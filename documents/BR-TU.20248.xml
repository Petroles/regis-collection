<?xml version="1.0" encoding="utf-8"?>
<add>
	<doc>
		<field name="docid">BR-TU.20248</field>
		<field name="filename">3720_monografia_dyego.pdf</field>
		<field name="filetype">PDF</field>
		<field name="text">
UNIVERSIDADE FEDERAL DE SANTA CATARINA

CENTRO TECNOLO?GICO

DEPARTAMENTO DE INFORMA?TICA E ESTATI?STICA

Integrac?a?o de uma Etapa de Ana?lise

Explorato?ria de Dados em um

Sistema de Ana?lise de Risco para

Operac?o?es de Completac?a?o e

Perfurac?a?o de Poc?os de Petro?leo

Dyego Wrubel Santin

Floriano?polis

2007



Dyego Wrubel Santin

Integrac?a?o de uma Etapa de Ana?lise

Explorato?ria de Dados em um Sistema de

Ana?lise de Risco para Operac?o?es de

Completac?a?o e Perfurac?a?o de Poc?os de

Petro?leo

Proposta de Projeto para o Trabalho de Con-
clusa?o de Curso em Cie?ncias da Computac?a?o
da Universidade Federal de Santa Catarina.

Orientador:

Mauro Roisenberg, Dr.

Universidade Federal de Santa Catarina
Centro Tecnolo?gico

Departamento de Informa?tica e Estat??stica

Floriano?polis

2007



Monografia de Projeto Final de Graduac?a?o sob o t??tulo “Integrac?a?o de uma Etapa de

Ana?lise Explorato?ria de Dados em um Sistema de Ana?lise de Risco para Operac?o?es de

Completac?a?o e Perfurac?a?o de Poc?os de Petro?leo”, defendida por Dyego Wrubel Santin e

aprovada em 2007, em Floriano?polis, Estado de Santa Catarina, pela banca examinadora

constitu??da pelos professores:

Prof. Mauro Roisenberg, Dr.
Orientador

Prof. Dalton Francisco de Andrade, Dr.
Universidade Federal de Santa Catarina

Profa. Silvia Modesto Nassar, Dra.
Universidade Federal de Santa Catarina



Agradecimentos

Aos meus queridos pais Domingos Santin e Albany Santin.

Em especial, ao Projeto E&amp;amp;P Risk e toda equipe pela grande experie?ncia.

Ao Professor Dr. Mauro Roisenberg pela oportunidade.

Aos Professores Dr. Dalton Francisco de Andrade e Dra. Silvia Modesto Nassar pelo

apoio.

Aos grandes companheiros e amigos da turma 022 que de alguma forma contribuiram

para a realizac?a?o deste trabalho.



Suma?rio

Lista de Figuras

1 Introduc?a?o p. 7

1.1 Tema . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . p. 8

1.2 Delimitac?a?o do Tema . . . . . . . . . . . . . . . . . . . . . . . . . . . . p. 8

1.3 Objetivo Geral . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . p. 8

1.4 Objetivos Espec??ficos . . . . . . . . . . . . . . . . . . . . . . . . . . . . p. 9

1.5 Motivac?a?o . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . p. 10

1.6 Estrutura do Trabalho . . . . . . . . . . . . . . . . . . . . . . . . . . . p. 10

2 Descoberta de Conhecimento - KDD p. 11

2.1 Fundamentac?a?o da Tipificac?a?o . . . . . . . . . . . . . . . . . . . . . . . p. 13

2.1.1 Tipificac?a?o . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . p. 13

2.2 Trabalhos Relacionados . . . . . . . . . . . . . . . . . . . . . . . . . . . p. 15

2.2.1 Weka . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . p. 15

2.2.2 SETIP - Sistema Especialista para Tipificar Dados de uma Pesquisa p. 15

3 E&amp;amp;P Risk IV p. 16

3.1 Introduc?a?o . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . p. 16

3.1.1 Ana?lise Explorato?ria dos Dados . . . . . . . . . . . . . . . . . . p. 16

3.1.2 Minerac?a?o dos Dados . . . . . . . . . . . . . . . . . . . . . . . . p. 16

3.2 Importac?a?o e Esquema de Organizac?a?o dos Dados . . . . . . . . . . . . p. 16

3.2.1 Organizac?a?o dos Dados . . . . . . . . . . . . . . . . . . . . . . . p. 16



3.2.2 Fontes de Dados Suportadas . . . . . . . . . . . . . . . . . . . . p. 17

3.2.2.1 Arquivos no formato texto com a extensa?o “txt” ou “csv” p. 17

3.2.2.2 Dados via provedor OLE DB . . . . . . . . . . . . . . p. 17

3.2.2.3 Microsoft Excel 97/2000/2002 . . . . . . . . . . . . . . p. 19

3.2.3 Configurac?o?es Regionais . . . . . . . . . . . . . . . . . . . . . . p. 19

3.2.4 Importac?a?o dos Dados . . . . . . . . . . . . . . . . . . . . . . . p. 20

3.2.4.1 Importando os dados de um arquivo CSV . . . . . . . p. 20

4 Ana?lise Explorato?ria dos Dados p. 24

4.1 Edic?a?o dos Dados . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . p. 25

4.2 Visualizac?a?o dos Dados . . . . . . . . . . . . . . . . . . . . . . . . . . . p. 29

4.2.1 Gra?ficos de Pontos . . . . . . . . . . . . . . . . . . . . . . . . . p. 29

4.2.2 Gra?ficos de Barras . . . . . . . . . . . . . . . . . . . . . . . . . p. 29

5 Metodologia de trabalho p. 33

5.1 Requisitos funcionais . . . . . . . . . . . . . . . . . . . . . . . . . . . . p. 33

5.2 Especificac?a?o do sistema . . . . . . . . . . . . . . . . . . . . . . . . . . p. 34

5.2.1 Implementac?a?o . . . . . . . . . . . . . . . . . . . . . . . . . . . p. 34

6 Concluso?es p. 36

Refere?ncias p. 38



Lista de Figuras

1 Etapa para preparac?a?o dos dados no mo?dulo neural do E&amp;amp;P Risk IV . p. 9

2 Etapas do Processo de Criac?a?o do Modelo de Previsa?o . . . . . . . . . p. 12

3 Diagrama do Esquema de Tipificac?a?o . . . . . . . . . . . . . . . . . . . p. 14

4 Selecionando o provedor OLE DB . . . . . . . . . . . . . . . . . . . . . p. 18

5 Propriedades da conexa?o . . . . . . . . . . . . . . . . . . . . . . . . . . p. 19

6 Selecionado a fonte dos dados . . . . . . . . . . . . . . . . . . . . . . . p. 20

7 Determinando o nome do arquivo, o delimitador e se possui os nomes

dos atributos . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . p. 21

8 Selecionado os atributos . . . . . . . . . . . . . . . . . . . . . . . . . . p. 22

9 Visualizando e editando os tipos dos atributos . . . . . . . . . . . . . . p. 23

10 Ana?lise Explorato?ria . . . . . . . . . . . . . . . . . . . . . . . . . . . . p. 26

11 Edic?a?o dos dados . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . p. 27

12 Substituic?a?o nume?rica . . . . . . . . . . . . . . . . . . . . . . . . . . . p. 28

13 Substituic?a?o nominal . . . . . . . . . . . . . . . . . . . . . . . . . . . . p. 28

14 Gra?ficos de pontos. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . p. 30

15 Gra?ficos de Barras . . . . . . . . . . . . . . . . . . . . . . . . . . . . . p. 31

16 Diagrama de Classes da estrutura ba?sica do sistema . . . . . . . . . . . p. 35



7

1 Introduc?a?o

A ana?lise de riscos e o gerenciamento em processos de explorac?a?o de petro?leo, atual-

mente sa?o a?reas em crescente expansa?o. As companhias petrol??feras esta?o usufruindo de

princ??pios de ana?lise de riscos em combinac?a?o com novas tecnologias, para aumentar sua

capacidade de explorac?a?o.

As operac?o?es de perfurac?a?o e completac?a?o de poc?os de petro?leo sa?o muito complexas,

com um alto grau de imprecisa?o e va?rios fatores de riscos associados. Os maiores gastos

esta?o relacionados com operac?o?es de sondas para intervenc?o?es em poc?os e manutenc?o?es

corretivas. Para se ter uma ide?ia, os custos de extrac?a?o no terceiro trimestre de 2006

atingiram 6,64US$/bbl (Petrobras).

Portanto, a complexidade destas operac?o?es e? um dos grandes responsa?veis pelos altos

custos de produc?a?o. Desta maneira, surge a seguinte questa?o: E? poss??vel construir um

sistema computacional de simulac?a?o e ana?lise de risco para estas operac?o?es?

E ale?m disso, capaz de fazer uma estimativa do tempo total para realizar uma

determinada operac?a?o?

Atualmente, muitas te?cnicas de Intelige?ncia Computacional sa?o empregadas com su-

cesso no desenvolvimento de sistemas inteligentes de previsa?o, suporte a? decisa?o, controle,

otimizac?a?o, modelagem, classificac?a?o e reconhecimento de padro?es em geral, aplicados em

diversos setores: energe?tico, industrial, econo?mico, financeiro, comercial, entre outros.

Diante disso, a soluc?a?o proposta para as questo?es acima chama-se E&amp;amp;P Risk. O

E&amp;amp;P Risk e? um projeto desenvolvido pelos integrantes do laborato?rio PerformanceLab da

UFSC (Universidade Federal de Santa Catarina) em parceria com o centro de pesquisa

da Petrobras/Cenpes.

O E&amp;amp;P Risk esta? dividido em va?rios mo?dulos:

• Mo?dulo Monte Carlo;

• Mo?dulo Bayesiano;



8

• Mo?dulo de Teste de Adere?ncia;

• Mo?dulo Neural.

Diante deste contexto, o principal objetivo dessa proposta e? apresentar novas abor-

dagens e te?cnicas de ana?lise explorato?ria de dados, que possam ser empregadas no E&amp;amp;P

Risk, mais especificamente, no mo?dulo neural. O Mo?dulo neural foi introduzido na versa?o

III do E&amp;amp;P Risk e teve continuac?a?o na versa?o IV.

1.1 Tema

A grande imprevisibilidade presente nas operac?o?es de perfurac?a?o e completac?a?o de

poc?os de petro?leo, devido a uma se?rie de riscos e fatores, tais como o conhecimento limitado

sobre as caracter??sticas geolo?gicas, as dificuldades te?cnicas e ainda, o comportamento

imprevis??vel de operadores humanos, torna imprescind??vel o uso de alguma te?cnica ou

ferramenta para auxiliar na estimativa do tempo total gasto com essas operac?o?es.

1.2 Delimitac?a?o do Tema

A proposta e? utilizar te?cnicas de ana?lise explorato?ria de dados com a finalidade de au-

xiliar na ana?lise de riscos em operac?o?es de perfurac?a?o e completac?a?o de poc?os de petro?leo,

visto que, estas te?cnicas ve?m desempenhando um papel fundamental na descoberta de

novos conhecimentos e informac?o?es va?lidas, impl??citas em bases de dados.

1.3 Objetivo Geral

Desenvolver um novo submo?dulo de Ana?lise Explorato?ria dos dados para integrar

o processo de descoberta do tempo total, conforme pode ser visto na figura 1:

A justificativa e? que um dos pontos cr??ticos para os modelos de redes neurais e? a qua-

lidade dos dados de entrada, ou seja, quanto maior a qualidade dos dados mais confia?vel

sera? o resultado.

Ale?m disso, o mo?dulo neural no E&amp;amp;P Risk III tava limitado a uma se?rie de restric?o?es

impostas pela maneira como os dados eram importados.



9

1. Exige-se que o arquivo de entrada para os dados esteja no formato texto com a

extensa?o (*.txt);

2. O caractere delimitador para os campos dos registros deve ser o ponto-e-v??rgula (;);

3. O identificador dos campos de strings sa?o as aspas duplas (“campo”);

4. Todo registro que possuir um campo na?o preenchido sera? descartado, na?o possibili-

tando ao usua?rio nenhum tipo de tratamento para estes campos.

A figura 1 ilustra todo o processo para a estimativa do tempo total no mo?dulo neural

proposto para o E&amp;amp;P Risk IV, que vai desde a importac?a?o dos dados que servira?o de

entrada para a etapa de ana?lise explorato?ria, que por sua vez ira? alimentar o algoritmo

minerador que vai fazer a estimativa do tempo total.

Figura 1: Etapa para preparac?a?o dos dados no mo?dulo neural do E&amp;amp;P Risk IV

1.4 Objetivos Espec??ficos

• Desenvolver uma interface gra?fica que permita ao usua?rio ter uma visa?o geral dos
dados, atrave?s de estat??sticas gerais e gra?ficos de barras e ale?m disso, interagir com

ferramentas de manipulac?a?o e preparac?a?o dos dados;

• Implantar uma nova etapa de ana?lise explorato?ria e preparac?a?o dos dados no pro-
cesso de estimativa do tempo total realizado pelo modelo de previsa?o neural;

• Implementar ferramentas para a realizac?a?o de tarefas de limpeza dos dados, as-
sim como ferramentas para auxiliar a identificac?a?o de ru??dos, valores corrompidos,

inconsiste?ncias e redunda?ncias;

• Permitir a manipulac?a?o dos dados atrave?s de ferramentas de edic?a?o e de visualizac?a?o
gra?fica dos dados;



10

• Permitir a selec?a?o determin??stica dos atributos para que o usua?rio possa escolher
apenas os atributos relevantes ao dom??nio em questa?o.

• Desenvolver uma ferramenta para auxiliar na tarefa de tratamento dos campos na?o
preenchidos (“missings”) dos dados.

• Utilizar e compreender ferramentas de consultas a base de dados, tais como a lin-
guagem SQL.

1.5 Motivac?a?o

O crescente aumento das bases de dados devido a? grande quantidade de informac?o?es

gerada nos dias atuais, esta? tornando cada vez mais importante, o uso de ferramentas

e te?cnicas automatizadas para extrair conhecimento dessas grandes colec?o?es de dados.

Dentre as te?cnicas mais utilizadas, temos a ana?lise explorato?ria dos dados.

Ale?m disso, e? muito importante estimar o tempo total de uma operac?a?o de perfurac?a?o

de um poc?o de petro?leo, principalmente, devido ao alto custo deste tipo de operac?a?o.

1.6 Estrutura do Trabalho

O Trabalho esta? definido da seguinte maneira:

O cap??tulo 2 faz uma abordagem do processo de descoberta de conhecimento KDD,

assim como o esquema que foi definido para o E&amp;amp;P Risk IV. O cap??tulo 3 diz respeito ao

E&amp;amp;P Risk IV propriamente dito e o funcionamento do “wizard” de importac?a?o de dados.

O cap??tulo 4 traz as te?cnicas de preparac?a?o de dados e ana?lise explorato?ria empregadas

para as mais diversas tarefas. O cap??tulo 5 trata a metologia de trabalho adotada assim

como detalhes de implementac?a?o. Finamente, o cap??tulo 6 e? dedicado a?s concluso?es e

trabalhos futuros do projeto.



11

2 Descoberta de Conhecimento -
KDD

A a?rea de Descoberta de Conhecimento em Banco de Dados (KDD - Knowledge

Discovery in Databases) surgiu da necessidade de te?cnicas e soluc?o?es para ana?lise de

grandes bases de dados. O KDD e? um processo amplo, que inclui va?rias etapas. Estas

etapas podem ser classificadas de maneira geral como: Ana?lise Explorato?ria de Dados e

Minerac?a?o de Dados.

O objetivo da ana?lise explorato?ria de dados e? examinar a estrutura subjacente

dos dados e aprender sobre os relacionamentos sistema?ticos entre muitas varia?veis. A

ana?lise explorato?ria de dados inclui um conjunto de ferramentas gra?ficas e descritivas,

para explorar os dados, como pre?-requisito para uma ana?lise de dados mais formal, e

como parte da construc?a?o de modelos.

Na etapa de Minerac?a?o de Dados (Data Mining) um conjunto de te?cnicas sa?o

empregadas para a extrac?a?o de padro?es de interesse e para a criac?a?o de modelos para

estimac?a?o e predic?a?o de valores. Ja? entre as tarefas da etapa de Minerac?a?o, podemos

encontrar te?cnicas de Ana?lise de Agrupamentos, Ana?lise de Regressa?o, Avaliac?a?o e Visu-

alizac?a?o, entre outras.

Mais detalhadamente, as etapas do processo completo de KDD sa?o as seguintes (SILVA,

2004):

1. Limpeza dos dados: etapa para a eliminic?a?o de ru??dos, dados inconsistentes ou

corrompidos. Ale?m disso, correc?a?o de poss??veis erros e imputac?a?o ou eliminic?a?o de

valores nulos e redundantes.

2. Integrac?a?o dos dados: etapa de combinac?a?o de diferentes fontes de dados para a

formac?a?o de um u?nico reposito?rio de dados.

3. Selec?a?o: etapa para a selec?a?o dos atributos que sa?o relevantes para o objetivo da



12

tarefa. Por exemplo, o usua?rio pode decidir que informac?o?es como “Nome do poc?o”

na?o sa?o importantes para determinar o tempo total de perfurac?a?o de um novo poc?o.

4. Transformac?a?o dos dados: etapa para a transformac?a?o dos dados em um formato

apropriado para a execuc?a?o dos algoritmos de minerac?a?o.

5. Minerac?a?o: etapa essencial no processo de KDD, consiste na aplicac?a?o de te?cnicas

inteligentes com o propo?sito de extrair os padro?es e informac?o?es de interesse. Pode-

se dizer que transforma dados em informac?o?es.

6. Avaliac?a?o ou Po?s-processamento: etapa para identificac?a?o dos melhores padro?es

de acordo com algum crite?rio adotado, ou seja, e? um processo de refinamento dos

resultados.

7. Visualizac?a?o dos Resultados: etapa para a representac?a?o e interpretac?a?o do conhe-

cimento minerado.

Figura 2: Etapas do Processo de Criac?a?o do Modelo de Previsa?o



13

2.1 Fundamentac?a?o da Tipificac?a?o

2.1.1 Tipificac?a?o

O processo de tipificac?a?o automa?tico de varia?veis implementado no E&amp;amp;P Risk IV,

e? uma ferramenta para auxiliar o usua?rio na definic?a?o dos tipos das varia?veis. Definir

os tipos das varia?veis pode ficar complicado para um usua?rio na?o te?cnico que na?o tem

conhecimento da sema?ntica das mesmas, ou seja, na?o e? um especialista do dom??nio. Ale?m

disso, o tipo da varia?vel e? uma informac?a?o importante para o submo?dulo neural do sistema.

O sistema proposto e? uma adaptac?a?o e simplificac?a?o do processo de tipificac?a?o im-

plementado no SETIP. (SANTOS, 2001) De acordo com a natureza da varia?vel, o seu tipo

pode ser classificado dentre as seguintes categorias: qualitativa, quantitativa, booleana

ou do tipo data.

Para as varia?veis do tipo qualitativa, booleana e data, a identificac?a?o e? simples, uma

vez que esta informac?a?o pode ser descoberta atrave?s dos pro?prios valores e formatos dos

dados. No entanto, a complexidade aumenta quando os valores sa?o nume?ricos, pois surge

a seguinte questa?o:

Os valores nume?ricos da varia?vel possuem uma sema?ntica de qualidades da varia?vel,

ou seja, a varia?vel e? qualitativa?

Por exemplo, uma determinada varia?vel qualitativa, “Grau de Dificuldade de Per-

furac?a?o“, pode representar uma escala da seguinte maneira:

• 1 para representar um grau alto;

• 0,5 para representar um grau me?dio;

• 0 para represe ntar um grau baixo;

A proposta e? baseada na busca dessa informac?a?o em uma base de conhecimento de

casos atrave?s da pol??tica do vizinho mais pro?ximo, ou seja, encontra-se por similari-

dade o caso da base mais ”parecido“ com o novo caso indefinido. Dessa maneira, o tipo

do novo caso e? determinado de acordo com o tipo do mais similar a este novo caso. Este

esquema pode ser visto na figura 3.

Um caso e? definido atrave?s dos seguintes para?metros (SANTOS, 2001):

• Me?dia dos valores absolutos elevados ao expoente -1, para Xi 6= 0, com i = 1, 2, ..., n.



14

Figura 3: Diagrama do Esquema de Tipificac?a?o

Onde Xi representa os valores va?lidos e n a quantidade de valores va?lidos.

M edExpo =

?n
i=1 |Xi|?1

n
(2.1)

• Raza?o entre a quantidade de valores que se repetem nos dados R e o nu?mero de
valores va?lidos n.

RazaoRep =
R

n
(2.2)

• Me?dia ponderada adaptada dos valores va?lidos para max 6= min.

M edP ond =
%

?

0
BBBBB@

?n
i=1

1

2Xi
n

1
CCCCCA

(max ? min) (2.3)

• Soma (dividida de forma a obter um valor entre zero e um) dos valores, na suposic?a?o
de formarem uma Progressa?o Aritme?tica (PA), para max + min 6= 0 e Dif 6= 0,
onde Dif representa o nu?mero de diferentes valores que os dados possuem.

SomaP A =
2

(max + min) Dif
(2.4)

• Raza?o (dividida de forma a obter um valor entre zero e um) dos valores, na suposic?a?o
de formarem uma Progressa?o Aritme?tica (PA), para max + min 6= 0 e Dif 6= 0,
onde DDif i representa o nu?mero de valores que na?o se repetem nos dados.

RazaoP A =
2 (

?n
i=1 (DDifi+1 ? DDifi))
(max + min) Dif

(2.5)



15

A base de casos do esquema e? ilustrada na tabela abaixo:

Caso M edExpo RazaoRep M edP ond SomaP A RazaoP A Tipo

0 0,16273 0,31111 0,00741 0,02144 0,12500 0,0

1 0,83706 0,21429 0,03571 0,10967 0,95333 1,0

2 0,46578 0,25000 0,08333 0,19806 0,96667 1,0

3 0,05490 0,03445 0,00055 0,01544 0,64000 0,0

4 0,44000 0,66667 0,33333 0,40126 0,98000 1,0

2.2 Trabalhos Relacionados

2.2.1 Weka

O Weka (THE UNIVERSITY OF WAIKATO, ) e? um software de minerac?a?o de dados

desenvolvido na linguagem de programac?a?o Java (Sun), com co?digo aberto e licenc?a GPL

(General Public License), que apresenta uma colec?a?o de algoritmos de aprendizado para a

realizac?a?o de tarefas de minerac?a?o de dados. Possui ferramentas para pre?-processamento,

classificac?a?o, regressa?o, clusterizac?a?o, regras de associac?a?o e visualizac?a?o dos dados.

2.2.2 SETIP - Sistema Especialista para Tipificar Dados de uma
Pesquisa

O SETIP (SANTOS, 2001) e? um sistema especialista integrado ao SEstat (sistema

utilizado no ensino da estat??stica), que classifica varia?veis de dados quanto ao seu tipo,

qualitativa ou quantitativa.



16

3 E&amp;amp;P Risk IV

3.1 Introduc?a?o

O Sistema E&amp;amp;P Risk IV e? um ambiente computacional voltado para a simulac?a?o e

ana?lise de risco em operac?o?es de perfurac?a?o e completac?a?o de poc?os de petro?leo. Foi

desenvolvido pelos integrantes dos laborato?rios da UFSC (Universidade Federal de Santa

Catarina), PerformanceLab, LEA e L3C sob encomenda da Petrobras/Cenpes.

3.1.1 Ana?lise Explorato?ria dos Dados

A etapa de Ana?lise Explorato?ria de Dados inclui tarefas que manipulam e preparam

os dados para a etapa de minerac?a?o, tais como: limpeza, tipificac?a?o, integrac?a?o dos dados,

selec?a?o de atributos e transformac?a?o de dados.

3.1.2 Minerac?a?o dos Dados

No caso do Sistema E&amp;amp;P Risk IV, o Sub-Mo?dulo de Redes Neurais Artificiais prove?

um conjunto de te?cnicas e ferramentas destinadas a construir modelos para previsa?o de

valores de tempos de intervenc?a?o em operac?o?es complexas de engenharia de poc?os a partir

de informac?o?es histo?ricas armazenadas em bancos de dados da companhia.

3.2 Importac?a?o e Esquema de Organizac?a?o dos Da-

dos

3.2.1 Organizac?a?o dos Dados

Os dados sa?o organizados e mantidos em uma estrutura interna de armazenamento,

desta maneira, qualquer alterac?a?o que seja aplicada aos dados da estrutura, na?o sera?

propagada aos dados originais na fonte.



17

3.2.2 Fontes de Dados Suportadas

O E&amp;amp;P Risk IV possui uma fonte de dados bastante diversificada e flex??vel, suportando

os seguintes formatos:

3.2.2.1 Arquivos no formato texto com a extensa?o “txt” ou “csv”

Este formato e? uma representac?a?o tabular dos dados. Portanto, o arquivo possui um

conjunto de “n” linhas (registros), sendo cada registro composto por “m” colunas (valores

dos campos) separados por um caractere delimitador. Diante disso, o nu?mero de varia?veis

de dados e? determinado pelo nu?mero de colunas “m”, ou seja, cada coluna representa

uma varia?vel distinta.

Ale?m disso, a primeira linha pode ser um registro especial que conte?m os nomes das

varia?veis. Caso contra?rio, as varia?veis assumira?o nomes padro?es definidos automatica-

mente pelo sistema. As demais linhas possuem apenas dados.

Exemplos de caracteres delimitadores que podem ser utilizados: o ponto-e-v??rgula, a

v??rgula, caracteres de espac?amento (tabulac?a?o ou espac?o em branco) e ainda, qualquer

outro caractere que possa ser determinado pelo usua?rio.

Observac?o?es: E? necessa?rio a integridade do arquivo, ou seja, que todos os registros

possuam o mesmo nu?mero de campos delimitados. Um campo “missing” sera? iden-

tificado pela ocorre?ncia de dois delimitadores consecutivos. Ale?m disso, e? necessa?rio a

corresponde?ncia entre o caractere delimitador do arquivo com o indicado pelo usua?rio

durante a etapa de importac?a?o dos dados.

3.2.2.2 Dados via provedor OLE DB

Neste caso, o acesso aos dados sera? feito atrave?s de um provedor OLE DB especificado

pelo usua?rio

O que e? OLE DB?

OLE DB extende por Object Linking and Embedding for Databases. Tecnologia de-

senvolvida pela Microsoft e usada para se ter acesso a diferentes fontes de informac?o?es

ou bases de dados, de maneira uniforme. E? dividida em consumidores e provedores. Os

consumidores sa?o os aplicativos que necessitam do acesso aos dados e os provedores sa?o

os componentes de software que fornecem uma interface para o acesso.



18

Especificando o provedor OLE DB no E&amp;amp;P Risk IV

Durante a etapa de importac?a?o, e? usada a aba “Provider” do “Data Link Properties”

para selecionar o provedor OLE DB apropriado para a base de dados, dentre uma lista

de todos os provedores detectados no computador.

Por exemplo, as bases de dados do Microsoft Access (*.mdb), podem ser acessadas

atrave?s do provedor Microsoft Jet 4.0.

Figura 4: Selecionando o provedor OLE DB

Especificando a conexa?o para o acesso

E? na aba “Connection” que sa?o definidas as propriedades de conexa?o requeridas para

fazer o acesso a um determinado provedor. A conexa?o pode ser testada para verificar as

propriedades.



19

Figura 5: Propriedades da conexa?o

3.2.2.3 Microsoft Excel 97/2000/2002

Esta opc?a?o espera um arquivo com a extensa?o “xls” contendo internamente uma

ou mais planilhas. No u?ltimo caso, o usua?rio selecionara? a planilha desejada para a

importac?a?o dos seus dados.

3.2.3 Configurac?o?es Regionais

O E&amp;amp;P Risk IV adota as configurac?o?es regionais definidas no sistema operacional para

os padro?es nume?ricos, como o separador de decimal, milhar, entre outros.

Deste modo, os dados originais usados para a importac?a?o devera?o obedecer o esquema

de configurac?a?o local do sistema. Por exemplo, caso o sistema esteja configurado para



20

usar as configurac?o?es regionais do Brasil, assumi-se como separador de decimal a v??rgula

(“,”) e como separador de milhar o ponto (“.”).

Ale?m disso, deve-se descartar a possibilidade de usar o mesmo caractere, por exemplo

a v??rgula, tanto para separador de decimal como para delimitador entre os valores dos

dados.

3.2.4 Importac?a?o dos Dados

A importac?a?o dos dados e? realizada em forma de um “Wizard”. Deste modo, uma

seque?ncia pre?-determinada de passos sera? executada de acordo com a opc?a?o de fonte de

dados escolhida pelo usua?rio.

A seguir e? apresentado os passos de um procedimento padra?o para importac?a?o de

dados a? partir de um aquivo texto com a extensa?o CSV.

3.2.4.1 Importando os dados de um arquivo CSV

1. O primeiro passo e? selecionar o tipo da fonte dos dados. Figura(6).

Figura 6: Selecionado a fonte dos dados



21

2. O passo seguinte e? determinar o nome do arquivo que conte?m os dados, o caractere

delimitador dos campos dos registros e ainda, indicar se o primeiro registro conte?m

ou na?o os nomes dos atributos (Figura 7).

Figura 7: Determinando o nome do arquivo, o delimitador e se possui os nomes dos
atributos

3. Apo?s isso, deve-se fazer a selec?a?o dos atributos que sera?o importados para a ana?lise

explorato?ria. (Figura 8).

O avanc?o no procedimento de importac?a?o, exatamente neste ponto, implicara? na

execuc?a?o do processo de tipificac?a?o automa?tico das varia?veis de dados que esta?o

sendo obtidas para a etapa de ana?lise.

Visto que a tipificac?a?o e? apenas uma ferramenta para auxiliar o especialista a de-

terminar os tipos para as suas varia?veis de entrada, o pro?ximo passo consiste na

visualizac?a?o dos resultados da tipificac?a?o e ainda, poss??vel alterac?a?o e correc?a?o para

os tipos determinados.

4. Finalmente, o u?ltimo passo e? a visualizac?a?o e edic?a?o dos tipos dos atributos. Figura(9).



22

Figura 8: Selecionado os atributos



23

Figura 9: Visualizando e editando os tipos dos atributos



24

4 Ana?lise Explorato?ria dos Dados

A etapa que sucede a importac?a?o dos dados do sistema e? chamada de “ana?lise ex-

plorato?ria dos dados”. Nesta etapa, uma se?rie de informac?o?es sa?o gerenciadas atrave?s

de uma interface para vizualizac?a?o de estat??sticas gerais, atributos, tipos dos atributos,

gra?ficos, gra?ficos de barras e ainda, ferramentas para limpeza, selec?a?o, transformac?a?o e

edic?a?o dos dados.

As informac?o?es esta?o distribu??das em diferentes perspectivas da interface gra?fica, con-

forme pode ser visto na figura 10:

1. Informac?o?es Gerais: exibe o nome da fonte dos dados, o total de registros lidos

da base e o total de atributos.

2. Atributos: exibe uma lista com os nomes dos atributos e uma caixa de selec?a?o ao

lado de cada nome. Acima da lista existem tre?s boto?es:

• Todos: marca a caixa de selec?a?o de todos os atributos.
• Remover: remove os atributos que possuem a caixa de selec?a?o marcada.
• Inverter: marca a caixa de selec?a?o que esta? desmarcada e vice-versa.

3. Tipos: exibe os tipos dos atributos previamente tipificados entre as quatro poss??veis

classes: quantitativos, qualitativos, tipo booleano e data.

4. Atributo Selecionado (estat??sticas): apresenta algumas estat??sticas de um de-

terminado atributo selecionado. Dentre as estat??sticas destacam-se:

• Distintos: nu?mero de diferentes valores que os dados possuem para o atributo
selecionado.

• U?nicos: nu?mero de valores do atributo que possuem uma u?nica insta?ncia nos
dados.



25

• Missing: nu?mero de registros dos dados para qual o valor do atributo na?o
esta? preenchido.

Abaixo destas estat??sticas, e? exibida uma lista com informac?o?es sobre os valores do

atributo de acordo com o seu tipo. Para um atributo quantitativo, a lista exibira?

quatro novas estat??sticas descrevendo a distribuic?a?o dos dados, sendo estas: o valor

m??nimo, ma?ximo, me?dia e o desvio padra?o. Para os demais tipos, a lista exibira? cada

poss??vel valor do atributo com a sua correspondente freque?ncia, ou seja, o nu?mero

de vezes que o valor aparece nos registros.

5. Gra?ficos de Barras (visualizac?a?o prima?ria): apresenta o gra?fico de barras de

frequ?e?ncia do atributo selecionado. Acima do gra?fico de barras tem-se um compo-

nente “combobox” com os nomes dos atributos que podem ser selecionados. Ao

seu lado direito, encontram-se informac?o?es (classe, frequ?e?ncia) que sera?o exibidas

quando o usua?rio clicar em uma barra do gra?fico de barras.

Ale?m disso, no canto inferior esquerdo da tela existem quatro outras funcionalidades:

1. Salvar: salva os dados em um arquivo texto (*.txt). O caractere delimitador de

valores podera? ser o ponto-e-v??rgula, ou enta?o, o caractere de tabulac?a?o.

2. Ir para o treinamento: Passa para a etapa de treinamento da rede neural se na?o

existirem valores missigns para os dados, caso contra?rio, o tratamento dos mesmos

ainda devera? ser feito.

3. Edic?a?o: Exibe a janela de edic?a?o dos dados.

4. Visualizac?a?o: Exibe a janela de vizualizac?a?o dos dados.

4.1 Edic?a?o dos Dados

A tabela de edic?a?o de dados, que pode ser vista na Figura 11, e? o mecanismo que o

usua?rio possui para realizar algum tipo de tratamento ou transformac?a?o nos dados.

Ao clicar com o bota?o direito do mouse sobre a tabela de edic?a?o, o usua?rio acessa

um “popup menu”com as principais funcionalidades para realizar a tarefa de edic?a?o dos

dados, conforme pode ser visto na figura 11.

Dentre as principais funcionalidades da etapa de edic?a?o destacam-se:



26

Figura 10: Ana?lise Explorato?ria

1. Renomear Atributo: utilizada para renomear o nome do atributo.

2. Substituir: substituir valores dos atributos por novos valores.

• Permitir a substituic?a?o de todos os valores do atributo por um novo valor
escolhido. Para um atributo nume?rico por um novo valor qualquer (Figura

12). Para um atributo nominal por um dos valores nominais ja? existentes.

• Permitir a substituic?a?o de todos os valores “missings” por um novo valor
especificado. Para um atributo nume?rico o novo valor pode ser zero, o valor

me?dio, ou um nu?mero qualquer. Para um atributo nominal, um dos valores

nominais ja? existentes (Figura 13).

3. Missings: realizar o tratamento dos valores na?o preenchidos (“missings”).



27

Figura 11: Edic?a?o dos dados

4. Ordenar (Crescente): reordenar a visualizac?a?o de todos os registros por ordem

crescente dos valores do atributo.

5. Ordenar (Decrescente): reordenar a visualizac?a?o de todos os registros por ordem

decrescente dos valores do atributo.

A ordenac?a?o da coluna tambe?m e? feita automaticamente ao clicar-se com o bota?o

esquerdo do mouse sobre o nome da coluna. A coluna ordenada destaca-se das

demais por possuir uma indicac?a?o (seta) ao lado do nome do atributo e pela sua cor

de fundo diferenciada.

6. Remover linha: remover a linha da tabela.

7. Remover coluna: remover a coluna da tabela.

8. Salvar: permitir a exportac?a?o dos dados da tabela para dois poss??veis formatos.



28

Figura 12: Substituic?a?o nume?rica

Figura 13: Substituic?a?o nominal

O primeiro para arquivo texto (*.txt) com o caractere de tabulac?a?o de delimitador

e o segundo, tambe?m arquivo texto (*.csv) com o caractere de ponto-e-v??rgula de

delimitador.

Ale?m disso, existem outras funcionalidades que podem ser usadas na tarefa de edic?a?o.

Por exemplo, o valor de um campo pode ser alterado diretamente na tabela. Neste caso,

para um atributo nominal atrave?s de uma lista dos poss??veis valores que e? exibida na tela

atrave?s de um componente “combobox” e para um atributo nume?rico atrave?s do pro?prio

valor nume?rico digitado.

Ainda, e? poss??vel remover da tabela va?rias linhas consecutivas selecionadas pelo

usua?rio.



29

4.2 Visualizac?a?o dos Dados

Ferramenta gra?fica que permite fazer a vizualizac?a?o dos dados atrave?s de gra?ficos

de pontos e gra?ficos de barras. A janela possui dois modos de visualizac?a?o dos dados:

Gra?ficos de Pontos e Gra?ficos de Barras.

4.2.1 Gra?ficos de Pontos

O modo de visualizac?a?o dos gra?ficos apresenta tre?s partes principais:

1. Eixos: Estes campos definem quais atributos sera?o representados no eixo das abs-

cissas (x) e das ordenadas (y) do gra?fico de pontos.

Conforme pode ser visto na figura 14 destacado em azul, TipoIntervencao e Ti-

poSonda respectivamente.

2. Gra?ficos de Pontos: Mostra o conjunto de pontos de coordenadas (x, y) plotados

da base de dados para os atributos definidas em eixos.

O efeito de “zoom” no gra?fico (+/-) e? obtido selecionando-se a a?rea do gra?fico

desejada com o bota?o esquerdo do mouse pressionado.

3. Registros: Mostra o(s) registros(s) correspondente(s) da base de dados de uma

determinada coordenada (x, y) selecionada.

Por exemplo, conforme porde ser visto na figura 14 destacado em preto, os registros

exibidos correspondem aos casos da base que te?m coordenadas (x=Perfurac?a?o Es-

pecial, y=NS). A coordenada para o(s) registro(s) e? definida clicando-se sobre um

dos pontos de coordenadas (“x” em vermelho) do gra?fico.

4.2.2 Gra?ficos de Barras

O modo de visualizac?a?o dos gra?ficos de barras apresenta tre?s partes principais:

1. Eixos: Estes campos definem quais atributos correspondem ao eixo das abscissas

(x) e das ordenadas (y) do gra?fico de barras.

Conforme pode ser visto na figura ?? destacado em azul,, ProfFinalSondador e

TipoSonda respectivamente.



30

Figura 14: Gra?ficos de pontos.

2. Gra?ficos de barras com legenda a? direita: Gra?ficos de barras verticais para

o atributo da abscissa (x), cujas cores representam a frequ?e?ncia em relac?a?o as ca-

tegorias da ordenada (y). As categorias sa?o definidas de acordo com o tipo do

atributo, ou seja, para um atributo nume?rico sera?o o intervalo de classe dos seus

valores e para um atributo nominal sera?o um dos seus poss??veis valores.

Por exemplo, conforme porde ser visto na figura 15, as barras verticais para a abs-

cissa (x=ProfFinalSondador) sa?o intervalos de classes dos seus valores e as categorias

da ordenada (y=TipoSonda) sa?o valores do atributo como NS, PA, SS.

Da mesma maneira, o efeito de “zoom” no gra?fico (+/-) e? obtido selecionando-se a

a?rea do gra?fico desejada com o bota?o esquerdo do mouse pressionado. A legenda

aparece ao lado direito do gra?fico de barras.

3. Informac?o?es da relac?a?o (x, y): Exibe informac?o?es espec??ficas sobre a relac?a?o



31

Figura 15: Gra?ficos de Barras

entre uma barra vertical (x) e uma categoria da ordenada (y). Cada categoria e?

representada por uma cor diferente na barra.

• x: valor da abscissa (x) que corresponde a barra vertical.
• Categoria(y): valor da categoria da ordenada (y) que esta? relacionada com

a barra vertical (x).

• Freque?ncia (x, y): valor da freque?ncia de ocorre?ncia nos dados da relac?a?o
entre (x) e a categoria (y).

Pore?m, essas informac?o?es somente sa?o exibidas quando o usua?rio clicar sobre uma

das poss??veis a?reas da barra vertical, cada uma com sua cor espec??fica. Por exemplo,

na figura ?? destacado em vermelho, sa?o apresentadas as seguintes informac?o?es:

• x: [3342, 8; 3500, 3] representa o intervalo de classe para aquela barra vertical.



32

• Categoria (y): SPM e? o valor da ordenada (y=TipoSonda) para aquela a?rea
selecionada da barra do gra?fico de barras.

• Freque?ncia: 196 representa a freque?ncia de ocorre?ncia da relac?a?o entre [3342, 8; 3500, 3]
e SPM nos dados.



33

5 Metodologia de trabalho

Foi realizado um estudo detalhado e aprofundado de algumas te?cnicas de ana?lise

explorato?ria de dados existentes na literatura, assim como, o estudo de caso do software

WEKA, que incorpora diversos aspectos e conceitos de ana?lise explorato?ria de dados.

Com tudo isso, buscou-se um melhor embasamento teo?rico para a realizac?a?o da proposta

em questa?o.

5.1 Requisitos funcionais

- Importar os dados de uma base de dados corporativa, permitindo a visualizac?a?o e

edic?a?o destes dados.

- Possibilitar a nomeac?a?o e alterac?a?o dos campos da base de dados.

- As alterac?o?es nos dados na?o sera?o propagadas para a estrutura original da base de

dados, ou seja, sera?o locais.

- Classificar os campos da base de dados de acordo com a natureza destes dados:

1. Qualitativo Ordinal

2. Qualitativo Nominal

3. Quantitativo Discreto

4. Quantitativo Cont??nuo

- Permitir a preparac?a?o dos dados para a etapa de minerac?a?o atrave?s de te?cnicas de

selec?a?o, pre?-processamento e transformac?a?o destes dados.

- Permitir o tratamento de valores na?o preenchidos (missings).

- Poder obter uma distribuic?a?o mais sime?trica dos dados, atrave?s de processos de

transformac?a?o destes dados.



34

5.2 Especificac?a?o do sistema

5.2.1 Implementac?a?o

A implementac?a?o consiste no desenvolvimento de um mo?dulo de software integrado,

incorporando aspectos de minerac?a?o de dados, de acordo com os requisitos apresentados.

A implementac?a?o do aplicativo sera? feita na linguagem de programac?a?o C++.

Parte da modelagem de classes UML proposta para a estrutura ba?sica do sistema e?

apresentada na figura 16:



35

Figura 16: Diagrama de Classes da estrutura ba?sica do sistema



36

6 Concluso?es

A principal tarefa do mo?dulo neural do E&amp;amp;P Risk IV e? fazer uma estimativa do

tempo total para realizar uma nova operac?a?o de perfurac?a?o ou completac?a?o de um poc?o

de petro?leo baseada em um conjunto de varia?veis de dados. O processo de descoberta dessa

informac?a?o e? amplo e passa pelas seguintes etapas: importac?a?o e tipificac?a?o, limpeza e

selec?a?o, ana?lise de agrupamentos e modelo de previsa?o.

A grande contribuic?a?o deste trabalho para o processo foi a implementac?a?o de soluc?o?es

para a realizac?a?o das duas primeiras etapas, basicamente, a preparac?a?o dos dados para

o algoritmo minerador. A preparac?a?o dos dados e? um passo importante e cr??tico para

problemas de ana?lise de dados modelados com redes neurais, pois a qualidade destes

dados te?m um grande impacto sobre os resultados finais, no caso, a estimativa do tempo

total. Ale?m disso, outro ponto forte e? o sistema de imputac?a?o para o tratamento dos

dados na?o preenchidos.

Desta maneira, pode-se afirmar que a ferramenta cumpriu todos os requisitos es-

pecificados atrave?s de diversas funcionalidades que facilitam a realizac?a?o da tarefa de

preparac?a?o. Uma das principais funcionalidades e? o tratamento dos valores na?o preenchi-

dos (“missings”), visto que, a restric?a?o para a realizac?a?o do treinamento da rede neural

modelada para a ana?lise de agrupamentos e? que na?o existam valores “missings” nos dados

de entrada.

Ale?m disso, a ferramenta pode desempenhar o papel de um “filtro” para os dados.

Atrave?s das ferramentas de edic?a?o e visualizac?a?o pode-se identificar ru??dos, valores cor-

rompidos, inconsiste?ncias, redunda?ncias, ou seja, fazer uma limpeza nos dados.

Aplicou-se tambe?m de forma positiva um processo de tipificac?a?o automa?tico de varia?veis

que serve para auxiliar o usua?rio na?o especialista do dom??nio a identificar os respectivos

tipos. Este foi um dos maiores desafios do sistema devido a complexidade do problema.

Como trabalho futuro, pode-se incorporar novas te?cnicas avanc?adas para o processo de

selec?a?o de varia?veis, por exemplo, algoritmos gene?ticos, assim como, novas te?cnicas para



37

o processo de tipificac?a?o de varia?veis. Ale?m disso, definir novos crite?rios para identificar

correlac?o?es e associac?o?es entre campos da base de dados.

Um aspecto positivo do E&amp;amp;P Risk IV e? a sua flexibilidade para a importac?a?o dos

dados, ou seja, permite a obtenc?a?o dos dados de diferentes formatos de fontes. Desta

maneira, outra ide?ia de trabalho futuro seria a extensa?o da ferramenta de importac?a?o dos

dados para possibilitar a integrac?a?o de va?rias fontes de dados em um u?nico reposito?rio

centralizado.



38

Refere?ncias

BARBETTA, P. A. A Estat??stica Aplicada a?s Cie?ncias Sociais. [S.l.]: Editora da UFSC,
1998.

BARBETTA, P. A. Estat??stica para Cursos de Engenharia e Informa?tica. [S.l.]: Editora
Atlas, 2004.

BUSSAB, W. de O. Estat??stica Ba?sica. [S.l.]: Saraiva, 2003.

LOPES, C. H. Descoberta de Conhecimento e Minerac?a?o de Dados. PUC-Rio de Janeiro,
1999.

ROISENBERG, M. Risk assessment of drilling and completion operations in petroleum
wells using a monte carlo and neural network approach. In: PROCEEDINGS OF THE
2005 WINTER SIMULATION CONFERENCE. [S.l.], 2005.

ROSE, P. R. Risk Analysis and Management of Petroleum Exploration Ventures.
USA: The American Association of Petroleum Geologists, 2001. (AAPG Methods in
Exploration, 12).

SANTOS, J. G. dos. SETIP - Sistema Especialista para Tipificar Dados de uma Pesquisa:
Varia?veis Qualitativas e Quantitativas. Dissertac?a?o (Mestrado) — Universidade Federal
de Santa Catarina, 2001.

SILVA, W. T. da. Anais do XXIV Congresso da Sociedade Brasileira de Computac?a?o.
[S.l.: s.n.], 2004.

THE UNIVERSITY OF WAIKATO. Weka Software. [S.l.]. Dispon??vel em:
&lt;http://www.cs.waikato.ac.nz/ ml/weka/&gt;. Acesso em: 06 jul. 2005.

YU, L. An integrated data preparation scheme for neural network data analysis. IEEE
Transactions on Knowledge and Data Engineering, 2006.


</field>
	</doc>
</add>