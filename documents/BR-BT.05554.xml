<?xml version="1.0" encoding="utf-8"?>
<add>
	<doc>
		<field name="docid">BR-BT.05554</field>
		<field name="filename">BTP_1972_15_4_06_Aplicacao_de_computadores.pdf</field>
		<field name="filetype">PDF</field>
		<field name="text">PERFURAÇÃO E PRODUÇÃO
aplicação de computadores digitais na simulação de reservatório de petróleo
Newton Reis Monteiro (*)
SINOPSE — Técnicas de simulação do_ fluxo de fluidos em meios porosos. Equações matemáticas que permitem exprimir o comportamento físictTdoTenômeno. De um modo geral, busca-se a solução através de um sistema de equações diferenciais parciais, resolvíveis por algoritmos, com uso extensivo dos recursos dosTcoínputadores digitais de grande velocidade e capacidade de memória. Esta é a primeira das duas partes em que foi dividido o trabalho para efeito de publicação.
(*) Técnico da Divisão de Produção, Departamento de Exploração e Produção (DIPEO/DEXPRO) — PETEOBBÁS.
B. téc. PETROBRAS, Rio de Janeiro, 15 (4) : 355-374, out./dez. 1972
Newton Reis Monteiro, formaão em Engenharia Mecânica pela Escola Nacional ãe Engenharia ãa Universidade ão Brasil e ãiplomaão em Engenharia ãe Petróleo pe7a Universiãaãe ãa Bahia, em convênio com o CENAP-BA, concluiu o curso ãe Matemática Superior ãa Pontifícia Universiãaãe Católica (PUC) ão Bio ãe Janeiro através ãe convênio entre essa entiãaãe e a PETBOBBAS. Tem o titulo ãe Master of Science ãa Universiãaãe ãe Stanford fU-S.A.J. Trabalhou em Engenharia ãe Beservatârio na antiga Divisão ãe Reservatórios ãa Begião ãe Proãução ãa Bahia (DIVIBES/BPBA) até 1963. Transferião para o Setor ãe Beservatórios ãa Divisão ãe Proãução ão Departamento ãe Exploração e Proãução (SEBEV/DIPBO/DEXPBO), é, atualmente, substituto ão Chefe ão Setor. Trabalha há algum tempo no ãesenvolvvmento ãe programas ãe computaãores para análise ãe reservatório ãe petróleo, principalmente, tenão parti-cipaão na elaboração ão primeiro simulador numérico ãe reservatório desenvolvido na PETBOBBAS. É assessor ãa área ãe proãução ão Departamento ãe Exploração e Proãução (DEXPBO) junto a este periódico e, na qualidade ãe Full Member, fas parte ãos quadros ão American Institute Mining Metalurgicall Engineers (A.I.M.E.).
1 — INTRODUÇÃO
A Engenharia de-Reservatórios é uma eiêneia relativamente nova; tendo tido seus fundamentos práticos desenvolvidos nos países teenologieamente adiantados, somente após a 2» Guerra Mundial, na década de 40. Ela trata da ocorrência e movimento de fluidos em reservatórios, com a finalidade de maximizar sua obtenção na superfície. Engloba, com efeito, um estudo detalhado dos fatores que afetam a recuperação de óleo e gás para de- • terminar o mais eficiente e lucrativo método de produção, levando também em consideração as condições político-econômicas vigentes.
Existem dois procedimentos para produzir ou recuperar o petróleo de uma jazida natural, tecnicamente conhecida como reservatório: (1) por recuperação primária, quando se utiliza apenas a energia expulsiva natural do reservatório, ou (2) por recuperação secundária, em que à energia natural se procura adicionar uma energia exterior, o que se obtém geralmente por injeção de água ou de gás natural. A técnica da recuperação primária, única adotada nos primeiros 70 anos de vigência da indústria de produção-de petróleo, é mais intuitiva e não requer investimentos adicionais, mas conduz à recuperação de uma percentagem do óleo que, via de regra, não alcança senão índices bastante reduzidos. Com a técnica da recuperação secundária tais índices podem ser grandemente aumentados, o que requer, de um lado, um estudo tecnológico complexo sobre os mecanismos artificiais a introduzir, e, de outro, um investimento adicional de importantes proporções. A escolha adequada do procedimento de recuperação a ser adotado requer, obviamente, planejamento baseado em coleta sistemática de dados e no desempenho de modelos físicos e matemáticos que conduzam às soluções mais convenientes, quer do pon
to de vista técnico, quer, prineipalmente, do ponto de vista econômico. Tal é a finalidade da Engenharia de Reservatórios — hoje considerada como a ciência-chave da produção de petróleo.
Suas armas são a eiêneia da transmissão de fluidos através de meios porosos, a análise numérica de sistemas de equações diferenciais parciais não--lineares, a pesquisa operacional e a análise de riscos, ramos esses que só com o advento do computador eletrônico de grande capacidade de memória e alta eficiência operacional puderam ter acelerado seu desenvolvimento e, por conseguinte, aplicação eficaz e em tempo hábil, com decorrente melhoria nos sistemas periféricos. O presente trabalho é uma tentativa de apresentar de maneira acessível e clara os fundamentos da Engenharia de Reservatórios e, principalmente, de mostrar — tomando por exemplo um caso simples — como são empregados os computadores eletrônicos na resolução de seus problemas. Terá atingido o seu objetivo se mostrar a sua necessidade e importância, suas fi-dificuldades e perpectivas.
2 — RESERVATÓRIO DE PETRÓLEO
2.1 — DEFINIÇÃO DE RESERVATÓRIO
DE PETRÓLEO
Uma camada de rocha permeável contendo petróleo e “selada” por camadas superiores e inferiores impermeáveis, que assim isolam o conteúdo da camada permeável, constitui o que chamamos, de um modo geral, de reservatório de petróleo. Esses reservatórios podem resultar de condições estruturais (dobramento ou falhamentos) ou condições estratigráfieas (camadas permeáveis de rocha dentro de camadas impermeáveis). Pela definição pode-se depreender que um mesmo campo é capaz de apresentar mais de um resarvatório- de petróleo.
B. téc.- PETROBRAS, Rio de Janeiro, 15. (4) : 355-374, • out ./dez. ...1972
2.2	— TIPOS E FORMAS DE
RESERVATÓRIOS
Muitas propostas têm sido apresentadas no sentido de classificar as diferentes configurações dos reservatórios de petróleo, sendo a mais simples (1X) a que separa os reservatórios de acordo com as características geológicas que causaram seu aparecimento. Essas características são:
(1)	Dobramento estrutural;
(2)	Estruturas falhadas;
(3)	Estruturas com deseontinuidade de deposição de sedimentos:
(4)	Estruturas formadas por movimentos internos de materiais da crosta terrestre, tais como domos salinos ou incrustações de serpentina;
(5)	Mudanças de permeabilidade dentro de uma camada;
(6)	Combinações de duas ou mais das características acima, o que constitui o tipo mais comum de reservatório.
As figuras 1 e 2 são exemplos do tipo (1); a figura' 3 é um exemplo de reservatório do tipo (2); a figura 4 exemplifica o tipo (3); as figuras 5 e 6 exemplificam o tipo (4) e, finalmente, a figura 7 ilustra um reservatório do tipo (5).
2.3	— CARACTERÍSTICAS DAS ROCHAS-
-RESERVATÓRIO
a)	Porosidade — O volume vazio existente entre os grãos de uma camada rochosa é chamado de espaço poroso. Nos espaços porosos da rocha-reser-vatório ocorre a acumulação de óleo e/ou gás. O espaço poroso, ou porosidade da rocha, dá à mesma a propriedade de absorver e reter fluidos. A porosidade é medida em percentagem, do -volume total de rocha.
b)	Permeabilidade — O maior ou menor grau
de dificuldade experimentado por um fluido ao escoar através de espaços porosos interconectaãos reflete o grau de permeabilidade da rocha. A rocha é mais permeável quando os fluidos se escoam através de seu interior eom maior facilidade. É um fenômeno similar ao escoamento através de oléodu-tos ou aquedutos, onde os mais largos e mais reti-líneos permitem aos fluidos escoar mais facilmente. Embora podendo apresentar boa porosidade, muitos rochas são impermeáveis ao movimento de água, gás ou óleo. A permeabilidade depende da interligação dos poros, razão pela qual rochas de poros não interligados apresentarão baixa permeabilidade; Exemplos típicos são: giz, anidritos e alguns arenitos altamente cimentados. .	■&amp;lt;-/■
■ Quando se considera a permeabilidade da-roeha, dêvemós,'imediatamente, pensar em termos da força que provoca o escoamento do fluido através da rocha. Essa força provém da pressão — do mesmo modo que em um tubo se aplica a pressão para
forçar o movimento de líquidos ou de gás em seu interior.	.......
Em 1856 o engenheiro francês Henry Darcy (7) realizou testes em filtros de água, e de. seu trabalho foram retirâdas-iconclusões importantes para o estudo da facilidade do escoamento de fluidos em rochás porosas . -Darcy concluiu que a vazão de um fluido através de uma dada rocha.varia_direta..e proporeionalmente à pressão aplicada, e varia inversa e proporeionalmente à viscosidade do fluido. O fator de proporcionalidade é o que denominamos permeabilidade, que é medida em darcies. Um arenito com 1 darcy de permeabilidade é definido como um arenito no qual a vazão de 1 cm3 de um fluido com viscosidade de 1 centipoise (viscosidade da água à aproximadamente 15,5° C) escoa em 1 cm de arenito através de uma seção transversal de 1 cm2, no tempo de 1 segundo, sendo’que a diferença de pressão através do comprimento é de 1 atmosfera. A figura 8 ilustra.a definição.
Rochas-reservatório dotadas de uma permeabilidade média da ordem de 1 darcy são raras, por isso é usual o emprego de milidarcies (1 milésimo de darcy) como unidade prática de permeabilidade. .
Pára - fortalecer .a compreensão do conceito de permeabilidade e ilustrar sua importância como parâmetro importante na produção de petróleo, podemos dizer que em. um poço cuja roeha-reserva-tório tem a espessura de 3 metros com 1 darcy de permeabilidade seria possível obter a produção de cerca de 150 barris de óleo por dia, com a pressão no interior do poço sendo de apenas 1 kg/cm2, inferior à existente dentro da rocha-reservatório.
c)	Permeabilidade Relativa — Tal como foi descrito anteriormente, a permeabilidade é a medida da facilidade do escoamento do fluido através dos espaços de uma rocha-reservatório. Todavia, devido ao fato de termos às vezes mais de uma fase fluida escoando simultaneamente na rocha — gás, óleo e água —, devemos levar em conta as relações de permeabilidade relativa de cada fase, a qual é a medida da facilidade com que uma fase, dentre duas ou mais presentes, escoa, ao ser comparada com a facilidade com que essa mesma fase flui quando somente ela está presente no meio poroso. Por conseguinte, a quantidade de cada fase fluida presente nos espaços porosos,— o que denominamos de satiiração da fase — controlará também o movimento do fluido e, desse modo, também as relações de permeabilidade relativa das fases na rocha-reservatório.	-
3	— SIMULAÇÃO DÉ RESERVATÓRIOS DE PETRÓLEO&amp;lt;
3.1	— SUA NATUREZA E PROCEI)ÍMENTO-
A simulação numérica usando computadores digitais é um novo instrumento para o estudo de reservatórios de petróleo. As diversas funções da En-
357i
oLeo
FIj. i- o'leo acumulado numa estrutura tipo domo .
Fig.Z- CÍLEO ACUMULADO NUMA ESTRUTURA TIPO ANTICLINAL
Fig. 3-ACUMULAÇÃO ESTRUTURAL RESULTANTE DE FALHAMENTO
Fig. 4-ACUMULAÇÃO DE OLEO EM DESCONTINUIDADE
ver a taxa de recuperação a ser obtida.
Para avaliar as reservas é necessário estimar 0 volume total da jazida, 0 que pode ser executado através de informações geológicas, análises de testemunhos da roeha-reservatório obtidas durante a perfuração dos poços, perfilagem elétrica, etc. O volume total da jazida pode também ser estimado pelo estudo do comportamento da pressão e volume do reservatório, para isso se usando várias técnicas matemáticas complexas, e variáveis de caso para caso, indieadas na figura 9 pela etapa representada pela pitoresca expressão “Caixa Preta”.
Essas mesmas técnicas ajudarão também a determinar 0 mecanismo do reservatório, permitindo diferençar um mecanismo de exaustão natural (de-pleção) do mecanismo de expansão da capa de gás, infiltração de água etc.
ENGENHARIA DE RESERVATÓRIOS
ESTIMAR
VOLUMES
I
DETERMINAÇÃO 00 MECANISMO
/cAIXA PRETA ______
]
	
	CALCULAR 0 FATOR DE RECUPERAÇÃO
	
	
ESTIMAR.AS RESERVAS^
PREVISÃO DA \
TAXA DE j RECUPERAÇÃO j
Fig. 9
Conhecendo-se .0 tipo de mecanismo pode-se chegar ao fator de recuperação aplicável ao reservatório. A aplicação desse fator ao volume da jazida fornece as reservas do reservatório.	-
3.1.1 — CAIXA PRETA
Seu objetivo é achar um simulador que verifique a performance passada do reservatório. Isso feito
esse simulador poderá ser usado para a previsão da performance futura.
Várias técnicas de simulação existem atualmente. Elas diferem no que diz respeito à aplicação e no grau de sofisticação empregado. A figura 10 apresenta algumas técnicas possíveis e que têm sido usadas com variado grau de sucesso.
As curvas de declínio são gráficos de vazão de produção versus tempo ou produção acumulada, usando-se diferentes escalas.	■
Usualmente uma linha reta é traçada e extrapolada para dar uma recuperação final e a taxa de recuperação. A figura 11 ilustra uma típica curva de declínio.
As curvas de declínio usam somente vazões de produção e prestam relativamente pouca' atenção para as pressões do reservatório. Uma mudança no mpdo de operação do campo poderia alterar a inclinação da curva de declínio, 0 que revela facilmente a fraqueza do método. Daí serem usadas principalmente para poços isolados cuja produção esteja de certa maneira chegando ao fim.
Onde npi = Recuperação final estimada. . Ta = Tempo estimado para abandono das operações.
Fig. 11.
Em estudos de Balanço de Materiais (s) considera-se o comportamento pressão-volume do reservatório inteiro. Admitindo-se originalmente na jazida uma dada quantidade de óleo — estimada através de cálculos volumétricos —, deixa-se a pressão variar de acordo com o volume de fluido retirado. Esse declínio é comparado com o comportamento de pressão realmente observado, e, se necessário, a estimativa do volume de óleo originalmente na jazida é modificada até que um perfeito ajuste seja obtido entre o volume estimado e o calculado. Na presença de influxo de água (water drive) devemos incluir variáveis adicionais para permitir a simulação desse fenômeno.
Também têm sido usados, nesses casos, computadores analógicos (s) para simulação do. comportamento do influxo de água em regime transiente, água essa proveniente de um aqüífero ou de injeção.
Com o objetivo de estudar o deslocamento de fluidos imiscíveis várias técnicas e modelos têm sidó empregados. Buckley e Leverett(s), engenheiros americanos, desenvolveram uma teoria que analisa esse problema usando variações em saturações e-permeabilidades relativas. Antes- do advento de computadores digitais de grande porte e eficiência operacional, essa técnica era a de maior utilização pelos engenheiros de reservatórios. Todavia, a mais nova e poderosa técnica no campo de modelos físicos para engenharia de reservatórios é a utilização de modelos numéricos de. simulação (3) operados em.computadores digitais ,o que, em síntese, constitui-se no objetivo primordial desse artigo,
3.2	— NATUREZA	'
Na simulação numérica de reservatórios de petróleo (3) escrevem-se as equações fundamentais de fluxo de fluidos em forma de equação diferencial parcial para cada uma das fases presentes. Essas equações 'diferenciais parciais são obtidas combinando-se os princípios fundamentais da Física, .que, via de- regra, são usados em qiialquer ramo de ciência. Os princípios físicos básicos podem ser sintetizados do seguinte modo (10):
1)	Balanço de massa	■
2)	Equações de fluxo
3)	Balanço de energia
4)	Expressões de equilíbrio
5)	Balanços de quantidade de movimento
Os três balanços são também conhecidos como equações de continuidade.	-	-	■	.
No nosso caso, combinando as equações de continuidade, equações de fluxo e equações de estado, estas últimas não representando princípios físicos fundamentais, obtém-se uma’ equação diferencial parcial não linear (4 e 10), cuja solução analítica ainda não foi descoberta. Na Engenharia-de -Petróleo a equação de continuidade expressa' a conservação da massa. Para a maioria das condições de fluxo através de um meio poroso a equação de fluxo é a equação de Darcy (7). A equação de estado consiste em uma descrição das relações pressão-vo-
o I----1----í---*----1---1----1---*----1........ -..-1---1---1
O	DISTÂNCIA ( km ) -----«*-	X
o = Poços produtores de fluidos. 0 = Poços injetores de fluidos.
Fiff. 12.	..........
lume ou pressão-densidade para ás várias fases fluidas presentes.	.....: .	'	' ' - -
Posteriormènté essas equações diferenciais parciais são escritas em forma de diferenças finitas, tanto em espaço como-em tempo (1X e 5).	- - '
Uma malha de diferenças finitas- tem o aspecto mostrado na figura 12.	-	' - ■■
Para cada ponto ou' nó da malha é alocado um valor para a permeabilidade, espessura de rocha, porosidade, conteúdo de fluido, profundidade e pressão.
Para os fluidos existentes em cada nó da malha são atribuídos valores para viscosidade, fatores volumes de formação, razão gás/óleo de solução e densidade. A seguir se atribui um valor para a compressibilidade da rocha. Assumem-se as vazões de produção para, uma das fases fluidas presentes nos diversos poços do reservatório.
Então, para uma diferença finita de tempo (intervalo de tempo), novas pressões são ealculadas; As vazões de cada fase produzida por poço são calculadas a partir dos valores de saturação existente em cada ponto do sistema de malha. Esse procedimento é repetido para - um - determinado número de intervalos de tempo; desse modo, tanto o histórico de produção como o de pressão são. calculados para cada poço dentro do sistema. Queremos salientar que os fatores volumes de formação das fases bem como as razões gás/óleo de solução provêm de equações de estado, predefinidas para cada tipo de fase.	.......
3.3	— DADOS DE ENTRADA NO
.. SISTEMA (INPUT)
Para cada nó no sistema de malha necessitamos dos seguintes valores:
■ — Permeabilidade
— Porosidade
- —— Espessura ' '	■
— Profundidade'-"- '•
— Dimensões da malha
— Saturação inicial de cada fase
— Pressão inicial
— Compressibilidade da rocha
K — (md) .
&lt;/&gt; :— (fração) ’ h — (m)	■	.
--Z-— (m) ■
Ai — (m)
Si — (fração) Pí — (kg/cm2)
Cr—(vol./vol./kg/cm2)
As características dos fluidos são derivadas das seguintes relações:	. .	.	: • ■
Fator volume de formação do óleo (Bo) ver' - sus pressão (P kg/cm2). •	. -
— Fator volume de formação do gás (Bg) versus pressão.	■
— Fator volume de formação de água (Bw) versus pressão (os fatores descritos acima são adimensionais).
— Viscosidade do óleo, água e gás. (centipoise).
—• (Rs) — Razão gás/óleo de solução uersus pressão.
—	(Rsw) — Razão gás/água. de solução versus
pressão.	.	.
—	(po) — Densidade do óleo (g/ení3)
—	(pa) — Densidade da água (g/em3)
- — (í?g) —Densidade do -gás .(g/em3)	■
■ As forças de atração e repulsão entre rocha e ‘ fluidos no reservatório são .dadas pelas relações citadas a seguir, sendo que todas são funções da saturação da fase fluida no ponto considerado:
—- Permeabilidade relativa de cada fase (Kr,).
— Pressão Capilar entre óleo e água (PCO,W);
— Pressão Capilar entre gás e óleo (Pcg,0).
Outros dados adicionais provêm dos poços e incluem: intervalo produtor, vazão de produção de óleo versus tempo, vazão de produção de água versus tempo, vazão de produção de gás versus tempo, pressões observadas nos poços versus tempo, etc.
3.4	— APLICAÇÕES PRÁTICAS
É provável que a mais conhecida aplicação da simulação numérica de reservatórios de petróleo seja a levada a efeito na ajustagem ou verificação da performance passada de um reservatório, para utilizar os resultados na previsão do eompor--tamento futuro. Durante a' fase de ajustagem {matching) do histórico de pressão-produção do reservatório, devemos, é claro, empregar os melhores dados disponíveis para, todos os itens citados no parágrafo anterior.
Injeialmente colocam-se ..os poços para produzir nas vazões medidas' durante o histórico, considerando-se as vazões de cada uma das fases; então o comportamento de produção e vazão das fases’ remanescentes são calculadas. Tais pressões e vazões são. comparadas com os valores observados no reservatório. Algumas vezes essas comparações são feitas com • o . auxílio, de • gráficos. A. comparação entre os valores calculados e observados .fornece uma indicação da precisão dos dados iniciais de entrada. Outras'vezes torna-se necessário modificar alguns “dados” de entrada até que o ajuste ■entre os comportamentos calculado é observado possa ser classificado dentro de uma tolerância pre- estabelecida. Não existe nenhuma regra rígida para indicar quando um bom ajuste é encontrado.
0 número de vezes que o programa simulador é processado depende da complexidade . e do . tempo da performance passada que se. pretende ajustar. Desse. modo, a “caixa preta” obtida apresenta usualmente um elevado grau de sofisticação, quando, afinal, é considerada em condições de ser usada para prever o comportamento futuro de um reservatório.
Na fase de previsão, temos a liberdade de estabelecer vazões de produção para todos os poços ou para o campo inteiro,- ou ainda estabeleeer uma vazão de produção a ser mantida até que a pressão do reservatório caia abaixo .de um certo valor pre-estabelecido, quando então tem início.uma.injeção de água ou gás em lugar adequado no reservatório. Por conseguinte, podemos estudar o comportamento futuro do reservatório seguindo uma série de esquemas hipotéticos, os quais, combinados com uma avaliação econômica apropriada, permitem a seleção do melhor esquema de produção para o reservatório — ou seja do esquema teoricamente mais eficiente — esquema de produção para o reservatório .	’
3.5	— RESTRIÇÕES
Nesse ponto torna-se necessário introduzir uma palavra de cautela para evitar o uso inadequado do simulador, o que conduziría a resultados nem sempre agradáveis ao engenheiro e prineipalmente àqueles que erêem que o computador é infalível. Nunca devemos esquecer que o simulador foi ajustado para um certo tipo de histórico de pressão--produção — por exemplo: depleção em taxas moderadas. Não devemos confiar na precisão dos resultados do simulador se, subitamente, o mecanismo atuante for alterado para uma injeção de água sem que o histórico leve em conta tal injeção. Do mesmo modo, se de repente o reservatório passa a produzir com vazões muito elevadas, tais que a pressão caia abaixo da chamada “pressão de saturação” {bubble point pressure), quando o gás em solução no óleo começa a ser liberado, e se o ajuste da performance passada considerou as pressões sempre acima da pressão de saturação, os resultados da previsão devem ser considerados como duvidosos. A prática nos ensinou que não devemos fazer previsões para períodos maiores do que o dobro do utilizado no ajuste da performance passada supondo condições similares de operação.
3.6	— APLICAÇÕES COMPLEMENTARES
Embora os modelos numéricos para reservatórios tenham sido desenvolvidos para estudar o comportamento do reservatório como um todo, eles têm muitas outras aplicações. Seções representativas de reservatórios podem, ser analisadas útilizãndo-se os-melhores valores disponíveis "para as variáveis, o que nos permite caracterizar seu mecanismo. Então, alguns parâmetros podem ser variados de maneira a avaliar o efeito que eles causam no mecanismo do reservatório como um todo. Desse mo
do, é possível determinar quais parâmetros necessitam melhor apreciação para um ótimo entendimento da performance do reservatório.
. Modelos de reservatórios podem ser usados para o estudo de problemas específicos de um determinado poço, tais como crescimento ou abaixamen-to de pressão decorrente de testes, comportamento das razões gás/óleo, água/óleo no histórico de produção (10).
Os modelos de reservatórios têm aplicação também em estudos de cones de água (Figura 13) e/ou gás (Figura' 14).
Finalizando essa relação de aplicações, podemos ainda nos referir ao auxílio mútuo que esses modelos exercem na avaliação de estudos de laboratórios. Como os simuladores de fluxo de fluidos re-
POÇO
Fig.l3-EXEMPL0 DE CONE DE A'GUA NUM POÇO
POÇO
Fig. 14-EXEMPLO DE CONE DE GAS NUM POÇO
solvem, em sua essência, as equações fundamentais do fluxo em meios porosos, é possível analisar-se o resultado de trabalhos realizados em testemunhos sujeitos à lavagem por diferentes fluidos, estudos de embebição, etc.
4	— EQUAÇÕES DIFERENCIAIS PARA SIMULAÇÃO DO FLUXO EM RESERVATÓRIO
Por simulação de reservatórios queremos nos referir à determinação do comportamento real de um reservatório, a partir dos resultados obtidos num modelo desse reservatório. O modelo pode ser tanto físico (ex.: construído em laboratório) como matemático.
Um modelo matemático de qualquer sistema físico é simplesmente um sistema de equações descrevendo os processos físicos que ocorrem no sistema em estudo (3- -■ x). Esses processos, no caso de reservatórios de petróleo, são basicamente constituídos por fluxo de fluidos e transferência de massa. Até três fases imiseíveis podem escoar simultaneamente enquanto uma dessas, o gás, proporciona transferência de massa principalmente com a fase óleo. A gravidade, a capilaridade e as forças de viscosidade, todas combinadas, desempenham uma importante função no processo de fluxo de fluidos.
As equações do modelo devem levar em consideração essas forças e também levar em conta a configuração aleatória dos reservatórios, no que diz respeito à heterogeneidade e geometria.
As equações, de um modo geral, podem ser consideradas como uma balanço de massa — run balanço para cada fase que esteja fluindo. Se as pressões e saturações forem consideradas uniformes através de todo o reservatório, então o “Balanço de Materiais” (9) anteriormente descrito é suficiente. Entretanto, se ocorrer que essas variáveis tomem valores diversos em cada ponto do reservatório, o resultado é um sistema de equações diferenciais aplicáveis a cada ponto (x, y, z) dentro do reservatório e em qualquer tempo t (2- 3- 6- 7).
4.1 — EQUAÇÕES DIFERENCIAIS PARA FLUXO MONOFÃSICO (3)
No estudo de fluxo de qualquer espécie — calor, fluidos, eletricidade —, o sistema matemático é obtido aplicando-se simplesmente o princípio da conservação. Esse princípio elementar estabelece que nenhuma quantidade física pode ser criada ou destruída.	. .
,4.1.1 — EQUAÇÃO DA CONTINUIDADE	.
A continuidade é a expressão matemática da lei de conservação de massa. Ela pode ser desenvolvida considerando-se o fluxo de fluido através de um sólido elementar de dimensões Ax, Ay e
Fig.15- EM COORDENADAS RETANGULARES
Az, com arestas paralelas aos eixos x, y e z, como ilustrado na figura 15.
Para esse sólido elementar podemos escrever o balanço de massa na forma seguinte:
(entrada de massa — saída de massa )+ geração de massa = acumulação de massa. (1)
Na face x do cubo, a velocidade do fluido e a densidade do mesmo são vx e px, respectivamente. Na face x + Az do sólido, a velocidade e a densidade são di+aí e Px+Ax- Similarmente para as outras faces paralelas aos planos z — x e a; — y, teremos velocidades e densidades definidas como vy, vz, Pyi Pz O ^y+àyi Vz + Azi Pv+&amp;amp;y 6 Pz+kz* Alem díSSO, considera-se a massa produzida M, massa essa expressa em massa por unidade de tempo e por unidade de volume.
Com essas definições, a lei de eonservação da massa pode ser estabelecida a partir da equação (1). A quantidade de massa que entra no elemento durante um intervalor de tempo Ai é:
px vx ày àz àt + pyvy Az Ag Ai + pzvz Az Ay àt.
A quantidade de massa deixando o sólido elementar durante esse intervalo de tempo é:
Pz-r ú.z Vz-r àz ày Ag Aí -|- Py+ Ay Vy+ Ay Az Ag Aí -f-
*i~ Pz t-Az ^z+Az Az Ay Aí.
Nesse mesmo intervalo de tempo, a quantidade de massa retirada (ou acrescentada) do elemento será:
M (z, y, g, í) Az Ay Ag Aí.
A diferença entre as quantidades de massa que entra, sai, e a retirada, constitui a acumulação de massa;
(^,y, z.fi+Ai Pz, y, z,£+At&amp;lt;j&gt;z,y, z,t Pz,y,z,Ò Áz Áy Ag Aí, onde 0 é a porosidade.
Substituindo essas expressões na equação (1) e dividindo tudo por Az Ay Ag Aí, tomando os Emites quando Az, Ay e Ag se aproximam de zero, e lembrando que:
teremos,
= - 4 (*P)	(2)
Ou, usando o divergente,
Q
v. (pv) d- AT(x, Vl z, o = Qt (4&gt;p)	(3)
que é a equação da continuidade em coordenadas retangulares e incluindo um termo de geração (fonte ou sumidouro).
A equação (3) é utilizada para a obtenção da equação diferencial que descreve o movimento de fluido num meio poroso. Para isso é necessário conhecermos a equação de fluxo adequada à determinação de velocidade em (3) e também conhecermos uma equação de estado que descreva a dependência da densidade do fluido em relação à pressão.
A equação de fluxo resulta das experiências de Henry Darcy (3), e. é Darcy”.
Vz = -
«1/ = ~
conhecida como L&amp;amp;t. de		
K		(4)
P	dx	
k	dí	(5)
—		
p	dy	
Nessas fórmulas, k é a permeabilidade efetiva e que pode ser diferente nas três direções coordenadas.
y é a viscosidade do fluido.
ó é o potencial do fluido.
Quando o fluido é compressível, o que ocorre comumente na prática, o potencial&amp;lt;j&gt; é definido pela expressão:
® = f^+gh	(7)
P
(2, 9, 10)
: Ó potencial como acima definido ê a expressão do trabalho realizado para deslocar uma unidade de massa fluida de um nível arbitrário, até uma' altura h, considerando-se as energias de compressão e potencial, desprezando-se as energias einéti-ea è eletrõ-química.
Esse potencial é definido pana cada uma das fases presentes no meio poroso. As equações de estado utilizadas para relacionar densidade e pressão são definidas normalmente em função dos fatores volumes de formação anteriormente citados, e também da compressibilidade da fase. Sem entrar em maiores considerações, estabelecem-se as seguintes.relações de dependência:
Já havíamos dado, no item 2.3 parágrafo c) os conceitos de permeabilidade relativa de cada fase, bem como o de saturação da fase. Naquela oportunidade havíamos salientado que a permeabilidade relativa de cada fase era uma função do conteúdo das fases presentes (saturações) bem como da permeabilidade que o meio apresenta para a fase quando somente ela estivesse escoando. Assim, para óleo, gás e água podemos definir permeabilidade relativa' como:
kT0 ^f(S0'Sw)	1	(12)
kT0 = f (So'Sw)	1	(13)
km = f (So&gt; Sw)	1	(14)
(8)
onde o subscrito s significa condições standard.
Pw
Pws
Bw
(9)
e finalmente a densidade do óleo dada pela equação abaixo, onde Rs, conforme citado anteriormente, é uma medida da solubilidade do gás no óleo e também uma função da pressão.
Nessas equações, So e Sw representam as saturações de óleo e água, respeetivamente, e juntamente com a saturação de gás, denotada como Sg, preenchem o espaço poroso de elemento de reservatório. Como essas saturações são dadas, na prática, como fração do volume ocupado, por cada uma das fases no elemento de reservatório, infere-se facilmente que:	■
So + Sw -j- Sg = 1	(15)
Po =
Pos d~ Es . Pgs
B~o
(10)
O conceito de saturação permite, por conseguinte, separarmos as massas de cada uma das fases presentes no elemento de volume do reservatório. Assim, a massa de óleo é dada por:
Outra equação de estado cujo emprego é dé importância a que define a compressibilidade de um líquido ligeiramente compressível. Essa compressibilidade é definida para condições isotérmicas e sua relação de dependência se expressa pela equação:
a massa de água por
0So
Bo p°3
(16)
- JL
p dp
(11)
4&gt;SW
p p«»
■t$w
(17)
As equações de (3) a f1,1) permitem, quando eombinadas para cada fase, que se obtenha a equação diferencial parcial que descreve o fenômeno físico do escoamento em meio poroso, para a fase em consideração. Isso será apresentado a seguir.
e a massa' de gás por
0 Rs Pgs Sg
Bo- ■
(18)
4.2	— SISTEMA DE EQUAÇÕES DIFEREN-
■ CIAIS PARA FLUXO MULTIFÃSICO
Em um dado instante, um volume elementar do reservatório conterá um certo volume de gás, óleo e água, os quais, quando reduzidos às condições standard, serão modificados como em consequência da solubilidade do gás no óleo e na água, bem como devido à compressibilidade de cada fase. Como definido -anteriormente, o. fator de solubilidade do gás Rs é a razão entre um determinado volume de óleo e o volume de gás dele liberado (tudo referido às condições-padrão) e esse volume de óleo. Essa mesma definição é estendida para a solubilidade do gás na água', sendo Rsw o termo usado para denotá-la.
onde foram consideradas as massas de gás em solução na água e no óleo.
Usando então a lei de Darcy podemos escrever as expressões para o fluxo de massa de cada uma das fases como:
para o óleo,
poVo= _	(19)
para a água,
'	' ..	' k-km pax - ■ , -	■ -• ■
pwvw =-----------— V&amp;lt;pw ... (20J
Pw ™w
.para o gás,
Pb vb
k kTg Pgs Pg Bg
V&lt;£0
v&lt;f&gt;g
Jc kro RS PgS Po Bq
(21)
Combinando as equações (3) e de (16) a (21) e fazendo algumas simplificações algébricas, obteremos as equações (22), (23) e (24), que constituem a- base do sistema físico que representa o escoamento de três fases: distintas em um meio poroso.
Fase óleo:
/ k kT0
\ PoBo

V •
(22)
Fase água:
(
k krw V&amp;lt;í&gt; „
pw Bw
V •
G dt
(23)
Fase gás:
V •
+ V
V$g\ \ PgBg )
Z k kT0 Rs X7 X \ Po Bg )
+ (24) Qo, Qw e qg sendo vazões volumétricas (injeção ou produção) em cada ponto onde houver uma fonte ou sumidouro.
Considerando a equação (15), &amp;amp;&gt; + Sw + Ss = = 1, também, assim, ficamos com um sistema de equações diferenciais parciais altamente não-linea-res com três equações e cinco incógnitas, respectivamente $0,&amp;lt;£&gt;„, í&gt;ffJSweS0. O processo de redução a três incógnitas e a' determinação das incógnitas mais convenientes para serem retidas dependerão do método de solução (°- 4).
Além da equação (15), um outro fenômeno físico que ocorre quando do escoamento multifásieo de fluidos em meios porosos permitirá uma redução no número de incógnitas das equações (22), (23 e (24)-.- Trata-se da. pressão capilar.
Como se sabe, pressão capilar é a pressão eor-respondnete à força por unidade de área resultante. da interação de forças interfáeiais entre líquidos, gases’e ó meio no qual coexistem. Devido a
. esse fenômeno, as pressões nas fases óleo, gás e água são diferentes. Na prática, duas pressões capilares independentes podem ser definidas:	’
Pressão capilar - óleo/água:
Bgow ~ Po Pvj	(25)
Pressão capilar gás/óleo:
Pego = Pg- Po	(26)
Como existem muito poucos resultados experimentais sobre pressão capilar considerando três fases; é necessário' obter estimativas sobre as mesmas, a partir dos resultados medidos, usando duas fases — isto é: os subsistemas óleo/água e gás/ óleo. As medições de pressão capilar são feitas em laboratório, usando-se testemunhos das rochas-re-servatório em estudo, e seus resultados são dados como função-das saturações de fluidos’presentes, tendo como parâmetro controlador principal a permeabilidade do meio.	-
De posse dessas correlações é possível diminuir o número de incógnitas, expressando run potencial em função de outro.
Como o objetivo fundamental do simulador de comportamento de reservatórios é encontrar o modelo matemático capaz de resolver os problemas encontrados no histórico de pressão-produção do campo, ajustando-o dentro de um determinado nível de tolerância, para depois extrapolar o comportamento futuro do mesmo, pode-se facilmente avaliar a complexidade do problema pelo sistema de equações (22), (23) e (24), que, com o auxílio das correlações (15), (25) e (26) deve ser resolvido para cada ponto de reservatório.
5	— DIFERENÇAS FINITAS PARA EQUAÇÕES DIFERENCIAIS
.5.1 — FORMAS DE DIFERENÇAS FINITAS-
A solução numérica, de uma equação diferencial parcial nada mais é ’do que o processo de resolução de uma' representação em diferenças finitas da equação diferencial. Essa representação é obtida substituindo-se todas as derivadas por formas de diferenças finitas, as quais podem ser facilmente deduzidas, a partir da expansão em série de taylor, da variável dependente. Se uma função y (z) e todas as suas derivadas existem no ponto aj0, então y (z) pode ser expandida em série de Taylor como:	.
y H - y (ac) -Ha - x.J ;/ (a0) +	// •	+'
eôm a notação yi = y (z0 + i Az), a equação aci-mapode ser escrita,
yi = Vo + Axy'o	+-^ya"-+ ... (27).
e também,
y-i = y0- Axy'o + ^-y"o - yo" + • ■ ■ (28)
Se As é pequeno, os termos de ordem superior a 3 em As podem ser ignorados, e a equação (27) pode ser escrita como:
y'° =	+	(29)
o que se constitui numa forma de diferença finita para a derivada primeira no ponto xa.
dx
Subtraindo (28) de (27) teremos:
então, combinando-se (27), (28), (32) è (33) teremos:
(34)
A representação (34) é, todavia, raramente usada devido ao grande trabalho computacional que envolve.
Resumindo, podemos dizer que as formas mais usuais para as derivadas primeira e segunda, em qualquer ponto z = íAz, são:
dy dx	2/f+i - Vi 	 Vi ~ Vi-i Az	Az	(35)
dy dx	2/í+i ~ Vi-i 2 Az	(36)
d2y	2/í+i ~ 22/í + 2/í i	(37)
dx3	Az2	
= +0 (Áa;2) (30)
que é uma forma alternativa para a derivada primeira em termos de diferenças finitas. Comparando as equações (29) e (30) vê-se que o erro de truncamento é da ordem de As em (29) e A®2 em (30). Por conseguinte, a última expressão fornece uma representação mais precisa para' a derivada primeira.
Somando (27) e (28) obtemos uma forma em diferença finita para a derivada segunda.
onde yi = y (i A®)
Uma outra aproximação para a derivada primeira é obtida escrevendo o desenvolvimento de Taylor, por dois modos diferentes, primeiro considerando z = zo + J Az e depois com z = z0 — % Az. Subtraindo os dois resultados obtemos:
dy
dx
yi+i yi^ri Ax
(38)
yo
yi - 2y0 + 7/-1
Az2
+ 0 (Az2)
(31)
z = i Ax
Essa forma é muito útil para expressar em forma ò d
de diferenças finitas o termo K (z) o qual
Uma representação ainda mais precisa poderia ser obtida de modo semelhante ao realizado para a equação (30) escrevendo-se
freqüentemente aparece nas equações dos simuladores de reservatório de petróleo. Usando a equação (38) este termo se representa por:
y2 = yo + 2AZ7/0'
,	, 8Az*y0"'
' 2! + 3!
+
ôA (z) dp dx dx
Ax
(39)
+
16 Az4 ylv 4!
(32)
Da' mesma forma:
y-2 =?/o — 2 Axy? +
4 Az2 2/0"
21
, 8Ax3y0"'
-----—---
+
+
16 Az4 2/or 4!
(33)
Substituindo as equações (41), (40) em (39) teremos finalmente:
d K dp = K1+1 pi+1 - (Ki+ j + Kj - è) Pi + dx ' ãx	Ax2
_ + A- i-| Pi-i
Ax2	k ‘
Esse tipo de desenvolvimento é o mais comu-mente utilizado nos sistemas de equações diferenciais do tipo parabólico como representado pelas equações (22), (23) e 24).
6	— ELEMENTOS SOBRE FORMAS EM DIFERENÇAS FINITAS DOS TIPOS EXPLÍCITO E IMPLÍCITO
Nas discussões sobre solução numérica de equações diferenciais parciais, os termos “explícito” e “implícito” aparecem freqüentemente.
Neste resumo daremos uma breve explanação dos mesmos no que se refere às equações diferen-- ciais parabólicas que constituem em síntese o alvo de toda essa digressão.
Seja a equação
d2p _ dp_
dx2 dl
(43)
a qual suponhamos válida numa região definida por:
0 &amp;lt;x &amp;lt;X
0 &amp;lt;t
e cuja' representação no nosso sistema de malhas é dador por,
x = íAx , 0 &amp;lt;i &amp;lt;I, onde I = X
t = j M
onde Ax e Aí são os incrementos escolhidos para espaço e tempo.
O termo p1)3- representa o valoi’ p(íAx,jAí).
Uma representação em diferenças finitas de (43) no ponto (i , J) pode ser escrita como:
Pi 4- ii y 2 Pi, j + Pi—i) j
Ax2
Pi, 3 4-1 Pi, j
Aí
(44)
A representação -3—? J?*’3- -1 apesar de apresentar' dp menor erro não é utilizada para substituir
devido a problemas de estabilidade de solução, o que foge ao objetivo do presente artigo.
A equação (44) é denominada uma representação explícita de (43) porque em cada intervalo de tempo apenas uma incógnita (p{,	+ z) aparece na
equação, e, por conseguinte, a mesma pode ser resolvida explicitamente. Assim, se denominarmos a = Aí/Ax2 e resolvendo para a única incógnita teremos,
Pí,3+1 = a Pi+1,3 - (2a - 1) Pi.j + a Pi-Ítj (45)
Nas condições iniciais ( j = 0) todos os Pi, }- para 0 &amp;lt;i &amp;lt;I são conhecidos e então pi,r pode ser calculado explicitamente para todos os pontos i. Obviamente conhecendo pia podemos calcular pil2 e assim por diante.
Infelizmente esse procedimento não é usualmente empregado na resolução de problemas práticos devido ao aparecimento de instabilidade na solução. De um modo bastante geral, podemos dizer que para valores de a inferiores a 1/2 o processo de solução é estável. Todavia essa restrição atinge sobremaneira o tempo de computação, tornando antieconômica sua aplicação em problemas de simulação.
Uma representação implícita da equação (43) no ponto (i , j) pode ser escrita do modo seguinte:
sua principal característica é substituir a deiivada d2p
em espaço por uma forma em diferenças finitas
calculada no tempo (j + 1) A í ao invés de no tempo j A í como no caso prévio.
O uso dessa formulação implica no aparecimento de 3 (três) incógnitas para cada intervalo de tempo. Chamando b = Ax2/Aí e manipulando alge-bricamente a equação (46) obteremos
Pi+ 1, 3+1 — (2 + &amp;amp;) Pi, 3 4-1 + Pi- 1,3+1—b Pi, j (47)
Observa-se, então, que, nesse caso, em cada intervalo de tempo se obtém um sistema de equações simultâneas que formam uma matriz do tipo tri-diagonal. A expressão implícita obviamente se re-refe ao fato de que as incógnitas estão sempre relacionadas entre si através de um sistema de equações simultâneas. Embora pareça exigir trabalho computacional consideravelmente maior do que o exigido pela forma’ explícita, a forma implícita indicada em (47) é normalmente empregada nos sistemas dos simuladores de reservatório pelo fato de apresentar soluções absolutamente estáveis para grande número de aplicações práticas, sem qual-quei* restrição ao intervalo de tempo dado. A diferença entre as formas explícitas e implícitas pode ser mais facilmente divisada nos diagramas a seguir:
)
FORMA EXPLÍCITA
A
FORMA IMPLÍCITA
ô
Lj
x
FIG. 16
7	— MÉTODOS DE SOLUÇÃO DOS SISTEMAS DE EQUAÇÕES
Nos parágrafos precedentes foram consideradas apenas equações diferenciais parciais envolvendo uma dimensão (#). Todavia, os problemas físicos requerem soluções de equações em duas ou até mesmo três dimensões; entretanto, como veremos a seguir, os mesmos métodos empregados para a solução dos sistemas de matrizes em uma dimensão são suficientes para resolver problemas multidimen-sionais.
Consideremos inicialmente uma equação diferencial parcial em duas dimensões:
d2p	&lt;92p _ dp
dx2	dy2 dt
(48)
Essa equação pode ser aplicada para condução de calor em duas dimensões, difusão molecular e, é claro, em fluxo transiente de run fluido compres-sível em meio poroso.
Para escrever essa equação implicitamente em forma de diferenças finitas, vamos usar a seguinte notação:
A2a: Pn+l ~	n+1 ~ Pi, j, n+1 + Pi-l,i,n+l
&amp;amp; U Pn+ 1 ~ Pi, j + 1; n+ 1	2 Pi, j, ni_ 1 -}- Pi, j-_ 1, n+ 1
AfP Pi, 3, n+1 Piijm
x = iAx	y = jAy
Desse modo, a representação implícita em diferenças finitas pode ser escrita como:
As Pn+l J Ay Pn+l ______ &amp;amp;ÍP
Aa;2	A?/2 Ai
(49)
Expandindo e simplificando, obteremos:
Pi+hj + Pi-i&gt;i +
Ax2
Ay2
(Pí, /+! + Pi, 3-i) — (2 + 2
(50)
Todos os valores no membro esquerdo da equação são aplicados ao novo intervalo de tempo tn + i (o subscrito n -f- 1 foi retirado das incógnitas) .
A equação (50) escrita para os pontos i = 1, 2, ... I; j = 1,2 ... J constitui um sistema de I X J equações com I X J incógnitas, Pi , ,.
Em forma de matriz essas equações podem ser escritas abreviadamente como
Ãp = B	(51)
onde Z é uma matriz pentadiagonal e p e B são matrizes coluna de comprimento I X J.	.
7.1	— TRABALHO DE COMPUTAÇÃO
NECESSÁRIO PARA SOLUÇÃO CONVENCIONAL (ELIMINAÇÃO DE GAUSS)
A aplicação do método de eliminação de Gauss na Matriz A requei’ aproximadamente 2PJ operações aritméticas. Especificamente, cerca de PJ multiplicações e PJ adições são necessárias para transformar a matriz numa matriz triangular-superior (todos os zeros ficando abaixo da diagonal principal); cerca de PJ multiplicações e PJ adições se tomam então necessárias para determinar os valores de p, num total de PJ (Z + 1) multiplicações e PJ (I + 1) adições.
Apenas como observação, podemos ressaltar que para uma malha quadrada (Z = J — N) teremos um total de 2Ni operações. Uma matriz quadrada completa, com N- incógnitas, necessitaria de 2Ne operações para a resolução do problema.
7.2	— MÉTODOS ITERATIVOS
DE SOLUÇÃO
Os métodos normalmente empregados para resolução de sistemas de equações algébricas simultâneas requerem todo um conjunto de cálculos usualmente demorados, até que uma solução para o sistema seja encontrada. Também é possível demonstrar que esses métodos são muito sensíveis a erros de computação. Uma outra característica’, que é objeto de contestação, se prende ao fato de que os métodos convencionais (de eliminação), como nas equações que acabamos de discutir, quase não aproveitam a vantagem que apresenta uma matriz com elevado número de zeros.
Um meio de obter uma solução aproximada para um dado sistema é fazer uma “estimativa baseada na experiência’” que temos sobre o problema. Se esses valores não conduzirem a resultados satisfatórios, seleeionam-se outros; notando cuidadosamente a influência de cada variável, as novas estimativas não mais necessitam ser alicerçadas somente na experiência, e a continuação do processo nos levará a uma boa aproximação do sistema de equações em estudo. É preciso salientar que, quando esse procedimento é usado, um erro em qualquer
uma' das “estimativas” não impede que a solução correta seja obtida. Esses erros refletem-se apenas no número de tentativas para obter a solução dentro de uma dada precisão. Quando essas “estimativas” seguem um predeterminado esquema — isto é: quando os valores estimados para a tentativa 7c + 1 resultam dos valores da tentativa k —, o método de obtenção da solução é denominado ite-rativo (ll&gt; 5). Qualquer procedimento iterativo é denominado convergente quando as diferenças entre a solução exata e as aproximações sucessivas tendem a zero, à medida que o número de iterações aumenta. Os métodos iterativos para resolução de equações lineares algébricas são geralmente usados quando o número de incógnitas é grande, onde cada equação contém somente um pequeno número delas — isto é: a matriz dos coeficientes consiste prineipalmente de zeros.
Isso se prende ao fato de que os métodos iterativos usam com vantagem esse número de zeros, poupando grande tempo de computação em relação aos métodos de eliminação. Afortunadamente, as equações em forma de diferença finita associadas com as equações diferenciais do escoamento de fluidos em reservatórios se enquadram dentro das características acima citadas.
7.3	— MÉTODO DE SOLUÇÃO IMPLÍCITA EM DIREÇÕES ALTERNADAS (ADIP) (-. =■ *)
O método de solução implícito em direções alternadas é uma técnica para solução numérica de equações diferenciais parabólicas e elípticas em duas dimensões. Douglas e Rachford desenvolveram um método modificado, também implícito, para a solução numérica de equações parabólicas e elípticas em duas e três dimensões.
ADIP — O método de solução implícito em direções alternadas dá uma' boa aproximação para a equação parabólica em duas dimensões.
(43)
O método mais eficiente para sua resolução é basicamente o proposto em 1955 por Peaceman e Rachfoed (x1), que demonstraram com um exemplo típico que o método exigia cerca de 25 vezes menos trabalho computacional do que o método de solução usando a forma de diferença explícita.
Supondo que a solução é conhecida para o tempo tn , o método consiste em substituir uma das derivadas parciais de segunda ordem, digamos
d*p d^’ P°r
uma aproximação implícita em diferen
ças finitas escrita para um tempo tn+i]t, substi-tumdo a outra derivada por uma forma explí
cita de diferenças finitas.
Supondo que estamos trabalhando numa região onde Nãx = I e M Ay = J, a aplicação do método para cada um dos (N — 1) pontos da malha numa linha paralela ao eixo dos x's, nos dará, então, (TV — 1) equações para os (N — 1) valores incógnitos de p nesses pontos, para o tempo tn + 1/2 •
Y 4
	f	X	z	\	* '	Z	»	Z
		X	Z	z	»	z	l-	1
s	'	s	z	x	Z	X	)	&gt; Pi.j.n z	X.	Z
	X	Z Z	\	V	z Z	X	z z	X	1	z1 z	X	X »
	•	z		V	z		X
0	12	3	i	N-l	(1,0)	X
FIG. 17-EXEMPLO DE MALHA RETANGULAR
Quando houver (M — 1) linhas paralelas ao eixo dos x's , o avanço da solução sobre a área do retângulo no tempo t„ + 1/2 envolverá a solução de (M — 1) sistemas independentes de equações, com cada sistema' contendo (N — 1) incógnitas. Obviamente, a solução desses sistemas é muito mais fácil do que a solução de (N — 1). (M — 1) equações, associadas com os métodos totalmente implícitos.
0 avanço da solução para o tempo tn(.i é então
obtido substituindo-se, agora,
d2p
-^7- por uma apro-
oy2
ximação em forma implícita e -yy por uma forma explícita. Escrevem-se as equações correspondentes a cada ponto da malha ao longo de colunas para-le.as ao eixo dos y's.
' Isso, por conseguinte, nos dará ÇN — 1) sistemas independentes de equações, envolvendo (M — 1) incógnitas. 0 intervalo de tempo At deve ser o mesmo para cada avanço. Desde que a solução para os intervalos de tempo sucessivos seja derivada alternando-se linhas e colunas como anteriormente descrito, o método é válido para todas as razões Aí/(Az2) e Aí/(A?/). Cada ponto da solução — se considerada de per si (linhas ou colunas) — é instável, e a repetição unilateral conduz a um crescimento de erros inadmissível. Em forma algébrica podemos usar a seguinte notação para descrever o procedimento:
A» p* + A2 pn = A (p* - p„)
(52)
(54)
A1 p* + A2 pn+1 = ~ (pn+1 - p*)	(53)
Na forma implícita de diferenças finitas, esta equação se torna:
onde,
&amp;amp;xP = (Pi+1, i ~ 2pi, j + Pi _ i, y) / As2 P = (Pí&gt; í +1 2pí, j -f- pi, j _ i) / Ap2
A variável pí= em (52) e (53) pode ser considerada como Pn + i/2. Cada uma dessas equações conduz, com vimos, à solução de um problema unidimensional (matriz tridiagonal), ao contrário do que encontramos ao abordar as mesmas equações em sua forma totahnente implícita, cujo resultado era uma matriz pentadiagonal. Até o presente, muito pouco é conhecido sobre as condições nas quais o método é válido e superior a outros em regiões não retangulares e também para equações mais generalizadas .
7.4	— COMPARAÇÃO ENTRE O TRABALHO DE COMPÚTACÃO EMPREGADO NO MÉTODO DIRETO E NO PROCESSO EM DIREÇÕES ALTERNADAS
Conforme mencionado anteriormente, a solução direta do problema matricial associado com a equação
A2Pntl =	(Pn+1 ~ Pn)
necessita aproximadamente de 2IV operações aritméticas, em duas dimensões, por intervalo de tempo. Essas operações são igualmente divididas entre multiplicações e adições.
Pode ser provado teoricamente (3) que são necessárias somente 46ZJ operações, igualmente divididas entre multiplicações e adições, para solueio-d-D
nar a equaçao V • A (x, p) Vp =	, onde o coe-
ficiente é variável, usando o método em direções alternadas. Isso requer 461J/LIJ'i operações, ou seja 23/J2 menos trabalho computacional do que a solução totalmente implícita. Como um exemplo da • eficiência desse método, consideremos a área I — = J = 50, e teremos uma razão de 23/(50)2 — = 0,0092, entre o trabalho computacional exigido pela solução' sugerida e aquele exigido pela solução convencional.
7.5	— MÉTODOS ITERATIVOS EM DIREÇÕES ALTERNADAS USANDO PARÂMETROS DE ITERAÇÃO
Consideremos uma equação parabólica simples com um termo “fonte”, ou seja:
A" Pn-t-l Q	(Pn+ 1 Pn)
OU
A2Pn+1 Pn+1 At Pn	Bi&gt;i (55)
onde i , j denota o ponto da malha (xí , y,).
Obtém-se pn + x por iteração, usando o procedimento a seguir. Seja o sistema básico:
Al p* + A2 p„ = A (p* - Pn) (52)
A2p* + A2pn+x ~ (pn+ , - p*)	(53)
Este sistema pode ser reescrito com a introdução da variável Hk — Parâmetro de iteração — na forma a seguir:
1/2 (A2p* + Aj» + 1/2 A2pfc - p* = II k
(p* — pk) — B	(56)
1/2 (A2p* + A2p«= +1) + 1/2 A2pfc - ~pk+1 = '	UkZ
= Hk (pfc+1 — pfc) — B	(57)
No sistema acima, pft, p* e p^1 são aproximações sucessivas para o valor exato de pM, no tempo ^n+l •
A diferença entre o sistema básico (52) e (53) e o descrito por (56) e (57) consiste em, além de incluir o termo “fonte”, adicionar o termo 1/2 A2ps para expressar a equação de diferenças finitas em termos de média ponderada (fator de peso = 1/2) com os resultados da iteração anterior. Isso introduz maior estabilidade ao método de solução. Todavia, a principal diferença reside na inserção do parâmetro de iteração Hk (3&gt; 9). Seu emprego é proveniente de estudos realizados sobre a resolução de equações diferenciais parciais do tipo elíptico, e a correta explanação de sua atuação foge ao objetivo principal deste artigo. Entretanto, para uma melhor compreensão, podemos defini-lo como um agente acelerador de convergência.
Uma inspeção visual é bastante para verificar que, quando o processo é convergente, a magnitude do parâmetro não tem importância fundamental. Para assegurar a convergência do sistema, o mesmo valor de Hk deve ser usado em cada um dos dois
“degraus” de resolução. Entretanto, pode ser alterado de uma iteração para otura. A solução de p*, da equação (56) e , de (57), constitui uma iteração. K iterações formam um ciclo. Assim, um ciclo compreende a solução do sistema (56) e (57), para K = 1, 2 ,.........K , usando os parâ-
metros l/i , II2, ■... Htc . Os ciclos são repetidos até que a convergência seja obtida.
A solução iterativa da equação (55) para1 p„+i tem a vantagem de poder utilizar qualquer intervalo de tempo. Se essa mesma equação for resolvida pelo método não iterativo em direções alternadas, haverá um limite para o intervalo de tempo, o qual deverá diminuir proporcionalmente a a , de modo a assegurar estabilidade e precisão na solução.
8	— RESOLUÇÃO DE UM SISTEMA SIMULADOR PARA RESERVATÓRIOS DE PETRÓLEO
Com a finalidade de faeilitar o entendimento, vamos considerar as equações gerais (11), para o caso de fluxo de apenas duas fases eompressíveis, respectivamente óleo e água, em duas direções principais de escoamento — a saber: x e y.
Para esse caso teremos:
(k kn V 0O \ Po Bq /
(22)
/Zc krw V$w\ \ Pw Bw j
+ 5w =
(23)
V •
V -
Para' facilidade de manuseio, costumamos trabalhar em Engenharia de Reservatórios com a função inversa de Bo e Bw, embora mantendo a mesma nomenclatura. Daqui por diante, porém, as equações (22), (23) e (24) serão escritas do seguinte modo:
„ (k kri)B0 V$o\ ,	d ,a
V . I--------—-------l + ío = (So 0 Bo) (58)
(kkTWBwV |	d f p t&gt; \ zkíy\
V . ------ ---- I + qw =	(S„&amp;lt;p Bw) (59)
Note-se que essas equações foram empregadas para que o termo “fonte”, ou “sumidouro”, represente vazões volumétricos, que é o que se obtém no campo, ao invés de vazões em massa, como à primeira vista pode parecer.
Para obter a solução do sistema de equações acima, devemos primeiramente expandir todas as derivadas e procurar substituir as demais variáveis em função de nossas incógnitas fundamentais, 0O e 0IC . Para isso., devemos levar em consideração
os conceitos, adiante referidos, de compressibilidade de rocha e fluido, bem como os de permeabilidade relativa de pressão capilar.
8.1	— COMPRESSIBILIDARES Co, Cw e CT
Como já definido, o conceito de compressibilidade de fase fluida pode ser aplicado à água dando:
r   1	dpw
w	pw dPw
Usando essa expressão combinada com o eenceito de potencial definido pela equação (7), teremos:
C = 1	dt
pw dt dpw d&lt;4&gt;„
Entretanto, considerando que de (9) podemos escrever
dpw _ dBw dt ~ dt
e usando a simbologia At Bw para expressar a derivada de Bw em relação ao tempo, teremos:
AtBw = Cwp~w
ou, em termos de diferenças finitas,
AtBw = cwp\.,. n($w,y.n + 1 - Íwiiy,n)/Aí (60)
Analogamente, para a' fase óleo chegaremos facilmente a:
At .Bo = Co p2o i, j, „ ($o£, j, „ +1 — $i, /, „)/ Ai (61)
Similarmente, a porosidade incluindo a compressibilidade da rocha, fornecerá
At&lt;j&gt; — Cr	Pu&gt;i,j,n (^wf.í.n+l	, n)/(^2)
8.2	— PRESSÃO CAPILAR
Para a pressão capilar, como normalmente ela é fornecida em função da saturação de água , o procedimento diverge um pouco do acima descrito. Teremos:
= S' = (.ds^dt^ãpjdf) dpc
e como pc = po — Pu» teremos dpc = dpa — dpw ou ainda dpc = p0 d$0 - pw ou, usando diferenças finitas para dSmf dt, teremos,
Como uma das restrições do modelo foi colocar So +	= 1, implicando em Aí So =	— At S,o,
por conseguinte, obteremos, por analogia a (63),
(64)

Nas equações (60) a (64), algumas variáveis foram consideradas no tempo tn em vez de no tempo ín+! , visto que sua variação em relação à magnitude dos intervalos de tempo usualmente considerados é pequena, na prática, não introduzindo erro apreciável.
Substituindo as expressões agora obtidas no sistema fundamental expandido, teremos o sistema final em diefrenças finitas. Nas equações abaixo foi introduzido o termo correspondente à injeção de água, e todas as equações foram multiplicadas por AzAy.
[(fcfc„)i+v-n(^£+1,í,n+1-^-,/,n+x) +
- n+1 - n+1)] +
[(fc fcro)í,J+J,n	n+1 ~ 00»,/, n+1) ~~
(fc fcro)í,/-i,n ( ^&gt;O£1 J-!, n	0&lt;&gt;í,/-l, n+1) ~ Qo =
A.r Ay Aí
{B°i,i.n S°i,3,n C* 01./.» P^i,j,n ($*&gt;{,3',n+1
+ ^’í.y.n ^i,3,n Si,j [Pw,-,y,„(0wí,j,n+i
~ 0«£,/,n) ~ POi.i.n	~	+
+ $0i,3,n&amp;lt;l&gt;i.3,n Cf) P0iijin (0Oí&lt;y,„+l ~	(65)
Essa equação constitui o desenvolvimento, em diferenças finitas, para o escoamento da fase óleo no meio poroso em consideração.
Seguindo para a fase água um desenvolvimento semelhante obteremos:
jUM AX	0“l,/,n+l)
— (k kr^)i_itjtn.	(	nU — 0wt-_i,y, „)]
+ (fc krJ)i ^ n (_(}&gt;„■ .+l n+1 — 0w,-,3,n)]
n i r _ Ay rD a zv j.
Qw + + w	e““l,/,n/,n ^r(Pi,:’,n Pwi,3,n
( 0“í, i, n+1	0*»», 3, n) + B”i, 3, n^i, I"	í f P°i, j, n
(0°l,/,n+l	&amp;amp;®i,3&gt;n)	Pwii 3' n	3, n+1	0w»,/,n)l
^wi,3,n	Cwp2Wtiítn(,&lt;j&gt;icit]-in+1 — 0tt,•,/,„)}	(66)
As equações (60), (65) e (66) aplicadas a' cada nó da malha do reservatório constituem um sistema de equações lineares que resolveremos pelo sistema iterativo implícito, usando direções alternadas — ou seja: adotando o método cujos conceitos básicos foram explanados na seção precedente. Conforme indicado naquela oportunidade, o sistema é estável para quaisquer valores de Az , Ay e Aí.
As equações (60), (65) e (66) são do tipo:
Al 0O£_1,+ Bi 4&gt;oiljin+i + Cl 0O£_i,y,n+i + + D1 $*,5-1, n+1 + B1&amp;lt;j}oiiíin+i + F1 0OÍ(Í+i,b+i + +&amp;lt;?l^/.n+l = ^	(67)
e,
A2 0wi_i,J-„,l+i + B2&amp;lt;f&gt;n,iljtn+1 + C2 (I&gt;wi+Iljin+1 +	•
+ D2 0w1(Í_ijb+i + B2 ^&gt;wíjíjn+i + F2 0wÍj3+ijB+i
+ ^+1 = ^	(68)
8.3	— RESOLUÇÃO USANDO O MÉTODO ITERATIVO EM DIREÇÕES ALTERNADAS
Aplicando o método acima citado às equações (61), (67) e (68), teremos:
Para a Direção X — Fase óleo:
Ai 0*Oi_i,/ + Bi&amp;lt;p*oitj + Ci 0*oí+i,y + Di&amp;lt;j)kOi .3._!
+ Ei + Fi&amp;lt;t3\ .+1 + Gi	Ki + Hk
($**,5 ~	(69)
Fase água:
A2 4&gt;*wí-i,j + B2&amp;lt;t&gt;*wití + C2	+ D2 j-i +
E2 + F2&amp;lt;t&gt;kwití+1 + G2 = K2 + Hk
-&amp;lt;/&gt;%,.)	(70)
Para a Direção Y — Fase óleo:
Ai ^Vi./ + B1 0*°í,/ +	$**+1.5 + D1 $**5-1
+ Ei + Fi + G2 = Ki + Hk
(7D
Fase água:	.
a2 + b2 + c2 + O2
+ E,&amp;lt;j&gt;™. + F2&amp;lt;j&gt;%j+1 + G2 fá» = K2 + Hk
(72)
As variáveis com índices superiores (fc), (*) e (Zc 4- 1) indicam aproximações sucessivas para o tempo in+! — isto é: aproximações para&amp;lt;pOi . n+1 e 4&gt;wi,j,nn Hk, como mencionado anteriormenté, é o parâmetro de iteração, funcionando como acelerador de convergência. Sua introdução não altera o resultado a ser obtido, desde que o critério de convergência |&amp;lt;/&gt;(£/ —	&amp;lt;e pode ser escolhido
tão pequeno quanto conveniente.
A solução simultânea do sistema em cada direção implica na resolução de um sistema linear de matrizes tridiagonais, conforme demonstrado em parágrafo anterior. Assim sendo, desde que lidamos com menos incógnitas, podemos escrever as equações (62), (69), (70), (71) e (72) do seguinte modo:
Direção X,
= Dl:./	(73)
A*, í ^*0£-l, /+ B*i, i tâi.j + B3i, j tâi, j + j ^*0£+l, j = = D2£&gt;í	(74)
Direção Y,
+ BUij + B2.,&amp;lt;- + C^.	=
= Diitj	(75J
A^Ü-r +	^ + B3itj&amp;lt;- +	=
= D2íi/	.	(76)
Faz-se necessário ressalvar que, embora tendo a mesma nomenclatura nas duas direções., os coeficientes possuem significados diferentes. A razão de mantermos a nomenclatura deve-se ao fato de que o mesmo algoritmo (4- 5- u) é usado para solucionar as duas direções. .
O algoritmo (4) para' a resolução do sistema de equações (63), (73), (74), (75) e (76) é o seguinte:
= fa-i
C^,/
\-i = ~ C^j! Pi-i
= - faw Gk-i! Ví-í
Fí’j
~~ B^J A^-
&amp;amp;/./ = B2i&lt;j - A^,. \2i_Vj
^3i-j= b^í - Aiití
^4,-y- — B^,j Af^.j Xlj-xy
T11.,- =
~ /321,3.D21,j.
Pi.í
^ll.J D2j,y ^31,/ Dlj.y 72i&lt;í = _ __
Vii./ = [&amp;amp;„■ (Di,-,; - Ai^y^J — fa,, (D^ -
- A^.y^-]/mj.
= [£1^ (.D^j - A^-y^J) -	-
Alf,j Vlj-i./)] / /b‘,Z.
A solução do sistema é dada por:
0 aItí = yii.j
4&gt; Ol,j = V2j,/
4 v&gt;i.i = Vlj./ ^1/./	w£+l&gt;/	^2i’Z	°l+l&gt;/
^’*0»,/ = V2,-,/ — ^-3í./ 4&gt; Oj-.-!,,- — ^2i,j&amp;lt;/&gt; WÍ+1.Í
Note-se que, se admitirmos não existir fluxo nos limites do reservatório, as condições de contorno nos darão:
-411,/5=5 Ail,] = ê^ii,/ (^4x./	0
Se trocarmos os devidos índices, teremos o algoritmo para a direção Y.
No próximo número deste periódico discutiremos a aplicação dos conhecimentos até então apresentados na formulação de um programa simulador para estudo dos reservatórios da PETROBRÁS. Basicamente trataremos de sua flexibilidade operacional e resultados de sua aplicação num caso típico, mostrando sua eficiência e, finalmente, considerações sobre seu desenvolvimento no que diz respeito aos equipamentos disponíveis.
CITAÇÕES
(*) Bonet, E. J. — Simulador de reservatórios de duas dimensões, duas fases, horizontal, não estacionário. Boletim Técnico da PETROBRAS, Rio de Janeiro, 11 (2): 249--62, abr./jun. 1968.
(2)	Clark, N. J. —Elements of petroleum reser-
voirs. Dallas, Tex., Society of Petroleum Engineers of AIME, 1960.
(3)	Coats, K. H. — Elements of reservoir simula-
tion; class notes. Austin, Tex., The University of Texas, 1967.
(4)	Douglas Jr. et alii — method for eaueulat-
ing multi-dimensional imiseible displacement. Transactions of the AIME, New York, 216, 1959.
(5)	Ketter, R. L. &amp;amp; Pawel Jr., S. P. — Modern
methods of engineering computation. New York, McGraw-Hill, 1969.
(8)	Marques, J. K. — Campo de Araçás, estudo de engenharia de reservatórios. Rio de Janeiro, 1971. [Em impressão]
(T) Mattews, C. S. &amp;amp; Russel, D. G. — Pressure buildup and flow tests in Wells. Dallas, Tex., Society of Petroleum Engineers of AIME ,1967 (American Institute of Mining, Metallurgical and Petroleum Engineers. Society of Petroleum Engineers. Monograph — v. 1).
(8)	Miller, F. G. — Advanced reservoir engineering; class notes. Stanford, Cal., Stanford University, 1970.
(9)	Peaceman, D. W. —Fundamentals of reser-
voir simulation; lectures notes. Houston, Tex., Esso Production Research Co., 1969.
(10)	Ramey, H. J. — Advanced gas natural engi-
neering; class notes. Stanford, Cal., Stanford University, 1970.
C1) Smith, G. D. — Numerical solution of partial differential equations. London, Oxford University Press, 1965.
SYNOPSIS — Simulation techniques for fluid flow through porous media. Mathematical equations to express the physical behavior of the phenomenon. Generally the search of the results requires the solution of sets of partial differential equations throzigh special algorithms using extensively digital computers of great speed and large core availability. This is the first of two parts series into wich the work was divided for publication.
(Originais recebidos em 10-ÜI-72.)
</field>
	</doc>
</add>