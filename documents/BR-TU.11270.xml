<?xml version="1.0" encoding="utf-8"?>
<add>
	<doc>
		<field name="docid">BR-TU.11270</field>
		<field name="filename">16550_CastanedaJimenez_GermanEfrain_M.pdf</field>
		<field name="filetype">PDF</field>
		<field name="text">
 i 

  

 

German Efrain Castañeda Jimenez 

 

 

 

 

 

Simulação do Controle de Escoamento 

Multifásico em uma Bomba Centrífuga 

Submersa - BCS 
 

 

 

 

 

 

 

 

 

 

 

23/2014 

 

 

 

 

 

 

 

 

 

 CAMPINAS  

2014 

 



 iii 



 iv 

 
 

 

Ficha catalográfica 

Universidade Estadual de Campinas 

Biblioteca da Área de Engenharia e Arquitetura 

Rose Meire da Silva - CRB 8/5974 
 

 

Castañeda Jimenez, German Efrain, 1988- 

  C275s CasSimulação do controle de escoamento multifásico em uma bomba centrífuga 

submersa - BCS / German Efrain Castañeda Jimenez. – Campinas, SP : [s.n.], 

2014. 
 

CasOrientador: Janito Vaqueiro Ferreira. 

CasDissertação (mestrado) – Universidade Estadual de Campinas, Faculdade de 

Engenharia Mecânica. 
 

Cas1. Bomba centrífuga. 2. Controle robusto. 3. Modelagem e simulação. 4. 

Aprendizado de máquinas. 5. Escoamento multifásico. I. Vaqueiro Ferreira, 

Janito,1961-. II. Universidade Estadual de Campinas. Faculdade de Engenharia 

Mecânica. III. Título. 
 

 

 

 

Informações para Biblioteca Digital 
 

Título em outro idioma: Simulation control of multiphase flow an electrical submersible pump - 

EPS 

Palavras-chave em inglês: 

Centrifugal pumps 

Robust control 

Modeling and simulation 

Machine learning 

Multiphase flow 

Área de concentração: Mecânica dos Sólidos e Projeto Mecânico 

Titulação: Mestre em Engenharia Mecânica 

Banca examinadora: 

Janito Vaqueiro Ferreira [Orientador] 

Alberto Luiz Serpa 

Vicente Lopes Junior 

Data de defesa: 26-02-2014 

Programa de Pós-Graduação: Engenharia Mecânica 



 v 

 

 



 vii 

Dedico este trabalho aos meus pais, German Castañeda e Amparo Jimenez, por ter-me 

guiado pelo caminho do sucesso e as minhas irmãs Carolina e Lorena pelo apoio. 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 
 
 



 ix 

Agradecimentos 
 

A Deus pela oportunidade. 

A meu orientador Prof. Dr. Janito Vaqueiro Ferreira, pelo apoio, pela dedicação e pelos 

conselhos ao longo do projeto. Também por me permitir realizar meus estudos de mestrado no 

Brasil. 

A minha família pelo apoio constante, independentemente da distância. Aos meus pais e 

minhas irmãs agradecimentos infinitos, que me apoiaram em cada momento desta etapa na minha 

vida. 

A meus amigos. Especialmente a Jenny Lombo, Manuel Arcila e Camilo Ariza por abrir as 

portas de suas casas quando eu cheguei ao Brasil. A meus companheiros de aventura Paola 

Gonzalez, Oscar Rojas e Maria Fernanda. A Marcela Corredor, Olmer Garcia e seu filho Sergio 

por fazer-me membro de sua família. A meu amigo Beto que sem o seu apoio eu não teria ficado 

aqui no Brasil. E demais amigos aqui no Brasil e no exterior que fizeram parte deste processo.  

A todos os professores e colegas do DMC e da FEM, que ajudaram de forma direta e 

indireta na conclusão deste trabalho. 

Principalmente quero agradecer a minha namorada Diana Martinez, por seu apoio, 

paciência e por sua amizade. E principalmente por ser a força de meu dia a dia, a motivação, por 

ser minha fonte de inspiração e alegria nesta etapa de minha vida. 

À Universidade Estadual de Campinas por fornecer um local para o desenvolvimento de 

meu projeto e a Petrobras pelo apoio econômico. 

 

 

 

 

 

 

 

 

 



 xi 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

“Tudo deveria se tornar o mais simples possível, 

 mas não simplificado.” 

_____________________________________ 

Albert Einstein 

 

 

 

“O entusiasmo é a maior força da alma. 

Conserva-o e nunca te faltará poder 

para conseguires o que desejas.” 

__________________________ 

Napoleão Bonaparte 

 

 

 

 



 xiii 

Resumo 

 

Jimenez, G. E. C. Simulação do Controle de escoamento multifásico em uma bomba 

centrífuga submersa - BCS. Campinas: Faculdade de Engenharia Mecânica, Universidade 

Estadual de Campinas, 2014. 127p. Dissertação (Mestrado). 

Na indústria do petróleo é comum à utilização de bombas centrífugas submersas (BCS) 

operando em escoamento multifásico líquido-gás. A presença de elevadas vazões de gás causam 

uma degradação severa no desempenho da bomba, gerando instabilidades nas curvas de pressão-

vazão, como o ‘surging’ e o ‘gas locking’. Portanto o conhecimento destas instabilidades é 

fundamental para a adequada operação da bomba e assim evitar falhas prematuras no 

equipamento.  

Na atualidade não existem modelos matemáticos que representem de forma adequada o 

comportamento da BCS na região de ‘surging’ e no ‘gas locking’, gerando a necessidade de 

empregar circuitos de testes para fazer o levantamento das curvas de desempenho das bombas. A 

maioria dos circuitos de testes é operada de forma manual para obter às condições de operação da 

bomba, tornando os ensaios repetitivos, cansativos e trabalhosos. Por isto nasce a necessidade de 

automatizar estas bancadas com a finalidade de facilitar o processo do levantamento das curvas 

de desempenho das bombas. 

Este trabalho apresenta o projeto e simulação de um controle robusto tipo    que permita 

manter o escoamento multifásico na entrada de uma BCS em diferentes condições de operação da 

bomba. Este controlador é projetado a partir de um circuito de testes para BCS virtual que é 

modelado empregando formulações físicas e modelos ajustados mediante dados experimentais 

usando algoritmos de aprendizagem de máquinas baseados em máquinas de suporte vetorial para 

regressão (SVMr). Após o projeto de controle, o controlador projetado é testado no circuito de 

testes virtual mediante simulações em tempo real ‘software in the loop’ (SIL). 

Palavras Chave: Bomba centrífuga, controle robusto, modelagem e simulação, aprendizado 

de máquinas, escoamento multifásico. 

 

 



 xv 

Abstract 

 

Jimenez, G. E. C. Simulation Control of multiphase flow an electrical submersible pump - 

ESP. Campinas: Department of Mechanical Engineering, University of Campinas, 2014. 127p. 

Thesis (Master). 

In the oil industry, it is common to use electrical submersible pumps (ESP) operating with 

gas -liquid multiphase flow. The presence of high gas flows causes severe degradation in 

performance of the pump, generating instabilities in the flow-pressure curves, as "surging" and 

"gas locking". Therefore knowledge of these instabilities is essential for the proper functioning of 

the pump and thereby prevents premature failure of the equipment. 

Currently there are no mathematical models that adequately represent the behavior of the 

EPS in the region of “surging” and “gas locking”, creating the need to use test circuits to make a 

study of the performance curves of the pumps. Most test circuits are operated manually to reach 

the operating conditions of the pump, making repetitive, tedious and laborious trials. Therefore 

there is a need to automate these circuits in order to facilitate the process of obtaining the 

performance curve of the pump. 

In this paper the project and simulation of a robust control type    for keeping the 

multiphase flow in the entrance of a EPS operating at different conditions is performed. This 

controller is designed based on a test circuit virtual for EPS which is modeled using physical 

formulations and adjusted models obtained by experimental data using machine learning 

algorithms based on support vector machines for regression (SVMR). After the controller design, 

the control is tested in the virtual test circuits using simulations in real time "software in the loop" 

(SIL). 

Key Words: Centrifugal pump, robust control, modeling and simulation, machine learning, 

multiphase flow. 

 

 



 xvii 

Lista de Ilustrações 
 

Figura 1.1 Arquitetura da proposta ........................................................................................ 4 

Figura 2.1 Estagio de BCS ..................................................................................................... 7 

Figura 2.2 Representação das curvas de desempenho de BCS com escoamento multifásico 9 

Figura 2.3 Atividades básicas para o processo de identificação .......................................... 10 

Figura 2.4 Validação experimental ...................................................................................... 11 

Figura 2.5 Passos básicos para o desenvolvimento de um sistema de controle ................... 13 

Figura 2.6 Componentes do HIL e SIL ................................................................................ 14 

Figura 3.1 Esquema básico do controle    ........................................................................ 15 

Figura 3.2 Sistema geral com filtros de ponderação nas entradas e saídas .......................... 19 

Figura 3.3 Problema de regressão linear com SVM ............................................................ 20 

Figura 3.4 Efeito do parâmetro   ......................................................................................... 21 

Figura 3.5 Mapeamento de alta dimensionalidade ............................................................... 23 

Figura 4.1 Circuito de testes para BCS ................................................................................ 25 

Figura 4.2 Diagrama de blocos do sistema .......................................................................... 26 

Figura 4.3 Eletroválvula de controle de vazão de ar ............................................................ 28 

Figura 4.4 Diagrama de blocos da eletroválvula .................................................................. 28 

Figura 4.5 Circuito equivalente da eletroválvula ................................................................. 29 

Figura 4.6 Esquema equivalente do mecanismo da válvula de ar........................................ 30 

Figura 4.7 Fluxo de um gás através de um orifício .............................................................. 31 

Figura 4.8 Válvula tipo agulha ............................................................................................. 32 

Figura 4.9 Válvula de controle de fluido ............................................................................. 33 

Figura 4.10 Diagrama de blocos modelo bomba booster .................................................... 34 

Figura 4.11 Diagrama de blocos do modelo de elevação da bomba booster ....................... 34 

Figura 4.12 Efeito da rotação na bomba booster ................................................................. 35 

Figura 4.13 Esquema eixo bomba booster ........................................................................... 36 

Figura 4.14 Diagrama de blocos do modelo da BCS ........................................................... 37 

Figura 4.15 a) Efeito da rotação, b) Efeito da Pressão c) Efeito do ar na mistura. .............. 38 

Figura 4.16 Diagrama dos modelos de caixa preta do sistema ............................................ 40 

Figura 4.17 Diagrama de fluxo da iteração dos componentes do circuito ........................... 40 



 xviii 

Figura 4.18 Curvas da bomba booster mediante SVM ........................................................ 42 

Figura 4.19 Curvas da BCS mediante SVM,                           ......... 43 

Figura 4.20 Curvas da BCS mediante SVM,                           ......... 44 

Figura 4.21 Curvas da BCS mediante SVM,                            ....... 44 

Figura 4.22 Modelo não linear do sistema. .......................................................................... 46 

Figura 4.23 Variação da resposta da porcentagem de gás em diferentes rotações da bomba 

booster .................................................................................................................................. 47 

Figura 4.24 Variação da resposta da porcentagem de gás em diferentes rotações da BCS . 48 

Figura 4.25 Variação da resposta da porcentagem de gás em diferentes vazões de fluido, a) 

Resposta do sistema a baixas vazões de fluido, b) Resposta do sistema com grandes trocas 

na vazão de fluido ................................................................................................................ 49 

Figura 4.26 Resposta da pressão de entrada na BCS com diferentes porcentagem de gás .. 50 

Figura 4.27 Variação da resposta da pressão de entrada em diferentes rotações da BCS ... 50 

Figura 4.28 Variação da resposta da pressão de entrada em diferentes vazões de fluido .... 51 

Figura 5.1 Diagramas de blocos da bancada de testes virtual do sistema com controle ...... 52 

Figura 5.2 Comparação modelo real e aproximado da porcentagem de gás ........................ 54 

Figura 5.3 Efeito da porcentagem de gás na pressão de entrada da BCS ............................ 55 

Figura 5.4 Comparação modelo real e aproximado da pressão de entrada da BCS ............. 56 

Figura 5.5 Estrutura do sistema com controle ...................................................................... 57 

Figura 5.6 Sistema da forma padrão com filtros de ponderação .......................................... 58 

Figura 5.7 Diagrama de blocos da bancada de testes virtual com o controle. ..................... 63 

Figura 5.8 Resposta da porcentagem de gás em diferentes pressões de entrada: a) Resposta 

do sistema, b) Esforços de controle...................................................................................... 64 

Figura 5.9 Resposta da porcentagem de gás em diferentes rotações da BCS: a) Resposta do 

sistema, b) Esforços de controle........................................................................................... 65 

Figura 5.10 Resposta da porcentagem de gás em diferentes temperaturas: a) Resposta do 

sistema, b) Esforços de controle........................................................................................... 66 

Figura 5.12 Resposta da porcentagem de gás em diferentes vazões de fluido: a) Resposta do 

sistema, b) Esforços de controle........................................................................................... 67 

Figura 5.13 Resposta da porcentagem de gás com ruído de medição: a) Resposta do sistema 

com ruído de medição, b) Esforços de controle ................................................................... 68 



 xix 

Figura 5.14 Resposta da pressão de entrada em diferentes vazões de fluido: a) Resposta do 

sistema, b) Esforços de controle........................................................................................... 69 

Figura 5.15 Resposta da pressão de entrada em diferentes rotações da BCS: a) Resposta do 

sistema, b) Esforços de controle........................................................................................... 70 

Figura 5.16 Resposta da pressão de entrada em diferentes vazões de fluido: a) Resposta do 

sistema, b) Esforços de controle........................................................................................... 71 

Figura 5.17 Resposta da pressão de entrada com ruído de medição: a) Resposta do sistema 

com ruído de medição, b) Esforços de controle ................................................................... 72 

Figura 5.18 Curvas da BCS com controle,                          ........... 72 

Figura 5.19 Curvas da BCS com controle,                        ...................... 73 

Figura 5.20 Comportamento do deslocamento do pistão no levantamento das curvas ....... 74 

Figura 5.21 Comportamento da rotação da bomba booster no levantamento das curvas .... 74 

Figura 6.1 Troca do sistema real por SIL software .............................................................. 75 

Figura 6.2 Processo de geração de aplicação em tempo real ............................................... 76 

Figura 6.3 Interface no ControlDesk .................................................................................... 77 

Figura 6.4 Partes da interface de usuário no ControlDesk ................................................... 78 

Figura 6.5 Conector da Dspace com a conexão física das entradas e saídas do sistema. .... 79 

Figura 6.6 Modelo não linear para SIL ................................................................................ 80 

Figura 6.7 Curvas da BCS em SIL com controle,                          81 

Figura 6.8 Curvas da BCS em SIL com controle,                         ....... 82 

Figura B.1 Bias e Variância com Respeito aos Modelos ..................................................... 91 

Figura C.1 Diagrama de fluxo do AG .................................................................................. 93 

Figura C.2 Genótipo dos indivíduos .................................................................................... 94 

Figura C.3 Método da roleta. ............................................................................................... 95 

Figura C.4 Combinação do genótipo. .................................................................................. 95 

Figura C.5 Mutação no genótipo. ......................................................................................... 95 

 

 

 

 



 xxi 

Lista de Tabelas 

 

Tabela 3.1 Tipos de kernel ................................................................................................... 24 

Tabela 4.1 Parâmetros da SVM da bomba booster .............................................................. 41 

Tabela 4.2 Parâmetros da SVM da BCS .............................................................................. 42 

Tabela 5.1 Filtros de ponderação. ........................................................................................ 60 

Tabela C.1 Exemplo de duplicação dos indivíduos ............................................................. 94 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 



 xxiii 

 Lista de Abreviaturas e Siglas 

 

Notação 

 

No presente documento as letras maiúsculas em negrito denotam matrizes e letras 

minúsculas em negrito representam vetores. Letras em fonte normal são escalares. 

 

Abreviações 

 

AG   Algoritmo genético. 

BCS   Bomba Centrifuga submersa ou bombeio centrifugo submerso 

MSE    Mean Square Error (Erro Quadrático Médio) 

ESP   Electrical submersible pumps 

HIL   hardware in the loop 

SIL   Software in the loop 

SVM   Support Vector Machine (Máquina de Vetores de Suporte) 

SVMr, SVMR Support Vector Machine Regression (Máquina de Vetores de 

Suporte para Regressão) 

SVs    Support Vector (Vectores de suporte) 

 

Siglas 

 

     Termo de Bias 

           Erro de treinamento 

          Erro de validação 

            Erro de teste 

 ( )   Função do Modelo 

     Vetor de sinais de controle. 

     Vetor de entradas exógenas 

     Vetor de estados do sistema 

     Amostras de entrada da SVMr 



 xxiv 

     Vetor de sinais enviados ao controlador 

     Amostras objetivo da SVMr 

     Vetor de sinais de desempenho 

     Termo de Penalização do SVM 

      Fluxo mássico de ar             

        Fluxo mássico de agua            

          Fluxo mássico do fluido            

 ( )   Função de kernel ou núcleo 

    Matriz do Controlador 

 ( )   Controlador 

    Matriz do sistema 

 ( )   Sistema 

     Diferencial de pressões           

     Pressão no reservatório de ar           

     Pressão na entrada da BCS           

     Pressão na saída da BCS           

    Vazão de fluido             

      Vazão de ar         
     

        Vazão de agua         
     

         Vazão de fluido multifásico       
     

     Coeficiente de Determinação 

     Temperatura no reservatório de ar        

     Temperatura na entrada da BCS        

     Temperatura na saída da BCS        

     Voltagem de excitação da válvula        

       Rotação do eixo da BCS           

       Rotação do eixo da bomba boster          

       Deslocamento do pistão da válvula de ar       

        Deslocamento do pistão da válvula de fluido      

     
        

   Multiplicador de Lagrange 



 xxv 

     Limite factível 

     Fator da Margem SVM 

     Variáveis de relaxamento na SVMr 

      Massa específica do gás          
   

     Fator do kernel 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 



 xxvii 

SUMÁRIO 
 

Capítulo 1. INTRODUÇÃO ................................................................................................ 1 

1.1 Introdução .............................................................................................................. 1 

1.2 Motivação .............................................................................................................. 2 

1.3 Proposta de trabalho ............................................................................................... 3 

1.3.1 Objetivo Geral .................................................................................................... 3 

1.3.2 Atividades Específicas ....................................................................................... 3 

1.4 Arquitetura ............................................................................................................. 4 

1.4.1 Organização da Dissertação ............................................................................... 5 

Capítulo 2. REVISÃO BIBLIOGRÁFICA ......................................................................... 6 

2.1 Bomba Centrífuga Submersa (BCS) ...................................................................... 6 

2.1.1 Escoamento Bifásico em Bombas ...................................................................... 7 

2.1.2 Desempenho de BCS operando com mistura bifásica gás-líquido .................... 8 

2.2 Identificação de sistemas ....................................................................................... 9 

2.2.1 Seleção da estrutura do modelo ........................................................................ 10 

2.2.2 Planejamento dos experimentos para obtenção de dados ................................. 10 

2.2.3 Validação do Modelo ....................................................................................... 11 

2.3 Controle Robusto ................................................................................................. 11 

2.4 Software e Hardware in the Loop ........................................................................ 13 

Capítulo 3. FUNDAMENTOS TEÓRICOS ..................................................................... 15 

3.1 Controle    ........................................................................................................ 15 

3.1.1 Filtros de ponderação ....................................................................................... 18 

3.2 Máquinas de suporte vetorial (SVM) ................................................................... 19 

3.2.1 Máquinas de suporte vetorial linear. ................................................................ 20 

3.2.2 Máquinas de suporte vetorial linear com indicadores de erro. ......................... 21 



 xxviii 

3.2.3 Máquinas de suporte vetorial não linear. ......................................................... 23 

Capítulo 4. MODELAGEM DA BANCADA DE TESTES VIRTUAL ........................... 25 

4.1 Circuito de Testes de BCS ................................................................................... 25 

4.2 Proposta de Modelo da bancada de testes ............................................................ 26 

4.2.1 Modelagem da válvula de ar ............................................................................ 27 

4.2.2 Modelagem da Válvula de Fluido .................................................................... 32 

4.2.3 Modelagem da bomba booster ......................................................................... 33 

4.2.4 Modelagem da bomba BCS.............................................................................. 36 

4.3 Bancada Virtual de Testes. .................................................................................. 39 

4.4 Validação das Modelagens da Bancada de Testes Virtual................................... 41 

4.4.1 Modelos aproximados mediante algoritmos de SVMr ..................................... 41 

4.4.2 Comportamento da bancada de testes virtual ................................................... 45 

Capítulo 5. CONTROLE DO SISTEMA .......................................................................... 52 

5.1 Sistema de Controle em Malha Fechada .............................................................. 52 

5.2 Identificação dos sistemas para o controle a partir da bancada de testes virtual . 53 

5.2.1 Modelo linear de porcentagem de gás .............................................................. 53 

5.2.2 Modelo Linear da Pressão de entrada na BCS ................................................. 55 

5.3 Projeto de controle ............................................................................................... 56 

5.4 Resposta do sistema em malha fechada com controle ......................................... 62 

5.4.1 Comportamento da porcentagem de gás .......................................................... 64 

5.4.2 Comportamento da pressão de entrada na BCS ............................................... 68 

5.4.3 Curvas de desempenho da BCS obtidas com o controle .................................. 72 

Capítulo 6. SOFTWARE IN THE LOOP DO SISTEMA .................................................. 75 

6.1 MicroAutoBox com placa DSPACE DS-1511 .................................................... 75 

6.2 Software dSPACE CONTROLDESK ................................................................. 76 



 xxix 

6.3 Simulação em tempo real SIL .............................................................................. 77 

6.3.1 Interface no ControlDesk ................................................................................. 77 

6.3.2 Modelo de simulação SIL ................................................................................ 79 

6.3.3 Curvas de desempenho obtidas com o SIL ...................................................... 81 

Capítulo 7. CONCLUSÕES E RECOMENDAÇÕES DE TRABALHOS FUTUROS ... 83 

7.1 Conclusões ........................................................................................................... 83 

7.2 Recomendações de Trabalhos Futuros ................................................................ 84 

REFERÊNCIAS ................................................................................................................... 86 

APÊNDICE A. Avaliação dos Modelos. ........................................................................... 90 

APÊNDICE B. Regulação Mediante Bias/Variância. ....................................................... 91 

APÊNDICE C. Algoritmos Genéticos .............................................................................. 93 

APÊNDICE D. Programa do Projeto de Controle ............................................................ 96 

ANEXO i. Procedimento Experimental de Testes ............................................................ 98 

 

 

 



 1 

Capítulo 1. INTRODUÇÃO 

1.1 Introdução 

Na indústria do petróleo os métodos de elevação são fundamentais, sendo empregados para 

dar energia ao fluido no reservatório com a finalidade de levar o fluido até a superfície. O 

bombeio centrífugo submerso (BCS) é um método de elevação artificial amplamente utilizado e 

consiste na utilização de uma bomba centrífuga de múltiplos estágios, geralmente instalada na 

extremidade da coluna de produção, dentro do poço de petróleo.  

É comum que o fluido produzido no poço seja uma mistura bifásica líquido-gás. A presença 

de gás causa mudanças nas propriedades do fluido, tais como variação da densidade, viscosidade 

e presença de uma fase gasosa, que pode causar severos impactos no desempenho das bombas  

BCS. 

A utilização de BCS operando com escoamento bifásico líquido-gás é comum na indústria 

do petróleo. Por isso existe um grande interesse em conhecer o desempenho destas bombas. Na 

atualidade as pesquisas que estudam o comportamento do escoamento bifásico em bombas 

centrífugas são de natureza empírica e têm sido fundamentais para compreender e fornecer 

informações sobre o desempenho real das BCS operando com escoamento bifásico líquido-gás. 

O estudo do comportamento do escoamento bifásico em bombas centrífugas normalmente é 

realizado em laboratórios com bancadas de teste, que permitam controlar as condições de 

operações da bomba e as propriedades do fluido (vazão, densidade, temperatura, pressões e a 

porcentagem de gás na mistura). Deste modo se obtém as curvas de desempenho da bomba, com 

a finalidade de formular, modelar e estudar as instabilidades geradas pelo escoamento bifásico 

em BCS, como é apresentado nas pesquisas de MONTE, 2011, DUTRA, 2007 e GAMBOA, 

2007. 

Ao se implementar bancadas ou circuitos de testes para o estudo do desempenho das BCS, 

nasce a necessidade de automatizar estas bancadas com a finalidade de facilitar o processo do 

levantamento das curvas de desempenho das bombas, já que realizar este processo de forma 

manual é muito trabalhoso como diz MONTE, 2011, porque ao se ter que controlar distintas 



 2 

variáveis no circuito, onde umas dependem de outras, o processo de ajuste da condição de 

operação desejada se torna de tentativa e erro. 

Este projeto tem por objetivo projetar e simular um controle robusto que permita manter o 

escoamento multifásico água-gás na entrada de uma BCS em diferentes condições de operação da 

bomba. Este controle deve estabilizar a pressão e a porcentagem de gás na entrada da bomba com 

a finalidade de obter as curvas de desempenho da BCS em diferentes rotações, pressões e 

porcentagem de gás. 

O controlador é projetado usando um modelo simplificado linear aproximado de um 

modelo não linear, onde este modelo não linear é baseado em algoritmos de aprendizagem de 

máquinas supervisionadas ajustado mediante dados experimentais. O desempenho do controlador 

obtido é testado no modelo não linear, para estudar seu comportamento em diferentes condições 

de operação da bomba. 

1.2 Motivação 

As bombas centrífugas submersas fazem parte importante da indústria petrolífera, sendo um 

dos equipamentos mais empregados para a elevação artificial. As bombas, semelhantes à todas as 

máquinas, apresentam ao longo do seu funcionamento desgastes e quebras que se querem prever. 

Para prever o mau funcionamento das bombas, é necessário conhecer o comportamento e o 

desempenho destes equipamentos em diferentes condições de operação. Devido a que na 

literatura ainda não existem modelos que representem adequadamente o comportamento real do 

escoamento dentro de uma bomba pela complexidade do seu funcionamento, se realizam estudos 

experimentais.  

Os estudos experimentais se realizam em laboratórios empregando circuitos de teste onde 

se simulam as condições de operação da bomba. Atingir uma condição de operação é um 

procedimento bastante trabalhoso, por exemplo, para fazer o levantamento da curva de 

desempenho vazão-pressão, os testes são realizados à uma fração volumétrica de gás constante, e 

além disto, também se controla a pressão de sucção da BCS, que é mantida constante ao longo de 

toda a curva de desempenho. Como é apresentado no ANEXO i este procedimento é realizado de 

forma manual convertendo-se em um processo de tentativa e erro. 



 3 

Este processo de tentativa e erro aumenta o tempo de execução dos testes, gerando a 

necessidade de se automatizar os circuitos de testes motivando assim os objetivos desta pesquisa. 

1.3 Proposta de trabalho 

1.3.1 Objetivo Geral 

O objetivo do trabalho é projetar e simular um controle robusto que permita manter um 

escoamento multifásico (água-gás) conhecido em uma BCS em diferentes condições de operação 

da bomba. Este controle deve estabilizar a pressão e a porcentagem de gás na entrada da bomba 

com a finalidade de obter as curvas de desempenho da BCS em diferentes rotações, pressões e 

porcentagem de gás. 

1.3.2 Atividades Específicas 

Para alcançar o objetivo deste trabalho, foram definidas as seguintes tarefas para assim 

simular o controle da estabilização da pressão e da porcentagem de gás na entrada da bomba a 

partir de dados obtidos experimentalmente:  

 

Desenvolver um modelo não linear que consiga predizer o comportamento da condição de 

operação de uma BCS a partir das curvas de desempenho vazão–elevação para diferentes 

condições de trabalho (rotações, porcentagem de gás e pressões de entrada). 

 

? Desenvolver um modelo não linear que represente o comportamento de um circuito de 

testes para BCS. 

 

? Aproximar modelos lineares de ordem reduzida do comportamento da pressão e da 

porcentagem de gás a partir do modelo não linear da bancada de testes virtual de BCS. 

 

? Projetar um controlador robusto a partir dos modelos reduzidos para manter a pressão e a 

porcentagem de gás na entrada da BCS para diferentes condições de operação da bomba. 

 



 4 

? Testar o comportamento do controlador projetado no modelo não linear da bancada de 

testes virtual para BCS. 

1.4 Arquitetura 

Na Figura 1.1 é apresentada a arquitetura proposta, onde se tem um diagrama de blocos que 

contem dois blocos ou processos principais, o primeiro apresenta a modelagem da bancada de 

testes virtual e o segundo da metodologia para o projeto de controle.  

Do primeiro bloco se obtém um modelo não linear que representa o comportamento da 

bancada de testes virtual. Deste modelo não linear se realiza uma aproximação das variáveis a 

controlar (pressão e porcentagem de gás), com a finalidade de obter modelos lineares de ordem 

reduzida que representem o comportamento das variáveis em uma condição pré-estabelecida, 

para serem empregados no projeto de controle. Do segundo bloco se obtém um controlador 

robusto que é testado no modelo não linear determinando a estabilização do sistema em 

diferentes condições de operação. 

Modelagem do 

circuito de testes

Caixa branca Caixa preta

Modelos

SVMr

Validação

Modelo não 

linear

Projeto de 

Controle

Linearizar o modelo

Modelo ampliado com filtros 

de ponderação

Obter

Estimar o controle

Controlador
Simulações em tempo 

real

 

Figura 1.1 Arquitetura da proposta 



 5 

1.4.1 Organização da Dissertação 

Esse trabalho está estruturado em sete (7) capítulos.  

O Capítulo 1 apresenta a justificativa do trabalho, definição do problema, os objetivos e a 

arquitetura da pesquisa. 

 O Capítulo 2 apresenta uma revisão bibliográfica dos principais conceitos a serem tratados 

nesta pesquisa. Abordam-se conceitos de bombas centrífugas submersas (BCS), identificação de 

sistemas, controle robusto e o método de Software in the Loop (SIL). 

O Capítulo 3 apresenta os fundamentos teóricos dos controladores   , as bases do cálculo 

do controlador mediante as equações de Riccati e a finalidade dos filtros de ponderação. No 

capítulo também é apresentado os conceitos matemáticos das máquinas de suporte vetorial para 

regressão. 

O Capítulo 4 apresenta a modelagem do sistema a partir de métodos de caixa preta e branca 

obtendo um modelo de simulação da bancada de testes virtual.  

O Capítulo 5 apresenta a linearização dos modelos para o projeto de controle, como é 

aumentado o sistema acrescentando distúrbios, erros de medição e filtros de ponderação. 

Apresenta-se o comportamento do controle em diferentes pontos de operação da bancada de 

testes virtual. 

O Capítulo 6 apresenta o sistema empregado para a simulação em tempo real SIL e o 

respectivo modelo em malha fechada. São apresentadas também a curvas de desempenho obtidas 

na simulação SIL. 

O Capítulo 7 apresenta as conclusões da pesquisa, assim como também sugestões para 

trabalhos futuros. 

  



 6 

Capítulo 2. REVISÃO BIBLIOGRÁFICA 

Este capítulo apresenta os conceitos básicos referentes ao comportamento das BCS em 

escoamento multifásico, como pode ser calculada a porcentagem de gás presente na mistura 

bifásica e o desempenho das bombas operando com fluidos multifásicos. Apresenta-se um 

resumo do conceito de identificação de sistemas. O capítulo inclui uma introdução ao controle 

robusto, uma recompilação de seus inícios e aplicações e como são os passos básicos do processo 

de projeto de controle. O capítulo termina apresentando métodos de simulação em tempo real. 

 

2.1 Bomba Centrífuga Submersa (BCS) 

As bombas são máquinas rotativas hidráulicas que realizam trabalho sobre um fluido com a 

finalidade de transportá-lo de um ponto a outro. A BCS é acionada por um motor elétrico que 

fornece energia cinética ao fluido que é convertida parcialmente em energia de pressão. 

Principalmente as BCS são bombas de múltiplos estágios instalados em série, os rotores são de 

tipo fechado e são de fluxo misto ou radial (MONTE, 2011). 

Os estágios de uma BCS são compostos por dois componentes básicos: rotor e o difusor. O 

rotor é constituído por um conjunto de pás confinadas por paredes, onde as pás e paredes formam 

os canais do rotor. O difusor é o componente fixo, solidário à carcaça da bomba. 

Como pode ser observado na Figura 2.1 o fluido entra no rotor na direção axial com 

velocidade baixa, ao encontrar-se com as pás, e devido à elevada velocidade de rotação do rotor, 

o fluido é acelerado tangencialmente e sua velocidade é aumentada, convertendo o torque 

aplicado pela bomba ao fluido em energia cinética. O fluido em alta velocidade deixa o rotor e 

entra no difusor, parte estacionária da bomba, onde ocorre a conversão de parte da energia 

cinética em energia de pressão devido à que o fluido diminui a velocidade (WHITE, 1999). 



 7 

 

Figura 2.1 Estagio de BCS 

2.1.1 Escoamento Bifásico em Bombas 

O escoamento bifásico é constituído por diferentes parâmetros dimensionais e 

adimensionais que são apresentados à seguir: 

? Vazão Volumétrica de gás (   ): é o volume de gás por unidade de tempo injetado na 

bomba, medido na temperatura e pressão da sucção. A vazão volumétrica de gás é medida 

antes da injeção na bomba, em condições diferentes de sucção da bomba, sendo necessário 

calcular a vazão volumétrica na entrada da bomba mediante a conservação de massa 

apresentada na Equação ( 2.1 ) onde     é a massa específica do gás na sucção da bomba, 

       é a massa específica do gás no medidor de vazão e        é a vazão volumétrica 

de gás no medidor de vazão (MONTE, 2011). 

    
             

   
 ( 2.1 ) 

? Vazão Volumétrica do fluido (      ): é a soma da vazão volumétrica de gás    , e a 

vazão volumétrica de líquido      , ambas medidas a pressão e temperatura da sucção da 

bomba conforme mostrado na Equação (2.2). 

                  ( 2.2 ) 



 8 

 Sendo a vazão volumétrica de fluido a razão entre a vazão mássica       e a massa 

específica do líquido       à temperatura e pressão da sucção da bomba conforme 

apresentado na Equação (2.3). 

      
     

     
 ( 2.3 ) 

? Porcentagem de gás ou fração de Vazio (     ): é a razão entre a vazão volumétrica de gás 

e a vazão volumétrica total conforme mostrada na Equação (2.4): 

       
   

      
 

   
         

 ( 2.4 ) 

A fração volumétrica de gás está associada à condição de não escorregamento entre as 

fases, ou seja, quando as velocidades locais das fases são iguais. De modo geral, essa condição é 

válida para o escoamento de pequenas bolhas dispersas carregadas por uma fase líquida contínua 

que ocorre comumente em escoamentos com elevadas vazões de líquido (MONTE, 2011). 

2.1.2 Desempenho de BCS operando com mistura bifásica gás-líquido 

O gás livre presente no reservatório é produzido juntamente com o petróleo líquido, por isto 

é comum à utilização de bombas operando com escoamento bifásico líquido-gás. A energia 

cinética transferida ao fluido pelas máquinas hidráulicas é proporcional a sua massa específica, 

portanto a presença de gás na sucção da bomba deteriora o aumento de pressão do fluido ao ser 

bombeado (MONTE, 2011). 

A Figura 2.2 mostra as curva de desempenho de uma bomba operando com escoamento 

líquido-gás com diferentes porcentagens de gás. A curva (1) representa a operação da bomba com 

escoamento bifásico com uma quantidade de gás muito pequena. A curva (2) representa o 

comportamento da bomba com um aumento da porcentagem de gás, onde se observa apenas uma 

pequena diminuição da capacidade de elevação, já que a quantidade de gás ainda é mínima e o 

fluido tem um comportamento homogêneo, ou seja, as bolhas se encontram dispersas no líquido.  

A curva (3) apresenta uma curva característica quando a presença de gás na mistura é 

maior, evidenciando um ponto máximo na curva. Este ponto máximo é conhecido como ponto de 

“surging”, caracterizado por uma diminuição considerável na sua capacidade de bombeamento. 



 9 

Nessas condições o escoamento não é mais homogêneo, ou seja, o líquido e o gás na mistura 

multifásica escoam separadamente.  

Quando existe uma elevada presença de gás no escoamento a curva apresenta novas 

instabilidades. A curva (4) apresenta três regiões distintas de operação. A região (a) apresenta 

uma operação estável, ou seja, a mistura é homogênea. A região (b) inicia o ponto de surging 

apresentando uma queda de pressão na capacidade de bombeamento. A presença de grande 

quantidade de gás livre em baixas vazões pode causar o bloqueio da área disponível ao 

escoamento no rotor da bomba, fazendo com que a vazão seja nula, fenômeno conhecido como 

‘gas locking’. Esta grande instabilidade se destaca na região(c) da curva (4), 

 

 

Figura 2.2 Representação das curvas de desempenho de BCS com escoamento multifásico 

sendo    o diferencial de pressões entre a saída e a entrada da BCS, e   a vazão total de fluido, 

ou seja, vazão de liquido mais a vazão de ar como e apresentado na equação ( 2.2 ). 

2.2 Identificação de sistemas 

Entende-se por identificação de sistemas, a obtenção de um modelo que represente o 

comportamento de um sistema em estudo. O modelo pode ser linear, não linear, estático, 



 10 

dinâmico, determinístico, estocástico, dependente do tipo do processo e aplicação que se 

considere. A Figura 2.3 apresenta as atividades básicas para a identificação de sistemas (LJUNG, 

1999). 

Sistema

Planejamento dos 

experimentos

Seleção da estrutura 

do modelo

Obtenção de dados 

experimentais

Estimação do 

modelo

Implementação do 

modelo

Validação do 

modelo

 

Figura 2.3 Atividades básicas para o processo de identificação 

2.2.1 Seleção da estrutura do modelo 

Para obter um modelo matemático pode-se aplicar leis físicas a um sistema, mas o modelo 

pode apresentar parâmetros desconhecidos que são obtidos mediante testes reais (OGATA, 

1987). Existem três tipos de modelos (LJUNG, 1999) (AGUIRRE, 2007): modelo de caixa 

branca que se obtém de leis físicas; Modelos de caixa preta que postula uma estrutura matemática 

com parâmetros que são ajustados mediante dados experimentais; modelos de caixa cinza onde 

uma parte se obtém de leis físicas e outra de ajuste por experimentação. 

2.2.2 Planejamento dos experimentos para obtenção de dados 

No planejamento dos experimentos se decide os tipos de sinais de entrada, os distúrbios e 

os sinais de saída que vão ser parte dos experimentos para a identificação do sistema. As entradas 

do sistema devem garantir a excitação de todos os modos do sistema (AGUIRRE, 2007), algumas 

das entradas mais utilizadas são: impulso, sinais senoidais, sinais randômicos, etc. Dependendo 

da saída obtida se faz um processamento do sinal para aperfeiçoá-lo, por exemplo, a 

implementação de filtros para diminuir o ruído do sinal. 



 11 

2.2.3 Validação do Modelo 

Schlesinger (1979) define que o objetivo da validação é comprovar que o modelo obtido 

possui uma gama satisfatória de precisão de acordo com a aplicação pretendida do sistema 

(SCHLESINGER, 1979), (SARGENT, 1998).  

A validação experimental busca definir as limitações do modelo, como são os erros de 

predição e os limites até onde o modelo é preditivo. Para isto se fazem testes nos modelos obtidos 

com dados diferentes aos utilizados na obtenção dos modelos. A Figura 2.4 apresenta uma 

comparação dos dados reais aos dados preditos por um modelo ajustado. A partir do sistema real 

tomam-se novos dados que são introduzidos ao modelo para predizer novas características, e a 

partir das características preditas e as reais se faz uma comparação, com a finalidade de 

determinar o quanto representativo é o modelo (ver APÊNDICE A). 

 

Figura 2.4 Validação experimental 

2.3 Controle Robusto 

Ao projetar um sistema de controle, a eficiência deste vai depender da similaridade de 

nosso modelo com o fenômeno físico a controlar. Quando se modelam fenômenos físicos muito 

Sistema Real
Dados Reais

Erro de teste

=0,01%

Modelo

+



 12 

complexos o modelo matemático não consegue representar completamente o comportamento 

deste, já que o modelo foi simplificado com os parâmetros fundamentais do sistema. Em outras 

palavras o processo de modelagem acrescenta erros e incertezas no desenho de sistemas de 

controle, pela simplificação aplicada no processo de modelagem, como por exemplo, tentar 

representar o sistema real por  um sistema linear ou invariante no tempo. Por isto é que a teoria 

de controle clássica perde aplicabilidade com sistemas reais complexos como sistemas não 

lineares, variantes no tempo ou sistemas MIMO (Múltiplas entradas e múltiplas saídas) 

(OGATA, 2002), (RODRÍGEZ, 1996). 

A década de oitenta é considerada a época onde foi desenvolvido o método de controle 

robusto. DOYLE, 1981 apresenta como as declarações SISO clássica de problemas de desenho de 

realimentação com incertezas não estruturadas podem se generalizar de forma confiável a 

sistemas múltiplas-entradas e múltiplas-saídas (MIMO). ZAMES e FANCIS, 1983 apresentaram 

feedbacks que minimizam a função de sensibilidade de um sistema de uma variável representado 

por sua resposta de frequência. O problema foi estudado num contexto geral, e alguns exemplos 

de    foram resolvidos. Os resultados foram estendidos para sistemas instáveis onde foram 

propostas formulações para manter a estabilidade em malha fechada. STEIN e ATHANS, 1987 

apresentam um tutorial para o procedimento de projeto para sistemas de realimentação 

multivariáveis lineares LQG / LTR, já que LQR / LTR é apresentado como uma solução para    

para funções de transferência no domínio da frequência. DOYLE, 1989 apresenta um tipo de 

tutorial para resolver problemas em malha fechada simples de    e    em formulação de 

variáveis de estados.  

Algumas das aplicações da teoria de controle robusto são realizadas, por exemplo, em 

processos químicos, robótica, estruturas flexíveis como SARRACINI, 2006, OKUBO, 1998 

DRAKUNOV, 1992 e controle de aeronaves como VIVAS, 2011, DE OLIVEIRA, 2009. 

Os sistemas de controle podem ser obtidos mediante um procedimento passo a passo 

apresentado na Figura 2.5, partindo desde o modelo físico até a validação do sistema com o 

controle (SKOGESTAD, 2001). 



 13 

 

Figura 2.5 Passos básicos para o desenvolvimento de um sistema de controle 

2.4 Software e Hardware in the Loop 

O hardware e software in the loop (HIL e SIL) são técnicas que permitem realizar uma 

representação rápida do modelo virtual de um sistema, em um protótipo físico através de sistemas 

embarcados, com a finalidade de permitir a realização de testes mais próximos com a realidade 

DEL SIGNORE, 2005. As simulações de SIL e HIL têm sido usadas na área da Indústria 

Automotiva de Produção no desenvolvimento de transmissões, suspensões e pneus. Outra área 

onde são implementadas o HIL e SIL são a robótica em aplicações gerais. 

A seguir são apresentadas algumas vantagens dos métodos HIL e SIL: 

Estudar o sistema a ser controlado

Modelar o sistema e simplificar o modelo

Decidir quais variáveis devem ser medidas e manipuladas

Fazer a escolha do controlador a ser usado

Escolher as medidas de desempenho, com base nos objetivos gerais do projeto

Projetar o controlador

Analisar o sistema de controle resultante

As especificações estão 

satisfeitas?

Simule o sistema controlado resultante

Sim

Não

Escolha de hardware e software para o controlador real

Testar e validar o sistema de controle.

O sistema satisfaz os objetivos 

do projeto?

Sim

Não



 14 

? Desenvolver produtos com maior rapidez e menores custos. 

? Melhorar a interação entre protótipos físicos e subsistemas modelados, já que se pode 

verificar o comportamento do produto com maior rigor, aumentando a credibilidade dos 

testes. 

? Detectar e antecipar falhas no produto antes que este seja industrializado. 

 Uma das maiores desvantagens dos métodos é que estão limitadas aos recursos 

computacionais, porque o método requer recursos elevados e complexos para obter uma boa 

precisão nos resultados (GORDILLO, 2012). 

 

Figura 2.6 Componentes do HIL e SIL 

A Figura 2.6 mostra o conceito de simulações em tempo real que estão compostos 

principalmente do modelo matemático da planta, sensores, atuadores, sistemas de aquisição, 

unidade de controle que tem como objetivo comunicar a interface de usuário com o sistema de 

aquisição, e a interface gráfica onde o usuário pode interagir com o sistema. 

 O software in the loop (SIL) segundo CHOI, 1999 é um método pelo qual algumas partes 

do hardware são substituídas por simulações baseadas em software, ou seja, é quando o 

controlador é físico e a planta é substituída por um modelo matemático, conectados entre si e 

simulados em tempo real.  

Modelo Matemático

Unidade de controle

Componente Físico

A
tu

a
d

o
re

s

S
e
n

so
re

s

Interface gráfica

SIL

ControleControle

Hardware in the Loop Software in the Loop



 15 

Capítulo 3. FUNDAMENTOS TEÓRICOS 

Neste capítulo se apresentam os fundamentos teóricos dos controladores   , as bases de 

funcionamento, como é calculado o esforço de controle, como é resolvido o problema de 

otimização mediante as equações de Riccati e como os filtros de ponderação melhoram o 

comportamento do controle. No capítulo também é apresentado os conceitos matemáticos das 

máquinas de suporte vetorial para regressão para o problema linear e como é solucionado o 

problema para o caso não linear com o kernel. 

3.1 Controle    

O controlador    tem como objetivo minimizar a norma ? da função de transferência, ou 

seja, reduzir o pico de amplitude no diagrama de bode para o problema SISO, ou o pico do maior 

valor singular no caso MIMO. 

A representação básica em diagrama de blocos utilizado em controlador robusto é 

apresentada na  Figura 3.1, 

 

Figura 3.1 Esquema básico do controle    

onde: 

?  ( ) é o sistema sendo controlado 

?  ( ) é o controlador 

?   é o vetor de entradas exógenas (distúrbios externos, ruídos de medições e referências) 

?   é o vetor de sinais de controle. 



 16 

?   é o vetor de sinais que se deseja controlar e utilizado para medir o desempenho do 

sistema (sinais de controle e estados) 

?   é o vetor de sinais enviados ao controlador. 

O controle    aumenta a quantidade de incertezas que podem ser permitidas sem 

desestabilizar o processo  ( ), aumentando a margem de estabilidade robusta do respectivo 

processo. 

Da Figura 3.1 podemos escrever as equações de estados do problema    na forma 

(RODRÍGEZ, 1996, SILVA, 2010): 

 ?            
               
               

 ( 3.1 ) 

Ou na forma matricial 

{
 ?
 
 
}   {

 
 
 

} ( 3.2 ) 

Sendo 

  [
     
        
        

] ( 3.3 ) 

 

A matriz de transferência do sistema pode ser representada na forma: 

[
 
 ]  [

      
      

] [
 
 

] ( 3.4 ) 

sendo     a função de transferência entre as entradas exógenas   e as medidas de 

desempenho  ,     é a função de transferência entre os sinais de controle   e as medidas de 

desempenho  ,     é a função de transferência entre as entradas exógenas   e os sinais enviados 

ao controlador   e     é a função de transferência entre os sinais de controle   e os sinais 

enviados ao controlador  . 



 17 

Tem-se portanto que: 

             ( 3.5 ) 

             ( 3.6 ) 

onde o esforço de controle está dado por: 

   ( )   ( 3.7 ) 

Substituindo ( 3.7 ) em ( 3.6 ) e isolando  , tem-se: 

             ?  

  (      )
       

( 3.8 ) 

Substituindo ( 3.7 ) em ( 3.5 ), tem-se: 

              ( 3.9 ) 

Ao substituir a equação  ( 3.8 ) em ( 3.9 ), pode-se obter a relação entre   e   do sistema 

em malha fechada como é apresentado na equação ( 3.10 ). 

  [         (      )
     ]  ( 3.10 ) 

Da equação (3.10) podemos escrever     como sendo: 

            (      )
  

    ( 3.11 ) 

onde     é a matriz de transferência entre a entrada   e a saídas de desempenho  . Esta matriz 

de transferência é chamada de transformação linear fracional inferior. 

O projeto de controle    tem como objetivo buscar um   que minimize a norma    da 

matriz de transferência     e garanta a estabilidade do sistema (SILVA, 2010). O problema de 

otimização associado ao projeto de controladores    é descrito na Equação ( 3.12 ) 

      
 

?   ?  ( 3.12 ) 

Se considera que o problema sub-ótimo procura minimizar a norma    da matriz de 

transferência entre as entradas exógenas e as saídas de desempenho, onde esta norma deve ser 

menor que um limite factível   e maior que zero tornando o problema na forma: 



 18 

?   ?    ( 3.13 ) 

O controlador   é ótimo quando     é minimizado até que a condição na Equação ( 3.13 

) não seja respeitada ZHOU,1998. O problema de otimização se torna portanto na forma: 

    
         ?   ?   

 ( 3.14 ) 

O problema    pode ser resolvido com o auxílio de duas equações de Riccati 

(RODRÍGEZ, 1996), cujas soluções são utilizadas para o cálculo do controlador   . 

 

3.1.1 Filtros de ponderação 

Os filtros de ponderação são filtros colocados nas entradas e nas saídas do sistema a ser 

controlado no momento do projeto do controle. 

Os filtros de ponderação aplicados nas saídas atuam de forma que os sistemas em malha 

fechada apresentem um comportamento pré-definido, por exemplo, seja um distúrbio afetando 

mais a saída de desempenho do sistema em baixa frequência, pode-se optar por projetar um filtro 

de ponderação que atenue a influência do distúrbio na baixa frequência, e incluir este filtro no 

projeto do controlador. 

Os filtros de ponderação utilizados nas entradas também têm como objetivo dar aos sinais 

de entrada uma composição espectral especifica. Por exemplo, imaginando uma entrada exógena 

que apresenta componentes de baixas frequências, acrescentando um filtro passa-baixa permite 

que o sinal de controle atue só nas baixas frequências e as componentes de alta frequência sejam 

ignoradas (SARRACINI, 2006). 

A Figura 3.2 apresenta o conjunto geral da planta e controlador com filtros de ponderação 

 ( ) nas entradas exógenas (referencia  , distúrbio no esforço de controle   , distúrbio na saída 

do sistema    e ruído de medição  ) e nas saídas de desempenho (saída do sistema  , erro do 

sistema   e o esforço de controle  ), sendo as saídas de desempenho da forma: 

  



 19 

       (      )
        
       

 ( 3.15 ) 

 

 

Figura 3.2 Sistema geral com filtros de ponderação nas entradas e saídas 

3.2 Máquinas de suporte vetorial (SVM) 

As máquinas de suporte vetorial (SVM, sigla em inglês Support Vector Machines) são 

algoritmos de aprendizagem de máquinas supervisionadas para problemas de classificação e 

regressão desenvolvidos por Vladimir Vapnik (HONG, 2013). 

Para o caso de regressão tem-se um conjunto de dados de treinamento {(     )}         , 

onde cada      
  representa uma amostra dos dados de entrada e cada       um objetivo. O 

conjunto de dados poderia representar, por exemplo, como o valor de uma casa está sujeito ao 

tamanho da mesma como é apresentado na Figura 3.3. O objetivo da SVM é achar uma função 

 ( ) que tenha como máximo um   de erro dos objetivos reais das amostras   . Ou seja, estimar 

os coeficientes de regressão de  ( ) com os requisitos dados (STOEAN, 2006 e SMOLA_2004). 



 20 

 

Figura 3.3 Problema de regressão linear com SVM 

3.2.1 Máquinas de suporte vetorial linear. 

Suponha-se que um modelo de regressão linear pode ajustar os dados de treinamento, 

consequentemente a função  ( ) tem a forma: 

 ( )  ?   ?    ( 3.16 ) 

onde         é a inclinação do plano de regressão e      é o ponto onde a superfície 

intersecta o eixo  .  

Pode ser dito que a SVM tem como objetivo aproximar uma função   aos dados de 

treinamento com uma precisão  , matematicamente isto se pode ser escrito na forma: 

|   (?    ?   )|              ( 3.17 ) 

ou 

{
   ?    ?      
?    ?        

            ( 3.18 ) 

Por outro lado o objetivo da SVM é obter a menor margem que contenha a maioria dos 

dados com a menor inclinação, isto é,   com a condição:  

   
 

 

 
? ?  ( 3.19 ) 



 21 

Ou seja, o problema de otimização no caso de SVM regressão linear é dado por: 

{
   

 

 

 
? ? 

          {
   ?    ?      
?    ?        

            
 ( 3.20 ) 

3.2.2 Máquinas de suporte vetorial linear com indicadores de erro. 

Pode acontecer que a função  ( ) não seja capaz de ajustar-se a todos os dados de 

treinamento e por isto a SVM permite alguns erros. Para que a SVM permita erros se acrescentam 

variáveis de relaxamento    e   
  na condição de aproximação dos dados de treinamento ligados a 

cada uma das amostras, da forma (STOEAN, 2006, SMOLA, 2004 e HONG, 2013): 

{
 
 

 
    

 

 

 
? ?   ?( 

 
  

 
 )

 

   

          {

   ?    ?         
?    ?           

 

 
 
  

 
   

            

 ( 3.21 ) 

onde     é um parâmetro que penaliza os erros permitidos, ou seja,  .determina o equilíbrio 

entre a curvatura da função  ( ) respeito à quantidade de derivações máximas permitidas por   

como e apresentado na Figura 3.4.  

 

Figura 3.4 Efeito do parâmetro   

A equação ( 3.21 ) pode ser resolvida empregando a formulação dual e a programação 

quadrática (HONG, 2013). A ideia é construir uma função de Lagrange da função objetivo 



 22 

acrescentando um conjunto de variáveis chamadas de multiplicadores de Lagrange. A 

correspondente formulação é apresentada na forma (SMOLA, 2004):  

  
 

 
? ?   ?( 

 
  

 
 )

 

   

 ? ( 
 
 
 
  

 
  

 

 )

 

   

 ?   (        ?    ?   )

 

   

 ?   
 (   

 
     ?    ?   )

 

   

 

( 3.22 ) 

sendo   a função de Lagrange e      
        

  os multiplicadores de Lagrange, onde ditos 

multiplicadores tem que satisfazer: 

     
        

     ( 3.23 ) 

Deriva-se   com respeito às variáveis principais (         
 ) obtendo-se: 

  

  
 ?(  

    )

 

 

   ( 3.24 ) 

  

  
   ?(     

 )  

 

 

   ( 3.25 ) 

  

   
          

  

   
      

    
   

 ( 3.26 ) 

Substituindo ( 3.24 ), ( 3.25 ) e ( 3.26 ) em ( 3.22 ) se obtém o problema de optimização 

dual: 

   [ 
 

 
?(     

 )(     
 )?      ?

 

   

  ?(     
 )

 

   

 ?   (     
 )

 

   

]

          {
?(  

    )

 

   

  

     
       

 ( 3.27 ) 

Depois de solucionar o problema dual a decisão ótima pode ser obtida (HONG, 2013):  



 23 

 ( )  ?(     
 )?      ?   

 

   

 ( 3.28 ) 

A equação ( 3.28 ) é chamada de expansão de máquina de suporte vetorial, ou seja,   pode 

ser descrita como uma combinação linear das    de treinamento. Num certo sentido a 

complexidade da representação de uma função SVM é independente do número de dimensões do 

espaço de entradas, e depende só do número de vetores de suporte (SVs). 

3.2.3 Máquinas de suporte vetorial não linear. 

Os problemas não lineares são mais comuns nas aplicações práticas. A forma de resolver 

este tipo de problemas é usando uma função Kernel ou núcleo. A função Kernel pode projetar os 

dados para um espaço de maior dimensionalidade como é apresentado na Figura 3.5, e assim 

melhorar a capacidade da máquina de suporte vetorial linear de representar a relação não linear 

no espaço de entrada original. Isso leva ao problema de otimização da equação ( 3.29 ) (HONG, 

2013): 

   [ 
 

 
?(     

 )(     
 ) (     )

 

   

  ?(     
 )

 

   

 ?   (     
 )

 

   

]

          {
?(  

    )

 

   

  

     
       

 ( 3.29 ) 

sendo  (     ) a função de Kernel. 

 

Figura 3.5 Mapeamento de alta dimensionalidade 



 24 

A correspondente função de decisão ótima com o Kernel é dada por: 

 ( )  ?(     
 ) (     )   

 

   

 ( 3.30 ) 

Quanto maior for à dimensão do espaço de descrição, o kernel vai apresentar uma maior 

probabilidade de obter um hiperplano. Ao transformar o espaço de entrada em um espaço 

superior (teoricamente de dimensão infinita), é possível obter uma separação das classes 

mediante hiperplanos. 

Existem diversos tipos de kernel como e apresentado na Tabela 3.1, o kernel empregado 

neste trabalho e uma função gaussiana onde o parâmetro    da gaussiana é o limiar para a 

transformação das novas características. 

Tabela 3.1 Tipos de kernel 

Kernel Função Parâmetros 

Gaussiana  
 (

|    |
 

   
)
    

Polinomial (     )    

Perceptron 2 camadas      (   
      )        

 

  



 25 

Capítulo 4. MODELAGEM DA BANCADA DE TESTES VIRTUAL 

Neste capítulo é apresentada a metodologia para a modelagem da bancada de testes virtual 

para BCS. Primeiramente é exposto o sistema em estudo, seus componentes principais e assim 

como é seu princípio de funcionamento. A partir do sistema apresentado, realizou-se a 

modelagem de cada componente que faz farte do sistema, obtendo um modelo geral não linear e 

não paramétrico composto por submodelos de caixa preta e caixa branca.  

4.1 Circuito de Testes de BCS 

O circuito de testes de BCS é constituído basicamente por tanques de água e ar, tubulação, uma 

bomba booster, válvulas de vazão e instrumentação conforme apresenta o diagrama esquemático da 

bancada de testes virtual da Figura 4.1. 

Bomba boosterTanque de agua

Tanque de ar

Motor P? 

Medidor de vazão

Medidor de vazão

Válvula controle de flujo

Válvula controle de vazão de ar

BCS
Torque

P? 

T? T? 

T? P?

Agua

Ar

Agua + Ar

 

Figura 4.1 Circuito de testes para BCS 

Na bancada de testes da Figura 4.1, a bomba booster bombeia a água do tanque para a linha de 

testes com o objetivo de vencer as perdas de carga devidas à tubulação e acessórios. A bomba booster 

tem a função também de controlar a pressão na entrada da BCS. Este ajuste de pressão é realizado 

mediante o controle da rotação do eixo da bomba. Antes de chegar à BCS o fluido passa por um 

medidor de vazão. O ar utilizado como parte gasosa, é comprimido é injetado na sucção da BCS 



 26 

passando também por um medidor de vazão. O controle da vazão de gás é realizado por uma válvula 

que fica depois do medidor de vazão.  

O fluido multifásico é bombeado de volta ao tanque de água onde é realizada a separação 

gravitacional das fazes da mistura. A vazão de fluido é controlada por uma válvula instalada na 

tubulação de recalque. O acionamento da BCS é realizado por um motor de indução trifásico 

controlado por um variador de frequência. No circuito de testes também são medidas, as pressões, 

temperaturas, viscosidades na entrada e saída da BCS, torque no eixo de acionamento da bomba, 

corrente e tensão no motor elétrico. 

4.2 Proposta de Modelo da bancada de testes 

Foi desenvolvido um modelo matemático que representasse o comportamento da bancada 

de testes que apresenta como variáveis de entrada a rotação da bomba booster WBtr, a rotação da 

BCS WBCS, o deslocamento do pistão da válvula de controle do fluido de saída do escoamento da 

bomba BCS Xvalf, a voltagem de excitação da eletroválvula de controle de vazão de ar, e como 

variáveis de saída a pressão de entrada da bomba BCS    e a porcentagem de vazio      . A 

Figura 4.2 apresenta uma proposta do sistema a modelar o qual está representada pelos 

componentes principais de um circuito de testes para BCS.  

 

Figura 4.2 Diagrama de blocos do sistema 

Bomba booster

Válvula Ar

Vazio

BCS

Válvula Fluido

+



 27 

Da Figura 4.2 se pode observar que o modelo da bancada virtual contem cinco (5) 

componentes principais apresentados a seguir: 

? A válvula de ar contém como entradas a voltagem de excitação da válvula   , a pressão 

   e temperatura    na entrada na BCS, a pressão    e temperatura    no reservatório de 

ar. Como saída a válvula de ar tem a vazão de ar    . 

? A válvula de fluido como entradas principais tem deslocamento do pistão       e a 

pressão gerada pela BCS   . Como saída a válvula de fluido tem a vazão de ar      . 

? A bomba booster tem como entradas a rotação do eixo      e a vazão de agua      , e 

como saída a pressão de entrada na BCS   . 

? A BCS contém como entradas a rotação do eixo     , a pressão de entrada na BCS   , a 

vazão total de fluido        e a porcentagem de gás      . Como saída a pressão gerada 

pela BCS   .. 

? O calculo da porcentagem de gás      , tem como entrada a vazão de ar     e a vazão de 

agua        

A seguir vão ser apresentados os procedimentos de como foi desenvolvido cada um dos 

modelos dos componentes do circuito de testes de BCS mostrados na Figura 4.2. A porcentagem 

de gás pode ser calculada empregando a equação ( 2.4 ) apresentada na subseção 2.1.1 

4.2.1 Modelagem da válvula de ar 

A Figura 4.3 apresenta o desenho esquemático básico de uma eletroválvula de controle de 

vazão. Baseando-se no esquema se pode obter o modelo matemático de cada um dos segmentos 

que compõem a válvula apresentados no diagrama de blocos da Figura 4.4, sendo: 

?   ( ) é função de transferência do componente elétrico, onde a entrada    é a voltagem 

de excitação do circuito, e a saída    é a força gerada pela eletroválvula. A equação ( 4.7 ) 

apresenta a formulação do componente elétrico. 

?   ( ) é a função de transferência do componente mecânico, tendo como entrada a soma 

de    com    que é um distúrbio devido à pressão exercida pelo fluido ao pistão da 

válvula, tendo como saída o deslocamento do pistão     . Na equação ( 4.14 ) é 

apresentado a formulação do componente mecânico da válvula. 



 28 

?    ( ) é a função de transferência do componente pneumático. Tem como entrada      e 

como saída fluxo de ar    . Nas equações ( 4.17 ) e ( 4.18 ) é apresentado a formulação 

do componente pneumático. 

 

Figura 4.3 Eletroválvula de controle de vazão de ar 

 

 

Figura 4.4 Diagrama de blocos da eletroválvula 

4.2.1.1 Equações eletromecânicas 

O esquema apresentado na Figura 4.5 mostra o circuito elétrico da eletroválvula, onde    é 

a voltagem de excitação do circuito,    é a voltagem na saída do amplificador,   é a corrente na 

bobina,    é o ganho do amplificador de corrente DC,    e    são as resistências devidas ao 

amplificador e à bobina,    é a indutância da bobina,      é a voltagem induzida pela força 

eletromotriz,    é o coeficiente da força eletromotriz, e      é o deslocamento do pistão 

(ZHANG, 2010). 



 29 

 

Figura 4.5 Circuito equivalente da eletroválvula 

Da Figura 4.5 temos que: 

  ( )      ( )      ( )     ??( )      ( ) ( 4.1 ) 

  ( )    ( )    ( 4.2 ) 

    ( )     ?   ( ) ( 4.3 ) 

Substituindo ( 4.2 ), ( 4.3 ) em ( 4.1 ) temos: 

  ( )        ( )      ( )     ??( )     ?   ( ) ( 4.4 ) 

Fazendo a transformada de Laplace com condições iniciais iguais a zero (     ) temos: 

 {  ( )   }     
  {    ( )      ( )     ??( )     ?   ( )}     

 ( 4.5 ) 

  ( )       ( )      ( )        ( )           ( ) ( 4.6 ) 

Finalmente a equação fica na forma: 

       [            ]  ( )            ( ) ( 4.7 ) 

A Figura 4.6 apresenta um esquema simplificado da parte mecânica da válvula que é um 

mecanismo composto basicamente de uma massa   , uma mola   , e um mecanismo de 

amortecimento    gerado pelo atrito entre os componentes e o fluido na válvula.  



 30 

 

Figura 4.6 Esquema equivalente do mecanismo da válvula de ar 

Da Figura 4.6 temos que: 

   ?   ( )     ?   ( )        ( )    ( )    ( ) ( 4.8 ) 

  ( )      ( ) ( 4.9 ) 

sendo    a constante de proporcionalidade eletromecânica. Aplicando a transformada de Laplace 

temos 

 {   ?   ( )     ?   ( )        ( )}       {  ( )    ( )}     
 ( 4.10 ) 

 {  ( )}       {    ( )}      ( 4.11 ) 

   
     ( )         ( )        ( )    ( )    ( ) ( 4.12 ) 

  ( )      ( ) ( 4.13 ) 

Finalmente as equações ficam na forma: 

    
                    ( 4.14 ) 

        ( 4.15 ) 

onde    é a força gerada pela eletroválvula,    é a força exercida pelo fluido ao pistão, e     é a 

constante de proporcionalidade eletromecânica.  



 31 

4.2.1.2 Equações Pneumáticas 

Considerando o fluxo de ar estável passando por um orifício como é apresentado na Figura 

4.7, e supondo que não existem os efeitos de atrito, pode-se escrever as equações de fluxo 

mássico numa válvula (OGATA, 1987). 

 

Figura 4.7 Fluxo de um gás através de um orifício 

Quando a condição de pressão é            a velocidade do gás é subsônica, e o fluxo 

mássico pode ser obtido pela expressão: 

        ?
 

     
 ?  (     ) ( 4.16 ) 

Se         [
   

    
], e supondo que o fator de expansão   é quase constante para (  

  

  
      ), pode-se dizer que        . Substituindo estes valores em (4.16) tem-se: 

             
 

?  
 ?  (     )    (  

  
  

      ) ( 4.17 ) 

 

Quando a condição de pressão é            , a velocidade do gás é sônica e o fluxo 

mássico não depende da pressão de entrada ao orifício, e a equação do fluxo de ar pode ser obtida 

por: 

             
  

?  
    (

  
  

      ) ( 4.18 ) 



 32 

onde    é dada em    ,    e    em pressões absolutas,    e     em    . 

Sendo uma válvula tipo agulha como se apresenta na Figura 4.8, a dimensão    pode ser 

obtida pela expressão: 

 

Figura 4.8 Válvula tipo agulha 

  (    )  

{
 

 
                 

 (           )                        
   

 

 
                       

 ( 4.19 ) 

sendo         o deslocamento máximo do pistão da válvula. 

4.2.2 Modelagem da Válvula de Fluido 

O modelo da válvula de fluido tem como objetivo calcular a vazão de líquido presente na 

mistura a partir da pressão gerada pela BCS e da abertura da válvula. A Figura 4.9 apresenta uma 

válvula de controle de vazão tipo agulha. Tendo em conta o fluxo através de orifícios, pode-se 

escrever que o fluxo mássico numa válvula esta dado por: 



 33 

 
 

 

Figura 4.9 Válvula de controle de fluido 

           ?
 

 
(     ) ( 4.20 ) 

onde    pode ser obtida pela expressão: 

  (     )  

{
 
 

 
 

                  

 (           )                           

   
 

 
                         

 ( 4.21 ) 

 

sendo          o deslocamento máximo do pistão da válvula de fluido, a densidade do fluido   

vai depender da quantidade de ar na mistura.  

4.2.3 Modelagem da bomba booster 

Na Figura 4.10 apresenta a proposta do modelo da bomba booster a qual está constituída 

por duas sessões; o modelo de elevação da bomba que depende dos sinais de entrada de rotação e 

de vazão de água da bomba fornecendo como sinal de saída a pressão, e o modelo da rotação do 

eixo da bomba que depende do sinal de torque de entrada para fornecer o sinal de rotação de 

saída do eixo da bomba. 

 



 34 

SVM  

Dados de 

treinamento

Modelo da elevação 

 Rotação eixo

Vazão de agua

Pressão de saída
Modelo de rotação 

do eixo

F???? 

 

Figura 4.10 Diagrama de blocos modelo bomba booster 

4.2.3.1 Modelo da elevação da bomba booster 

Para obter o modelo da elevação da bomba booster, utilizou-se um processo de 

identificação de caixa preta baseado em aprendizagem de máquina. 

O algoritmo de aprendizagem de máquina usado para o desenvolvimento do modelo da 

bomba booster é o de máquinas de suporte vetorial para regressão (SVMr, siglas em inglês). A 

Figura 4.11 apresenta a proposta do modelo da bomba booster, sendo a rotação do eixo      e a 

vazão       as entradas ao modelo e a pressão    a saída. 

 

Figura 4.11 Diagrama de blocos do modelo de elevação da bomba booster 

A SVMr implementada emprega um “kernel” tipo gaussiano para obter um mapeamento 

completo entrada-saída. Os dados de treinamento foram extraídos das curvas de desempenho 

vazão-pressão apresentados no trabalho de POTTEBAUM 1984. Os dados exibem as curvas de 

uma bomba centrífuga operando a rotações diferentes, como mostra a Figura 4.12. 



 35 

 

Figura 4.12 Efeito da rotação na bomba booster 

O SVMr treinado deve conter informação suficiente para reproduzir os dados de 

treinamento e também interpolar condições de operação da bomba que não foram incluídas no 

treinamento do SVMr. Com o objetivo de obter os melhores parâmetros (o   da regularização 

apresentado na equação ( 3.21 ), o    do “kernel” gaussiano apresentado na Tabela 3.1e o   da 

margem apresentado na equação ( 3.20 )), utilizou-se o método de regulação mediante 

bias/variância (APÊNDICE B). Para o treinamento do modelo de SVMr utilizou-se os 

“toolboxes” de distribuição gratuita (SVMLIB) executadas no MatLab (CHANG, 2011) para 

realizar o treinamento da SVMR para predisser novas características se emprega a equação ( 3.30 

) apresentada na subseção 3.2.3 empregando os vetores de suporte   , multiplicadores de 

Lagrange    e o parâmetro de bias   otimizados pelo “toolbox” após do treinamento. 

4.2.3.2 Modelo da velocidade de rotação do eixo da bomba 

A Figura 4.13 apresenta um modelo simplificado de um eixo, sendo      a inércia do eixo 

do rotor,      o amortecimento devido ao atrito e do fluido no rotor da bomba,      o torque de 

entrada ao modelo e      a velocidade de rotação do eixo. 



 36 

 

Figura 4.13 Esquema eixo bomba booster 

Da Figura 4.13 temos que: 

     ?   ( )       ?   ( )      ( ) ( 4.22 ) 

    ( )   ?   ( ) ( 4.23 ) 

Substituindo 

     ?   ( )           ( )      ( ) ( 4.24 ) 

 {     ?   ( )           ( )}       {    ( )}      ( 4.25 ) 

           ( )           ( )      ( ) ( 4.26 ) 

    
    

 
 

           
 ( 4.27 ) 

Da Equação ( 4.27 ) pode-se dizer que a velocidade de saída do eixo da bomba para uma 

entrada de torque apresenta um comportamento de um sistema de primeira ordem. 

4.2.4 Modelagem da bomba BCS 

O modelo da BCS está baseado em um modelo de caixa preta como se apresenta na Figura 

4.14, tendo como entradas do modelo a pressão de entrada na BCS, a porcentagem de gás na 

mistura, a rotação da BCS, e a vazão da mistura água-gás, e como saída a pressão de saída gerada 

pela BCS. 



 37 

 

Figura 4.14 Diagrama de blocos do modelo da BCS 

O modelo da BCS semelhante ao modelo da booster foi desenvolvido mediante SVMr 

usando um “kernel” tipo gaussiano. Os dados para o treinamento do modelo foram extraídos da 

dissertação de mestrado MONTE (2011) onde o autor faz um estudo experimental de bombas 

BCS operando com escoamento bifásico líquido-gás, apresentando dados do comportamento de 

uma BCS a diferentes rotações, pressões de entrada, e porcentagens de gás na mistura. A Figura 

4.15 apresenta curvas de desempenho da bomba BCS operando em diferentes condições de 

pressão de entrada, rotação, e porcentagem de gás. 

 

a) 



 38 

 

b) 

 

c) 

 

Figura 4.15 a) Efeito da rotação, b) Efeito da Pressão c) Efeito do ar na mistura.  



 39 

Com o objetivo de obter os melhores parâmetros (o   da regularização, o   do “kernel” 

gaussiano e o   da margem), utilizaram-se algoritmos genéticos (APÊNDICE C), já que o espaço 

de procura destes algoritmos é maior que a validação cruzada, e pela quantidade de dados 

disponíveis o custo computacional é menor. Para o treinamento do modelo de SVMr utilizou-se 

os “toolboxes” de distribuição gratuita (SVMLIB) executadas no MatLab (CHANG, 2011). 

4.3 Bancada Virtual de Testes. 

Para a obtenção da bancada virtual de testes foram desenvolvidos dois modelos que estão 

interligados como é apresentado na Figura 4.16, que contém respectivamente cada uns dos 

modelos de cada componente da bancada de testes virtual para BCS da Figura 4.1.  

O primeiro modelo ModeloValar_sf calcula a porcentagem de gás na mistura        e a 

vazão de ar na entrada da BCS     , onde estes dois parâmetros vão depender da abertura da 

válvula de ar      , da pressão de entrada na BCS   , das temperaturas no tanque de ar e na 

entrada da BCS    e   , e da pressão do ar no tanque   .  

O segundo modelo de caixa preta ModeloCircuitowar_sf realiza a interação dos modelos da 

bomba booster, da BCS e da válvula de fluido com o objetivo de calcular a vazão de água       
 

na mistura, a pressão de entrada na BCS    , a pressão de saída da BCS     e a vazão do fluido 

multifásico       . Os parâmetros de entrada no segundo modelo são a rotação da bomba booster 

     , a rotação da BCS      , a vazão de água e de ar na entrada da BCS       
 e       a 

porcentagem de gás na entrada da BCS       , a abertura da válvula de fluido       
, as 

temperaturas na entrada e saída da BCS     e    , e o número de iterações do algoritmo para que 

este se estabilize       . Na Figura 4.17 se apresenta um digrama da interação dos componentes 

do segundo bloco. 



 40 

 

Figura 4.16 Diagrama dos modelos de caixa preta do sistema 

Início

Entradas (W_BCS,W_Btr, Qagua0, Qar_bcs,Vazio, XValf, 
T2, T3,iter) Sendo Qagua0 uma C.I do modelo

Inicializar variáveis internas
Qagua=Qagua0;

i=1;

Calcular a pressão de saída da bomba booster
P2=ModeloBtr(W_Btr,Qagua);

Calcular a pressão de saída da BCS 
P3=ModeloBCS(W_BCS,Vazio,Qtotal,P2)

Calcular a vazão do fluido
Qtotal=Qagua+Qar;

Calcular a vazão de agua
Qagua=ModeloValfluido(P3,Xvalf,T2,P2,T3,Qar,Qagua)

i=i+1;
i==iter?

Retorna (Qtotal,P2, P3, Qagua)

Sim

Fim

não

 

Figura 4.17 Diagrama de fluxo da iteração dos componentes do circuito 



 41 

Através desta bancada virtual se pode obter de forma manual as curvas de desempenho 

vazão-pressão empregando a metodologia apresentada no ANEXO i, impondo valores diferentes 

em suas entradas. 

4.4 Validação das Modelagens da Bancada de Testes Virtual 

Nesta sessão se apresentam os resultados obtidos dos modelos da bomba booster e da BCS 

obtidos mediante algoritmos de máquinas de suporte vectorial para regressão. Também são 

apresentados alguns resultados obtidos manualmente da bancada de testes virtual, como o 

comportamento da resposta da porcentagem de gás e da pressão na entrada da BCS em diferentes 

condições de operação. 

4.4.1 Modelos aproximados mediante algoritmos de SVMr 

Nesta subseção apresentam-se os modelos obtidos mediante máquinas de suporte vetorial, 

seus parâmetros ocultos (      ) e os erros de predição obtidos. 

4.4.1.1 Modelo da Bomba Booster 

O modelo da bomba foi obtido mediante algoritmos de aprendizagem de máquinas usando 

máquinas de suporte vetorial. 

Os parâmetros do modelo (      )  podem ser vistos na Tabela 4.1 onde estes parâmetros 

foram obtidos mediante regulação bias/variância curvas de aprendizagem (APÊNDICE B). A 

metodologia para avaliar os modelos é apresentada no APÊNDICE A. 

Tabela 4.1 Parâmetros da SVM da bomba booster 

        
(MSE) 

[KPa] 

Coeficiente de 

correlação 

Bomba booster 2048 0.015625 0.0078125 8.37366e-05 0.999 

 

Na Figura 4.18 se apresentam os dados reais e as curvas da bomba booster obtidas pelo 

método de SVM 



 42 

 

Figura 4.18 Curvas da bomba booster mediante SVM 

Da Figura 4.18 e Tabela 4.1 podemos concluir que o modelo aproximado mediante o 

método de SVM é bom, já que o erro quadrático médio é de 8.373e-05 KPa, sendo este modelo 

considerado apropriado para predizer o comportamento da bomba booster. 

4.4.1.2 Modelo da BCS 

O modelo da BCS foi obtido mediante algoritmos de aprendizagem de máquinas usando 

máquinas de suporte vetorial. Os parâmetros do modelo se apresentam na Tabela 4.2 onde estes 

foram obtidos mediante algoritmos genéticos (APÊNDICE C). A metodologia para avaliar os 

modelos é apresentada no APÊNDICE A. 

Tabela 4.2 Parâmetros da SVM da BCS 

 
       

(MSE) 

[KPa] 

Coeficiente de 

correlação 

Modelo BCS 907.30 0.17392 0.03105 4.3469 0.998 

      

 

A Figura 4.19, Figura 4.20 e Figura 4.21 apresentam a comparação dos dados reais com os 

dados do modelo obtido baseado em SVM. Estas curvas mostram o comportamento do modelo 

em diferentes condições de operação da BCS. 



 43 

A Figura 4.19 apresenta as curvas de desempenho da BCS com mistura bifásica, a bomba 

está operando a 1800 RPM e uma pressão de entrada de 50 KPa. A Figura 4.20 mostra as curvas 

de desempenho da BCS operando com mistura bifásica em uma rotação da bomba de 2400 RPM 

e uma pressão de entrada de 50 KPa. Na Figura 4.21 se apresentam as curvas de desempenho da 

BCS com mistura bifásica, com a bomba operando a 1800 RPM e uma pressão na entrada de 100 

KPa. 

 

Figura 4.19 Curvas da BCS mediante SVM,                           



 44 

 

Figura 4.20 Curvas da BCS mediante SVM,                           

 

Figura 4.21 Curvas da BCS mediante SVM,                            



 45 

Da Tabela 4.2, Figura 4.19, Figura 4.20 e Figura 4.21 pode-se concluir que o modelo 

aproximado mediante o método de SVM é bom, já que o erro quadrático médio é de 4.34 KPa, ou 

seja um erro de         tendo em conta que o    máximo da bomba a 3600 RPM com fluido 

monofásico é aproximadamente de 250 KPa tendo um comportamento bom com respeito aos 

dados reais. É importante salientar que o modelo apresentou este erro porque os dados de 

treinamento foram poucos para o número de entradas do sistema. 

4.4.2 Comportamento da bancada de testes virtual 

Nesta sessão se apresenta o comportamento das variáveis de interesse (porcentagem de gás 

e pressão de entrada na BCS) da bancada de testes virtual, modificando os valores dos parâmetros 

do modelo não linear tais como a rotação da BCS, a vazão de água e temperaturas. A Figura 4.22 

apresenta o diagrama de blocos do modelo não linear do sistema desenvolvido. 

 



 46 

 

Figura 4.22 Modelo não linear do sistema. 

 



 47 

4.4.2.1 Comportamento da porcentagem de gás 

A porcentagem de gás na entrada da BCS depende das condições de operação do sistema 

como da rotação da bomba booster (Figura 4.23), da rotação da BCS (Figura 4.24) e da vazão de 

fluido (Figura 4.25). Para obter estas respostas se fixaram as variáveis e se acionou a válvula de 

vazão de ar com uma entrada tipo degrau de 0V-1V obtendo assim uma abertura total da válvula. 

A Figura 4.23 apresenta a variação da resposta da porcentagem de gás com diferentes 

rotações da bomba booster. Esta figura também representa o comportamento da porcentagem de 

gás em diferentes pressões de entrada na BCS, porque esta pressão depende diretamente da 

rotação da bomba booster. Da Figura 4.23 podemos dizer que a menores rotações da bomba se 

podem atingir maiores porcentagem de gás, em quanto que se aumentamos a rotação, a pressão 

aumenta e a quantidade volumétrica de gás diminui. 

 

Figura 4.23 Variação da resposta da porcentagem de gás em diferentes rotações da bomba booster 

 



 48 

 

Figura 4.24 Variação da resposta da porcentagem de gás em diferentes rotações da BCS 

Na Figura 4.24 apresenta o efeito gerado pela rotação da BCS na porcentagem de gás, 

pode-se observar que quando a rotação da BCS aumenta, a porcentagem de gás decresce devido a 

variação da vazão do fluido.  

 

a) 



 49 

 

b) 

Figura 4.25 Variação da resposta da porcentagem de gás em diferentes vazões de fluido, a) Resposta do 

sistema a baixas vazões de fluido, b) Resposta do sistema com grandes trocas na vazão de fluido 

Como se apresenta na Figura 4.25, a vazão de fluido afeta em alto grau o comportamento 

da porcentagem de gás e pode levar o sistema à instabilidade como se apresenta na Figura 4.25 

a), devido a que em vazões próximas de zero o sistema fica tão sensível que qualquer 

deslocamento por parte do pistão da válvula ou distúrbio pode instabilizar o sistema. 

4.4.2.2 Comportamento da pressão de entrada na BCS 

O comportamento da pressão de entrada da BCS vai depender das condições do sistema 

como da porcentagem de gás (Figura 4.26), da rotação da BCS (Figura 4.27) e da vazão de fluido 

(Figura 4.28). Para se obter as respostas se fixaram as variáveis e se considerou o sinal da rotação 

do eixo da bomba como o de uma entrada do tipo degrau de 0 RPM-3600RPM obtendo assim 

uma rotação máxima do eixo da bomba. 

A Figura 4.26 apresenta a variação da reposta da pressão de entrada na BCS com diferentes 

porcentagens de gás. Da figura pode-se concluir que a pressão de entrada na BCS aumenta 

quando a porcentagem de gás aumenta, mais o efeito da porcentagem de gás não é significativo. 

 



 50 

 

Figura 4.26 Resposta da pressão de entrada na BCS com diferentes porcentagem de gás 

A Figura 4.27 apresenta o efeito gerado pela rotação da BCS na sua pressão de entrada, 

onde pode-se observar que quando a rotação da BCS aumenta, a pressão de entrada da BCS 

diminui devido ao aumento da vazão do fluido. 

 

Figura 4.27 Variação da resposta da pressão de entrada em diferentes rotações da BCS 



 51 

Como pode ser observado na Figura 4.28, a vazão de fluido afeta o comportamento da  

pressão de entrada já que a maior quantidade de fluido passando pela bomba aumenta a sua 

velocidade causando uma perda de pressão na entrada da BCS. 

 

Figura 4.28 Variação da resposta da pressão de entrada em diferentes vazões de fluido 

  



 52 

Capítulo 5. CONTROLE DO SISTEMA 

Neste capítulo, apresenta-se a metodologia empregada para o projeto do controlador. Da 

bancada virtual apresentada no Capítulo 4, se realiza a identificação dos sistemas a controlar 

obtendo modelos lineares de ordem reduzida. A partir destes modelos lineares se projeta um 

controlador robusto que estabilize o sistema em malha fechada em distintas condições de 

operação. Com o controle projetado se fecha a malha usando a bancada de testes virtual para 

realizar simulações do comportamento do sistema de controle obtido. 

5.1 Sistema de Controle em Malha Fechada 

O sistema de controle em malha fechada proposto é apresentado na Figura 5.1. Para 

projetar o controle deve-se levar em conta que os parâmetros a serem controlados são a pressão 

de entrada à BCS e a porcentagem de gás presente na mistura bifásica na entrada da bomba. 

Quando é realizado o levantamento das curvas de desempenho vazão–elevação para escoamento 

multifásico estes dois parâmetros são afetados pela variação da vazão de fluido no circuito, e por 

isto é necessário o controle constante destes parâmetros. 

 

Figura 5.1 Diagramas de blocos da bancada de testes virtual do sistema com controle 

Bomba booster

Válvula Ar

Vazio

BCS

Válvula Fluido

+



 53 

Da Figura 5.1 se pode disser que o sistema em laço fechado tem dois laços de controle com 

controladores independentes. O primeiro controlador    controla a porcentagem de gás na 

mistura multifásica água-gás medindo o sinal de       no circuito de testes e gerando o esforço 

de controle    que aciona a válvula de ar com a finalidade de enxergar ate a referencia       ; o 

segundo controlados    controla a pressão de entrada na BCS    gerando o esforço de controle 

    que aciona a bomba booster para enxergar ate a referencia     . Além de seguir as 

referencias os controladores devem estabilizam o sistema. 

5.2 Identificação dos sistemas para o controle a partir da bancada de testes 

virtual 

Com a finalidade de obter um modelo de caixa branca que descreva o comportamento do 

sistema para projetar o controle, realiza-se a identificação do sistema a controlar mediante o 

método de identificação por subespaços em tempo discreto (N4SID), a partir de simulações feitas 

com o modelo real baseado em algoritmos de SVMr. 

O método de identificação por subespaços é um algoritmo que tem como principal 

característica trabalhar com os subespaços gerados pelas colunas ou linhas das matrizes de 

Hankel formadas pelas entradas e saídas (GIRALDO, 2008, KATAYAMA, 2005). Os modelos 

de estados no tempo discreto estão descrito matematicamente pela seguinte equação: 

            
          

 ( 5.1 ) 

Para obter os vetores de entrada e saída dos sistemas a controlar se fizeram simulações em 

condições de operação preestabelecida, ou seja, para uma condição de operação da BCS. 

5.2.1 Modelo linear de porcentagem de gás 

O modelo de porcentagem de gás foi aproximado em condições de operação da bancada de 

testes virtual onde a vazão de água é baixa, já que nesta região a porcentagem de gás se mostrou 

ser mais sensível, evitando a região de vazões de água muito pequenas próximas de zero onde a 

porcentagem de gás apresentou instabilidades (ver Figura 4.25 a). 



 54 

O modelo de porcentagem de gás obtido pelo método N4SID empregando o toolbox de 

identificação do MatLab é um modelo de dois estados com uma entrada e uma saída, sendo a 

entrada a voltagem de excitação da eletroválvula com um limite de 1volt, e a saída a porcentagem 

de gás na mistura normalizada [0,1] com um máximo de 45% para uma abertura na válvula de 

fluido de 10%. A Figura 5.2 apresenta a comparação do modelo real e o modelo aproximado 

normalizado para uma entrada implementada (um sinal quadrado com um período de 2 segundos) 

para a obtenção dos vetores de entrada e saída para o método de N4SID. 

 

Figura 5.2 Comparação modelo real e aproximado da porcentagem de gás 

 

O modelo obtido é um sistema de dois estados com uma entrada, uma saída e com    

      , resultando no sistema: 

              
              

 ( 5.2 ) 

sendo: 

    [
             
          

] 

    [
          
        

] 

                    

        

( 5.3 ) 



 55 

5.2.2 Modelo Linear da Pressão de entrada na BCS 

O modelo da pressão de entrada na BCS foi aproximado em condição de operação da 

bancada de testes virtual onde a abertura da válvula de fluido é de 50% com uma abertura da 

válvula de ar de 10%, já que estas duas variáveis não afetam notavelmente a pressão como é 

apresentado na Figura 5.3.  

 

Figura 5.3 Efeito da porcentagem de gás na pressão de entrada da BCS 

O modelo obtido pelo método N4SID é um modelo de dois estados de uma entrada e uma 

saída, sendo a entrada o torque de excitação do eixo da bomba com um intervalo normalizado de 

[0,1], e a saída e a pressão na entrada da BCS também normalizado de [0,1] com um máximo de 

270KPa para uma abertura da válvula de fluido de 50%. A Figura 5.4 apresenta a comparação do 

modelo real e o modelo aproximado para uma entrada implementada (um sinal tipo degrau) para 

a obtenção dos vetores de entrada e saída para o método de N4SID. 



 56 

 

Figura 5.4 Comparação modelo real e aproximado da pressão de entrada da BCS 

O modelo obtido é um sistema de dois estados com uma entrada, uma saída e com    

      , resultando no sistema: 

              
            

 ( 5.4 ) 

sendo: 

   [
              

              
] 

   [
        
        

] 

                 

       

( 5.5 ) 

 

5.3 Projeto de controle 

Já que os modelos obtidos são aproximados, lineares de ordem reduzida e foram 

identificados em uma condição de operação da bancada de testes virtual preestabelecida, 

apresentam incertezas devido a que o circuito tem um comportamento não linear em diferentes 

condições de operação, se optou por projetar um controlador robusto   . Este tipo de controlador 



 57 

pode ser empregado quando se deseja que um sistema mantenha um determinado desempenho em 

condições adversas tais como erros de modelagem e distúrbios externos SARRACINI, 2006.  

A Figura 5.5 apresenta a estrutura do sistema ampliado com ruído de medição e distúrbio 

na saída do sistema com o controle.  

P +

+

K
-

+
Z? 

Z? Z? 
R

u

n

d

y? 

y? 
y

 

Figura 5.5 Estrutura do sistema com controle 

Para o controle da porcentagem de gás temos da Figura 5.5 que: 

       [

      
      
      

]                                 [

       
       
       

]   

       [
       
       

] 

 

( 5.6 ) 

Para o controle da pressão da Figura 5.5 temos: 

    [

   
   
   

]         
           [

    
    
    

]        [
    
    

] 

 

( 5.7 ) 

Das equações ( 5.6 ) e ( 5.7 ) temos que nossas entradas exógenas   seja para o laço de 

controle da porcentagem de gás       ou o laço de controle da pressão de entrada na BCS    são 

a referência  , um distúrbio na saída do sistema   e o ruído de medição n. As sinais de medição 

enviadas ao controle   são: 



 58 

  [
  
  

]  [
 

     
] ( 5.8 ) 

 

sendo   a saída do sistema. As medidas de desempenho   para os dos laços de controle são dadas 

por: 

  [
  
  
  

]  [
  (   )

   
 

] ( 5.9 ) 

 

sendo   o esforço de controle. O sistema ampliado é da forma: 

 ?            
               
               

 ( 5.10 ) 

O sistema na forma padrão com filtros de ponderação esta apresentada na Figura 5.6. 

P +

+

Z? 

Z? 

Z? 

r

u

d -

+Wr

Wd

Wn
n

WS

WU

WT

K

y? 

y? 

r

d

n

Z? 

Z? 

Z? ^

^

^

^

^

^

 

Figura 5.6 Sistema da forma padrão com filtros de ponderação 

Neste trabalho, são considerados os filtros de ponderação: 

? O filtro    é responsável por eliminar o ruído que apresenta na referência, já que esta vai 

depender diretamente de variáveis medidas no circuito de testes. 



 59 

O modelo de estados do filtro é dado por: 

 ?           

 ?           
( 5.11 ) 

? O filtro    é responsável por eliminar perturbações de tipo degrau na saída do sistema, 

este filtro é considerado porque as variáveis a serem controladas vão depender das 

condições de operação da bancada de testes virtual, por exemplo, a porcentagem de gás 

depende da temperatura, da vazão de água e da pressão de entrada na BCS. 

O modelo de estados do filtro é dado por: 

 ?           

 ?           
( 5.12 ) 

? O filtro    é responsável por atenuar o ruído de medição ( ). Onde    é um ganho 

   . Neste trabalho foi considerado ganho    . 

? O filtro    é o peso de sensibilidade que permite definir as características de desempenho 

e rejeição de perturbações de baixa frequência. 

O modelo de estados do filtro é dado por: 

 ?           

 ?           
( 5.13 ) 

? O filtro    é responsável por eliminar sinal de controle da faixa de frequência que não 

foi considerada no modelo do sistema. 

O modelo de estados do filtro é dado por: 

 ?           

 ?           
( 5.14 ) 

? O filtro    é responsável por tornar o sistema mais robusto referente a incertezas 

multiplicativas na saída. Não foi considerado por que o sistema não apresenta incertezas 

multiplicativas 

O modelo de estados do filtro é dado por: 

 ?            

 ?            
( 5.15 ) 



 60 

Na tabela são apresentados os filtros de ponderação dos dois sistemas a controlar (Pressão 

de entrada na BCS    e a porcentagem de gás      ) em tempo discreto com um tempo de 

amostragem de      . 

Tabela 5.1 Filtros de ponderação. 

Filtro 
Sistema 

         

   
                        

            
 

                        

               
 

   
                        

              
 

                        

               
 

   
                       

            
 

                        

               
 

   
                        

                
 

                          

                      
 

 

 

A partir do sistema ampliado com os filtros se projeta o controlador    empregando o 

“toolboox” de controle robusto de MatLab com o comando “hinfsyn” aplicando o método de 

Riccati. No APÊNDICE D apresenta o programa empregado no MatLab para o projeto de 

controle. 

Os controladores obtidos são da forma: 

            
          

 ( 5.16 ) 

Onde as matrizes (       ) do controlador para o controle da pressão de entrada na BCS 

são apresentadas na equação ( 5.17 ). 



 61 

  
[
 
 
 
 
 
 

                          
                         

                                     
                             
                               
                             
                           

                         
                         
                               
                                

                           
                            
                      ]

 
 
 
 
 
 

 

 

  

[
 
 
 
 
 
 

               
               

                  
             
             
              
             ]

 
 
 
 
 
 

 

 

  

[
 
 
 
 
 
 
           
          
          

           
       

          
      ]

 
 
 
 
 
 
 

, 

 

                  

 

( 5.17 ) 

As matrizes (       ) do controlador para o controle da porcentagem de gás na BCS são 

apresentadas na equação ( 5.18 ). 



 62 

  
[
 
 
 
 
 
 

                          
                         

                                          
                             
                                   
                                  
                          

                         
                         
                               
                            

                   
                        
                       ]

 
 
 
 
 
 

 

 

  

[
 
 
 
 
 
 

              
                   

                   
              
              

                 
               ]

 
 
 
 
 
 

 

  

[
 
 
 
 
 
 
           
          

      
       

           
      

       ]
 
 
 
 
 
 
 

, 

                  

( 5.18 ) 

5.4 Resposta do sistema em malha fechada com controle 

Nesta sessão se apresenta o comportamento das variáveis controladas da bancada de testes 

virtual (porcentagem de gás e pressão de entrada na BCS) em malha fechada e o comportamento 

do esforço de controle, através da modificação dos parâmetros da bancada de testes virtual 

(rotação da BCS, abertura da válvula de fluido e temperaturas no circuito). A Figura 5.7 

apresenta a simulação da bancada de testes virtual com o controle, onde as caixas verdes são os 

controladores. 



 63 

 

Figura 5.7 Diagrama de blocos da bancada de testes virtual com o controle. 

 



 64 

5.4.1 Comportamento da porcentagem de gás 

Nesta parte dos resultados se apresenta o comportamento da porcentagem de gás em 

diferentes condições de operação da bancada de testes virtual de BCS (Modelo não linear 

apresentado na Figura 5.7) com o respectivo controle, com o objetivo de avaliar o 

comportamento do sistema em malha fechada. 

A Figura 5.8 apresenta as respostas da porcentagem de gás e do esforço de controle em 

diferentes pressões de entrada na BCS. A análise de desempenho se realizou fixando as variáveis 

do sistema como a rotação da BCS (1800 RPM), as temperaturas (280 K) e a vazão de fluido 

(15% de abertura na válvula de fluido). 

 

a) 

 

b) 

Figura 5.8 Resposta da porcentagem de gás em diferentes pressões de entrada: a) Resposta do sistema, b) 

Esforços de controle. 



 65 

Na Figura 5.9 apresenta o comportamento da porcentagem de gás em diferentes condições 

de rotação da BCS, onde neste teste as variáveis fixas são a pressão de entrada (150 KPa), as 

temperaturas (280 K) e a vazão de fluido (15% de abertura na válvula de fluido). 

 

a) 

 

b) 

Figura 5.9 Resposta da porcentagem de gás em diferentes rotações da BCS: a) Resposta do sistema, b) 

Esforços de controle 

A Figura 5.10 apresenta o comportamento da porcentagem de gás em diferentes 

temperaturas sendo           , onde as variáveis fixas são a pressão de entrada (150 

KPa), a rotação da BCS (1800 RPM) e a vazão de fluido (15% de abertura na válvula de fluido). 



 66 

 

a) 

 

b) 

Figura 5.10 Resposta da porcentagem de gás em diferentes temperaturas: a) Resposta do sistema, b) 

Esforços de controle 

A Figura 5.11 apresenta o comportamento da porcentagem de gás em diferentes vazões de 

fluido variando a abertura da válvula na descarga da BCS, onde neste teste as variáveis fixas são 

a pressão de entrada (150 KPa), a rotação da BCS (1800 RPM) e as temperaturas (290 K). 

Como se pode observar nas Figura 5.8, Figura 5.9, Figura 5.10 e Figura 5.11 o controle 

apresentou um bom comportamento em distintas condições de operação da bancada de testes 

virtual, levando à saída do sistema, neste caso à porcentagem de gás, até a referência desejada 

sem desestabilizar o sistema. Também se pode apreciar na Figura 5.11 que devido à sensibilidade 

da porcentagem de gás em vazões perto a zero, o sistema com controle pode apresentar sobre-

implusos na resposta transiente do sistema. 



 67 

 

 

a) 

 

b) 

Figura 5.11 Resposta da porcentagem de gás em diferentes vazões de fluido: a) Resposta do sistema, b) 

Esforços de controle 

A simulação apresentada na Figura 5.12 foi realizada fixando as variáveis pressão de 

entrada (150 KPa), rotação da BCS (1800 RPM), vazão de fluido (15% de abertura na válvula de 

fluido) e temperaturas (290 K), e foi acrescentado ruído nos sinais de medição para o controle 

(pressão de saída e porcentagem de gás) sendo a media do sinal medido com um desvio padrão de 

um 5% do sinal. Observa-se que o controle teve uma boa rejeição ao ruído de medição. 



 68 

 

a) 

 

b) 

Figura 5.12 Resposta da porcentagem de gás com ruído de medição: a) Resposta do sistema com ruído de 

medição, b) Esforços de controle 

5.4.2 Comportamento da pressão de entrada na BCS 

Nesta parte dos resultados se apresenta o comportamento da pressão de entrada na BCS em 

diferentes condições de operação da bancada de testes virtual de BCS (Modelo não linear 

apresentado na Figura 5.7) com o controle com o objetivo de avaliar o comportamento do sistema 

em malha fechada. 

A Figura 5.13 apresenta as respostas da pressão de entrada e do esforço de controle em 

diferentes vazões de gás na BCS. A análise de desempenho se realizou fixando as variáveis do 

sistema como a rotação da BCS (1800 RPM) e a vazão de fluido (15% de abertura na válvula de 



 69 

fluido). Da Figura 5.13 podemos concluir que o efeito gerado pela troca da porcentagem de gás 

na pressão de entrada é rejeitado pelo controlador. 

 

a) 

 

b) 

Figura 5.13 Resposta da pressão de entrada em diferentes vazões de fluido: a) Resposta do sistema, b) 

Esforços de controle. 

 

a) 



 70 

 

b) 

Figura 5.14 Resposta da pressão de entrada em diferentes rotações da BCS: a) Resposta do sistema, b) 

Esforços de controle 

A Figura 5.14 apresenta o comportamento da pressão de entrada na BCS em diferentes 

condições de rotação, onde neste teste as variáveis fixas são a porcentagem de gás (3%) e vazão 

de fluido (15% de abertura na válvula de fluido). Da Figura 5.14 pode se observar que o 

controlador consegue eliminar a variação na pressão de entrada na BCS gerada pela troca da 

rotação da BCS. 

A Figura 5.15 apresenta o comportamento da pressão de entrada à BCS em diferentes 

vazões de fluido variando a abertura da válvula na descarga da BCS, em neste teste as variáveis 

fixas são a porcentagem de gás (3% KPa) e a Rotação da BCS (1800 RPM). 

 

a) 



 71 

 

b) 

Figura 5.15 Resposta da pressão de entrada em diferentes vazões de fluido: a) Resposta do sistema, b) 

Esforços de controle 

Como se pode observar nas Figura 5.13, Figura 5.14 e Figura 5.15 o controle teve um bom 

comportamento em distintas condições de operação da bancada de testes virtual, levando à saída 

do sistema neste caso à pressão de entrada na BCS até a referência sem desestabilizar o sistema. 

A simulação apresentada na Figura 5.16 foi realizada com as variáveis de porcentagem de 

gás (3%), de Rotação da BCS (1800 RPM) e de vazão de fluido (15% de abertura na válvula de 

fluido), e foi acrescentado ruído nos sinais de medição para o controle (pressão de saída e 

porcentagem de gás) sendo a média o sinal medido e com um desvio padrão de um 5% do sinal. 

Na Figura 5.16 b) pode-se observar que o controle teve boa rejeição ao ruído de medição. 

 

a) 



 72 

 

b) 

Figura 5.16 Resposta da pressão de entrada com ruído de medição: a) Resposta do sistema com ruído de 

medição, b) Esforços de controle 

5.4.3 Curvas de desempenho da BCS obtidas com o controle 

A seguir se apresentam as curvas de desempenho pressão-vazão obtidas com o sistema de 

controle desenvolvido para diferentes condições de operação da BCS 

 

Figura 5.17 Curvas da BCS com controle,                          



 73 

 

Figura 5.18 Curvas da BCS com controle,                        

As Figura 5.17 e Figura 5.18 apresentam as curvas de desempenho em duas condições de 

rotação para diferentes porcentagens de ar. Das figuras podemos concluir que o controlador teve 

bom desempenho em diferentes condições de funcionamento e portanto se pode obter as curvas 

de desempenho com o sistema controlado, mas o controle não pode estabilizar o sistema em 

vazões pertos de zero como pode ser observado na Figura 5.17. Além disto, o sistema apresenta 

um erro maior em altas vazões em presença de porcentagens de gás elevadas como e apresentado 

na Figura 5.18. Isto é devido a que o sistema pneumático não foi capaz de fornecer a vazão de ar 

necessária para se obter à porcentagem de gás desejada. 

Na Figura 5.19 se pode observar que em vazões acima de         o controlador abre a 

válvula para atingir a porcentagem de gás desejada, mas a válvula não consegue fornecer a 

quantidade de ar necessária, já que a pressão no reservatório não é suficiente para conseguir uma 

vazão de ar adequada. Aumentando a pressão no reservatório se pode obter a curva em vazões 

maiores, mas em vazões perto de zero o sistema se torna mais sensível causando instabilidades 



 74 

como é apresentado na Figura 5.17. Devido a este comportamento dependente da pressão do 

reservatório existe a necessidade de se escolher uma pressão ideal de trabalho do reservatório 

para cada faixa de operação da bomba para  realizar o correto levantamento das curvas de 

desempenho. 

 

Figura 5.19 Comportamento do deslocamento do pistão no levantamento das curvas 

A Figura 5.20 apresenta como é alterada a rotação da bomba booster pelo controlador para 

atingir a pressão de entrada na BCS durante o levantamento das curvas de desempenho. 

 

Figura 5.20 Comportamento da rotação da bomba booster no levantamento das curvas 

  



 75 

Capítulo 6. SOFTWARE IN THE LOOP DO SISTEMA 

Com a finalidade de observar o desempenho dos controladores projetados se decidiu 

realizar um Software in the loop (SIL) do sistema realimentado. O princípio básico do SIL é 

substituir o sistema a ser controlado por um modelo de simulação em tempo real (CHOI, 1999) 

Figura 6.1. Os sistemas reais têm componentes mecânicos e eletrônicos caros ou de difícil 

manutenção, por isto a indústria tem a necessidade de realizar testes de simulação trocando os 

componentes reais com modelos matemáticos (M. LINJAMAA 2000).  

 

Figura 6.1 Troca do sistema real por SIL software 

A simulação SIL em tempo real foi realizada num sistema MicroAutoBox com uma placa 

dSPACE DS-1511. O software para fazer o acompanhamento e monitoramento é o 

CONTROLDESK da dSPACE.  

6.1  MicroAutoBox com placa DSPACE DS-1511 

Para gerar uma aplicação em tempo real com a placa dSPACE, o primeiro passo é gerar o 

modelo no Simulink, usando os blocos dSPACE RTI (Real Time Interface) de interface I/O. 

Depois é gerado um código em linguagem C que é compilado e carregado na aplicação de tempo 

real (Figura 6.2) DSPACE 2012. 

 



 76 

 

 

Figura 6.2 Processo de geração de aplicação em tempo real 

O MicroAutoBox é composto de um processador IBM PPC 750GL, 900MHz na placa DS-

1511, dezesseis (16) canais de entradas analógicas de 16 bits com faixa de 0V-5V, quatro (4) 

canais de saída analógica de 12 bits com faixa de 0V-4.5V, com a possibilidade de usar 

conversores DAC (Digital Analog Converter) ou ADC (Analog Digital Converter,) e entrada e saída 

digital. 

6.2 Software dSPACE CONTROLDESK 

É um software usado para acompanhar a aquisição, visualização e monitoramento de dados, 

podendo-se alterar alguns dos parâmetros e variáveis de modo contínuo. Ele executa todas as 

tarefas necessárias, em um único ambiente de trabalho, desde o início do experimento até o fim, 

apresentando uma interface simples para iniciar, validar e acompanhar o comportamento dos 

modelos de operação e controle, com ferramentas de automação, instrumentação virtual e com a 

vantagem de ser em tempo real. A Figura 6.3 apresenta a interface desenvolvida no ControlDesk. 



 77 

 

Figura 6.3 Interface no ControlDesk 

6.3 Simulação em tempo real SIL 

Nesta sessão se apresenta a interface desenvolvida no ControlDesk, o modelo 

implementado no Simulink para ser executado no dSpace MicroAutoBox II, e a comparação das 

curvas de desempenho obtidas na simulação SIL com o modelo da bancada de testes virtual da 

BCS, e os erros apresentados. 

6.3.1 Interface no ControlDesk 

A Figura 6.4 apresenta a interface de usuário, onde se pode observar o comportamento do 

sistema com o controle (vazões, pressões, esforços de controle e variáveis controladas) e as 

modificações em cada uma das variáveis que compõem o circuito de teste em malha fechada 

(referências, temperaturas, pressão nos tanques, rotação da BCS e abertura da válvula de fluido), 



 78 

 

Figura 6.4 Partes da interface de usuário no ControlDesk 

sendo: 

(1) É um arranjo de variáveis de observação (pressão de saída da BCS, rotação da bomba 

booster e deslocamento do pistão) e ajuste das variáveis da bancada de testes virtual como 

as temperaturas no circuito e pressões dos tanques. 

(2) Apresenta os resultados sendo obtidos nas vazões do sistema; vazão de ar, vazão de água 

e vazão total. 

(3) É onde se ajusta a referência desejada da pressão e da porcentagem de gás na entrada da 

BCS. 

(4) É o scrollbar para ajustar à abertura da válvula de fluido. 

(5) E o scrollbar para ajustar a rotação da BCS 

(6) Apresenta o comportamento do sinal de referência (verde) e do sinal controlado 

(vermelho). 

(7) Apresenta os esforços de controle da porcentagem de gás em verde e da pressão de 

entrada da BCS em vermelho 

Esforços de controle Comparação de P2 Comparação do vazio

Apertura da válvula de fluido

Rotação da BCS 

1 23

4
5

67



 79 

6.3.2 Modelo de simulação SIL 

A Figura 6.6 apresenta a modelo implementado no Simulink, modelo este composto por 

duas partes; a primeira representa o modelo da bancada de testes virtual para BCS; a segunda 

representa o controlador. Na Figura 6.6 as caixas verdes representam os conversores digitais 

análogos (DAC) do MicroAutoBox II, as caixas amarelas representam os conversores análogico 

digital (ADC) do MicroAutoBox II. As linhas tracejadas vermelhas representam a realimentação 

física do sistema com o controle, como é apresentado nas conexões físicas feitas no conector 

utilizado no MicroAutoBox II mostrado na Figura 6.5. 

        

Figura 6.5 Conector da Dspace com a conexão física das entradas e saídas do sistema. 

 



 80 

 

 

Figura 6.6 Modelo não linear para SIL 

 

Circuito de testes

Controlador



 81 

6.3.3 Curvas de desempenho obtidas com o SIL 

A Figura 6.7 apresenta as curvas de desempenho da BCS obtidas com o circuito controlado 

simulado no MicroAutoBox II, onde as curvas apresentadas são para porcentagem de gás de 1%, 

2%, 3% 5% com a pressão de entrada fixa em:            e a rotação da BCS fixa em 

             . Sendo as linhas pontilhadas obtidas pela simulação e as linhas contínuas são 

as curvas reais, ou seja, as curvas obtidas somente com o modelo SVM da BCS. 

 

Figura 6.7 Curvas da BCS em SIL com controle,                          

A Figura 6.8 apresenta as curvas de desempenho da BCS com o circuito controlado 

simulado no MicroAutoBox II em outras condições, onde as curvas apresentadas são para 

porcentagem de gás de 1%, 3% e 5% com a pressão de entrada fixa em:        KPa e a 

rotação da BCS fixa em          . Sendo as linhas pontilhadas obtidas pela simulação e as 

linhas contínuas são as curvas reais, ou seja, a curva obtida somente com o modelo SVM da BCS. 



 82 

 

Figura 6.8 Curvas da BCS em SIL com controle,                         

Os resultados obtidos da simulação SIL são similares aos apresentados na sessão 5.4.3. O 

sistema controlado apresentou instabilidades com vazões de fluido perto de zero, e o erro 

aumentou enquanto a vazão aumentava. Das Figura 6.7 e Figura 6.8 se pode concluir que o 

controlador teve um bom desempenho em uma ampla faixa de operações (pressões, rotações, 

vazões e porcentagens de gás) da BCS. 

  



 83 

Capítulo 7. CONCLUSÕES E RECOMENDAÇÕES DE TRABALHOS 
FUTUROS 

7.1 Conclusões 

Com a finalidade de avaliar o comportamento do levantamento das curvas de desempenho 

pressão-vazão da BCS com o controle, devido à necessidade de automatizar os circuitos de testes 

para facilitar os ensaios e melhorar a qualidade dos mesmos, no percurso do trabalho se 

desenvolveram modelos não lineares baseados em algoritmos de SVM capazes de interpolar o 

comportamento da BCS em diferentes pontos de operação (pressão, vazão, rotação e porcentual 

de gás) a partir de dados experimentais. Ditos modelos apresentam uma boa generalização devido 

a que para o treinamento se realizou uma otimização dos parâmetros ocultos do algoritmo 

empregando algoritmos genéticos e regularização mediante bias versus variância. 

Para avaliar a possibilidade de projetar um sistema controlável para se obter 

automaticamente as curvas de desempenho de BCS se decidiu por desenvolver um modelo não 

linear que representasse o comportamento de um circuito de testes de BCS, modelando os 

componentes de dito circuito a partir de dados experimentais e formulações físicas. Obtendo 

assim uma bancada de testes virtual no qual se poderiam obter as curvas de desempenho pressão-

vazão de forma manual como no circuito real. 

A partir da bancada de testes virtual obtida que representa o sistema real, se realizou uma 

identificação dos sistemas de interesse em uma condição de operação do circuito a modelos 

lineares de ordem reduzida mediante o método de identificação por subespaços em tempo 

discreto. Dos modelos reduzidos se projetaram controladores robustos    capazes de estabilizar 

tanto a pressão de entrada bem como a porcentagem de gás em diferentes pontos de operação da 

BCS (pressões, rotações da BCS, temperaturas no circuito, vazão de fluido), cabe observar que o 

controle foi projetado numa só condição de operação do circuito de testes. Como é apresentado 

na subseção 4.4.2 do Capítulo 4 a bancada de testes tem um comportamento diferente em 

distintas condições de operação. Os controladores apresentam uma boa rejeição a distúrbios, 

erros de modelagem e ruídos acrescentados nos sinais de mediação. A partir do mencionado 

anteriormente se pode dizer que os controladores são capazes de controlar as condições de 



 84 

entrada na BCS para realizar o levantamento das curvas de desempenho vazão-pressão da bomba 

operando em escoamento multifásico. 

Realizou-se o teste do sistema com o controle em tempo real, mediante simulações SIL 

embarcando o controlador numa placa MicroAutoBox II da dSPACE. Nesta simulação se 

obtiveram automaticamente as curvas de desempenho da BCS pressão-vazão desejadas. O 

controlador apresentou um bom comportamento em diferentes condições de operação, 

salientando-se que o sistema realimentado apresentou algumas instabilidades em vazões perto de 

zero. Ditas instabilidades podem ser reduzidas diminuindo a pressão do reservatório de ar devido 

a que o sistema perde sensibilidade quanto menor o diferencial de pressões na válvula de 

controle. 

7.2 Recomendações de Trabalhos Futuros 

A partir das experiências vividas, dificuldades apresentadas no desenvolvimento do projeto 

e das conclusões obtidas, as sugestões para dar continuidade à pesquisa são: 

Com a finalidade de obter uma melhor representação dos modelos não paramétricos da 

BCS, é recomendável treinar o algoritmo de SVM com um maior número de condições de 

operação da bomba.  

Neste trabalho só se apresentou a curva de desempenho vazão-pressão, em trabalhos futuro 

é recomendável obter as curvas de desempenho de vazão-potência e vazão-eficiência para 

realizar o estudo destas curvas de desempenho com o sistema controlado. 

Devido que este trabalho faz o projeto de controle dos dois laços de controle de forma 

independente, se sugere realizar a identificação do sistema em conjunto e projetar um só 

controlador que estabilize e controle o sistema, com a finalidade de evitar que os controladores 

que trabalham de forma independente gerem instabilidades no sistema, já que um controlador 

pode instabilizar o comportamento do outro laço de controle. 

Implementar diferentes metodologias de identificação para modelar o comportamento 

completo da bancada de testes virtual para BCS, e assim obter melhores resultados no momento 

de projetar e implementar o controle no sistema real. 



 85 

Estudar o comportamento da bancada de testes virtual em malha fechada com diferentes 

métodos de controle moderno como controle adaptativo, controle fuzzy, controle com algoritmos 

de aprendizagem de máquinas (neurocontroladores) ou controle comutado. 

Devido à necessidade de trocar a pressão do reservatório de ar para poder obter melhores 

resultados nas curvas de desempenho da BCS, se sugere acrescentar mais um controle para 

ajustar a sua pressão. 

  



 86 

REFERÊNCIAS 
 

 

AGUIRRE, L.A, Introdução à Identificação de Sistemas – Técnicas Lineares e Não-Lineares 

Aplicadas a Sistemas Reais, 3a Edição, UFMG, 2007 

 

 

ANDREW Ng. Introduction to Machine Learning. Machine learning Course, Coursera based into 

Standford University, 2012. 

 

 

CHANG. C.C and LIN. C.J. LIBSVM : a library for support vector machines. ACM Transactions 

on Intelligent Systems and Technology, 2:27:1-27:27, 2011. 

 

 

CHOI, S.G and W. H. KWON.. Real-time distributed software-in-the-loop simulation for 

distributed control systems. In Proc. of the 1999 IEEE International Sym- posium on Computer 

Aided Control System Design, pp 115-119, 1999 

 

 

DEL SIGNORE, M. J.; KROVI, V. Virtual prototyping and hardware-in-the-loop testing for 

musculoskeletal system analysis, Proceedings of the IEEE international conference Mechatronics 

and automation, pp. 394-399, Ontario, Canada, 2005. 

 

 

DE OLIVEIRA, H, R, PAGLIONE, P, Controle Longitudinal de uma Aeronave Flexível 

Utilizando    com Realimentação Estática da Saída, Brazilian Symposium on Aerospace Eng, &amp;amp; 

Applications, 2009. 

 

 

DOYLE, J, C, STEIN, G, Multivariable Feedback Design: Concepts for a Classical/Modern 

Synthesis, IEEE Trans. On Automatic Control, Vol AC-26, No 1, pp 4-16, 1981. 

 

 

DOYLE, J, C, GLOVER, K, KHARGONEKAR, P, P, FRANCIS, B, A, State-Space Solution to 

Standard    and    Control Problem, IEEE Transaction on Automatic Control, Vol 31, No 8, pp 

831-846, 1989 

 

 



 87 

DRAKUNOV, S. V., OZGUNER, U., Vibration Suppression in Flexible Structures via the 

Sliding-Mode Control Approach. In: Proceedings of the 31st IEEE Conference on Decision and 

Control, v. 2, pp. 1365-1366. , 1992 

 

 

DSPACE, MicroAutoBox II, Hardware Installation and Configuration, v7.3,2012 

 

 

DUTRA, L, do A, G. Modelagem do Escoamento Monofásico em Bomba Centrífuga Submersa 

Operando com Fluidos Viscosos, Dissertação de Mestrado FEM/UNICAMP, 2007. 

 

 

GAMBOA, J, J. PRADO, M, Multiphase Performance of ESP Stages-Part I, The University of 

Tulsa, Artificial Lift Projects, 2007 

 

 

GIRALDO, C, Métodos de Subespaços para Identificação de Sistemas: Propostas de Alterações, 

Implementações e Avaliações, Dissertação de Mestrado FEEE/UNICAMP, 2008. 

 

 

GORDILLO, C, C, A. Estratégias para a correção dos efeitos de atraso de sistemas Hardware In 

the Loop (HIL), Dissertação de Mestrado FEM/UNICAMP, 2012. 

 

 

HONG, Z. YONGMEI, L. BSP-Based Support Vector Regression Machine Parallel Framework, 

Computer and Information Science (ICIS), 2013 IEEE/ACIS 12
th

, pp 329-334, 2013. 

 

 

KATAYAMA, T. Subspace Methods for System Identification. Springer, 2005 

 

 

LJUNG, L, System Identification: Theory for the User, Second Edition, Upper Saddle River, NJ: 

Prentice Hall PTR, 1999 

 

 

M. LINJAMAA, T. VIRVALO, J. GUSTAFSSON, J. LINTULA, V. AALTONEN, M. 

KIVIKOSKI, Hardware-in-the-loop environment for servo system controller design, tuning and 

testing, Microprocessors and Microsystems 24, pp 13-2, 2000 

 

 



 88 

MONTE, V, W, Estudo Experimental de Bombas de BCS Operando com Escoamento Bifásico 

Gás-Líquido, Dissertação de Mestrado FEM/UNICAMP, 2011. 

 

 

OGATA, K, Dinámica de sistemas, 1ra Ed, Prentice-Hall Hispanoamericana. S.A, 1987  

 

 

OGATA, K, Modern Control Engineering, 4a Ed, Pearson Education International. 2002 

 

 

OKUBO, H.; ICHIKAWA, H.; NISHIMURA, T. Structure and Controller Design for Vibration 

Control of Flexible Structures via Robust Pole Assignment. IEEE, pp. 619-623, 1998. 

 

 

POTTEBAUM, R, J, Optimal Characteristics of a Variable-Frequency Centrífugal Pump Motor 

Drive, IEEE Transactions on Industry Applications, vol. IA-20, n. 1, 1984 

 

 

QING, Y. FRED R, Parameter Selection of Support Vector Regression Machine Based on 

Differential Evolution Algorithm, Sixth International Conference on Fuzzy Systems and 

Knowledge Discovery, IEEE, vol 2, pp 596-598, 2009 

 

 

RODRÍGUEZ, R, F, LÓPEZ, S, M, J, Control Adaptativo y Robusto, Universidad de Sevilla, 

1996 

 

 

SARGENT, R. G, Verification And Validation Of Simulation Models, p 55-64, 1998. 

 

 

SARRACINI, J F, Síntese de Controladores H? de Ordem Reduzida com Aplicação no Controle 

Ativo de Estruturas Flexíveis, Dissertação de Mestrado FEM/UNICAMP, 2006. 

 

 

SCHLESINGER, et al.. Terminology for Model Credibility, Simulation, Vol 32, p. 103-104, 

1979 

 

 

SKOGESTAD, S. POSTLETHWAITE, I Multivariable Feedback Control Analysis and design, 

2a Ed. 2001. 

 



 89 

 

SILVA, M, P. Controle e Estimação de Estado de Sistemas Multivariáveis Não Lineares 

Variantes no Tempo Limitados em Norma: Aspectos de Robustez, Descentralização e 

Otimização   , Dissertação de Mestrado FEEE/UNICAMP, 2010 

 

 

SMOLA, J, S. SCHOLKOPF, B. A tutorial on support vector regression, Kluwer Academic 

Publishers. Manufactured in The Netherlands, Statistics and Computing 14, pp 199-222, 2004. 

 

 

STEIN, G, ATHANS, M, The LQR/LTR Procedure for Multivariable Feedback Control Design, 

IEEE Transaction on Automatic Control, Vol AC-32,No 2, pp 105-113, 1987 

 

 

STOEAN, S. DUMITRESCU, D. PREUSS, M. STOEAN, C. Evolutionary Support Vector 

Regression Machines, Symbolic and Numeric Algorithms for Scientific Computing, pp 330-335, 

2006 

 

 

VIVAS, G, E, C, Control del Helicóptero 2D Usando Métodos de Control Robusto   , 

Universidad Nacional de Colombia, 2011 

 

 

WHITE F. M, Fluid Mechanics, 4th ed, McGraw-Hill, pp 711-768, 1999 

 

 

ZAMES, G, FRANCIS, B, A, Feedback, Minimar Sensitivity, and Optimal Robustness, IEEE 

Trans. Automat. Contr, Vol AC-28, No 5 pp 585-601, 1983. 

 

 

ZHANG, X, ZHANG, X, L, S, Modeling and Simulation of Proportional Fuel Flow Rate Control 

Valve, International Conference on Computer, Mechatronics, Control and Electronic Engineering 

(CMCE), 2010 

 

 

ZHOU, K. Essentials of robust control. Tom Robbins, 1998. 



 90 

APÊNDICE A.  Avaliação dos Modelos. 

Para a validação dos modelos obtidos mediante o método de máquinas de suporte vetorial 

foi realizado avaliação do erro quadrático médio (MSE) e do coeficiente de determinação (R
2
). 

Na literatura opta-se por empregar estes métodos estatísticos para a avaliação de modelos. 

A precisão é dada pela média dos valores preditos e dos valores reais. Por valores reais 

têm-se aqueles que foram obtidos dos testes reais. Para o cálculo de precisão é utilizado o erro 

médio quadrático, definido como, 

    ?
(         )

 

 

 

   

  (A.1) 

onde,    é o valor predito pelo algoritmo de aprendizagem na entrada  ;        é o valor observado 

da entrada    e   é o número de valores analisados.  

O coeficiente de determinação (R
2
) é uma medida de ajuste dos modelos estatísticos 

generalizados em relação aos valores reais, indicando os valores reais em valores de 

porcentagem. Quanto mais perto de 1 é o valor, mais explicativo é o modelo, definido como, 

 
 
 

? (         )
  

   

? (             )
  

   

   
? (         )

  
   

? (             )
  

   

  (A.2) 

onde    é o valor prognosticado pelo algoritmo de aprendizagem na entrada  ;        a média dos 

valores,        o valor real da entrada    e   o número de valores analisados. O coeficiente varia 

entre 0 e 1 onde: 

?  
 
      é considerado que o modelo não tem correlação e seu comportamento é aleatório. 

?         
 
       é considerado um relacionamento leve. 

?         
 
       é considerado um relacionamento moderado. 

?         
 
       é considerado um relacionamento forte.  



 91 

APÊNDICE B.  Regulação Mediante Bias/Variância. 

É necessário saber se os modelos de aprendizagem de máquinas apresentam problemas de 

bias (baixo ajuste) ou variância (sobre ajuste), para poder corrigir ou tentar melhorar o modelo. 

Uma forma de solucionar este problema é ter hipóteses em um nível intermediário de 

complexidade, já que dá o menor erro generalizado (ANDREW, 2012). A Figura B.1 apresenta 

os erros de validação e os erros de treinamento com respeito aos modelos obtidos do algoritmo, 

por exemplo, os diferentes modelos obtidos de SVMr variando o parâmetro de penalização  . 

 

Figura B.1 Bias e Variância com Respeito aos Modelos 

Para realizar a regulação do modelo as amostras de teste se dividem em três grupos para 

calcular o erro de treinamento          , erro de validação         e erro de teste          . 

Portanto a divisão dos dados adotada é da seguinte forma,     de treinamento (             ), 

    de validação (         )e     de teste (             ), e ainda colocando aleatoriamente as 

amostras nos grupos para evitar uma generalização errada. 

Os erros são dados por: 

Modelos

Alta Bias Alta Variância

Baixa Bias e baixa Variância



 92 

          
 

        
?   ( (      )         )

 

      

   

        
 

      
?   ( (    )       )

 

    

   

          
 

        
?   ( (     )        )

 

      

   

  ( B.1 ) 

sendo  ( ) o modelo a regularizar. 

O objetivo deste método de regulação é fazer um mapeamento dos modelos obtidos 

trocando os parâmetros ocultos (      ), calculando o erro de validação e de treinamento para 

cada combinação possível e assim procurar os parâmetros que apresentem menor um valor 

intermediário onde o modelo apresente baixa bias e baixa variância. 

 

  



 93 

APÊNDICE C. Algoritmos Genéticos 

A seleção dos parâmetros (      ) é uma questão importante nos algoritmos de SVMr, 

porque destes parâmetros dependem a efetividade do algoritmo (QING, 2009). Esta seleção se 

pode fazer de forma automática mediante algoritmos genéticos (AG). 

Os AG são métodos adaptativos que podem ser usados para solucionar problemas de busca 

e otimização. Estão baseados no processo genético dos seres vivos. O processo de evolução está 

baseado na natureza, o seja, os princípios naturais e a supervivência do mais forte.  

A Figura C.1 apresenta um diagrama de fluxo do algoritmo genético. 

 

Figura C.1 Diagrama de fluxo do AG 

Inicio

Gerar população inicial

Computar a função de avaliação (fitness) em cada individuo.

Selecionar indivíduos mais aptos

Cruzamento

Mutação

Computar a função de avaliação (fitness) em cada individuo.

Gerar nova geração

Fim

A polpação a 

convergido?

Não

Sim

C
ic

lo
 r

e
p

ro
d

u
ti

v
o



 94 

Cada individuo da população tem três características (      ), onde o genótipo de cada 

individuo está dado em números binários como é apresentado na Figura C.2. Estes indivíduos são 

gerados aleatoriamente para obter uma área maior de procura. 

 

Figura C.2 Genótipo dos indivíduos 

Ditos indivíduos são avaliados mediante uma função fitness. Para solucionar o problema de 

SVMr, a função fitness da um maior valor de adaptação a cada indivíduo se o seu erro de 

validação         é menor, ou seja, realizamos o treinamento da SVMr com cada indivíduo, 

calculamos seus erros de validação e os indivíduos que apresentem os menores erros serão os 

melhores adaptados. 

Para realizar o cruzamento entre os indivíduos, se duplicam os indivíduos dependendo de 

seu valor de adaptação. Por exemplo, temos 5 indivíduos                            com 

valores de adaptação de                           respectivamente, podemos observar que o 

indivíduo 2 obterá más copias que o indivíduo 1 que tem um menor valor de adaptação como é 

apresentado na Tabela C.1. 

Tabela C.1 Exemplo de duplicação dos indivíduos 

Indivíduo Adaptação Copias 

     0.01 0 

     0.5 4 

     0.31 3 

     0.1 1 

     0.21 2 

 

A partir das cópias dos indivíduos, selecionamos os pais para obter a próxima geração 

implementando o método da roleta. O método da roleta seleciona aleatoriamente um indivíduo 

para que este seja pai da seguinte geração como é apresentado na Figura C.3, onde os indivíduos 



 95 

que tenham mais cópias aumentam a probabilidade de ser escolhido. O método da roleta se repete 

até obter um número de pais igual à população inicial. 

 

Figura C.3 Método da roleta. 

Para obter os filhos se realiza uma combinação do genótipo dos pais em uma posição 

aleatória como se apresenta na Figura C.4. 

 

Figura C.4 Combinação do genótipo. 

Finalmente para obter a nova geração se mutam alguns dos filhos, onde esta mutação 

mantém a diversidade da população. A mutação consiste em trocar um gene do genótipo do 

indivíduo (ver Figura C.5), onde este gene é escolhido aleatoriamente.  

 

Figura C.5 Mutação no genótipo. 

A nova geração vai ser composta pelos filhos e filhos mutados, e a nova geração deve ter a 

mesma quantidade de indivíduos que a população inicial.  



 96 

APÊNDICE D. Programa do Projeto de Controle 

%% projeto de controle 
close all; clear all; clc 
% método empregado para o projeto do controlador 
metodo='ric';   %lmi ric 

  
%% Carregar sistema P_2 ou Vazio  
load('modeloPinw_norm') %  planta (P_2) 
%load('modelovaziow_norm') %  planta (Vazio) 

  
%% obter planta nominal 
[A,B,C,D] = linmod('sistema_d'); 
Pn=ss(A,B,C,D); 
u={'u_1'}; 
w={'R','D','N'}; 
z={'z_1','z_2','z_3'}; 
y={'e_1','e_2'}; 
Pn.inputname = [w u]; 
Pn.outputname = [z y]; 

  
%% calculo da norma do sistema 
nra=norm(Pn(1,1:length(w)),inf) 

  
%% Observar o desempenho da planta nominal 
fw=logspace(-1,2,80000); 
figure(15) 
sigma(Pn(1,1:length(w)),'r',fw) 
legend('Pn','Pr') 

  
%% Projetar K para Pn 
K=hinfsyn(Pn,length(y),1,'METHOD',metodo); %lmi ric 
K.inputname = y; 
K.outputname = u; 

  
%% feedback 
T=connect(Pn,K,w,z); 

  

  
%% Estabilidade e desempenho 
figure(2) 
step(T) 
eig(T) 

  
%% Calcular la norma 
nraT=norm(T,inf) 

  
% O sistema em laço fechado não consegue chegar ate a referencia, por isto são 
% empregados alguns filtros de ponderação, e também para melhorar o 
% desempenho com o sistema real. 

  
%% Filtros de ponderação 
%----------------------------------------------------------------- 



 97 

% são carregados os filtros para o projeto de P_2 
load('filtrosPinw','wr','wd','ws','wu','wt')  
% são carregados os filtros para o projeto do vazio 
%load('filtrosvaziow','wr','wd','ws','wu')  

  
%% criar planta com filtros 

  
w_t={'R_1','D_1','N'}; %vector de entradas con filtros 
z_t={'z1_1','z_2','z3_1'}; %vector de medidas de desempheno com filtros 
Pnt=connect(Pn,wr,wd,ws,wu,wt,[w_t u],[z_t y]); 

  
%% projetar o controlador com filtros 
 Kt=hinfsyn(Pnt,length(y),1,'METHOD',metodo); %lmi ric 
Kt.inputname= y; 
Kt.outputname=u; 

  
%% feedback 
Tr=connect(Pn,Kt,w,z); 

  
%% Desempenho com filtros 
figure(3);  
sigma(Pn(1,1:length(w)),'k',Tr(1,:),'r',Pnt(1,1:length(w)),'b',fw) 
legend('Pr','Tr','Pnt') 
figure(5) 
step(Tr) 

  
%% Estabilidade  
eig(Tr) 
Ktd=c2d(Kt,dt,'tustin'); 

  
% é guardado o controlador obtido 
savefile = 'K005Pinw_norm'; 
%savefile = 'K005Vaziow_norm'; 
save(savefile,'Kt','Ktd','Pr','Tr'); 

  



 98 

ANEXO i. Procedimento Experimental de Testes 

O procedimento a seguir é o desenvolvido por MONTE (2011) para o desenvolvimento do 

seu projeto de mestrado. Monte Verde fala que o procedimento é bastante trabalhoso porque os 

testes são realizados à uma fração volumétrica de gás constante além disto também está 

controlando a pressão de sucção da BCS, que é mantida constante ao longo de toda a curva de 

desempenho. 

A seguir, é descrito o procedimento experimental adotado para testes bifásicos por MONTE, 

2011: 

1. Liga-se a bomba booster e, a seguir, a bomba BCS, fixando uma rotação para a BCS 

através do inversor de frequência. A rotação da BCS permanece fixa ao longo de todo o 

ensaio. 

2. Através do controle da rotação da bomba booster, fixa-se a pressão na sucção da BCS. 

Essa pressão deve ser mantida constante ao longo de todo o experimento. 

3. Regula-se a vazão de gás de forma a obter-se a vazão volumétrica de gás desejada. Esse 

valor também é mantido constante. Quando a vazão de gás é alterada, a pressão de sucção 

também se altera. Dessa forma, é necessário ajustar novamente a rotação da bomba 

booster até que a pressão de sucção seja a desejada. 

4. Com esses três parâmetros ajustados, pressão de sucção, fração volumétrica de gás e 

rotação da BCS, espera-se aproximadamente três minutos para que a condição 

operacional se estabilize. 

5. Realiza-se a aquisição dos dados durante um intervalo de 30 segundos. 

6. Para o ajuste da próxima condição operacional de vazão, diminui-se a rotação da bomba 

booster e em seguida ajusta-se a vazão de ar e água até que a fração volumétrica seja a 

desejada. Ajusta-se novamente a rotação da bomba booster de forma a manter constante a 

pressão de sucção na BCS. Trata-se de um processo iterativo de abertura de válvulas e 

ajuste de rotação da bomba booster até que sejam estabelecidas as condições desejadas. 

Os procedimentos 5 e 6 são repetidos até que a vazão de mistura seja a vazão máxima, 

condição que caracteriza o final do teste.  


</field>
	</doc>
</add>