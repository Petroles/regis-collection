<?xml version="1.0" encoding="utf-8"?>
<add>
	<doc>
		<field name="docid">BR-TU.09975</field>
		<field name="filename">15006_Guilherme%20Araujo%20Martins.pdf</field>
		<field name="filetype">PDF</field>
		<field name="text">UNIVERSIDADE FEDERAL FLUMINENSE ESCOLA DE ENGENHARIA
DEPARTAMENTO DE ENGENHARIA QUÍMICA E DE PETRÓLEO CURSO DE ENGENHARIA DE PETRÓLEO
SIMULAÇÃO NUMÉRICA DE RESERVATÓRIOS COM MALHA TRIANGULAR E SISTEMA BIDIMENSIONAL-BIFÁSICO ÓLEO/ÁGUA
MONOGRAFIA DE GRADUAÇÃO EM ENGENHARIA DE PETRÓLEO
GUILHERME ARAUJO MARTINS
NITERÓI
2010
GUILHERME ARAUJO MARTINS
SIMULAÇÃO NUMÉRICA DE RESERVATÓRIOS COM MALHA TRIANGULAR E SISTEMA BIDIMENSIONAL-BIFÁSICO ÓLEO/ÁGUA
Trabalho de Conclusão de Curso apresentado ao Curso de Graduação em Engenharia de Petróleo da Escola de Engenharia da Universidade Federal Fluminense, como requisito parcial para obtenção do Grau de Bacharel em Engenharia de Petróleo.
Orientadora: ProK Drã. CLAUDIA OSSANAI OURIQUE
NITERÓI
2010
Ficha Catalográfica elaborada pela Biblioteca da Escola de Engenharia e Instituto de Computação da UFF
M386 Martins, Guilherme Araújo.
Simulação numérica de reservatórios com malha triangular e sistema bidimensional-bifásico óleo/água / Guilherme Araújo Martins. - Niterói, RJ : [s.n.], 2010.
87 f.
Trabalho (Conclusão de Curso) - Departamento de Engenharia
Química e de Petróleo - Universidade Federal Fluminense, 2010. Orientador: Cláudia Ossanai Ourique.
1. Engenharia de reservatório. 2. Simulação numérica. 3. Malha triangular. I. Título.
CDD 665.5
Scanned by CamScanner
GUILHERME ARAUJO MARTINS
SIMULAÇÃO NUMÉRICA DE RESERVATÓRIOS COM MALHA TRIANGULAR E SISTEMA BIDIMENSIONAL-BIFÁSICO ÓLEO/ÁGUA
Trabalho de Conclusão de Curso apresentado ao Curso de Graduação em Engenharia de Petróleo da Escola de Engenharia da Universidade Federal Fluminense, como requisito parcial para obtenção do Grau de Bacharel em Engenharia de Petróleo.
Aprovado em 25 de Novembro de 2010.
BANCA EXAMINADORA
Profã. Drâ. Cláudia Ossanai Ourique - Orientadora
UFF
Rodrigo Ferreira Pardo UFF
Prof. Dr. Fernando Cunha Peixoto UFF
NITERÓI
2010
Este trabalho é dedicado à minha noiva Mariana, aos meus pais, Sérgio e Márcia, e ao meu irmão Gustavo, por todo o apoio e compreensão que me prestaram. A todos vocês meu muito obrigado.
AGRADECIMETOS
Primeiramente a Deus, por me permitir chegar até aqui.
Aos meus pais, Sérgio e Márcia, por seu carinho, estímulo e dedicação de uma vida inteira.
À minha noiva Mariana, por ter estado sempre ao meu lado, com seu apoio, paciência, incentivo e carinho.
Ao meu irmão Gustavo, por ser não só um irmão, mas um amigo e companheiro.
À professora Claudia Ossanai Ourique, incentivadora e orientadora, sempre disposta a ajudar.
Ao professor Arturo Rodrigo Ferreira Pardo, pela prontidão e ajuda na finalização do trabalho.
Ao professor e coordenador Geraldo de Souza Ferreira, pela orientação inicial do trabalho e apoio nesses anos de graduação.
Aos amigos que me apoiaram.
EPÍGRAFE
“Deus nos fez perfeitos e não escolhe os capacitados, capacita os escolhidos. Fazer ou não fazer algo, só depende de nossa vontade e perseverança."
Albert Einstein
RESUMO
A simulação numérica de reservatórios é uma ferramenta indispensável à engenharia de reservatórios, sendo utilizada desde a descoberta até o abandono de um campo, com o objetivo de auxiliar a tomada de decisões de desenvolvimento, tais como de decisão de desenvolvimento inicial do campo e aquelas relacionadas à implementação de um método de recuperação avançada, provendo meios para aumentar-se a porcentagem de recuperação final dos fluidos contidos em um reservatório. Neste trabalho é estudada a simulação numérica utilizando-se malha triangular para o caso específico de sistema bidimensional-bifásico óleo/água. A malha triangular apresenta como vantagens a maior flexibilidade para modelagem de reservatórios de geometria complexa, e a redução do efeito de orientação de malha, devido ao fato de reproduzir melhor a configuração do escoamento. Devido à sua complexidade, a malha triangular é gerada por um algoritmo numérico que se adapta simultaneamente às fronteiras externas do reservatório e aos contornos de regiões heterogêneas, caso existam. Para modelagem matemática foi utilizado o modelo Black-Oil, resultante da combinação de um balanço de massa integral com a lei de Darcy. As equações integrais de fluxo são discretizadas por diferenças finitas, utilizando-se o método de bloco triangularização das mediatrizes, e em seguida as equações de fluxo discretizadas são resolvidas através do método SS implícito. Por fim, são exemplificadas algumas aplicações da simulação numérica de reservatórios, pela resolução de um problema típico da engenharia de reservatórios, através do simulador gratuito BOAST98.
Palavras-chave: Simulação Numérica de Reservatórios. Black-Oil. Malha Triangular.
ABSTRACT
The numerical reservoirs simulation is an indispensable tool for reservoir engineering, being used from discovery to the abandonment of a field, with the aim of assisting development decision making, such as the decision of initial development of the field and those related to the implementation of a enhanced recovery method, providing the means to increase the percentage of final recovery of the fluids contained in a reservoir. In this work the numerical simulation using triangular grid for the specific case of two-dimensional and two-phase (oil/water) system is studied. The triangular grid has the advantages of greater flexibility for modeling of complex-geometry reservoirs, and the reduction of the grid orientation effect, due to the fact that reproduces better the flow's configuration. Due to its complexity, the triangular grid is generated by a numerical algorithm that simultaneously adapts itself to the reservoir's external boundaries and to the contours of heterogeneous regions, if they exist. For mathematical modeling the Black-Oil model was used, resulting from the combination of an integral mass balance with the Darcy's law. The integral flow equations are discretized by finite differences, using the perpendicular bissector method, and afterwards the discretized flow equations are solved by the SS implicit method. Finally, some applications of reservoirs numerical simulation are illustrated, by solving a typical problem of reservoir engineering, with the freeware-simulator BOAST98.
Keywords: Numerical Reservoirs Simulation. Black-Oil. Triangular Grid.
LISTA DE FIGURAS
Figura 2.1 - Exemplo de discretização espacial em duas dimensões.................13
Figura 2.2 - Resumo das aplicações dos modelos de simulação de reservatórios.....17
Figura 2.3 - Modelo 1D...........................................................17
Figura 2.4 - Modelo 2D cross-sectional...........................................18
Figura 2.5 - Modelo 2D areal.....................................................18
Figura 2.6 - Modelo radial.......................................................18
Figura 2.7 - Modelo 3D...........................................................19
Figura 2.8 - Etapas de um estudo de reservatório usando um simulador numérico ... 20
Figura 2.9 - Esquema geral do processo de ajuste de histórico....................23
Figura 3.1 - Malha bloco-centrado................................................25
Figura 3.2 - Malha ponto	distribuído............................................25
Figura 3.3 - Exemplo de	malha retangular.......................................26
Figura 3.4 - Exemplo de	malha cilíndrica.......................................26
Figura 3.5 - Exemplo de	malha corner-point.....................................27
Figura 3.6 - Exemplo de	refinamento local......................................28
Figura 3.7 - Exemplo de	malha híbrida..........................................28
Figura 3.8 - Malhas Voronoi e Delaunay...........................................29
Figura 3.9 - Caminhos de fluxo para fluxos paralelo e diagonal...................30
Figura 3.10 - Malhas paralela e diagonal.........................................30
Figura 3.11 - Esquemas nine-spot e five-spot.....................................31
Figura 3.12 - (a) Plano físico e (b) Plano transformado..........................35
Figura 3.13 - (a) Plano físico e (b) Plano transformado..........................36
Figura 3.14 - Malha triangular no plano transformado.............................38
Figura 4.1 - Elemento de controle................................................41
Figura 5.1 - Exemplo de malha triangular.........................................48
Figura 5.2 - Método das mediatrizes..............................................49
Figura 5.3 - Método das medianas.................................................49
Figura 6.1 - Reservatório sob esquema five-spot.............................64
Figura 6.2 - Pressões no bloco produtor e na “boca” do poço produtor........65
Figura 6.3 - Saturação de óleo no bloco produtor............................65
Figura 6.4 - Saturação de água no bloco produtor............................66
Figura 6.5 - Mapa de saturação de óleo após 90 dias.........................66
Figura 6.6 - Mapa de saturação de água após 90 dias.........................67
LISTA DE TABELAS
Tabela 6.1 - Dados do reservatório .....................................................63
Tabela 6.2 - Dados P.V.T. dos fluidos...................................................64
LISTA DE SÍMBOLOS
Nomenclatura
A	área da face do elemento de controle, m2
A	área superficial do volume de controle, m2
A	área do reservatório, m2
Ba	fator volume de formação da água, m3/m3std
B o	fator volume de formação do óleo, m3/m3std
cf	compressibilidade efetiva do meio poroso, 1/Pa
D	profundidade, m
fg	fator geométrico de transmissibilidades, m3
g	aceleração da gravidade, m/s2
h	espessura do bloco produtor, m
J	matriz Jacobiano
k	permeabilidade absoluta do meio poroso, m2
kro	permeabilidade relativa ao óleo
kra	permeabilidade relativa a água
krao	permeabilidade relativa água/óleo
k roa	permeabilidade relativa óleo/água
K	tensor de permeabilidades absolutas
i	linha de malha entre os pontos de malha i e j
ma	massa cumulada, Kg
me	massa que entra, Kg
ms	massa que sai, Kg
mf / s	massa que entra ou sai através de uma fonte ou de um sumidouro, Kg
mv	massa contida no elemento de controle, Kg
m	vazão mássica por unidade de área, Kg/s/m2
p	pressão, Pa
Pc	pressão capilar, Pa
Pr	pressão do reservatório, Pa
	pressão de fluxo no poço, Pa
q	vazão volumétrica por unidade de volume, m3/s/m3
Q	vazão volumétrica, m3/s
Q	vazão mássica, Kg/s
Qm	vazão mássica que entra ou sai por fonte ou sumidouro, Kg/s
ro	raio equivalente de drenagem, m
rw	raio do poço, m
R	função resíduo
s	variável espacial ao longo de uma linha de malha, m
s	fator de película
Sa	saturação de água
So	saturação de óleo
t	tempo, s
T	transmissibilidade, m3/(Pa.s)
u	velocidade superficial ou de Darcy, m/s
u	vetor de velocidade superficial ou de Darcy
V	volume do elemento de controle, m3
V	volume do bloco de malha, m3
x e y	coordenadas do ponto de malha (plano real), m
x, y e z	coordenadas retangulares, m
WI	índice de poço
X	incógnitas (P ou Sa)
Letras Gregas
a, ( e y	funções quadráticas
2	mobilidade
P n e Ç	viscosidade, Pa.s coordenada do ponto de malha (plano transformado), m
p	massa específica, Kg/m3
0
0
Subscritos
porosidade
potencial de fluxo, Pa
a	água
a	acumulada
e	entra
f / 5	fonte ou sumidouro
i,	j	interface dos blocos	de malha	i	e	j
i	índice do ponto de malha de	um	determinado bloco
j	índices dos pontos de malha vizinhos a um determinado bloco
o	óleo
p	fase (óleo ou	água)
5	sai
SUMÁRIO
1	INTRODUÇÃO...................................................1
1.1	OBJETIVOS................................................1
1.2	JUSTIFICATIVA............................................2
1.3	RELEVÂNCIA...............................................3
1.4	METODOLOGIA..............................................3
1.5	ESTRUTURA DO TRABALHO....................................4
2	SIMULAÇÃO NUMÉRICA DE RESERVATÓRIOS: ESTADO DA ARTE..........6
2.1	UMA BREVE HISTÓRIA DA SIMULAÇÃO DE RESERVATÓRIOS.........7
2.2	SIMULADORES NUMÉRICOS DE RESERVATÓRIO....................9
2.2.1	Metodologia.........................................10
2.3	TIPOS DE SIMULADORES NUMÉRICOS DE RESERVATÓRIO..........13
2.3.1	Classificação pelo Tratamento Matemático............14
2.3.2	Classificação Quanto à Geometria do Modelo..........17
2.3.3	Classificação de Acordo com o Número de Fases.......19
2.4	ETAPAS NA EXECUÇÃO DE UM ESTUDO DE RESERVATÓRIO UTILIZANDO
SIMULADORES NUMÉRICOS.......................................20
2.4.1	Coleta e Preparação de Dados ...................... 20
2.4.2	Preparação do Modelo de Simulação ................. 21
2.4.3	Ajuste de Histórico.................................21
2.4.4	Extrapolação........................................23
3	MALHAS DE DISCRETIZAÇÃO.....................................24
3.1	GEOMETRIAS DE MALHAS AREAIS.............................25
3.2	O EFEITO DE ORIENTAÇÃO DE MALHA.........................30
3.3	CONSTRUÇÃO NUMÉRICA DA MALHA............................33
3.3.1	Método Numérico de Construção da Malha Triangular...33
3.3.1.1	Formulações matemática e numérica...............36
4	FORMULAÇÃO INTEGRAL DAS EQUAÇÕES DE FLUXO...................41
4.1	LEIA DA CONSERVAÇÃO DE MASSA............................41
4.2	LEI DE DARCY............................................44
4.3	EQUAÇÕES DE FLUXO.......................................46
5	MODELO NUMÉRICO.............................................48
5.1	CONSTRUÇÃO DOS BLOCOS DE MALHA..........................48
5.1.1	Método das Mediatrizes..............................48
5.2	DISCRETIZAÇÃO DAS EQUAÇÕES DE FLUXO SEGUNDO O MÉTODO DAS
MEDIATRIZES...................................................50
5.2.1	Discretização do Termo de Fluxo.......................50
5.2.2	Discretização do Termo de Acumulação..................52
5.2.3	Equação de Fluxo Discretizada.........................52
5.3	SOLUÇÃO DO MODELO NUMÉRICO................................53
5.3.1	Resolução Pela Formulação SS Implícita................55
5.4	MODELO DE POÇO............................................60
6	APLICAÇÕES DA SIMULAÇÃO DE RESERVATÓRIOS......................63
7	CONCLUSÕES E RECOMENDAÇÕES....................................69
REFERÊNCIAS BIBLIOGRÁFICAS......................................71
1	INTRODUÇÃO
O aumento acentuado da demanda energética em todo o mundo nas últimas décadas obrigou a sociedade a buscar soluções, a fim de evitar uma crise energética. Tornaram-se necessários, além da auto-suficiência e desenvolvimento tecnológico em fontes de energia vitais como o petróleo, a busca por fontes alternativas (e o domínio da tecnologia envolvida) e a otimização do consumo de energia. Contudo, viu-se necessária a criação de novas áreas de atuação profissional voltadas para a indústria energética, tal como a engenharia de petróleo, que trata em particular dos ramos da indústria do petróleo relacionados à exploração e produção (OLIVEIRA, 2009).
As funções de um engenheiro de petróleo são, entre outras, a quantificação de reservas, a criação de projetos de desenvolvimento de campos petrolíferos e de extração dos hidrocarbonetos contidos nestes, e o dimensionamento dos sistemas de produção necessários. A execução de tais projetos pode envolver investimentos de centenas de milhões de dólares e devem, portanto, ter seus riscos calculados e minimizados. Tal tarefa deve levar em consideração fatores físicos e químicos complexos envolvidos, tais como as variações regionais das propriedades dos fluidos e das da rocha (OLIVEIRA, 2009).
A complexidade inerente a esta tarefa levou à criação da simulação numérica de reservatórios, que vem sendo utilizada há décadas, e tornou-se uma indispensável ferramenta para a indústria de exploração de petróleo, com aplicação desde a descoberta até o abandono de um campo (OLIVEIRA, 2009).
1.1	OBJETIVOS
O objetivo do presente trabalho é o de apresentar um estudo sobre essa tradicional e complexa aplicação da indústria do petróleo, a simulação numérica de reservatórios. Serão apresentados o que é e como é feita uma simulação de reservatório, detalhando os aspectos envolvidos nesta. Para tal, serão discutidos: etapas e metodologia envolvidas no desenvolvimento de uma simulação de reservatório, simuladores numéricos de reservatório, malhas de discretização e métodos de geração destas, modelos para tratamento matemático do comportamento dos fluidos, métodos de construção dos blocos de malha, modelo numérico para
resolução das equações de fluxo, método de resolução do modelo numérico e método de aproximação para modelo de poço.
O estudo a ser desenvolvido terá como foco a simulação utilizando o método das diferenças finitas com malha triangular e a modelagem matemática Black-Oil, para representação do comportamento dos fluidos, de sistemas com escoamento bidimensional-bifásico óleo/água. Como conclusão do estudo, serão exemplificadas algumas aplicações da simulação de reservatórios, através da utilização do software gratuito de simulação BOAST98.
Este trabalho tem como objetivos específicos:
•	Fornecer uma visão geral da simulação numérica de reservatórios;
•	Discutir os tipos de malha de discretização e os métodos de construção destas;
•	Descrever a formulação matemática do modelo Black-Oil;
•	Descrever o modelo numérico para resolução das equações de fluxo, e o método de resolução deste;
•	Efetuar a simulação de um problema típico da engenharia de reservatórios, com a utilização do simulador BOAST98.
1.2	JUSTIFICATIVA
Como justificativa para elaboração do presente trabalho pode-se considerar o interesse pela área de engenharia de reservatórios, em específico no que se refere à simulação de reservatórios.
A complexidade instigante e a importância desta área levam à consideração da realização de uma pós-graduação em engenharia de reservatório, e o seguimento de uma carreira nesta área.
Contudo, o estudo mais aprofundado da simulação de reservatórios, por meio da elaboração do presente trabalho, é um importante primeiro passo para a pretendida futura carreira de engenheiro de reservatórios.
1.3	RELEVÂNCIA
Uma das mais importantes etapas na exploração de um reservatório de petróleo é a descrição mais verossímil possível deste, através da construção de um modelo de simulação. Quanto mais acurado for o modelo construído, melhor prever-se-á o comportamento futuro do reservatório (MACHADO, 2010).
Tendo-se conhecimento aproximado do comportamento futuro do reservatório, podem-se elaborar estratégias de gerenciamento do reservatório que maximizem a porcentagem de recuperação final dos fluidos contidos neste e, consequentemente, a rentabilidade do projeto de exploração.
Portanto, a simulação numérica de reservatórios tem fundamental importância na engenharia de reservatórios, sendo indispensável para o sucesso do processo de explotação de um reservatório de petróleo.
1.4	METODOLOGIA
O objetivo deste trabalho é o de apresentar um estudo sobre a simulação numérica de reservatórios.
Para atingir o objetivo final, foi adotada uma metodologia de desenvolvimento constituída das seguintes etapas:
a)	Levantamento bibliográfico
A etapa inicial consistiu na realização de uma pesquisa bibliográfica para o levantamento e estudo do material que há disponível acerca do tema, e seleção do material base para o desenvolvimento do trabalho.
b)	Construção dos capítulos conceituais
O passo seguinte foi a abordagem conceitual da simulação numérica de reservatórios. Foram desenvolvidos capítulos conceituais que apresentaram primeiramente o que é a simulação numérica e um simulador numérico de reservatórios, e em seguida os aspectos envolvidos num estudo de simulação.
c)	Aplicações
Em seguida, foram exemplificadas algumas aplicações da simulação de reservatórios, com a utilização do simulador BOAST98.
d)	Apresentação das conclusões e recomendações
Por fim, foram apresentadas as conclusões sobre o estudo realizado e as recomendações para realização de trabalhos futuros.
1.5	ESTRUTURA DO TRABALHO
O presente trabalho é constituído de sete capítulos, que são: Simulação Numérica de Reservatórios: Estado da Arte; Malhas de Discretização; Formulação Integral das Equações de Fluxo; Modelo Numérico; Aplicações da Simulação de Reservatórios; Conclusões e Recomendações.
O capítulo 2, Simulação Numérica de Reservatórios: Estado da Arte, apresenta uma visão geral da simulação de reservatórios, incluindo metodologia e etapas envolvidas num estudo de simulação.
O capítulo 3, Malhas de Discretização, fornece uma discussão conceitual sobre malhas de discretização e o método numérico de construção adotado no presente trabalho.
No capítulo Formulação Integral das Equações de Fluxo é apresentada a formulação matemática do modelo Black-Oil, obtida através de um balanço de materiais combinado com a lei de Darcy.
Em seguida, o capítulo Modelo Numérico apresenta o método de construção dos blocos de malha adotado no presente trabalho, a forma discretizada das equações de fluxo seguindo este método e o método numérico para resolução destas. É ainda abordado, por fim, o modelo de poço adequado para a geometria de blocos de malha adotada.
No capítulo 6, Aplicações da Simulação de Reservatórios, são exemplificadas algumas aplicações da simulação de reservatórios, com a utilização do simulador gratuito BOAST98.
E, por fim, as conclusões acerca dos resultados obtidos na elaboração do presente trabalho e as recomendações para trabalhos futuros são apresentadas no capítulo final, Conclusões e Recomendações.
2	SIMULAÇÃO NUMÉRICA DE RESERVATÓRIOS: ESTADO DA ARTE
O objetivo principal de uma simulação numérica de reservatório é o de predizer o comportamento futuro de um reservatório e de prover meios para aumentar-se a porcentagem de recuperação final dos fluidos contidos neste. Isto é, a simulação é utilizada para auxílio na tomada de decisões de desenvolvimento, tais como de decisão de desenvolvimento inicial de um campo e aquelas relacionadas à implementação de um método de recuperação avançada, por exemplo, WAG - Water Alternating Gas ou, em português, injeção alternada de água e gás. (WATTS, 1997).
Através dela é possível, de acordo com Rosa, Carvalho e Xavier (2006): a determinação do melhor esquema de desenvolvimento do campo em estudo; o estudo de métodos de recuperação através da análise do comportamento do reservatório quando sujeito à injeção de diferentes tipos de fluidos (água, gás, vapor, etc.); a análise da influência da vazão de produção e/ou injeção na recuperação dos hidrocarbonetos; a determinação do efeito de localização dos poços, e do espaçamento entre eles, na recuperação final; a determinação das vazões de produção críticas para conter problemas de cone de água e/ou gás e a simulação de modelos físicos de laboratório.
Staggs e Herbeck (1971 apud COATS, 1982) fornecem, com exemplos, uma detalhada discussão sobre os usos da simulação. COATS (1969 apud COATS, 1982) fornece uma discussão geral sobre usos corretos e incorretos do processo de simulação. McCulloch et al. (1969 apud COATS, 1982) descrevem algumas aplicações da simulação em escala de campo.
Devido aos avanços feitos desde o final da década de 1950 na tecnologia de hardware e software computacional, a tecnologia em simulação de reservatórios vem sendo continuamente aprimorada, possibilitando a formulação de sofisticados modelos para descrever os mais complexos processos que ocorrem em reservatórios durante a implementação de um esquema de recuperação (WATTS, 1997).
2.1	UMA BREVE HISTÓRIA DA SIMULAÇÃO DE RESERVATÓRIOS
A simulação de reservatórios vem sendo utilizada desde o início da engenharia de petróleo na década de 1930. A simulação é simplesmente o uso de cálculos para predizer o desempenho do reservatório (a previsão de recuperação ou comparar a economia de métodos alternativos de recuperação). Antes de 1960, estes cálculos consistiam principalmente em métodos analíticos, balanços materiais de dimensão zero e cálculos unidimensionais (1D) de Buckley-Leverett (COATS, 1982).
Ao final dos anos 1940, várias empresas reconheceram a potencialidade da simulação de reservatórios e iniciaram o desenvolvimento de modelos analógicos e numéricos buscando melhorar os existentes balanços materiais, soluções analíticas e cálculos de deslocamento unidimensional (1D) de Buckley-Leverett (BREITENBACH, 1991).
Esforços importantes no que tange à investigação fundamental sobre a solução numérica das equações de fluxo começaram a dar resultados significativos ao fim da década de 1950. Estes resultados foram programas de computador crus, porém úteis, para a simulação numérica de reservatórios. Pela primeira vez, os engenheiros de reservatório tiveram recursos para resolver problemas de maior complexidade (BREITENBACH, 1991).
O termo “simulação” tornou-se comum no início dos anos 1960, com a evolução dos então crus programas de simulação para programas de computador relativamente sofisticados. Estes programas representaram um avanço importante porque permitiram a solução de grandes conjuntos de equações de diferenças finitas que descrevem o fluxo multifásico 2D e 3D, transiente, em meios porosos heterogêneos. Este avanço foi possível graças à rápida evolução dos computadores digitais de alta velocidade e grande escala, e ao desenvolvimento de métodos matemáticos numéricos para a resolução de grandes sistemas de equações de diferenças finitas (COATS, 1982).
Durante a década de 1960, os esforços em simulação de reservatórios foram voltados principalmente a problemas de reservatório bifásicos água/gás e trifásicos de Black-Oil. Os métodos de recuperação simulados eram limitados essencialmente a depleção ou manutenção de pressão (COATS, 1982). Muitos programas de computador foram desenvolvidos para lidar com e resolver grande parte dos mais comuns problemas de reservatório encontrados até então (BREITENBACH, 1991).
Entretanto, durante a década de 1970, o quadro mudou significativamente. O aumento acentuado dos preços do petróleo e as tendências governamentais para a desregulamentação e financiamento parcial de projetos-piloto de campo levaram a uma proliferação dos processos de recuperação avançada (COATS, 1982). Com os avanços nas técnicas de solução numérica e o aumento da velocidade dos computadores (BREITENBACH, 1991), foram desenvolvidos simuladores matemáticos que permitiram a simulação de novos processos que se estendiam além das convencionais depleção e manutenção da pressão, para inundação miscível, inundação química, injeção de CO2, estimulação/inundação de vapor ou água quente, e combustão in-situ. Como adição ao simples fluxo multifásico em meios porosos, os simuladores passaram a ter que refletir adsorção e degradação químicas, emulsificantes e os efeitos da redução da tensão interfacial, cinética de reação, e outros efeitos térmicos e complexos comportamentos de equilíbrio de fases (COATS, 1982).
A gama de aplicações de simulação de reservatórios continuou a se expandir durante a década de 1980. A descrição dos reservatórios finalmente torna-se um dos principais tópicos, e avança para o uso da geoestatística como ferramenta para a descrição de heterogeneidades e o fornecimento de uma definição de reservatório não expressa pelos modelos de reservatório então existentes. Neste período também foi desenvolvida a tecnologia para modelar reservatórios naturalmente fraturados, incluindo efeitos de composição, com extensões na simulação de fraturamento hidráulico e de poços horizontais, e aplicação em processos complexos como o monitoramento de reservatório. As aplicações primárias de simulação de reservatórias que eram feitas em mainframes no início da década, passaram a ser feitas em desktops no final desta (BREITENBACH, 1991).
Os esforços dominantes da década de 1990 foram direcionados para desenvolver simuladores de mais fácil utilização. Esses esforços incluem o trabalho nas GUI's (Graphical User Interfaces - Interfaces Gráficas de Usuário), as tentativas de generalização da integração de dados, e o desenvolvimento de pacotes de malhas automáticas. O uso de modelos geológicos numéricos, frequentemente representando variações de propriedades em fina escala estatisticamente geradas, tornou-se generalizado. Houve um trabalho considerável sobre os métodos de upscaling das propriedades de reservatório. A flexibilidade da geração de malhas aumentou com o uso do refinamento local de malha e de malhas de geometrias mais complexas. Houve também integração da simulação de reservatórios com ferramentas computacionais
não referentes ao reservatório, tais como modelos de instalações e pacotes de economia (WATTS, 1997).
Na década de 2000 os avanços significativos em hardware, em específico dos processadores, e o fortalecimento do processamento paralelo com a utilização dos chamados clusters (supercomputadores com milhares de núcleos de processamento trabalhando paralelamente) permitiram cada vez mais a utilização de refinamento de malhas e os simuladores passaram a ser capazes de trabalhar com malhas de centenas de milhares a milhões de células, o que levou a possibilidade de representações cada vez mais reais das geometrias de reservatório mais complexas. Os simuladores passaram a ser mais interativos e de mais fácil utilização, com uma maior possibilidade de pré- e pós-processamento por parte do usuário, e com capacidade abrangente de resolução dos diversos problemas de simulação de reservatórios.
2.2	SIMULADORES NUMÉRICOS DE RESERVATÓRIO
Segundo Ertekin, Abou-Kassen e King (2001), um simulador numérico de reservatório é um modelo computacional capaz de gerar previsões precisas do comportamento de um reservatório de petróleo sob diferentes condições de operação. E conforme Soares (2002 apud OLIVEIRA, 2009), esse modelo baseia-se na teoria de fluxo em meios porosos, que possui um campo de aplicação abrangente, sendo utilizada não só na engenharia de reservatórios, mas também em diversas outras áreas da ciência e engenharia como: modelagem de aquíferos, mecânica dos solos, fluxo de contaminantes e análises de fluxo sanguíneo no interior do corpo humano.
Para a elaboração desse modelo computacional é necessário o entendimento da caracterização das jazidas, das propriedades das rochas e dos fluidos nelas contidos, da maneira como esses fluidos interagem entre si no interior da rocha, além das leis físicas que regem o movimento dos fluidos no seu interior. A partir desse entendimento torna-se possível a elaboração de um modelo de simulação que possa, por fim, ser simulado (GRECCO, 2007).
A precisão de um simulador numérico de reservatório é proporcional à quantidade e qualidade das propriedades dos fluidos e da rocha utilizadas para a obtenção do modelo numérico. No entanto, ao utilizar-se um número maior de características, há um significativo aumento do custo computacional da simulação.
Portanto, uma das questões na simulação é a busca pelo equilíbrio entre precisão e custo computacional (OLIVEIRA, 2009).
2.2.1	Metodologia
As complexas equações diferenciais resultantes do modelo matemático formulado, utilizado para obtenção do modelo numérico, geralmente não podem ser resolvidas analiticamente, devido à natureza não-linear, e, por isso, técnicas de discretização numérica são utilizadas para obter uma solução aproximada. O processo de discretização consiste na conversão de equações contínuas (e seu domínio) em equações de discretas (MACHADO, 2010). Diversos métodos de solução de equações diferenciais parciais estão disponíveis na literatura (método de volumes finitos, método de elementos finitos, método das diferenças finitas, etc.), sendo o papel de qualquer um desses, o de obter uma solução aproximada de uma equação diferencial parcial através da construção de um sistema de equações algébricas.
De acordo com Machado (2010), o método mais utilizado em simuladores de reservatórios é o método das diferenças finitas. Este método é implementado por imposição de uma malha de diferenças finitas sobre o reservatório a ser modelado. A malha de discretização escolhida é então utilizada para aproximar as derivadas espaciais das equações contínuas (MACHADO, 2010), tratando o eixo coordenado contínuo através de pontos isolados (OLIVEIRA, 2009), como mostra a figura 2.1. A discretização do tempo consiste em dividir o domínio do tempo em intervalos, onde, em cada passo de tempo, são calculadas as incógnitas do problema. Estas aproximações das derivadas espaciais e temporal em diferenças finitas são obtidas por truncamento da expansão das séries de Taylor, para as incógnitas pressão e saturação (MACHADO, 2010).
Figura 2.1 - Exemplo de discretização espacial em duas dimensões (OLIVEIRA, 2009).
Cada bloco da malha gerada possui um valor médio para cada uma das propriedades do reservatório (como porosidade e permeabilidade) e dos fluidos (pressão, saturação, temperatura, composição, etc.), que varia com o tempo durante o período de simulação (COATS, 1982).
A aplicação das técnicas de discretização do espaço e do tempo gera, para cada bloco da malha, um sistema de equações algébricas não lineares (equações de diferenças finitas) que deve ser resolvido para cada subintervalo de tempo. Estas equações descrevem o transporte de fluidos ao longo de cada face do bloco de malha (BREITENBACH, 1991). Em razão da não linearidade, os sistemas devem ser resolvidos por um método numérico iterativo. Este método numérico consiste na linearização das equações de diferenças finitas, fornecendo como resultado um sistema de equações lineares que deve ser resolvido para cada passo de iteração do método. Dessa forma, a resolução de sistemas de equações lineares é uma atividade extremamente importante na simulação de reservatório e, segundo Chen, Huan e Ma (2006), chega a ocupar de 80 a 90% do tempo da simulação.
Os métodos de solução de sistemas de equações lineares podem ser divididos, basicamente, em dois grupos: métodos diretos e métodos iterativos. Segundo Gilat e Subramaniam (2000), os métodos diretos utilizam algoritmos de fatoração para encontrar a solução exata do sistema em um número fixo de passos; já os métodos iterativos tentam aproximar, a cada iteração, uma solução inicial (pouco precisa) à solução real do sistema. As iterações são realizadas até que a solução aproximada seja suficientemente precisa. Para a resolução de problemas de larga escala, como os da simulação de reservatório, Fanchi, Harpole e Bujnowski (1982, apud OLIVEIRA, 2009) apontam a utilização de métodos iterativos como mais adequada que a utilização de métodos diretos.
Os métodos numéricos para resolução das equações de diferença finitas podem ser explícitos, implícitos ou híbridos, de acordo com o tratamento das incógnitas do problema nos passos de iteração. Os métodos explícitos são condicionalmente estáveis e fornecem convergência rápida, porém não garantida. Na simulação de reservatórios os métodos híbridos e totalmente implícitos, que são incondicionalmente estáveis e apresentam convergência mais lenta, são os mais utilizados por fornecerem convergência garantida. Os mais utilizados são as formulações IMPES, SEQ (Sequencial) e SS (Solução Simultânea) implícita (CHEN; HUAN; MA, 2006).
O método híbrido IMPES, cuja sigla denota Implicit Pressure and Explicit Saturation - ou, em português, Pressão Implícita e Saturação Explícita -, determina primeiramente os valores de pressão no nível de tempo novo utilizando saturações no nível de tempo passado, e depois utiliza as novas pressões no nível de tempo novo para calcular explicitamente as saturações no nível de tempo novo. Isto é, a solução de uma única equação de pressão é seguida por uma atualização explícita das saturações (e das transmissibilidades nos termos de fluxo) e composições dos fluidos em cada célula (COATS, 1982). Sheldon et al. (1960 apud COATS, 1982), Stone et al. (1961 apud COATS, 1982) e Fagin et al. (1966 apud COATS, 1982) fornecem uma descrição do método IMPES para problemas de Black-Oil.
MacDonald (1970 apud COATS, 1982) melhorou a estabilidade do método IMPES para o caso bifásico óleo/água adotando, após a solução de uma equação de pressão, a solução de uma equação de saturação de água sobre a malha, usando valores implícitos (em nível de tempo novo ou ao fim do passo de iteração) para as permeabilidades relativas nas transmissibilidades dos termos de fluxo intercelulares (COATS, 1982). Spillette et al. (1973 apud COATS, 1982) estendeu este conceito para o caso trifásico e chamou a formulação de Sequencial.
A formulação SS implícita faz uso de valores ao fim do passo de iteração para as permeabilidades relativas (e densidades e viscosidades) nas transmissibilidades dos termos de fluxo intercelulares (COATS, 1982). As incógnitas do problema são calculadas simultaneamente através da resolução simultânea de todas as N equações. Segundo Coats (1982), Blair e Weinaug (1969) foram os primeiros a publicar esta formulação totalmente implícita.
Os cálculos (ou custo computacional) por passo de iteração e o tamanho do time step (passo da discretização temporal) aumentam da formulação IMPES para a SEQ, e desta para a SS implícita. Estudos de cone de único poço geralmente envolvem espaçamentos de malha radiais, resultando em blocos de malha muito pequenos próximos ao poço e grandes taxas de transferência. Para estes estudos, a formulação IMPES é inadequada, e a formulação SS implícita é geralmente a mais eficiente. Para estudos 3D de Black-Oil, em escala de campo, o tempo total de computação é frequentemente menor com a formulação IMPES em comparação com a SS implícita, porque esta requer muita capacidade de armazenamento computacional, associada à solução das N equações simultaneamente (COATS, 1982).
Há ainda casos nos quais se utiliza um esquema implícito adaptativo (AIM -Adaptive Implicit Method). A idéia principal deste método híbrido é encontrar um meio termo eficiente entre as formulações SS implícita e IMPES (CHEN; HUAN; MA, 2006). Isto é, em um determinado passo de iteração, o simulador identifica as regiões do reservatório onde as variações de pressão e saturação são mais intensas e, para estas regiões, utiliza a computacionalmente custosa formulação SS implícita, enquanto nos blocos de malha restantes a formulação IMPES é implementada (MACHADO, 2010).
2.3	TIPOS DE SIMULADORES NUMÉRICOS DE RESERVATÓRIO
Há vários tipos de simuladores numéricos de reservatório. A escolha de qual tipo a ser utilizado depende de fatores, tais como: o problema a ser abordado, as características do reservatório e dos fluidos contidos neste, a quantidade e qualidade dos dados disponíveis, o detalhamento necessário do estudo e recursos de computação disponíveis (hardware).
Os simuladores numéricos normalmente são classificados em função de três características básicas (ROSA; CARVALHO; XAVIER, 2006): o tratamento matemático utilizado, a geometria do modelo adotada e o número de fases admitidas.
2.3.1	Classificação pelo Tratamento Matemático
Os tratamentos matemáticos do comportamento físico e da característica de desempenho determinam uma das classificações dos simuladores numéricos de reservatório. Na tentativa de obtenção de resultados cada vez mais próximos do comportamento real de um reservatório, diversos modelos de comportamento dos fluxos no reservatório foram desenvolvidos. A complexidade destes modelos aumenta
à medida que características (como reações químicas, variação de temperatura e miscibilidade de fluxos) dos reservatórios são adicionadas (OLIVEIRA, 2009).
A utilização de determinado modelo ou não depende de fatores relacionados ao reservatório, ao tipo de processo de recuperação utilizado e, principalmente, ao comportamento dos fluidos existentes. Os modelos de fluxo mais utilizados em simulações de reservatórios são (MATTAX; DALTON, 1990, apud OLIVEIRA, 2009): o modelo Black-Oil, o modelo composicional e os modelos térmicos.
a)	Modelo tipo Beta ou Black-Oil
O modelo Black-Oil considera cada uma das fases eventualmente presentes no reservatório (óleo, água e gás) constituídas de um único componente. Assim, por exemplo, a fase óleo é considerada formada por um único componente, denominado simplesmente óleo, apesar de na realidade o óleo ser constituído por diversos hidrocarbonetos (ROSA; CARVALHO; XAVIER, 2006). Considera-se que o componente óleo só existe na fase óleo (não possui volatilidade na fase gás), o componente água só existe na fase água e o componente gás pode encontrar-se na fase gás, livre no reservatório, ou dissolvido na fase óleo.
Esse modelo considera também que a temperatura do reservatório é constante e que não há reações químicas entre os componentes (OLIVEIRA, 2009). A sua utilização é recomendada para reservatórios que possuem óleos com baixa volatilidade, nos quais as variações na composição do óleo e efeitos térmicos não sejam significativos (PRAIS; CAMPAGNOLO, 1991), e em situações em que o processo de recuperação utilizado é insensível às mudanças composicionais nos fluidos do reservatório como, por exemplo, mecanismos de recuperação primária e injeção de água (MACHADO, 2010).
O modelo Black-oil, mesmo não sendo o modelo mais completo existente, é o mais utilizado pelos simuladores comerciais de reservatórios (FACHI; HARPOLE; BUJNOWSKI, 1982; CMG, 1995; SCHLUMBERGER, 2009 apud OLIVEIRA, 2009) por obter resultados satisfatórios em espaços de tempo aceitáveis. Os demais modelos mais completos, devido ao alto custo do ponto de vista computacional, não são adequados para a maioria dos casos práticos.
b)	Modelo composicional
No modelo composicional as composições das diversas fases eventualmente presentes no meio poroso são levadas em consideração no tratamento matemático. A fase óleo não é mais admitida como sendo formada por um único componente, mas sim pelos vários hidrocarbonetos que compõem o óleo, tais como Ci, C2, C3, etc.. Como geralmente o número de hidrocarbonetos presentes em um determinado óleo ou gás é muito grande, costuma-se agrupar diversos desses componentes, para fins de simplificação, dando origem a um grupo chamado de pseudocomponente (ROSA; CARVALHO; XAVIER, 2006).
Exemplificando: em um determinado reservatório a fase óleo poderia ser representada por dois componentes e dois pseudocomponentes, C1, C2, C3 - C6 e C7+. Ou seja, os hidrocarbonetos C3, C4, C5 e C6 estariam representados pelo pseudocomponente C3 - C6, enquanto aqueles com pesos moleculares maiores que o do C6 estariam englobados no pseudocomponente C7+. Sem a utilização desta simplificação, e a consequente redução do tempo computacional, situações complexas com um número muito grande de componentes tornar-se-iam de simulação impraticável (ROSA; CARVALHO; XAVIER, 2006).
As propriedades das fases gás e óleo e as constantes de equilíbrio químico (K) são obtidas por correlações em função da composição e da pressão, ou por equações de estado (COATS, 1982).
Os modelos composicionais são utilizados na simulação de processos de recuperação para os quais as considerações de composição constante e imiscibilidade das fases óleo e gás são inválidas (COATS, 1982). Alguns exemplos são (MACHADO, 2010): depleção de reservatórios de óleo volátil e gás retrógrado, processos de recuperação baseados em miscibilidade após múltiplos contatos e processos de injeção de CO2 e N2.
Há ainda os modelos chamados semi-composicionais, nos quais a única diferença em relação aos modelos composicionais é o fato de que a constante de equilíbrio químico é constante em relação a mudanças de composição, isto é, varia apenas com alterações da pressão e da temperatura (MACHADO, 2010).
c)	Modelo térmico
O modelo térmico é utilizado em casos em que é necessária a consideração dos efeitos de variações na temperatura no interior do reservatório como, por exemplo, no caso em que é estudada a aplicação de um método térmico de recuperação avançada em reservatórios de óleo pesado (injeção de vapor, injeção de água quente, combustão in situ, etc.). Estes modelos utilizam associado ao balanço de massa um balanço energético, para cada componente. Os modelos térmicos utilizam necessariamente um tratamento composicional, devido ao fato de tratarem situações complexas (ROSA; CARVALHO; XAVIER, 2006) e, assim como os modelos composicionais, utilizam correlações P.V.T. para descrever as propriedades dos componentes das fases óleo e gás como funções da pressão, temperatura e composição (COATS, 1982).
d)	Outros
Além dos modelos supracitados, há outros, porém menos populares, utilizados em situações específicas, tais como, de acordo com Machado (2010): simulação de processos químicos (por exemplo, injeção de polímeros e surfactantes) e microbiológicos (por exemplo, geração de H2S no reservatório por bactérias redutoras de sulfato), e simulação de reservatórios naturalmente fraturados (alguns reservatórios carbonáticos, por exemplo).
No caso da simulação de reservatórios naturalmente fraturados, é utilizado o chamado modelo de dois meios (dual media) - fratura-matriz -, que considera a rocha reservatório composta por duas redes interconectadas, fratura e matriz, cada uma com suas próprias propriedades. Este modelo “roda” com formulações Black-Oil ou composicional, de acordo com o problema abordado, utilizando diferentes configurações, dependendo se o fluxo na matriz é permitido ou não, usualmente chamadas de dupla-porosidade e de dupla-permeabilidade (MACHADO, 2010).
Um resumo das aplicações dos modelos de simulação de reservatórios, de acordo com o tipo do hidrocarboneto, é mostrado na figura 2.2.
Figura 2.2 - Resumo das aplicações dos modelos de simulação de reservatórios
(MACAHADO, 2010).
2.3.2	Classificação Quanto à Geometria do Modelo
Os tipos mais comuns de geometria são (COSENTINO, 2001):
a)	Modelo 1D
Por não representar a geometria real do reservatório e não poder simular o processo de deslocamento, esse tipo de modelo nunca é utilizado para um estudo em escala de campo. No entanto, ele pode ser usado para análises de sensibilidade de certos parâmetros do reservatório (figura 2.3).
Figura 2.3 - Modelo 1D (COSENTINO, 2001).
b)	Modelo 2D cross-sectional
É utilizado em estudos relacionados a processos de deslocamento vertical, por exemplo, casos de injeção de água ou gás, ou em casos nos quais o fluxo vertical é predominante (figura 2.4).
Figura 2.4 - Modelo 2D cross-sectional (COSENTINO, 2001).
c)	Modelo 2D areal
É utilizado quando padrões de escoamento areais são predominantes no reservatório e quando heterogeneidades verticais não são significativamente influentes na descrição do escoamento dos fluidos, ou ainda no caso de reservatórios onde os efeitos gravitacionais são desprezíveis. Este modelo é tipicamente aplicado em estudos de injeção (figura 2.5).
Figura 2.5 - Modelo 2D areal (COSENTINO, 2001).
d)	Modelo radial
Limita-se a região ao redor do poço, sendo usualmente construído para avaliação do comportamento da produção do poço na presença de gradientes verticais significativos. É tipicamente aplicado em estudos de cone de água e de gás em poços horizontais e verticais (figura 2.6).
Figura 2.6 - Modelo radial (COSENTINO, 2001).
e)	Modelo 3D
Este é o modelo mais utilizado e pode, teoricamente, ser utilizado para representar qualquer modelo de processo de recuperação no reservatório, sendo a única limitação o número total de células (devido ao custo computacional), que de um modo geral limita o grau de detalhamento na descrição. Este modelo pode levar em consideração a distribuição de propriedades geológicas e petrofísicas do reservatório e, além disso, pode ser utilizado na presença de grandes heterogeneidades verticais ou horizontais e de um modo geral sempre que a geologia é muito complexa para uma representação 2D.
O modelo 3D permite que o reservatório inteiro seja modelado e é, portanto, a melhor escolha para um estudo integrado. Entretanto, principalmente nos casos de grandes campos de petróleo, os quais possuem uma grande quantidade de informações, nem sempre é necessário ou desejável construir um estudo para o campo inteiro. Nestes casos, uma alternativa mais viável é uma combinação de estudos de menor escala e técnicas convencionais de engenharia de reservatórios para a representação do campo inteiro (figura 2.7).
Figura 2.7 - Modelo 3D (COSENTINO, 2001).
2.3.3	Classificação de Acordo com o Número de Fases
Os simuladores numéricos de reservatórios podem ser classificados de acordo com o número de fases admitidas em monofásicos, bifásicos e trifásicos (ROSA; CARVALHO; XAVIER, 2006):
a)	Monofásico
Considera uma só fase presente no reservatório (óleo, gás ou água no caso de se tratar de um aquífero).
b)	Bifásico
Considera duas fases presentes no reservatório, geralmente óleo e água (reservatório de óleo) ou gás e água (reservatório de gás).
c)	Trifásico
Considera três fases presentes no reservatório como, por exemplo, no caso de escoamento óleo/água e sólidos (resinas e asfaltenos, por exemplo).
2.4	ETAPAS NA EXECUÇÃO DE UM ESTUDO DE RESERVATÓRIO UTILIZANDO SIMULADORES NUMÉRICOS
O processo de simulação consiste na descrição do reservatório, ajuste de histórico e então na predição do comportamento futuro do reservatório sob diferentes cenários de desenvolvimento (BREITENBACH, 1991). As etapas normalmente seguidas podem ser resumidas no fluxograma apresentado na figura 2.8.
Figura 2.8 - Etapas de um estudo de reservatório usando um simulador numérico (ROSA; CARVALHO; XAVIER, 2006).
2.4.1	Coleta e Preparação de Dados
Nesta etapa inicial, todos os dados disponíveis acerca do reservatório sob estudo, incluindo dados geológicos, da rocha, dos fluidos, da produção e da completação de poços, são armazenados e interpretados. A confiabilidade do estudo é proporcional à quantidade e à qualidade destes dados (ROSA; CARVALHO; XAVIER, 2006).
O resultado da descrição do reservatório é o chamado modelo de reservatório, que inclui: geometria do reservatório; permeabilidade, porosidade e espessura de cada bloco de malha; permeabilidade relativa e pressão capilar vs. saturação para cada parte do reservatório; e tabelas com propriedades P.V.T. dos fluidos (BREITENBACH, 1991). Unindo-se o modelo de reservatório, os dados de completação e produção dos poços e o modelo numérico, obtém-se o chamado modelo de simulação (MACHADO, 2010).
2.4.2	Preparação do Modelo de Simulação
A etapa seguinte à coleta e preparação dos dados consiste na preparação do modelo de simulação. Nesta etapa o modelo de reservatório é transposto para o modelo numérico. O modelo de reservatório fornece ao modelo numérico os dados necessários par compor o modelo de simulação, tais como geometria do grid, propriedades do reservatório, propriedades dos fluidos, etc.. E assim, o modelo de simulação contém todas as informações necessárias para “alimentar” o simulador numérico (ROSA; CARVALHO; XAVIER, 2006).
2.4.3	Ajuste de Histórico
Para reservatórios que já produzem, isto é, que possuem um histórico de produção dos poços, o modelo de simulação deve reproduzir esses dados o mais verossimilmente possível, além de dados de testes de pressão, perfis de saturação e inícios da chegada da água injetada (MACHADO, 2010). Mas mesmo com a evolução nas tecnologias e métodos de aquisição, a quantidade e qualidade de dados geológicos obtidos ainda não são suficientes para representar e reproduzir perfeitamente os reservatórios e, portanto, a acurácia das previsões fornecidas pelo modelo de simulação pode não ser satisfatória (GRECCO, 2007).
A etapa de ajuste de histórico, ilustrada pelo fluxograma da figura 2.9, consiste na calibração do modelo de simulação com o reservatório real através dos melhores dados disponíveis dos históricos de produção (água, óleo e gás) e de pressão, isto é, o ajuste de histórico tem o objetivo de tornar as previsões fornecidas pelo modelo de simulação consistentes com os dados de produção, dentro das restrições geológicas (GRECCO, 2007).
Figura 2.9 - Esquema geral do processo de ajuste de histórico (GRECCO, 2007).
O ajuste é realizado variando-se parâmetros de entrada de uma simulação para outra até que as previsões sejam consideradas adequadas. Os principais dados com que se trabalha no processo de ajuste são: permeabilidade absoluta da rocha, para ajuste de gradientes de pressão; permeabilidade absoluta e área de extensão das heterogeneidades verticais, para ajuste do escoamento vertical dos fluidos; permeabilidades relativas aos fluidos de produção e pressões capilares, para ajuste das frentes móveis de saturação; tamanhos de aquífero e de capa de gás e transmissibilidades, para ajustes de nível global de pressão e de fluxo (BREITENBACH, 1991); além de ajustes de porosidade da rocha, vazão de produção/injeção, pressão inicial do reservatório, etc. (GRECCO, 2007).
A escolha dos parâmetros a serem variados no processo de ajuste é uma tarefa difícil. Para tornar tal tarefa mais simples podem-se utilizar técnicas auxiliares, tal como a simulação por linhas de fluxo. A simulação por linhas de fluxo é um método numérico semelhante aos métodos clássicos de discretização numérica (método de volumes finitos, método de elementos finitos, método das diferenças finitas, etc.), porém mais rápido devido a algumas simplificações feitas para a modelagem do processo; devido a estas simplificações é um processo menos confiável e é utilizado apenas como ferramenta auxiliar. Esta técnica serve como uma ferramenta auxiliar no processo de ajuste de histórico de produção porque as linhas de fluxo podem ser utilizadas para determinar áreas onde ocorrem escoamentos no reservatório, possibilitando a definição das melhores regiões a terem os parâmetros geológicos alterados (GRECCO, 2007).
Contudo, se o ajuste de histórico for bem sucedido, o modelo de simulação é dito ajustado e poderá ser utilizado para se efetuar previsões confiáveis em relação ao comportamento futuro do reservatório. Caso contrário, o modelo de simulação
somente poderá ser utilizado para a realização de comparações semiquantitativas dos resultados dos diferentes modos de operação do reservatório. Todavia, em ambos os casos, a precisão da simulação é melhorada através do ajuste de histórico (ROSA; CARVALHO; XAVIER, 2006).
2.4.4	Extrapolação
Após o ajuste do modelo de simulação, a próxima etapa é a utilização deste para se prever o comportamento futuro do reservatório. Nesta previsão podem-se impor vazões para todos os poços ou para o campo como um todo ou impor as pressões de fluxo na “boca” dos poços, obtendo-se então as suas vazões de produção através do uso de um modelo de poço. Pode-se ainda impor a manutenção de uma vazão até que a pressão média do bloco de malha produtor caia abaixo de certo ponto, a partir do qual se dá início a um projeto de recuperação secundária (injeção de água ou gás). Ou seja, a extrapolação provê meios para o estudo de diversos esquemas de explotação, o que permite a decisão pelo esquema ótimo de produção, através de uma análise econômica dos resultados desses estudos (ROSA; CARVALHO; XAVIER, 2006).
Entretanto, mesmo após um ajuste de histórico satisfatório, é possível que o modelo de simulação não represente as condições reais do reservatório e, portanto, possível que as previsões fornecidas pela simulação nem sempre reflitam os dados do histórico. Isto se dá devido ao fato do comportamento do reservatório ser influenciado por diversos fatores, tais como: porosidade, espessuras, saturações, permeabilidades relativas, etc., cujos dados conhecidos (através dos métodos de aquisição) podem não ser representativos de todo o reservatório. Em geral, quanto mais longo o histórico utilizado no ajuste, mais acuradas serão as previsões (ROSA; CARVALHO; XAVIER, 2006).
3	MALHAS DE DISCRETIZAÇÃO
Thompson, Soni e Weatherill (1999) definem uma malha de discretização como sendo um conjunto de pontos distribuídos sobre um campo de cálculos, utilizado para a solução numérica de um conjunto de equações diferenciais parciais. Ainda segundo estes autores, este conjunto de pontos pode ser estruturado, por exemplo, formado pelas interseções de superfícies de coordenadas curvilíneas, ou desestruturado, isto é, sem relação com direções coordenadas. No primeiro caso, os pontos formam células quadriláteras em 2D, ou hexagonais em 3D. Já a malha desestruturada geralmente consiste de triângulos e tetraedros em 2D e 3D, respectivamente, na forma mais básica, mas em geral pode ser composta também por hexágonos ou elementos de forma qualquer.
As malhas estruturadas podem ser geradas algebricamente pela interpolação a partir de fronteiras, como a interpolação transfinita, por exemplo, ou através da solução de um conjunto de equações diferenciais parciais na região. Já a geração de malhas desestruturadas pode ser feita pelo mosaico de uma distribuição de pontos, que pode ser aleatória, mas é mais comumente produzida por algum procedimento ordenado (THOMPSON; SONI; WEATHERILL, 1999).
Segundo Ertekin et al. (2001 apud MACHADO, 2010), os dois tipos de malhas (grids) de diferenças finitas usados na simulação de reservatórios são o bloco-centrado (figura 3.1) e o ponto-distribuído (figura 3.2).
De acordo com Machado (2010), em uma malha bloco-centrado os blocos com dimensão conhecida são sobrepostos sobre o reservatório (todos os blocos estão no interior do reservatório). Para um sistema de coordenadas retangular, os pontos de malha são definidos como o centro destes blocos. Enquanto que para um sistema não retangular, os pontos de malha são definidos pelos baricentros dos blocos. Não há então, em uma malha bloco-centrado, pontos de malha nas fronteiras do reservatório.
Nas malhas de ponto-distribuído, de acordo com Aziz e Settari (1979), os primeiros e últimos pontos são definidos entre as fronteiras do reservatório. O resto dos pontos é distribuído uniformemente entre esses pontos da fronteira, de modo que o limite dos blocos fique na metade da distância que separa dois pontos adjacentes.

I	- 1		_ ...	i	“ “ ■? I
1	i	1
,,4			A		
i-’J 1	pj	1
1	.	i	i
1	1	1
o— —	ijl	
Figura 3.1 - Malha bloco-centrado (AZIZ, 1993 apud MACHADO, 2010).
Figura 3.2 - Malha ponto distribuído (AZIZ, 1993 apud MACHADO, 2010).
3.1	GEOMETRIAS DE MALHAS AREAIS
Malhas areais são utilizadas quando padrões de escoamento areais são predominantes no reservatório e quando heterogeneidades verticais não são significativamente influentes na descrição do escoamento dos fluidos, ou ainda no caso de reservatórios onde os efeitos gravitacionais são desprezíveis. As malhas areais podem ter as seguintes geometrias (MACHADO, 2010):
a)	Geometria cartesiana
Figura 3.3 - Exemplo de malha retangular (MACHADO, 2010).
b)	Geometria cilíndrica
A geometria cilíndrica é utilizada para estudos de simulação que envolvem um único poço. Dentre os objetivos de simular um único poço estão: predição do comportamento de poços individuais; determinação de efeitos de cones de água e gás; determinação de estratégias de completação/produção e otimização de intervalos canhoneados (figura 3.4).
Figura 3.4 - Exemplo de malha cilíndrica (MACHADO, 2010).
c)	Geometria corner-point
A malha corner-point permite a descrição do reservatório com um grande realismo geológico, sendo apropriada para descrição de reservatórios altamente falhados. No entanto apresenta o problema de ser não-ortogonal, gerando complicações para o operador de diferenças finitas, que só considera as componentes ortogonais dos gradientes do potencial. Portanto, apesar do realismo geológico, os resultados podem não ser muito acurados (figura 3.5).
Figura 3.5 - Exemplo de malha corner-point (MACHADO, 2010).
d)	Refinamento local e malhas híbridas
A utilização de malhas extremamente finas torna fácil a descrição das geometrias de reservatório mais complexas. Entretanto, o uso de tais malhas é impraticável para muitos casos devido ao alto custo computacional gerado. Como forma de resolver este problema foi criada a técnica de refinamento local, que consiste na utilização de uma malha secundária (mais fina) sobre uma malha primária (mais grossa). O refinamento é feito em regiões de maior interesse, sendo as demais regiões do modelo, de menor interesse, deixadas com o mínimo de células ativas, conforme ilustra a figura 3.6, onde a região mais escura é a de maior interesse; isto gera resultados próximos àqueles quando se utiliza uma malha-base fina, com significativa diminuição do custo computacional.
As regiões de interesse para o refinamento podem ser, segundo Chong (2004): regiões com grande variação de pressão próximo ao poço; regiões com grande variação de saturação e regiões com alta heterogeneidade.
Figura 3.6 - Exemplo de refinamento local (MACHADO, 2010).
Uma malha é dita híbrida quando, no refinamento local, utiliza-se uma malha secundária de geometria diferente da malha primária (figura 3.7). Estas malhas foram introduzidas por Pedrosa e Aziz (1986 apud MACHADO, 2010) e são geralmente utilizadas com o intuito de proverem-se melhores definições em áreas vizinhas a poços.
Figura 3.7 - Exemplo de malha híbrida (PALAGI; AZIZ, 1992).
e)	Malhas Voronoi e Delaunay
A malha Voronoi é uma das mais flexíveis e úteis malhas para a simulação de reservatório. Dado um ponto de malha, um bloco de malha Voronoi é definido como sendo a região do espaço que é mais próxima deste ponto de malha do que de qualquer outro. Cada bloco é associado a um ponto de malha e a uma série de blocos vizinhos. A malha Voronoi pode ser classificada como uma malha ponto-distribuído generalizada, devido ao fato de que um ponto da fronteira de dois blocos Voronoi é equidistante a dois pontos de malha.
A principal vantagem da malha Voronoi é que pontos de malha podem ser especificados em qualquer lugar do domínio independentemente da posição dos demais pontos. Outra vantagem apresentada pela malha Voronoi, segundo Machado (2010), é o fato de que as fronteiras da malha são ortogonais às linhas que conectam dois pontos adjacentes (por isto esta malha também é chamada malha PEBI -Perpendicular Bissector ou, em português, Bissetor Perpendicular), trazendo como vantagem o fato das faces serem perpendiculares ao fluxo; fato importante, pois os simuladores comerciais calculam os gradientes de potencial perpendiculares às faces dos blocos.
Ainda como vantagem, no processo de refinamento local, a malha Voronoi provê uma forma natural de conectar a malha fina com a malha-base grossa. Devido à gradual variação nas dimensões dos blocos de malha na região de transição entre as malhas fina e grossa, técnicas convencionais de refinamento local apresentam uma série de restrições em relação ao modo como a malha-base pode ser refinada; técnicas de refinamento utilizando malhas Voronoi não apresentam esta limitação (PALAGI; AZIZ, 1992).
De acordo com Palagi e Aziz (1992), muitas das mais comuns malhas utilizadas podem ser vistas como casos especiais ou pelo menos como aproximações bem próximas da malha Voronoi, tais como as malhas cartesiana e cilíndrica, entre outras. Quando a malha é formada apenas por triângulos, esta é chamada malha Delaunay (figura 3.8).
Figura 3.8 - Malhas Voronoi e Delaunay (PALAGI; AZIZ, 1992).
3.2	O EFEITO DE ORIENTAÇÃO DE MALHA
Em modelos multidimensionais, a dispersão numérica leva à ocorrência de um fenômeno onde os resultados calculados são influenciados pela orientação da malha, relativa às localizações dos poços injetores e produtores. Este fenômeno é um inconveniente dos esquemas tradicionais de diferenças finitas utilizando malha cartesiana (esquemas envolvendo diferenciação five-spot e single-point upstream weighting - ponderação de um ponto à frente - para a mobilidade), e é denominado de efeito de orientação de malha (CHONG, 2004).
Segundo Chong (2004), o problema pode ser ilustrado pelas figuras 3.9 e 3.10. A figura 3.9 representa uma parte da malha cartesiana de um modelo utilizado, por exemplo, para a simulação de injeção de água em um reservatório de óleo. Esta parte do modelo contém um poço produtor e dois poços injetores. No simulador, a água proveniente do poço A seguirá por um caminho reto até o poço produtor. Já a água proveniente do poço B mover-se-á por um caminho em ziguezague até o poço produtor. Além de o percurso de fluxo da água proveniente do poço B ser maior, esta “varrerá” o reservatório de forma mais eficiente do que aquela proveniente do poço A. Entretanto, se a malha for girada em 45°, conforme ilustra a figura 3.10, os resultados obtidos para os dois poços serão invertidos.
Figura 3.9 - Caminhos de fluxo para fluxos paralelo e diagonal (CHONG, 2004).
Figura 3.10 - Malhas paralela e diagonal (COATS, 1982).
Haja vista, o efeito de orientação de malha tornou-se um dos importantes fatores influenciadores no desenvolvimento de diferentes esquemas de diferenças finitas e diferentes tipos de malhas de discretização. A literatura referente às técnicas desenvolvidas ao longo dos anos a fim de obliterar-se o efeito de orientação de malha pode ser dividida em alguns grupos de autores (CHONG, 2004).
Conforme descrito por Chong (2004), estes grupos dividem-se da seguinte maneira:
O primeiro grupo apontou como a causa do efeito o uso da técnica de singlepoint upstream para a ponderação da mobilidade. Eles atribuíram a ocorrência da dispersão numérica causadora do efeito de orientação de malha à utilização desta técnica de ordem inferior. Eles então propuseram a utilização da técnica two-point upstream para a ponderação da mobilidade, no lugar da tradicional técnica single-point upstream. Eles conseguiram uma redução na dispersão numérica e a consequente redução no efeito de orientação de malha. Entretanto, baseando-se nos estudos de Vinsome e Au (1979), concluíram que para um caso com razão de mobilidade extremamente desfavorável, a formulação upstream prevê uma queda de pressão ao longo de uma frente de choque muito menor do que deveria ser e vice-versa, no caso de razão de mobilidade muito favorável.
O segundo grupo aprimorou o método de utilização de esquemas nine-spot de diferenças finitas, propostos inicialmente por Yanosik e McCracken (1976), através da introdução de um “fator de ponderação”, que assumia os valores quatro e um para as malhas cartesianas diagonal e paralela, respectivamente. Um esquema nine-spot, ilustrado na figura 3.11, consiste na adição de transmissibilidades diagonais em relação às direções X-Y, com o intuito de reduzir o efeito de orientação de malha quando o fluxo não está alinhado com a malha.
Y
				
	• \ y	♦	• X		 five-spot 	 nine-spot
	• -*—	klz b¡\	—► •	
	z •	1 •	•	»- y
				
Figura 3.11 - Esquemas nine-spot e five-spot (COATS, 1982).
Entretanto, Ko e Au (1979) concluíram que o esquema nine-spot proposto por Yanosik e McCraken (1976) não poderia solucionar o problema de orientação de malha para todas as razões de mobilidade, uma vez que o fator de ponderação utilizado no método é uma função da razão de mobilidade. Adicionalmente, segundo Amado (1990), embora contribuam efetivamente para reduzir o efeito de orientação de malha, os esquemas nine-spot tornam mais difíceis os tratamentos dos contornos e também das heterogeneidades, além do aumento do esforço computacional.
O terceiro grupo introduziu a utilização de esquemas de diferenças finitas de ordem superior, conhecidos como HOT (high-order techniques). Por exemplo, Chen et al. (1991), Pinto e Correa (1992) e Wolcott et al. (1996) propuseram o uso de esquemas de expansão de séries de Taylor de terceira ordem, conhecidos como métodos TVD (Total Variation Dimishing), sendo que Wolcott et al. (1996) utilizaram uma combinação dos esquemas nine-spot e TVD. Através da utilização das HOT, os autores conseguiram reduzir a dispersão numérica e produziram resultados mais acurados para as frontes de saturação.
O último grupo focou-se na utilização de malhas de geometrias diferentes. Um dos exemplos foi a introdução, no início da década de 1980, da geometria de malha triangular, que requer o uso de um sistema de malha de ponto-distribuído, e apresenta
uma geração mais complicada. A vantagem desta malha é que as fronteiras da malha não ficam alinhadas com uma direção em particular. Adicionalmente, Pruess e Bodvarsson (1993) propuseram o uso do esquema de diferenças finitas seven-spot, que consiste essencialmente de um modelo estruturado e uniforme de blocos de malha hexagonais. Eles investigaram alguns problemas de injeção de vapor com a utilização deste novo esquema e resultados satisfatórios no que tange à redução do efeito de orientação de malha foram obtidos, não obstante a utilização de malhas relativamente grossas.
A tendência atual é a da utilização das malhas desestruturadas, as quais apresentam como vantagem conexões muito flexíveis, que ajudam a reduzir a dispersão numérica. No entanto, a geração e construção deste tipo de malha não são simples, sendo necessária a utilização de métodos numéricos complexos para tal.
3.3	CONSTRUÇÃO NUMÉRICA DA MALHA
A escolha correta do tipo e forma da malha, sobre a qual serão discretizadas as equações diferenciais de escoamento, é de fundamental importância para tornar a simulação do escoamento de fluidos em reservatórios eficiente e precisa. No presente trabalho optou-se pela utilização da malha triangular em vez da tradicional malha cartesiana, apesar da maior complexidade para sua construção, devido à sua maior flexibilidade.
A geometria das malhas triangulares permite a construção de blocos de malha hexagonais, através dos quais é possível considerar-se um maior número de direções de escoamento, conseguindo-se assim uma configuração mais real, sem direções preferenciais de escoamento, o que permite reduzir significativamente os efeitos de orientação de malha, comuns nas malhas cartesianas (AMADO, 1990).
Além disso, a utilização da malha triangular tem como vantagem adicional o fato de modelar com maior flexibilidade, uniformizando-se com os contornos internos e externos, com a utilização de um número de células bem inferior ao empregado no caso de malhas cartesianas, situações com reservatórios de geometria irregular ou complexa, ou ainda, segundo Amado (1990), aqueles que porventura venham a exibir anisotropias internas, tais como falhas selantes, formações heterogêneas ou impermeáveis, canais com elevadas permeabilidades ou outras particularidades
geomorfológicas. A utilização da malha triangular fornece ainda uma facilidade para a realização de refinamento local, em qualquer região desejada (AMADO, 1990).
3.3.1	Método Numérico de Construção da Malha Triangular
A tarefa de gerar uma malha a fim de discretizar um domínio físico consiste na geração de um sistema de coordenadas no interior deste domínio. O sistema de coordenadas deve adaptar-se às fronteiras do domínio, isto é, deve possuir linhas coordenadas cobrindo todas as fronteiras deste, e sua distribuição no interior do domínio deve ser suave, com concentração em regiões com grande variação na solução (THOMPSON; WARSI; WAYNE, 1985).
O sistema de coordenadas (ou a malha de discretização) é gerado através da determinação dos valores das coordenadas no interior do domínio físico, a partir de valores especificados nas fronteiras desta região (problema de valor de fronteira). Para tal, uma das coordenadas é mantida constante em cada uma das fronteiras do domínio físico, enquanto a outra varia monotonicamente (caso contrário, o mesmo par de valores do sistema de coordenadas ocorrerá em pontos físicos distintos) à mesma taxa ao longo de cada fronteira (THOMPSON; WARSI; WAYNE, 1985).
Os procedimentos de geração de sistemas de coordenadas a partir de valores de fronteira são divididos em dois tipos gerais: construção por interpolação algébrica entre as fronteiras e solução numérica de equações diferenciais. Dentre os procedimentos algébricos estão, entre outros, normalização simples de fronteiras e interpolação transfinita (THOMPSON; WARSI; WAYNE, 1985). Quanto à solução numérica de equações diferenciais, as equações podem ser elípticas, parabólicas ou hiperbólicas; segundo Thompson, Warsi e Wayne (1985), se os pontos coordenados são especificados por toda a fronteira fechada do domínio físico, as equações devem ser elípticas, enquanto se forem especificados em apenas uma porção da fronteira, as equações serão parabólicas ou hiperbólicas.
Os métodos algébricos são os mais simples, no entanto, a resolução de sistemas de equações diferenciais gera soluções mais suaves e, portanto, este é o método mais utilizado (THOMPSON; SONI; WEATHERILL, 1999). Entretanto, a solução do sistema de equações diferenciais sobre um domínio pode tornar-se muito complexa dependendo da geometria deste. Para resolver tal problema é utilizado um procedimento de transformação de planos. Passando-se do plano físico para o
chamado plano transformado ou computacional, consegue-se, de acordo com Amado (1990), uma ordenação para as variáveis no sistema matricial e uma simplificação, através de uma retificação, para os contornos curvilíneos reais, facilitando o tratamento das condições de fronteira.
Domínios curvilíneos podem ser considerados, do ponto de vista computacional (programação), como sendo logicamente retangulares. Isto é, um domínio curvilíneo num plano físico pode ser transformado num domínio logicamente retangular no plano computacional (plano transformado), conforme ilustra a figura 3.12, onde o domínio físico em (a) é “cortado” e depois transformado no retângulo em (b). Vale ressaltar que, conceitualmente, não há diferença entre ambos, sendo necessário apenas o emprego pelo programador de um sistema de equações diferente em cada caso (THOMPSON; SONI; WEATHERILL, 1999).
Figura 3.12 - (a) Plano físico e (b) Plano Transformado
(THOMPSON; WARSI; WAYNE, 1985).
A resolução do sistema de equações diferenciais sobre o plano físico gera uma malha curvilínea sobre o domínio físico, enquanto que a resolução das equações sobre o plano transformado gera uma malha cartesiana. É óbvio que deve haver uma correspondência única entre os pontos de ambas as malhas, isto é, todo ponto no plano físico deve corresponder a um, e apenas um, ponto no plano transformado, e vice versa. O princípio extremum, que diz que soluções extremas não podem ocorrer no interior de um domínio, apresentado por alguns sistemas elípticos, serve como garantia de uma correspondência ponto a ponto entre as malhas dos planos físico e transformado (THOMPSON; WARSI; WAYNE, 1985).
Outra propriedade importante apresentada pelos sistemas elípticos, segundo Thompson, Warsi e Wayne (1985), é a suavidade inerente que prevalece na solução destes, devido à tendência de suavização dos operadores elípticos; esta tendência,
aliada ao princípio extremum, permite a geração de malhas para quaisquer configurações, sem a ocorrência de sobreposição de linhas de malha. Além disso, as descontinuidades de inclinação nas fronteiras não são propagadas para o interior do domínio (THOMPSON; WARSI; WAYNE, 1985).
Há, portanto, uma série de vantagens na utilização de sistemas de equações diferenciais parciais elípticas para a geração de malhas. O mais simples sistema elíptico, e um que apresenta uma considerável suavização nas soluções é o sistema de equações de Laplace (THOMPSON; WARSI; WAYNE, 1985).
3.3.1.1	Formulações matemática e numérica
A formulação utilizada neste trabalho baseia-se na solução numérica de um sistema elíptico quase-linear em um plano transformado retangular, conforme descrito por Amando (1990). Os pontos de malha são tomados como as soluções deste sistema de equações diferenciais parciais (equações transformadas de Laplace), utilizando-se valores coordenados especificados nas fronteiras do domínio físico.
O algoritmo de geração utilizado permite: a geração de uma malha triangular que ajuste-se com flexibilidade aos contornos internos e externos do reservatório; o refinamento local em qualquer região desejada; e a geração parcial da malha, para o caso de reservatórios muito complexos ou que apresentem múltiplas regiões.
Considere, por exemplo, uma malha curvilínea conforme ilustrado na figura 3.12a. Esta malha pode ser diagramada logicamente conforme a figura 3.12b.
Figura 3.13 - (a) Plano físico e (b) Plano Transformado (AMADO, 1990).
A geração da malha curvilínea em 3.13a é obtida pela resolução do sistema de equações de Laplace,
V	2n = 0
V	2t = 0
(3.1)
no plano físico, atribuíndo-se valores arbitrários de n e t nas fronteiras do domínio físico, sendo n e t as variáveis dependentes, isto é, n = n ( x, y) e t = t ( x, y). As soluções do sistema (3.1) fornecem as coordenadas (n ,t) dos pontos de malha da malha curvilínea.
Entretanto, a solução do sistema de equações (3.1) pode tornar-se muito complexa dependendo da geometria do domínio físico. Como simplificação, pode-se resolver um novo sistema no plano transformado, efetuando-se primeiro um procedimento de inversão de variáveis. Assim, invertendo e escrevendo as equações em termos de x(n,t) e y (n,t), obtém-se:
Zx
1	1 g
- n e nx = J ty
1
1
t, =~n, e ny =—Áy
(3.2)
J
J
Onde o jacobiano J é dado por: J = xn	- x. yn.
Com estas relações, o sistema (3.1) transforma-se no chamado sistema de
equações de Laplace inversas, dado por:
ax - 'l/hx.. + Yxnn = 0
(3.3)
ay -	0
Onde os termos a, J3 e '/ são chamados de funções quadráticas e são definidos
como:
2 2
a = Xn + y,
vn+ y y^
2 2
Y=	+ y¡	(3.4)
As soluções do sistema (3.3) fornecem as coordenadas (x, y) dos pontos de malha da malha cartesiana, sendo as coordenadas (x, y) nas fronteiras as condições de contorno do problema.
Para a solução do sistema (3.3) é primeiramente necessária uma discretização por diferenças finitas dos termos correspondentes às derivadas primeira e segunda, isto é, x,	, xnn e y , e ynn. Através do método da linha integral, utilizando-
se teorema de Gauss, as expressões de diferenças finitas para essas derivadas podem ser obtidas. Consegue-se, assim, uma aproximação para as derivadas em um ponto de malha qualquer em função dos pontos de malha vizinhos.
Os triângulos no plano transformado são formados a partir das diagonais dos quadriláteros da malha cartesiana. Para obter estes triângulos, atribuem-se, no plano transformado, valores para e n em incrementos unitários em linhas adjacentes, e que variam linearmente com a posição no espaço	conforme ilustrado na figura
3.14.
Figura 3.14 - Malha triangular no plano transformado (AMADO, 1990).
As expressões de diferenças finitas para as derivadas, considerando-se a configuração triangular da figura 3.14, são dadas por:
= 6 [(x2 + 2xi + x6 )-(x3 + 2x4 + x5 )]
xn = 1 [(xi + 2x6 + x5 )- (x2 + 2x3 + x4 )] 6
&amp;lt;x = x1 + 2 x + x 4
= 1 [(xi+ x6 + x3 + x4 )-(x2 + x5 + 2x)]
= x6 - 2x + x3
(3.5)
xnn

As derivadas da coordenada y são definidas de maneira análoga. Os valores calculados para x e y fornecem as coordenadas do ponto de malha localizado no bloco em questão, e x1,..., x6 e y1,..., y6 determinam as coordenadas dos pontos de malha vizinhos.
Substituindo-se o conjunto de equações (3.5) no sistema de equações de Laplace inversas (3.3), obtém-se o seguinte conjunto de equações:
2 c i (xi - x ) = 0 i=1
6
2 ci(yi- y )=0 j=1
(3.6)
Onde c1 = c4 = a- [, c2 = c5 = [ e c3 = c6 = Y - [3.
Explicitando-se os valores de x e
y no sistema de equações acima, obtém-
se:

&lt;
2 cixi
1	___
2	c
1
2 w
y=~l2~
2	ci
i
x =
(3.7)
v
O sistema (3.7) é resolvido utilizando-se o processo iterativo de Gauss -Seidel, seguindo-se as seguintes etapas:
•	É considerada uma estimativa inicial para as coordenadas x e y de todos os pontos da malha triangular, sendo as coordenadas dos pontos interiores consideradas inicialmente nulas;
•	Os termos c são então calculados para cada ponto de malha, a partir dos valores iniciais das coordenadas dos pontos vizinhos;
•	Calculam-se os novos valores de x e y para cada um dos pontos de malha, com os valores de ci e as equações (3.7);
•	Comparam-se os valores novos com os anteriores;
•	Repete-se o processo até obter-se convergência.
4	FORMULAÇÃO INTEGRAL DAS EQUAÇÕES DE FLUXO
As equações integrais de fluxo que formam o modelo matemático Black-Oil bifásico óleo/água são obtidas através de um balanço material, combinado com a lei de Darcy, que rege o fluxo de fluidos em meios porosos.
Neste capítulo primeiramente são descritas as leis de conservação de massa e de Darcy, de acordo com Oliveira (2009). Em seguida, é descrita a formulação integral das equações de fluxo, segundo Amado (1990).
4.1	LEI DA CONSERVAÇÃO DE MASSA
A lei da conservação de massa estabelece o balanço de massa para um determinado fluido em um elemento de controle, conforme ilustrado na figura 4.1, cujo volume assume-se não variar com o tempo. O balanço de massa estabelece, admitindo-se que não haja transferência de massa entre os fluidos envolvidos, que o fluxo líquido de massa que atravessa as fronteiras do volume de controle deve ser igual à taxa de acumulo de massa mais a vazão mássica produzida ou injetada no interior deste volume, para cada um dos fluidos.
Figura 4.1 - Elemento de controle (OLIVEIRA, 2009).
Admitindo-se que o fluxo de massa entra ou sai do elemento, através de suas faces, paralelamente aos eixos do sistema cartesiano, pode-se escrever a seguinte expressão para o balanço de massa da fase p (a para água ou o para óleo):
Onde me é a massa que entra e ms é a massa que sai do elemento através de suas faces, mf /s é massa que entra ou sai do elemento através de uma fonte ou de um sumidouro (poço injetor ou produtor, respectivamente) e ma é a massa acumulada no elemento durante um intervalo de tempo At.
O termo de massa devido à fonte ou ao sumidouro é chamado de termo de poço, enquanto o termo de massa acumulada é chamado de termo de acumulação.
Os termos de massa que entra e sai podem ser escritos em relação ao ponto central do elemento de controle, de coordenadas (x, y , z), da seguinte forma:
(me) p =
(ms) p =
(mpxAx )x_AX + (mpyAy )y_Ay + (mpZAz )z_ Az
2 2 2
At
(4.2)
(m pxAx )x +Ax +(m pyAy )y + Ay + (m pzAz )z + Az
2 2 2
At
(4.3)
Com Ax, Ay e Az representando
as áreas das faces do elemento segundo as
direções x, y , z respectivamente, e (mpx) ±Ax
x± 2
representando o fluxo de massa
(massa que flui por unidade de tempo, por unidade de área) da fase p que entra ou
. Ax sai do elemento pela face x ± —
2
podendo ser definido como:
m = p u
px	p px
(4.4)
Sendo pp a massa específica da fase p e upx a velocidade superficial ou de Darcy. Os fluxos de massa segundo as direções y e z são definidos analogamente.
Definindo Qmp como sendo a vazão mássica da fase p que entra ou sai no elemento devido a um poço (injetor ou produtor) localizado no seu interior, tem-se:
(m,, ) = Q At
\ f / s /p	x-smp
(4.5)
Será adotado como convenção que para uma fonte Qmp &amp;lt;0 e para um sumidouro Qmp &gt; 0.
Escrevendo a vazão mássica Qmp em termos da vazão volumétrica da fase p , Qp, tem-se:
Qmp =PpQp	(4.6)
O termo de acumulação representa a variação da massa acumulada entre os tempos t e t + At, sendo definido como:
(ma)p =(mvp)t+At -(mVp)t	(4-7)
Onde mvp = S pfppV é a massa da fase p contida no elemento de controle, V = AxAyAz é o volume do elemento (volume de controle), f é a porosidade do elemento e Sp é a saturação da fase p . Assim:
(ma) p = (spfPp AxAyAz) t+At - (spfPp AxAyAz)t	(4-8)
Substituindo-se as equações (4.2), (4.3), (4.5) e (4.8) na equação (4.1), rearranjando-se os termos e dividindo-se o resultado por V e At , tem-se finalmente:
(m px ), A -(m px )xx
______2________2_
Ax
(mpy )y '■ - (mpy )y-Ay
______ 2__________ 2
Ay
+
(m pz ) .A -(m pz ) -A£
_______2________2_
Az
(SpfPp)'+A -(SpfPp)' ■
At
+ ppqp
(4.9)
Qp
Onde qp = —- é a vazão volumétrica por unidade de volume. p V
Na equação (4.9), aplicando-se o limite em ambos os lados, com Ax, Ay, Az e At tendendo a zero, e a definição de derivada, e substituindo-se os termos de fluxo mássico pela equação (4.4), deduzida para cada direção, tem-se:
- dx pudy ^ppupy) dz (pp^pz)=dt	)+ppqp	(4-10)
ou
d
-Vpup )=dt (Spfr&gt;p )+Pp9p	(4-11)
As equações (4.10) e (4.11) representam a forma final do balanço material para a fase p , admitindo-se um sistema de eixos cartesiano. No entanto, de acordo com as características do problema que se deseja resolver, podem-se escrever, por conveniência, as equações (4.10) e (4.11) em relação a outros sistemas de eixos.
4.2	LEI DE DARCY
A lei de Darcy é uma expressão empírica que descreve o fluxo de fluidos através de um meio poroso.
Para um fluxo multidimensional, bifásico óleo/água, admitindo-se um sistema de coordenadas cartesianas, a lei de Darcy é definida da seguinte forma:
krp „
up =-K —V0p, p = o,a	(4.12)
V
Onde:
up = vetor de velocidade superficial ou de Darcy;
flp = viscosidade da fase p ;
krp = permeabilidade relativa à fase p, que representa a facilidade com que a fase p escoa pelo meio poroso, quando este está saturado por mais de uma fase;
V0 p = gradiente do potencial de fluxo, definido como:
V*p = VP -PpgVD
(4.13)
Com g sendo a aceleração da gravidade, pp a massa específica da fase p, D a profundidade, calculada em relação a um ponto de referência, e Pp a pressão da fase p à profundidade D ;
K = tensor de permeabilidades absolutas, que contém os valores de permeabilidade absoluta segundo as direções x, y e z, definido por:
K =
kyx
kxy
ky
kzy
kyz kz
(4.14)

É comum admitir-se em simulação de reservatórios que as direções preferenciais de fluxo coincidam com as direções principais do tensor de permeabilidades absolutas, podendo este, portanto, ser substituído por um tensor diagonal representado por:
kx
ky
kz
(4.15)
A permeabilidade absoluta (k) do meio poroso representa uma medida da facilidade apresentada por este para um fluido escoar através de seus poros. Para um meio isotrópico kx = ky = kz = k , e:
K = k
(4.16)
4.3	EQUAÇÕES DE FLUXO
- JV	Up	= JV dt	^dV + V (Pq	’ P = °a (4'17)
A integral de volume do fluxo de massa no lado esquerdo da equação (4.17) pode ser transformada em uma integral de superfície, aplicando-se o teorema da divergência. Assim, esta equação torna-se:
- JAPp (up ndA = JV I”(SpP )dV + JV (Pp^p dV	(4.18)
Onde A é a área da superfície de contorno do volume de controle V e n é o vetor normal a essa superfície.
Substituindo-se a equação (4.12) na equação (4.18), obtém-se:
k	d
JaKP -¡T(V*p-ndA = LddV + JvP d
(4.19)
É comum na engenharia de reservatórios expressar os volumes em condições standard (padronizadas ou de superfície). Para fazê-lo na equação (4.19), dividem-se todos os termos da equação por pp = pSC (massa específica nas condições
standard) e aplica-se a definição do fator volume de formação,
Bp
Pp , ps.c. ’
obtendo-se, assim, a seguinte equação:
m i s
IaK^p(v*p n)dA = Jvm ■B-
k Bp
i A dV + C dV
JV B
k p J
(4.20)
( e A
p J
Onde Â,p
krp
ÍpBp
é a mobilidade da fase p .
A equação (4.20) representa o modelo matemático Black-Oil e será resolvida neste trabalho, considerando-se um conjunto de condições inicial e de contorno,
através de um modelo numérico que utiliza discretização por diferenças finitas em uma malha triangular, em um sistema bidimensional-bifásico óleo/água.
5	MODELO NUMÉRICO
Após a geração da malha triangular, conforme a ilustrada na figura 5.1, por exemplo, cada ponto dessa malha deve ser associado a um bloco de malha, sobre o qual as equações de fluxo são discretizadas e posteriormente resolvidas.
Figura 5.1 - Exemplo de malha triangular (AMADO, 1990).
Diferentes métodos podem ser utilizados para construir as fronteiras dos blocos de malha, cada um resultando em diferentes expressões para o cálculo dos coeficientes de fluxo (transmissibilidades) entre os blocos. Dentre os métodos, os dois principais são relacionados com cevianas do triângulo, e são os métodos das mediatrizes e das medianas (AMADO, 1990).
5.1.1	Método das Mediatrizes
O método das mediatrizes ou PEBI (Perpendicular Bissector) é o método de construção no qual os contornos dos blocos de malha são as mediatrizes dos lados dos triângulos da malha triangular. Os circuncentros dos triângulos, isto é, os encontros de suas mediatrizes, formam os vértices dos blocos. Assim, criam-se blocos hexagonais centrados em pontos de malha, e cujas arestas são ortogonais às linhas de malha, formando assim uma linha de escoamento para cada uma das seis arestas do bloco, conforme a figura 5.2 (AMADO, 1990).
Figura 5.2 - Método das mediatrizes (AMADO, 1990).
5.1.2	Método das Medianas
No método das medianas, os contornos dos blocos de malha são formados pelas linhas que unem os baricentros e os pontos médios dos lados dos triângulos da malha triangular, sendo os baricentros os vértices dos blocos, conforme a figura 5.3 (AMADO, 1990).
Figura 5.3 - Método das medianas (AMADO, 1990).
O método das medianas é mais adequado para reservatórios com grandes anisotropias internas porque, segundo Amado e Pedrosa (1994), permite a consideração de todos os parâmetro anisotrópicos como sendo um tensor aplicado
nos baricentros dos triângulos e como uma parte dos termos de transmissibilidade. No entanto, a difícil construção dos blocos por este método pode tornar-se um empecilho.
Neste trabalho optou-se pelo método das mediatrizes como forma de construção dos blocos de malha.
5.2	DISCRETIZAÇÃO DAS EQUAÇÕES DE FLUXO SEGUNDO O MÉTODO DAS MEDIATRIZES
Com os blocos de malha hexagonais construídos pelo método das mediatrizes, o próximo passo é a obtenção da forma numérica da equação integral de fluxo, através da discretização da equação (4.20).
O procedimento de discretização pelo método das diferenças finitas é descrito a seguir, segundo Amado (1990).
5.2.1	Discretização do Termo de Fluxo
A vazão mássica através das faces de um determinado bloco i pode ser
expressa como:
6
Z QPi . , P = o,a j=1	"
(5.1)
Onde j = 1,2,... , 6 representa os pontos de malha vizinhos ao ponto de malha i
Q
considerado, e
representa a vazão mássica da fase p através da interface i, j
dos blocos de malha associados aos pontos de malha i e j, sendo definida, de
acordo com a equação (4.20), por:
QPij = Ia KÀP(v0p*)A
’J i,j
(5.2)
A discretização da equação (5.2) é realizada em dois passos de integração. Integra-se primeiramente a equação ao longo da interface i, j , através da regra de quadratura Gaussiana de um ponto, resultando em:
	
	K p
pl,j	ds Jl. j _
(5.3)
Onde
ds
= V0p.n, sendo 5 a variável espacial ao longo da linha i - j, li ., e
Ap. .
ri. j
i,j
a mobilidade interfacial da fase p .
d0 p
Q
O segundo passo de integração consiste em integrar-se a equação (5.3) ao longo de I. j, resultando em:
Qp.
l j
i,j
p
í.j—ds
il K
(5.4)
Ou ainda:
Qp. = T A0
i	i	i
ij
i,j
ij
(5.5)
Onde Tp
pi
é a transmissibilidade da fase p através da interface i, j do bloco i, e é
expressa por:
=fsp,.,
(5.6)
Onde fg é o fator geométrico de transmissibilidades. Para cada método de bloco triangularização, uma expressão diferente para o fator geométrico é conseguida. No caso do método das mediatrizes ele é expresso por:
(5.7)
Onde a. . é o tamanho da linha de malha interligando os pontos de malha i e j .
Contudo, a discretização do termo de fluxo pode ser finalmente expressa por:
Pi, j
2 A..J
1 11 K KJ JJ
A* p .
ri, J
(5.8)
Qp	p

5.2.2	Discretização do Termo de Acumulação
Para a discretização do termo de acumulação faz-se necessária a aproximação da derivada temporal. Esta aproximação é realizada por diferenças finitas em atraso, nos passos de tempo n e n +1, da seguinte forma:
dt
( Sp 1	1	17 s 1		n+1	( s 1n 1	
0			0—	—	0—	
B	At		B		B	
k p)			k p)	i	k p)	i
p = o ,a
(5.9)
d
Com a substituição da aproximação acima na integral de volume correspondente ao termo de acumulação da equação (4.20), a integração sobre o volume V., do bloco i, resulta em:
JV dt
d ( Sp I	V.
0^- dV = V-At
l BP)	At
Vi
At
( S 1
0SL
l Bp l
(5.10)
5.2.3	Equação de Fluxo Discretizada
Como último passo para obtenção da equação de fluxo discretizada, deve-se integrar sobre o volume de controle V a parcela correspondente ao termo fonte na equação (4.20), resultando em:

Vii Br ]dV	)
k p)
I , p = o ,a
i ' s.c.
(5.11)
Onde (Qp ) representa a vazão volumétrica da fase p , produzida ou injetada no
x ” i ' s.c.
bloco de malha i, em condições de superfície.
A substituição das expressões discretizadas e integradas, relativas às parcelas de fluxo, acumulação e fonte, na equação (4.20), resulta na equação representativa do modelo numérico correspondente ao modelo matemático proposto. Esta equação é, então, expressa por:
6
E Tp A0 „
¿-1 pi ,j	pi, j
j=1
i, j
V. (
= V- At 0
At
k Bp Ji
+ (Qp ) , p = o,a e i = 1,2,...,N (5.12) r i s.c.
V
Onde N é o número total de blocos da malha.
5.3	SOLUÇÃO DO MODELO NUMÉRICO
O modelo numérico representado pela equação (5.12) representa um sistema bidimensional, discretizado por uma malha triangular, com escoamento bifásico óleo/água, representado matematicamente pelo modelo Black-Oil.
Para solução do modelo devem ser consideradas condições de contorno e inicial. A imposição da condição inicial consiste na definição das variáveis dependentes do tempo (pressão e saturação) em cada bloco de malha, para o tempo inicial. As condições de contorno devem ser definidas para os contornos interno, que são os poços, e externo, que são as fronteiras físicas do domínio de fluxo. Os tipos de condição a serem impostas podem ser (MACHADO, 2010):
a)	Especificação da pressão no contorno (problema de Dirichlet)
i)	Contorno interno: poços produzindo (ou injetando) a uma pressão constante em frente aos canhoneados;
ii)	Contorno externo: pressão constante no limite do reservatório (regime permanente).
b)	Especificação do gradiente de pressão no contorno (problema de Neumann)
i)	Contorno interno: poços produzindo com gradiente de pressão específico, isto é, com vazão total constante, até atingirem uma pressão de fluxo no poço mínima;
ii)	Contorno externo: regime permanente, ou reservatório com limites selados (regime pseudo-permanente).
Além das condições de contorno e inicial, podem ser consideradas condições simplificadoras. No presente trabalho serão considerados efeitos gravitacionais e capilares desprezíveis, e reservatório isotrópico e incompressível. Assim:
•	Pcoa = Po _ Pa = 0 (sem pressão capilar);
•	0o = 0a = Po = Pa = P (efeitos gravitacionais desprezíveis);
•	K = k (reservatório isotrópico);
•	Cf = 0 (reservatório incompressível).
E como relação adicional, tem-se:
So + Sa = 1
(5.13)
Com as simplificações supracitadas e a relação (5.13), a equação (5.12) pode ser expandida como:
Para a fase óleo:
Y To¡] (P] - Pi)--^,.4':l „-'1' +Q)
j-1 ■'
Para a fase água:
Bo	Ji
J , i = 1,2,...,N
i s.c.
(5.14)
6	.	, — r -
Y Ta (P, - P ) = — (bkt-^ y, ay ] i&gt; Ari	b
]-1	L a _h
+ Qat )s.c., i = 1,2,..., N
(5.15)
As propriedades P.V.T. dos fluidos e as curvas de permeabilidade relativa para o sistema óleo/água são funções das variáveis pressão e saturação. Essas relações funcionais são obtidas através de tabelas de análise experimental (AMADO, 1990).
Nota-se pelas equações (5.14) e (5.15), que para cada bloco da malha surgem duas incógnitas e duas equações não lineares. A solução do sistema de equações não lineares formado, fornece os valores de P e Sa para cada bloco de malha, em cada time step At.
5.3.1	Resolução Pela Formulação SS Implícita
O sistema de equações representado por (5.14) e (5.15) são altamente não lineares, sendo assim necessário para sua resolução o emprego de um método numérico de linearização.
A formulação totalmente implícita se baseia no cálculo dos resíduos para cada uma das fases e na minimização deste resíduo através do método iterativo de Newton (MACHADO, 2010).
Expressando-se os termos das equações (5.14) e (5.15) no passo de tempo n +1, pode-se escrevê-las na forma de resíduos, que devem se anular para cada intervalo de tempo, do seguinte modo (AMADO, 1990):
Para a fase óleo:
Rn+1 oi
= E T"' (p - P)
j=iL
n+1
V.
—ò.
'
At
r 1-Sa
Bo 7
xn+1
-Q.) n+=o
6
(1 - Sa 1n
l Bo
7
i
(5.16)
Para a fase água:
R
, in+1
a
&amp;lt;Ba 7
r s
r s
ai
n+1
V
¡ ò. à . Tl At
-(Qa: )nc = 0 (5.17)
' 1n a
&amp;lt;Ba 7
- i
As funções resíduo R'(&gt;' e R^1 podem ser determinadas através de uma
expansão em série de Taylor ao redor de V, da seguinte forma (AMADO, 1990):
R -	Rv + y
pi p VX l
dRP, Y
dX J
ÕX v+1 = 0, p = o, a
(5.18)
Ou ainda:
y
VX
dX
A v
ÕXv+1
7
= - Rv
Pi
(5.19)
Onde ÕXv+1 = Xv+1 - Xv, com X representando as incógnitas P e Sa no bloco i e nos vizinhos j.
Expandindo-se (5.19), temos:
Para a função resíduo do óleo:
- R v
oi
f dRot Y
l dP J
õpv+1 +
\v
"Ro
V dSa, 7
S+1 +
ai
y
Vj
Õpj+1 +
z
v dSaj
ÕSv+1
aj
f dR
l dPj 7
V
7
(5.20)
Para a função resíduo da água:
- Rv
ai
f dRat Y
l dP J
ÕPv+1 +
dRa Y
V dSai 7
s+1+y
a
ai	Vj
ÕPj+1 +
' '&gt;R.
dSaj 7
S+1
aj
V
V
l dPj 7
(5.21)
A equação (5.19) pode ser escrita na forma matricial como (AMADO, 1990):
J VÕX' =- Rv
(5.22)
Onde (MALISKA et al., 1993):
õXv+1 = [õXv+1	...	õxN ]T
T (pv+1 - p) ’
í	\
S- S v __V a1	a17_
-iT
-	(pv+1 - pv) ~
V N p N )
7	\
Sv+1 - Sv
_V aN aN Jj_
- RV
-~v
- R
— V
- Rn
	r- RV ’ Oi		r- RV ’ oN	
	- RV		- RV	
	1 1		1 	1	
E J é denominada matriz Jacobiano, representada por:
JV
J ii
jV
Ji N
f dRoi Y
V	dpi)
f Ri Y
V	dpi J
f 'R
V	dSai Y f dRai Y
V	dSai J
Y
dRoi Y
ÍPN J dRg, Y dPN J
Y
VdSaN ) ' dRa1
dSa
V aN J
Y
J V
jV
J Ni
J V
J NN
Y
f ^Ro
oN
dPi
V	i J f dRa Y
aN
dPi
V	i J
f dR
. Y
oN
dSa
V	ai J
R Y
dSa
V	ai J
Com N igual ao número de blocos da malha.
(dRo Y
oN dPN
V	N J f dRa Y
aN dPN
V	N J
Y
dRo
oN
dSa
V	aN J
R
__aN
dS
V
Y
aN J
As derivadas das funções resíduos em relação às variáveis saturação são dadas por (AMADO, 1990):
pressão e
Derivadas em relação à pressão:
dRp	dTp. ,
—— = —(p - P )+ T
d/&gt;	dP {Pj	Ppj ’
Pi
p = o, a
(5.23)
dRp	r dT,
pi = dp Zj
Pi
Pi, j
vj L
dP (p -Pi)-YT
— Pi ,j Vj
i, j
VÁ
At

SPt dBPt '
B2 dP
V	Pi	J
dfepi 1c.
dP
(5.24)
A derivada da transmissibilidade, para w = i, j, é dada por:
Para a fase óleo:
dTo
‘, j
dPw
i j
f k
g roa
PB )2
b
dP	o
k dPw
.',B
dPw
Po
J . . -Ji, j
(5.25)
Para a fase água:
dTa. ,
ai, j
dP
w
f k
J g rao
(PaBa )2 k dP
dPw
Pa
J . .
~¡h j
(5.26)
w
Derivadas em relação à saturação:
dRp	(p - p)
dSa V j 1 ’
dSaj
p = o, a
(5.27)
Ví0í	1
At	Bp k	pi J
d(õpi
dSa
(5.28)
A derivada da transmissibilidade, para w = i, j, é dada por:
Para a fase óleo:
dr0 ,
j, j =
dSa
aw
fg	dkroa
poBo dSaw
w -ii, j
(5.29)
Para a fase água:
dTa. .
dSa aw
fg	dkrao
PaBa dSaw
w -ii, J
(5.30)
Para o cálculo das transmissibilidades e suas respectivas derivadas que ocorrem na interface i, j, faz-se necessária a utilização de um método de ponderação (AMADO, 1990). No presente trabalho optou-se pelo método mais simples e largamente utilizado em simulação numérica de reservatório, embora propenso a
dRp.	j'"
dSa, ’ j _
P - Pi) dSa V j J
dispersão numérica (CHONG, 2004), denominado single-point upstream weighting ou ponderação de um ponto à frente.
A ponderação de um ponto à frente é definida por (AZIZ; SETTARI, 1979):
Gt, se o fluxo for de i para j
Gj, se o fluxo for de j para i
G =
j
Onde G é uma propriedade qualquer.
Isto é, se o sentido do escoamento for do ponto i para o ponto j, as propriedades na interface i, j são avaliadas em i; em caso contrário, são avaliadas em j .
Para efeitos gravitacionais e capilares desprezíveis, a direção do escoamento é dada por (AZIZ; SETTARI, 1979):
Fluxo de i para j, se AP = (Pj - Pi )&amp;lt;0
Fluxo de j para i, se AP = (Pj - P.) &gt; 0
Assim, segundo Amado (1990), dependendo do sentido do escoamento, algumas das derivadas dos termos de transmissibilidades se anularão, caso se derive uma função em relação a uma variável atuante no ponto j e se avalie a função em i , por exemplo.
O processo iterativo de solução é realizado da seguinte maneira (AMADO, 1990):
• Como primeiro passo, devem ser determinadas as condições iniciais para as variáveis pressão e saturação. Uma boa estimativa inicial é considerar os valores de pressão e saturação iniciais do reservatório em todos os blocos da malha, isto é, P0 = PR	e = Sa ;
R inicial	a	Lí inicial
• Em seguida calcula-se a matriz Jacobiano J0 e a matriz de resíduos
- R0;
• Resolvendo-se o sistema (5.22), obtém-se a matriz SX1;
•	Calculam-se, então, os valores da pressão e da saturação no próximo passo de iteração, por X1 = X0 + òX1;
•	Repete-se o processo iterativo até que |òX&amp;lt;tolerância especificada e 1 &amp;lt;tolerância especificada.
Um dos fatores influenciadores da estabilidade da solução é o controle do tamanho do time step. O controle correto do time step assegura não só uma maior estabilidade da solução, mas também a redução dos erros de truncamento no tempo. Estas duas condições estão relacionadas com a taxa de variação das variáveis pressão e saturação; quanto maior a taxa de variação, menor é o time step que deve ser utilizado (AZIZ; SETTARI, 1979).
Um procedimento de controle do time step consiste na redução do tamanho deste, sempre que a variação nas variáveis pressão e saturação, em algum bloco de malha, ultrapassar um valor máximo pré-estabelecido, de um passo de iteração para outro (CHONG, 2004). Os cálculos realizados com o time step inadequado são descartados e refeitos com um novo time step, reduzido proporcionalmente ao quanto foi ultrapassado da tolerância especificada para a pressão e/ou a saturação (MALISKA et al., 1993).
Em geral, segundo Machado (2010), especifica-se um valor máximo de time step de 31 dias e um valor mínimo de 0,001 do dia. O simulador começa calculando com o valor máximo e vai refinando até o mínimo, sempre que as tolerâncias de variação da pressão e/ou saturação forem ultrapassadas (geralmente 4% e 150 psi, respectivamente).
5.4	MODELO DE POÇO
A pressão média calculada através da simulação para os blocos produtores não são iguais às pressões de fluxo na “boca” destes poços, devido, em geral, ao fato das dimensões dos blocos de malha serem significativamente superiores aos diâmetros dos poços (PALAGI; AZIZ, 1992).
Os termos de poço, isto é, os termos fonte presentes na equação de balanço material são proporcionais à diferença entre as pressões do bloco produtor e do poço produtor; o coeficiente de proporcionalidade é conhecido como índice de produtividade
(IP). A parte de natureza geométrica do IP é o chamado índice de poço, ou well index (WI), e o modelo utilizado para determinar o índice de poço é conhecido como modelo de poço. Ou seja, o modelo de poço permite que a interação entre o poço produtor e o reservatório seja determinada de forma acurada e, consequentemente, que as pressões do bloco produtor e do poço produtor sejam relacionadas (PALAGI; AZIZ, 1992).
A relação entre o termo fonte e a diferença entre as pressões do bloco produtor e do poço produtor, para um meio isotrópico, é dada por (PALAGI; AZIZ, 1992):
( k
krp
VPPBP J
Qp )	= WI
p &gt;S.C.	1
(Pp - Pwf ). , P = 0 ,a
i
(5.31)
E assim:
'VpBP'
k
V krP Ji
Pwfi = PP.
¡'QP: ^.C.
wi.
(5.32)
Onde Pf é a pressão de fluxo na “boca” do poço produtor.
O índice de poço, WI, é dado por (PALAGI; AZIZ, 1992):
(5.33)
Onde 0 é o ângulo aberto ao fluxo no poço produtor, rw é o raio do poço produtor, 5 é o fator de película, h é a espessura do bloco produtor e ro é o raio equivalente do bloco produtor, definido como o ponto no qual a pressão do bloco produtor, fornecida pelo simulador, se iguala à pressão dada pela distribuição radial em regime permanente.
Uma expressão que relacione ro com a geometria dos blocos de malha e a localização do poço é chamada modelo de poço (PALAGI; AZIZ, 1992). Para blocos
de malha hexagonais, com poços localizados no seu centro, Amado (1990) propôs um modelo de poço, definido por:
6 ’
E j=i 
\ = exp&lt;
ln As. .
As,„
6	l. .
. j
A'
- 2n
(5.34)

i j
i j

V
Onde |/i j é o comprimento da interface i, j entre os blocos i e j, e Asi j é o comprimento da linha de malha compreendida entre os pontos de malha i e j ,
conforme a figura 5.4.
l
Para malha regular e uniforme, tem-se que
li j
Asi j
Vã w.
As	3
Assim, tem-se que (AMADO, 1990):
(ro). = 0,163 As
(5.35)
Figura 5.4 - Bloco hexagonal (AMADO, 1990).
6	APLICAÇÕES DA SIMULAÇÃO DE RESERVATÓRIOS
Conforme discutido nos capítulos anteriores, a simulação numérica de reservatórios pode ser utilizada para diversos fins. Neste capítulo serão exemplificadas algumas das mais importantes utilizações da simulação de reservatórios (pressões no bloco e poço produtores, saturações de água e óleo no bloco produtor e mapas de saturação), através da simulação de um problema típico da engenharia de reservatórios, elaborado a partir de Fanchi (2006), com o simulador gratuito BOAST98.
Considere um reservatório homogêneo, isotrópico e incompressível, de geometria quadrada, com fronteiras seladas, sob um esquema de produção five-spot, produzindo a uma vazão constante de 18 STB/dia. A vazão de injeção de água de cada um dos quatro poços injetores é constante, sendo de 20 SCF/dia nos primeiros 200 dias e de 12 SCF/dia nos demais dias. O escoamento é bidimensional-bifásico óleo/água (reservatório subsaturado), com efeitos capilares e gravitacionais desprezíveis. Os demais dados do problema são:
Tabela 6.1 - Dados do reservatório.
DADOS DO RESERVATÓRIO	
Área do reservatório	60000 ft2
Altura da formação	10 ft
Permeabilidade absoluta da rocha	150 mD
Porosidade da rocha	0.25
Pressão inicial do reservatório	4990 psi
Saturação de água conata	0.20
Saturação inicial de óleo	0.80
Raio dos poços	0.33 ft
As permeabilidades relativas são dadas por:
= S2
S a
k
ra
(6.1)
kro =(1 — Sa )2
(6.2)
Tabela 6.2 - Dados P.V.T. dos fluidos.
DADOS P.V.T. DOS			FLUIDOS	
Pressão (psi)	Bo (ft3/STB)	Viscosidade do óleo (cp)	Ba (ft3/STB)	Viscosidade da água (cp)
6014.7	1.0620	1.9300	1.02	1.0000
5014.7	1.0647	1.6611	1.02	1.0000
4014.7	1.0673	1.4297	1.02	1.0000
3014.7	1.0700	1.2306	1.03	1.0000
2514.7	1.0714	1.1417	1.03	1.0000
2014.7	1.0727	1.0592	1.03	1.0000
1514.7	1.0741	0.9827	1.03	1.0000
1014.7	1.0754	0.9116	1.03	1.0000
514.7	1.0768	0.8458	1.03	1.0000
14.7	1.0781	0.7847	1.03	1.0000
O problema é ilustrado na figura 6.1, abaixo:
Figura 6.1 - Reservatório sob esquema five-spot.
Os resultados da simulação para um período de 1400 dias, utilizando-se uma malha de 7x7 blocos, foram:
a)	Variações das pressões no bloco produtor e na “boca” do poço produtor com o tempo
PRESSÃO (PSI)
PRESSÃO, PRODUTOR
□	200	400	600	600	1,000	1,200	1,400
TEMPO (DIAS)
■ PRESSÃO NA "BOCA" DO POÇO	i PRESSÃO NO BLOCO
Figura 6.2 - Pressões no bloco produtor e na “boca” do poço produtor.
b) Variações das saturações de água e óleo no bloco produtor com o tempo
Figura 6.3 - Saturação de óleo no bloco produtor.
SATURAÇÃO DE ÁGUA NO BLOCO PRODUTOR
Figura 6.4 - Saturação de água no bloco produtor.
c) Mapas de saturação de óleo e de água após 90 dias
Figura 6.5 - Mapa de saturação de óleo após 90 dias.
MAPA DE SATURAÇÃO DE ÁGUA
Figura 6.6 - Mapa de saturação de água após 90 dias.
Pode-se notar pela figura 6.2 que quando a vazão total de injeção de água era próxima à vazão de produção (durante os primeiros 200 dias), a pressão do reservatório decrescia suavemente com o tempo. Quando a vazão total de injeção foi reduzida para 48 SCF/dia, a variação da pressão do reservatório com o tempo passou a ser mais acentuada.
Outra observação que deve ser feita é a questão do tempo de breakthrough da água de injeção, isto é, o tempo que o fronte da água de injeção levou para atingir o bloco produtor. Pode-se constatar pelas figuras 6.3 e 6.4 que este tempo foi de aproximadamente 75 dias. Percebe-se ainda pelas figuras 6.3 e 6.4 que a vazão total de injeção de água foi reduzida após os primeiros 200 dias, devido às acentuadas variações das saturações de água e óleo no bloco produtor durante este período. A redução é necessária para ajustar a RAO (razão água óleo), isto é, para diminuir a produção de água, que passa a ser significativa devido ao crescimento da saturação de água no bloco produtor.
Pelas figuras 6.5 e 6.6 pode ser observada a forma como a água de injeção “varre” o óleo no reservatório. As regiões próximas às fronteiras do reservatório, entre
os poços injetores (regiões amarelas na figura 6.5), não são bem “varridas” pela água, ficando assim uma quantidade significativa de óleo nestas regiões. Uma solução para este problema seria a realização de uma infill drilling, acrescentando novos poços injetores, com distâncias menores entre si.
7	CONCLUSÕES E RECOMENDAÇÕES
Foi apresentada uma visão geral da simulação de reservatórios, abordando tópicos como: quais são as utilizações da simulação; o histórico do desenvolvimento desta área nas últimas décadas; o que é um simulador numérico de reservatórios e qual é a metodologia utilizada por este; e as etapas envolvidas num estudo de simulação numérica de reservatórios.
Foram discutidos o que é uma malha de discretização e quais são os tipos mais utilizados em simulação de reservatórios. Foi discutido ainda o efeito de orientação de malha, que pode gerar erros significativos nos resultados de uma simulação, e os esforços realizados nas últimas décadas a fim de obliterar-se este efeito. Dentre as geometrias de malha foi adotada a malha triangular, que apresenta como vantagens a redução do efeito de orientação de malha e a flexibilidade para modelagem de reservatórios de geometria complexa. Foi feita uma abordagem geral dos métodos numéricos de construção de malhas e foi mostrado o método numérico de geração da malha triangular adotada.
O modelo Black-Oil foi utilizado para a modelagem matemática. Sua dedução foi demonstrada, sendo resultado da combinação de um balanço material integral com a lei de Darcy.
As equações integrais de fluxo foram discretizadas por diferenças finitas, utilizando-se o método de bloco triangularização das mediatrizes. Foi adotado o método SS implícito como forma de resolução das equações de fluxo discretizadas, sendo abordadas as questões da influência do controle do tamanho do time step na estabilidade e acurácia das soluções, e do modelo de poço adequado para a geometria hexagonal de blocos de malha adotada.
Por fim, foram exemplificadas algumas aplicações da simulação numérica de reservatórios, dentro do escopo do estudo realizado, com a utilização do simulador gratuito BOAST98.
Como continuação deste trabalho, pode ser estudada primeiramente a extensão do modelo numérico adotado para casos com reservatórios anisotrópicos e compressíveis, e com efeitos capilares e gravitacionais não desprezíveis. Em seguida, pode ser feita a extensão para casos bidimensional-trifásicos óleo/água/gás e para casos tridimensionais.
REFERÊNCIAS BIBLIOGRÁFICAS
AMADO, L. C. N.; PEDROSA, O. A. A finite volume approach with triangular grids in reservoir simulation. Paper SPE, n.23633, p.179-185, 1994.
AZIZ, K.; SETTARI, A. Petroleum reservoir simulation. 1 ed. London: Applied Science Publishers Ltd., 1979. 553p.
BREITENBACH, E. A. Reservoir simulation: state of the art. Paper SPE, n.23472-PA, p.1033-1036, set. 1991. Disponível em:&amp;lt;http://www.onepetro.org/mslib/app/new Search.do&gt;. Acesso em: 8 abr. 2010.
CHEN, Z.; HUAN, G.; MA, Y. Computational methods for multiphase flows in porous media. 1 ed. Philadelphia: SIAM, 2006. 549p.
CHONG, E. E. Development of a 2-D black-oil reservoir simulator using a unique gridblock system. 2004. Dissertação (Mestrado em Engenharia de Petróleo) - Office of Graduate Studies, Texas A&amp;amp;M University, College Station, 2004. Disponível em:&amp;lt;http://repository.tamu.edu/bitstream/handle/1969.1/3334/etd-tamu-2004C-PETE-Chon g.pdf?sequence=1&gt;. Acesso em: 10 jun. 2010.
COATS, K. H. Reservoir simulation: state of the art. Paper SPE, n.10020-PA, p.16331642, ago. 1982. Disponível em:&amp;lt;http://www.onepetro.org/mslib/app/newSearch.do&gt;. Acesso em: 8 abr. 2010.
COSENTINO, L. Integrated reservoir studies. 1 ed. Paris: Editions TECHNIP, 2001. 322p.
ERTEKIN, T.; ABOU-KASSEM, J. H.; KING, G. R. Basic applied reservoir simulation. SPE Textbook Series v.7. Richardson: SPE, 2001.
FANCHI, J. R. Principles of applied reservoir simulation. 3 ed. Mississippi: Elsevier Science Publishing Co., Inc., 2006. 511p.
GILAT, A.; SUBRAMANIAM, V. Métodos numéricos para engenheiros e cientistas. 1 ed. Porto Alegre: Bookman, 2000. 480p.
GRECCO, C. B. Metodologia para ajuste de histórico assistido através do uso da simulação por linhas de fluxo. Boletim técnico da produção de petróleo, Rio de Janeiro, v.2, n.2, p.323-339, 2007. Disponível em: http://vdpf.petrobras.com.br/vdpf/PDF HighlightServlet.svlt?acao=pdf&amp;amp;codigoArtigo=188#xml=http://vdpf.petrobras.com.br/vd pf/PDFHighlightServlet.svlt?acao=xml&amp;amp;codigoArtigo=188&gt;. Acesso em: 22 abr. 2010.
MACHADO, V. B. M. Modelagem e simulação numérica de reservatórios de petróleo: principais aspectos envolvidos. Apostila (Curso de Formação de Engenheiros de
MALISKA, C. R. et al. Desenvolvimento de um simulador 3D black-oil em coordenadas curvilíneas generalizadas. Apostila (Relatório Parcial de Atividades Preparado para o CENPES/PETROBRAS) - Departamento de Engenharia Mecânica, Universidade Federal de Santa Catarina, Florianópolis, 1993. 42p.
OLIVEIRA, B. C. Simulação de reservatórios de petróleo em ambiente MPSoC. 2009. Dissertação (Mestrado em Sistemas e Computação) - Centro de Ciências Exatas e da Terra, Universidade Federal do Rio Grande do Norte, Natal, 2009. Disponível em:&amp;lt;http://www.ppgsc.ufrn.br/html/Producao/Dissertacoes&gt;. Acesso em: 18 mar. 2010.
PALAGI, C. L.; AZIZ, K. Handling of wells in reservoir simulators. In: INTERNATIONAL FORUM ON RESERVOIR SIMULATION, 4., 1992, Salzburg. Anais.... Stanford: Stanford University, 1992. p.1-95.
PRAIS, F.; CAMPAGNOLO, E. A. Modelagem do escoamento multifásico em simulação de reservatório. In: CONGRESSO BRASILEIRO DE ENGENHARIA MECÂNICA, 11., 1991, São Paulo. Artigo.... São Paulo, 1991. p.545-548.
ROSA, A. J.; CARVALHO, R. S.; XAVIER, J. A. D. Engenharia de reservatórios de petróleo. 1 ed. Rio de Janeiro: Interciência, 2006. 832p.
THOMPSON, J. F.; SONI, B. K.; WEATHERILL, N. P. Handbook of grid generation. 1 ed. Boca Raton: CRC Press, 1999.
THOMPSON, J. F.; WARSI, Z. U. A.; WAYNE, C. M. Numerical grid generation. 1 ed. Mississippi: Elsevier Science Publishing Co., Inc., 1985. 323p.
WATTS, J. W. Reservoir simulation: past, present and future. Paper SPE, Dallas, n.38441-PA, p.171-176, dez. 1997. Disponível em:&amp;lt;http://www.onepetro.org/mslib/ app/newSearch.do&gt;. Acesso em: 8 abr. 2010.</field>
	</doc>
</add>