<?xml version="1.0" encoding="utf-8"?>
<add>
	<doc>
		<field name="docid">BR-TU.13728</field>
		<field name="filename">19843_Mobilidade%20el%c3%a9trica_sistema%20de%20venda%20de%20energia%20por%20sms.pdf</field>
		<field name="filetype">PDF</field>
		<field name="text">
Universidade de Aveiro Departamento de Engenharia Mecânica
2014

Luísa Manuel de

Sousa Pereira

Azeredo

Mobilidade elétrica - Sistema de venda de

energia por SMS





Universidade de Aveiro Departamento de Engenharia Mecânica
2014

Luísa Manuel de

Sousa Pereira

Azeredo

Mobilidade elétrica - Sistema de venda de

energia por SMS

Dissertação apresentada à Universidade de Aveiro para cumprimento dos re-
quisitos necessários à obtenção do grau de Mestre em Engenharia Mecânica,
realizada sob a orientação cientí?ca de José Paulo Oliveira Santos, Profes-
sor Auxiliar do Departamento de Engenharia Mecânica da Universidade de
Aveiro





O júri / The jury

Presidente / President Professora Doutora Margarida Isabel Cabrita Marques Coelho
Professara Auxiliar da Universidade de Aveiro

Vogais / Examiners committee Professor Doutor Rui Manuel Escadas Ramos Martins
Professor Auxiliar da Universidade de Aveiro (Arguente Principal)

Professor Doutor José Paulo Oliveira Santos
Professor Auxiliar da Universidade de Aveiro (Orientador)





Agradecimentos /
Acknowledgements

Gostaria de deixar o meu especial agradecimento a todos, que direta ou
indiretamente, permitiram e colaboraram para o desfecho desta formação
académica.
Ao meu orientador, Professor Doutor José Paulo Santos, pela con?ança e
apoio que sempre prestou ao longo deste projeto.

Aos meus pais, Manelzinho e Guidinha, a oportunidade que me deram para
prosseguir os meus estudos e apoio incondicional nos melhores e piores mo-
mentos de todos os anos da minha vida. Um muito obrigada por tudo.

À minha irmã, Joana, o apoio e o carinho que sempre me deu ao longo
desta longa caminhada, permitindo desde muito cedo o sucesso em toda a
formação académica.

Ao meu melhor amigo, Rui, por toda a atenção, paciência, carinho e apoio
que sempre demonstrou, em todos os momentos, sendo uma forte contribui-
ção para ultrapassar todos os obstáculos.

Aos meus amigos de mecânica e aos meus colegas de laboratório pela ami-
zade, companheirismo e espírito de entreajuda ao longo de todo este tempo.
Juntos passámos momentos de grande diversão, assim como contribuímos
para o sucesso de cada um de nós.

A todos um MUITO OBRIGADA!





Palavras Chave Medição, Carregamento, Veículo Elétrico, Analógico, PIC-GSM, Microchip
PIC, PHP, HTML5

Resumo Com o constante aumento dos preços do petróleo e dos seus derivados, as-
sim como a sua crescente escassez, as soluções a curto prazo passam pela
utilização de veículos com diferentes meios de propulsão, entre eles os mo-
tores a hidrogénio e os motores elétricos. A evolução tecnológica observada
nos últimos anos na área dos veículos elétricos e o previsível aumento do
número de veículos, não foi acompanhado pelo aumento de postos de abas-
tecimento, existindo uma importante área do país onde, ainda não é possível
abastecer o automóvel. Outro obstáculo, é o processo de compra de energia
nos postos existentes ser demorado, uma vez que necessitam de um prévio
registo do utilizador para adquirir o cartão para a compra de energia.

O documento apresentado, contém os detalhes acerca de um projeto que
consiste na criação de um protótipo para abastecimento de veículos elétri-
cos, o qual oferece ao utilizador a possibilidade de requisitar quantidades de
energia através de um SMS, e consultar todos os consumos efetuados no
posto de abastecimento através de um navegador de Internet. A utilização
de página Web possibilita a visualização de conteúdos referidos no navega-
dor em quase todos os telemóveis de nova geração, bem como em tablet e
computadores.

Tendo em conta que o sistema deveria ser de baixo custo e com resultados
práticos próximos de alguns modelos dispendiosos existentes no mercado,
recorreu-se a componentes de baixo custo. Este projeto permite assim a
requisição de energia através de uma SMS, com registo de dados numa
página Web do posto de abastecimento.





Keywords Measurement, Charger, Electric Vehicle, Analogic, PIC-GSM, Microchip
PIC, PHP, HTML5

Abstract With the lack and constant increasing prices of fossil fuels, short-term solu-
tions result in the use of di?erent types of propulsion such as, hydrogen or
electric motors.
The technological evolution in electric vehicles, on the passed few years, and
its predictable rising number, were not followed by the number of charging
stations. Therefore, there are some important areas that do not allow an
electric vehicle to charge. Existing charging stations require a prior user
registration to get a card for energy purchase, which makes all the process
slow.
The document here presented, contains details about a prototype created
for electric vehicles supply o?ering, the user, the possibility, to require energy
through a SMS and to consult user consumptions, on every charging station,
through a Internet browser. Web page usage, allows the content visualization
in all smartphones and tablets.

Given that the system should be low-cost and with results close to some
existing expensive models on the market, used low-cost componentes. This
project allows the purchase of energy through a SMS, with data register on
a Website for the charging station.





Conteúdo

Conteúdo i

Lista de Figuras iii

Lista de Tabelas v

Acrónimos vii

1 Introdução 1

1.1 Contexto . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 1
1.2 Problema a resolver . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 2
1.3 Objetivos . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 3
1.4 Organização . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 4

2 Estado de Arte 5

2.1 Veículo Elétrico . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 5
2.2 Legislação associada à implementação do posto de abastecimento . . . . . . . . 6
2.3 Tecnologias de abastecimento . . . . . . . . . . . . . . . . . . . . . . . . . . . . 7

2.3.1 EFACEC . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 7
2.3.2 EV Solutions . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 8
2.3.3 Charge Point . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 9

2.4 Empresas de Monitorização Gestão de postos públicos . . . . . . . . . . . . . . 10
2.4.1 MOBI.E Mobilidade Elétrica . . . . . . . . . . . . . . . . . . . . . . . . 10
2.4.2 Essent . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 11
2.4.3 Wattstation . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 12

2.5 Projetos Relacionados . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 13
2.5.1 "Electric vehicle charging infrastructure in Poland"

[Benysek and Jarnut, 2012] . . . . . . . . . . . . . . . . . . . . . . . . . 13

3 Solução Proposta 15

3.1 Perspetiva Geral . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 15
3.2 Funcionalidades do sistema . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 16
3.3 Restrições . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 16
3.4 Apresentação da solução . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 16

i



4 Implementação do Posto de Abastecimento 21

4.1 Arquitetura do Sistema . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 21
4.1.1 Módulo 1 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 21
4.1.2 Módulo 2 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 22
4.1.3 Módulo 3 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 23
4.1.4 Conclusão . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 24

4.2 Módulo 1- Controlo da passagem da corrente elétrica . . . . . . . . . . . . . . . 25
4.3 Módulo 2 - Medição da Energia . . . . . . . . . . . . . . . . . . . . . . . . . . . 26

4.3.1 Medição da Corrente . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 26
4.3.2 Medição da Tensão . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 29
4.3.3 Microcontrolador . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 31

4.4 Módulo 3 - Modem GSM/GPRS . . . . . . . . . . . . . . . . . . . . . . . . . . 36
4.4.1 Comunicação RS232 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 36
4.4.2 Comunicação TCP/IP . . . . . . . . . . . . . . . . . . . . . . . . . . . . 37

4.5 Síntese protótipo . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 40

5 Implementação do Sistema de Monitorização 43

5.1 Base de dados MySQL . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 44
5.2 Página WEB . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 45

6 Conclusões e Trabalho futuro 53

6.1 Conclusões . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 53
6.2 Trabalho Futuro . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 54

Bibliogra?a 55

A Diagramas 59

B Esquemas Elétricos 69

ii



Lista de Figuras

1.1 Utilização de Veículos Elétricos nos países da Europa.[Automotive] . . . . . . . 1
1.2 Crescimento Global dos postos de abastecimento de veículos elétricos.[Research] 3

2.1 Carregamento do veículo elétrico.[Reis, 2010] . . . . . . . . . . . . . . . . . . . 6
2.2 Exemplos de postos de abastecimento da EFACEC.[EFACEC] . . . . . . . . . . 8
2.3 Exemplos de postos de abastecimento da EV Solutions.[Solutions] . . . . . . . . 9
2.4 Aplicação de carregamento da Charge Point.[Point] . . . . . . . . . . . . . . . . 10
2.5 Aplicação de apoio MOBIE. [Reis, 2010] . . . . . . . . . . . . . . . . . . . . . . 11
2.6 Funcionamento do Microincasso.[Microincasso] . . . . . . . . . . . . . . . . . . 12
2.7 Aplicação para Smartphone da Wattstation.[Wattstation] . . . . . . . . . . . . . 13
2.8 Sistema de carregamento de VE na Polónia.[Benysek and Jarnut, 2012] . . . . . 13
2.9 Protótipo desenvolvido. Legenda: D- ecrã, CM - modulo de comunicação

bidirecional, CPU- unidade de processamento central, AC- Modulo de con-
trolo de acesso, P- proteção, M- medidor de energia, S- estado de leitura.
[Benysek and Jarnut, 2012] . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 14

3.1 Diagrama da solução proposta. . . . . . . . . . . . . . . . . . . . . . . . . . . . 17
3.2 Fluxograma da solução proposta. . . . . . . . . . . . . . . . . . . . . . . . . . . 18

4.1 Propostas para o Módulo 1. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 22
4.2 Propostas para o Módulo 2. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 23
4.3 Proposta para o Módulo 3 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 24
4.4 Diagrama dos módulos existentes. . . . . . . . . . . . . . . . . . . . . . . . . . . 25
4.5 Módulo 1 - Controlo da passagem da corrente elétrica. . . . . . . . . . . . . . . 26
4.6 Efeito de Hall.[Electronics, 2014] . . . . . . . . . . . . . . . . . . . . . . . . . . 26
4.7 Comparação de transdutores . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 27
4.8 Circuito representativo do tratamento dos sinais da corrente . . . . . . . . . . . 28
4.9 Transdutor de tensão LV25-P da LEM [LEM, 2014b] . . . . . . . . . . . . . . . 30
4.10 Circuito representativo do tratamento dos sinais da corrente . . . . . . . . . . . 31
4.11 Esquema geral do microcontrolador . . . . . . . . . . . . . . . . . . . . . . . . . 32
4.12 Potências. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 33
4.13 Ordem de leitura das entradas analógicas. . . . . . . . . . . . . . . . . . . . . . 35
4.14 Diagrama de envio/receção de SMS com carregamento. . . . . . . . . . . . . . . 37
4.15 Diagrama do envio de dados para a página web . . . . . . . . . . . . . . . . . . 39
4.16 Diagrama do processo do carregador . . . . . . . . . . . . . . . . . . . . . . . . 40
4.17 Prototipo - Vista exterior . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 41
4.18 Prototipo - Vista interior . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 42

iii



4.19 Teste de envio de mensagem para o protótipo. . . . . . . . . . . . . . . . . . . . 42

5.1 Módulo da Monitorização . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 43
5.2 Código PHP para inserção de valores na base de dados. . . . . . . . . . . . . . 44
5.3 Estrutura da base de dados. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 44
5.4 Ícone da página. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 45
5.5 Página principal E.Charger. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 46
5.6 Pagina para fazer registo. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 48
5.7 Caixa de aviso de registo efetuado. . . . . . . . . . . . . . . . . . . . . . . . . . 48
5.8 Pagina do cliente . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 49
5.9 Pagina para fazer Login. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 50
5.10 Pagina de administrador. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 51
5.11 Pesquisa por cliente. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 52
5.12 Pagina Sobre o projeto criado. . . . . . . . . . . . . . . . . . . . . . . . . . . . . 52
5.13 Pagina com o Contacto do projeto. . . . . . . . . . . . . . . . . . . . . . . . . . 52

A.1 Diagrama de comandos em ciclo normal. . . . . . . . . . . . . . . . . . . . . . . 61
A.2 Diagrama de envio/recepção de SMS quando há erros. . . . . . . . . . . . . . . 63
A.3 Vetor Interrupção do Pic 18f97J60 . . . . . . . . . . . . . . . . . . . . . . . . . 65
A.4 Diagrama geral do Pic 18f97J60 . . . . . . . . . . . . . . . . . . . . . . . . . . . 67

B.1 Esquema representativo de montagem módulo Triac . . . . . . . . . . . . . . . 71
B.2 Esquema representativo de montagem do transdutor de tensao . . . . . . . . . . 73
B.3 Esquema representativo de montagem do transdutor de corrente . . . . . . . . . 75

iv



Lista de Tabelas

4.1 Comparação entre transdutores de corrente . . . . . . . . . . . . . . . . . . . . 27
4.2 Características do transdutor LV25-P . . . . . . . . . . . . . . . . . . . . . . . . 29
4.3 Comandos AT para envio e receção de SMS. . . . . . . . . . . . . . . . . . . . . 36
4.4 Comandos AT para a comunicação TCP/IP . . . . . . . . . . . . . . . . . . . . 38

v



vi



Acrónimos

A Ampere

API Application Programming Interface

APN Access Point Name

AC Corrente Alternada

DC Corrente Contínua

EV Veiculo elétrico

GPS Global Positioning System

GPRS General Packet Radio Service

GSM Global System for Mobile Comunications

HEV Veículo elétrico híbrido

HTML Hypertext Markup Language

Hz Hertz

Ief Corrente efetiva

IP Internet Protocol

kwh quilo-watt-hora

LCD Liquid Crystal Display

Q Potência Reativa

QR Quick Response

Pact Potência Ativa

PCB Printed Circuit Board

PDP Packet Data Protocol

Pinst Potência Instantânea

vii



PLC Programmable logic controller

S Potência Aparente

SIM Subscriber Identity Module

SMS Short Message Service

TCP Transmission Control Protocol

UART Universal Asynchronous Receiver/Transmitter

URL Uniform Resource Locator

V Volt

VAR Volt - Ampere reativo

VA Volt - Ampere

Vef Tensão efetiva

W Watt

viii



Capítulo 1

Introdução

1.1 Contexto

A nível internacional, todos os países têm assistido a uma revolução no setor energético.
Esta revolução assenta na ?utuação dos preços dos combustíveis fósseis, nas alterações cli-
máticas, no esgotamento das fontes energéticas e, mais recentemente, nos impactos oriundos
da crise ?nanceira global que obrigou a uma mudança de atitude perante a forma como se
abordarão as questões energéticas no futuro.

A dependência do petróleo e o impacto ambiental daí resultante, conduziu a uma aposta
numa diversi?cação energética para a mobilidade que visam a melhoria da qualidade de vida
das populações e a redução da fatura energética nacional. O principal objetivo passa por
contribuir para a mobilidade sustentável, maximizando as vantagens e integrando as energias
renováveis como alternativa aos combustíveis fósseis. Daí, as soluções a curto prazo passam
pela utilização de veículos com diferentes meios de propulsão, entre eles os motores a hidrogénio
e os motores elétricos. Na Figura 1.1, pode-se observar a percentagem de utilização de veículos

Figura 1.1: Utilização de Veículos Elétricos nos países da Europa.[Automotive]

1



2 1.Introdução

elétricos nos países da Europa no ano de 2013. No entanto, em Portugal essa percentagem é
bastante reduzida.

Existem dois fatores que têm vindo a limitar a massi?cação dos veículos elétricos, a sua
reduzida autonomia e o seu preço, quando comparados com a dos veículos de combustão in-
terna. Como forma de compensar a reduzida autonomia, é necessário continuar a progredir
em dois níveis: ao nível do veículo é necessário evoluir a tecnologia das baterias atuais bem
como os sistemas de gestão energéticos internos, ao passo que a nível de apoio ao veículo é ne-
cessário ampliar as redes nacionais de postos de carregamentos, bem como técnicas de gestão
que permitam aproveitar a rede elétrica. As novas tecnologias, em particular as tecnologias
de comunicação, aparecem como suporte às soluções que podem ser desenvolvidas para resol-
ver estes problemas na medida em que permitem uma otimização da gestão local (e mesmo
nacional) bem como da gestão da produção e do consumo.

1.2 Problema a resolver

Como foi referido anteriormente, um dos grandes obstáculos aos carros elétricos centra-se
na infraestrutura de carregamento bem como a escassez da sua rede. Segundo um estudo da
Pike Research realizado em 2010(Figura 1.2) os postos de abastecimento para veículos elé-
tricos tenderiam a aumentar na Europa, especialmente na parte Oeste. No entanto, com a
crise económica existente, com especial destaque em Portugal, tal evolução não se veri?cou,
como se pôde veri?car na Figura 1.1. Este resultado pode ser derivado à di?culdade que a
população portuguesa tem em abastecer os seus veículos elétricos (VE). ?A disponibilidade de
carregamento é um dos principais obstáculos à difusão do VE. Mais de 60% dos agregados da
Área Metropolitana de Lisboa não têm possibilidade de carregar o VE em casa, o que signi-
?ca que, para terem um VE, teriam que estar dispostos a aceitar as limitações e a incerteza
decorrentes de poderem carregar o automóvel apenas no emprego (se fosse esse o caso) ou nos
postos de carregamento públicos. Este obstáculo só poderá ser superado quando existir uma
rede de postos de carregamento públicos de tal forma extensa e densa que não exista essa
incerteza.? [Barbosa, 2012a]

Para resolver esse paradigma, o Ministério do Ambiente, Ordenamento do Território e
Energia de Portugal, desenvolveu em Setembro de 2014 o Compromisso para o Crescimento
Verde, que visa manter o crescimento económico com menor consumo dos recursos naturais,
mantendo a qualidade de vida da população. E no que toca ao apoio à mobilidade elétrica, um
dos compromissos é "Promover a mobilidade elétrica, alargando e introduzindo maior concor-
rência na rede pública, privilegiando os modos de carregamento nas habitações e nos locais de
trabalho e concretizando programas de mobilidade sustentável na administração publica (até
2020, introduzir 1250 viaturas elétricas e híbridas plug-in nos serviços do Estado e concretizar
sistemas de gestão de frotas - car pooling)."[Portugal, 2014]

Por isso, a solução indicada para aumentar a rede de postos de carregamento, seria a ela-
boração de postos com um reduzido preço de compra e de implementação, que ?zesse face
à reduzida rede de abastecimento em Portugal que proporcionaria o aumento da compra de
veículos elétricos.

Luísa Manuel de Sousa Pereira Azeredo Dissertação de Mestrado



1.Introdução 3

Figura 1.2: Crescimento Global dos postos de abastecimento de veículos elétricos.[Research]

Outro problema existente na rede de abastecimento de veículos elétricos em Portugal,
preside particularmente de como é efetuado o pagamento do serviço. Atualmente, a rede
nacional é constituída por postos que apenas permitem ao utilizador o pagamento com um
cartão pré-pago da empresa. Esse cartão para ser utilizado, exige necessariamente um prévio
registo na rede de abastecimentos para que seja enviado por correio o respetivo cartão. Neste
caso, impossibilita um novo utilizador de um veiculo elétrico de o carregar num posto público
prontamente.

Conclui-se assim que existe uma elevada urgência para que seja desenvolvido um posto de
abastecimento que faça frente a este paradigma.

1.3 Objetivos

O trabalho a realizar nesta dissertação tem como objetivo, como foi referido anteriormente,
aumentar a rede nacional de postos de abastecimento bem como melhorar o sistema de aqui-
sição dessa energia. Assim, torna-se necessário criar um modelo de fácil implementação, que
permita a sua instalação e utilização em qualquer ponto do país de forma rápida e segura.

Pretende-se que seja um modelo com um custo de implementação baixo, para se poder
aumentar a rede de abastecimento, de forma fácil com a sua implementação num simples
poste de iluminação pública, por exemplo. Outro objetivo, é ultrapassar o problema dos pos-
tos existentes no momento, alterando o método de pagamento. Uma vez que na população
portuguesa o uso de telemóvel é muito frequente, uma solução viável seria o pagamento feito
por uma simples SMS, facilitando o acesso do utilizador aos mesmos. Esta solução permitiria
também a que qualquer turista pudesse utilizar o posto.

Espera-se que este novo equipamento venha acompanhado de um website para que o uti-
lizador possa consultar os seus consumos mensais junto deste postos de abastecimento.

Luísa Manuel de Sousa Pereira Azeredo Dissertação de Mestrado



4 1.Introdução

1.4 Organização

Em termos gerais, a estrutura da presente dissertação encontra-se dividida em seis capí-
tulos.

O primeiro capítulo é composto pela Introdução. Nesta fase inicial, apresento a temática
em estudo, os respetivos objetivos e âmbito do protótipo desenvolvido, e dão-se a conhecer
as principais motivações que conduziram à seleção do tema e das questões subordinadas ao
mesmo. Por outro lado, procura-se enquadrar a problemática associada ao produto a desen-
volver, o problema existente atualmente no mercado português e a procura de uma solução
viável para este paradigma.

No segundo capítulo, é desenvolvido o Estado de Arte. Nesta fase, enquadro os conceitos
inerentes a este protótipo, como o veículo elétrico e o modo de abastecimento deste. É feita
uma ligeira abordagem pela legislação necessária para colocar um produto desenvolvido no
mercado português. Apresento as diversas tecnologias existentes já no mercado bem como
aquelas em estudo, tanto no meio académico como no meio empresarial, bem como alguns dos
web sites ou aplicações para smartphones, desenvolvidos para apoio desses meios de abasteci-
mentos de veículos elétricos por algumas empresas.

O terceiro capítulo é constituído pela Solução Proposta. Na primeira fase, é procurada uma
solução tendo em vista à problemática referida na Introdução bem como todas as tecnologias
já existentes mencionadas no Estado de Arte. São abordadas as funcionalidades e restrições
que o equipamento a desenvolver deve ter. Por ?m é apresentada a solução proposta, bem
como a sua arquitetura.

No quarto capítulo denominado por Implementação do posto de abastecimento, como o
nome indica são apresentados os módulos inerentes ao hardware, bem como os cálculos e as
justi?cações das escolhas feitas.

No quinto capítulo é a apresentado a Implementação do sistema de monitorização, onde
é elaborada a página web e a base de dados de apoio ao protótipo desenvolvido, tendo em
consideração o lado do utilizador e o lado da administração do produto.

No sexto capítulo é feito a abordagem à análise do protótipo bem como às Conclusões
deste. Também é apresentado o trabalho futuro que consiste no que poderá ser feito no
seguimento deste projeto.

Luísa Manuel de Sousa Pereira Azeredo Dissertação de Mestrado



Capítulo 2

Estado de Arte

Neste capítulo é apresentado o atual estado da arte, tendo em conta o problema apresen-
tado no capítulo anterior. No início serão identi?cados alguns aspetos a ter em conta relativa-
mente aos veículos elétricos e a sua constituição interna de forma a se obter uma perspetiva dos
seus constituintes. Seguidamente será levantado o estudo a nível de soluções e características
para o carregamento dos veículos elétricos e por ?m as tecnologias e soluções existentes a nível
de comunicações que podem ser implementadas num sistema de carregamentos de veículos
elétricos.

2.1 Veículo Elétrico

Os veículos elétricos podem ser classi?cados de acordo com as fontes de energia para mo-
vimentar o veículo. Basicamente, existem dois tipos: veículo elétrico a bateria (EV), ou seja,
a única fonte de energia é a bateria elétrica, e o veículo elétrico híbrido (HEV), possuindo
um motor de combustão interna (gasolina ou diesel) e um conjunto de baterias químicas mais
acionamento ou conversor de potência e motor elétrico.[Escola]

Na arquitetura do veículo elétrico destacam-se quatro pontos essenciais:

• Motor elétrico, que se pode dividir essencialmente em dois tipos: corrente continua (DC)
e corrente alternada (AC).

• Sistema de controlo, que é o responsável pela gestão de energia entre a bateria e o
motor, sendo que o sistema disponibiliza a energia mediante as necessidades do motor.
O sistema de controlo também é responsável pelo funcionamento do motor durante a
travagem regenerativa, garantindo que o motor passa a funcionar como um gerador.

• Bateria, que é onde ?ca armazenada a energia elétrica, que é disponibilizada ao veículo
consoante as suas necessidades.

• Sistema de travagem. Durante a travagem, o motor funciona como um gerador, carre-
gando desta maneira a bateria, o que permite aumentar a autonomia. Este funciona-
mento denomina-se a travagem regenerativa.

Para carregar um veículo elétrico é necessário ligá-lo à corrente elétrica. O tempo de carga
varia, dependendo do tipo de carga (rápida/lenta) e da capacidade e tensão/corrente do car-
regador.

5



6 2.Estado de Arte

O carregamento convencional dos veículos elétricos é feito com recurso a um cabo, podendo
distinguir-se 2 tipos de carga, lenta/normal e rápida (Figura 2.1):

• Carga lenta/normal
Através da tensão de 220 V é possível carregar totalmente as baterias de um veículo
elétrico entre seis a oito horas. Este método é indicado para os utilizadores carregarem
o seu veículo durante a noite, aproveitando assim a energia proveniente de fontes de
energia renováveis e o acesso a tarifas mais económicas, bem com em locais próximos do
emprego. Neste tipo de carga, a corrente pode variar de 16A a 32A.

• Carga rápida
Utilizando tensões de 400 V e uma corrente aproximada de 100A, consegue-se carregar
uma bateria de 20 kWh em vinte a trinta minutos, dependendo da corrente disponível.
Este método é indicado para postos de carregamentos localizados em centros comerciais,
parques de estacionamento e postos de carregamento rápido especí?cos para o efeito.

Figura 2.1: Carregamento do veículo elétrico.[Reis, 2010]

2.2 Legislação associada à implementação do posto de abaste-
cimento

Para a elaboração de postos de abastecimento de veículos elétricos, foram criadas legisla-
ções e normas que têm de ser cumpridas. A norma europeia existente para este tipo de produto
é a EN/NP61851 ? Sistema de carga para veículos elétricos, que de?ne como deve ser feito
o carregamento de um veículo elétrico e em que condições. No entanto, o governo português
criou alguns regulamentos para além da norma europeia, que caso surja o interesse de comer-
cializar este produto em Portugal, têm de ser consideradas. De seguida são demonstrados os
mais relevantes para este caso:

• Portaria n.o 1201/2013, de 29 de Novembro, estabelece os requisitos técnicos a que ?ca
sujeita a atribuição de licença para o exercício da atividade de operação de pontos de
carregamento da rede de mobilidade elétrica;

Luísa Manuel de Sousa Pereira Azeredo Dissertação de Mestrado



2.Estado de Arte 7

• Portaria n.o 1202/2010 de 29 de Novembro, estabelece os termos aplicáveis às licenças
de utilização privativa do domínio público para a instalação de pontos de carregamento
de baterias de veículos elétricos em local público de acesso publico;

• Portaria n.o 1232/2010, de 9 de Dezembro, ?xa o valor das taxas devidas pela emissão
das licenças de comercialização de eletricidade para a mobilidade elétrica e de operação
de pontos de carregamento, bem como da taxa de inspeção devida pela realização de
inspeções periódicas;

• Portaria n.o 173/2011 de 28 de Abril, estabelece as condições mínimas, os limites de
capital e riscos cobertos pelo seguro obrigatório de responsabilidade civil por danos
causados no exercício da atividade de comercialização de eletricidade para a mobilidade
elétrica;

• Portaria n.o 252/2011 de 27 de Junho, estabelece as normas técnicas para instalação
e funcionamento de pontos de carregamento normal em edifícios e outras operações
urbanísticas.

2.3 Tecnologias de abastecimento

De seguida são apresentadas as soluções comerciais existentes no mercado, ou seja, é feita
uma breve descrição dos tipos de carregadores existentes bem como algumas das estações de
carregamento existentes.

2.3.1 EFACEC

A EFACEC consiste numa empresa portuguesa que desenvolve, para além de outras tecno-
logias, postos de abastecimento para veículos elétricos. Atualmente, os existentes em Portugal
na via pública são produto desta empresa.

Para o tipo de carregamento rápido, a EFACEC apresenta o Quick Charger (Figura 2.2).
Consiste num carregador de corrente contínua que pode ser utilizado para carregar todos os
veículos elétricos, que permite um carregamento de 80% em 30 minutos. Este equipamento
esta desenvolvido para corrente continua, no entanto está disponível como opção uma corrente
alternada de 43kVA. As suas características essenciais são:

• Voltagem: 400V

• Frequência: 50/60Hz

• Corrente:73 A

• Fator de potência: 0,98

Para efetuar o pagamento do serviço, a empresa dispõem de instalação de leitura para cartões
RFID, que necessita de um prévio registo na empresa para a sua aquisição.

Luísa Manuel de Sousa Pereira Azeredo Dissertação de Mestrado



8 2.Estado de Arte

(a) Carregamento Rápido (b) Carregamento Lento

Figura 2.2: Exemplos de postos de abastecimento da EFACEC.[EFACEC]

Para carregamentos lentos, a EFACEC desenvolveu equipamentos para instalação em ha-
bitações. Por esse motivo, este modelo tem as seguintes funcionalidades:

• Veri?car se o veículo se encontra corretamente ligado;

• Veri?cação contínua da integridade do condutor de terra de proteção;

• Deteção contínua de corrente residual;

• Ativar/ desativar a saída do carregador;

Este modelo, comparativamente ao anterior, já utiliza correntes mais inferiores. Neste mo-
delo, a corrente varia de 16A a 32A e utiliza a energia da rede com aproximadamente 230V.
Opcionalmente, este modelo também vem equipado com acesso por RFID.

2.3.2 EV Solutions

A EV Solutions consiste numa empresa que comercializa carregadores para veículos elétri-
cos. Para tal, desenvolveu carregadores para os dois tipos de carregamentos realizados. Para
ambos o método de pagamento aplicado é através de cartão.

No caso do carregamento lento, um exemplo da EV Solutions para aplicação pública de
carregamento, está representado do lado direito da Figura 2.3. Este equipamento possui as
seguintes características:

• Voltagem: 208VAC a 240VAC

• Frequência: 60/50 Hz

• Corrente de saída: máximo 30A

Luísa Manuel de Sousa Pereira Azeredo Dissertação de Mestrado



2.Estado de Arte 9

• Corrente de entrada: máximo 40A

Este tipo de carregador tem um preço comercial aproximado de 600 euros. Este modelo
depois pode ser adaptado com sistemas de comunicaçãowi? para auxiliar as redes de distri-
buição.

(a) Carregamento Rápido (b) Carregamento Lento

Figura 2.3: Exemplos de postos de abastecimento da EV Solutions.[Solutions]

Para o carregamento rápido, a EV Solutions desenvolveu para a Nissan um modelo que
permite carregar o veículo em cerca de 80% em 30 minutos, sendo ideal para aplicações públicas
e comerciais. Este modelo tem as seguintes características:

• Voltagem: 480V

• Frequência: 50/60Hz

• Corrente: 54A

Este modelo pode ainda ter a instalação de um LCD que permite demonstrar o consumo
energético.

2.3.3 Charge Point

A Charge Point é uma rede de postos de abastecimento de carros elétricos distribuídos na
Europa, Estados Unidos da América, Ásia e Austrália. Esta rede, apenas contém postos de
carregamento lento. O exemplo referido na Figura 2.4, tem as seguintes características:

• Voltagem: 240VAC

• Corrente: 30A

• Frequência: 60Hz

Luísa Manuel de Sousa Pereira Azeredo Dissertação de Mestrado



10 2.Estado de Arte

Este modelo possui um LCD que demonstra instruções de como o utilizador deve usar o
carregador, bem como é acompanhado de uma aplicação para Smartphone. Na Figura 2.4
pode-se visualizar as diversas funcionalidades dessa aplicação. O cliente pode monitorizar
o carregamento do veiculo à distância, pode iniciar o carregamento através do smartphone,
consegue procurar através de um mapa interativo todos os postos de abastecimento existentes,
bem como memorizar os seus favoritos numa lista.

Para adquirir esta aplicação e aceder a todas as suas funcionalidades, o utilizador apenas
precisa de se registar no site da Charge Point, cedendo os seus dados pessoais, bem como
adicionar um método de pagamento, Paypal ou cartão de crédito. Depois de adicionados à
aplicação, é tudo automático.

Figura 2.4: Aplicação de carregamento da Charge Point.[Point]

2.4 Empresas de Monitorização Gestão de postos públicos

2.4.1 MOBI.E Mobilidade Elétrica

A MOBI.E surge como resposta à necessidade de uma Rede de Mobilidade Elétrica em
Portugal, uma rede integrada de vários pontos no território nacional, que permitirá o abaste-
cimento dos veículos elétricos mediante um cartão de carregamento. A eletricidade pode ser
fornecida pelos diferentes comerciantes ou através de energias renováveis presentes no local.
Para efetuar o abastecimento do veiculo elétrico, no posto é possível efetuar:

• Autenticação por cartão pré pago/ pós pago;

• Carregamento lento e rápido;

• Seleção do comerciante de eletricidade, no ponto de carregamento;

• Segurança: autenticação e conexão ou desconexão, apenas possíveis com cartão válido;

• Comunicação remota com sistemas de gestão da rede elétrica e da rede de carregamento
MOBIE.

Luísa Manuel de Sousa Pereira Azeredo Dissertação de Mestrado



2.Estado de Arte 11

Esta rede possui uma aplicação para o telemóvel que permite ao cliente saber o estado
de carga da bateria do veículo, permite encontrar o ponto de carregamento mais próximo e
permite também obter uma fatura única com todos os gastos efetuados ao logo do período
assim contratado. Isso também é possível ser efetuado através do web site da empresa (Figura
2.5).

Para a empresa, também foi criada uma gestão interna dos postos, para que sejam con-
trolados e monitorizados todos eles. Essa rede,permite à empresa ter uma transmissão segura
de dados entre a infraestrutura e a entidade, bem como permite uma gestão da informação de
carregamento por posto.

Figura 2.5: Aplicação de apoio MOBIE. [Reis, 2010]

Através desta rede, pode-se observar que o abastecimento de veículos elétricos surge aliado
às novas tecnologias, de forma a permitir ao utilizador diversas funcionalidades em tempo real.

2.4.2 Essent

A Essent é uma empresa de energia na Holanda, que associou o método de pagamento
por SMS (Short Message Service) a um posto de abastecimento de carros elétricos, através
da Microincasso que é uma empresa que aplica serviços de pagamento por SMS (Figura2.6).
Este serviço funciona como uma gestão de contas previamente criadas.

Luísa Manuel de Sousa Pereira Azeredo Dissertação de Mestrado



12 2.Estado de Arte

O cliente que efetue carregamentos nestes postos necessita de ter uma conta associada à
empresa. Essa conta pode ser efetuada com um cartão de crédito ou com conta Paypal.

A sessão de carregamento inicia-se com o envio de uma SMS e termina do mesmo modo.
Ou seja, o utilizador envia uma SMS para o número disponível no posto de abastecimento,
o serviço envia ao utilizador uma mensagem a perguntar o número da conta associada, para
proceder à cobrança de energia e aí começa o carregamento do carro. Se o utilizador já tiver
conta no Microincasso, essa pergunta não é feita. Quando este termina, o utilizador recebe
uma SMS com a informação de quanto foi debitado da sua conta pelo Microincasso.

A Essent assegura que o meio de pagamento utilizado é extremamente seguro, e a conta
da Microincasso tem um limite máximo de pagamento de 50 euros .

Figura 2.6: Funcionamento do Microincasso.[Microincasso]

2.4.3 Wattstation

A Wattstation é uma rede de postos de abastecimento predominantemente na zona do
norte dos Estados Unidos da América. Esta rede difere das restantes por possuir equipa-
mentos com método de pagamento diferente. Neste caso, o pagamento é efetuado através da
identi?cação de um QR code(Quick Response) situado em cada posto de abastecimento. Um
QR code consiste num tipo de código de barras que armazena URL capazes de serem lidos
por um smartphone (por exemplo), através da câmara e com a aplicação apropriada.

Desta forma, o utilizador apenas precisa de adquirir uma aplicação no seu telemóvel (Figura
2.7), fazer a identi?cação do código QR que se situa no posto de abastecimento, associar uma
conta Paypal à aplicação e assim torna-se possível o carregamento. Nesta aplicação também
é possível obter todos os postos disponíveis da Wattstation através de um mapa interativo,
perto do local onde o cliente se encontra, através da localização por GPS do seu smartphone.

Este tipo de pagamento tem como restrição a utilização de um telemóvel inteligente ou
um tablet, uma vez que apenas esses equipamentos permitem a leitura de QR code.

Luísa Manuel de Sousa Pereira Azeredo Dissertação de Mestrado



2.Estado de Arte 13

Figura 2.7: Aplicação para Smartphone da Wattstation.[Wattstation]

2.5 Projetos Relacionados

2.5.1 "Electric vehicle charging infrastructure in Poland"
[Benysek and Jarnut, 2012]

Este projeto tem como objetivo desenvolver ou melhorar as infraestruturas de carregamento
de veículos elétricos na Polónia. Foram considerados diversos fatores, tais como a localização,
quantidade de postos de carregamento bem como os seus diferentes tipos. Este sistema de
carregamento possui um centralizado sistema de acesso, que é baseado numa troca bidirecional
de dados entre os diferentes postos individuais do sistema de carregamento elétrico. A troca
de dados nesta estrutura é feita via GPRS (General Packet Radio Services) e a coordenação
é feita pela base central, tal como está representado na Figura 2.8.

Figura 2.8: Sistema de carregamento de VE na Polónia.[Benysek and Jarnut, 2012]

Neste projeto foram desenvolvidos dois tipos de postos: os de cidade, instalados em espa-
ços públicos; e os de garagem, instalados em residências privadas.

Luísa Manuel de Sousa Pereira Azeredo Dissertação de Mestrado



14 2.Estado de Arte

A maior diferença entre estes dois tipos de postos consiste no número de conexões que
podem ser feitas. Ou seja, nos postos de cidade podem ser carregados até três veículos ao
mesmo tempo, enquanto que nos postos de garagem apenas pode ser carregado um veículo.

Neste projeto também propõe dois diferentes tipos de fontes de energia. Propõem a uti-
lização apenas da rede elétrica (230V) nos meios mais citadinos, mas nos menos citadinos
propõe a aplicação de micro geração de energia, tal como energias renováveis. No entanto,
quando as condições naturais não permitem a geração de energia necessária ao funcionamento
normal do posto de abastecimento, é ligada a energia da rede. A base central sabe sempre
que isso acontece, uma vez que recebe dados deste postos, tais como a humidade, a direção do
vento e a temperatura, que são automaticamente inseridos numa base de dados para posteri-
ormente desenvolverem os grá?cos da aplicação, onde também se pode visualizar os consumos
dos postos em questão.

Em resumo, o utilizador aciona o posto de carregamento através da aproximação de um
cartão RFID, reportando os seus dados à base central, que veri?ca se tem autorização para
aceder. Após esta aceitar, o utilizador pode carregar o veículo com a energia requerida. Após
terminar, o posto de abastecimento envia uma SMS para o utilizador a informa-lo que o
carregamento terminou. Ao longo do carregamento, o posto envia dados para a base central,
tais como o consumo a ser feito, identi?cação do consumidor, quando inicia e quando termina
o carregamento. Pode-se visualizar a arquitetura deste protótipo na Figura 2.9.

Figura 2.9: Protótipo desenvolvido. Legenda: D- ecrã, CM - modulo de comunicação bidireci-
onal, CPU- unidade de processamento central, AC- Modulo de controlo de acesso, P- proteção,
M- medidor de energia, S- estado de leitura.
[Benysek and Jarnut, 2012]

Luísa Manuel de Sousa Pereira Azeredo Dissertação de Mestrado



Capítulo 3

Solução Proposta

Neste capítulo será realizada uma análise dos requisitos deste projeto. Assim sendo, será
apresentada uma perspetiva geral do sistema, quais as suas principais funcionalidades, assim
como uma noção de quais as restrições que limitam o projeto. Por ?m, serão listados todos
os requisitos que permitirão a construção do sistema pretendido com o mínimo de ambiguidade.

Como culminar deste estudo apresentar-se-á a solução proposta para o sistema, onde se
de?nirá a sua arquitetura, que levará à posterior implementação.

3.1 Perspetiva Geral

No capítulo anterior foram analisados diversos dispositivos existentes no mercado. No en-
tanto, apesar do seu elevado valor comercial,na maior parte existe uma constante repetição
no meio de pagamento existente. Ou seja, na sua maioria necessitam de uma pré-adesão à
rede de abastecimento para aquisição do cartão, para ser possível a utilização dos respetivos
postos ou necessitam de um smartphone para proceder à compra da energia.

Como foi referido anteriormente, o objetivo desta dissertação é facilitar ou agilizar todo o
processo de carregamento do veículo elétrico, e aumentar a rede de abastecimento nacional.
Por isso, uma boa solução seria excluir qualquer uma que obrigasse o utilizador a esperar
por um cartão ou qualquer bem material, e que permitisse a utilização imediata do posto de
carregamento após a aquisição de um veículo elétrico.

Desta forma, propõe-se a elaboração de um posto de abastecimento económico do ponto
de vista de implementação e com compra de energia por SMS. Assim, permite a que qualquer
utilizador que possua um telemóvel possa efetuar carregamentos nestes postos.

A SMS apenas requer a utilização de um cartão SIM (no telemóvel do cliente) e uma vez
que, segundo um estudo da Marktest de 2012 em média 92% de pessoas em Portugal possuem
telemóvel [Marktest], conclui-se assim que esta seja uma boa solução para este tipo de serviço,
em que o utilizador não necessita de disponibilizar os seus dados pessoas ou de se registar
na rede de gestão de serviços. Este é um serviço que pode ser efetuado imediatamente pelo
cliente.

15



16 3.Solução Proposta

3.2 Funcionalidades do sistema

As capacidades presentes num sistema avaliam-se pelas funções que executam. Este resulta
num melhoramento do atual sistema de carregamento para veículos elétricos, tendo como
principal função medir a energia consumida e efetuar a sua cobrança da forma mais prática
possível.

Desta forma, as principais funcionalidades do sistema são:

• Medição dos consumos de energia ativa pedidos;

• Garantia de integridade dos dados adquiridos;

• Cobrança da energia requisitada de forma autónoma e com saldo positivo no cartão SIM;

• Permissão de utilização de energia apenas quando o cliente possui um saldo positivo;

• Disponibilização dos dados relativos aos clientes do seu consumo em kwh;

• Utilização da rede GSM para a troca de mensagens.

3.3 Restrições

Trata-se de um sistema destinado para aplicação em espaços públicos com utilização da
rede elétrica normal, de forma a aumentar a quantidade de postos de abastecimento em Por-
tugal. Por isso, o sistema está sujeito às seguintes restrições:

• O sistema deve ser de baixo custo;

• Baixo consumo;

• Alimentação de todo o circuito de medição através da rede;

• Protótipo desenvolvido para efetuar medições de energia em circuitos de corrente alter-
nada, cuja tensão nominal é 230V e frequência nominal é 50Hz;

• Protótipo será desenvolvido utilizando as redes GSM disponíveis em Portugal;

• Robustez e ?abilidade do sistema;

• Dimensões reduzidas para o sistema.

3.4 Apresentação da solução

Como foi referido anteriormente, propõe-se um posto de abastecimento com pagamento
através de uma mensagem de texto proveniente de um telemóvel. A mensagem de texto é
enviada para o número contido no posto de abastecimento, que cobra o valor correspondente
da energia gasta do cartão de telemóvel do cliente. Usando pagamento por SMS, os utiliza-
dores conseguem efetuar com segurança e rapidez o pagamento do serviço, sem ser necessário
que a empresa do posto de abastecimento tivesse acesso ao cartão de crédito ou a um cartão
pré pago, ou mesmo a uma conta bancária. Todo o processo seria con?dencial ou anónimo,
?cando o cliente seguro quanto à partilha de dados pessoais. Para o investidor do produto,

Luísa Manuel de Sousa Pereira Azeredo Dissertação de Mestrado



3.Solução Proposta 17

ter venda de energia por SMS seria uma mais valia, não teria a necessidade de veri?car as
identidades destes e não teria problema em enviar cartões para todos os clientes associados.
No momento, a maior parte das pessoas possui um telemóvel com envio de SMS, logo seria
um bom método de pagamento para este tipo de serviço.

Como se observou, na generalidade dos equipamentos, existe para este o apoio de página
web, com o respetivo consumo do veículo a ser abastecido. Por isso, torna-se necessário que
este modelo a desenvolver possua um apoio do mesmo género, para que seja competitivo no
mercado. Pode-se observar na Figura 3.1 a solução aqui referida. Esta tem como objetivo
desenvolver um posto de abastecimento com capacidade para receber e enviar várias SMS
para o cliente, iniciar e controlar o carregamento, bem como enviar os dados de consumo para
uma base de dados para serem utilizados e manipulados por uma página Web também aqui
desenvolvida.

Esta página pode assim ser consultada por qualquer dispositivo com acesso à Internet,
tanto pelo cliente como pelo administrador do posto.

INTERNET

Página Web
Consumos de cliente

Figura 3.1: Diagrama da solução proposta.

Este protótipo poderá ser desenvolvido em maior escala, possuindo a multiplicação do
protótipo, mas com números diferentes no posto.

Na Figura 3.2, é possível observar um ?uxograma do funcionamento geral do protótipo.
Com foi referido anteriormente, o processo de carregamento é desencadeado pelo envio da
SMS pelo cliente para o número do posto de abastecimento.

Luísa Manuel de Sousa Pereira Azeredo Dissertação de Mestrado



18 3.Solução Proposta

Início

Espera pelo envio 
da mensagem
pelo utilizador

Mensagem 
recebida?

Não

Inicio do 
Carregamento 

Envio de mensagem ao 
cliente de Inicio de 

carregamento

Fim de 
carregamento. 

Envio de mensagem ao 
cliente de Fim de 

carregamento

Envio de dados para 
a base de dados

Fim de processo

Elaboração de 
gráficos na página 

Web

Sim

Escrita Correta?

Sim

Não

Envio de mensagem 
ao cliente que a 
escrita não está 

correta

Figura 3.2: Fluxograma da solução proposta.

Luísa Manuel de Sousa Pereira Azeredo Dissertação de Mestrado



3.Solução Proposta 19

No posto de abastecimento, é lida a mensagem, que deve ser enviada pelo cliente conforme
as instruções no posto (ordem de mensagem escrita). Após veri?cação da mensagem e a
con?rmação de saldo positivo no cartão SIM do cliente, é iniciado o carregamento do veiculo
elétrico. O inicio e o ?m de carregamento é noti?cado ao cliente através de uma SMS. Aquando
do término do carregamento, são enviados os dados do telemóvel e do consumo para a página
Web, que desenvolverá os grá?cos dos consumos do cliente.

Luísa Manuel de Sousa Pereira Azeredo Dissertação de Mestrado



20 3.Solução Proposta

Luísa Manuel de Sousa Pereira Azeredo Dissertação de Mestrado



Capítulo 4

Implementação do Posto de

Abastecimento

4.1 Arquitetura do Sistema

De acordo com a solução proposta, o equipamento a ser desenvolvido terá de possuir três
módulos essenciais: o módulo de controlo da passagem da corrente elétrica (Módulo 1), o
módulo da medição da energia (Módulo 2) e o módulo do envio e receção de mensagens e
dados para a página web (Módulo 3).

Todos os componentes a ser analisados têm em conta a existência destes no laboratório
onde se concretiza a elaboração deste projeto.

4.1.1 Módulo 1

Para este módulo surge a necessidade de procurar a melhor solução para o controlo da
passagem da corrente elétrica, uma vez que apenas se pretende que passe energia quando é
aprovado o carregamento do veículo. Para isso, existe por exemplo o relé mecânico e o triac.

Em comparação entre os dois, é possível veri?car algumas vantagens da utilização do triac
[IXYS]:

• É normalmente mais pequeno que o relé;

• Tem mais durabilidade uma vez que não tem partes em contacto que se degradam;

• Necessita de pouca energia para funcionar;

• Não tem interação magnética em comparação com o relé;

• Não gera ruído;

• É mais imune aos choques físicos e às vibrações.

• O relé não funciona corretamente com repetibilidades ou comutações num intervalo
reduzido de tempo;

21



22 4.Implementação do Posto de Abastecimento

Desta forma, é fácil concluir qual a melhor solução para o protótipo em questão. Uma
vez que o triac tem um menor desgaste e funciona melhor para repetições consecutivas, é sem
dúvida uma boa solução para um posto de abastecimento.

(a) Triac BT136 [NXP] (b) Relé da Omnron
[Omron]

Figura 4.1: Propostas para o Módulo 1.

4.1.2 Módulo 2

Neste módulo é necessário encontrar uma solução para o tratamento de dados para o cálculo
da energia. Por esse motivo, tem-se dois tipos de equipamentos que podem ser considerados
na implementação num posto de abastecimento: microcontroladores e PLC (Programmable
logic controller). As duas opções podem ser observadas na Figura 4.2.

Os microcontroladores são bastante semelhantes aos autómatos programáveis (PLC). Os
dois possuem memória interna para armazenarem os seus programas, ambos podem executar
autonomamente esses programas, estes são escritos em computador e, depois de compilados,
são transferidos para as suas memórias internas, ambos podem ter entradas e saídas elétricas:
digitais e analógicas, e os dois podem ter interfaces de comunicação do tipo Rs232, Rs485,
Ethernet,etc.

No entanto também existem diferenças, o PLC foi concebido para funcionar em ambientes
industriais e possui por isso proteções mecânicas e elétricas que os micro-controladores não
possuem. Contudo, os micro-controladores têm a seu favor um preço muito reduzido, uma
reduzida dimensão e um baixo consumo elétrico, enquanto que o PLC é exatamente o oposto.

Por esse motivo, conclui-se que o equipamento adequado para o tratamento de dados neste
módulo seria o micro-controlador, uma vez que se pretende desenvolver um equipamento de
baixo custo de implementação e de reduzidas dimensões.

Luísa Manuel de Sousa Pereira Azeredo Dissertação de Mestrado



4.Implementação do Posto de Abastecimento 23

(a) Microcontroladores da Micro-
chip [Microchip]

(b) PLC da Fatek [FATEK]

Figura 4.2: Propostas para o Módulo 2.

4.1.3 Módulo 3

Por último, é necessário encontrar a melhor solução para receber e enviar mensagens para
o telemóvel do cliente, bem como enviar os dados para a página web. Para isso, a melhor so-
lução seria a implementação de um sistema que pudesse desta forma realizar as duas operações.

Uma vez que o objetivo deste projeto é a implementação de postos de abastecimento em
qualquer parte do país, deve-se assim excluir qualquer hipótese que inclua ligação à Internet
por cabos, bem como a comunicação wireless para um router próximo. Assim, encontra-se
uma boa solução a utilização da comunicação GPRS/GSM. É uma tecnologia que utiliza o
cartão SIM do telemóvel, aumentando as taxas de transferência de dados nas redes GSM exis-
tentes. O GPRS combina o acesso móvel a serviços baseados em Protocolo IP, que utilizam a
transmissão de pacotes de dados que faz uso altamente e?ciente do espectro e permite alta velo-
cidade de dados. Fornece aos utilizadores maior largura de banda, tornando possível e rentável
permanecer constantemente ligado, bem como enviar e receber dados de texto, grá?cos e vídeo.

Para este tipo de comunicação, existe por exemplo a placa PIC-GSM produzida pela
Olimex (Figura4.3). Esta permite ter numa só placa um micro controlador e um módulo
GSM/GPRS. De seguida pode-se ver as suas principais especi?cações:

• Módulo GSM/GPRS de 900/1800/1900Mhz;

• Bateria de Li-ion;

• Microcontrolador PIC18f97J60;

• Conector RS232;

• Cristal de 20Mhz;

• Dois relays de 10A/250VAC;

• Duas entradas digitais;

• Entradas Analógicas.

Luísa Manuel de Sousa Pereira Azeredo Dissertação de Mestrado



24 4.Implementação do Posto de Abastecimento

Figura 4.3: Proposta para o Módulo 3

Desta forma, esta placa torna-se um bom sistema para implementar neste projeto, uma
vez que na mesma placa são concentrados dois módulos: Módulo 2 e Módulo 3, aproveitando
espaço no protótipo.

4.1.4 Conclusão

Após todos os equipamentos observados e das conclusões obtidas em cada módulo apre-
sentado, pode-se concluir que então se obtém no geral três módulos essenciais: Módulo 1
constituído pelo Triac para o controlo da passagem da energia elétrica; Módulo 2 constituído
pelo microcontrolador para medição da energia e controlo do seguinte módulo; e Módulo 3
constituído pelo Modem PIC-GSM da Olimex, para o envio da informação tanto para o tele-
móvel como para a Internet.

No esquema da Figura 4.4 é possível visualizar os principais componentes pensados para
este equipamento. Como foi referido anteriormente, o Modem PIC-GSM já contém um mi-
crocontrolador integrado, torna-se então oportuno a sua utilização para o Módulo 2, uma vez
que seria desnecessário a utilização de outro microcontrolador para o efeito, permitindo assim
uma redução no espaço do produto a desenvolver.

Dessa forma, faz-se a medição da energia e a comunicação por GSM/GPRS através no
mesmo microcontrolador. Pode-se também observar no esquema da Figura 4.4, que a comu-
nicação entre o microcontrolador e o modem GSM/GPRS é efetuada através de RS232, que
por sua vez comunica por TCP/IP para o envio de dados para a página Web e para a base de
dados, e por SMS(Comandos AT) para o telemóvel.

Esta solução permite, como foi referido anteriormente, ao utilizador consultar informações
relativo às ações realizadas nos postos de abastecimento, numa página web disponível em
qualquer equipamento com acesso à Internet.

Luísa Manuel de Sousa Pereira Azeredo Dissertação de Mestrado



4.Implementação do Posto de Abastecimento 25

Internet

Base de dados

Página WEB

           Modem GSM/GPRS

GSM/SMS

TCP/IP
MicrocontroladorRS232

Tensão

Corrente

L N

Módulo 3
Módulo 2

Módulo 1

V

A

Triac

Módulo Monitorização

Figura 4.4: Diagrama dos módulos existentes.

4.2 Módulo 1- Controlo da passagem da corrente elétrica

Para que o carregamento possa ser efetuado, tem de existir uma ordem por parte do mi-
crocontrolador, para que haja passagem ou corte de energia para o veículo. Para isso, foi
desenvolvido um pequeno módulo representado na Figura 4.5, que permite a passagem de
eletricidade para o equipamento a ser carregado. Essa instrução é feita por parte do micro-
controlador, através de uma saída ativa. Como foi referido anteriormente, para a ?nalidade
utilizou-se um esquema baseado num TRIAC.

O microcontrolador possui apenas uma alimentação de 3,3V DC, portanto este tem que
se manter isolado do TRIAC, uma vez que este tem tensões na ordem dos 230V AC. Para
esta ?nalidade foi utilizado um optoacopulador MOC3021[Source and Driver, 1995], que as-
segura que, mesmo em caso de sobrecarga de corrente elétrica, o resto dos componentes não
?quem dani?cados. Para fornecer a corrente necessária ao acionamento do MOC3021, é usado
um transístor BC547C[Semiconductors et al.] cuja base é controlada pelo microcontrolador.
Desta forma garante-se que chega corrente su?ciente ao optoacopulador.

Assim sendo, o microcontrolador liga-se à base do transístor, fazendo chegar corrente ao
díodo interno do optoacopulador. Por sua vez, este permite a passagem de energia para a
Gate do TRIAC, o qual fecha o circuito, fazendo com que a corrente chegue ao veiculo a ser
carregado. O TRIAC utilizado é o BT136[NXP]. Pode ser visualizado o esquema elétrico
deste módulo no Apêndice B.

Luísa Manuel de Sousa Pereira Azeredo Dissertação de Mestrado



26 4.Implementação do Posto de Abastecimento

Figura 4.5: Módulo 1 - Controlo da passagem da corrente elétrica.

4.3 Módulo 2 - Medição da Energia

Como foi referido anteriormente, neste módulo é abordado a medição da energia, bem
como o tratamento desses dados pelo microcontrolador. O microcontrolador utilizado, como
referido, é aquele que se encontra na placa PIC-GSM utilizada para o efeito.

Inicialmente, é feita a abordagem dos componentes utilizados para a medição da corrente
e da tensão, para o cálculo da energia utilizada. Esse tratamento de dados das medições é
então feita à posteriori pelo microcontrolador.

4.3.1 Medição da Corrente

Para a medição da corrente, optou-se por um transdutor de corrente. Estes funcionam
com base no princípio do Efeito de Hall (Figura 4.6). Na prática, a passagem de corrente num
condutor induz um campo magnético que é captado por um anel ferromagnético posicionado
em seu redor. Este mesmo anel apresenta uma interrupção em forma de fenda, na qual é
evidente a passagem do campo magnético induzido pelo condutor. Nesta mesma fenda é
então colocada uma barra de Hall, que é sujeita ao efeito do campo referido. Como resultado,
as suas cargas positivas e negativas posicionam-se em extremidades opostas, criando uma
diferença de potencial. [Farinha, 2009]

Figura 4.6: Efeito de Hall.[Electronics, 2014]

Luísa Manuel de Sousa Pereira Azeredo Dissertação de Mestrado



4.Implementação do Posto de Abastecimento 27

Para ser possível escolher o melhor transdutor de corrente para este protótipo, procedeu-
se à pesquisa de transdutores de corrente. Após a procura e uma análise de mercado, bem
como no laboratório, obteve-se duas soluções: o CSLA1CD da Honeywell(Figura 4.7(b)) e o
LTS15NP da LEM(Figura 4.7(a)). Estes sensores são de baixo custo monetário, o fazendo a
que o produto ?nal possa ser de baixo custo, que é um dos objetivos deste protótipo a ser
desenvolvido.

(a) Transdutor LTS15NP
[LEM, 2014a]

(b) Transdutor CSLA1CD
[Honeywell, 2014]

Figura 4.7: Comparação de transdutores

Na Tabela 4.1, pode-se observar algumas características de ambos os transdutores.

Tabela 4.1: Comparação entre transdutores de corrente

CSLA1CD LTS15NP

Medições de 0 a 57A Medições de 0 a 48A
Sensibilidade de 49,6mV/A Sensibilidade de 41,6mV/A

Medições de corrente AC ou DC
Linearidade e precisão

Capacidade de sobrecarga de corrente

Os dois transdutores são muito semelhantes a nível de características, diferenciando-se
essencialmente no nível da medição da corrente, fonte de alimentação e sensibilidade. Desta
forma, optou-se pelo sensor CSLA1CD por ter uma sensibilidade superior. Também se teve
em consideração as voltas que se podem dar em torno no sensor, uma vez que a sensibilidade
das suas medições aumenta consoante o número de voltas.

Para que o sinal proveniente do transdutor de corrente fosse ampli?cado e ?ltrado, foi
utilizado um ampli?cador de instrumentação da Analog Devices, o AD623. Este ampli?cador
é de baixo consumo energético, fácil de utilizar, possui uma elevada impedância de entrada,
baixa impedância de saída e permite ganhos de 1 a 1000. Este dispositivo tem também uma
característica importante para esta implementação, tem uma boa relação de rejeição em modo
comum (CMRR - Common Mode Rejection). Esta característica é importante uma vez que
os sinais medidos são de baixas tensões e o ruído pode afetar os resultados.[Analog, 2014].

O esquema representativo desta implementação pode ser observado na Figura 4.8. Relati-
vamente ao ampli?cador foi necessário proceder ao dimensionamento de alguns componentes,

Luísa Manuel de Sousa Pereira Azeredo Dissertação de Mestrado



28 4.Implementação do Posto de Abastecimento

na sua maioria resistências, para que as tensões à saída estivessem compreendidas entre os 0 e
os 5V. Como o sinal de saída do transdutor varia de forma sinusoidal, houve a necessidade de
colocar a linha dos 0V em torno dos 2,5V. Para isso introduziu-se um divisor resistivo entre o
GND e os 5V.

IP+4

IP-5
VIOUT 3

VCC 1

GND 2

U1

CSLA1CD

3

2
6

4
7

1 5
8

U2

AD623

R1
10k

R2
10k

R3
10k

5V

5V

R4
10k

R5
10k

L

L

R6
4.7k

C1
0.68uF

EXT2-10 (AN6)

Figura 4.8: Circuito representativo do tratamento dos sinais da corrente

O dimensionamento das resistências para o divisor resistivo foi efetuado de acordo com a
equação 4.1, em que V5=2,5V e Vcc=5V, ou seja R2=R3=10Kohms, como mostra a Figura 4.8.

V 5 = (
R3

R3 + R2
)V cc (4.1)

Sendo assim, com a utilização desses valores, conseguiu-se que a saída desse divisor resis-
tivo ?casse em 2,5V. Este Vout foi conectado ao pino 5 do AD623, denominado por Reference
Terminal, que tem como função de?nir a tensão de saída correspondente nula a fase, quando
não há corrente.

Para que o sinal fosse ampli?cado, de forma a ter uma melhor leitura das oscilações por
parte da ADC, aplicou-se um ganho de 11.

G =
100k

R1
+ 1 (4.2)

Luísa Manuel de Sousa Pereira Azeredo Dissertação de Mestrado



4.Implementação do Posto de Abastecimento 29

Por ?m, foi implementado um ?ltro passa-baixo, com o principal objetivo de eliminar
algum ruído existente no sinal. Para isso foi considerada uma frequência de corte de 50Hz,
resultando numa resistência (R6) de 4,7kohms e um condensador(C1) de 0,68uF.

fc =
1

2.?.R6.C1
(4.3)

O fabricante do sensor de Hall implementado, indica na sua folha de características, qual a
tensão que o sensor apresenta na sua saída em função da corrente que o percorre. No entanto
estes valores foram obtidos enquanto o sensor de Hall era alimentado a 12V DC, com o obje-
tivo de reduzir o número de fontes de alimentação e poupar recursos, o sensor foi alimentado
a 5V DC. Para aumentar a sensibilidade do sensor, enrolou-se o ?o em volta do sensor, com
4 voltas. Com esta alimentação é necessário calibrar o sensor. Essa calibração foi elaborada
medindo com o multímetro em modo amperímetro, em fase, e medindo ao mesmo tempo a
tensão na entrada analógica do microcontrolador, em debug, corrigindo os seus valores. Essa
calibração vai ser explicada mais a frente neste capítulo.

4.3.2 Medição da Tensão

De seguida é feita a descrição de como foi feita a leitura da tensão que passa para o equipa-
mento. Uma vez que o equipamento é alimentado a uma corrente alternada com uma tensão
e?caz de cerca de 230V, torna-se necessário converte-la para valores consideravelmente mais
baixos.

Para isso, à semelhança da medição da corrente, foi utilizado um transdutor de tensão por
efeito de hall. O transdutor utilizado para o efeito foi o LV25-P (Figura 4.9) fabricado pela
LEM. Na tabela são apresentadas as suas características.

Tabela 4.2: Características do transdutor LV25-P

LV25-P

Excelente precisão
Muito boa linearidade

Rápido tempo de resposta
Grande imunidade a interferências exteriores

Este sensor suporta tensões de entrada entre os 10 e os 500V, e possui isolamento galvânico
entre o circuito primário e o secundário, o que se adequa para este projeto. Como este sensor
foi alimentado a 12V, foi necessário dimensionar a resistência de medida, R1, de modo a que
a corrente no primário não ultrapasse os 10mA (Figura 4.9(a)). Na documentação do sensor
sugerem-se valores da resistência de saída, Rm, entre os 30 e os 190 ?, e depois de alguns
testes efetuados chegou-se a um valor para a resistência de saída , Rm, na ordem dos 100?.
No que diz respeito à resistência do primário, foram utilizadas as informações presentes na
documentação do transdutor, onde sugerem que para uma corrente máxima de 10mA a resis-
tência do primário R1 deverá ser igual a 25k?/2.5W. No entanto, depois de efetuadas algumas

Luísa Manuel de Sousa Pereira Azeredo Dissertação de Mestrado



30 4.Implementação do Posto de Abastecimento

(a) Esquema da ligação (b) Transdutor

Figura 4.9: Transdutor de tensão LV25-P da LEM [LEM, 2014b]

medições, concluiu-se que para a resistência a relação 27k?/2.5W seria mais adequada.

Na ?gura 4.10, pode ser analisado o circuito elaborado para o tratamento de dados do
transdutor de tensão. À semelhança do transdutor de corrente, neste também foi imple-
mentado um ampli?cador operacional para o tratamento de sinal. Recorreu-se a um divisor
resistivo com V5 conectado ao pino 5 (Reference Terminal) do AD623 para que a linha dos
0V ?casse aproximadamente nos 2.5V, pois o sinal recebido é de forma sinusoidal.

Para os cálculos dessas resistências utilizou-se a equação 4.4, em que com um Vcc de 5V,
pode-se obter para as resistências valores iguais, ou seja R2=R3=10k?.

V 5 = (
R2

R3 + R2
)V cc (4.4)

Para este ampli?cador não foi necessário colocar qualquer tipo de resistência de ganho
(Rg). E como é referido na documentação do AD623, G=1 quando não há utilização de Rg.

Para a redução de ruído existente nos sinais de tensão, foi instalado um ?ltro passa-baixo
com uma frequência de corte de 50Hz, calculada a partir da equação 4.5.

fc =
1

2.?.R6.C1
(4.5)

Foram ainda utilizados dois dispositivos, ICL7660A e TL7660, para converter tensão po-
sitiva para negativa, 12V e 5V respetivamente.

Luísa Manuel de Sousa Pereira Azeredo Dissertação de Mestrado



4.Implementação do Posto de Abastecimento 31

3

2
6

4
7

1 5
8

U1

AD623

R1
10k

R2
10k R3 10k

R4
10k

5V

R5
10k

C1

10uF

C2
10uF

5V

EXT-25 (AN2)

CAP+2

CAP-4

GND 3

V+ 8

VOUT 5LV6
OSC7

U4

ICL7660A

CAP+2

CAP-4

GND 3

V+ 8

VOUT 5LV6
OSC7

U2

TL7660

C3
1uF

12V

R6
10k

C4
1uF

+HT4

-HT5 - 2
Out 3

+ 1

12V

LV25-P

R7
27k

RM
100 C5

0.33uF

Figura 4.10: Circuito representativo do tratamento dos sinais da corrente

4.3.3 Microcontrolador

O microcontrolador que se encontra na placa PIC-GSM é o Pic18F97J60 , que tem as
especi?cações necessárias ao projeto,uma vez que é um componente bastante completo, tendo
como principais características[Technology, 2006]:

• 16 Canais conversores Analógico-Digitais (A/D);

• Dois módulos UART (RS232);

• 5 Módulos Timer (Timer 0 a Timer4);

• Duas portas com capacidade de suportar SPI e I2C com modo Master e Slave.

No entanto, como o microcontrolador já se encontra montado na placa, apenas se pode
utilizar os pinos disponíveis para o efeito desejado. Segundo o documento de apoio ao PIC
GSM [OLIMEX, 2008], o módulo GSM encontra-se conectado na segunda UART do micro-
controlador, sendo esta a utilizada para a comunicação. E para fazer as leituras da medição
da energia, são assim utilizadas as entradas analógicas disponíveis na placa para o microcon-
trolador.

Luísa Manuel de Sousa Pereira Azeredo Dissertação de Mestrado



32 4.Implementação do Posto de Abastecimento

Figura 4.11: Esquema geral do microcontrolador

Como foi abordado anteriormente, as entradas utilizadas para o efeito foram representadas
nos esquemas elétricos.Ou seja, a leitura da tensão e da corrente são efetuadas através das
entradas analógicas do microcontrolador (ADC). A tensão pela AN2 (Ext1-25) e a corrente
pela AN6 (Ext2-10).

Após a elaboração dos circuitos para a receção de dados da corrente e da tensão, é necessá-
rio tratar os dados recebidos, convertê-los para valores reais e calcular as grandezas necessárias.
Para isso, de seguida é feita uma ligeira abordagem sobre as grandezas envolvidas, bem como
é feito o tratamento dos dados.

Grandezas associadas

A potência de um sinal, qualquer que ele seja, é uma grandeza que determina a quantidade
de energia transferida por uma fonte por unidade de tempo. No caso da potência elétrica ins-
tantânea (Pinst), o seu valor é calculado com base no produto das duas grandezas envolvidas:
tensão elétrica(v(t)) e corrente elétrica(i(t)). No caso particular do sistema elétrico de energia,
os dispositivos são alimentados por uma corrente alternada. Assim, a corrente e tensão de
alimentação possuem uma forma de onda sinusoidal com uma frequência de 50 Hz. A potên-
cia elétrica instantânea de um equipamento alimentado através da rede elétrica é também um
sinal com uma forma sinusoidal mas com o dobro da frequência.

Pinst(t) = v(t) ? i(t) (4.6)

A energia de um sinal pode ser de?nida como o somatório do valor da potência instantânea
do sinal.

E =

? ?
?

P(t) dt (4.7)

Luísa Manuel de Sousa Pereira Azeredo Dissertação de Mestrado



4.Implementação do Posto de Abastecimento 33

Quando a impedância associada aos dispositivos é puramente resistiva, então toda a ener-
gia consumida corresponde à energia transformada, por exemplo em luz, calor, etc.

Por vezes a impedância da carga contém uma componente reativa, que pode ser indutiva
ou capacitiva. Este facto conduz a um desfasamento entre os sinais de corrente e tensão, que
será tanto maior quanto maior for a razão da componente reativa pela resistiva. O desfasa-
mento introduzido entre a tensão e corrente leva a que em determinados momentos o sentido
de circulação da corrente seja contrário à queda de tensão nos terminais da carga, nesses ins-
tantes a carga devolve energia à rede. Assim, a existência das componentes reativas levam ao
aparecimento de uma energia que oscila na rede entre a carga e o gerador. Este facto tem
como consequência o aparecimento de três tipos de potência associadas, são elas, potência
aparente, potência ativa e potência reativa (Figura 4.12).

Figura 4.12: Potências.

Derivado ao facto da existência destes três tipos de potência pode-se de?nir o conceito
de fator de potência. O fator de potência é razão da potência ativa pela potência aparente,
tratando-se por isso, de um número adimensional entre 0 e 1. Este fator é de?nido pelo tipo
de carga, podendo esta ser resistiva, indutiva ou capacitiva e designa-se por cos(?).

A potência aparente (S) é aquela que é efetivamente disponibilizada pela rede, sendo as
suas unidades o VA (Volt-Ampere). Assim o módulo da potência aparente no sistema elétrico
pode ser obtido a partir do produto entre os valores e?cazes de tensão elétrica (Vef ) e a cor-
rente elétrica (Ief ).

|S| = Vef ? Ief (4.8)

A potência ativa (Pact) é a potência utilizada pelas cargas para realizar o trabalho de
gerar calor, luz e é expressa em W (Watt). Pode-se descrever a potência ativa como o valor
médio da potência absorvida. Alternativamente a potência ativa pode ainda ser de?nida como
o produto entre a potência aparente e o fator de potência:

P = Vef ? Ief ? cos(?) (4.9)

Desta forma é possível efetuar a medição da energia, com o valor da tensão e corrente
obtidos através das entradas analógicas.

Leitura da ADC

O programa desenvolvido para a medição da energia, utiliza uma rotina de serviço à in-
terrupção, que é "chamada"sempre que existe receção de dados pela porta série pelo modem

Luísa Manuel de Sousa Pereira Azeredo Dissertação de Mestrado



34 4.Implementação do Posto de Abastecimento

GSM, ou seja, sempre que é recebida uma mensagem enviada pelo utilizador(SMS). Quando
recebe a SMS, é acionada a saída corresponde ao triac, para passar a energia para o equi-
pamento. Depois procede-se à medição da corrente e da tensão, através de duas entradas
analógicas. Essa medição é feita apenas enquanto estiver ligado o equipamento, e o equipa-
mento apenas está ligado enquanto estiver a contar a energia pedida pelo utilizador através
da mensagem.

Uma vez que os valores da corrente e da tensão não vêm corrigidos, é necessário converter
os valores de entrada (na gama dos 5V) para valores de aproximadamente 230V (no caso da
tensão) ou para aproximadamente 0,43V (no caso da corrente), uma vez que a calibração foi
realizada com uma lâmpada de 100W aproximadamente.

Por isso, foi necessário obter várias amostras de medição, tanto para a corrente como para
a tensão, para encontrar o fator de conversão. Após se estabelecerem os valores indicados com
um erro bastante reduzido, procedeu-se à medição.

No ?uxograma da Figura 4.13, é possível observar o ciclo feito para se proceder à medição.
Inicialmente, memoriza-se a Energia que está escrita na mensagem que o cliente enviou para
o equipamento, depois dá-se o inicio da contagem do Timer. Quando o cálculo da energia
(Equação 4.7) estiver igual ou superior à energia enviada pela mensagem, desliga-se o timer
(contagem do tempo) e desliga-se o Triac (para não passar mais energia para o veículo, neste
caso a lâmpada). Se a energia consumida for inferior é feito de novo a medição para o cálculo
da potência. Após este processo, os valores de todas as variáveis envolvidas são postas a zero,
para estarem preparadas para uma nova medição.

A calibração da medição das grandezas foi feita utilizando a lâmpada, como já foi referido
anteriormente, e um osciloscópio. Fez-se a leitura no microcontrolador em debug, utilizando o
software MPLAB IDE v8.91, que permite assim fazer diferentes medições com a variação do
tempo. Os valores foram corrigidos e calibrados consoante os valores que davam no osciloscó-
pio.

O MPLAB é um software destinado a desenvolver aplicações para microcontroladores fa-
bricados pela Microchip, como neste caso o PIC18F97J60. Este ambiente de desenvolvimento
permite a edição, o debugging e programação do microcontrolador. Relativamente ao código
fonte, este pode ser escrito em linguagem C ou em assembly, sendo que nesta dissertação foi
utilizada a primeira. Uma das principais vantagens do MPLAB é a possibilidade de visua-
lização dos registos na memória do programa utilizando o modo do debug, o que facilita o
desenvolvimento do código fonte, e da calibração de grandezas como o caso da tensão e da
corrente.

Resumidamente, ligou-se a lâmpada e solicitou-se uma aquisição de dados ao hardware.
Depois do microcontrolador converter os dados adquiridos pelos transdutores de corrente e
tensão numa sequência binária (digital) proporcional aos sinais de entrada (analógicos), foi
necessário proceder a uma análise dos resultados obtidos de forma a criar uma relação entre
os mesmos e os valores dados pelo osciloscópio. Após essa medição, procedeu-se à calibração
dos dados, para na próxima medição se obter valores considerados reais de tensão e corrente.

Luísa Manuel de Sousa Pereira Azeredo Dissertação de Mestrado



4.Implementação do Posto de Abastecimento 35

Inicio da leitura

Memorização da 
energia da SMS

Medição da 
voltagem (AN2)

Medição da 
corrente (AN6)

Cálculo da  Potência 
Instantânea

Energia consumida 
= Energia da SMS?

Início do Timer

Não

SIM
Stop

 Timer
Desliga a  Energia 

(RB5=0)

Figura 4.13: Ordem de leitura das entradas analógicas.

Luísa Manuel de Sousa Pereira Azeredo Dissertação de Mestrado



36 4.Implementação do Posto de Abastecimento

Através disto e depois dos dados adquiridos se encontrarem nas unidades de volts e ampe-
res, é então possível proceder ao cálculo da potência a partir da equação 4.9, em que o ? é o
ângulo de fase entre a onda da tensão e a onda da corrente. Este é calculado entre a diferença
dos índices correspondentes aos valores máximos de cada onda nos respetivos arrays.

4.4 Módulo 3 - Modem GSM/GPRS

Para a interação com este módulo, o microcontrolador integrado na placa está conectado
através da sua UART, por uma comunicação por RS232. Para a comunicação funcionar sem
problemas, precisa de ter umas características especi?cas:

• Baudrate de 115200bps;

• Possui um cristal de 25Mhz;

De seguida é feita a divisão entre as duas comunicações realizadas pela mesma UART:
Comunicação RS232 para a comunicação para o envio e receção de SMS, e a comunicação
TCP/IP para o envio de dados para a base de dados.

Como foi referido anteriormente, para a comunicação ser efetuada, colocou-se uma inter-
rupção para que se espere por uma SMS no terminal, para que depois de todas as condições
estarem satisfeitas, possa através de uma das suas saídas ligar o Triac para proceder ao car-
regamento do veículo elétrico.

4.4.1 Comunicação RS232

Como foi referido anteriormente, a medição da energia é desencadeada por uma SMS
enviada pelo utilizador. Para que seja possível a interação do microcontrolador com o modem
GSM, tem de haver comunicação com comandos AT pela porta série.

Neste equipamento foram utilizados os comandos AT disponíveis na Tabela 4.3. Para exis-
tir uma boa comunicação entre o microcontrolador e o modem GSM/GPRS, foi necessário
efetuar uma máquina de estados em que, apenas se transita para o estado seguinte quando
existe a con?rmação do envio do comando respetivo, continuando a ler os restantes estados.

Tabela 4.3: Comandos AT para envio e receção de SMS.

Comandos AT Designação

AT Veri?cação de conexão com o modem GSM

AT+CMGF=1
Con?gura o módulo GSM/GPRS para que
as mensagens sejam apresentadas em for-
mato de texto.

AT+CMGS="numero?mensagem&gt;
Permite o envio de mensagens de texto
para o número de telemóvel indicado.

AT+CMGL="ALL" Mensagens recebidas

AT+CMGR=1
Permite ler a mensagem recebida, que se
encontra na posição 1.

AT+CMGD=1 Apaga a mensagem que esta na posição 1.

Luísa Manuel de Sousa Pereira Azeredo Dissertação de Mestrado



4.Implementação do Posto de Abastecimento 37

No diagrama da Figura 4.14, é possível visualizar uma comunicação entre o microcon-
trolador e o modem GSM/GPRS, no caso de um cliente enviar uma SMS para o posto de
abastecimento e a SMS estar bem escrita, ou seja, proceder ao carregamento.

MicrocontroladorMicrocontrolador Módulo GSM

 AT&amp;lt;CR&gt;

OK

ATE0&amp;lt;CR&gt;

OK

AT+CMGF=1&amp;lt;CR&gt;

OK

AT+CMGR=1&amp;lt;CR&gt;

OK

+CMGR: "REC UNREAD"/"+351*********"//"yy/mm/dd/hh:mm:ss+ss"..MMMM....OK.

AT+CMGS="+351*********"&lt;CR&gt;&lt;CR&gt;"O carregamento de:MMMM kwh vai ser efetuado. Obrigado.&amp;lt;CR&gt;&amp;lt;0x1A&gt;

OK

AT+CMGS="+351*********"&lt;CR&gt;&lt;CR&gt;"O carregamento foi efetuado com sucesso. Obrigado.&amp;lt;CR&gt;&lt;0x1A&gt;

OK

AT+CMGDA="del all"&amp;lt;CR&gt;

OK

ciclo

Figura 4.14: Diagrama de envio/receção de SMS com carregamento.

Como foi referido no ?uxograma da Figura 3.2, a mensagem a ser enviada aquando do iní-
cio e do ?m de carregamento, é apenas quando se inicia ou termina a medição. Essa instrução
é dada pelo microcontrolador.

No caso de o cliente enviar uma mensagem para o posto de abastecimento com a ordem de
escrita errada, a ordem dos comandos altera-se ligeiramente. O diagrama pode ser observado
na secção do Apêndice A (Figura A.2). No entanto, se ninguém enviar mensagem para o
posto de abastecimento, este vai ter a mesma ordem de comandos sempre que se inicia o
equipamento, que se pode também analisar no Apêndice A (Figura A.1).

4.4.2 Comunicação TCP/IP

Esta comunicação é realizada para enviar os consumos para a base de dados. Para isso, o
cartão SIM presente no módulo tem de ter um tarifário associado que permita não só o envio
de SMS, como também o acesso à Internet.

Luísa Manuel de Sousa Pereira Azeredo Dissertação de Mestrado



38 4.Implementação do Posto de Abastecimento

Neste processo, a comunicação com o microcontrolador continua a ser por RS232, usando
a mesma UART que as comunicações anteriores. No entanto, os comandos AT usados para
esta comunicação TCP/IP são diferentes. Na tabela 4.4 pode-se veri?car os comandos AT
utilizados para esta comunicação.

Tabela 4.4: Comandos AT para a comunicação TCP/IP

Comandos AT Designação

AT+CIPSTATUS Veri?cação de Estado de ligação TCP/IP
AT+CIPSPRT=1 Indicação de envio de dados
AT+CDNSORIP=0 Veri?cação do modo de comunicação
AT+CIPSRIP=1 Indicação de visualização de IP e porta do

envio aquando da receção
AT+CIPHEAD=1 Adicionar um IP head aquando da receção

de dados
AT+CGDCONT=1,"IP","site da rede" Adiciona os parâmetros do tipo PDP

AT+CSTT="APN","utilizador","palavra
passe"

Fazer a ligação ao APN indicado, introdu-
zindo o utilizador e palavra passe necessá-
rio para o registo.

AT+CIICR Fazer a ligação de dados GPRS.

AT+CIFSR
Pede à rede que atribua ao módulo
GSM/GPRS um IP local

AT+CIPSTART="TCP","IP","PORTA"

Ligação de dados com o protocolo
TCP/IP, ao computador com o endereço
IP indicado e porta pela qual será feita a
ligação.

AT+CIPSEND&amp;lt;mensagem&gt; Enviar a mensagem para onde se pretende
AT+CIPSHUT Desligar a ligação GPRS em curso

A ordem de envio dos comandos AT para o modem GSM pode ser analisado na Figura
4.15. Tal como no envio da SMS, neste caso também é necessário ter uma máquina de estados
para o envio de cada comando, para que seja possível um correto envio de dados.

Este envio de dados para a base de dados é feita através do IP da página Web com código
php associado. Desta forma, são inseridos no url o valor da energia consumida e o telemóvel
associado. Ou seja, IP/teste.php?ener=...&amp;amp;ph=..., em que "ener"e "ph"são os dados que se
pretende inserir na base de dados, energia e telefone respetivamente.

Como se pode analisar no ?uxograma, a resposta do envio de diversos comandos AT é
"OK". Se esta resposta não for satisfeita, o microcontrolador volta a enviar o comando até
que seja essa a resposta. Uma vez que, se a ordem de envio e receção de comandos não for a
representada no ?uxograma, esta comunicação não é bem efetuada.

Luísa Manuel de Sousa Pereira Azeredo Dissertação de Mestrado



4.Implementação do Posto de Abastecimento 39

MicrocontroladorMicrocontrolador Módulo GSM

 AT+CIPSTATUS&lt;CR&gt;

OK&lt;CR&gt;STATE: IP INITIAL

AT+CIPSPRT=1&lt;CR&gt;

OK

AT+CDNSORIP=0&lt;CR&gt;

OK

AT+CIPSRIP=1&lt;CR&gt;

OK

AT+CIPHEAD=1&lt;CR&gt;

OK

AT+CGDCONT=1,"IP","internet.vodafone.pt"&lt;CR&gt;

OK

AT+CSTT="internet.vodafone.pt","guest","guest"&lt;CR&gt;

OK

AT+CIICR&lt;CR&gt;

OK

AT+CIPSTATUS&amp;lt;CR&gt;

OK&amp;lt;CR&gt; STATE: IP GPRSACT

AT+CIFSR&amp;lt;CR&gt;

**.**.**

AT+CIPSTATUS&amp;lt;CR&gt;

OK&amp;lt;CR&gt; STATE: IP STATUS

AT+CIPSTART="TCP","193.137.172.23","80"

OK&amp;lt;CR&gt; CONNECT OK

AT+CIPSEND&amp;lt;CR&gt; GET /teste.php?ener=MMMM&amp;amp;ph=*********&lt;CR&gt;Host:193.137.172.23&lt;CR&gt;

SEND OK 

AT+CIPSHUT&amp;lt;CR&gt;

SHUT OK

Figura 4.15: Diagrama do envio de dados para a página web

Luísa Manuel de Sousa Pereira Azeredo Dissertação de Mestrado



40 4.Implementação do Posto de Abastecimento

4.5 Síntese protótipo

Após a implementação de todo o hardware envolvido, e da programação do microcon-
trolador existente, é possível assim elaborar o ?uxograma síntese do funcionamento deste
protótipo. Como se pode visualizar na Figura 4.16, para além da mensagem enviada para
o cliente aquando do inicio e do ?m do carregamento, também são ativados dois led's: led
verde quando se inicia o carregamento, e led vermelho quando termina o carregamento. Este
protótipo permite também ao utilizador aceder à página Web, explicada no capítulo seguinte.

Início

Espera pelo envio 
da mensagem
pelo utilizador

“CARR ****” ?

Inicio do 
Carregamento 

Permissão do Triac

Sim

Envio de mensagem ao 
cliente de Inicio de 

carregamento

Fim de 
carregamento. 

Envio de mensagem ao 
cliente de Fim de 

carregamento

Acendeu Led 
Verde

Acendeu Led 
Vermelho

Envio de dados por 
TCP/IP para a base 

de dados

Fim de processo

Elaboração de 
gráficos na página 

Web

Envio de mensagem ao 
cliente de erro na escrita

Não

Figura 4.16: Diagrama do processo do carregador

Luísa Manuel de Sousa Pereira Azeredo Dissertação de Mestrado



4.Implementação do Posto de Abastecimento 41

Na Figura 4.17 e na Figura 4.18 é possível visualizar o protótipo desenvolvido por fora e
por dentro, respetivamente. Como se pode observar na primeira ?gura, possui os leds mencio-
nados anteriormente, a ?cha para o carregamento de um dispositivo (neste caso para a ligação
da lâmpada) e o logótipo do equipamento. Este foi inteiramente elaborado pelo autor desta
dissertação, com inspiração nas formas e cores relacionadas com o meio ambiente e com as
energias renováveis. O nome do logótipo deriva de Electric Charger, daí o nome "E.Charger",
uma vez que consiste num carregador elétrico.

Figura 4.17: Prototipo - Vista exterior

Na segunda Figura (4.18) é então possível visualizar todos os componentes na caixa. Exem-
pli?cando a placa PIC-GSM da Olimex, com o cartão SIM necessário para envio ou receção de
mensagens e troca de dados; o módulo Triac; e duas placas brancas que constituem os outros
componentes mencionados anteriormente.

Como foi referido, trata-se de um protótipo experimental, necessitando de melhorias na
caixa e organização de diversos equipamentos.

Na Figura 4.19 é possível visualizar dois testes elaborados no protótipo. Do lado esquerdo
(a) pode ser visualizada a resposta do protótipo a uma mensagem com caracteres distintos e
a respetiva resposta; do lado direito (b) pode ser visualizada o envio de uma mensagem com
a ordem pretendida no protótipo e a respetiva resposta.

Luísa Manuel de Sousa Pereira Azeredo Dissertação de Mestrado



42 4.Implementação do Posto de Abastecimento

Figura 4.18: Prototipo - Vista interior

(a) Envio de mensagem errada (b) Envio de mensagem correta

Figura 4.19: Teste de envio de mensagem para o protótipo.

Luísa Manuel de Sousa Pereira Azeredo Dissertação de Mestrado



Capítulo 5

Implementação do Sistema de

Monitorização

Neste capítulo é desenvolvido o módulo correspondente à Monitorização do posto de abas-
tecimento (Figura 5.1). Este módulo é constituído pela base de dados MySQL gerida através
do phpMyAdmin, bem como a página web desenvolvida em HTML5.

Para a ativação da base de dados e da página web foi utilizado o Xampp. Este é um pacote
de servidores no qual se encontra o servidor Web Apache, o servidor de base de dados MySQL
e um interpretador de PHP, entre outros. Esta é uma aplicação bastante útil no desenvolvi-
mento de aplicações Web e não necessita de licença de utilização.

Internet

Página WEB

Apache

PHP

HTML5

Figura 5.1: Módulo da Monitorização

43



44 5.Implementação do Sistema de Monitorização

5.1 Base de dados MySQL

O MySQL é um sistema de gestão de bases de dados, que permite gerir bases de da-
dos com um elevado número de registos de uma forma rápida e e?ciente. Para além disso é
facilmente integrado com linguagens de programação como é o caso do Visual Basic ou o PHP.

Na base de dados foram criadas duas tabelas essenciais: a tabela dos consumos totais do
posto (Tabela "Energia") e a tabela de registo dos clientes do posto (Tabela "Registo"). A
base de dados criada pode ser observada na Figura 5.3.

A tabela "Energia"tem como variáveis a "phoneenergia"do tipo int(250) e a "energy"do
tipo int(250) que são os dados recebidos por TCP/IP pelo Módulo 3. Estes dados são inseridos
na tabela através de código desenvolvido em PHP ("teste.php").

Como foi referido anteriormente, os dados a ser submetidos na base dados são enviados
através de um url (teste.php?ph=123456789&amp;amp;ener=100), em que o ?cheiro PHP os vai inserir
na base de dados através do código abaixo (Figura 5.2).

Figura 5.2: Código PHP para inserção de valores na base de dados.

Desta forma, os valores do telefone (ph - phoneenergia) e os da energia (ener - energy) são
introduzidos na tabela "Energia".

Energia

phoneenergi a (int(250))

energy (int(250))

date (timestamp)

Registo

name (varchar(250))

mail (varchar(250))

phone (varchar(250))

date (varchar(250))

pass (varchar(250))

Figura 5.3: Estrutura da base de dados.

A variável "date"que é do tipo timestamp, é automaticamente inserida aquando da entrada
dos valores na tabela. Esta variável indica a data e a hora do carregamento efetuado.

Luísa Manuel de Sousa Pereira Azeredo Dissertação de Mestrado



5.Implementação do Sistema de Monitorização 45

A tabela "Registo"consiste numa base de dados dos clientes que se queiram registar na
página Web para ter acesso aos seus consumos. Então, a tabela contém como variáveis o
nome ("name"), e-mail ("mail"), número de telefone ("phone") que deve ser o mesmo que foi
utilizado no carregamento, a data de nascimento ("date") pois apenas permite a utilizadores
com idade acima dos 18 anos, e a palavra pass ("pass") que permite depois ao cliente aceder
à sua página de consumos com con?dencialidade. Nesta tabela foi logo inserido o per?l de
administrador(nome:admin, mail:admin@ua.pt) para posteriormente ser permitido o acesso à
página Web.

De seguida, vai-se veri?car que na elaboração da página Web foi tido em conta algumas
restrições, como não ser permitido o registo de dois ou mais clientes com o mesmo número de
telemóvel ou com o mesmo e-mail.

5.2 Página WEB

Como foi referido anteriormente, para o auxílio deste produto, torna-se vantajoso conter
uma página WEB que permita ao utilizador consultar os consumos e os seus abastecimentos
nos postos associados. Esta página foi desenvolvida utilizando a linguagem HTML5.

O HTML5 é a quinta versão da linguagem HTML. Esta versão traz consigo importantes
mudanças quanto ao papel do HTML no mundo da Web, através de novas funcionalidades
como semântica e acessibilidade [HTML5] e com novos recursos, antes só possíveis com re-
curso a outras tecnologias. Esta linguagem permite que a página possa ter acesso através de
computadores comuns, bem como por dispositivos móveis.

Desta forma, foi criada uma página bastante intuitiva, que permite a qualquer utiliza-
dor consultar onde se situam os respetivos postos de abastecimento,como também permite
o registo de cliente, para que seja possível a análise dos consumos associados ao número de
telemóvel. Nesta página foram criadas 5 secções/separadores (Home, Login, Registar, Sobre
e Contacto) que se pode visualizar na Figura 5.5. Estes separadores podem ser visualizados
em toda a página do E.Charger, para que seja possível navegar com facilidade. Foi elaborado
também um ícone da marca deste protótipo, para que valorize esta pagina web esteticamente,
que pode ser visualizada no separador do browser em que se está a navegar (Figura 5.4).

Figura 5.4: Ícone da página.

A página "Home"é a página principal deste posto de abastecimento. Na Figura 5.5 pode
ser observada essa página, onde os quadrados sombreados a vermelho signi?cam as partes ?-
xas de toda a página Web, e o quadrado verde o que muda à medida que se muda de separador.

Neste separador, é permitido ao utilizador consultar através de um mapa interativo, os
postos de abastecimento existentes. Este mapa é obtido através de uma API da Google Maps
JavaScript. É utilizada a versão 3 da API que foi desenvolvida especialmente para ser mais

Luísa Manuel de Sousa Pereira Azeredo Dissertação de Mestrado



46 5.Implementação do Sistema de Monitorização

Figura 5.5: Página principal E.Charger.

Luísa Manuel de Sousa Pereira Azeredo Dissertação de Mestrado



5.Implementação do Sistema de Monitorização 47

rápida e apresentar mais compatibilidade com dispositivos móveis e também com aplicações
Web tradicionais em computadores.

A Google Maps JavaScript API V3 é um serviço gratuito, disponível para qualquer site
que o público possa usar gratuitamente. [Developers] A utilização desta API permite então,
apresentar aos utilizadores a localização dos postos de abastecimento existentes.

Na página "Registo", permite a um utilizador novo o registo no site. Como se pode visu-
alizar na Figura 5.6, esta secção pede os seguintes dados:

• Nome;

• Número de Telefone - apenas permite a inserção de nove dígitos, não permitindo letras;

• Data de nascimento - personalizada para apenas inserir datas válidas a partir de 18 anos;

• E-mail - apenas permite inserir e-mails com um caracter @ e um ponto (.);

• Password - permite ao utilizador gravar os dados ocultos.

Após as caixas de texto, esta página contém dois botões: o botão Apagar permite limpar
todas as caixas de texto até aí preenchidas; o botão Enviar envia todos os dados até aí pre-
enchidos para a base de dados criada para o efeito. Antes de serem enviados os dados para
a base de dados, é veri?cado se já existe algum cliente registado com o mesmo número de
telefone ou com o mesmo e-mail.

No ?nal, se o registo foi bem efetuado, mostra ao utilizador uma caixa de aviso (Figura
5.7) que informa o utilizador que o registo foi bem efetuado, e que após o clique no botão OK,
o encaminha para a página Home. Se o registo não for bem sucedido (no caso de já existir o
mesmo número de telefone ou o mesmo mail), aparece ao utilizador uma caixa idêntica à da
Figura 5.7, mas a informar que não foi bem efetuado, e encaminha de novo para a página de
Registo.

Na página do Login, existe o formulário de entrada para a página dos consumos. Se o
Login for efetuado pelo cliente que efetuou registo previamente, ao inserir o seu e-mail e a sua
password, terá acesso aos consumos efetuados pelo número de telemóvel que está associado a
este registo. Se o Login for efetuado pelo administrador da página, ao inserir as credenciais de
administrador (admin), este encaminha para a página que demonstra os consumos efetuados
no posto E.Charger, bem como os consumos dos clientes.

Como se pode visualizar na Figura 5.9, é pedido o E-mail e a password. Antes de ser feito
o Login, são veri?cadas duas restrições: primeiro se existe um Login com o email inserido,
e segundo se o email e a password estão corretas, através da base de dados. Se ambas não
estiverem corretas, ao fazer Login aparece uma caixa de aviso, como a da Figura 5.7, mas a
mencionar que o Login não foi efetuado.

Luísa Manuel de Sousa Pereira Azeredo Dissertação de Mestrado



48 5.Implementação do Sistema de Monitorização

Figura 5.6: Pagina para fazer registo.

Figura 5.7: Caixa de aviso de registo efetuado.

Na Página "Cliente", aparece, como já foi referido, um grá?co com os consumos efetuados
no posto E.Charger, associado ao Login efetuado. Para uma melhor visualização, é colocado
o número associado aos consumos do cliente.

O grá?co que se pode visualizar na Figura 5.8 é elaborado através de uma API da Google.
Como foi referido anteriormente, essa API disponibiliza gratuitamente grá?cos base possíveis
de manipular. Neste caso, foi criado um grá?co de barras com valores provenientes da base de
dados, que permite saber ao certo o valor do consumo do cliente em Ws, com a data em que
fez o consumo. Os valores estão em Ws (watts segundo), uma vez que os testes elaborados
com a lâmpada, tinham duração curta, não chegando a obter consumos de unidades de kwh
(quilo watt hora). Tem ainda a possibilidade de con?rmar o valor referentes a cada barra,
passando o ponteiro por cima, uma vez que salienta o valor ali estimado. Este tipo de grá?cos
permite alterar o estilo (barras, linhas, circular) e as cores (por exemplo).

Nesta página, pode-se também observar um botão de LogOut que permite ao utilizador
terminar sessão, voltando para a página Home, bem como permite ao utilizador ver o número

Luísa Manuel de Sousa Pereira Azeredo Dissertação de Mestrado



5.Implementação do Sistema de Monitorização 49

de telefone associado aos consumos do grá?co.

Figura 5.8: Pagina do cliente

Luísa Manuel de Sousa Pereira Azeredo Dissertação de Mestrado



50 5.Implementação do Sistema de Monitorização

Figura 5.9: Pagina para fazer Login.

Na página de Administrador, pode-se visualizar, como já foi referido, os consumos existen-
tes no Posto E.Charger de todos os clientes, através de um grá?co (Figura 5.10). Neste caso
o grá?co também utiliza a API da Google, no entanto é modi?cado para um grá?co de linhas.

Aqui é possível ao administrador visualizar os registos efetuados na página, bem como
consultar individualmente os consumos de cada cliente. Para isso basta na caixa de texto
presente, inserir o número de telefone associado ao cliente em questão e clicar no botão Search
(Figura 5.11), e aí são disponibilizados todos os consumos efetuados pelo número de telefone
pesquisado. Nas ?guras apresentadas alguns números de telefone estão rasurados para priva-
cidade das pessoas que testaram o produto.

Na página "Sobre"(Figura 5.12) e na página "Contacto"(Figura 5.13) apenas são explica-
dos alguns pormenores do projeto, bem como quem o elaborou e a orientação, tanto como o
contacto da pessoa que o desenvolveu respetivamente.

Luísa Manuel de Sousa Pereira Azeredo Dissertação de Mestrado



5.Implementação do Sistema de Monitorização 51

Figura 5.10: Pagina de administrador.

Luísa Manuel de Sousa Pereira Azeredo Dissertação de Mestrado



52 5.Implementação do Sistema de Monitorização

Figura 5.11: Pesquisa por cliente.

Figura 5.12: Pagina Sobre o projeto criado.

Figura 5.13: Pagina com o Contacto do projeto.

Luísa Manuel de Sousa Pereira Azeredo Dissertação de Mestrado



Capítulo 6

Conclusões e Trabalho futuro

6.1 Conclusões

O projeto e construção do posto de abastecimento para veículos elétricos, objeto desta
dissertação, foi concluído com sucesso. Os objetivos iniciais foram plenamente alcançados
destacando-se as seguintes funcionalidades: envio e receção de SMS pelo posto, medição do
consumo elétrico, envio de dados para uma base de dados e criação de uma página web para
visualizar esses consumos.

O estudo dos diversos postos de abastecimento apresentados no capítulo 2, resultou numa
visão integrada das tecnologias e funcionalidades necessárias ao desenvolvimento do sistema
proposto nesta dissertação. Uma vez que só assim foi possível desenvolver uma solução me-
lhorada do que já existe no mercado, de forma a ser um produto competitivo.

Ao longo da implementação e construção do sistema surgiram diversos contratempos que
obrigaram à reformulação de alguns processos. Salientam-se as di?culdades na calibração dos
dados pelo microcontrolador, na programação das interrupções do microcontrolador e na co-
municação deste com o modem GSM, especialmente na de?nição dos tempos de espera, das
con?rmações dos pedidos feitos ao modem.

Após o desenvolvimento deste protótipo, conclui-se que se devia ter optado por um me-
didor de corrente mais preciso, uma vez que se obteve alguns pequenos erros de medição nos
testes efetuados. Também neste protótipo será necessário alterar alguns equipamentos, para
que seja possível carregar um veiculo elétrico com uma corrente cerca de 16A a 32A, que neste
caso assegura apenas 4A no triac.

Neste produto também será necessário implementar proteções na caixa do produto, bem
como desenvolver uma caixa exterior num material resistente a diferenças de temperatura
elevadas (p.ex. -25oC a mais de 50oC) com isolamento à prova de água(Índice de proteção de
67). Por esse motivo, propõe-se uma caixa desenvolvida em material Polipropileno(PP), que é
de baixo custo mas tem alta resistência ao impacto e boa estabilidade térmica. Este material
também permite fazer um posto de abastecimento apelativo com forma invulgar, uma vez que
o PP é de fácil moldagem e coloração. A nível de interior, será necessário fazer um estudo
sobre os protocolos de carga, de forma a implementar proteções de sobrecarga de corrente,

53



54 6.Conclusões e Trabalho futuro

para que se mantenha a segurança do utilizador.

A este protótipo ainda é preciso ser adicionada a cobrança da energia fornecida a partir
do cartão SIM, uma vez que houve contacto com operadoras , mas não foi possível estabelecer
um contrato que o permitisse, para o teste do equipamento a esse nível.

O desenvolvimento deste projeto permitiu ainda adquirir conhecimentos de diferentes
áreas, nomeadamente de eletrotecnia, eletrónica, sistemas digitais, instrumentação e comuni-
cações móveis, tendo sido assim um trabalho deveras enriquecedor, uma vez que no mestrado
em questão essas áreas não são muito desenvolvidas.

A Internet mostrou-se um recurso essencial no desenvolvimento deste projeto, tendo sido
fundamental na análise do estado da arte, no contacto com os fabricantes e os fornecedores
do material e na pesquisa de soluções para alguns dos problemas encontrados.

6.2 Trabalho Futuro

Perante as conclusões obtidas do trabalho desenvolvido para esta dissertação, torna-se
viável a sugestão de futuras implementações com base neste. Propõe-se:

• Adicionar um novo sensor de corrente a ?m de melhorar a aquisição de dados, no sentido
de ter mais precisão;

• Criação de aplicação Android ou Windows Mobile, para que seja mais fácil a consulta
dos consumos;

• Projeto com micro geração de energia, com aplicação de painéis fotovoltaicos, para que
a empresa administradora do produto possa fazer preços mais económicos;

• Criação de contrato com uma empresa operadora de redes GSM para que seja possível
a venda de energia ao cliente e a cobrança monetária, com adição de fatura de gastos
diferenciados por telecomunicações e energia.

• Criação da caixa para o produto num material resistente a variação de temperatura e
ao impacto, com implementação de tomadas com proteção de sobrecarga de corrente.

Luísa Manuel de Sousa Pereira Azeredo Dissertação de Mestrado



Bibliogra?a

[Analog, 2014] Analog (2014). Ad623. Available from: http://www.analog.com/static/
imported-files/data_sheets/AD623.pdf.

[Arif et al., 2013] Arif, A., Ai-hussain, M., Ai-mutairi, N., and Ai-ammar, E. (2013). Experi-
mental study and design of smart energy meter for the smart grid. pages 1?6.

[Automotive] Automotive. Electric vehicle sales uk on the rise marketing in automotive;
consultado em: 27/05/2014. Available from: http://www.marketinginautomotive.com/
electric_vehicle_sales_uk/.

[Balsa, 2013] Balsa, J. (2013). Avaliação do impacto da introdução de veículos elétricos na
procura de combustiveis em portugal; consultado em:27/05/2014. Available from: https:
//estudogeral.sib.uc.pt/bitstream/10316/24945/1/Tese_vf.pdf.

[Barbosa, 2012a] Barbosa, A. (2012a). Redes de abastecimento para veículos eletricos; con-
sultado em:27/05/2014. Available from: http://ave.dee.isep.ipp.pt/~mjf/act_lect/
SIAUT/Trabalhos2011-12/SIAUT_2011-12_ProjetoRenaultNissan.pdf.

[Barbosa, 2012b] Barbosa, A. V. (2012b). Redes de abastecimento para veículos elétricos.
pages 1?8.

[BC974] BC974, N. Bc874/bc547 series datasheet; consultado em:20/08/2014. Available from:
http://www.nxp.com/documents/data_sheet/BC847_BC547_SER.pdf.

[Benysek and Jarnut, 2012] Benysek, G. and Jarnut, M. (2012). Electric vehicle charging in-
frastructure in poland. Renewable and Sustainable Energy Reviews, 16(1):320?328. Available
from: http://linkinghub.elsevier.com/retrieve/pii/S1364032111004059.

[Description et al., 2001] Description, G., Data, Q. R., Con?guration, P. I. N., and Values,
L. (2001). Triacs bt136 series general description quick reference data triacs bt136 series.
(June):1?6.

[Developers] Developers, G. Google maps; consultado em: 27/05/2014. Available from:
https://developers.google.com/maps/.

[EFACEC] EFACEC. Efacec. Available from: http://www.efacec.pt/presentationLayer/
efacec_empresa_00.aspx?idioma=1&amp;amp;area=8&amp;amp;local=303&amp;amp;empresa=147.

[Electrique] Electrique, F. M. Voiture et vehicule electrique - france mobilite electrique; con-
sultado em 22/09/2014. Available from: http://www.france-mobilite-electrique.org/
?lang=fr.

55

http://www.analog.com/static/imported-files/data_sheets/AD623.pdf
http://www.analog.com/static/imported-files/data_sheets/AD623.pdf
http://www.marketinginautomotive.com/electric_vehicle_sales_uk/
http://www.marketinginautomotive.com/electric_vehicle_sales_uk/
https://estudogeral.sib.uc.pt/bitstream/10316/24945/1/Tese_vf.pdf
https://estudogeral.sib.uc.pt/bitstream/10316/24945/1/Tese_vf.pdf
http://ave.dee.isep.ipp.pt/~mjf/act_lect/SIAUT/Trabalhos 2011-12/SIAUT_2011-12_ProjetoRenaultNissan.pdf
http://ave.dee.isep.ipp.pt/~mjf/act_lect/SIAUT/Trabalhos 2011-12/SIAUT_2011-12_ProjetoRenaultNissan.pdf
http://www.nxp.com/documents/data_sheet/BC847_BC547_SER.pdf
http://linkinghub.elsevier.com/retrieve/pii/S1364032111004059
https://developers.google.com/maps/
http://www.efacec.pt/presentationLayer/efacec_empresa_00.aspx?idioma=1&amp;amp;area=8&amp;amp;local=303&amp;amp;empresa=147
http://www.efacec.pt/presentationLayer/efacec_empresa_00.aspx?idioma=1&amp;amp;area=8&amp;amp;local=303&amp;amp;empresa=147
http://www.france-mobilite-electrique.org/?lang=fr
http://www.france-mobilite-electrique.org/?lang=fr


56 BIBLIOGRAFIA

[Electronics, 2014] Electronics, P. (2014). Efeito de hall; consultado em: 12/06/2014. Avai-
lable from: http://powerelectronics.com/site-files/powerelectronics.com/files/
archive/powerelectronics.com/electromechanical_devices/sensors_transducers/

hall-effect-sensing_fig3.jpg.

[Escola] Escola. Carta na escola; consultado em: 27/08/2014. Available from: http://www.
cartanaescola.com.br/single/show/91.

[Farinha, 2009] Farinha, D. (2009). Sistemas de telecontagem e gestão de energia em ambientes
residenciais.

[FATEK] FATEK. Plc fatek fbs 24mc; consultado em:20/10/2014. Available from: http:
//file.siam2web.com/saesales/product/2011526_53135.jpg.

[Ferreira, 2011] Ferreira, N. (2011). Sistema de contagem de energia elétrica baseado em tec-
nologia gsm; consultado em: 12/06/2014. Available from: http://repositorio-aberto.
up.pt/bitstream/10216/61507/1/000148272.pdf.

[GreenCar] GreenCar. Green car congress: Pike forecasts more than 4.7m electric vehicle
charge points to be installed worldwide by 2015; china to represent more than 1/3 of global
market; consultado em:27/05/2014. Available from: http://www.greencarcongress.com/
2010/05/pike-20100525.html.

[Honeywell, 2014] Honeywell (2014). Csla1cd honeywell. Available from: http://media.
digikey.com/Photos/Honeywell%20Photos/CSLA1CE.JPG.

[HTML5] HTML5. Html5; consultado em: 27/05/2014. Available from: http://pt.
wikipedia.org/wiki/HTML5.

[Instruments, 2014] Instruments, T. (2014). Tl7660 cmos voltage converter; consultado em:
12/06/2014. Available from: http://www.ti.com/lit/ds/symlink/tl7660.pdf.

[Intersil, 2014] Intersil (2014). Cmos voltage converters; consultado em: 12/06/2014. Availa-
ble from: http://www.intersil.com/content/dam/Intersil/documents/icl7/icl7660.
pdf.

[IXYS] IXYS. Application note : An-145 advantages of solid-state relays over electro-
mechanical relays application note : An-145.

[Kisense] Kisense. Kisense; consultado em:20/08/2014. Available from: http://www.
isasensing.com/pt/pagina/98.

[LEM, 2014a] LEM (2014a). Lts15np lem; consultado em: 12/06/2014. Available from: http:
//media.digikey.com/photos/LEM%20Photos/LTS%2015-NP,LTS%2025-NP.jpg.

[LEM, 2014b] LEM (2014b). Voltage transducer lv 25-p; consultado em: 12/06/2014. Avai-
lable from: http://www.lem.com/docs/products/lv%2025-p.pdf.

[Malhotra and Seethalakshmi, 2013] Malhotra, P. R. and Seethalakshmi, R. (2013). Automa-
tic meter reading and theft control system by using gsm. 5(2):1?5.

[Marktest] Marktest. Posse de telemóvel nos 92Available from: http://www.marktest.com/
wap/a/n/id~18f8.aspx.

Luísa Manuel de Sousa Pereira Azeredo Dissertação de Mestrado

http://powerelectronics.com/site-files/powerelectronics.com/files/archive/powerelectronics.com/electromechanical_devices/sensors_transducers/hall-effect-sensing_fig3.jpg
http://powerelectronics.com/site-files/powerelectronics.com/files/archive/powerelectronics.com/electromechanical_devices/sensors_transducers/hall-effect-sensing_fig3.jpg
http://powerelectronics.com/site-files/powerelectronics.com/files/archive/powerelectronics.com/electromechanical_devices/sensors_transducers/hall-effect-sensing_fig3.jpg
http://www.cartanaescola.com.br/single/show/91
http://www.cartanaescola.com.br/single/show/91
http://file.siam2web.com/saesales/product/2011526_53135.jpg
http://file.siam2web.com/saesales/product/2011526_53135.jpg
http://repositorio-aberto.up.pt/bitstream/10216/61507/1/000148272.pdf
http://repositorio-aberto.up.pt/bitstream/10216/61507/1/000148272.pdf
http://www.greencarcongress.com/2010/05/pike-20100525.html
http://www.greencarcongress.com/2010/05/pike-20100525.html
http://media.digikey.com/Photos/Honeywell%20Photos/CSLA1CE.JPG
http://media.digikey.com/Photos/Honeywell%20Photos/CSLA1CE.JPG
http://pt.wikipedia.org/wiki/HTML5
http://pt.wikipedia.org/wiki/HTML5
http://www.ti.com/lit/ds/symlink/tl7660.pdf
http://www.intersil.com/content/dam/Intersil/documents/icl7/icl7660.pdf
http://www.intersil.com/content/dam/Intersil/documents/icl7/icl7660.pdf
http://www.isasensing.com/pt/pagina/98
http://www.isasensing.com/pt/pagina/98
http://media.digikey.com/photos/LEM%20Photos/LTS%2015-NP,LTS%2025-NP.jpg
http://media.digikey.com/photos/LEM%20Photos/LTS%2015-NP,LTS%2025-NP.jpg
http://www.lem.com/docs/products/lv%2025-p.pdf
http://www.marktest.com/wap/a/n/id~18f8.aspx
http://www.marktest.com/wap/a/n/id~18f8.aspx


BIBLIOGRAFIA 57

[Microchip] Microchip. Microcontrolador da microchip; consultado em:20/10/2014. Avai-
lable from: http://en.wikipedia.org/wiki/PIC_microcontroller#mediaviewer/File:
PIC_microcontrollers.jpg.

[Microincasso] Microincasso. Microincasso; consultado em:20/08/2014. Available from: www.
microincasso.nl.

[Miguel and Miranda, 2011] Miguel, L. and Miranda, F. (2011). Veículo elétrico com interface
para a rede elétrica. (June).

[Motorola] Motorola. Moc3020 semiconductor technical data; consultado em:22/05/2014.
Available from: http://pdf.datasheetcatalog.com/datasheet/motorola/MOC3021.pdf.

[NXP] NXP, B. Bt136-600 data sheet; consultado em:22/05/2014. Available from: http:
//www.nxp.com/documents/data_sheet/BT136-600.pdf.

[OLIMEX, 2008] OLIMEX (2008). Pic-gsm development board users manual. (June).

[OLIMEX, 2013] OLIMEX (2013). Mod-gsm development board user's manual.

[Omron] Omron. Relay omron; consultado em:20/10/2014. Available from: http://www.
omron.com/ecb/products/pdf/en-g5le.pdf.

[Point] Point, C. Charge point mobile app; consultado em: 06/10/2014. Available from:
http://www.chargepoint.com/mobile.

[Portugal, 2014] Portugal, G. (2014). Compromisso para o crescimento verde. page 6.

[Rashdi et al., 2012] Rashdi, A., Malik, R., Rashid, S., Ajmal, A., and Sadiq, S. (2012). Re-
mote energy monitoring, pro?ling and control through GSM network. 2012 International
Conference on Innovations in Information Technology (IIT), pages 184?188. Available from:
http://ieeexplore.ieee.org/lpdocs/epic03/wrapper.htm?arnumber=6207728.

[Reis, 2010] Reis, L. (2010). Modelo e sistema de carregamento para veículos eléctricos em
portugal.

[Research] Research, P. PIKE RESEARCH: SALES OF ELECTRIC CARS TO HIT 358,000
BY 2017, CALIFORNIA LEADS THE WAY, EV CHARGING STATIONS TO LAG
BEHIND - PBT; Consultado em: 20/08/2014. Available from: http://tommytoy.typepad.
com.

[Sbordone et al., 2014] Sbordone, D., Bertini, I., Di Pietra, B., Falvo, M., Genovese, a., and
Martirano, L. (2014). Ev fast charging stations and energy storage technologies: A real im-
plementation in the smart micro grid paradigm. Electric Power Systems Research. Available
from: http://linkinghub.elsevier.com/retrieve/pii/S0378779614002880.

[Scholar, 2013] Scholar, P. G. (2013). Gsm based automatic energy meter reading system with
instant billing. pages 65?72.

[Semiconductors et al.] Semiconductors, V., Data, M., and Table, P. Small signal transistors
( npn ). (85113):1?9.

Luísa Manuel de Sousa Pereira Azeredo Dissertação de Mestrado

http://en.wikipedia.org/wiki/PIC_microcontroller#mediaviewer/File:PIC_microcontrollers.jpg
http://en.wikipedia.org/wiki/PIC_microcontroller#mediaviewer/File:PIC_microcontrollers.jpg
www.microincasso.nl
www.microincasso.nl
http://pdf.datasheetcatalog.com/datasheet/motorola/MOC3021.pdf
http://www.nxp.com/documents/data_sheet/BT136-600.pdf
http://www.nxp.com/documents/data_sheet/BT136-600.pdf
http://www.omron.com/ecb/products/pdf/en-g5le.pdf
http://www.omron.com/ecb/products/pdf/en-g5le.pdf
http://www.chargepoint.com/mobile
http://ieeexplore.ieee.org/lpdocs/epic03/wrapper.htm?arnumber=6207728
http://tommytoy.typepad.com
http://tommytoy.typepad.com
http://linkinghub.elsevier.com/retrieve/pii/S0378779614002880


58 BIBLIOGRAFIA

[Solutions] Solutions, E. Av home ev chargers ? aerovironment, inc. online store. Available
from: http://store.evsolutions.com/av-home-ev-chargers-c13.aspx.

[Source and Driver, 1995] Source, G.-a.-d. I. and Driver, O.-c. S. T. (1995). Moc3020 thru
moc3023 optocouplers/optoisolators. (October 1986).

[Speci?cation] Speci?cation, S. Sim300d at command set software.

[Stations] Stations, C. C. Ct4000 family. pages 1?4.

[Technology, 2006] Technology, M. (2006). Pic18f97j60 family 1 mbit ?ash microcontrollers
with ethernet.

[Wattstation] Wattstation. Wattstation; consultado em:20/08/2014. Available from: https:
//www.gewattstation.com/connect/.

[Yuan et al., 2012] Yuan, Z., Xu, H., Han, H., and Zhao, Y. (2012). Research of smart charging
management system for electric vehicles based on wireless communication networks. 2012
IEEE 6th International Conference on Information and Automation for Sustainability, pages
242?247. Available from: http://ieeexplore.ieee.org/lpdocs/epic03/wrapper.htm?
arnumber=6419910.

Luísa Manuel de Sousa Pereira Azeredo Dissertação de Mestrado

http://store.evsolutions.com/av-home-ev-chargers-c13.aspx
https://www.gewattstation.com/connect/
https://www.gewattstation.com/connect/
http://ieeexplore.ieee.org/lpdocs/epic03/wrapper.htm?arnumber=6419910
http://ieeexplore.ieee.org/lpdocs/epic03/wrapper.htm?arnumber=6419910


Apêndice A

Diagramas

59



60 A.Diagramas

Luísa Manuel de Sousa Pereira Azeredo Dissertação de Mestrado



A.Diagramas 61

MicrocontroladorMicrocontrolador Módulo GSM

 AT&amp;lt;CR&gt;

OK

ATE0&amp;lt;CR&gt;

OK

AT+CMGF=1&amp;lt;CR&gt;

OK

AT+CMGR=1&amp;lt;CR&gt;

OK

ciclo

Figura A.1: Diagrama de comandos em ciclo normal.

Luísa Manuel de Sousa Pereira Azeredo Dissertação de Mestrado



62 A.Diagramas

Luísa Manuel de Sousa Pereira Azeredo Dissertação de Mestrado



A.Diagramas 63

MicrocontroladorMicrocontrolador Módulo GSM

 AT&amp;lt;CR&gt;

OK

ATE0&amp;lt;CR&gt;

OK

AT+CMGF=1&amp;lt;CR&gt;

OK

AT+CMGR=1&amp;lt;CR&gt;

+CMGR: "REC UNREAD"/"+351*********"//"yy/mm/dd/hh:mm:ss+ss"..MMMM....OK.

AT+CMGS="+351*********"&lt;CR&gt;&lt;CR&gt;"A sua SMS possui erros. Por favor volte a tentar. Obrigado.&amp;lt;CR&gt;&amp;lt;0x1A&gt;

OK

AT+CMGDA="del all"&amp;lt;CR&gt;

OK

ciclo

Figura A.2: Diagrama de envio/recepção de SMS quando há erros.

Luísa Manuel de Sousa Pereira Azeredo Dissertação de Mestrado



64 A.Diagramas

Luísa Manuel de Sousa Pereira Azeredo Dissertação de Mestrado



A.Diagramas 65

Vetor de 
Interrupção

RC1IF ==1 ?

Não

TMR1IF==1 ?

Sim
Receção de 

caracteres da porta 
série 

rx[rxi]=RCREG

Sim TMR1IF=0

Não

Fim

Figura A.3: Vetor Interrupção do Pic 18f97J60

Luísa Manuel de Sousa Pereira Azeredo Dissertação de Mestrado



66 A.Diagramas

Luísa Manuel de Sousa Pereira Azeredo Dissertação de Mestrado



A.Diagramas 67

Inicio
Instrução de Escrita 

Módulo GSM
AT+CMGF=1

Leitura da 1ª 
Mensagem

AT+CMGD=1

Tem 
Mensagem?

Sim

Leu “CARR xxxx”

Não

Não
Envia mensagem de 

Resposta 

Sim

Memorização dos 4 
digitos. 

“A sua SMS possui 
erros. Por favor 
volte a tentar. 

Obrigado.

Inicio da Contagem 
da energia

RB4=1 

Envio de mensagem 
para o cliente. “O 

carregamento de (4 
digitos) ws vai ser 

efetuado. Obrigado

Envia uma SMS ao 
cliente. “O 

carregamento 
terminou. Obrigado.”

Fim

Eliminação da 
mensagem. 

AT+CMGA=”dell all”

Sim

Contagem 
terminou?

Não

Figura A.4: Diagrama geral do Pic 18f97J60

Luísa Manuel de Sousa Pereira Azeredo Dissertação de Mestrado



68 A.Diagramas

Luísa Manuel de Sousa Pereira Azeredo Dissertação de Mestrado



Apêndice B

Esquemas Elétricos

69



70 B.Esquemas Elétricos

Luísa Manuel de Sousa Pereira Azeredo Dissertação de Mestrado



B.Esquemas Elétricos 71

Figura B.1: Esquema representativo de montagem módulo Triac

Luísa Manuel de Sousa Pereira Azeredo Dissertação de Mestrado



72 B.Esquemas Elétricos

Luísa Manuel de Sousa Pereira Azeredo Dissertação de Mestrado



B.Esquemas Elétricos 73

3

2
6

4
7

1 5
8

U1

AD623

R1
10k

R2
10k R3 10k

R4
10k

5V

R5
10k

C1

10uF

C2
10uF

5V

EXT-25 (AN2)

CAP+2

CAP-4

GND 3

V+ 8

VOUT 5LV6
OSC7

U4

ICL7660A

CAP+2

CAP-4

GND 3

V+ 8

VOUT 5LV6
OSC7

U2

TL7660C3
1uF

12V

R6
10k

C4
1uF

+HT4

-HT5 - 2
Out 3

+ 1

12V

LV25-P

R7
27k

RM
100

Figura B.2: Esquema representativo de montagem do transdutor de tensao

Luísa Manuel de Sousa Pereira Azeredo Dissertação de Mestrado



74 B.Esquemas Elétricos

Luísa Manuel de Sousa Pereira Azeredo Dissertação de Mestrado



B.Esquemas Elétricos 75

IP+4

IP-5
VIOUT 3

VCC 1

GND 2

U1

CSLA1CD

3

2
6

4
7

1 5
8

U2

AD623

R1
10k

R2
10k

R3
10k

5V

5V

R4
10k

R5
10k

L

L

R6
4.7k

C1
0.68uF

EXT2-10 (AN6)

Figura B.3: Esquema representativo de montagem do transdutor de corrente

Luísa Manuel de Sousa Pereira Azeredo Dissertação de Mestrado



76 B.Esquemas Elétricos

Luísa Manuel de Sousa Pereira Azeredo Dissertação de Mestrado


	Conteúdo
	Lista de Figuras
	Lista de Tabelas
	Acrónimos
	Introdução
	Contexto
	Problema a resolver
	Objetivos
	Organização

	Estado de Arte
	Veículo Elétrico
	Legislação associada à implementação do posto de abastecimento
	Tecnologias de abastecimento
	EFACEC
	EV Solutions
	Charge Point

	Empresas de Monitorização Gestão de postos públicos
	MOBI.E Mobilidade Elétrica
	Essent
	Wattstation

	Projetos Relacionados
	"Electric vehicle charging infrastructure in Poland" Poland


	Solução Proposta
	Perspetiva Geral
	Funcionalidades do sistema
	Restrições
	Apresentação da solução

	Implementação do Posto de Abastecimento
	Arquitetura do Sistema
	Módulo 1
	Módulo 2
	Módulo 3
	Conclusão

	Módulo 1- Controlo da passagem da corrente elétrica
	Módulo 2 - Medição da Energia
	Medição da Corrente
	Medição da Tensão
	Microcontrolador

	Módulo 3 - Modem GSM/GPRS
	Comunicação RS232
	Comunicação TCP/IP

	Síntese protótipo

	Implementação do Sistema de Monitorização
	Base de dados MySQL
	Página WEB

	Conclusões e Trabalho futuro
	Conclusões
	Trabalho Futuro

	Bibliografia
	Diagramas
	Esquemas Elétricos

</field>
	</doc>
</add>