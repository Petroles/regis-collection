<?xml version="1.0" encoding="utf-8"?>
<add>
	<doc>
		<field name="docid">BR-TU.14333</field>
		<field name="filename">2063_301871.pdf</field>
		<field name="filetype">PDF</field>
		<field name="text">
UNIVERSIDADE FEDERAL DE SANTA CATARINA
DEPARTAMENTO DE INFORMÁTICA E ESTATÍSTICA

André Ferreira Bem Silva

CARACTERIZAÇÃO DO ESPAÇO POROSO EM ROCHAS POR
ESFERAS MÁXIMAS EXATAS

Florianópolis

2012





André Ferreira Bem Silva

CARACTERIZAÇÃO DO ESPAÇO POROSO EM ROCHAS POR
ESFERAS MÁXIMAS EXATAS

Caracterização do Espaço Poroso em Ro-
chas por Esferas Máximas Exatas subme-
tido ao Programa de Pós-graduação em Ci-
ência da Computação para a obtenção do
Grau de Mestre em Ciências da Computa-
ção.
Orientador: Eros Comunello, Prof. Dr. rer.
nat.

Florianópolis

2012



 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 
Catalogação na fonte pela Biblioteca Universitária 

da 

Universidade Federal de Santa Catarina 

 

 
 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

         

. 

 

 

         

 

 S586c  Silva, André Ferreira Bem 

           Caracterização do espaço poroso em rochas por esferas 

        máximas exatas [dissertação] / André Ferreira Bem Silva ;  

        orientador, Eros Comunello. - Florianópolis, SC, 2012.  

           153 p.: il., grafs. 

 

           Dissertação (mestrado) - Universidade Federal de Santa 

        Catarina, Centro Tecnológico. Programa de Pós-Graduação em  

        Ciência da Computação. 

 

           Inclui referências 

 

           1. Informática. 2. Ciência da computação. 3. Escoamento. 

        4. Rochas. 5. Porosidade. I. Comunello, Eros. II. Universidade 

        Federal de Santa Catarina. Programa de Pós-Graduação em  

        Ciência da Computação. III. Título.  

                                                CDU 681 

 

 

 

                          

 

 

 

 

 

 







Aos meus pais, Laura e Pedro. Aos meus avós,
Osvaldo e Ana e à Samanta, com todo meu
amor.





AGRADECIMENTOS

Ao Prof. Eros Comunello pela orientação,
Ao Prof. Aldo von Wangenheim pelo espaço físico e equipamentos,
Aos meus colegas de laboratório. Sem exceção,
Aos meus familiares,
Aos meus amigos,
A todos que contribuiram direta ou indiretamente para esse trabalho.





"Education is a system of imposed ignorance"
"A educação é um sistema de ignorância im-
posta"(tradução livre)

Noam Chomsky





RESUMO

Neste trabalho, uma modificação ao algoritmo de esferas máximas (MB) é
proposto. Essa abordagem recebe o nome de esferas máximas exatas (EMB),
por utilizar os raios exatos ao invés de duas aproximações. Tal mudança, traz
consequências para o resultado final, definindo de forma mais detalhada a es-
trutura interna do espaço poroso, gerando cinquenta porcento mais poros e
gargantas. Dessa forma, a rede gerada de modo exato é comparada a rede ori-
ginal, em características básicas e nas simulações de escoamento monofásico,
obtendo-se resultados bem correlacionados e em mesma escala de grandeza
para ambas, apesar de diferentes. Muitas otimizações para paralelização e
dados comprimidos são propostas e o algoritmo exato, mesmo processando
mais esferas, é de duas a seis mais rápido para todos os casos de estudo.
Palavras-chave: volume, microtomografia, espaço poroso, escoamento, rede
de poros, rocha





ABSTRACT

In this work a maximum balls (MB) modification is presented. This novel
approach receives the name of exact maximum balls (EMB) because it uses
one exact radius instead of two approximations. Therefore, there are conse-
quences to the generated pore network which is found out to define the pore
space with at least fifty porcent more detail, that is, pores and throats. That
way, the exact pore network is compared with the original and it is discovered
that there is a strict correlation between their results and that these are always
of the same magnitude, although different. Also, a lot of optimizations to
process compressed data and to allow data parallelization are shown and the
EMB pore network extraction is, in every test case, consistently faster than
MB. The obtained speedup was from two up to six times.
Keywords: volumn, microtomography, pore space, transport prediction, pore
network, rock





SUMÁRIO

Lista de Tabelas . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
Lista de Figuras . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
Lista de Algoritmos . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 25
1 INTRODUÇÃO . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 27
1.1 CONTEXTO . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 27
1.2 OBJETIVOS . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 30
1.2.1 Objetivo geral . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 30
1.2.2 Objetivos específicos . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 30
1.3 A RESPEITO DA LEITURA DESTE TRABALHO . . . . . . . . . . . . 31
2 REVISÃO SISTEMÁTICA DA LITERATURA . . . . . . . . . . . . . . . 33
2.1 IDENTIFICAÇÃO DA PESQUISA E SELEÇÃO DOS ESTUDOS 33
2.1.1 Critérios de inclusão . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 33
2.1.2 Critérios de exclusão . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 34
2.2 ESTADO DA ARTE . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 34
2.2.1 Métodos do eixo médio . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 34
2.2.2 Método baseado em processos . . . . . . . . . . . . . . . . . . . . . . . . . . . 35
2.2.3 Esferas máximas . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 37
2.3 MÉTODO . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 38
3 PROCESSAMENTO E ANÁLISE DE DADOS MICROTOMO-

GRÁFICOS DE ROCHA . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 41
3.1 AQUISIÇÃO DE DADOS . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 41
3.1.1 Porosimetria por injeção de mercúrio . . . . . . . . . . . . . . . . . . . . . 41
3.1.2 Microtomografia computadorizada . . . . . . . . . . . . . . . . . . . . . . . 42
3.2 BINARIZAÇÃO DO VOLUME DE DADOS . . . . . . . . . . . . . . . . . . 43
3.3 FILTRAGEM E TRATAMENTO . . . . . . . . . . . . . . . . . . . . . . . . . . . . 45
3.4 COMPRESSÃO RLE . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 47
3.5 VOLUMES . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 48
3.6 CONCLUSÃO . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 51
4 EXTRAÇÃO DE REDE DE POROS POR ESFERAS MÁXI-

MAS EXATAS . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 53
4.1 BUSCA DE ESFERAS . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 53
4.1.1 Algoritmo de inflar esferas . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 53
4.1.2 Mapa de distâncias exatas . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 55
4.2 REMOÇÃO DE ESFERAS . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 60
4.3 AGLOMERAÇÃO . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 64
4.4 GERAÇÃO DA RP . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 67
4.5 ESTRUTURAS COMPRIMIDAS . . . . . . . . . . . . . . . . . . . . . . . . . . . 70



4.6 CONCLUSÃO . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 71
5 PROPRIEDADES DA REDE E CÁLCULOS DE TRANSPORTE 75
5.1 ESTUDO DE CASO S1 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 75
5.1.1 Número de coordenação . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 78
5.1.2 Poros . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 79
5.1.3 Gargantas . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 81
5.2 ESTUDO DE CASO C1 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 84
5.2.1 Número de coordenação . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 86
5.2.2 Poros . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 87
5.2.3 Gargantas . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 88
5.3 DEMAIS ARENITOS . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 92
5.4 ROCHA C2 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 97
5.5 ESCOAMENTO MONOFÁSICO E PROPRIEDADES PETRO-

FÍSICAS . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 99
5.5.1 Fator de forma . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 99
5.5.2 Permeabilidade absoluta . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 102
5.5.3 Fator de formação . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 104
5.5.4 Resultados . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 105
5.6 CONCLUSÃO . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 110
6 CONCLUSÃO . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 115
6.1 REFLEXÕES CONCLUSIVAS . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 115
6.2 TRABALHOS FUTUROS . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 118
6.2.1 Otimizações em cpu e gpu . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 118
Aglomeração . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 118
Busca de esferas vizinhas . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 119
Estruturas comprimidas em gpu . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 120
Busca de esferas em gpu . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 120
Utilização de ponto fixo ao invés de ponto flutuante . . . . . . . . . . . . . . . . . 121
6.2.2 Validação com outras técnicas e estudo de variáveis de en-

trada e saída . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 121
6.2.3 Tratamento de dados multiescalares e volumes grandes . . . . . 122
6.3 RECONHECIMENTOS E AGRADECIMENTOS . . . . . . . . . . . . . . 122
Referências Bibliográficas . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 125
7 APÊNDICE A: FORMATO RBV E RESULTADOS . . . . . . . . . . . 131
7.1 FORMATO RBV . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 131
7.2 VALORES PARA DEMAIS VOLUMES . . . . . . . . . . . . . . . . . . . . . 131
7.2.1 Números de coordenação . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 139
7.3 ESCOAMENTO MONOFÁSICO NAS REDES EMB E MB NOS

EIXOS Y E Z . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 145
7.4 PARÂMETROS PARA O SIMULADOR . . . . . . . . . . . . . . . . . . . . . 145



LISTA DE TABELAS

Tabela 2 Imagens de seções transversais dos volumes de entrada, com
suas dimensões, porosidades e resoluções. A fase poro está em branco . . 49
Tabela 3 Características da RP, no EMB e MB, para o volume S1 . . . . . 76
Tabela 4 Características da RP, no EMB e MB, para o volume C1 . . . . . 85
Tabela 5 Características da RP, no EMB e MB, para o volume S2 . . . . . 93
Tabela 6 Características da RP, no EMB e MB, para o volume S3 . . . . . 94
Tabela 7 Características da RP, no EMB e MB, para o volume S5 . . . . . 95
Tabela 8 Características da RP, no EMB e MB, para o volume A1 . . . . . 96
Tabela 9 Características da RP, no EMB e MB, para o volume C2 . . . . . 98
Tabela 10 Tabela de valores dos fatores de formação e permeabilidades
para o EMB. Fator de expansão 0.5 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 107
Tabela 11 Tabela de valores dos fatores de formação e permeabilidades
para o EMB. Fator de expansão 0.6 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 107
Tabela 12 Tabela de valores dos fatores de formação e permeabilidades
para o EMB. Fator de expansão 0.7 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 108
Tabela 13 Tabela de valores dos fatores de formação e permeabilidades
para o EMB. Fator de expansão 0.8 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 108
Tabela 14 Tabela de valores dos fatores de formação e permeabilidades
para o MB . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 109
Tabela 15 Tabela de valores dos fatores de formação e permeabilidades
para o MB. Valores obtidos diretamente da tese de Dong e Blunt (2007) . 109
Tabela 16 Tabela que apresenta a razão do resultado obtido pela simula-
ção na rede EMB pela rede MB para diferentes fatores de expansão, no
eixo x . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 110
Tabela 17 Tabela que apresenta a razão do resultado obtido pela simula-
ção na rede EMB em relação aos resultados do trabalho de Dong e Blunt
(2007) para diferentes fatores de expansão, no eixo x . . . . . . . . . . . . . . . . . . 112
Tabela 18 Características da RP, no EMB e MB, para o volume S4 . . . . . 132
Tabela 19 Características da RP, no EMB e MB, para o volume S6 . . . . . 133
Tabela 20 Características da RP, no EMB e MB, para o volume S7 . . . . . 134
Tabela 21 Características da RP, no EMB e MB, para o volume S8 . . . . . 135
Tabela 22 Características da RP, no EMB e MB, para o volume S9 . . . . . 136
Tabela 23 Características da RP, no EMB e MB, para o volume S10 . . . . 137
Tabela 24 Características da RP, no EMB e MB, para o volume S11 . . . . 138



Tabela 25 Tabela que apresenta a razão do resultado obtido pela simula-
ção na rede EMB em relação aos resultados do trabalho de Dong e Blunt
(2007) para diferentes fatores de expansão, no eixo y . . . . . . . . . . . . . . . . . . 146
Tabela 26 Tabela que apresenta a razão do resultado obtido pela simula-
ção na rede EMB em relação aos resultados do trabalho de Dong e Blunt
(2007) para diferentes fatores de expansão, no eixo z . . . . . . . . . . . . . . . . . . 147



LISTA DE FIGURAS

Figura 1 Exemplo de parte do espaço poroso (em branco) em uma amos-
tra microtomográfica de rocha carbonática de dimensões 400x400x100 . . 28
Figura 2 Rede de poros para uma amostra de rocha carbonática. Observa-
se a irregularidade nos tamanhos e conexões dos poros e gargantas resul-
tantes . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 29
Figura 3 Função de transferência utilizada para visualização da rede . . 30
Figura 4 Figura que demonstra os resultados para extração do eixo mé-
dio em uma amostra de rocha. Schena e Favretto (2006) . . . . . . . . . . . . . . . 35
Figura 5 Corte transversal de uma amostra de arenito do Mar do Norte,
do trabalho de Oren e Bakke (2002) . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 36
Figura 6 Exemplo de configuração para descoberta de poros e gargan-
tas, por Hu Dong (DONG; BLUNT, 2007) . . . . . . . . . . . . . . . . . . . . . . . . . . . 37
Figura 7 Visão geral do algoritmo de esferas máximas . . . . . . . . . . . . . . . 38
Figura 8 Todas as esferas, não contidas em nenhuma outra, que repre-
sentam a distância até o voxel não poro mais próximo. . . . . . . . . . . . . . . . . 39
Figura 9 Configuração de porosimetria por injeção de mercúrio e uma
amostra real . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 42
Figura 10 Obtenção das imagens e pipeline de processamento típico para
amostras de rocha, por Fernandes, Appoloni e Fernandes (2009) . . . . . . . 43
Figura 11 Amostra de arenito e os histogramas referentes . . . . . . . . . . . . . 46
Figura 12 Imagem binarizada, onde i representa as linha e j as colunas . 47
Figura 13 Espaço absoluto, em MB, dos RBVs e RAWs . . . . . . . . . . . . . . . 50
Figura 14 Espaço , em porcentagem, dos RBVs e RAWs . . . . . . . . . . . . . . 51
Figura 15 Configurações de intersecção com pixel rocha em cinza e raios
em várias cores. O esquema de Dong e Blunt (2007) (direita) e o esquema
com esferas de tamanho exato (esquerda) . . . . . . . . . . . . . . . . . . . . . . . . . . . . 54
Figura 16 Tempo total de execução, em segundos, discriminando as eta-
pas do algoritmo de Dong e Blunt (2007), para várias entradas . . . . . . . . . 55
Figura 17 Esferas quadráticas após a aplicação da transformação 1D, da
esquerda para direita (figura esq.) e da direita para esquerda (figura dir.) 57
Figura 18 Exemplo de transformação do algoritmo de Saito, para uma
iteração do algoritmo sobre o elemento destacado na coluna G, cujo re-
sultado modifica H . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 58
Figura 19 Tempos de execução para busca de esferas por mapa de dis-



tâncias, single thread (ST) e multithread (MT), em segundos, na máquina
M1, para os dados de entrada em versões comprimidas ou não . . . . . . . . . 59
Figura 20 Ganho de performance do mapa de distâncias exatas em rela-
ção ao algoritmo de inflar esferas de Dong. Escala logarítmica . . . . . . . . . 60
Figura 21 Tempos de execução para a remoção de esferas contidas em
outras maiores . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 62
Figura 22 Exemplo de caso de remoção de esferas . . . . . . . . . . . . . . . . . . . . 62
Figura 23 Esferas encontradas na etapa de busca e o número de esferas
removidas, por EMB e por MB . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 63
Figura 24 Volume de exemplo e as árvores hierárquicas geradas para os
dois poros com uma garganta G1 ligando-os . . . . . . . . . . . . . . . . . . . . . . . . . 64
Figura 25 Expansão de gargantas, conforme proposto por Dong. Nesse
caso, o fator E f de expansão é de 70% . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 66
Figura 26 Número de poros e gargantas gerados pelo MB e pelo EMB . . 67
Figura 27 Porcentagem de voxels inválidos, em relação ao total de vo-
xels, no final do processo para ambos os algoritmos de esferas máximas . 68
Figura 28 Número de inlets e outlets gerados pelo MB e pelo EMB . . . . 68
Figura 29 Definição de inlets (esq.) e outlets (dir.), conforme proposto
por Al-Kharusi e Blunt (2007) . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 70
Figura 30 Tempo levado, em cada etapa do EMB, para volumes diversos.
O Fator E f de expansão é 50% . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 72
Figura 31 Tempo levado, em cada etapa do EMB, para volumes diversos.
O Fator E f de expansão é 80% . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 73
Figura 32 Rede gerada pelo EMB para o volume S1 . . . . . . . . . . . . . . . . . . 76
Figura 33 Frequência do número de coordenação nos algoritmos EMB e
MB para o volume S1 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 78
Figura 34 Distribuição de raios de poros para ambos algoritmos. Fatores
de expansão 50%, 60%, 70% e 80% para o EMB . . . . . . . . . . . . . . . . . . . . . 79
Figura 35 Frequência dos volumes dos poros para as redes EMB e MB do
volume S1. A última faixa engloba todos os valores maiores que quatro
vezes a média . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 80
Figura 36 Distribuição de comprimentos das gargantas para ambos algo-
ritmos no S1. Fatores de expansão 50%, 60%, 70% e 80% para o EMB . 81
Figura 37 Distribuição de raio das gargantas para ambos algoritmos no
S1. Fatores de expansão 50%, 60%, 70% e 80% para o EMB . . . . . . . . . . 82
Figura 38 Razão do comprimento da garganta pelo raio da mesma no
volume S1. A última faixa são os valores maiores que quatro vezes a
média . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 83



Figura 39 Frequência dos volumes das gargantas para o volume S1. A
última faixa são os valores maiores que quatro vezes a média . . . . . . . . . . 84
Figura 40 Rede gerada para o volume C1 . . . . . . . . . . . . . . . . . . . . . . . . . . . . 85
Figura 41 Frequência do número de coordenação nos algoritmos EMB e
MB para o volume C1 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 87
Figura 42 Distribuição de raios de poros para ambos algoritmos no vo-
lume C1. Fatores de expansão 50%, 60%, 70% e 80% para o EMB . . . . . 88
Figura 43 Frequência dos volumes dos poros para as redes EMB e MB do
volume C1. A última faixa engloba todos os valores maiores que quatro
vezes a média . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 89
Figura 44 Distribuição de comprimentos das gargantas no volume C1.
Fatores de expansão 50%, 60%, 70% e 80% para o EMB . . . . . . . . . . . . . . 89
Figura 45 Distribuição de comprimentos das gargantas para ambos algo-
ritmos. Fatores de expansão 50%, 60%, 70% e 80% para o EMB . . . . . . . 90
Figura 46 Razão do comprimento da garganta pelo raio da mesma no
volume C1. A última faixa são os valores maiores que quatro vezes a
média . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 91
Figura 47 Frequência dos volumes das gargantas para o volume C1. A
última faixa são os valores maiores que quatro vezes a média . . . . . . . . . . 91
Figura 48 Rede gerada para o volume S2 . . . . . . . . . . . . . . . . . . . . . . . . . . . . 93
Figura 49 Rede gerada para o volume S3 . . . . . . . . . . . . . . . . . . . . . . . . . . . . 94
Figura 50 Rede gerada para o volume S5 . . . . . . . . . . . . . . . . . . . . . . . . . . . . 95
Figura 51 Rede gerada para o volume A1 . . . . . . . . . . . . . . . . . . . . . . . . . . . . 96
Figura 52 Rede gerada para o volume C2 . . . . . . . . . . . . . . . . . . . . . . . . . . . . 98
Figura 53 Determinação da geometria mais próxima a um determinado
objeto a partir do fator de forma . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 100
Figura 54 Frequência do fator de forma para o volume S1 . . . . . . . . . . . . . 101
Figura 55 Frequência do fator de forma para o volume C1 . . . . . . . . . . . . . 101
Figura 56 Configuração poro-garganta-poro onde a região cinza é a re-
gião de cálculo do fluxo Qp,i j . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 103
Figura 57 Fatores de forma Fx para as redes EMB e MB . . . . . . . . . . . . . . 111
Figura 58 Permeabilidades Kx, em mD, para as redes EMB e MB . . . . . . 112
Figura 59 Permeabilidades Kx, em mD, para as redes EMB e o resultado
original de Dong e Blunt (2007) . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 113
Figura 60 Fatores de forma Fx para as redes EMB e o resultado original
de Dong e Blunt (2007) . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 114



Figura 61 Valores em milhares de esferas processadas por segundo, du-
rante a execução do EMB e MB no eixo x. A linha pontilhada é a média
global . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 116
Figura 62 Rede gerada para o volume S4 . . . . . . . . . . . . . . . . . . . . . . . . . . . . 132
Figura 63 Rede gerada para o volume S6 . . . . . . . . . . . . . . . . . . . . . . . . . . . . 133
Figura 64 Rede gerada para o volume S7 . . . . . . . . . . . . . . . . . . . . . . . . . . . . 134
Figura 65 Rede gerada para o volume S8 . . . . . . . . . . . . . . . . . . . . . . . . . . . . 135
Figura 66 Rede gerada para o volume S9 . . . . . . . . . . . . . . . . . . . . . . . . . . . . 136
Figura 67 Rede gerada para o volume S10 . . . . . . . . . . . . . . . . . . . . . . . . . . . 137
Figura 68 Rede gerada para o volume S11 . . . . . . . . . . . . . . . . . . . . . . . . . . . 138
Figura 69 Distribuição do número de coordenação para o EMB e MB no
volume C2 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 139
Figura 70 Distribuição do número de coordenação para o EMB e MB no
volume S2 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 140
Figura 71 Distribuição do número de coordenação para o EMB e MB no
volume S3 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 140
Figura 72 Distribuição do número de coordenação para o EMB e MB no
volume S4 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 141
Figura 73 Distribuição do número de coordenação para o EMB e MB no
volume S5 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 141
Figura 74 Distribuição do número de coordenação para o EMB e MB no
volume S6 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 142
Figura 75 Distribuição do número de coordenação para o EMB e MB no
volume S7 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 142
Figura 76 Distribuição do número de coordenação para o EMB e MB no
volume S8 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 143
Figura 77 Distribuição do número de coordenação para o EMB e MB no
volume S9 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 143
Figura 78 Distribuição do número de coordenação para o EMB e MB no
volume S10 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 144
Figura 79 Distribuição do número de coordenação para o EMB e MB no
volume S11 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 144
Figura 80 Distribuição do número de coordenação para o EMB e MB no
volume A1 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 145
Figura 81 Permeabilidades Ky, em mD, para as redes EMB e o resultado
original de Dong e Blunt (2007) . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 146
Figura 82 Fatores de forma Fy para as redes EMB e o resultado original



de Dong e Blunt (2007) . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 147
Figura 83 Permeabilidades Kz, em mD, para as redes EMB e o resultado
original de Dong e Blunt (2007) . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 148
Figura 84 Fatores de forma Fz para as redes EMB e o resultado original
de Dong e Blunt (2007) . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 148





25

LISTA DE ALGORITMOS

1 Obtenção do valor de thresholding automático . . . . . . . . . . . . . . 44
2 Transformação 1D no sentido frente, conforme proposta por

Lotufo, Falcao e Zampirolli (2000) . . . . . . . . . . . . . . . . . . . . . . . . 56
3 Execução no sentido frente do algoritmo de Saito para a coluna G 59
4 Descobre se S0 está contido em S1 . . . . . . . . . . . . . . . . . . . . . . . . 61
5 Obtém todos os valores de uma linha do volume, iterando por

segmento . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 71



26



27

1 INTRODUÇÃO

Nesse capítulo ficam esclarecidos os conceitos e trabalhos importan-
tes, sobre os quais esse trabalho é construído. Também, especificam-se as
metas almejadas e os resultados obtidos por outros trabalhos da literatura que
partilham de objetivos mútuos com esse trabalho.

1.1 CONTEXTO

Existe uma grande quantidade de hidrocarbonetos os quais estão con-
tidos rochas carbonáticas (JONES, 1984). O espaço poroso de rochas car-
bonáticas é altamente irregular devido a sua formação complexa (ROBERT;
CORDELL, 1992). A morfologia, a geometria e a topologia dos do espaço
poroso tem grande influência sobre as características gerais da rocha em ques-
tão e o comportamento de fluidos e gases dentro dessa (LUCIA, 1999). Um
exemplo de amostra carbonática, binarizada, com espaço poroso representado
pela cor branca e a rocha em preto, pode ser visto na figura 1.

A indústria petrolífera tem evoluído bastante no sentido de recupe-
rar hidrocarbonetos contidos nas reservas carbonáticas e existe uma demanda
para técnicas e representações computacionais as quais representem de forma
preditiva a complexa dinâmica de fluidos computacionais e gases no espaço
poroso. Valores como permeabilidade absoluta, permeabilidade relativa e
pressão capilar são importantes de serem avaliados quanto à extração de hi-
drocarbonetos, principalmente com relação a recuperação aprimorada de pe-
tróleo.

É possível extrair, dos dados microscópicos brutos, o comportamento
de um determinado fluido invadindo e escoando pelo espaço poroso. Uma
maneira, é utilizar-se de um método computacional que represente as inte-
rações de conectividade macroscópicas e o escoamento do fluido diretamente
no volume bruto. O método de Lattice-Boltzmann (LBM) (CHEN; DOOLEN,
1998), é capaz de descobrir tal dinâmica para um dado volume. Contudo, esse
método é computacionalmente custoso, mesmo para simulações com somente
uma fase. Se levado em consideração simulações multi-fases, o método torna-
se proibitivamente lento, podendo levar semanas para obter-se um resultado,
mesmo para volumes pequenos . Assim, faz-se necessário técnicas diferentes
para obter-se resultados em tempo hábil (FAN et al., 2004; BERNASCHI et
al., 2010).



28

Figura 1: Exemplo de parte do espaço poroso (em branco) em uma amostra
microtomográfica de rocha carbonática de dimensões 400x400x100

No trabalho de Fan et al. (2004), descreve-se para o LBM um tempo
por passo de 310 milisegundos. Como o passo utilizado é tipicamente um
milésimo, isso significa que para simular um segundo tem-se um tempo de
310 segundos. Considera-se que uma simulação interessante necessite de ao
menos algumas dezenas de segundos, tem-se que o tempo para fazê-la cresce
bastante. Assim, tem-se a necessidade de técnicas alternativas para previsão
e simulação de escoamento em tempo hábil.

Fatt (1956) criou um modelo de representação dos reticulados forma-
dos pelas relações poro-garganta-poro em duas dimensões. Pelo fato do mo-
delo representar somente cortes transversais, a conectividade final era inferior
ao encontrada em amostras reais. Ainda assim, o autor era capaz de fazer cál-
culos de escoamento e de distribuição de poros e gargantas sobre a rede.

Chatzis e Dullien (1977) ampliaram o modelo para três dimensiões.
Eles tentavam aproximar a estrutura interna do arenito com reticulados re-
gulares. Tal abordagem foi também utilizada mais tarde para a criação de
arenito por métodos estocásticos para representação de arenitos (BAKKE;
OREN, 1997; LERDAHL; OREN; BAKKE, 2000).

Rochas homogêneas possuem estruturas conhecidamente regulares e
portanto representá-los por métodos estocásticos tem bons resultados. O
mesmo não acontece para as rochas heterogêneas, pois sua irregularidade e
variabilidade são bem maiores quando comparadas as primeiras. As rochas



29

Figura 2: Rede de poros para uma amostra de rocha carbonática. Observa-se
a irregularidade nos tamanhos e conexões dos poros e gargantas resultantes

carbonáticas heterogêneas, por exemplo, são fruto de complexos processos
diagenéticos químicos e biológicos, os quais as transformam. A modelagem
dessas é mais complexa e métodos recentes atuam direto sobre o volume bi-
narizado, na tentativa de extrarir uma rede de poros e gargantas, onde regiões
de acúmulo de fluido são identificadas como sendo poro e regiões estreitas en-
tre dois poros são definidos como sendo gargantas (AL-KHARUSI; BLUNT,
2007; DONG; BLUNT, 2007; SCHENA; FAVRETTO, 2006).

Existem algoritmos os quais geram uma rede de poros a partir de um
dado volume tomográfico de rocha. Entre eles estão o método baseado em
processos (PB) (OREN; BAKKE, 2002), extração rápida de rede (SCHENA;
FAVRETTO, 2006) e esferas máximas (MB) (DONG; BLUNT, 2007; AL-
KHARUSI; BLUNT, 2007). A partir desses, pode-se obter uma representa-
ção a partir do volume inicial que represente o volume de rocha, sendo que o
algoritmo esferas máximas foi criado especificamente para representar rochas
carbonáticas, de difícil representação por métodos estocásticos anteriores. A
figura 2, demonstra a rede final gerada pelo algoritmo para uma amostra de ro-
cha carbonática. A complexidade e irregularidade é evidenciada pela grande
população de poros e gargantas pequenos e mal conectados em contraste com
poucos desses elementos grandes e bem conectados. Na figura 3, apresenta-
se a função de transferência utilizada na visualização da rede. Apesar de não
tradicional, essa função foi usada por apresentar de equivalente poros peque-



30

Figura 3: Função de transferência utilizada para visualização da rede

nos e grandes. Portanto, é possível ver de maneira nítida poros pequenos e
grandes, pelo fato de apresentarem cores bastante diferentes e constratantes.
A função de transferência é editável e tal visualização pode ser facilmente
adaptada.

Recentes avanços em microtomografia tornam as técnicas de extração
rápida melhores e mais próximas dos valores amostrados por técnicas labora-
toriais. A resolução da imagem influencia diretamente na qualidade da rede
extraída, e portanto na precisão da simulação (DONG; BLUNT, 2007; AL-
KHARUSI; BLUNT, 2007; SCHENA; FAVRETTO; PILLER, 2008). Tam-
bém, a utilização de múltiplas resoluções e escalas diferentes tem constituído
um desafio na caracterização do espaço poroso.

1.2 OBJETIVOS

1.2.1 Objetivo geral

O objetivo geral desse trabalho é propor uma metodologia automati-
zada para extrair-se a rede de poros e gargantas de uma amostra microtomo-
gráfica binarizada de rocha, seja ela carbonática ou arenítica, homogênea ou
heterogênea. Esse método deve ser paralelizável e utilizar de técnicas para
diminuir o consumo de memória. A rede gerada deve representar o espaço
poroso e portanto deve possuir uma precisão aceitável com relação a dados já
conhecidos das amostras utilizadas.

1.2.2 Objetivos específicos

1. Implementar um algoritmo de extração de redes de poros e gargantas
que seja capaz de extrair uma rede de poros e gargantas a partir de uma
amostra de rocha, inclusive amostras heterogêneas.



31

2. Detectar pontos passíveis de otimização computacional e de memória
no algoritmo original, incluindo os gargalos para ambos. Também, de-
tectar possíveis falhas do algoritmo original e modificá-lo conforme
necessário.

3. Implementar as otimizações de memória e de tempo computacional cu-
jos impactos sejam maiores no resultado final. Os pontos principais
serão os gargalos identificados anteriormente.

4. Detectar pontos paralelizáveis nas etapas do algoritmo. Implementar as
paralelizações e verificar o ganho de performance em relação a versão
original. A etapa só é considerada rápida se tão eficiente quanto ao
menos uma outra técnica capaz de executar o mesmo volume.

5. Comparar o tempo de execução e os resultados obtidos da versão mo-
dificada dos algoritmos com os resultados da implementação original,
comentando as diferenças entre eles.

6. Utilizar a rede extraída para calcular distribuições de raio e compri-
mento para poros e gargantas. Também, devem ser extraídos resulta-
dos de fator de formação e permeabilidade absoluta para caracterizar-
se o escoamento monofásico pela rede. Por fim, devem ser verificados
possíveis diferenças dos resultados obtidos com relação aos originais,
traçando paralelos. Só considera-se como aceitáveis os valores que es-
tiverem na mesma escala de grandeza.

1.3 A RESPEITO DA LEITURA DESTE TRABALHO

Nesta seção são definidas as convenções de nomes e de notações uti-
lizadas nesse trabalho. Por exemplo, os termos cpu e gpu são utilizados na
forma minúscula e sem itálico porque visa-se facilitar a leitura do texto e di-
minuir a atenção para termos tão utilizados. Os termos cluster, grid, threshold
e engine são mais utilizados que suas traduções para a língua portuguesa,
agregado, grade, limiar e motor, respectivamente e, portanto, são usados em
seu lugar. Também, os termos thread, hardware e multithread que não pos-
suem equivalentes são utilizados, sem ênfase alguma.

Algumas abreviações serão feitas, pois alguns termos são bastante re-
correntes no texto:



32

Termo Abreviação
Rede de poros e gargantas RP

Esferas máximas MB

Esferas máximas exatas EMB

Método de Lattice-Boltzmann LBM

Método baseado em processos PB

Extração rápida de rede FNE

Single thread, Single threaded ST

Multithread, Multithreaded MT

Vale observar que o para o MB, existem partes no texto em que se fala
em Megabytes, cuja abreviação é a mesma. Essas partes são todas bem con-
textualizadas e não há confusão de forma alguma. Também, o EMB é o nome
dado a adaptação do MB definida neste trabalho. As abreviações de single
threaded e multithreaded são utilizadas nos gráficos de modo a diminuir o
tamanho das legendas referentes, mantendo a atenção aos gráficos em si.

As duas workstation utilizadas em todos os testes deste trabalho, pos-
suem a seguintes configurações:

Identificador M1 M2
CPU Intel Core i5 x4

2.80Ghz
AMD Phenom x4
2.60Ghz

GPU Geforce GT 210
512MB

Geforce GTX 560
1024MB

MEM 8GB 4GB

SO Linux x86_64,
Kernel 3.0.0-15

Linux x86_64,
Kernel 3.0.0.0-15

GCC GCC 4.6.1 GCC 4.6.1

LLVM/CLANG LLVM/Clang 2.9 LLVM/Clang 2.9

Em todos os valores descritos em tabelas o descriminador decimal será
o ponto ao invés da tradicional vírgula da língua portuguesa. Essa mudança
foi feita de modo a facilitar a integração com o latex e a linguagem de pro-
cessamento estatístico, chamada R. Acredita-se que tal mudança não fere a
língua referente e menos ainda o entendimento deste trabalho.

O capítulo 2 trata do estado da arte e faz uma revisão sistemática da
literatura, terminando com a metodologia adotada para a explanação e de-
monstração dos resultados obtidos. A aquisição e o processamento de dados
microtomográficos são o alvo de estudo do capítulo 3. Já a parte de proces-
samento dos meta-dados é motivo de estudo no capítulo 4. A caracterização
e obtenção de dados encontra-se no capítulo 5. Por fim tem-se o apêndice
com figuras, gráficos e tabelas que demonstram os resultados obtidos e não
descritos no decorrer do trabalho.



33

2 REVISÃO SISTEMÁTICA DA LITERATURA

Esse capítulo segue as convenções de revisão definidas no relatório
técnico de Kitchenham (2004) e é padrão em todas as dissertações Instituto
Nacional de Convergência Digital (INCOD).

Nas seção 2.1, as palavras-chaves e métodos de definição dos trabalhos
correlacionados a esse trabalho são descritos exaustivamente. A seção 2.2
define uma revisão do estado da arte na área. Em seguida, na seção 2.3,
tem-se uma definição da metodologia que será utilizado nos demais capítulos
do trabalho para explorar-se e desenvolver o problema de caracterização e
extração de redes de poros e gargantas.

2.1 IDENTIFICAÇÃO DA PESQUISA E SELEÇÃO DOS ESTUDOS

Analisou-se os artigos publicados em anais de congresso, artigos com-
pletos e teses publicados entre 1960 a 2011. Os mecanismos de busca, Google
Scholar, ACM Digital Library, Society of Petroleum Engineers, Springerlink
e ScienceDirect. Para identificar-se os possíveis trabalhos relacionados, fo-
ram utilizados alguns critérios de inclusão e exclusão, os quais levaram à
escolha dos dados a serem extraídos e por fim aos dados brutos.

2.1.1 Critérios de inclusão

A partir dos artigos filtrados de acordo com pelo menos uma das se-
guintes palavras, presentes nas palavras-chaves ou resumo: pore, space, pore
space, pore media, pore network, fluid simulation, simulation, fluid, permea-
bility, relative permeability, absolute permeability, lattice-boltzmann method,
numeric, fluid, solver, extracion, network.

Os artigos e teses iniciais foram filtrados de acordo com a relevância,
critério esse, definido pelo mecanismo de busca e pelos fatores já citados.
Somente os quinze primeiro trabalhos de cada busca foram levados em consi-
deração, tendo em vista que os resultados acima desse valor raramente terão
algum conteúdo referente ao de interesse.

Os trabalhos não analisados os quais foram encontrados como rele-
vantes no estado da arte dos trabalhos analisados ou que foram considerados
uma referência mais original quanto aos conteúdos pesquisados foram incluí-
dos também.



34

2.1.2 Critérios de exclusão

Foram excluídos os trabalhos os quais eram estritamente de cunho ge-
ológico ou não possuíam nenhum tipo de comparação a uma técnica compu-
tacional. Também, os trabalhos cujas técnicas aplicadas não foram utilizadas
em cálculos para volumes tridimensionais e os trabalhos que eram unicamente
experimentais, i. e, não definem novas técnicas ou modificações a técnicas
computacionais existentes.

Foram removidos também aqueles que não eram mais originais que
os artigos os quais referenciavam, para uma dada pesquisa, sendo portanto,
substituídos pelo mais original. Também, aqueles cuja pesquisa não eram
relacionadas ou relacionáveis à caracterização do espaço poros em rochas.

2.2 ESTADO DA ARTE

Quanto à construção de redes a partir do espaço poroso, existem três
principais métodos: esferas máximas, métodos do eixo médio e o método
baseado em processos.

2.2.1 Métodos do eixo médio

Os métodos do eixo médio, também conhecido como esqueleto, do
espaço poroso classificam determinadas regiões como pertencentes à garganta
ou ao poro por diferentes heurísticas.

O método de extração rápida, proposto por Schena e Favretto (2006)
é um dos métodos dessa classe. Tal método depende de como são classifi-
cados poros e gargantas, ou seja, do critério usado e é possível obter valores
de permeabilidade e de transporte utilizando-se as seções transversais ao eixo
médio como referência e calcular a condutância na garganta (SCHENA; FA-
VRETTO; PILLER, 2008). Esse cálculo é feito, utilizando-se método dos
elementos finitos (MEF).

O algoritmo centra-se na extração do eixo médio aproximado de um
volume. O eixo médio é obtido a partir de uma mapa de distâncias exatas,
também chamado de transformada de distâncias exatas e a aplicação de al-
goritmos e procedimentos que refinam e extraem o esqueleto ou eixo médio
aproximado, conforme visto na figura 4.

Após o cálculo do mapa de distâncias exatas, faz-se a extração das
linhas de fluxo, a partir transformada geodésica e seu gradiente normalizado.
Essa etapa de extração é completamente paralelizável e obtém os caminhos



35

Figura 4: Figura que demonstra os resultados para extração do eixo médio
em uma amostra de rocha. Schena e Favretto (2006)

de escoamento dentro do espaço poroso.
Bifurcações do caminho são definidas como nodos da rede. Os seg-

mentos que percorrem dois nodos são definidos como borda da rede. Os
nodos são os poros e o que á entre eles é definido como região de garganta.

A extração de valores de escoamento monofásico e valores petrofísi-
cos pode ser feita pela obtenção das secções transversais ao eixo médio apro-
ximado. No trabalho de Schena, Favretto e Piller (2008), tais informações
são encontrados pela aplicação do método dos elementos finitos (MEF) so-
bre o resultado da extração rápida e são ditos como superiores aos resultados
encontrados no método baseado em processos (PB).

2.2.2 Método baseado em processos

O método baseado em processos (PB) foi proposto por Oren e Bakke
(2002) e tem como ponto forte a precisão para volumes homogêneos diversos,
principalmente arenitos. Esse método baseia-se em reticulados regulares para
a construção do volume de maneira estocástica (BAKKE; OREN, 1997).

Inicialmente, a técnica assume que todos os grãos são esferas. A partir
dos grãos iniciais, aplicam-se três processos distintos de modelagem e modi-
ficação dos grãos: a sedimentação, compactação e diagênese.

A sedimentação é feita por grão e pode ser de baixa energia ou alta
energia. Na de baixa energia, os grãos são escolhidos de maneira aleatória
e cria-se um campo gravitacional que faz com que ele caia sob a ação de
seu próprio peso até atingir um mínimo local. Assim, ele para ao atingir o
fundo da amostra ou outro grão. Em contrapartida, na sedimentação de alta



36

Figura 5: Corte transversal de uma amostra de arenito do Mar do Norte, do
trabalho de Oren e Bakke (2002)

energia, forças laterais como ondas e fluxos empurram lateralmente o grão,
diminuindo a influência da força gravitacional atuando sobre o grão. Isso é
feito no PB depositando-o no ponto de mínimo global, implicando em uma
maior aglomeração de grãos e menor porosidade.

A compactação é a reação ao estresse vertical imposto sobre o volume
rochoso. É modelado no PB a partir da fórmula:

Z = Z0(1??z)

Onde Z é a nova posição vertical, Z0 é a posição original e ?z é o fator
percentual de compactação, definido entre zero e um. O resultado da compac-
tação é que alguns grãos podem se interpenetrar. Isso é considerado adequado
pelo modelo e o volume excedente é considerado perdido ou transferido para
fora do sistema.

Diagênese é o nome dado a processos químicos, biológicos ou físicos
que ocasionam desidratação, cimentação, dissolução, entre outros. Somente
os processos de supercimentação do quartzo e da formação autigênica de ar-
gila na superfície do grão são modeladas por aproximações conhecidas de tais
fenômenos.

O resultado final do PB é bem de acordo com o encontrado em areni-



37

Figura 6: Exemplo de configuração para descoberta de poros e gargantas, por
Hu Dong (DONG; BLUNT, 2007)

tos do tipo Fontainebleau. Contudo, a modelagem por processos para rochas
heterogêneas é dificultosa, sobretudo pela origem complexa da rocha cujos
fenômenos são difíceis de serem modelados. A figura 5 demonstra uma ima-
gem obtida por back-scattered electrons (BSE), ou microscópio eletrônico de
varredura (MEV). Observa-se na figura, em preto os poros, em cinza claro os
grãos e em cinza escuro a argila. O PB é capaz de modelar redes de poros e
gargantas a partir de imagens como essa.

Os cálculos de condutância, e consequentemente de permeabilidade,
são obtidos por meio de seções transversais extraídas do volume em amostra-
das em diversos ângulos (OREN; BAKKE, 2002). Por fim, a rede pode ser
criada a partir de um modelo prévio da rede e os mesmos cálculos serem feitos
na rede calculada (VALVATNE et al., 2005), incluindo cálculos multifásicos.

2.2.3 Esferas máximas

As esferas máximas, método proposto por Al-Kharusi e Blunt (2007),
é baseado no trabalho de Silin, Jin e Patzek (2003), utilizado para calcular a
morfologia em amostras de rochas heterogêneas. No método proposto por Al-
Kharusi, as esferas são classificadas em uma hierarquia. Elas são classificadas
em mestras, escravas ou cluster, sendo que o último pode ser limitados ou
não. Cada cluster pode possuir filhos, assim como as mestras e escravas.



38

Figura 7: Visão geral do algoritmo de esferas máximas

Assim, tem-se uma hierarquia que define, segundo um conjunto de regras,
poros e gargantas.

O trabalho de Dong e Blunt (2007) seguiu a mesma ideia, porém eles
partem das esferas de raio maior, para as esferas de raio menor, aglomerando
as esferas que se intersectem e gerando gargantas no encontro de duas esferas
com poros pais diferentes. O processo é descrito visualmente na figura 6,
onde há dois poros ligados por uma garganta. O intuito das modificações foi
definir modificações sobre o algoritmo de Al-Kharusi de modo a ele consumir
menos memória e processamento. Gargalos esses, identificados pelo próprio
autor (AL-KHARUSI; BLUNT, 2007).

Os algoritmos de extração automatizada de uma rede de poros e gar-
gantas usando o algoritmo de esferas máximas seguem o pipeline demons-
trado pela figura 7. O MB é o único dos algoritmos citados que possui eficácia
conhecida na literatura para extração de rede de poros de amostras heterogê-
neas. O método foi proposto para a caracterização dessas. Por esse motivo,
ele foi o escolhido para implementar-se a modificação descrita nesse traba-
lho. Em seguida, descreve-se o método que será utilizado nesse trabalho para
fazer-se as modificações ao MB.

2.3 MÉTODO

Inicialmente, será feita um levantamento dos volumes de interesse
para esse trabalho, com relação aos trabalhos anteriores do MB. Alguns dos
volumes utilizados nos trabalhos base do algoritmo encontram-se disponíveis
para uso. Tais volumes devem ser descritos e o processo para chegar-se até



39

Figura 8: Todas as esferas, não contidas em nenhuma outra, que representam
a distância até o voxel não poro mais próximo.

eles, em sua forma binarizada. Ao mesmo tempo, deve-se propor uma técnica
para compressão desses volumes binarizados para que eles utilizem o menos
de memória e espaço em disco. Assim, tem-se mais espaço em memória para
a execução do algoritmo em si.

Para cumprir com o objetivo de acelerar e modificar o algoritmo MB,
deve-se primeiro levar em consideração as principais etapas do algoritmo e
os dados de entrada e saída deles. Deve ser selecionado um conjunto de algo-
ritmos os quais sejam capazes de suprir, de forma ótima, ou seja, com maior
eficiência, os requisitos de aceleração e paralelização do algoritmo em uma
dada plataforma e testá-los. Dos algoritmos relevantes obtidos, tem-se aque-
les os quais existem etapas seriais. Elas devem ser identificadas, caso existam,
pois elas que definirão o máximo de desempenho obtido ao paralelizar-se o
problema.

Para obter resultados mais eficientes em relação ao algoritmo MB,
pretende-se utilizar implementações paralelizadas, em cpu, para todos os al-
goritmos e estudar implementações em gpu, para partes específicas das etapas
gerais, comparando-as com a chamada versão ouro, em cpu. A exploração de
paralelismo no algoritmo de esferas máximas é pioneira na literatura. Para
outras técnicas menos recentes, como o LBM existem muitas implementa-
ções paralelizadas, mesmo em gpu (FAN et al., 2004; BERNASCHI et al.,
2010).



40

Trazer o algoritmo de esferas máximas inteiramente para a gpu se-
ria uma tarefa hercúlea, já que existem etapas completamente sequenciais na
aglomeração original. Também, não se trata de um algoritmo único, mas um
conjunto de passos os quais individualmente são mais simples de compre-
ender e implementar. As esferas, após a aglomeração, são todas as esferas
expostas na figura 8. A cor representa o tamanho do poro o qual a esfera foi
aglomerada e as esferas pertencentes a gargantas não estão representadas.

Será implementada uma versão sequencial, em cpu, do esferas máxi-
mas, exportando o resultado para o solver proposto por Valvatne et al. (2005),
o qual simula a fase água e fase óleo da extração de fluído a partir de uma rede
de poros de entrada. A partir da comparação dos resultados de permeabili-
dade, principalmente a absoluta, faz-se um comparativo quanto a exatidão do
resultado obtido em relação aos resultados de outros métodos para as mesmas
amostras.

Essa implementação inicial será feita sobre as bibliotecas C3DE (Cy-
clops 3D Environment) (SILVA et al., 2009), inicialmente utilizadas para vi-
sualização e processamento de volumes médicos, porém adaptada para o pro-
cessamento de dados de microtomografia de rocha.



41

3 PROCESSAMENTO E ANÁLISE DE DADOS
MICROTOMOGRÁFICOS DE ROCHA

Nesse capítulo, define-se como ocorre a aquisição de dados microto-
mográficos de rocha e qual processamento é necessário sobre esse volume
de dados brutos para obter-se uma amostra binária, representando o espaço
poroso e a rocha. Também, serão apresentadas técnicas as quais permitem o
processamento e visualização de grandes volumes de dados e os volumes de
dados utilizados em várias partes desse trabalho.

3.1 AQUISIÇÃO DE DADOS

Existem vários métodos utilizados pela indústria para extrair-se dados
petrofísicos de uma amostra de rochas qualquer, como a dolomita da figura
9b. Dentre essas técnicas destacam-se duas: porosimetria por injeção de
mercúrio e processamento de amostras microtomográficas.

A porosimetria por injeção de mercúrio, proposta por Washburn (1921)
e aplicada em laboratório por Henderson et al. (1940). Tal técnica, baseia-se
no fato do mercúrio ser um fluido não-molhante em relação a várias subs-
tâncias, incluindo os materiais rochosos, e portanto, não penetra em vulgos
e fissuras de maneira espontânea, ou seja, é necessário aplicar pressão sobre
ele para que isso aconteça.

A microtomografia computadorizada de rochas obtém fatias bidimen-
sionais, ou seja, imagens de secções transversais alinhadas. O empilhamento
dessas imagens gera um volume microtomográfico. Analisando-se o volume
por um modelo de análise de espaço poroso é possível obter características do
espaço poroso. Uma vantagem desse método é a possibilidade de reutilizar-se
a amostra para obter novos dados microtomográficos. Também, os avanços
na resolução e qualidade desse tipo de reconstrução que refinam o resultado
dos modelos aplicados sobre ele.

3.1.1 Porosimetria por injeção de mercúrio

O teste é feito introduzindo a amostra em um recipiente dotado de um
capilar, no qual a amostra encontra-se em condições de vácuo. Assim, ao
injetar-se o mercúrio no recipiente, preenchendo também o capilar, e aplicar-
se uma pressão para que o mercúrio adentre as fissuras e vulgos, tem-se a
quantidade de líquido reduzido no capilar. É possível calcular uma curva de



42

(a) Recipiente para cálculo da porosimetria (b) Amostra de dolo-
mita do período siluri-
ano

Figura 9: Configuração de porosimetria por injeção de mercúrio e uma amos-
tra real

penetração no volume de amostra, para cada pressão aplicada e extrair valores
de distribuição de poros de maneira direta. Por um pós-processamento apro-
ximado também obtém-se a permeabilidade absoluta. Contudo, essa técnica
é destrutiva, arruinando a amostra para qualquer uso futuro. Uma visão geral
desse processo pode ser observada na figura 9a.

3.1.2 Microtomografia computadorizada

A microtomografia provê uma maneira de analisar-se o volume da
amostra computacionalmente, possibilitando assim o reuso dessa em outras
microtomografias. Assim, pode-se obter imagens distintas em resoluções dis-
tintas para o mesmo volume. Isso possibilita a utilização de dados multi es-
calares. A microtomografia também dá uma ideia visual da forma do espaço
poroso interno.

A amostragem dá-se da seguinte forma: o volume é centrado no mi-
crotomógrafo. Ele é rotacionado, pelo sistema de movimentação controlada
do tomógrafo e o perfil de projeção atenuado é obtido pelas amostras em vá-
rios ângulos. Finalmente, os dados tridimensionais dos cortes transversais
do volume são reconstruídos no formato de imagem pelo próprio microto-
mógrafo. O resultado final são imagens transversais em tons de cinza. O



43

Figura 10: Obtenção das imagens e pipeline de processamento típico para
amostras de rocha, por Fernandes, Appoloni e Fernandes (2009)

processo geral é observado na figura 10.
A partir das imagens obtidas pode ser feito o processamento de inú-

meras propriedades petrofísicas. Entretanto, não é possível calcular essas
propriedades sem um pré-processamento que defina para os algoritmos sub-
sequentes quais partes do volume são espaço poroso e quais são rocha. Essa
etapa exige um processamento para definir-se um valor de limiar que defina o
espaço poroso como sendo 0 ou 1 e o rochoso o complementar. Tal processo
denomina-se binarização.

3.2 BINARIZAÇÃO DO VOLUME DE DADOS

A binarização dá-se por uma função T de thresholding a qual defina,
para cada pixel px,y ? I , sendo I a imagem original:

px,y = T (px,y)

T (x) =

{
1, x &gt; ?
0, x ? ?



44

? é o valor do threshold em si. É possível calcular esse valor de forma
automática, ou selecionar-se manualmente. Uma forma de selecionar-se auto-
maticamente o valor de threshold é pela mediana ou média (SEZGIN; SAN-
KUR, 2004). Outra maneira, é a avaliar-se o histograma da imagem e des-
cobrir o ponto de mínimo entre duas populações. O algoritmo 1, demonstra
uma maneira robusta e iterativa de obter-se o valor de threshold, na tentativa
de achar o ponto de mínimo entre duas populações.

Algoritmo 1: Obtenção do valor de thresholding automático
entrada: Ii a imagem de entrada; t0 o "chute"de threshold inicial
saída : o valor de threshold
t ? t0;
while t 6= t0 do

m0 ? c0 ? 0;
m1 ? c1 ? 0;
for px,y ? Ii do

if px,y ? t then
c0 ? c0 + 1;
m0 ? m0 + px,y;

else
c1 ? c1 + 1;
m1 ? m1 + px,y;

t0 ? t;
m0 ?

m0
max(c0,1)

;
m1 ? m1max(c1,1) ;
t ? m02 +

m1
2 ;

return t;

O resultado final da função de thresholding é uma imagem binarizada,
define-se como foreground os pixels em branco e background os pixels em
preto, ou vice-versa. Assim, tem-se na amostra volumétrica de rocha, a defi-
nição da fase porosa e rochosa.

A técnica mais simples de binarização é delegar a escolha do valor de
limiar ao especialista. Essa técnica manual pode ser aprimorada pela escolha
automatizada de um valor inicial. Assim, o especialista pode avaliar se o
resultado foi bom o suficiente ou modificá-lo como desejar.

Existem muitos outros algoritmos que possam ser utilizados no con-
texto de amostras de rocha (SEZGIN; SANKUR, 2004), porém, mais impor-
tante do que a própria binarização é a pré-filtragem do volume amostrado, a
qual influencia diretamente o resultado final da binarização.



45

3.3 FILTRAGEM E TRATAMENTO

Para que o volume binarizado possua características mais homogêneas
e para reduzir-se o número de artefatos provenientes da etapa de aquisição das
imagens, tipicamente faz-se uma pré-filtragem do volume.

Um método bastante robusto para a filtragem do volume é o filtro da
mediana. Para cada subconjunto de n por m pixels, procura-se o elemento
mediano e define-se todos os pixels pertencentes a essa região com o valor
encontrado.

A vantagem desse filtro é a remoção de elementos ruidosos no es-
paço poroso ou na rocha e também pelo fechamento de pequenos buracos
em ambos. Assim menos elementos pequenos, normalmente provenientes de
problemas na aquisição farão parte das etapas de processamento futura. Tam-
bém, modifica-se o histograma da imagem, aglomerando os valores de pixels
em torno de valores mais comuns.

Na figura 11, encontra-se ilustrado a imagem original e a imagem fil-
trada e os histogramas de cada uma. Observa-se que os valores finais são mais
concentrados em torno de pontos de máximo e menos em relação aos pontos
de mínimo. Isso facilita a aplicação de algoritmos que extraiam um valor de
threshold de maneira automática como o descrito na seção 3.2.

Apesar da eficiência na remoção de elementos ruidosos do filtro da
mediana ser inquestionável, outros como o gaussiano e filtros específicos para
remoção de artefatos da etapa de aquisição podem ser utilizados. Como na
binarização, a decisão da necessidade desses pode ser delegada ao especialista
o qual aplicará os filtros conforme desejar.

Após a filtragem e binarização, tem-se o volume binarizado em valo-
res branco e preto, ditos foreground e background, ou vice-versa. Segundo
Lucia (1999), a quantidade de elementos pertencentes ao espaço poroso é a
porosidade ? , definida em função do número de voxels pertencentes ao es-
paço poroso. Considerando-se Vp, o número total de voxels pertencentes ao
espaço poroso e V , o número total de voxels no volume, a porosidade é dada
por:

? =
Vp
V

(1)

Como somente os voxels pertencentes ao espaço poroso são de inte-
resse para a extração da rede de poros e gargantas, a aplicação de técnicas
de compressão tem bons resultados quanto à utilização de memória total dos
sistemas que o fazem. Pela própria simplicidade do volume binário, técnicas
de compressão diversas são eficientes. A compressão run-lenght encoding
(RLE) é um exemplo.



46

(a) Amostra antes (esq.) e após (dir.) a aplicação do filtro da mediana

(b) Histograma antes (esq.) e após (dir.) a aplicação do filtro da mediana

Figura 11: Amostra de arenito e os histogramas referentes



47

Figura 12: Imagem binarizada, onde i representa as linha e j as colunas

3.4 COMPRESSÃO RLE

Considera-se o seguinte quadro de ocupação de memória em função
do tamanho do volume binarizado, representando com um byte por voxel:

Lado em pixels 64 128 256 512 1024 2048 4096
Memória (MB) 0.25 2 16 128 1024 8192 65536

Percebe-se o grande crescimento na ocupação de memória, ainda mais
se considerado que essa ocupação dá-se pelo fato da representação utilizada
ser a mais simples, isso é, ela não leva em consideração a possibilidade de
redundância na representação do volume e a representação binária. Gasta-se
um espaço, em disco e em memória, demasiadamente grande para representar
o volume dessa forma, sobretudo ao considerar-se a possibilidade de repre-
sentar esse volume inteiramente na gpu.

A fim de representar-se a imagem 12 da maneira tradicional, assumindo-
se que a coluna é mais variante, como uma sequência de pixels onde o valor
do pixel é dado por W, se branco e B se preto, a representação extensiva da
imagem seria W, W, W ..., B, B, W, W, B, B, W, ..., W. Ou seja, um va-
lor branco ou preto definido para cada pixel da imagem. Tal solução é dita
como uma imagem raw, ou bruta, e não possui nenhum tipo de compressão.
Para volumes muito grandes, conforme já visto, a utilização de compressão é
primordial.

O run-length encoding (RLE) é uma técnica para representação com-
pacta de dados. Ao invés de representar-se os dados extensivamente, pode-
se representar somente os segmentos de elementos repetidos, isso é, para a



48

mesma imagem, a representação ficaria 9W (nove brancos seguidos), 2B (2
pretos seguidos), 2W, 2B, 2W, 2B, ..., e assim por diante. Um problema dessa
representação é que para acessar-se aleatoriamente qualquer elemento do vo-
lume, algo amplamente utilizado em algoritmos de processamento diversos,
tem-se uma complexidade O(logn), onde n é o número de pixels existentes na
imagem. Tal técnica pode ser vista na seção 4.5.

Para aumentar-se a eficiência da busca aleatória na imagem, faz-se
uma compressão RLE por linha, diminuindo o fator n do número de pixels
da imagem para o número de pixels por linha. Assim, tem-se um melhor de-
sempenho numa busca aleatória qualquer e é possível recuperar, em tempo
linear, qualquer linha do volume. Algoritmos inteligentes, que assumam essa
representação ótima por linha, podem ser mais eficientes que algoritmos des-
preparados para acessar a imagem dessa forma.

A mesma representação, exemplificada na imagem, pode ser utilizada
em um volume. Ainda é possível comprimir-se por linha e acessar-se ale-
atoriamente os dados no volume. Portanto, para aplicar esse algoritmo de
compressão basta aplicar a ideia a um formato padrão, que no caso desse
trabalho é o RBV. A descrição encontra-se na seção 7.1.

3.5 VOLUMES

Nessa seção, define-se os volumes utilizados, classificando-os em três
tipos diferentes: Arenitos, definidos pela consoante S seguida de um número,
e.g., S1, S2, S3. Carbonatos, definidos por um C seguido por um número, por
exemplo, C1, C2, C3, e amostras sintéticas, definidas por um A seguido por
um número, isto é, A1, A2, A3... A tabela 2, demonstra imagens de cortes
transversais dos volumes utilizados, com as nomenclaturas devidas, seguidas
de suas dimensões, porosidades e resoluções.

Os arenitos S1 a S9 e os carbonatos C1 e C2 são volumes de dados
disponibilizados pelo Imperial College London e são amostras as quais foram
usadas no trabalho de Dong e Blunt (2007).

Na figura 13, observa-se a memória ocupada, em MB, dos volumes
de entrada, para o formato RBV e para o formato RAW. Os arenitos S1 a S9
e a A1 são todos volumes de dimensões 3003, e ocupam, sem compressão,
aproximadamente 25 MB em memória cada. Na A1 a taxa de compressão é
menor pois é uma amostra com poros bastante irregulares e com porosidade
alta. As amostras carbonáticas são maiores, ocupando até 70 MB. Para volu-
mes grandes, com dimensões maiores que 10243 o espaço ocupado salta para
casa dos GB. Assim, tem-se a necessidade de compressão, sobretudo para
ser possível processar esses volumes maiores em máquinas não dedicadas a



49

S1 S2 S3 S4
300x300x300 300x300x300 300x300x300 300x300x300

Porosidade: 14.13% Porosidade: 24.26% Porosidade: 16.85% Porosidade: 17.12%
Resolução: 8.68µ m Resolução: 4.95µ m Resolução: 9.1µ m Resolução: 8.96µ m

S5 S6 S7 S8
300x300x300 300x300x300 300x300x300 300x300x300

Porosidade: 21.13% Porosidade: 23.95% Porosidade: 25.04% Porosidade: 33.98%
Resolução: 3.99µ m Resolução: 5.1µ m Resolução: 3.80µ m Resolução: 4.89µ m

S9 S10 S11 C1
300x300x300 400x400x400 300x300x300 400x400x400

Porosidade: 22.17% Porosidade: 19.80% Porosidade: 23.21% Porosidade: 23.26%
Resolução: 3.38µ m Resolução: 2.4µ m Resolução: 3.4µ m Resolução: 2.85µ m

C2 C3 C4 A1
400x400x400 416x416x400 322x322x418 300x300x300

Porosidade: 16.83% Porosidade: 10.95% Porosidade: 03.19% Porosidade: 42.86%
Resolução: 5.34µ m Resolução: 3.6µ m Resolução: 0.36µ m Resolução: 3.85µ m

Tabela 2: Imagens de seções transversais dos volumes de entrada, com suas
dimensões, porosidades e resoluções. A fase poro está em branco



50

S1 S2 S3 S4 S5 S6 S7 S8 S9 S10 S11 C1 C2 C3 C4 A1

RBV

RAW

0

10

20

30

40

50

60

70

M
e
m

ó
r
ia

 (
M

B
)

Volume

Figura 13: Espaço absoluto, em MB, dos RBVs e RAWs

processamento ou clusters.
Os valores percentuais de compressão variam de aproximadamente

6.5% a 20% para os volumes de entrada, conforme observado no gráfico 14.
O fator que mais afeta a performance de compressão não é a porosidade do
volume em si, pois o formato RBV representa segmentos de pixels e não seus
valores diretamente. Assim, o que mais afeta a taxa de compressão são infor-
mações ruidosas e amostras cujo espaço poroso e rochoso são irregulares.

Alguns volumes se destacam na taxa de compressão acentuada. No
caso do C3 e C4, o volume RBV foi bem menor porque os dados porosos
eram esparsos e sua porosidade é baixa. No S11, o volume de poros é de-
masiadamente concentrado se comparado com outras amostras carbonáticas.
Nos arenitos S1, S5, S6, S9 a dupla baixa porosidade e amostra com poros
regulares fazem com que a compressão por faixas de valores seja bastante
eficaz.

A filtragem na etapa de aquisição e a pré-filtragem dos volumes bina-
rizados fazem com que o volume fique mais homogêneo e perca informações
ruidosas. Portanto, contribuem significativamente para a compressão do vo-
lume binarizado e mesmo para a etapa de extração de RP, onde esses voxels
não serão processados e não irão gerar meta-informações.



51

S1 S2 S3 S4 S5 S6 S7 S8 S9 S10 S11 C1 C2 C3 C4 A1

RBV

RAW

0

20

40

60

80

100
P

or
ce

n
ta

g
em

 (
%

)

Volumes

Figura 14: Espaço , em porcentagem, dos RBVs e RAWs

3.6 CONCLUSÃO

O processo de aquisição e filtragem de dados tomográficas tem im-
pacto nas etapas futuras e na compressão do volume binarizado. Nessa etapa,
o expertise do especialista é de fundamental importância, sobretudo na etapa
de aquisição e checagem da qualidade dos dados obtidos. Também, a inten-
sidade da filtragem pode ser parametrizada. Assim, pode-se aplicar filtragens
mais intensas sobre volumes ruidosos e menos intensas sobre outros. Isso
tudo, pode ser delegado ao especialista porque ele possui a fonte de conhe-
cimento do que é um dado amostral bom ou não. Ainda assim, algoritmos
automatizados podem auxiliar e acelerar a decisão.

Nota-se que a taxa de compressão varia conforme a morfologia do
espaço poroso, porém ela não foi maior que pouco mais de 20% para todos os
volumes de entrada, das figuras 13 e 14. Portanto, confirma-se a validade de
tal técnica, principalmente para economia de memória em volumes grandes,
já que tomógrafos recentes são capazes de reconstruir volumes com GB de
dados.

A tabela 2 contém todos os volumes utilizados nesse capítulo e nos
capítulos 4 e 5. O Laboratório de Meios Porosos e Propriedades Termofísicas



52

(LMPT) da Universidade Federal de Santa Catarina disponibilizou as amos-
tras C3, C4, S10 e S11. As outras são idênticas aos volumes utilizados no
trabalho de Dong e Blunt (2007). Pela utilização de vários volumes idênti-
cos, é possível traçar vários paralelos entre a técnica MB e as esferas máximas
exatas (EMB), descrita no capítulo 4.



53

4 EXTRAÇÃO DE REDE DE POROS POR ESFERAS MÁXIMAS
EXATAS

Nesse capítulo são vistos os resultados referentes cada etapa do esfe-
ras máximas (MB) com relação as modificações propostas. Às modificações
feitas sobre o algoritmo MB, dá-se o nome de esferas máximas exatas (EMB).

O algoritmo de esferas máximas possui quatro macro-etapas: a busca
de esferas, a remoção de esferas, a aglomeração e por fim a geração da RP. A
figura 7, apresenta todas as etapas que compreendem o processo automatizado
de geração de RP a partir de um volume de uma amostra de rocha, incluindo
as quatro macro-etapas apontadas.

4.1 BUSCA DE ESFERAS

A etapa de busca de esferas é vital para o processo que sucede, uma
vez que nessa etapa são encontradas todas as esferas que representam a dis-
tância do voxel poro até o rocha mais próximo. Essas esferas, são processa-
das, sendo removidas as esferas que estejam contidas em outras. Somente as
esferas restantes desse último processo são aglomeradas e por fim geram a
RP.

Existem duas vertentes para extrair-se as esferas do volume poroso: o
algoritmo de inflar esferas (DONG; BLUNT, 2007; AL-KHARUSI; BLUNT,
2007) e a extração das esferas por meio de uma transformada de distâncias,
do inglês distance transform (SCHENA; FAVRETTO, 2006).

4.1.1 Algoritmo de inflar esferas

Al-Kharusi e Blunt (2007) e Dong e Blunt (2007) utilizaram a aborda-
gem de inflar as esferas, a partir de cada voxel pertencente ao espaço poroso.
Nessa técnica, o produto final são dois raios diferentes para a esfera: um raio
máximo, denotado por Rmax, definido pela esfera discreta que contém todos
os voxels, incluindo o voxel rocha mais próximo e um raio mínimo, denotado
por Rmin cujo valor é o raio da esfera que inclui todos os voxels menos o voxel
rocha mais próximo.

Tem–se um voxel V1 que é o valor sólido mais próximo do voxel de
interesse V0, pertencente ao espaço poroso. O raio real do voxel, denotado
por Rreal , é algo entre Rmin e Rmax e é definido, em espaço euclidiano, por:



54

Figura 15: Configurações de intersecção com pixel rocha em cinza e raios em
várias cores. O esquema de Dong e Blunt (2007) (direita) e o esquema com
esferas de tamanho exato (esquerda)

Rreal = dist(V1,V0) (1)

Rreal =
?
(x1 ?x0)2 +(y1 ?y0)2 +(z1 ?z0)2 (2)

Pelo fato de levar-se em consideração a distância no espaço tridimensi-
onal para construir-se a esfera de raio Rmin e Rmax, é impossível, sem analisar-
se novamente o volume, obter-se o raio Rreal a partir de ambas.

Conforme definido por Dong e Blunt (2009) tem-se que se uma esfera
S0, com Rmin = R0, está contida em outra, S1, com Rmin = R1, então na figura
15, as esferas cujo Rmin =

?
2, não deveriam ultrapassar a barreira imposta

pelos pixels que denotam o sólido e se intersectar. Segundo a equação de
intersecção definida na seção 4.2, isso acontece. Portanto, em etapas futuras,
ao invés de achar dois poros conectados por uma garganta, o algoritmo achará
somente um poro com uma das duas esferas que na versão exata definem
poros sendo a filha direta da outra. Esse fato tornar-se-á mais claro nas seções
4.2 e 4.3.

A figura 16, demonstra os tempos de execução do algoritmo de Dong
para vários volumes de entrada. Observa-se uma grande variação, sobretudo
na etapa de inflar as esferas, e.g., S1 e C1. Achada a evidência do possí-
vel problema com a intersecção que pode ocorrer durante a etapa de busca
sua complexidade não linear, assume-se a tarefa de achar um algoritmo cujo
resultado final seja as esferas achadas no esquema no qual as duas esferas
maiores não se intersectam e cuja complexidade seja mais linear em função
do tamanho do volume de entrada. O mapa de distâncias exatas, também
usada na extração rápida de rede (FNE) de Schena e Favretto (2006), é uma
possível solução.



55

S1 S2 S3 S4 S5 S6 S7 S8 S9 S10 S11 C1 C2 A1

Geração da rede
Aglomeração
Remoção de esferas
Inflar esferas

0

100

200

300

400

500

T
em

p
o 

(s
)

Volumes

Figura 16: Tempo total de execução, em segundos, discriminando as etapas
do algoritmo de Dong e Blunt (2007), para várias entradas

4.1.2 Mapa de distâncias exatas

A transformada de distâncias, sobretudo a de distâncias exatas, é um
pré-processamento típico para o processo de esqueletonização ou extração do
eixo médio (FABBRI et al., 2008; SCHENA; FAVRETTO, 2006; SCHENA;
FAVRETTO; PILLER, 2008). Como entrada para o mapa utiliza-se uma ima-
gem ou volume inicial, binarizado, onde em preto encontra-se a região de
background, e em branco a região de foreground ou vice-versa. É possí-
vel extrair-se um mapa cuja métrica de distância, dependendo do algoritmo,
pode ser qualquer uma escolhida, como a métrica euclidiana, proveniente da
distância euclidiana, definida na equação 2. Outras métricas possíveis são
manhattan, city block que é um caso especial da distância de Minkowski,
Mahalanobis, entre outras.

Aritmética em ponto flutuante, em cpu, costuma ser mais lenta que
a aritmética inteira. Portanto, a métrica de distância euclidiana quadrática,
cujos valores são números inteiros, é mais atraente por possuir complexidade
computacional menor. Muitos dos algoritmos são aplicáveis para ambas as
métricas (FABBRI et al., 2008).

Saito e Toriwaki (1994) propuseram um algoritmo simples, a nível



56

Algoritmo 2: Transformação 1D no sentido frente, conforme pro-
posta por Lotufo, Falcao e Zampirolli (2000)

entrada: Fjk a linha de entrada; Z o conjunto de pixels do
foreground; j a coluna selecionada; k o plano selecionado

saída : G jk A linha da coluna j e plano k transformada
G jk ? Fjk;
mod ? 1;
ult ? 0;
for x = 0 até length(Fi) do

if fx jk ? Z then
if fx jk &gt; ult + mod then

gx jk ? ult + mod;
mod ? mod + 2;

else
mod ? 1;

ult ? fx jk;
else

mod ? 1;
ult ? 0;

de entendimento e implementação, quando comparado a muitos dos outros
existentes. Ele aceita qualquer métrica escolhida e possui bom desempenho
geral, apesar de sua complexidade teórica de O(n3), onde n é o tamanho total
da imagem de entrada (FABBRI et al., 2008). O algoritmo pode ser dividido
três etapas subsequentes: as varreduras 1D, 2D e a 3D.

A primeira parte do algoritmo é o cálculo para distâncias 1D. Dado
uma imagem binária F = { fi jk}, a qual tem R linhas, C colunas e P planos,
calcula-se a máscara 1D a partir de F , gerando a máscara G, da seguinte
forma:

G = { fi jk} (3)
gi jk = min{gi jk +( j?y)2; fiyk = 0,1 ? y ?C} (4)

O algoritmo de varredura 1D, utilizando somente somas para calcu-
lar as distâncias pode ser visto no trabalho de Lotufo, Falcao e Zampirolli
(2000). O processo é visto na figura 17, resultado da aplicação do algoritmo
2. Varre-se da esquerda para a direita e da direita para a esquerda em duas
etapas subsequentes, para todas as linhas do volume calculando-se o próximo



57

Figura 17: Esferas quadráticas após a aplicação da transformação 1D, da
esquerda para direita (figura esq.) e da direita para esquerda (figura dir.)

elemento como um somatório do valor acumulado do elemento anterior. O
valor acumulado vira o valor do elemento toda vez que ele é menor que o va-
lor acumulado. Lembra-se que os valores do background são sempre 0 para
o algoritmo. Esses valores correspondem ao espaço da rocha, nos volumes
microtomográficos processados, já que a região de interesse são exatamente
os poros ou não rocha.

A transformação 2D, por Saito, é visualizada na figura 18. Nela, o
elemento destacado na coluna G está sofrendo uma iteração do algoritmo
de Saito e Toriwaki (1994). No algoritmo 3, demonstra-se a aplicação, no
sentido frente, do algoritmo de Saito para uma coluna G qualquer. Aplicando-
se para cada elemento da coluna G, calcula-se uma imagem H, com distâncias
mínimas em 2D por um algoritmo de dupla varredura, uma para frente e outra
para trás. A aplicação subsequente no sentido oposto transforma G em H.
Matematicamente:

H = {gi jk} (5)
hi jk = min{gi jk +(i?x)2; fx jk = 0,1 ? x ? R} (6)

Por fim, a transformação 3D é feita sobre H, de maneira idêntica a
transformação 2D, trocando-se apenas a direção da busca:



58

Figura 18: Exemplo de transformação do algoritmo de Saito, para uma ite-
ração do algoritmo sobre o elemento destacado na coluna G, cujo resultado
modifica H

S = {hi jk} (7)
si jk = min{hi jk +(k?z)2; fi jz = 0,1 ? z ? P} (8)

Fez-se duas implementações do algoritmo, uma utilizando multithrea-
ding e outra rodando em apenas uma thread. A estratégia da implementação
multithread abordada é similar a de Torelli et al. (2010), onde o volume de
dados é navegado por voxel, linha e plano, nas transformações 1D, 2D e 3D,
respectivamente. O objetivo de tal padrão de acesso a memória é manter-se
a obtenção dos valores no volume por linha, ou seja, diminuir o overhead da
representação comprimida.

A figura 19 demonstra os resultados de execução para vários dados
amostrais, com dados comprimidos ou não. Observa-se as diferenças de
tempo de execução não é da grandeza esperada para as versões com dados
comprimidos ou não. Isso deve-se ao fato da implementação do filtro de Saito
utilizar-se de maneira inteligente dos dados de entrada, acessando-os por li-
nha para manter-se um desempenho linear, mesmo com dados comprimidos.

Os dados comprimidos provocam uma perda de desempenho signifi-
cativa, porém mesmo para esses o desempenho, do mapa de distâncias exatas,



59

S1 S2 S3 S4 S5 S6 S7 S8 S9 S10 S11 C1 C2 A1

?

?

? ?
?

? ?

?

?

?

?

?

?

?

0

1

2

3

4
T

em
p

o 
(s

)

Volumes

?

ST c/ compressão

ST s/ compressão

MT c/ compressão

MT s/
compressão

Figura 19: Tempos de execução para busca de esferas por mapa de distâncias,
single thread (ST) e multithread (MT), em segundos, na máquina M1, para os
dados de entrada em versões comprimidas ou não

Algoritmo 3: Execução no sentido frente do algoritmo de Saito
para a coluna G

entrada: G a coluna de entrada; R o número de linhas no volume
saída : G transformada no sentido frente
for i = 0 até R do

if gi jk &gt; g(i?1) jk then
for n = 0 até R?i do

if g(i?1) jk +(n + 1)2 &amp;lt;g(i+n) jk then
h(i+n) jk = g(i?1) jk +(n + 1)

2;
else

break;

else
hi jk = gi jk;



60

S1 S2 S3 S4 S5 S6 S7 S8 S9 S10 S11 C1 C2 A1
Volumes

G
an

h
o 

d
e 

p
er

fo
rm

an
ce

 (
x

)

0

5

8

22

480

?

?

? ?

?

?

?
?

?

?

?

?

?

?

?

ST c/ compressão

ST s/ compressão

MT c/ compressão

MT s/
compressão

Figura 20: Ganho de performance do mapa de distâncias exatas em relação
ao algoritmo de inflar esferas de Dong. Escala logarítmica

em relação a inflar esferas é de aproximadamente 2 a 455 vezes mais rápidos
para os volumes de entrada, conforme visto na figura 20. Isso dá-se pelo fato
de comparar-se implementações single thread e multithread e também pelo
algoritmo de busca de esferas de Dong ser mais sensível ao volume de en-
trada e a distribuição do espaço poroso, como fica claro em alguns volumes,
e. g. S5, S6, S9, C1.

O mapa de distâncias exatas, obtido por meio da execução do algo-
ritmo de Saito, multithreaded ou não, demonstra-se mais robusto, obtendo
desempenhos similares para volumes diversos e variando mais conforme a
dimensão do volume de entrada, demonstrando assim uma linearidade e um
comportamento previsível, para o caso de volumes de poros. Apesar disso, o
algoritmo gera esferas que podem estar contidas em outras e estas precisam
se não removidas acarretarão um processamento desnecessário nas etapas de
aglomeração e geração da rede.

4.2 REMOÇÃO DE ESFERAS

As esferas resultantes do processo de varredura tem de ser checadas
por um algoritmo de intersecção, com possíveis esferas que estejam contidas



61

Algoritmo 4: Descobre se S0 está contido em S1
entrada: R0 é o raio da esfera S0; R1 é o raio da esfera S1; C0 é o

centro de S0; C1 é o centro de S1
saída : Verdade, se S0 está contido e Falso no caso contrário
v ?C1 ?C0;
dist ?

?
dot(v,v);

rDi f f ? R1 ?R0;
retorna : dist ? rDi f f ;

nela. Senão, persistem muitas informações repetidas nas próximas etapas do
algoritmo, podendo gerar até resultados errados ou alterados para os cálculos
feitos sobre a rede.

Uma maneira de checar-se se uma esfera S0 está contida em outra S1
é verificar se a distância entre elas é menor que a diferença entre seus raios.
Assim:

dist(S1,S0)? R1 ?R0 (9)

A partir da equação 9, se utiliza-se os raios Rmin e Rmax de Hu Dong,
conforme descritos na seção 4.1.1, para intersecção de duas esferas, observa-
se que esferas que fisicamente não se intersectariam o fazem. Isso deve-se ao
fato do valor do raio para Hu Dong ser inteiro e jamais exato.

O algoritmo 4 apresenta em pseudocódigo o proposto por Ericson
(2005), algoritmo que testa se duas esferas estão se intersectando segundo
a equação 9. As entradas são os centros e os raios de duas esferas S0 e S1 e
resultado é se as S0 está contida ou não. A figura 22 demonstra um exemplo
onde as esferas a serem removidas estão destacadas em cinza escuro.

Observa-se na figura 21 que ganho de desempenho, em versão single
thread foram piores que o MB original e, mesmo para versões multithreads, o
ganho sobre o MB não foi da mesma grandeza da etapa de busca. Isso deve-
se ao fato do algoritmo de remoção de Dong, utilizar os raios em valores
quadráticos e inteiros para remover as esferas inclusas, enquanto no EMB, a
intersecção é feita de forma exata, pela conversão do raio quadrático inteiro,
obtido pelo mapa de distâncias quadráticas, para valores exatos, em ponto
flutuante, conforme demonstrado na figura 15.

A vantagem de manter-se os valores de distância quadráticas de forma
inteira é a possibilidade de evitar muitas comparações em ponto flutuante,
pois se uma esfera é menor que uma esfera vizinha, ela não pode removê-la.
Mesmo em arquiteturas de cpu modernas, os testes sobre valores inteiros são
mais rápidos do que a comparação em ponto flutuante. No gráfico, parece



62

S1 S2 S3 S4 S5 S6 S7 S8 S9 S10 S11 C1 C2 A1
Volumes

T
em

p
o 

(s
)

0

20

40

60

80

100

120

?

?

? ?

?

?

? ?

?

?

?

?

?

?

?

ST c/ compressão

ST s/ compressão

MT c/ compressão

MT s/
compressão

Hu Dong

Figura 21: Tempos de execução para a remoção de esferas contidas em outras
maiores

Figura 22: Exemplo de caso de remoção de esferas



63

S1 S2 S3 S4 S5 S6 S7 S8 S9 S10 S11 C1 C2 A1
Volumes

?

?

? ?

?

? ?

?

?

?

?

?

?

?

0.0e+00

5.0e+06

1.0e+07

1.5e+07

E
sf
er
as

?

Totais
Removidas pelo MB
Removidas pelo EMB

Figura 23: Esferas encontradas na etapa de busca e o número de esferas re-
movidas, por EMB e por MB

que a versão comprimida praticamente não tem overhead em relação a raw,
contudo isso não é verdade. A versão comprimida possui um tratamento es-
pecial, com um algoritmo único capaz de mudar a complexidade da iteração
sobre as esferas no volume. A modificação é descrita na seção 4.5.

Finalmente, também é possível otimizar a execução do algoritmo pela
ordenação prévia das esferas, tal que esferas pequenas, contidas em maiores,
deixam de ser processadas. Os raios formam um conjunto finito definido,
possibilitando a utilização direta do bucket sort (CORWIN; LOGAR, 2004).

Da aplicação da remoção, por meio do algoritmo 4, resultam as es-
feras que passarão pela etapa de aglomeração. Na figura 23, observa-se o
número de esferas totais, achadas no algoritmo MB e EMB, cujos números
iniciais são idênticos, uma vez que na etapa de busca acha-se o tantas esferas
quantos voxels no espaço poroso. O número de esferas removidas pelo MB é
bem maior porque, conforme visto na figura 15, o raio das esferas para esse é
inteiro e maior que o exato, principalmente para poros grandes. Essa caracte-
rística leva o número final de esferas ser bem menor no algoritmo original.



64

Figura 24: Volume de exemplo e as árvores hierárquicas geradas para os dois
poros com uma garganta G1 ligando-os

4.3 AGLOMERAÇÃO

No passo de aglomeração ou agregação ou ainda aglutinação, tradu-
ções válidas de clustering, o algoritmo MB de Dong e Blunt (2007) difere
bastante do algoritmo de Al-Kharusi e Blunt (2007). Enquanto o último de-
fine, durante a aglomeração, uma hierarquia de conjunto de esferas, Dong
define uma hierarquia direta de esferas, onde a esfera raiz é um poro. Essa
modificação foi imposta para reduzir-se drasticamente o uso de memória que
limitava o uso da implementação de Al-Kharusi, mesmo para volumes consi-
derados pequenos, isto é, com pouco mais de cem voxels de lado. Segundo
Dong e Blunt (2007), a aglomeração pode ser descrita em cinco passos:

1. Após a remoção das esferas inclusas, sobrarão um conjunto de esferas
as quais definem um conjunto finito de raios diferentes. Elas podem ser
ordenadas, novamente por um bucket sort, por exemplo. O resultado é
o vetor de valores Z, ordenado em função do tamanho do raio.

(a) Dá-se a todas as esferas Si ? Z um rank infinito. Esse é definido,
para fins de implementação, como o maior valor inteiro represen-
tável no tamanho de palavra da cpu alvo.

2. Começando-se pela primeira esfera S0, do maior conjunto de raios, Z0,



65

define-se o rank dela como sendo a primeira e um novo nome de família
é gerado e dado a essa esfera. Cada esfera Si que intersecte com ela
recebe o rank de segunda geração. Ainda assim, a esfera recebe o nome
de família de S0. Cada esfera sabe quem é seu ancestral, mesmo que
seja nenhum, como no caso da primeira.

3. Ordena-se então, novamente o conjunto de esferas de mesmo raio, com
os ranks atualizados pela etapa anterior, do menor para o maior. Para
cada esfera Si que ainda não foi visitada, verifica-se se ela já foi visitada
pelo seu rank. Se ela não foi, define-se o rank dela como sendo a
primeira e repete-se a etapa 2 para ela. Se ela foi visitada, então ela
verifica as esferas que intersectam com Si, definidas como o conjunto
C j , e passa-se o nome de família para elas obtido da esfera raiz (poro).

(a) Se alguma esfera S j ?C j já possui um nome de família diferente
do nome da Si, então essa esfera S j define uma garganta e duas
cadeias de esferas serão extraídas a partir dela, uma ligando até o
ancestral de Si e outra ligando ao ancestral já existente de S j .

4. O mesmo processo de ordenação é feito até que todas as esferas do con-
junto Zi sejam processadas. Após serem visitadas todas as esferas do
conjunto Zi, começa-se novamente o processo, visitando-se as esferas
do conjunto Zi+1.

5. Os mesmos processos de ordenação e aglomeração são aplicados para
todos os conjuntos Zi ? Z.

A expansão das gargantas é uma das etapas chaves do MB, uma vez que
é graças a ela que a geometria correta da rede é extraída. Nessa etapa, ao
encontrar-se uma esfera que pertence a garganta, efetua-se o crescimento da
região de garganta em direção aos dois poros envolvidos.

O fator percentual E f , define a razão entre o raio da maior esfera a ser
englobada na garganta e pode ser descrito, tal que se a razão r for menor que
E f , então a esfera é garganta. Para três esferas, a garganta Sg, de raio Rg, a
esfera poro Sp, de raio Rp e uma esfera Si, de raio Ri, a razão é dada por:

r =
Ri

RP ?Rg
(10)

Assim, se r for menor que E f , então a esfera Si faz parte da garganta e
sua ancestral é analisada, até que a razão r seja maior ou igual a E f ou que a
esfera analisada faça parte de um poro. Para toda esfera Si cujo fator é maior
que E f na cadeia, essa esfera torna-se parte do poro.



66

Figura 25: Expansão de gargantas, conforme proposto por Dong. Nesse caso,
o fator E f de expansão é de 70%

A figura 25, demonstra a expansão de uma garganta a partir da desco-
berta esfera que pertence, ao mesmo tempo, a duas famílias diferentes. Todas
as esferas até o ponto de parada farão parte da garganta e se tornarão parte
da região definida por essa. Dong e Blunt (2007) assumiram um fator de ex-
pansão E f igual a 70% é o ponto de parada para o algoritmo de expansão.
Nota-se que na figura a expansão parou na esfera com raio sete, uma vez que
r = 7÷(14?4) = 0,7.

Checou-se que o fator de expansão de Dong foi definido analitica-
mente em função de resultados amostrais de pressão capilar (DONG; BLUNT,
2007, 2009). Como até então, o EMB difere bastante do MB, sobretudo no
volume de esferas processadas durante a aglomeração, decidiu-se utilizar vá-
rios fatores diferentes, os quais serão vistos no capítulo 5 e, espera-se gerar
resultados bastante diferentes, uma vez que o volume, a área e a geometria
dos poros e gargantas influenciam diretamente no cálculo de transporte e nas
propriedades da rede.

Uma vez aplicado o algoritmo sobre as esferas, os resultados finais são
esferas que definem o espaço poroso como garganta, poro ou indefinido. A
figura 24 demonstra uma amostra com suas esferas já definidas. Os poros P1 e
P2 são ligados pela garganta G1, enquanto as esferas em cinza fazem parte do
volume poroso de cada uma. Ambas as hierarquias relativas aos dois poros
são demonstradas abaixo da amostra.

O número de esferas geradas no EMB e no MB estão na figura 26.
Nota-se que o EMB tende a gerar mais poros e gargantas que o MB, mesmo



67

S1 S2 S3 S4 S5 S6 S7 S8 S9 S10 S11 C1 C2 A1
Volumes

?

?

?

?

?
?

?

?

?

?

?

?

?

?

0

5000

10000

15000

20000
E
le
m
e
n
to
s

?

Poros (MB)
Gargantas (MB)
Poros (EMB)
Gargantas (EMB)

Figura 26: Número de poros e gargantas gerados pelo MB e pelo EMB

que em proporções parecidas. Isso deve-se ao fato de mais esferas permane-
cerem no EMB após a etapa de remoção, graças ao algoritmo de intersecção
ser diferente no EMB. No capítulo 5, tem-se a descrição extensiva dos resul-
tados para as amostras de entrada e essa ideia é trazida com mais informações
que formam um plano de fundo para o entendimento das diferenças entre as
técnicas.

Finalmente, os poros e gargantas podem gerar a rede para ser ob-
servada visualmente e os dados petrofísicos e estatísticos podem ser extraí-
dos por meio dela. Contudo o número de poros indefinidos ainda pode ser
grande, sem um pós-processamento adequado sobre o espaço poroso. Esse
pós-processamento é definido na etapa de geração da rede de poros e gargan-
tas.

4.4 GERAÇÃO DA RP

Após a aglomeração, tem-se quais esferas fazem parte do poro e gar-
ganta. As esferas restantes tem de ser caracterizadas como sendo poro, gar-
ganta ou voxel inválido. Essas etapas de pós-processamento refinam o re-
sultado da aglomeração e são, curiosamente, pouco discutidas nos traba-



68

S1 S2 S3 S4 S5 S6 S7 S8 S9 S10 S11 C1 C2 A1

Volumes

?

?

?

?

?

? ?

?

? ?
?

?

?

?

0.00

0.02

0.04

0.06

0.08

P
or

ce
n

ta
g

em
 (

%
)

?

Voxels inválidos (MB)

Voxels inválidos (EMB)

Figura 27: Porcentagem de voxels inválidos, em relação ao total de voxels,
no final do processo para ambos os algoritmos de esferas máximas

S1 S2 S3 S4 S5 S6 S7 S8 S9 S10 S11 C1 C2 A1

Volumes

? ?

?

?

?

?

?
?

?

?

?

?

?

?

0

100

200

300

400

E
le
m
e
n
to
s

?

Inlets (MB)

Outlets (MB)

Inlets (EMB)

Outlets (EMB)

Figura 28: Número de inlets e outlets gerados pelo MB e pelo EMB



69

lhos de esferas máximas anteriores (AL-KHARUSI; BLUNT, 2007; DONG;
BLUNT, 2009, 2007). No fim da aglomeração, é possível que hajam esferas
em regiões de garganta, que se reprocessadas fariam parte dela. Isso é, essas
esferas foram processadas antes de uma de suas vizinhas fazerem parte da
região de garganta.

A fim de eliminar grande parte das esferas indefinidas, percorre-se
as esferas que definam gargantas, em ordem de grandeza, achando esferas
indefinidas que essas intersectem com. Essas esferas são definidas como per-
tencentes a mesma região de garganta. Após essa passada, tem-se uma se-
gunda que define as esferas processadas restantes como sendo parte do poro.
Por fim, tem-se todas as esferas válidas identificadas como poro ou garganta.
Idealmente, todas as esferas encontradas contribuiriam para definição da RP,
porém a irregularidade de alguns volumes e pequenas ilhas de poros descone-
xas. Isso pode ser frutos de filtragens fracas ou incompletas e a consequência
é que parte dos dos voxels pertencentes ao poro sejam invalidados, ou seja,
suas esferas representativas são inválidas.

As esferas inválidas são todas aquelas cujos raios são menores que o
raio mínimo para ser poro e não intersectam com nenhuma esfera que faz
parte do conjunto de poros e/ou gargantas. O gráfico da figura 27, demons-
tra o número de voxels (e esferas) inválidos para vários volumes, no MB e
EMB. Vê-se que o número de voxels inválidos ao final do algoritmo EMB
é maior que no MB. Uma possível explicação é, novamente, o algoritmo de
intersecção de esferas, uma vez que é possível ele retornar esferas isoladas
fisicamente como intersectantes, deixando menos esferas isoladas.

No trabalho de Dong e Blunt (2007), esferas cujos raios são menor
que o mínimo permitido não sejam processadas, e portanto invalidadas se não
forem intersectadas por outras. Isso faz com que trechos estreitos do espaço
poroso, conforme o da figura 15, possam configurar um problema. Contudo,
os valores são pequenos para o EMB e MB, isso deve-se ao fato do pós-
processamento da rede gerada na aglomeração, comentado anteriormente, e
também pela configuração citada ser pouco comum no espaço poroso. Assim,
mesmo que o EMB tenha uma quantidade maior de voxels inválidos, ambos
valores são bastante pequenos.

Por último, define-se quais elementos fazem parte dos inlets e outlets.
Em Al-Kharusi e Blunt (2007), os inlets e outlets são definidos como os poros
cuja posição no eixo de extração seja inferior a 10% ou superior a 90% da
magnitude do eixo, para inlets e outlets, respectivamente. Isso, desde que
com a adição desse elemento ao conjunto referente, esse não ultrapasse 25%
do número total de poros. A figura 29 ilustra a definição de inlets num eixo
de cálculo arbitrário, segundo a definição de Al-Kharusi.

No trabalho de Dong e Blunt (2007), define-se que os inlets e outlets



70

Figura 29: Definição de inlets (esq.) e outlets (dir.), conforme proposto por
Al-Kharusi e Blunt (2007)

são aqueles poros que possuem ligação direta com a borda do volume no eixo
de interesse. Essa mesma definição é válida no EMB porque assim obtém-
se uma representação mais baseada na topologia e conectividade do espaço
poroso real. Também, a definição de Al-Kharusi era válida para volumes
de tamanho pequeno e talvez não possua a mesma validade para volumes
maiores.

4.5 ESTRUTURAS COMPRIMIDAS

As estruturas que armazenam o volume de esferas a partir da etapa
de busca e remoção das esferas possuem um tipo de compressão de dados
similar a compressão sobre o volume RLE, do capítulo 3. Essas estruturas, ao
invés de armazenarem um dado por valor de voxel, armazenam somente os
valores relativos aos voxels representativos do espaço poroso. Isso é, utiliza-
se o mesmo tipo de compressão por segmentos, apresentado no RLE, porém
aplicado a dados não binarizados.

A eficiência final da compressão, depende diretamente da porosidade,
definida na equação 1. Sendo n o número de elementos de tamanho t, o espaço
total ocupado pela estrutura comprimida é o tamanho total, n×t, multiplicado



71

Algoritmo 5: Obtém todos os valores de uma linha do volume,
iterando por segmento

entrada: V é o conjunto de segmentos da linha de interesse, com
os valores dos dados; d é o vetor de saída com um valor
por voxel

saída : O vetor d com os valores da linha de interesse
for i = 0 até i ? length(d) do

/*Todas posições são inicializadas com valores

nulos */

d[i]? ? ;
for v ?V do

for i = v.begin até i &amp;lt;v.end do
d[i]? v.d[i?v.begin];

pela própria porosidade P.
Como, em geral, os volumes apresentam porosidades menor que 50%,

as taxas de compressão são bastante interessantes. Contudo, ainda existe,
como no RBV, o overhead da etapa de busca do valor. Isso é, a complexidade
da busca de um pixel qualquer é log n, para uma linha de tamanho n.

É possível, assim como na busca de valores por linha, trazer a perfor-
mance mais próxima de dados não comprimidos. Para uma busca qualquer,
pode-se obter o segmento relativo a essa busca e iterar os valores vizinhos, na
linha, em função do segmento atual.

O algoritmo 5 ilustra a iteração por segmentos ao invés de obter-se
individualmente cada valor de pixel. Assim, tem-se uma complexidade O(n),
porém, como nem sempre os algoritmos iteram sobre uma linha inteira, pode-
se fazer obter o elemento inicial em tempo log(n) e repetir o processo de
iteração de segmentos até o fim do intervalo desejado. Isso é, a complexidade
final de uma busca, por linha, para n elementos torna-se O(log n + n) ao invés
de O(n log n), que é mais próximo do O(n) original. A contrapartida dessa
técnica é a necessidade de passar um vetor do tamanho da linha do volume,
ou seja, há um consumo maior de memória.

4.6 CONCLUSÃO

Nesse capítulo, definiu-se as diferenças básicas do MB em relação a
outros algoritmos e, ademais, do MB e EMB. Observa-se que a alteração
do método de intersecção para esferas afeta bastante o resultado final da RP.



72

S1 S2 S3 S4 S5 S6 S7 S8 S9 S10 S11 C1 C2 A1

Geração da rede
Aglomeração
Remoção de esferas
Mapa de distâncias

0

20

40

60

80

100

120

T
em

p
o 

(s
)

Volumes

Figura 30: Tempo levado, em cada etapa do EMB, para volumes diversos. O
Fator E f de expansão é 50%

Na figura 23, tem-se o número de esferas totais e removidas em ambos. O
número de esferas remanescentes no EMB é bem maior que no MB o que
afeta diretamente o resultado da rede, na figura 26, onde o número de poros e
gargantas no EMB é constantemente maior que no MB.

Ao analisar-se a rede gerada pelos algoritmos, o MB apresente, em
geral, poros e gargantas maiores, mas o volume poroso representado por am-
bas deve ser o mesmo. Portanto, espera-se que os resultados de cálculo de
permeabilidade absoluta e o fator de forma sejam diferentes para ambos, no
capítulo 5. O que é observado é uma semelhança, principalmente na perme-
abilidade absoluta, porém uma discordância quanto ao fator de forma, com
tendências diferentes.

A variável E f para o MB original é 70%. Decidiu-se que esse valor
poderia não ser o melhor possível, já que o EMB apresenta mais esferas e di-
fere, mesmo em número de poros e gargantas, em relação ao MB. Os valores
de fator de expansão 50%, 60%, 70% e 80% são assumidos nesse trabalho
para ter-se uma amostra significativa que possibilite o estudo de um melhor
valor possível para ele. As figuras 30, e 31 demonstram o tempo de execução
total para cada volume de entrada, e o tempo relativo, levado em cada etapa.

As etapas do algoritmo, não variam muito, relativamente as outras com
a mudança do fator de escala, somente a etapa de geração da rede que torna-



73

S1 S2 S3 S4 S5 S6 S7 S8 S9 S10 S11 C1 C2 A1

Geração da rede
Aglomeração
Remoção de esferas
Mapa de distâncias

0

20

40

60

80

100

120
T

em
p

o 
(s

)

Volumes

Figura 31: Tempo levado, em cada etapa do EMB, para volumes diversos. O
Fator E f de expansão é 80%

se mais custosa porque com um fator de expansão maior, mais esferas são
gargantas e tem de ser pós-processadas. O tempo total, cresce em função do
fator de expansão e tem seu ápice no carbonato C1, variando de 120 segundos,
para E f igual a 50% e 60%, até aproximadamente 140, nos fatores 70% e
80%.

A variação, quase que linear, do tempo levado em função da variação
de E f , caracteriza a robustez atingida com o EMB. No MB, a variação, so-
bretudo na etapa de inflar esferas, faz com que o tempo levado seja bastante
diferente para diversos volumes de entrada. Também, para os vários volu-
mes de entrada, os tempos totais do algoritmo EMB são bem menores que o
MB. Isso deve-se ao fato do conjunto de técnicas de aceleração de para dados
comprimidos aplicados na implementação e também pelo fato de vários algo-
ritmos, principalmente a aglomeração, serem paralelos. Essa última é a etapa
mais custosa do EMB e algumas estratégias para reduzir seu tempo total de
execução são discutidas no capítulo 6.

Conseguiu-se ter um desempenho superior ao MB, cujos tempos de
geração estão na figura 16. Mesmo que as diferenças no EMB façam com
que mais esferas tenham de ser processadas, manteve-se um dos objetivos
deste trabalho porque o tempo total de execução para o EMB foi, em todos
os casos, menor que o MB. Resta apenas descobrir os impactos do algoritmo



74

sobre as propriedades e os cálculos feitos sobre a rede.



75

5 PROPRIEDADES DA REDE E CÁLCULOS DE TRANSPORTE

Nesse capítulo, são abordados as propriedades da rede reconstruída
pela técnica EMB, relacionando-as diretamente com as propriedades da rede
MB, de Hu Dong. Inicialmente, será feita uma comparação lado-a-lado para
um volume amostral de arenito e o mesmo para um volume de rocha se-
dimentar carbonática. Em sequência, serão descritos os valores gerais e as
propriedades para várias redes diferentes.

Na segunda parte, serão abordadas a previsão de transporte referente
as redes, com os valores de permeabilidade absoluta e fator de forma para as
redes EMB e MB.

Todos os valores extraídos foram a partir do resultado do simulador
two phase proposto por Valvatne. O algoritmo MB, de Dong e Blunt (2007),
não foi capaz de gerar todas as redes a partir dos volumes iniciais. Também,
os resultados para as redes que foram testadas não foram idênticos aos da tese
em questão. Assim, assume-se que o problema sejam as variáveis de entrada.

Como o two phase possui muitas combinações de configuração e mesmo
para ele, os resultados variam de acordo com as bibliotecas matemáticas da
plataforma, diferentes em Windows e Linux, e causam diferenças nos resul-
tados. Pelo fato de os dados de entrada do two phase não terem sido definidos
por Dong e Blunt (2007) foi impossível tentar produzir os mesmos resulta-
dos. Mesmo assim, no final do capítulo é feita uma comparação direta com
os resultados da tese em questão. Lembra-se que o valor do fator de expansão
para o MB é sempre 70%, conforme descrito no capítulo 4.

As configurações utilizadas para o two phase e o MB de Dong, neste
trabalho, encontram-se nos anexos, capítulo 7. Entre as inúmeras variáveis
descritas estão a viscosidade dos fluidos envolvidos e pressões de entrada
e saída. Esses parâmetros são para uma simulação multifásica, mesmo que
os valores abordados neste capítulo sejam somente relacionados a variáveis
monofásicas.

5.1 ESTUDO DE CASO S1

O volume S1, visualizado na figura 32, é interessante para estudo, uma
vez que é um volume pequeno, de dimensão 3003, com tempo de geração da
rede pequeno e propriedades bem definidas. Na tese de Dong e Blunt (2007),
valores amostrais para esse rede são determinados, em comparação com Oren
e Bakke (2002). Também, o algoritmo MB gerou redes, em alguns casos, que
não foram possíveis de rodar na implementação de Valvatne, na máquina M1.



76

EMB MB
Porosidade da rede 14.1 14.1
N de poros 2794.0 1868.0
N de gargantas 4371.0 3048.0
N de inlets 117.0 85.0
N de outlets 149.0 124.0
N de isolados 173.0 138.0
Elementos circulares 43.0 0.0
Elementos quadrados 65.0 19.0
Elementos triangulares 7059.0 4899.0

Tabela 3: Características da RP, no EMB e MB, para o volume S1

Figura 32: Rede gerada pelo EMB para o volume S1



77

Nesse trabalho, será feita uma comparação direta de valores amostrais
para o EMB e o MB, ao mesmo tempo introduzindo diferentes variáveis es-
tatísticas de comparação.

Na tabela 3, estão os valores absolutos para várias variáveis da RP nos
dois casos. A porosidade da rede é a porosidade obtida pela soma dos volu-
mes de poros e gargantas dividido pelo volume total. Pelo fato do número de
voxels inválidos variar, a porosidade da rede também não é sempre a mesma
da real, mas nessa RP o valor foi idêntico para o MB e o EMB com uma casa
de precisão.

Na rede gerada pelo EMB o número de poros é 2794, enquanto na
rede gerada pelo MB é 1868, ou seja, o EMB gera 50% poros a mais. Afim
de comparar-se as populações de poros em ambos os algoritmos, utilizou-se a
estratégia de normalizar as populações em função do número total de poros.
Assim, tem-se uma comparação direta da distribuição dos raios de poros para
ambos os resultados.

O número de gargantas geradas no EMB é 4371, enquanto no MB é de
3048. A proporção de poros em relação a gargantas em ambos é por volta de
60%, caracterizando a dissimilaridade no resultado de ambas. Ainda assim, o
EMB gera mais de 40% de gargantas a mais, graças as modificações descritas
no capítulo 4.

Define-se os inlets e outlets conforme o trabalho de Dong e Blunt
(2007), onde a partir de poros que encostam na borda criam-se novas gar-
gantas, conforme descrito na seção 4.4. Os números foram novamente dissi-
milares, 117 inlets e 149 outlets na rede do EMB e 85 inlets e 124 outlets na
rede do MB. Nesse caso, gerou-se mais inlets e outlets no EMB, apesar de
não ser sempre o observado, como nota-se na figura 28.

Elementos isolados, para o simulador two phase, são aqueles elemen-
tos que não possuem, simultaneamente, ligação com o inlets e outlets. Na
RP do EMB constatou-se 173 desses poros enquanto na RP do MB foram
138, ou seja, o primeiro gerou aproximadamente 25% de elementos isolados
a mais. Ou seja, nesse caso, a rede do EMB possui mais poros e esses são
mais conexos, percentualmente uma vez que, como já constatado, essa rede
tem 50% de poros a mais que a do MB.

Na tabela 3, define-se os valores para elementos circulares, quadrados
e triangulares. O número de elementos triangulares é maior para as duas
redes, contudo para a rede do MB, o número de elementos circulares chega a
zero e a proporção de elementos triangulares é bem maior, chegando a mais
de 99%. Esse fato será abordado na seção 5.5.1.



78

1 2 3 4 5 6 7 8 9 10 12 14 16 18 20 22

MB

EMB

0

5

10

15

20

25

30

F
re

q
u

ên
ci

a 
(%

)

Número de coordenação

Figura 33: Frequência do número de coordenação nos algoritmos EMB e MB
para o volume S1

5.1.1 Número de coordenação

O número de coordenação é uma variável tipicamente utilizada em
caracterização atômica de materiais. É, para a rede de de poros, uma proprie-
dade importante por denotar a conectividade interna da rede, isso é, o quanto
os poros internos da rede encontram-se conectados. O número de coordena-
ção para um poro qualquer é o número de gargantas que ligam ele a outro
poro.

A figura 33 apresenta as frequências percentuais do número de coor-
denação no volume S1, para todos os poros da RP. O MB parece apresentar
maiores frequências em números de coordenação maiores e nos poros com
apenas uma conexão. Nota-se uma grande concentração de uma a quatro co-
nexões, representando em ambos os casos mais de 70% do total de poros.

Pelo fato de muitos poros pequenos terem sido removidos a mais na
etapa de remoção de esferas inclusas em outras, graficamente apresentado na
figura 21, sobram mais poros maiores, mais bem conectados que os poros
pequenos e desconexos remanescentes. Assim, esse resultado talvez seja pro-
veniente das diferenças entre nas intersecções esfera-esfera entre o EMB e
MB. Também, como os valores são em frequência, os poros maiores no EMB



79

12 25 37 50 62 75 87 100 124 149 174 199

MB

EMB 0.5

EMB 0.6

EMB 0.7

EMB 0.8

0

10

20

30

40

F
re

q
u

ên
ci

a 
(%

)

Raio (micrometros)

Figura 34: Distribuição de raios de poros para ambos algoritmos. Fatores de
expansão 50%, 60%, 70% e 80% para o EMB

ficam obscurecidos pelo maior número total de poros, quando comparado ao
MB.

Apesar de interessantes, os números de coordenação do S1 não são
suficientes para extrair-se dados conclusivos. Faz-se necessário um estudo
mais profundo, com mais dados do mesmo volume e outros, principalmente
com volumes maiores e de diferentes resoluções.

5.1.2 Poros

Sendo Rv o raio extraído do volume esférico total do poro, definido em
função do volume Vp, em voxels do poro. O raio R do poro é idêntico a Rv, o
qual é definido por:

Rv =
3

?
Vp ?

3
4?

(1)

Na figura 34, tem-se as distribuições percentuais de faixas de raios do
MB e do EMB, para os fatores de expansão 50% e 80%, respectivamente.
As faixas 60% e 70% foram omitidas por serem demasiadamente idênticas as



80

198051 594152 990253 1386354 1782455 2178556 2574657 2970758

MB

EMB 0.5

EMB 0.6

EMB 0.7

EMB 0.8

0

10

20

30

40

50

F
re

q
u

ên
ci

a 
(%

)

Volume (micrometros cúbicos)

Figura 35: Frequência dos volumes dos poros para as redes EMB e MB do
volume S1. A última faixa engloba todos os valores maiores que quatro vezes
a média

duas apresentadas.
Observa-se que no MB os poros estão altamente concentrados em va-

lores menores que 50 micrômetros, uma vez que mais de 70% dos poros
possuem raios dentro desse limite. Também, raios maiores que 100 micrô-
metros são praticamente inexistentes para o MB. Em contraste, no EMB os
valores encontram-se menos concentrados em valores pequenos e bem mais
distribuídos variando bem pouco em função do fator de expansão de gargantas
utilizado.

Como os poros apresentam uma distribuição mais acentuada em valo-
res de raio alto no EMB, e uma menor população em valores baixos, acredita-
se que a regularidade e a baixa quantidade de poros pequenos foram bem
extraídas do volume arenítico. Ou seja, a rede EMB caracteriza os poros em
volumes areníticos adequadamente.

Para fatores de expansão maiores, no EMB, os valores encontram-se
levemente mais concentrados nas faixas menores de raio. Ainda assim, visu-
almente, a distribuição dos raios é quase idêntica. Isso deve-se ao fato de, em
geral, o volume do poro ser pouco afetado pela taxa de expansão. Nas gar-
gantas, os fatores de expansão tem impactos bem maiores porque influenciam
diretamente o comprimento e a distribuição desses sobre a RP.



81

34 68 102 170 238 305 373 441 509

MB

EMB 0.5

EMB 0.6

EMB 0.7

EMB 0.8

0

10

20

30

40

50

F
re

q
u

ên
ci

a 
(%

)

Comprimento (micrometros)

Figura 36: Distribuição de comprimentos das gargantas para ambos algorit-
mos no S1. Fatores de expansão 50%, 60%, 70% e 80% para o EMB

5.1.3 Gargantas

O comprimento de uma garganta é definido como a distância entre as
interfaces de poro, isso é, para uma garganta qualquer:

c = dist(S1,S0)?R1 ?R0 (2)

Onde S1 e S0 são as esferas conectadas pela garganta e R1 e R0 seus
respectivos raios, definidos pela equação 1. A função dist retorna a distância
entre os centros de duas esferas.

Na figura 36, demonstra-se os resultados de distribuição de compri-
mento em gargantas. Nota-se um crescimento nas gargantas de maior com-
primento em função do fator de expansão utilizado, conforme é esperado.
Isso demonstra que o fator contribuem, diretamente para o comprimento to-
tal da garganta, ou seja, o comportamento da rede para o aumento do fator é
adequado.

Em relação aos resultados do MB, o EMB apresenta, novamente, va-
lores mais distribuídos. Mais de 90% das gargantas geradas pelo algoritmo
original tem até 100 micrômetros. Mesmo que haja uma grande concentração
nessa faixa, no EMB isso representa pouco mais de 50%. Essas diferenças



82

4 8 12 16 20 24 28 32 36 40 44 48 52 56 60 64

MB

EMB 0.5

EMB 0.6

EMB 0.7

EMB 0.8

0

10

20

30

40

50

60

F
re

q
u

ên
ci

a 
(%

)

Raio (micrometros)

Figura 37: Distribuição de raio das gargantas para ambos algoritmos no S1.
Fatores de expansão 50%, 60%, 70% e 80% para o EMB

tem impacto sobre os cálculos de previsão de transporte, principalmente no
fator de formação e na permeabilidade absoluta.

A figura 37, demonstra os raios de cilindros nas redes geradas pelo
EMB, para o fator de expansão variando, e MB. Observa-se que o MB tem
resultados muito mais comportados nesse caso e isso deve-se ao fato da rede
gerada pelo MB utilizar uma métrica diferente da utilizada na implementação
do EMB. No primeiro, o raio de um cilindro é definido como no trabalho de ,
ou seja em função do raio da esfera que define a garganta e os raios dos poros
conectados. Já no segundo, utiliza-se o mesmo raciocínio do raio do poro,
isso é, obtêm-se o valor do raio em função do comprimento e do volume da
garganta. Isso é, para uma garganta Gi qualquer, pertencente ao conjunto de
gargantas do volume, com volume Vi e comprimento Li define-se que o raio
Ri da garganta é:

Ri =

?
Vi

? Li
(3)

Essa equação é obtida diretamente da equação de volume de um ci-
lindro, V = ? R2L. Mesmo com essa diferença, o comportamento do EMB
para o crescimento da garganta é mais ou menos constante. Esse resultado



83

17 35 52 69 87 104 139 173 208 243 379

MB

EMB 0.5

EMB 0.6

EMB 0.7

EMB 0.8

0

10

20

30

40

50

60
F

re
q
u

ên
ci

a 
(%

)

Razão do comprimento da garganta e raio do poro

Figura 38: Razão do comprimento da garganta pelo raio da mesma no volume
S1. A última faixa são os valores maiores que quatro vezes a média

é adequado porque pela equação 3, o raio cresce inversamente proporcional
ao comprimento e proporcional ao volume. Ou seja, como para fatores de
expansão, tanto o volume quanto o comprimento são maiores, o raio tende
a manter-se na mesma escala. Acredita-se que com a definição do raio em
função do comprimento da garganta, obtenha-se cilindros mais condizentes
com a geometria real da garganta.

Uma possível caracterização das gargantas de um volume pode ser
observada por meio da razão do comprimento das gargantas em função do ta-
manho de seu raio. Assim, tem-se uma ideia de qual proporção encontram-se
as gargantas. Esse dado, aliado aos outros analisados, provê uma definição
geométrica das gargantas em um volume. Na figura 38, tem-se a frequência
de várias faixas de razão par ao volume S1. Nesse gráfico, a última faixa está
em função da média até o maior valor de razão, portanto está visualmente
escalado diferentemente das outras. Nota-se que os valores de razão crescem,
em média, para o EMB, o que está de acordo com o observado nos gráficos
das figuras 36 e 37, que demonstram o crescimento do comprimento da gar-
ganta e uma certa constância no tamanho do raio. Assim, tem-se que a razão
escala com o aumento do fator de expansão. A razão média na rede MB é
de 17.35, enquanto na rede EMB é de 13.53, 14.60, 15.32 e 16.24, para os
fatores 50%, 60%, 70% e 80% de expansão, respectivamente.



84

30089 90267 150445 210624 270802 330980 391158 451336

MB

EMB 0.5

EMB 0.6

EMB 0.7

EMB 0.8

0

10

20

30

40

50

F
re

q
u

ên
ci

a 
(%

)

Volume da garganta

Figura 39: Frequência dos volumes das gargantas para o volume S1. A última
faixa são os valores maiores que quatro vezes a média

A frequência de volumes de garganta fornece a informação visual de
quão volumosas são as gargantas. Na figura 39, tem-se a frequência de faixas
de volume para as gargantas onde a última faixa é definida em função da
média. Tem-se uma grande aglomeração para valores pequenos, característica
de acordo com a maior aglomeração de valores de raio para gargantas e poros
em faixas de dezenas de micrômetros. Ainda assim, a escala de volume varia
bastante, sobretudo nas gargantas com raios e comprimentos maiores cujos
volumes serão cubicamente maior que outros.

5.2 ESTUDO DE CASO C1

O volume C1, visualizado em forma de esferas e cilindros na figura
40, é uma amostra carbonática discutida no também no trabalho de Dong e
Blunt (2007). Essa amostra, possui uma alta irregularidade, dada os proces-
sos diagenéticos os quais a originam. Ela é interessante por apresentar uma
forte contrapartida ao volume S1, de menor porosidade e mais regular e tam-
bém por apresentar, por sua morfologia, similaridade com rochas diversas de
bacias sedimentares. Recomenda-se a leitura da seção 5.1 porque nela várias
definições, nesta seção utilizadas, são explicadas.



85

EMB MB
Porosidade da rede 24.1 24.1
N de poros 8177.0 4576.0
N de gargantas 13542.0 6915.0
N de inlets 163.0 113.0
N de outlets 166.0 107.0
N de isolados 5454.0 3317.0
Elementos circulares 335.0 0.0
Elementos quadrados 302.0 67.0
Elementos triangulares 21084.0 11426.0

Tabela 4: Características da RP, no EMB e MB, para o volume C1

Figura 40: Rede gerada para o volume C1



86

Na tabela 4, encontram-se os valores de algumas propriedades da rede
para as duas redes. No EMB, a rede gerada possui 8177 poros e 13542 gar-
gantas, expressando uma proporção de poros em relação a gargantas em torno
de 60%. Para o MB, a relação é similar, com 4576 poros e 6915 gargantas, ou
seja, 66%. Novamente, a rede gerada obteve mais poros e gargantas porque
a rede do EMB possui aproximadamente 78% de poros e 95% de gargantas a
mais. Valores percentuais mais altos, quando comparados aos do S1.

O número de inlets e outlets foi de 163 e 166 para a rede das esferas
exatas, enquanto a rede da implementação de Dong apresentou 113 e 107,
respectivamente. Novamente, o número de inlets e outlets foi maior na rede
do EMB, mas relembra-se que isso não ocorre para todos os casos, conforme
visto na figura 28.

Uma grande diferença dos resultados do C1 com relação ao S1 é o
número de poros isolados, totalizando 5454 na rede do EMB e 3317 no MB,
ou seja 66% e 72% do número total de poros, respectivamente. Isso deve-se
ao fato da morfologia interna da rocha, com muitos poros pequenos desco-
nexos e poucos poros grandes bem conectados. Assim, é possível que pela
utilização de filtragens mais fortes sobre o volume binarizado e o aumento no
tamanho mínimo de um poro, parametrizável em ambos os algoritmos, tenha
um impacto sobre esse resultado.

Os tipos de elementos gerados nas duas redes são bastante similares.
Nota-se que na rede do MB tem-se zero elementos circulares de novo. Isso,
reafirma-se, será um motivo de observação na seção 5.5.1.

5.2.1 Número de coordenação

A plotagem da frequência do número de coordenação é demonstrado
na figura 41, para a amostra C1. Nela, é possível observar uma grande aglo-
meração em até quatro conexões por poro. Contudo, o mais frequente é ter
uma conexão, diferentemente do S1, onde duas conexões é o mais frequente.
Isso, se levado em consideração a figura 42, demonstra que o volume C1 é
composto por poucos poros grandes, altamente conectados (máximo de 55
conexões) e possui mais poros menores. Ou seja, são evidências da irregula-
ridade e heterogeneidade da amostra.

No esferas máximas exatas, o número de conexões é maior que o MB
para valores maior que um, porém a partir de sete conexões ele apresenta
maior frequência novamente. Novamente, o comportamento foi parecido com
o S1, onde essa inversão ocorria para quatro conexões ou mais.

A irregularidade da amostra é evidente quando observa-se número de
conexões próximos dos valores máximos. A baixa frequência que poros desse



87

1 4 7 10 13 16 19 22 25 28 31 34 37 40 43 46 49 52 55

MB

EMB

0

10

20

30

40

F
re

q
u

ên
ci

a 
(%

)

Número de coordenação

Figura 41: Frequência do número de coordenação nos algoritmos EMB e MB
para o volume C1

tipo aliadas a grande quantidade de poros pequenos é característica desse tipo
de volume. Ainda assim, tais características foram capturados de maneira
adequada pelo EMB.

5.2.2 Poros

A distribuição de raio de poros no volume S1 era quase idêntica para
vários fatores. Na figura 42 tem-se as distribuições percentuais de faixas de
raios do MB e do EMB, para os fatores de expansão de 50% a 80%. Nova-
mente, o raio final dos poros, obtido pela equação 1 varia pouco com o fator
de expansão utilizado. Entretanto, nesse volume os raios estão muito mais
concentrados em valores inferiores, isso é, há uma quantidade maior de poros
de tamanho pequeno, e poucos poros grandes, quando comparado ao arenito
S1. Isso também pode caracterizar uma falha na etapa de aquisição, ou seja,
se a resolução utilizada nessa etapa fosse melhor, talvez esses elementos pe-
quenos e desconexos apresentariam-se bem conectados.

Em relação ao esferas máximas, o EMB apresenta, como no S1, uma
distribuição de raios dos poros maior. No MB, mais de 70% dos raios tem até
8 micrômetros, enquanto na versão exata, a mesma faixa representa pouco



88

8 17 26 34 42 51 60 68 76 85 94 102 119 136

MB

EMB 0.5

EMB 0.6

EMB 0.7

EMB 0.8

0

20

40

60

F
re

q
u

ên
ci

a 
(%

)

Raio (micrometros)

Figura 42: Distribuição de raios de poros para ambos algoritmos no volume
C1. Fatores de expansão 50%, 60%, 70% e 80% para o EMB

mais de 40% dos poros. Entre 8 e 17 micrômetros estão 20% dos poros e
quase 40% para o MB e EMB, respectivamente. Portanto, houve um cresci-
mento expressivo nessa faixa de raios de poro para o EMB. O mesmo acon-
tece para raios maiores, mas os valores absolutos para as demais faixas são
menos expressivos que nas duas faixas citadas.

As faixas de volume de poros quando relacionadas a frequência em
que ocorrem geram os resultados vistos na figura 47. Nela, a última faixa de
frequência une todos os valores maiores que quatro vezes a média. Observa-
se que, assim como nas gargantas, o volume dos poros no C1 é menor que no
S1. Tem-se alguns poros grandes, porém a grande quantidade de poros é pe-
queno e desconexo, conforme visto pelo número de elementos isolados na ta-
bela 4 e pela distribuição do número de coordenação, na figura 41. Conforme
já observado, isso indica a necessidade de uma aquisição em uma melhor
resolução.

5.2.3 Gargantas

O comportamento do crescimento das gargantas, visto na figura 44, é
mantido para as gargantas dessa RP, como no S1. Apesar disso, as gargan-



89

9271 27812 46353 64894 83436 101977 120518 139059

MB

EMB 0.5

EMB 0.6

EMB 0.7

EMB 0.8

0

20

40

60

80

F
re

q
u

ên
ci

a 
(%

)

Volume (micrometros cúbicos)

Figura 43: Frequência dos volumes dos poros para as redes EMB e MB do
volume C1. A última faixa engloba todos os valores maiores que quatro vezes
a média

18 36 53 71 89 107 142 178 214 249 285

MB

EMB 0.5

EMB 0.6

EMB 0.7

EMB 0.8

0

20

40

60

80

F
re

q
u

ên
ci

a 
(%

)

Comprimento (micrometros)

Figura 44: Distribuição de comprimentos das gargantas no volume C1. Fato-
res de expansão 50%, 60%, 70% e 80% para o EMB



90

3 7 10 14 17 21 24 28 31 34 38 41 45 48 52 55

MB

EMB 0.5

EMB 0.6

EMB 0.7

EMB 0.8

0

10

20

30

40

50

60

70

F
re

q
u

ên
ci

a 
(%

)

Raio (micrometros)

Figura 45: Distribuição de comprimentos das gargantas para ambos algorit-
mos. Fatores de expansão 50%, 60%, 70% e 80% para o EMB

tas são menos compridas e menos distribuídas, assim como os poros. Isso é,
há uma alta concentração de gargantas com até 53 micrômetros no EMB e
MB. No último, essa faixa representa praticamente a totalidade das gargan-
tas, enquanto nas esferas exatas representam quase aproximadamente 90%
das gargantas. Essa grande concentração dá-se pelo mesmo fato da alta con-
centração de poros de raios pequenos, ou seja, é característica de um volume
heterogêneo irregular.

Na figura 45, estão os valores percentuais para as faixas de raios de
garganta. Nesse caso, o MB e EMB geraram redes com raios similares o que
implica que para volumes com muitos poros e gargantas pequenas, a defini-
ção da equação 3 resulte em pequenas diferenças com a equação , contudo
tal constatação requer um maior estudo para mais dados amostrais. O com-
portamento da rede do EMB, para os vários fatores de expansão foi de pouca
variação, conforme o visto no S1, sendo novamente adequado.

Para o volume C1, a razão média do comprimento das gargantas em
função do raio é de 14.1, 15.34, 16.22 e 16.91 na rede EMB, para os fatores
de expansão 50%, 60%, 70% e 80%, respectivamente, enquanto na gerada
pelo MB a razão média é 18.88. A figura 46 demonstra as frequências para
várias faixas de valores. Observa-se que o comportamento é similar ao obtido
no S1, onde o EMB gera uma rede com essa razão menor em média.



91

20 40 60 79 99 119 159 199 238 278 1174

MB

EMB 0.5

EMB 0.6

EMB 0.7

EMB 0.8

0

10

20

30

40

50

60

70

F
re

q
u

ên
ci

a 
(%

)

Razão do comprimento da garganta e raio do poro

Figura 46: Razão do comprimento da garganta pelo raio da mesma no volume
C1. A última faixa são os valores maiores que quatro vezes a média

1769 5306 8844 12381 15919 19456 22994 26531

MB

EMB 0.5

EMB 0.6

EMB 0.7

EMB 0.8

0

20

40

60

F
re

q
u

ên
ci

a 
(%

)

Volume da garganta

Figura 47: Frequência dos volumes das gargantas para o volume C1. A última
faixa são os valores maiores que quatro vezes a média



92

Outro fator que influencia diretamente a análise da rede é a distribui-
ção de volumes de gargantas. A figura 47 apresenta faixas de frequência para
os volumes das gargantas das redes geradas pelo EMB e MB. A última faixa,
como no S1, é definida em função da média, sendo visualmente maior, porém
representando uma faixa bem maior de valores. Nota-se que as gargantas do
C1 são, em média, menos volumosas que a do S1. Esse fato fica claro ao
analisar-se os valores de faixa para ambos, onde os valores para o S1 estão
quase que em outra escala de grandeza. Isso comprova que a partir desse
volume mais gargantas menos volumosas.

5.3 DEMAIS ARENITOS

Pelo fato dos resultados de alguns arenitos serem visualmente repeti-
tivos, ou seja, são similares e pela grande quantidade de volumes amostrais,
parte dos resultados estão nos anexos desse trabalho. Na seção 7.2 encontram-
se os resultados para os volumes S4, S7, S8 e S9. Apesar disso, os valores de
permeabilidade e fator de formação, descritos na seção 5.5.4, são de todas as
amostras analisadas também no capítulo 4.

Observa-se que assim como nas amostras S1 e C1, as redes EMB apre-
sentam sempre um número de gargantas e poros maior que nas MB. Essa dis-
tinção nos resultados já fora observada no capítulo 4 e é devida a diferença
na definição do raio e em ambos. Apesar disso, a porosidade calculada para
ambas são sempre similares, nunca variando mais que 0.5% nas amostras es-
tudadas.

Um fato que chama bastante atenção é o fato do MB nunca gerar fa-
tores de forma circulares para os elementos da rede e, em sua maioria, os
elementos gerados por ele serem triangulares. Os elementos quadrados são
sempre insignificativos. Existe um motivo para tal, e ele será motivo de es-
tudo na seção 5.5.1.

As tabelas 5, 6, 7 e 8 apresentam os valores obtidos para algumas
propriedades básicas da rede, contrapostos com o resultado obtido com o MB
para os mesmos volumes. A figura 48 demonstra o resultado visual da rede
S2, que em contrapartida com a rede S3, da figura 49, apresenta poros maiores
e menos numerosos. Isso pode ser observado nos números de ambas as redes,
apesar de ambas possuírem porosidades não tão diferentes, isto é, 24.9% e
17.1%, a rede S2 tem 3523 poros e 7400 gargantas enquanto a S3 contém
13794 poros e 20903 gargantas. Essas diferenças morfológicas entre as duas
rochas, refletem diretamente na permeabilidade absoluta e o fator de forma
dessas redes, descritos na seção 5.5.4.

O volume S5, apresenta um número de poros bem menor que o S2,



93

EMB MB
Porosidade da rede 24.9 24.7
N de poros 3523.0 2021.0
N de gargantas 7400.0 4942.0
N de inlets 164.0 112.0
N de outlets 172.0 125.0
N de isolados 105.0 73.0
Elementos circulares 126.0 0.0
Elementos quadrados 147.0 19.0
Elementos triangulares 10652.0 6946.0

Tabela 5: Características da RP, no EMB e MB, para o volume S2

Figura 48: Rede gerada para o volume S2



94

EMB MB
Porosidade da rede 17.0 17.2
N de poros 13794.0 8926.0
N de gargantas 20903.0 15103.0
N de inlets 347.0 288.0
N de outlets 375.0 301.0
N de isolados 1075.0 656.0
Elementos circulares 216.0 0.0
Elementos quadrados 381.0 130.0
Elementos triangulares 34102.0 23901.0

Tabela 6: Características da RP, no EMB e MB, para o volume S3

Figura 49: Rede gerada para o volume S3



95

EMB MB
Porosidade da rede 20.4 20.1
N de poros 970.0 518.0
N de gargantas 1719.0 900.0
N de inlets 59.0 40.0
N de outlets 57.0 39.0
N de isolados 83.0 66.0
Elementos circulares 40.0 0.0
Elementos quadrados 41.0 8.0
Elementos triangulares 2610.0 1412.0

Tabela 7: Características da RP, no EMB e MB, para o volume S5

Figura 50: Rede gerada para o volume S5



96

EMB MB
Porosidade da rede 43.0 42.6
N de poros 6067.0 3393.0
N de gargantas 16983.0 11479.0
N de inlets 279.0 200.0
N de outlets 297.0 202.0
N de isolados 111.0 23.0
Elementos circulares 454.0 0.0
Elementos quadrados 399.0 47.0
Elementos triangulares 22199.0 14827.0

Tabela 8: Características da RP, no EMB e MB, para o volume A1

Figura 51: Rede gerada para o volume A1



97

970 poros e 1719 gargantas e uma porosidade de 20.4%. É um volume bem
homogêneo e possui poucos poros pequenos conforme pode ser visualizado
na figura 50. Os demais poros são maiores e bem conectados. Tal organização
é bastante regular e esse volume deve possui uma permeabilidade bastante
diferente dos volumes apresentados também.

O volume A1 possui uma porosidade de 43.1%, 6067 poros e 16983
gargantas. Sua visualização é bastante densa com poucos poros pequenos.
Isso deve-se ao fato de ser, dentre as amostras analisadas, a única de sílica
sintética, e portanto, manufaturada. Tal origem, faz com que ela seja uma
muito diferente das analisadas até então. Contudo, é interessante exatamente
por apresentar uma forte contrapartida com os volumes vistos até então, so-
bretudo na porosidade elevada.

5.4 ROCHA C2

Como as rochas carbonáticas analisadas no capítulo 4 são apenas qua-
tro, todos os resultados referentes a elas se encontram descritos nessa seção,
com exceção da amostra C1, já descrita.

Na tabela 9 mantém-se as porosidades calculadas sobre a rede, de ma-
neira similar para as RPs do MB e EMB e o número de poros e gargantas
sempre maior no último, conforme já foi constado na figura 26. Ou seja, as
redes são, volumetricamente equivalentes para ambos, porém fundamental-
mente diferentes. Dessa constatação, espera-se que as permeabilidades ab-
solutas para ambas as redes sejam em mesma ordem de grandeza para um
determinado fator de expansão. Os resultados finais são vistos na seção 5.5.4
e discutidos na seção 5.6.

O volume C2 difere bastante com relação ao do C1, tanto visualmente
como em dados empíricos. Ele possui 13084 poros e 17710 gargantas e uma
porosidade calculada de 16.1% para a RP do EMB. Apesar de apresentar uma
certa similaridade como volume citado, o C2 é mais poluído e, analisando-se
os poros e gargantas gerados, existem menos poros grandes no último que no
primeiro. Também, as gargantas do C2 são em geral menores. Por fim, o ta-
manho amostral desses volumes é bastante diferente o que também influencia
os resultados para as equações de transporte.

Em todas as amostras, nota-se que o número de elementos circulares é
sempre zero no para redes do MB e o número de elementos quadrados é sem-
pre insignificativo perante o número de elementos triangulares. Isso também
é verdade para o EMB, porém, em geral, ele gera redes com mais elementos
quadrados e um número sempre não nulo de elementos quadrados. O mesmo
foi constatado nos volumes areníticos. Essa diferença com relação ao fator



98

EMB MB
Porosidade da rede 16.1 15.7
N de poros 13084.0 8508.0
N de gargantas 17710.0 10336.0
N de inlets 347.0 260.0
N de outlets 359.0 258.0
N de isolados 7728.0 5036.0
Elementos circulares 309.0 0.0
Elementos quadrados 349.0 130.0
Elementos triangulares 30138.0 18716.0

Tabela 9: Características da RP, no EMB e MB, para o volume C2

Figura 52: Rede gerada para o volume C2



99

de forma é proveniente de uma modificação feita sobre o MB, explanada na
seção 5.5.1.

5.5 ESCOAMENTO MONOFÁSICO E PROPRIEDADES PETROFÍSICAS

A simulação do escoamento de fluido pela RP é importante por ser
um mecanismo a mais para comprovação de padrões visuais e estocásticos
observados na rede. Dentre as variáveis de previsão de transporte, tem-se
aquelas obtidas para escoamento multifásico (multiphase), simulando-se óleo
e água, ou ainda óleo, água e gás. Também, existe a previsão em uma única
fase (single phase), também chamado de escoamento monofásico, capaz de
extrair o comportamento de apenas um fluido atravessando a rede de poros,
tipicamente a água.

Este trabalho, restringe-se a características para fases singulares, isso
é, apenas leva-se em consideração um ambiente com uma única fase. Apesar
disso, o simulador utilizado é capaz de extrair dados multifásicos.

Algumas assunções são feitas no ambiente monofásico de estudo: o
fluido é newtoniano, incompressível, imiscível e homogêneo; o fluido molha
completamente a fase porosa e, como não há interação com uma segunda
substância, o invade os poros sem resistência alguma.

A viscosidade do fluido é 1 cP, a pressão de entrada nos inlets é a 1 Pa e
a de saída é 0 Pa. Esses valores e todos os parâmetros utilizados encontram-se
no apêndice, seção 7.4.

As variáveis petrofísicas que, neste trabalho, foram consideradas im-
prescindíveis foram o fator de forma, a permeabilidade absoluta e o fator
de formação. A avaliação das três variáveis são vistas como suficientes para
comprovar a possibilidade de extrair-se dados petrofísicos a partir da rede
gerada pelo EMB, assim como compará-los com a mesma rede gerada pelo
MB.

5.5.1 Fator de forma

O fator de forma, do inglês shape factor, é uma variável, segundo Ma-
son e Morrow (1991), definida em função da área A do elemento e o perímetro
P, isto é:

G2D =
A2

P
(4)

O fator de forma é importante para a previsão das propriedades da



100

Figura 53: Determinação da geometria mais próxima a um determinado ob-
jeto a partir do fator de forma

transporte, principalmente em um ambiente multifase porque é a partir dessa
variável que se determina qual geometria é mais apropriada para a repre-
sentação de um determinado elemento e o quão irregular é esse elemento, e
portanto mais propício a reter líquido devido a forças capilares, alterando a
molhabilidade em uma interação multifásica (VALVATNE; BLUNT, 2004).

Um elemento irregular da rede, representado na forma de voxels pode
possuir o mesmo fator de forma de uma geometria regular, conforme demons-
trado na figura 53.

Os valores das geometrias regulares são, se relacionados a forma irre-
gular obtida na representação voxelizada, apenas referências que demonstram
de forma numérica a irregularidade do espaço poroso. Assim, um elemento
que possua uma forma bastante regular será representado por um círculo ou
um quadrado, enquanto um elemento bastante irregular será representado por
um triângulo cujos cantos podem formar ângulos extremamente agudos, o
que conforme já observado, essa característica modifica a passagem do fluido
durante simulações multifásicas.

Uma vantagem de utilizar-se uma forma mais simples para calcular
propriedades de transporte é que, além de ser possível calcular e definir a
quantidade de fluido retido durante nos cantos do elemento durante a simula-
ção, torna-se possível definir a pressão capilar de entrada como uma função
direta do fator de forma do poro (MASON; MORROW, 1991).

A definição do fator de forma como G2D não é válida em um ambiente
volumétrico, sendo reescrita como:

G3D =
V L
A2

(5)

Onde V é o volume da garganta ou poro e A a área. L é o raio para o
poros um elemento esférico e o comprimento para a garganta, ou seja, para
elementos esféricos e cilíndricos ele é diferente. As formas visualizadas na



101

0.00497375 0.019895 0.03481625 0.0497375 0.06465875 0.07958

MB

EMB 0.5

EMB 0.6

EMB 0.7

EMB 0.8

0

5

10

15

20

25

30

F
re

q
u

ên
ci

a 
(%

)

Fator de forma

Figura 54: Frequência do fator de forma para o volume S1

0.00497375 0.019895 0.03481625 0.0497375 0.06465875 0.07958

MB

EMB 0.5

EMB 0.6

EMB 0.7

EMB 0.8

0

5

10

15

20

25

30

F
re

q
u

ên
ci

a 
(%

)

Fator de forma

Figura 55: Frequência do fator de forma para o volume C1



102

figura 53 ainda são válidas numa simulação de escoamento fixa em um eixo.
Nas figuras 54 e 55, tem-se a distribuição dos fatores de forma para

os volumes S1 e C1. Observa-se que com o aumento do fator de expansão
das gargantas no EMB, os fatores de forma concentram-se mais em valores
mais altos, enquanto para o MB são impossivelmente similares e tendem a
seguir uma distribuição normal. A explicação para tal fato, pode ser encon-
trada no trabalho de Dong e Blunt (2007), onde a definição do fator de forma
do elemento é dado pelo tamanho do raio, assim os valores são arbitraria-
mente distribuídos ao longo dos valores Rmin ?1 a Rmax, conforme definidos
na seção 4.1.1, e o menor tamanho possível é 10% do tamanho real de um
voxel no volume (resolução). O objetivo do autor foi parametrizar a curva de
pressão capilar de modo a ela apresentar resultados mais similares ao PB. Tal
diferença, devem fazer com que os resultados de permeabilidade absoluta e
fator de formação sejam diferentes para o EMB e MB.

Confirma-se o que já era observado nas figuras 39, 36, 35 e 34 para o
S1 e nas figuras 47, 44, 43 e 42 para o C1. Devido ao fato do volume e o raio
dos poros serem pouco modificados pelo fator de expansão e o das gargantas
ser, em contrapartida, modificados significativamente, há uma transferência
de população dos fatores de forma menores para fatores de forma mais altos.
Por meio da definição da equação 5, conclui-se que o número de elementos
altamente irregulares diminui conforme o aumento do fator de expansão, as-
sim há uma melhor definição dos elementos altamente irregulares da rede,
isto é, as gargantas.

5.5.2 Permeabilidade absoluta

A permeabilidade é a vazão de um determinado fluido em um meio po-
roso e varia em função da variação da pressão de entrada. A permeabilidade
absoluta K está relacionada com a capacidade do meio poroso de permitir o
escoamento de um fluido por sua estrutura interna e é definida por:

K =
? LQ

A(pinlet ? poutlet)
(6)

Essa definição é válida quando a rede encontra-se em saturada na mo-
nofase p de viscosidade corresponde a ? . O fluxo monofásico total, denotado
por Q, é dado pela diferença de potencial p entre inlets e outlets, dada indivi-
dualmente por:

p = P??pgh

P é a pressão de entrada, ?pé a densidade da fase e g a constante de gravidade



103

Figura 56: Configuração poro-garganta-poro onde a região cinza é a região
de cálculo do fluxo Qp,i j

e h é a altura do volume. Apesar de não ser objeto de estudo nesse trabalho,
a permeabilidade relativa é dada por:

Kr =
Qmp

Q

Onde Qmp é o fluxo da fase p no ambiente multifásico com a mesma
pressão de entrada e saída. Q, O fluxo total do sistema é encontrada solvendo-
se a a pressão em todo poro i, impondo a conservação de massa em todos eles:

?
j

Qi j = 0 (7)

A variável j percorre todas as gargantas ligadas ao poro i. O fluxo
entre dois poros, i e j, é definido por:

Qi j =
gi j
Li j

(pi ? p j) (8)

A diferença de potencial da fase é o (pi? p j), enquanto a condutância
é dada por g. A condutância entre dois poros i e j, ligados por uma garganta t,
pode ser expressa como a média harmônica da condutância de cada elemento
envolvido, isto é:

Li j
gi j

=
Li
gi

+
Lt
gt

+
L j
g j

Li e L j são as distâncias do centro do poro a interface com a garganta
em questão. Lt é o comprimento da garganta até a interface poro-garganta,



104

conforme visto na figura 56. Nessa figura, a região acinzentada é a interface
poro-garganta-poro em si, sobre a qual o cálculo do fluxo é feito. A partir
da fórmula de Hagen-Poiseuille, pode-se afirmar que a condutância g, no
ambiente monofásico, é dada por:

g =
kA2G

µp
ou

g = A2S

O kG
µp

ou S é o fator de forma (shape factor) influenciado pelo tipo de
geometria utilizada. A constante k foi descoberta por testes de laboratório
no trabalho de Patzek e Silin (2001). A constante vale 0.5 para estruturas
circulares, 0.5623 para quadradas e 0.6 para equiláteras.

Pela equação 7, extrai-se um sistema linear de equações que pode
ser resolvido por um solver. A partir das pressões extraídas pelo solver,
substituindo-as na equação 8, tem-se o fluxo entre os conjuntos de poros co-
nectados. A partir daí, obtém-se a solução do fluxo Q da fase p, e por sua
substituição na fórmula geral, equação 6, acha-se o valor de permeabilidade
absoluta para a RP em questão.

Dada uma rede de poros de entrada gerada pelo EMB ou MB é pos-
sível obter os valores de permeabilidade absoluta por meio do simulador two
phase. Calcula-se a permeabilidade a partir do fluxo nas direções x, y e z
e obtém-se de forma análoga Kx,Ky e Kz. A partir desses, tem-se a média
aritmética:

K =
Kx + KY + Kz

3
(9)

Sendo K a permeabilidade absoluta, conforme descrita na equação 6,
obtida pela execução em cada eixo do volume.

5.5.3 Fator de formação

O fator de formação é o resultado da analogia do fluido na RP com
um circuito elétrico. Fatt (1956), definiu a permeabilidade absoluta em uma
RP definida no espaço 2D por meio de um circuito elétrico análogo a rede
analisada.

A lei de Poiseuille é análoga a lei de Ohm, generalizada por Kirchhoff
como J = ? E , onde J é a densidade da corrente em um determinado local,



105

? é condutividade do material e E o campo elétrico. Substituindo-se E pela
diferença de pressão, ? pela condutividade hidráulica e J pelo fluxo tem-se a
analogia entre as duas leis.

A partir da analogia, existe o fator de formação, obtido a partir da lei
de Ohm. Ele caracteriza a expressão da permeabilidade absoluta sob a ótica
da mesma. Portanto, define-se o fator como:

F =
Rn
Rw

Rn é a resistividade da rede quando completamente saturada e Rw é a
resistividade da água. A resistividade da rede é obtida a partir da lei de Ohm:

Rn =
A?E
JL

A é a secção transversal, ?E é a diferença de tensão, J é o fluxo total
e L o comprimento total da RP. A condutividade elétrica entre dois poros é
definida pela área da secção transversal quando ocupada pela água. Assim:

? =
Aw
Rw

O valor do fator de formação para uma rede qualquer é, finalmente,
dado por:

F =
1
?

(10)

É possível calcular esse valor em cada eixo, e a partir da média harmô-
nica dos Fi, que podem ser obtidos de maneira homóloga a equação 10, ou
seja Fi =

1
?i

(VALVATNE; BLUNT, 2004). A média harmônica é o valor de
F , isto é:

1
F

=
1
3
(

1
Fx

+
1
Fy

+
1
Fz
) (11)

O simulador two phase implementa a extração do fator de formação a
partir de uma rede de entrada, além do cálculo da permeabilidade absoluta.

5.5.4 Resultados

Nessa seção são apresentados os resultados dos fatores de forma e
permeabilidades absolutas pela utilização do simulador two phase, capaz de
extrair informações monofásicas e multifásicas a partir de uma descrição de



106

rede. Para tanto, fez-se necessário a implementação de um exportador da rede
para o formato textual exigido pelo simulador como entrada. Foi possível
rodar o simulador para todos os casos, a partir do exportador implementado,
contudo em um exemplo o simulador saiu com violação de memória após
rodar a simulação.

Curiosamente, o exportador da rede gerada pela implementação de
Dong e Blunt (2007) em muitos casos resultou em falhas no parsing do ar-
quivo pelo simulador, mesmo para exemplos os quais haviam sido descorri-
dos na dissertação citada. Assume-se que esses erros devem-se ao fato dos
códigos serem originalmente compilados em ambiente 32 bits e por possivel-
mente alguma alteração feita para que eles compilassem em um ambiente 64
bits tornou tais casos falhos. Essa última, é duvidosa pelo fato dos códigos
terem sido compilados em 32 bits como forma de teste também e não terem
obtido sucesso em todos os casos.

Para a maioria dos casos foi possível rodar o código para ambos, pelo
menos no eixo das abcissas, conforme será discorrido mais adiante. Nos
resultados que não puderam ser obtidos pelo esferas máximas, tem-se o valor
zero na tabela 14, referente aos resultados do mesmo.

Nota-se na tabela 14 que os resultados para os eixos y e z diferem
muito dos valores encontrados em x. O código original do MB gerava redes
sempre no eixo x, impossibilitando a escolha de outro eixo sem a alteração do
código. Sendo assim, modificou-se o software de modo a ser possível passar
por linha de comando o eixo a ser calculado. Assim, esses resultados diferen-
tes podem ser frutos da modificação feita e portanto, serão ignorados para fins
de comparação, ou seja, somente o eixo x será considerado nas comparações
EMB e MB na seção 5.6, pelo fato dos resultados obtidos serem duvidosos
perante o esperado.

Os resultados obtidos para as redes geradas pelo EMB estão nas tabe-
las 10, 11, 12 e 13, enquanto o resultado original para a RP gerada pelo MB
encontra-se na tabela 15. O resultado obtido na execução do código modi-
ficado encontra-se em 14. Nos três casos, as variáveis K e F são definidas
de acordo com as equações 9 e 11, respectivamente. Ou seja, são resultados
frutos de execuções singulares para cada um dos elementos pertencentes as
tuplas (Kx,Ky,Kz) e (Fx,Fy,Fz).

Da observação dos resultado tem-se que os dados empíricos diferem
bastante para fatores de forma diversos e, de forma geral, de maneira linear,
tanto para o fator de formação como para a permeabilidade absoluta. Essas
tendências e suas implicações são o próximo estudo de caso.



107

Fx Fy Fz F Kx Ky Kz K
S1 12.51 7.72 6.92 8.47 2081.17 2318.79 3694.25 2698.07
S2 2.01 1.54 1.51 1.66 9954.72 10096.30 10274.60 10108.54
S3 30.05 4.68 6.61 7.53 167.92 1095.84 733.31 665.69
S4 41.23 5.78 9.47 9.90 131.23 721.37 511.27 454.62
S5 1.76 1.68 1.40 1.60 18542.70 18380.80 20128.40 19017.30
S6 1.53 1.41 1.74 1.55 38252.20 38257.40 29676.40 35395.33
S7 1.25 1.13 1.06 1.14 18592.80 18381.00 18702.50 18558.77
S8 0.75 0.71 0.68 0.71 45350.20 44135.10 44813.10 44766.13
S9 2.16 1.94 1.96 2.02 88669.80 89761.30 85824.20 88085.10
S10 2.75 2.31 2.32 2.44 3533.28 3590.51 3526.14 3549.98
S11 1.70 1.46 1.63 1.59 10504.30 10760.60 10411.60 10558.83
C1 4.90 2.37 3.55 3.30 3268.11 4108.49 3311.10 3562.57
C2 99.51 11.53 8.65 14.13 41.67 303.00 269.77 204.81
A1 0.67 0.50 0.53 0.56 18814.50 21782.50 21479.20 20692.07

Tabela 10: Tabela de valores dos fatores de formação e permeabilidades para
o EMB. Fator de expansão 0.5

Fx Fy Fz F Kx Ky Kz K
S1 14.57 8.59 7.54 9.44 1741.27 1970.30 3421.12 2377.56
S2 2.36 1.75 1.74 1.91 8300.90 8485.78 8503.80 8430.16
S3 40.87 5.65 7.64 9.03 117.96 926.33 615.61 553.30
S4 52.89 6.71 11.01 11.59 100.68 616.94 431.73 383.12
S5 2.24 2.08 1.75 2.00 12965.40 13091.80 13322.90 13126.70
S6 1.99 1.78 2.01 1.92 28338.30 28650.10 24529.50 27172.63
S7 1.48 1.30 1.22 1.33 15000.20 14925.70 15078.90 15001.60
S8 0.86 0.81 0.77 0.81 38801.80 37637.10 38461.50 38300.13
S9 2.37 2.10 2.11 2.19 68894.40 70163.80 65725.50 68261.23
S10 3.24 2.66 2.67 2.83 3115.50 3157.01 3119.52 3130.68
S11 2.24 1.85 2.12 2.06 7659.00 8077.41 7610.67 7782.36
C1 6.20 3.49 4.30 4.41 2699.09 2832.20 2741.53 2757.61
C2 123.44 12.44 9.04 15.07 30.07 292.50 258.31 193.63
A1 0.77 0.60 0.62 0.66 16127.30 17253.10 17201.50 16860.63

Tabela 11: Tabela de valores dos fatores de formação e permeabilidades para
o EMB. Fator de expansão 0.6



108

Fx Fy Fz F Kx Ky Kz K
S1 19.02 10.57 9.04 11.64 1252.98 1458.20 3078.16 1929.78
S2 2.72 1.94 1.96 2.16 7174.60 7372.87 7387.01 7311.49
S3 48.76 6.39 8.68 10.26 96.51 814.50 531.22 480.75
S4 64.18 7.01 12.06 12.44 80.50 585.27 386.13 350.63
S5 2.65 2.45 2.45 2.51 11479.90 11462.10 11462.10 11468.03
S6 2.11 1.88 2.08 2.02 27184.70 27511.60 23889.70 26195.33
S7 1.78 1.52 1.42 1.56 12845.90 12830.70 12950.40 12875.67
S8 1.00 0.92 0.87 0.93 32807.30 31839.80 32632.20 32426.43
S9 2.97 2.56 2.54 2.68 50846.60 51026.00 50420.70 50764.43
S10 3.70 2.95 2.98 3.18 2533.63 2581.51 2542.44 2552.53
S11 2.86 2.42 2.65 2.63 5937.19 5929.38 5888.77 5918.45
C1 6.46 3.64 4.47 4.59 2525.86 2643.77 2564.57 2578.07
C2 146.10 14.24 9.43 16.38 27.50 153.56 250.18 143.75
A1 0.91 0.70 0.71 0.76 13324.70 14082.70 14451.50 13952.97

Tabela 12: Tabela de valores dos fatores de formação e permeabilidades para
o EMB. Fator de expansão 0.7

Fx Fy Fz F Kx Ky Kz K
S1 21.87 11.55 10.04 12.94 1093.41 1298.93 2943.11 1778.48
S2 3.12 2.16 2.19 2.42 6268.32 6490.20 6489.37 6415.96
S3 55.28 6.84 9.65 11.20 85.51 771.77 493.65 450.31
S4 73.42 7.53 13.58 13.64 69.44 538.03 335.45 314.31
S5 3.07 2.81 2.81 2.89 9773.88 9761.48 9761.48 9765.61
S6 2.35 2.07 2.29 2.23 23127.30 23416.00 20268.90 22270.73
S7 1.87 1.58 1.47 1.63 12504.30 12483.10 12642.50 12543.30
S8 1.12 1.02 0.96 1.03 28537.00 28126.50 28674.90 28446.13
S9 3.36 2.89 2.84 3.02 44853.00 45328.40 44902.00 45027.80
S10 4.44 3.41 3.48 3.72 2019.72 2060.75 2032.55 2037.67
S11 3.16 2.61 2.87 2.86 4981.95 4999.87 4970.75 4984.19
C1 7.31 3.87 4.83 4.98 2044.67 2209.00 2084.75 2112.81
C2 156.28 15.20 10.13 17.55 26.75 147.41 237.33 137.16
A1 1.02 0.76 0.80 0.85 11857.70 12730.10 12217.40 12268.40

Tabela 13: Tabela de valores dos fatores de formação e permeabilidades para
o EMB. Fator de expansão 0.8



109

Fx Fy Fz F Kx Ky Kz K
S1 23.73 4.99 5.53 7.09 1939.57 13541.90 12232.10 9237.86
S2 5.89 1.47 1.99 2.22 4690.01 48397.10 13868.00 22318.37
S3 36.27 3.21 7.49 6.35 302.87 18252.30 4105.03 7553.40
S4 58.53 3.09 2.48 4.03 177.90 18985.30 37215.50 18792.90
S5 6.10 0.00 2.20 0.00 8530.12 0.00 83881.90 0.00
S6 5.27 1.15 1.28 1.63 19464.10 50834.70 43884.80 38061.20
S7 4.27 2.75 0.95 1.82 9142.70 75542.00 87776.80 57487.17
S8 2.84 3.54 1.58 2.36 16629.80 4772.53 514421.00 178607.78
S9 6.78 2.02 2.33 2.80 29063.60 15723.80 7251.52 17346.31
S10 11.01 1.38 1.57 2.07 1398.57 76756.00 85443.60 54532.72
S11 7.61 4.99 0.00 0.00 3242.83 13541.90 0.00 0.00
C1 17.73 1.47 5.53 3.27 1190.00 48397.10 12232.10 20606.40
C2 102.99 0.00 0.00 0.00 161.49 0.00 0.00 0.00
A1 2.17 3.21 0.00 0.00 8475.24 18252.30 0.00 0.00

Tabela 14: Tabela de valores dos fatores de formação e permeabilidades para
o MB

Fx Fy Fz F Kx Ky Kz K
S1 36.30 37.90 53.50 41.30 1969.00 1752.00 1312.00 1678.00
S2 10.90 11.30 12.60 11.50 4318.00 3983.00 3394.00 3898.00
S3 52.20 41.90 70.30 52.40 143.00 420.00 109.00 224.00
S4 74.50 71.00 114.40 82.80 273.00 289.00 215.00 259.00
S5 14.10 14.60 15.90 14.80 4638.00 4874.00 4440.00 4651.00
S6 10.30 11.20 12.90 11.40 11289.00 10683.00 10951.00 10974.00
S7 9.60 9.30 11.20 9.90 7268.00 7594.00 6037.00 6966.00
S8 6.02 5.97 6.53 6.16 13063.00 13507.00 12936.00 13169.00
S9 16.40 19.90 18.10 18.00 2735.00 2093.00 1844.00 2224.00
C1 33.70 21.90 27.20 26.80 785.00 1469.00 1053.00 1102.00
C2 18.00 121.00 249.00 170.00 38.00 161.00 18.00 72.00
A1 4.47 4.57 5.73 4.86 8272.00 7977.00 5412.00 7220.00

Tabela 15: Tabela de valores dos fatores de formação e permeabilidades para
o MB. Valores obtidos diretamente da tese de Dong e Blunt (2007)



110

Fx 0.5 Fx 0.6 Fx 0.7 Fx 0.8 Kx 0.5 Kx 0.6 Kx 0.7 Kx 0.8
S1 0.527 0.614 0.801 0.921 1.073 0.898 0.646 0.564
S2 0.342 0.401 0.463 0.530 2.123 1.770 1.530 1.337
S3 0.829 1.127 1.345 1.524 0.554 0.389 0.319 0.282
S4 0.704 0.904 1.097 1.254 0.738 0.566 0.452 0.390
S5 0.289 0.367 0.435 0.504 2.174 1.520 1.346 1.146
S6 0.291 0.377 0.400 0.446 1.965 1.456 1.397 1.188
S7 0.292 0.347 0.417 0.438 2.034 1.641 1.405 1.368
S8 0.264 0.304 0.352 0.395 2.727 2.333 1.973 1.716
S9 0.319 0.350 0.437 0.496 3.051 2.370 1.749 1.543
S10 0.250 0.294 0.336 0.403 2.526 2.228 1.812 1.444
S11 0.223 0.295 0.376 0.415 3.239 2.362 1.831 1.536
C1 0.277 0.349 0.364 0.413 2.746 2.268 2.123 1.718
C2 0.966 1.199 1.419 1.517 0.258 0.186 0.170 0.166
A1 0.306 0.355 0.420 0.468 2.220 1.903 1.572 1.399
Média 0.420 0.520 0.619 0.695 1.959 1.564 1.309 1.128
Variância 0.058 0.101 0.148 0.180 0.896 0.593 0.416 0.293

Tabela 16: Tabela que apresenta a razão do resultado obtido pela simulação
na rede EMB pela rede MB para diferentes fatores de expansão, no eixo x

5.6 CONCLUSÃO

Neste capítulo, foram estudadas diversas redes e a partir da observação
de distribuições de raios, comprimentos, volumes e o número de coordenação
constatou-se uma série de diferenças e semelhanças entre os comportamentos
observados para as redes geradas pelo EMB e MB. Inicialmente, notou-se
que nos casos de estudo S1 e C1, o EMB gera redes com poros mais bem
conexos e gargantas e com uma população maior de ambos. Apesar disso, os
volumes representativos das redes são bastante similares em todos os casos,
com a rede EMB tendo uma variação de no máximo 0.5% para o cálculo da
porosidade sobre ela.

Em ambas as redes EMB e MB observou-se que o comportamento
da distribuição de comprimento de gargantas, a distribuição de tamanhos de
poros e a razão do comprimento pelo raio dos poros conectantes. A variação
do fator de expansão de gargantas implicou no crescimento do comprimento
das gargantas e uma leve alteração na distribuição de tamanhos de poros e
nos volumes dos mesmos. Concluiu-se que os elementos mais alterados pelo
fator são as próprias gargantas e a contribuição dessa variável é vital para a
definição delas.

Após a análise dos casos de estudo S1 e C1, fez-se uma breve de-
monstração dos resultados para os arenitos S2, S3, S5 e A1, reforçando as
constatações já feitas. De maneira análoga tem-se a rochas carbonática C2,



111

S1 S2 S3 S4 S5 S6 S7 S8 S9 S10 S11 C1 C2 A1

?

?

?

?

? ? ? ? ?
? ?

?

?

?0

50

100

150

?

MB

EMB 0.5

EMB 0.6

EMB 0.7

EMB 0.8

F
at

or
 d

e 
fo

rm
aç

ão

Volume

Figura 57: Fatores de forma Fx para as redes EMB e MB

para qual o resultado continuou a demonstrar tendências similares. Contudo,
o número de elementos triangulares, circulares e quadrados nas RPs do EMB
e MB, cuja definição é dado pelo fator de forma, foi bastante diferente. As
figuras 54 e 55 demonstram os fatores de forma para as redes de esferas má-
ximas e exatas e esferas máximas que são tão diferentes que parecem definir
variáveis distintas. Isso deve-se a forma como na implementação do MB de
Dong e Blunt (2007) os fatores de formas são exportados para o simulador
two phase. Na tese, define-se que o fator de forma segue uma variação arbi-
trária entre os raios Rmin e Rmax a qual varia em função de uma distribuição
normal, observada nas duas figuras.

A tabela 16, demonstra a razão dos valores obtidos no EMB, das ta-
belas 10, 11, 12 e 13, para os fatores de expansão referentes em relação ao
MB, na tabela 14. Há uma aproximação de resultados do EMB e MB, para
valores de expansão maiores, tanto para os fatores de forma como para as
permeabilidades absoluta. Contudo, para o último caso, os resultados podem
ser considerados mais interessantes, uma vez que tanto a média tende mais
a 1 como a variância diminui. Já para o fator de forma, a variância tende a
aumentar, para os casos de teste, indicando que os resultados apesar de mais
próximos, tendem a variar mais. As figuras 58 e 57, demonstram grafica-
mente os valores das tabelas 10, 11, 12, 13 e 14 para a execução no eixo das
abcissas.



112

S1 S2 S3 S4 S5 S6 S7 S8 S9 S10 S11 C1 C2 A1

?

?

? ?

?

?

?

?

?

?

?

?

?

?

0e+00

2e+04

4e+04

6e+04

8e+04

1e+05

P
e
r
m

e
a
b
il

id
a
d

e
 (

m
D

)

Volume

?

MB

EMB 0.5

EMB 0.6

EMB 0.7

EMB 0.8

Figura 58: Permeabilidades Kx, em mD, para as redes EMB e MB

Fx 0.5 Fx 0.6 Fx 0.7 Fx 0.8 Kx 0.5 Kx 0.6 Kx 0.7 Kx 0.8
S1 0.345 0.401 0.524 0.602 1.057 0.884 0.636 0.555
S2 0.185 0.217 0.250 0.286 2.305 1.922 1.662 1.452
S3 0.576 0.783 0.934 1.059 1.174 0.825 0.675 0.598
S4 0.553 0.710 0.862 0.986 0.481 0.369 0.295 0.254
S5 0.125 0.159 0.188 0.218 3.998 2.795 2.475 2.107
S6 0.149 0.193 0.204 0.228 3.388 2.510 2.408 2.049
S7 0.130 0.154 0.186 0.195 2.558 2.064 1.767 1.720
S8 0.125 0.143 0.166 0.186 3.472 2.970 2.511 2.185
S9 0.132 0.145 0.181 0.205 32.420 25.190 18.591 16.400
C1 0.146 0.184 0.192 0.217 4.163 3.438 3.218 2.605
C2 5.528 6.858 8.117 8.682 1.097 0.791 0.724 0.704
A1 0.149 0.172 0.204 0.228 2.274 1.950 1.611 1.433
Média 0.678 0.843 1.001 1.091 4.866 3.809 3.048 2.672
Variância 2.360 3.638 5.097 5.813 76.800 46.287 24.791 19.257

Tabela 17: Tabela que apresenta a razão do resultado obtido pela simulação
na rede EMB em relação aos resultados do trabalho de Dong e Blunt (2007)
para diferentes fatores de expansão, no eixo x



113

S1 S2 S3 S4 S5 S6 S7 S8 S9 C1 C2 A1

?

?

? ?

?

?

?

?

?

?

?

?

0e+00

2e+04

4e+04

6e+04

8e+04

1e+05

P
e
r
m

e
a
b
il

id
a
d

e
 (

m
D

)

Volume

?

MB

EMB 0.5

EMB 0.6

EMB 0.7

EMB 0.8

Figura 59: Permeabilidades Kx, em mD, para as redes EMB e o resultado
original de Dong e Blunt (2007)

A tabela 17 demonstra a razão dos valores obtidos no EMB, das ta-
belas 10, 11, 12 e 13, em relação aos valores demonstrados na tese de Dong
e Blunt (2007), cujos valores estão na tabela 15. Assim como no código ro-
dado, há uma tendência a aproximação dos resultados obtidos no MB e EMB
para o aumento do fator de expansão. Os melhores casos nesse sentido são
os volumes S3 e S4 que são casos onde a população de poros e gargantas é
bastante alta a distribuição de comprimentos e raios tende a valores baixos. É
possível que isso deva-se ao fato do MB encontrar raios maiores, diminuindo
a correlação entre ambos. Entretanto, tal conjectura requer um estudo mais
profundo das variáveis envolvidas no fator de forma, sobretudo das etapas
intermediarias de cálculo, destacadas na seção 5.5.1.

Os valores de permeabilidade absoluta estão em acordo com o já ob-
servado nas tabelas da execução do MB. Há uma proximidade, em média, dos
valores, e uma diminuição da variância com o crescimento do fator de expan-
são. Ainda assim, os valores do MB rodado são mais próximos dos extraídos
do EMB. Conforme já observado no início desse capítulo, o simulador two
phase, apesar de fornecer informações detalhadas da rede de entrada, resulta
em valores distintos para execução em diferentes plataformas e para diferen-
tes compiladores. Tal fato pode ser fruto do fato da biblioteca básica de mate-
mática ser implementada de diferentes maneiras em cada ambiente. Ou seja,



114

S1 S2 S3 S4 S5 S6 S7 S8 S9 C1 C2 A1

?

?

?

?

? ? ? ? ?
?

?

?0

50

100

150

?

MB

EMB 0.5

EMB 0.6

EMB 0.7

EMB 0.8

F
at

or
 d

e 
fo

rm
aç

ão

Volume

Figura 60: Fatores de forma Fx para as redes EMB e o resultado original de
Dong e Blunt (2007)

não há como reproduzir o ambiente de execução utilizado em Dong e Blunt
(2007) sem utilizar-se a mesma versão de compilador, sistema operacional e
na mesma máquina, e principalmente os parâmetros originais utilizados em
cada execução.

As tabelas de resultados para os eixos y e z estão nos anexos, seção
7.3. Os resultados visuais e características básicas das RPs dos arenitos S4,
S6, S7, S8 e S9 estão na seção 7.2, também nos anexos.



115

6 CONCLUSÃO

Neste capítulo encontram-se as reflexões finais a respeito desse traba-
lho, fruto das conclusões locais de cada capítulo, nas seções 3.6, 4.6 e 5.6.
As conclusões sobre essa trabalho são feitas em três partes, as reflexões con-
clusivas, os trabalhos futuros e os reconhecimentos e agradecimentos àqueles
que contribuíram com esse trabalho.

6.1 REFLEXÕES CONCLUSIVAS

No capítulo 3, foi feita uma visão geral de como são adquiridos os
dados brutos e as imagens microtomográficas de rochas. Observou-se como
a partir da análise das imagens microtomográficas, é possível aprimorar os
resultados na etapa de binarização de imagem. Os algoritmos de binariza-
ção são vários e mesmo os automatizados diferem em muitos pontos, porém,
mesmo um método da bissetriz, visto no algoritmo 1, é suficiente para o auxí-
lio ao especialista. Ainda assim, ele pode modificar esse valor manualmente
conforme necessário.

Definiu-se uma técnica baseada em compressão RLE para diminuir
o tamanho do volume em memória, definindo segmentos de valores pretos
ou brancos. Ainda assim, foi possível obter desempenhos de ordem linear
utilizando-se a ideia da seção 4.5. A iteração por segmento ao invés de valor
de pixel não só permite a otimização de memória mas também a de processa-
mento, principalmente efetiva em volumes grandes. Conforme demonstrado
na seção citada, a mesma ideia é aplicável a várias estruturas de dados que
utilizem necessite armazenar valores relacionados ao meio poroso, sendo as-
sim uma técnica de compressão extremamente interessante com relação aos
meios porosos.

Tem-se assim uma técnica simples, a nível de implementação e com-
preensão, com alta taxa de compressão, onde os pode-se dividir os valores
em segmentos de valores homogêneos. A taxa de compressão é menor que
a própria porosidade do volume, variando de 5% a 20% para os volumes de
entrada para os volumes de entrada.

No capítulo 4, foram descritas as esferas máximas (MB), esferas má-
ximas exatas (EMB), extração rápida de rede (FNE) e o método baseado em
processos (PB) e os resultados comparativos entre o EMB e o MB, para as
diversas etapas observadas na figura 7. O algoritmo MB original não possuía
nenhum tipo de paralelização em suas etapas. A paralelização das etapas se-
riais do algoritmo resultaram em ganhos de performance notáveis. Também,



116

S1 S2 S3 S4 S5 S6 S7 S8 S9 S10 S11 C1 C2 A1

Volumes

0

100

200

300

400

500

600

? ?

?

?

?

?

? ?

? ? ?
?

?

?

M
eg

ae
sf

er
as

 p
or

 s
eg

u
n

d
o

?

MB

EMB 0.5

EMB 0.6

EMB 0.7

EMB 0.8

Figura 61: Valores em milhares de esferas processadas por segundo, durante
a execução do EMB e MB no eixo x. A linha pontilhada é a média global

a utilização do mapa de distâncias exatas em substituição ao inflar de esfe-
ras do MB diminuiu drasticamente o tempo de busca das esferas (figura 20),
responsável por quase 50% do tempo total em alguns volumes no algoritmo
original.

A figura 61 mostra os valores em mega esferas (mil esferas) por se-
gundo de execução para os volumes amostrais utilizados. O número de es-
feras contadas são o total de esferas encontradas e não o total remanescente
após a remoção. Isso foi feito de modo a haver um piso equalitário compa-
rativo entre as duas técnicas. De outra forma, o desempenho do EMB seria
ainda mais destacado pelo fato dele remover menos esferas. No geral, os
valores flutuam de 50 a 300 mega esferas por segundo para o EMB, com ex-
ceção dos volumes S3 e S4. Já no MB, ficam sempre abaixo dos valores do
EMB, variando de aproximadamente 25 a 115 mega esferas processadas por
segundo.

O conjunto de otimização de etapas individuais e paralelização dessas,
fez com que, para todos os volumes de entrada, o tempo total de execução
fosse inferior no EMB, mesmo com um volume maior de esferas sendo pro-
cessadas. As etapas de remoção de esferas auto-inclusas e aglomeração apre-
sentaram resultados menos promissores, porém ainda sim positivos e menores
que os tempos apresentados pela implementação original. Portanto, um dos



117

objetivos principais desse trabalho foi alcançado, isto é, obter um tempo de
execução total menor que o algoritmo MB original, mesmo com um volume
maior de dados sendo processados.

A partir dos resultados obtidos pela extração de redes de poros, fez-se
um exportador para o formato aceito como entrada pelo simulador two phase,
utilizado também por Dong e Blunt (2007) e, portanto propício a uma com-
paração direta com esse. Fez-se uma descrição extensiva das amostras S1 e
C1, avaliando fatores como distribuição de raios e volumes de poros e com-
primentos, raios e volumes de gargantas. Também, observou-se o número de
coordenação em ambas as amostras e os valores visuais e empíricos obtidos
diretamente da rede. Foi verificado que o fator de expansão de gargantas é
vital para definição das distribuições de gargantas, principalmente no que diz
respeito aos comprimentos e volumes, enquanto os poros são pouco modifi-
cados pelo aumento do fator.

Os fatores de forma observados para as redes EMB e MB são bastante
diferentes, porém esse fato foi explanado na seção 5.5.1. O exportador de
redes do MB converte os fatores de forma para uma distribuição normal para
obter um comportamento mais próximo do método baseado em processos
(DONG; BLUNT, 2007). Tal distinção foi explorado na seção 5.5.1.

Não foi possível rodar todas as redes exportadas pela implementação
do MB, feita pelo mesmo, contudo obteve-se êxito no eixo x. Assim, foram
feitas comparações de permeabilidade e fator de forma somente para esse
eixo. Observou-se que, principalmente para a permeabilidade, os resultados
finais foram de mesma escala de grandeza, uma das metas desse trabalho.
Além disso, os resultados foram próximos, em valores absolutos com o EMB
gerando, em geral, valores maiores para permeabilidade absoluta e menores
para fator de forma. Isso é condizente com a definição de ambos, uma vez
que são variáveis inversamente proporcionais.

Um dos objetivos que não foi alcançado foi o de comparar os resulta-
dos obtidos com o LBM ou dados obtidos por meio de métodos destrutivos.
Tais testes necessitam de aparelhagem e softwares não estavam disponíveis
durante a execução deste trabalho. Assim, a comparação com dados terceiros
é vista como um trabalho futuro, principalmente como validação da técnica
utilizada, isto é, uma comparação com um padrão ouro.

Apesar de vários resultados positivos, há uma série de trabalhos futu-
ros e trabalhos incompletos que devem ser revistos em possíveis retomadas
do tema. A seção 6.2 trata exclusivamente de ideias não contempladas neste
trabalho.



118

6.2 TRABALHOS FUTUROS

Nessa seção são exploradas três quatro vertentes diferentes a serem
trabalhadas. São elas: otimizações em cpu e gpu, validação com outras técni-
cas, o estudo de variáveis de entrada e saída e o tratamento de dados multies-
calares e volumes grandes.

6.2.1 Otimizações em cpu e gpu

Em termos de desempenho, o EMB foi melhor que o MB em todos os
casos de entrada, entretanto mesmo para volumes pequenos, com 300 voxels
de lado, o algoritmo pode levar algumas dezenas de segundos.

Um questionamento a ser feito é se há a possibilidade de obter um
desempenho garantido, em tempo hábil, para uma determinada faixa de vo-
lume. Um exemplo: 500 voxels de lado e 5s de tempo máximo de execu-
ção. Acredita-se que a resposta seja afirmativa, pela observação de algumas
características e algoritmos existentes na literatura e pela possibilidade de
modificar-se os algoritmos existentes de modo a torná-los mais eficientes e
paralelizáveis. Ainda assim, tais requisitos de desempenho são extremistas e
requerem profundo estudo e mudanças em várias etapas e, no caso de gpus,
um hardware robusto e que obedeça o padrão Khronos OpenCLTMou NVI-
DIA CUDATM.

Existem cinco pontos principais exploráveis. Cada um deles será ob-
servado de maneira individual.

AGLOMERAÇÃO

A aglomeração é a etapa que consome mais tempo de processamento
do algoritmo de esferas máximas, ainda mais na versão exata. Neste último,
foi feita a paralelização da busca e intersecção de esferas de mesmo raio, e
obteve-se uma melhora significativa de desempenho. Contudo, o esquema
utilizado na paralelização possui uma etapa serial relativamente grande que é
a expansão da garganta encontrada e processamento das esferas vizinhas.

Existem duas vertentes possíveis de solução do problema relatado. A
primeira é propor um esquema produtor e consumidor, onde cada esfera pro-
cessada em paralelo pelo produtor avisando o consumidor da necessidade de
processamento da esfera. O consumidor então processa a esfera e aguarda
outra. A segunda solução é propor um algoritmo de aglomeração novo, con-
templando a paralelização.



119

No esquema produtor e consumidor, a dificuldade de implementação
é pequena e os resultados são, em tese, promissores. No caso de propor um
novo algoritmo para a aglomeração, tem-se a necessidade da validação do
novo esquema segundo o padrão ouro, do algoritmo original. Também, al-
gumas etapas do algoritmo são claramente seriais e a paralelização total ne-
cessitaria em alguns casos de um mecanismo de rollback. Isto é, seria neces-
sário checar possíveis colisões de dependência entre esferas de mesmo raio
intersectantes para não haver uma violação das etapas definidas e consequen-
temente um resultado incorreto.

Em suma, seria lógico a implementação do esquema produtor e con-
sumidor e, caso não fosse suficiente para obter o desempenho esperado, a
modificação do algoritmo de modo a fazê-lo perder grandes partes seriais.

Uma possível implementação em gpu da aglomeração requereria uma
modificação total do algoritmo, até porque a expansão de gargantas não po-
deria ser feita da forma atual, isto é, sequencialmente. Uma alternativa menos
radical é modificar somente a busca de esferas vizinhas, aliada ao esquema
de produtor e consumidor em cpu. Em tese, essa forma traria os melhores re-
sultados. Entretanto, tais conjecturas necessitam de reflexão e testes pontuais
para serem feitas. Assim, são consideradas um trabalho futuro.

BUSCA DE ESFERAS VIZINHAS

A intersecção de esferas é feita da maneira exata e ótima, contudo há
a possibilidade de aumentar-se a paralelização dos algoritmos que a utilizam.
Isto é, otimizar a busca de esferas intersectáveis e não a intersecção em si.
A busca de esferas colidíveis é utilizada na remoção de esferas auto-inclusas
e na aglomeração de maneira extensiva. A otimização do passos em cpu,
por meio da paralelização dos algoritmos e da transformação da busca em
uma operação linear, conforme demonstrado na seção 4.5, obteve ganhos de
desempenho observado em ambas. Isto é, as etapas únicas de cada algoritmo
não foram paralelizadas, mas somente a busca de esferas intersectáveis.

Apesar de otimizar a utilização de processamento, as otimizações cita-
das necessitam guardar o resultado intermediário para cada esfera de mesmo
raio, ou seja, utilizam mais memória, mesmo que de maneira temporária. As-
sim, acredita-se que a utilização de algum esquema de intersecção em massa
entre esferas seja capaz de obter resultados interessantes, se implementado
em gpu, porém a utilização de memória pode ser proibitiva, sobretudo em
volumes grandes.



120

ESTRUTURAS COMPRIMIDAS EM GPU

A representação de estruturas comprimidas em gpu, assim como fo-
ram concebidas em cpu, possibilita a implementação dos diversos algoritmos
observados no capítulo 4 de maneira a utilizar menos memória. Tais otimiza-
ções de memórias são imprescindíveis, até porque a memória disponível em
gpu é, em geral, menor que a memória principal, disponível para CPU. Isto
deve-se ao fato da arquitetura única da gpu, denominada single instruction
multiple thread (SIMT).

Implementando-se as estruturas comprimidas em gpu, tem-se a pos-
sibilidade de aplicar as ideias referentes a intersecção de esferas e busca de
esferas nessa arquitetura. O principal desafio seria adaptar os algoritmos re-
ferentes para utilizar a memória local, um tipo de memória pequena e rápida,
com garantia de acesso em tempo de registrador para um acesso coalescente
à memória.

BUSCA DE ESFERAS EM GPU

A busca de esferas de maneira exata, em gpu, é possível. O algoritmo
de parallel banding é capaz de extrair um mapa de distâncias exatas a partir de
imagens binarizadas. Tal algoritmo, assim como de Saito e Toriwaki (1994),
possui três passos distintos de transformação: 1D, 2D e 3D.

A ideia é dividir o volume em faixas (bands) distintas e resolver o
problema localmente. Após solver o problema local, tem-se um passo de
redução global, unindo resultados vizinhos. Em sequência, tem-se a nova
aplicação do passo de solucionar as distâncias e a transformada é completa.

No eixo 1D, os três passos descritos são aplicados de maneira sem
alteração. Na 2D, tem-se a necessidade de uma ordenação de faixas a se-
rem visitadas. Colocando-as em uma pilha de visitação. A parte serial é pe-
quena em relação a paralela e os desempenhos finais obtidos com tal técnica
é melhor mesmo que em técnicas similares que calculam somente a distância
aproximada. No eixo 3D a ideia é homóloga ao 2D.

A otimização da etapa de busca pode parecer desnecessária pelo fato
dessa etapa ser a menos custosa entre todas as 4. Contudo, a otimização das
outras fases pode vir a destacar essa como gargalo e solucionar esse problema
em gpu pode ser útil em implementações diversas, uma vez que o mapa de
distâncias exatas possui muitas outras aplicações.



121

UTILIZAÇÃO DE PONTO FIXO AO INVÉS DE PONTO FLUTUANTE

O ponto flutuante provê uma maneira de representar números decimais
num computador. Uma outra maneira de representar-se números desse tipo é
o ponto fixo. A vantagem dessa notação sobre o ponto flutuante é a de utilizar
somente de operações inteiras para fazer operações sobre a representação.
Assim, em cpu, haveriam ganhos grandes. Em contrapartida, a operação de
extração da raiz quadrada, tipicamente utilizada nas fórmulas de intersecção
e obtenção do raio das esferas seria aproximada.

O resultado final tenderia a ser mais preciso que o MB, mas menos
preciso que o EMB. Uma avaliação do resultado final seria necessária, mas
acredita-se que o ganho de eficiência seria interessante o suficiente para jus-
tificar o tradeoff.

6.2.2 Validação com outras técnicas e estudo de variáveis de entrada e
saída

A validação com outras técnicas será vital afim de comprovar a eficá-
cia e capacidade de representação da rede para as características geométricas,
topológicas e petrofísicas da rede, sobretudo nas previsões de escoamento e
simulações multifásicas. Nos trabalhos de Al-Kharusi e Blunt (2007) e Dong
e Blunt (2007) definiu-se uma comparação com o método PB, com LBM e
com dados obtidos por análise em laboratório como a porosimetria por inje-
ção de mercúrio descrita no capítulo 3.

Neste trabalho, não foi possível fazer paralelos com outras técnicas
por motivos diversos. Entre eles, indisponibilidade de equipamento e im-
possibilidade de aquisição de licenças dos softwares capazes de extrair tais
dados. Se solucionado os problemas descritos, existe a possibilidade de uma
validação baseada em dados obtidos por outras técnicas.

A partir dos dados validados, torna-se possível definir quais valores
utilizar em variáveis parametrizáveis do algoritmo, isto é o fator de expansão
das gargantas e o tamanho mínimo em voxels para uma esfera ser classificada
como poro.

Acredita-se que tais variáveis não tenham um valor ótimo para todos
os volumes, porém que em determinados tipos de rocha, valores ótimos ob-
tidos, por meio da análise da variação dos parâmetros, existam. Uma outra
possibilidade, seria propor variáveis adaptativas em ambos os casos, ou seja,
fatores de expansão adaptativos, dependentes dos tamanhos dos poros conec-
tantes e da garganta em questão. Também, os tamanhos mínimos de poro
poderiam ser dependentes do tamanho do volume.



122

6.2.3 Tratamento de dados multiescalares e volumes grandes

Dois pontos que não foram abordados durante o trabalho mas foram
citados direta ou indiretamente são a representação de volumes grandes e o
tratamento de dados multiescalares. Durante o capítulo 3, descreveu-se uma
técnica para compressão eficiente de volumes binarizados. Ainda assim, a
representação de volumes gigantescos com mais de 8000 voxels de lado é
um desafio na atualidade. Principalmente, se aliado ao tamanho do volume
tem-se diferentes amostras com resoluções distintas representando os mes-
mos dados.

O tratamento de dados multiescalares, mesmo sua visualização é um
desafio. Em Guthe et al. (2002), utilizou-se a compressão por wavelets para
a visualização de dados em várias qualidades distintas. O objetivo do traba-
lho era ser capaz de visualizar grandes volumes de dados em workstations
padrões da época. Ao considerar-se o panorama de visualização de múltiplos
volumes, o uso da gpu é imprescindível (BEYER, 2009; KAINZ et al., 2009).

A caracterização de volumes multiescalares também constitui um de-
safio recorrente e tem sido abordado com maior frequência em tempos re-
centes (NORDBOTTEN, 2009; BISWAL et al., 2011). Ela é útil na carac-
terização de volumes heterogêneos pela representação macroscópicas e mi-
croscópica das caracterísicas da rocha. Pode-se considerar a caracterização
multiescalar como um problema aberto, cuja solução, mesmo para casos sin-
gulares, requer um estudo profundo.

6.3 RECONHECIMENTOS E AGRADECIMENTOS

Esse trabalho foi fruto de uma operação conjunta entre a Petrobras,
o O Laboratório de Meios Porosos e Propriedades Termofísicas (LMPT) e o
Laboratório de Processamento de Imagens e Computação gráfica (LAPIX),
ambos da Universidade Federal de Santa Catarina. Conforme descrito no ca-
pítulo 3, quatro das amostras (C3, C4, S10 e S11) foram disponibilizadas pelo
LMPT e pela Petrobras. Alguns dos resultados desse trabalham intersectam
diretamente com o trabalho de Cunha (2012) e a leitura desse, além de ser
complementar a esse trabalho, é indispensável para compreensão completa
da área da caracterização de meios porosos.

Agradeço também aos colegas Felipe Borges Alves, Jeferson Vieira
Ramos e Renan Teston Inácio. Todos parceiros de projeto e de laboratório há
anos. Em especial ao Renan, pela descoberta das aproximações feitas por Hu
Dong em seu trabalho e pela ideia de fazer uma compressão por segmentos,
a qual foi definida e implementada nesse trabalho. Os trabalhos de Ramos



123

(2012) e Inácio (2012) também complementam os resultados obtidos nesse.
O primero propõe a validação do EMB, enquanto o segundo trata da renderi-
zação de múltiplas esferas.

Agradeço ao Martin Prüsse pela ideia de utilizar o ponto fixo no lugar
de ponto flutuante que pode trazer novos resultados para a extração de redes
de poros. Por fim, agradeço o colega Adiel Mittmann, cuja introdução à
linguagem R incentivou-me a usá-la.



124



125

REFERÊNCIAS BIBLIOGRÁFICAS

AL-KHARUSI, A. S.; BLUNT, M. J. Pore Scale Characterization of
Carbonate Rocks. Tese (Doutorado), 2007.

BAKKE, S.; OREN, P.-E. 3-d pore-scale modelling of sandstones
and flow simulations in the pore networks. SPE Journal, Society of
Petroleum Engineers, v. 2, n. 2, p. 136–149, Jun 1997. Disponível em:
&lt;http://www.onepetro.org/mslib/servlet/onepetropreview?id=00035479&amp;amp;soc=SPE&gt;.

BERNASCHI, M. et al. A flexible high-performance lattice boltzmann GPU
code for the simulations of fluid flows in complex geometries. Concurrency
Computat.: Pract. Exper., John Wiley &amp;amp; Sons, Ltd., Istituto Applicazioni
Calcolo, CNR, Viale Manzoni, 30-00185 Rome, Italy; Nvidia Corporation,
2701 San Tomas Expressway, Santa Clara, CA 95050, U.S.A.; SOFT,
Istituto Nazionale Fisica della Materia, CNR, P.le A. Moro, 2-00185 Rome,
Italy; Department of Physics and School of Engineering and Applied
Sciences, Harvard University, Cambridge, MA 02138, U.S.A.; Initiative
in Innovative Computing, Harvard University, Cambridge, MA 02138,
U.S.A., v. 22, n. 1, p. 1–14, 2010. ISSN 1532-0634. Disponível em:
&lt;http://dx.doi.org/10.1002/cpe.1466&gt;.

BEYER, J. GPU-based Multi-Volume Rendering of Complex Data in
Neuroscience and Neurosurgery. Tese (Doutorado) — Institute of Computer
Graphics and Algorithms, Vienna University of Technology, Favoritenstrasse
9-11/186, A-1040 Vienna, Austria, out. 2009. Disponível em:
&lt;http://www.cg.tuwien.ac.at/research/publications/2009/beyer-2009-gpu/&gt;.

BISWAL, B. et al. Modeling of multiscale porous media. Image Analysis
&amp;amp; Stereology, v. 28, n. 1, 2011. ISSN 1854-5165. Disponível em:
&lt;http://www.ias-iss.org/ojs/IAS/article/view/846&gt;.

CHATZIS, I.; DULLIEN, F. A. L. Modelling pore structure by 2-d and 3-d
networks with applicationto sandstones. Journal of Canadian Petroleum
Technology, n. 1, Jan 1977.

CHEN, S.; DOOLEN, G. D. Lattice boltzmann method for fluid flows.
Annu. Rev. Fluid Mech., v. 30, n. 1, p. 329–364, 1998. Disponível em:
&lt;http://dx.doi.org/10.1146/annurev.fluid.30.1.329&gt;.

CORWIN, E.; LOGAR, A. Sorting in linear time - variations on the
bucket sort. J. Comput. Small Coll., Consortium for Computing Sciences



126

in Colleges, USA, v. 20, p. 197–202, October 2004. ISSN 1937-4771.
Disponível em:&amp;lt;http://dl.acm.org/citation.cfm?id=1040231.1040257&gt;.

CUNHA, A. R. Caracterização de sistemas porosos de rochas reservatório
de petróleo a partir da extração de redes poro-ligações. Dissertação
(Mestrado) — Universidade Federal de Santa Catarina, 2012. Em elaboração.

DONG, H.; BLUNT, M. J. Micro CT Imaging and Pore Network Extraction.
Tese (Doutorado), 2007.

DONG, H.; BLUNT, M. J. Pore-network extraction from micro-
computerized-tomography images. Physical Review E - Statistical,
Nonlinear and Soft Matter Physics, APS, v. 80, n. 3 Pt 2, p. 036307, 2009.
Disponível em:&amp;lt;http://link.aps.org/doi/10.1103/PhysRevE.80.036307&gt;.

ERICSON, C. Real-Time Collision Detection (The Morgan Kauf-
mann Series in Interactive 3-D Technology). Morgan Kauf-
mann, 2005. Hardcover. ISBN 1558607323. Disponível em:
&lt;http://www.amazon.com/exec/obidos/redirect?tag=citeulike07-
20&amp;amp;path=ASIN/1558607323&gt;.

FABBRI, R. et al. 2D euclidean distance transform algorithms: A
comparative survey. ACM Comput. Surv., ACM, New York, NY, USA,
v. 40, n. 1, p. 1–44, fev. 2008. ISSN 0360-0300. Disponível em:
&lt;http://dx.doi.org/10.1145/1322432.1322434&gt;.

GPU Cluster for High Performance Computing. 47 p. Disponível em:
&lt;http://ieeexplore.ieee.org/xpls/abs_all.jsp?arnumber=1392977&gt;.

FATT. The network model of porous media iii. dynamic properties of
networks with tube radius distribution. Trans Soc. Min. Eng. AIME, 1956.

FERNANDES, J. S.; APPOLONI, C. R.; FERNANDES, C. P. Determinacao
de parametros microestruturais e reconstrução de imagens 3-d de rochas
reservatorio por microtomografia de raios x. RECEN - Revista Ciências
Exatas e Naturais, Vol. 11, No 1 (2009), 2009. ISSN 2175-5620. Disponível
em:&amp;lt;http://revistas.unicentro.br/index.php/RECEN/article/view/384&gt;.

GUTHE, S. et al. Interactive rendering of large volume data sets. In:
Visualization, 2002. VIS 2002. IEEE. [S.l.: s.n.], 2002. p. 53 –60.

INÁCIO, R. T. Visualização de conjuntos de dados representáveis por
esferas. Dissertação (Mestrado) — Universidade Federal de Santa Catarina,
2012. Em elaboração.



127

JONES, R. W. Comparison of carbonate and shale source rocks. AAPG
Special Volumes, SG 18: Petroleum Geochemistry and Source Rock
Potential of Carbonate Rocks, p. 163–180, 1984.

KAINZ, B. et al. Ray casting of multiple volumetric datasets with
polyhedral boundaries on manycore gpus. In: ACM SIGGRAPH
Asia 2009 papers. New York, NY, USA: ACM, 2009. (SIGGRAPH
Asia ’09), p. 152:1–152:9. ISBN 978-1-60558-858-2. Disponível em:
&lt;http://doi.acm.org/10.1145/1661412.1618498&gt;.

KITCHENHAM, B. Procedures for performing systematic reviews. [S.l.],
2004.

LERDAHL, T. R.; OREN, P.-E.; BAKKE, S. A predic-
tive network model for three-phase flow in porous media.
Society of Petroleum Engineers, 2000. Disponível em:
&lt;http://www.onepetro.org/mslib/servlet/onepetropreview?id=00059311&amp;amp;soc=SPE&gt;.

LOTUFO, R.; FALCAO, A.; ZAMPIROLLI, F. Fast euclidean distance
transform using a graph-search algorithm. Graphics, Patterns and Images,
SIBGRAPI Conference on, IEEE Computer Society, Los Alamitos, CA,
USA, v. 0, p. 269, 2000. ISSN 1530-1834.

LUCIA, F. J. Carbonate Reservoir Characterization. New York:
Springer-Verlag Berlin Heidelberg, 1999. 336 p.

MASON, G.; MORROW, N. R. Capillary behavior of a perfectly
wetting liquid in irregular triangular tubes. Journal of Colloid and
Interface Science, v. 141, n. 1, p. 262–274, 1991. Disponível em:
&lt;http://linkinghub.elsevier.com/retrieve/pii/002197979190321X&gt;.

NORDBOTTEN, J. M. Multiscale methods for multiphase flow in porous
media. In: Domain Decomposition Methods in Science and Engineering
XVIII. Springer Berlin Heidelberg, 2009, (Lecture Notes in Computational
Science and Engineering, v. 70). p. 39–50. ISBN 978-3-642-02677-5.
Disponível em:&amp;lt;http://dx.doi.org/10.1007/978-3-642-02677-5_4&gt;.

OREN, P.-E.; BAKKE, S. Process based reconstruction of sands-
tones and prediction of transport properties. Transport in Po-
rous Media, Springer Netherlands, v. 46, p. 311–343, 2002.
ISSN 0169-3913. 10.1023/A:1015031122338. Disponível em:
&lt;http://dx.doi.org/10.1023/A:1015031122338&gt;.

PATZEK, T.; SILIN, D. Shape factor and hydraulic conductance in noncircu-
lar capillaries: I. one-phase creeping flow. Journal of Colloid and Interface



128

Science, v. 236, n. 2, p. 295 – 304, 2001. ISSN 0021-9797. Disponível em:
&lt;http://www.sciencedirect.com/science/article/pii/S0021979700974137&gt;.

RAMOS, J. V.

Validação do Cálculo de Dados Petrofísicos com Base na Caracterização de
Rochas de Reservatório — Universidade Federal de Santa Catarina, 2012.
Em elaboração.

ROBERT, J.; CORDELL. Chapter 5 carbonates as hydrocarbon source rocks.
In: CHILINGARIAN, S. M. G.; RIEKE, H. (Ed.). carbonate reservoir
characterization: a geologic—engineering analysis, part I. Elsevier, 1992,
(Developments in Petroleum Science, v. 30). p. 271 – 329. Disponível em:
&lt;http://www.sciencedirect.com/science/article/pii/S0376736109701281&gt;.

SAITO, T.; TORIWAKI, J.-I. New algorithms for euclidean
distance transformation of an n-dimensional digitized pic-
ture with applications. Pattern Recognition, v. 27, n. 11,
p. 1551 – 1565, 1994. ISSN 0031-3203. Disponível em:
&lt;http://www.sciencedirect.com/science/article/pii/0031320394901333&gt;.

SCHENA, G.; FAVRETTO, S. Pore space network characterization with
sub-voxel definition. Transport in Porous Media, Springer Netherlands,
v. 70, p. 181–190, 2006. ISSN 0169-3913. 10.1007/s11242-006-9094-z.
Disponível em:&amp;lt;http://dx.doi.org/10.1007/s11242-006-9094-z&gt;.

SCHENA, G.; FAVRETTO, S.; PILLER, M. Pore space characterisation
and permeability prediction using fast network extraction and pore throat
conductance calculation. Society of Petroleum Engineers, 2008. Disponível
em:&amp;lt;http://www.onepetro.org/mslib/servlet/onepetropreview?id=SPE-
113511-MS&amp;amp;soc=SPE&gt;.

SEZGIN, M.; SANKUR, B. Survey over image thresholding techniques
and quantitative performance evaluation. Journal of Electronic Imaging,
SPIE, v. 13, n. 1, p. 146–168, 2004. ISSN 10179909. Disponível em:
&lt;http://dx.doi.org/10.1117/1.1631315&gt;.

SILIN, D. B.; JIN, G.; PATZEK, T. W. Robust determination of the pore
space morphology in sedimentary rocks. Society of Petroleum Engineers,
2003.

SILVA, A. F. B. et al. A multi-layered development framework for medical
imaging applications. In: CBMS’09. [S.l.: s.n.], 2009. p. 1–4.



129

TORELLI, J. C. et al. A high performance 3D exact euclidean distance
transform algorithm for distributed computing. International Journal of
Pattern Recognition and Artificial Intelligence, v. 24, n. 6, p. 1–19, 2010.

VALVATNE, P.; BLUNT, M. J. Predictive Pore-Scale Modelling of
Multiphase Flow. Tese (Doutorado), 2004.

VALVATNE, P. H. et al. Predictive pore-scale modeling of single and
multiphase flow. Transport in Porous Media, Springer Netherlands, v. 58, p.
23–41, 2005. ISSN 0169-3913. 10.1007/s11242-004-5468-2. Disponível em:
&lt;http://dx.doi.org/10.1007/s11242-004-5468-2&gt;.

WASHBURN, E. W. The dynamics of capillary flow. Phys. Rev., v. 17, p.
273–283, 1921.



130



131

7 APÊNDICE A: FORMATO RBV E RESULTADOS

7.1 FORMATO RBV

O formato Run-length Encoded Binary Volume (RBV) é composto por
duas partes. A primeira é o header com extensão .rbv , cujas informações são:

Campo Descrição Exemplo Tipo

DataDimensions Tamanho do
volume em voxels

“300 300 300” Obrigatório

Spacing Espaçamento entre
cada voxel

“0.375 0.332 0.8” Obrigatório

BinaryFile Caminho absoluto
ou relativo para a
parte binária, isso

é, o .rle

“arquivoTeste.rle” Obrigatório

Title Título da amostra “amostra teste” Opcional
Porosity Porosidade do

volume
“14.769” Opcional

O arquivo .rle é definido como um conjunto de headers seguidos de
segmentos. Em C:

# i n c l u d e &amp;lt;s t d i n t . h &gt;

s t r u c t R L E S e g m e n t H e a d e r {
u i n t 1 6 _ t n u m b e r O f S e g m e n t s ;
u i n t 8 _ t f i r s t P i x e l V a l u e ;

} ;

s t r u c t RLESegment {
u i n t 1 6 _ t s t a r t ;
u i n t 1 6 _ t l e n g t h ;

} ;

7.2 VALORES PARA DEMAIS VOLUMES

Nessa seção são apresentados os resultados obtidos pela extração das
RPs nos arenitos S4, S6, S7, S8 e S9. Os resultados observados nesses valores
são análogos aos apresentados durante o capítulo 5. Também são apresenta-
dos os números de coordenação para todas as redes exceto a C1 e S1, já vistas
durante o trabalho.



132

EMB MB
Porosidade da rede 17.2 17.3
N de poros 14265.0 9556.0
N de gargantas 18971.0 13321.0
N de inlets 375.0 312.0
N de outlets 395.0 317.0
N de isolados 2039.0 1221.0
Elementos circulares 163.0 0.0
Elementos quadrados 234.0 132.0
Elementos triangulares 32841.0 22747.0

Tabela 18: Características da RP, no EMB e MB, para o volume S4

Figura 62: Rede gerada para o volume S4



133

EMB MB
Porosidade da rede 24.5 24.5
N de poros 1316.0 597.0
N de gargantas 2642.0 1234.0
N de inlets 101.0 61.0
N de outlets 33.0 21.0
N de isolados 66.0 44.0
Elementos circulares 101.0 0.0
Elementos quadrados 74.0 12.0
Elementos triangulares 3785.0 1821.0

Tabela 19: Características da RP, no EMB e MB, para o volume S6

Figura 63: Rede gerada para o volume S6



134

EMB MB
Porosidade da rede 25.9 25.6
N de poros 2041.0 1016.0
N de gargantas 4734.0 2741.0
N de inlets 130.0 74.0
N de outlets 130.0 95.0
N de isolados 28.0 26.0
Elementos circulares 122.0 0.0
Elementos quadrados 126.0 13.0
Elementos triangulares 6529.0 3746.0

Tabela 20: Características da RP, no EMB e MB, para o volume S7

Figura 64: Rede gerada para o volume S7



135

EMB MB
Porosidade da rede 34.6 34.6
N de poros 2506.0 1324.0
N de gargantas 6612.0 4029.0
N de inlets 141.0 91.0
N de outlets 160.0 101.0
N de isolados 74.0 56.0
Elementos circulares 176.0 0.0
Elementos quadrados 170.0 20.0
Elementos triangulares 8774.0 5335.0

Tabela 21: Características da RP, no EMB e MB, para o volume S8

Figura 65: Rede gerada para o volume S8



136

EMB MB
Porosidade da rede 23.2 23.0
N de poros 880.0 604.0
N de gargantas 1454.0 1054.0
N de inlets 62.0 48.0
N de outlets 76.0 56.0
N de isolados 85.0 67.0
Elementos circulares 20.0 0.0
Elementos quadrados 23.0 10.0
Elementos triangulares 2293.0 1650.0

Tabela 22: Características da RP, no EMB e MB, para o volume S9

Figura 66: Rede gerada para o volume S9



137

EMB MB
Porosidade da rede 19.8 19.5
N de poros 2534.0 1429.0
N de gargantas 5047.0 2888.0
N de inlets 114.0 86.0
N de outlets 117.0 77.0
N de isolados 120.0 81.0
Elementos circulares 115.0 0.0
Elementos quadrados 66.0 17.0
Elementos triangulares 7402.0 4302.0

Tabela 23: Características da RP, no EMB e MB, para o volume S10

Figura 67: Rede gerada para o volume S10



138

EMB MB
Porosidade da rede 23.7 23.6
N de poros 977.0 566.0
N de gargantas 2030.0 1171.0
N de inlets 56.0 44.0
N de outlets 59.0 45.0
N de isolados 32.0 22.0
Elementos circulares 59.0 0.0
Elementos quadrados 30.0 6.0
Elementos triangulares 2920.0 1733.0

Tabela 24: Características da RP, no EMB e MB, para o volume S11

Figura 68: Rede gerada para o volume S11



139

1 3 5 7 9 11 14 17 20 23 26 29 32 35 38 41

MB

EMB

0

10

20

30

40

50

F
re

q
u

ên
ci

a 
(%

)

Número de coordenação

Figura 69: Distribuição do número de coordenação para o EMB e MB no
volume C2

7.2.1 Números de coordenação

Nessa seção são demonstrados graficamente os números de coordena-
ção para as amostras não vistas durante o capítulo 5.

Uma forte tendência que pode ser observada em todas as figuras é ade
gerar menos poros com zero ou uma conexão. Isso comprova que apesar de
gerar um número maior de voxels inválidos, conforme visto no capítulo 4, o
EMB gera menos poros desconexos.

Na tese de Dong e Blunt (2007) ele teoriza em certo ponto que um nú-
mero alto de poros desconexos pode ser devido a baixa resolução da imagem
de entrada. Apesar de tal constatação poder ser verdadeira, há espaço para
melhoria na técnica MB nesse sentido. Ou seja, é possível extrair poros mais
bem conexos da mesma imagem de entrada do MB, conforme demonstrado
pela rede EMB gerada.

Também, percebe-se uma tendência similar a do C1 e S1. Isso é, no
C2 há uma alta concentração em valores baixos de coordenação e poucos
poros com valores altíssimos. Em contrapartida, nos arenitos observa-se uma
maior regularidade da distribuição com uma frequência bem maior de poros
medianos.



140

1 2 3 4 5 6 7 8 9 11 13 15 17 19 21 23

MB

EMB

0

5

10

15

20

F
re

q
u

ên
ci

a 
(%

)

Número de coordenação

Figura 70: Distribuição do número de coordenação para o EMB e MB no
volume S2

1 3 5 7 9 11 13 15 17 19 21 23 25 27 29 31 33 35

MB

EMB

0

5

10

15

20

25

30

F
re

q
u

ên
ci

a 
(%

)

Número de coordenação

Figura 71: Distribuição do número de coordenação para o EMB e MB no
volume S3



141

1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18

MB

EMB

0

5

10

15

20

25

30

F
re

q
u

ên
ci

a 
(%

)

Número de coordenação

Figura 72: Distribuição do número de coordenação para o EMB e MB no
volume S4

1 3 5 7 9 11 13 15 17 19 21 23 25 27 29 31 33

MB

EMB

0

5

10

15

20

25

30

F
re

q
u

ên
ci

a 
(%

)

Número de coordenação

Figura 73: Distribuição do número de coordenação para o EMB e MB no
volume S5



142

1 3 5 7 9 11 14 17 20 23 26 29 32 35 38

MB

EMB

0

5

10

15

20

25

F
re

q
u

ên
ci

a 
(%

)

Número de coordenação

Figura 74: Distribuição do número de coordenação para o EMB e MB no
volume S6

1 4 7 10 13 16 19 22 25 28 31 34 37 40 43 46 49 52

MB

EMB

0

5

10

15

20

F
re

q
u

ên
ci

a 
(%

)

Número de coordenação

Figura 75: Distribuição do número de coordenação para o EMB e MB no
volume S7



143

1 3 5 7 9 11 13 15 17 19 21 23 25 27 29 31 33 35 37

MB

EMB

0

5

10

15
F

re
q
u

ên
ci

a 
(%

)

Número de coordenação

Figura 76: Distribuição do número de coordenação para o EMB e MB no
volume S8

1 3 5 7 9 11 13 15 17 19 21 23 25 27 29 31

MB

EMB

0

5

10

15

20

25

F
re

q
u

ên
ci

a 
(%

)

Número de coordenação

Figura 77: Distribuição do número de coordenação para o EMB e MB no
volume S9



144

1 2 3 4 5 6 7 8 9 10 12 14 16 18 20

MB

EMB

0

5

10

15

20

F
re

q
u

ên
ci

a 
(%

)

Número de coordenação

Figura 78: Distribuição do número de coordenação para o EMB e MB no
volume S10

1 2 3 4 5 6 7 8 9 11 13 15 17 19 21 23

MB

EMB

0

5

10

15

20

F
re

q
u

ên
ci

a 
(%

)

Número de coordenação

Figura 79: Distribuição do número de coordenação para o EMB e MB no
volume S11



145

1 3 5 7 9 11 14 17 20 23 26 29 32 35 38

MB

EMB

0

5

10

15

F
re

q
u

ên
ci

a 
(%

)

Número de coordenação

Figura 80: Distribuição do número de coordenação para o EMB e MB no
volume A1

7.3 ESCOAMENTO MONOFÁSICO NAS REDES EMB E MB NOS EI-
XOS Y E Z

Os resultados são refentes aos valores apresentados na tese de Dong
e Blunt (2007). No capítulo 5, foi feita uma comparação com os valores de
escoamento no eixo x. O eixo y apresentou, assim como o x, bons resultados,
porém no eixo z os valores para a rede EMB e MB foram bastante discrepan-
tes. No geral, observou-se valores esperados para as redes, porém no caso
C2, o resultado do EMB foi muito maior que o do MB para os fatores E f
utilizados. Uma explicação seria a diferença entre os parâmetros utilizados
na tese referente. Ainda assim, os resultados encontrados no trabalho citado
diferem bastante do encontrado nos testes rodados.

7.4 PARÂMETROS PARA O SIMULADOR

A definição dos parâmetros para escoamento no simulador two phase
foi feita usando um arquivo de descrição do mesmo, cuja definição das va-
riáveis encontra-se no trabalho de Valvatne e Blunt (2004). O arquivo de



146

Fy 0.5 Fy 0.6 Fy 0.7 Fy 0.8 Ky 0.5 Ky 0.6 Ky 0.7 Ky 0.8
S1 0.204 0.227 0.279 0.305 1.324 1.125 0.832 0.741
S2 0.137 0.155 0.172 0.191 2.535 2.130 1.851 1.629
S3 0.112 0.135 0.153 0.163 2.609 2.206 1.939 1.838
S4 0.081 0.094 0.099 0.106 2.496 2.135 2.025 1.862
S5 0.115 0.143 0.168 0.192 3.771 2.686 2.352 2.003
S6 0.126 0.159 0.168 0.184 3.581 2.682 2.575 2.192
S7 0.121 0.140 0.163 0.170 2.420 1.965 1.690 1.644
S8 0.118 0.135 0.154 0.171 3.268 2.786 2.357 2.082
S9 0.098 0.105 0.129 0.145 42.886 33.523 24.379 21.657
C1 0.108 0.159 0.166 0.177 2.797 1.928 1.800 1.504
C2 0.095 0.103 0.118 0.126 1.882 1.817 0.954 0.916
A1 0.110 0.132 0.153 0.166 2.731 2.163 1.765 1.596
Média 0.119 0.141 0.160 0.175 6.025 4.762 3.710 3.305
Variância 0.001 0.001 0.002 0.002 135.205 82.238 42.637 33.589

Tabela 25: Tabela que apresenta a razão do resultado obtido pela simulação
na rede EMB em relação aos resultados do trabalho de Dong e Blunt (2007)
para diferentes fatores de expansão, no eixo y

S1 S2 S3 S4 S5 S6 S7 S8 S9 C1 C2 A1

?

?

? ?

?

?

?

?

?

?

?

?

0e+00

2e+04

4e+04

6e+04

8e+04

1e+05

P
e
r
m

e
a
b
il

id
a
d

e
 (

m
D

)

Volume

?

MB

EMB 0.5

EMB 0.6

EMB 0.7

EMB 0.8

Figura 81: Permeabilidades Ky, em mD, para as redes EMB e o resultado
original de Dong e Blunt (2007)



147

S1 S2 S3 S4 S5 S6 S7 S8 S9 C1 C2 A1

?

?
? ?

? ? ? ? ?
?

?

?0

20

40

60

80

100

120

?

MB

EMB 0.5

EMB 0.6

EMB 0.7

EMB 0.8

F
at

or
 d

e 
fo

rm
aç

ão

Volume

Figura 82: Fatores de forma Fy para as redes EMB e o resultado original de
Dong e Blunt (2007)

Fz 0.5 Fz 0.6 Fz 0.7 Fz 0.8 Kz 0.5 Kz 0.6 Kz 0.7 Kz 0.8
S1 0.129 0.141 0.169 0.188 2.816 2.608 2.346 2.243
S2 0.120 0.138 0.156 0.174 3.027 2.506 2.176 1.912
S3 0.094 0.109 0.123 0.137 6.728 5.648 4.874 4.529
S4 0.083 0.096 0.105 0.119 2.378 2.008 1.796 1.560
S5 0.088 0.110 0.154 0.177 4.533 3.001 2.582 2.199
S6 0.135 0.155 0.161 0.177 2.710 2.240 2.182 1.851
S7 0.095 0.109 0.127 0.132 3.098 2.498 2.145 2.094
S8 0.104 0.118 0.134 0.148 3.464 2.973 2.523 2.217
S9 0.108 0.117 0.140 0.157 46.542 35.643 27.343 24.350
C1 0.131 0.158 0.164 0.178 3.144 2.604 2.435 1.980
C2 0.035 0.036 0.038 0.041 14.987 14.351 13.899 13.185
A1 0.092 0.108 0.124 0.140 3.969 3.178 2.670 2.257
Média 0.101 0.116 0.133 0.147 8.116 6.605 5.581 5.031
Variância 0.001 0.001 0.001 0.002 158.494 95.263 58.158 47.382

Tabela 26: Tabela que apresenta a razão do resultado obtido pela simulação
na rede EMB em relação aos resultados do trabalho de Dong e Blunt (2007)
para diferentes fatores de expansão, no eixo z



148

S1 S2 S3 S4 S5 S6 S7 S8 S9 C1 C2 A1

?

?

? ?

?

?

?

?

?

?

?

?

0

20000

40000

60000

80000

P
e
r
m

e
a
b
il

id
a
d

e
 (

m
D

)

Volume

?

MB

EMB 0.5

EMB 0.6

EMB 0.7

EMB 0.8

Figura 83: Permeabilidades Kz, em mD, para as redes EMB e o resultado
original de Dong e Blunt (2007)

S1 S2 S3 S4 S5 S6 S7 S8 S9 C1 C2 A1

?
?

? ?
? ? ? ? ? ?

?
?0

50

100

150

200

250
?

MB

EMB 0.5

EMB 0.6

EMB 0.7

EMB 0.8

F
at

or
 d

e 
fo

rm
aç

ão

Volume

Figura 84: Fatores de forma Fz para as redes EMB e o resultado original de
Dong e Blunt (2007)



149

parâmetros base utilizado no simulador foi o seguinte:

RAND_SEED
5 6 5 4 8 7 5
#

OUTPUT
% P r o p e r t y O u t p u t S w O u t p u t

T T
#

SAT_TARGET
%f i n a l S a t maxPc ma x D e l ta S w m a x D e l t a P c c a l c K r c a l c I

0 . 0 0 1 . 0 E21 0 . 2 0 5 0 0 0 0 0 . 0 T F
1 . 0 0 ?1.0 E21 0 . 2 0 5 0 0 0 0 0 . 0 T F

#

INIT_CON_ANG
0 . 0 0 . 0 0 . 2 3 . 0
#

EQUIL_CON_ANG
3 5 0 . 0 6 0 . 0 ?10.0 ?1.0 rMax
#

%FRAC_CON_ANG
% f r a c t i o n v o l B a s e d min max d e l t a e t a
% 0 . 5 T 9 0 . 0 1 4 0 . 0 ?10.0 ?1.0
% m e t h o d C l u s t Diam O i l?i n?Wat
% c o r r 4 F
%#

RES_FORMAT
e x c e l
#

RELPERM_DEF
s i n g l e F
#

TRAPPING
% I n j e c t f l u i d f r o m a l l o w d r a i n a g e w a t e r m u l t f a c t i n
% e n t r y e x i t o f d a n g l i n g e n d s f i l l e d c i r c e l e m

T F T 0 . 0 E?30
#

SOLVER_TUNE
% min Memory S c a l i n g S o l v e r V e r b o s e C o n d u c t a n c e
% t o l e r a n c e F a c t o r o u t p u t S o l v e r Cut?O f f

1 . 0 E?30 8 0 F 0 . 0
#

PRS_BDRS
% c a l c k r u s i n g r e c o r d p r e s s num p r e s s
% a v g p r e s s p r o f i l e s p r o f i l e s

F F 10
#

%SOLVER_DBG
% M a t r i c e s V e l o c i t i e s F i l e n a m e M a t l a b I n i t O n l y
% W O Res W O Res
% T T T F F F t e s t F F



150

%#

PORE_FILL_ALG
o r e n 2
#

PORE_FILL_WGT
0 0 . 5 1 . 0 5 . 0 1 0 . 0 5 0 . 0
#

%FILLING_LIST
%T T T
%#

FLUID
% i n t e r f a c i a l w a t e r o i l w a t e r o i l

w a t e r o i l
% t e n s i o n v i s c o s i t y v i s c o s i t y r e s i s t i v i t y r e s i s t i v i t y

d e n s i t y d e n s i t y
% (mN/m) ( c p ) ( c p ) ( Ohm . m) ( Ohm . m)

( kg / m3 ) ( kg / m3 )
3 0 . 0 1 . 0 1 . 0 1 . 2 1 0 0 0 . 0 1 0 0 0 . 0

1 0 0 0 . 0
% 1 2 . 3 0 . 9 9 1 5 . 2 3 1 . 2 1 0 0 0 . 0

1 0 4 4 . 0 1 0 4 4 . 0
#

CALC_BOX
0 . 1 0 . 9
#

%A_CLOSE_SHAVE
%0.7
%#

%MODIFY_MOD_SIZE
% 0 . 4 3 2 9
%#

%PRS_DIFF
%10.0 0 . 0 T
%#

%GRAV_CONST
%?9.81 ?9.81 0 . 0
%#

%MODIFY_RAD_DIST
% ================= THROATS =============================
%1 . / t h r o a t _ 1 p c _ c l a y . t x t ?2.0 ?600.0 % Read p o r e s i z e d i s t r i b u t i o n
% ================== PORES =============================
%2 ?1.0 ?3.0 0 . 2 3 . 0 % A s p e c t r a t i o
%T T 15
%#

%MODIFY_G_DIST
%?1
%5 0 . 0 0 1 0 . 0 4 8 1 1 ?1.0 ?1.0
%T 50
%#



151

%WRITE_NET
%T b e r e _ b i n
%#

SAT_COVERGENCE
% m i n N u m F i l l i n g s i n i t S t e p S i z e c u t B a c k m a x I n c r s t a b l e d i s p

10 0 . 1 0 . 8 2 . 0 F

A definição das varíaveis TITLE e NETWORK foram feitas de acordo
com a amostra de entrada.


</field>
	</doc>
</add>