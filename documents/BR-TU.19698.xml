<?xml version="1.0" encoding="utf-8"?>
<add>
	<doc>
		<field name="docid">BR-TU.19698</field>
		<field name="filename">3106_Farias_AgnaldoMonteiro_M.pdf</field>
		<field name="filetype">PDF</field>
		<field name="text">
Universidade Estadual de Campinas

Instituto de Matemática, Estatística e Computação Científica

Técnicas de Pós-Processamento na Simulação de Fluxos
Monofásicos em Meios Porosos

Agnaldo Monteiro Farias
Mestrado em Matemática Aplicada

Orientadora: Profa. Dra. Sônia Maria Gomes

Co-Orientador: Prof. Dr. Philippe R. B. Devloo

Campinas - SP

Dezembro de 2008





!!!!!!!!!!!!!!!"#$%&amp;amp;#%'%()*+,!"#%&amp;amp;-(%.)+%/%&amp;amp;0-(%
!!!!!!!!!!!!.".(")'-#%&amp;amp;/)&amp;amp;"1-##&amp;amp;/%&amp;amp;23"#%10
!!!!!!!!!!!"#$%#&amp;amp;'()*+#,-!.#+#,/!0+#1'#2,!3%4(1!5!06"7,!8!9:;&lt;

=,+#,1&gt;!3?2,%@&amp;amp;!.&amp;amp;2'(#+&amp;amp;!

=AA9' BC)2#),1 ! @( ! DE1FD+&amp;amp;)(11,/(2'&amp;amp; ! 2, ! 1#/G%,HI&amp;amp; ! @( ! J%GK&amp;amp;1!

/&amp;amp;2&amp;amp;J*1#)&amp;amp;1!(/!/(#&amp;amp;1!D&amp;amp;+&amp;amp;1&amp;amp;183?2,%@&amp;amp;!.&amp;amp;2'(#+&amp;amp;!=,+#,1!FF!0,/D#2,1&gt;!

LMNON!-1N2NP&gt;!A::7N!

Q+#(2',@&amp;amp;+(1!-!MR2#,!.,+#,!S&amp;amp;/(1T!OU#%#DD(!6(/V!"N!W(4%&amp;amp;&amp;amp;

W#11(+',HI&amp;amp; ! X/(1'+,@&amp;amp;Y ! F !Z2#4(+1#@,@( ![1',@G,% ! @( !0,/D#2,1N!

\21'#'G'&amp;amp;!@(!!.,'(/*'#),&gt;![1',']1'#),!(!0&amp;amp;/DG',HI&amp;amp;!0#(2']J#),N

^N !.C'&amp;amp;@&amp;amp;!@&amp;amp;1!(%(/(2'&amp;amp;1!J#2#'&amp;amp;1N!AN !.C'&amp;amp;@&amp;amp;1!S&amp;amp;,%F&amp;amp;+#(2'(@N!_N!

=G2HI&amp;amp;!@(!(K'+,HI&amp;amp;N!!\N!S&amp;amp;/(1&gt;!MR2#,!.,+#,N!\\N!W(4%&amp;amp;&amp;amp;&gt;!OU#%#DD(!6N!"N!

\\\N !Z2#4(+1#@,@( ![1',@G,% ! @( ! 0,/D#2,1N ! \21'#'G'&amp;amp; ! @( !.,'(/*'#),&gt;!

[1',']1'#),!(!0&amp;amp;/DG',HI&amp;amp;!0#(2']J#),N!\`N!B]'G%&amp;amp;N

B]'G%&amp;amp;!(/!#2?%a1-!O&amp;amp;1'FD+&amp;amp;)(11#2?!'()U2#bG(1!#2!1#/G%,'#&amp;amp;2!&amp;amp;J!J%&amp;amp;c!#2!D&amp;amp;+&amp;amp;G1!/(@#,N

O,%,4+,1F)U,4(!(/!#2?%a1!Xd(Vc&amp;amp;+@1Y-!!^N!=#2#'(!(%(/(2'!/('U&amp;amp;@N!AN!S&amp;amp;,%F&amp;amp;+#(2'(@!/('U&amp;amp;@1N!
_N!!=G2)'#&amp;amp;2!(K'+,)'#&amp;amp;2N

e+(,!@(!)&amp;amp;2)(2'+,HI&amp;amp;-!!32*%#1(!2G/C+#),

B#'G%,HI&amp;amp;-!.(1'+(!(/!.,'(/,'#),!3D%#),@,

",2),!(K,/#2,@&amp;amp;+,-!!O+&amp;amp;J,N!W+,N!M&amp;amp;2#,!.,+#,!S&amp;amp;/(1!X\.[00FZf\03.OY
!!!!!!O+&amp;amp;JN!W+N!O('+&amp;amp;2#&amp;amp;!OG%#2&amp;amp;!X\.[00FZf\03.OY

!!!!!!!!! O+&amp;amp;JN!W+N!g&amp;amp;+?(!h#i,+@&amp;amp;!W#,i!0,%%(!XZMOF=j[3Y

W,',!@,!@(J(1,-!!^98^A8A::7

O+&amp;amp;?+,/,!@(!OE1FS+,@G,HI&amp;amp;-!.(1'+,@&amp;amp;!(/!.,'(/,'#),!3D%#),@,

!!!!!!!!##





v

A meus pais,

José Alves Farias e

Helena Monteiro do N. Farias.



Agradecimentos

A minha querida Patrícia a quem agradeço o amor, carinho, compreensão e apoio.

A meus pais e irmãos.

Aos meus orientadores Sônia Maria Gomes e Philippe Remy B. Devloo pela atenção,
compreensão e amizade no desenvolvimento deste trabalho.

A todos meus colegas e amigos.

A todos os professores e funcionários da Unicamp que contribuíram de forma direta e indireta no
desenvolvimento deste trabalho.

Aos colegas e amigos do LabMeC, Cesar, Pira, Caju, Gustavo, Wilbor, João, Alaor, Denise, Diogo
e Thiago, sempre dispostos a ajudar.

À Petrobas pela bolsa de estudo concedida.

Agradeço a Deus pelo sonho realizado.

vii



Resumo

Em muitas situações na modelagem de problemas aplicados, o que se deseja de uma solução da
Equação Diferencial Parcial que descreve o modelo, não é a própria solução e sim alguma quanti-
dade de interesse. De forma geral, estas quantidades de interesse são caracterizadas por funcionais
lineares limitados no espaço de funções que contém as soluções. Como exemplo, tem-se: a derivada
da solução, o fluxo através de uma região da fronteira, o valor médio da solução sobre uma região
do domínio, o valor da solução em um ponto etc. Em tais circunstâncias, nem sempre o refinamento
uniforme ou uma estratégia de hp-refinamento, que diz respeito à qualidade global da solução, são
as estratégias mais apropriadas para melhorar a aproximação da quantidade, pois podem tornar o
custo computacional muito alto. Neste sentido, estratégias direcionadas para o aprimoramento da
aproximação de quantidades de interesse são temas que têm recebido grande interesse nas últimas
décadas. Um dos objetivos deste trabalho é o estudo de métodos para o pós-processamento da
solução por elementos finitos com objetivo de se obter uma precisão desejável na aproximação das
quantidades de interesse. Em particular, estudam-se dois métodos: a estratégia de adaptatividade
goal-oriented e o método da função de extração.

Palavras-chaves: Método dos elementos finitos, Métodos goal-oriented, Função extração.

ix



Abstract

In many situations in the modeling of applied problems, what is wish is not the solution of gover-
ning partial differential equation system but rather a quantities of interest. In general, the quantities
of interest are characterized by bounded linear functionals on the space of functions to which the
solutions belongs. As an example, we have: the derivative of the solution, the flux through part of
the bondary of the domain, the average of the solution over a subdomain, the value of the solution
in a point etc. In this circumstances, the uniform refinement or a strategy for hp-refinement, which
concerns the overall quality of the solution, not always are the most appropriate strategies to im-
prove the approximation of the quantity, because the computational cost may become too high. In
this sense, strategies directed to improve the accuracy of quantities of interest are topics that have
received considerable interest in recent decades. One of the objectives of this work is the study of
post-processing methods of the solution by finite elements in order to achieve a desirable precision
in the approximation of quantities of interest. In particular two methods are studied: the strategy
goal-oriented adaptivity and the method of the extraction function.

keywords: Finite element method, Goal-oriented methods, Extraction function.

xi



Lista de Símbolos

Letras Romanas:
B(·,·) - Forma bilinear
Cm([a, b]) - Espaço das funções definidas em [a, b] e de derivada D! , 0 !| ! |! m, contínua
D! - Operador de derivada parcial de multi-índice, ! = (!1, ..., !n)
F(·) - Forma linear
h - Parâmetro relacionado ao "tamanho" do elemento

H m(·) - Espaço de Sobolev
"#
K - Tensor das permeabilidades

K - Elemento geométrico

L(·) - Quantidade de Interesse
L?(·) - Forma generalizada de L(·)
L2(·) - Espaço Vetorial Normado
Nx, Ny - Número de divisões nos eixos x e y, respectivamente

p(·) - Pressão
p - grau do polinômio

T (·) - Transformação Linear
Th - Partição

X , Y - Espaços vetoriais

Letras Gregas:
! - Domínio computacional
µ - Viscosidade do fluido
" - Função Geradora
"i - Funções de base globais
#i - Funções de base locais

xiii



xiv

Símbolos:
" - Operador laplaciano
# - Operador gradiente
div - Operador divergente
| · | - Módulo
$ · $ - Norma
%·,·&amp;amp; - Produto interno



Sumário

1 Introdução 1

2 Aspectos Teóricos da Análise Funcional 3
2.1 Noções Preliminares . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 3

2.1.1 Transformações Lineares . . . . . . . . . . . . . . . . . . . . . . . . . . . 3
2.1.2 Funcional Linear (ou Forma Linear) . . . . . . . . . . . . . . . . . . . . . 5
2.1.3 Espaços Duais . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 5
2.1.4 Espaços de Hilbert . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 5

2.2 Formas Bilineares . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 7
2.2.1 Exemplos . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 9

2.3 Problema Variacional e Método de Galerkin . . . . . . . . . . . . . . . . . . . . . 10
2.3.1 O Problena Variacional . . . . . . . . . . . . . . . . . . . . . . . . . . . . 10
2.3.2 O Método de Galerkin . . . . . . . . . . . . . . . . . . . . . . . . . . . . 10

2.4 Os Espaços de Sobolev H m(!) e H m0 (!) . . . . . . . . . . . . . . . . . . . . . . . 12

3 Problema Físico 17
3.1 Equações Diferenciais de Interesse . . . . . . . . . . . . . . . . . . . . . . . . . . 17

3.1.1 Lei de Conservação da Massa . . . . . . . . . . . . . . . . . . . . . . . . 18
3.1.2 Casos Especiais de Interesse . . . . . . . . . . . . . . . . . . . . . . . . . 21

4 O Método dos Elementos Finitos - MEF 23
4.1 O Problema Modelo - Equação de Poisson . . . . . . . . . . . . . . . . . . . . . . 24
4.2 Formulação Variacional . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 24

4.2.1 Existência e Unicidade . . . . . . . . . . . . . . . . . . . . . . . . . . . . 25
4.3 Espaços de Elementos Finitos . . . . . . . . . . . . . . . . . . . . . . . . . . . . 26

4.3.1 Espaços de Elementos Finitos de Lagrange em 1D . . . . . . . . . . . . . 26
4.3.2 Espaços de Elementos Finitos de Lagrange em 2D . . . . . . . . . . . . . 31

xv



xvi SUMÁRIO

4.3.3 Formulação de Galerkin . . . . . . . . . . . . . . . . . . . . . . . . . . . 34
4.4 Estimadores de erro . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 35

4.4.1 Estimativa do Erro a Priori . . . . . . . . . . . . . . . . . . . . . . . . . . 36
4.4.2 Estimativa do Erro a Posteriori . . . . . . . . . . . . . . . . . . . . . . . . 37

4.5 Adaptatividade . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 39

5 PZ - Ambiente de Programação Orientado a Objeto 41
5.1 Experimentos Numéricos . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 42

5.1.1 Problema 1D . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 42
5.1.2 Exemplo 2D . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 45

6 Adaptatividade Goal-Oriented 51
6.1 Introdução . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 51

6.1.1 Exemplos de funcionais lineares limitados . . . . . . . . . . . . . . . . . . 52
6.2 Estimativa para o Erro em Quantidade de Interesse . . . . . . . . . . . . . . . . . 53
6.3 Aproximações e Limites para Erro L(e) . . . . . . . . . . . . . . . . . . . . . . . 55
6.4 Controle Adaptativo do Erro L(e): Refinamento

Goal-Oriented . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 57
6.5 Exemplo . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 59

6.5.1 Construção do Problema Dual . . . . . . . . . . . . . . . . . . . . . . . . 59
6.5.2 Solução Numérica . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 60

6.6 Problema Dual na Aproximação do Fluxo . . . . . . . . . . . . . . . . . . . . . . 63
6.6.1 Resultados Numéricos e Comentários . . . . . . . . . . . . . . . . . . . . 64

7 O Método da Função de Extração 67
7.1 Forma Generalizada para L(u) . . . . . . . . . . . . . . . . . . . . . . . . . . . . 67

7.1.1 Exemplo . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 68
7.2 Caso de Interesse (fluxo monofásico em meios porosos) . . . . . . . . . . . . . . . 70

7.2.1 Formulação do Problema . . . . . . . . . . . . . . . . . . . . . . . . . . . 70
7.2.2 Formas Generalizadas !L(u) . . . . . . . . . . . . . . . . . . . . . . . . . . 71
7.2.3 Testes de Validação . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 76
7.2.4 Comentários . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 85

8 Conclusões 87

Referências Bibliográficas 89



Lista de Figuras

2.1 Gráficos da funcão u(x) e de sua derivada fraca v(x). . . . . . . . . . . . . . . . . 15

3.1 Elemento de meio poroso ( à esquerda) e Fluxo de fluido através do elemento de
meio poroso (à direita). . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 18

4.1 Funções de base local lineares para problemas unidimensionais. . . . . . . . . . . 28

4.2 Funções de base local quadráticas para problemas unidimensionais. . . . . . . . . 29

4.3 Elemento retangular K = ['1, 1]( ['1, 1] e seus vértices indicados por a11, a12,
a21 e a22. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 32

4.4 Funções de base local bilineraes para problemas bidimensionais. . . . . . . . . . . 32

5.1 Gráficos da Solução exata exp(x) + 1 do problema 1D. . . . . . . . . . . . . . . . 43

5.2 Gráficos da solução aproximada uh(x) usando funções de base lineares, p = 1, e
com h = 9/2 e h = 9/4 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 44

5.3 Gráficos da solução aproximada uh(x) usando funções de base lineares, p = 1, e
com h = 9/8 e h = 9/16. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 44

5.4 Gráficos da solução aproximada uh(x) usando funções de base lineares, p = 1, e
com h = 9/32 e h = 9/64. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 44

5.5 Gráfico da Taxa de convergência nas normas L2(!), semi'H 1(!) e energia E(!),
com p = 1()), p = 2 (!) e p = 3 ("). . . . . . . . . . . . . . . . . . . . . . . . . 46

5.6 Solução exata do problema 2D, u = 5x2y2(1'x)2(e10x
2
'1)(1'y)2(e10y

2
'1). . . 48

5.7 Solução aproximada do problema 2D, usando refinamento uniforme com p = 5 e
h = 1/32. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 50

6.1 Solução exata do problema primal e dual. . . . . . . . . . . . . . . . . . . . . . . 60

6.2 Solução aproximada do problema Primal e Dual, com p = 1, para h = 1/2, h = 1/4,
h = 1/8, h = 1/16, respectivamente. . . . . . . . . . . . . . . . . . . . . . . . . . 61

xix



xx LISTA DE FIGURAS

6.3 Solução aproximada do problema Primal e Dual, com p = 2, para h = 1/2, h = 1/4,
h = 1/8, h = 1/16, respectivamente. . . . . . . . . . . . . . . . . . . . . . . . . . 62

6.4 Convergência do erro no funcional linear limitado L(u), usando funções de La-
grange de grau p = 1 (1) e p = 2 (2). . . . . . . . . . . . . . . . . . . . . . . . . . 64

6.5 Solução aproximada do problema dual considerando Nx = Ny = 4 (à esquerda) e
Nx = Ny = 8 (à direita) . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 65

6.6 Solução aproximada do problema dual considerando Nx = Ny = 16 (à esquerda) e
Nx = Ny = 32 (à direita). . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 65

7.1 Representação do domínio computacional !. . . . . . . . . . . . . . . . . . . . . 70

7.2 Gráfico da derivada parcial
$ u
$!n

(x, 0) , x = ['1, 1]. . . . . . . . . . . . . . . . . . . 72
7.3 Exemplo de uma função g(s) para o problema auxiliar. . . . . . . . . . . . . . . . 74
7.4 Gráficos da função " considerando $ !s = [1/4, 1/2]({0}. . . . . . . . . . . . . 75
7.5 Gráficos Log-Log do erro, na aproximação do valor do fluxo saindo pela região

$ !s1 = [0, 1/4]({0} com p = 1, 2, 3 e 4. . . . . . . . . . . . . . . . . . . . . . . 80
7.6 Gráficos Log-Log do erro, na aproximação do valor do fluxo saindo pela região

$ !s2 = [1/2, 3/4]({0} com p = 1, 2, 3 e 4. . . . . . . . . . . . . . . . . . . . . 81
7.7 Gráficos das funções g1(s) = g(s)

""
$ !s1 e g2(s) = g(s)

""
$ !s2 , com % = 0, 1. . . . . . 82



Lista de Tabelas

5.1 Taxa de convergência do erro medido nas normas L2(!) e semi'H 1(!). . . . . . 45
5.2 Taxa de convergência do erro medido nas normas H 1(!) e E(!). . . . . . . . . . 46
5.3 Valor do erro medido na norma em L2(!), considerando p = 1, p = 2, p = 3, p = 4

e p = 5. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 49
5.4 Taxas de convergências, do erro, medidas na norma em L2(!), considerando p = 1,

p = 2 , p = 3, p = 4 e p = 5. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 49
5.5 Valor do erro medido na norma em H 1!), considerando p = 1, p = 2, p = 3, p = 4

e p = 5. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 49
5.6 Taxas de convergências medidas na norma em H 1!), considerando p = 1, p = 2,

p = 3, p = 4 e p = 5. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 50

6.1 Valor do erro, medido na norma da energia e taxa de convergência para o problema
primal. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 62

6.2 Valor do erro, medido na norma da energia e taxa de convergência para o problema
dual. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 63

6.3 Valor do erro e taxa de convergência no funcional linear limitado L(u), com p = 1
e p = 2. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 63

7.1 Erros na regra de integração no cálculo do fluxo na região $ !s1 = [0, 1/4] ({0}
usando u e " analíticas. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 77

7.2 Erros na regra de integração no cálculo do fluxo no região $ !s2 = [1/2, 3/4]({0},
usando u e " analíticas. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 77

7.3 Valores aproximados do fluxo na região $ !s1 = [0, 1/4]({0}, pelo método direto,
modelo 2 e modelo 3. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 78

7.4 Valores aproximados do fluxo na região $ !s2 = [1/2, 3/4]({0}, pelo método di-
reto, modelo 2 e modelo 3. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 79

7.5 Valores aproximados do fluxo total saindo pela região $ !s1 = [0, 1/4]({0}. . . . 83

xxi



xxii LISTA DE TABELAS

7.6 Valores aproximados do fluxo total saindo pela região $ !s2 = [1/2, 3/4]({0}. . . 84



Capítulo 1

Introdução

Em muitas situações na modelagem de problemas aplicados, o que se deseja de uma solução da
Equação Diferencial Parcial (EDP), que descreve o modelo, não é a própria solução e sim alguma
quantidade de interesse. De forma geral, estas quantidades de interesse são caracterizadas por
funcionais lineares limitados no espaço de funções que contém as soluções, tal como: a derivada
da solução, o fluxo através de uma região da fronteira, o valor médio da solução sobre uma região do
domínio, o valor da solução em um ponto, etc. Em tais circunstâncias, nem sempre o refinamento
uniforme ou uma estratégia de hp-refinamento, que diz respeito à qualidade global da solução, são
as estratégias mais apropriadas para melhorar a aproximação da quantidade, pois podem tornar
o custo computacional muito alto. Neste sentido, estratégias direcionadas para o aprimoramento
da aproximação de quantidades de interesse são temas que têm recebido grande impotância nas
últimas décadas, como mostram as referências [2] e [3].

Um dos objetivos deste trabalho é o estudo de métodos para o pós-processamento da solução por
elementos finitos com objetivo de se obter uma precisão desejável na aproximação das quantidades
de interesse. Em particular, estudam-se dois métodos: a estratégia de adaptatividade goal-oriented
e o método da função de extração, [2] e [3], respectivamente. Também, apresenta-se um procedi-
mento designado para controlar o erro em uma quantidade de interesse específico, no espírito de
adaptatividade goal-oriented.

Especificamente, o modelo matemático a ser tratado é o escoamento monofásico de fluidos em
meios porosos, tendo como objetivo aplicações na simulação de reservatórios de petróleo onde
a quantidade de interesse representa a vazão de fluido em certas regiões do contorno no domínio
estipulado. As equações diferenciais do modelo são obtidas pela lei de conservação de massa junta-
mente com relação da Lei de Darcy para a velocidade do fluido. Maiores detalhes são encontrados
em [14, 15, 9, 12, 22].

1



2 CAPÍTULO 1. INTRODUÇÃO

Os próximos capítulos deste trabalho estão organizados da seguinte forma. O Capítulo 2 traz
noções e tópicos de Análise Funcional necessários ao desenvolvimento do trabalho.

No Capítulo 3 apresenta-se um breve comentário e descrição das equações do fluxo monofásico
em meios porosos, como ocorre em modelagem de reservatórios de petróleo, tendo como referên-
cias [15, 14, 22, 12].

O Capítulo 4 é dedicado ao estudo do Método de Elementos Finitos (MEF), [25, 10, 23]. Sua
sistemática, a partir de uma formulação variacional, é semelhante para muitos tipos de problemas.
Isso permite sua aplicação em inúmeras áreas: mecânica dos fluidos, mecânica dos sólidos, eletro-
magnetismo, termodinâmica, etc.

A parte computacional deste trabalho foi desenvolvido no Laboratório de Mecânica Compu-
tacional (LabMec) da Faculdade de Engenharia Civil, Arquitetura e Urbanismo da Unicamp. O
LabMec desenvolve um ambiente de programação orientado a objeto, conhecido como PZ. O am-
biente PZ é um conjunto de classes em liguagem C++, com objetivo de permitir a simulação de
métodos de elementos finitos. O Capítulo 5 contém uma breve descrição dos principais apectos do
ambiente PZ e, como exemplo ilustrativo, apresentam-se as resoluções de problemas de valores de
contorno unidimensional e bidimensional.

O Capítulo 6 é dedicado ao estudo de propostas do tipo goal-oriented para a estimativa do
erro de aproximações por elementos finitos de uma quantidade de interesse, no qual descrevem-se
argumentos propostos na literatura [2, 21, 16].

No Capítulo 7, apresenta-se um método para o pós-processamento da solução, pelo método dos
elementos finitos, com objetivo de obter uma alta precisão da aproximação de certas quantidades de
interesse, de acordo com Babuska [3, 4, 5]. Um exemplo em duas dimensões ilustra a aplicabilidade
do método, em que a quantidade de interesse considerada representa o fluxo sobre uma sub-região
do contorno em certo domínio estipulado.

O Capítulo 8 traz as conclusões e considerações finais da dissertação.
Nos Apêndices Ae B são incluidos os conceitos básicos de Espaços Normados, as notações

utilizadas no texto.



Capítulo 2

Aspectos Teóricos da Análise Funcional

Neste capítulo, resumem-se alguns conceitos de Análise Funcional que são úteis na teoria de mé-
todos dos elementos finitos. Como referência, utilizam-se [18, 20, 17]. Mostra-se, também, alguns
aspectos teóricos dos problemas elípticos, [13, 10], sendo de grande importância no entendimento
dos próximos capítulos.

2.1 Noções Preliminares

O Apêndice A contém os conceitos de espaços vetoriais normados que contribuem no entendimento
dessa seção.

2.1.1 Transformações Lineares

Definição 2.1 Sejam X e Y espaços vetorias sobre o mesmo corpo. Uma Transformação Linear é
uma aplicação T : D(T ) # R(T ), tal que:

i) O domíno D(T ) de T e a imagem R(T ) são espaços vetoriais, ambos no mesmo corpo K,
isto é:

T : D(T ) * X # R(T ) * Y

ii) Para todo u, v + D(T ), e ! + K, tem-se

T (u + v) = T (u) + T (v) e T (! u) = ! T (u)

No caso em que o domínio e contradomínio coincidem, é usada a expressão Operador Linear.

3



4 CAPÍTULO 2. ASPECTOS TEÓRICOS DA ANÁLISE FUNCIONAL

Definição 2.2 (Núcleo) O núcleo de uma transformação linear T : D(T ) * X # R(T ) * Y , de-
notado por N(T ), é o conjunto

N(T ) = {u + D(T ) : T (u) = 0}.

O conjunto N(T ) é um subespaço vetorial de D(T ) * X .

Definição 2.3 Seja T : X # Y uma transformação linear, em que X e Y são espaços vetoriais
normados. T é limitada se existe um escalar c &gt; 0, tal que

$ T (u) $! c $ u $, ,u + X

Pela definição acima, tem-se
$ T (u) $
$ u $

! c, u -= 0

Define-se a norma de uma transformação limitada $ T $ como o ínfimo das constantes c que satis-
fazem a condição acima

$ T $= sup
u+X ,u-=0

$ T (u) $
$ u $

= sup
u+X ,$u$=1

$ T (u) $

Disto decorre que, para todo u + X , $ T (u) $!$ T $$ u $.

Definição 2.4 (Continuidade) Uma transformação linear T é contínua em u0 + D(T ) se para
todo % &gt; 0 dado, exite &amp;amp; = (%, u0) &gt; 0 tal que

$ u'u0 $&amp;lt;&amp;amp; .$ T (u)'T (u0) $&amp;lt;%

Diz-se que T é contínua, se for contínua para todo u + D(T ).

Teorema 2.1 Sejam X e Y espaços vetoriais normados e T : X # Y uma transformação linear.
Então:

(a) T é limitada se, e somente se, T é contínua;

(b) Se T é contínua em u0, então, T é contínua em qualquer ponto u + X .



2.1. NOÇÕES PRELIMINARES 5

2.1.2 Funcional Linear (ou Forma Linear)

Definição 2.5 Uma transformação linear, f : X # K, em que X é um espaço vetorial sobre um
corpo K, é chamada de funcional linear.

Exemplo 2.1 A integral definida, f : C ([a, b]) # R, tal que

f (u) =
# b

a
u(t)dt, u + C ([a, b])

é um funcional linear limitado definido no espaço (C ([a, b]) ,$ · $$), e $ f $$= b'a.

2.1.3 Espaços Duais

Definição 2.6 Seja (X ,$ ·$ ) um espaço vetorial normado. O conjunto de todos funcionais lineares
limitados sobre X é chamado de espaço dual de X , denotado por X/, o qual constitui um espaço
normado, com a norma definida por

$ f $= sup
u+X ,u-=0

| f (u) |
$ u $

= sup
u+X ,$u$=1

| f (u) |

e com as operações

( f + g)(u) = f (u) + g(u) e (! f )(u) = ! f (u) .

Resulta que X/, é um espaço de Banach (sendo X de Banach ou não).

2.1.4 Espaços de Hilbert

Definição 2.7 (Espaço Vetorial com Produto Interno) Um espaço vetorial está munido com um
produto interno %·,· &amp;amp; : X (X # K se tal aplicação verifica as seguintes propriedades: para todos
vetores u, v e w + X e ,! + K, tem-se

(P1) %u, v&amp;amp; = %u, v&amp;amp;, se K = R . %u, v&amp;amp; = %v, u&amp;amp;

(P2) %u, u&amp;amp; 0 0, %u, u&amp;amp; = 0 1 u = 0

(P3) %u + v, w&amp;amp; = %u, w&amp;amp;+%v, w&amp;amp;

(P4) %! u, v&amp;amp; = !%u, v&amp;amp;



6 CAPÍTULO 2. ASPECTOS TEÓRICOS DA ANÁLISE FUNCIONAL

sendo z o complexo conjugado de z.

Dado um produto interno, a partir dele é possível introduzir uma norma

$ u $=
$
%u, u&amp;amp;. (2.1)

Esta norma satisfaz a Regra do Paralelogramo

$ u + v $2 + $ u'v $2= 2
%
$ u $2 + $ v $2

&amp;amp;
(2.2)

e a Desigualdade de Cauchy-Schwartz

| %u, v&amp;amp; |2! %u, u&amp;amp;%v, v&amp;amp;.

Definição 2.8 (Espaço de Hilbert) Um espaço de Hilbert é um espaço com produto interno com-
pleto em que a norma provém do produto interno. Portanto, um espaço de Hilbert é um espaço de
Banach.

Alguns Exemplos

Exemplo 2.2 (Espaço Euclidiano) O espaço Rn é um espaço de Hilbert com o produto interno
definido por

%u, v&amp;amp; = u1v1 + u2v2 + ... + unvn

em que, u = (u1, u2, ..., un) e v = (v1, v2, ..., vn). Daí, tem-se

$ u $= %u, u&amp;amp;1/2 =
'
u21 + u

2
2 + ... + u

2
n
(1/2

.

Exemplo 2.3 No espaço (C ([a, b]) ,$ · $2), a norma é proveniente do produto interno

%u , v&amp;amp; =
# b

a
u(t)v(t) dt . (2.3)

Este espaço não é completo, logo não é um espaço de Hilbert.

Exemplo 2.4 O espaço L2([a, b]), definido como o completamento do espaço (C ([a, b]) ,$ · $2), é
um espaço de Hilbert, em que a norma é proveniente do produto interno (2.3).



2.2. FORMAS BILINEARES 7

Projeção Ortogonal

Definição 2.9 (Vetores ortogonais) Seja X um espaço vetorial munido com produto interno. Diz-
se que u, v + X são ortogonais, u 2 v, se %u, v&amp;amp; = 0.

Teorema 2.2 (Pitágoras) Seja X um espaço vetorial munido com produto interno. Se u e v + X
são ortogonais, então

$ u + v $2=$ u $2 + $ v $2 .

Teorema 2.3 (Projeção Ortogonal) Sejam X um espaço de Hilbert, F * X um subespaço fechado
e u + {X 'F}. Então, existe um único elemento v + F tal que

u'v 2 ' , ,z + F.

Propriedades 1 Nas condições do teorema da projeção acima, são equivalentes:
i) u'v 2 ' , ,' + F ;
ii) $ u'v $= min

'+F
$ u'' $.

Teorema 2.4 (de Representação de Riesz) Seja X um espaço de Hilbert. Se f : X '# R é um
funcional linear limitado, f + X/, então existe um único elemento u + X de modo que o funcional
f é representado por:

f (v) = %v , u&amp;amp;, ,v + X

e
$ f $X/=$ u $X .

A solução u + X é conhecidada como representador de Riesz do funcional linear limitado f + X/.

2.2 Formas Bilineares

Os resultados descritos abaixo são uma prévia para o Teorema de Lax-Milgran, que será visto mais
adiante.

Definição 2.10 (Forma Sesquilinear) Sejam X e Y espaços vetoriais sobre o corpo K (R ou C),
a forma sesquilinear (ou funcional sesquilinear) B em X (Y é uma função

B : X (Y # K



8 CAPÍTULO 2. ASPECTOS TEÓRICOS DA ANÁLISE FUNCIONAL

tal que para todo u, u1, u2 + X e v, v1, v2 + Y e todo escalar !, ( + K, tem-se

(a) B(u1 + u2 , v) = B(u1 , v) + B(u2, v)

(b) B(u , v1 + v2) = B(u , v1) + B(u , v2)

(c) B(! u , v) = ! B(u , v)

(d) B(u , ( v) = ( B(u , v)

No caso em que K = R, B(·,·) é chamado de forma bilinear.

Definição 2.11 Para espaços normados X , diz-se que uma forma sesquilinear B(·,·) em X ( X é
limitada (contínua) se existe uma constante &amp;amp; &gt; 0 tal que

| B(u , v) |! &amp;amp; $ u $X$ v $X , ,u, v + X . (2.4)

e define-se a norma de B por

$ B $= sup
u,v+X'{0}

| B(u , v) |
$ u $x$ v $x

= sup
$u$X =$v$X =1

| B(u , v) | (2.5)

Definição 2.12 Uma forma bilinear B(·,·) : X (X # R é considerada simétrica se

B(u, v) = B(v, u)

para todo u, v + X .

Definição 2.13 Uma forma bilinear B(·,·) : X (X # R é considerada positiva definida se

B(u, u) &gt; 0

para todo u + X , u -= 0.

Definição 2.14 (Coercividade) Uma forma bilinear B(·,·) em X ( X é uma forma bilinear coer-
civa se existe uma constante ( &gt; 0 tal que

B(u, u) 0 ( $ u $2X , ,u + X . (2.6)



2.2. FORMAS BILINEARES 9

A constante ( é denominada constante de coercividade da forma bilinear. Note que a condição de
coercividade implica na positividade da forma bilinear.

Uma forma bilinear simétrica e coerciva define um produto interno %·,·&amp;amp;B : X (X # K, tal que

%u , v&amp;amp;B = B(u , v), ,u, v + X

e a norma proveniente desse produto interno

$ u $B= [%u , u&amp;amp;B]1/2

é denominada norma energia.

2.2.1 Exemplos

Seja o espaço vetorial real X = V ([a, b]),

V ([a, b]) = { f : [a, b] # R/ f contínua, f / contínua por partes e limitada},

com o produto interno definido por

% f , g&amp;amp;X =
# b

a
f (t)g(t) dt +

# b

a
f /(t)g/(t) dt, , f , g + X . (2.7)

Considerando o espaço X , definem-se as formas bilinear e linear sobre X . A forma bilinear B(·,·)
é definida por

B(u , v) =
# b

a
b(t)u(t)v(t) dt +

# b

a
k(t)u/(t)v/(t) dt , ,u, v + X ,

em que b e k são funções contínuas e estritamente positivas no intervalo [a, b]. A forma linear F(·)
é definida por

F(v) =
# b

a
u(t)v(t) dt, ,v + X (2.8)

em que u + C([a, b]).

Esta forma bilinear B(·,·) é simétrica, limitada e coerciva considerando a norma $ · $X prove-
niente do produto interno %·,·&amp;amp;X definido por (2.7). Analogamente, a forma linear F(·) é limitada
com relação a norma $ · $X proveniente do produto interno %·,·&amp;amp;X definido por (2.8).



10 CAPÍTULO 2. ASPECTOS TEÓRICOS DA ANÁLISE FUNCIONAL

2.3 Problema Variacional e Método de Galerkin

2.3.1 O Problena Variacional

Definição 2.15 Seja X um espaço vetorial sobre R munido do produto interno %·,·&amp;amp;X e da norma
$ · $X proveniente desse produto interno. Considere uma forma bilinear B(·,·), sobre X , simétrica,
contínua e coerciva e F + X/ um funcional linear limitado. O problema definido por:

)
Encontrar u + X solução da equação
B(u, v) = F(v) para todo v + X

(2.9)

é denotado Problema Variacional Simétrico.

O próximo teorema (Lax-Milgram) apresenta os resultados de existência e unicidade, bem como
uma estimativa de estabilidade, para a solução do Problema Variacional (2.9).

Teorema 2.5 (Lax-Milgram) Sejam B(·,·) uma forma bilinear contínua, simétrica e coerciva so-
bre o espaço de Hilbert X e F + X/. Então, existe um único elemento u + X solução da equação

B(u , v) = F(v) para todo v + X ,

e ainda, tem-se
$ u $X!

)
(

,

em que, ) é a constante de continuidade da forma linear F e ( a constante de coercividade da
forma bilinear B.

2.3.2 O Método de Galerkin

Considerando que já se tem o problema variacional (2.9), pode-se agora pensar no Método de
Galerkin, que é a base para o Método dos Elementos Finitos, que consiste em encontrar soluções
aproximadas para (2.9).

Considere um subespaço de dimensão finita VN do espaço vetorial X e seja B = {"1, "2, ..., "n}
uma base para VN . Desse modo, toda função v + VN é escrita como uma combinação linear das
funções de base, ou seja,

v(x) =
n

%
j=1

! j" j(x).

Assim, uma discretização para o problema variacional (2.9), usualmente denominada de Método



2.3. PROBLEMA VARIACIONAL E MÉTODO DE GALERKIN 11

de Galerkin, consiste em:
)

Encontrar uN + VN solução da equação
B(uN , v) = F(v) para todo v + VN .

(2.10)

Como a função uN + VN , tem-se

uN (x) =
n

%
i=1

!i"i(x) ,

e pelo fato de (2.10) ser válido para toda função em VN , em particular será válida para as funções
de base. Com isso, o problema (2.10) passa ser escrito como

*
+

,

Encontrar ! = (!i ) + Rn, tal que
n
%

i=1
!iB("i, " j) = F(" j) para todos j = 1, ..., n

(2.11)

O problema (2.11) é um sistema linear com n equações e n incógnitas !1, !2, ..., !n, que são as
coordenadas de uN com relação à base do subespaço VN . O sistema linear (2.11) pode ser escrito
na forma matricial

K ! = b

em que os elementos da matriz K = [ki j] são dados por

ki j = B("i , " j) para todos i, j = 1, ..., n ,

e os elementos do vetor b = [b j] são dados por

b j = F(" j) para todos j = 1, ..., n .

De maneira análoga ao problema variacional simétrico (2.9), a existência e unicidade da solu-
ção do problema variacional discreto (2.10) são garantidas pelo Teorema de Lax-Milgram.

Interpretação Geométrica da Solução de Galerkin

Vamos apresentar uma interpretação geométrica para a solução de Galerkin do Problema Variaci-
onal (2.9) com relação ao produto interno energia %·,·&amp;amp;B associado à forma bilinear B(·,·) sobre
X .



12 CAPÍTULO 2. ASPECTOS TEÓRICOS DA ANÁLISE FUNCIONAL

Se u + X é a solução do Problema Variacional (2.9), então

B(u, v) = F(v), ,v + X .

Como VN * X a igualdade acima continua valendo se escolhermos v + VN , ou seja

B(u, v) = F(v), ,v + VN . (2.12)

Da mesma forma, se uN + VN for a solução do problema variacional discreto (2.10), tem-se

B(uN , v) = F(v), ,v + VN . (2.13)

Assim, subtraindo (2.13) de (2.12) e utilizando a definição do produto interno %·,·&amp;amp;B = B(·,·), tem-
se

B(u'uN , v) = %(u'uN ) , v&amp;amp;B = 0, ,v + VN .

Portanto, pode-se dizer que o erro u ' uN da solução de Galerkin é ortogonal ao subespaço de
aproximação VN com relação ao produto interno energia. Esta propriedade é conhecida como orto-
gonalidade de Galerkin. Ou seja, a solução de Galerkin uN é a projeção ortogonal de u no espaço
de aproximação VN com relação ao produto interno energia. Em outras palavras, diz que a solução
de Galerkin uN + VN * X é a melhor aproximação de u + X com relação à norma energia, isto é

$ u'uN $B !$ u'v $B para todo v + VN . (2.14)

2.4 Os Espaços de Sobolev H m(!) e H m0 (!)

Nesta seção, apresentam-se os conceitos principais dos espaços de Sobolev H m(!) e H m0 (!), os
quais são de grande importância na construção de espaços de aproximação no método dos elemen-
tos finitos. Como referências, utilizam-se [18, 11].

Definição 2.16 Dados ! * Rn, um aberto limitado, e um inteiro m 0 0, denota-se por Cm(!) o
espaço vetorial das funções reais definidas em !, tal que D! u, ! = (!1, !2, ..., !n), é contínua
para 0 !| ! |! m. Por Cm0 (!) denota-se o subespaço de C

m(!) formado pelas funções u que se
anulam fora de um compacto contido em !, o qual pode variar de acordo com u.

Desde já,
C$(!) =

$
3
m

Cm(!), C$0 =
$
3
m

Cm0 (!).



2.4. OS ESPAÇOS DE SOBOLEV H M(!) E H M0 (!) 13

Em Cm0 (!) define-se o produto interno

%u , v&amp;amp;m = %
|!|!m

%D! u , D! v&amp;amp;, (2.15)

em que,
%u, v&amp;amp; =

#

!
(u v) dx

é o produto interno em L2(!). A partir desse produto interno, definem-se a semi-norma e norma
em Cm0 (!) e C

m(!), respectivamente,

Semi-Norma: | u |2m,2=
#

!

-
%

|!|=m
| D! u(x) |2

.
dx

(2.16)

Norma: $ u $2m,2=
#

!

/

%
0!|!|!m

| D! u(x) |2
0

dx . (2.17)

Para m = 0 tem-se

| u |20,2=$ u $
2
0,2=$ u $

2
L2(!) .

Definição 2.17 O espaço vetorial Cm4 (!) é definido por

Cm4 (!) = {u + C
m(!) :$ u $m,2&amp;lt;$ }.

Ambos Cm0 (!) e C
m
4 (!), munidos da norma $ . $m,2, não são espaços completos. Os completa-

mentos destes espaços são denotados, respectivamente, por H m0 (!) e H
m(!), os quais são espaços

de Hilbert. Para m = 0, fica claro que

H 0(!) = H 00 (!) = L
2(!). (2.18)

Por definição de completamento, dado u + H m(!) existe uma sequência {un} em Cm4 (!) tal
que $ un 'u $m,2'# 0. Tem-se também que para todo multi-índice ! com | ! |! m

$ D! un 'D! uN $0,2 ! $ un 'uN $m,2,

e assim pode-se concluir que {D! un} é sequência de Cauchy em L2(!). Sendo L2(!) completo,
existe v! + L2(!) tal que $ D! un ' v! $0,2'# 0. Então, tem-se a seguinte caracterização para o
espaço H m(!), [18].



14 CAPÍTULO 2. ASPECTOS TEÓRICOS DA ANÁLISE FUNCIONAL

Definição 2.18 O espaço H m(!) é caracterizado como o conjunto das funções u + L2(!) tal que
existe uma sequência {un} em Cm4 (!) e v! em L2(!) com

lim
n#$

$ un 'u $0,2= 0, lim
n#$

$ D! un 'v! $0,2= 0 . (2.19)

No caso em que u + Cm4 (!), se $ un ' u $m,2'# 0, então os limites em (2.19) são válidos com
v! = D! u. Deste modo, as funções v! em (2.19) são vistas como uma generalização do conceito
de derivada das funções de H m(!), generalização esta que dará origem à seguinte definição.

Definição 2.19 Dada uma função u + L2(!), diz-se que as funções v! + L2(!), | ! |! m, são suas
derivadas no sentido forte se existir uma sequência {un} em Cm4 (!) tal que

lim
n#$

#

!
| un 'u |2 dx = lim

n#$

#

!
| D! un 'v! |2 dx = 0, | ! |! m (2.20)

Diz-se também que a função u tem todas as derivadas (no sentido forte) de ordem menor ou igual
a m.

A unicidade dessas derivadas está provada em [18]. Uma outra noção de derivada em H m(!)
é a chamada derivada no sentido fraco.

Definição 2.20 Diz-se que uma função v! + L2(!) é a derivada de ordem ! de u + H m(!) no
sentido fraco, se:

#

!
(# v! ) dx = ('1)!

#

!
(uD! # )dx, | ! |! m (2.21)

para toda # + Cm0 (!).

Assim, se v! é a derivada de ordem ! de u + H m(!) no sentido forte, ela também é sua derivada
no sentido fraco. A recíproca também é verdadeira, [18]. Desta forma, simplificadamente, o espaço
H m(!) é definido como o espaço das funções u : ! '# R em que u + L2(!) e u admite derivada
fraca D! u + L2(!), para todo | ! |! m, isto é

H m(!) = {u + L2(!) : D! u + L2(!), , | ! |! m}. (2.22)

Exemplo 2.5 Seja u + L2(!), em que ! = (0, 1) * R, definida por

u(x) =

)
x se 0 &amp;lt;x ! 1/2
1'x se 1/2 &amp;lt;x &amp;lt;1

.



2.4. OS ESPAÇOS DE SOBOLEV H M(!) E H M0 (!) 15

0.0 0.2 0.4 0.6 0.8 1.0
0.0

0.1

0.2

0.3

0.4

0.5

u!x"

0.0 0.2 0.4 0.6 0.8 1.0
!1.0

!0.5

0.0

0.5

1.0

v!x"

Figura 2.1: Gráficos da funcão u(x) e de sua derivada fraca v(x).

Esta função não admite derivada ordinária u/ pois não é derivável em x = 1/2. Contudo, admite

derivada fraca v =
du
dx

definida por

v(x) =

)
+1 se 0 &amp;lt;x &amp;lt;1/2
'1 se 1/2 &amp;lt;x &amp;lt;1

,

Figura 2.1.

Teorema 2.6 (Desigualdade de Friedrichs) Seja ! * Rn um subconjunto limitado, com diâmetro
igual a d. Então, para todo u + H m0 (!), tem-se:

$ u $L2(!)! d
m

/

%
|!|=k

$ D! u $2L2(!)

01/2
.



Capítulo 3

Problema Físico

3.1 Equações Diferenciais de Interesse

O objetivo desta seção é apresentar um breve comentário sobre as equações do fluxo horizontal em
meios porosos, como ocorre em modelagem de reservatórios de petróleo, tendo como referências
[15, 14, 22, 12]. Um meio poroso é um material construído por uma fase sólida (rocha) e um espaço
vazio (poros) e é representado por um domínio ! * R3. Nesta dissertação somente é tratado o caso
do fluxo monofásico. Equações para o fluxo nos casos bifásico e trifásico são apresentadas em [22].

Na simulação de um reservatório, representa-se o comportamento real do mesmo através de um
modelo matemático formado por um conjunto de equações diferenciais parciais, juntamente com as
condições iniciais e de contorno, que descrevem adequadamente os processos físicos significativos
do sistema. Os processos que ocorrem em um reservatório de petróleo são basicamente escoamento
de fluido e transferência de massa. Isso ocorre em até três fases imiscíveis (água, óleo e gás),
fluindo simultaneamente. Na próxima subseção descreve-se a equação de conservação da massa
em fluxo monofásico, a qual é associada a duas equações básicas: a lei de Darcy, que é uma
equação de transporte de massa, e uma equação de estado, que tanto pode ser uma lei dos gases
como a equação da compressibilidade para o caso de líquidos.

Para o desenvolvimento das equações será utilizado um elemento de meio poroso através do
qual está ocorrendo o fluxo monofásico de um fluido. O elemento em questão, tal como mostrado
na Figura 3.1, tem a forma de um cubo com dimensões 5x, 5y e 5z, e o fluxo através do mesmo
será estudado durante um intervalo de tempo 5t.

17



18 CAPÍTULO 3. PROBLEMA FÍSICO

? x
?

?

y

z
A A*

qx

x x + ? x

qx

Figura 3.1: Elemento de meio poroso ( à esquerda) e Fluxo de fluido através do elemento de meio
poroso (à direita).

3.1.1 Lei de Conservação da Massa

Uma lei de conservação de uma certa quantidade é equacionada a partir do princípio

[massa que entra]'[massa que sai] = [massa acumulada] . (3.1)

A forma diferencial da lei de conservação é obtida avaliando este princípio em um cubo sufici-
entemente pequeno, permitindo assumir que a concentração dentro do volume é essencialmente
uniforme, e tomando o limite do resultado quando as dimensões do volume tendem para zero.

O caso mais geral é aquele em que ocorre a movimentação do fluido nas três direções, x, y e
z. A Figura 3.1 ilustra a movimentação do fluido na direção x (figura à direita). O fluido que se
desloca nessa direção, ao entrar no meio poroso o faz através da face A, normal à direção x, e ao
sair, o faz através da face oposta A4. O mesmo raciocínio pode ser utilizado para os fluxos nas
direções y e z.

O quociente entre a vazão q(x, y, z,t) [m3/s] e a área através da qual o fluxo está ocorrendo é
chamada de velocidade apararente do fluido. Assim, o quociente entre a vazão qx e a área 5y5z é
a velocidade aparente do fluido na direção x, que normalmente é representada por *x:

*x =
qx

5y5z
.

Da mesma forma as velocidades aparentes nas direções y e z são dadas, respectivamente, por:

*y =
qy

5x5z
e *z =

qz
5x5y

.

Em seguida considera-se a lei de conservação de massa para um fluxo monofásico em três
dimensões, primeiramente para o caso do fluxo compressível e depois do fluxo incompressível.



3.1. EQUAÇÕES DIFERENCIAIS DE INTERESSE 19

Fluido Compressível e Monofásico

No caso do fluido compressível considera-se que a densidade +(x, y, z, t) [kg/m3] e a velocidade
do fluido !* = (*x, *y, *z, t) [m/s] variam com a posição espacial e com o tempo.

Na direção x, a massa total que penetra no meio poroso através da face A e a massa que sai
através da face A4 são, respectivamente:

massa que entra = 5y5z(+ *x)(x, y , z ,t) (3.2)

e
massa que sai = 5y5z(+ *x)(x +5x, y, z, t). (3.3)

Analogamente, tem-se para o fluxo na direção y e z. Assim, a massa acumulada no corpo durante o
intervalo de tempo é

5x5y5z [(# +)(x, y, z, t +5t)'(# +)(x, y, z, t]
5t

, (3.4)

em que # representa a porosidade do meio dada pela razão entre o volume dos poros e o volume
total. Dessa forma, substituindo as equações (3.2) a (3.4) na fórmula (3.1) e dividindo por 5x 5
y5z, tem-se

(+ *x)(x, y, z, t)'(+ *x)(x +5x, y, z, t)
5x

+
(+ *y)(x, y, z, t)'(+ *y)(x, y +5y, z, t)

5y
+

(+ *z)(x, y, z, t)'(+ *z)(x, y, z +5z, t)
5z

=
(# +)(x, y, z, t +5t)'(# +)(x, y, z, t)

5t
,

tomando o limite, com 5x # 0, 5y # 0, 5z # 0 e 5t # 0, tem-se que a equação da conservação
da massa do fluxo compressível é dada por:

'
$ (+ *x)

$ x
'

$ (+ *y)
$ y

'
$ (+ *z)

$ z
=

$ (# +)
$ t

. (3.5)

Usando a notação do divergente na equação (3.5) tem-se

$ (# +)
$ t

+ div(+!*) = 0. (3.6)



20 CAPÍTULO 3. PROBLEMA FÍSICO

Lei de Darcy

A Lei de Darcy para um fluxo monofásico relaciona a velocidade aparente do fluido com os gradi-
entes de pressão. Em três dimensões tem-se

*x = '
kx
µ

$ p
$ x

, *y = '
ky
µ

$ p
$ y

e *z = '
kz
µ

$ p
$ z

,

,
(3.7)

com kx, ky e kz &gt; 0. Portanto, o sistema de equações (3.7) pode ser escrito como:

!* = '
1
µ
"#
K # p , (3.8)

sendo
"#
K o tensor das permeabilidades, cuja representação matricial é dada por:

"#
K =

1

2
3

kx 0 0
0 ky 0
0 0 kz

4

5
6 .

O sinal negativo na equação (3.8) indica que a pressão é decrescente na direção do fluxo, ou seja, o
escoamento ocorre de um ponto de maior pressão para outro de menor pressão. Para incluir a força
da gravidade nas equações (3.7) toma-se a função profundidade Z(x, y, z), aqui tomada na direção-z.
Desda maneira, a lei de Darcy é dada por, [12, 22]:

!* = '
1
µ
"#
K (# p'+ g#Z) , (3.9)

sendo g[m/s2] a aceleração da gravidade. Portanto, substuindo a lei de Darcy (3.9) na equação
(3.6), tem-se a forma geral para a conservação de massa em fluidos compressíveis e monofásicos
em três dimensões

'div
-

+
µ
"#
K (# p'+ g#Z)

.
+

$ (# +)
$ t

= 0. (3.10)

Equação de Estado

Além das considerações relacionadas com fluxos em meios porosos feitas anteriormente, é neces-
sário especificar uma equação de estado para o fluido, isto é, a relação entre a densidade e a pressão,
+ = +(p). Para o caso de fluxo de líquidos, pode-se usar a equação geral da compressibilidade dos



3.1. EQUAÇÕES DIFERENCIAIS DE INTERESSE 21

fluidos, escrita na forma:

c =
1
+

$ +
$ p

, (3.11)

em que c[Pa'1] é a compressibilidade do líquido. A equação (3.11) pode ser desdobrada em função
de x, y, z e t para ser incorporada na equação (3.10), obtendo as igualdades:

+
$ p
$ x

=
1
c

$ +
$ x

, +
$ p
$ y

=
1
c

$ +
$ y

e +
$ p
$ z

=
1
c

$ +
$ z

.

A equação
$ (# +)

$ t
é escrita da seguite maneira, [1]:

$ (# +)
$ t

=
# ct

c
$ +
$ t

,

em que ct = c + c f é a compressibilidade total, dada pela soma da compressibilidade do líquido
com a compressibilidade do meio.

Considerando c, ct e µ constantes e desprezando o efeito da gravidade, ou seja #Z = 0, a
equação 3.10 é escrita como

div(
1
µ
"#
K # p) = (# ct )

$ +
$ t

, (3.12)

Condições de Contorno

Em simulações de reservatórios, o interesse principal encontra-se no interior do mesmo. Sendo as-
sim, pode-se assumir que o meio poroso encontra-se dentro de um domínio ! * R3 e o escoamento
no reservatório está sujeito as seguintes condições de contorno:

• Nos limites do reservatório pode-se aplicar condições de contorno tipo Dirichlet ou tipo Neu-
mann. Nas condições de contorno tipo Dirichlet define-se o valor da pressão do fluido nos
limites do reservatório e nas condições de Neumann define-se o valor do fluxo (vazão) que
entra ou sai do reservatório através de seus limites.

3.1.2 Casos Especiais de Interesse

Neste trabalho consideram-se apenas casos especiais, em que a equação de conservação de massa
(3.10) é simplificada. Inicialmente, assume-se que o efeito da gravidade é negligenciado e que o
meio seja homogêneo com # constante. Nestas condições, o problema de valor de contorno para
um fluido compressível monofásico se reduz a:



22 CAPÍTULO 3. PROBLEMA FÍSICO

Problema 1: Fluido Compressível

Encontrar p(x, y, z, ,t) e !* tal que
*
7777+

7777,

'div [+!*] + #
$ +
$ t

= 0,

!* = '
1
µ
"#
K # p,

+ = +(p),

(3.13)

mais as condições de contorno e inicial. No caso em que a densidade do fluido é constante, #
$ +
$ t

=
0, tem-se um fluido incompressível, em que a equação da conservação da massa se reduz a 'div!* =
0. Dessa forma tem-se:

Problema 2: Fluido Incompressível

Encontrar p = p(x, y, z, t) e !* , tal que:
*
+

,

'div(!*) = 0,

!* = '
1
µ
"#
K # p,

(3.14)

mais as condições de contorno e inicial.



Capítulo 4

O Método dos Elementos Finitos - MEF

O Método dos Elementos Finitos - MEF para solução aproximada de um problema variacional
é essencialmente o método de Galerkin onde usa-se como espaço de aproximação um espaço de
elementos finitos formado por funções polinomiais por partes. Simplificadamente, a metodologia
do MEF consiste nos seguintes passos:

1. Definição da equação diferencial - em geral provém de uma lei de conservação e inclui as
informações de contorno;

2. Obtenção da formulação variacional do problema;

3. Escolha de um espaço de funções de aproximação de dimensão finita;

4. Aplicação do método de Galerkin para o espaço de funções adotado: o resultado da aplicação
do método será um sistema algébrico cuja solução consiste de coeficientes da combinação
linear da solução aproximada em relação à da base adotada;

5. Resolução do sistema algébrico: consiste na resolução do sistema linear gerado pelo método
de Galerkin para obtenção dos coeficientes;

6. Análise da solução obtida: como o resultado é uma aproximação para a solução real do
problema, há a necessidade de se verificar a precisão da solução por meio de alguma técnica
de pós-processamento, ou ainda por meio da estimativa do erro de aproximação.

Para descrever a metodologia será utilizado um problema bidimensional, a equação de Poisson,
sendo desenvolvidas todas as etapas consideradas acima.

23



24 CAPÍTULO 4. O MÉTODO DOS ELEMENTOS FINITOS - MEF

4.1 O Problema Modelo - Equação de Poisson

Seja ! * R2 um aberto limitado com contorno $ ! Lipschitz (as derivadas normais de u são limi-
tadas e uniformente contínuas em $ !). Considere o problema modelo de valor de contorno,

'"u = f em ! (4.1)

com f + L2(!), sujeito à condição de contorno de Dirichlet

u(x, y) = 0, (x, y) + $ !. (4.2)

4.2 Formulação Variacional

Multiplicando a equação (4.1) por um função v e integrando em !, tem-se

'
#

!
("u v) dA =

#

!
( f v) dA, (4.3)

que vale para todas funções v de um espaço escolhido adequadamente. As funções v são conhe-
cidas como funções teste. Com o intuito de descrever a formulação variacional do problema mais
consistentemente, será introduzido a idéia de conjunto de todas funções que são suficientemente
suaves para serem consideradas como funções testes. O conjunto de tais funções, que tem valor
v(x, y) = 0 em (x, y) + $ ! é denotado pelo símbolo V (!).

Agora, será obtida uma formulação variacional de (4.1) pela observação que, se u e v são
funções suficientemente suaves, então, a integração por partes e com o uso da fórmula de Green,
Apêndice B.2, do lado esquerdo da expressão em (4.3), tem-se

#

!
(#u · #v) dA =

#

!
( f v) dA . (4.4)

Pode-se observar que (4.3) contém as derivadas segundas da solução u, enquanto (4.4) tem ape-
nas derivadas primeiras e assim, em passar de (4.3) para (4.4) tem-se um "enfraquecimento" da
suavidade requerida na solução. Desta forma, (4.1) e (4.2) podem ser substituidas pelo problema
variacional *

+

,
Encontrar u + V (!), tal que#

!
(#u · #v) dA =

#

!
( f v) dA, ,v + V (!) ,

(4.5)

em que V (!) = H 10 (!). Isto é,



4.2. FORMULAÇÃO VARIACIONAL 25

V (!) =
8

v + H 1(!) : v(x, y) = 0, (x, y) + &amp;amp;D
9

. (4.6)

Outro aspecto importante a ser destacado é a possibilidade de representar a formulação variaci-
onal através de um termo bilinear e um termo linear conforme mostrado abaixo:

*
7+

7,

B(u, v) =
#

!
(#u · #v) dA,

F(v) =
#

!
( f v) dA.

(4.7)

Assim, o problema é escrito como:
)

Encontrar u + V (!), tal que
B(u, v) = F(v), ,v + V (!).

(4.8)

4.2.1 Existência e Unicidade

Pela desigualdade de Cauchy-Schwarz, tem-se,

| B(u, v) |= |
:

! (#u · #v) dA| !$ #u $L2(!)$ #v $L2(!)

!$ u $H 1(!)$ v $H 1(!), ,u, v + V (!)

Isso implica que a forma bilinear B(. , .) é limitada em V (!) (V (!). Além disso, tem-se que a
forma bilinear é simétrica em V (!). Por outo lado, através da desigualdade de Friedrichs, existe
uma constante C &gt; 0 tal que

$ u $2L2(!)&amp;lt;C $ #u $
2
L2(!), ,u + V (!).

Pelo fato de $ u $2H 1(!)=$ u $
2
L2(!) + $ #u $

2
L2(!), tem-se

$ u $2H 1(!)! (1 + C) $ #u $
2
L2(!) .

Como B(u, u) =
:

! (#u · #u) dA =$ #u $
2
L2(!), resulta que

B(u, u) 0 (1'C)'1 $ u $2, ,u + V (!).

Isto é, B(. , .) é coerciva em V (!)(V (!). Portanto, pelo Teorema 2.5, Teorema de Lax-Milgram,
existe uma única solução u para o problema (4.8) (maiores detalhes ver [11], pg. 91).



26 CAPÍTULO 4. O MÉTODO DOS ELEMENTOS FINITOS - MEF

4.3 Espaços de Elementos Finitos

Espaços de elementos finitos são espaços de funções polinomiais por partes definidas em sub-
divisões do domínio de simulação. Para definir um espaço de elementos finitos é necessário os
seguintes passos, [13] página 67:

• Construir uma partição Th = {K} do domínio computacional !. Os elementos K poderão ser
intervalos, para m = 1, triângulos ou quadriláteros, para m = 2, e tetraedros, por exemplo,
para m = 3;

• Definir a natureza das funções v sobre cada elemento K (isto é, linear, quadrática, cúbica,
etc) e uma base local para essas funções;

• Construir o espaço de elementos finitos Vh através da descrição dos parâmetros que permitem
combinar as funções de base locais em cada elemento, formando bases globais.

Nesta seção será abordado de maneira sucinta o conceito dos espaços de elementos finitos para o
caso particular dos espaços de Lagrange.

4.3.1 Espaços de Elementos Finitos de Lagrange em 1D

Seja Pd o espaço vetorial real dos polinômios de grau menor ou igual a d. Dada uma sequência
de d + 1 pontos a0 &amp;lt;a1 &amp;lt;... &amp;lt;ad'1 &amp;lt;ad , definem-se os polinômios de Lagrange "i + Pd , para
i = 0, 1, 2, ..., d,

"i(x) =
d
'

j=0, j -=i

(x'a j)
(ai 'a j)

que formam uma base para Pd . De fato, como

"i(a j) =

)
1 se i = j
0 se i -= j

todo polinômio p + Pd é escrito da seguinte forma:

p(x) = p(x0)"0(x) + p(x1)"1(x) + ... + p(xd )"d (x) .

Definição 4.1 Dada uma partição Th = {K = [xk'1, xk], k = 1, .., n} do intervalo [a, b], seja
Vh = Ld (Th) o conjunto das funções v definidas no intervalo [a, b], tal que

• A restrição de ,(x) em cada elemento K + Th coincide com um polinômio p(K)(x) + Pd ;



4.3. ESPAÇOS DE ELEMENTOS FINITOS 27

• , + C0([a, b]).

O espaço Ld (Th) é um subespaço vetorial de C0([a, b]) com dim(Ld (Th)) = n(d + 1. O parâmetro
h indica o espaçamento mínimo h = min{hk, k = 1, ..., n}.

A seguir, mostram-se alguns exemplos desses espaços, o espaço das funções de Lagrange li-
neares e quadráticas, L1(Th) e L2(Th) respectivamente. A construção dos espaços das funções de
Lagrange de grau maior ou igual a três, isto é, as funções cúbicas, quárticas, etc, é análoga, como
indicado em [10] página 64 e [7] página 38.

Espaços das Funções de Lagrange Lineares por Partes

Para d = 1, o espaço Vh = L1(Th) é denomindo de espaço das funções de Lagrange lineares por
partes. Os polinômios de Lagrange associadas aos vértices do elemento K = [xk'1, xk] são dados
por

# (K)1 (x) =
xk 'x

hk
,

# (K)2 (x) =
x'xk'1

hk
,

(4.9)

em que hk = xk ' xk'1. Desta forma, a restrição de toda função , + L1(Th) ao elemento K pode
ser expressa em termos desta base de Lagrange

,(x) = ,(xk'1)#
(K)
1 (x) + ,(xk)#

(K)
2 (x) , ,x + K = [xk'1, xk] .

As funções # (K)1 e #
(K)
2 são chamadas de funções de base local, no elemento K. A Figura 4.1

mostra um elemento padrão, ou mestre, K = [0, 1] com as funções de base local #1 e #2.
A partir da definição das funções de base local definem-se as funções de base global do espaço

L1(Th).

Definição 4.2 Denota-se por "i(x), i = 0, 1, 2, ..., n, as funções da base global do espaço L1(Th),
associadas aos vértices xi dos elementos da partição Th, as quais são definidas por:

"0(x) =

*
+

,

x1 'x
h1

se x + [x0, x1]

0 se x /+ [x0, x1] ,



28 CAPÍTULO 4. O MÉTODO DOS ELEMENTOS FINITOS - MEF

0.0 0.2 0.4 0.6 0.8 1.0
0.0

0.2

0.4

0.6

0.8

1.0

!

"2!!"

"1!!"

Figura 4.1: Funções de base local lineares para problemas unidimensionais.

"i(x) =

*
777+

777,

x'xi'1
hi

se x + [xi'1, x]
xi+1 'x

hi+1
se x + [xi, xi+1]

0 se x /+ [xi'1, xi+1]
e

"n(x) =

*
+

,

x'xn'1
hn

se x + [xn'1, xn]

0 se x /+ [xn'1, xn]

As funções "i satisfazem a condição

"i(x j) =

)
1 se i = j
0 se i -= j

, i, j = 0, 1, ..., n,

sendo portanto, chamadas de funções de base nodais. Essas funções são linearmente independentes
e verifica-se que toda , em L1(Th) se expressa na forma

,(x) =
n

%
i=0

,(xi)"i(x) .

Portanto, formam uma base para o espaço L1(Th), resultando que a dimensão de L1(Th) é igual
a n + 1. Pela sua construção, uma função de L1(Th) possui derivada constante por partes, sendo
portanto uma função de H 1([a, b]).



4.3. ESPAÇOS DE ELEMENTOS FINITOS 29

!1.0 !0.5 0.0 0.5 1.0

0.0

0.2

0.4

0.6

0.8

1.0

"

#3!""

#2!""

#1!""

Figura 4.2: Funções de base local quadráticas para problemas unidimensionais.

Espaço das Funções de Lagrange Quadráticas

Para d = 2, o espaço Vh = L2(Th) é denomindo espaço das funções de Lagrange quadráticas por
partes. Os polinômios de Lagrange associadas aos vértices do elemento K = [xk'1, xk] e ao seu
ponto médio x?k = (xk'1 + xk) /2 são dados por

# (K)1 (x) = 2
;

xk 'x
hk

&amp;lt;;
xk 'x

hk
'

1
2

&lt;
,

# (K)2 (x) = 4
;

xk 'x
hk

&amp;lt;;
x'xk'1

hk

&lt;
,

# (K)3 (x) = 2
;

x'xk'1
hk

&amp;lt;;
x'xk'1

hk
'

1
2

&lt;
,

(4.10)

em que, hk = xk ' xk'1. Sendo assim, a restrição de toda função , + L2(Th) ao elemento K pode
ser escrita da forma

,(x) = ,(xk'1)#
(K)
1 (x) + ,(x?)#

(K)
2 (x) + ,(xk)#

(K)
3 (x) , ,x + K = [xk'1, xk] .

As funções # (K)1 , #
(K)
2 e #

(K)
3 são as funções de base local do elemento K. A Figura 4.2 mostra um

elemento padrão K = ['1, 1] com as funções de base local # (K)1 , #
(K)
2 e #

(K)
3 pertencentes a P2.

A partir da definição das funções de base local quadráticas, definem-se as funções de base
global do espaço L2(Th).

Definição 4.3 Denota-se por "0, "1, "2k'1, "2k, ..., "2n'1, "2n as funções da base global do



30 CAPÍTULO 4. O MÉTODO DOS ELEMENTOS FINITOS - MEF

espaço L2(Th), as quais são definidas da seguinte forma:

1. Função "0 associada ao ponto x0

"0(x) =

*
+

,
2
;

x1 'x
h1

&amp;lt;;
x1 'x

h1
'

1
2

&lt;
se x + K = [x0, x1]

0 se x /+ [x0, x1] .

2. Funções "2k associadas aos pontos xk, k = 1, 2, ..., n'1,

"2k(x) =

*
7+

7,

# (K)3 (x) se x + K = [xk'1, xk]
# (K)1 (x) se x + K = [xk, xk+1]
0 se x /+ [xk'1, xk+1] .

3. Funções "2k'1 associadas aos pontos médios x?k = (xk'1 + xk) /2 , x?k + K = [xk'1, xk],
k = 1, 2, ..., n

"2k'1(x) =

)
# (K)2 (x) se x + K = [xk'1, xk]
0 se x /+ [xk'1, xk] .

4. Função "2n associada ao ponto xn

"2n(x) =

*
+

,
2
;

x'xn'1
hn

&amp;lt;;
x'xn'1

hn
'

1
2

&lt;
se x + K = [xn'1, xn]

0 se x /+ [xn'1, xn] .

As funções "i satisfazem as condições

"2k(x) =

*
7+

7,

1 se x = xk
0 se x = x j, j -= k
0 se x = x?k

, k = 0, 1, ..., n ,

e

"2k'1(x) =

)
1 se x = x?k
0 se x = x j

, k = 1, 2, ..., n ,

sendo portanto, chamadas de funções de base nodais. Essas funções são linearmente independentes
e verifica-se que toda , em L2(Th) se expressa da na forma

,(x) =
2n

%
j=0

a j" j(x) ,



4.3. ESPAÇOS DE ELEMENTOS FINITOS 31

em que os coeficientes são a2k = ,(xk) e a2k'1 = ,(x?k). Portanto, formam uma base de L2(Th),
cuja dimensão é 2n + 1. Pela sua construção, uma função de L2(Th) possui derivada linear por
partes, sendo portanto uma função de H 1([a, b]).

4.3.2 Espaços de Elementos Finitos de Lagrange em 2D

Os princípios para a construção de espaços de elementos finitos de Lagrange bidimensionais são
análogos ao caso unidimensional. Ou seja, considera-se o domínio computacional ! * R2 particio-
nado em um número finito de elementos retangulares ou triangulares K, formando uma patição Th.
Constroem-se funções de base polinomiais localmente em cada elemento e depois constroem-se as
funções de base globais, as quais são contínuas nas interfaces, entre elementos adjacentes.

Elementos Retangulares

Sobre um elemento retangular K define-se por Q1(K) o espaço das funções polinomiais bilinea-
res,

Q1(K) = {,, ,(x, y) = !1 + !2x + !3y + !4xy, (x, y) + K e !i + R},

com dim Q1(K) = 4. As funções , + Q1(K) são produtos tensoriais de polinômios unidimensionais
de grau menor ou igual a um em cada uma das variáveis x e y. Sendo assim, se K = Kx ( Ky
com Kx = [xk'1, xk] e Ky = [y j'1, y j], as funções de base local para Q1(K) podem ser obtidas
como produto tensorial das funções de base de Lagrange lineraes, (4.9), para P1(Kx) e P1(Ky).
Precisamente,

# (K)11 (x, y) = #
(Kx)
1 (x)#

(Ky)
1 (y) ,

# (K)12 (x, y) = #
(Kx)
1 (x)#

(Ky)
2 (y) ,

# (K)21 (x, y) = #
(Kx)
2 (x)#

(Ky)
1 (y) ,

# (K)22 (x, y) = #
(Kx)
2 (x)#

(Ky)
2 (y) ,

(4.11)

são as quatro funções de base local para Q1(K), as quais são funções nodais associadas aos quatro
vértices de K. Como exemplo, a Figura 4.3 mostra um elemento retangular padrão, K = ['1, 1](
['1, 1], e a Figura 4.4 mostra as funções de base sobre o elemento, associadas aos vértices a11,
a12, a21 e a22 do elemento.

De forma análoga, produtos tensoriais de polinômios de Lagrange de ordem arbitrária podem
ser usados nas construções de elementos retangulares de ordem superior cujas bases locais nodais



32 CAPÍTULO 4. O MÉTODO DOS ELEMENTOS FINITOS - MEF

1

?1

x

y
a22a12

a11 a21

?1 1

Figura 4.3: Elemento retangular K = ['1, 1]( ['1, 1] e seus vértices indicados por a11, a12, a21
e a22.

!11!x, y"

"1.0

"0.5

0.0

0.5

1.0
"1.0

"0.5

0.0

0.5

1.0

0.0

0.5

1.0

!12!x, y"

"1.0

"0.5

0.0

0.5

1.0
"1.0

"0.5

0.0

0.5

1.0

0.0

0.5

1.0

!21!x, y"

"1.0

"0.5

0.0

0.5

1.0
"1.0

"0.5

0.0

0.5

1.0

0.0

0.5

1.0

!22!x, y"

"1.0

"0.5

0.0

0.5

1.0
"1.0

"0.5

0.0

0.5

1.0

0.0

0.5

1.0

Figura 4.4: Funções de base local bilineraes para problemas bidimensionais.



4.3. ESPAÇOS DE ELEMENTOS FINITOS 33

estão associadas aos nós que são obtidos pelo produto tensorial das funções nodais pertencentes às
bases unidimensionais correspondentes, [10] página 198.

Como no caso unidimensional o espaço de elementos finitos retangulares Vh são construídos
combinando as bases locais para formar bases globais contínuas. Além disso, pelo fato das funções
v + Vh serem polinômios em cada elemnto K e contínuas através da fronteira de elementos adjacen-
tes, então as derivadas D! v, | ! |= 1, existem e são contínuas por partes, portanto v + H 1(!), [10]
e [13].

Elementos Triangulares

Sejam K um elemento triangular e P1(K) o espaço de funções lineares

,(x, y) = !1 + !2x + !3y, (x, y) + K

com dim P1(K) = 3. Sendo (x j, y j) + R2, j = 1, 2, 3, as coordenadas dos vértices do triângulo,
as funções de base local são:

# (K)1 (x, y) =
1

2AK
[(x2y3 'x3y2) + (y2 'y3)x + (x3 'x2)y] ,

# (K)2 (x, y) =
1

2AK
[(x3y1 'x1y3) + (y3 'y1)x + (x1 'x3)y] ,

# (K)3 (x, y) =
1

2AK
[(x1y2 'x2y1) + (y1 'y2)x + (x2 'x1)y] ,

(4.12)

em que AK é a área do triângulo K, de forma que

# (K)i (x j, y j) =

)
1 se i = j
0 se i -= j .

Toda função , + P1(K)) é escrita unicamente por

,(x, y) = aK1 #
(K)
1 (x) + a

K
2 #

(K)
2 (x) + a

K
3 #

(K)
3 (x) , ,(x, y) + K

sendo a(K)j = ,(x j, y j), j = 1, 2, 3.



34 CAPÍTULO 4. O MÉTODO DOS ELEMENTOS FINITOS - MEF

De forma geral, dim Pr(K) =
(r+1)(r+2)

2 e

Pr(K) =

)
,, ,(x, y) = %

0!i+ j!r
!i jxiy j para (x, y) + K, !i j + R

=
.

Analogamente definem-se funções de base local # (K)i (x, y), i = 1, ..., dim Pr(K). Para os casos
dos elementos quadráticoss e cúbicos, ver [10] página 204.

Como no caso dos elementos finitos retangulares, o espaço de elementos finitos triangulares
Vh são construídos combinando as bases locais para formar bases globais contínuas e resultam em
subespaços de H 1!), [10] e [13].

4.3.3 Formulação de Galerkin

Considerando que já se tem a formulação variacional para o problema e um espaço de elementos
finitos Vh, pode-se agora pensar no método de Galerkin, visto na Subseção 2.3.2, para construir
soluções aproximadas para o problema (4.8). Assim, em vez de tratar o problema de dimensão
infinita (4.8), procura-se uma solução aproximada uh + Vh. Desta forma, o problema aproximado
consiste em: )

Encontrar uh + Vh, tal que
B(uh, vh) = F(vh), ,vh + Vh .

(4.13)

Utilizando as funções de base global para Vh

(h = {"i, i = 1 , ..., Nh }, (4.14)

e adotando como funções testes v = " j, j = 1, ... , Nh, o problema (4.13) resume-se em:

*
+

,

Encontrar !i, i = 1, . . . , Nh, tal que
Nh
%

i=1
!i{B("i, " j)} = F(" j), j = 1, ... , Nh .

(4.15)

Consideram-se agora algumas mudanças de notações, sob as quais o problema (4.15) é mais visto:

• A matriz de rigidez global Ki j, é dada por:

Ki j = B("i, " j) =
#

!

%
#"i · #" j

&amp;amp;
dA; (4.16)



4.4. ESTIMADORES DE ERRO 35

• O vetor de carga X =
'
X j

(
é dado por:

X j = F(" j) =
#

!

%
f " j

&amp;amp;
dA. (4.17)

Com isso, o problema (4.15) pode ser escrito na forma usual (sistema de equações lineares):

*
+

,

Encontrar !i, i = 1, ... , Nh, tal que
Nh
%

i=1
!iKi j = X j , j = 1, ... , Nh .

(4.18)

O qual pode ser represenatado por [K][!] = [X ].

4.4 Estimadores de erro

O método dos elementos finitos fornece uma aproximação da função procurada, dentro do subes-
paço Vh escolhido. Caso o subespaço escolhido Vh não seja adequado, a função de aproximação
não apresentará uma precisão satisfatória. Neste caso, uma análise para verificar tal precisão será
necessária.

Para a análise de aproximação gerada por meio de uma metodologia de elementos finitos
considera-se o erro

e(x) = u(x)'uh(x) , (4.19)

em que u é a solução exata e uh é a solução aproximada. As principais normas utilizadas no estudo
de estimadores de erro são :

- norma energia E(!): $ e $2B= B(u ' uh, u ' uh), em que B representa uma forma
bilinear;

- norma L2(!) : $ e $2L2 =
:

! | u'uh |
2 dx;

- semi-norma H 1(!) : | e |2H 1 =
:

! | #u'#uh |
2 dx;

- norma H 1(!) : $ e $2H 1 =$ e $
2
L2 + | e |

2
H 1

- norma L$(!) : $ e $L$ = supx+!{| u(x)'uh(x) |}.

Utilizando uma norma e conhecendo-se o resultado analítico do problema em questão, o cálculo
do erro seria simples. Como a obtenção da solução analítica é algo inviável para a maioria dos
problemas nos quais são utilizados métodos numéricos, utiliza-se, então, uma abordagem na qual
o erro da aproximação é estimado.



36 CAPÍTULO 4. O MÉTODO DOS ELEMENTOS FINITOS - MEF

Os estimadores de erro podem ser baseados em dois grupos: a priori e a posteriori. As esti-
mativas de erro a priori trazem informações antecipadas sobre a grandeza do erro e sobre o modo
de convergência da solução. O estimador de erro a posteriori é baseado nas informações obtidas
durante o processo de solução e as estimativas de erro podem ser feitas para cada elemento da
malha (erro local) ou para toda malha (erro global). Os estimadores de erro a posteriori tem seu
desenvolvimento cada vez maior, sendo [6] o primeiro trabalho de destaque, onde o estimador de
erro baseia-se nas aproximações da norma de energia do erro em cada elemento K da malha.

Em seguida apresentam-se algumas estimativas de erro a priori e a posteriori. Um estudo mais
aprofundado do assunto, já que está além do estudo proposto nesse trabalho, pode ser visto em [11]
e [2, 24].

4.4.1 Estimativa do Erro a Priori

Nesta seção apresentam-se algumas estimativas a priori para o erro, nas normas em H 1(!) e L2(!),
na aproximação pelo método do Galerkin do problema modelo, que são válidas sob condições
apropriadas dos espaços aproximantes de elementos finitos (ver [11], pg. 82-95).

Seja e = u ' uh o erro entre a solução exata u do problema (4.8) e a solução aproximada por
elementos finitos uh do problema (4.13). Seja p 0 1 o grau dos polinômios usados na definição das
funções de base Vh, supondo que u + H r(!)3H 10 (!), r &gt; 1, e µ = min(p , r '1), então

$ e $H 1(!)! C(1 +
M
!

)hµ | u |H r(!) (4.20)

Assim, se u for suficientemente suave (isto é, se r for grande), a taxa de convergência assintótica do
erro, na norma em H 1(!), será de ordem O(hp). Por exemplo, para elementos lineares e quadráti-
cos tem-se as ordens O(h) e O(h2), respectivamente. Vale notar que, se a regularidade de u for r &amp;lt;p
o aumento no grau do polinômio não melhora a taxa de convergência. Verifica-se que se f + H s(!),
! é convexo com fronteira $ ! Lipschitziano, então, u + H s+2(!) e $ u $H s+2(!)! C $ f $H s(!),
ver [11, 19]. Desta forma, tem-se

$ e $H 1(!)! Ch
µ1 $ f $H s(!), (4.21)

em que
µ1 = min(p , s + 1)

e C é uma constante que depende dos dados do problema.



4.4. ESTIMADORES DE ERRO 37

No caso da norma em L2(!), tem-se o seguinte estimador do erro:

$ e $L2(!)! Ch
) $ u $H r(!) ,

sendo
) = min(2p , p + 1 , r).

Se f + H s(!), $ u $H r(!)! C $ f $H r'2(!), então

$ e $L2(!)! Ch
- $ f $H s(!),

em que
- = min(2p , p + 1 , s + 2)

e C é uma constante que depende dos dados do problema. Assim, se elementos lineares são usados,
p = 1, e r = s + 2 0 2, tem-se - = 2 e ordem O(h2) para o erro em L2(!), e assim sucessivamente
para elementos de grau maior.

Outras estimativas para erro a priori considerando a norma da energia E e a semi-norma H 1(!)
são mostradas em [10, 11].

De um modo geral, as estimativas a priori são da forma

Erro(h) =$ e $! C hµ , (4.22)

em que C é uma constante que depende dos dados do problema e µ é um inteiro que depende
da regularidade da solução e do grau dos polinômios usados na definição das funções de base
polinomiais por partes utilizadas. O expoente µ é uma medida da taxa de convergência assintótica
do erro, com respeito a norma $ · $ escolhida. Além disso, se µ &gt; 0, então o erro $ e $, claramente,
aproxima-se de zero quando h tende a zero.

4.4.2 Estimativa do Erro a Posteriori

Nesta seção apresenta-se uma etimativa para o erro a posteriori, encontrado em [2, 24], através
da norma da energia. A forma bilinear B(u, v) é simétrica e coersiva em V (!) (V (!) e assim,
define um produto interno em V (!). Este produto interno está associado com a norma de energia
$ u $E =

$
B(u, u). O erro numérico na aproximação uh de u, é dado por uma função e + V (!) ,



38 CAPÍTULO 4. O MÉTODO DOS ELEMENTOS FINITOS - MEF

e = u'uh. Fazendo u = e + uh tem-se

B(e + uh, v) = F(v) . B(e, v) + B(uh, v) = F(v)
. B(e, v) = F(v)'B(uh, v), ,v + V (!)

(4.23)

Escrevendo Ruh(v) = F(v)'B(uh, v), tem-se

B(e, v) = Ruh(v) , ,v + V (!) , (4.24)

em que Ruh, chamado de resíduo, é um funcional linear do espaço dual V
/(!) e depende dos dados

do problema e da solução por elementos finitos uh. Essa estimativa de erro faz uso dos dados do
problema variacional e propriedades do erro. Por exemplo, este erro aproximado satisfaz a equação
residual (4.23) e a condição de ortogonalidade de Galerkin, Subseção 2.3.2,

B(e, vh) = R
u
h(vh) = F(vh)'B(uh, vh) = 0 , ,vh + Vh .

Uma equação residual similar a (4.23) é proposta por Ainsworth e Oden [2], a qual é obtida pela
integração por partes, sobre cada elemento, da parte esquerda da equação (4.23).

#

K
(#e · #v)dA =

#

K
(R v)dA +

#

K
(v #e |K ·!nK)ds. (4.25)

Em que:

e : função erro procurada;

v : função teste;

R : função residual ou resíduo, R = f + "u;

!nK : vetor normal à face do elemento (K);

K : elemento em análise.

Assim, de acordo com [2], resolvendo a equação (4.25), considerando condições de continuidade
das funções e de suas integrais, a sua solução pode ser limitada por:

$ e $E(K)! C1 $ R $L2(K) +C2 $ S $L2(K) , (4.26)

onde S é uma aproximação para #e ·!nK na face do elemento e C1 e C2 são constantes que dependem
da malha, principalmente do tamanho do elemento (hk).



4.5. ADAPTATIVIDADE 39

4.5 Adaptatividade

Nesta Subseção faz-se uma breve introdução sobre o conceito de adaptividade. Pela definição do
MEF, os parâmetros que podem ser alterados para modificar o espaço de funções de aproximação
são:

• h: parâmetro relacionado à discretização da malha, normalmente associado ao "tamanho" do
elemento;

• p: parâmetro relacionado ao grau dos polinômios, de cada elemento, utilizados como base
local para o espaço Vh.

A adaptividade consiste no enriquecimento/melhoria do espaço de funções Vh, onde este enrique-
cimento pode ser feito através do refinamento dos parâmetros h, p ou ainda a combinação destes.
O refinamento h consiste na redução do tamanho dos elementos da malha, enquanto que o refina-
mento p consiste na elevação da ordem dos polinômios da base de funções teste. O refinamento h p
consiste no refinamento destes dois parâmetros para a mesma malha.



Capítulo 5

PZ - Ambiente de Programação Orientado a
Objeto

A parte numérica deste trabalho foi desenvolvida usando o Ambiente de Programação Científica
Orientada a Objetos PZ, que é um código livre, disponível para a comunidade científica através do
endereço http://labmec.fec.unicamp.br/pz/download. Para um estudo mais aprofundado do Ambi-
ente PZ ver as referências [8, 24].

O ambiente PZ é um conjunto de classes em linguagem C++, com o objetivo de permitir a
implementação de métodos de elementos finitos em problemas de valores de contorno unidimen-
cionais, bidimensionais e tridimensionais. O PZ é constituido de módulos bem diferenciados, cada
qual com funções específicas, os quais combinados adquirem as funcionalidades necessárias para
a implementação de métodos de elementos finitos.

O PZ é desenvolvido usando programação orientada a objetos e portanto tem como um de seus
grandes trunfos a reutilização de códigos (objetos e métodos), pois a maioria das partes de um
código de elementos finitos são muito semelhantes de uma formulação para outra.

O ambiente PZ pode ser entendido como um conjunto de ferramentas cuja única interdepen-
dência reside na utilização de suas classes comuns e utilitárias. De modo geral as ferramentas do
ambiente PZ podem ser classificadas nos seguintes grupos:

• Módulo para definição do problema a ser solucionado;

• Módulo para definição de geometria do problema, incluindo diversos elementos unidimensi-
onais, bidimensionais e tridimensionais, além de algoritmos de adaptatividade h para todos
os elementos disponíveis;

• Módulos para definição de espaço das funções de base;

41



42 CAPÍTULO 5. PZ - AMBIENTE DE PROGRAMAÇÃO ORIENTADO A OBJETO

• Módulos utilitários, onde são definidas classes de vetores matriciais e métodos de resolução
de sistemas lineares.

Como exemplo de classes implimentadas no PZ, tem-se:

A classe TPZGeoMesh e suas classes derivadas executam (implementam) uma malha geomé-
trica para o ambiente PZ, em que, uma malha geométrica consiste em uma coleção de nós e ele-
mentos geométricos. A classe TPZCompEl e suas classes derivadas implementam o espaço de
aproximação.

A classe TPZAnalisys e suas derivadas implementam as operações globais de uma simulação
de elementos finitos, sendo aqui executadas as operações de construção de sistema de equações.
Implementam métodos de resolução do sistema, podendo ser implementado desde a solução de
problemas lineares até a solução de problemas não lineares com evolução no tempo.

5.1 Experimentos Numéricos

São resolvidos numericamente dois problemas de valores de contorno, unidimensional e bidimensi-
onal, respectivamente, tendo como objetivo confirmar a ordem da taxa de convergência assintótica
do erro, nas normas H 1(!) e L2(!), em problema elípticos, conforme o que foi apresentado na
análise do erro a priori na Seção 4.4 do Capítulo 4. Além disso, o estudo da taxa de convergência
é útil na validação do programa computacional desenvolvido. Na resolução numérica do problema
unidimensional utilizam-se os espaços de elementos finitos de Lagrange em 1D como espaços de
funções aproximantes. Já no problema bidimensional usam-se os espaços de elementos finitos de
Lagrange em 2D associados aos elementos retangulares da partiçao da malha.

5.1.1 Problema 1D

Considera-se o seguinte problema de valor de contorno

*
7+

7,

'u//(x) + u(x) = 1, x + !
u(0) = 2
u(9) = exp(9) + 1 ,

com ! = (0, 9). A solução analítica deste problema é u(x) = exp(x) + 1, como mostra a Figura
5.1.



5.1. EXPERIMENTOS NUMÉRICOS 43

0 2 4 6 8
0

2000

4000

6000

8000

Figura 5.1: Gráficos da Solução exata exp(x) + 1 do problema 1D.

Formulação Variacional

Multiplicando a equação diferencial pela função teste v + H 10 (!) e integrando no intervalo, tem-se:

# 9

0

'
'u//(x)v(x) + u(x)v(x)

(
dx =

# 9

0
[v(x)] dx.

Fazendo integração por partes tem-se que:

# 9

0

'
u//(x)v(x)

(
dx =

'
u/(x)v(x)

(9
0 '

# 9

0

'
u/(x)v/(x)

(
dx

Portanto, a formulação variacional é dada por: Encontrar u + H 1(!), u(0) = 1 e u(9) = exp(9) + 1,
tal que

B(u, v) = F(v), ,v + H 10 (!) ,

em que
B(u, v) =

: 9
0 [u

/(x)v/(x) + u(x)v(x)] dx, F(v) =
: 1

0 [v(x)] dx .

Solução Numérica

As Figuras 5.2, 5.3 e 5.4 mostram os gráficos da solução exata e das soluções aproximadas conside-
rando elementos finitos de Lagrange lineares, p = 1, em malhas uniformes variando o espaçamento
h. Observa-se que a solução aproximada tende à solução exata com h tendendo a zero.

A partir de (4.22), se Erro = O(hµ ), plotando o gráfico log-log, (log10 h versus log10 Erro ),
obtém-se

log10 Erro = µ log10 h + log10 C. (5.1)



44 CAPÍTULO 5. PZ - AMBIENTE DE PROGRAMAÇÃO ORIENTADO A OBJETO

0 2 4 6 8

0

2000

4000

6000

8000
h!9!2

0 2 4 6 8
0

2000

4000

6000

8000
h!9!4

Figura 5.2: Gráficos da solução aproximada uh(x) usando funções de base lineares, p = 1, e com
h = 9/2 e h = 9/4 .

0 2 4 6 8
0

2000

4000

6000

8000
h!9!8

0 2 4 6 8
0

2000

4000

6000

8000
h!9!16

Figura 5.3: Gráficos da solução aproximada uh(x) usando funções de base lineares, p = 1, e com
h = 9/8 e h = 9/16.

0 2 4 6 8
0

2000

4000

6000

8000
h!9!32

0 2 4 6 8
0

2000

4000

6000

8000
h!9!64

Figura 5.4: Gráficos da solução aproximada uh(x) usando funções de base lineares, p = 1, e com
h = 9/32 e h = 9/64.



5.1. EXPERIMENTOS NUMÉRICOS 45

Medida da taxa de convergência, µ =
log10(Erro1/Erro2)

log10 2

Norma L2(!) Semi-norma H 1(!)
h1, h2 p = 1 p = 2 p = 3 p = 1 p = 2 p = 3

9/2, 9/4 1,42233 1,99839 3,10097 0,691256 1,328720 2,038520
9/4, 9/8 1,80423 2,63041 3,66221 0,753194 1,770680 2,629380

9/8, 9/16 1,96531 2,89580 3,91391 0,843794 1,951090 2,881740
9/16, 9/32 2,00360 2,97332 3,98654 0,922576 1,998160 2,963590
9/32, 9/64 2,00742 2,99330 4,00143 0,963188 2,005300 2,988050

9/64, 9/128 2,00512 2,99830 4,00262 0,982258 2,004240 2,995570
9/128, 9/256 2,00291 2,99955 3,99992 0,991339 2,002520 2,999490
9/256, 9/512 2,00155 2,99988 3,95877 0,995722 2,001360 3,009460

Tabela 5.1: Taxa de convergência do erro medido nas normas L2(!) e semi'H 1(!).

A partir desta equação, a medida da taxa de convergência pode ser estimada da seguinte maneira:
considerando os parâmetros h1 e h2, h1 &gt; h2, pertencentes a duas malhas uniformes, tem-se

log10 Erro1 = µ log10 h1 + log10 C

e
log10 Erro2 = µ log10 h2 + log10 C .

Subtraindo a segunda equação da primera resulta que

µ =
log10 (Erro1/Erro2)

log10 (h1/h2)
. (5.2)

As Tabelas 5.1 e 5.2 mostram os valores da taxa de convergência µ estimada pela fórmula (5.2),
tomando valores de h listados na primeira coluna. De acordo com a literatura [10, 11], para o
erro medido na norma L2(!) a taxa de convergência deve ser de ordem O(hp+1) enquanto que nas
normas H 1(!), semi ' H 1(!) e energia E(!) a ordem é de O(hp), concordando com os valores
estimados. A Figura 5.5 mostra os gráfico log-log dessas taxas de convergências.

5.1.2 Exemplo 2D

O objetivo aqui, é mostrar um problema de valor de contorno, no qual é difícil de ser verificada
numericamente a taxa de convergência do erro O(hp) esperada. Neste caso, nem sempre o refina-
mento uniforme h ou p leva a um erro numérico tendendo a zero quando h tende a zero ou quando



46 CAPÍTULO 5. PZ - AMBIENTE DE PROGRAMAÇÃO ORIENTADO A OBJETO

Medida da taxa de convergência, µ =
log10(Erro1/Erro2)

log10 2

Norma H 1(!) Norma energia E(!)
h1, h2 p = 1 p = 2 p = 3 p = 1 p = 2 p = 3

9/2, 9/4 1,271910 1,39891 2,21611 1,27191 1,39891 2,21611
9/4, 9/8 1,314010 1,80502 2,67647 1,314010 1,80502 2,67647

9/8, 9/16 1,082410 1,96237 2,89346 1,082410 1,96237 2,89346
9/16, 9/32 0,983935 2,00129 2,96641 0,983935 2,00129 2,96641
9/32, 9/64 0,977423 2,00611 2,98873 0,977423 2,00611 2,98873

9/64, 9/128 0,985640 2,00445 2,99593 0,985640 2,00445 2,99593
9/128, 9/256 0,992148 2,00257 2,99954 0,992148 2,00257 2,99954
9/256, 9/512 0,995924 2,00137 3,00946 0,995924 2,00137 3,00946

Tabela 5.2: Taxa de convergência do erro medido nas normas H 1(!) e E(!).

!
!

!

!

!

!

!

!

!

"

"

"

"

"

"

"

"

"

#

#

#

#

#

#

#

#

#

!1.5 !1.0 !0.5 0.0 0.5

!6

!4

!2

0

2

4

Log!h"

L
og
!E
rr
o"

NORMA L2

!
!

!
!

!
!

!
!

!

"

"

"

"

"

"

"

"

"

#

#

#

#

#

#

#

#

#

!1.5 !1.0 !0.5 0.0 0.5

!2

0

2

4

Log!h"

L
og
!E
rr
o"

NORMA SH1

!
!

!
!

!
!

!
!

!

"

"

"

"

"

"

"

"

"

#

#

#

#

#

#

#

#

#

!1.5 !1.0 !0.5 0.0 0.5

!2

0

2

4

Log!h"

L
og
!E
rr
o"

NORMA DA ENERGIA

Figura 5.5: Gráfico da Taxa de convergência nas normas L2(!), semi ' H 1(!) e energia E(!),
com p = 1()), p = 2 (!) e p = 3 (").



5.1. EXPERIMENTOS NUMÉRICOS 47

aumenta-se a ordem dos polinômios das funções de base.

Considere o seguinte problema de valor de contorno, [2] pg. 198:

*
7+

7,

'"u = f , (x, y) + !
u = 0, (x, y) + &amp;amp;D
$ u/$ n = 0, (x, y) + &amp;amp;N

em que, ! = (0, 1)((0, 1), &amp;amp;D = {(x, y), 0 &amp;lt;x &amp;lt;1 e y = 0}, &amp;amp;N = &amp;amp;'&amp;amp;D e

f (x, y) = 10{(e10x
2
'1)(e10y

2
'1)(x'1)2(y'1)2y2+

4(e10y
2
'1)(1'x)x(1 + e10x

2
('10x2 + 10x'1))(y'1)2y2+

(e10y
2
'1)x2('1 + e10x

2
(200x4 '400x3 + 250x2 '60x + 11))(y'1)2y2+

40e10y
2
(e10x

2
'1)(x'1)2x2y2(2y2 '3y + 1) + (e10x

2
'1)(e10y

2
'1)(x'1)2x2(6y2 'y + 1)+

10e10y
2
(e10x

2
'1)(x'1)2x2(y'1)2y2(20y2 + 1)}.

A solução exata é dada por:

u(x, y) = 5x2y2(1'x)2(e10x
2
'1)(1'y)2(e10y

2
'1).

Formulação Variacional

Seja V (!) o subespaço
V (!) =

8
v + H 1(!) : v = 0 em &amp;amp;D

9
.

Multiplicando a equação diferencial pela função teste v + V (!) e aplicando a fórmula de Green,
Equação (B.6), tem-se:

#

!
(#u · #v) dA'

#

$ !
(v#u · n) ds =

#

!
( f v) dA.

Pelas condições de contorno, tem-se
#

!
(#u · #v) dA =

#

!
( f v) dA.



48 CAPÍTULO 5. PZ - AMBIENTE DE PROGRAMAÇÃO ORIENTADO A OBJETO

0.0 0.2 0.4 0.6 0.8 1.0

0.0

0.2

0.4

0.6

0.8

1.0

0

500

1000

1500

2000

2500

3000

3500

Figura 5.6: Solução exata do problema 2D, u = 5x2y2(1'x)2(e10x
2
'1)(1'y)2(e10y

2
'1).

Portanto, a formulação variacional é dada por: Encontrar u + V (!), tal que

B(u, v) = F(v) ,v + V (!)

em que

B(u, v) =
#

!
(#u · #v) dA, F(v) =

#

!
( f v) dA.

Solução Numérica

Embora seja suave, a solução exata possui uma região de forte gradiente, como mostra a Figura 5.6.
Devido a esse fato, o custo computacional para se obter uma solução com precisão adequada, pode
ser muito alto quando trabalha-se com refinamentos uniformes hp. Nas Tabelas 5.3, 5.4, 5.5 e 5.6
mostram-se os valores do erro numérico e das taxas de converência do erro medidos nas normas
L2(!) e H 1(!), onde podem-se constatar os cometários acima. O parâmetro p representa o grau
das funções de base de Lagrange unidimensionais, utilizadas no produto tensorial para construção
dos espaços de elementos finitos de Lagrange em 2D.

A Figura 5.7 mostra o gráfico da solução aproximada usando p = 5 e h = 1/32. Os valores do
erro, e = u ' uh, calculados nas normas L2(!) e H 1(!) são de 0, 00087364 e 0, 428289, respecti-
vamente, como mostram as Tabelas 5.3 e 5.5.



5.1. EXPERIMENTOS NUMÉRICOS 49

Valor do erro, $ . $L2(!)
h p = 1 p = 2 p = 3 p = 4 p = 5

1/2 485,037 395,791 182,802 68,6695 71,9861
1/4 418,617 120,598 53,681 44,486 20,6810
1/8 145,654 38,2637 24,2332 7,15342 1,46716

1/16 37,8799 16,6034 3,48541 0,455989 0,04451890
1/32 18,9318 3,08534 0,28934 0,0182051 0,00087364

Tabela 5.3: Valor do erro medido na norma em L2(!), considerando p = 1, p = 2, p = 3, p = 4 e
p = 5.

Taxa de convergência, $ . $L2(!), µ =
log10(Erro1/Erro2)

log10 2

h1, h2 p = 1 p = 2 p = 3 p = 4 p = 5
1/2, 1/4 0,212464 1,71453 1,76815 0,626318 1,79941
1/4, 1/8 1,52309 1,65616 1,14708 2,636650 3,81721
1/8, 1/16 1,94304 1,2045 2,79758 3,971560 5,04246

1/16, 1/32 1,00062 2,42798 3,59050 4,646580 5,67123

Tabela 5.4: Taxas de convergências, do erro, medidas na norma em L2(!), considerando p = 1,
p = 2 , p = 3, p = 4 e p = 5.

Valor do erro, $ . $H 1(!)
h p = 1 p = 2 p = 3 p = 4 p = 5

1/2 7639,31 6987,37 4583,74 3293,40 3265,72
1/4 7464,75 4065,00 3054,25 2600,06 1389,54
1/8 4803,11 2668,33 1989,21 738,082 183,825

1/16 2591,65 1818,28 539,035 91,4074 10,9609
1/32 2059,19 648,77 88,2487 7,24674 0,428289

Tabela 5.5: Valor do erro medido na norma em H 1!), considerando p = 1, p = 2, p = 3, p = 4 e
p = 5.



50 CAPÍTULO 5. PZ - AMBIENTE DE PROGRAMAÇÃO ORIENTADO A OBJETO

Taxa de convergência, $ . $H 1(!), µ =
log10(Erro1/Erro2)

log10 2

h1, h2 p = 1 p = 2 p = 3 p = 4 p = 5
1/2, 1/4 0,033484 0,781494 0,585707 0,341033 1,23279
1/4, 1/8 0,636125 0,610566 0,618623 1,816690 2,9182

1/8, 1/16 0,890098 0,550115 1,883740 3,013400 4,06789
1/16, 1/32 0,331794 1,486800 2,610730 3,656910 4,67764

Tabela 5.6: Taxas de convergências medidas na norma em H 1!), considerando p = 1, p = 2, p = 3,
p = 4 e p = 5.

Figura 5.7: Solução aproximada do problema 2D, usando refinamento uniforme com p = 5 e h =
1/32.



Capítulo 6

Adaptatividade Goal-Oriented

Neste capítulo, um dos focos principais deste trabalho, considera-se a estimativa do erro a pos-
teriori na qual o erro numérico da aproximação por elementos finitos é calculado em termos da
quantidade de interesse em vez da norma de energia. Estas quantidades de interesse são caracteri-
zadas por funcionais lineares no espaço de funções que contém as soluções. Também mostram-se
os conceitos de adaptividade "goal-oriented", [2, 21], a qual envolve adaptação da malha, procedi-
mento designado para controlar o erro em uma quantidade de interesse específica.

6.1 Introdução

O objeto de muitos cálculos por elementos finitos é a determinação de uma quantidade específica
dependendo da solução u, a qual é necessária para uma ou mais decisões particulares. Segundo
Oden e Ainsworth [2], o estimador para o erro medido na norma da energia pode ser utilizado para
estimar o erro da quantidade de interesse. Para desenvolver um sistema geral, é conveniente con-
siderar uma quantidade de interesse como um funcional linear limitado L : V # R em um espaço
V de funções de aproximação admissíveis para o problema considerado. O caminho mais simples
para estimar a quantidade de interesse L na solução exata u, dada a aproximação por elementos
finitos uh, é tomar L(u) 6 L(uh). A linearidade do funcional L significa que o erro na aproximação
da quantidade de interesse pode ser escrito na forma

L(u)'L(uh) = L(e) , (6.1)

em que e = u'uh é o erro na aproximação por elementos finitos.

51



52 CAPÍTULO 6. ADAPTATIVIDADE GOAL-ORIENTED

6.1.1 Exemplos de funcionais lineares limitados

Alguns exemplos de quantidade de interesse caracterizados em termos de funcionais lineares limi-
tados são descritos a seguir. Na aproximação por elementos finitos estes funcionais mostram-se
adequados para expressarem a quantidade de interesse, quando possível, na forma de uma integral
sobre o domínio !. Nesta seção, assume-se V = H 10 (!). Como primeiro exemplo de uma quanti-
dade de interesse pode-se citar a média da solução u sobre um subdomínio !s * !. E seu funcional
linear limitado correspondente é dado por:

L1(u) =
1

| !s |

#

!
.1(x)u(x)dx, (6.2)

em que .1(x) é igual a 1 se x + !s e 0 caso contrário, e | !s | define a área ou volume de !s.

Proposição 6.1 Sejam u + H 10 (!) e . + L
2(!). Então, o funcional linear L(u) =

:
! . u dx é limi-

tado em H 10 (!).

Prova: Como u + H 10 (!) e . + L
2(!) , então, pela desigualdade de Cauchy-Scwartz, tem-se:

| L(u) |=
""""
#

!
. u dx

"""" !$ . $L2(!)$ u $L2(!)! C $ u $H 1(!)

em que C =$ . $L2(!).

!

Sendo assim, L1(u) em (6.2) é um funcional linear limitado. Um outro exemplo aplica-se para
funções vetorias u + (H 10 (!)

d ) em que o interesse é sobre o fluxo através de $ !s * $ !, em que,
!s é uma sub-região do domínio. Assim o funcional será dado por:

L2(u) =
#

$ !s
u.nds =

#

!s
div(u)dx =

#

!
.2(x) div(u)dx, (6.3)

sendo .2(x) = 1 se x + !s e zero caso contrário. Este, também é um funcional linear limitado.
Existem outras quantidades de interesse, as quais não podem ser caracterizadas por um funci-

onal linear limitado. É o caso por exemplo do valor de uma função u + H 1(!) em um ponto do
domínio, cujo funcional é L(u) = u(x0). Na referência [2] mostra-se como esses casos podem ser
tratados.



6.2. ESTIMATIVA PARA O ERRO EM QUANTIDADE DE INTERESSE 53

6.2 Estimativa para o Erro em Quantidade de Interesse

Seja L + V / um funcional linear limitado em V , representando alguma quantidade de interesse
L(u). Tem-se por objetivo, estimar o erro % L na aproximação da quantidade de interesse L(uh), o
qual pode ser escrito como

% L = L(u)'L(uh) = L(u'uh) = L(e) . (6.4)

Uma maneira de estimar % L seria aproximar o erro e através de (4.24) e daí L(e) = % L. Mas, re-
solver o problema (4.24) é tão caro numericamente quanto o problema original. Uma aproximação
alternativa para L(e), encontrada em [21], é feita através de um problema adjunto, ou problema
dual, do problema primal. O problema primal representa o problema a ser resolvido, tal como o
problema modelo na forma (4.8).

Como a norma aqui associada ao espaço V é a norma de energia, por definição, a norma de L é:

$ L $V /= sup
v+V'{0}

| L(v) |
$ v $E

. (6.5)

De (6.5) segue que sup
v+V'{0}

| L(u) |
$ v $E

0
| L(e) |
$ e $E

, o que implica

| L(e) |!$ L $V /$ e $E . (6.6)

Esta fórmula indica um limite para o erro na quantidade de interesse em termos da norma de energia
do erro e. Pode-se assim, relacionar o erro na quantidade de interesse pelo erro na aproximação por
elementos finitos. É claro que (6.6) é de uso limitado em virtude de vários fatores, um dos quais é
não sabermos a norma do funcional linear limitado L.

Seja ' L + V o representador de Riesz do funcional linear limitado L, o qual é definido como a
solução única do problema: )

Encontrar ' L + V, tal que
B(v, ' L) = L(v) , ,v + V .

(6.7)

Esse problema é chamado problema adjunto, ou problema dual, do problema primal. O Teorema
de Lax-Milgram garante a existência e unicidade de ' L em V e, além disso, $ L $V /=$ ' L $E .
Portanto, de (6.6), tem-se

| L(e) |!$ ' L $E$ e $E . (6.8)

De acordo com Oden, [2], existem dois pontos negativos em relação ao limite (6.8). Primeiro,



54 CAPÍTULO 6. ADAPTATIVIDADE GOAL-ORIENTED

é requerido o conhecimento do valor exato de ' L. Segundo, o argumento geral que conduz à
(6.8) não traz nenhuma vantagem do fato que e é o erro na aproximação de Galerkin, e assim,
como consequência, a estimativa pode ser um tanto inadequada. Estas deficiências são tratadas nos
seguintes resultados:

Teorema 6.2 Seja uh + Vh a aproximação por elementos finitos da solução do problema primal:
)

Encontrar u + V, tal que
B(u, v) = F(v), ,v + V ,

em que B : V (V '# R é uma forma bilinear simétrica, contínua e coerciva e F : V '# R é uma
forma linear limitada. Seja L : V '# R um funcional linear limitado e defina ' L como a solução
do problema adjunto, )

Encontrar ' L + V, tal que
B(v, ' L) = L(v), ,v + V ,

(6.9)

Então, o erro na aproximação por elementos finitos da quantidade de interesse é dado por

L(e) = L(u)'L(uh) = B(e, eL) , (6.10)

sendo e = u'uh e eL = ' L '' Lh os erros na aproximação por elementos finitos de u e '
L, respec-

tivamente.

Prova: Escolhendo v = e em (6.9), tem-se L(e) = B(e, ' L) .
A propriedade de ortogonalidade de Galerkin implica que para todo 'h + Vh tem-se B(e, 'h) = 0.
Logo,

L(e) = B(e, ' L) = B(e, ' L)'B(e, 'h) = B(e, ' L ''h).

Seja 'h a aproximação por elementos finitos de ' L, definida pela solução do problema

'h + Vh : B(vh, 'h) = L(vh), ,vh + Vh.

Assim, tem-se
L(e) = B(e, ' L ''h) = B(e, eL) ,

como desejado.

!



6.3. APROXIMAÇÕES E LIMITES PARA ERRO L(E) 55

Este Teorema relaciona o erro na quantidade de interesse L em termos dos erros na aproximação
por elementos finitos da solução u e o representador de L, medido na norma energia. Disto segue
que qualquer dos estimadores para o erro medido na norma energia pode ser usado para estimar
o erro na quantidade de interesse. Assim, as conclusões do Teorema 6.2 justificam a atenção
considerável dada ao estimador do erro medido na norma energia.

6.3 Aproximações e Limites para Erro L(e)

Suponha que / seja um estimador a posteriori para o erro e no problema primal medido na norma
de energia. Analogamente, dado a aproximação por elementos finitos para o representador de Riesz
satisfazendo

' Lh + Vh : B('
L
h , vh) = L(vh), ,vh + Vh (6.11)

pode-se utilizar a mesma técnica para produzir o estimador a posteriori do erro eL = ' L '' Lh

$ eL $E! / L. (6.12)

O Teorema (6.2) mostra então que

| L(u)'L(uh) |=| B(e, eL) | ! $e$E$eL$E = / / L. (6.13)

De acordo com Oden e Ainsworth [2, 21] a desigualdade de Cauchy-Schawarz usada para
deduzir o limite (6.13) da fórmula exata (6.10) geralmente produz um péssimo limite. Assim em
vez disto, pode-se recorrer ao Teorema (6.3):

Teorema 6.3 Assumindo as definições do Teorema 6.2, e que a forma bilinear B seja simétrica
tem-se:

L(e) = B(e, eL) =
1
4
$ e + eL $2E '

1
4
$ e'eL $2E . (6.14)

Prova: Pela identidade do paralelogramo tem-se

$ e + eL $2E = B(e + e
L, e + eL) = B(e, e) + 2B(e, eL) + B(eL, eL)

e
$ e'eL $2E = B(e'e

L, e'eL) = B(e, e)'2B(e, eL) + B(eL, eL) .



56 CAPÍTULO 6. ADAPTATIVIDADE GOAL-ORIENTED

Combinando esses dois resultados, tem-se

$ e'eL $2E ' $ e + e
L $2E = '4B(e, e

L) ,

o que implica

B(e, eL) =
1
4
$ e + eL $2E '

1
4
$ e'eL $2E .

!

Agora, utilizando um escalar ! + R, uma nova versão de (6.14) é dada por, [2]:

B(e, eL) =
1
4
$ ! e +

1
!

eL $2E '
1
4
$ ! e'

1
!

eL $2E , ! -= 0. (6.15)

Com os resultados de (6.15) e pelo Teorema 6.2 tem-se uma representação exata do erro na quan-
tidade de interesse,

L(e) = L(u)'L(uh) =
1
4
$ ! e +

1
!

eL $2E '
1
4
$ ! e'

1
!

eL $2E . (6.16)

A equação (6.16) é o ponto chave para a derivação do limite superior (/ Lupp) e inferior (/ Llow) em
L(e). Assim, pode-se enunciar o seguinte Lema, de acordo com a referência [2]:

Lema 6.4 Seja ! uma constante real fixa, ! -= 0, e suponha que / +low, /
+
upp, /

'
low e /

'
upp satisfaçam

/ +low !$ ! e +
1
!

eL $e! / +upp (6.17)

e
/'low !$ ! e'

1
!

eL $e! /'upp. (6.18)

Então,

/ Llow =
1
4
(/ +low)

2 '
1
4
(/'upp)

2 ! L(u)'L(uh) !
1
4
(/ +upp)

2 '
1
4
(/'low)

2 = / Lupp, (6.19)

em que / +low, /
+
upp, /

'
low e /

'
upp denotam os estimadores de erros globais.

Este resultado mostra que o problema reduz-se à derivação de limites superiores e inferiores
sobre erros medidos na norma de energia. O valor de ! é escolhido de tal maneira que

$ ! e $E =$ eL/! $E .



6.4. CONTROLE ADAPTATIVO DO ERRO L(E): REFINAMENTO GOAL-ORIENTED 57

Assim,

$ ! e $e=$
eL

!
$e=

1
!
$ eL $E. ! 2 =

$ eL $E
$ e $E

,

ou seja,

! =

&gt;
$ eL $E
$ e $E

. (6.20)

Esta escolha de ! é justificada pelo fato de minimizar as quantidades $ ! e + e
L

! $
2
e e $ ! e'

eL
! $

2
e .

Uma outra alternativa para obter uma estimativa de L(e) na quantidade de interesse segue de
(6.10),

| L(e) |=| B(e, eL) |! %
K

| BK (e, eL) |! %
K
$ e $E,K$ eL $E,K , (6.21)

em que BK(., .) e $ . $E,K denotam, respectivamente, a restrinção de B(., .) e $ . $E sobre um ele-
mento K. Visto que as estimativas / e / L de $ e $E e $ eL $E , respectivamente, podem ser decom-
postas na norma de energia sobre o elemento K, define-se

% L = %
K

% LK 6 %
K

/K/ LK (6.22)

tal que
| L(e) |! %

K
$ e $E,K$ eL $E,K6 % L. (6.23)

em que % L é uma estimativa do erro L(e) na quantidade de interesse.

6.4 Controle Adaptativo do Erro L(e): Refinamento
Goal-Oriented

Tradicionalmente, os algoritmos de refinamento adaptativo são construídos a partir do controle do
erro medido na norma de energia. Controlando o erro global tem-se um efeito benéfico na exatidão
dos erros locais e do erros em quantidades de interesse. No entanto, se tratarmos somente certas
quantidades específicas, a aproximação por adaptatividade baseada no erro global pode resultar em
uma resolução adaptativa extensiva e desnecessária, de características da solução que têm pouca
relação na precisão da quantidade de interesse, [2]. A disponibilidade de estimativas computá-
veis para erros na quantidade específica de interesse, torna-se possível construir os esquemas de
refinamento adaptativos designados a atingir o erro diretamente na quantidade de interesse, [21].
A adaptatividade goal-oriented resulta na redução do custo computacional, visto que somente as



58 CAPÍTULO 6. ADAPTATIVIDADE GOAL-ORIENTED

características da solução que afetam fortemente a quantidade de interesse são resolvidas. Segue
abaixo uma estratégia do refinamento adaptativo goal-oriented designado a produzir uma aproxi-
mação da quantidade de interesse L para um erro relativo de tolerância +tol , ([2], [21]):

1. Construir uma partição inicial Th do domínio ! e um subespaço de elementos finitos inicial
Vh;

2. Calcular a aproximação de elementos finitos uh + Vh e aproximar a quantidade de interesse
por L(uh);

3. Calcular os limitantes superiores e inferiores do erro na quantidade de interesse ;

4. Observar se o erro relativo é menor do que a tolerância +tol dada. O processo iterativo termina
se a tolerância é alcançada;

5. Se a tolerância não for satisfeita a malha dos elementos é adaptada, para reduzir os efeitos
das fontes de erro, e retornar ao passo 2.

A malha será adaptada sempre que o estimador para o erro relativo exceder a tolerância +tol , isto é,

erel =
| L(e) |
| L(u) |

6
| % L |

| L(uh) |
0 +tol , (6.24)

em que endo % L uma estimativa do erro L(e) na quantidade de interesse, equação (6.23). O objetivo
na adaptação de malhas é refinar os elementos que mais contribuem para a quantidade L(e). Isto
é possível pela decomposição da estimativa global % L em contribuições dos elementos individuais,
equação (6.22), em que

% L = %
K

% LK = %
K

/K/ LK . (6.25)

Sendo /K e / LK os respectivos indicadores locais dos erros e e e
L medidos na norma de energia

sobre o elemento K. De acordo com [2], um elemento K da malha será refinado se

% LK 0 +ad p maxj
(% Lj ), (6.26)

em que +ad p é um parâmetro definido entre 0 e 1. Ou ainda, pode-se utilizar o seguinte critério: o
elemento K será refinado se

% LK 0 0, 3 maxj
(% Lj ). (6.27)



6.5. EXEMPLO 59

6.5 Exemplo

O objetivo nesse exemplo é mostrar numericamente que a ordem da taxa de convergência do erro,
medida pelo funcional linear limitado, é igual a duas vezes a ordem de convergência medida na
norma da energia, [2, 16]. Para isto, seguem-se todos os passos do Teorema 6.2. Na resolução
numérica dos problemas, primal e dual, utilizam-se os espaços de elementos finitos de Lagrange
em 1D, das fuções lineares e quadráticas.

6.5.1 Construção do Problema Dual

Considere o problema primal:
)
'u//(x) + u(x) = x, ,x + ! = (0, 1),
u(0) = 0 e u(1) = 0.

A formulação variacional deste problema consiste em encontrar u + H 10 (!), tal que
*
+

,

# 1

0
{u/(x)v/(x) + u(x)v(x)} dx =

: 1
0 x v(x) dx,

,v + H 10 (!).

Usando as fórmulas bilinear e linear, tem-se,

B(u, v) =
# 1

0

8
u/(x)v/(x) + u(x)v(x)

9
dx e F(v) =

# 1

0
x v(x) dx . (6.28)

Desta maneira o problema primal é dado por: Encontrar u + H 10 (!), tal que

B(u, v) = F(v), ,v + H 10 (!).

O funcional linear limitado L(u) representará a média da solução, sobre o subdomínio !s = [1/2, 3/4] *
!, ou seja,

L(u) =
1

| !s |

# 1

0
.(x)u(x) dx , (6.29)

em que

.(x) =

)
1 se x + !s
0 se x /+ !s

(6.30)



60 CAPÍTULO 6. ADAPTATIVIDADE GOAL-ORIENTED

0.2 0.4 0.6 0.8 1.0

0.01

0.02

0.03

0.04

0.05

Solução Exata do Problema Primal

0.2 0.4 0.6 0.8 1.0

0.02

0.04

0.06

0.08

0.10

Solução Exata do Problema Dual

Figura 6.1: Solução exata do problema primal e dual.

com . + L2(!). Sendo assim, o problema dual é dado por : Encontrar ' , tal que
*
+

,
''//(x) + '(x) =

1
| !s |

.(x), , x + !

'(0) = 0 e '(1) = 0
,

sendo . dado pela equação (6.30). A fomulação variacional do problema dual reduz-se a encontrar
' + H 10 (!), tal que

# 1

0

8
v/(x)'/(x) + v(x)'(x)

9
dx =

1
| !s |

# 1

0
.(x)v(x) dx , ,v + H 10 (!).

Ou seja, encontrar ' + H 10 (!), tal que

B(v, ') = L(v), ,v + H 10 (!).

6.5.2 Solução Numérica

A solução exata do problema primal e do problema dual, Figura 6.1, são dadas por, respectivamente:

u(x) = x'
senh(x)
senh(1)

e

'(x) = 1'
ex + e1'x

1 + e
.

O valor exato do funcional linear limitado é L(u) = 0, 0563916. As Figuras 6.2 e 6.3 mostram os
gráficos das soluções aproximadas do problemas primal e dual. Os parâmetros p e h representam



6.5. EXEMPLO 61

0.2 0.4 0.6 0.8 1.0

0.01
0.02
0.03
0.04
0.05

Aproximada
Primal

0.2 0.4 0.6 0.8 1.0

0.01
0.02
0.03
0.04
0.05

Aproximada
Primal

0.2 0.4 0.6 0.8 1.0

0.01
0.02
0.03
0.04
0.05

Aproximada
Primal

0.2 0.4 0.6 0.8 1.0

0.01
0.02
0.03
0.04
0.05

Aproximada
Primal

0.2 0.4 0.6 0.8 1.0

0.02
0.04
0.06
0.08
0.10

Aproximada
Dual

0.2 0.4 0.6 0.8 1.0

0.02
0.04
0.06
0.08
0.10

Aproximada
Dual

0.2 0.4 0.6 0.8 1.0

0.02
0.04
0.06
0.08
0.10

Aproximada
Dual

0.2 0.4 0.6 0.8 1.0

0.02
0.04
0.06
0.08
0.10

Aproximada
Dual

Figura 6.2: Solução aproximada do problema Primal e Dual, com p = 1, para h = 1/2, h = 1/4,
h = 1/8, h = 1/16, respectivamente.

o grau da função polinomial e o espaçamento de cada partição do domínio, respectivamente. Ana-
logamente, as Tabelas 6.1 e 6.2 mostram os valores dos erros, medidos na norma da energia, na
aproximação da solução e suas respectivas taxas de convergência.

Os valores dos erros para o problema primal e dual, respectivamente, são dados por:

$ e $E =$ u'uh $E = [B(u'uh , u'uh)]
1/2

e
$ eL $E =$ ' ''h $E = [B(' ''h , ' ''h)]

1/2 .

Portanto, através do Teorema 3.1, o erro em aproximar a quantidade de interesse pelo funcional
linear limitado é dado por:

% L = L(e) = L(u'uh) = B(e, eL).



62 CAPÍTULO 6. ADAPTATIVIDADE GOAL-ORIENTED

0.2 0.4 0.6 0.8 1.0

0.01
0.02
0.03
0.04
0.05
0.06

Aproximada
Primal

0.2 0.4 0.6 0.8 1.0

0.01
0.02
0.03
0.04
0.05

Aproximada
Primal

0.2 0.4 0.6 0.8 1.0

0.01
0.02
0.03
0.04
0.05

Aproximada
Primal

0.2 0.4 0.6 0.8 1.0

0.01
0.02
0.03
0.04
0.05

Aproximada
Primal

0.2 0.4 0.6 0.8 1.0

0.02
0.04
0.06
0.08
0.10

Aproximada
Dual

0.2 0.4 0.6 0.8 1.0

0.02
0.04
0.06
0.08
0.10

Aproximada
Dual

0.2 0.4 0.6 0.8 1.0

0.02
0.04
0.06
0.08
0.10

Aproximada
Dual

0.2 0.4 0.6 0.8 1.0

0.02
0.04
0.06
0.08
0.10

Aproximada
Dual

Figura 6.3: Solução aproximada do problema Primal e Dual, com p = 2, para h = 1/2, h = 1/4,
h = 1/8, h = 1/16, respectivamente.

Problema primal
Valor do erro Taxa de convergência

h p = 1 p = 2 p = 1 p = 2
1/2 0, 07664840 0, 00935090 - -
1/4 0, 03895630 0, 00234740 0, 97639902 1, 99404052
1/8 0, 01955600 0, 00058748 0, 99124535 1, 99846433

1/16 0, 00978767 0, 00014690 0, 99857639 1, 99961450
1/32 0, 00489504 0, 00003672 0, 99964481 1, 99990180
1/64 0, 00244767 0, 00000918 0, 99991158 1, 99997879

Tabela 6.1: Valor do erro, medido na norma da energia e taxa de convergência para o problema
primal.



6.6. PROBLEMA DUAL NA APROXIMAÇÃO DO FLUXO 63

Problema dual
Valor do erro Taxa de convergência

h p = 1 p = 2 p = 1 p = 2
1/2 0, 13443700 0, 00213359 - -
1/4 0, 06686100 0, 00059262 1, 00769 1, 8481
1/8 0, 03338690 0, 00011681 1, 00188 1, 96607

1/16 0, 01668810 0, 00003813 1, 00046 1, 99174
1/32 0, 00834336 0, 00000957 1, 00012 1, 99464
1/64 0, 00417159 0, 00000239 1, 00003 2, 00154

Tabela 6.2: Valor do erro, medido na norma da energia e taxa de convergência para o problema
dual.

Funcional linear limitado
Valor do erro Taxa de convergência

h p = 1 p = 2 p = 1 p = 2
1/2 0, 0090366900 2, 2761(10'6 - -
1/4 0, 0022351900 1, 7560(10'7 2, 0153969610 3, 6961909778
1/8 0, 0005573440 1, 1504(10'8 2, 0037575135 3, 9321562800

1/16 0, 0001392460 7, 2726(10'10 2, 0009321676 3, 9834657714
1/32 0, 0000348058 4, 5589(10'11 2, 0002362447 3, 9957182832
1/64 0, 0000087011 2, 6099(10'12 2, 0000580309 4, 1266011426

Tabela 6.3: Valor do erro e taxa de convergência no funcional linear limitado L(u), com p = 1 e
p = 2.

A Tabela 6.3 mostra o valor do erro, % L, e sua taxa de convergência em p = 1 e p = 2, a qual
está de acordo com as referências citadas. A Figura 6.4 mostra o gráfico log-log dessa taxa de
convergência.

6.6 Problema Dual na Aproximação do Fluxo

Nessa seção considera-se um exemplo bidimensional para avaliar o comportamento da solução
do problema dual, quando a quantidade de interesse representa o fluxo saindo por uma região do
contorno $ !. Onde conclue-se que a solução do problema dual apresenta sigularidades na região
de interesse, tornando-se este um processo caro na estimativa do erro na aproximação da quantidade
de interesse. Na resolução numérica do problema utilizam-se os espaços de elementos finitos de
Lagrange em 2D, associados aos elementos retangulares de Lagrange de grau p = 6.

Considera-se o problema primal dado pelo problema



64 CAPÍTULO 6. ADAPTATIVIDADE GOAL-ORIENTED

1
1

1
1

1
1

2

2

2

2

2

2

!1.5 !1.0 !0.5
!12

!10

!8

!6

!4

!2

log h

lo
g
er
ro

Figura 6.4: Convergência do erro no funcional linear limitado L(u), usando funções de Lagrange
de grau p = 1 (1) e p = 2 (2).

*
7+

7,

'"u = 0 em !
u = gD em &amp;amp;D
u = gN em &amp;amp;N

com gD + L2(&amp;amp;D) e gN + L2(&amp;amp;N ), sendo ! = (0, 1) ( (0, 1), &amp;amp;D = {(0, y) 7 (1, y), y + (0, 1)}
e &amp;amp;N = $ ! ' &amp;amp;D. A quantidade de interesse representa o valor do fluxo saindo pela fronteira
&amp;amp;0 = {(1, y), y + (0, 1)} * &amp;amp;D,

L(v) =
#

&amp;amp;0

$ v
$ n

ds .

O problema dual é dado por
*
7777+

7777,

'"' = 0 em !
' = 1 em &amp;amp;0
' = 0 em &amp;amp;D '&amp;amp;0
$ '/$ n = 0 em &amp;amp;N .

6.6.1 Resultados Numéricos e Comentários

As Figuras 6.5 e 6.6 mostram as soluções aproximadas do problema dual, considerando um espaço
de aproximação formado por funções polinomiais biquadráticas, com o domínio particionado uni-
formemente nos eixos x e y. Denotam-se por Nx e Ny os números de divisões dos eixos x e y,
respectivamente.

Na Figura 6.5 mostram-se as soluções aproximadas do problema dual considerando Nx = Ny =
4 (gráfico à esquerda) e Nx = Ny = 8 (gráfico à direita). Analogamente, na Figura 6.6 mostram-



6.6. PROBLEMA DUAL NA APROXIMAÇÃO DO FLUXO 65

se as soluções aproximadas do problema dual, considerando Nx = Ny = 16 (gráfico à esquerda),
Nx = Ny = 32 (gráfico à direita).

Figura 6.5: Solução aproximada do problema dual considerando Nx = Ny = 4 (à esquerda) e Nx =
Ny = 8 (à direita) .

Figura 6.6: Solução aproximada do problema dual considerando Nx = Ny = 16 (à esquerda) e
Nx = Ny = 32 (à direita).



66 CAPÍTULO 6. ADAPTATIVIDADE GOAL-ORIENTED

Observa-se que a solução do problema dual sempre apresenta singularidades na região de in-
teresse. Desta forma, conclue-se que o método de estimativa para erro em quantidade de interesse
através da adaptatividade goal oriented torna-se um processo caro e não vantajoso para esse caso.



Capítulo 7

O Método da Função de Extração

Neste capítulo apresenta-se um método, visto em [3, 4, 5], para o pós-processamento da solução, de
elementos finitos, com objetivo de obter uma alta precisão da aproximação de certas quantidades de
interesse L(u). A idéia consiste em utilizar um funcional auxiliar !L, coincidindo com L na solução
do problema, que permita melhor taxa de convergência. Apresentam-se exemplos da aplicação do
método em problemas bidimensionais de escoamento monofásico de fluidos em meios porosos, em
que a quantidade de interesse representa o fluxo sobre uma sub-região do contorno.

7.1 Forma Generalizada para L(u)

Como no Capítulo 6, denota-se por L(u) a quantidade de interesse que se deseja determinar sobre
a solução u do problema em questão.

Definição 7.1 (Forma Generalizada para L) Um funcional linear limitado !L é uma forma gene-
ralizada de L se

L(u) = !L(u)

em que u é a solução do problema de valor de contorno (4.1)-(4.2).

Quando !L(u) tiver a forma
!L(u) =

#

!
T (u)0 dA + R , (7.1)

essa é conhecida como a expressão de extração para L(u), a função 0 é chamada de função de
extração e R de termo de carga. T é uma transformação linear e pode, por exemplo, ter a forma
T (u) = u ou T (u) = #u, de acordo com a quantidade de interesse a ser tratada. Nas próximas
seções são apresentados alguns exemplos relacionados à escolha de !L.

67



68 CAPÍTULO 7. O MÉTODO DA FUNÇÃO DE EXTRAÇÃO

De acordo com [3], sugere-se um método de aproximação para !L(u). Se uh é uma aproximação
de u pelo método dos elementos finitos da solução do problema, então, pode-se aproximar !L(u) por
!L(uh). A diferença entre !L(u) e !L(uh) é dada por

e = !L(u)'!L(uh) (7.2)

A escolha de !L afeta a magnitude dessa diferença. Por exemplo, na expressão de extração (7.1),
uma boa escolha da 0 é uma característica importante de uma implementação bem sucedida de
!L(uh).

7.1.1 Exemplo

Considere o problema modelo de valor de contorno:

'"u = f em ! (7.3)

sujeito à condição de contorno de Dirichlet

u = 0 em $ ! , (7.4)

em que f + L2(!). Suponha uma quantidade de interesse L(u) e uma forma generalizada na forma
de extração em que T (u) = u. Nesse exemplo mostra-se a necessidade de termos uma função
0 suave na precisão da aproximação !L(uh). Considere um modelo de elementos finitos para o
problema modelo (7.3)-(7.4), em que a solução uh satisfaz

B(uh, v) = F(v) , v + V, (7.5)

sendo V o espaço de elementos finitos de funções adimissíveis, B(·,·) dada por

B(u, u) =
#

!
(#u · #u)dA ,,u + V

e F(·) por
F(v) =

#

!
( f v)dA , ,v + V.

Pela propriedade da ortogonalidade do erro, tem-se

B(u'uh, v) =
#

!
(#(u'uh) · #v)dA = 0 (7.6)



7.1. FORMA GENERALIZADA PARA L(U ) 69

para todo v + V . A norma da energia proveniente do produto interno B(·,·) é dada por

$ u $B= (E(u))1/2 ,

com
E(u) =

#

!

%
#(u)2

&amp;amp;
dA.

Desta forma, pelo fato de u? ser a solução por elementos finitos, a estimatima do erro por elementos
finitos pode ser escrita como

E(u'uh) ! min
v4+V

E(u'v4) . (7.7)

Seja 1 uma função auxiliar tal que
)

"1 = '0 em !,
1 = 0 em $ !.

(7.8)

Multiplicando por w e integrando por partes, tem-se
#

!
(#1 · #w)dA =

#

!
(0 w)dA (7.9)

para toda função w satisfazendo as condições de contorno em (7.4) e com E(w) a norma energia
associada ao problema auxiliar. Tomando w = u'uh em (7.9), chega-se na seguinte estimativa para
o erro:

e = !L(u)'!L(uh) =
#

!
(0 w)dA

=
#

!
(#1 · #w)dA =

#

!
(#1 · #(u'uh))dA.

(7.10)

Subtraindo-se (7.6) de (7.10), resulta que

!L(u)'!L(uh) =
#

!
((#(u'uh) · #(1 'v))dA ,

para todo v + V . Assim, tomando o mínimo sobre todo v + V e por (7.7), tem-se

| !L(u)'!L(uh) | ! min
v+V

|
?#

!
((#(u'uh) · #(1 'v))dA

@
|

! min
v+V

|
A

E(u'uh)1/2E(1 'v)1/2
B

|

= min
v4+V

A
E(u'v4)1/2

B
min
v+V

A
E(1 'v)1/2

B
.

(7.11)

Portanto, pode-se dizer que o erro em !L(u) é limitado pelo produto entre a norma energia da dife-



70 CAPÍTULO 7. O MÉTODO DA FUNÇÃO DE EXTRAÇÃO

?

x

y

(?1,0)

(?1,1) (1,1)

(1,0)

?1 ?2

Figura 7.1: Representação do domínio computacional !.

rença de u pela sua melhor aproximação em V e a norma energia da diferença de 1 e sua melhor
aproximação em V . Isso mostra a importância da função de extração ser suave, pois uma função 0
suave garante uma função 1 suave e essa será melhor aproximada pelas funções em V , reduzindo
o erro em !L(u).

7.2 Caso de Interesse (fluxo monofásico em meios porosos)

Nesta seção mostra-se como construir uma função de extração 0 e assim determinar uma expressão
para as quantidades de interesse L(u), representadas pelo valor do fluxo de fluido saindo por uma
sub-região $ !s do contorno. Para isso, será considerado um problema de valor de contorno em
duas dimensões.

7.2.1 Formulação do Problema

O modelo matemático a ser tratado é o escoamento monofásico de fluidos incompressíveis e de
regime de fluxo permanente em meios porosos, tendo como objetivo aplicações na simulação de
reservatórios de petróleo. No regime permanente de fluxo significa que o meio poroso ! * R2,
Figura 7.1, recebe uma alimentação externa contínua de tal maneira que o fluido produzido através
do poço é reposto simultaneamente através da fronteira externa. Devido a essa alimentação, a vazão
permanece constante no espaço e no tempo. Devido à alimentação externa, a pressão também não
varia com o tempo.



7.2. CASO DE INTERESSE (FLUXO MONOFÁSICO EM MEIOS POROSOS) 71

A equação diferencial do modelo é dada por

*
+

,

'div(!v) = 0 em !

!v = '
1
µ
"#
K #u

(7.12)

• Sendo
"#
K o tensor das permeabilidades

"#
K =

C
kx 0
0 ky

D
,

em que, kx e ky são as permeabilidades nas direções x e y, respectivamente, com kx e ky &gt; 0
e constantes;

• µ &gt; 0 é a viscosidade do fluido, µ constante.

Nos contornos do domínio pode-se aplicar condições de contorno tipo Dirichlet ou tipo Neumann.
A condição de contorno tipo Dirichlet define o valor da pressão do fluido nos limites do reservatório
e a condição de Neumann define o valor do fluxo (vazão) que entra ou sai do reservatório através
de seus limites.

Quando o meio poroso for isotrópico, isto é k = kx = ky, o problema (7.12) é representado pela
equação de Laplace

'"u = 0 . (7.13)

A partir da teoria apresentada nas seções anteriores, considera-se como quantidade de interesse
o fluxo total que sai por uma região do contorno,

L(u) = '
#

$ !s

;
1
µ

(
"#
K #u) ·!n

&lt;
ds,

em que !n é a normal externa a $ !s.

7.2.2 Formas Generalizadas !L(u)

Como demonstração prática da construção da forma generalizada !L(u), considera-se o problema
(7.12) no caso em que o meio poroso é isotrópico. Dessa forma, o problema é dado por:

'"u = 0 , (7.14)



72 CAPÍTULO 7. O MÉTODO DA FUNÇÃO DE EXTRAÇÃO

!1.0 !0.5 0.0 0.5 1.0
0.0

0.5

1.0

1.5

2.0

2.5

3.0

Figura 7.2: Gráfico da derivada parcial
$ u
$!n

(x, 0) , x = ['1, 1].

com a condição de contorno

*
7+

7,

u = 0 em &amp;amp;2 = (0, 1]({0}
#u ·!n = 0 em &amp;amp;1 = ['1, 0]({0}
u = f em $ !'{&amp;amp;1 7 &amp;amp;2}

(7.15)

em que f = r1/2 sin(2 /2), com r =
$

x2 + y2 e 2 = arctan(y/x), e !n é a normal unitária externa à
&amp;amp;2. Esse problema possui solução analítica

u = r1/2 sin(2 /2) . (7.16)

A Figura 7.2 mostra o gráfico da derivada direcional $ u/$!n, !n = {0,'1}, na região ['1, 1]({0},
a qual apresenta uma singularidade quando x se aproxima de zero pela direida, x '# 0+.

A quantidade de interesse é escrita como:

L(u) = '
#

$ !s
(#u ·!n) ds,

em que $ !s * &amp;amp;2 e !n é a normal externa a $ !s. Consideram-se três modelos para a forma genera-
lizada !L(u) da quantidade de interesse.

Modelo 1:

Seja " uma função geradora, suave em !, que satisfaça
)

" = '1 em $ !s * &amp;amp;2
" = 0 em $ !'$ !s .

(7.17)



7.2. CASO DE INTERESSE (FLUXO MONOFÁSICO EM MEIOS POROSOS) 73

Pela Fórmula de Green, Apêndice B.6, tem-se

#

$ !
(" #u ·!n) ds =

#

!
div (" #u) dA =

#

!
(#u · #") dA +

#

!
(" "u) dA .

Uma vez que "u = 0 e pelas condições em " , resulta que

#

$ !s
('#u ·!n) ds =

#

!
(#u · #") dA .

Ou seja, definindo
!L(u) = '

#

$ !s
(#u ·!n) ds =

#

!
(#u · #") dA , (7.18)

tem-se que !L(u) é uma forma generalizada para L(u).

A fórmula (7.18) está na forma de extração (7.1), com T (u) = #u, função de extração 0 = #"
e termo de carga nulo, R = 0. Sendo assim, a expressão de extração nos leva a aproximar !L(u) por

!L(uh) =
#

!
(#uh · #") dA

em que uh é uma aproximação por elementos finitos de u. A precisão da aproximação !L(uh) de-
pende da suavidade da função geradora " .

Existem muitas maneiras de se construir uma função geradora suave que satisfaça a condição
(7.17). Pode-se, por exemplo, construir uma função " com essas propriedades utilizando o método
dos elementos finitos para resolver o seguinte problema:

*
7+

7,

"" = 0 em !
" = g(s) em &amp;amp;1 7&amp;amp;2
" = 0 em $ !'{&amp;amp;1 7&amp;amp;2}

(7.19)

sendo g uma função suave em &amp;amp;1 7&amp;amp;2, tal que g(s) = '1 em s + $ !s e g tende, suavemente, a zero
para s + {&amp;amp;1 7&amp;amp;2}'$ !s. Por exemplo, $ !s = [x1, x2]({0}, pode escrever g como:

g(s) =

*
7777+

7777,

'
(% + 2x1 '2s)(% 'x1 + s)2

% 3
se x1 '% ! s &amp;lt;x1

'1 se x1 ! s ! x2

'
(% + x2 's)2(% '2x2 + 2s)

% 3
se x2 &amp;lt;s ! x2 + % .

(7.20)

A Figura 7.3 mostra o gráfico para a função g(s), com $ !s = [0, 1/2]({0} e % = 0, 25.



74 CAPÍTULO 7. O MÉTODO DA FUNÇÃO DE EXTRAÇÃO

!1.0 !0.5 0.0 0.5 1.0
!1.0

!0.8

!0.6

!0.4

!0.2

0.0
g!s"

Figura 7.3: Exemplo de uma função g(s) para o problema auxiliar.

Modelo 2

Seja " uma função geradora, suave em !, que satisfaça
*
7+

7,

"" = 0
" = '1 em $ !s * &amp;amp;2
" = 0 em &amp;amp;2 '$ !s

(7.21)

De forma análoga ao Modelo 1, tem-se

#

$ !
(" #u ·!n) ds =

#

!
(#u · #") dA.

Assim,
#

&amp;amp;1
(" #u ·!n) ds +

#

&amp;amp;2
(" #u ·!n) ds +

#

$ !'{&amp;amp;17&amp;amp;2}
(" #u ·!n) ds =

#

!
(#u · #") dA.

Pelas condições em " e u, Equações (7.21) e (7.15) respectivamente, resulta que

#

$ !s
('#u ·!n) ds =

#

!
(#u · #") dA'

#

$ !'{&amp;amp;17&amp;amp;2}
(" #u ·!n) ds.

Ou seja, definindo

!L(u) =
#

!
(#u · #") dA'

#

$ !'{&amp;amp;17&amp;amp;2}
(" #u ·!n) ds (7.22)

tem-se que !L(u) é uma forma generalizada para L(u), que está na forma de extração (7.1), com



7.2. CASO DE INTERESSE (FLUXO MONOFÁSICO EM MEIOS POROSOS) 75

!!x, y"

"1.0

"0.5

0.0

0.5

1.0
0.0

0.5

1.0

"1.0

"0.5

0.0

!1.0 !0.5 0.0 0.5 1.0
!1.0

!0.8

!0.6

!0.4

!0.2

0.0

"!x, 0"

Figura 7.4: Gráficos da função " considerando $ !s = [1/4, 1/2]({0}.

T (u) = #u, função de extração 0 = #" e termo de carga

R = '
#

$ !'{&amp;amp;17&amp;amp;2}
(" #u ·!n) ds,

que agora depende de u.

Sendo assim, o método da função de extração nos leva a aproximar !L(u) por

!L(uh) =
#

!
(#uh · #") dA'

#

$ !'{&amp;amp;17&amp;amp;2}
(" #uh ·!n) ds ,

em que uh é uma aproximação por elementos finitos de u.

Tem-se que a função geradora " tem a seguinte expressão analítica:

"(x, y) =
1
3

-
arctan

;
x'x2

y

&lt;
'arctan

;
x'x1

y

&lt;.
. (7.23)

Considerando, por exemplo, $ !s = [1/4, 1/2]({0} a Figura 7.4 mostra os gráficos de "(x, y) e
"(x, 0) com x, y + !.

Modelo 3

Considera-se a mesma função " do Modelo 2, tem-se
#

$ !
(u#" ·!n) ds =

#

!
(#u · #") dA.



76 CAPÍTULO 7. O MÉTODO DA FUNÇÃO DE EXTRAÇÃO

Portanto, substituindo em (7.22), tem-se que

!L(u) =
#

$ !'&amp;amp;2
(u#" ·!n) ds'

#

$ !'{&amp;amp;17&amp;amp;2}
(" #u ·!n) ds (7.24)

é uma forma generalizada para a quantidade L(u).

7.2.3 Testes de Validação

Como uma demonstração prática do método descrito, nesta seção considera-se o resultado numé-
rico pelo MEF para o problema (7.14)-(7.15). Serão utilizadas as formas generalizadas para L(u)
definidas pelos Modelos 1, 2 e 3, Equações (7.18) e (7.22) e (7.24). Os resultados obtidos serão
usados para validar o programa computacional desenvolvido e, também, comparar os resultados
das taxas de convergência do erro, através do gráfico log-log, na aproximação da quantidade de
interesse pelo Método Direto e pelo método da função de extração.

Na resolução numérica do problema utilizam-se os espaços de elementos finitos de Lagrange
retangulares como espaços de funções aproximantes. O parâmetro p representa o grau das funções
de base de Lagrange unidimensionais, utilizadas no produto tensorial para construção dos espaços
de elementos finitos de Lagrange em 2D. Definem-se por Nx e Ny os números de intervalos da
partição nos eixos x e y do domínio, respectivamente.

Define-se como método direto a aproximação da quantidade de interesse L(u) pela forma geral,
isto

L(uh) = '
#

$ !s
(#uh ·!n) ds, (7.25)

em que u? é a solução aproximada, pelo método dos elementos finitos, do problema (7.14)-(7.15).
Serão consideradas dois casos para a sub-região $ !s * &amp;amp;2:

$ !s1 = [0, 1/4]({0} e $ !s2 = [1/2, 3/4]({0}.

Resultados Obtidos Usando u e " Analíticas

Utiliza-se a função u, solução analítica do problema (7.14)-(7.15), calculam-se os valores da quan-
tidade de interesse escrita nas formas generalizadas, Equações (7.22) e (7.24), e pelo método direto,
Equação (7.25), no programa computacional desenvolvido, sendo " dada pela equação (7.23). O
objetivo aqui é validar o programa, através do cálculo do erro na regra de integração em cada par-
tição do domínio. Nas Tabelas 7.1 e 7.2 mostram-se os valores do erro em porcentagem para cada
Nx, com Nx = Ny, na qual observa-se que os erros na regra de integração não serão significantes



7.2. CASO DE INTERESSE (FLUXO MONOFÁSICO EM MEIOS POROSOS) 77

Valor exato do fluxo 0,5
Nx, Ny Método Direto D(%) Modelo 3 D(%) Modelo 2 D(%)

1 0, 5063438955 0,12 0, 4864646065 2,70 0, 508716033 1,74
2 0, 4851052787 2,97 0, 4904344812 1,91 0, 4860982089 2,78
4 0, 489381386 2,12 0, 4932380723 1,35 0, 4899959596 2,00
8 0, 4924915061 1,50 0, 4952192703 0,95 0, 4929252625 1,41

16 0, 494690693 1,06 0, 496619752 0,67 0, 4949971164 1,00
32 0, 496245753 0,75 0, 497609888 0,47 0, 4964623248 0,70

Tabela 7.1: Erros na regra de integração no cálculo do fluxo na região $ !s1 = [0, 1/4]({0} usando
u e " analíticas.

Valor exato do fluxo 0, 158918623
Nx, Ny Método Direto D(%) Modelo 3 D(%) Modelo 2 D(%)

1 0,14251276 10, 32 0,15892118 1, 6(10'3 0,14139314 11, 03
2 0,15894221 1(10'2 0,15891952 5, 6(10'4 0,15896469 3(10'2

4 0,15891862 2, 5(10'7 0,15891894 2(10'4 0,15891824 2, 4(10'4

8 0,15891862 2, 5(10'7 0,15891873 7(10'5 0,15891849 8, 6(10'5

16 0,15891862 2, 5(10'7 0,15891866 2, 5(10'5 0,15891857 3, 1(10'5

32 0,15891862 2, 5(10'7 0,15891864 8, 5(10'6 0,15891861 1, 1(10'5

Tabela 7.2: Erros na regra de integração no cálculo do fluxo no região $ !s2 = [1/2, 3/4] ({0},
usando u e " analíticas.

na qualidade da aproximação numérica.



78 CAPÍTULO 7. O MÉTODO DA FUNÇÃO DE EXTRAÇÃO

Método Direto
Nx, Ny P = 1 P = 2 P = 3 P = 4

1 0,18427701 0,29431677 0,36232310 0,39963821
2 0,22012398 0,32836280 0,37903913 0,40590313
4 0,27387358 0,37154584 0,41442253 0,43255391
8 0,32338454 0,40898757 0,43754887 0,45128448

16 0,36716683 0,43474567 0,45486901 0,46491844
32 0,40240992 0,45313692 0,46757379 0,47487530

Método da Extração: Modelo 3
Nx, Ny P = 1 P = 2 P = 3 P = 4

1 0,29179224 0,33887436 0,37227083 0,39463369
2 0,32434877 0,37275331 0,40227655 0,42053099
4 0,35600581 0,40267866 0,42691062 0,44133433
8 0,38721020 0,42730877 0,44628399 0,45726493
16 0,41433215 0,44661058 0,46098719 0,46914939
32 0,43633028 0,46123823 0,47189408 0,47786677

Método da Extração: Modelo 2
Nx, Ny P = 1 P = 2 P = 3 P = 4

1 0,32095241 0,36613846 0,40111339 0,42298012
2 0,32437789 0,37308143 0,40260106 0,42082976
4 0,35603736 0,40273369 0,42698544 0,44142454
8 0,38723203 0,42734749 0,44633679 0,45732865
16 0,41434749 0,44663791 0,46102449 0,46919442
32 0,43634109 0,46125754 0,47192044 0,47789860

Tabela 7.3: Valores aproximados do fluxo na região $ !s1 = [0, 1/4] ( {0}, pelo método direto,
modelo 2 e modelo 3.

Resultados Obtidos Usando u? e "

Usa-se a função u?, solução aproxima do problema (7.14)-(7.15), nas formas generalizadas, Equa-
ções (7.22) e (7.24), e a função " é dada pela equação (7.23). As Tabelas 7.3 e 7.4 mostram os
valores aproximados do fluxo nas regiões $ !s1 = [0, 1/4]({0} e $ !s2 = [1/2, 3/4]({0}, consi-
derando a aproximação pelo Método Direto, Equação (7.25), e pelo Método da função de Extração
com a forma generalizada do Modelo 2, Equações (7.22) e Modelo 3, Equação (7.24).

As Figuras 7.5 e 7.6 mostram os gráficos log-log do erro, em porcentagem, na aproximação do
fluxo em cada sub-região $ !s * &amp;amp;2. Utilizam-se as seguintes notações para os gráficos:

• MD: Cálculo do fluxo pelo Método Direto, Equação (7.25);



7.2. CASO DE INTERESSE (FLUXO MONOFÁSICO EM MEIOS POROSOS) 79

Método Direto
Nx, Ny P = 1 P = 2 P = 3 P = 4

1 0,1202887008 0,1396161552 0,1421232238 0,1469384836
2 0,1452484308 0,1627236871 0,1579792940 0,1587969690
4 0,1530835717 0,1594906628 0,1585254551 0,1586198512
8 0,1565255332 0,1588443256 0,1586854091 0,1587716701

16 0,1579292517 0,1587859522 0,1587994036 0,1588456220
32 0,1584858988 0,1588270912 0,1588588578 0,1588821636

Método da Extração: Modelo 3
Nx, Ny P = 1 P = 2 P = 3 P = 4

1 0,1629800244 0,1580148777 0,1559611217 0,1586070938
2 0,1579780096 0,1571758525 0,1579111224 0,1583431288
4 0,1575670564 0,1579830811 0,1584348113 0,1586266797
8 0,1580795401 0,1584483032 0,1586787237 0,1587726889
16 0,1584620078 0,1586835300 0,1587989387 0,1588456928
32 0,1586815138 0,1588011432 0,1588588259 0,1588821681

Método da Extração: Modelo 2
Nx, Ny P = 1 P = 2 P = 3 P = 4

1 0,1462220436 0,1408006942 0,1378400006 0,1409112100
2 0,1580605005 0,1571738877 0,1579590129 0,1583889023
4 0,1575841308 0,1579853859 0,1584347747 0,1586266772
8 0,1580793149 0,1584483425 0,1586787237 0,1587726889
16 0,1584620142 0,1586835278 0,1587989387 0,1588456928
32 0,1586815144 0,1588011431 0,1588588259 0,1588821681

Tabela 7.4: Valores aproximados do fluxo na região $ !s2 = [1/2, 3/4]({0}, pelo método direto,
modelo 2 e modelo 3.

• IntDom: Cálculo do fluxo pelo método da função de extração usando a forma generalizada
do Modelo 2, Equação (7.22);

• IntCont: Cálculo do fluxo pelo método da função de extração usando a forma generalizada
do Modelo 3, Equação (7.24).



80 CAPÍTULO 7. O MÉTODO DA FUNÇÃO DE EXTRAÇÃO

Figura 7.5: Gráficos Log-Log do erro, na aproximação do valor do fluxo saindo pela região $ !s1 =
[0, 1/4]({0} com p = 1, 2, 3 e 4.



7.2. CASO DE INTERESSE (FLUXO MONOFÁSICO EM MEIOS POROSOS) 81

Figura 7.6: Gráficos Log-Log do erro, na aproximação do valor do fluxo saindo pela região $ !s2 =
[1/2, 3/4]({0} com p = 1, 2, 3 e 4.



82 CAPÍTULO 7. O MÉTODO DA FUNÇÃO DE EXTRAÇÃO

!1.0 !0.5 0.0 0.5 1.0
!1.0

!0.8

!0.6

!0.4

!0.2

0.0

g1!s"

Figura 7.7: Gráficos das funções g1(s) = g(s)
""
$ !s1 e g2(s) = g(s)

""
$ !s2 , com % = 0, 1.

Resultados Obtidos Usando u?

Neste teste, tem-se por objetivo confrontar os resultados obtidos na aproximação da quantidade
de interesse L(u) obtidos pelo método direto, Equação (7.25), pelo Modelo 1, Equação (7.18), e
pelo Modelo 2, Equação (7.22). Calcula-se a solução aproximada da quantidade de interesse pelo
método da função da extração usando os Modelo 1, Equações (7.18) e pelo Método Direto, usando
a Equação (7.25). Neste caso, usam-se as funções u? e "? , soluções aproximadas dos problemas
(7.14)-(7.15) e (7.19), respectivamente, para cada uma das sub-regiões $ !s1 = [0, 1/4] ( {0} e
$ !s2 = [1/2, 3/4]({0}. No caso do Modelo 2, Equação(7.22), usa-se a função " analítica dada
pela Equação (7.23).

Na resolução numérica do problema auxiliar (7.19) foi utilizado um espaço de aproximação
mais enriquecido, para obter uma aproximação mais precisa e com isso diminuir o erro na apro-
ximação da quantidade de interesse pelo método da função de extração. Foram utilizadas funções
de base de Lagrange unidimensionais de grau p + 1, na construção do espaço de elementos finitos
de Lagrange em 2D. Toma-se % = 1/10 na função g(s) do problema (7.19), correspondente a cada
uma das sub-regiões $ !s1 e $ !s2. A Figura 7.7 mostra os gráficos de g

""
$ !s1 e g

""
$ !s2 .

Na Tabela 7.5 mostram-se os resultados na aproximação da quantidade de interesse L(u) e o
valor do erro (D), em porcentagem, em relação a solução exata L(u) na região $ !s1, considerando
vários valores do grau p e do número de intervalos Nx e Ny. Analogamente, na Tabela 7.6 mostram-
se, respectivamente, os mesmos resultados considerando a aproximação do fluxo de fluido na região
$ !s2. Os valores exatos da quantidade de interesse em cada sub-região são:

• L(u) = 0, 5 em $ !s1 = [0, 1/4]({0}

• L(u) = 0, 158919 em $ !s2 = [1/2, 3/4]({0}



7.2. CASO DE INTERESSE (FLUXO MONOFÁSICO EM MEIOS POROSOS) 83

Valores aproximados com p = 1
Nx, Ny Método Direto D(%) Modelo 1 D(%) Modelo 2 D(%)
3, 1 0, 166408 66, 7 0, 274125 45, 2 0, 300188 40, 0
6, 2 0, 216802 56, 6 0, 297552 40, 5 0, 325162 35, 0

12, 4 0, 269356 46, 1 0, 342097 31, 6 0, 356659 28, 7
24, 8 0, 320887 35, 8 0, 381175 23, 8 0, 387765 22, 5
48, 16 0, 365741 26, 9 0, 411556 17, 7 0, 414813 17, 0
96, 32 0, 401561 19, 7 0, 437075 12, 6 0, 436732 12, 7

Valores aproximados com p = 2
Nx, Ny Método Direto D(%) Modelo 1 D(%) Modelo 2 D(%)
3, 1 0, 264748 47,1 0, 313240 37,4 0, 337539 32,5
6, 2 0, 322025 35,6 0, 360725 27,9 0, 372461 25,5

12, 4 0, 371672 25,7 0, 393097 21,4 0, 402632 19,5
24, 8 0, 408339 18,3 0, 424957 15,1 0, 427343 14,5
48, 16 0, 434239 13,2 0, 446634 10,7 0, 446668 10,7
96, 32 0, 452792 9,44 0, 464996 7,00 0, 461296 7,74

Valores aproximados com p = 3
Nx, Ny Método Direto D(%) Modelo 1 D(%) Modelo 2 D(%)
3, 1 0, 329267 34,2 0, 345469 30,9 0, 371886 25,6
6, 2 0, 378740 24,3 0, 386802 22,6 0, 401907 19,6

12, 4 0, 413185 17,5 0, 418821 16,2 0, 426673 14,7
24, 8 0, 437129 12,6 0, 446179 10,8 0, 446135 10,8
48, 16 0, 454582 9,08 0, 463047 7,39 0, 460893 7,82
96, 32 0, 467377 6,52 0, 477935 4,41 0, 471834 5,63

Valores aproximados com p = 4
Nx, Ny Método Direto D(%) Modelo 1 D(%) Modelo 2 D(%)
3, 1 0, 369805 26,0 0, 381819 23,6 0, 393790 21,2
6, 2 0, 407301 18,5 0, 410383 17,9 0, 419916 16,0

12, 4 0, 432515 13,5 0, 434539 13,1 0, 440921 11,8
24, 8 0, 451022 9,80 0, 459207 8,16 0, 456983 8,60
48, 16 0, 464736 7,05 0, 473070 5,39 0, 468956 6,21
96, 32 0, 474749 5,05 0, 485790 2,84 0, 477733 4,45

Tabela 7.5: Valores aproximados do fluxo total saindo pela região $ !s1 = [0, 1/4]({0}.



84 CAPÍTULO 7. O MÉTODO DA FUNÇÃO DE EXTRAÇÃO

Valores aproximados com p = 1
Nx, Ny Método Direto D(%) Modelo 1 D(%) Modelo 2 D(%)
3, 1 0, 131682 17,1 0, 167188 5,20 0, 167357 5,31
6, 2 0, 145881 8,20 0, 153870 3,18 0, 159651 0,46
12, 4 0, 153286 3,54 0, 157060 1,17 0, 158304 0,39
24, 8 0, 156634 1,44 0, 158172 0,47 0, 158437 0,30
48, 16 0, 157972 0,60 0, 158892 0,02 0, 158640 0,18
96, 32 0, 158503 0,26 0, 159218 0,19 0, 158771 0,09

Valores aproximados com p = 2
Nx, Ny Método Direto D(%) Modelo 1 D(%) Modelo 2 D(%)
3, 1 0, 161080 1,36 0, 148464 6,58 0, 154090 3,04
6, 2 0, 160860 1,22 0, 158513 0,26 0, 156733 1,38
12, 4 0, 159367 0,28 0, 158796 0,08 0, 157907 0,64
24, 8 0, 158845 0,05 0, 159075 0,10 0, 158435 0,30
48, 16 0, 158789 0,08 0, 159359 0,28 0, 158683 0,15
96, 32 0, 158829 0,06 0, 159454 0,34 0, 158802 0,07

Valores aproximados com p = 3
Nx, Ny Método Direto D(%) Modelo 1 D(%) Modelo 2 D(%)
3, 1 0, 161089 1,37 0, 158784 0,08 0, 157265 1,04
6, 2 0, 158770 0,09 0, 157994 0,58 0, 157988 0,59
12, 4 0, 158526 0,25 0, 159279 0,23 0, 158446 0,30
24, 8 0, 158688 0,15 0, 159304 0,24 0, 158682 0,15
48, 16 0, 158801 0,07 0, 159473 0,35 0, 158800 0,07
96, 32 0, 158860 0,04 0, 159511 0,37 0, 158860 0,04

Valores aproximados com p = 4
Nx, Ny Método Direto D(%) Modelo 1 D(%) Modelo 2 D(%)
3, 1 0, 158644 0,17 0, 155413 2,21 0, 157983 0,59
6, 2 0, 158310 0,38 0, 158850 0,04 0, 158337 0,37
12, 4 0, 158618 0,19 0, 159474 0,35 0, 158629 0,18
24, 8 0, 158773 0,09 0, 159397 0,30 0, 158774 0,09
48, 16 0, 158846 0,05 0, 159519 0,38 0, 158846 0,05
96, 32 0, 158882 0,02 0, 159534 0,39 0, 158882 0,02

Tabela 7.6: Valores aproximados do fluxo total saindo pela região $ !s2 = [1/2, 3/4]({0}.



7.2. CASO DE INTERESSE (FLUXO MONOFÁSICO EM MEIOS POROSOS) 85

7.2.4 Comentários

De acordo com os resultados obtidos nas tabelas e figuras anteriores tem-se as seguintes observa-
ções:

Na região onde a solução apresenta singularidade, $ !s1 = [0, 1/4] ({0}, nota-se que o Mé-
todo Direto de pós-processamento apresentou um desempenho inferior comparado com o método
da função de extração, Modelos 1, 2 e 3. Os Modelos 2 e 3 apresentaram melhor desempenho
comparado ao Modelo 1 quando p = 1 e p = 2. Já para p = 3 e p = 4, este último foi melhor que
os dois anteriores.

Na região $ !s2 = [1/2, 3/4] ( {0}, para p = 1, p = 2 e p = 3 o Método Direto de pós-
processamento apresentou um melhor desempenho, menor diferença, comparado ao método da
função de extração, sendo que os Modelos 2 e 3 foram melhores que o Modelo 1. Para p = 4 os
Modelos 2 e 3 apresentaram melhor desempenho comparado ao Método Direto e o Modelo 1.



Capítulo 8

Conclusões

Neste trabalho foi realizado o estudo de dois métodos para o pós-processamento da solução por
elementos finitos, a estratégia de adaptatividade goal-oriented e o método da função de extração,
com objetivo de se obter uma precisão desejável na aproximação das quantidades de interesse. Em
particular, a quantidade de interesse representa o fluxo total de fluido saindo por uma região do
contorno no domínio estipulado.

Com os resultados obtidos na Seção 6.6 observa-se que o método de estimativa goal-oriented
gera um problema dual com singularidade muito forte na região de interesse. Portanto, este método
torna-se um processo caro na estimativa do erro na aproximação do valor do fluxo, no problema
definido.

A partir dos resultados obtidos na Seção 7.2, conclue-se que o método da função de extração
para aproximação da quantidade de interesse, apresentado em [3, 4, 5], apresenta vantagens em
relação ao método direto em regiões que apresentam pontos de singularidades, como é o caso da
região $ !s1 = [0, 1/4]({0} do problema (7.14) e (7.15). Em regiões que não apresentam pontos de
singularidades, o método direto de pós-processamento apresenta melhor desempenho, comparado
ao método de extração, exceto quando o grau p = 4. Os Modelos 2 e 3, Equações (7.22) e (7.24),
do método da função extração, os quais usam função geradora " analítica, apresentaram melhor
desempenho comparado com o desempenho do Modelo 1, (7.18), o qual usa funções geradoras
aproximadas.

Conclui-se que o método de extração deu resultados similares ao método do cálculo direto.
Isto se deve ao fato de que a função geradora utilizada, " , possui a mesma ordem de suavidade
da função u e isto está diretamente relacionado com a taxa de convergência de L?(u?). Portando,
necessita-se de uma função " com mais suavidade em relação a função u para se obter uma maior
taxa de convergência.

87



88 CAPÍTULO 8. CONCLUSÕES

Ressalta-se ainda o grande esforço dedicado a este trabalho, no qual foi possível no prazo do
mestrado implementar os métodos goal oriented e da função de extração. Além disso, a utilização
do ambiente PZ permitiu implementar e verificar a complexidade dessas técnicas.



Referências Bibliográficas

[1] R. S. CARVALHO e J. A. D. Xavier A. J. ROSA. Engenharia de Reservatórios de Petróleo.
Rio de Janeiro, Brasil, 2006.

[2] M. AINSWORTH and J. T. ODEN. A posteriori error estimation in finite element analysis.
A Wiley-interscience publication, 2000.

[3] I. BABUSKA and A. MILLER. The post-processing approach in the finite element method
- part 1: Calculation of displacements, stresses and other higther derivatives of the displace-
ments. International Journal for Numerical Methods in Engineering, 20:1085–1109, 1984.

[4] I. BABUSKA and A. MILLER. The post-processing approach in the finite element method
- part 2: The calculation of stress intensity factors. International Journal for Numerical
Methods in Engineering, 20:1111–1129, 1984.

[5] I. BABUSKA and A. MILLER. The post-processing approach in the finite element method
- part 3: A posteriori error estimates and adaptive mesh selection. International Journal for
Numerical Methods in Engineering, 20:2311–2324, 1984.

[6] I. BABUSKA and W. C. RHEINBOLDT. A posteriori error estimates for the finite element
method. International Journal of Numerical Methods in Engineering, 12:1597–1615, 1978.

[7] G. F. CAREY and J. T. ODEN. FINITE ELEMENTS: A Second Course, volume II of The
Texas Finite Element Series. Prentice-Hall, Inc., Englewood Cliffs, New Jersey, 1983.

[8] P. R. B. DEVLOO. Pz -object oriented finite element software. Technical report, 2005.

[9] A. C. F. CORREA e A. J. ROSA. Análise de testes de pressão em poços. Technical report,
CEPETRO-Unicamp, 1987.

[10] G. F. CAREY E. B. BECKER and J. T. ODEN. Finite elements: An introduction, volume 1.
Prentice-Hall, 1981.

89



90 REFERÊNCIAS BIBLIOGRÁFICAS

[11] J. T. ODEN end G. F. CAREY. FINITE ELEMENTS: Mathematical Aspects, volume 4. Pren-
tice Hall, 1983.

[12] R. A. GREENKORN. Flow Phenomena in Porous Media-fundamentls and applications in
petroleum, water and food production. Marcel Dekker, Inc., 1983.

[13] C. JOHNSON. Numerical solution of partial differential equation by the finite element
method. Cambridge, USA, 1990.

[14] S. D. JOSHI. Horizontal Well Technology. Tulsa, Oklahoma, USA, 1991.

[15] V. R. PENMATCHA K. AZIS and S. ARBABI. Effects of pressure drop in horizontal wells
and optimum well length. Society of Petroleum Engineers Journal, 4(3):215–223, September
1999.

[16] B. SENIOR K. HARRIMAN, P. HOUSTON and E. SÜLI. hp-version discontinuous galerkin
methods with interior penalty for partial diferential equations with nonnegative characteristic
form. Technical report, 1991.

[17] E. KREYSZIG. AIntroductiory Functional Analysis with Aplications. John Wiley, 1989.

[18] C. A. MOURA. Análise funcional para aplicações-posologia. Rio de janeiro, 2002.

[19] J. NECAS. Les Méthodes en Théorie des Équations Elliptique. Masson, Paris, 1967.

[20] J. T. ODEN. Applied Functional Analysis. Prentice-Hall, Inc., 1979.

[21] J. T. ODEN and S. PRUDHOMME. Goal-oriented error estimation and adaptivity for the
finite element method. Technical report, Texas Institute for Computation and Applied Mathe-
matics the University of Texas at Austin, 1999.

[22] D. W. PEACEMAN. Fundamentals of Numerical Reservoir Simulation. Oxford, New York,
1977.

[23] J. N. REDDY. An introduction to the finite element method. McGraw-Hill Book Company,
1984.

[24] E. C. RYLO. Auto-adaptividade hp utilizando biblioteca de padrões de refinamento com
estimativa de erro e avaliação de padrões hp em paralelo. PhD thesis, Universidade Estadual
de Campinas-Faculdade de Engenharia Civil, 2007.



REFERÊNCIAS BIBLIOGRÁFICAS 91

[25] B. SZABÓ and I. BABUSKA. Finite element analysis. JOHN WILEY and SONS. INC.,
1991.



Apêndice A

Espaço Vetorial e Espaço Normado

A.1 Espaço Vetorial

Definição A.1 Um espaço vetorial é um conjunto X = (X , +, .), não vazio, de elementos u, v, ...
munido de duas operações algébricas (adição e multiplicação por escalar).

• adição + : X (X # X

• multiplicação por escalar · : K(X # X , K é um corpo (R ou C)

Propriedades 2 (da adição) Para todo u, v e w + X , tem-se

• Comutativa: u + v = v + u

• Associativa: u + (v + w) = (u + v) + w

• Elemento Neutro: ,u + X , 82 + X tal que 2 + u = u

• Oposto: ,u + X , 8'u + X tal que u + ('u) = 2

Propriedades 3 (da multiplicação por escalar) Sendo u e v + X , ! e ( + K, tem-se:

• !.(( .u) = (!.( ) · u

• ! · (u + v) = ! · u + ( · v

• 1 · u = u

• (! + ( ) · u = ! · u + ( · u

93



94 APÊNDICE A. ESPAÇO VETORIAL E ESPAÇO NORMADO

A.2 Espaço Normado

Definição A.2 (Norma) Norma é uma função, $ . $: X # R+, definida em um espaço vetorial
X = (X , +, .) com as seguintes propriedades:

(N1) $u $0 0, ,u + X ; $ u $= 0 1 u = 0

(N2) $ c.u $=| c |$ u $, ,c + K e ,u + X

(N3) $ u + v $!$ u $ + $ v $

Definição A.3 (Espaço Normado) Um espaço normado é um espaço vetorial com uma norma.

Definições em Espaços Normados

Definição A.4 (Convergência) Uma sequência (un) em um espaço normado X = (X ,$ . $) é con-
vergente se existe u + X tal que

lim
n#$

$ un 'u $= 0

u é chamado de limite de (un) e é representado por

lim
n#$

un = u

ou, simplesmente,
un # u

Definição A.5 (Fechado, Aberto, Ponto Aderente e Fecho) Seja X = (X ,$ . $) um espaço nor-
mado e sejam F * X , A * X e M * X .

O subconjunto F é fechado se para toda sequência (un) em X tal que un + X , ,n, e un # u
tem-se u + X .

Diz-se que o subconjunto A * X é aberto se seu complementar X 'A é fechado.
Sejam M * X e y + X , diz-se que y é aderente a M se existe um sequência (un) de elementos de

M que converge para y.
O fecho M do subconjunto M * X é o conjunto de todos os pontos aderentes de M. Por

construção M é fechado.

Definição A.6 (Denso) Sejam B, M * X = (X ,$ . $). Diz-se que B é denso em M se dado y + M
qualquer, existe uma sequência (un) de elementos de B tal que un # y. Em outras palalvras, B é
denso em M se todo ponto de M é aderente a B.



A.2. ESPAÇO NORMADO 95

Definição A.7 (Sequência de Cauchy) A sequência (un) em um espaço normado é uma sequência
de Cauchy se para todo % &gt; 0 existe um n0 = n0(%) tal que

$ un 'um $&amp;lt;%, ,n, m &gt; n0

Definição A.8 (Compacidade) Um subconjunto M * X = (X ,$ . $) é compacto se toda sequência
(un), un + M, possui uma subsequência convergente para um ponto u0 + M.

Definição A.9 (Espaço Completo) Um espaço normado X = (X ,$ . $) é completo se toda sequên-
cia de Cauchy for convergente.

Propriedades 4 Tem-se que:
(1) Todo espaço normado de dimensão finita é completo.
(2) Todo subconjunto completo é fechado.
(3) Todo subconjunto fechado de um completo é completo.

Definição A.10 (Espaço de Banach) Seja X = (X ,$ . $) um espaço normado. Se X for completo
ele é chamado de espaço de Banach.

Definição A.11 (Completamento) Seja X = (X ,$ . $) um espaço normado. Simplificadamente,
um completamento X do espaço normado X trata-se de um processo geral que nos permite intro-
duzir um contexto no qual todas as sequências de Cauchy, em X , são convergentes. Para maiores
detalhes ver [18, 20, 17].

Exemplos Importantes

Exemplo A.1 Seja o espaço vetorial C([a, b]), o conjunto constituido de todas as funções de valo-
res reais definidas e contínuas em [a, b]. Munido da norma

$ u $$= max
a!t!b

| u(t) |,

este espaço vetorial é de Banach.

Exemplo A.2 O Espaço vetorial C([a, b]) de todas funções contínuas de valor real, definidas em
[a, b], munido da norma

$ u $2=
;# b

a
| u(t) |2 dt

&lt;1/2

não é um espaço de Banach.



96 APÊNDICE A. ESPAÇO VETORIAL E ESPAÇO NORMADO

Observação: No espaço C([a, b]), a definição de soma e multiplicação por escalar é dada por:

(u + v)(t) = u(t) + v(t), ,u, v + C[a, b],

(- .u)(t) = - .u(t), ,- + R e ,u + C[a, b]

Exemplo A.3 O espaço vetorial L2([a, b],$ . $2) é definido como o completamento do espaço
C([a, b],$ . $2) do Exemplo 2.



Apêndice B

Notações

B.1 Notação de Laurent Schwartz

Seja n 0 1 fixo. Dados n inteiros não negativos !1, !2, ..., !n denota-se ! = (!1, !2, ..., !n) e
! ! != !1 + !2+, ..., +!n. Diz que ! é um multi-índice e, por exemplo, a! = a!1!2...!n . Por
simplicidade o símbolo D j representará o operador de derivação parcial $ /$ x j , com 1 ! j ! n,
de forma que D estará denotando o vetor gradiente

D = (D1, D2, ... , Dn) (B.1)

e
D! = D!11 D

!2
2 ...D

!n
n =

$ !1+!2+...+!n
$ x!11 $ x

!2
2 ...$ x

!n
n

=
$ !! !

$ x!11 $ x
!2
2 ...$ x

!n
n

. (B.2)

Por exemplo, D(1, 2, 3) f = $ 6 f /$ x1$ x22$ x
3
3, D

(0, 1) f = $ f /$ x2, D(0, 0) f = f , em que f é uma função
suave em um aberto ! * Rn.

B.2 Operadores Diferenciais

Divergente

Dado um vetor !u + R3, o seu divergente, # ·!u ou div!u, é o operador diferencial dado por

# ·!u =
$ ux
$ x

+
$ uy
$ y

+
$ uz
$ z

(B.3)

97



98 APÊNDICE B. NOTAÇÕES

Gradiente

Seja agora a função escalar u : R3 # R, o seu gradiente, #u, é o operador

#u = (
$ u
$ x

,
$ u
$ y

,
$ u
$ z

). (B.4)

Laplaciano

É a combinação entre o divergente e o gradiente,

# · (#u) =
$
$ x

(
$ u
$ x

) +
$
$ y

(
$ u
$ y

) +
$
$ z

(
$ u
$ z

),

de uma fução escalar u que é representado pelo operador

"u =
$ 2u
$ x2

+
$ 2u
$ y2

+
$ 2u
$ z2

. (B.5)

Este operador é chamado de Laplaciano de u.

Fórmula de Green

A fórmula de Green nos diz que: se u e v são campos escalares, então

#

!
div(v#u) =

#

!
(#v · #u + v"u)d4 =

#

$ !
v

$ u
$ n

d5 (B.6)

em que !n é o versor normal à $ !.




</field>
	</doc>
</add>