<?xml version="1.0" encoding="utf-8"?>
<add>
	<doc>
		<field name="docid">BR-TU.10985</field>
		<field name="filename">16196_Dissertac%cc%a7a%cc%83o_Jorge_Dias.pdf</field>
		<field name="filetype">PDF</field>
		<field name="text">
  

Imagem	
	

	

Jorge	Manuel	Alves	Dias	

	

	

	

Algoritmos	para	o	Carregamento	Coordenado	de	Veículos	

Elétricos	para	a	Integração	em	Larga	Escala	de	Energias	

Renováveis	
	

	

	
Dissertação	de	mestrado	em	Engenharia	Eletrotécnica	e	de	Computadores	

	

fevereiro	de	2017 

	
	

	

	

	

	

	

	

	

	

	 	

Jorge	Manuel	Alves	Dias	

	

Algoritmos	para	o	Carregamento	Coordenado	de		

Veículos	Elétricos	para	a	Integração	em		

Larga	Escala	de	Energias	Renováveis	
Dissertação	de	Mestrado	em	Engenharia	Eletrotécnica	e	de	Computadores	

	

setembro	de	2017	 
	

	
	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	



  

	



 

 
 

Departamento de Engenharia Eletrotécnica e de Computadores  

Faculdade de Ciências e Tecnologia 

 Universidade de Coimbra 

 

Dissertação de Mestrado em Engenharia Eletrotécnica e de Computadores 

 

Algoritmos para o Carregamento Coordenado de 
Veículos Elétricos para a Integração em Larga 

Escala de Energias Renováveis  

Jorge Manuel Alves Dias 

 

Desenvolvido com a Supervisão de Professor Doutor 

 Pedro Manuel Soares Moura 

Júri?

Presidente: Professor Doutor Carlos Alberto Henggeler de Carvalho Antunes 

Vogal: Professor Doutor Paulo José Gameiro Pereirinha 

Orientador: Professor Doutor Pedro Manuel Soares Moura 

 

setembro de 2017 



 

  



 

 

Agradecimentos 

Agradeço de uma forma muito especial ao Prof. Doutor Pedro Moura pela 

paciência e disponibilidade empreendida nesta dissertação. As suas contribuições foram 

valiosas e fundamentais neste trabalho. Foi um privilegio desenvolver esta dissertação 

sobre a sua orientação.  

Aos meus amigos que comigo percorram este longo percurso académico, com os 

quais partilhei muitos momentos de alegria e experiências académicas inesquecíveis. Aos 

amigos de infância e àqueles que mesmo espalhados pelo mundo ajudaram-me sem o 

aperceberem.  

Um agradecimento especial à minha namorada, por todo o amor, atenção e 

carinho proporcionado nos bons e maus momentos.  

Por ultimo e de maior importância agradeço à minha família que sempre me 

apoiaram e me deram o sentimento mais importante, amor.  Sem eles não teria sido 

possível chegar a esta etapa. A motivação e suporte prestados foram essenciais ao longo 

de toda a minha vida. 

A todos o meu sincero e profundo agradecimento.  

  



 

 

 

  



 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

A todos os que me educaram 

  



 

 

  



 

Resumo 
Desde o início da mobilidade pessoal que os veículos elétricos estiveram presentes, mas os seus 

rivais movidos a combustíveis fósseis tinham um desempenho superior e eram mais baratos. Contudo, 

atualmente o cenário já se começa a inverter devido à instabilidade de preços do petróleo, poluição e 

incentivos na compra de veículos elétricos.  

A mobilidade é uma área que requer grandes quantidades de energia. Nos veículos tradicionais 

é fácil armazenar e transportar o combustível, mas nos veículos elétricos, a energia tem de ser 

transportada em redes que, na maioria, não foram pensadas para suportar grandes cargas como um 

grande aglomerado de veículos elétricos a carregar. Assim, caso não exista uma coordenação de 

carregamentos podem ocorrer picos de procura de energia imprevistos levando à falha da rede. 

Outro aliado no combate à poluição é a aposta na produção de energias renováveis, com as 

quais se consegue reduzir a emissão de gases de efeito estufa, mas a sua produção é intermitente e 

variável. Este problema leva à necessidade de grandes capacidades de produção o que origina, por 

vezes, excesso de geração renovável face ao consumo.  

Neste trabalho irão ser desenvolvidos algoritmos para mitigar os dois problemas anteriores: 

carregamento em massa de veículos elétricos e excesso de geração renovável. Como tal, irão ser 

desenvolvidos algoritmos com o objetivo de absorver excesso de geração renovável, reduzir os custos 

associados ao carregamento de veículos elétricos e otimizar o diagrama de carga nacional. 

Os algoritmos irão agendar os carregamentos para períodos onde haja um maior excesso ou 

percentagem de geração renovável. Fazendo isto, espera-se evitar problemas de picos de procura na 

rede uma vez que o algoritmo distribui racionalmente os horários de carregamento, proporcionando 

assim uma maior integração de veículos elétricos, possibilitando o crescimento desta área. 

Adicionalmente, irá também ser simulado um algoritmo que irá agendar os carregamentos em função 

do preço da energia e não no seu excesso. Geralmente, o excesso de energia ocorre sempre que a 

procura é baixa, o que leva à diminuição dos custos da energia. Ao carregar os veículos nesses 

períodos o seu custo será reduzido obtendo assim vantagens não só para as redes elétricas como 

também para os utilizadores de veículos elétricos.  

Com as simulações efetuadas pode-se concluir que usando o algoritmo em função do excesso 

de energia, consegue-se aproveitar o excesso de geração renovável, reduzir os custos associados ao 

carregamento e suavizar o diagrama de carga. Usando o algoritmo em função do preço de energia já 

só se verifica a redução dos custos. 

 

Palavras Chave: Veículo Elétrico, Carregamento, Otimização, Algoritmos, Energias Renováveis 	  



 

  



 

Abstract 
Since the beginning of personal mobility, electric vehicles have been present, but their fossil 

fuel powered rivals had better performance and lower cost. However, nowadays this scenario is 

starting to change due to the instability of oil prices, pollution and incentives for the purchase of 

electric vehicles. 

Mobility is an area that requires large quantity of energy. In traditional vehicles it is easy to 

store and transport fuel, but, in electric vehicles, energy has to be transported in networks that were 

not designed to withstand heavy loads, such as the required for a large fleet of electric vehicles. Thus, 

if there is no coordination of the charging process, unforeseen power demand peaks can lead to grid 

failures. 

Another ally in the fight against pollution is the commitment in renewable energy generation, 

which can reduce the emission of greenhouse gases, but its generation profile is intermittent and 

variable. This problem leads to a need for large generation capacities, which sometimes leads to a 

surplus of generation relatively to the consumption. 

In this work, algorithms to mitigate the two previous problems will be developed: large scale 

charging of electric vehicles and renewable generation surplus. Therefore, the goal of these 

algorithms is to absorb the renewable generation surplus, reduce charging costs of electric vehicles 

and optimize the national load diagram. 

The algorithms will reschedule the charging for the periods with larger percentage of renewable 

generation. By doing this, it is expected to avoid problems of demand peaks, since the algorithm 

rationally distributes the charging periods, ensuring a good integration of electric vehicles, enabling 

the growth of this area. In addition, an algorithm that schedules the charging based on the energy 

price and not on the generation surplus, will also be simulated. Generally, the generation surplus 

energy occurs whenever demand is low which leads to a decrease in energy prices. By charging the 

vehicles in such periods the cost will be reduced obtaining advantages not only for the electrical grid, 

but also for the users.  

With this work, it can be concluded that by using intelligent charging it is possible to take 

advantage of the renewable generation surplus, reduce the costs associated with charging and smooth 

the load diagram. By using the algorithm as a function of the energy price, there is only a reduction 

of costs. 

 

Key	words: Electric	Vehicle,	Charging,	Optimization,	Algorithms,	Renewable	Energies	

	



 

  



 i 

Índice 
 

Lista	de	Figuras	.........................................................................................................	iii	

Lista	de	Tabelas	........................................................................................................	iv	

Lista	de	Acrónimos	....................................................................................................	v	

1	 Introdução	.........................................................................................................	1	

1.1	 Enquadramento	....................................................................................................	1	

1.2	 Motivação	.............................................................................................................	1	

1.3	 Objetivos	..............................................................................................................	2	

1.4	 Estrutura	da	Dissertação	.......................................................................................	3	

2	 Mobilidade	Elétrica	............................................................................................	4	

2.1	 Tipos	de	Veículos	Elétricos	....................................................................................	4	

2.2	 Elétrico	vs.	Combustão	..........................................................................................	5	

2.3	 Motores	e	Baterias	................................................................................................	6	

2.4	 Carregamento	de	um	Veículo	Elétrico	...................................................................	6	

2.5	 Impacto	dos	Veículos	Elétricos	..............................................................................	8	

2.5.1	 Impacto	dos	VEs	nas	redes	de	energia	elétrica	......................................................	9	

2.5.1.1	 Aumento	do	pico	de	procura	......................................................................................	9	
2.5.1.2	 Recurso	de	resposta	à	procura	e	armazenamento	de	energia	...................................	9	
2.5.1.3	 Qualidade	da	energia	................................................................................................	10	

2.5.2	 Impacto	ambiental	dos	VEs	..................................................................................	12	

2.5.3	 Impacto	económico	dos	VEs	.................................................................................	13	

3	 Carregamento	Coordenado	de	Veículos	Elétricos	.............................................	14	

3.1	 Controlo	de	carregamento	local	..........................................................................	15	

3.2	 Controlo	de	carregamento	iterativo	....................................................................	15	

3.3	 Controlo	de	carregamento	centralizado	..............................................................	16	

3.4	 Sistema	Multi-Agente	.........................................................................................	16	

3.5	 Comparação	de	carregamentos	inteligentes	........................................................	17	

4	 Problema	.........................................................................................................	20	

4.1	 Excesso	de	produção	de	energia	..........................................................................	20	

4.2	 Exportação	e	armazenamento	.............................................................................	20	



 ii 

4.3	 Veículos	elétricos	como	complemento	................................................................	22	

5	 Descrição	do	Algoritmo	....................................................................................	24	

5.1	 Objetivos	............................................................................................................	24	

5.2	 Dados	necessários	...............................................................................................	25	

5.2.1	 Previsão	da	produção	e	consumo	energia	............................................................	25	

5.2.2	 Preço	da	energia	...................................................................................................	25	

5.2.3	 Estado	do	VE	.........................................................................................................	26	

5.3	 Equipamentos	necessários	..................................................................................	27	

5.3.1	 Sistema	de	Controlo	Auxiliar	................................................................................	27	

5.3.2	 Sistema	de	Controlo	Central	.................................................................................	28	

5.4	 Funcionamento	do	algoritmo	..............................................................................	28	

5.4.1	 Entrada	de	dados	..................................................................................................	30	

5.4.2	 Agendamento	.......................................................................................................	31	

6	 Testes	e	resultados	..........................................................................................	35	

6.1	 Dados	necessários	...............................................................................................	35	

6.2	 Simulação	de	inverno	..........................................................................................	38	

6.3	 Simulação	de	verão	.............................................................................................	41	

7	 Conclusões	e	trabalho	futuro	...........................................................................	46	

7.1	 Conclusões	..........................................................................................................	46	

7.2	 Trabalho	Futuro	..................................................................................................	49	

Referências	.............................................................................................................	51	

8	 Anexo	A	-	Algoritmo.m	.....................................................................................	57	

9	 Anexo	B	-	Previsao.m	.......................................................................................	64	

10	 Anexo	C	-	ListaVE.m	.....................................................................................	72	

11	 Anexo	D	-	Tempo.m	.....................................................................................	75	

12	 Anexo	E	–	Erro.m	..........................................................................................	76	

13	 Anexo	F	-	Janela.m	.......................................................................................	77	

14	 Anexo	G	-	Plots.m	.........................................................................................	78	

15	 Anexo	H	–	PlotsComparativos.m	..................................................................	80	

16	 Anexo	H	–	Lista	VE	final	................................................................................	82	



 iii 

	

Lista de Figuras 

Figura 1 - Classificação dos impactos dos VEs ................................................................ 8	

Figura 2 – Impactos dos VEs nas redes de energia elétrica .............................................. 9	

Figura 3 – Impacto de emissões de um Nissan Leaf por km para diferentes modos de 

condução [38] .......................................................................................................... 13	

Figura 4 - Exemplo das arquiteturas dos algoritmos: (a) carregamento descontrolado, (b) 

controlo local, (c) controlo iterativo/centralizado ................................................... 16	

Figura 5 - Comparação do impacto dos diferentes métodos de carregamento no diagrama 

de carga [49] ........................................................................................................... 17	

Figura 6 – Complementaridade Hídrica [57] .................................................................. 21	

Figura 7 - Diagrama de consumo total para o dia 2 de janeiro de 2017 (Fonte REN) ... 22	

Figura 8 - Diagramas de energia dos dias 2 e 3 de fevereiro de 2017 ............................ 25	

Figura 9 - Fluxograma do SCA ....................................................................................... 29	

Figura 10 - Fluxograma do SCC ..................................................................................... 30	

Figura 11 – Informação mostrada na janela de comandos do Matlab ............................ 33	

Figura 12 - Primeira e última viagem ............................................................................. 37	

Figura 13 - Viagens de e para casa ................................................................................. 37	

Figura 14 - Simulação de inverno (2 e 3 de fevereiro de 2017) com preços MIBEL ..... 38	

Figura 15 - Simulação de inverno (2 e 3 de fevereiro de 2017) com preços Bi-horário 39	

Figura 16 - Diagramas de energia dos dias 9 e 10 de agosto de 2016 (sem utilização do 

fator de redução de 10 mil vezes) ........................................................................... 42	

Figura 17 - Simulação de verão (9 e 10 de agosto de 2016) com preços MIBEL .......... 42	

Figura 18 - Simulação de verão (9 e 10 de agosto de 2016) com preços Bi-horário ...... 43	

Figura 19 - Diagramas de carga nos dias 2 e 3 de fevereiro de 2017 (consumo geral 

reduzido em 10 mil vezes) ...................................................................................... 48	

Figura 20 - Diagramas de carga nos dias 9 e 10 de agosto de 2016(consumo geral reduzido 

em 10 mil vezes) ..................................................................................................... 48	

 

  



 iv 

Lista de Tabelas 

 

Tabela 1 - – Limites de emissões de CO2 e vendas necessárias para cumprir as metas de 

emissões em 2020 [12] .............................................................................................. 6	

Tabela 2 – Dados necessários ao algoritmo .................................................................... 28	

Tabela 3 - Vendas de VEs em Portugal [67] ................................................................... 36	

Tabela 4 - Modelos de VE mais vendidos em Portugal [67] .......................................... 36	

Tabela 5 - Resultados das simulações para os dias 2 e 3 de fevereiro de 2017 .............. 39	

Tabela 6 - Resultados das simulações para os dias 9 e 10 de agosto de 2016 ................ 44	

Tabela 7 - Comparação da redução de custos ................................................................. 44	

Tabela 8 - Comparativo do uso do excesso de renovável por cada algoritmo ................ 45	

Tabela 9 - Resultados finais do algoritmo em função do excesso de renovável ............. 47	

 

 

  



 v 

Lista de Acrónimos 

  

ACAP  Associação do Comércio Automóvel de Portugal 

CCC Controlo de Carregamento Centralizado 

CCL Controlo de Carregamento Local 

ERSE Entidade Reguladora do Sector Energético 

EU União Europeia 

GEE Gases de Efeito Estufa 

MAS Multi Agent System 

MIBEL Mercado Ibérico de Eletricidade 

MCI Motor de Combustão Interna 

SEE Sistema de Energia Elétrica 

SCA Sistema de Controlo Auxiliar 

SCC Sistema de Controlo Central 

SOC State of Charge 

UVE Associação de Utilizadores de Veículos Elétricos 

VE(s) Veículo(s) Elétrico(s) 

 

  



 vi 

 

  



 1 

	

1 Introdução 

1.1 Enquadramento 
A sociedade moderna está dependente da energia elétrica. É uma componente essencial do 

nosso estilo de vida e um fator determinante da economia e sustentabilidade do Mundo. 

Cada vez há mais incentivos para a utilização de transportes públicos, mas, na verdade, há 

uma tendência para a utilização de um veículo pessoal. Como tal, é necessário tirar partido deste 

aspeto negativo e torná-lo apelativo eletrificando a mobilidade e reduzindo a libertação de gases 

de efeito estufa (GEE). É sabido que os combustíveis fósseis estão no cerne de grandes problemas 

ambientais e alterações climáticas e são estes aspetos que têm suscitado uma aposta na produção 

de energia elétrica com base em fontes de energia renováveis, em detrimento de fontes que 

promovam a emissão de GEE.  

Neste sentido, a União Europeia (UE) possui objetivos ambiciosos, uma vez que pretende que 

em 2030, 27% da energia total produzida seja proveniente de fontes renováveis e que haja uma 

redução em cerca de 40% (em relação a 1990) não só da emissão de GEE, mas também do consumo 

de energia em geral, através de medidas de eficiência energética. 

Outro fator importante que encoraja a mudança para a mobilidade elétrica é o preço dos 

combustíveis fósseis. O preço dos combustíveis fósseis é proporcional ao preço do crude. No 

entanto há outra variável que são as taxas politico económicas que, neste momento, em Portugal, 

são verdadeiramente elevadas. Em 2011, o barril de petróleo custava mais do dobro do que 

atualmente, no entanto, os preços dos combustíveis eram idênticos aos que podemos encontrar 

hoje num posto fazendo com que os consumidores contenham as suas deslocações e pensem duas 

vezes no tipo de veículo que pretendem adquirir. Antes de 2000 havia uma tendência para veículos 

movidos a gasolina que rapidamente se alterou para gasóleo. Na atualidade, os compradores já têm 

uma terceira alternativa à altura dos rivais, o veículo elétrico (VE). 

  

1.2 Motivação 
Por melhor que seja a decisão de adotar os VEs como solução a vários problemas da sociedade 

e aumentar a utilização de energias renováveis, podem existir também inconvenientes.  

As energias renováveis são maioritariamente incontroláveis. Podem-se prever com alguma 

exatidão, mas não há a possibilidade de controlar o nível de produção, que depende exclusivamente 

das condições climatéricas. Portugal, durante o período noturno, costuma ter mínimos de consumo 

no diagrama de carga nacional abaixo de 3000 MW, o que é aproximadamente 5 vezes inferior ao 



 2 

total da capacidade instalada das principais de energias renováveis que podem funcionar à noite 

(eólica e hídrica). Esta capacidade instalada é necessária durante o dia, mas, durante a noite há 

diversas situações em que satisfaz totalmente a procura e até excedendo-a em algumas horas de 

maior abundância de energias renováveis.  

Em termos de massificação da utilização dos VEs, o problema que se coloca é a criação de 

uma nova ponta de procura no diagrama de carga. A generalidade dos utilizadores carrega o seu 

veículo após o período laboral, no inicio da noite ao chegar a casa. Como a penetração de VEs 

ainda é baixa o impacto atual é insignificante. Nos anos que se seguem, com o aumento das 

unidades vendidas e com a crescente tendência para cargas rápidas nos primeiros instantes de 

carregamento, os VEs podem conduzir a complicados problemas na gestão das redes causando um 

grande desequilíbrio nos sistemas de energia elétrica (SEE). 

Atualmente, de maneira a estimular o equilíbrio do diagrama de carga, é utilizado um conjunto 

de tarifas de venda de energia a diferentes preços sendo mais baixo nos períodos noturnos ou ao 

fim-de-semana e mais elevado nos restantes períodos, quando comparado com uma tarifa simples 

em que o preço é mantido constante. Estas medidas encorajam os consumidores a alterar os seus 

hábitos de utilização de certos equipamentos como por exemplo usar a máquina de lavar apenas 

durante a noite quando a eletricidade é mais barata. Ao fazer isto o utilizador contribui para a 

redução do pico de procura e estabilização do diagrama de carga. 

Em contrapartida, esta ação implica uma gestão eficiente por parte do utilizador o que por 

vezes pode ser complicada de gerir. Depender do consumidor para gerir o seu próprio consumo 

pode funcionar durante um período inicial, em que estão motivados pela novidade e poupanças 

que podem alcançar, todavia, após este período inicial, haverá uma tendência para voltar à sua 

“zona de conforto” e ceder aos antigos hábitos [1]. 

Usando um sistema automatizado, que tenha em consideração as preferências do consumidor, 

para gerir o carregamento do VE é uma melhor solução que se adapta às alterações da rede 

podendo até interromper o processo quando necessário [2][3]. Esta medida reduz a necessidade e 

a utilização de centrais de produção usadas nas horas de ponta contribuindo para a redução da 

emissão de GEE uma vez que parte destas centrais são a gás devido ao seu rápido tempo de 

atuação. Com o diagrama de carga equilibrado é possível também aumentar a eficiência de todas 

as outras centrais pois estas podem passar a funcionar com um valor mais perto do nominal [4][5]. 

 

1.3 Objetivos 
Neste trabalho pretende-se desenvolver algoritmos para o controlo coordenado do 

carregamento de frotas de VE. Tais algoritmos devem ser baseados na previsão da geração 



 3 

renovável e do consumo de forma a controlar o carregamento dos veículos em função dos excessos 

e variações da geração renovável.  

Assim, os objetivos desta dissertação são:  

• Demonstrar que com o deslocamento do período horário do carregamento de VEs é 

possível absorver excesso de energia renovável; 

• Demonstrar que o deslocamento do período horário do carregamento de um VEs pode 

assegurar uma redução de custos ao utilizador; 

• Demonstrar que é possível otimizar o diagrama de carga nacional deslocando o 

carregamento de frotas de VEs de períodos de ponta para períodos com excedente de 

energia renovável. 

 

1.4 Estrutura da Dissertação 
A presente dissertação encontra-se organizada em 7 capítulos: 

O capítulo 1 é dedicado a uma introdução ao tema seguido pelos problemas que enfrentamos 

na atualidade na área da mobilidade elétrica. É também abordada a motivação da elaboração desta 

dissertação e os seus objetivos. 

O capítulo 2 tem o intuito de dar continuidade à introdução com uma análise mais detalhada 

sobre veículos elétricos e aspetos relevantes a esta dissertação que gira em torno deles. Serão 

também debatidos os problemas relacionados com carregamento em massa de VEs. 

No capítulo 3 são apresentadas e comparadas diversas estratégias de carregamentos 

coordenados já existentes. 

No capítulo 4 são analisados dados relativos a perfis de geração e excessos, e possíveis 

soluções a estes problemas. 

No capítulo 5 são descritos vários algoritmos para coordenação de carregamentos, o seu 

funcionamento, finalidades e fazendo também uma analogia entre os mesmos.  

No capítulo 6 serão apresentadas as simulações realizadas, os seus resultados e uma análise 

dos mesmos. 

Para concluir, segue-se o capítulo 7 onde serão expostas as conclusões deste trabalho, 

acompanhadas de sugestões de implementações futuras. 

  



 4 

 

2 Mobilidade Elétrica 
Os VEs diferenciam-se dos veículos usuais pelo facto de utilizarem um sistema de propulsão 

elétrico. Em alternativa à solução comum, em que a propulsão tem por base um depósito de 

combustível, um motor de combustão interna (MCI) (que converte a energia armazenada no 

combustível em energia mecânica) e um sistema de transmissão mecânica às rodas. Já os VEs, 

utilizam motores elétricos, que convertem energia elétrica na energia mecânica necessária à sua 

propulsão. 

Um VE não só poderá reduzir a emissão de GEE e outros poluentes, como também promove 

a utilização de energia proveniente de fontes renováveis [6]. Portanto, os VEs contribuem para um 

sector de transportes mais limpo e para a independência das energias fósseis utilizadas atualmente. 

É difícil atribuir apenas a uma pessoa a invenção do primeiro VE. Em 1828, o Húngaro Ányos 

Jedlik, inventou um pequeno modelo de um carro movido por um motor elétrico. Após Jedlik, 

vários inventores contribuíram para esta inovação tais como Robert Anderson, Stratingh of 

Groningen, Thomas Davenport, entre outros [7]. Todos estes inventores estimularam a evolução 

dos VEs até se tornarem nos veículos atuais, com mais de 600 km de autonomia (o novo modelo 

da Tesla – P100D, com uma velocidade moderada e condições ideais é reivindicado pela empresa 

como tendo mais de 1000 km de autonomia), com desempenhos que desafiam qualquer carro 

desportivo com MCI e, mais importante, sem utilizarem combustíveis fósseis.  

Outro fator deveras essencial foi o desenvolvimento das baterias, pois sem estas, não seria 

possível armazenar energia para a propulsão do VEs, sendo a autonomia e a duração dos 

carregamentos a grande limitação neste sector uma vez que todos os outros componentes do 

veículo já estão numa fase de elevada maturidade. 

 

2.1 Tipos de Veículos Elétricos 
Os VEs têm todos a mesma base tecnológica, contudo existem importantes diferenças 

tecnológicas que permitem distinguir vários tipos de VEs. Assim, estes podem ser divididos em 

três categorias: veículos puramente elétricos, híbridos e veículos de célula de combustível.  

O nome da categoria em si explica o conceito: veículos puramente elétricos apenas possuem 

motores elétricos alimentados por baterias sendo seu carregamento efetuado através da ligação a 

uma tomada (Plug-in).  

Os veículos híbridos possuem um MCI aliado a um motor elétrico. Podem se dividir em 

diferentes classes, série (o MCI fornece potência ao alternador que, por sua vez, produz energia 

elétrica necessária ao funcionamento do motor elétrico que propulsiona o veículo), paralelo (quer 



 5 

o MCI quer o motor elétrico fornecem potência em simultâneo às rodas motrizes) ou série-paralelo 

(uma combinação das duas anteriores que junta as suas vantagens em detrimento da 

complexidade). A ideia por detrás dos VEs híbridos é os motores se complementarem, permitindo 

ter uma grande autonomia graças ao MCI com baixos consumos devido ao motor elétrico. O 

carregamento das baterias é efetuado pelo MCI ou, nos mais recentes, pode também ser carregado 

diretamente por uma tomada. Atualmente, quase todos os veículos híbridos vendidos são Plug-in.  

Os veículos de célula de combustível produzem a energia necessária para a locomoção a partir 

do hidrogénio. A eletricidade resulta duma reação química entre o hidrogénio e o oxigénio cujo 

produto, para além da eletricidade, é água, pelo que se pode concluir que estes veículos não são 

poluentes. A energia elétrica produzida é utilizada na locomoção do veículo ou guardada nas 

baterias para uso posterior. Esta tecnologia possui a desvantagem de utilizar um combustível 

(hidrogénio) cuja ocorrência na Natureza não é abundante e cuja obtenção implica um processo 

químico. Se este processo utilizar fontes de energia não-renováveis, então a produção de 

hidrogénio não é ambientalmente favorável [8]. 

 

2.2 Elétrico vs. Combustão 
Sendo os veículos de combustão interna os atuais rivais aos VEs, é necessário fazer uma 

apreciação sobre os prós e contras envolvidos neste tema.  

Estudos recentes [9][10], demonstram que os VEs são superiores aos veículos tradicionais no 

que diz respeito a eficiência e em termos ambientais. Como consequência, é esperado que o 

número de unidades de VEs a circular venha a aumentar consideravelmente nos próximos anos, 

especialmente em áreas urbanas.  

 Um MCI moderno e sofisticado a gasóleo, consegue uma eficiência de 35-40% na gama 

de velocidade ideal, havendo um grande declínio fora desta zona. Já os motores a gasolina apenas 

conseguem uma eficiência entre os 18% e os 25% significando que aproximadamente 80% da 

energia disponível é desperdiçada como calor [10].  

Apesar da enorme discrepância de eficiências os MCI dominam completamente o sector 

dos transportes, representando 98% da totalidade [11] e emitindo GEE com um impacto 

considerável. O transporte rodoviário é responsável por aproximadamente por um quarto de todas 

as emissões de gases de efeito de estufa nos Europa e nos Estados Unidos, gerando mais de 3 Gt 

de CO2. A adoção de VEs pode vir a ter um grande impacto a atingir as metas globais de emissão 

de CO2 estabelecidas na Tabela 1. 



 6 

Tabela 1 - – Limites de emissões de CO2 e vendas necessárias para cumprir as metas de emissões em 2020 [12] 

 Limites de emissões de CO2 
para veículos novos 

(gCO2/km) 

Previsão atual de emissões 

de CO2 dos veículos 

(gCO2/km) 

Número de novos 

VEs até 2020 

(milhões) 

 2015  2020 2015 2020 

Europa 130 95 120 104 1,4 

EUA 182 133 163 150 0,9 

 

2.3 Motores e Baterias 
Os motores de tração usados nos VEs, por norma, são motores DC, motores de indução, 

motores síncronos de ímanes permanentes ou motores de relutância. A decisão depende da 

densidade de potência, eficiência, controlabilidade, fiabilidade, maturidade tecnológica e custo 

[13][14][15], sendo os motores de ímanes permanentes e os de indução os mais comuns, devido à 

sua eficiência que pode atingir desde os 85% a 95% numa ampla gama de velocidades [16]. 

O principal aspeto que tem atrasado a evolução da mobilidade elétrica é o armazenamento 

de energia. As baterias são a melhor solução atualmente tendo o problema de terem um custo 

elevado, que representa uma percentagem substancial do custo do VE. 

Os fabricantes de automóveis elétricos estão a apostar nas baterias de iões de lítio, 

especialmente pelo equilíbrio que existe entre densidade de energia, durabilidade, segurança e 

custo de fabrico. As baterias de iões de lítio são caracterizadas pela ausência de memória e baixa 

taxa de auto-descarga e, presentemente, ainda são vistas como a melhor opção para atingir os 

requisitos de armazenamento de energia num VE. 

Há opções que seriam mais apelativas como as baterias de polímero de lítio que conseguem 

ser mais compactas e leves que as de iões de lítio, mas que ainda não estão maduras o suficiente 

para aplicações de alta capacidade. Apesar disto, já há fabricantes, como a gigante da Coreia do 

Sul Kia Motors Company, que já equipa os seus VEs com este tipo de baterias.  

 

2.4 Carregamento de um Veículo Elétrico 
O carregamento de um VE consiste no processo de reposição de energia elétrica na(s) 

bateria(s) do veículo para um nível máximo, ou pelo menos, superior. Os VEs estão dotados de 

um carregador interno que transforma a energia recebida (por meio de um cabo) em corrente 

alternada (CA) para corrente contínua (CC), sendo dessa forma absorvida pela bateria. Para tal, o 

VE deve ser ligado à rede elétrica, seja através de um posto de carregamento próprio ou 

simplesmente usando uma tomada doméstica normal. Contudo, pode haver variantes, como no 



 7 

caso dos supercarregadores Tesla, em que as baterias do carro recebem diretamente energia DC 

de uma rede exclusiva da própria empresa. 

A norma europeia/portuguesa EN/NP61851 – Sistema de carga condutiva para VEs (2003), 

revista em Dezembro de 2010, define como deve ser feito o carregamento de um VE e em que 

condições. Para esse efeito define 4 modos de carregamento [17]: 

• Modo 1 - Ligação do VE à rede de alimentação utilizando tomadas normalizadas de 

corrente até 16A, no lado da rede de alimentação, monofásica ou trifásica, com 

condutores de fase(s), de neutro e de terra de proteção, ou seja, utilizando tomadas 

domésticas do tipo schuko ou industriais da norma EN60309.  

• Modo 3 - O Modo 3 antecede o Modo 2 pois trata-se de uma adaptação. Segundo a norma 

EN/NP61851, o Modo 3 é um sistema de fornecimento de energia em corrente alternada, 

desenvolvido especificamente para VEs. Este sistema visa aumentar a segurança do 

processo de carregamento de um VE e reduzir o risco decorrente de eventuais erros de 

manipulação por seres humanos e de defeito de isolamento elétrico do VE, cabo de 

ligação ou tomada de fornecimento.  

• Modo 2 -  É um sistema de carregamento desenvolvido para permitir um veículo que só 

carrega em Modo 3, carregar numa tomada existente doméstica ou industrial. Para esse 

efeito o cabo de carregamento tem a função de piloto de controlo desde o veículo até a 

uma caixa de comando situada na outra ponta do cabo. Esta caixa permite Modo 3 ao 

longo do cabo. Da caixa de comando sai uma ficha doméstica ou industrial para ligar a 

uma tomada. 

• Modo 4 - É definido como a ligação indireta do VE à rede de alimentação utilizando um 

carregador externo no qual o condutor-piloto de controlo vai até ao equipamento 

ligando-se de uma forma permanente à rede de alimentação. É exemplo do Modo 4 os 

carregadores rápidos DC que alimentam a bateria do veículo diretamente em DC, 

fazendo o bypass do carregador de bordo. 

É hoje aceite, quer pela indústria elétrica quer pela automóvel, que o Modo 3 é a solução 

mais adequada para o carregamento de veículos elétricos, pois apresenta importantes vantagens, 

nomeadamente: 

• Ao utilizar tomadas dedicadas para o carregamento de VEs, impedem-se possíveis 

problemas de utilização de correntes superiores ao suportável por tomadas antigas;  

• A segurança adicional que representa a monitorização contínua do isolamento do 

veículo quando em carga;  

• A possibilidade de utilização de diferentes níveis de potência de fornecimento por um 

VE, utilizando a mesma ficha e tomada; 



 8 

• A possibilidade intrínseca do encravamento das fichas do cabo de ligação, na tomada 

de fornecimento e do veículo, durante a sessão de carregamento, o que evita 

desconexão da ficha em tensão; 

• A possibilidade intrínseca de a tomada estar sempre sem alimentação, quando não está 

em utilização, através da monitorização do circuito de “piloto de controlo”.  

• A possibilidade do estabelecimento de uma sessão de comunicação entre a tomada de 

fornecimento e o veículo, que permite a coordenação do carregamento do veículo com 

a disponibilidade dos recursos de rede. 

Não obstante às vantagens do Modo 3, é importante manter aberta utilização do Modo 1 e 

2, pois isso permite que qualquer veículo carregue em qualquer lado, o que é uma importante 

vantagem para o paradigma de mobilidade elétrica.  

 

2.5 Impacto dos Veículos Elétricos 
Atualmente, é dada grande atenção aos VEs no que toca às alterações climáticas dado que o 

sector de transportes é considerado o segundo maior responsável por emissões CO2 [18]. O 

desenvolvimento em massa de VEs pode ser uma boa solução em alternativa ao consumo 

excessivo de combustíveis fósseis e, eventualmente, poluição do ar. Face a este facto, é natural o 

rápido crescimento da população de VEs que se observa nos dias hoje.  

Contudo, este desenvolvimento abrupto acarreta impactos adversos em diferentes cenários. 

Estes impactos podem variar em função no nível de penetração de VEs, nas características das 

suas baterias, nas estratégias de carregamento, estilos de condução, tempos de carregamento, 

estado de carga (State of Charge - SOC) da bateria, distâncias de condução, estratégias de 

fornecimento e das tarifas elétricas disponíveis [19][20]. Um VE não emite diretamente CO2, mas 

pode ser mais prejudicial que um veículo de combustão padrão caso a energia utilizada provenha 

de fontes não renováveis. 

No geral, os impactos dos VEs podem ser classificados em 3 categoriais principais mostradas 

da Figura 1 e detalhadas nas seguintes subseções.  

Figura 1 - Classificação dos impactos dos VEs 

Impactos dos 
VEs

Impacto na rede 
elétrica

Impacto 
ambiental

Impacto 
económico



 9 

2.5.1 Impacto dos VEs nas redes de energia elétrica 
O impacto dos VEs tem um papel crucial na fiabilidade de um SEE que é essencial no que 

diz respeito à qualidade de abastecimento. Pode-se ter fatores positivos e negativos, tal como a 

Figura 2 indica: 

 
Figura 2 – Impactos dos VEs nas redes de energia elétrica 

2.5.1.1 Aumento do pico de procura 
Vários estudos foram conduzidos de modo a examinar o impacto do carregamento de VEs 

durante picos de procura na rede. O incremento causado pelos VEs neste período foi investigado 

em [21]. Foi determinado, pelos autores, que o carregamento completo não coordenado de VEs 

com alta penetração durante o período de ponta pode, por vezes, ser superior à capacidade de 

geração de energia elétrica em alguns dias de maior procura. Com isto, concluiu-se que 93% dos 

carregamentos deveria ser desviado para intervalos de menor procura caso a capacidade máxima 

de geração se mantivesse constante.  

Num estudo semelhante, Wang e Paranjape [22], mostraram que, com 30% de penetração 

de VEs e com carregamento não controlado, o pico de procura numa rede de distribuição 

residencial representada por um alimentador de teste IEEE de 34 nodos [23], iria aumentar em 

53%. 

 

2.5.1.2 Recurso de resposta à procura e armazenamento de energia 
Os VEs podem ajudar a equilibrar o balanço procura-oferta de uma rede.  Usando métodos 

de carregamento coordenado é possível, através da deslocação do período de carregamento, 

Impactos dos 
VEs nas redes 

de energia 
elétrica

Impactos 
positivos

Recurso de 
resposta à 

procura e de 
armazenamento 

de energia

Impactos 
negativos

Aumento do 
pico de procura

Qualidade de 
energia

Distorção 
harmónica

Desequilibrio 
das tensões

Tremulações

Auemento das 
perdas de 
energia

Sobrecarga dos 
transformadores

Instabilidade de 
tensão 



 10 

preencher cavas no diagrama de carga, minimizar a ponta de procura (reduzindo assim os custos 

da rede) e possibilitando preços de carregamento mais baixos. Em [24] e [25], conseguiu-se reduzir 

a ponta sem adicionar capacidade de geração extra recorrendo a carregamentos inteligentes ou 

controlados e servindo-se de tarifas especiais. 

É possível, recorrendo a uma frota de VEs, absorver excessos de geração de renovável e 

compensar rápidas reduções atuando como um grande sistema de armazenamento de energia, 

possibilitando a integração de mais energias renováveis. Este cenário é conhecido como Vehicle 

to Grid –  Veículo para a Rede, abreviado na literatura inglesa como V2G, consiste em utilizar as 

baterias do VE para armazenar energia durante o período de carregamento quando ligadas à rede 

de distribuição. É uma tecnologia que aumenta a fiabilidade e diminui os custos de um SEE. O 

rápido fornecimento de energia que este método permite, é uma maneira eficaz de contribuir para 

a qualidade de energia mitigando as flutuações de tensão, auxiliando nos períodos de ponta e 

diminuindo as perdas no SEE em que está incluído. Em contrapartida, é uma técnica que provoca 

um grande desgaste nas baterias levando a uma substituição das mesmas prematuramente. Com as 

baterias que existem neste momento no mercado, é um sistema que ainda não atrai os 

consumidores devido à não rentabilidade. 

 

2.5.1.3 Qualidade da energia 
A crescente penetração de VEs numa rede de distribuição pode afetar a qualidade de 

fornecimento. Vários estudos averiguaram o impacto a nível da instabilidade da tensão, distorção 

harmónica, desequilíbrio de tensões, tremulações, aumento das perdas e sobrecargas de 

transformadores. 

 

2.5.1.3.1 Instabilidade de tensão 

Entende-se a instabilidade de tensão como a capacidade do SEE, dada uma condição inicial 

de operação, reganhar um estado de equilíbrio depois de sujeito a um distúrbio. A crescente 

penetração de VEs pode originar problemas ao nível da tensão dado que as suas caraterísticas de 

carregamento são diferentes das de uma casa tradicional ou cargas na indústria. Os VEs são cargas 

não-lineares1 que consomem uma quantidade de energia considerável durante um curto período 

de tempo durante o seu carregamento que, como consequência, influencia a estabilidade da tensão 

[26].  

                                                
1 Uma carga é dita não-linear quando a corrente que ela absorve não tem a mesma forma da tensão que a 

alimenta. 



 11 

2.5.1.3.2 Distorção harmónica 

A presença de harmónicos é sinónimo de uma onda de tensão ou corrente deformada. Essa 

deformação significa que a distribuição de energia elétrica é perturbada e que a sua qualidade não 

é ótima. Os harmónicos são causados por cargas não lineares e têm um impacto económico 

considerável. Provocam o envelhecimento precoce do material, por vezes implicam o 

sobredimensionamento do sistema e aumentam as perdas de energia. Estes harmónicos geralmente 

provocam o aquecimento dos equipamentos como transformadores, fusíveis e, por vezes, originam 

o aparecimento de uma corrente no neutro da rede que pode acarretar problemas caso seja 

sobrecarregado [27]. 

 

2.5.1.3.3 Desequilíbrio das tensões 

A variação da tensão num sistema trifásico é uma condição em que a as amplitudes das 

três fases não é igual ou o desfasamento entre elas é diferente de 120º. Este fenómeno ocorre nas 

redes de distribuição quando há um sobre carregamento de uma ou várias fases de um sistema 

multifásico devido ao desequilíbrio de cargas. Neste caso, devido à elevada potência que os 

carregadores dos VEs necessitam é um fenómeno comum de ocorrer. 

 

2.5.1.3.4 Tremulações  

A tremulação da tensão trata-se de uma interrupção não completa do fornecimento de 

energia em que há uma redução da tensão eficaz durante um período de 10 ms a 1 mim [28]. Ocorre 

numa rede de distribuição quando há um curto-circuito, sobrecarga ou arranque de motores 

elétricos de potência considerável. Para estimar as consequências da integração de VEs numa rede 

de distribuição, Lee et al. [29], criaram um modelo de um carregador de um VE. A simulação 

mostrou que as tremulações excediam os limites padrão IEEE [30] com apenas 20% de penetração. 

 

2.5.1.3.5 Aumento das perdas de energia 

A penetração em massa de VEs pode afetar a rede de distribuição de tal maneira que a 

quantidade de perdas de energia nas linhas pode aumentar drasticamente.  

De maneira a calcular as perdas provocadas pelos VEs num cenário de elevada penetração, 

Papodopoulos et al. [31], utilizando uma aproximação probabilística em que incluía intensidade 

de carregamentos e durações de carga incertas, mostrou que as perdas iriam aumentar 9%.  

Semelhantemente, Pieltain et al. [32], com três cenários diferentes de penetração, 35%, 51% e 

62%, usaram um modelo que não dependia do horário de carregamento ou padrões. Os resultados 

mostraram um incremento das perdas que iria dos 10% até, no pior cenário, 40%. 



 12 

 

2.5.1.3.6 Sobrecarga dos transformadores 

A penetração em larga escala de VEs numa rede de distribuição produz uma pressão 

adicional nos transformadores de distribuição.  

Em [33], os autores concluíram que, com uma penetração de VEs de apenas 20%, alguns 

transformadores de distribuição iram estar no limite de funcionamento nominal, sendo estes 

equipamentos os que podem vir a limitar a expansão da mobilidade elétrica em algumas regiões 

[34]. 

 

2.5.2 Impacto ambiental dos VEs 
A energia dos VEs puros e dos híbridos Plug-in provém da rede de energia elétrica ao 

contrário dos transportes tradicionais que implicam a queima de combustíveis fósseis. Posto isto, 

as emissões de GEE durante a fase de operação são nulas quando se opta por usar um VE desde 

que, a energia derive de fontes “limpas”, tais como fontes de energia renováveis.  

De modo a calcular as emissões de CO2 e outros poluentes por km, Donateo et al. [35] 

propôs uma metodologia que incluía o consumo de energia e a diversidade de geração para cada 

evento de carregamento e níveis de emissão. O estudo apresenta as vantagens da mobilidade 

elétrica em termos de dióxido de carbono, monóxido de carbono, monóxido de nitrogénio e outras 

partículas poluentes.  É também concluído que um VE é o veículo que tem as emissões well-to-

wheel – “do tanque às rodas” mais baixas. Sendo well-to-wheel um parâmetro usado para calcular 

as emissões durante todo o ciclo de vida de um veículo, desde a sua produção à utilização. 

Um modelo que avalia as emissões de GEE num cenário de adoção em massa de VE foi 

investigado em [36]. Os impactos foram calculados para dois anos específicos com um intervalo 

de dez anos entre eles. Nos primeiros anos, o estudo revelou que, carregando os VEs durante 

períodos de vazio ou preenchendo cavas no diagrama de carga resultou numa maior libertação de 

GEE, devido à percentagem elevada de geração recorrendo a centrais a carvão. Contudo, na 

segunda parte do estudo, com a remoção das centrais a carvão, verificou-se uma redução de 85% 

de emissões de CO2 no sector de transporte na Dinamarca. 

Lund e Kempton [37] mostraram que, mesmo sem inclusão de energia eólica, o uso de VE 

pode mitigar significativamente a emissão de CO2.  

Num estudo similar [38], foram comparadas as emissões de CO2 por quilómetro percorrido 

de um Nissan Leaf. A análise envolveu três países com emissões de produção de energia distintas 

obtendo os resultados da Figura 3. Na França, país com baixas emissões, o carregamento das 

baterias implica uma libertação de 83 gCO2/km, já para Portugal o valor sobe para os 122 gCO2/km 

e, no caso de um país com elevadas emissões, a Polónia, atinge-se 210 gCO2/km. 



 13 

 
Figura 3 – Impacto de emissões de um Nissan Leaf por km para diferentes modos de condução [38] 

Num outro estudo [39], foi investigado os impactos dos VE num ambiente urbano com 

uma penetração de 50%. Os autores verificaram a redução de monóxido de nitrogénio (responsável 

por chuvas ácidas e nevoeiros químicos) e de dióxido de nitrogénio (gás irritante para os pulmões 

que diminui a resistência às infeções respiratórias) em 15% e 5,5%, respetivamente.  

 Em suma, carregar um VE numa rede elétrica que tenha como base energia proveniente de 

queima de carvão ou gás natural, emite mais gases prejudiciais face ao uso de um veículo 

tradicional [40]. Em situação onde haja integração de energia renovável as emissões são reduzidas 

[41]. 

 

2.5.3 Impacto económico dos VEs 
Os impactos económicos dos VEs podem ser observados de duas diferentes perspetivas: 

do lado do proprietário e do lado das entidades responsáveis pela gestão das redes de energia 

elétrica [42].  

Do ponto de vista do proprietário, os custos de manutenção e de utilização de um VE é 

inferior ao de um veículo tradicional devido à maior eficiência do motor elétrico face ao MCI [43]. 

Em contrapartida, o custo inicial de adquisição de um VE é ainda elevado comparado com veículos 

com MCI. Contudo, a produção em massa e incentivos à compra podem reduzir significativamente 

os preços dos VEs no futuro.  

Da perspetiva da rede elétrica, a integração de VEs num SEE aumenta a complexidade, os 

custos do sistema e as perdas. Contudo, uma estratégia de carregamento eficiente pode minimizar 

esses aspetos adversos [44][45].  



 14 

 

3 Carregamento Coordenado de Veículos Elétricos  

Tal como descrito anteriormente, o desenvolvimento da mobilidade elétrica pode ter impactos 

negativos nas redes de energia elétrica, pelo que é necessário encontrar ferramentas que mitiguem 

esses efeitos. Simultaneamente, é necessário manter os utilizadores dos VEs satisfeitos, sendo a 

sua principal preocupação ter as baterias carregadas na altura em que necessitam usar o veículo. 

Contudo, existe um grau de flexibilidade elevado, pois os VEs, geralmente, passam mais tempo 

estacionados do que aquele necessário para carregar as baterias. Assim, pode-se explorar esta 

flexibilidade e mover os carregamentos para um período de tempo em que, por exemplo, o 

consumo de energia seja menor, a geração de energia renovável maior ou os custos menores. Esta 

oportunidade possibilita o desenvolvimento de algoritmos de carregamento inteligentes de modo 

a mitigar os problemas que os carregamentos dos VEs provocam nos SEE. Estes algoritmos 

decidem quando o veículo deve ser carregado e, caso seja permitido, a potência de carregamento 

de modo a atingir os objetivos pretendidos. Neste capítulo serão apresentados vários casos de 

otimização de carregamento de VEs, tendo como principais objetivos minimizar o custo de 

carregamento, minimizar as pontas de procura, melhorar a qualidade dos SEE e maximizar uso da 

energia renovável disponível. 

Tradicionalmente, a oferta de energia é ajustada em tempo real de modo a satisfazer a procura. 

De modo a facilitar este equilíbrio, os consumidores são encorajados, através de tarifas com preços 

mais reduzidos em períodos de pouca procura, a deslocar os seus consumos de maneira a preencher 

as cavas nos diagramas. Esta técnica não só tem um impacto económico positivo para o 

consumidor como, indiretamente, melhora a eficiência dos SEE devido à redução das pontas de 

procura [46] tal como já foi analisado nas secções 2.5.1.1 e 2.5.1.3.5. Ao diminuir as pontas de 

procura, está-se a diminuir a corrente no sistema provocando uma redução de perdas. Outra 

consequência é a diminuição da resistividade das linhas, devido à redução da temperatura 

associada à redução da corrente, que também contribui para a redução das perdas.  

Colocar o VE a carregar em períodos de vazio pode ser o suficiente para os objetivos do 

utilizador. Contudo, para a rede elétrica, tal pode não ser suficiente, pois se todos os VEs 

começarem a carregar à mesma hora, num caso de penetração elevada de VEs, tal pode dar origem 

a uma nova ponta no diagrama de carga. Para mitigar esse problema, é necessário utilizar uma 

estratégia mais robusta e capaz de gerir várias variáveis de controlo, mantendo sempre como 

prioridade a satisfação das necessidades do utilizador.  

O controlo inteligente de carregamento oferece uma potencial solução para acomodar o 

carregamento de uma vasta população de VEs numa rede de distribuição, sem a necessidade de 



 15 

melhorar significativamente as infraestruturas. Existem dois tipos principais de controlo 

inteligente de carregamento: Controlo de Carregamento Local (CCL) e Controlo de Carregamento 

Centralizado (CCC). No CCC, o carregamento de um grupo de VEs é gerido por um controlador 

central. No CCL, o consumidor é o responsável pelo carregamento do seu veículo localmente. O 

CCC tem acesso a mais informação e pode iniciar e interromper os carregamentos para controlar 

a procura de energia global dentro do sistema, sendo mais vocacionada para o equilíbrio de 

geração-procura e qualidade de energia. No caso do CCL não existe um controlador principal e o 

principal objetivo é o de minimizar os custos de carregamento. Este método também pode ter em 

conta as restrições da rede, ajudando a mitigar as pontas de procura, porém não é tão eficaz a nível 

de controlo de qualidade de energia do SEE. Neste capítulo, serão apresentados exemplos de vários 

métodos e, por fim, uma comparação entre eles. 

 

3.1 Controlo de carregamento local 
O algoritmo desenvolvido em [47] é um CCL que usa informação do consumo local de 

modo a determinar o horário de carregamento. Assume-se que é sabido o consumo de energia do 

local onde está estacionado o VE, o SOC, a duração do carregamento e que existe um sistema 

auxiliar de programação de modo a iniciar o carregamento no instante pretendido. O consumo é 

previsto com base o no histórico do edifício e, como tal, o impacto de casas vizinhas e o perfil de 

cargas geral do SEE não é considerado. Assim sendo, o objetivo é minimizar a ponta local de 

procura e a variação do perfil do diagrama de carga. O algoritmo recorre a um modelo de 

programação quadrática, executado separadamente para cada veículo, de modo a encontrar o 

horário ótimo de carregamento.  

 

3.2 Controlo de carregamento iterativo 
O algoritmo introduzido em [48] usa uma técnica iterativa e é um método intermédio entre 

CCL e CCC. O carregamento é na mesma controlado localmente, mas neste caso é considerado 

não apenas o consumo da casa, mas também o das casas vizinhas. Tem como objetivo equilibrar 

o diagrama de carga visto do lado do transformador, tendo um propósito mais geral e abrangente. 

Este algoritmo é baseado no método “first-come-first-served”. Assim, quando um veículo chega a 

casa é avaliado o seu impacto no diagrama de carga geral e calculado o período ótimo de 

carregamento. Ao chegar outro VE a outra residência, o algoritmo é executado novamente apenas 

para este ultimo, tendo em conta os que já estão previamente agendados. 

 



 16 

3.3 Controlo de carregamento centralizado  
O algoritmo introduzido em [49] é um método de CCC. Este considera o histórico de 

consumo de cada casa e as sessões de carregamento programadas que irão ocorrer no futuro na 

área que se está a controlar. Num período de carregamento, é definido antecipadamente o horário 

em que um conjunto de veículos irá carregar. Para tal é necessário saber o horário de chegada, 

horário de saída, SOC e parâmetros de carregamento, tais como a potência absorvida. Baseado 

nesta informação, os horários de carregamento de cada veículo são determinados simultaneamente 

resolvendo um modelo de programação quadrática. É de notar que, em contraste com um modelo 

de CCL iterativo, o CCC apenas tem que ser executado uma vez de modo a encontrar a solução 

ótima. A vantagem é que este considera antecipadamente toda a informação, permitindo uma 

maior flexibilidade de horários. Na Figura 4 são exemplificadas as diferentes abordagens 

anteriormente descritas. 

 
Figura 4 - Exemplo das arquiteturas dos algoritmos: (a) carregamento descontrolado, (b) controlo local, (c) controlo 

iterativo/centralizado 

3.4  Sistema Multi-Agente 
Outra abordagem é baseada num Sistema Multi-Agente (Multi Agent System - MAS). Um 

Sistema Multi-Agente é um sistema computacional em que dois ou mais agentes interagem ou 

trabalham em conjunto de forma a desempenhar determinadas tarefas ou satisfazer um conjunto 

de objetivos [50]. Neste caso, o que define o período de carregamento é o preço da energia, 

considerando os preços de mercado [51]. É de notar que esta coordenação baseada num sistema 

de mercado assume que o preço da energia é usado apenas para controlar o sinal que estimula o 

controlador do carregamento do VE a adiar ou avançar o seu consumo, mas nenhum sistema de 

preço em tempo real está ligado a este tipo de sistema. A grande vantagem da coordenação de 

carregamentos com base num mercado de eletricidade com um sistema MAS é que não requer um 

algoritmo de planeamento central e acomoda um grande número de VEs. Em [52] foi formulado 



 17 

um algoritmo MAS que, segundo os autores, é superior face aos últimos três devido a não 

necessitar dados precisos acerca do carregamento dos VE. 

 

3.5 Comparação de carregamentos inteligentes 
Em [49], os autores do algoritmo CCC apresentado em 3.3, compararam o seu algoritmo 

com outros três algoritmos diferentes. A simulação consistiu num cenário de 63 casas distribuídas 

por 3 postos de transformação, ligados a um transformador de distribuição de 250 kVA. As casas 

possuíam apenas uma ligação monofásica, que são distribuídas uniformemente pelas 3 fases do 

sistema. Como histórico de consumo das residências foram usados dados reais recolhidos na 

Bélgica durante o inverno (pior cenário devido ao maior consumo de energia) e atribuídos 

aleatoriamente às casas da simulação. Os 4 métodos foram simulados para 3 tipos de cenários 

(número baixo, médio e elevado de VEs ligados à rede). A Figura 5 mostra a carga vista pelo 

transformador de distribuição num cenário descontrolado e num cenário controlado com média 

penetração de carregamento de VEs.  

  
Figura 5 - Comparação do impacto dos diferentes métodos de carregamento no diagrama de carga [49] 

É visível que o carregamento descontrolado conduz a um aumento substancial no ponta de 

carga chegando quase aos 200 kW (para o cenário de média penetração). Com carregamento 

coordenado esta ponta reduz-se para menos de metade. No algoritmo local (QP1) e no algoritmo 

baseado no sistema multi-agente (MAS) os resultados foram muito similares: 53,84% e 53,19%, 

respetivamente. No método iterativo (QP2) e centralizado (QP3) a redução da ponta foi 

ligeiramente superior atingindo os 58,73%. É de notar que, com estes dois últimos dois métodos, 

a ponta máxima não ultrapassou o valor do cenário original em que não existem VEs a carregar 

nessa rede. O método local apenas remove 92% da ponta adicional, pois apenas considera a ponta 

de cada casa individualmente, movendo o carregamento para um período fora da ponta dessa casa, 

mas que pode não ser compatível com as casas vizinhas. O método baseado no mercado de energia 

também sofre do mesmo problema eliminando apenas 90,64% da ponta no caso do cenário 

intermédio.  



 18 

Outro fator importante é a variação do perfil de carga pois influencia o despacho das centrais 

de produção. Idealmente, quanto menor a variação melhor o será o perfil sendo esta variação 

calculada através do desvio máximo e mínimo do diagrama. Comparando com o cenário de 

carregamento descontrolado, todos os algoritmos melhoram a estabilidade do perfil, no entanto, 

verifica-se uma grande diferença entre o método baseado num mercado MAS e os que utilizam 

programação quadrática. Dentro destes últimos, como seria de esperar, é com o algoritmo 

centralizado que se consegue um melhor perfil, visto haver um maior leque de informações que 

podem ser utilizadas para assegurar a coordenação. O MAS reduziu a variação em 34,91%, 

enquanto que o CCC, reduziu em 60,50%.  

Em suma, as abordagens baseadas em programação quadrática são superiores, em termos de 

controlo da ponta de procura e variação no perfil de carga, às que usam sistemas multi-agente. Em 

contrapartida, as que utilizam um MAS requerem menos conhecimentos, são mais fáceis de 

implementar e de adaptar para diferentes objetivos. Assim, se o objetivo for apenas limitar a ponta 

de procura, o MAS pode ser suficiente. Se a variação do perfil de carga for relevante, já será 

necessário optar por um método iterativo ou global. 

Em [53], foi realizado um estudo, usando também programação quadrática, para resolver o 

problema de otimização de forma a comparar algoritmos de CCC e de CCL. As principais 

conclusões obtidas das simulações provam que as abordagens baseadas em CCC fazem um melhor 

uso das capacidades da rede e conseguem um melhor controlo de tesão visto toda a informação ser 

conhecida pelo controlador central. Em contrapartida, o CCC necessita uma infraestrutura de 

comunicação significante confrontado com métodos CCL. 

Os autores de [54] comparam também vários métodos de controlo de carregamento com o 

objetivo de otimizar o custo de produção de energia elétrica. Os resultados das simulações 

mostraram que a melhor solução, em termos de custo, é obtida através de carregamento 

centralizado, mas o CCL, conseguiu obter resultados igualmente satisfatórios. Assim sendo, os 

autores concluíram que o método CCL é preferível uma vez que consegue bons resultados, requer 

menos capacidade de comunicação e, muito importante, tem uma maior aceitação por parte dos 

consumidores devido à maior privacidade face a um CCC. 

Colocados todos estes estudos em cima da mesa e fazendo uma análise geral, é visível a 

superioridade do CCC face ao CC iterativo, CCL e MAS no entanto, poderá não ser a melhor 

solução em alguns cenários. O CCC peca a nível de custo de implementação, privacidade e 

complexidade de funcionamento e comunicação. Outro fator importante é o nível de penetração 

de VEs, pois em caso de ser reduzido, qualquer método apresenta soluções válidas, já para alta 

penetração uma arquitetura centralizada é a melhor solução de modo a tirar proveito e otimizar a 

rede.  



 19 

Dado que em Portugal o número de VEs ainda é muito reduzido quando comparado com o 

total existente não será necessário recorrer a algoritmos centralizados de modo a ter bons 

resultados. Como observado anteriormente, para níveis de baixa penetração o CCC é idêntico ao 

CC iterativo o que nos leva a optar pelo segundo não só pelos resultados como também pela 

simplicidade face ao primeiro. Notar ainda que este é mais eficaz que o CCL afirmando ainda mais 

a escolha do método iterativo. 

De modo a complementar este trabalho e ter um outro método de comparação, será também 

elaborado um algoritmo que recorra a um MAS, ou seja, irá coordenar os VEs tendo como base o 

preço da energia elétrica.   



 20 

 

4 Problema 

4.1 Excesso de produção de energia 
Para combater as mudanças climáticas e cumprir objetivos ambientais é natural o crescimento 

das energias renováveis. Portugal não foge à exceção e já conta com uma capacidade de produção 

de renováveis de 13036 MW de um total de 19518 MW instalada (dados referentes a finais de 

2016). Portugal é assim um dos países da União Europeia que consome mais energia proveniente 

de fontes renováveis tendo este consumo chegado aos 57% em 2016 [55]. 

Todavia, parte desta geração renovável não é totalmente controlável. Um exemplo disso é o 

sector eólico que conta com uma capacidade instalada de 5046 MW. No dia 2 de janeiro de 2017 

a REN registou um valor máximo instantâneo de 4532 MW, no entanto há dias em que não se 

verifica uma terça parte deste valor. Este desvio dá origem a excessos de produção em dias muito 

ventosos que coincidam com dias de elevada produção hídrica ou quando o consumo é baixo. 

Esta situação é muito comum e, apesar dos vários incentivos de desvios de carga para 

períodos noturnos, como tarifas bi-horárias, o excesso de energia irá ocorrer cada vez mais devido 

ao aumento futuro de geração renovável. Adicionalmente, atualmente a energia é sempre paga ao 

produtor a um preço pré-definido e, num cenário onde a produção é superior à procura, o preço de 

venda da energia tende para zero provocando um défice no sistema [56].  

 

4.2 Exportação e armazenamento 
Quando não é possível consumir a totalidade da geração os gestores dos SEE deparam-se 

com dificuldades para os manterem estáveis e dentro dos parâmetros de funcionamento. 

Geralmente o excesso de produção em Portugal deve-se a níveis elevados de energia eólica e 

hídrica. Como tais recursos não variam substancialmente entre Portugal e Espanha, quando há 

excesso num país, por norma também há no outro. Esta realidade impossibilita a exportação de 

grandes quantidades de energia visto que Espanha é o único potencial importador de Portugal.  

Uma outra alternativa para mitigar este excesso é armazenando a energia recorrendo a 

bombagem. As centrais hidroelétricas, equipadas com bombagem, permitem usar o excesso de 

produção eólica. Em períodos de menor consumo do dia, e de grande produção eólica, esta energia 

pode ser aproveitada para bombear a água das albufeiras para posterior turbinamento nas horas de 

ponta. Desse modo, é possível a sua reutilização para produzir nova energia hidroelétrica em 

períodos mais rentáveis. Isto permite um melhor aproveitamento de projetos eólicos e hídricos nas 



 21 

centrais que disponham do sistema de bombagem, assegurando uma complementaridade hídrica-

eólica, tal como é apresentado na Figura 6. 

 

 
Figura 6 – Complementaridade Hídrica [57]  

A grande capacidade de armazenamento com um arranque rápido que estas centrais possuem 

também é um aspeto positivo, sendo possível entrarem em serviço em poucos minutos quando se 

verifica períodos de aumento de consumos. No entanto, os locais para a construção destas centrais 

são limitados, requer custos iniciais elevados assim como o tempo de construção e há perdas 

inerentes ao processo de armazenamento [58]. 

A bombagem em Portugal conta com uma potência instalada de 2437 MW. Em 2016 

consumiram 1519 GWh dos quais se reaproveitaram 1217 GWh [55]. A Figura 7 apresenta o 

diagrama de consumo total do dia 2 de janeiro de 2017 onde se pode verificar o excesso de 

produção principalmente devido à eólica. De salientar que, das 00:00H até por volta das 11:00H, 

se realizou bombagem que teve uma ponta máxima de 1823 MW e um consumo de 8,6 GWh, mais 

2,8 GWh do que no dia homólogo do ano anterior. 



 22 

 
Figura 7 - Diagrama de consumo total para o dia 2 de janeiro de 2017 (Fonte REN)	

4.3 Veículos elétricos como complemento 
No futuro, os carregamentos inteligentes serão necessários de modo a prevenir pontas de 

procura elevadas e outras adversidades. Se esse problema for aliado ao excesso de energia, pode-

se colmatar várias questões com apenas uma solução. Assim, com o carregamento coordenado de 

VEs focado no aproveitamento do excesso de energia renovável, não só se reduz as pontas de 

procura, como também as emissões de CO2, aumenta-se a qualidade da energia nos SEE, 

equilibram-se os diagramas de carga e consegue-se reduzir os custos de carregamento das baterias 

dos VEs. 

Um estudo feito em Portugal em 2011 [59], concluiu que os portugueses viajam uma média de 

30 km por dia o que, admitindo um consumo variável entre 0,10 e 0,2 kWh/km [38] dá uma média 

diária de 3 - 6 kWh por dia ou aproximadamente 1096 – 2192 kWh por ano caso essa pessoa 

circule num VE. Aliando a bombagem realizada em 2016 (1519 GWh) ao balanço das exportações 

(5085 GW) [55] é possível calcular que essa energia (6604 GWh) daria para entre 3 e 6 milhões 

de VEs circularem durante um ano (admitindo a média portuguesa de 30 km/dia). Notar que, 

apenas a bombagem, daria para 0,7 a 1,4 milhões de VEs enquanto que a exportação daria para 

2,3 a 4,6 milhões de VEs. 

Segundo a Associação do Comércio Automóvel de Portugal (ACAP), em 2015 existiam 

aproximadamente 4,5 milhões de veículos em circulação em Portugal o que significa que, num 

cenário utópico em que a penetração de VE fosse 100%, a energia exportada atualmente em 

conjunto com a utilizada em bombagem em Portugal já seria suficiente para satisfazer as 

deslocações dos portugueses.   



 23 

Segundo a Associação de Utilizadores de Veículos Elétricos (UVE), existem atualmente cerca 

de 5500 VE em Portugal (dando um consumo médio anual entre 6028 MWh e 12056 MWh). Esta 

alternativa seria um bom complemento à bombagem e preferível à exportação uma vez que, os 

preços são, geralmente, mais baixos do que os de comercialização.  

 

 

  



 24 

 

5 Descrição do Algoritmo 

A maioria dos utilizadores de VEs carrega o seu veículo durante a noite para se poder deslocar 

no dia seguinte. A sua rotina passa por chegar a casa e ligar o veículo à rede da mesma maneira 

que faz com o seu telemóvel. O problema é que um VE é uma carga que pode consumir até dezenas 

de kWh e pode ter um grande impacto quando se pretende carregar milhares ao mesmo tempo. 

Alguns utilizadores mais avançados já possuem sistemas que apenas carregam o VE em períodos 

onde a energia é mais barata. No entanto, esses sistemas não têm em atenção as necessidades dos 

SEE podendo até ser ainda mais prejudicial do que iniciar o carregamento imediatamente ao chegar 

a casa, pois podem originar picos de procura devido à simultaneidade do inicio do carregamento. 

Favoravelmente, este trabalho tem como um dos objetivos o aproveitamento do excesso de energia 

renovável, que se verifica principalmente no período noturno coincidente com a maioria dos 

carregamentos residenciais dos VEs.  

Um estudo realizado em novembro de 2016 pela Universidade de Michigan [60] analisou as 

preferências de um grupo de 542 utilizadores norte-americanos de VEs do qual se concluiu que:  

• 73,1% dos inquiridos preferem um carregamento otimizado em detrimento do 

carregamento não inteligente convencional; 

• 65,3% dos inquiridos preferem um algoritmo de gestão que dê prioridade às energias 

renováveis, em detrimento de uma otimização apenas para redução de custos e gestão da 

procura de energia. 

Dado que com este trabalho se pretende conseguir uma redução de custos de carregamento, 

fazendo o aproveitamento de energias renováveis, calculasse que teria uma forte aceitação por 

parte dos consumidores. 

 

5.1 Objetivos 
O objetivo primordial deste algoritmo é o de alocar a carga dos VEs para as horas com 

excesso de produção de energia proveniente de fontes renováveis. Essas horas, geralmente, 

coincidem com o período de menor consumo, sendo assim também um período onde o preço da 

energia no mercado é mais barato. Assim, consegue-se três benefícios principais: 

1. Aproveitar ao máximo o excesso de energia renovável; 

2. Reduzir os custos associados ao carregamento de VE; 

3. Otimizar o diagrama de carga nacional. 

 



 25 

5.2  Dados necessários 

5.2.1 Previsão da produção e consumo energia 
Antes de qualquer cálculo feito pelo algoritmo será necessário possuir alguns dados 

antemão, nomeadamente a previsão do excesso de energia. Para tal será necessário recolher 

informação da previsão da produção de energia disponível em [61] e do consumo esperado 

disponível em [62] (Sistema de Informação de Mercados de Energia REN). No entanto, apesar de 

existir previsão com vários dias de antecedência, a REN só disponibiliza nos seus sites a previsão 

horária. Como tal, para efeitos de simulação, serão usados dados de dias passados, para os quais 

se tem toda a informação do que se consumiu e o que se produziu detalhadamente. Os dados 

recolhidos vêm em modo tabela, disponíveis em [63], onde existe toda a informação com 

estatísticas diárias, com a qual é possível calcular o excesso de energia disponível ficando com o 

aspeto da Figura 8. Estes dados permitirão executar o algoritmo com o objetivo de aproveitar ao 

máximo o excesso de energia renovável. 

 

 
Figura 8 - Diagramas de energia dos dias 2 e 3 de fevereiro de 2017 

 

5.2.2 Preço da energia 
Simultaneamente, será necessário saber o preço da energia durante cada hora do dia. Com 

esta informação, o algoritmo passa a ter como principal objetivo reduzir os custos de carregamento 

para os utilizadores e não o aproveitamento do excesso de energia renovável. Na prática, visto em 



 26 

Portugal ainda não existir uma tarifa em tempo real dos preços, a rede disponibilizará o tipo de 

tarifário que cada utilizador possui de modo a saber o preço da energia.  

Segundo cálculos da Entidade Reguladora do Sector Energético (ERSE), o ponto de 

equilíbrio entre o que se paga a menos na hora de vazio do mercado regulado e a mais fora desse 

período é atingido quando o consumo no primeiro período fica acima de 36% do total, ou seja, se 

o consumo nas horas de vazio for superior a esta percentagem, o cliente tem vantagens na tarifa 

bi-horária. Já se for inferior, é mais vantajoso passar para a tarifa simples.  

De acordo com dados recentes da (ERSE), o consumo médio anual de eletricidade de um 

cliente doméstico português em baixa tensão normal aproxima-se dos 2500 kWh. Assumindo uma 

média anual de consumo de um VE de 1644 kWh (média do consumo calculado em 4.3), e que o 

utilizador não desloca mais nenhum consumo para períodos de vazio sem ser o carregamento do 

VE calcula-se que este período represente cerca de 40% do consumo total. Posto isto, é necessário 

que o utilizador de VE tenha, no mínimo, tarifa bi-horária de modo a aumentar as suas poupanças. 

O algoritmo receberá, da rede, informações do tipo de tarifa do utilizador, contendo o preço 

da energia em cada hora. Para além do aproveitamento do excesso de renovável, irá ser analisado 

um cenário em que se possua bi-horária e, dado que a tendência é para que no futuro as tarifas 

sejam tempo real, será também analisado um cenário de tarifa em tempo real tendo em conta a 

variação dos preços do Mercado Ibérico de Eletricidade (MIBEL).  O preço da energia, como já 

referido anteriormente, é baseado no MIBEL, no entanto, esse preço não é o real pago pelos 

consumidores finais, uma vez que não tem em conta custos de transporte, distribuição, margens 

de lucro, etc. Assim, para se ter valores mais realistas, utilizou-se a variação da tarifa do MIBEL 

mas multiplicada por um fator que a relaciona com o preço final. Considerando uma tarifa bi-

horária esta tem atualmente um preço médio, já com IVA, de 0,1913 €/kWh [64]. Dividindo 0,1913 

pelo preço médio MIBEL tem-se um fator entre 4 e 5 (dependendo dos dias), o que significa que 

os utilizadores vão pagar 4 a 5 vezes mais do que o valor anunciado no MIBEL. 

 

5.2.3 Estado do VE 
Posteriormente, a saber a energia disponível e o seu preço, é necessário saber os dados dos 

VEs que se pretende carregar. Do lado do VE será necessário recolher a capacidade da bateria do 

veículo (em kWh) e o seu SOC atual. Adicionalmente, o utilizador deverá introduzir a potência do 

carregador (em kW), o SOC desejado e a hora a que pretende esse SOC.  

O SOC desejado irá estar por defeito a 100%, no entanto, caso o utilizador não pretender 

a totalidade da bateria, irá ter a possibilidade de alterar este parâmetro. 

A hora prevista de saída irá ser introduzida pelo utilizador tendo espaçamentos de 15 

minutos. Ao introduzir a hora pretendida a que o SOC esteja no nível desejado o SCA irá averiguar 



 27 

se esse valor é possível. Caso não seja possível, deverá alertar o utilizador e indicar duas 

alternativas possíveis: 

1. A hora em que é possível ter esse SOC; 

2. O SOC que é possível ter à hora prevista de saída. 

Todos os dados introduzidos pelo utilizador serão automaticamente guardados para que, 

da próxima vez, seja um procedimento mais rápido não tendo de voltar a introduzir tudo 

novamente. Ex.: caso o utilizador precise sempre de 100% da bateria às 8h00, não terá necessidade 

de estar sempre a colocar os mesmos dados, o SCA irá informar e perguntar ao utilizador se 

pretende alterar os dados da última sessão. 

Em qualquer momento o utilizador pode cancelar o carregamento inteligente. Caso o 

utilizador se engane a introduzir os dados poderá cancelar o agendamento, introduzir novamente 

os dados e dar reentrada no sistema. 

 

5.3 Equipamentos necessários 

5.3.1 Sistema de Controlo Auxiliar 
Admite-se que os veículos possuem um Sistema de Controlo Auxiliar (SCA) com 

capacidade de comunicação bilateral que envia dados do veículo e recebe ordens do Sistema de 

Controlo Central (SCC) para iniciar o carregamento, pelo que, o SCA deverá ter as seguintes 

funcionalidades: 

§ Capacidade de avaliação do VE, isto é, tem de conseguir recolher os seguintes dados 

de informação do VE: 

• SOC da bateria (0 – 100%); 

• Capacidade da bateria (em kWh). 

§ Tem de ter a possibilidade de introdução dos seguintes dados: 

• Tipo de carregamento (normal ou inteligente); 

• Hora prevista de partida (em intervalos de 15 mim). 

• SOC desejado (em %); 

• Potência do carregador (em kW); 

Todos os dados devem ser, posteriormente, enviados ao SCC de modo a que se proceda 

aos cálculos do período de carregamento. 

 



 28 

5.3.2 Sistema de Controlo Central 
O SCC é um dispositivo que recebe informações de todos os VE ligados ao sistema e 

calcula em tempo real o melhor horário de carregamento para cada VE individualmente e de forma 

iterativa, tendo em conta os seguintes aspetos: 

• Excesso de produção de energia renovável; 

• Custo da energia a cada hora; 

• Dados dos VEs. 

 

5.4 Funcionamento do algoritmo 
Para executar o algoritmo o utilizador tem apenas de correr o ficheiro Algoritmo.m (Anexo 

A - Algoritmo.m). Este irá, conforme necessário, executar outros ficheiros auxiliares de modo a 

ter todos os dados necessários para realizar os cálculos finais dos períodos de carregamento de 

cada veículo. 

A Tabela 2 é um resumo dos dados necessários para o algoritmo calcular o período de 

carregamento ideal para um determinado VE. 

 
Tabela 2 – Dados necessários ao algoritmo 

Dados necessários ao algoritmo 
Introduzidos pelo utilizador Recolhidas pelo SCA Necessárias ao SCC 
Potência do carregador (P) Capacidade da bateria (C) 

 
Excesso de produção de energia 
renovável 

Estado de carga desejado (SOCd) Estado de carga atual (SOCa) Custo da energia a cada hora 
 

Hora prevista de Saída (HPS)  Dados dos VEs (introduzidos pelo 
utilizador e recolhidos pelo SCA 

  Hora atual (H) 

 

O SCC garantirá, se possível, que todas as preferências dos utilizadores dos VEs 

relativamente a SOC final e hora sejam satisfeitos. Como é visível na Figura 8, a janela do 

algoritmo será de 2 dias divididas em intervalos de 15 mim tendo assim, no total, 192 períodos 

possíveis de carregamento. De modo a clarificar, o fluxograma do SCC será independente do SCA, 

sendo apresentados e explicados na próxima secção. 

A Figura 9 apresenta o fluxograma do funcionamento do SCA e a Figura 10 apresenta o 

fluxograma do funcionamento do SCC.  



 29 

 
Figura 9 - Fluxograma do SCA 

 



 30 

 
Figura 10 - Fluxograma do SCC 

 

5.4.1 Entrada de dados 
O algoritmo recebe a previsão da geração e do consumo de energia e analisa esses dados 

de modo a obter a curva do excesso de geração renovável, como demonstrado na Figura 8. Estes 

dados poderão ser editados no ficheiro Previsao.m (Anexo B - Previsao.m) onde é possível 

adicionar outros cenários de simulação. Para tal bastar aceder ao site do Centro de Informação da 

REN [63], escolher um dia, fazer o download do respetivo ficheiro Excel e o algoritmo irá 

automaticamente recolher os dados e calcular o excesso de energia renovável. Nesse ficheiro, é 

também necessário colocar a informação do preço da energia a cada hora do MIBEL o qual está 

disponível em [65] e o preço de uma tarifa bi-horária [64], no caso de se querer simular um cenário 

com esses preços. Uma vez que a informação do preço da energia é horária, esses valores serão 



 31 

adaptados para serem trabalhados não num formato de 24 pontos por dia, mas sim 96 (para se ter 

intervalos de 15 mim) e, posteriormente, associados numa variável de 192 pontos, equivalente a 

dois dias.  

Posteriormente, o algoritmo irá carregar uma lista de VEs no ficheiro ListaVE.m (Anexo 

C - ListaVE.m), no qual é possível editar ou adicionar veículos a serem carregados. A lista é uma 

matriz que possui todas as informações necessárias ao agendamento. Nesse ficheiro é ainda 

calculado, aleatoriamente, um SOCa e uma potência do carregador de modo a tornar a amostra 

variável simulando utilizadores humanos como será analisado, posteriormente com mais detalhe, 

na secção 6.1. 

Na prática, o utilizador ao chegar à sua residência, colocará o VE ligado ao SCA que, por 

sua vez, está ligado à rede e ao SCC. O primeiro passo será a escolha entre um carregamento 

“Normal” e “Inteligente” como visível na  Figura 9. Caso opte pelo “Normal” o VE irá iniciar 

imediatamente o carregamento e só vai terminar quando estiver totalmente carregado ou quando 

o utilizador interromper o carregamento. Na opção “Inteligente” será pedido ao utilizador que 

introduza os dados necessários (P, HPS, SOCd). Simultaneamente, o SCA faz uma análise do 

estado do veículo recolhendo os dados do VE (C, SOCa) e enviando-os ao SCC, juntamente com 

as preferências do utilizador. O algoritmo irá simular sempre os dois cenários, normal e inteligente, 

de modo a ter uma comparação final da sua eficácia. 

 

5.4.2 Agendamento 
Após receber toda a informação necessária, o SCC, irá proceder ao cálculo para determinar 

quando um veículo deverá carregar.  

Dado que se irá trabalhar apenas com carregamentos residenciais a potência do carregador 

será muito inferior àquela verificada num posto de carregamento público. Isto trás benefícios no 

que diz respeito à simplicidade uma vez que, tal como demonstrado em [66], a baixa potência, a 

energia consumida por uma bateria durante a fase de carregamento de um VE é constante 

facilitando assim o cálculo da duração do tempo de carregamento em função do SOC e da potência 

do carregador. Posto isto, como se trata de um carregamento com uma potência constante, basta 

executar a Equação 1 obtendo assim o tempo em horas necessário até atingir o SOC desejado. 

 

! =	$%&amp;amp;' ? $%&amp;amp;)* ×	&amp;amp;																																																											(1) 

 

Em segundo lugar, irá calcular quanto tempo o VE tem disponível para carregar e verificar se 

esse tempo é suficiente executando a condição demonstrada pela Equação 2. 



 32 

 

	/*$ ? / &gt; !																																																																									(2) 
 

Caso demore mais tempo a carregar do que aquele que tem disponível irá ser apresentada uma 

mensagem de erro ao utilizador com a informação da percentagem do SOC da bateria à hora 

prevista de saída introduzida e a hora a que estará disponível o SOC desejado. Se o veículo tiver 

tempo necessário para o carregamento pretendido ir-se-á dar início ao algoritmo principal 

exemplificado na Figura 10. De notar que, por exemplo se a hora atual (H) for 12h do dia 2 e a 

hora prevista de saída (HPS) for 8h o algoritmo irá assumir que, como HPS &amp;lt;H, a HPS será no 

dia seguinte por isso irá somar-lhe 24 horas ficando HPS = 32. 

Estes passos descritos anteriores serão executados no ficheiro Tempo.m (Anexo D - 

Tempo.m) sendo a mensagem de erro e as respetivas informações calculadas no ficheiro Erro.m 

(Anexo E – Erro.m).  No ficheiro principal, Algoritmo.m (Anexo A - Algoritmo.m), como se está 

a simular dados de dias passados, foi definida uma hora H com um valor de 12, ou seja, o algoritmo 

interpreta que sejam 12:00h do primeiro dia dessa simulação. Esse valor poderá ser alterado pelo 

utilizador, no entanto, caso escolha um valor elevado (por exemplo 22), os VEs que tenham uma 

hora prevista de chegada no algoritmo antes das 22h serão considerados pelo sistema, entradas do 

dia seguinte podendo não haver tempo suficiente para carregarem pois só estará disponível uma 

janela das 22h às 24h do segundo dia.  

Em terceiro lugar, o SCC irá verificar a janela possível de carregamento e ordená-la conforme 

o objetivo pretendido no ficheiro Janela.m (Anexo F - Janela.m): 

• Caso o objetivo seja o aproveitamento ao máximo do excesso de energia renovável, o 

algoritmo irá ordenar os períodos de tempo disponíveis por ordem decrescente de 

excesso; 

• Caso se pretenda reduzir os custos, o algoritmo irá ordenar os períodos de tempo por 

ordem crescente em função do custo da energia. 

Após a ordenação, vão ser atribuídos vários períodos de carregamento a esse VE como 

exemplificado na Figura 11 onde foi simulado um veículo que chegou às 20h ao local de 

carregamento, com um SOCa de 80%, um SOCd de 100%, HPS 7h com P = 4 kW e C = 30 kWh. 



 33 

 
Figura 11 – Informação mostrada na janela de comandos do Matlab 

A variável “excesso_adaptado_ordenado” é a lista dos períodos possíveis para o VE carregar. 

A primeira coluna é a hora (em períodos de 15 mim), a segunda coluna é o excesso de energia 

renovável e a terceira é o custo da energia nesse período (em €/MWh). Como o objetivo deste 

exemplo é o aproveitamento do excesso de renovável, a matriz será ordenada por ordem 

decrescente da coluna 2. Como o VE só necessita de 6 períodos de um total de 43 disponíveis, 

logo o algoritmo irá alocar os 6 primeiros períodos da lista “excesso_adaptado_ordenado” a esse 

veículo (29, 30, 29.25, 30.25, 30.5 e 29.75), retirando 24 horas, 5h, 6h, 5:15h, 6:15h, 6:30h e 5:45h, 

ou seja, irá carregar das 5h às 5:30h e das 5:45h às 6:45h). No fim, à matriz inicial que contem os 

períodos com o respetivo excesso e custo da energia, ir-se-á subtrair a energia que este VE irá 

consumir de modo a ter a nova curva para efetuar com rigor os cálculos para o próximo veículo 

que der entrada no sistema. Após todos os cálculos e as respetivas atribuições de períodos a cada 

VE são criados vários gráficos no ficheiro Plot.m (Anexo G - Plots.m), com os resultados obtidos.  

De modo a testar a efetividade dos algoritmos para cumprir o terceiro objetivo, suavização do 

diagrama de carga, é realizada uma comparação do antes e depois no ficheiro 



 34 

PlotsComparativos.m (Anexo H – PlotsComparativos.m). Nesses gráficos poder-se-á analisar o 

impacto no diagrama de carga do carregamento de todos os veículos. 

No fim é possível visualizar a lista de VEs atualizada, por ordem de chegada, e com a 

informação do custo de carregamento nas últimas três colunas da matriz dos três diferentes 

métodos usados. Essa lista estará guardada na variável ListaOrdenada (Anexo H – Lista VE final) 

onde também é possível verificar o número de períodos necessários ao carregamento de cada VE 

na oitava coluna. 

  



 35 

 

6 Testes e resultados 

Neste capítulo serão testados 3 algoritmos em 2 cenários distintos, com 2 variantes (preço da 

energia), dando um total de 12 simulações. O primeiro cenário será um dia típico de inverno, 

simulado com dados de energia dos dias 2 e 3 de fevereiro de 2017, que foi um dia com excesso 

de energia renovável típico desta estação. Em contrapartida, de modo a simular um cenário oposto, 

recorreu-se a dados de aproximadamente meio ano antes, nomeadamente 9 e 10 de agosto de 2016, 

um cenário de verão em que é difícil haver excesso pois há menos produção renovável proveniente 

de eólicas e as centrais hidroelétricas ficam limitadas devido à pouca precipitação. Em ambos os 

casos foram executadas três simulações cada uma com um algoritmo diferente:  

• a primeira com o objetivo de aproveitar ao máximo o excesso de renovável; 

• a segunda com o objetivo de reduzir ao máximo os custos de carregamento; 

• a terceira que simula carregamentos normais, sem usar qualquer tipo de sistema 

inteligente. 

Os 3 casos foram executados 2 vezes com preços de energia diferentes, um com uma tarifa 

bi-horária e outro em função da variação do preço do MIBEL. É muito importante notar que ambos 

os cenários são referentes a dias úteis e não a fins-de-semana, de modo a simular com coerência o 

dia-a-dia dos utilizadores portugueses de VEs. 

Com estas simulações espera-se poder analisar os seguintes impactos: 

• Impactos que os algoritmos têm no aproveitamento de energia renovável e no 

diagrama de carga; 

• Impacto no custo de carregamento da utilização de um carregamento inteligente; 

• Impacto no diagrama de carga de carregamentos não inteligentes e semi-inteligentes 

(agendamento do carregamento em função do custo de energia, em especial com 

tarifa bi-horária) em que é esperado que os veículos comecem a carregar, 

sensivelmente, todos à mesma hora, causando um pico de consumo; 

• Comparação de impactos e vantagens de um carregamento inteligente face a um 

semi-inteligente e outro não inteligente; 

 

6.1 Dados necessários 
Antes da execução das simulações é necessário possuir de antemão alguns dados de modo a 

emular a entrada de VEs, hábitos dos utilizadores e as suas preferências. 



 36 

  A população será composta em função da percentagem dos VEs mais vendidos em Portugal 

tendo como base dados da Tabela 3. 

 
Tabela 3 - Vendas de VEs em Portugal [67] 

	 2011	 2012	 2013	 2014	 2015	 2016	 2017	 TOTAL	
VENDAS		 210	 161	 224	 362	 1305	 1970	 1289	 5521	

PERCENTAGEM	(%)	 3,8	 2,9	 4,0	 6,6	 23,6	 35,7	 23,4	 100	

 

Dado que, de janeiro de 2011 até dezembro de 2014 o número de VE vendidos em Portugal 

foi de apenas 957 unidades (correspondendo a 17,3% do total existente) e de forma a possuir uma 

lista de VEs modernos e mais atual principalmente a nível de capacidade das baterias, apenas serão 

contabilizados os VEs vendidos entre janeiro de 2015 e maio de 2017. Dessa lista, são 

considerados os 10 mais vendidos ficando a Tabela 4. A população de VEs será então constituída 

tendo como base as percentagens dos VEs da Tabela 4.  

 
Tabela 4 - Modelos de VEs mais vendidos em Portugal [67] 

	 VEÍCULO	 VENDAS	 %	 BATERIA	(KWH)	

1	 Nissan Leaf 695	 20	 30	

2	 Mitsubishi Outlander PHEV 613	 17	 12	

3	 Renault Zoe 561	 16	 41	

4	 BMW i3 466	 13	 33	

5	 Mercedes C350e 461	 13	 6,2	

6	 Volvo V60 Plug-In 261	 7	 8	

7	 BMW 330e 214	 6	 7	

8	 Renault Twizy 100	 3	 6,1	

9	 BMW 225xe Active Tourer 97	 3	 7,6	

10	 Volkswagen Passat GTE 90	 2	 9	

	 Total 3558	 100	 	

 

Admitindo um consumo médio variável entre 3 kWh e 6 kWh por dia, calculado na secção 

4.3, foram gerados valores aleatórios entre 3 e 6 para obter valores diferentes para o SOC atual 

dos VEs a carregar, tornando assim a amostra mais aleatória. Por defeito, o SOC desejado será 

100%, com a possibilidade de alteração por parte do utilizador. 



 37 

Relativamente à potência do carregador, existe um vasto leque de carregadores disponíveis 

e potências variáveis para promover o carregamento de um VE. Tendo em conta que o foco deste 

trabalho é em carregamentos domésticos irão ser tomados valores compreendidos entre 10 A e 32 

A, o que corresponde a uma potência (para 230 V) de 2,3 kW a 7,36 kW. Nas simulações, serão 

gerados números aleatórios entre 2300 e 7360 e associados à coluna correspondente à potência do 

carregador. Na prática, este valor será inserido pelo utilizador.  

A hora de entrada no sistema e hora prevista de saída é, talvez, o passo mais difícil de 

prever uma vez que depende de fatores humanos. Em contrapartida, pode-se criar um modelo 

baseado nos hábitos dos utilizadores de VEs e ter uma base sólida tendo em conta os horários mais 

comuns de partida e de chegada dos utilizadores à sua residência. Como base, será considerado 

um estudo heurístico realizado em Espanha em 2014 [68]. Dado que se trata de um país vizinho e 

os hábitos socioculturais são semelhantes será uma boa aproximação do cenário nacional. Na 

Figura 12 é apresentada a distribuição estatística por hora da primeira viagem e da última. De notar 

que a primeira viagem ocorre entre as 8:00h e as 10:00h, que corresponde ao inicio de um dia de 

trabalho, e que a última viagem de regresso a casa ocorre entre as 19:00h e as 24:00h. No entanto, 

durante estes períodos, há utilizadores que se deslocam mais que uma vez podendo ser necessário 

carregar o veículo nesses instantes. De forma a abranger todos os cenários possíveis, a lista de VE 

usada terá como base a Figura 13 sendo adaptada conforme as percentagens indicadas em cada 

hora.  
 

 
Figura 12 - Primeira e última viagem 

 
Figura 13 - Viagens de e para casa 

De notar que, tal como observado na Figura 8, o excesso tem o valor de pico a rondar os 1000 

MW o que daria para suportar, nesse preciso instante, mais de 200 mil VEs (assumindo uma 

potência média constante de 5 kW e uma simultaneidade unitária de carregamentos). Como essa 

simulação demoraria várias horas a ser executada e como esse número ultrapassa em larga escala 

os 5500 VE registados em Portugal, a escala será reduzida em 10 mil vezes de modo a acelerar as 

simulações. Esse valor poderá ser alterado no ficheiro Algoritmo.m (Anexo A - Algoritmo.m) na 



 38 

variável r. Dado que a nossa população é de 100 VEs, a redução de 10 mil vezes dos recursos 

disponíveis equivale, na realidade, a uma população de 1 milhão de VEs. Este valor traduz-se num 

cenário imaginário de, aproximadamente, 20% de penetração de VEs em Portugal. 

 

6.2 Simulação de inverno 
O cenário de inverno corresponde aos dias 2 e 3 de fevereiro de 2017. Foram dois dias 

bastantes ventosos e que procederam dias de alguma precipitação levando a que ocorresse uma 

elevada produção de energia proveniente de fontes renováveis, como observável na Figura 8. 

Nestes dois dias, a produção total de energia foi de 435,9 GWh, da qual, com 75% com origem 

em fontes renováveis. O pico de produção renovável ocorreu no dia 3 e teve um valor de 7774 

MW às 18:45 h, onde o consumo se situava nos 7600 MW. 

Após as simulações, foi possível obter a Figura 14 e a Figura 15. Na Figura 14 são visíveis 

as 3 simulações (agendamento em função do excesso de renovável, agendamento em função do 

custo da energia e agendamento não inteligente) usando preços de energia baseados na variação 

dos preços do MIBEL. A Figura 15, por sua vez, mostra também os resultados das mesmas três 

simulações, mas usando preços referentes a uma tarifa bi-horária [64]. 

 
Figura 14 - Simulação de inverno (2 e 3 de fevereiro de 2017) com preços MIBEL 

 

Em detalhe, dada figura possui 5 sub gráficos (explicado do topo para baixo): 

1- Gráfico do excesso de energia renovável antes e após o carregamento dos VE, 

usando um algoritmo focado no aproveitamento do excesso de energia renovável; 



 39 

2- Gráfico que mostra os processos iterativos desde a curva original do excesso até à 

curva final, cada linha é um carregamento de um VE; 

3- Gráfico que mostra a evolução do preço da energia ao longo do tempo; 

4- Gráfico que mostra o excesso original, os processos iterativos de carregamento e 

a curva final do excesso de energia renovável, usando um algoritmo focado na 

minimização dos custos de carregamento; 

5- Por fim, é mostrado um cenário que seria de esperar caso não se use qualquer tipo 

de carregamento inteligente. 

 
Figura 15 - Simulação de inverno (2 e 3 de fevereiro de 2017) com preços Bi-horário 

Após uma análise dos gráficos é possível recolher dados de modo a obter a Tabela 5.  

 
Tabela 5 - Resultados das simulações para os dias 2 e 3 de fevereiro de 2017 

Tipo	de	simulação	 Pico	
máximo	
(kw)	

Pico	
mínimo	
(kw)	

Desvio	
(kw)	

Desvio	(%)	
face	ao	
original	

Custo	
médio	(€)	

Original	 122,89	 -215,59	 338,48	 -	 -	
Em	função	do	excesso	de	

renovável,	com	preços	mibel	
64,61	 -215,59	 280,20	 -17,22	 0,9531	

Em	função	do	excesso	de	
renovável,	com	preços	bi-horário	

64,61	 -215,59	 280,20	 -17,22	 0,8442	

Em	função	dos	preços	mibel	 122,89	 -540,11	 663,0	 +95,88	 0,6642	
Em	função	dos	preços	bi-horário	 122,89	 -576,50	 699,39	 +106,63	 0,6507	
Não	inteligente	com	preços	mibel	 122,89	 -290,32	 413,12	 +22,05	 1,0895	
Não	inteligente	com	preços	bi-

horário	
122,89	 -290,32	 413,12	 +22,05	 1,0082	



 40 

Na Tabela 5 é possível notar a eficácia do algoritmo que faz o agendamento dos 

carregamentos em função do excesso de energia renovável, reduzindo em 17,22% o desvio que há 

entre o pico da curva original e o da final após os carregamentos. Este método mostrou-se bastante 

eficaz no cumprimento do terceiro objetivo, suavizando e equilibrando o diagrama, pois o 

algoritmo irá agendar os carregamentos para as horas de maior excesso começando pela hora em 

que há mais energia renovável, 6:00h do dia 3. 

No segundo sub-gráfico vê-se os períodos escolhidos pelo algoritmo para o carregamento 

ideal de cada VE. Iterativamente, irá alocar vários períodos, a um determinado veículo, começando 

pelos períodos em que há um maior excesso de energia. Quando esse excesso deixa de existir, o 

algoritmo irá alocar os períodos de carregamento nas situações em que os valores de produção de 

energia renovável sejam menos negativos evitando assim a intensificação do uso de fontes de 

energia não renováveis.  

Em relação ao segundo cenário (quarto sub-gráfico), em que o agendamento é feito em 

função do preço da energia é de notar um elevado pico nos instantes em que o preço é mais baixo. 

Como o preço é mais baixo nessa hora irá haver uma preferência por esse horário. Na Figura 14, 

que se usa um preço baseado no MIBEL, o pico mais negativo chega a atingir uma potência de  

-540 kW enquanto que, na Figura 15, atinge os -576 kW. Este último caso é o exemplo de um 

carregamento semi-inteligente, em que os carregamentos estão focados exclusivamente na 

poupança dos utilizadores. Como tal iniciam o carregamento no instante em que a energia é mais 

barata e dado que se trata de uma tarifa bi-horária e os preços são comuns a todos os utilizadores 

nesta situação, os carregamentos serão agendados todos para a mesma hora provocando uma ponta 

elevada. No caso de se trabalhar em função da variação dos preços MIBEL o pico de procura 

ocorre por volta das 4:00h do dia 3 enquanto que, em função de uma tarifa bi-horária ocorre pouco 

depois das 22:00h do dia 2, que é logo após o início do período de vazio na tarifa. 

Por fim, no último gráfico é apresentado o caso mais comum que é referente a 

carregamentos não inteligentes. Como seria de esperar, as curvas referentes a esse gráfico da 

Figura 14 e da Figura 15 são iguais, uma vez que não existe qualquer tipo de agendamento em 

função do excesso de renovável ou do custo de energia. O carregamento depende apenas da hora 

de chegada e do estado de veículo. É de evidenciar que o pico de potência mais negativo desta 

simulação se situa nos -280 kW o que é um valor muito menos negativo que usando um algoritmo 

semi-inteligente mostrando que, ao nível de equilíbrio de diagramas de SEE, é preferível não usar 

um sistema baseado em preços que inicie múltiplos carregamentos à mesma hora sem ter noção 

da quantidade de cargas previstas a essa hora como acontece num sistema semi-inteligente. 

Um outro aspeto que é um objetivo deste trabalho é a redução dos custos de carregamento. 

A comparação será feita usando como base as simulações que usam um carregamento não 



 41 

inteligente que apresentou em ambos os casos (usando variação dos preços MIBEL ou tarifa bi-

horária) uma média de custos dos carregamentos de aproximadamente 1 €. Como verificado na 

Tabela 5, em qualquer cenário em que se use um algoritmo de carregamento os custos são 

inferiores.  

Nos casos em que o agendamento é feito em função do excesso de renovável houve ligeiras 

diferenças que se devem a variações no preço da energia ao longo do dia, que podem ser 

verificadas no terceiro sub gráfico da Figura 14. A grande parte dos carregamentos usando este 

método é efetuada entre as 6:00h e as 8:00h da manhã, onde se regista um maior custo nessas horas 

no preço baseado na variação do MIBEL face a uma tarifa bi-horária.  

Usando a variação de preços do MIBEL, com o algoritmo para aproveitamento do excesso 

de renováveis é obtida uma redução de custos de 12,52% e usando o algoritmo em função do preço 

da energia a redução é 16,27%. De igual modo, usando uma tarifa bi-horária reduziu-se em 39,04% 

usando o algoritmo em função do excesso de renováveis e 35,46% usando o algoritmo em função 

dos preços, tudo face a um carregamento não inteligente. Assim, a nível de custos é claramente 

visível a superioridade do segundo método face ao primeiro, no entanto, peca pelo pico gerado no 

diagrama, o que não acontece no primeiro método que o torna mais linear. 

 

6.3 Simulação de verão 
O cenário de verão corresponde aos dias 9 e 10 de agosto de 2016. Este foi um mês 

extremamente quente e seco (a precipitação atingiu apenas 30% do que é típico nesse mês), em 

que a temperatura média foi superior à normal e onde se registaram os dias mais quentes do ano 

(entre 5 a 14 desse mês) [69]. Estas circunstâncias tornam o mês de agosto de 2016 um ótimo teste 

com um acentuado contraste ao cenário de inverno já analisado, possibilitando assim verificar o 

desempenho dos algoritmos. Relativamente aos dias 9 e 10 de agosto de 2016, a produção teve um 

total de 289,4 GWh em que 60% foi de origem renovável, tendo o pico da mesma ocorrido no dia 

10 às 21:30h com um valor de 5155 MW, onde o consumo era de 6607 MW. 

Nesta simulação, apesar de o excesso de energia renovável ser praticamente nulo, os 

resultados são idênticos aos da simulação de inverno, sobressaindo assim a versatilidade do 

algoritmo em se adaptar a situações muito distintas. De notar que a população de veículos que foi 

usada para simular o cenário de inverno (número de VEs, SOCa, H, HPS e P) é idêntica, não se 

tendo modificado nada que adultere os resultados. Os diagramas de energia correspondentes a 

esses dias são visíveis na Figura 16 onde é possível verificar a inexistência de excesso de produção 

de energia renovável. 



 42 

Os resultados das simulações, para o caso do uso do preço da energia baseado no MIBEL 

são mostrados na Figura 17, enquanto que, os resultados usando os preços de uma tarifa bi-horária 

são visíveis na Figura 18. Os sub gráficos dessas figuras são análogos aos da simulação de inverno.  

 

 
Figura 16 - Diagramas de energia dos dias 9 e 10 de agosto de 2016 (sem utilização do fator de redução de 10 mil vezes) 

 

 
Figura 17 - Simulação de verão (9 e 10 de agosto de 2016) com preços MIBEL 



 43 

 
Figura 18 - Simulação de verão (9 e 10 de agosto de 2016) com preços Bi-horário 

Uma vez mais, o primeiro algoritmo teve um bom desempenho. Não foi possível fazer uso 

do excesso de energia renovável, no entanto, foi suavizado ao máximo o diagrama alocando os 

carregamentos nos períodos em que o excesso de renovável foi menos negativo. Esse agendamento 

iterativo é visível no segundo sub gráfico da Figura 17 e da Figura 18. 

Em relação ao segundo algoritmo, os impactos negativos foram idênticos ao do cenário de 

inverno. Todos os carregamentos foram agendados para a mesma hora (mais barata) levando ao 

aparecimento de um pico de procura acentuado. Esse pico, com um valor de aproximadamente 

500 kW, ocorreu as 4:00h da manhã do dia 10, no caso em que se usou um preço da energia 

baseado na variação do MIBEL e ocorreu por volta das 22h do dia 9, no caso com preços bi-

horários, pois é quando os preços da tarifa bi-horária sofrem um abaixamento. Em nenhum dos 

casos se verificou uma suavização do diagrama, tendo até provocado o efeito oposto, pois este 

algoritmo ignora por completo o excesso de energia renovável ou o diagrama de carga. O seu único 

objetivo é poupar nos custos de carregamento tendo por isso um efeito negativo ao gerar o pico de 

procura visível no quarto sub gráfico da Figura 17 e da Figura 18 sendo que, no último caso 

(usando preços bi-horário), as consequências serão piores dados que a procura às 22:00h é, 

geralmente, superior à verificada às 4:00h. 

Por fim, usando um carregamento não inteligente, não se consegue suavizar o diagrama, 

reduzir custos nem assegurar qualquer primazia por energia renovável. Ainda assim, os seus 

efeitos negativos no diagrama de carga são inferiores ao caso do método anterior, não originando 

um pico de procura (é de salientar que este pico é baixo pois se está a trabalhar com níveis de 

penetração baixos, caso se usasse níveis altos iria ser relevante e ainda mais nefasto no caso de 



 44 

agendamento em função do preço). Dos três algoritmos, tal como observado na Tabela 6, o 

carregamento não inteligente é o que tem maiores custos para o utilizador uma vez que a maioria 

dos carregamentos iniciam entre as 20:00h e as 22:00h o que corresponde a um período de ponta 

em que a energia é mais cara.  

Para este cenário, usando a variação de preços do MIBEL é visível uma redução de custos 

de 29,84% usando o algoritmo para aproveitamento do excesso de renovável e de 35,95% usando 

o algoritmo em função do preço da energia. No caso das simulações com tarifa bi-horária reduziu-

se em 32,96% com o primeiro método e 35,46% com o segundo, face a um carregamento não 

inteligente.  

 
Tabela 6 - Resultados das simulações para os dias 9 e 10 de agosto de 2016 

Tipo	de	simulação	 Máximo	(kw)	 Mínimo	
(kw)	

Desvio	
(kw)	

Desvio	face	ao	
original	(%)	

Custo	
médio	(€)	

Original	 5,21	 -387,39	 392,60	 -	 -	

Por	excesso	renovável	
com	preços	mibel	

-91,15	 -387,39	 296,24	 -	24,54	 0,7420	

Por	excesso	com	preços	
bi-horário	

-91,15	 -387,39	 296,24	 -24,54	 0,6759	

Por	preços	mibel	 5,21	 -596,87	 512,08	 +	30,43	 0,6773	
Por	preços	bi-horário	 5,21	 -604,02	 609,23	 +55,18	 0,6507	
Não	inteligente	com	

preços	mibel	
5,21	 -425,81	 431,02	 +9,79	 1,0575	

Não	inteligente	com	
preços	bi-horário	

5,21	 -425,81	 431,02	 +9,79	 1,0082	

 

A Tabela 7 faz um resumo da redução de custos de carregamento em todas as simulações dos 

dois cenários, inverno e verão. Como seria de esperar, é visível a superioridade, em termos de 

custos de carregamento, do método de agendamento em função do custo da energia face a um 

carregamento não inteligente e até superior ao carregamento inteligente de aproveitamento do 

excesso de energia renovável. No cenário de verão o excesso é praticamente nulo, no entanto, os 

valores menos positivos coincidem com os períodos em que a energia é mais barata daí a diferença 

da redução de um algoritmo para o outro não ser tão acentuada como no cenário de inverno.   

 
Tabela 7 - Comparação da redução de custos 

	 Inverno	 Verão	
Em	função	do	excesso	mibel	 12,52%	 29,84%	
Em	função	do	excesso	bi-horário	 16,27%	 32,96%	
Em	função	do	preço	mibel	 39,04%	 35,95%	
Em	função	do	preço	bi-horário	 35,46%	 35,46%	



 45 

 
Sendo o principal objetivo deste trabalho o aproveitamento do excesso de energia 

renováveis em carregamentos domésticos de VEs, é mostrado na Tabela 8 o desempenho de cada 

algoritmo. É importante relembrar que, como se está a trabalhar com dados nacionais reais e de 

modo a encurtar o tempo da realização das simulações se está a reduzir em 10 mil vezes os valores 

de energia. Sendo que no cenário de inverno houve um excesso de geração renovável de 25166 

MWh, na simulação foi usado o valor de 2516,6 kWh. No de verão, os 5,2 kWh mostrados na 

Tabela 8 corresponde na realidade a um excesso de 52 MWh. 

 
Tabela 8 - Comparativo do uso do excesso de renovável por cada algoritmo 

	 Cenário	de	
inverno	

Cenário	de	
verão	

Excesso	absorvido	
(inverno)	

Excesso	de	renovável	original		 2516,6	kwh	 5,2	kwh	 -	
Excesso	após	o	1º	método	(função	
do	excesso)	

1144,2	kwh	 0	kwh	 54,5%	

Excesso	após	o	2º	método	(função	
do	preço)		

2516,6	kwh	 5,2	kwh	 0%	

Absorção	não	inteligente		 2516,6	kwh	 5,2	kwh	 0%	
 

Da análise da Tabela 8 verifica-se que o algoritmo que agenda os carregamentos em função 

do excesso conseguiu absorver 54,5% do total no cenário de inverno. Já no caso dos outros dois 

algoritmos, nenhum absorveu qualquer excesso de energia renovável uma vez que, em qualquer 

cenário usando preços bi-horários ou baseados na variação do MIBEL, os preços da energia mais 

baixos não coincidiram com períodos de excesso de renovável. Como no cenário de verão apenas 

se verificou um excesso de 5,2 kWh não é fiável afirmar que o primeiro algoritmo conseguiu 

aproveitar 100% do excesso uma vez que se trata de um valor reduzido e que, por coincidência, 

coincidiu apenas com o período noturno. Se ocorresse a meio do dia, muito provavelmente, o 

algoritmo não teria capacidade para aproveitar o excesso, tal como os outros, uma vez que poderia 

não haver veículos a necessitar carregamento nessas horas.  

  



 46 

 

7 Conclusões e trabalho futuro 

7.1 Conclusões 
Desde o início do trabalho que se estipulou 3 objetivos: 

1. Aproveitar ao máximo o excesso de energia renovável; 

2. Reduzir os custos associados ao carregamento de VEs; 

3. Otimizar o diagrama de carga nacional. 

O alcance destes objetivos seria atingindo adiando o carregamento para períodos mais 

favoráveis. No caso de se focar no primeiro objetivo, o carregamento seria programado num 

horário onde houvesse um maior excesso de energia renovável. No caso de se pretender o segundo 

objetivo, os carregamentos seriam efetuados nas horas em que a energia seria mais barata. Dado 

que, quando há menos procura o preço da energia é mais barata ou que, quando há excesso de 

energia o preço da mesma é mais barata, o terceiro objetivo seria frequentemente alcançado 

automaticamente após a execução de qualquer um dos algoritmos.  

As tarifas energéticas estão em constante evolução. No futuro, é muito provável que Portugal 

adote tarifas em tempo real. Quando isso for possível, será de esperar que o preço da energia seja 

mais barato quando houver excesso de energia renovável, o que dará origem a uma equivalência 

nos dois primeiros métodos usados neste trabalho. O resultado obtido usando um algoritmo de 

agendamento em função do excesso será igual ao obtido usando um algoritmo em função do preço 

da energia em tempo real, uma vez que estes estarão fortemente relacionados. Como atualmente 

isso não ocorre é natural que haja diferenças no diagrama optando por métodos diferentes.  

Outro fator que ajudará a igualar os resultados dos métodos será num cenário de alta 

penetração de VEs. Num futuro, quando houver um número considerável de VEs em circulação, 

os seus carregamentos terão um grande impacto na rede, como tal, quando um grande aglomerado 

de VEs estiver a carregar o preço da energia irá aumentar fazendo com que os próximos VEs a dar 

entrada no sistema já vão carregar noutros períodos em que haja menos procura e que, 

consequentemente, a energia seja mais barata. Dado que o preço da energia da tarifa bi-horária ou 

baseado no MIBEL ainda não estão totalmente sincronizados com o excesso de energia, mas sim 

com a procura, é natural que a suavização do diagrama de carga (objetivo 3) só ser atingido usando 

o primeiro algoritmo sendo até prejudicado usando o segundo, em que o agendamento é em função 

do preço. 

No entanto, visto que o foco primordial deste trabalho é o desenvolvimento de algoritmos 

que coordenem o carregamento de VEs que permitam a integração em larga escala de energias 



 47 

renováveis e ainda não estão disponíveis tarifas em preço real, a conclusão debruçar-se-á 

principalmente no primeiro método desenvolvido com tarifas bi-horárias onde os resultados são 

visíveis na Tabela 9.  
Tabela 9 - Resultados finais do algoritmo em função do excesso de renovável 

	 Excesso	de	renovável	
absorvido	(%)	

Média	redução	de	custos	
(%)	

Agendamento	em	função	do	excesso	
de	renovável	

54	 16,27	a	32,96	

 

Usando o primeiro algoritmo, a absorção de excesso de energia renovável não foi superior 

a 54%, pois os restantes 46% estavam em períodos em que não coincidiam com as preferências do 

utilizador. A outra grande fatia de excesso ocorreu entre a 01:00h e as 08h:00 do primeiro dia. 

Caso se estivesse a trabalhar com uma janela de três dias (1, 2 e 3 de fevereiro) ou em tempo 

contínuo, os VE que chegassem no dia 1 iriam usar esse excesso do dia 2. Assim, o excesso 

absorvido pelo carregamento de veículos nos dias 2 e 3 de fevereiro teria valores perto de 100%. 

A nível de otimização do diagrama de carga, a superioridade do algoritmo em função do 

excesso de renovável face a um carregamento não inteligente pode ser observada na Figura 19, 

relativa ao cenário de inverno e na Figura 20 para o cenário de verão, ambos os casos ilustrados 

pelo ficheiro PlostsComparativos.m (Anexo H – PlotsComparativos.m). Novamente, de modo a 

acelerar as simulações, a escala foi reduzida em 10 mil vezes.  

Na Figura 19 é visível o aumento dos picos de procura devido ao carregamento de VEs 

quando se usa carregamentos não inteligentes. Usando o algoritmo em função do excesso de 

energia é possível verificar um controlo desse pico no cenário de inverno.  

Na simulação de verão (Figura 20) o efeito de carregamentos descontrolados é semelhante 

ao da simulação de inverno ocorrendo um grande pico de procura por volta das 21:00h do dia 9. 

Um equilíbrio quase ideal no que diz respeito a preenchimento de vales em diagramas de carga, é 

atingindo, usando o algoritmo de agendamento em função do excesso de renovável. Neste cenário, 

o algoritmo consegue distribuir os vários carregamentos de forma equilibrada ao longo do período 

noturno. Não criou qualquer pico de procura e, no período das 24:00h às 08:00h a procura não 

teve valores tão baixos devido ao desvio de carregamentos para esse intervalo. 



 48 

 
Figura 19 - Diagramas de carga nos dias 2 e 3 de fevereiro de 2017 (consumo geral reduzido em 10 mil vezes) 

 

 
Figura 20 - Diagramas de carga nos dias 9 e 10 de agosto de 2016 (consumo geral reduzido em 10 mil vezes) 



 49 

Em termos de custos ao longo de um ano, usando um algoritmo focado no aproveitamento 

do excesso de energia renovável, para além de ajudar a reduzir as emissões para a atmosfera de 

GEE e a estabilizar os diagramas de carga, consegue-se poupar entre 55 € e 118 € por cada VE. 

Usando um algoritmo em função do preço, essa poupança sobe para valores entre 135 € e 143 €. 

Em contrapartida, usando este último algoritmo, irão surgir picos de procura que poderão ter de 

ser fornecidos tendo como base combustíveis fósseis. 

Resumindo, usando o algoritmo em função do excesso de energia, consegue-se aproveitar o 

excesso de geração renovável, reduzir os custos associados ao carregamento e suavizar o diagrama 

de carga. Usando o algoritmo em função do preço de energia já só se verifica a redução dos custos. 

O aproveitamento de energias renováveis por este segundo método só será aceitável se o preço da 

energia variar em função do nível de geração renovável. Em termos de suavização do diagrama, 

este método é o pior tendo resultados mais nefastos do que carregamentos não inteligentes. Estes 

últimos, apesar de não provocarem, com este nível de penetração baixo, um grande efeito negativo, 

não fazem qualquer uso do excesso de energia renovável e são os que têm um maior custo de 

carregamento dos três. Concluindo e tendo em conta todos os impactos causados pelos VEs, com 

o carregamento coordenado de VEs focado no aproveitamento do excesso de energia renovável, 

não só se reduz as pontas de procura, como também as emissões de CO2, aumenta-se a qualidade 

da energia nos SEE, equilibram-se os diagramas de carga e consegue-se reduzir os custos de 

carregamento das baterias dos VEs. 

 

7.2 Trabalho Futuro  
Como observado na secção anterior, em parte, os algoritmos têm um desempenho limitado 

pela janela de simulação. Para aproveitar ao máximo o excesso de energia de dois dias seria 

necessário ter uma janela de três dias originando um sistema de n+1 sendo n o número de dias que 

se queira simular o aproveitamento do excesso de renovável. Com este já seria possível simular 

com rigor os carregamentos durante uma semana inteira ou um período mais alargado. Idealmente, 

os algoritmos poderiam ser adaptados para funcionar em tempo real, tenho uma previsão dos 

carregamentos de VEs do dia decorrente e da produção e do consumo das 24 horas seguintes. 

Outro aspeto que se pode mudar é a finalidade do algoritmo, incluindo outros objetivos ou 

uma análise multiobjectivo para o algoritmo tentar assegurar simultaneamente bons resultados 

para vários objetivos. 

Também crucial para o trabalho futuro seria a nível de otimização do código, que poderia 

ser melhorado usando computação paralela de modo a se simular facilmente um número de 

amostras correspondente a uma frota de VEs de elevada dimensão (por exemplo um milhão de 

VEs). De forma a melhorar os resultados obtidos, uma vez que se estaria a aumentar os níveis de 



 50 

penetração de VE, tal como analisado na secção 3.5, poder-se-ia optar por um controlo 

centralizado em vez de iterativo. 

 

  



 51 

Referências 

[1] Samadi, P.; Mohsenian-Rad, H.; Schober, R.; Wong, V.W.S., Advanced Demand Side 

Management for the Future Smart Grid Using Mechanism Design, IEEE Transactions on 

Smart Grid, vol.3, no.3, pp.1170,1180, Sept. 2012. 

[2] Koutitas, G., Control of Flexible Smart Devices in the Smart Grid, IEEE Transactions on 

Smart Grid, vol.3, no.3, pp.1333,1343, Sept. 2012. 

[3] Daniel Freund, Marco Lutzenberger, Sahin Albayrak, Costs and Gains of Smart Charging 

Electric Vehicles to Provide Regulation Services, Procedia Computer Science, vol. 10, pp. 

846- 853, 2012. 

[4] Aoife Foley, Barry Tyther, Patrick Calnan, Brian Ó Gallachóir, Impacts of Electric Vehicle 

charging under electricity market operations, Applied Energy, vol. 101, pp. 93-102, 2013 

[5] R. P. Faria, V. C. Ramirez, P. S. Moura, J. I. Moreno, J. B. Delgado, and A. T. De Almeida, 

“SMARTplug?: Using smart devices for a managed charge of electric vehicles”, 2013.  

[6] Raslavicius L, Azzopardi B, Kersys A, Starevicius M, Bazaras Z, Makaras R. Electric 

vehicles challenges and opportunities: lithuanian review. Renewable and Sustainable 

Energy Reviews 2015; 42:786–800. 

[7] Bellis M., ThoughtCo., “A History of Electric Vehicles”, 

http://inventors.about.com/od/estartinventions/a/History-Of-Electric-Vehicles.htm - 

acedido a 28 de fevereiro de 2017. 

[8] L. N. M. Duarte, “Comparação de Estratégias de Carregamento de Veículos Elétricos,” 

Dissertação de Mestrado, FEUP, 2012. 

[9] J. Larminie, J. Lowry, Electric Vehicle Technology Explained, John Wiley &amp;amp; Sons, Ltd, 

England, 2003.  

[10] R. Faria, P. Moura, J. Delgado, and A. T. De Almeida, A sustainability assessment of 

electric vehicles as a personal mobility system,” Energy Convers. Manag., vol. 61, pp. 19–

30, 2012. 

[11] Nick Zielinski; “Chevy Volt and E-Flex Enabling Energy Diversity”; Cascadia 

TransTechEnergy Series, p.4, May 2007. 

[12] World Energy Council, “World Energy Perspectives E-MOBILITY: CLOSING THE 

EMISSIONS GAP,” p. 40, 2016. 

[13] Vicatos, M., Tegopoulos, J., 2003. A doubly-fed induction machine differential drive 

model for automobiles. IEEE Transactions on Energy Conversion 18, 225-230. 



 52 

[14] Yang, Z., Shang, F., Brown, I.P., Krishnamurthy, M., 2015. Comparative Study of Interior 

Permanent Magnet, Induction, and Switched Reluctance Motor Drives for EV and HEV 

Applications. IEEE Transactions on Transportation Electrification 1, 245-254. 

[15] Zeraoulia, M., 2006. Electric motor drive selection issues for HEV propulsion systems: A 

comparative study. IEEE Transactions on Vehicular Technology, vol. 55, 1756-1764. 

[16] S. Rezaee, E. Farjah, B. Khorramdel, Probabilistic analysis of plug-in electric vehicles 

impact on electrical grid through homes and parking lots, Sustain. Energy, IEEE Trans. 4 

(4) (2013) p 1024 - 1033. 

[17] Sociedade Gestora de Operações da Rede de Mobilidade Elétrica, “Formas de 

Carregamento de Veículos Eléctricos em Documento para o utilizador,” pp. 3–21, 2011. 

[18] Leong YP, Indati MS, Hisham HA. Climate change challenges on CO2 emission reduction 

for developing countries: a case for Malaysia's agenda for action. International Journal of 

Climate Change: Impacts Responses, 2011. 

[19] Rajakaruna S, Shahnia F, Ghosh A. Plug in electric vehicles in smart grids. 1st ed. Springer 

Science and Business Media Singapore Pte Ltd; 2015. 

[20] Leou RC, Su CL, Lu CN. Stochastic analyses of electric vehicle charging im- pacts on 

distribution network. IEEE Transactions on Power Systems 2014; 29:1055–63.   

[21] McCarthy D, Wolfs P. The HV system impacts of large scale electric vehicle deployments 

in a metropolitan area. In: Proceedings of the 20th Australasian Universities Power 

Engineering Conference (AUPEC), Christchurch; 2010. p. 1–6. 

[22] Wang Z, Paranjape R. An evaluation of electric vehicle penetration under demand response 

in a multi-agent based simulation. IEEE Electrical Power and Energy Conference (EPEC), 

Calgary, AB; 2014. p. 220-5. 

[23] W. H. Kersting, "Radial distribution test feeders," in Power Engineering Society Winter 

Meeting, 2001. IEEE, 2001, pp. 908-912. 

[24] Kristofferson T, Capion K, Meibom P. Optimal charging of electric drive vehicles in a 

market environment. Applied Energy 2011; 88:1940–8. 

[25] Denholm P, Short W. An evaluation of utility system impacts and benefits of optimally 

dispatched plug-in hybrid electric vehicles. Golden, CO: National Renewable Energy 

Laboratory; 2006.   

[26] Gomez JC, Morcos MM. Impact of EV battery chargers on the power quality of 

distribution systems. IEEE Transations on Power Delivery 2003;18(3):975–81.  

[27] Desmet JJM, Sweertvaegher I, Vanalme G, Stockman K, Belmans RJM. Analysis of the 

neutral conductor current in a three-phase supplied network with nonlinear single-phase 

loads. IEEE Transations on Industry Applications 2003; 39(3):587–93.  



 53 

[28] IEEE Standards Coordinating Committee 22 on Power Quality, IEEE Std 1159. IEEE 

Recommended Practice for Monitoring Electric Power Quality; 1995.   

[29] Lee SJ, Kim JH, Kim DU, Go HS, Kim CH, Kim ES, et al. Evaluation of voltage sag and 

unbalance due to the system connection of electric vehicles on distribution system. Journal 

of Electrical Engineering and Technology 2014; 9:452–60. 

[30] IEEE Power &amp;amp; Energy Society, IEEE Recommended Practice for Monitoring Electric 

Power Quality; 2009. 

[31] Papadopoulos P, Skarvelis-Kazakos S, Grau I, Awad B, Cipcigan LM, Jenkins N. Impact 

of residential charging of electric vehicles on distribution networks, a probabilistic 

approach. In: 45th International Universities Power Engineering Conference (UPEC); 

2010. p. 1–5. 

[32] Pieltain FL, Roman TGS, Cossent R, Domingo CM, Frias P. Assessment of the impact of 

plug-in electric vehicles on distribution networks. IEEE Transactions on Power Systems 

2011; 26(1):206–13. 

[33] Elnozahy MS, Salama MM. A comprehensive study of the impacts of PHEVs on 

residential distribution networks. IEEE Transations on Sustainable Energy 2014; 5:332–

42. 

[34] Berisha SH, Karady GG, Ahmad R, Hobbs R, Karner D. Current harmonics generated by 

electric vehicle battery chargers. In: Proceedings of the International Conference on Power 

Electronics, Drives, and Energy Systems for Industrial Growth; 1996. p. 584-9. 

[35] Donateo T, Ingrosso F, Licci F, Laforgia D. A method to estimate the environmental 

impact of an electric city car during six months of testing in an Italian city. J Power Sources 

2014; 270:487–98. 

[36] Kim JD, Rahimi M. Future energy loads for a large-scale adoption of electric vehicles in 

the city of Los Angeles: impacts on greenhouse gas (GHG) emissions. Energy Policy 2014; 

73:620–30. 

[37] Lund H, Kempton W. Integration of renewable energy into the transport and electricity 

sectors through V2G. Energy Policy 2008; 36:3578–87. 

[38] R. Faria, P. Marques, P. Moura, F. Freire, J. Delgado, and A. T. De Almeida, “Impact of 

the electricity mix and use profile in the life-cycle assessment of electric vehicles,” 

Renew. Sustain. Energy Rev., vol. 24, pp. 271–287, 2013.   

[39] Ferrero E, Alessandrini S, Balanzino A. Impact of the electric vehicles on the air pollution 

from a highway. Applied Energy 2016; 169:450–9. 

[40] Sioshansi R, Miller J. Plug-in hybrid electric vehicles can be clean and economical in dirty 

power systems. Energy Policy 2011; 39(10):6151–61. 



 54 

[41] Mwasilu F, Justo JJ, Kim EK, Do TD, Jung JW. Electric vehicles and smart grid 

interaction: a review on vehicle to grid and renewable energy sources integration. 

Renewable and Sustainable Energy Reviews 2014; 34:501–16. 

[42] Richardson DB. Electric vehicles and the electric grid: a review of modeling approaches, 

impacts and renewable energy integration. Renew Sustain Energy Rev 2013; 19:247–54. 

[43] Thomas C. Fuel cell and battery electric vehicles compared. International Journal of 

Hydrogen Energy 2009; 34:6005–20.  

[44] Kiviluoma J, Meibom P. Methodology for modeling plug-in electric vehicles in the power 

system and cost estimates for a system with either smart or dumb electric vehicles. Energy 

2011; 36:1758–67. 

[45] Weis A, Jaramillo P, Michalek J. Estimating the potential of controlled plug-in hybrid 

electric vehicle charging to reduce operational and capacity expansion costs for electric 

power systems with high wind penetration. Applied Energy 2014; 115:190–204.  

[46] G. Strbac, “Demand side management: Benefits and challenges,” Energy Policy, vol. 36, 

no. 12, pp. 4419–4426, 2008. 

[47] K. Clement-Nyns, E. Haesen, and J. Driesen, “The Impact of Charging Plug-In Hybrid 

ElectricVehicles on a Residential Distribution Grid,” IEEE Transactions on Power 

Systems, vol. 25, no. 1, pp. 371–380, February 2010. 

[48] K. Mets, T. Verschueren, W. Haerick, C. Develder, and F. De Turck, “Optimizing Smart 

Energy Control Strategies for Plug-In Hybrid Electric Vehicle Charging,” pp. 293–299, 

2010.   

[49] K. Mets, R. D’Hulst, and C. Develder, “Comparison of Intelligent charging algorithms for 

electric vehicles to reduce peak load and demand variability in a distribution grid,” J. 

Commun. Networks, vol. 14, no. 6, pp. 672–681, 2012.  

[50] Luís Paulo Reis, Coordenação em Sistemas Multi-Agente: Aplicações na Gestão 

Universitária e Futebol Robótico (Coordination in Multi-Agent Systems: Applications in 

University Management and Robotic Soccer), PhD Thesis, FEUP, July of 2003. 

[51] M. Hommelberg, C. Warmer, I. Kamphuis, J. Kok, and G. Schaeffer, “Distributed control 

concepts using multi-agent technology and automatic markets: an indispensable feature of 

smart power grids,” in Proc. 2007 IEEE Power Engineering Society General Meeting, 

Tampa, Florida, USA, 2007, p. 7 pp. 

[52] Logenthiran T, Srinivasan D. Multi-agent system for managing a power distribution system 

with plug-in hybrid electrical vehicles in smart grid. ISGT2011-India. IEEE 2011; 

0954:346–51. 



 55 

[53] Richardson P, Flynn D, Keane A. Local versus centralized charging strategies for electric 

vehicles in low voltage distribution systems. IEEE Transactions on Smart Grid 2012; 

3:1020–8.  

[54] Gonzalez Vaya M, Andersson G. Centralized and decentralized approaches to smart 

charging of plug-in vehicles, 3rd IEEE PES Inovative Smart Grid Technologies Europe 

(ISGT Europe) 2012:1–8. 

[55] REN, Dados Técnicos Eletricidade 2016 - Disponível em 

http://www.centrodeinformacao.ren.pt/PT/InformacaoTecnica/DadosTecnicos/REN%20

Dados%20Técnicos%202016.pdf – Acedido a 11 de junho de 2017. 

[56] J. Delgado, R. Faria, P. Moura e A. de Almeida, “The contribution of Plug-In Electric 

Vehicles to achieve energy transition goals in Energy Efficiency Improvement, Renewable 

Energy integration and Greenhouse Gas emissions reduction”., Instituto de Sistemas e 

Robótica – Universidade de Coimbra, Julho de 2017. 

[57] EDP, Complementaridade hídrica-eólica – Disponível em http://www.a-nossa-

energia.edp.pt/centros_produtores/complementariedade_hidroeolica_pe.php – Acedido a 

16 de junho de 2017. 

[58] Yang CJ. Pumped Hydroelectric Storage, Center on Global Change, Duke University, 

Durham, North Carolina 27708, USA, 2011. 

[59] P. Gomes, M. Lopes, H. Martins, J. Carvalho, P. Teixeira, and U. De Aveiro, “Anexo 8 

Custos internos e externos de Mobilidade Índice,” 2011.  

[60] B. Schoettle and M. Sivak, “Consumer Preferences for the Charging of Plug-In Electric 

Vehicles,” Sustain. Worlwide Transp., no. November, 2016.  

[61] REN, Previsão de Produção -  REN Sistema de Informação de Mercados de Energia - 

http://www.mercado.ren.pt/PT/Electr/InfoMercado/Prod/Paginas/Prev.aspx 

[62] REN, Previsão de Consumo - REN Sistema de Informação de Mercados de Energia - 

Disponível em:  

http://www.mercado.ren.pt/PT/Electr/InfoMercado/Consumo/PrevConsumo/Paginas/Pre

vConsDia.aspx 

[63] REN, Estatística Diária – Centro de Informação REN - Disponível em:   

http://www.centrodeinformacao.ren.pt/EN/Pages/CIHomePage.aspx 

[64] EDP, Preço Tarifas Baixa Tensão Normal – Disponível em:  

http://www.edpsu.pt/pt/particulares/tarifasehorarios/BTN/Pages/TarifasBTNate20.7kVA.

aspx 



 56 

[65] REN, Histórico de preços da energia – Disponível em:  

http://www.mercado.ren.pt/PT/Electr/InfoMercado/InfOp/MercOmel/Paginas/Precos.asp

x 

[66] R. Faria, P. Moura, J. Delgado, and A. T. De Almeida, “Managing the charging of electrical 

vehicles: Impacts on the electrical grid and on the environment,” IEEE Intell. Transp. Syst. 

Mag., vol. 6, no. 3, pp. 54–65, 2014.  

[67] José P., Vendas Veículos Elétricos em Portugal – Disponível em: http://ev-

sales.blogspot.pt/search/label/Portugal -  acedido a 5 de julho de 2017. 

[68] M. Alonso, H. Amaris, J. G. Germain, and J. M. Galan, “Optimal charging scheduling of 

electric vehicles in smart grids by heuristic algorithms,” Energies, vol. 7, no. 4, pp. 2449–

2475, 2014. 

[69] IPMA, Resumo Clima Agosto 2016 - Disponível em:  

https://www.ipma.pt/export/sites/ipma/bin/docs/relatorios/clima/resumo-clima-agosto-

2016.pdf  



 57 

8 Anexo A - Algoritmo.m 

 
% 4 Simulações possíveis: 
% 1 - Em função do excesso de renovável 
% 2 - Em função dos preços MIBEL 
% 3 - Em função dos preços de tarifa bi-horária (carrega em horas de vazio) 
% 4 - Carregamento normal, sem qualquer tipo de inteligência 
% Para simular o caso 3 é necessário alterar os valores dos preços em 
% Previsao.m 
  
tic; clear; clc; close all 
  
h = 12; %Hora atual hipotética 
r = 10; % Fator de redução do excesso de energia 
% Estamos a reduzir o excesso em 10 mil vezes, uma vez que estamos a usar  
% r = 10 e, para além disso, o excesso está em MW e os nossos veículos em kW 
% Usamos este fator para tornar visível as diferenças no gráfico caso 
% contrário teríamos de usar 1 milhão VE para ter o mesmo efeito com o senão 
% que a simulação demoraria vários dias a fazer. 
  
run Previsao.m 
run ListaVE.m 
run Tempo.m 
  
%% ---------------------------------------- Dias 9 e 10 de agosto de 2016 
disp('Algortimo para os dias 9 e 10 de agosto de 2016') 
excesso = excesso9_10; 
excesso_original = excesso(:,2); 
dia1 = 9; 
dia2 = 10; 
  
figure 
    subplot(5,1,1) 
        hold on 
        plot(excesso(:,1),excesso_original,'LineWidth',3); %Excesso original 
    subplot(5,1,2) 
        hold on 
        plot(excesso(:,1),excesso_original,'b','LineWidth',3); %Excesso 
original  
        LV4 = line([h h],[-500 200]); %Linha vertical hora atual hipotética 
        LV4.Color = 'blue'; 
        LV4.LineStyle = '--'; 
    subplot(5,1,3) 
        hold on 
        plot(excesso(:,1),excesso(:,3),'LineWidth',3); %Custo energia MIBEL 
        plot(excesso(:,1),excesso(:,4),'LineWidth',3); %Custo energia bi-
horário        
    subplot(5,1,4) 
        hold on 
        plot(excesso(:,1),excesso_original,'b','LineWidth',3); %Excesso 
original 
        LV4 = line([h h],[-500 200]); %Linha vertical hora atual hipotética 
        LV4.Color = 'blue'; 
        LV4.LineStyle = '--'; 
    subplot(5,1,5) 
        hold on 
        plot(excesso(:,1),excesso_original,'b','LineWidth',3); %Excesso 
original 
        LV6 = line([h h],[-500 200]); %Linha vertical hora atual hipotética 
        LV6.Color = 'blue'; 
        LV6.LineStyle = '--'; 
  



 58 

%% Periodos de carregamento em função do excesso de energia renovável 
disp('-----------------------------------------------------------------------
--------------------------------------------------------') 
disp('Carregamento em função do excesso de renovável') 
for i=1:size(ListaOrdenada) %Ciclo corrido para cada veículo (iterativo) 
    Periodos = 0; 
    z = 0; 
    custo = [excesso(:,1);excesso(:,3)]'; 
    run Janela.m   
    if ListaOrdenada(i,9) &gt; size(excesso_adaptado_ordenado) %Mensagem de erro 
caso não haja tempo suficiente para carregar o VE 
        run Erro.m 
    else 
        % disp('-------------------------------------------------------------
------------------------------------------------------------------') 
        % string2 = sprintf('\nVeículo %d: \n - Hora de chegada: %.2fh \n - 
Hora prevista de saída: %.2fh \n - Irá carregar nos seguintes períodos 
(precisa de %d, de um total disponíveis de 
%d):',ListaOrdenada(i,1),ListaOrdenada(i,2),ListaOrdenada(i,7),ListaOrdenada(
i,9),size(excesso_adaptado_ordenado,1)); 
        % disp(string2) 
        for k=1:ListaOrdenada(i,9) %ListaOrdenada(:,9) = Número de periodos 
necessários 
            Periodos(k,:) = excesso_adaptado_ordenado(k);  
            ListaOrdenada(i,10) = ListaOrdenada(i,10) + ListaOrdenada(i,6) * 
excesso_adaptado_ordenado(k,3)/4; %Cálculo do custo de carregamento 
            for a=1:size(excesso) %Subtração da energia gasta pelo veículo ao 
diagrama de excessos 
                if excesso_adaptado_ordenado(k) == excesso(a,1) 
%size(excesso) = 96. O ciclo if irá percorrer a matriz "excesso", quando a 
hora do "periodo" for igual ao "excesso" irá ser subtraída a energia 
necessária pelo VE ao excesso atual 
                    excesso(a,2) = excesso(a,2) - ListaOrdenada(i,6); % 
ListaOrdenada(:,6) = Potência utilizada pelo carregador 
                end 
            end           
        end    
        % Periodos 
        % string3 = sprintf('Custo de carregamento: %.2f 
Euros\n',ListaOrdenada(i,10)); 
        % disp(string3) 
    end     
    subplot(5,1,2) %Intermédio 
    plot(excesso(:,1),excesso(:,2),'LineWidth',1); 
end 
  
%% Períodos de carregamento em função do preço da energia MIBEL 
consumo(:,1) = excesso(:,1); 
consumo(:,2) = excesso_original; 
disp('-----------------------------------------------------------------------
--------------------------------------------------------') 
disp('Carregamento em função do preço da energia') 
  
for i=1:size(ListaOrdenada) %Ciclo corrido para cada veículo (iterativo) 
    Periodos = 0; 
    z = 1; 
    run Janela.m 
       if ListaOrdenada(i,9) &gt; size(excesso_adaptado_ordenado) %Mensagem de 
erro caso não haja tempo suficiente para carregar o VE 
           run Erro.m 
       else 
           %disp('-----------------------------------------------------------
--------------------------------------------------------------------') 
           %string2 = sprintf('\nVeículo %d: \n - Hora de chegada: %.2fh \n - 
Hora prevista de saída: %.2fh \n - Irá carregar nos seguintes períodos 



 59 

(precisa de %d, de um total disponíveis de 
%d):',ListaOrdenada(i,1),ListaOrdenada(i,2),ListaOrdenada(i,7),ListaOrdenada(
i,9),size(excesso_adaptado_ordenado,1)); 
           %disp(string2) 
           for k=1:ListaOrdenada(i,9) %ListaOrdenada(:,9) = Número de 
períodos necessários 
               Periodos(k,:) = excesso_adaptado_ordenado(k);  
               ListaOrdenada(i,11) = ListaOrdenada(i,11) + ListaOrdenada(i,6) 
* excesso_adaptado_ordenado(k,3)/4; %Cálculo do custo de carregamento 
               for a=1:size(excesso) %Subtração da energia gasta pelo veículo 
ao diagrama de excessos 
                   if excesso_adaptado_ordenado(k) == excesso(a,1) 
%size(excesso) = 96. O ciclo if irá percorrer a matriz "excesso", quando a 
hora do "período" for igual ao "excesso" irá ser subtraída a energia 
necessária pelo VE ao excesso atual 
                       consumo(a,2) = consumo(a,2) - ListaOrdenada(i,6); % 
ListaOrdenada(:,6) = Potência utilizada pelo carregador 
                   end 
               end 
           end 
           Periodos; 
           %string3 = sprintf('Custo de carregamento: %.2f 
Euros\n',ListaOrdenada(i,11)); 
           %disp(string3) 
       end 
       consumo; 
       subplot(5,1,4) %Intermédio 
       hold on 
       plot(consumo(:,1),consumo(:,2),'LineWidth',1); 
end 
  
  
run Plots.m 
  
%% Carregamento não inteligente 
excesso = excesso9_10; 
  
disp('--------------------------------------------------------------------') 
disp('Carregamento não inteligente') 
for i=1:size(ListaOrdenada) %Ciclo corrido para cada veículo (iterativo) 
    Periodos = 0; 
    z = 2; 
    run Janela.m 
       if ListaOrdenada(i,9) &gt; size(excesso_adaptado_ordenado) %Mensagem de 
erro caso não haja tempo suficiente para carregar o VE 
           run Erro.m 
       else 
           %disp('-----------------------------------------------------------
--------------------------------------------------------------------') 
           %string2 = sprintf('\nVeículo %d: \n - Hora de chegada: %.2fh \n - 
Hora prevista de saída: %.2fh \n - Irá carregar nos seguintes períodos 
(precisa de %d, de um total disponíveis de 
%d):',ListaOrdenada(i,1),ListaOrdenada(i,2),ListaOrdenada(i,7),ListaOrdenada(
i,9),size(excesso_adaptado_ordenado,1)); 
           %disp(string2) 
           for k=1:ListaOrdenada(i,9) %ListaOrdenada(:,9) = Número de 
períodos necessários 
               Periodos(k,:) = excesso_adaptado_ordenado(k);  
               ListaOrdenada(i,12) = ListaOrdenada(i,12) + ListaOrdenada(i,6) 
* excesso_adaptado_ordenado(k,3)/4; %Cálculo do custo de carregamento 
               for a=1:size(excesso) %Subtração da energia gasta pelo veículo 
ao diagrama de excessos 
                   if excesso_adaptado_ordenado(k) == excesso(a,1) 
%size(excesso) = 96. O ciclo if irá percorrer a matriz "excesso", quando a 



 60 

hora do "período" for igual ao "excesso" irá ser subtraída a energia 
necessária pelo VE ao excesso atual 
                    excesso(a,2) = excesso(a,2) - ListaOrdenada(i,6); % 
ListaOrdenada(:,6) = Potência utilizada pelo carregador 
                end 
               end 
           end 
           Periodos; 
           %string3 = sprintf('Custo de carregamento: %.2f 
Euros\n',ListaOrdenada(i,12)); 
           %disp(string3) 
       end 
        
       subplot(5,1,5) %Intermédio 
       hold on 
       plot(excesso(:,1),excesso(:,2),'LineWidth',1); 
end 
plot(excesso(:,1),excesso_original,'b','LineWidth',4); %Excesso original 
disp('--------------------------------------------------------------------') 
%-------------------------------------------------------------------------- 
% ListaOrdenada 
  
%% ---------------------------------------- Dia 2 e 3 de fevereiro de 2017 
disp('Algortimo para os dias 2 e 3 de fevereiro de 2016') 
excesso = excesso2_3; 
excesso_original = excesso(:,2); 
dia1 = 2; 
dia2 = 3; 
  
figure 
    subplot(5,1,1) 
        hold on 
        plot(excesso(:,1),excesso_original,'LineWidth',3); %Excesso original 
    subplot(5,1,2) 
        hold on 
        plot(excesso(:,1),excesso_original,'b','LineWidth',3); %Excesso 
original 
        LV4 = line([h h],[-500 200]); %Linha vertical hora atual hipotética 
        LV4.Color = 'blue'; 
        LV4.LineStyle = '--'; 
    subplot(5,1,3) 
        hold on 
        plot(excesso(:,1),excesso(:,3),'LineWidth',3); %Custo energia MIBEL 
        plot(excesso(:,1),excesso(:,4),'LineWidth',3); %Custo energia bi-
horário 
    subplot(5,1,4) 
        hold on 
        plot(excesso(:,1),excesso_original,'b','LineWidth',3); %Excesso 
original 
        LV4 = line([h h],[-500 200]); %Linha vertical hora atual hipotética 
        LV4.Color = 'blue'; 
        LV4.LineStyle = '--'; 
    subplot(5,1,5) 
        hold on 
        plot(excesso(:,1),excesso_original,'b','LineWidth',3); %Excesso 
original 
        LV6 = line([h h],[-500 200]); %Linha vertical hora atual hipotética 
        LV6.Color = 'blue'; 
        LV6.LineStyle = '--'; 
  
%% Periodos de carregamento em função do excesso de energia renovável 
disp('-----------------------------------------------------------------------
--------------------------------------------------------') 
disp('Carregamento em função do excesso de renovável') 
for i=1:size(ListaOrdenada) %Ciclo corrido para cada veículo (iterativo) 



 61 

    Periodos = 0; 
    z = 0; 
    custo = [excesso(:,1);excesso(:,3)]'; 
    run Janela.m   
    if ListaOrdenada(i,9) &gt; size(excesso_adaptado_ordenado) %Mensagem de erro 
caso não haja tempo suficiente para carregar o VE 
        run Erro.m 
    else 
        %disp('--------------------------------------------------------------
-----------------------------------------------------------------') 
        %string2 = sprintf('\nVeículo %d: \n - Hora de chegada: %.2fh \n - 
Hora prevista de saída: %.2fh \n - Irá carregar nos seguintes períodos 
(precisa de %d, de um total disponíveis de 
%d):',ListaOrdenada(i,1),ListaOrdenada(i,2),ListaOrdenada(i,7),ListaOrdenada(
i,9),size(excesso_adaptado_ordenado,1)); 
        %disp(string2) 
        for k=1:ListaOrdenada(i,9) %ListaOrdenada(:,9) = Número de periodos 
necessários 
            Periodos(k,:) = excesso_adaptado_ordenado(k);  
            ListaOrdenada(i,10) = ListaOrdenada(i,10) + ListaOrdenada(i,6) * 
excesso_adaptado_ordenado(k,3)/4; %Cálculo do custo de carregamento 
            for a=1:size(excesso) %Subtração da energia gasta pelo veículo ao 
diagrama de excessos 
                if excesso_adaptado_ordenado(k) == excesso(a,1) 
%size(excesso) = 96. O ciclo if irá percorrer a matriz "excesso", quando a 
hora do "periodo" for igual ao "excesso" irá ser subtraída a energia 
necessária pelo VE ao excesso atual 
                    excesso(a,2) = excesso(a,2) - ListaOrdenada(i,6); % 
ListaOrdenada(:,6) = Potência utilizada pelo carregador 
                end 
            end           
        end    
        %Periodos 
        %string3 = sprintf('Custo de carregamento: %.2f 
Euros\n',ListaOrdenada(i,10)); 
        %disp(string3) 
    end     
    subplot(5,1,2) %Intermédio 
    hold on 
    plot(excesso(:,1),excesso(:,2),'LineWidth',1); 
end 
  
%% Períodos de carregamento em função do preço da energia MIBEL 
consumo(:,1) = excesso(:,1); 
consumo(:,2) = excesso_original; 
disp('-----------------------------------------------------------------------
--------------------------------------------------------') 
disp('Carregamento em função do preço da energia') 
  
for i=1:size(ListaOrdenada) %Ciclo corrido para cada veículo (iterativo) 
    Periodos = 0; 
    z = 1; 
    run Janela.m 
       if ListaOrdenada(i,9) &gt; size(excesso_adaptado_ordenado) %Mensagem de 
erro caso não haja tempo suficiente para carregar o VE 
           run Erro.m 
       else 
           %disp('-----------------------------------------------------------
--------------------------------------------------------------------') 
           %string2 = sprintf('\nVeículo %d: \n - Hora de chegada: %.2fh \n - 
Hora prevista de saída: %.2fh \n - Irá carregar nos seguintes períodos 
(precisa de %d, de um total disponíveis de 
%d):',ListaOrdenada(i,1),ListaOrdenada(i,2),ListaOrdenada(i,7),ListaOrdenada(
i,9),size(excesso_adaptado_ordenado,1)); 
           %disp(string2) 



 62 

           for k=1:ListaOrdenada(i,9) %ListaOrdenada(:,9) = Número de 
periodos necessários 
               Periodos(k,:) = excesso_adaptado_ordenado(k);  
               ListaOrdenada(i,11) = ListaOrdenada(i,11) + ListaOrdenada(i,6) 
* excesso_adaptado_ordenado(k,3)/4; %Cálculo do custo de carregamento 
               for a=1:size(excesso) %Subtração da energia gasta pelo veículo 
ao diagrama de excessos 
                   if excesso_adaptado_ordenado(k) == excesso(a,1) 
%size(excesso) = 96. O ciclo if irá percorrer a matriz "excesso", quando a 
hora do "periodo" for igual ao "excesso" irá ser subtraída a energia 
necessária pelo VE ao excesso atual 
                       consumo(a,2) = consumo(a,2) - ListaOrdenada(i,6); % 
ListaOrdenada(:,6) = Potência utilizada pelo carregador 
                   end 
               end 
           end 
           Periodos; 
           %string3 = sprintf('Custo de carregamento: %.2f 
Euros\n',ListaOrdenada(i,11)); 
           %disp(string3) 
       end 
       consumo; 
       subplot(5,1,4) %Intermédio 
       hold on 
       plot(consumo(:,1),consumo(:,2),'LineWidth',1); 
end 
  
run Plots.m 
  
%% Carregamento não inteligente 
excesso = excesso2_3; 
  
disp('--------------------------------------------------------------------') 
disp('Carregamento não inteligente') 
for i=1:size(ListaOrdenada) %Ciclo corrido para cada veículo (iterativo) 
    Periodos = 0; 
    z = 2; 
    run Janela.m 
       if ListaOrdenada(i,9) &gt; size(excesso_adaptado_ordenado) %Mensagem de 
erro caso não haja tempo suficiente para carregar o VE 
           run Erro.m 
       else 
           %disp('-----------------------------------------------------------
--------------------------------------------------------------------') 
           %string2 = sprintf('\nVeículo %d: \n - Hora de chegada: %.2fh \n - 
Hora prevista de saída: %.2fh \n - Irá carregar nos seguintes períodos 
(precisa de %d, de um total disponíveis de 
%d):',ListaOrdenada(i,1),ListaOrdenada(i,2),ListaOrdenada(i,7),ListaOrdenada(
i,9),size(excesso_adaptado_ordenado,1)); 
           %disp(string2) 
           for k=1:ListaOrdenada(i,9) %ListaOrdenada(:,9) = Número de 
periodos necessários 
               Periodos(k,:) = excesso_adaptado_ordenado(k);  
               ListaOrdenada(i,12) = ListaOrdenada(i,12) + ListaOrdenada(i,6) 
* excesso_adaptado_ordenado(k,3)/4; %Cálculo do custo de carregamento 
               for a=1:size(excesso) %Subtração da energia gasta pelo veículo 
ao diagrama de excessos 
                   if excesso_adaptado_ordenado(k) == excesso(a,1) 
%size(excesso) = 96. O ciclo if irá percorrer a matriz "excesso", quando a 
hora do "periodo" for igual ao "excesso" irá ser subtraída a energia 
necessária pelo VE ao excesso atual 
                    excesso(a,2) = excesso(a,2) - ListaOrdenada(i,6); % 
ListaOrdenada(:,6) = Potência utilizada pelo carregador 
                end 
               end 



 63 

           end 
           Periodos; 
           %string3 = sprintf('Custo de carregamento: %.2f 
Euros\n',ListaOrdenada(i,12)); 
           %disp(string3) 
       end 
        
       subplot(5,1,5) %Intermédio 
       hold on 
       plot(excesso(:,1),excesso(:,2),'LineWidth',1); 
end 
plot(excesso(:,1),excesso_original,'b','LineWidth',4); %Excesso original 
disp('--------------------------------------------------------------------') 
%-------------------------------------------------------------------------- 
% ListaOrdenada % Lista final de VE com os custos de carregamento 
toc 
  



 64 

9 Anexo B - Previsao.m 

 
% Este script, através dos ficheiros Excel disponibilizados pelo site de  
% informação da REN (http://www.centrodeinformacao.ren.pt/) calcula o excesso 
% de energia renovável que existe em determinados dias 
% As informações do preço da energia foram adquiridas em: 
%http://www.mercado.ren.pt/PT/Electr/InfoMercado/InfOp/MercOmel/Paginas/Preco
s.aspx 
  
%% Dados referentes a 9 de agosto de 2016 
    data = xlsread('9ago.xlsx'); %Colocar nome do ficheiro. Por vezes ocorre 
um erro que tem de se abrir o Excel normalmente e gravar novamente 
  
    carvao = data(:,3); 
    fuel = data(:,4); 
    gas = data(:,5); 
    albufeiras = data(:,6); 
    fios = data(:,7); 
    import9 = data(:,8); 
    export9 = data(:,9); 
    PRE_hidro = data(:,10); 
    PRE_termico = data(:,11); 
    PRE_eolica = data(:,12); 
    PRE_foto = data(:,13); 
    PRE_ondas = data(:,14); 
    bombagem9 = data(:,15); 
    consumo9 = data(:,16); 
  
    producao9 = carvao + fuel + gas + albufeiras + fios + PRE_hidro + 
PRE_termico + PRE_eolica + PRE_foto + PRE_ondas; 
    renovavel9 = albufeiras + fios +PRE_hidro + PRE_termico + PRE_eolica + 
PRE_foto + PRE_ondas; 
    excesso9 = renovavel9 - consumo9; 
     
    preco9 = [45.1000000000000 42.5000000000000 37 35.2600000000000 
32.5300000000000 32.5000000000000 39.7300000000000 43.7800000000000 
44.8000000000000 43.4700000000000 39.4100000000000 40.8500000000000 
42.1300000000000 43.4700000000000 43.4700000000000 38.7100000000000 38 38 37 
35.8000000000000 38.4100000000000 44 44 36.0700000000000]; 
    preco9 = preco9 / 1000; 
     
%% Dados referentes a 10 de agosto de 2016 
    data = xlsread('10ago.xlsx'); %Colocar nome do ficheiro. Por vezes ocorre 
um erro que tem de se abrir o Excel normalmente e gravar novamente pois o 
ficheiro, segundo o Excel, provém de fontes não seguras. 
  
    carvao = data(:,3); 
    fuel = data(:,4); 
    gas = data(:,5); 
    albufeiras = data(:,6); 
    fios = data(:,7); 
    import10 = data(:,8); 
    export10 = data(:,9); 
    PRE_hidro = data(:,10); 
    PRE_termico = data(:,11); 
    PRE_eolica = data(:,12); 
    PRE_foto = data(:,13); 
    PRE_ondas = data(:,14); 
    bombagem10 = data(:,15); 
    consumo10 = data(:,16); 
  



 65 

    producao10 = carvao + fuel + gas + albufeiras + fios + PRE_hidro + 
PRE_termico + PRE_eolica + PRE_foto + PRE_ondas; 
    renovavel10 = albufeiras + fios +PRE_hidro + PRE_termico + PRE_eolica + 
PRE_foto + PRE_ondas; 
    excesso10 = renovavel10 - consumo10; 
     
    preco10 = [31.3400000000000 30.5200000000000 26.9000000000000 26 
25.9700000000000 26.2200000000000 28.3900000000000 31.0500000000000 
33.9500000000000 38.9800000000000 38.6300000000000 38.2900000000000 
36.7000000000000 38.4400000000000 38.4400000000000 36.0900000000000 
36.9000000000000 38.2900000000000 39.1200000000000 40.8400000000000 
44.8400000000000 47.2000000000000 47 39.7000000000000]; 
    preco10 = preco10 / 1000; 
     
%% Dados referentes a 2 de fevereiro de 2017 
    data = xlsread('2fev.xlsx'); %Colocar nome do ficheiro. Por vezes ocorre 
um erro que tem de se abrir o excel normalmente e gravar novamente pois o 
ficheiro, segundo o Excel, provém de fontes não seguras. 
 
  
    carvao = data(:,3); 
    fuel = data(:,4); 
    gas = data(:,5); 
    albufeiras = data(:,6); 
    fios = data(:,7); 
    import2 = data(:,8); 
    export2 = data(:,9); 
    PRE_hidro = data(:,10); 
    PRE_termico = data(:,11); 
    PRE_eolica = data(:,12); 
    PRE_foto = data(:,13); 
    PRE_ondas = data(:,14); 
    bombagem2 = data(:,15); 
    consumo2 = data(:,16); 
  
    producao2 = carvao + fuel + gas + albufeiras + fios + PRE_hidro + 
PRE_termico + PRE_eolica + PRE_foto + PRE_ondas; 
    renovavel2 = albufeiras + fios +PRE_hidro + PRE_termico + PRE_eolica + 
PRE_foto + PRE_ondas; 
    excesso2 = renovavel2 - consumo2; 
     
    preco2 = [41.1100000000000 38.7400000000000 36.9400000000000 
33.9000000000000 33.8500000000000 33.7700000000000 39.9100000000000 
55.5800000000000 57.1900000000000 59.1000000000000 58.6900000000000 
57.6600000000000 57.6600000000000 54.4400000000000 50.9000000000000 
47.1000000000000 45.9800000000000 48.8000000000000 56.1100000000000 
60.7900000000000 61.2300000000000 60.7100000000000 49.6100000000000 
42.1200000000000]; 
    preco2 = preco2 / 1000; 
     
%% Dados referentes a 3 de fevereiro de 2017 
    data = xlsread('3fev.xlsx'); %Colocar nome do ficheiro. Por vezes ocorre 
um erro que tem de se abrir o excel normalmente e gravar novamente pois o 
ficheiro, segundo o Excel, provém de fontes não seguras. 
 
  
    carvao = data(:,3); 
    fuel = data(:,4); 
    gas = data(:,5); 
    albufeiras = data(:,6); 
    fios = data(:,7); 
    import3 = data(:,8); 
    export3 = data(:,9); 
    PRE_hidro = data(:,10); 
    PRE_termico = data(:,11); 



 66 

    PRE_eolica = data(:,12); 
    PRE_foto = data(:,13); 
    PRE_ondas = data(:,14); 
    bombagem3 = data(:,15); 
    consumo3 = data(:,16); 
  
    producao3 = carvao + fuel + gas + albufeiras + fios + PRE_hidro + 
PRE_termico + PRE_eolica + PRE_foto + PRE_ondas; 
    renovavel3 = albufeiras + fios +PRE_hidro + PRE_termico + PRE_eolica + 
PRE_foto + PRE_ondas; 
    excesso3 = renovavel3 - consumo3; 
     
    preco3 = [39.8700000000000 34.9200000000000 34.2600000000000 
32.5500000000000 32.4900000000000 34.5800000000000 40 52.6000000000000 
53.6200000000000 55.7900000000000 56.6700000000000 55.9700000000000 
54.3700000000000 53.6700000000000 51.9600000000000 48.4700000000000 
47.4700000000000 52.0100000000000 55.7900000000000 58.2900000000000 
53.6900000000000 52.6200000000000 44.2500000000000 39.8500000000000]; 
    preco3 = preco3 / 1000; 
     
%% Associações de dias de modo a ter uma janela não de um mas de dois dias 
% 9 com 10 de agosto 
    excesso9_10(1:96) = excesso9; 
    excesso9_10(97:192) = excesso10; 
     
    producao9_10(1:96) = producao9; 
    producao9_10(97:192) = producao10; 
     
    consumo9_10(1:96) = consumo9; 
    consumo9_10(97:192) = consumo10; 
     
    bombagem9_10(1:96) = bombagem9; 
    bombagem9_10(97:192) = bombagem10; 
     
    renovavel9_10(1:96) = renovavel9; 
    renovavel9_10(97:192) = renovavel10; 
     
    export9_10(1:96) = export9; 
    export9_10(97:192) = export10; 
     
    import9_10(1:96) = import9; 
    import9_10(97:192) = import10; 
     
%2 com 3 de fevereiro 
    excesso2_3(1:96) = excesso2; 
    excesso2_3(97:192) = excesso3; 
     
    producao2_3(1:96) = producao2; 
    producao2_3(97:192) = producao3; 
     
    consumo2_3(1:96) = consumo2; 
    consumo2_3(97:192) = consumo3; 
     
    bombagem2_3(1:96) = bombagem2; 
    bombagem2_3(97:192) = bombagem3; 
     
    renovavel2_3(1:96) = renovavel2; 
    renovavel2_3(97:192) = renovavel3; 
     
    export2_3(1:96) = export3; 
    export2_3(97:192) = export3; 
     
    import2_3(1:96) = import3; 
    import2_3(97:192) = import3; 
     



 67 

    %Os preços estão variam a cada hora. É preciso ter valores de 15 em 15 
mim tal como os diagramas de energia 
    i=1; 
for j=1:24 %Preços de dia 2 com 96 valores. 
    preco2_96(i) = preco2(j); 
    i=i+1; 
    preco2_96(i) = preco2(j); 
    i=i+1; 
    preco2_96(i) = preco2(j); 
    i=i+1; 
    preco2_96(i) = preco2(j); 
    i=i+1; 
end 
  
    i=1; 
for j=1:24 %Preços de dia 3 com 96 valores. 
    preco3_96(i) = preco3(j); 
    i=i+1; 
    preco3_96(i) = preco3(j); 
    i=i+1; 
    preco3_96(i) = preco3(j); 
    i=i+1; 
    preco3_96(i) = preco3(j); 
    i=i+1; 
end 
  
preco2_3(1:96) = preco2_96; 
preco2_3(97:192) = preco3_96; 
  
i=1; 
for j=1:24 %Preços de dia 9 com 96 valores. 
    preco9_96(i) = preco9(j); 
    i=i+1; 
    preco9_96(i) = preco9(j); 
    i=i+1; 
    preco9_96(i) = preco9(j); 
    i=i+1; 
    preco9_96(i) = preco9(j); 
    i=i+1; 
end 
  
    i=1; 
for j=1:24 %Preços de dia 3 com 96 valores. 
    preco10_96(i) = preco10(j); 
    i=i+1; 
    preco10_96(i) = preco10(j); 
    i=i+1; 
    preco10_96(i) = preco10(j); 
    i=i+1; 
    preco10_96(i) = preco10(j); 
    i=i+1; 
end 
  
preco9_10(1:96) = preco9_96; 
preco9_10(97:192) = preco10_96; 
  
%Preços tarifa bi-horária 
n = 0.1942; 
v = 0.1014; 
bi = [v v v v v v v v n n n n n n n n n n n n n n v v]; 
i = 1; 
for j=1:24 
    bi_96(i) = bi(j); 
    i=i+1; 
    bi_96(i) = bi(j); 



 68 

    i=i+1; 
    bi_96(i) = bi(j); 
    i=i+1; 
    bi_96(i) = bi(j); 
    i=i+1; 
end 
     
bi_2_96(1:96) = bi_96; %Adaptar tarifa bi-horária para 2 dias 
bi_2_96(97:192) = bi_96; 
bi_2_96 = bi_2_96 * 1.23; %(IVA) 
  
%% Graficos 9 e 10 de agosto de 2016 
x = 0:0.25:47.75; 
  
figure 
    subplot(3,1,1) % Diagrama Nacional 
        hold on 
        grid on 
  
        yyaxis left 
            ylabel('MW','fontweight','bold') 
            a1 = area(x,consumo9_10+bombagem9_10); 
            a1.FaceColor = [255/255;211/255;155/255]; 
  
            a2 = area(x,producao9_10); 
            a2.FaceColor = [191/255;239/255;255/255]; 
  
            plot(x,consumo9_10 + bombagem9_10,'b','LineWidth',2); 
            plot(x,consumo9_10,'k','LineWidth',4); 
            plot(x,renovavel9_10,'g','LineWidth',2) 
  
        yyaxis right 
            plot(x,preco9_10) 
            ylabel('E/MWh','fontweight','bold') 
  
        title('Diagrama de Consumo Total - 9 e 10 de agosto de 
2016','fontweight','bold','fontsize',14) 
        legend('Importação','Produção','Consumo+Bombagem','Consumo','Renováve
l','Custo Energia','Location','southeast') 
        xlabel('Horas','fontweight','bold'); 
        horizontal = line([0 48],[0 0]); %Linha horizontal y = 0 
        horizontal.Color = 'black'; 
        set(gca,'XTick',0:2:48); %Aumentar o número de espaçamentos no eixo x 
        xticklabels({0 2 4 6 8 10 12 14 16 18 20 22 24 2 4 6 8 10 12 14 16 18 
20 22 24}) 
        xlim([0 48]) 
  
    subplot(3,1,2) % Balanço Renovável 
        hold on 
        grid on 
  
        aux1 = excesso9_10; 
        a3 = area(x,aux1); 
        a3.FaceColor = [202/255;255/255;112/255]; 
  
        title('Balanço Energia Renovável - 9 e 10 de agosto de 2016 (face ao 
consumo)','fontweight','bold','fontsize',14) 
        legend('Balanço energia renovável') 
        ylabel('MW','fontweight','bold') 
        xlabel('Horas','fontweight','bold'); 
        horizontal = line([0 48],[0 0]); %Linha horizontal y = 0 
        horizontal.Color = 'black'; 
        set(gca,'XTick',0:2:48); %Aumentar o número de espaçamentos no eixo x 
        xticklabels({0 2 4 6 8 10 12 14 16 18 20 22 24 2 4 6 8 10 12 14 16 18 
20 22 24}) 



 69 

        xlim([0 48]) 
         
    subplot(3,1,3); %Saldo Importador e Bombagem 
        hold on 
        grid on  
  
        a4 = area(x,bombagem9_10); 
        a4.FaceColor = [56/255;176/255;222/255]; 
        alpha(.7) 
  
        a5 = area(x,-export9_10); 
        a5.FaceColor = [255/255 127/255 36/255]; 
  
        a6 = area(x,import9_10); 
        a6.FaceColor = [255/255;211/255;155/255]; 
  
        title('Saldo Importador e 
Bombagem','fontweight','bold','fontsize',14) 
        legend('Bombagem','Exportação','Importação'); 
        ylabel('MW','fontweight','bold') 
        xlabel('Horas','fontweight','bold'); 
        xlim([0 23.5]) 
        set(gca,'XTick',0:1:24); %Aumentar o número de espaçamentos no eixo x 
         
%% Gráficos 2 e 3 de fevereiro de 2017    
figure     
    subplot(3,1,1) % Diagrama Nacional 
        hold on 
        grid on 
  
        yyaxis left 
            ylabel('MW','fontweight','bold') 
            a7 = area(x,consumo2_3+bombagem2_3); 
            a7.FaceColor = [255/255;211/255;155/255]; 
  
            a8 = area(x,producao2_3); 
            a8.FaceColor = [191/255;239/255;255/255]; 
  
            plot(x,consumo2_3 + bombagem2_3,'b','LineWidth',2); 
            plot(x,consumo2_3,'k','LineWidth',4); 
            plot(x,renovavel2_3,'g','LineWidth',2) 
  
        yyaxis right 
            plot(x,preco2_3) 
            ylabel('E/MWh','fontweight','bold') 
  
        title('Diagrama de Consumo Total - 2 e 3 de fevereiro de 
2017','fontweight','bold','fontsize',14) 
        legend('Importação','Produção','Consumo+Bombagem','Consumo','Renovave
l','Custo Energia','Location','southeast') 
        xlabel('Horas','fontweight','bold'); 
        horizontal = line([0 48],[0 0]); %Linha horizontal y = 0 
        horizontal.Color = 'black'; 
        set(gca,'XTick',0:2:48); %Aumentar o número de espaçamentos no eixo x 
        xticklabels({0 2 4 6 8 10 12 14 16 18 20 22 24 2 4 6 8 10 12 14 16 18 
20 22 24}) 
        xlim([0 48]) 
  
    subplot(3,1,2) % Balanço Renovável 
        grid on 
        plot(x,excesso2_3) 
  
        aux2 = excesso2_3; 
        a9 = area(x,aux2); 
        a9.FaceColor = [202/255;255/255;112/255]; 



 70 

  
        title('Balanço Energia Renovável - 2 e 3 de fevereiro de 2017 (face 
ao consumo)','fontweight','bold','fontsize',14) 
        legend('Balanço energia renovável') 
        xlabel('Horas','fontweight','bold'); 
        ylabel('MW','fontweight','bold') 
        horizontal = line([0 48],[0 0]); %Linha horizontal y = 0 
        horizontal.Color = 'black'; 
        set(gca,'XTick',0:2:48); %Aumentar o número de espaçamentos no eixo x 
        xticklabels({0 2 4 6 8 10 12 14 16 18 20 22 24 2 4 6 8 10 12 14 16 18 
20 22 24}) 
        xlim([0 48]) 
         
    subplot(3,1,3); %Saldo Importador e Bombagem 
        hold on 
        grid on  
  
        a10 = area(x,bombagem2_3); 
        a10.FaceColor = [56/255;176/255;222/255]; 
        alpha(.7) 
  
        a11 = area(x,-export2_3); 
        a11.FaceColor = [255/255 127/255 36/255]; 
  
        a12 = area(x,import2_3); 
        a12.FaceColor = [255/255;211/255;155/255]; 
  
        title('Saldo Importador e 
Bombagem','fontweight','bold','fontsize',14) 
        legend('Bombagem','Exportação','Importação'); 
        ylabel('MW','fontweight','bold') 
        xlabel('Horas','fontweight','bold'); 
        xlim([0 23.5]) 
        set(gca,'XTick',0:1:24); %Aumentar o número de espaçamentos no eixo x 
  
%% Preço real pago pelos consumidores 
% Estamos a utilizar os dados do MIBEL para termos tarifas variáveis hora a 
hora.  
% A única incoerência é o seu valor absoluto. Quando houver tarifas em tempo  
% real é normal que estas acompanhem a variação do MIBEL, mas o valor 
absoluto  
% da tarifa que chega ao cliente final é obviamente mais alto (para pagar  
% transporte, distribuição, margens de lucro, etc.). 
% Assim, para termos valores mais realistas o ideal é utilizar a variação  
% da tarifa no MIBEL nesse dia, mas multiplicada por um fator que a relacione 
% com o preço final. 
  
% Considerando a tarifa 
% 
http://www.edpsu.pt/pt/particulares/tarifasehorarios/BTN/Pages/TarifasBTNate2
0.7kVA.aspx 
% [ 0,1942*1.23(IVA)*14(horas) + 0,1014*1.23(IVA)*10(horas) ] / 24 (horas) 
  
% Podemos também calcular o preço médio do MIBEL para esse dia durante as  
% 24 horas (M) e ter assim o fator que relaciona os preços médios F=C/M 
% Basta assim multiplicar os valores do MIBEL por F para no final termos um  
% custo da energia médio que corresponde ao custo atual para o cliente final, 
% mas com uma variação igual à do MIBEL. 
  
C = (0.1942*1.23*14 + 0.1014*1.23*10) / 24; 
  
M9_10 = mean(preco9_10); 
F9_10 = C/M9_10; 
  
M2_3 = mean(preco2_3);  



 71 

F2_3 = C/M2_3; 
  
preco9_10 = preco9_10 * F9_10; 
preco2_3 = preco2_3 * F2_3; 
  
%------------------------------------------------------------------------- 
% Alterar daqui para baixo caso se pretenda usar preços bi-horário 
  
excesso9_10 = [x' excesso9_10'/r preco9_10' bi_2_96']; 
excesso2_3 = [x' excesso2_3'/r preco2_3' bi_2_96']; 
  
% Inverter comentários 
  
% excesso9_10 = [x' excesso9_10'/r bi_2_96' bi_2_96']; 
% excesso2_3 = [x' excesso2_3'/r bi_2_96' bi_2_96']; 
  



 72 

10 Anexo C - ListaVE.m 

 
% Lista de VE a carregar. 
% Na realidade será introduzido no sistema um a um (iterativo). 
% Cada carro, ao ser conectado ao sistema, irá executar de imediato o 
algoritmo. 
% Cada VE é uma linha. 
  
%INFORMAÇÕES RECOLHIDAS (por esta ordem; cada coluna uma informação): 
% 1 - Número de entrada do Veículo 
% 2 - Hora de chegada do veículo (horas) 
% 3 - Capacidade da bateria (kWh) 
% 4 - SOC pretendido (%) 
% 5 - SOC atual (%) 
% 6 - Potência do carregador (kW) 
% 7 - Hora prevista de saída (horas) 
% 8 - Tempo de carregamento (horas) 
% 9 - Número de períodos necessários (arredondado por excesso)  
% 10 - Custo de carregamento indo pelo excesso de renovável (em Euros) 
% 11 - Custo de carregamento indo pelo custo de energia (em Euros) 
% 12 - Custo de carregamento indo por carregamento normal (Euros) 
  
%Cenário real 
Lista = [ 
%    1    2     3   4   5   6   7   8  9 10 11 12 
    001 11.00 30.0 100 000 00 18.00 0 00 00 00 00 
    002 13.00 30.0 100 000 00 17.00 0 00 00 00 00 
    003 14.00 30.0 100 000 00 06.00 0 00 00 00 00 
    004 15.00 30.0 100 000 00 07.00 0 00 00 00 00 
    005 19.00 30.0 100 000 00 08.00 0 00 00 00 00 
    006 20.00 30.0 100 000 00 08.00 0 00 00 00 00 
    007 21.00 30.0 100 000 00 07.00 0 00 00 00 00 
    008 22.00 30.0 100 000 00 08.00 0 00 00 00 00 
    009 23.00 30.0 100 000 00 09.00 0 00 00 00 00 
    010 24.00 30.0 100 000 00 09.00 0 00 00 00 00 
    011 12.50 30.0 100 000 00 06.00 0 00 00 00 00 
    012 13.00 30.0 100 000 00 08.00 0 00 00 00 00 
    013 14.00 30.0 100 000 00 08.00 0 00 00 00 00 
    014 15.00 30.0 100 000 00 08.00 0 00 00 00 00 
    015 19.00 30.0 100 000 00 09.00 0 00 00 00 00 
    016 20.00 30.0 100 000 00 09.00 0 00 00 00 00 
    017 21.00 30.0 100 000 00 12.00 0 00 00 00 00 
    018 22.00 30.0 100 000 00 16.00 0 00 00 00 00 
    019 23.00 30.0 100 000 00 16.00 0 00 00 00 00 
    020 24.00 30.0 100 000 00 16.00 0 00 00 00 00  
    021 19.00 12.0 100 000 00 10.00 0 00 00 00 00 
    022 22.00 12.0 100 000 00 16.00 0 00 00 00 00 
    023 20.00 12.0 100 000 00 09.00 0 00 00 00 00 
    024 22.00 12.0 100 000 00 08.00 0 00 00 00 00 
    025 14.00 12.0 100 000 00 08.00 0 00 00 00 00 
    026 20.00 12.0 100 000 00 08.00 0 00 00 00 00 
    027 21.00 12.0 100 000 00 09.00 0 00 00 00 00 
    028 19.00 12.0 100 000 00 09.00 0 00 00 00 00 
    029 21.00 12.0 100 000 00 08.00 0 00 00 00 00 
    030 20.00 12.0 100 000 00 09.00 0 00 00 00 00 
    031 21.00 12.0 100 000 00 10.00 0 00 00 00 00 
    032 14.00 12.0 100 000 00 08.00 0 00 00 00 00 
    033 22.00 12.0 100 000 00 09.00 0 00 00 00 00 
    034 22.00 12.0 100 000 00 17.00 0 00 00 00 00 
    035 19.00 12.0 100 000 00 08.00 0 00 00 00 00 
    036 22.00 12.0 100 000 00 09.00 0 00 00 00 00 
    037 21.00 12.0 100 000 00 09.00 0 00 00 00 00 
    038 14.00 41.0 100 000 00 09.00 0 00 00 00 00 



 73 

    039 22.00 41.0 100 000 00 09.00 0 00 00 00 00 
    040 23.00 41.0 100 000 00 17.00 0 00 00 00 00 
    041 13.00 41.0 100 000 00 08.00 0 00 00 00 00 
    042 20.00 41.0 100 000 00 10.00 0 00 00 00 00 
    043 21.00 41.0 100 000 00 08.00 0 00 00 00 00 
    044 21.00 41.0 100 000 00 09.00 0 00 00 00 00 
    045 20.00 41.0 100 000 00 09.00 0 00 00 00 00 
    046 20.00 41.0 100 000 00 09.00 0 00 00 00 00 
    047 21.00 41.0 100 000 00 09.00 0 00 00 00 00 
    048 14.00 41.0 100 000 00 08.00 0 00 00 00 00 
    049 22.00 41.0 100 000 00 09.00 0 00 00 00 00 
    050 20.00 41.0 100 000 00 08.00 0 00 00 00 00 
    051 19.00 41.0 100 000 00 08.00 0 00 00 00 00 
    052 14.00 41.0 100 000 00 09.00 0 00 00 00 00 
    053 15.00 41.0 100 000 00 09.00 0 00 00 00 00 
    054 20.00 33.0 100 000 00 09.00 0 00 00 00 00 
    055 22.00 33.0 100 000 00 08.00 0 00 00 00 00 
    056 13.00 33.0 100 000 00 08.00 0 00 00 00 00 
    057 21.00 33.0 100 000 00 08.00 0 00 00 00 00 
    058 20.00 33.0 100 000 00 08.00 0 00 00 00 00 
    059 20.00 33.0 100 000 00 08.00 0 00 00 00 00 
    060 21.00 33.0 100 000 00 09.00 0 00 00 00 00 
    061 22.00 33.0 100 000 00 09.00 0 00 00 00 00 
    062 14.00 33.0 100 000 00 09.00 0 00 00 00 00 
    063 22.00 33.0 100 000 00 08.00 0 00 00 00 00 
    064 20.00 33.0 100 000 00 09.00 0 00 00 00 00 
    065 21.00 33.0 100 000 00 08.00 0 00 00 00 00 
    066 22.00 33.0 100 000 00 08.00 0 00 00 00 00 
    067 14.00 06.2 100 000 00 08.00 0 00 00 00 00 
    068 21.00 06.2 100 000 00 09.00 0 00 00 00 00 
    069 21.00 06.2 100 000 00 08.00 0 00 00 00 00 
    070 20.00 06.2 100 000 00 08.00 0 00 00 00 00 
    071 22.00 06.2 100 000 00 08.00 0 00 00 00 00 
    072 21.00 06.2 100 000 00 08.00 0 00 00 00 00 
    073 21.00 06.2 100 000 00 08.00 0 00 00 00 00 
    074 21.00 06.2 100 000 00 08.00 0 00 00 00 00 
    075 23.00 06.2 100 000 00 17.00 0 00 00 00 00 
    076 21.00 06.2 100 000 00 08.00 0 00 00 00 00 
    077 22.00 06.2 100 000 00 17.00 0 00 00 00 00 
    079 21.00 06.2 100 000 00 08.00 0 00 00 00 00 
    078 22.00 06.2 100 000 00 09.00 0 00 00 00 00 
    080 21.00 08.0 100 000 00 09.00 0 00 00 00 00 
    081 19.00 08.0 100 000 00 09.00 0 00 00 00 00 
    082 22.00 08.0 100 000 00 08.00 0 00 00 00 00 
    083 21.00 08.0 100 000 00 08.00 0 00 00 00 00 
    084 21.00 08.0 100 000 00 08.00 0 00 00 00 00 
    085 21.00 08.0 100 000 00 08.00 0 00 00 00 00 
    086 20.00 08.0 100 000 00 09.00 0 00 00 00 00 
    087 22.00 07.0 100 000 00 09.00 0 00 00 00 00 
    088 20.00 07.0 100 000 00 09.00 0 00 00 00 00 
    089 23.00 07.0 100 000 00 17.00 0 00 00 00 00 
    090 21.00 07.0 100 000 00 09.00 0 00 00 00 00 
    091 19.00 07.0 100 000 00 09.00 0 00 00 00 00 
    092 22.00 07.0 100 000 00 17.00 0 00 00 00 00 
    093 20.00 06.1 100 000 00 09.00 0 00 00 00 00 
    094 22.00 06.1 100 000 00 08.00 0 00 00 00 00 
    095 24.00 06.1 100 000 00 18.00 0 00 00 00 00 
    096 20.00 07.6 100 000 00 08.00 0 00 00 00 00 
    097 20.00 07.6 100 000 00 09.00 0 00 00 00 00 
    098 15.00 07.6 100 000 00 08.00 0 00 00 00 00 
    099 20.00 09.0 100 000 00 17.00 0 00 00 00 00 
    100 19.00 09.0 100 000 00 08.00 0 00 00 00 00 
]; 
  
   



 74 

for i=1:size(Lista) %Estimativa SOC atual 
    % Admitindo média de consumo de 3kWh - 6 kWh por dia (capítulo 4.3) 
    Lista(i,5) = (Lista(i,3) - randi([3 6]))*100 / Lista(i,3); 
end 
  
for i=1:size(Lista) %Estimativa Potência do carregador  
    % Valor variável compreendido entre 10 e 32 Amperes. 
    % Convertido para potência usando uma tensão igual a 230 V 
    Lista(i,6) = randi([10 32])*230/1000; 
end 
  
F = 1; %Fator que multiplica a nossa lista de VE por um fator f. 
Lista = repmat(Lista,F,1); 
% Útil caso se queira simular um maior número de VEs. 
  



 75 

11 Anexo D - Tempo.m 

 
% Calculo do tempo de carregamento para cada veículo. 
% A Lista fica ordenada por ordem de chegada 
  
for i=1:size(Lista,1) 
    Lista(i,8) = Lista(i,3) * (Lista(i,4)-Lista(i,5))/100/Lista(i,6); 
%Cálculo do tempo 
    Lista(i,9) = Lista(i,8)/(48/192); %Cálculo dos períodos necessários 
(quantos 15 mim precisa)(há 96 períodos por dia) 
    Lista(i,9) = ceil(Lista(i,9)); %Arredondamento por excesso do n.º de 
períodos 
    if Lista(i,2) &amp;lt;h %Explicado no ponto 1 
        Lista(i,2) = Lista(i,2) +24;  
    end 
    if Lista(i,7) &amp;lt;Lista(i,2) %Explicado no ponto 2 
        Lista(i,7) = Lista(i,7) + 24; 
    end 
end 
  
ListaOrdenada = sortrows(Lista,2); %Ordenamento da Lista de VEs por ordem 
decrescente de períodos necessários 
  
% Ponto 1 
% Hora atual = 12h. Se na lista aparecer, por exemplo, um VE com hora de 
chegada 9h, 
% significa que é do dia seguinte, logo temos de adicionar 24h. 
  
%Ponto 2 
% Na lista de VE temos VE a entrar por exemplo as 20:00h e a sair as 8:00h. 
% Na verdade essas 8:00h é do dia seguinte. Para o algoritmo funcionar 
% corretamente temos de adicionar 24 horas a esses casos. 
  



 76 

12 Anexo E – Erro.m 

% Mensagem de erro caso o veículo não tenha tempo de carregar 
  
disp('-----------------------------------------------------------------------
--------------------------------------------------------') 
  
string1 = sprintf('\nERRO - O veículo número %d não tem tempo suficiente para 
carregar!\n       Hora de chegada: %0.2fh\n       Hora prevista de saída: 
%dh\n       Precisa de %d períodos e só tem disponíveis %d.', 
ListaOrdenada(i,1),ListaOrdenada(i,2),ListaOrdenada(i,7),ListaOrdenada(i,9),s
ize(excesso_adaptado_ordenado,1)); 
disp(string1) 
  
%Informação e solução alternativa: 
  
% O veículo só conseguirá carregar x% do total: 
% size(excesso_adaptado_ordenado,1); %Número de períodos disponíveis 
% ListaOrdenada(i,9); %Número de períodos necessários 
  
aux1 = round(size(excesso_adaptado_ordenado,1)*100/ListaOrdenada(i,9)); % 
Regra de 3 simples 
  
% Carga disponível ás x horas: 
aux2 = (ListaOrdenada(i,9) - size(excesso_adaptado_ordenado,1))/4 + 
ListaOrdenada(i,7); 
  
string2 = sprintf('       O veículo só conseguirá carregar %d%% do total da 
bateria até as %dh. \n       A carga total só estará disponível às %0.2f 
horas.',aux1,ListaOrdenada(i,7),aux2); 
disp(string2) 
 
  



 77 

13 Anexo F - Janela.m 

 
% Calculo da janela de carregamento. 
% Cada veículo terá a sua prórpia janela tendo em conta a hora atual e a hora 
prevista de saída. 
  
a = -9999; %Variável para ajudar a calcular a janela possível 
  
excesso_adaptado = zeros(192,4); 
for j=1:192 %Ciclo para determinar janela possível tendo em conta hora 
prevista de saída  
    if (j-1 &gt; ListaOrdenada(i,2)*96/24 &amp;amp;&amp;amp; j&amp;lt;= ListaOrdenada(i,7)*96/24) %if 
hora de saída &gt; hora de excesso ou periodo j &gt; hora real em periodos de 15 
mim, é possível carregar nessa hora 
        excesso_adaptado(j,:) = excesso(j,:); %janela limitada por hora de 
saída 
    else 
        excesso_adaptado(j,:) = a; 
    end 
end 
 
% O ciclo abaixo serve para ordenar a variável excesso_adaptado_ordenado em 
função do objetivo pretendido. 
  
if z == 0 %Ciclo em função do preço 
    excesso_adaptado_ordenado = flip(sortrows(excesso_adaptado,2)); 
elseif z == 1 %Ciclo excesso energia 
    excesso_adaptado_ordenado = sortrows(excesso_adaptado,3); %Modificar caso 
se pretenda trabalhar com o custo de energia 
elseif z == 2 %Carregamento normal  
    excesso_adaptado_ordenado = excesso_adaptado; 
end 
  
rows_to_remove = any(excesso_adaptado_ordenado==a, 2); 
excesso_adaptado_ordenado(rows_to_remove,:) = []; 
excesso_adaptado_ordenado; %Janela que o VEi possui ordenada por ordem 
  
% No ciclo for, o programa cria uma matriz 192x4, a qual grande parte é zero. 
% Ele compara uma lista de 192 números. Quando é verdadeiro é copiada a 
% informação da matriz “excesso” para a matriz “excesso_adaptado” mas, pelo  
% meio a comparação também irá dar falso, como o programa tem de colocar  
% qualquer coisa na matriz, então mete esses valores todos a zero. Para o  
% problema funcionar temos de remover todas as linhas que sejam zeros o que  
% pode dar conflitos no caso em que haja 0 de nenovável às 0 horas. Para  
% superar este problema, quando for falso atribui-se "99999999" e  
% posteriormente remove-se todos os 999999. 
  



 78 

14 Anexo G - Plots.m 

 
% Gráficos 
%-------------------------------------------------------------------------- 
subplot(5,1,1) %Original vs Final 
    grid on 
     
    plot(excesso(:,1),excesso(:,2),'LineWidth',2); %Excesso final 
     
    LV2 = line([h h],[-500 200]); %Linha vertical hora atual hipotética 
    LV2.Color = 'blue'; 
    LV2.LineStyle = '--'; 
         
    LV1 = line([0 48],[0 0]); %Linha horizontal y = 0 
    LV1.Color = 'black'; 
     
    str=sprintf('Diagrama de Excesso de Renovável nos dias %d e %d de 
fevereiro de 2017',dia1,dia2); 
    title(str,'fontweight','bold','fontsize',14) 
    legend('Excesso Inicial','Excesso Final','Hora atual') 
    ylabel('kW','fontweight','bold') 
    xlabel('Horas','fontweight','bold'); 
    xlim([0 48]) 
    ylim([-600 200]) 
    set(gca,'XTick',0:2:48); 
    xticklabels({0 2 4 6 8 10 12 14 16 18 20 22 24 2 4 6 8 10 12 14 16 18 20 
22 24}) 
  
%-------------------------------------------------------------------------
-     
     
subplot(5,1,2) %Intermédio, é feito dentro do ciclo e atualizada para cada 
veiculo 
    grid on 
     
    plot(excesso(:,1),excesso_original,'b','LineWidth',3); %Excesso original 
     
    LV3 = line([0 48],[0 0]); %Linha horizontal y = 0 
    LV3.Color = 'black'; 
     
    title('Processos Iterativos','fontweight','bold','fontsize',14) 
    legend('Excesso Inicial','Hora atual','Iterações','Location','southeast') 
    ylabel('kW','fontweight','bold') 
    xlabel('Horas','fontweight','bold'); 
    xlim([0 48]) 
    ylim([-600 200]) 
    set(gca,'XTick',0:2:48); 
    xticklabels({0 2 4 6 8 10 12 14 16 18 20 22 24 2 4 6 8 10 12 14 16 18 20 
22 24}) 
     
%-------------------------------------------------------------------------- 
     
subplot(5,1,3) %Custo da Energia 
    grid on 
     
    LV5 = line([0 48],[0 0]); %Linha horizontal y = 0 
    LV5.Color = 'black'; 
     
    LV6 = line([h h],[-600 250]); %Linha vertical hora atual hipotética 
    LV6.Color = 'blue'; 
    LV6.LineStyle = '--'; 
     



 79 

    str=sprintf('Preços da Energia a %d e %d de fevereiro de 
2017',dia1,dia2); 
    title(str,'fontweight','bold','fontsize',14)    
    legend('Custo da energia (MIBEL x Fator) (E/kWh)','Custo Energia (Bi-
Horário + IVA) (E/kWh)','Hora atual','Location','southeast') 
    %legend('Custo Energia (Bi-Horário + IVA) (E/kWh)','Hora 
atual','Location','southeast') 
    ylabel('E/MWh','fontweight','bold') 
    xlabel('Horas','fontweight','bold'); 
    xlim([0 48]) 
    set(gca,'XTick',0:2:48); 
    ylim([0 .3]) 
    xticklabels({0 2 4 6 8 10 12 14 16 18 20 22 24 2 4 6 8 10 12 14 16 18 20 
22 24}) 
  
%-------------------------------------------------------------------------- 
  
subplot(5,1,4) %Balanço indo pelo excesso de energia 
    grid on 
     
    LV3 = line([0 48],[0 0]); %Linha horizontal y = 0 
    LV3.Color = 'black'; 
     
    plot(excesso(:,1),excesso_original,'b','LineWidth',3); %Excesso original 
          
    str=sprintf('Balanço renovável em função do preço da energia a %d e %d de 
fevereiro de 2017',dia1,dia2); 
    legend('Excesso Inicial','Hora atual','Iterações') 
    title(str,'fontweight','bold','fontsize',14)    
    ylabel('kW','fontweight','bold') 
    xlabel('Horas','fontweight','bold'); 
    xlim([0 48]) 
    set(gca,'XTick',0:2:48); 
    ylim([-600 200]) 
    xticklabels({0 2 4 6 8 10 12 14 16 18 20 22 24 2 4 6 8 10 12 14 16 18 20 
22 24}) 
     
%-------------------------------------------------------------------------- 
  
subplot(5,1,5) %Balanço indo pelo excesso de energia 
    grid on 
     
    LV3 = line([0 48],[0 0]); %Linha horizontal y = 0 
    LV3.Color = 'black'; 
              
    sprintf('Diagrama utilizando um carregamento não inteligente'); 
    legend('Excesso Inicial','Hora atual','Iterações') 
  
    title(str,'fontweight','bold','fontsize',14)    
    ylabel('kW','fontweight','bold') 
    xlabel('Horas','fontweight','bold'); 
    xlim([0 48]) 
    set(gca,'XTick',0:2:48); 
    ylim([-600 200]) 
    xticklabels({0 2 4 6 8 10 12 14 16 18 20 22 24 2 4 6 8 10 12 14 16 18 20 
22 24}) 
     
%-------------------------------------------------------------------------- 
 

 

 

 

  



 80 

15 Anexo H – PlotsComparativos.m 

figure 
    subplot(2,1,1) 
        hold on 
        grid on 
         
        plot(x,consumo9_10/r,'LineWidth',2) 
        plot(x,carregamentointeligente9_10,'LineWidth',2) 
         
        str=sprintf('Diagrama de carga dos dias 9 e 10 de agosto de 2016\n 
Carregamento Inteligente'); 
        title(str,'fontweight','bold','fontsize',14) 
        legend('Diagrama Inicial','Diagrama Final') 
        ylabel('kW','fontweight','bold') 
        xlabel('Horas','fontweight','bold'); 
        xlim([0 48]) 
        ylim([450 850]) 
        set(gca,'XTick',0:2:48); 
        xticklabels({0 2 4 6 8 10 12 14 16 18 20 22 24 2 4 6 8 10 12 14 16 18 
20 22 24}) 
         
    subplot(2,1,2) 
        hold on 
        grid on 
         
        plot(x,consumo9_10/r,'LineWidth',2) 
        plot(x,carregamentonaointeligente9_10,'LineWidth',2) 
         
        str=sprintf('Diagrama de carga dos dias 9 e 10 de agosto de 2016\n 
Carregamento Não Inteligente'); 
        title(str,'fontweight','bold','fontsize',14) 
        legend('Diagrama Inicial','Diagrama Final') 
        ylabel('kW','fontweight','bold') 
        xlabel('Horas','fontweight','bold'); 
        xlim([0 48]) 
        ylim([450 850]) 
        set(gca,'XTick',0:2:48);  
        xticklabels({0 2 4 6 8 10 12 14 16 18 20 22 24 2 4 6 8 10 12 14 16 18 
20 22 24}) 
  
%-------------------------------------------------------------------------- 
         
figure 
    subplot(2,1,1) 
        hold on 
        grid on 
         
        plot(x,consumo2_3/r,'LineWidth',2) 
        plot(x,carregamentointeligente2_3,'LineWidth',2) 
         
        str=sprintf('Diagrama de carga dos dias 2 e 3 de fevereiro de 2017\n 
Carregamento Inteligente'); 
        title(str,'fontweight','bold','fontsize',14) 
        legend('Diagrama Inicial','Diagrama Final') 
        ylabel('kW','fontweight','bold') 
        xlabel('Horas','fontweight','bold'); 
        xlim([0 48]) 
        ylim([450 950]) 
        set(gca,'XTick',0:2:48); 
        xticklabels({0 2 4 6 8 10 12 14 16 18 20 22 24 2 4 6 8 10 12 14 16 18 
20 22 24}) 
         
    subplot(2,1,2) 



 81 

        hold on 
        grid on 
         
        plot(x,consumo2_3/r,'LineWidth',2) 
        plot(x,carregamentonaointeligente2_3,'LineWidth',2) 
         
        str=sprintf('Diagrama de carga dos dias 2 e 3 de fevereiro de 2017\n 
Carregamento Não Inteligente'); 
        title(str,'fontweight','bold','fontsize',14) 
        legend('Diagrama Inicial','Diagrama Final') 
        ylabel('kW','fontweight','bold') 
        xlabel('Horas','fontweight','bold'); 
        xlim([0 48]) 
        ylim([450 950]) 
        set(gca,'XTick',0:2:48);  
        xticklabels({0 2 4 6 8 10 12 14 16 18 20 22 24 2 4 6 8 10 12 14 16 18 
20 22 24}) 
 

  



 82 

16 Anexo H – Lista VE final 

 
Coluna 1 - Número de entrada do Veículo 
Coluna 2 - Hora de chegada do veículo (horas) 
Coluna 3 - Capacidade da bateria (kWh) 
Coluna 4 - SOC pretendido (%) 
Coluna 5 - SOC atual (%) 
Coluna 6 - Potência do carregador (kW) 
Coluna 7 - Hora prevista de saída (horas) 
Coluna 8 - Tempo de carregamento (horas) 
Coluna 9 - Número de períodos necessários (arredondado por excesso)  
Coluna 10 - Custo de carregamento indo pelo excesso de renovável (em 
Euros) 
Coluna 11 - Custo de carregamento indo pelo custo de energia (em 
Euros) 
Coluna 12 - Custo de carregamento indo por carregamento normal (Euros) 


</field>
	</doc>
</add>