<?xml version="1.0" encoding="utf-8"?>
<add>
	<doc>
		<field name="docid">BR-TU.07581</field>
		<field name="filename">12300_Schiozer_DenisJose_M.pdf</field>
		<field name="filetype">PDF</field>
		<field name="text">UNIVERSIDADE ESTADUAL DE CAMPINAS
FACULDADE DE ENGENHARIA DE CAMPINAS
DEPARTAMENTO DE ENGENHARIA DE PETRÓLEO
Dissertação Apresentada a
Faculdade de Engenharia de Campinas
Como Requisito Parcial à Obtenção do
Título de Mestre em Engenharia de Petróleo
ESTUDO DE UM MODELO COMPOST ClONAL
PARA SIMULAÇXO DE RESERVATÓRIOS

íW-Gc
C6/&lt;SA

lt


Autor
Deni s José
Schiozer
Orientador
: Antônio Cláudio de França Corróa
Junho de 1QS9
UNIVERSIDADE ESTADUAL DE CAMPINAS
FACULDADE DE ENGENHARIA
►
DEPARTAMENTO DE ENGENHARIA DE PETROLEO
A dissertação "Estudo de um modelo Composicional para Simulação de Reservatórios", elaborada por Denis José Schiozer e aprovada por todos os membros da Banca Examinadora foi aceita pela Sub-Comissão de Pós-Graduação em Engenharia de Petróleo como requisito parcial a obtenção do Título de Mestre em Engenharia de Petróleo.
Campinas»28 de Junho de 1989.
Banca Exami nador a
Antóni
AGRADECIMENTOS
Aos funcionários e professores do CEPETRO e da UNICAMP e aos colegas de curso, por tornarem esta tarefa mais fácil e agradável.

INDI CE
Pági na
Abstract...................................................... x
13	Introdução................................................... 1
l
1.1-	A escolha	do modelo...................................... 3
1.2-	O modelo. ............................................... 4
23	Modelo Matemático............................................ 6
2.1-	EquaçBes	do	Escoamento.................................. 6
2.2-	EquaçSes	de	Equilíbrio.................................. Ô
2.3-	EquaçSes	Adicionais.................................... 10
33 Di scr et i z aç ão.......................................... 11
3.1-	Grade.................................................. 11
3.2-	Equações............................................... 12
43 Método de Solução............................................ 15
4.1-	Fluxograma.............................................. 18
4.2-	Equação de Pressão.........................  .	. ...... lâ
4.	3— Equações das	Composições............................... 26
4.	4- Equações das	Saturações................................ 27
3.1-	Equilíbrio Líquido-Vapor............................... 29
3. 2- EquaçSes de Estado..........................F......... 32
5.3-	O "Flash".............................................. 35
65	Tópicos especiais.......................................... 39
6.1-	Permeabilidade Relativa................................ 39
6.2—	Modelo de Poço......................................... 41
6.3—	Balanço de Materiais................................... 44
6. 4- Critério de Convergência.............................. 45
6.5-	Modelo Radial.......................................... 46
6.6-	ResoluçSo do Sistema................................... 49
6.7-	Controle do Intervalo de Tempo......................... 50
6.8-	Modelo de Helfferich................................... 51
73 Resul tados................................................. 53
7.1-	Caso 1 - Modelo Unidimensional - InjeçSo de Gás........ 54
7.2-	Caso 2 - Condensação Retrógrada........................ 63
7.3-	Caso 3 - Modelo de Helfferioh.......................... 68
7.4-	Caso 4 - Modelo Radial................................. 75
7.5-	' Caso 5 - ValidaçSo do Modelo......................... 76
85 Concl uscSes................................................ 80
ANEXOS
►
BD Tabela de Conversão de Unidades para o SI .................... 88
O Listagem do Programa........................................... 89
A
DD Exemplo Entrada de Dados..................................... 113
Referências Bibliográficas................................... 115
LISTA DE FIGURAS
►
Pági na
Figura 4.2	: Sistema de Resolução da Equação da Pressão......	21
Figura 7.1.1 : Distribuição das ComposiçSes no Tempo
Comparação do Modelo CNFA3 com o “C0MP3"........ 56
Figura 7.1.2 : Distribuição das ComposiçSes nos Blocos
Comparação do Modelo CNFA3 com o "COMP3*'....... 57
Fi gur a 7.1.3 : Di str i bui ção das Composi ç8es nos BI ocos
Comparação do Modelo CNFA3 com o "COMP3"
sem a Limitação da Equação C3. 103.............. 5S
Figura 7.1.4 : Composição do Butano
Efeitos da Limitação da Equação C3. 103......... 5Õ
Figura 7.1.5 : Composição do Butano
Efeitos da Variação do Número de Blocos......... 60
Figura 7.1.6 : Saturação de Óleo
Comparação do Modelo CNFA3 com o “COMP3"........ 61
Figura 7.2.1 : Saturação de õleo - Condensação Retrógrada
Efeitos da Variação do Intervalo de Tempo....... 65
Figura 7.2.2 ; Envelope de Fases para CMetano: 0.650653,
C Butano: 0. 325513 e CDecano: O. 023843........ 66
Figura 7.2.3 : Envelope de Fases para CMetano: 0.691893,
CButano: 0.303043 e CDecano: 0.005073........... 67
Figura 7.3.1 : Saturação de õleo - Modelo de Helfferich
Efeitos da Variação do número de blocos......... 71
Efeitos da Variação da Formulação das ComposiçSes......................i................ 72
Figura 7.3.3 : Composição do Fluido Injetado — Modelo de Helfferich. Efeitos da Variação do número de blocos........................................................ 73
Figura 7.3.4 : Composição do Fluido Injetado - Modelo de Helfferich. Efeitos da Variação da Formulação das ComposiçSes....................................... 74
*
RESUMO
Este tipo de modelo é usado na simuiaç2o do comportamento de reservatórios de gás condensado e óleo volátil» na injeção de gás e CO^ e em estudos de deslocamentos miscíveis. A sua aplicação pode ser estendida para alguns problemas do tipo "black-oilAs equaçSes são resolvidas por um método iterativo e sequencial, através do balanço de moles dos hidrocarbonetos e da água, com base em um modelo de Nghiem. L.X. »Fong, D. K. e Aziz, K. .
O equilíbrio e as propriedades das fases são estimadas por um "flash” usando uma equação de estado que pode ser tanto a de Peng- Robinson como a de Soave-Redlich-Kwong, dentre outras. Um cálculo "flash" eficiente permite o uso do modelo na região crítica.
O modelo foi testado para vários casos e alguns deles são apresentados e discutidos.
Devi do à si mpli ci dade, tempo computaci onal e desempenho, este trabalho pode ser um primeiro passo para o desenvolvimento de um "General Purpose Reservoir Simulator".
ABSTRACT
This type of model is required in the simulation of the behavi or of gas condensate and volati1e oil reservoi r s, in enhanced oi1 recovery reservoirs by CO^ or enriched gas injection and in miscible displacement. It can be used also for some bl ack-oi1 problems.
The equations are based on the mol ar bal ance of the hydrocarbon components and water, and they are solved using an iterative-sequential method, based on a model by Nghiem, L. X. , Fong, D.K. , and Aziz, K. .
The composi ti onal phase equi1i brium and phase behavi or properties are estimated by a equilibrium flash calculation using an equation of state Cei ther Peng-Robi nson or Soave-Redli ch-Kwong?. An efficient flash-calculation permits the use of the model around the critical point.
The model has been tested agai nst some condi ti ons whi ch ar e presented and discussed.
Thi s model, due to the si mpli city to program, run-ti me and performance, can be useful1 as a first step for the development of a General Purpose Reservoir Simulator
►
1 - INTRODUÇSO
Um modelo de simulação de reservatórios pode ser definido como um gr upo de equaçSes de balanço de materi ai s a ser r esolvi do nuiner i camente, geral mente por di fer enças finitas.
Recentemente, com o surgi mento de diferentes métodos de
r ecuper ação de ól eo e
gás, o número de modelos de simulação de
reserva t ór i os
cresceu
bastante. Os
aplicados
na
injeção
de vapor ou
em processos de combustão
"in-situ"
em
reser vatór i os de 61eo
pesado. Os modelos quí mi cos
incluem a
injeção de produtos químicos tais como polímeros e soda
cáustica.
são usados para simular reservatórios naturalmente fraturados. Estes;, porém, não pertencem ao alvo de discussSes deste trabalho.
Os modelos do tipo "black-oil" são isotérmicos e podem ser usados em estudos de recuperação convencionais de hidrocarbonetos
em reservatórios contendo água, óleo e gás. O balanço de massas é feito com base nestas trés fases e as propriedades dos fluidos dependem apenas da pressão atuante e da pressão de saturação do si stema de hi drocarbonetos. Este ti po de modelo supSe ai nda composiçóes de óleo e gás constantes e não considera a solubilidade do 61eo no gás, isto é, a volati1idade do 61eo.
Na década de 70» com a elevação acentuada do preço do petróleo» cresceu a i mportânci a dos métodos especi ai s de recuperação. A necessidade de se aumentar a produção doméstica de ól eo fez com que poços mai s pr ofundos fossem per furados, aumentando a freqüéncia de reservatórios de óleo vol áti 1 e gás condensado.
Dentro deste contexto» surgiu a necessidade de desenvolvi mento de si stemas mai s complexos capazes de si mui ar a produção de óleo sob condiçSes em que os modelos "black-oil" são i neficientes.
Ganharam ênfase os model os "blact-oi 1" modi fi cados e os composicionais. Os primeiros são model os um pouco mai s sofisticados que os "black-oil" convencionais» com algumas alteraçSes como» por exemplo, mútua solubilidade entre as fases. Os modelos composicionais são utilizados quando o comportamento do r eser vatór i o é af etado pel a var i ação das pr opri edades PVT com a composição dos hidrocarbonetos.
O sucesso de alguns modelos composicionais, aliado á rápida evolução dos computadores, faz com que as pesquisas se voltem para o desenvolvimento de um simulador capaz de englobar todos ou a maioria dos casos anteriores C"General Purpose Reservoir Si mui ator"D.
A idéia deste trabalho nasceu da possibilidade de se estudar um modelo composi ci onal si mples, que pudesse ser usado também para problemas do tipo "black-oil". Este é o primeiro passo para o desenvolvimento de um "General Purpose Reservoir Si mui ator".
1.1	- A ESCOLHA DO MODELO
►
O estudo dos efeitos de mudanças de composição na simulação de reservatórios começou com a introdução do equi1i brio líquido-vapor CELVD nos modelos computacionais. Todas as tentativas» entretanto, apresentavam problemas de convergência na região critica.
t
Este problema começou a ser superado por Fussel1 e Fussel1 EFF791, com a introdução de uma equação de estado cúbica CEOSD na determinação do equilíbrio líquido-vapor.
Desde então, outros modelos utilizando equaçÊSes de estado foram apresentados. A referência £ TLS833 mostra uma comparação entre três modelos: o modelo total mente implícito de Coats [CoaSO], o de Nghiem, Fong e Aziz ENFA813 e o de Young e Stephenson EYS831. A referência EWonSS] apresenta também algumas outras for muiaçSes e compar açSes.
De acordo com os resultados apresentados nestas referências, o modelo ENFA811 foi escolhido como base na f or mülação do pr esente tr abaiho, pelos result ados apr esentados,
pelo menor	tempo	de desenvolvi mento	do	pr ogr ama,	pel a mai or	
si mpli ci dade	de construção do modelo		e	pelo menor	tempo	de
computação	quando	se	tr abal ha	com	um	pequeno	número	de
componentes.
A viabilização do estudo dos problemas do tipo "black-oi 1“ seria conseguida pela redução do número de componentes. Com apenas doi s componentes, o tempo de computação di mi nui bastante e a solubilidade entre as fases é feita naturalmente pelo cálculo do
A escol ha dos componentes para cada caso deve ser feita a partir de dados experimentais de propriedades PVT.
1.2-0 MODELO
O model o computad onal a ser estudado é do ti po composici onal, com cálculo implí cito da pressão e explici to das saturações e composições.
O equilíbrio de fases é calculado por um "flash" através de uma equação de estado , que pode ser a de Peng-Robi nson ou a de Soave-Rediich-Kwong.
A formulação da equação da pressão leva a uma matriz simétrica e diagonalmente dominante, o que é uma característica i mportante para a estábilidade numérica do modelo, e permi te a uti1i zação de métodos de eli mi nação di reta par a a solução do sistema de equações.
As equações são resolvidas através de um método iterativo sequencial, conforme o fluxograma apresentado no item C4.1}.
O modelo tem por base ainda as seguintes características:
-	fluxo isotérmico,
-	escoamento trifásico Cóleo,gás e água},
-	bidimensional CX e Y},
-	muiti componente,
-	poços de injeção ou produção em qualquer bloco,
-	gravidade e pressão capilar desprezadas,
-	meio homogêneo e isotrópico,
-	blocos uniformes em cada direção,
-	escoamento regido pela 1 ei de Darcy,
-	produção à vazão ou pressão constante e,
-	reser vaLór i o fechado C sem f1uxo externoD.
2 - MODELO MATEMATICO

2.1-	EQUAÇÕES DO ESCOAMENTO
As equações do escoamento serSo escritas com base no pri ncipio da conservação de massa e na 1ei de Darcy.
1
• Conservação de massa para fluxo monofásico em uma direção
A equação do escoamento para este caso é:
C2. 12&gt;
onde, p
0
u
X
«V
q
---&gt; densi dade molar »
---* por osi dade»
---► veloci dade aparente e
---&gt; vazão molar por unidade de volume.
• Fluxo Multidimensional
A equação C2.pode ser generalizada para mais de uma
dimensão» resultando:
+ q
C2. 2?
• Fluxo Mui tifásico
pode ser escrita como:

onde» L
SL
- *•(?&amp;amp;) + SJ
■+ Indice indicador da fase
+ saturação da fase L
Lei de Darcy
A lei de Darcy, modificada para
fornece uma relação entre
a veloci dade de
Coléa, gás
escoamento
escoamento
e o gradiente de pressão
para
expressa da
forma,
k

k'l(
onde,
k
permeabi1i dade
i
k , r l
♦
per meabi1i dade
a lei
C2. 33
ou água3

muí bifásico.
aparente, u^,
cada fase. Esta relação pode ser
vPl- ]
absoluta»
reiativa
a fase CL3 e,
C2. 43
Pl

pressão atuante na fase
Definindo-se o potencial de fluxo
= 7Pl “	•
de Darcy pode ser expressa por:
CD.
através de
C2. 53
k k

* EquaçHes de fluxo para as fases
A fim de se produzi r as equaçSes de escoamento par a cada
fase, a equaçSo C2.63 pode ser substituída na C2.33 resultando em:
V- —+ 5t = -Éj-	Sj .
ou
V*	+ qL	&lt;?t	Sl) ’	ca. 83
onde a mobi1i dade da fase L é	definida por:	
k	k .	
X = 		r L 	 o. .	C2. 93
• EquaçSes de fluxo para os componentes
O modelo composiclonal tem por base o balanço de moles de cada componente do sistema de hidrocarbonetos. Com isto torna-se nec-ssário escrever também as equaçSes de fluxo para cada componente, as quals são:
•+	•+	â
7‘x Vy + X y ) + q = —-~r~ R z (p S + p S }1
v o m o	g m gy	m	&lt;Tt L m o o	g 9y J »
m = 1. . . p , C 2. 103
TH
x -------* fraçSo molar do componente Cm5 na fase líquida»
m	'
y -------» fraçSo molar do componente Creó na fase gasosa e,
m

número de componentes.
2.	2 - EQUAÇÕES DE EQUILIBRIO
i
A condição de equilíbrio termodinâmico exige igualdade de fugacidades ñas fases óleo e gás para cada componente:
f = f »	m = 1.-v .	C2.115
mo	mg
Aínda como equaçGes de equilíbrio» estão aquelas obtidas do
balanço de materiais das fases óleo e gâs» ou seja»
	z = L x + V y , rn	m	m	C2. 125
	P s I	-	°	°	C2. 135
	u	p S + p S ’ ° O	9 Sí	
e	p s V -	3 9	C2.145
	p S + p S ’ o o	g g	
onde» L		» fraçSo molar do líquido»	
V		► fração molar do g&amp;amp;s.	
2.3 - EQUAÇÕES ADICIONAIS
definições de fração molar e saturação fornecem as seguintes
rei ações:
S + S + S = 1 , o g w
k
C2. 153
	L + V		= 1 &gt;	C2. 163
e				
	p	1?	V	
	£ z m	= m	= £y =1 “ m	C2.173
	m=l	m=l	m=l	
Deste modo, obtem-se um sistema com n,C3v+63 equações e
D
n C 3l&gt;+63 i ncógni tas ► or i gi nadas pel a dl scr eti zaçSo das equações O
diferenciais.
As incógnitas são: a pressão atuante no sistema Cp. 3, as
saturações CS .S . e S . 3 , as frações molares totais no óleo CL 3 oi gi vi	L
e no gás CVp e as frações molares dos componentes na mistura
Cz .3, no óleo Cx .3 e no gás Cy .3. O índice Cí3 refere-se ao mi	mt	mt
bloco e varia de Cl 3 a Cn 3 e o índice Cm3 refere-se ao O
componente, variando de C13 a Cw3.	’&gt;	.
As equações fi nais a serem utilixadas pelo si stema são: a
C2.83, a C2.103, a C2.113 e da CS. 133 a C2.173.

3	- DISCRETIZAÇÀO
i
3.1-	GRADE
O primeiro passo para a discretização ó a definição das características do modelo, que são:
—	bloco centrado,
—	duas di mensSes C x e yD,
—	'"upstream mobility",
—	"2-point upstream" para fraçdes molares,
—	malha de 5 pontos e,
—	grade uniforme em cada direção.

Deste modo,
as equaçBes dos componentes C2.1OD podem ser
escritas pera as direçSes x e y :
d ¿hc
a âx
+
a
+
Do mesmo
modo,
as
equaçSes C2.85 »
para
►
cada fase
ficam:
d f,	d	1	d	r	0 d		d	
dx p	nj +	&amp;amp;y	s	dy J	+ ql=	dt	pl* sl
ca, a?
k
3.2	- EQUAÇÕES
Uti1 i zando-se
um
esquema de
diferenças
finí tas com 5
pontos, a equaçSo C3.25 pode ser discretizada por:
Ax. I U l+£/2
L L
n+ 1	n+ 1
Ax,
t + 1/2
n
V-l/2
n+ 1
n+ i

Ax
1-1/2
n+ £
1 Ay.
(\)n
Vj+£Z2
n+ 1
Ay.
j + l/2
n+ £	n+ £
+ qn
qUj
íc[(* asiF*
(\W
Ay.
JJ-l/2
£♦ pisJ"l
Jij
C3. 35
. j 
+
onde» q^ =	■- qt - Vb ,
Vb		r volunte do bloco CAx*AyAz5 e.
(1		► indica o intervalo de tempo.
Definindo-se a transmissivídade por:
\ A V -¿Sr- ►
C3. 45

onde, A é a área transversal aberta ao fluxo, e
mui ti pliçando a
equação C3.35 pelo volume do bloco, V^, obtem-se:
f n+1
\ W^i
L+l/Z
n+1-	-	n+1
n+1
n t i
Wi-t. J +
r n+1
+I?. (Wu«
J+1/2 *■
&gt;-	n+i
WuJ ’
n+1	-
Wi.j-J +
k
+ W- .5 ■ -£[(*	- (*
Na forma simplificada, a equação C3.55 fica :
a^1^ = -£[(&gt; p1sl)”’* - &amp;amp;
A discretização par a as equaçSes de cada componente,
eq.C3,15, pode também ser expressa desta forma, ou seja.
1
. R—n n. n+1 „	—n n. n+1 J , _n
A T x Aui + T y Aw f + q
I o m o	gmg J	m
Vb L1
Ãt^
n+1 n+1 » Z
m
S
- o
+ P s )n+1
3
- /znfp S + P s )n m V o o	g g-7	L,	C3. 75
As transmissividade CT , T e °	g	T 5 V	entre os blocos são
calculadas a partir das propri edades no bloco de maior
As compos!ç3es Cx &amp;amp; y 3 também poderiam ser calculadas m	m
desta forma, mas segundo a referência ENFA811, ipto pode causar
dlspersSo numérica excessiva. Para diminuir a dispersSo numérica o
cálculo é f ei to levando-se em conta os doi s blocos no senti do do
maior potencial C"two-point upstream"}.
For exemplo, se p. &gt;p.
i ~ 1 i
tem—se:
onde CO é um bloco da grade,
m. -t-i/2
AL + Al.
L-1	v - 2
*
C3. 83
Como
os blocos são uniformes
tem-se queAU
At.
L - 1
e
portanto:
O w. &gt;
C3. 93
SSo ai nda i mpostas as 1i mi taçSes,
C3.103
para minimizar problemas de "overshoot" e "undershoot".
As considerações apresentadas nas equaçSes C3. 93
e C3.103
valem também para y
m
4	- MÉTODO DE SOLUÇÃO
O método é baseado no tratamento i mpl1ci to das pressões , ficando as saturações e as composi ç3es com um tratamento
* explícito. Deste modo, as transmissividades sSo calculadas no intervalo de tempo anteriores Cn3, e as equaçBes de balanço de massa ficam:
• água
n+4
C4.13
* componentes hidrocarbonetos
* r_n n * n+1 , _n n. n+11 . n ATx Ay + T y Ay	+ q
loTn o	gm gj	m
(p.3.+
(* zJposo+
C4. 23
Somando-se as equaçSes Cd.23, tem-se
a equação de balanço
de massa para o sistema de hidrocarbonetos:

m
1. .


_nA n+11 . n Vb
J + S, = -Al

onde.
v
qh = E q.
1
C4. 43
Para o caso particular de pressão capilar e efei tos
gravi tacionais desprezíveis,
Ay* = Au* = Au* = Ap o	g	w
»
C4. 33
Portanto,
as equaçSes C4.13 a C4.33
podem ser simplificadas
para:
C4. 63
-	[* ^oSo + p9s9)]n]tj
C4. 73
-
C4, 83
O método de solução pode ser melhor. . entendido através do
por meio do seguinte processo iterativo:

Passo 1			»	Combinar equaçBes C4.63 a C4. 83 para	formar	a
			equação da pressão, item C4.23.		
Passo	a -		►	Resolver a equação da pressão obtendo pL+1.		
Passo	3	-		1, + i Resolver equação C4.63 obtendo S		
Passo	4		t	Resolver equação de composição obtendo	t + i z m	
Passo			Fazer um flash obtendo xí + 1	» yt + 1 m	m	vl + l	
					
			,1+1	l+l	l+i L	» p	e p o	g	sL + 1 O	
Passo	6 -		1	Resolver equaçBes de saturação, obtendo		e
		SL + 1 9			
Passo	7	-		-t	Testar convergência.		
			*	Se não houver convergência, voltar ao	passo	2
f azendo C l=L+±J »
----»- Se houver convergência, passar para o próximo
intervalo de tempo Cn=n+13.
Observar que o índice ClD é usado para indicar o número da itei ação e Cn3 para indicar o intervalo de tempo. Na primeira iteração Cl=i3» os valores das variáveis são iguais aos do i n ter valo de tempo anterior Cn5. Quando a convergência for ati ngi da» as var i ávei s do i nt er vaio de tempo C n+13 assumem os
valeros que possuíam na iteração Cl+O.
4. 1
FLUXOGRAMA
Figura 4. 1 : Fluxograma.
4.2	- EQUAÇXO DA PRESSXO
í
A equação da pressSo ê obtida multiplicando-se a equação
C4.63 por um parâmetro constante CÔ3 e somando-se com a equação
C4.83. Tem-se então:
103
Este fator pode ser
em t-0 pela expressão:
calculado
113
í Segundo a referência [NFA81]* para os casos práticos de densidades molares, o valor de &amp;amp; fica entre 0*1 e 0,2.
® Solução da equação da pressão
A equação da pressão C4.93 é válida para os Cn 3 blocos da Q
grade. Deste modo* a resolução desta equação está baseada num sistema de Cn 3 equaçSes e Cn 3 incógnitas.
o	O
A di screti zação fei ta no 1 tem C 33 determi na que a equação
O processo iterativo utilizado foi o método de Newton» que determina o sistema:
t
C4. 120
i = 1. .. nb .
onde» J f11		&gt;	elementos do Jacobiano.			
t k					4
F( l) í		*	lado	esquerdo da equaçáo	de pressão	C4. 90.
A pressão		na	iteração&amp;lt;1+d	é	obtida a	partir das
propriedades na iteração CO , sendo a primeira iteração baseada no intervalo de tempo anterior Cn).
Jfl	_T1 2		J	1		' ÓP,		-F '
			l.ny+l		±		1
J21	J22	J23	-		ÔP2		-F 2
	J32	J33	J34	-		óp3		-F 3
		•	J n-ny,nb		•		-
J				0			
ny,i							
		J	J	,	J t t		&lt;5p		-F L
		nb, nb — ny	r&gt;b,nb-1	nb,nb		nb		rib
Figura CA. 22)
Sistema para Resolução da Equação da Pressão
onde» i.
---t bloco Cí=l..ri 2&gt;,
O
n X		► numero	de	blocos	na	direção	x,
n y		* número	de	blocos	na	di r eção	y»
nb		► número	de	blocos	totais	Cn. = nx*ny3 e b		
	1*1	1					
óp	= p	- p .					

►
&lt;b
indica a
interface entre os blocos Ci} e
Ck}.
No caso deste trabalho as transmi ssi vi dades
CT&gt; são
calculadas no bloco de maior pressão C"upstream mobility"}.
I
O último termo da equação C4.14} pode ser expandido para:
*
õCcpcD
~&amp;amp;P
d&lt;^	da
* 3?
C4. 15?
ou ainda»

= cr
dp
&lt;9al
dpj
C4. 16}
onde a compressibilidade
da rocha ê definida por:
c
r
1 4&gt;
dp
C4. 17}
O termo
é tratado
de forma diferente nas
referências
[NFA811, lManSl3 e
C NghSl], a
saber:
• ENFA813
Despreza as derivadas das saturaçSes e composiçGes
em relação à pressão ficando:
C4. 18}
onde,
p -------» densidade molar da água à pressão de referência,
d -------► compressl bil idade da água defini da por ,
203
213

• [ManSlJ ----»■ Segundo Mansoori, existem certas condiçSes de fluxo '
no reservatório em que as deri vadas das saturaçSes em reiação a pressão não podem ser desprezadas. Deste modo, a utilização da equação C4.183 pode resultar em divergência* oscilação ou convergência lenta do método de Newton C4.12D.
Uma nova formulação foi apresentada para eliminar estes pr oblemas:
ÕCL âp
ô s
w
C4. 233
Combinando-se as equaçSes C2. 133 e C2. 143
pode—se obter:
V Po í1 - S J
Pg + V(Po" Ps)
►
Pode-se escrever» &amp;amp;ntSío:
V Pp í1 - SJ Pg + V(po‘ Pg)
C4. 253
Derivando-se a equaçSo C4. 253
em relação a
pressão»
resulta:
fc(PoSo + PgSJ = C1 - SJ
C4. 263
&lt;*[ p
U 9
+
OU
fe(poS» * Pg£j = C1 - SJ •
onde» p*
C4.273
Õpo dp
V’ =
V ” V
p_______&amp;lt;p-*-&lt;5p &gt;
&lt;5p
C4. 283
* [NghSl1
+ Segundo
casos
pode ser resol vi do
por um fator de amortecimento Cw3
i
l + i	1	.	1	= 1
pk = pk + w apk
C4. 293
onde,
+ variaçSo de pressSo obtida
pela equaçSo
C4.123 e
&amp;lt;L &gt; w
+ fator de amortecimentos
C0&lt;wl&lt;13.
Nghiem ressalta aínda que o método
de Manssori
requer um
flash
adicional para cada bloco em cada iteraçSo, aumentando o
tempo
computaci onal.
Deve-se
levar em consideraçSo» porém» que o fator de
amor teci mento
pode aumentar o número de iteraçBes» aumentando
também o tempo
computacional.
Neste trabalho» o método utilizado foi o de Mansoori e o
"flash" adicional foi utilizado também para calcular p 1
O
P
numericamente» assim como foi feito para V* CequaçSo 4.283.
A discussSo deste problema está no, item C83.
Numa análise das equaçSes C4.133 e C4. 143 permite concluir
que como C«9^otZ'dp3 é positivo e C &amp;amp;q Xdp3 e CAq^/^p3 sSo negativos
ou nulos» o Jacoblano é simétrico e diagonalmente dominante.
C6. 63.
4.3	- EQUAÇÕES DAS COMPOSIÇOES
As fraçSes expli ci tamente a equação C4.73.
molares na iteração Cl+±? »	z&lt;l+1&gt;í são obtidas
m
parti r das pressSes pC 1 + 11 uti 1 i zando-se a
Isol ando-se z L + 4 m
tem—se:
&amp;lt;l+i&gt; z m
{¿(u. * vJ"Apl"]
C4.303
, O denominador da equação anterior pode ser substituído por:
C4. 31?
componente flca entSo:
►
&amp;lt;l+n z m
=	+ vJ"Apltl]
q + tf 0nfp s + m Atr	[ q o
pS)\"L
g gj m j
* -[A[(T= + Tj"Apl’!] + %
S + p S o g ff.
C4. 323
+
+

n
4.4
i
- EQUAÇÕES DAS SATURAÇÕES
As saturaçSes na iteração d+u
são também
obti das
(3 primeiro passo é calcular P¿+±
e + 1 a partir das
equaçSes C4.173 e C4.1S3.
Após isto, a equaçSo
Sl+1, ’resultando:
w
—I +1	| . — n . L + 1
S = MT Àp + q + w	1 V
Vk	1 Pk
ÃT * p«Sv J * Ut *
L+i l + i]
p.)
C4. 333
Já para o cálculo das
saturaçSes de óleo
e gás ,
exi ste a
necessidade de obter +1	„
m
L + i	L + i	L + i
ym &gt; p&amp;amp; &gt;
m	o	g
I 4» 1 V x
Ll + i
Isto é feito por um "flash” conforme está explicado no
i tem C 53 .
Se o resultado do "flash" conduzir a vL + £ = ot
então,
e
C4. 353
Por outro lado, se
= 1
as saturaçSes se tornam:
„l +1	.	_1+1
S	=1	- S
9	V
C4. 363
e
O .
C4. 373
Caso 0&lt;VL+i&lt;l , as saturaçSes sSo calculadas a partir das
equaçSes C2.153, C2. 163 e C2.173, resultando:
	=	[ 0 - SJ L p9 1-	C4. 383
		[ L * v J '	
e			
	L = i -	1 - s		C4. 3Q3
9	V	o		
Depois de obtidas todas as propriedades na iteraçSSo Cl+ó, o processo segue para a próxima iteraçSo ou o próximo intervalo de tempo, conforme a convergência tenha sido obtida ou não. O critério de convergência está descrito no item C63.
5	- EQUILÍBRIO LIQUIDO-VAPOR - ‘‘FLASH"
Para o caso de um modelo totalmente implícito» estas equaçães são incorporadas ao si stema, como na referéncia £ Coa80] no modelo de Coats,
No caso de um modelo sequenclal, assim como qualquer outro modelo não totalmente implícito» o equilíbrio 1íquido-vapor ó resolvido separadamente, sendo chamado de liberação instantânea ou "flash".
O "flash" é parte fundamental do modelo e, principalmente na região crítica, ele deve ser eficiente para evitar oscilaçSes ou divergência.
O pri mei ro passo para evi tar estas osci1açSes na regí So crítica foi dado por “Fussell and Fussell" CFF79J , com a introdução de um modelo composicional com equação de estado cúbica.
3.1	- EQUILIBRIO LI QUIDO-VAPOR
O critério termodinâmico do equilíbrio líquido-vapor em um sistema de CiZ) componentes implica em se minimizar a energia livre de Oibbs, G, de acordo com as equaçSes:
dG
âu , ml
âG dN
m
1 . . . V
C5. 15
mv
►
onde, N ,
ml
N mv
N
m
número	de	mol es	do	componente	m na	fase	1íquida
número	de	moles	do	componente	m na	f ase	gasosa
número	de	moles	do	componente	m		
Como N + N = N
ml mv	m
pode ser mostrada que:
&lt;SG	âG	_ =
5N ,	dN	ml
ml	mv
- G mv
C5. 25
onde, G , mL		k ener gi a	1 i vre parei al mol ar	de	Gibbs	do
	componente	m na fase líquida,			
G		k ener gi a	livre	parcial molar	de	Gibbs	do
mv
componente m na fase gasosa.
A diferença G - G , para temperatura constante, pode ml	mv
ser relacionada com as fugacidades dos elementos como se segue:
f		
G - G - NRT In	, ml	mv	k	I mv	i. = 1 ... 1»,	CS.35
■~&gt;nde» f
mv
r
mL
---► fugacidade do elemento m na fase gasosa»
---» fugacidade do elemento m na fase líquida,
----k número de moles.
+ Temperatura.
—-—+ Constante Universal dos Gases
O conceito de fugacidade foi introduzido pois é uma medida
N
R
No equilíbrio termodinâmico, a transferência de massa entre as fases é nula, o que exige:
ou ai nda,
f mv	CS. 43
i - 0 .	CS. 53
■J	
Os coeficientes de fugacidade para cada fase podem ser
defi ni dos como:
PL = fL/p -
CS. 63
f&gt; = f /p
V	V
CS. 73
Para uma mistura de C v 3 componentes, a relaçSo pode ser estendida usando-se as fraçSes molares:
’’ml. = fmlZ(P	’
CS. 83
CS. 93
Das equaçSes CS.43, CS.83 e CS.93:
ou.
ou ainda,
onde, K m
Pnl P
P P mv
P mv
rn
P m
P~ mv
C5. 103
C5.113
C 5. 123
+ constante
de
equilíbrio
11qui do-vapor.
K m
X m
&gt;
»



A
5.	2 - EQUAÇÕES DE ESTADO
As equa^Ses de estado sSo usadas para cal cul ar as T'ugacidades dos elementos em cada fase. As equagSes de estado de melhor resultado e mais discutidas na literatura sSo as de Peng-Robinson e Soave-Redlich-Kwong, ambas modificagSes da equagSo de Van der Waals.
5.2.1	- PENG-ROBINSON CPR3
A relapso PVT assume a forma:
a
VCV + b3 + bCV - b3 ’
CS. 133
onde.
b = 0.07780
RT
1
p-c
C5. 143
^2„2 R T
aCT3	= O.45724	c —p	 a &gt;	C5. 153
ot°' 5	= 1 + mfl	- T°‘	,	C5. 163
		r J	
			
m = O.37464	+ 1.54226	to - 0. 26992 ü)2 ,	C5. 173
		N b°* 5 m thL m	
	&lt;JÒ		C5.183
		£ N b°- 7 ml m m	
		» fator	acêntrico da mistura,	
u m		&gt; fator	acéntrico do componente m,	
b m		► constante de equaçSo de estado CfunçSo		de T e P 3 c	e
e , N ----------► número de moles do componente m na fase l.
mL
Com a introduçSo do fátor de compressibil idade CZ=pv/RT3, a
segui nte equaçSo cúbi ca é obti da:
Za - Cl - B 3Z2 + CA - 3B2 - 2B3Z - CAB - B2 - B33 = O C5. 193
onde, A = —t—
2 2 R T
R = bP
B RT
b
a = £ £ x xa ,
, m l ml m l
a = (1 - 6 J a a	,
mt v	ml/ m	L
m	 &gt;	componente,
l ------»	fase,
&lt;5	 ►	coeficiente	de iteração binário e	*
ml
a , a , a --------» constantes da equação de estado, funçSes
ml	l	m
de p , T e w.
G	C
O coeficiente	de fugacidade p	, m	para	cada	fase, É	£ dado
por:					
ln = et(z - 9	- 1 n f7 - Pl -	pF	V 1 L ml	b 1 m	•
	(	5 arSB	1	a	b	
. ln|z +	+ 13B1
[z - ClTS - 13 Bj
5.2.2	- SOAVE-REDLICH-KWOMG CSRK3
Da mesma forma» pode-se escrever para SRK,
onde,
08664
42747
RT
fr
o.
íô - O. 176 oi2
C5. 22}
C5. 23}
C5. 16}
C5. 24}
+
1.
»
►
A equaçSo cúbica do fator de compressibilidade fica:
	Z3 - Z2 + CA - B - B2}Z		- AB = 0		C5. 25}
E o	coeficiente de fugacidade	é	dado por:		
b		I"2	E xia. .	1 Lm	b 1	•d1+D
ln	= ET	• CZ - 1} - ln CZ - Bl - 1		L	m	
			b	d	
CS. 26}
As constantes são as mesmas da equaçSo de CPR}.
5.3	- O "FLASH"
O cálculo do equilíbri o 1íquido-vapor tem como ~ objeti vo
principal, a determinação das fraçSes molares dos componentes e
Utilizando-se a defini^So da constante de equilibrio,
C5,123, as equatjSes C2. 123,	C2.163 e C2.173 podem ser combinadas
par a f or necer :
das fases.
	z	
		C5. 273
	m	1 + VCK - 13	
	m	*
e	z K	
	m m	C5. 283
	ym	1 + VCK - 13 m	
Da equa^So C2.213 pode-se escrever
gCV3
- ¿y,
m= 1
X m
C5.293
= O .
Das equa^Ses C5. 273 , C5. 283 e C5.293 vem:
C5. 303
Se F é a razSo de fugacidades, segue-se que : m
F
m
e, no equi11 br i o,
f rnv
F - 1
m
ou ainda»
0
C5. 325
	 fmlzíp		-F í m X i
m	&lt;p mv	fmvZÍP	ym)	
CS. 335
Uma vez obtidos os valores de K , V é obtido de equação m
C5. 305 e as fraçSes molares x e y são calculados a partir das TY1	Ytl
equaçSes CS. 275 e C5. 285 .	k
(5 processo de obtenção de K «á iterativo, e uma estimativa
inicial pode ser dada pela relação de Wilson:
K m
1
P r m
3727
C5. 345
onde, P --------» pressão reduzida
r m
T -------► temperatura reduzi da
r m
O novo valor de K é obtido da relação dos coeficientes de m
fugacidade calculados pelas equaçSes de estado CS. 205 ou C3.265.
, A convergência do flash é obtida quando:
1
E fF - i)2 &amp;lt;É
“ v m	c
C 5. 365
O valor de c está discutido na referência'[TL293J.
Depois que o equilíbrio é atingido a densidade de cada fase
pode ser calculada a partir do fator de compressibilidade CZ5:
correlaçSes que podem ser encontradas nas referências [BurTSJ»
[ABW601 e [MC73] ou ainda na referência £ JSÍS8].	►
6	- TÓPICOS ESPECIAIS
►
6.1	- PERMEABILIDADE RELATIVA
Para o cálculo da permeabilidade relativa às três fases, dois modelos de Stone têm sido mais comuns na literatura.
Os dois modelos assumem que a permeabi1 idade reiati va a água á f unçSo apenas da satur ação de água, a permeabi1i dade relativa ao gás é funçáo apenas da saturação de gás e que a permeabilidade relativa ao 61 eo 6 funçSo das saturaçBes de água e gás, ou seja:
	k rw	- f(sJ •	C6.13
	k rg	-'(%) •	C6. 23
e			
	k	= ffk	» Jc	&gt; 1c	» k 1 &gt;	C6. 33
	ro	row	rog	rg	rvj	
onde.			
	k r ou	‘ f(so)	•	C6. 43
k r og
C6. 53
S = S + S L&gt;	O	V
C6. 63
S = S + S h	o	g
C6. 7?
Os vai ores de k , k t rov rog
k e k s2lo tabelados &amp;amp; usados rg	rv
como entrada do programa. Um exemplo desta tabela pode ser visto
no anexo CD? » nos dados de entrada dos os exemplos uti1izados
* neste trabalho.
As expressSâs de k para os dois modelos são: r o
Modelo Cl?
k = k fSl+k ÍS } - k fl " S ) + { [S 1 Fk (1 - S ) -ro	row v	rog &amp;lt;L-7	rov V-	ves	I t L.J I row V-	vc^
- * (sjlL (1 - S ) - k (SjlA fl - S ]ll C6. 8? r ov v. h'/ I | row*-	vc-J	rogv I.-7 I	t rowv	vc-7 J |
Modelo CS?
+ k„(Si] +	*
-	- M} ■ Msv)+
onde, S
ve
+ Saturação de água conata.
vaior es de k	mai or es
r o
que 1.0,
que pode acontecer em certos
casos.
Se as equaçSes C6. 93 e C6.S3 levarem a valores negativos de k faz-se Ck =03.
ra	ro
6.2	- MODELO DE POÇO
O modelo proposto pode conter poços em qual quer bloco da grade.
Par a os poços i nj etor es, a vazão molar de cada elemento deve ser especificada e, de acordo com a formulação apresentada, devem ter valores positivos.
Para os poços produtores podemos ter dois casos:
• vazão volumétrica das fases	» Q^) especificadas
Neste caso as	vaz Ses molar es	dos	elementos devem ser
calculadas da seguinte	maneira:		
	q = p Q V	w		C6.103
e			-
Q = m	n	n	.	n	n X p Q + y p moo	mg	Qn g	C6. 113
• produção a pressSo constante
O valor de IP, constante, pode ser fornecido na entrada de dados, anexo CD3. Se o vai or fornecido na entrada de dados for zero, ele será, calculado da seguinte maneira Csegundo a referência EPedB413 .
TO —	h		k C6. 123
1 n ir Zr v o		
r = O. 14 Ax £1 +	“ ] •	C6, 133
Ax	1		
“ " Ãy ’	ã -	a &amp;lt;2	C6. 143
h = Az		C6.153
Depois
de cal cul ado o vai or
de IP,
as vazSes molares são
dadas por:
f	k p	k P	1	.	.			
% = IP[	r O o	+	* y mJ	l(t	»	C6. 163
C6. 173
C6.1S}
C6. 19}
onde, p é a pressào no fundo do poço especificada.
As derivadas das
vazSes em r elação à pr essSo
de equação
C4.14} são:
4
C6. 20}
e
dq,	v ~ h “ IP y	fk p	k p	} X +	'9 9 y	C6.21}	
4	fu	Wí	u	ml		
	Io	9	J		
Para o caso de vazão constante as derivadas são nulas pois as propriedades s£o calculadads no intervalo de tempo Cní.
Uma outra possibilidade é calcular a vazão a cada iteração a pcrtir dos dados da iteração anterior CD. Isto foi testado com sucesso, diminuindo inclusive a pequena oscilação na produção de óleo.
6.3	- BALANÇO DE MATERIAIS
k
O balanço de materi ai s é um 1mpor tante i nstrumento par a testar a ef i ci ênci a do modelo, assi m como para a vaii dade do critério de convergência.
O modelo estÁ baseado no balanço de moles de cada elemento dentro de cada bloco da grade. O balanço de materiais é usado para verificar se a variaçSo de moles no reservatório é igual à vazSo de moles nos poços.
O erro, em número de moles pode ser calculado como:
• para os hidrocarbonetos
erro C?O = 100
m
S x o m

- *"	- pgV J"] + At)} * v„
m ~ 1. . . v
C6. 223
• para a água
erro
233
onde.
V é o número de moles inicialmente no reservatório, m
6. 4
CRITÉRIO DE CONVERGENCIA

Na referência ETLS83] o critério de convergência usado é
baseado nos resíduos do balanço de moles de cada componente, ou:
|MIPl+1 - MIPn + fVL VN1*4
1 m	m v b m
At
lYlüX
C6. 243
onde, MIP
-♦ número de moles Inicial do reservatório Cmoles
"in place'*3
N --------► f1uxo molar superf i ci al do componente m
TA
— 4	— S
£	----» varia de 10 a 10
O
Porém, para o caso específico deste model o, a mesma referência sugere um teste de convergência baseado na iteraçSo da pressSo.
O critério de convergência usado foi, entSo foi baseado na
OU:
onde,
1 Kl2&amp;lt;c
L - 1
- ■ ¡ -X K+ VJ
C6. 253
C6. 263
£	---» varia delfíaO. Olíí .
n. inj
blocos de injeção .
moles de produção.
Os efeitos da variação de
£ estão descritos no item
C82&gt;
6.5	- MODELO RADIAL
O model o pr oposto pode
ser di screti zado para o
fl uxo
&amp;amp;
radial. A equação CS. 95» pode
ser
escrita do seguinte modo:
1 £_írX ÊE r ar L ar
*v
at
C6. 275
+
A equação discretizada» de
acordo com as mesmas condi çSes
mencionadas no capítulo C35» fica:
i U r Ar I L+i/2 v L
n+ 1
r.	rl^../Al + X"
L+i/zIr - r. I L-i/2 l '-+1 U
n+ 1
-.[fert] ]•
+
¿[(*	(* PA]"] •
C6. 28?
Def ine-se
o volume dó bloco CV 3, o volume discretizado do D
bloco CV 3 e o raio de curvatura r. pela aproximação da média d	t+1/2	■
logarítmica como se segue:
V = nír2
b	1.+1/2
rZ iXz
1.-1/2J
CS. 2Q3
r.
L+l/Z
z
Í+1ZZ
1 nC r .	Zr . 3
t +1 t
C6. 313
2 2 r .	- r ,
L +1	L
r
1 nC r .	Zr . 3 Z
v + i v
C6. 323
Muiti pi i cando-se os termos de acumulação e fontes pel o
volume e o termo de fluxo pelo volume discretizado, obtem-se:
- £	(M"l ■
C6. 333
Definindo-se ainda»
2nAzX .	r1* ,p	_	li+l/Z i + i/2	2nAzX, , 	1-V + 1Z2	
ií+±z2	r.	- r. L + i	L	lnCr. Zr.3 i + i	i	»
C6.343
a equação final fica equivalente à equação C3. 63 * com variação apenas no cálculo das transmissividades e do volume CVb3.
Quando a equação C 3.63 é resolvi da numericamente, blocos menores são necessários à medida se aproxima do poço. Isto resulta em uma grade altamente irregular.
Uma manei r a de se evi tar esta gr ade i r r egular é a
A equação C6.273 pode ser escrita como;
SçUs- 3¿\	+ 5t = fcHsJ
C6. 333
A equação final é a mesma
com diferença apenas
nos ter mos
de transmissividade que ficam:
2nAzk
_	_	U +1/2
LÍ.-H/2 Ç .	- Ç .
s t + 1	v
O espaçamento regular pode ser fei to através de;
¿F = Cln r - 1 n r 3/n,
o	w	o
onde.
raio externo do reservatório .
r
C6. 363
CG. 373
Da mesma forma que para cada fase CÜ» pode-se escrever as equaçSes de fluxo radial para cada hidrocarboneto. Elas serão semelhantes às equaçSes C3.73 com di ferença nos ter mos de transmissividade &amp;amp; no volume do bloco.
6.6	- RESOLUÇÃO DO SISTEMA
A equação CA. 123 resultante do método de Newton determina a solução do sistema penta-diagonal mostrado na figura 4.1. Para a resolução deste sistema, o programa utiliza a subrotina GBAND da referência íAS7Q], que é um método de el i mi nação de Gauss sem pi voteamento e pode resolver si stemas com qual quer número de bandas, ou di agonai s.
*
Para os problemas de uma dimensão, incluindo o radial, o sistema passa a ser tri-diagonal. Para estes casos, o algoritmo utilizado foi o de Thomas, que é também uma forma de eliminação de Gauss.
Para alguns casos, o sistema pode ser mal condicionado, principalmente os de vazão constante onde as derivadas da vazão em relação à pressão são nulas. Nestes casos o determinante da matriz Jacobiana é próximo de zero, fazendo com que a resposta oscile em torno da solução real. Para certos casos, a convergência pode nem ser atingida.
Um artifício matemático simples para se evitar esta oscilação está descrito na referência CPFTVS01. Supondo que o sistema a ser resolvido seja:
[ AKu&gt; =&amp;lt;b&gt; ,	C6. 383
se a matriz [AJ for mal condicionada, a solução&amp;lt;u&gt; será acrescida de um&amp;lt;&lt;5u&gt;, resultando também em um&amp;lt;ób&gt; , ou seja:

[AKÓu&gt; =&amp;lt;ób&gt; ,
CG. 403
de onde pode-se determi nar o valor de&amp;lt;óu&gt; que deve ser subtrai do da resposta inicial.
A implementação deste artifício fez não só com que certos casos passasem a convergir, como diminuiu bastante o número de iteraçSes necessárias nos casos que já convergiam.
6. 7 - CONTROLE DO INTERVALO DE TEMPO
O contr ole do i ntervaio de tempo é fei to na for ma convencional baseado nas variaçBes máximas de pressão, saturação ou composiçSes» e nos 1 imites estabelecidos para estas variáveis
Se todas estas variáveis forem menores que seus limites, o pr óxi mo i nter vai o de tempo aumentar Ar azão deste cr esci mento 6 a menor razão entre o limite estabelecido e o máximo calculado para ca'4"' variável.
Por exemplo, se a menor razão for a da saturação de gás:
C6. 413
expli car melhor » admi te-se que* por exemplo * o caso mai s crí ti co
seja o de pressão» ou seja:

max
C6. 423
é apliçado um valor
de segurança Ct?3 que deve ser aproximadamente Cl.33.
£e
o próximo intervalo
de tempo
*
dimi nuirá
do seguinte modo:
Atn+i
Atn
Tãp f
1 TY1O.X 1
C6. 433
Se
o própr i o i nter vaio de tempo é
c~»lcul ado
novamente
mas com um valor novo* usando—se a equação
anterior
C6. 433.
O
i nter vaio de tempo deve di mi nui r também quando há
uma
previsão
de condensação retrógrada.
6. 8 - MODELO DE HELFFERICH
Um modo de se validar o modelo é através da' obtenção de uma solução analítica, obtida a partir de algumas simplificaçSes, e a comparação com a resposta deste modelo [Hèl813. Admitindo-se que:
e
£ = 0 ,
w
í
CS. 445
p	= u = constante ,	C6. 455
o	g	
p = p = constantef
k = S2 ro	o
CS. 465
C6. 475
k = S2 ,	C6.485
rçr	g
e que o "flash" tenha como resultado valores constantes das frações molares do 11qui do e do gás» e ainda reduzi ndo-se par a dois o número de hidrocarbonetos, pode-se obter uma soluçSo analítica.
No item C7. 35 pode-se verificar a comparação entre os resultados do modelo e a solução analítica, obtidos a partir destas consideraçSes.
7	- RESULTADOS
O erro no balanço de materiais foi feito para todos os casos e não está mencionado para cada um em particular pois apr esentou vaior es acei t ávei s» sendo de no máximo da or dem de
_g
10	. De manei r a geral * os erros eram mai ores nos bl ocos onde
estava a frente de gás ou água injetados ou quando havia uma maior variação das saturaçSes.
O número de hidrocarbonetos dos casos testados foi de no máxi mo três poi s* embora o programa acei te um número mai or de -imponentes, este não é o objetivo deste trabalho.
Em todos os casos apresentados» a variação da saturação de áy ua se deve exclusivamente á variação de pressão pois a água não flui entre os blocos.
O efeito da utilização da formulação '*2—point upstream" para as fraçCíes molares Cx e y D está descrito no caso C1D.
m	Tn
O método é comparado com uma solução analítica* obtida a pirtir de certas simplificações, como pode ser visto no caso C3D.
Este caso é um exemplo da referéncia E TLS82] que compara os métodos de ENFA811, EYS83] e ECoaSO]. E um caso unidimensional e os dados deste problema estão nas tabelas C7.1.13 e C7.1.23.
As figuras de C7.1.13 a C 7. 1.63 mostram uma comparação do presente método cora o simuí ador "COMP3” da PETROBRÃS. Para esta comparação o intervalo usado foi de 3 di as e o reservatório foi dividido em 20 blocos. Os resultados são bastante próximos e a diferença na saturação de óleo deve-se principalmente aos diferentes modelos de permeabilidade relativa. A produção total de óleo é bastante próxima nos dois casos mas a produção em cada intervalo de tempo apresenta uma oscilação nos resultados do COMP3 e isto não acontece neste modelo. Esta oscilação acontecia antes do dispositivo explicado no Ítem 6.6.
Um outro ponto i mportante que deve ser menci onado é a presença de dispersão numérica no presente método. Todos os modelos apresentados nas referências demonstram uma preocupação constante com este pr oblema, e a úni ca manei r a encontr ada par a
L
amenizá-lo foi a utilização de formulação "2-point upstream" para as composiçSes.
Este tipo de formulação, porém, traz um outro tipo de problema como pode ser verificado na figura C7.1.23 e é conhecido como "overshoot" e “undershoot". A limitação imposta no item 3, equação C3.1O3, diminui bastante este problema Cver figura 7.1.33.
O que deve ser pesado, é o fato de que à medi da que se aumenta o número de blocos, a dispersão numérica diminui mas este problema se agrava. O número de blocos a ser utilizado, então.
deve ser escolhido com cuidado.
*
Tabela 7.1.1
Dados
Caso 1
VARIÁVEL	UNIDADE	VALOR
compri mento	Cm3	76. 2
área transversal	Cm2)	464. 5
permeabi1i dade	C md3	2000
porosí dade		0. 3
compressibilidade da rocha	ClZpsiO	4x10_&lt;S
compress!bi 1idade da água	ClZpsi3	3x1 O_d
temperatura	°F	160 *
sat' açSes i ni ci ai s CS » S , S D o	g	v		C0. 8, 0. 0, 0.23
pressão inicial e de produção	Cpsi)	2000
Índice de produtividade	3 C f t —cpZdi a-psi 3	1.012X105
tempo final	Cdias3	210
c omposiçSo i ni c i al CC , nC , nC 0 í	4	IO		C0. 2, 0.2, 0.63
Tabela 7.1.2 : Injeção - Caso 1
VARIAVEL 1	UNIDADE	VALOR
injeção de gás	CMSCFZdiaO	83,5
	CKmolZdia3	ÍOO
composição de gás injetado CC , nC 3 1	4		CO. 8, 0.20
1.0
+ METANO NFA
x METANO C0MP3 o DECANO NFA
♦ DECANO COMPS
0.8 -
COMPOSiCAO
TEMPO (d)
Figura 7.1.1 : DistribuigSo das ComposigSes no Tempo.
ComparagSo do Modelo CNFA3 com o "COMP3'’.
CBloco de injegSoi.
1.0
+ METANO NFA x METANO C0MP3 o DECANO NFA
* DECANO C0MP3
0.8 -
COMPOSICAO
o.o H i i i i i i i i i
0.0	0.2	0.4	0.6	0.8	1.0
DISTANCIA ADIMENSIONAL DO BLOCO DE INJECAO
Figura 7.1.2 : Distribuição das ComposiçSes nos Blocos.
Comparação do Modelo CNFA3 com o "C0MP3".
C21O diasD.
1.0
4- METANO NFA x METANO C0MP3 o DECANO NFA
* DECANO C0MP3
0.8 -
COMPOSICAO
o.o H !	] i i i i i i i
0.0	0.2	0.4	0.6	0.8	1.0
DISTANCIA ADIMENSIONAL DO BLOCO DE INJECAO
Figura 7.1.3 :
Di str i bui çào das Composi ç3es nos BIocos.
Comparação do Modelo CNFA2) com o "COMP3" sem a
Limitação da Equação C3.1O3.
COMPOSICAO DO BUTANO
Figura 7.1.4 : CompoaiçSo do Butano C210 dias5.
Efeitos da Limitação da Equação C3.103.
COMPOSICAO DO BUTANO
Figura 7.1.5 : Composição do Butano CEIO dias?.
Efeitos da Variação do Número de Blocos.
1.0
x NFA o C0MP3
0.8
SATURACAO DE OLEO
0.6
0.4
0.2 -
o.o H	 0		i	1	 50	100	'	150		r- 200
			TEMPO (d)	
Figura 7.1.6
Saturação de Óleo no Bioco de Injeção.
Comparação do Modelo CNFAD com o "COMPS".
7.2	- CASO 2- CONDENSAÇÃO RETRÓGRADA
Devido à particularidade dos dados de produção, a pressão e a temperatura permanecem aproximadamente constantes para cada bloco, ocorrendo variação apenas na composição dos hidrocarbonetos. Deste modo, como o fluido injetado é mais rico em elementos mais leves, espera-se que a saturação de gás aumente no bloco de injeção.
Com a composição de injeção da tabela C7.3D, isto ocorre até certo ponto, quando a saturação de óleo começa a aumentar, como pode ser verificado na figura C7. 2. 1D.
Para os pontos CID e C2D desta figura, foram traçados os envelopes de fase, figuras C7. 2. 2D e C7. 2. 3D » pelos quais se verifica a condensação retrógrada.
O maior problema da ocorrência deste fenômeno é o fato de que» como as trasmissividades são calculadas no intervalo de tempo anterior, esta inversão no comportamento das saturações faz com que o modelo apresente uma certa oscilação. Isto pode ser verificado na figura C7.2.1D.
Lima maneira de se evitar esta oscilação é através da diminuição do intervalo de tempo após a previsão da ocorrência do fenómeno. O controle automático do intervalo de tempo encarrega—se naturalmente de levá-lo novamente ao nível anterior.
Isto pode ser comprovado pela f igura . C 7. 2. 1D onde os dados
63
diminui para 0.5 dias. A oscilaçSo diminui bastante.
Tabela 7.2 : Dados de injeção- Caso 2
VARIÁVEL	UNIDADE	VALOR
injeçSo de gâs	C MSCF/di aD	62, 5
	CKmolZdi a3	74,8
composiçSo de gás injetado CC , nC 3 i	+		CO. 8, 0.23
1.0
SATURACAO DE OLEO
Figura 7.2.1 : Saturação de Oleo - Condensação Retrógrada
Efeitos da Variação no Intervalo de Tempo.
CBI oco de injeção!).
1*7700 0NV33QPI9ZC0 ONVinQVlOSg O ONV13H1
0V'JIS0dH03 V V8Vd S3SV3 30 3dO13AN3 ZZi DIJ
Ido I WlVkJ3dW31
PRESSÃO IPSII
PRESSÃO (PSI)
FIG. 7.2.3 ENVELOPE DE FASES PARA A COMPOSICAO
(METANO 0 692),I0UTANO 0303) e (DECANO 0-051
7.3	- CASO 3- MODELO DE HELFFERICH
As tabelas de dados para esta comparação são a C7. 3. 12) e a C7. 3. 22) , de onde se obtém os resultados mostrados nas figuras C7. 3. 12&gt; a (27. 2. 22) , para um deslocamento de 50?í do volume poroso.
A diferença entre as formulaçSes "2-point upstream" e "1—point upstream'* se faz presente nos blocos onde se encontra a região de duas fases. Os resultados do "2-point upstream" são 1 igei ramente mel hores.
A variação de 20 para 80 blocos causa uma grande diferença nos resultados. Para 80 blocos o resultado é bem próximo do analítico equanto que para 20 blocos os erros são razoavelmente andes.
Deste modo, deve—se escolher com cuidado o número de blocos par a utjter a mel hor r ei ação entr e a pr eci são nos r esul tados e o tempo computacional. Para o caso unidimensional, pode ser viável um grande número de blocos, mas para o bidimensional isto deve ser estudado com maior cautela.
A única ressalva a ser feita para esta comparação é o fato de que as simplificaçdes feitas eliminam qualquer erro proveniente do "f 1 ash", mas é um método úti 1 para testar o modelo quanto a intervalos de tempo e número de blocos possíveis.
Tabela 7.3.1 : Dados — Caso 3
VARIÁVEL	UNIDADE	VALOR
comprimento	Cm3	76. 2
área transversal	Crô	464,. a
permeabi1Idade	Cmd3	200
porosidade		0. 3
compressi bi1i dade da rocha	C1Zpsi 3	0
temperatura	T	160
saturaçSes iníciais CS t S 1 o	g		Cl.OZ) , CO.OZ)
pressão inicial e de produção	C psi3	2000
índii_= de produtividade	C f t3 -cpzdi a-psi Z)	1. OI 2x1 O=
tempo Tinal	CdiasZ)	210
composição inicial cc.cz&gt; 1	iO		CO. 03 . Cl. 03
viscosidade Cu &amp;amp; u 5 °	9	CcpZ)	Cl. 03 , Cl.03
densiúades molar es	a CgmolZm 3	6000
VARIÁVEL	UNI D ADE	VALOR
injeção de gás	CMSCFZdia3	83,3
	C KmolZdia}	100
composição de gás injetado CC » C 3 1	IO		C1.0, 0.03
SATURACAO DE OLEO
1.0
Figura 7.3.1 : Saturação de óleo - Modelo de Helfferich.
Efeitos da VariaçSo do Número de Blocos.
SATURACAO DE OLEO
Figura 7.3.2 : Saturação de Óleo - Modelo de Helfferich.
Efeitos da Variação da Formulação das Composiçdes.
COMPOSICAO DO FLUIDO DE INJECAO
1.0
DISTANCIA ADIMENSIONAL DO BLOCO DE INJECAO
Figura 7.3.3	: Composição do Fluido Injetado - Modelo de
Helfferich. Efeitos da Variação do Número de
Blocos.
COMPOSICAO DO FLUIDO DE INJECAO
1.0
Figura 7.3.4	: Composição do Fluido Injetado - Modelo de
Heifferich. Efeitos da Variação da Formulação das
ComposiçSes.
7.	4 - CASO 4- MODELO RADIAL
Como visto no item C6. 5? , este modelo pode ser estendido para o fluxo radial. O grande problema da utilização de um modelo semi-implíci to para este caso é o f ato de que» devido à grande queda de pressão, os blocos próximos ao poço devem ser muito pequenos» o mesmo acontecendo com o intervalo de tempo. Isto ocorre pois» nos modelos não totalmente implícitos, o fluxo fica limitado pelo volume poroso dos blocos.
Para se ter uma idéia desta limitação, com um reservatório de mesmo volume do caso CO» o intervalo de tempo fica limitado a um valor» aproximadamente, trinta vezes menor.
Por esta razão» os casos radi ai s não for am vali dados e estudados com maiores detalhes pois» para estes casos» o tempo computacional seri a muito grande, principalmente para um modelo ccmp _J-ional. Para problemas radiais, aconselha-se a utilização dos modelos totalmente implícitos. Isto pode ser encontrado nas i¿ncias [JonSSl, [JR88], [JR893 e [Coa851.
7.5 - CASO 5- VALIDAÇÃO DO MODELO
C7. 1?
onde qL —	-* vazSo total ,
L —	—&gt; comprimento do reservatório,
Po ”	—» pressSo na face x = 0 e,
Pc -	—&gt; pressSo na face x = L .
As;	sim, consi der ando a pressSo de i njeçSo i gual à origi nal
do reservatório Cp^3, a integral contendo os termos de permeabilidade relativa pode ser calculado por partes para cada bloco, ou seja,
qL L
A k
C7.£3
Considerando a mobi1idade total constante ao 1ongo de cada
bloco, obtém-se :
qt L	nb S” í kro p + kr9 plcp.-p: j =i	*	C7. Sd ■	. f
A k		
ou, simplesmente,	qt L - 1	C7. 4D
nb Akí ( j = l	k	k	- ro p + rg p 1 Cp - p, 3 °	^g gJj J	J_1	
onde, pj *= p^ quando j = 1.		
A tabela C7.5.apresenta os dados para a alimentação do modelo a ser validado. A tabela C7.5. 22) apresenta o resultado do quociente definido no lado esquerdo da equação C7. 4D como função do número de blocos. Observa-se que, com o refinamento da malha, o quoci ente tende à uni dade.
Tabela 7.5.1 : Dados - Caso 5
F
VARIÃVEL	UNIDADE	VALOR
comprimento	C nD	250
área transversal	Ciô	464. 5
per meabi1i dade	C mdl	25
porosi dade		0. 3
ccmpressibi 1 idade da rocha	ClZpsO	0.000004
compressibilidade da água	C1Zpsi D	0.000003
temperatura	°F	160
saturaçSes ini ci ai s CS . S , S 2) o	g	V		C0. 8» 0.0» 0.23
pressão inicial	CpsiZ)	3000
índice de produtividade	C ft3-cpZdi a-psi 3	1.012x1 o5
composição inicial CC , C , C ? 14	10		C . 22&gt; . C . 22&gt;, C . 6D
.azâo de produção	CSTBZdZ)	78. O
■ .imposição de injeção		i gual À i ni ci al
Tabela 7.5.2 : Resultados - Caso 5
NÚMERO DE BLOCOS	QUOCIENTE DEFINIDO NA EQUAÇÃO C7.42)
20	0. 93
40	0. 97
80	0. 99
8 - CONCLUSÕES
A grande desvantagem é a limitação do intervalo de tempo devido ao tratamento explicito das composições e transmi ssi vi dades. Esta limitação pode ser pequena , como no caso do início da condensação retrógrada mas também pode ser bastante severa, como no escoamento radial. Para estes casos, torna—se necessário um modelo totalmente implícito.
Outro ponto importante é a necessidade da implementação do artifício matemático explicado no item C62&gt;. Nos casos de produção à. pressão constante, o número de iteraçSes por intervalo de tempo c-4tj» em média, de três para uma. Nos casos de produção constante, o sistema era mal condicionado e, muitas vezes. nem convergia. À reféi êíicia [Won881 cita que a utilização do balanço de moles ao invés' de fraçSes molares pode ter o mesmo efeito, além de melhorar o balanço de materiais.
o -&gt;0001 o não apr esentou probi emas de convergênci a, pel o menos no^ casos testados. A referência (TLS833 cita que em certos casos surge a necessidade da uti1ização do fator de amortecimento adotado por Nghiem CNgh823. Isto não foi necessário em nenhum caso estudado. A razão disto pode ser a implementação da modificação de um dos termos do Jacobiana, proposta por Manscori [Man823 e
so
descrita no item C4D.
ser viabilizado através de um estudo bem mais detalhado, para ser apliçado somente nos pontos necessárias. O seu uso i ndi scr i mi nado em todos os intervai os de tempo pr ejudi ca a convergéncia e aumenta demasiadamente o tempo computacional.
Um ponto sempre menci onado por todos os modelos composicionais é a presença de dispersão numérica. Segundo as referências ETLS831 e EWonSSJ, no modelo implícito de Coais [CoaSO], este problema é ainda mai s grave. Coats sugere a especi ficação da composição do óleo como a original até que a saturação de gás seja diferente de zero. A justificativa usada foi de que os erros na composição do óleo seriam menores do que os causados pela di spersão numérica. A formui ação "2-poi nt upstream" para as composiç3es, sugerida por ENFA81] pode apresentar pz 1 ' 'nas de "overshoot" e "undershoot“, mesmo com as limitaçBes da equação C3.10D. Isto se agrava um pouco com o crescimento do númesi u de blocos.
Um dos pontos pouco mencionados nos resultados, e que fazia parte do alvo inicial deste trabalho, foi o da aplicação deste modele	problemas do tipo "black—oil". Uma das causas foi o
maior +&amp;lt;=mpo computacional dos modelos composicionais em relação aos ”black-oi 1". Não parece viável a utilização de um modelo tão mai s complexo do que o problema a ser estudado. Algumas referéncias sugerem algumas simplificaçBes nos “ modelos composi ci onai s que podem ser f ei tas para o estudo de problemas do
ANEXOS
ANEXO A
NOMENCLATURA
a	constante na equação de estado
À	Cap/RZT22)
b	constante na equação de estado
B	CbP/RT)
c r	compressibi1idade da rocha
c V	* compressibil i dade da Água
erro	erro no balanço de materiais
f	fugacidade
F	lado esquerdo da equação da pressão C4.11D
F m	razão de fugacidade
g	aceleração da gravidade
G 3	energia livre de Gibbs CâG,
IP	índic» de prodnt i'’'dade
J	Jacobiano
K m	constante de equil 1-brio 1íquido—vapor
k	permeabilidade absoluta
k r	permeabilidade relativa
L	fração molar do líquido
m	constante na equação de estado
n	número de moles
nb	número de blocos
P	pressão
P w	pressão no fundo do poço
p c	pressão crítica 84
pressSo reduzida
vazão mol ar
vazão volumá t r i ca
►
vazão molar por unidade de volume
constante universal dos gases
rai o
saturação
tempo
tr ansmissi vi dade
temperatura crítica
temperatura
temperatura reduzi da
veloci dade
fração molar do gás
volume do bloco
volume discretizado do bloco
fator de amortecimento
fração molar do componente Cm2) no líquido
fraçSo molar do componente Cm2) no gás
fração molar total' do componente Cnü
fator de compressibilidade
C&amp;amp;p S + pS + p S 2)
V V	o o	9 9
coeficiente de iteração binário
fator para medir a convergência
porosi dade
potenci al de f1uxo
coeficiente de fugacidade
gradiente
fator de segurança para o controle do intervalo de tempo
85
X.	mobi1 i dade
fj	viscosidade
p	densidade molar

Ç	linearização de r Cln r?
Ô	tp S + p S 1/Ep CS + S)]
o o	5 9	w o	g
u	número de componentes
os	fator acéntrico
*
SUBSCRITO
b	hidrocarboneto
i-» j &gt; k	bl oco
L	f ase
Lím	1 i mi te
m	componente
maje	máxi mo
o, g, v	fasesCóleo, gás e água?
SC	condição padrão
X	dir .-çao x
y	direção y
w	poço SUPERESCRITO
c	Colsi us
F	Fa.r anheit
L	iteração
L&gt;	aproximação da média logarítmica
rs R	intervalo de tempo Rankini
ANEXO B
QUANTIDADE	UNIDADE	UNIDADE SI	FATOR DE CONV. PARA O SI
Compressi bi1i dades	1/psi	1/Pa	1.450377E-04 %
Comprimento	ft in	m	3.O48OOOE-01 2.54OOOOE-O2
Densí dade	1bm/ft3 lbm/bbl	Kg/m3	1.6O184ÊE+O1 2.85301OE+OO
Massa	lbm	Kg	4. 5359OE-O1
Per meabi1i dade	md	2 m	9.869233E-16
Pressão	psi a	Pa	6.894757E+03
1 Temper atura	°C °F °R	K	T =TC+273. 15 k T, =€1^+459.673/1.8 k T, =Tr/1.8 k
Tempo	dias	s	8.64OOOOE+O4
VazSo	STB/dia ft3/dia	m3Zs	1.84O13OE-O6 3.277414E+OO
Viscosidade	cp	Pa*s	l.OE-03 *
Vol ume	bbl fta	3 m	1.589873E-01 2.831685E02
Vazão molar	lbmol	Kmol	4.535Q24E-01
* val or aproxi mado
c c c c c c c c c c
DENIS
DATA
C
C
C c c
DE RESERVATÓRIOS
JOSE SCHIOZER
JUNHO - 1989
DECLARACAO DE VARIAVEIS
IMPLICIT REALES CA-H,K,O-Q,S-Z3
REALMS ROO,ROG,ROW,RAUX,RO,RWELL,ROSCW,ROON»ROGN,ROWN,ROOSC,ROGSC, +	ROOI , ROGI, ROWI
CHARACTERS CHARA4C153
CHARACTERS CHARA8C253
COMMON/ENT/CHARA4,CHARA8,1NTE01,1NTEO2,1NTE03,1NTE04C 253,
1	INTE05,1NTE06,1NTEO7,1NTEOS,INTEO9,1NTEi O,INTE11C 253 »
2	REAL01C 253,REAL02C 253,REAL03C 253,REAL04C 253,REAL05C 253,
3	REAL06C 253 „ REAL07C 253 , REAL08C 253 , REAL09» REAL10REAL11 .
4	REAL12,REAL13,REAL14,REAL15,REAL16,REAL17C 253
COMMON/SAI/INTEI2,REAL71,REAL72,REAL73,REAL74,REAL75,REAL76
1
COMMON
+
COMMON
COMMON
COMMON
COMMON
REAL77,REAL78,REAL79,I CONV,REALXC 253,REALYC253 zTMS/ TOC 503 , TGC 503 , TWC 503 , TC 503 , PC 50,103 , ALFAC 503 , FI C 503 ,
TETA,VOLC 503,DFIA,VC 503,DELTAP
ZCOMPZ ZC50,103 , YC50* 103 , XC 50,103 , NCOMP /CONV/ FC503
ZVAZZ
/PRTZ
QWC 503 „ QHC 503 »QMC 50,103 »QOC 503 , QGC 503
NDAY,ITEMAX,IPRI NT, DX , DY , XL , YL t DAYPRTC 303 . CP,CT,CO,CD,NFLAG
IDTt DT,DPLIM» DSLIM.DPMAX,DSMAX
ZTSC/
/JACOB/ GC50.5O3
/SAT/ SOC 503,SGC 503 , SWC 503
/DENS/ ROOC 503,ROGC 503&gt;ROWC 503 /PROPI/
ZPROP1Z
ZPROP2Z
ZPROP3Z
ZPROP4Z
/PW/ PWELLC503.DTN,CUMOIL»CUMGAS,GASINJ
/PROPNZ SONC 503,SGNC 503,SWNC 503,PNC 50,103 ,ZNC 50,103,
SOI ,SGI , SWI , PI , FII
TEMPO,ITER,NX,NY,N,AUXX,AUXY.KM,EPI,NIP
RAUX»PMAX,PMIN,CR,CW,POR.DZ.ROSCW,PROIND
KROC 503,KRGC503,KRWC 503,VOC 503 ,VGC 503, VISW, NK
IMAX. TK, DTMAX, QOMIN, QOMAX, QOSC, QGSC
COMMON
COMMON
COMMON
COMMON
COMMON
COMMON
COMMON
COMMON
COMMON
COMMON
COMMON
+ XNC50,103 »YNC50,103,ROONC 503,ROGNC 503,ROWNC 503,ALFANC 503 »FINC 503 COMMON
COMMON
COMMON
COMMON
/PERM/ SSC203.KKOWC203,KKWC203.KKGC 203.KKOGC 203,KROWI /MOL/ PMC1O3,PMO,PMW,PMG
ZMATBZ ERROC103,ERROW &gt;ERROCC103,ERROCW,ERTOT,VOLINI
ZPRT2/ VOLHIDC103,VOLIPCI03, QiC103,QpC103,VOLIPW,VOLWAT
DIMENS!ON AC 5003,DELC 503,XIC 503,YIC 503 ,del2C 503
IO
OPENCI,FILE=‘SR. DAT’3 readCl„103PROIND,DAMP,epl3 formate3C15x,flO. 233
ROTT NA DE LEITURA
CALL INI READ
CLOSEC13
n n o n r&gt; n	nnn q q n	o n n
OPENC 2.FILE=1 SR1. PRN * 3
OPENC3.FILE=*SR2. PRN‘3
OPENC 4, FI LE= ’ SR3. PRN»2)
OPENC 5,FILE=‘SR4.PRN13
OPENC 6,FILE= &gt; SR5. PRN’3
100 ITER = O
IDT = 0
WRITEC*.7053TEMPOZCT
CALCULO DAS TRANSMISSIVIDADES
CALL TRANSCn3
200 DO 110 I = 1 , N
DO 11O J = l.N
110 GCI , J3 = O. OdO	4
CALCULO DO JACOBIANO PARA RESOLUÇÃO DA EQUACAO DA PRESSÃO
CALL CALCULO
RESOLUÇÃO DO SISTEMA TRI-DIAGONAL
if Cny.ne.13 goto 203
cal1 thomasCn,g,f,dei3 do 196 1=1, n
fCi3 = - fCi3
do 194 j=l,n
194	fCi3 = fCi3 + gCi,J3*delCJ3
196 continue
cal1 thomasC n,g,f,dei23 do 198 1=1 ,n
198 delCi3 = delC13 + del2Ci3
goto 208
RESOLUÇÃO DO SISTEMA PENTADIAGONAL
CONVERTE GCI,J3 EM ACIND3 PARA SOLUCAO 130 GBAND
203	1=0
IND = O
202 1=1+1
IF CI.GT. N3 GOTO 206
IF Cl.LE.NY3 J = O
IF CI.GT. NY3 J = I - NY - 1
IF‘ Cl. GE. N-NY3 L = N
IF CI.LT. N-NY3 L = NY + I
204	J = J + 1
1ND = IND + 1
ACIND3 = GCI , J3
IF CJ.EQ. L3 GOTO 202
GOTO 204
206 CONTTNUE
u o u
166 continue	*
CALL GBAND CA,F,DEL2,N,NY,EPS,IERR,03 do 168 i =1, n
168 delCi3 = delCÍ3 + dol2Ci3
C
C	ATUALIZACAO DA PRESSÃO PARA A NOVA ITERACAO
C
208 DO 210 I=1,NX DO 210 J~1,NY
IJ - CI-13XNY + J
210 PCI.J3 = PCI.J3 + damp * DELCIJ3
CALCULO DAS COMPOSICOES E DA SATURACAO DA AGUA
DO 400 I = 1,NX
DO 400 J = 1, NY
IJ =« CI-13*NY + J
C
IF Cl.NE.13 GOTO 222
DEN = O. OdO
SWCIJ3 = O. OdO
DO 218 M = 1,NCOMP
218 ZCIJ.M3 - O. OdO
GOTO 240
222	AUX = PCI-1.J3 “ PCI,J3
IF C AUX. LE. O. d03 GOTO 230
DEN = AUX * CTOCIJ-NY3 + TGCIJ-NY33 * AUXX SWCIJ3 = AUX * TWCIJ-NY3 * AUXX
DO 225 M=l,NCOMP
IF Cl.NE.23 GOTO 223
XX = XNCIJ-NY.M3 YY = YNCIJ-NY.MJ
GOTO 225
223	IF CNTP. EQ. 03 THEN
XX = 1.5d0 * XNCIJ-NY.M3 - O. 5dO * XNCI J-NY*2, M3 YY = 1.5d0 m YNCIJ-NY.M3 - O. 5dO * YNCIJ-NY*2»M3 IF CXX.GT. DMAX1CXNCIJ.M3,XNCIJ-NY»M333 THEN
XX = DMAX1 C XNCI J, M3 , XNCI J-NY, M33 ENDIF
IF CYY. GT. DMAX1CYNCIJ ,M3 , YNCI J-NY .M333 THEN YY = DMAX1 C YNCIJ,M3,YNCIJ-NY,M33
ENDIF
IF CXX. LT. DMIN1CXNCIJ, M3 ,XNCIJ-NY,M33&gt; THEN XX = DMI NI C XNCIJ.M3 ,XNCIJ-NY,M33
ENDIF
IF CYY. LT. DMIN1C YNCI J, M3 , YNCI J-NY, M333 THEN YY = DMIN1 C YNCIJ.M3 , YNCI J-NY , M33
ENDIF
ELSE
XX = XNCIJ-NY,M3
YY = YNCIJ-NY.M3
ENDIF
225 ZCIJ.M3 = AUX * CT0CIJ-NY3 m XX + TGCIJ-NY3 * YY3 * AUXX Q1
XX = XNCIJ.MD	&gt;
YY = YNCIJ.MD
GOTO 235
233 IF CNTP.EQ. OD THEN
XX = 1.5d0 * XNCIJ,MD ' O.5d0 * XNCIJ+NY,MD
YY = 1.5d0 * YNCIJ.MD - O.3d0 * YNCIJ+NY.MD ELSE
XX = XNCIJ.MD
YY = YNCIJ.MD
ENDIF
235 ZCIJ.MD = AUX * CTOCIJD * XX + TGCIJD * YYD * AUXX
240 IF CI.EQ. NXD GOTO 260
AUX = PCI+l.JD - PCI.JD	‘
IF C AUX. I ,E. 0. dOD GOTO 250
DEN = DEN + AUX * CTOCIJ+NYD + TGCIJ+NYDD * AUXX SWCIJD = SWCIJD + AUX * TWCIJ+NYD * AUXX
DO 245 M=1,NCOMP
IF CI.NE.NX-1D GOTO 243
XX = XNCIJ+NY.MD
YY = YNCIJ+NY.MD
GOTO 245
243	IFCNTP. EQ. OD THEN
XX = 1.5d0 * XNCIJ+NY,MD - O.5dO * XNCIJ+NY*2,MD YY ~ 1.5d0 w YNCIJ+NY.MD - 0.SdO * YNCIJ+NY*2,MD IF CXX. GT. DMAX1CXNCI J.MD .XNCIJ+NY,MDDD THEN
XX = DMAX1 C XNCIJ.MD.XNCIJ+NY,MDD ENDIF
IF CYY. GT. DMAX1CYNCIJ.MD .YNCIJ+NY,MDDD THEN YY = DMAX1 C YNCIJ,MD.YNCIJ+NY.MDD
ENDIF
IF CXX. LT. DMIN1CXNCIJ ,MD . XNCI J+NY. MDDD THEN XX = DMIN1 C XNCIJ.MD»XNCIJ+NY,MDD
ENDIF
IF CYY. LT. DMIN1C YNCI J, MD . YNCI J+NY, MDDD THEN
t	YY = DMIN1 C YNCIJ,MD.YNCIJ+NY,MDD
ENDIF
ELSE
XX = XNCIJ+NY.MD YY = YNCIJ+NY.MD
ENDIF
245	ZCIJ.MD = ZCIJ.MD + AUX * CTOCIJ+NYD * XX -+ TGCIJ+NYD * YYD
+	* AUXX
GOTO 260
DEN = DEN + AUX * CTOCIJD + TGCIJDD * AUXX SWCIJD = SWCIJD + AUX « TWCIJD * AUXX DO 255 M=1.NCOMP
IF Cl.NE.1D GOTO 253
XX = XNCIJ.MD YY = YNCIJ.MD
GOTO 255
253	IF CNTP. EQ. OD THEN
XX = Í.SdO * XNCIJ.MD -
92
O.5dO * XNCIJ-NY.MD
255	ZCIJ.M3 = ZCIJ.M3 + AUX x CTOCIJ3 * XX + TGCIJ3 x YY3 x AUXX
260 IF CJ.EQ. 13 GOTO 280
AUX = PCIU-O - PCI.J3
IF CAUX. LE. O. dO3 GOTO 270
DEN = DEN + AUX * CTOCIJ-13 + TGCIJ-133 x AUXY
SWCIJ3 = SWCIJ3 + AUX X TWCIJ-13 x AUXY
DO 265 M=1»NCOMP
IF CJ.NE. 23 GOTO 263
XX = XNCIJ-1 tM3
YY = YNCI J-l »MJ
GOTO 265
263	IF CNTP. EQ. 03 THEN
XX = l.SdO x XNCIJ-1,M3 - O. 5d0 x XNCIJ-2.M3	1
YY = l.SdO x YNCIJ-ljM? - 0. SdO * YNCIJ--2,MD
IF CXX. GT. DMAX1C XNCIJ t M3 »XNCI J-l , M333 THEN
XX = DMAX1 C XNCI J&gt; M3 k XNCI J-l &gt; MJ3
ENDIF
IF CYY. GT. DMAX1CYNCI J,M3 ,YNCIJ-1 .M333 THEN
YY = DMAX1 C YNCIJ » M3 t YNCI J-l , M33
ENDIF
IF CXX. LT. DMIN1CXNCIJ, bD fXNCI J-l ,bD33 THEN
XX = DMIN1 C XNCIJ»M3 f XNCI J-l, M33
ENDIF
IF CYY. LT. DMIN1C YNCI J, bD , YNCI J-l ,M333 THEN
YY = DbUNl C YNCI J»M3 , YNCI J-l ,M33
ENDIF
ELSE
XX = XNCIJ-l.MJ
YY = YNCIJ—1»M3
ENDIF
265	ZCIJ.M3 - ZCIJ»M3 + AUX x CTOCIJ-13 x XX + TGCIJ-13 * YY3
+	x AUXY
GOTO 2S0
270 DEN = DEN + AUX x CTOCIJ3 + TGCIJ33 * AUXY
‘ SWCIJ3 = SWCIJ3 + AUX * TWCIJ3 X AUXY DO 275 M=1,NCOMP
IF CJ.NE.NY3 GOTO 273
XX = XNCIJ»M3
YY = YNCIJ.M3
GOTO 275
273 IFCNTP.EQ. 03 THEN
XX = 1.SdO « XNCIJ.bD - 0.SdO x XNCIJ+lfM3
YY - l.SdO x YNCIJ,M3 - O.SdO x YNCIJ+1,M3 ELSE
XX = XNCIJ»M3
YY = YNCIJ.M3
ENDIF
275	ZCIJ»M3 = ZCIJ.M3 + AUX x CTOCIJ3 * XX + TGCIJ3 x YY3 x AUXY
C
280 IF CJ.EQ. NY3 GOTO 300
AUX = PCI»J+13 - PCI.J3
IF CAUX. LE. O. dO3 GOTO 290
283
DEN = DEN + AUX * SWCIJJ = SWCIJJ + DO 285 M-l.NCOMP
IF CJ. NE. NY-1J XX = XNCI J+l.MJ YY = YNCI J+l .MJ GOTO 285 IF CNTP. EQ. OJ XX = 1.5dO YY = 1.5d0
CTOCIJ+1J + T6CIJ+1JJ AUX * TWCIJ+1J * AUXY
THEN
*	XNCI J+l. MJ - O. 5d0 *
*	YNCI J+l. MJ - O. SdO *
290
* AUXY
XNCIJ+2.MJ YNCIJ+2. MJ
IF CXX. GT. DMAX1CXNCIJ»MJ.XNCIJ+l.MJJJ XX = DMAX1 C XNCI J. MJ ,XNCI J+l , MJJ
ENDIF
IF CYY.GT.DMAX1CYNCIJ.MJ.YNCIJ+1 .MJJJ YY = DMAX1 C YNCI J,MJ , YNCI J+l .MJJ
ENDIF
IF CXX. LT. DMIN1C XNCIJ . MJ , XNCI J+l , MJ J J
XX - DMIN1 C XNCI J .MJ .XNCI J+l , MJ J
ENDIF
IF CYY. LT. DMINICYNCI J, MJ , YNCI J+l .MJJJ YY - DMIN1 C YNCIJ.MJ .YNCIJ+l .MJJ
ENDIF
ELSE
XX = XNCI J+l , MJ
YY = YNCI J+l .MJ ENDIF
ZCIJ.MJ = ZCIJ.MJ + AUX * CTOCIJ+1J * XX
* AUXY
THEN
THEN
THEN
THEN
+ TGCIJ+1J * YYJ
+
GOTO 300
DEN = DEN + AUX * CTOCIJJ + TGCIJ2O * SWCIJJ = SWCIJJ + AUX * TWCIJJ * AUXY DO 295 M=1&gt; NCOMP
IF CJ. NE. 1J GOTO 293
AUXY
►

XX = XNCIJ.MJ YY ~ YNCIJ.MJ GOTO 295
293	IF CNTP. EQ. OJ THEN
XX = 1.5d0 * XNCIJ.MJ - O.SdO * XNCIJ-l.MJ YY = 1.5d0 * YNCIJ.MJ - O.BdO « YNCIJ-l.MJ ELSE
;	XX = XNCIJ.MJ
YY = YNCIJ.MJ
ENDIF
295	ZCIJ.MJ = ZCIJ.MJ + AUX * CTOCIJJ * XX + TGCIJJ * YYJ * AUXY
«
300 DEN = DEN + QHCIJJ + VOLCIJJ/DT * FINCIJJ * C ROONCIJJ *
+	SONCIJJ + ROGNCIJJ * SGNCIJJ J
DO 310 M=l.NCOMP
ZCIJ.MJ +
310 ZCIJ.MJ
= ZCIJ.MJ + QMCIJ.MJ + VOLCIJJ/DT * FINCIJJ * ZNCIJ.MJ * CROONCIJJ * SONCIJJ + ROGNCIJJ * SGNCIJJJ
= ZCIJ.MJ / DEN
ROWCIJJ = ROSCW * Cl.dO + CW * CPCI.JJ - 14.7d0*CPJJ / PMW SWCIJJ = CSWCIJJ + QWCIJJ + VOLCIJJ/DT x FINCIJJ x ROWNCIJJ +	* SWNCIJJJ / CVOLCIJJ/DT * FICIJJ * ROWCIJJJ
400 CONTINUE
c
DO 450 1=1, NX
DO 450 J=1,NY
IJ = CI-lDwNY + J	»
REAL12 = SNGL CPCI,J5 Z CP2)
DO 440 M=1,NCOMP
440	7CMZ) = SNGL CZCIJ.ND^
CALL GPASIM
CALL CONVERTEC XI , YI , VOCI JZ&gt;, VGCI JD , QUAL,ROOCIJD , ROGCI JZ) , CD, NCOMPZ) DO 441 M=l,NCOMP
XCIJ,MZ) = XICMZ)
441	YCU.ND = YICMZ)
IF CQUAL. EQ. O. OdOZ) GOTO 442
VCIJZ) = l.dOZ CCl.dO- QUALZJZQUAL * PMG ZPMO + 1 . dOZ) GOTO 444
442	VCI_D = O. OdO
C	*
C	So,Sg eq 28-31
C
444 IF CVCIJD . NE. O. D GOTO 446
SOCIJZ) = l.dO -SWCIJZ) GOTO 449
446 IF CVCIZD . NE.1. dOZ) GOTO 448
SOCIJZ) - O. dO
GOTO 449
448	SOCIJZ) = Cl.dO- SWCIJZ)? * Cl.dO- VCIJZ)? * ROGCIJDZC Cl.dO- VCIJ?Z&gt;
+	* ROGCIJ? + VCIJ? * ROOCIJ? 3
449	SGCIJZ) = 1. dO - SWCIJ? - SOCIJ?
ALFACIJ? = TETA*ROWCI J? «SWCIJZ) + ROOCI JZ) «SOCI JZ) + ROGC I J&gt; «SGCI JZ) FICIJ? = POR x Cl.dO+ CR * CPCI.J? - 14. 7dO*CP??
450	CONTINUE
C
C	TESTE DE CONVERGÊNCIA
C
CALL TESTECTEST,N?
WRITEC»,201? ITER,TEST
201 FORMATC* ITERACAO *,12,’ NORMA *,E10.2?
C
C • CALCULO DA TOLERÂNCIA
C
TOL = EPI
C
IF CTEST. LE.TOLZ) GOTO 500
ITER = ITER + 1 J
IF CITER. GT.ITEMÀX? GOTO 800
GOTO 200
C
500 CONTINUE
C
C CONTROLE DO INTERVALO DE TEMPO
C
C	CALL TSTEP
C	IF CIDT. EQ. 1Z) GOTO	1OO
C
C	CALCULO DO BALANÇO	DE MATERIAIS
C
CALL MATBAL
C
C	ATUALIZACAO DAS VARIAVEIS PARA O PROXIMO INTERVALO DE TEMPO
G
DO 600 1=1,NX
DO 600 J=1,NY	»
IJ = CI-1} * NY + J
PNCI,J} = PCI»JO
SONCIJD = SOCIJD
SGNCIJD = SGCIJ}
SWNCIJD = SWCIJO
ALFANCIJO = ALFACIJD
FINCIJ} = FICIJD
ROONCIJ} = ROOCIJD
ROGNCIJO = ROGCIJD
ROWNCIJD = ROWCI JO
DO 610 M=l,NCOMP
ZNCIJ,M} = ZCIJ,M}
XNCIJF.M} = XCIJ,M}	“
610	YNCIJF,ND = YCIJ,M}
600 CONTINUE
C
C	IMPRESSÃO DOS RESULTADOS
C
CUMOIL = CUMOIL + QOSG * DTZct
CUMGAS = CUMGAS + QGSC * DTZlOOOZct
DO 700 M = 1,NCOMP
700	VOLIPCM} = O. ODO
VOLIPW = 0. ODO
DO 70S IJ = l.N
AUX - VOLCIJ} M FICIJO * CROOCIJ} * SOCIJO + ROGCIJ} * SGCIJ}} VOLIPW = VOLIPW + VOLCI JO * FICIJ} * ROWCI JO * SWCIJD
DO 701 M = 1»NCOMP
701	VOLIPCM} = VOLIPCM} + AUX * ZCIJ.M}
705	CONTINUE
DO 703 M = 1,NCOMP
Qi CM} = Qi CM} + QMC1,M}*DT
703	QpCM} = QpCM} + QMCnx,M}*DT
WRITEC*.790}iter ,Q0SC, SOC1} , SOCN} , ZC1,1} , ZC1 , NCOMP} ,
+	ERROW,C ERROC M},M=1,NCOMP}
! WRITEC*,792}PCI,1}zCP,PCNx.NY}ZCP
IPRINT = IPRINT + 1
IF CI PRINT. EQ. NFL AG} THEN
IPRINT = O
WRITEC 2,705}TEMPOzCT
WRITEC2,765} QOSC,QGSCZ1OOO,CUMOIL,CUMGAS
WRI TEC 2,713}
DO 704 M=1,NCOMP
WRI TEC 2,723} M, ERROC M} , Qi CM} , QpC M} , VOLI PC MI ,VOLHIDCM}
704	CONTINUE
WRITEC2,735}ERROW,QwCI J} ,QwCI J} , VOLIPW, VOLWAT
WRITEC2,745}
DO 706 I=1» N
WRI TEC2,755}I , PCI , 1 }ZCP, SOCI} , SGCI} , SWC1} , ZCI , 1} , ZCI , 3}
706	CONTINUE
ENDIF

705	FORMATC80C’X’3,Z,20x,' Tempo Cdias3 = *,F6.0,Z3
715 formate9X ,'BALANÇO’,6X,4C'MOLES’,7X3„Z, »COMP. *,4X, ’ DE MAT. ’ , 6X, + ’INJ. ’ »8X, * PROD. ’,5X, ’IN PLACE' , 4X, ’ INICI AIS’ » Z,5C ’-* 3 , +	5C3X,9C’-*333
725 FORMATC 13,2X,5C3X,E9. 333
735 FORMATC2X, ' W’ ,2X,5C3X,E9. 33 ,ZZ3
745 formate'BLOCO PRESSÃO	SO’, 8X, ’ SG’, 8X , ’ SW’, 7X , ' ZC 13 * , 6X,
+ ’ZC33’,Z, ’---- -----------'»5C2X,'--------'33
755 FORMATCIX,I3,4X,F7.2,2x,3CF7. 4,3x33
765 FORMATC’POCO
+	Z, ’
+	//------
OLEO	GAS
C STBZD3	C MsefZD3
OLEO ACUM.
CSTB3
GAS ACUM.
CMMscf3
►
+	Z,7X,E9. 3,2X, EQ. 3,4X,E1O. 4, 4X,E9. 3,Z3
c
790	FORMATC iS,F8. 2, IX ,6CF8. 6,1X33
791	FORMATC4OF7.5,1X3
792	FORMATC2CF16. 5,1X33
793	FORMATC 40C F9.3,1X3 3
794	FORMATC4F8. 6,1X3
795	F0RMATC15,F8.2,1X,8CF8. 6,1X33
IF CTEMPO. GE. TMAX3 GOTO 800 TEMPO = TEMPO + DT
GOTO 10O
800 CLOSEC23
CLOSEC33
CLOSEC43
CLOSEC53
CLOSEC63
DO 810 I=1.3
810	WRITECw, ’C1X, Al3 ’3CHARC73
: STOP
END
n n a n n
W» ,h&lt;aaxxXxKXXXXXXXXXXXX S|JBROTI NA I NI READ XXXXXXXXXXXXXXXXXXXXXXXX LEITURA DOS DADOS E INICIALIZAÇÃO DAS VARIAVEIS
INI READ
IMPLICIT REAL*6 CA-H,K,O-Q,S-Z3
REAL** ROO,ROG,ROW,RAUX,RO,RWELL,ROSCW,ROON,ROGN,ROWN,ROOSC,ROGSC, +	ROOT , ROGI, ROWI
CHARACTERS CHARA4C153
CHARACTER*© CHARA8C253
COMMONZENTZCHARA4,CHARA8,1NTEO1,1NTE02,1NTEO3,1NTEO4C 253,
1	INTE05,1NTE06,1NTEO7,1NTE08,1NTE09,1NTE10,1NTE11C 253,
2	REAL01C 253,REAL02C 253,REAL03C 253,REALO4C 253,REAL05C 253,
3	REAL06C 253,REALO7C 253,REALQ8C 253,REAL09,REAL10,REAL11,
1
COMMON
t
REAL77 &gt; REAL78,REAL7Q»ICONV,REALXC 253,REALYC 253 ZTMSZ TOC 503 , TGC 503 , TWC 503 . TC 503 , PC 50,103 , ALFAC 503 , FI C 503 , TETA,VOLC 503,DFIA , VC 503,DELTAP ZCOMPZ ZC50,103,YC50,103,XC5O,1O3,NCOMP ZVAZZ ZPRTZ
COMMON COMMON COMMON
QWC 503 , QHC 503 , QMC 50,103 , QOC 503 , QGC 503
NDAY , ITEMAX, IPRI NT,DX,DY,XL,YL, DAYPRTC 303 , CP,CT,CQ, CD,NFLAG
IDT,DT,DPLIM,DSLIM,DPMAX,DSMAX
ZTSCZ
ZJACOBZ GC50.503
ZSATZ SOC 503 , SGC 503 , SWC 503
ZDENSZ ROOC 503,ROGC 503,ROWC 503 ZPROPIZ
ZPROP1Z
ZPROP2Z
ZPROP3Z
ZPROP4Z
ZPROPNZ
SOI , SGI , SWI »PI. FI I
TEMPO,I TER» NX,NY,N,AUXX,AUXY,KM,EPI,NTP
RAUX,PMAX,PMIN,CR,CW,POR,DZ,ROSCW,PROIND
KROC 503 , KRGC 503 , KRWC 503 »VOC 503 , VGC 503 , VI SW, NK
TMAX, TK, DTMAX , QOMIN, QOMAX , QOSC, QGSC
SONC 503 , SGNC6O3 , SWNC503 , PNC5O,1O3 , ZNC50, lOb ,
ZPERMZ SSC 203 , KKOWC 203 , KKWC 203 , KKGC 203 , KKOGC 203 , KROWI
ZMOLZ PMC 103,PMO,PMW ,PMG
ZMATBZ EPROC103„ERROW tERROCC103,ERROCW,ERTOT,VOLINI
ZPWZ PWELLC 503,DTN,CUMOIL,CUMGAS ,GASINJ
ZPRT2Z VOLHIDC 103 ,VOLIPC 103 , Qi C103 , QpC103,VOLIPW,VOLWAT
COMMON
COMMON
COMMON
COMMON
COMMON
COMMON
COMMON
COMMON
COMMON
COMMON
+ XNC 50,103 ,YNC 50,103,ROONC 503,ROGNC 503,ROWNC 503,ALFANC 503,FINC 503 COMMON
COMMON
COMMON
COMMON
COMMON
DIMENSION XIC103,YIC103,ZIC103,ROSCC103,XXC503
c
c
c
READCI,153 XL, YL,DZ,POR,PI,SOI,SGI,SWI,KX,KY,CR,CW,RWELL,PMAX, +	PMIN,QOMAX,QOMIN,DPLIM,DSLIM,DTMAX,TMAX,DT,TK,EPI ,
+	epi 2,SWC,ROSCW,DELTAP,PMW,VI SW,RE
READC1,253 NX,NY,ITEMAX,NPRO, NI N J,NFLAG,NDAY,NK,NCOMP,MODELO, +	NTP
7
10
EPI AUX = O.OdO
DO 10 1=1 ,NINJ
READC1,353 NI,N2 ni = CN1-13»NY+N2 READC1,S53QWC NI3 do 7 L=1.NCOMP
r eadC 1,953 QMC ni , L3
EPI AUX = EPIAUX + QMCni,L3 continue continue
EPIAUX = EPIAUX + QWCni3 EPI = EPI * EPIAUX if Cepi . eq. O. OdO3 epi = epi 2 READC1,53
c
•DO 12 1=1,NPRO
READCI,853 NI , N2, QOCC NI-13«NY+N23 CONTINUE
.READCI,53
DO 20 J=l,NCOMP
READC 1,453 ZIC J3 ,PMC J3 , INTE11C J3
PMCJ3 = PMCJ3 Z 1OOO. dO
CONTINUE
C
uuu
READCI ,33
READCI,553 CDAYPRTC13,I=1,NDAY3
READCI,53
READCI ,653 CSSC13 ,KKOWCI3 &gt;KKWC13 , KKGCI3 , KKOGC13,1 =1 ,NK3
CALL INTERPC SS,KKOW,NK,C1. dO- SWC3,KROWI3
RE ADC 1,53
READC1,753 INTE01,1NTE02.INTE03,1NTEO5,1NTE06»INTE07,1NTE08, +	INTE09,INTE1O,REAL09,REAL1O,REAL11,REAL12,REAL13,
+	REAL14,REAL13
•INICIALIZACAO DAS VARIAVEIS
INTE05 = NCOMP
CQ = 1.84013D-06
CP = 6894.757dO
CT = 86400.dO
CD = 16.01846d0
VISW = VISW * O.OOldO	'
PMW = PMW ZlOOO.dO
DT = DT * CT
TMAX = TMAX * CT
TEMPO = DT
DO 22 I=1,NDAY
22	DAYPRTC 13 = DAYPRTCI3 * CT
NDAY = 1
IPRINT = 0
PI = PI * CP
DELTAP = DELTAP * CP
DPLIM=DPLIM * CP
PMAX = PMAX * CP
PMIN = PMIN * CP
CR = CP Z CP
CW = CW Z CP
DX = XLZNX
DY = YLzNY
XXE = DLOGCRE3
XXW = DLOGCRWELL3
DXX = CXXE - XXW3ZNX
'DO 26 1=1,NX+1
26	XXCI3	= XXW + CI-13 * DXX
CUMOIL = O.dO
CUMGAS = O.dO
GASINJ = O. dO
ERROW = O. dO
DO 33 M=1.NCOMP
33	EP.ROCCM3 = O.dO
KX = XX * 1.D-1S
KY = KY * 1 . D-l 5
KM=DSQRTCKX*KY3
IF ¿MODELO. NE. 03 THEN
AUXX = KX * DY * DZ Z DX
AUXY = KY » DX * DZ Z DY
ELSE
AUXX = 2 * 3.14159D0 * KX * DZ Z DXX
AUXY = O. ODO
RAUX = DLOGC ROZRWELL3	&gt;
PROIND = 2. dO * 3.1416d0 * KM * DZ Z RAUX
31	TETA = 0.15d0
FII = POR * Cl.dO+ CR * CPI - 14.7dO*CP33
ROWI = ROSCW «Cl.dO + CW * CPI - 14.7dO*CP31 z PMW
REALO9 = SNGLCTTO
REAL12 = SNGLCPIZCP3
DO 34 I = 1 .NCOMP
34	REAL17CI5 = SNGLCZICI53
C
CALL GPASIM
CALL CONVERTE CXI,YI.VISO,VISG.QUAL.ROOI.ROGI,CD»NCOMP3 IF CQUAL. EQ. O. OdO5 GOTO 36
VINI = l.dOZ CCl.dO- QUAL3ZQUAL * PMG ZPMO + 1. d03 GOTO 38
36 VINI = O.OdO
38 SOI = Cl.dO- SWID * Cl.dO- VI NI 3 * ROGIZC Cl.dO- VINI?
+	* ROGI + VINI * ROOI 5
SGI = 1. dO - SWI - SOI
ALFAI = TETA*ROWI«SWI + ROOI «SOI + ROGI «SGI
VOLWAT = O. ODO
VOLINI = O.ODO
DO 40 M=1.NCOMP
40	VOLHIDCM5 - O.ODO
C
C	INICIALICAZAO DAS PROPRIEDADES DA GRADE
C
DO 50 I=1»NX
DO 50 J=1»NY IJ = CI-15MNY + J IF CMODELO. EQ. 05 THEN
VOLCIJD = 3.14159D0 * DZ « C DEXP C 2«XXCIJ+13 5 -+	DEXPC 2MXXCIJ5 3 5
ELsE
VOLCIJ5 = DX*DY*DZ
í ENDIF
AUX = VOLCIJ3 « FII * CROOI x SOI + ROGI « SGI3 VOLWAT * VOLWAT * V0LCIJ5 * FII * CROWI * SWI 3 VOLINI = VOLINI + AUX + VOLWAT
DO 44 M=1 , NCOMP
44	V0LHIDCM3 = VOLHIDCM5 + AUX * ZICM3
rei»J3 = pi
PNCI.JD = PI
t-wELLCIJ3 = PMAX
SOCIJ5 = SOI
SGCIJ5 = SGI
SWCIJ5 = SWI
XONCIJ3 = SOI
SGNCIJ3 = SGI
SWNCIJD = SWI
ROONCIJD - ROOI
ROGNCIJ3 = ROGI
ROWNCIJ3 = ROWI
ROOCIJ3 = ROOI
ROGCIJ5 = ROGI
ROWCIJ5 = ROWI
VOCIJ3 = VISO
VGCIJ5 = VISG
VCIJ5 = VI NI
ALFACIJ5 = ALFAI
FICIJ5 = FII
ALFANCIJ5 = ALFAI
FINCIJ5 = FII
QHCIJ3 = O. OdO
DO 48 M=1 , NCCMP
ZNCIJ.M5 = ZICM3
ZCIJ.hD = ZICM5
XNCIJ,M5 = XICM5
YNCIJ.M5 = YICM5
48	OHCIJ5 = QHCIJ5 + QMCIJ.M5
QWCIJ5 = QWCIJ5 * CQ * ROSCW Z PMW
QOC1J5 = QOCIJ5 * CQ
50 CONTINUE
»
5	FORMATCZ5
IS FORMATCZZZ, 31C13X , FIO. O, Z55
85 FORMATC11C15X»I3»ZD,/5
85 FORMAÍ(_2CaX,I255
45 FORMATC3C 2X,F10.03,2X ,135
55 FORMATCSX. F10. 05
65 FORMATC SC 2X , F10. 05 5
75 FORMATC9C15X , 13, Z5,7C15X,FIO. O,Z55
BS FORMATC2C2X, 125 , C2X , FIO. 055
95 formatC2X»FIO. 05
RETURN
END
C
C KxxifMxxMKXXKitxxiofKXKMXx SUBROTTNA I NI PRINT xxxkxxxxxxxxkxxxxxxxxxxx C	PRINT DATA
C
SUBROUTINE INIPRINT
IMPLICIT REALMS CA-H,K,O-Q,S-Z5
REALES ROO,ROG,ROW,RAUX,RO,RWELL»ROSCW,ROON,ROGN&gt;ROWN,ROOSC,ROGSC, s+	ROOI, ROGI , ROWI
COMMON ZVAZZ QWC 505 , OHC 305 , QMC 50,105 , QOC505 , QGC 505
COMMON ZPRTZ NDAY,ITEMAX,IPRINT,DX,DY,XL,YL,DAYPRTC3O5,
+	CP,CT, CQ,.CD. NFLAG
COMMON ZPROPIz SOI,SGI,SWI, PI , FI I
COMMON ZPROP1Z TEMPO,ITER,NX, NY, N, AUXX, AUXY, KM, EPI, NIP
COMMON ZPR0P2Z RAUX,PMAX,PMIN,CR,CW,POR,DZ,ROSCW,PROIND
C
SKIN=O.dO
PC=O.dO
WRITEC2,155
WRI TEC2.253XL,YL,DZ,PP.QOMAX,QOMIN,PMIN,DSLIM,DPLIM,CR,CW,FII, +	RWELL,SKIN, PC, SGI , SOI , SWI ,CKX*1. Dl 55 ,CKY*1. Dl 55
FORMATCZZZZZ,3X,60C ’*‘5,2Cz,3X, &gt;*' , 58C *	‘5 , '*’5,Z,3X,
+ ’*	SIMULACAO DE RESERVATÓRIOS	-	,
+ Z,3X,,5SC* ’5,,Z.3X,
+ ’*	TESE	m’,
+ 2CZ.3X,	, 58C ’ ’5,’*’5,z,3X,
1O1
+
+
»
4-
’ ’3 » ’X’} »Z,3X,
O.’x’,Z.3X.
TRI-FASICO
if*
Z,3X, *x* , 58C ’
’ x
2CZ.3X.’x’,58C
FORMATC 5X„ ’DADOS INI Cl AIS ‘DIMENSÃO - COMPRIMENTO.
LARGURA.....
PROFUNDIDADE
’PRESSÃO INICIAL DO RESERVATÓRIO. . . ‘MAXIMA ’MINIMA ‘MINIMA •MAXIMA
DENIS JOSE SCHIOZER
JUNHO
’ ’3 , ‘x’3 »Z»3X,60C ’x’3 .ZZZZZ3
’tZZ,3Xt
4-
’MAXIMA
*
it*
»
*
&gt;
»
*
1980	X*
»F7.0,‘	m’,Z,3X,
»F7.O,’	m‘ ,Z,3X,
,F7.0»’	m’ »Z» 3X ,
»F7. 0, ‘	Pa’,Z,3X,
»F7.0, ’	’,z,3X
,F7.0,’	’»Z,3X
»F7.0, ‘	Pa’» z, 3X, .
1
»F7.2»Z»3X&gt;
4-
4-
PRODUÇÃO DE OLEO................
PRODUÇÃO DE OLEO. ..............
PRESSÃO NO POCO.................
VARI ACAO DE SATURACAO NO ’»Z»3X» INTERVALO DE TEMPO..............
VARIACAO DE PRESSÃO NO ’,Z,3X» INTERVALO
’COMPRESSIBI LIDADE * COMPRESSIBILIDADE ‘POROSIDADE A 14.7 ‘RAIO DO POCO....
’SKIN ...........
’PRESSÃO CAPILAR. . ‘SATURACAO DE GAS INICIAL. ’SATURACAO DE OLEO INICIAL ’SATURACAO DE AGUA INICIAL ’PERMEABILIDADE DIRECAO. . . ’	DIRETIO. ..
DA DA psi
DE TEMPO ROCHA. . .
AGUA. . . . .
Pa* izPa
»Z,3X&gt; ‘»Z,3X, IzPa’»Z&gt;3X,
,F7.O*’	!
»F7. 0,‘ ,F7.0»‘ »F7. 2,Z,2x,
»F7. 2, ’ m’ »Z,3x»
,F7. O./^x.
»F7.0»‘ Pa’,Z,3x,
»F7.2,Z»3x»
»F7. 2, Zt 3x,
»F7.2,Z»3x, »F7.0,’ »F7.0»’
md’,/t3x, md’t/fâx.
+
+
+
+
23 ;
+
+
+
+
+

+
+
+


►
►



&gt;
&gt;

►


►
&gt;
&gt;

»
»
»
■ 2CZ33 RETURN END
uuuuu
XKXKKXXKXKXXK^txxxxxxxx SUBROTI NA TRANS xxxxxx*xx*xxx*xxxxxxxxx*xx
CALCULA AS TRANSMI SSI VIDADES
SUBROUTINE TRANSCrO
C
IMPLICIT REALX8 CA-H»K»O-QtS-Z3
REALxfi ROO,ROG,ROW,RAUX ,RO,RWELL»ROSCW,ROON,ROGN,ROWN,ROOSC»ROGSC, +	ROOI , ROGI . ROWI .
CHARACTERX4 CHARA4C153
CHARACTERS CH AR A8C 25 3
COMMON ZTMSZ TOC 503,TGC 503,TWC 503,TC 503,PC 50,103,ÀLFAC 503,FIC 503t +	TETA„VOLC 503 »DFIA»VC 503,DELTAP‘
COMMON ZSATZ SOC503,SGC503,SWC303
COMMON ZDENSZ ROOC 503 , ROGC 503 » ROWC 503
COMMON ZPROP3Z KROC503»KRGC503,KRWC503»VOC503»VGC503,VISW,NK
COMMON ZPROP4Z TMAX,TK,DTMAX,QOMIN.QOMAX,QOSC»QGSC
COMMON ZPROPNZ SONC5O3,SGNC303&gt;SWNC503,PNC5O,103,ZNC50»103&gt;
+ XNC 50,103» YNC 50,103»ROONC 503,ROGNC 503 » ROWNC 503,ALFANC503,FINC 503
COMMON ZPERMZ SSC2O3»KKOWC203,KKWC203,KKGC203»KKOGC2O3»KROWI
C
DO 10 I =1 , N
CALL PERELCI?
IF CSOCI?. EQ. O. ODO? THEN
TOC 15 = O. ODO
ELSE
TOCI? = KROCI? * ROOCI? Z VOCI? ENDIF
IF CSGCI ? . EQ. O. ODO? THEN
TGCI? = O. ODO
ELSE
TGCI? = KRGCI? * ROGCI? Z VGCI? ENDIF
TWCI? = ¡CRWCI? * ROWCI? Z VISW
10	TCI? = TOCI? + TGCI? + TETA*TWCI?
RETURN
END
n n o q r? n n
xx-xx***** SUBROTI NA CALCULO xxxxxxxx CALCULA O JACOBI ANO E A FUNCAO “ F "
PARA A RTESOLUCAO DA EQUACAO DA PRESSAO
SUBROUTINE CALCULO
IMPLICIT REALS C A-H, K, 0-Q, S-Z?
REALS ROO,ROG,ROW,RAUX,RO,RWELL,ROSCW,ROON,ROGN,ROWN,ROOSC,ROGSC +	ROOT , ROGI , ROWI
CHARACTERS CHARA4C15?
CHARACTERS CHARA8C25?
COMMONzENTzCHARA4,CHARA8,INTEO1,1NTE02,1NTE03,1NTEO4C 25?,
1	INTEO5,INTE08,INTE07,INTE08,INTEO9,INTE1O,INTE11C25?,
2	REAL01C 25?,REALO2C25? » REALO3C 25?,REAL04C 25?,REALO5C 25?
3	REAL06C 25?,REAL07C 25?,REAL08C 25?,REALO9,REAL10,REAL11,
4	REAL12,REAL!3,REAL14,REAL15,REAL! 6,REAL17C 25?
COMMONzSAIZlNTE12,REAL71,REAL72,REAL73,REAL74,REAL75,REAL76
1
COMMON
REAL77,REAL78,REAL79,1CONV.REALXC 25?,REALYC25? ZTMSZ TOC SO? , TGC 50? , TWC 50? , TC 50? , PC 50,10? , AL FAC 50? , FI C 50? .
TETA,VOLC 50?,DFIA,VC 50?,DELTAP
ZCOMPZ ZC 50.10? , YC 50,10? , XC 50,10? ,NCOMP ZCONVz FC 50?
ZVAZz
ZPRTZ
COMMON
COMMON
i COMMON
COMMON
+
COMMON
COMMON
COMMON
COMMON
COMMON
COMMON
COMMON
+ XNC 50,10?,YNC 50,10?,ROONC 50?,ROGNC 50?,ROWNC 50?,ALFANC50?,FINC 50?
QWC5O? ,QHC50? ,Q¡MC50,10? ,QOC5O? »QGC50?
NDAY,ITEMAX11PRINT,DX,DY»XL,YL,DAYPRTC 30?, CP,CT,CQ,CD,NFLAG
IDT, DT, DPLIM, DSLIM. DPMAX, DSMAX
ZTSC/
ZJACO8Z GC50,50?
ZSATZ SOC50?,SGC50?,SWC50?
ZDENSZ ROOC50?,ROGC3O?,ROWC50?
ZPROP1Z TEMPO,ITER.NX,NY,N»AUXX,AUXY.KM.EPI,NTP
ZPROP2Z RAUX,PMAX,PHIN,CR,CW,POR,DZ,ROSCW,PROIND ZPROPNZ SONC 50?»SGNC 50?,SWNC 50?,PNC 50,10?,ZNC 50,10?,
COMMON COMMON COMMON COMMON
ZPROP3Z KROC 50?,KRGC 50? tKRWC 50?,VOC 50?,VGC 50? , VISW.NK
ZPROP4Z TMAX,TK,DTMAX,QOMIN,QOMAX,QOSC,QGSC
ZPERMZ SSC20?,KKOWC20?,KKWC 20?„KRGC 20? , KKOGC2O?,KROWI ZPWZ PWELLC 50? &gt;DTN,CUMOIL ,CUMGAS,GASINJ
F -&gt; FUNCAO DA PRESSAO
C	G -&gt; JACOBIANO
C	CALCULO DOS TERMOS DE FLUXO
C
DO 300 I=1,NX
DO 300 J=1,NY
IJ=CI-1?*NY + J	►
IF Cl.NE.1? GOTO 20
FCIJ? = O.OdO
GCIJ,I J? = O.OdO
GOTO 40
20 AUX = PC 1-1,1? - PCI,J?
IF C AUX. LE. 0. dO? GOTO 30
C
FCIJ? = -AUX * TCIJ-NY? * AUXX GCIJ.IJ? = - TCIJ-NY? * AUXX GCIJ.IJ-NY? = TCIJ-NY? * AUXX GOTO 40
30 FCIJ? = -AUX * TCIJ? * AUXX
GCIJ,IJ? = - TCIJ? * AUXX GCIJ,IJ-NY? = TCIJ? * AUXX
C
40 IF CI.EQ. NX? GOTO 60
AUX = PCI+1..D - PCI.J?
IF CAUX.LE.O. ? GOTO 50
FCIJ? = FCIJ? - AUX * TCIJ+NY? * AUXX GCIJ.IJ? = GCIJ.IJ? - TCIJ+NY? * AUXX GCIJ.IJ+NY? = GCIJ,IJ+NY? + TCIJ+NY? * AUXX GOTO 60
50 FCIJ? = FCIJ? - AUX » TCIJ? * AUXX GCIJ.IJ? = GCIJjIJ? - TCIJ? * AUXX GCIJ.IJ+NY? = GCIJ.IJ+NY? + TCIJ? * AUXX
C
60 IF CJ.EQ. 1? GOTO 80
AUX = PCI.J-1? - PCI.J?
IF C AUX. LE. O. dO? GOTO 70
FCIJ? = FCIJ? - AUX * TCIJ-1? * AUXY GCIJ.IJ? = GCIJ.IJ? - TCIJ-1? m AUXY GCIJ.IJ-1? = GCIJ.IJ-l? + TCIJ —1? * AUXY GOTO 80
70 FCIJ? = FCIJ? - AUX x TCIJ? * AUXY ! GCIJ.IJ? = GCIJ.IJ? - TCIJ? * AUXY
GCIJ.IJ-1? = GCIJ.IJ-1? + TCIJ? * AUXY
C
80 IF CJ.EQ. NY? GOTO 1OO
AUX = PCI.J+1? - PCI.J?
IF C AUX. LE. O. dO? GOTO 90
FCIJ?- = FCIJ? - AUX * TCIJ+1? * AUXY GC i i.IJ? - GCIJ.IJ? - TCIJ +11 x AUXY GCIJ.IJ+l? = GCIJ.IJ+1? + TCIJ+1? * AUXY GOiu 1OO
WO FCIJ? = FCIJ? - AUX * TCIJ? * AUXY GCIJ.IJ? = GCIJ.IJ? - TCIJ? * AUXY GCIJ.IJ+1? = GCIJ.IJ+1? + TCIJ? x AUXY
C
1OO CONTINUE
C
C CALCULO DE ,'FM E DAS DERIVADAS PARA O JACOBIANO C	TERMOS DE FONTE E ACUMULACAO
104
c
IF CQOCIJ? . EQ. O. dO? GOTO 150
CALL VAZAO CIJ »I» J »DQH?
150 FCIJ? = FCIJ? - TETAxQWCIJ? - QHCIJ? + VOLCID/üT * CFICIJ? * +	ALFACIJ? - FINCIJ? * ALFANCIJ??
DQW = 0.OdO	&gt;
C DQH = O. OdO
REAL13 = SNGLCCPCI.J? + DELTAP? Z CP?
DO SOO M - 1»NCOMP
SOO	REAL17CM? = SNGLC ZCIJ , M? ?
CALL GPASIM
CALL CONVERTE CXI,YI&gt;VISO»VISG&gt;DV,DROO,DROG,CD,NCOMP?
IF C DV. EQ. O. OdO? GOTO 310
DV - l.dOZ CCl.dO- DV?ZDV * PMG ZPMO + 1. dO?
GOTO 220
210 DV = O. OdO
220 DROO - CDROO - ROOCIJ?? Z DELTAP
DROG = CDROG - ROGCIJ?? Z DELTAP
DROW = CW * ROSCW
DV = CDV - VCIJ?? Z DELTAP
DFI = CR * POR
daux = CROGCIJ? + VCIJ? * CROOCIJ? - ROGCIJ???
if Cdaux. EQ. O. ODO? THEN
DALFA = O. ODO
ELSE
DALFA = TETA * SWCIJ? * DROW + C DROO * ROGCIJ?**2 + VCIJ? * +	CROOCIJ?**2 * DROG - ROGCIJ?**2 * DROO? - DV * ROOCIJ? *
+	ROGCIJ? * CROOCIJ? - ROGCIJ?? ? * Cl.dO - SWCIJ?? Z daux
endi f
DFIA = DFI * ALFACIJ? + FICIJ? * DALFA
GCIJ.IJ? = GCIJ.IJ? + TETA * DQW + DQH - VOLCIJ? * DFIA Z DT DQH = O. OdO DQW = O. OdO
200 CONTINUE
RETURN
END
*********************** SUBROTINA TESTE ************************* :	TESTE DE CONVERGENCIA
TEST - NORMA
SUBROUTINE TESTE CTEST.N?
IMPLICIT REALES C A-H,K,0-Q, S-Z?
COMMON zCONVz FC50?
TEST=0. dO
DO 10 I =1 . N
TEST=TEST+FCI? **2
10 CONTINUE
TEST=DSQRTC TEST?
RETURN
END
o n o o	.. n n n n n n
SUBROTINA THOMAS
RESOLUÇÃO DO SISTEMA TRI-DIAGONAL
SUBROUTINE THOMASCN, a, b, x3
IMPLICIT REALMS CA~H»K,O-Q,S-Z3
DIMENSI ON xC 503 , aaC 503,bbC 503 , ccC 503,qqC 503 , ggC 503 +	,bC503,aC50.503
do 3 i J =1 , n
aaCiJ3=aCiJ,iJ3
if Cij.ne.n3 bbC i J3 =aC i j , i j +13
if Cij.ne.13 ccdJ3=aCi j ,ij-13
3	continue
wi = aaC13
ggC 13 =bC 13 Zwi
do 1 i =2, n
qqC i -1 3 =bbC i -13 Zwi
wi =aaC i 3 -ccC i 3 *qqC i -13
1	ggC i 3 —C bC i 3 -ecC i 3 *ggC i -13 3 Zwi
xCn3 =ggCn3
do 2 i =2,n
J~n-i +1
2	xC j 3 =ggC j 3 -qqC j 3 *xC j +13
return
end
U'JUUU
SOLUCAO DE SISTEMA DE EQUACOES COM MATRIZ DE BANDA SEM
PIVOTAMENTO - AZIZ &amp;amp; SETTARI - PAGINA 444
SUBROUTT NE GB ANDC A „ D, X , N, M, EPS, I ERR»IFRST3
IMPLICIT REALMS CA-H.K,O-Q,S-Z3
REALMS ROO,ROG,ROW,RAUX,RO,RWELL,ROSCW,ROON &gt;ROGN»ROWN,ROOSC» ROGSC , +	2001 , ROGI , ROWI
DIMENSION AC13 ,DC13 ,XC13
IERR = O
J = 1
DO IO 1=1 ,N
IE = M
IF CI+M-N3 21,21,22
22	IE = N - I
21 IEAUX = M
IF CI-M3 23,23,24
23	IEAUX = I
24	' IE1 = IE + IEAUX
MBIG = IE
JI = J + IE1
J2 = JI
IF CIFRST. GT. 03 GOTO 27
TF ^DABSCACJ33 - EPE3 25,25,27
23 I:	-■ IERR + 1
rtf i * i'iBIG3 10,10,26
EC DC CO J0=1,MBIG
S	- ^J13ZACJ3
lb&amp;lt;_ j. r'RST. GT. 03 GOTO 35
LO -fU LK=1,MBIG
75- - JI + LK
JK - J + LK
30 ACJ1K3 = ACJ1K3 - ACJK3*S
35	CONTINUE
IAUX = JO + I
DC I AUX 3 = DC I AUX 3 - DCI3*S
106
IE = M
IFCIAUX+M-N1 31,31,32
32	IE = N - I AUX
31 IEAUX = M
IFCIAUX-M3 23,33,34
33	IEAUX = I AUX	‘
34	IE1 = IE + IEAUX
20 JI = JI + IE1
10 J - J2 + 1
J = J - M - 1
NP1 = N + 1
DO 40 IINV=1,N
I = NPi - IINV
IE = M
IF ri+M-hD 41,41,42
42	IE = N - I
41 MBI^ -IE
XCI1 = DCI1
IF lMBIGI 44,44,43
43	DO 50 LK=1,MBIG
IK -	I+LK
JK =	J+LK
50	XCI1	= XCI1	-	XCIK1*ACJK1
44	XCI1	= XCI1ZACJ1
IE =	M
IF CI+M-NP11 51,51,52
52	IE = NPi - I
51	IEAUX = M
IFCI-1-M3 53,53,54
53	IEAUX =1-1
54	IE1 = IE + IEAUX
J = J - IE1 -1
40 CONTINUE
RETURN
END
C
C xxyyyxxxxxxxxxxKxyyyMxx SUBROTI NA	PEREL xxxxxxx-oxxxxxxxxxxmwt
C	CALCULA PERMEABILI DADES RELATIVAS
C
■SUBROUTINE PERELCIJ1
IMPLICIT REALMS C A-H, K, O-Q, S-2D
REALMS ROO,ROG,ROW,RAUX,RO,RWELL,ROSCW,ROON,ROGN,ROWN,ROOSC,ROGSC, +	ROOT , ROGI . ROWI ■
COMMON ZSATZ SOC503,SGC501,SWC501
COMMON ZDENSZ ROOC50J,ROGC501»ROWC50J
COMMON ZPROP3Z KROC5O1 , KRGC 301, KRWC 501 , V0C501, VGC 501 , VISW, NK
COMMON ZPROPNZ SONC 501 , SGNC 501 , SWNC 501 , PNC 50', 101 , ZNC 50,101,
+ XNC 50,101,YNC 50,101,ROONC 501,ROGNC 501,ROWNC 501,ALFANC 501,FINC 501 COMMON zPERMZ SSC 201,KKOWC 201,KKWC 201,KKGC 201,KKOGC 201,KROWI
C DO 1O0 IJ=1,N
C	IF CCSOCIJ1. EQ. SONCI Jll. AND. CSGCIJ1. EQ. SGNCIJ111 GOTOIOO
SH = 1. dO - SWCIJ1
SL = l.dO - SGCI JI
CALL INTERPCSS,KKOW,NK,SH,KROWI
CALL INTERPC SS,KKW,NK,SWCI JI,KRWCI JI1
CALL INTERPCSS,KKG,NK,SGCIJI,KRGCIJll
CALL INTERPCSS,KKOG»NK,SL,KROG1
107
CALL INTERPCSS, KKOW, NK, SOCI J3 , KROW3	*
KROCIJ3 - KROW + KROG ~ KROWI + SL * C KROWI - AUXK3 *
+	CKROWI - KROG3 Z KROWI
IF CKROCI J3 . GT. 1. d03 KROCIJ3 = 1. dO
100 CONTIHUE
RETURN
END
U'J'JU'JCUU'J'J	UUUl
SUBROTI NA INTERP	xxxx x xxx x k x x-x x xxx x x xxx
INTERPOLACAO	LI NEAR
X	vetor i ndependente
Y	vetores dependentes
N	numero máximo de valores	de	X
XX	argumento
YY	valores das funcoes	irrterpol adas
SUBROUTINE INTERP CX, Y , N ,XX »YY3
IMPLICIT REALES CA-H,K,O-Q.S-Z3
REALES ROO, ROG,ROW,RAUX ,RO, RWELL tROSCW,ROON,ROGN,ROWN,ROOSC.ROGSC ,
+	ROOT, ROGI,ROWI
DIMENSION XC 203.YC 203
IF CXX.GT. XCN3 3 GOTO 98
IF CXX.LT.XC133 GOTO 99
1=1
30 I =1 +1
IF CXX.GT. XCI33 GOTO 30
YL = CYCI3-YCI-133ZCXCI3-XCI-133
YY = YCI-13 + CXX-XCI-133 w YL
RETURN
98	YY=YCN3
RETURN
99	YY=YC13
RETURN
END
XXXXXXXXXXXMXXXKXXXXXX SUBROTINA CONVERTE xxxxxxxxxxxxxxxxxxxxxxxx
CONVERCAO DE VARIAVEIS E UNIDADES DO GPASIM
SUBROUTINE CONVERTE CX,Y,VISO,VISG,QUAL,DENSO,DENSG,CD,NCOMP3
IMPLICIT REALES CA-H,K,O-Q,S-Z3
^REALMS ROO,ROG,ROW,RAUX,RO,RWELL,ROSCW,ROON,RO6N,ROWN,ROOSC,ROGSC, +'	ROOI , ROGI , ROWI
■ COMMONzSAIZlNTE12,REAL71,REAL72,REAL73,REAL74,REAL75,REAL76,
1	REAL77,REAL7B,REAL79,1CONV,REALXC 253,REALYC 253
COMMON ZMOLZ PMC1O3,PMO,PMW,PMG
DIMENSION XC103,YClO3
VISO = DBLECREAL743 * 0.001 dO
VISG = DBLECREAL753 * O.OOldO
QUAL = DBLECREAL763
PMO = 0. OdO
PMG = 0. OdO
DO IO I=1,NCOMP
XCI3 - DBLECREALXCI33
YCI3 = DBLECREALYCI33 PMO = PMO + XCI3 * PMCI3
10 PMG = PMG + YCI3 * PMCI3 IF CPMO. NE. O. OdO3 GOTO 20 DENSO = O.OdO
GOTO 30
20 DENSO = DBLECREAL783 * CD Z PMO IF CPMG. NE. O. Od03 GOTO 30
DENSG = 0. dO
GOTO 40
30 DENSG = DBLECREAL793 x CD Z PMG 40 CONTINUE
RETURN
END
non n
COMMON
SU8ROTINA MATBAL BALANCO DE MATERIAIS

SUBROUTINE MATBAL
IMPLICIT REaL*8 CA-H,K,O-Q,S-Z3 REAL*8
ROO.ROG &gt; ROW,RAUX.RO, RWELL,ROSCW tROON,ROGN»ROWN,ROOSC,ROGSC, ROOI , ROGI t ROWI
ZTMSZ TOC 503 &gt; TGC 305,TWC 503 , TC 503 , PC SO,103 ,ALEAC 503 , FIC 503 , TETA , VOLC 503,DFIA,VC 503,DELTAP
ZCOMFZ ZC5O,103,YC50,103,XC50,103,NCOMP
ZVAZZ QWC503 ,QHC5O3 ,QMC5O,1O3 ,Q0C503 ,QGC503
ZTSCZ IDT, DT, DPLIM, DSLIM,DPMAX,DSMAX
ZSATZ SOC 503 , SGC 503 , SWC 503
ZDENSZ ROOC 503 ,ROGC 503,ROWC 503
ZPROPIZ SOI ,SGI ,SWI ,PI ,FII
ZPROP1Z TEMPO,ITER, NX, NY, N,AUXX,AUXY,KM.EPI,NTP
ZPWZ PWELLC 503,DTN,CUMOIL,CUMGAS,GASINJ
ZPROPNZ SONC 503,SGNC 503,SWNC 503„PNC 50,103,ZNC 50,103,

10
SO
100
150
LuUl’AJ’JUJl
COMMON
COMMON
COMMON
COMMON
COMMON
COMMON
COMMON
COMMON
+ XNC 50,103,YNC 50,103,ROONC 503,ROGNC503.ROWNC 503,ALF ANC 503, FI NC 503 COMMON ZMOLZ PMC103,PMO,PMW,PMG
COMMON ZMATBZ ERROC1O3,ERROW,ERROCC1O3,ERROCW,ERTOT,VOLINI ERROW - O.dO
DO 10 M=l,NCOMP
ERROCM3 = O.dO
: DO 100 1=1 ,N
ERROW = ERROW + V0LCI3 * CFICI3 * ROWCI3 * SWCI3 - FINCI3 « ROWNCI3 * SWNCI33 + QWCI3 * DT
DO 50 M=1,NCOMP
ERROCMD = ERROCM3 + VOLC 13
ROGCI3 « SGC13 *
SONCI3 * XNCI ,M3
QMCI ,M3 * DT
CONIT NUE
CONTINUE
ERROW = ERROW Z VOLINI
ERROCW = ERROCW + ERROW
DO 150 M = 1,NCOMP
ERROCM3 = ERROCM3 Z
ERROCCM3 = ERROCCM3
CONTINUE
RETURN
END
* CFICI3 * CROOCI3 * SOC13 * XCI.M3 +
YCI.M33 - FINCI3 * CROONCI3 *
+ ROGNCX3 * SGNCI3 * YNCI.M333 +
VOLINI + ERROCM3
+
+
+
uuuu
SUBROUTINE VAZAO CIJ,I,J,DQH3
IMPLICIT REALES C A H, K, 0 -Q, S-Z3
REÀL*8 ROO, ROG, ROW, RAUX , RO, RWELL, ROSCW, ROON, ROGN, ROWN» ROOSC, ROGSC, +	ROOI , ROGI , ROWI
CHARACTER*! CHAPA1C153
CHARACTER*8 CHARA8C253
COMMONZENTZCHARA4,CHARAB,INTE01,1NTE02,1NTE03,1NTE04C 253 »
1	INTE05,1NTE06,INTEO7,1NTE08,1NTE09,1NTE10,1NTE11C 253,
2	REAL01C 253,PEAL03C 253,REAL02C 353,REAL04C 253,REAL05C 353,
3	REAL06C 253,REAL07C 253,REAL08C 253,REAL09,REAL10,REAL11,
4	REAL13,REAL13,REAL14,REAL15 &gt; REAL16,REAL17C 353
COMMONZSAIZINTE12,REAL71,REAL72,REAL73,REAL74,REAL75,REAL76,
1
COMMON
+
COMMON
COMMON
COMMON
+
COMMON
COMMON
COMMON
COMMON
COMMON
COMMON
COMMON
COMMON
+ XNC 50,103,YNC 50,103,ROONC 503,ROGNC 503,ROWNC 503,ALFANC 503,FINC 503
COMMON ZPERMZ SSC 203,KKOWC203,KKWC 203,KKGC 203,KKOGC 203 &gt;KROWI COMMON ZMOLZ PMC103,PMO,PMW,PMG
DIMENSION XSCC1O3,YSCC1O3
REAL77,REAL78,REAL7Ô,ICONV,REALXC 353,REALYC 253
ZTMSZ TOC 503,TGC 503,TWC 503.TC 503,PC 50,103,ALFAC 503{PIC 503, TETA,VOLC 503,DFIA,VC 503,DELTAP
zCOMPZ ZC50,103 , YC 50,103 , XC 50,103 ,NCOMP ZVAZZ
ZPRTZ
QWC5O3 .QHC3O3 ,QMC5O,1O3 ,QQC5O3 .QQC5O3
NDAY,ITEMAX, IPRI NT, DX , DY , XL, YL,DAYPRTC 303, CP,CT,CQ,CD,NFLAG
SOC 503 , SGC 503 , SWC 503
TEMPO,ITER,NX,NY,N,AUXX,AUXY,KM,EPI,NTP
RAUX» PMAX, PMIN, CR, CW,POR,DZ,ROSCW,PROIND
KROC 503,KRGC 503,KRWC 503,VOC 503.VGC 503, VISW, NK TMAX,TK,DTMAX,QOMIN,QOMÁX,QOSC,QGSC
zSATz
ZDENSZ ROOC 503,ROGC 503,ROWC 503
ZPROP1/
ZPROP2Z
ZPR0P3Z
ZPROP4Z
ZPWZ PWELLC 503,DTN,CUMOIL,CUMGAS,GASINJ
ZPROPNZ SONC 503,SGNC 303,SWNC 503,PNC 50,103,ZNC 50,i 03,
►
R09AUX = REAL09
REALO9 = 60.0
R12AUX = REAL12
REAL12 = 14.7
fif CKROCIJ3.EQ. O.OD03 THEN
FO = O. ODO
ELSE
FO = l.ODO Z Cl. ODO + ROGCIJ3 * KRGCIJ3 * VOCIJ3 Z ROOCIJ3 Z KROCIJ3 Z VGCIJ3 3
ENDIF
DO 10 M = 1, NCOMP
' REAL17CM3 = SNGLCXNCIJ,M3*FO3 + SNGLC YNCI J, M3*C1. ODO - FO33
PMOAUX = PMO
PMGAUX = PMG
CALL GPASIM
CALL CONVERTE C X SC,YSC,VISO, VISG,QU AL,ROOSC,ROGSC,CD,NC0MP3 IF C QU AL. EQ. O. 03 GOTO 12
VN - l.dOZ CCl.dO- QUAL3ZQUAL * PMG ZPMO + 1. d03 GOTO 14
12 VN = O.OdO
14 QHCIJD = O. OdO
IF CPCI , T). GT. PMIND GOTO 18 WRITEC*,163
16 FORMATC' PRESSÃO MÍNIMA ATINGI DAF STOP
18 IF CPCI, JD . GE. PMAX2) GOTO 20
OMOL = ROOSC * QOCIJD IF CVN.EQ. l.dO3 THEN “ GMOL - O. OdO
ELSE
GMOL = VN * OMOL Z Cl.dO- VN? ENDIF DO ao M-l,NCOMP
QMCIJ.M? =s REAL17CM? * COMOL + GMOL? QHCIJ2) = QHCIJD + QMCIJ.M?
20	CONTE NUE
DQH = 0. OdO
QOSC = QOCIJ? Z CQ
GOTO 50
30	PWELLCIJ? = PMAX
34	KROAUX	=	KROCIJ?
KRGAUX	=	KRGCIJ?
KRWAUX	=	KRWCIJ?
SOCIJ?	= 2x SOCIJ?		- SONCIJ?	
SGCIJ?	= 2* SGCIJ?		- SGNCIJ?	
SWCIJ?	= 2* SWCIJ?		- SWNCIJ?	
CALL PERELCIJ?				
KROCIJ?	= O.5dO	x	CKROAUX +	KROCIJ??
KRGCIJ?	= 0.5d0	X	CKRGAUX +	KRGCIJ??
KRWCIJ?	= 0. 5d0	X	CKRWAUX +	KRWCIJ??
DO 40 M	=1,NCOMP			
IF CVOCIJD.EQ. O. ODO? THEN
QMdJ.M? = PROIND * KRGCIJ? * ROGCIJ? Z VGCIJ? * YNCIJ.M? *
+	CPWELLCIJ? - PCI.J??
ELSE
QMCIJ,M? = PROIND * CKROCIJ? * ROOCIJ? Z VOCIJ? * XNCIJ.M? + + KRGCIJ? * ROGCIJ? Z VGCIJ? * YNCIJ.M?? « CPWELLCIJ? - PCI.J?? ; ENDIF
QHCIJ? = QHCIJJ + QMCIJ.M?
40 CONTINUE
OMOL = QHCIJ? * Cl.ODO-VN?
GMOL = QHCIJ? * VN
IF CVN. EQ. 1. ODO? THEN
QOSC = O. ODO
DQH = - PROIND * CKRGCIJ? * ROGCIJ? Z VGCIJJ)
ELSE
QOSC - OMOL Z ROOSC Z 1.84O13E-O6
DQH = - PROIND * CKROCIJ? * ROOCIJ? Z VOCIJ? + KRGCIJ? *
+	ROGCIJ? Z VGCIJ??
ENDI F
KROCIJ? = KROAUX
KRGCIJ? = KRGAUX
KRWCIJ? = KRWAUX
SOCIJD	=	CSOCIJ'J	+	SONCIJ55
SgCIJZ)	=	CSgCIJZ)	+	SgNCIJ55
SwCIJD	=	CSwCIJZ)	+	SwNCIJ}}
OOO
50
QGSC = GMOL / ROGSC Z 3. £77413E-04
PMO = PMOAUX
PMG = PMGAUX
REALOQ = ROQAUX
REAL12 = R12AUX
RETURN
END
C
C
FIM DO PROGRAMA
C
ANEXO C
XL YL DZ POR PI SOI SGI
SWI
KX KY CR cw RWELL PMAX PMIN QOMAX QOMIN DPLIM DSLIM DTMAX TMAX DT
TEMPERATURA EPI
EPI2 swc ROSCW DELTAP
PMW
VISW
RE
PR. INDEX DAMP
&gt;
&gt;
&gt;
&gt;
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt;
&gt;
&gt;
&gt;
&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt;
. 3d0 2000.dO . 8dO . OdO . 2d0 200.dO 200.dO
O. IdO 5000.dO 1OOO. dO 1000. dO 1OO. dO 100.dO
O. IdO
3. dO 310. dO
3.OOdO 160. dO
76.196dO&lt;
30.479d0&lt;
15. 239d0&lt;
&lt;
&lt;
&lt;
&lt;
&lt;
&lt;
&lt;
.000004d0&amp;lt;.000003d0&lt;
&lt;
&lt;
&lt;
&lt;
&lt;
&lt;
&lt;
&lt;
&lt;
&lt;
&lt;
O. OOl 00d0&amp;lt;O. OOlOOdO&amp;lt;. 2d0	&lt;
1OOO. dO&amp;lt;
ÍO. OOdO&lt;
&lt;
&lt;
&lt;
4. S10D-O0&lt;
1.0&amp;lt;
18. dO . 41 dO 300. OdO
OLEO
CmJ COMPRIMENTO C rrD LARGURA CirD PROFUNDIDADE PPOROSIDADE CpsiaD PRESSAO INICIAL SATURACAO INICIAL DE
SATURACAO INICIAL DE GAS SATURACAO INICIAL DE CmdZ) PERMEABILIDADE Cmd2&gt; PERMEABILIDADE
Cl/psiL&gt; COMPRESSI BI LI DADE Cl/psi} COMPRESSIBILIDADE CrrD RAIO DO POCO Cpsia) PRESSAO MAXIMA CpsiaJ PRESSAO MÍNIMA CSTBZD5 VAZAO CSTB/D5 VAZAO Cpsi a5
AGUA
DIRECAO Y
DIRECAO Y DA ROCHA . DA AGUA
MAXIMA
MINIMA
VARI ACAO DE VARIACAO DE
MAXIMA MAXIMA INTERVALO DE TEMPO TEMPO FINAL INTERVALO DE TEMPO entrada
PRESSAO SATURACAO MAXIMO
do GPASIM
IRREDUTÍVEL
DA AGUA- CONDICOES PADRAO
C di as2 C di as2&gt; C di asZ) C oF2) mudar Lambem
TOLERANCIA TOLERANCIA SATURACAO DE AGUA CKg/m33 DENSIDADE
Cpsia? PARA CALCULO DAS DERIVADAS NUMERICAS PESO MOLECULAR DA AGUA
CcpD VISCOSIDADE DA AGUA
CnD RAI O EXTERNO DO RESERVATÓRIO
INDICE DE PRODUTIVIDADE FATOR DE AMORTECIMENTO
NX	&gt;	20&lt;	
NY ITEMAX	&gt; &gt;	01 &amp;lt;15&lt;	NUMERO MAXIMO DE ITERAÇÕES
NPRO	&gt;	1&amp;lt;	NUMERO DE POCOS - PRODUÇÃO
NINJ	&gt;	1&amp;lt;	NUMERO DE POCOS - INJECAO
NFLAG	&gt;	1&amp;lt;	IMPRIME A CADA NFLAG INTERVALOS DE TEMPO
NDAY	&gt;	1O&lt;	NUMERO DE VEZES A IMPRIMIR
NK	&gt;	17&lt;	NUMERO DE LEITURAS - PERMEABILIDADES
NCOMP	&gt;	3&lt;	NUMERO DE COMPONENTES
MODELO	&gt;	1&lt;	0 -&gt; RADIAL	l-&gt; CARTESIANO
NTP	&gt;	O&lt;	O -&gt; 2-POINT UPSTREAM 1 -&gt; 1-POINT UPSTREAM
1	J	QW		***** INJECAO
&lt;&gt;	1&lt;&gt; 1&lt;&gt;	
&lt;&gt;	0.dO&amp;lt;&gt;	
&lt;&gt;	. 915332DOO	QL
&lt;&gt;	. 228833DOO	02
&lt;&gt;	. OOOOOODOO	03
I	J O 1&lt;&gt; 1&lt;&gt;		00 -78. d0 O CSTB/DZ)	xxxxx PRODUÇÃO xxxxx
	ZCI?	P MOL.	INTE11	
o	. 2dO	&lt;&gt;	16. O43dO&lt;&gt; 020	METANO
o	. 2d0	O 58. 124d0&lt;&gt; 050	ISO BUTANO
o	. 8d0	O 142.286dO&lt;&gt; 140	N DECANO
LEITURA DO VETOR DE IMPRESSÃO
O	365.dO O		
O	730.dO	O	
O	1095.dO	O	
o	1460.dO	o	
o	1825. dO	o	
o	2190. dO	o	
o	2555.dO	o	
o	2920.dO	o	
o	3285.dO	o	
o	3650.dO	o	
SAT			KORWCSO	KRWCSW3		KRGC SG1		KROGCSLD		
O	-0. IdO	O	. OdO	O	. OdO	&lt;&gt;	. OdO	O	. OdO	&lt;
O	. 15d0	O	. OdO	&lt;&gt;	. OdO	&lt;&gt;	. OdO	&lt;&gt;	. OdO	&lt;
o	. 2OdO	O	. 02d0	&lt;&gt;	. OdO	O	. OdO	O	. OdO	&lt;
o	. 25d0	O	. 04d0	&lt;&gt;	. OdO	&lt;&gt;	. OdO	&lt;&gt;	. OdO	&lt;
o	. 2SdO	O	.O52dO	&lt;&gt;	. OdO	&lt;&gt;	.OOBdO	&lt;&gt;	. OdO	&lt;
o	. 3Od0	O	. OBdO	&lt;&gt;	.003dO	&lt;&gt;	. OldO	&lt;&gt;	. OdO	&lt;
o	. 40d0	o	. lldO	&lt;&gt;	. O2dO	&lt;&gt;	. 03d0	o	. OdO	&lt;
o	. 5Od0	o	. 20d0	&lt;&gt;	. 08d0	&lt;&gt;	. O8dO	o	. OdO	&lt;
o	. 52d0	o	. 28d0	&lt;&gt;	.O92dO	&lt;&gt;	.104d0	&lt;&gt;	. OdO	&lt;
o	. BOdO	o	. 35d0	&lt;&gt;	. 14d0	&lt;&gt;	. 2OdO	&lt;&gt;	. O3d0	&lt;
o	. 65dO	o	. 40d0	&lt;&gt;	. 18dO	&lt;&gt;	. 30d0	&lt;&gt;	.O45dO	&lt;
o	. 7Od0	o	. 36d0	O	. 22d0	&lt;&gt;	. 40d0	o	..12d0	&lt;
o	. 72d0	o	1.OOdO	&lt;&gt;	.242dO	&lt;&gt;	. 44dO	&lt;&gt;	. 16dO	&lt;
o	. 80d0	o	1.OOdO	o	. 33d0	&lt;&gt;	. BOdO	o	. 31 dO	&lt;
o	. 9OdO	o	1.OOdO	&lt;&gt;	. 53d0	&lt;&gt;	. 80d0	o	. 6OdO	&lt;
o	1. OOdO	o	1.OOdO	o	1.OOdO	&lt;&gt;	1.OOdO	&lt;&gt;	1.OOdO	&lt;
o	1.1 OdO	o	1.OOdO	&lt;&gt;	1.OOdO	O	1.OOdO	&lt;&gt;	1.OOdO	&lt;
ENTRADAS GPASIM
INTE01	&gt;	1	&lt;	eq.	de	estado —&gt; 1- PR	2- SRK
INTEO2	&gt;	1	&lt;	cal	culo das propriedades	
INTE03	&gt;	0	&lt;	numero		de comp, hi poteticos
INTE05	&gt;	3	&lt;	numero		total de componentes
INTEO6	&gt;	05&lt;		opcao de calculo		
INTE07	&gt;	3	&lt;	opcao de relatorio de salda .		
INTE08	&gt;	1	&lt;	unidades de entrada C 1-molzh 3~1bszh 3-bblZh		
INTE09	&gt;	1	&lt;	ori gem		de calculo
INTE10	&gt;	1	&lt;	origem de entalpia e entropia		
REAL09	&gt;		160.		&lt;	temperatura inicial
REAL10	&gt;			0.	&lt;	temperatura final
REAL11	&gt;			0.	&lt;	incremento de temperatura
REal.1 2	&gt;		4800.		&lt;	pressão inicial - "mudar pi”
REAL13	&gt;			0.	&lt;	pressão final
REAL14	&gt;			0.	&lt;	incremento de pressão
REAL15	&gt;			1.	&lt;	fracao LzF
BIBLIOGRAFIA
♦
[ABR8Q]	Au, A» D. K. , Behie, A., Rubin, B. and Vinsome, P. K. W. .	"Techniques	for	Fully	Implicit Reservoir Simulation", SPE 9302, Setembro, 1980
EABW6O3	Amyx, J. W. , Bass, D. M. and Whiting, R. L. , "Petroleum Reservoir Engineering", McGraw Hill, i960.
EADFB23	Acs, G. , Dollschall, S. and Farkas, E. , "General Purpose Compos!ti onal Model", SPE 10515, 1982.
EAS793	Azi z, K. and Sett ar i , A. "Petrol eum Reservoir Simulation", Applied Science Publishers Ltd., London, 1979.
[Bur79]	Burcik, E. J. , "Propr1erties of Petroleum Reservoir Fluids", Jonh Wiley and Sons, New York, 1979.
CCoa763	Coats, K.H. , "Simulation of Steamflooding with Distilation and Solution Gas", SPE 5015, Outubro 1976.
[Coa783	Coats, K. H. , "A Highly Implicit Steamflood Model", SPE Journal, 369, Outubro 1978.
C Coa803	Coats, K.H., "An Equation of State Compositional Model", SPEJ, 363-376, Outubro 1980.
ECoa823	Coats, K. H. , "Reservoir Simulation	State of Art", JPT, 1633-1642, Agosto 1982.
ECoa853	Coats,	K. H. ,	"Simulation of	Gas	Condensate
Reservoir Performance", SPEJ, 1870-1886, 1983.
ECJR743	Cook, R. E. , Jacoby, R. H. and Ramesh, A. B. , "A Beta—Type Reservoir Simulator for Approximating Compositional Effects During Gas Injection", SPEJ, vol.14, pp 471-481, 1974.
[Cri771	Crichlow, H. B. , "Modern Reservoir Engineering : A Simulation Approach", Prentice Hall, New Jersey, 1977.
EFF793	Fussel, L. T. and Fussel, D. D. , "An Iterative Technique	for	Compositional Models", SPEJ, 211-220, Agosto 1979.
CFraBGJ	Franchi ,	J.R. ,	"Boast-E3CR	:	Black	Oil	and Condensate Simulation on an IBM-PC", SPE 13297, 1986.
E FY78J	Fussel, D. D. and Yanosik, J. L. , "An iterative Sequence	for	Phase	Equilibrium	Calculations Incorporating	the	Redlich-Kwong	EOS",	SPEJ, 173-182, Junho 1978.
E Helen	Helfferich,	F. G. ,	"Theory of Multicomponent, Muiti phase Di splacement i n Por ous Medi a", SPEJ , 51—62, Fevereiro 1981.
r Hua851	Huan, G. R. , "A Flash Black Oil Model", SPE 15297, 1985.
[JonSSJ Jones, J.R., "Computation Analysis of Single Well
Responses for Gas Condensate Systems", The
University of Tulsa, 1985.
£JR89J
c jsreei
EKB83]
EKen83]
EKumB?]
E KVS78J
ELY853
CMan82]
Flowing Well Response in Gas-Condensate Wells",
SPE Formation Evaluation, 578-594,, Setembro 1988.
Jones, J.R. e Raghavan R. , "Interpretation of
Buildup Gas-Condensate Wells", SPE Formation
Evaluation, 93-104, Margo 1989.
Jossi, J.A., Stiel L.I., and Thodos G. , "The Viscosity of Pure Substances in the Dense Gaseous and Liquid Phases”, A. I. C. H. F. Journal, vol. 8, n? 1, pag 59-62, 1958.
Kenyon, O. E. and Behie, A. , "Third SPE Comparative Soluction Project : Gas Cycling of Retrograde Condensate Reservoirs", SPE 12278, 1983.
Kendall, R. P. et al, "Development of a Multiple Aplication Reservoir Simulator for Use on a Vector Computer", SPE 11483, 1983.
Kumar, S. , "Gas Production Engineering", Gulf Publishing Co., Houston, Texas, 1987.
Kazemi, H. , Vestal, C. R. and Shank, G. D. , "An Efficient Multicomponent Numerial Simulation", SPEJ, 355-368 ,Outubro 1978.
Lo, T. S. and Youngren G. K. , "A New Approach to Li mi ted Composi ti onal Si mulati on ; Di rect Soluti on of the Phase Equilibrium Equations", SPE 13518, 1985.
Mansoori, J. ,"Discussion of .Compositional Modeling
	with an Equation of State", SPE Journal f 202-203, Abril 1982.
t Me 733	McCai n, W. D. , Jr, "The Properties of Petroleum Fluids", Pen Well, 1973.
[NAL83]	Nghiem, L. X. , Aziz, K. and Li ¥. K. , "A Robust Iterative	Method	for	Flash	Calculations Using the SRK or the PR Equation of State", SPEJ, 521-530, Junho 1983.
[NFA81]	Nghiem,	L.X. ,	Fong,	D. K.	and	Aziz,	K. , k "Compositional	Modelig	with an	Equation	of State", SPEJ, 887-698, Dezembro 1981.
[NghS2]	Nghiem, L.X. , "Author’s Reply to Discussion of Compositional Modeling with an Equation of State", SPE Journal, 204, Abril 1982.
[NWFA851	Nutakki R. , Wong T. &gt; Firoozabadi A. , Aziz K. , "Bevelopment	of	General	Purpose Simulators", Stanford University,	Stanford, California, Jul ho 1985.
[Ode81]	Odeh.	A. S. ,	"Comparison of	Solution	to	a Three—Di mensi onal Black —Oi1 Reservolr Si mulati on Problem", JPT, pp 13-25, Janeiro 1981.
[Pea77]	Peaceman,	t). W. ,	"Fundamentals	of	Numerical Reservoir	Si mul ati on",	Elsevier	Scientific Publishing Co., New York, 1977.
L?ed842	Pedrosa, Jr. O. A. , "Use of Hybrid Grid in Reservoir Simulati on", Stanford Uni versi ty, Stanford, Cali for ni a, Dezembro 1984.
L PFTV861	Press, W. H. , Flannery, B. P. , Teukolsky, S. A. ,
	Vetterling, W. T. , ‘'Numerical Recipes", Cambridge University Press, Cambridge,1986.
C StaBl J	Standing, M. B. , "Volumetric and Phase Behavior of Oil Field Hydrocarbon Systems", Millet the Printer Inc., Dal las, 1981.
CSV86]	Shank, G. D and Vestal, C. R. , "Practical Technics in Two-Pseudo Component Bl ack-Oil Simulation", SPE 15156» 1986.
CTLS831	Thele, K. J. , Lake, L. W. &gt; Sepehrnoori K. ,	"A Comparation of the Three Equation-of-State Compositional Simulator", In Seventh SPE Symposium on Reservoir Simulation, San Francisco, n? 1224S, Novembro 1983.
[Wat96]	Watts, J. W. , "A Compositional Formulation of the Pressure and Saturation Equations", SPEJ, 243-252, Maio 1986.
[WonSB]	Wong, T. W. , "Compositional and Black Oil Modelling -with Emphasis on the Volume Balance Method”, Stanford	Uni ver sity,	St anford,	California, Fevereiro 19SS.
[YS833	Young, L. C. and Stephenson, R. E. , "A Generalized Compositional Approach for Reservoir Simulation", SPE Journal 727—742, Outubro 1983.</field>
	</doc>
</add>