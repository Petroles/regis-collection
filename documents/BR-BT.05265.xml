<?xml version="1.0" encoding="utf-8"?>
<add>
	<doc>
		<field name="docid">BR-BT.05265</field>
		<field name="filename">BTP_1986_29_1_07_Ajustamento_automatizado.pdf</field>
		<field name="filetype">PDF</field>
		<field name="text">Ajustamento Automatizado com Curvas Tipo na Análise de Testes em Poços com Uso de Determinação no Campo de Laplace dos Gradientes da Função Objetivo
ADALBERTO JOSÉ ROSA, Setor de Ensino na Bahia, Divisão de Ensino, Centro de Pesquisas.
RESUMO — São investigados métodos automáticos de ajuste com curvas tipo para a interpretação de testes de fluxo na presença de efeitos de estocagem e dano no poço. Métodos de regressão não-linear de Gauss ou Gauss-Marquardt são usados para estimar parâmetros do sistema poço-re-servatório. O uso das técnicas de inversão numérica de transformadas de Laplace para obter gradientes da função objetivo, com respeito aos parâmetros desconhecidos, permite uma solução particularmente rápida para o problema. Além disso, este novo método possibilita o ajuste automático para vários outros modelos, anteriormente inacessíveis, constituindo um avanço sobre as técnicas existentes. Exemplos são apresentados.
ABSTRACT — Automatic methods of type curve matching for the interpretation of drawdown tests in the presence of wellbore storage and skin are investigated. Gauss or Gauss-Marquardt nonlinear regression methods are used to estimate wellbore and reservoir parameters. The use of numerical Laplace transform inversion techniques make the problem solution particularly streamlined. Besides that, this new method enables automated fitting of many more type curves than were formerly possible, and is therefore a major improvemout on existing techniques. Examples are shown.
(Originais recebidos em 30-V-85.)
1	- INTRODUÇÃO
A maioria dos métodos usados para a análise do comportamento de testes de fluxo em poços de óleo são gráficos e classificam-se em duas categorias principais:
a)	construção de um gráfico que resulte numa linha reta, facilitando assim a interpretação;
b)	aj'ustamento dos dados com a curva tipo apropriada.
Neste trabalho são propostos métodos de solução do problema com utilização de computador digital, o que reduz o caráter subj'etivo da interpretação. São usados métodos de regressão não-linear de Gauss e Gauss-Marquardt, combinados com técnicas de inversão numérica da transformada de Laplace.
Os algoritmos de regressão não-linear requerem expressões analíticas para a queda de pressão no poço e suas derivadas em relação aos parâmetros desconhecidos. Normalmente, não se dispõe desses valores para as curvas tipo existentes, o que tem impedido seus ajustes automáticos.
Este estudo obteve sucesso no cálculo dessas funções por meio da inversão numérica de expressões analíticas no do
mínio de Laplace, possibilitando o ajuste automático numa extensa faixa de casos, antes inacessíveis. Além disso, restringindo-se certos parâmetros do reservatório a valores positivos, aumenta-se a velocidade de convergência dos algoritmos de regressão não-linear.
Exemplos citados demonstram que a análise de regressão, em algumas situações, pode produzir melhores resultados do que os métodos gráficos convencionais, inclusive em casos em que estes últimos simplesmente não podem ser empregados.
2	- PESQUISA BIBLIOGRÁFICA
2.1	— Análise Convencional
Na análise convencional de dados de fluxo transiente em reservatórios homogêneos, o gráfico semilogarítmico de pressão versus tempo é largamente empregado. Esta técnica normalmente requer uma decisão sobre o início da linha reta após o desaparecimento dos efeitos de estocagem no poço. A análise de dados de longo tempo em testes de fluxo pode também ser usada na estimativa do volume do reservatório comunicante com o poço. Este teste, chamado "teste limite de reservatório", foi introduzido
por JONES (‘) em 1956.
Em 1970, AGARWAL e outros (2) apresentaram uma solução para reservatório infinito incluindo efeitos de película e estocagem no poço. O uso do método de ajustamento com curvas tipo foi proposto para estimativa de parâmetros do reservatório ou, o que é mais importante, do início da linha reta semilog. Aparentemente, quatro parâmetros poderíam ser obtidos por meio desse procedimento: 0hct, kh, s e C.
Em 1979, GRINGARTEN e outros (3) desenvolveram novas curvas tipo para o mesmo modelo considerado por AGARWAL e outros (2). Esse novo formato de apresentação revelou que somente três parâmetros independentes do sistema poço-reservatório poderíam ser determinados mediante ajustamento com curvas tipo. A partir do ajuste da pressão é possível determinar o produto kh; a partir do tempo, o coeficiente de estocagem C, e da curva escolhida, o produto Cp e2S, e, conseqüentemente, o fator de película s.
Com respeito a reservatórios estratifi-cados, que é um dos tipos de heteroge-neidade tratados neste estudo, o trabalho mais extensivo deve-se a TARIQ (4) em 1977, no qual curvas tipo foram geradas para reservatórios limitados estra-tificados, sem fluxo entre as diversas camadas.
2.2	— Análise de Testes Automática (Computadorizada)
Em 1966, JAHNS (5) usou uma combinação de simulação e análise de regressão para descrever um reservatório bidimensional com dados de testes de interferência. O reservatório foi dividido numa série de blocos homogêneos cuja transmissibilidade (kh//i) e estocagem (&lt;/&gt;hct) foram estimadas de modo a satisfazer o critério de mínimos quadrados.
COATS e outros (6), em 1970, formularam uma técnica similar, que empregava mínimos quadrados e programação linear para determinar a descrição do reservatório a partir de dados de desempenho.
Lm 1972, EARLOUGHER &amp;amp; KERSCH (7) mostraram dois exemplos de aplicação de análise automática do período transiente de testes de campo. O método de análise por regressão foi aplicado à solução da linha-fonte num reservatório infinito. O primeiro exemplo consistia na estimativa de parâmetros de reservatório com utilização de
dados de teste de interferência. No segundo, um teste de fall-off e de interferência foi analisado. Os efeitos de estocagem no poço foram considerados, mas, para isso, foi necessário um grande número de superposições de vazão na simulação do período de afterflow do teste de fall-off, até que se obtivesse um ajustamento aceitável.
Em 1972, HERNANDEZ&amp;amp;SWIFT (8) formularam o chamado "algoritmo diferencial de mínimos quadrados", para descrição automática do reservatório, que aplicava uma pseudolinearização entre os dados de comportamento e os parâmetros do reservatório. Como critério para a otimização, adotou-se o método dos mínimos quadrados, que, segundo os autores, eliminava os problemas de linearização de sistemas não-lineares.
CHEN e outros (9), em 1974, usaram o "método do controle ótimo", para obter ajustamento do histórico de reservatórios. Efetuaram-se comparações entre as eficiências dos métodos steepest descent, Gauss-Newton e gradientes conjugados. Segundo as conclusões, o "método do controle ótimo" requer menor tempo computacional do que as técnicas antes utilizadas.
Finalmente, RODGERS eoutros(10), em 1981, empregaram a regressão não--linear para estimar permeabilidade, constante de difusividade, pressão inicial e distâncias geométricas em reservatórios limitados, mas com fatores de película conhecidos e sem efeitos de estocagem, a partir de dados de teste de crescimento de pressão teóricos e práticos. A solução para a pressão no poço em forma analítica no campo real permitiu a obtenção das derivadas necessárias à linearização das equações não-lineares, por meio da aplicação da regra de Leibnitz.
3	- OBJETIVO
O principal objetivo deste estudo foi a investigação de métodos de aplicação automática da técnica de ajustamento de dados com curvas tipo. Portanto, ao invés de gerar curvas tipo para diferentes combinações de parâmetros do reservatório, podem-se gerar curvas tipo específicas internamente até que se encontre o melhor ajustamento.
Neste trabalho, a solução para a queda de pressão no poço, incluindo efeitos de dano de formação e estocagem, é considerada no domínio de Laplace. Essa equação é não-linear em relação aos parâmetros desconhecidos, e o pro
blema de estimá-los requer o uso de análise de regressão não-linear.
Considerando que a solução da equação diferencial governante do fluxo é conhecida explicitamente apenas no campo de Laplace, essa solução e suas derivadas em relação aos parâmetros, necessárias à implementação da regressão não-linear, foram invertidas numericamente por meio de uma técnica simples e eficiente proposta por STEH-FEST (u) em 1970. O ajustamento da curva tipo (solução) aos dados foi, então, feito no campo real. Reservatórios ilimitados ou limitados, estratifica-dos ou homogêneos foram considerados no estudo, mas somente o caso de reservatório infinito é incluído neste trabalho. Os casos de múltiplas camadas podem ser encontrados em ROSA (12).
A determinação dos gradientes da função objetivo no campo de Laplace e suas subseqüentes inversões foram bem sucedidas, indicando que muitas outras soluções de modelos de reservatório facilmente obtidas pelo método da transformação de Laplace poderão ser ajustadas a dados de pressão automaticamente.
4	- OS MODELOS FÍSICO E MATE
MÁTICO
0 modelo físico estudado consiste num reservatório composto de várias camadas que se comunicam somente através do poço e podem ter diferentes raios externos. O caso de uma só camada produzindo no regime transiente é enfocado neste artigo e é uma particularidade do sistema mais geral. O comportamento de reservatório infinito pode ser tido como o de um reservatório limitado produzindo durante pequeno espaço de tempo de modo que seus limites não tenham ainda sido afetados. Exemplos específicos serão fornecidos, mas a formulação é geral.
O modelo matemático é derivado com as hipóteses usuais num reservatório produtor de óleo, horizontal e cilíndrico.
5	- SOLUÇÕES DOS MODELOS
MATEMÁTICOS
As soluções para a queda de pressão no poço são obtidas por meio do método da transformação de Laplace.
5.1	— Reservatório Infinito Estratifi-cado
No campo de Laplace, a queda de
pressão no poço é dada por:
ajustamento de modelo, usaremos o mais antigo e mais largamente empregado, o método dos mínimos quadrados.
qt a^KjojvSF
Ko&lt;ajvÇ‘)tS|a)v5K,lü|Xá7
Inicialmente definiremos:
onde:
= valor teórico da queda de pressão no poço no tempo t = tj, definido pelas equações 1 ou 2;
= valor medido daquela queda de pressão.
cidas somente no campo de Laplace. As derivadas são então obtidas por meio da expressão:
9f
(5)
onde:
Z é o argumento no campo de Laplace; Ko e K( são as funções modificadas de Bessel de segunda espécie e ordens zero e um, respectivamente; nC é o número de camadas; e os demais símbolos seguem a nomenclatura usual.
O método dos mínimos quadrados consiste na minimização da soma dos quadrados dos resíduos, definida por:
onde:
p = número do parâmetro
0p= parâmetro do reservatório
(T = vetor cujos componentes são os parâmetros do reservatório
f = função F no domínio de Laplace, isto é, Apwf(^z z)
5.2 — Reservatório Limitado Estratifi-cado
Neste caso, a solução é, conforme TARIQ (4):
0 = (0 j, 02, . . ., 0np)T é o vetor dos np parâmetros a serem determinados.
onde:
ò| = IO(ajx/Z)—sjo-jx/ZI i (ap/Z)
5K = KolajVzj+sjap/zkj (ajVZ)
e lo, Ij são funções de Bessel modificadas de primeira espécie e ordens zero e um, respectivamente.
Dá-se o nome de função objetivo a SQR(ít) e deseja-se encontrar o vetor (T* para o qual ela alcança seu ponto de mínimo, num processo chamado de otimização. Se restringirmos os parâmetros a certos intervalos ou regiões, teremos uma programação não-linear.
Como discutido por BARD (13), há vários métodos para resolver tais tipos de problema, mas nenhum deles tem-se revelado o melhor para todos os casos de programação não-linear. Portanto, teremos que explorar seus comportamentos em nossos casos particulares e comparar seus resultados.
6.1 — Método de Gauss
O sistema de equações de condição é dado por:
Após a linearização do sistema de equações 4, as equações normais são construídas usando-se um método simples e prático descrito por WYLIE (14). Em seguida, o sistema de equações normais é resolvido, e as correções adicionadas ao vetor solução, para formar uma nova estimativa dos parâmetros. O processo é repetido até a convergência dentro de uma acurácia prescrita.
O método de Gauss é reconhecidamente muito sensível aos valores estabelecidos no início do processo iterativo e pode convergir lentamente, ou mesmo divergir, se esses valores forem consideravelmente diferentes daqueles da solução correta do problema.
A inversão das equações do campo de Laplace para o campo real foi feita numericamente, usando-se o algoritmo de STEHFEST (u). A variável de acurácia N naquele algoritmo foi escolhida como sendo 8, valor com o qual os resultados da avaliação de pressão no poço concordam com aqueles apresentados por AGARWAL e outros (2) em quatro ou cinco algarismos significativos.
6 - ESTIMATIVA NÃO-LINEAR DE PARÂMETROS DO RESERVATÓRIO: FORMULAÇÃO DO PROBLEMA E ESCOLHA DO MÉTODO
Os parâmetros do modelo são as propriedades do sistema poço-reservatório, e a variável tempo é representada no domínio de Laplace pelo argumento Z. A atribuição aos parâmetros de valores que permitam o ajustamento das equações 1 ou 2 aos dados obtidos de um teste de fluxo resulta num problema de ajustamento de modelo.
Dentre os diversos métodos para efetuar a estimativa de parâmetros num
6.2 — Método de Gauss-Marquardt: Técnicas de Interpolação-Extra-polação e Funções de Penalidade
As equações desse sistema são não-li-neares com respeito às características do poço e do reservatório, os quais aparecem em várias combinações nos parâmetros a, 0, s eC. A base do método de Gauss é a linearização de equações pela expansão de cada função Fj em uma série de Taylor com truncamento dos termos que envolvem derivadas de ordem igual ou superior a dois. È importante notar que essas derivadas não podem ser analiticamente obtidas no campo real porque as funções Fj são conhe-
MARQUARDT (15) publicou, em 1963, um procedimento que combina as vantagens do método baseado na série de Taylor (Gauss), evitando seu problema de divergência, e do método de steepest descent (ou gradiente), evitando sua lenta convergência após as primeiras iterações. O método revela-se muito útil quando a matriz é altamente mal condicionada, como no caso em que os parâmetros a serem estimados apresentam altas correlações entre si. MARQUARDT mustrou que re^olveç. o sistema de equa-
ções normais ED = U equivale a resolver o sistema:
(E + Àl) D =u
(6)
onde À é uma constante, e I a matriz identidade.
O vetor solução após a iteração i + 1, em termos da solução da iteração i, é dado por:
(f(i+1&gt; =&lt;t(i) + d(í+1)	(7)
onde D é a solução do sistema de equações normais, modificado de acordo com a variação Marquardt.
O seguinte procedimento pode ser usado:
a)	Inicie com À = 0,01
b)	Substitua À por 0,1 À se
SQR
c)	Caso contrário, encontre um fator:
p&lt;i+1&gt; tal que ^(i+1) = ^(1)+p(i+1)
g(i+1)
produza:
SQR
e substitua À por 10À. Este último passo é chamado de método de interpolação.
A técnica de extrapolação consiste em se tentar pelo menos um outro valor de p que possa reduzir ainda mais o valor de SQR, ainda que o vetor solução (5 tenha sido aceitável na iteração.
Outra maneira de melhorar os aspectos numéricos da solução do sistema linearizado de equações é empregar uma transformação de escala na matriz coeficiente e no vetor. A equação em estudo era inicialmente, na forma matricial:
ed = lT	(8)
Definiremos uma matriz e um vetor transformados, ES e US, de acordo com:
a solução do sistema passa a ser:
D = DS/\/Ç	(12)
Considerando-se que a maioria dos parâmetros do reservatório não podem assumir valores negativos, a busca itera-tiva pode ser mantida fisicamente coerente e ter sua velocidade aumentada aplicando-se restrições a esses parâmetros. Isto pode ser alcançado, por exemplo, com uso de funções de penalidade. A restrição é definida por: hj(^)&gt;0	(13)
à qual a seguinte função de penalidade é atribuída:
=Sj/hj(^)	(14)
onde Ôj é uma pequena constante positiva.
A função objetivo modificada vem a
ser:
SQR+(íf) = SQR(^)+SSi/hi(6^)	(15)
j 1 1
Se (t+ e t* são os pontos para os quais SQR+ e SQR atingem seus mínimos, respectivamente, é possível provar que, sob condições adequadas:
lim Sj-X)
(16)
A nova forma da equação 8, após a inclusão dos termos da função penalidade, é, para o método de Gauss:
E+D,i+1,=U	(17)
(19)
(20)
hab bab
0a,	= dois elernentos quaisquer do
vetor (T;
np = número de parâmetros a serem determinados.
Os limites dos parâmetros■ têm que ser escolhidos convenientemente para cada problema específico. Como exemplo, tomaremos o seguinte:
Aplicando-se o método de Marquardt: [(ES) + Àl] DS =US	(11)
0	&lt;	a	&lt;	1sl/2
0	&lt;	V		100 darcy.cm/cP
0	&lt;	s	&lt;	30
0	&lt;	C		6 x 106 cm3/atm
(21)
Assim, as restrições serão:
h5(íJ&gt;)=s &gt;0
h2(^) = 1-a&gt;0	h6((?) S30-s&gt; 0
h3(íT)=P&gt;0	h7((^)=C&gt;0
h4(?) = 100-P&gt;0 h8((t)=6x106-C&gt; 0
A função de penalidade será, portanto:
8	§i	32 ô3 ô4
S Ê$)=— + — +— + — + j=1	a	1-a p 100-P
S5 S6 S7 ô8
+— + — +—+ ---------- (22)
s 30—s C 6x106—C
Atribuiremos, aos ô's, pequenos números da mesma ordem de magnitude, calculados por meio da expressão:
(23)
Sj = 104SQR (t(i)
onde 6 é o vetor solução obtido na iteração anterior.
7	- EXEMPLO: ESTIMATIVA DE k, s e C NUM RESERVATÓRIO INFINITO HOMOGÊNEO
Inicialmente, tentou-se a determinação de quatro parâmetros do reservatório por meio da regressão não-linear: a, P, s e C. De acordo com o trabalho de GRINGARTEN e outros (3), seria impossível obter uma única solução para as quatro variáveis, fato confirmado por meio da análise computacional. A ambi-güidade aparece na ajustagem automática com as curvas tipo, da mesma forma que na ajustagem gráfica, e é devida às altas correlações (algumas vezes maiores que 0,99) entre alguns pares de parâmetros: (a, P), (a, s) e (P, s). Esse fato revela a combinação de parâmetros indicada para a ajustagem automática (certamente, a combinação a, P e s não o é).
Os resultados desse exercício de ajustagem, mostrados na tabela I, indicam também que as funções de penalidades nem sempre são suficientes para prevenir resultados não realísticos para os parâmetros do reservatório (note as per-meabilidades negativas) se o ponto de partida não for adequado.
Finalmente, a ajustagem automática com as curvas tipo é capaz de convergir mesmo quando a solução é ambígua (veja os casos 3 e 4 na tabela I). Isto se torna uma desvantagem porque o usuário incauto pode estar desatento à multiplicidade de soluções igualmente aceitáveis em termos teóricos, mas que nada representam em relação à realidade do sistema estudado.
Resultados do Método de Gauss-Marquardt
Dados Iniciais (Unidades de Darcy)	Método	Estimativa Inicial (Darcy)	Solução (Darcy)	Número de Iterações	SQR (atm2)	Parâmetros do Reservatório (Solução) (Darcy)
k =	0,1 h =	100 s -	10 C = 6 283	Gauss-Marquardt sem funções de penalidade	a =	0,07 0 = 20 s =	10 C = 6 283	- 0,2369 10,99 14,38 9 029	1		
		a =	0,10 P =	12 s =	10 C = 6 283	-0,0051 11,04 11,05 6 495	1		
	Gauss-Marquardt com funções de penalidade	a =	0,10 P =	12 s =	10 C = 6 283	0,1617 10 10,48 6 283	6	0,4839 x 10’9	k =	0,038 h =	263 s =	10,48 C = 6 283
		a =	0,15 P =	10 s =	11 C = 6 283	0,2004 10 10,7 6 283	5	0,1646 x 10~8	k =	0,025 h =	401,6 s =	10,7 C = 6283
Fig. 1 - Teste de fluxo — gráfico log-log para análise por ajustamento com curva tipo.
A solução se torna única, no entanto, se somente três parâmetros são estimados: k, s e C.
7.1	— Aplicação do Método de Gauss
A tabela II apresenta dados obtidos de um teste de fluxo num poço de óleo, os quais são fortemente influenciados pelos efeitos de estocagem no poço.
k = 104 mD = 0,104 darcy
s =12,3
C = 0,86659 bbl/psi = 202 386 cm3/ atm
TABELA II
Dados para Exemplo de Teste
qsc = 179 STB/d = 329 cm3/s Bo = 1,2 bbl/STB = 1,2 cm3/cm3 h = 35 pé = 1 066,8 cm rw = 0,276 pé = 8,412
Ct = 8,2 x 10’6 psi’1 = 120,5 atm-1 0	= 0,18
H	= 1,0 cP
Dados de Pressão — Teste de Fluxo
A figura 1 mostra o gráfico log-log. Ajustando essa curva com as curvas tipo de GRINGARTEN e outros (3), estimamos:
At (h)	Apwf (psi)	Apwf (atm)
0,2	19,7	1,34
0,3	28,1	1,91
0,5	43,1	2,93
0,7	58,3	3,97
1,0	75,1	5,11
2,0	114,5	7,79
3,0	135,5	9,22
5,0	152,2	10,36
7,0	163,2	11,10
10,0	166,7	11,34
20,0	171,2	11,65
30,0	173,9	11,83
50,0	175,2	11,92
70,0	177,1	12,05
Fonte: EARLOUGHER &amp;amp; KERSCH (16).
Fig. 2 - Teste de fluxo — gráfico semilog para análise convencional.
EARLOUGHER &amp;amp; KERSCH (16) obtiveram os seguintes resultados utilizando o ajustamento com curvas tipo:
k = 132 mD = 0,132 darcy
s = 18
C = 0,0942 bbl/psi = 220 172 cm3/ atm
Com auxílio aa análise semilog convencional, segundo a figura 2, calculamos:
k = 102,6 mD = 0,103 darcy s = 12,1
De acordo com o início aproximado da linha reta semilog indicado pela ajus-tagem com as curvas de GRINGARTEN e outros (3), somente os dois ou no máximo três últimos pontos encontram-se sobre essa reta, o que torna a análise convencional relativamente difícil e subjetiva. No intuito de investigar este fato, empregamos o método de Gauss usando
todos os pontos dados e também em outras situações em que omitimos alguns dos dados (tabela III).
O ajustamento com utilização de todos os pontos dados produziu uma soma de quadrados dos resíduos igual a 0,0478 atm2, e o maior resíduo individual observado foi de 0,156 atm. A permeabilidade e o fator de película estimados pelo método semilog convencional são 13,6% e 23,6% maiores que os valores obtidos pelo método de Gauss, respectivamente.
A análise semilog convencional é dificultada devido ao pequeno número de pontos sobre a linha reta. Neste caso, é interessante observar o que aconteceria se os dois últimos pontos não estivessem presentes: a análise convencional seria impossível, mas a ajustagem automatizada, ainda assim, produziría resultados razoáveis para a permeabilidade e fator de película, com desvio máximo de 18%, e praticamente o mesmo valor para o coeficiente de estocagem.
Excluindo-se os primeiros três pontos, seria impossível estimar a estocagem no poço mediante análise da reta de inclinação unitária, que não estaria presente. Porém, o método de Gauss fornecería aproximadamente os mesmos valores obtidos usando-se todos os pontos da
dos.
Esses exemplos mostram a eficácia do procedimento automatizado: é pos-
TABELA III
Resultados do Método de Gauss Dados da Tabela II
sível estimar três parâmetros do sistema poço-reservatório a partir de dados que compreendem somente a zona de transição entre a reta de inclinação unitária (dominada pelos efeitos de estocagem) e a linha reta semilog (quando os efeitos de estocagem já desapareceram). A melhor maneira de se efetuar essa análise é aplicar uma técnica de regressão não-li-near automática, como proposto neste estudo, já que não existe uma expressão analítica simples para a queda de pressão na região de transição, e a ajustagem visual se torna completamente subjetiva.
Além disso, a abordagem automática permite a estimativa de intervalos de confiança para os parâmetros. Essa quantificação da qualidade de ajustagem não pode ser feita na análise convencional.
7.2	— Aplicação do Método de Gauss-Marquardt com Funções de Penalidade
Resultados do Método de Gauss sem Funções de Penalidade
Estimativa Inicial (Unidades de Darcy)	Solução (Unidades de Darcy)	Número de Iterações	SQR (atm)2
k=	0,10 s =	15 C = 20 000	k = - 0,3546 x 10 s = - 0,7028 x 103 C= 0,27920 x 105	1	
k =	0,01 s =	20 C = 20 000	k = — 0,1589 x 10’2 s = - 0,2415 x 102 C= 0,21446 x 10s	1	
k =	0,01 s =	5 C = 20 000	k= 0,01536 s =	0,1466 x 102 C= 0,19823 x 105	5	1,638
k =	0,004 s =	5 C = 20 000	k= 0,01536 s =	0,1466 x 102 C= 0,19823 x 10s	8	1,638
Suponhamos que, para simplificar, sejam consideradas as mesmas restrições anteriormente impostas aos parâmetros a serem determinados:
0 &amp;lt;k (darcy) &amp;lt;1
0 &amp;lt;s	&lt;30
0 &amp;lt;C(cm3/atm) &amp;lt;6x106
Então, as funções de penalidade são as mesmas usadas na derivação do método para a estimativa de a, )3, s e C.
Empregando-se o mesmo conjunto de dados a partir do qual se construiu a tabela I, diversos exemplos foram rodados aplicando-se os métodos de Gauss e Gauss-Marquardt, com ou sem funções de penalidade (tabelas IV e V). O exemplo 6 da tabela V foi também rodado
com o valor inicial de À = 0,01, mas na primeira iteração a permeabilidade tornou-se negativa, apesar das restrições impostas.
7.3	— Discussão de Resultados
A comparação entre os resultados das tabelas IV e V permite as seguintes observações:
a)	Exemplo 1: para estimativas preliminares razoavelmente próximas da solução, os métodos de Gauss com e sem restrições convergem praticamente após o mesmo número de iterações;
b)	Exemplo 2: o método de Gauss com funções de penalidade pode convergir a partir de estimativas iniciais para as
quais o método de Gauss simples divergiría;
c)	Exemplo 3: a imposição de restrições sob a forma de funções de penalidade não é uma garantia de convergência. A utilização de outras constantes nos termos que definem as funções de penalidade, bem como de outros métodos para solução de problemas com restrição (métodos de projeção, por exemplo) podería aumentar a região de convergência do problema;
d)	Exemplo 4: o uso de restrições em alguns casos onde a estimativa inicial não é tão próxima da solução do problema pode apresentar a vantagem de requerer menor número de iterações até a convergência dentro do limite de acurácia prescrito;
e)	Exemplo 5: para estimativas prelimi-
TABELA V
Resultados dos Métodos de Gauss e Gauss-Marquardt com Funções de Penalidade
Exemplo	Método		Estimativa Inicial	Solução						N.° de Iterações	SQR (atm)2
			Sistema de Unidades de Darcy							
			k	s	C	k	s	C		
1			0,01	7,0	20 000	0,01537	14,67	19 823	4	1,638
2	Gauss		0,01	20,0	20 000	0,01537	14,67	19 823	5	1,638
3			0,10	15,0	20 000	negativo			1	
4			0,004	5,0	20 000	0,01537	14,67	19 823	6	1,638
5	Gauss-Marquardt	À = 0,01	0,004	5,0	20 000	0,01536	14,67	19 823	6	1,638
6		X= 100	0,10	15,0	20 000	0,01537	14,67	19 823	11	1,638
Fig. 3 - Evolução dos parâmetros do sistema poço-reservatôrio durante a estimativa automática.
Fig. 4 - Comportamento dos resíduos durante a estimativa automática dos parâmetros do sistema poço-reserva-tório.
nares com boa aproximação em relação à solução correta, o método de Gauss-Marquardt não apresenta visível vantagem sobre o de Gauss em termos de número de iterações;
f)	Exemplo 6: o método de Gauss-Marquardt fornece maior região de convergência do que o de Gauss. Eventualmente, o valor inicial necessário do parâmetro X no algoritmo de Marquardt pode ser consideravelmente maior que o normalmente recomendado, de 0,01.
Portanto, já que a inclusão das funções de penalidade e de variação de Marquardt requer tempo computacional adicional praticamente desprezível, seu uso é sempre recomendado, com a finalidade de aumentar a região de convergência. Isto é particularmente útil quando a estimativa inicial dos parâmetros é difícil devido à escassez de informações.
O comportamento dos diferentes métodos empregados acha-se ilustrado nas figuras 3 e 4, que apresentam os resultados, em cada iteração, para a estimativa inicial de k = 0,004 darcy, s = 5 e C = 20 000 cm3/atm.
A figura 3 apresenta a evolução dos
parâmetros k e s. O terceiro (C) não sofreu grandes variações durante o processo porque sua estimativa inicial foi razoavelmente bem aproximada. As tendências gerais nos comportamentos são similares, pois os princípios são idênticos para todos os métodos. Porém, facilmente se reconhecem os benefícios alcançados pelo uso das funções de penalidade, as quais impedem que a solução em cada iteração se afaste muito do caminho de maior velocidade de convergência e eventualmente se desvie para regiões fisicamente inconsistentes com a natureza do problema.
A figura 4 representa o comportamento dos resíduos. O método de Gauss-Marquardt mostrou-se o mais eficiente neste exemplo particular, porque a soma dos quadrados dos resíduos experimentou o mais rápido declínio inicialmente, permaneceu inferior aos demais durante todo o processo e convergiu para a mesma solução num menor número de iterações.
Cabe uma nota final a respeito da estimativa de k, s e C com base no método de Gauss: a matriz correlação mostrada na saída do programa de computador in
dicou que uma alta correlação entre k e s estava ainda presente neste exemplo específico, o que implica que a confiança nas estimativas (de k e s é menor do que na de C. Em outras palavras, podemos esperar intervalos de confiança relativamente grandes para k e s, como confirmado nos cálculos contidos em anexo. Além do mais, esta é uma característica não somente do conjunto de dados usado, mas também da própria essência do problema, já que surge da equação que governa o processo físico, em razão de a matriz correlação não depender dos dados de pressão.
8	- CONCLUSÕES
a) Embora a convergência para uma solução ótima não garanta unicidade, nem a convergência para duas ou mais soluções ótimas diferentes garanta não unicidade, a aplicação da técnica de regressão ao reservatório homogêneo infinito demonstrou que, para efeitos práticos, é impossível estimar mais de três parâmetros do sistema. Isto significa que a estimativa dos quatro parâmetros k, h, s e C por meio da ajustagem com as curvas tipo de fluxo não é factível, como indica
do pelas curvas de GRINGARTEN e outros (3). Além disso, os três parâmetros a serem determinados devem ser cuidadosamente escolhidos, de modo a não serem linearmente dependentes e a apresentarem as mínimas correlações possíveis durante o processo de regressão. Um conjunto de interesse na maioria dos casos práticos e que atende satisfatoriamente a essas exigências seria: permeabilidade (k), fator de película (s) e coeficiente de estocagem do poço (C);
b)	O método de Gauss-Marquardt mostrou-se necessário em casos de matrizes coeficientes altamente mal condicionadas e vantajoso em situações normais, requerendo tempo adicional de computação desprezível e aumentando a eficiência do processo em comparação com o método de Gauss;
c)	A imposição de restrições aos parâmetros é útil na aceleração da convergência, bem como na redução da possibilidade de divergência do procedimento iterativo;
d)	A principal vantagem da análise de regressão automática sobre a convencional é a interpretação simultânea de todo o conjunto de dados, e não a subintervalos, separadamente. Mesmo a região de transição entre a reta de inclinação unitária (somente efeitos de estocagem) e a linha reta semilog (sem efeitos de estocagem), para a qual não existe método convencional de interpretação, pode ser analisada pela técnica de regressão não-linear automatizada;
e)	Outros tipos de teste de pressão podem ser analisados com o recurso de técnica similar. Por exemplo, o teste de crescimento de pressão ou o teste de fluxo com vazões múltiplas podem ser interpretados aplicando-se o princípio da superposição de efeitos e a regressão não-linear à solução para a pressão no poço no teste de fluxo. A estimativa de parâmetros do sistema poço-reservatório em diferentes modelos físicos pode também ser implementada e investigada facilmente;
f)	Em qualquer interpretação, é sempre aconselhável o uso de certas técnicas aplicadas na análise convencional, antes da análise final automatizada. Isto pode fornecer, no mínimo, alguma idéia sobre os parâmetros desconhecidos, a qual pode ser usada como estimativa inicial no esquema iterativo. Nessa análise preliminar, podemos incluir os gráficos log-log, para estimativa do coeficiente de estocagem, e semilog, para estimativa da
permeabilidade e do fator de película. Além disso, tais gráficos podem indicar a presença de limites externos ou efeitos de heterogeneidade, os quais determinarão o tipo de modelo físico a ser empregado. Finalmente, pontos que se encontram claramente fora da tendência geral dos dados devem ser considerados um erro excessivo e excluídos da análise.
NOMENCLATURA
Símbolos Romanos
C = coeficiente de estocagem do poço, cm3/atm
ct = compressibilidade total do sistema, atm~1
3	= vetor solução na análise de re-
gressão não-linear
E = matriz de coeficientes no sistema de equações normais
EMQ = erro médio quadrado
ES = matriz de coeficientes E após a transformação de escala h = espessura de camada, cm hj = função de restrição no método das funções de penalidade
I	= matriz identidade
l0	= função de Bessel modificada de
primeira espécie e ordem zero lj = função de Bessel modificada de primeira espécie e ordem um
Ko = função de Bessel modificada de segunda espécie e ordem zero
Kj = função de Bessel modificada de segunda espécie e ordem um k	= permeabilidade, darcy
m	= inclinação da linha reta semilog
na análise convencional, atm n = número de pontos dados nC = número de camadas num sistema estratificado
np = número de parâmetros a serem estimados na regressão não-linear
P	=	probabilidade
p	=	pressão, atm
Pwf	=	Pressão de fluxo	de fundo,	atm
qsc	=	vazão total em	condições	pa-
drão, cm3/s
qt = vazão total de fluxo em condições de fundo de poço, cm3/s re	= raio externo, cm
rw	= raio do poço, cm
s = fator de película, adimensional SQR = soma de quadrados dos resíduos no método dos mínimos quadrados, atm2
J = tempo, s, ou distribuição de probabilidade
Ü = vetor no sistema de equações normais
—z
US = vetor U apos a transformação de escala
V* = erro médio padrão para a estimativa de um parâmetro não-linear
Z = argumento de uma função no domínio de Laplace
Símbolos Gregos
a
ai
0
A
= rw/\/Vj. s1Z2
= nível ae significação, fração
= kh/jU = transmissibilida-de, darcy-cm/cP
= diferença
Apwf = Pi - Pwf = Pueda de pressão no poço, atm
A Pwf]
[APwflt=1;.
= valor medido da queda de pressão no poço no
tempo t = tj, atm valor teórico da queda de pressão no poço no tem-
Apwf(Z)
5
P
X
r
V
po t = tj, atm
= Apwf((T, Z) = transformada de Laplace da queda de pressão no poço
= k/&lt;/&gt;M Ct = constante de difusividade hidráulica, cm2/s
= constante nas funções de penalidade
= função de penalidade
= fator de relaxação usado na técnica de interpola-ção-extrapolação
= parâmetro no método de Gauss-Marquardt
= vetor de np componentes, parâmetros do reservatório
= estimativa do vetor parâ-
metro
0
P
= porosidade da rocha-re-servatório, fração
= viscosidade do fluido no reservatório, cP
INDICES
e = externo
i = número de ordem de um ponto dado ou de uma iteração
j = número de ordem de uma camada num sistema estratificado
p = parâmetro
w = poço
wf= poço em fluxo
E - 01 = m
E - 03 = Pa.s
E - 01 = m
E + 03 = s
E - 02 = m
E — 16 = m2
E + 03 = Pa
FATORES DE CONVERSÁO DE UNIDADES PARA O SI
Sistema Americano
bbl x 1,589 873 cPx 1,0* ft x 3,048* h x 3,6* in x 2,54* mD x 9,869 233 psi x 6,894 757
Sistema de Darcy
atm x 1,01325	E + 05 = Pa
cm x 1,0*	E - 02 = m
darcy x 9,869 233 E — 13 = m2
REFERÊNCIAS BIBLIOGRÁFICAS
(J) JONES, P. Reservoir limit tests. O/7 Gas J., 54 (59): 184-96, June 18, 1956.
(2)	AGARWAL, R. G.; AL-HUSSAINY,
R. &amp;amp; RAMEY Jr., H. J. An investigation of wellbore storage and skin effect in unsteady liquid flow: I Analytical treatment. Soc. Pet. Eng. J., 10 (3): 279; Trans. Al ME, 249.
(3)	GRINGARTEN, A. C. et alii. A
comparison between different skin and wellbore storage typecurves for early-time transient analysis. Dallas, TX, SPE, 1979. (SPE paper 8205).
(4)	TARIQ, S. M. A study of the
behavior of layered reservoirs with wellbore storage and skin effect. Stanford, Stanford University, September 1977. Tese (Ph. D.) — Stanford University, Petroleum Engineering Department.
(s) JAHNS, H. 0. A rapid method for obtaining a two-dimensional reservoir description from well pressure response data. Soc. Pet. Eng. J., 6 (4): 315-27, Dec. 1966; Trans. AIME, 237.
(6)	COATS, K. H.; DEMPSEY, J. R. L. &amp;amp; HENDERSON, J. H. A new technique for determining reservoir description from field performance data. Soc. Pet. Eng. J., 10 (1): 66-74, Mar. 1970; Trans. AIME, 249.
* Fator de conversão exato.
(7)	EARLOUGHER Jr., R. C. &amp;amp;
KERSCH, K. M. Field examples of automatic transient test analysis. J. Pet. Techno!., 24 (10): 1271-7, Oct. 1972.
(8)	HERNANDEZ, V. M. &amp;amp; SWIFT,
G. W. A method for determining reservoir parameters from early drawdown data. Dallas, Texas, SPE, 1972. (SPE paper 3982).
(9)	CHEN, W. J. et alii. A new algo-
rithm for automatic history matching. Dallas, Texas, SPE, 1973. (SPE paper 4545); Trans. AIME, 257.
(10)	RODGERS, J. S. et alii. Nonlinear
well test analysis reveals reservoir boundary shape. 0/7 Gas J., 79 (37): 63-8, Sept. 14, 1981.
(n) STEHFEST, H. Numerical inversion of Laplace transforms. Communications of the ADM, 13 (1): Algorithm 368, Jan. 1970.
(12)	ROSA, A. J. Automated type curve
matching in well test analysis. Stanford, Stanford University, March, 1983. Tese (Sci. M.).
(13)	BARD, Y. Nonlinear parameter
estimation. New York, Academic Press, 1974.
(14)	WYLIE, C. R. Advanced engineering
mathematics. 4. ed. New York, McGraw-Hill, 1975.
(15)	MARQUARDT, D. W. An algo-
rithm for least-squares estimation of nonlinear parameters.
J.	Soc. Ind. Appt. Math., 7/(2), June, 1963.
(16)	EARLOUGHER Jr., R. C. &amp;amp;
KERSCH, K. M. Analysis of short-time transient test data by type-curve matching. J. Pet. Techno!., 26 (7): 793-800, July 1974; Trans. AIME, 257.
BIBLIOGRAFIA
ABRAMOWITZ, M. &amp;amp; STEGUN, J. A., ed. Handbook of mathematical functions. New York, Dover Publications, Inc., 1970.
AFIFI, A. A. &amp;amp; AZEN, S. P. Statistical analysis — a computer oriented approach. 2. ed. New York, Academic Press, 1979.
CHURCHILL, R. V. Operational mathematics. 3. ed. New York, McGraw-Hill, 1972.
EARLOUGHER Jr., R. C. Advances in well test analysis. Dallas, SPE of AIME, 1977. (Monograph series, v. 5).
KENNEDY Jr., W. &amp;amp; GENTLE, J. E.
Statistical computing. New York, M. Dekker, 1980.
MATTHEWS, C. S. &amp;amp; RUSSEL, D. G. Pressure buildup and flow tests in wells. Dallas, SPE of AIME, 1967. (Monograph series, v. 1).
RAMEY Jr., H. J. Short-time well test data interpretation in the presence of skin effect and wellbore storage. J. Pet. Technol., 22 (1): 97-104, Jan. 1980; Trans. AIME, 249.
SNEDECOR, G. W. &amp;amp; COCHRAN, W. G. Statistical methods. 7. ed. Ames, Iowa, The Iowa State University Press, 1980.
YOUNGER, M. S. A handbook for linear regression, .north Scituak, Mass., Duxbury Press, 1979.
AGRADECIMENTO
O autor deseja expressar sua gratidão à Petróleo Brasileiro S.A. — PETRO-BRÁS, pelo suporte financeiro que permitiu a realização deste estudo, como parte da tese de mestrado na Universidade de Stanford.
ANEXO
ESTIMATIVA DE INTERVALOS DE CONFIANÇA
PARA O MÉTODO DE GAUSS
É sempre desejável avaliar a qualidade da estimativa dos parâmetros do reservatório por meio de regressão não-linear. Em vez de fornecermos somente as melhores estimativas de ponto 6* para os vários parâmetros 0p, um modo mais útil é a determinação de intervalos para as estimativas, da forma j1, S [■, onde I e S são os limites inferior e superior dos parâmetros 0p, respectivamente. Esses intervalos serão funções do número de pontos dados e da confiança desejada.
Definindo as como o chamado "nível de significação", dizemos que a afirmativa "o valor verdadeiro do parâmetro 0p situa-se no intervalo j I, s| " tem uma probabilidade de (1 — as) de estar correta. O intervalo 11, S é denotado como um intervalo de 100 (1 — as) % de confiança.
De acordo com HARTLEY ('), é possível encontrar intervalos (ou regiões) de confiança exatos para os parâmetros não--lineares. No entanto, determinaremos somente intervalos de confiança aproximados, porque, além de ser muito mais simples, não há sentido em se estimar rigorosamente a resposta de um problema cujos dados nem sempre apresentam esse alto grau de precisão.
Inicialmente, definimos o erro médio quadrado:
EMQ =	(1)
n — np
onde n é o número de pontos dados, e np, o número de parâmetros.
O intervalo de confiança para o parâmetro 6p será dado por:
- t&lt;V2; n - np [V&amp;lt;^)]1/2; 0* + tQ,/2; n _ np [V* (9;)]1/2 j,	(2)
onde:
tas/2- n — np = val°r obtido da distribuição "t" para n — np graus de liberdade e tal que P j t &gt; tas/2- n — np [ = as72;
[V* (0*)]1/2 = \/EMQ.eijj = erro padrão da estimativa do parâmetro 0p;
eijj	= elementos da diagonal da matriz E-1;
E	= matriz cujos elementos são os coeficientes no sistema de equações normais resolvido na última iteração.
Trabalhemos com os resultados da tabela IV. As estimativas de ponto para os parâmetros do reservatório foram:
k*= 0,01537 darcy s* = 14,67 C*= 19 823cm3/atm
Para intervalos com 95% de confiança, teríamos:
100 (1 - as) = 95 ou as/2 = 0,025
O número de pontos utilizados foi n = 25. Portanto, o número de graus de liberdade é n — np = 25 — 3 = 22. De uma tabela da distribuição "t", obtém-se:
W2; n - np = ^,025; 22 = 2'074
Os elementos da diagonal da matriz E'1 foram obtidos da saída do computador:
ein = 0,1953936 x 10’4 ei22 = 0,3849717 x 102 ei33 = 0,2978872 x 106
A soma de quadrados dos resíduos foi SQR = 1,638 atm2, da qual calculamos o erro médio quadrado: EMQ = -SQR = 1'638 -= 0,074454
n — np 25 — 3
Para os erros padrão determinamos:
[V* (k*)]1/2 = x/EMQ . ein = 0,001206
[V* (s*)]1/2	= VEMQ . ei22 = 1,693
[V* (C*)]1/2 = VEMQ . ei33 = 148,9
Daí, os intervalos, calculados com 95% de confiança, são:
0,01286&amp;lt;k (darcy)&amp;lt;	0,01786
11,15	&amp;lt;s	&lt;	18,17
19514&amp;lt;C(cm3/atm)&amp;lt;	20132
Para maior confiança, por exemplo 99%, os intervalos cresceríam em comprimento. Evidentemente, eles são sempre dependentes da qualidade e do número de pontos usados. Quanto maior o número de informações, menor o intervalo de confiança e, conseqüentemente, maior a confiança nas estimativas de ponto.
Nesta altura, podemos explicar, a partir de um outro ponto de vista, o insucesso da estimativa dos parâmetros k, h, s e C. Desde que a matriz E era mal condicionada, os elementos de sua inversa apresentavam valores de grande magnitude, produzindo um valor elevado para o número de condição daquela matriz. Sendo os elementos da diagonal de E"1 extremamente grandes, os intervalos resultam tão largos que não existe confiança alguma nas estimativas dos parâmetros. Estas se tornam sem sentido, já que muitas soluções completamente diferentes e também aceitáveis podem ser encontradas.
I1) HARTLEY, H. O. Exact confidence regions for the parameters in nonlinear regression laws. Biometria, 51: 347, 1964.
</field>
	</doc>
</add>