<?xml version="1.0" encoding="utf-8"?>
<add>
	<doc>
		<field name="docid">BR-TU.23876</field>
		<field name="filename">8136_PauloMartinsBarbosaFortesManoelVC.pdf</field>
		<field name="filetype">PDF</field>
		<field name="text">
UNIVERSIDADE DE SA?O PAULO

FACULDADE DE ADMINISTRAC?A?O, ECONOMIA E CONTABILIDADE

DEPARTAMENTO DE ECONOMIA

PROGRAMA DE PO?S-GRADUAC?A?O EM ECONOMIA

Impacto de saltos no comportamento de prec?os de

commodities

Paulo Martins Barbosa Fortes Manoel

Orientador: Prof. Dr. Denisard Cneio de Oliveira Alves

JANEIRO 2013

Sa?o Paulo



Prof. Dr. Joa?o Grandino Rodas

Reitor da Universidade de Sa?o Paulo

Prof. Dr. Reinaldo Guerreiro

Diretor da Faculdade de Economia, Administrac?a?o e Contabilidade

Prof.a Dra. Elizabeth Maria Mercier Querido Farina

Chefe do Departamento de Economia

Prof. Dr. Pedro Garcia Duarte

Coordenador do Programa de Po?s-Graduac?a?o em Economia



Paulo Martins Barbosa Fortes Manoel

Impacto de saltos no comportamento de prec?os de commodities

Dissertac?a?o apresentada ao Depar-
tamento de Economia da Faculdade
de Economia, Administrac?a?o e Con-
tabilidade da Universidade de Sa?o
Paulo como requisito para a obten-
c?a?o do t??tulo de Mestre em Cie?ncias.

Orientador: Prof. Dr. Denisard Cneio de Oliveira Alves

JANEIRO 2013

Versa?o Corrigida

(versa?o original dispon??vel na Faculdade de Economia, Administrac?a?o e Contabilidade)

Sa?o Paulo



FICHA CATALOGRA?FICA
Elaborada pela Sec?a?o de Processamento Te?cnico SBD/FEA-USP

Manoel, Paulo Martins Barbosa Fortes
Impacto de saltos no comportamento de prec?os de commodities / Paulo

Martins Barbosa Fortes Manoel - Sa?o Paulo, 2012.
105 p.
Dissertac?a?o (Mestrado) - Universidade de Sa?o Paulo, 2011
Orientador: Denisard Cneio de Oliveira Alves.
1. Financ?as 2. Derivativos 3. Petro?leo
4. Me?todos MCMC 5. Bolsa de mercadorias

I. Universidade de Sa?o Paulo. Faculdade de Economia, Administrac?a?o
e Contabilidade. II. T??tulo.

CDD - 332



iii

Aos meus pais, Sergio e Laura



iv



v

AGRADECIMENTOS

A entrega deste trabalho encerra um per??odo que foi, de diversas maneiras, o mais frut??fero

da minha vida. No mestrado do IPE-USP vivi situac?o?es que promoveram meu amadu-

recimento acade?mico e pessoal: adquiri profundo conhecimento da teoria econo?mica com

verdadeiros professores e fiz amigos que, com toda certeza, levarei para toda a vida. Nada

mais justo, portanto, que agradecer todos aqueles que, de alguma maneira, me auxiliaram

nesta caminhada.

Comec?o agradecendo minha ma?e, Laura. Sem seu apoio e sua e?nfase nos estudos esta

dissertac?a?o jama?is seria consumada. Agradec?o tambe?m meus irma?os, Daniel e Andre?,

pela pacie?ncia nos tempos de elaborac?a?o deste trabalho, e meus avo?s, Marta e Claro, por

todo suporte e amor incondicional.

Agradec?o meu colega e grande amigo Eduardo Ros pela pacie?ncia na leitura deste trabalho

e por suas valiosas sugesto?es. Agradec?o tambe?m meu orientador, Ricardo Avelino, pela

sugesta?o do tema e pelos ensinamentos acerca da escrita de um trabalho cient??fico.

Registro aqui minha gratida?o e minha admirac?a?o aos meus companheiros de todos os

eventos, dos profanos aos eruditos, das noites na D-Edge a?s o?peras no Theatro Municipal,

Andre Zilio, Victor Westrupp e Andre Mazini, grandes amigos que lograram tornar a

passagem pelo mestrado prazerosa.

At last, but not at least, agradec?o aos amigos que fiz neste mestrado. Nossa unia?o foi

de tal modo intensa que formamos um grupo especial, carinhosamente chamado de PAR-

TIDINHO COPEIRO, composto pelos gau?chos bairristas Andre? Zilio e Eduardo Ros;

pelo sempre criativo Heleno; pelo arqueiro Maria?o; pelo dinamarque?s Victor; pelo felino

Joa?o; e pelo Cegonha, Eduardo. O mestrado termina aqui, mas nossa amizade permanece.



vi



vii

RESUMO

Neste trabalho analisa-se a releva?ncia de saltos no aprec?amento de derivativos de com-

modities atrave?s da comparac?a?o de dois modelos. O primeiro leva em considerac?a?o um

convenience yield com reversa?o a? me?dia, enquanto o segundo e? uma generalizac?a?o do pri-

meiro com saltos no prec?o a? vista. Ambos os modelos sa?o estimados por meio de uma

abordagem Bayesiana, sendo as distribuic?o?es a posteriori simuladas com o uso de te?c-

nincas da fam??lia MCMC. Dados de petro?leo, trigo e cobre sa?o utilizados para fins de

estimac?a?o. A ana?lise econome?trica indica significa?ncia estat??stica para saltos, mas na?o

encontrou-se evide?ncia significativa de que saltos melhoram o aprec?amento de derivativos.



viii



ix

ABSTRACT

In this work we analyze the relevance of jumps in the pricing of commodity contingent

claims by comparing two models. The first takes into account mean-reverting conveni-

ence yields, and the second is a generalization of the first with jumps in spot prices. Both

models were estimated using a Bayesian approach, and posterior distributions where si-

mulated using MCMC techniques. Oil, copper and wheat data where used for estimation

proposes. Econometric analysis indicates statistical significance for jumps, but we found

no strong evidence that jumps improve derivative pricing.



x



Sumario

Lista de Tabelas xiii

Lista de Figuras xv

1. Introduc?a?o . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 1

2. Modelos de aprec?amento . . . . . . . . . . . . . . . . . . . . . . . . . . . . 7

2..1 Modelo CYE . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 7

2..1.1 Equac?o?es de Estado . . . . . . . . . . . . . . . . . . . . . 7

2..1.2 Medida neutra ao risco . . . . . . . . . . . . . . . . . . . . 9

2..2 Modelo CYES . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 11

2..2.1 Equac?a?o de Estados . . . . . . . . . . . . . . . . . . . . . 11

2..2.2 Medida neutra ao risco . . . . . . . . . . . . . . . . . . . . 12

2..3 Aprec?amento de opc?o?es . . . . . . . . . . . . . . . . . . . . . . . . . 14

3. Modelo econome?trico . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 17

3..1 Me?todo de simulac?a?o . . . . . . . . . . . . . . . . . . . . . . . . . . 21

4. Descric?a?o dos dados . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 25

5. Resultados . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 31

5..1 Para?metros Estimados . . . . . . . . . . . . . . . . . . . . . . . . . 31

5..2 Comparac?a?o entre os modelos CYE e CYES . . . . . . . . . . . . . 39

5..2.1 Comparac?a?o da REQM para Contratos Futuros Fora da
Amostra . . . . . . . . . . . . . . . . . . . . . . . . . . . . 39

5..2.2 Normalidade dos Res??duos . . . . . . . . . . . . . . . . . . 41

5..2.3 Comparac?a?o das REQM para Prec?os de Opc?o?es . . . . . . 44

6. Conclusa?o . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 49

7. Ape?ndice . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 51

7..1 Aprec?amento de contratos futuros . . . . . . . . . . . . . . . . . . 51

7..2 Algoritmo LSM . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 57



xii

7..3 Prova de que a func?a?o de verossimilhanc?a pode ser ilimitada na
presenc?a de saltos . . . . . . . . . . . . . . . . . . . . . . . . . . . 61

7..4 Especificac?a?o Bayesiana . . . . . . . . . . . . . . . . . . . . . . . . 63

7..5 Deduc?a?o das distribuic?o?es a posteriori . . . . . . . . . . . . . . . . 65

7..5.1 Deduc?a?o de µm|??µm, ?q,?m,?, y . . . . . . . . . . . . . 65

7..5.2 Deduc?a?o de ?|???, ?q,?m,?, y . . . . . . . . . . . . . . . 66

7..5.3 Deduc?a?o de ??|????, ?q,?m,?, y . . . . . . . . . . . . . . . 67

7..5.4 Deduc?a?o de V ?2|??V , ?q,?m,?, y . . . . . . . . . . . . . 68

7..5.5 Deduc?a?o de ??m|????m, ?q,?m,?, y . . . . . . . . . . . . . 69

7..5.6 Deduc?a?o de ??2|??, ?q,?m,?, y . . . . . . . . . . . . . . 69

7..5.7 Deduc?a?o de ?|??, ?q,?m,?, y . . . . . . . . . . . . . . . . 70

7..5.8 Deduc?a?o de ?qi|?,{?qj}j 6=i,?m,?, y . . . . . . . . . . . . 70

7..5.9 Deduc?a?o de ?mi|?, ?q,{?mj}j 6=i,?, y . . . . . . . . . . . . 71

7..6 Descric?a?o do algoritmo MCMC . . . . . . . . . . . . . . . . . . . . 73

7..6.1 Simulac?a?o de ? . . . . . . . . . . . . . . . . . . . . . . . . 73

7..6.2 Simulac?a?o de ? . . . . . . . . . . . . . . . . . . . . . . . . 74

7..6.3 Simulac?a?o de {?i}Ni=i . . . . . . . . . . . . . . . . . . . . . 75

7..6.4 Algoritmo de MCMC completo . . . . . . . . . . . . . . . 77

7..7 Exemplo das cadeias de Markov: modelo CYES e dados de cobre . 79

8. Bibliografia . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 85



Lista de Tabelas

1 Valores teo?ricos para opc?o?es americanas e europeias no modelo CYES . . . 15

2 Estat??sticas descritivas dos dados de petro?leo . . . . . . . . . . . . . . . . . 25

3 Estat??sticas descritivas dos dados de trigo . . . . . . . . . . . . . . . . . . . 28

4 Estat??sticas descritivas dos dados de cobre . . . . . . . . . . . . . . . . . . 29

5 Estimac?a?o dos modelos CYE e CYES para dados de petro?leo . . . . . . . . 32

6 Estimac?a?o dos modelos CYE e CYES para dados de trigo . . . . . . . . . . 35

7 Estimac?a?o dos modelos CYE e CYES para dados de cobre . . . . . . . . . 36

8 Comparac?a?o entre erros de previsa?o dos modelos CYES e CYE estimados
com os dados de petro?leo do painel A . . . . . . . . . . . . . . . . . . . . . 39

9 Comparac?a?o entre erros de previsa?o dos modelos CYES e CYE estimados
com os dados de petro?leo trigo . . . . . . . . . . . . . . . . . . . . . . . . . 40

10 Comparac?a?o entre erros de previsa?o dos modelos CYES e CYE estimados
com os dados de cobre . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 40

11 Medidas de normalidade para os res??duos da equac?a?o do prec?o a? vista . . . 43

12 Medidas de normalidade para os res??duos da equac?a?o do convenience yield 43

13 Comparac?a?o entre erros de previsa?o dos modelos CYES e CYE para dados
de opc?o?es de futuros de petro?leo . . . . . . . . . . . . . . . . . . . . . . . . 45

14 Especificac?a?o das distribuic?o?es a posteriori nos modelos CYE e CYES . . . 64



xiv



Lista de Figuras

1 Maturidades histo?ricas dos contratos futuros de petro?leo do painel A . . . 26

2 Nu?mero me?dio de negociac?o?es do contrato F11 em um dia . . . . . . . . . 27

3 Nu?mero de negociac?o?es do contrato F7 em um dia . . . . . . . . . . . . . . 28

4 Me?dias e intervalos de confianc?a para as varia?veis de estado no modelo
CYES utilizando os dados de petro?leo do painel B . . . . . . . . . . . . . . 33

5 Estimativas da probabilidade e da magnitude dos saltos para dados do
painel B de petro?leo . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 34

6 Me?dias e intervalos de confianc?a para as varia?veis de estado no modelo
CYES utilizando os dados de cobre . . . . . . . . . . . . . . . . . . . . . . 36

7 Estimativas da probabilidade e da magnitude dos saltos para dados de trigo 38

8 QQ plot para os res??duos das equac?o?es de estado para dados de cobre . . . 41

9 QQ plot para os res??duos das equac?o?es de estado para dados de petro?leo
do painel A . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 42

10 Evoulc?a?o histo?rica da amostra de opc?o?es americanas de petro?leo e do con-
trato futuro F1 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 45

11 Dados de mercado e previso?es para o contrato CLF1C 95.00 . . . . . . . . 46

12 Simulac?a?o de µm|y utilizando o modelo CYES e dados de cobre . . . . . . 79

13 Simulac?a?o de ?|y utilizando o modelo CYES e dados de cobre . . . . . . . 80

14 Simulac?a?o de ?|y utilizando o modelo CYES e dados de cobre . . . . . . . 80

15 Simulac?a?o de ?S|y utilizando o modelo CYES e dados de cobre . . . . . . . 81

16 Simulac?a?o de ??|y utilizando o modelo CYES e dados de cobre . . . . . . . 81

17 Simulac?a?o de ?|y utilizando o modelo CYES e dados de cobre . . . . . . . 82

18 Simulac?a?o de ??|y utilizando o modelo CYES e dados de cobre . . . . . . . 82

19 Simulac?a?o de V |y utilizando o modelo CYES e dados de cobre . . . . . . . 83

20 Simulac?a?o de ?|y utilizando o modelo CYES e dados de cobre . . . . . . . 83

21 Simulac?a?o de ??m|y utilizando o modelo CYES e dados de cobre . . . . . . 84

22 Simulac?a?o de ?|y utilizando o modelo CYES e dados de cobre . . . . . . . 84



xvi



1

1. Introduc?a?o

O objetivo deste trabalho e? responder a seguinte questa?o: sa?o os saltos relevantes para o

aprec?amento de derivativos de commodities ? Esta pergunta e? motivada por uma se?rie de

artigos que encontram evide?ncia emp??rica a respeito da existe?ncia de pre?mio de risco de

saltos nos prec?os de opc?o?es de ac?o?es, como Gurdip Bakashi &amp;amp; Chen (1997), Bates (1991)

e Pan (2002). Nenhum estudo a este respeito, no entanto, foi efetuado para o mercado de

commodities, que goza de caracter??sticas distintas a?quelas dos mercados de ac?o?es e requer

uma ana?lise espec??fica.

A principal particularidade do mercado de commodities na?o compartilhada por outros

mercados, como o de ac?o?es ou o de juros, e? que a sua posse f??sica pode representar um

benef??cio ou um custo para o detentor. Os mecanismos que determinam estes custos e estes

benef??cios, assim como seus impactos nos prec?os futuros, sa?o contemplados pela chamada

teoria do armazenamento de Working (1949). Esta teoria sustenta que, quando o n??vel

total de estoque de determinada commodity e? alto, armaze?ns disponiveis sa?o mais escassos,

o que implica em um custo de armazenamento mais elevado; nesta situac?a?o os prec?os

futuros devem ser, por na?o arbitragem, mais elevados que o prec?o a? vista multiplicado

pela taxa de juros livre de risco, um feno?meno conhecido como contango. Por outro lado,

se o n??vel de estoques da commodity e? baixo, armaze?ns livres seriam mais abundantes e,

consequentemente, o custo de carrego estaria abaixo do fluxo de servic?os providenciado

pelo armaze?m1 e do potencial benef??cio que a posse f??sica da commodity traz como a

possibilidade de tomar vantagem de flutuac?o?es locais de prec?os e de demandas locais

por produtos processados; neste caso os prec?os futuros devem situar-se abaixo do prec?o

a? vista multiplicado pela taxa de juros livre de risco, num feno?meno conhecido como

backwardation.

1O fluxo de servic?os providenciado por um armaze?m pode compreender processamento, transporte e
publicidade, entre outros. Uma ana?lise mais detalhada destes servic?os pode ser encontrada em Working
(1949)



2

O benef??cio l??quido da posse f??sica de uma commodity na?o usufru??do pelo detentor de

um contrato futuro e?, portanto, um conceito chave na explicac?a?o da estrutura a termo

de prec?os de commodities, recebendo o nome de convenience yield. Esta varia?vel possui

papel central em estudos recentes acerca do mercado de commodities. Black (1976) a

assume constante e calcula fo?rmulas fechadas para prec?os de contratos futuros e de opc?o?es

europeias. Gibson &amp;amp; Schwartz (1990) mostra que um modelo de dois fatores, com um

processo de reversa?o a? me?dia para o convenience yield, pode explicar os prec?os de contratos

futuros com razoa?vel precisa?o. Schwartz (1997), por fim, generaliza o modelo anterior com

a inclusa?o de taxas de juros estoca?sticas com reversa?o a? me?dia.

Nos modelos acima citados, prec?os seguem uma trajeto?ria continua. Ao verificar a re-

leva?ncia de saltos no aprec?amento de commodities este trabalho tambe?m analisa se esta

hipo?tese e? va?lida ou impo?e restric?o?es excessivas a? dina?mica estoca?stica dos prec?os de

commodities, gerando insumos para pesquisas futuras.

A significa?ncia de saltos no aprec?amento de derivativos e? testada atrave?s da estimac?a?o de

um modelo de prec?os de commodities que contempla um convenience yield que reverte

a? uma me?dia de longo prazo e prec?os a? vista com saltos. Este modelo foi introduzido

por Hilliard &amp;amp; Reis (1998) em uma abordagem teo?rica, onde sa?o deduzidas fo?rmulas

fechadas para prec?os de contratos futuros e de opc?o?es europeias, mas sem uma tentativa

de estimac?a?o de seus para?metros. E? tambe?m estimado o modelo ana?logo sem saltos,

como em Gibson &amp;amp; Schwartz (1990), para em seguida comparar a adere?ncia de ambos os

modelos aos prec?os de derivativos observados no mercado.

A estimac?a?o de modelos com saltos envolve certas dificuldades te?cnicas e deve ser efetu-

ada com precauc?a?o. Usualmente, para?metros de modelos de aprec?amento sa?o estimados

por ma?xima verossimilhanc?a. Este me?todo, no entando, perde sua validade no contexto

de precessos com saltos. Honore? (1998) mostra que, no processo de saltos de Merton

(1976), a func?a?o de verossimilhanc?a e? ilimitada, de modo que o estimador de ma?xima

verossimilhanc?a sequer esta? definido. Honore? (1998) propo?e um estimador consistente



3

para os para?metros do modelo de Merton (1976), dependendo de algumas especificac?o?es

do modelo. Uma poss??vel soluc?a?o mais geral, adotada neste trabalho, e? o uso de uma

distribuic?a?o a priori para os para?metros, numa abordagem de estimac?a?o Bayesiana. Tal

distribuic?a?o e? capaz de eliminar as singularidades da func?a?o de verossimilhanc?a que ocor-

rem na fronteira do espac?o parame?trico onde a varia?ncia dos termos de erro aproximam-se

de zero. Neste ponto, o problema de estimac?a?o se reduz ao problema computacional do

ca?lculo de momentos da distribuic?a?o de probabilidade a posteriori.

Um ferramental indicado para lidar com ca?lculos envolvendo distribuic?o?es de probabilidade

de altas dimenso?es (como e? o caso da distribuic?a?o a posteriori deste trabalho) na literatura

econome?trica e? o da classe de algoritmos das Cadeias de Markov via Monte Carlo (MCMC

segundo a abreviac?a?o em ingle?s). Esta fam??lia prove? me?todos gerais e elegantes para

simular uma determinada distribuic?a?o de probabilidade atrave?s da construc?a?o de uma

cadeia de Markov com propriedades de converge?ncia deseja?veis. A ideia ba?sica consiste em

armazenar uma cadeia suficientemente grande de valores correlacionados que satisfazem a

uma lei dos grandes nu?meros apropriada, de modo que momentos da distribuic?a?o original

podem ser aproximados com arbitra?ria precisa?o.

A construc?a?o da citada cadeia de Markov envolve a selec?a?o de uma densidade geradora

de candidatos para cada para?metro (ou para cada bloco de para?metros, dependendo de

como o algoritmo for desenhado), sendo o algoritmo final composto por uma sequencia de

passos de amostragens para cada (bloco de) para?metro(s). Para uma densidade geradora

de candidatos gene?rica o passo do algoritmo recebe o nome de Metropolis-Hastings. Se,

no entanto, formos capazes de gerar amostras da verdadeira distribuic?a?o marginal do

para?metro (ou bloco de para?metros) em questa?o, o passo do algoritmo recebe o nome

de Gibbs-Sampling, um caso particular dos algoritmos de Metropolis-Hastings. Me?todos

de Gibbs-Sampling sa?o deseja?veis em relac?a?o a me?todos gene?ricos de Metropolis-Hastings

pois, em geral, logram gerar cadeias de menor auto-correlac?a?o. Sua viabilidade pra?tica

depende, no entanto, da possibilidade de gerar amostras das distribuic?o?es marginais, o

que nem sempre e? poss??vel.



4

A varia?vel a ser simulada neste trabalho e? a distribuic?a?o conjunta dos saltos, dos para?-

metros e das varia?veis latentes (o prec?o a? vista e o conveniene yield ) condicionados aos

valores das varia?veis de medida, os contratos futuros negociados nas bolsas de futuros.

Utilizou-se um algoritmo de simulac?a?o da fam??lia MCMC que consiste de uma mistura de

passsos do tipo Metropolis-Hastings gene?rico e de passos do tipo Gibbs-Sampling, sempre

adotando o u?ltimo quando poss??vel. As varia?veis latentes foram simuladas por meio do

me?todo de Jong &amp;amp; Shephard (1995), que permite a amostragem de um se?rie de varia?veis

de estado que satisfazem as hipo?teses do filtro de Kalman cla?ssico.

Os momentos da distribuic?a?o a posteriori foram calculados utilizando-se dados de petro?leo,

cobre e trigo. Econtrou-se significa?ncia estat??stica para saltos nos dados de petro?leo e trigo.

Ademais, identifiou-se um salto percentual me?dio signficantemente positivo para os dados

de trigo, em contraste com a literatura de saltos em prec?os de ac?o?es que, via de regra,

encontra saltos me?dios negativos.

Visando mensurar o ganho que a inclusa?o do termo de salto representa em relac?a?o ao mo-

delo sem saltos, compara-se neste trabalho suas performances em termos de aprec?amento

de derivativos fora da amostra de estimac?a?o. Esta ana?lise foi efetuada utilizando-se (1)

contratos futuros com maturidades fora do intervalo de estimac?a?o e (2) opo?es americanas

em futuros de petro?leo. A ana?lise da ra??z quadrada do erro quadra?tico me?dio (REQM)

mostra que o modelo com saltos apresenta uma pequena, pore?m estatisticamente insig-

nificante, vantagem no aprec?amento de contratos futuros. A comparac?a?o dos erros de

previsa?o dos prec?os de opc?o?es americanas tambe?m na?o mostra uma melhor adere?ncia do

modelo com saltos, indicando que, no caso de commodities, saltos na?o apresentam a mesma

releva?ncia no aprec?amento de derivativos que aquela verificada no mercado de ac?o?es.

Este trabalho esta? organizado da seguinte maneira. Os modelos teo?ricos de aprec?amento

de commodities, em suas verso?es com e sem saltos, assim como os resultados ba?sicos

acerca do aprec?amento de derivativos utilizados neste trabalho, encontram-se na sec?a?o 2.

O modelo econome?trico e o me?todo de simulac?a?o da distribuic?a?o a posteriori sa?o estudados



5

na sec?a?o 3. A descric?a?o das bases de dados de petro?leo, cobre e trigo e? feita ne sec?a?o 4. Os

resultados da ana?lise econome?trica e a comparac?a?o dos modelos com saltos e sem saltos

em termos de aprec?amentos de derivativos e de normalidade dos res??duos econtram-se na

sec?a?o 5.



6



7

2. Modelos de aprec?amento

Nesta sa?o estudados, de um ponto de vista estritamete teo?rico, dois modelos. O primeira

leva em considerac?a?o um convenience yield com reversa?o a? uma me?dia de longo prazo e

foi intrduzido por Gibson &amp;amp; Schwartz (1990). O segundo e? uma generalizac?a?o do primeiro

incorporando saltos no prec?o a? vista e foi introduzido por Hilliard &amp;amp; Reis (1998). Ambos os

modelos sa?o de simples manipulac?a?o e possuem fo?rmulas fechadas para prec?os de contratos

futuros.

Ao longo deste trabalho, o primeiro modelo sera? denominado modelo de convenience yield

estoca?stico (CYE). Ja? o segundo modelo sera? denominado modelo de convenience yield

estoca?stico com saltos (CYES). Ambos os modelos supo?e que (1) transac?o?es ocorrem

continuamente no tempo; (2) na?o existem custos de transac?a?o, taxas ou restric?o?es para

posic?o?es vendidas; e (3) a taxa de juros livre de risco e? uma constante r.

2..1 Modelo CYE

2..1.1 Equac?o?es de Estado

Este modelo possui duas varia?veis de estado: o prec?o a? vista da commodity, S, e o conveni-

ence yield instanta?neo, ?, que atua como um fluxo de servic?os ao detentor da commodity.

Supo?e-se que a lei de movimento destas varia?veis e? dada pelas seguintes equac?o?es de

difusa?o:

dS = (µ? ?)Sdt + ?SSdZS (2.1)

d? = ?(?? ?)dt + ??dZ? (2.2)

onde (1) µ e? o retorno de longo prazo1 da commodity ; (2) ? e? a me?dia de longo prazo

1O retorno de longo prazo da commodity sera? a soma do fluxo de servic?os ? com a variac?a?o esperada
para o prec?o, µ? ?.



8

do convenience yield ; (3) ? e? a velocidade de ajustamento do convenience yield a? sua

me?dia de longo prazo; (4) ?S e ?? sa?o os devios padra?o dos termos de erro das equac?o?es

do prec?o a? vista e do convenience yield, respectivamente; e (5) dZS e dZ? sa?o movimentos

Brownianos correlacionados por ?S?.

O retorno de longo prazo µ deve, idealmente, estar acima da taxa de juros livre de risco

r, pois um fato estilizado a respeito do mercado de commodities e? que seus prec?os tendem

a acompanhar o ciclo econo?mico.

A me?dia de longo prazo para o convenience yield, ?, encontra uma interpretac?a?o na teoria

do armazenamento: quanto maior seu valor, maior e? o benef??cio l??quido me?dio em mante?-la

estocada e menores sa?o os custos me?dios de armazenamento.

Para poder capturar certos fatos estilizados acerca do mercado de commodities, onde

situac?o?es de contango e backwardation ocorrem de maneira alternada no tempo, devemos

permitir que ? oscile em torno de sua me?dia ?. A velocidade com que ? reverte a? sua

me?dia e? dada pelo para?metro ?; isto e?, apo?s um choque ??dZ?, ? retornara? para sua me?dia

? mais rapidamente para valores maiores de ?1.

O para?metro de correlac?a?o entre os termos de erro do prec?o e do convenience yield, ?S?,

e? esperado positivo pela teoria do armazenamento, pois ambos os choques resultam de

movimentos no n??vel total de estoques da commodity. Numa situac?a?o de aumento do

n??vel de estoques o prec?o a? vista deve, para manter o equil??brio entre oferta e demanda,

diminuir; simultaneamente, armaze?ns disponiveis devem tornar-se mais escassos, o que

implicara? em um aumento do custo de estocagem e em uma diminuic?a?o do convenience

yield. O racioc??nio no caso de uma diminuic?a?o do n??vel total de estoques e? ana?logo e leva

a um aumento tanto do prec?o a? vista quanto do convenience yield.

1Com efeito, a meia-vida deste processo, isto e?, o tempo me?dio necessa?rio para que ? atinja o ponto
me?dio entre ? e ?, sera? inversamente proporcional a ?.



9

2..1.2 Medida neutra ao risco

Esta subsec?a?o trata de uma breve discussa?o da medida neutra ao risco e do aprec?amento

dos contratos futuros no modelo CYE, necessa?ria para o objetivo dste trabalho de com-

parar o aprec?amento de drivativos entre os modelos com saltos e sem saltos. Uma ana?lise

pormenorizada pode ser encontrada em Bjerksund (1991) ou no ape?ndice 7..1.

Utilizando o Lemma de Ito e definindo X = log(S) a equac?a?o do prec?o a? vista toma a

seguinte forma:

dX =
(
µ? ? ?

1

2
?2S

)
dt + ?SdZS. (2.3)

Neste modelo, o convenience yield instanta?neo ? funciona da mesma maneira que um fluxo

de dividendos. Consequentemente, o termo de tende?ncia da equac?a?o do prec?o a? vista na

medida neutra ao risco toma a forma r??, onde r e? a taxa de juros livre de risco, suposta

constante. Logo, o processo para as varia?veis de estado na medida neutra ao risco toma

a forma

dX? = (r ? ?)dt + ?SdZ?S (2.4)

d?? = [?(?? ?) ???]dt + ??dZ?? (2.5)

onde ?? e? o prec?o do risco do convenience yield
1. Neste trabalho seguiremos a hipo?tese de

Schwartz (1997) de que ?? e? constante. Este pressuposto e? feito com o intuito de manter

o modelo o mais simples poss??vel e de na?o tornar o processo de estimac?a?o excessivamente

complexo; e? perfeitamente razoa?vel, no entanto, que ?? esteja relacionado com as varia?veis

de estado ou com o ciclo econo?mico, e possive??s parametrizac?o?es de ?? podem motivar

pesquisas futuras.

Seja F(T,S,?) o prec?o de um contrato futuro distando T anos da maturidade. Pode-se

1O para?metro ?? pode ser intepretado como o custo de securitizac?a?o do risco de variac?a?o do convenience
yield e deve ser, idealmente, positivo.



10

mostrar que, escolhendo uma combinac?a?o adequada deste contrato futuro e da commodity

subjacente, obte?m-se um portfolio livre de risco. Por na?o arbitragem, este portfolio devera?

ter como retorno a taxa de juros livre de risco. Igualando estes retornos obte?m-se a

seguinte equac?a?o de derivadas parciais:

1

2
FSS?

2
SS

2 +
1

2
F???

2
? + FS?S?S???S? + FSS(r ? ?) + F?[(?? ?) ???] ?Ft = 0. (2.6)

Bjerksund (1991) resolve esta equac?a?o analiticamente, obtendo a seguinte fo?rmula fechada

para os prec?os futuros:

log(F(T)) = X ? ?
1 ?e??T

?
+ A(T) (2.7)

onde A(T) na?o depende das varia?veis de estado e seu valor pode ser encontrado no ape?ndice

7..1 (fo?rmula 7.70).

Esta relac?a?o linear entre as varia?veis de estado e os prec?os futuros tem consequencias

relevantes para a estrutura a termo de prec?os de commodities. Note, primeiramente, que

mudanc?as no prec?o a? vista implicam em deslocamentos paralelos da curva de log-prec?os

futuros. Logo, qualquer tipo de mudanc?a na inclinac?a?o da curva de log-prec?os deve estar,

necessariamente, atrelada a uma variac?a?o do convenience yield instanta?neo. Outro fato

interessante e? que, quanto maior a maturidade do contrato, ou quanto maior a velocidade

de reversa?o a? me?dia ?, menor e? o impacto do convenience yield no prec?o futuro. Isso

decorre do fato de que, nestas situac?o?es, o valor do convenience yield instanta?neo prove?

pouca informac?a?o a respeito da sua trajeto?ria futura.

A equac?a?o 2.7 mostra ainda que o modelo ECY contempla situac?o?es de backwardation e

de contango. Com efeito, como 1?e
??T

?
&gt; 0, prec?os futuros sera?o maiores (menores) que

o prec?o a? vista multiplicado pela taxa de juros para ? positivo (negativo) suficientemente

grande em mo?dulo, caracterizando contango (beckwardation).



11

2..2 Modelo CYES

2..2.1 Equac?a?o de Estados

Este modelo generaliza o modelo CYE de uma maneira natural para contemplar saltos

no prec?o a? vista como em Merton (1976), Bates (1991) e Hilliard &amp;amp; Reis (1998). Ale?m do

convenience yield estoca?stico e do prec?o a? vista, duas novas varia?veis de estado sa?o incor-

poradas ao modelo: o nu?mero de saltos realizados, q, seguindo um processo de Poisson,

e o valor (percentual) do salto, ?, seguindo uma distribuic?a?o log-normal. Uma maneira

de pensar este modelo e? que, em quase todos os instantes de tempo, o prec?o a? vista e o

convenience yield seguem o processo de difusa?o do modelo CYE. Quando os saltos sa?o

acionados, sempre em instantes discretos, o prec?o a? vista se move de maneira descontinua

com incremento ?S = ?S.

Mais precisamente, ale?m das hipo?teses de taxa de juros constante, de negociac?o?es realiza-

das continuamente no tempo e de ause?ncia de custos de transac?a?o ou de taxas, supo?e-se

que as varia?veis de estado (S,?,q,?) seguem as equac?o?es 2.2 e

dS

S
= (µ? ? ????)dt + ?SdZS + ?dq. (2.8)

onde (1) µ e? o retorno de longo prazo da commodity ; (2) q e? um processo de Poisson com

para?metro de intensidade (anualizado) ?; (3) log(1 + ?) segue distribuic?a?o normal com

me?dia log(1 + ??) ? 0.5?2 e desvio padra?o ?.

O para?metro de intensidade de Poisson, ?, representa a quantidade esperada de saltos

em um ano e, caso saltos sejam eventos de baixa frequencia, na?o deve possuir grande

magnitude.

O para?metro ??, como ja? foi dito, representa o choque percentual me?dio nos prec?os quando

o salto e? acionado. Na?o ha? uma expectativa a priori para seu sinal, podendo inclusive ser

nulo no caso de saltos sime?tricos.



12

2..2.2 Medida neutra ao risco

Como Merton (1976) observou, neste modelo na?o e? poss??vel construir uma carteira livre de

risco composta pela commodity e por uma cesta de derivativos com as hipo?teses feitas ate?

o momento: em qualquer carteira deste ge?nero restaria um risco de salto na?o securitiza?vel.

Para proceder com o aprec?amento de derivativos por na?o arbitragem, fundamental para

a comparac?a?o entre os modelos CYE e CYES, sera?o necessa?rios pressupostos adicionais.

Na literatura de saltos ha? dois poss??veis conjuntos de hipo?teses que permitem a deduc?a?o

da medida neutra ao risco e o consequente ca?lculo de prec?os de derivativos. Ambos sera?o

enunciados nesta subsec?a?o.

O primeiro trabalho a obter fo?rmulas de derivativos para este tipo de processo foi Merton

(1976). Este trabalho contorna o problema dos saltos na?o securitiza?veis supondo que (1)

o CAPM e? uma descric?a?o va?lida para o equil??brio do mercado de ativos e (2) o risco do

saltos na?o e? siste?mico. A hipo?tese (2) e?, neste trabalho, justificada no caso de ac?o?es de

uma u?nica companhia pelo argumento de que saltos seriam causados por novas informac?o?es

disponibilizadas e, sendo este um efeito firma-espec??fico, na?o influenciaria o mercado como

um todo. Logo, no arcabouc?o do CAPM, tal risco poderia ser eliminado sem custos.

O me?rito destas hipo?teses e? sua simplicidade, mas carecem de realismo no caso do mercado

commodities. Nota-se que tal mercado e? composto por grandes grupos de mate?rias-primas

e, sendo cada um destes grupos de elevado valor financeiro total, na?o parece razoa?vel

considera?-los partes desprez??veis da carteira de mercado.

Hipo?teses alternativas sa?o feitas por Bates (1991) para estimar um modelo de saltos para

o ??ndice S&amp;amp;P 500, num contexto em que a existe?ncia de risco de saltos na?o siste?mico e?

extremamente inveross??mil. Suas hipo?teses, que sera?o adotadas neste trabalho, referem-

se ao lado da demanda por ativos, sendo: (1) os agentes poupadores sa?o homoge?neos;

(2) a renda otimamente investida por estes agentes segue um processo de difusa?o com

saltos simulta?neos aos saltos do prec?o do ativo estudado; e (3) a utilidade do agente

representativo e? separavel no tempo, com aversa?o ao risco constante.



13

Com estas hipo?teses Bates (1991) deduz a equac?a?o de movimento para o prec?o a? vista na

medida neutra ao risco. A adaptac?a?o do seu argumento para o modelo de commodities,

feita por Hilliard &amp;amp; Reis (1998), e? trivial e corresponde a? seguinte equac?a?o:

dS?

S?
= (r ? ? ??????)dt + ?SdZS + ??dq?. (2.9)

onde, na medida neutra ao risco, dq? e? um processo de Poisson com para?metro de inten-

didade ?? e ??? segue uma distribuic?a?o log-normal de me?dia ???.

A respeito dos para?metros de salto na medida neutra ao risco, Bates (1991) observa que

“the true parameters (...) do not differ qualitatively or quantitatively from

risk-neutral parameters”

Suporemos, enta?o, que ?? = ? e que ??? = ??. Utilizamos este pressuposto porque, como

sera? visto, o processo de estimac?a?o deste trabalho na?o permite a estimac?a?o dos para?metros

de saltos na medida neutra ao risco. Eles sera?o, no entanto, utilizados no aprec?amento

de opc?o?es no modelo CYES. Note que, utilizando estas hipo?teses, chegamos aos mesmos

resultados que aqueles obtidos com os pressupostos de Merton (1976).

O ca?lculo do prec?o de contratos futuros e? extremamente simples e segue o argumento

de Hilliard &amp;amp; Reis (1998). Sejam S?? e S? as trajeto?rias (estoca?sticas) do prec?o a? vista

na medida neutra ao risco nos modelos CYE e CYES, respectivamente. Como vale que

E?(??dq?) = ??? (onde E? representa o operador esperanc?a na medida neutra ao risco)

deve-se ter, necessariamente, que E?(S?T ) = E
?(S??T ), uma igualdade entre os prec?os de

contratos futuros com maturidade em T em ambos os modelos.

Logo, o prec?o de contratos futuros no modelo CYES e? dado pela equac?a?o 2.7. Isto se

deve ao fato de que satos alteram a curtose e a assimetria dos prec?os no futuro segundo

a medida neutra ao risco, mas na?o mudam sua me?dia. O aprec?amento de opc?o?es, no

entanto, apresenta certas mudanc?as, como sera? discutido da pro?xima sec?a?o.



14

2..3 Aprec?amento de opc?o?es

Uma das grandes dificuldades relacionadas ao uso de opc?o?es para comparar os modelos

CYE e CYES e? o de que, em geral, a liquidez do mercado de opc?o?es de commodities

concetra-se em opc?o?es americanas, cujo aprec?amento e? ainda um desafio para a teoria de

derivativos financeiros.

Diferentemente das opc?o?es europeias, que tem uma data fixa para seu exerc??cio, opc?o?es

americanas podem ser exercidas durante todo o intervalo de tempo ate? seu vencimento.

Isto implica que seu aprec?amento deve levar em conta a distribuic?a?o de probabilidade do

prec?o em todos os instantes de tempo ate? a sua maturidade, e na?o apenas a distribuic?a?o

da data do vencinto, como no caso de opc?o?es europeias. Tal aprec?amento e?, portanto,

extremamente mais complexo e raramente logra obter fo?rmulas anal??ticas fechadas.

Usualmente, prec?os de opc?o?es americanas sa?o calculados por meio de me?todos nume?ricos.

Os me?todos mais utilizados, como o de diferenc?as finitas e o da a?rvore binomial, na?o sa?o

adequados para este trabalho pois, como observa Longstaff &amp;amp; Schwartz (2001),

“(...) finite difference and binomial techniques become impractical in situations

where there are multiple factors.”

Para fins de ca?lculo de prec?os de opc?o?es de compra americanas, sera? utilizado neste traba-

lho o chamado me?todo de m??nimos quadrados de Monte Carlo (LSM, segundo a sigla em

ingle?s) de Longstaff &amp;amp; Schwartz (2001). Este me?todo consiste dos seguintes passos: (1)

simulac?a?o de Z trajeto?rias das varia?veis de estado segundo a medida neutra ao risco; (2)

estimac?a?o recursiva do valor de na?o exercer a opc?a?o em cada instante por meio de m??nimos

quadrados ordina?rios; (3) ca?lculo do prec?o da opc?a?o em cada instante e em cada trajetora

como o ma?ximo entre o valor de na?o exerc??cio e o valor de exerc??cio; e (4) ca?lculo do prec?o

atual como a me?dia (entre todas as Z trajeto?rias) dos prec?os no momento imediatamente

seguinte, descontados pela taxa de juros livre de risco.



15

Para fins de ilustrac?a?o, exibe-se na tabela 1 os valores teo?ricos para prec?os de opc?o?es

europeias (segundo a fo?rmula fechada de Hilliard &amp;amp; Reis (1998)) e americanas (calculadas

pelo me?todo LSM) de um contrato futuro da commodity para diferentes configurac?o?es dos

para?metros e das varia?veis de estado.

Para?metros S = 35,? = ?0.1 S = 45,? = ?0.05 S = 35,? = 0.05 S = 45,? = 0.1
? ?? ?? Euro. Amer. Euro. Amer. Euro. Amer. Euro. Amer.
1 ?0.20 0.05 3.77 5.50 9.37 13.18 2.87 4.38 7.63 10.65
1 ?0.20 0.30 3.91 5.50 9.51 12.94 3.01 4.25 7.78 10.65
1 0.20 0.05 3.71 5.41 9.08 12.75 2.87 4.29 7.39 10.58
1 0.20 0.30 3.85 5.55 9.23 12.96 3.00 4.24 7.55 10.54
5 ?0.20 0.05 6.52 7.68 12.41 14.63 5.44 6.40 10.67 12.51
5 ?0.20 0.30 6.61 7.67 12.50 14.93 5.53 6.49 10.76 12.48
5 0.20 0.05 6.16 7.67 11.67 16.65 5.18 6.73 10.02 12.58
5 0.20 0.30 6.25 7.76 11.78 14.61 5.26 6.39 10.13 12.53

Tabela 1: Valores teo?ricos para opc?o?es americanas e europeias no modelo CYES

Exibe-se nesta tabela os prec?os de opc?o?es de compra americanas e europeias para diferentes con-
figurac?o?es de parametros e de varia?veis de estado no modelo CYES. Prec?os de opc?o?es americanas sa?o
calculados com a fo?rmula fechada de Hilliard &amp;amp; Reis (1998), enquanto prec?os de opc?o?es americanas sa?o
calculados utilizando o me?todo LSM com base nos seguintes para?metros (para uma explicac?a?o sobre
estes para?metros, checar ape?ndice 7..2): 100,000 trajeto?rias simuladas, divisa?o do intervalo de exerc??cio
em 100 pontos e func?o?es ba?sicas consistindo de todos os polinomios de Laguerre (ponderados) ate? ordem
tre?s. Utilizou-se tambe?m uma opc?a?o com maturidade de 0.75 anos de um contrato futuro da commodity
com maturidade de um ano, ?S de 0.3, ? de 2, ? de 0.2, ?? de 0.1, ? de 0.05, r de 0.06, e um prec?o strike
para o contrato futuro de 40.

Nota-se que o prec?o da opc?a?o e? sens??vel a variac?o?es do para?metro ?. Na tabela exibe-

se configurac?o?es com alta frequencia de salto (? = 5) e com baixa frequencia de salto

(? = 1). Situac?o?es de alta frequecia de saltos tendem, ceteris paribus, a gerar prec?os mais

elevados para as opc?o?es, contemplando assim o chamado pre?mio de risco de salto. Tome,

por exemplo, uma variac?a?o de ? fixando ?? em ?0.20 e ?S em 0.05. Quando ? muda seu

valor de 1 para 5 o prec?o da opc?a?o americana salta de 3.77 para 6.52, uma variac?a?o de,

aproximadamente, 73%.

Outro fato interessante que pode ser destacado destas simulac?o?es e? que a me?dia do valor

percentual do salto, ??, afeta o prec?o de opc?o?es de maneira assime?trica; isto e?, valores de

?? de mesmo mo?dulo mas de sinais distintos na?o afetam os prec?os das opc?o?es do mesmo

modo, sendo que, ceteris paribus, valores negativos tendem a gerar prec?os mais elevados

para opc?o?es. Isto ocorre porque, como observado em Bates (1991), a assimetria dos prec?os



16

futuros na medida neutra ao risco tem o mesmo sinal de ??, sendo mais curvados para a

direita no caso ?? &gt; 0.

O exemplo acima mostra que o modelo com saltos gera, em teoria, deferenc?as quantitativas

e qualitativas em relac?a?o ao modelo sem saltos. Isto na?o significa, no entanto, que o

modelo CYES ira?, a priori, ter mais adere?ncia aos dados de mercado. Esta questa?o so?

pode ser respondida apo?s a estimac?a?o dos modelos CYE e CYES e o posterior cotejo dos

seus erros de previsa?o. Esta estimac?a?o e? precedida por uma discussa?o teo?rica do me?todo

econome?trico utilizado na intepretac?a?o dos dados, que e? feita na pro?xima sec?a?o.



17

3. Modelo econome?trico

Esta sec?a?o e? destinada a uma discussa?o teo?rica do me?todo de estimac?a?o utilizado para

estimar os modelos CYE e CYES. Fazemos tambe?m uma breve descric?a?o dos me?todos

usuais de estimac?a?o de modelos de aprec?amento e explicamos porque estes me?todos na?o

sa?o apropriados para estimar o modelo CYES.

O primeiro passo do processo de estimac?a?o e? a definic?a?o do conjunto informacional dis-

pon??vel ao econometrista. Este e? um ponto cr??tico para modelos de aprec?amento de

commodities pois, como observado por Schwartz (1997),

“(...) one of the difficulties in the empirical implementation of commodity

price models is that frequently the factors or state variables are not directly

observable.”

Prec?os a? vista sa?o negociados de modo descentralizado e sem uma padronizac?a?o adequada

do produto comercializado, o que dificulta a precisa definic?a?o de um prec?o a? vista em um

dado instante de tempo. O problema do convenience yield e? ainda pior, pois se trata

de uma abstrac?a?o de potenciais ganhos especulativos que o investidor pode usufruir1.

Contratos futuros, por outro lado, sa?o negociados com grande transparencia, de modo

centralizado e padronizado. Estas caracter??sticas deseja?veis os tornam ideais para compor

a amostra do modelo econome?trico aqui abordado.

Neste trabalho sera? adotada a hipo?tese de Schwartz (1997) de que as u?nicas varia?veis

observadas pelo econometrista sa?o os prec?os de contartos futuros negociados nas bolsas

de futuros, sendo as varia?veis de estado (isto e?, o prec?o a? vista e o convenience yield ) na?o

observa?veis.

Descreve-se de maneira mais precisa, nas pro?ximas linhas, o processo gerador de dados,

assim como a parte destes dados que compora? o conjunto de informac?a?o observa?vel. O

1Como, por exemplo, aproveitar flutuac?o?es locais de prec?os no local onde a commodity esta? armaze-
nada.



18

econometrista observa os dados de mercado apenas nos instantes t1, t2, . . . tN?1, tN com

ti+1 ? ti = ?t para todo i. Em cada instante ti a informac?a?o dispon??vel sera? o vetor de

logaritmos de prec?os de contratos futuros yi = {y
j
i}1?j?K cujo vetor de anos a? maturidade

e? constante no tempo e dado por T = (T1,T2, . . . ,TK)
&gt;.

Os log-prec?os futuros observados podem envolver spreads de bid-ask, na?o-simultaneidade

das observac?o?es, limites de prec?o, erros de medida, etc. Supo?e-se neste trabalho que

todos esses ru??dos podem ser representados por erros aditivos homoceda?sticos e na?o auto-

correlacionados. Assim, a relac?a?o entre as varia?veis de estado e o log-prec?o futuro pode,

segundo a equac?a?o 2.7, ser sistematizada na seguinte equac?a?o de medida:

yi = d + Z?i + vi (3.10)

onde ?i = (Xi,?i)
? e? o vetor de varia?veis latentes, {vi}1?i?N e? um conjunto de varia?-

veis multivariadas na?o-correlacionadas noramente distribu??das com matriz de varia?ncia

V 2IKxK e as matrizes d e Z sa?o definidas por

d =

?
????????

A(T1)

A(T2)

...

A(TK)

?
????????
, (3.11)

Z =

?
????????

1 ?1?e
??T1
?

1 ?1?e
??T2
?

...
...

1 ?1?e
??TK
?

?
????????
. (3.12)



19

Antes de prosseguir com a descric?a?o do me?todo de estimac?a?o via MCMC, o problema da

na?o linearidade entre as varia?veis de estado ?i imposto pela lei de movimento 2.3 deve ser

enderec?ado1. A relac?a?o anal??tica entre ?i+1 e ?i e? complexa e sua utilizac?a?o no algoritmo

de simulac?a?o de Metropolis-Hastings o tornaria indesejavelmente complicado.

A soluc?a?o adotada para contornar este problema e? a utilizac?a?o da linearizac?a?o (conhecida

como aproximac?a?o de Euler) da equac?a?o de mudanc?a de estados 2.3. Como observa

Johannes &amp;amp; Polson (2002), esta pra?tica e? usual no contexto de estimac?a?o de modelos de

difusa?o via MCMC e, se o incremento temporal ?t e? sufucientemente pequeno, incorre-se

em erros desprez??veis2.

A equac?a?o de mudanc?a de estados para o modelo CYES, baseada na equac?a?o 2.3 e ja? em

sua forma linearizada, toma a forma

?i+1 = ci + Q?i + ?i (3.13)

onde

ci =

?
?? (µ???? ? 12?2S)?t + ?i?qi

???t

?
?? , (3.14)

Q =

?
?? 1 ??t

0 1 ???t

?
?? . (3.15)

? ? E(?i?&gt;i ) =

?
?? ?t?2s ?t?S??s??

?t?S??s?? ?t?
2
?

?
?? . (3.16)

P(?qi = 1) = ??t , P(?qi = 0) = 1 ???t. (3.17)

1Note que a lei de movimento das varia?veis de estado 2.3 e? linear apenas para variac?o?es infinitesmais
de tempo, mas na?o para variac?o?es discretas.

2Neste trabalho utiliza-se ?t = 7
365
? 0.02 para dados semanais, mesmo valor utilizado por Schwartz

(1997).



20

A representac?a?o em espac?o de estados dada pelas equac?o?es 3.10 e 3.13 pode ser utilizada

para o ca?lculo da func?a?o de verossimilhanc?a dos para?metros condicionados aos valores das

varia?veis de medida por meio do filtro de Kalman. A abordagem natural, a partir deste

ponto, seria a maximizac?a?o desta func?a?o para a obtenc?a?o dos estimadores de ma?xima

verossimilhanc?a, como fez Schwartz (1997) para o modelo CYE. Este procedimento e?, no

entanto, inva?lido no contexto de processos com saltos. Isto porque, conforme provado em

Honore? (1998), log-retornos em um modelo desta categoria sa?o uma mistura de distribui-

c?o?es normais, e um resultado a respeito deste tipo de distribuic?a?o e? o de que sua func?a?o

de verossimilhanc?a e? ilimitada se os para?metros de me?dia e de varia?ncia sa?o desconheci-

dos, tendendo ao infinito em certos pontos do espac?o parame?trico em que a varia?ncia se

aproxima de zero. Uma prova desta afirmac?a?o pode ser encontrada no ape?ndice 7..3.

Contorna-se este problema neste trabalho adotando-se uma distribuic?a?o a priori informa-

tiva para os para?metros. A ideia ba?sica e? a de que uma distribuic?a?o a prori que atribui

baixa densidade de probabilidade a? regia?o do espac?o parame?trico em que a varia?ncia dos

termos de erro aproxima-se de zero pode eliminar as citadas singularidades da func?a?o de

verossimilhanc?a. Isto pode ser feito, por exemplo, com a hipo?tese de uma distribuic?a?o a

priori gamma inversa para os para?metros de varia?ncia, cuja densidade de probabilidade

converge exponencialmente para zero quando seu argumento vai para zero.

Esta hipo?tese altera o objeto de estimac?a?o e de infere?ncia no modelo econome?trico. Em vez

de obter estimativas de um para?metro nume?rico fixo, no arcabouc?o da estat??stica cla?ssica,

este trabalho tratara? do estudo da distribuic?a?o a posteriori 1 dos para?metros, isto e?, da

distribuic?a?o dos para?metros condicionados a?s varia?veis de medida observadas no mercado,

numa abordagem de estimac?a?o Bayesiana. Para prosseguir com o processo de estimac?a?o,

faz-se necessa?ria a especificac?a?o do modelo Bayesiano adotado, isto e?, a definic?a?o das

varia?veis a serem estimadas e suas distribuic?oes a priori. O vetor de para?metros a ser

estimado, ?, e? uma simples reparametrizac?a?o do modelo como apresentado na sec?a?o 2.,

1A distribuic?a?o a posteriori de um conjunto de para?metros ? condicionados aos valores de certa vara?vel
de medida y e? dada pela regra de Bayes p(?|y) ? p(y)p(y|?).



21

adotada para tornar o me?todo de simulac?a?o mais simples. Sua definic?a?o precisa, assim

como sua distribuic?a?o a priori, podem ser encontrados no ape?ndice 7..4.

3..1 Me?todo de simulac?a?o

Neste ponto, o problema de infere?ncia reduz-se ao problema computacional do ca?luclo de

momentos da seguinte distribuic?a?o de probabilidade a posteriori :

p
(

?,{?i}Ni=1,{?qi}
N?1
i=1 ,{?i}

N?1
i=1 |y

)
. (3.18)

Em outras palavras, deseja-se estudar a distribuic?a?o de probabilidade conjunta dos para?-

metros, dos prec?os a? vista, do convenience yield e dos saltos condicionados a? informac?a?o

de mercado dos prec?os dos contratos futuros.

Uma te?cnica adequada para o estudo de uma distribuic?a?o de probabilidade de alta di-

mensa?o, como e? o caso de 3.18, e? o de simulac?a?o via Metropolis-Hastings. Este me?todo

tem como objetivo a amostragem de uma cadeia cuja medida estaciona?ria coincide com a

distribuic?a?o de probabilidade estudada.

Antes de iniciar a descric?a?o do algoritmo de Metropolis-Hastings, conve?m, por simplici-

dade, fixar uma notac?a?o. Chamaremos a varia?vel aleato?ria completa a ser simulada de ?,

isto e?,

? =
{

?,{?i}Ni=1,{?qi}
N?1
i=1 ,{?i}

N?1
i=1

}???y. (3.19)
O primeiro passo para a aplicac?a?o do algoritmo de Metropolis-Hastings e? a definic?a?o dos

blocos de para?metros que sera?o simulados simultaneamente1. Considere uma divisa?o de ?

em n blocos disjuntos, isto e?, ? = ?1 ??2 ?·· ·??n e ?i??j = ? se i 6= j (uma descric?a?o

precisa dos blocos adotados neste trabalho pode ser encontrada no ape?ndice 7..6).

1Segundo Chib (2001), tais blocos devem conter varaveis altamente correlacionadas, a fim de que a
convergencia da cadeia seja mais veloz



22

O passo seguinte e? o da escolha de uma densidade geradora de candidatos para cada

bloco. A densidade associada ao bloco i, denotada por hi(?
c
i|?1, ?2, . . . , ?n), especifica

uma medida de probabilidade para a amostragem de um candidato ?ci para a cadeia de

Markov a ser gerada. Este candidato, no entanto, pode na?o compor a cadeia. Ele sera?

aceito com a seguinte probabilidade ?:

? = min

{
p(?ci, ??i)hi(?i|?ci, ??i)
p(?i, ??i)hi(?

c
i|?i, ??i)

, 1

}
(3.20)

onde ??i representa o vetor de para?metros excluindo-se o bloco i. A probabilidade de

aceite tem como func?a?o “moldar” os valores gerados pela densidade hi para ficarem pro?-

ximos da distribuic?a?o marginal de ?i.

Suponha que estejamos aptos a simular perfeitamente a distribuic?a?o marginal do bloco

?i. Neste caso, a densidade geradora de candidatos seria dada por

hi(?
c
i|?i, ??i) = p(?

c
i|??i) (3.21)

e a probabilidade de aceite fica

? = min

{
p(?ci, ??i)p(?i|??i)
p(?i, ??i)p(?

c
i|??i)

, 1

}
= 1 (3.22)

de modo que o candidato e? sempre aceito. Esse caso e? conhecido como Gibbs-Sampling

e, em geral, e? preferido em relac?a?o a me?todos de Metropolis-Hastings gene?ricos, mas

dependem da possibilidade de se gerar amostras das verdadeiras distribuic?o?es marginais,

o que nem sempre e? poss??vel. No ape?ndice 7..6, que conte?m uma descric?a?o mais precisa

do algoritmo MCMC utilizado neste trabalho, pode-se encontrar a descric?a?o dos blocos

em que se logrou a utilizac?a?o do me?todo de Gibbs-Sampling.

O u?ltimo passo para a aplicac?a?o do algoritmo e? a definic?a?o do nu?mero M de elementos que

sera?o armazenados na cadeia de Markov. Valores maiores de M tornam a cadeia gerada

mais pro?xima da sua medida estaciona?ria, mas sa?o limitados pela memo?ria computacional

dispon??vel. No presente trabalho utiliza-se M = 10, 000.



23

O algoritmo completo de Metropolis-Hastings pode enta?o ser enunciado da seguinte ma-

neira:

1. Especifique um chute inicial ?(0) = (?
(0)
1 , ?

(0)
2 , . . . , ?

(0)
n )

2. Fac?a, para m = 1, . . . ,M,

(a) Fac?a, para i = 1, . . . ,n,

i. Gere um candidato ?ci ? hi(?ci|?
(m)
1 , . . . , ?

(m)
i?1, ?

(m?1)
i , . . . , ?

(m?1)
n )

ii. calcule

? = min

{
p(?ci, ??i)hi(?

(m?1)
i |?

c
i, ??i)

p(?
(m?1)
i , ??i)hi(?

c
i|?i, ??i)

, 1

}
(3.23)

onde ??i = (?
(m)
1 , . . . , ?

(m)
i?1, ?

(m?1)
i , . . . , ?

(m?1)
n )

iii. defina

?
(m)
i =

????
???

?ci se ? &gt; Uniforme(0, 1)

?
(m?1)
i caso contrario

(3.24)

3. Retorne {?(1), ?(2), . . . , ?(M)}.

Em geral, para tentar minimizar a influencia do chute inicial ?(0) no resultado final,

descarta-se um trecho inicial da cadeia antes de se comec?ar a gravar os M valores, o

chamado burn-in. Neste trabalho utiliza-se um burn-in de 2,000.

Os resultados ba?sicos de convergencia da cadeia {?(1), ?(2), . . . , ?(M)} encontram-se em

Chib (2001). Para fins pra?ticos, pode-se supor que {?(1), ?(2), . . . , ?(M)} segue a distri-

buic?a?o de ? e que momentos de func?o?es de ? podem ser calculados utilizando-se leis dos

grandes nu?meros e me?dias amostrais da cadeia gerada.

Uma descric?a?o mais precisa do algoritmo de estimac?a?o pode ser encontrado no ape?ndice

7..6. No que segue, todas as estimativas de para?metros sa?o baseadas nas me?dias das

distribuic?o?es a posteriori calculadas por meio desta simulac?a?o.



24



25

4. Descric?a?o dos dados

Os dados utilizados para fins de estimac?a?o consistem de observac?o?es semanais (em cada

sexta-feira) de prec?os de contratos futuros de petro?leo, cobre e trigo. Em cada estimac?a?o

utilizou-se quatro maturidades distintas (isto e?, K = 4)

A tabela 2 mostra as estat??sticas descritivas ba?sicas dos contratos futuros de petro?leo da

NYMEX utilizados nas estimac?o?es deste trabalho. Os dados de petro?leo consistem de dois

paine?is: um primeiro, chamado de painel A, contemplando os contratos F1, F3, F7 e F10

no intervalo de tempo que vai de 6/1/1995 a 24/8/2012, e um segundo, chamado de painel

B, contendo os contratos F1, F3, F7 e F10 no intervalo de 4/9/1987 a 24/8/2012. Aqui

F1 denota o contrato futuro mais pro?ximo da maturidade, F2 denota o segundo contrato

mais pro?ximo da maturidade e assim por diante.

Prec?o Me?dio Maturidade Me?dia
Contrato Futuro (Desvio Padra?o) (Desvio Padra?o)

Painel A: De 6/1/1995 a 24/8/2012
F1 47.88(30.10) 0.072(0.024)
F5 48.21(31.03) 0.405(0.024)
F10 48.03(31.62) 0.822(0.024)
F15 47.76(31.83) 1.239(0.024)

Painel B: De 4/9/1987 a 24/8/2012
F1 39.55(28.46) 0.072(0.035)
F3 39.68(28.95) 0.241(0.080)
F7 39.59(29.52) 0.577(0.180)
F10 39.46(29,73) 0.829(0.255)

Tabela 2: Estat??sticas descritivas dos dados de petro?leo

Esta tabela conte?m as me?dias e os desvios padra?o para o prec?o e para os anos a? maturidade de
cada contrato utilizado para fins de estimac?a?o.

Como a data de maturidade de cada contrato e? fixa, o nu?mero de anos a? maturidade

deve decrescer com o tempo. Sempre que F1 matura, no entanto, ha? uma rolagem dos

contratos: F2 transforma-se em F1, F3 transforma-se em F2 e assim por diante, o que faz

com que o nu?mero de anos a? maturidade retorne ao antigo patamar, sempre dentro de

uma pequena faixa de variac?a?o, como pode ser observado na figura 1.



26

Figura 1: Maturidades histo?ricas dos contratos futuros de petro?leo do painel A
Esta figura mostra, com uma frequencia semanal, as maturidades (em anos) de cada um dos quatro
contratos utilizados na estimac?a?o deste trabalho, comec?ando em 6/1/1995 e com te?rmino em 24/8/2012

Para fins de estimac?a?o, cada contrato sera? tratado como se seu nu?mero de anos a? maturi-

dade fosse constante, de modo que o modelo econome?trico da sec?a?o 3 pode ser utilizado.

Esta hipo?tese e? motivada pelos valores muito baixos de desvio padra?o da maturidade

exibidos na tabela 2, variando entre 0.02 e 0.2 no pior dos casos.

A utilizac?a?o de dois paine?is distintos para os dados de petro?leo busca contemplar dois

tipos de amostra: uma que possua contratos de maior maturidade, o painel A, e um que

possua maior histo?rico, o painel B. Na?o e? poss??vel construir uma amostra com estas duas

propriedades porque os contratos acima de F10 eram extremamente il??quidos antes da

de?cada de 90. A figura 2, que exibe o nu?mero me?dio de negociac?o?es diarias do contrato

F11 em uma janela mo?vel de doze meses, ilustra este fato. Nota-se que o nu?mero de

negociac?o?es era irriso?rio antes da de?cada de 90, comec?a a ganhar impulso em 1989 e

adquire maior consiste?ncia apo?s 1995, rompendo definitivamente a barreira dos 2,500

contratos dia?rios e chegando a valores superiores a 20,000 contratos por dia em per??odos

recentes



27

Figura 2: Nu?mero me?dio de negociac?o?es do contrato F11 em um dia
Esta figura mostra mostra o nu?mero me?dio de negociac?o?es diarias do contrato futuro de petro?leo F11
numa janela mo?vel de doze meses.

Os dados de trigo da bolsa de Chicago, cujas estat??sticas descritivas ba?sicas esta?o repor-

tadas na tabela 3, apresentam problema semelhante. Os contratos ate? F6 apresentam

considera?vel volume de negociac?a?o apo?s 1989, de aproximadamente 2,000 contratos por

dia, em me?dia. O contrato F7 (com maturidade de 1.3 anos), no entanto, apresenta li-

quidez apenas em certos per??odos, chegando a na?o ser negociado em diversas datas, como

pode ser visto no gra?fico 3. Os contratos acima de F7 (F8, F9 ate? F15) apresentam, via

de regra, pior liquidez em todas as datas.

Em face deste problema, optou-se por utilizar apenas os contratos F1, F3, F5 e F6 para

os dados de trigo. A utilizac?a?o do contrato F7 so? poderia ser feita em datas apo?s 2006,

data em que este contrato atinge volumes ne negociac?a?o mais consistentes, o que tornaria

a amostra indesejavelmente pequena.

Nota-se que em ambas as bases de dados abordadas ate? o momento (os paine?is de petro?leo

e o painel de trigo), os contratos futuros mais longos te?m aproximadamente um ano de

maturidade. Contratos mais longos poderiam estimar os para?metros da estrutura a termo



28

Prec?o Me?dio Maturidade Me?dia
Contrato Futuro (Desvio Padra?o) (Desvio Padra?o)

De 6/1/1989 a 20/6/2008
F1 3.719(1.359) 0.113(0.071)
F3 3.767(1.260) 0.530(0.114)
F5 3.784(1.171) 0.928(0.144)
F6 3.796(1.153) 1.148(0.179)

Tabela 3: Estat??sticas descritivas dos dados de trigo

Esta tabela conte?m as me?dias e os desvios padra?o para o prec?o e para os anos a? maturidade de
cada contrato utilizado para fins de estimac?a?o.

Figura 3: Nu?mero de negociac?o?es do contrato F7 em um dia
Esta figura mostra mostra o nu?mero de negociac?o?es diarias do contrato futuro de trigo F7.



29

de maneira mais precisa, mas tais contratos na?o possuem histo?ricos suficientemente longos

nos dados colhidos. Schwartz (1997) observa que este problema esta? presente na maioria

das bases de dados pu?blicas provenientes de bolsas de futuros1.

As estat??sticas ba?sicas da u?ltima base de contratos futros utilizada neste trabalho, de

cobre, encontram-se na tabela 4. Esta base e?, dentre as outras utilizadas neste trabalho,

a mais rica em termos de maturidades (o contrato mais longo possui maturidade me?dia

de 1.7 anos) e tamanho da amostra (de 1990 a 2012).

Prec?o Me?dio Maturidade Me?dia
Contrato Futuro (Desvio Padra?o) (Desvio Padra?o)

Data from 5/1/1990 to 24/8/2012
F1 175.97(117.41) 0.114(0.064)
F3 174.91(117.40) 0.510(0.083)
F6 170.86(115.68) 1.114(0.064)
F9 167.61(112.80) 1.706(0.079)

Tabela 4: Estat??sticas descritivas dos dados de cobre

Esta tabela conte?m as me?dias e os desvios padra?o para o prec?o e para os anos a? maturidade de
cada contrato utilizado para fins de estimac?a?o.

1A ana?lise da literatura feita pelo autor encontrou trabalhos que utilizam amostras com maiores
maturidades apenas quando referentes a dados na?o pu?blicos. Schwartz (1997), por exemplo, utiliza dados
proprieta?rios da Enron Capital com maturidades me?dias de ate? nove anos.



30



31

5. Resultados

5..1 Para?metros Estimados

Como esperado, os para?metros para os quais se utilizou um me?todo de Gibbs-Sampling

(discriminados no ape?ndice 7..6) esta?o associados a cadeias de menor auto-correlac?a?o, de

aproximadamente zero na vige?sima ordem, com excec?a?o dos para?metros de salto, que

apresentam correlac?a?o mais intensa. O para?metro de frequencia de saltos ?, por exemplo,

possui uma autocorrelac?a?o de aproximadamente 0.6 para a cente?sima ordem, valor consi-

derado alto pela literatura de me?todos de Monte Carlo, o que pode tornar sua convergencia

mais lenta e sua estimativa mais imprecisa. Os para?metros gerados por me?todos gene?ricos

de Metropolis Hastings apresentam cadeias com auto-correlac?a?o de aproximadamente 0.4

na cente?sima ordem, valor tambe?m considerado alto. Como observa Chib (2001), cadeias

de elevada auto-correlac?a?o sa?o comuns em simulac?o?es de varia?veis de altas dimenso?es,

como no presente trabalho. Para maiores informac?o?es acerca das cadeias geradas checar

o ape?ndice 7..7, que conte?m todas as informac?o?es relevantes para as simulac?o?es de cobre.

As demais simulac?o?es te?m aspecto semelhante.

A tabela 5 conte?m as me?dias, os desvios padra?o e a significa?ncia estat??stica da distribuic?a?o

a posteriori de cada pa?metro para os dados de petro?leo contidos nos paine?is A e B, onde

os para?metros com subscrito “m” sa?o referentes a? reparametrizac?a?o (explicada no ape?ndice

7..4) utilizada para a aplicac?a?o do algoritmo MCMC.

Os para?metros de retorno de longo prazo (µ) sa?o, em todos os casos, significantes e

acima da taxa de juros me?dia do per??odo (de 0.03 para o painel A e 0.04 para o painel

B). Os valores obtidos neste trabalho oscilam em torno de 0.22 e 0.24 (nota-se que a

inclusa?o de saltos praticamente na?o altera tais estimativas) , valores muito pro?ximos

a?queles encontrados por Schwartz (1997), de 0.238 e 0.244 para dois paine?is que va?o de

1990 a 1995. Estes valores indicam um excesso de retorno da ordem de 0.2.

A estimativa da me?dia de longo prazo do convenience yield, ?, depende fortemente da



32

Base Painel A Painel B
Contratos F1, F5, F10, F15 F1, F3, F7, F10

NOBS 921 1304
Per??odo 6/1/1995 a 24/8/2012 4/9/1987 a 24/8/2012
Modelo CYES CYE CYES CYE
µm 0.274(0.091) *** 0.174 (0.080) ** 0.267 (0.068) *** 0.185 (0.078) ***
? 0.078(0.053) * 0.078 (0.054) * 0.117 (0.045) *** 0.119 (0.048) ***
? 1.335(0.054) *** 1.337 (0.063) *** 1.881 (0.086) *** 1.803 (0.109) ***
?S 0.269(0.015) *** 0.318 (0.015) *** 0.252 (0.014) *** 0.323 (0.016) ***
?? 0.303(0.019) *** 0.290 (0.018) *** 0.392 (0.023) *** 0.379 (0.029) ***
? 0.978(0.008) *** 0.856 (0.020) *** 0.980 (0.005) *** 0.853 (0.016) ***
?? -0.009(0.031) -0.008 (0.042) -0.015 (0.055) -0.026 (0.073)
V 0.020(0.007) *** 0.026 (0.010) *** 0.022 (0.010) *** 0.027 (0.012) ***
? 20.652(3.447) *** 19.499 (2.556) ***
??m -0.005(0.004) * -0.004 (0.003)
? 0.039(0.003) *** 0.043 (0.002) ***
µ 0.225(0.074) *** 0.225 (0.080) *** 0.233 (0.067) *** 0.237 (0.078) ***
? 0.115(0.084) * 0.113 (0.089) 0.249 (0.134) ** 0.260 (0.151) **
?? -0.004(0.004) -0.003 (0.003)

Tabela 5: Estimac?a?o dos modelos CYE e CYES para dados de petro?leo

Esta tabela conte?m as me?dias das distribuic?o?es a posteriori para cada para?metro dos modelos
com saltos e sem saltos. Desvios padra?o das distribuic?o?es a posteriori esta?o entre parenteses. NOBS =
nu?mero de observac?o?es, *** indica significa?ncia estat??stica ao n??vel 99%, ** indica significa?ncia estat??stica
ao n??vel 95% e * indica significa?ncia estat??stica ao n??vel 90%

amostra usada. O painel B, que contempla um intervalo de tempo maior, indica uma valor

de aproximadamente 0.12 para ?, enquanto o painel A, que cobre uma amostra menor,

indica um valor bastante menor para este para?metro, de 0.078. Estas estimativas esta?o

abaixo dos valores encontrados por Schwartz (1997) em paine?is que va?o de 1990 a 1995, de

0.180 e 1.184, dependendo dos contratos futuros utilizados. Estas diferenc?as devem-se a?

grande queda dos prec?os a? vista do petro?leo ocorridas em 2008, que foram acompanhados

em menor intensidade pelos prec?os futuros mais longos, gerando uma queda considera?vel

no valor do convenience yield. Isto pode ser visto claramente na figura 4, que conte?m as

estimativas e os intervalos de confianc?a para estas varia?veis latentes: o convenience yield

atinge seu m??nimo histo?rico de, aproximadamente, -1 na citada queda de prec?os.

As estimativas do para?metro de velocidade de ajustamento ? sa?o fortemente significativas

e sa?o favora?veis a? hipo?tese de que o convenience yield reverte a? uma me?dia de longo

prazo. Nossas estimativas sa?o de, aproximadamente, 1.8 para o painel B e 1.4 para o



33

painel A. Estes resultados va?o ao encontro com aquele obtido por Schwartz (1997) de que

estimativas baseadas em contratos de maiores maturidades indicam uma reversa?o a? me?dia

menos intensa. Neste sentido, e? elucidativa sua estimativa de 1.187 para ? utilizando dados

de petro?leo fornecidos pela Enron Capital, com contatos de maturidades me?dias de ate?

nove anos.

Figura 4: Me?dias e intervalos de confianc?a para as varia?veis de estado no
modelo CYES utilizando os dados de petro?leo do painel B

Os resultados obtidos para ?, positivos e estatisticamente significantes, va?o ao encontro

com a teoria do armazenamento, conforme explicado na sec?a?o 2. Nota-se que, em ambos

os paine?is, a estimativa de ? aumenta de maneira significante nos modelos com saltos, de

0.86 para 0.98 no painel A e de 0.85 para 0.98 no painel B. A intuic?a?o deste resultado

e? a de que os saltos sa?o capazes de “limpar” os res??duos da equac?a?o do prec?o a? vista de

choques na?o correlacionados com o convenience yield.



34

O prec?o do risco do convenience yield, ??, e? positivo, como esperado, e estatisticamente

significante, variando entre 0.11 para o painel A e 0.25 para o painel B, valores que diferem

muito pouco daqueles encontrados por Schwartz (1997), que variam entre 0.19 e 0.32.

As estimativas obtidas para o para?metro de frequencia anual de saltos ?, de aproxima-

damente 20, sa?o altas se comparadas com estudos ana?logos do mercado de ac?o?es, que

geralmente o estimam entre 1 e 5; Bjorn Eraker &amp;amp; Polsonn (2003), por exemplo, encon-

tram valores pro?ximos a 1.5 para o ??ndice S&amp;amp;P 500. Outro fato interessante a respeito dos

para?metros de saltos e? que a estimativa do salto percentual me?dio, ??, e? estatisticamente

insignificante, indicando a presenc?a de saltos sime?tricos em dados de petro?leo. Este resul-

tado contrasta com a maioria dos estudos de saltos no mercado acionario, que geralmente

encontra saltos me?dios significantemente negativos. Isso e? explicado pela assimetria dos

log-retornos de petro?leo, de aproximadamente -0.26, relativamente baixa se comparada,

por exemplo, a? assimetria do ??ndice S&amp;amp;P 500, de -2.6.

Figura 5: Estimativas da probabilidade e da magnitude dos saltos para dados
do painel B de petro?leo



35

Contratos F1, F3, F5, F6
NOBS 1016

Per??odo 6/1/1989 to 20/6/2008
Modelo CYES CYE
µm 0.012 (0.064) 0.171 (0.061) ***
? 0.127 (0.045) *** 0.128 (0.051) ***
? 1.538 (0.066) *** 1.425 (0.101) ***
?S 0.216 (0.010) *** 0.245 (0.010) ***
?? 0.290 (0.017) *** 0.275 (0.021) ***
? 0.937 (0.020) *** 0.814 (0.024) ***
?? -0.151 (0.040) -0.166 (0.058)
V 0.034 (0.005) *** 0.038 (0.010) ***
? 8.950 (2.639) ***
??m 0.019 (0.006) ***
? 0.040 (0.005) ***
µ 0.203 (0.058) *** 0.201 (0.061) ***
? 0.427 (0.094) *** 0.416 (0.010) ***
?? 0.020 (0.006) ***

Tabela 6: Estimac?a?o dos modelos CYE e CYES para dados de trigo

Esta tabela conte?m as me?dias das distribuic?o?es a posteriori para cada para?metro dos modelos
com saltos e sem saltos. Desvios padra?o das distribuic?o?es a posteriori esta?o entre parenteses. NOBS =
nu?mero de observac?o?es, *** indica significa?ncia estat??stica ao n??vel 99%, ** indica significa?ncia estat??stica
ao n??vel 95% e * indica significa?ncia estat??stica ao n??vel 90%

A figura 5 mostra as estimativas de probabilidade de salto e de magnitude de salto em

cada semana da amostra para o painel B. Nota-se que em alguns per??odos, como no final

de 2008, ha? um agrupamento de saltos, indicando um per??odo de alta volatilidade. Como

observa Johannes &amp;amp; Polson (2002), este feno?meno e? comum em modelos de saltos que

na?o contemplam volatilidade estoca?stica e podem indicar um erro de especificac?a?o. Como

modelos de volatilidade estoca?stica na?o esta?o no escopo deste trabalho, no entanto, na?o

se enderec?ara? aqui este problema.

As tabelas 6 e 7 conte?m as estimativas referentes aos dados de trigo e cobre, respectiva-

mente. Assim como no caso do petro?leo, as estimativas do retorno de longo prazo µ, de

0.12 para cobre e 0.20 para trigo, sa?o estatisticamente significantes e situam-se acima da

taxa de juros de livro de risco. A estimatima de µ aqui encontrada para dados de cobre e?

sensivelmente distinta a?quela de Schwartz (1997), de 0.326; esta divergencia e? explicada

pela forte queda nos prec?os e no convenience yield do cobre apo?s 2008, um per??odo na?o

contemplado no trabalho citado; esta queda pode ser vista na figura 6, que conte?m as

estimativas das varia?veis de estado no modelo com saltos.



36

Contratos F1, F3, F6, F9
NOBS 1182

Per??odo 5/1/1990 to 24/8/2012
Modelo CYES CYE
µm 0.115 (0.056) ** 0.092 (0.079) *
? 0.033 (0.045) 0.033 (0.056)
? 0.588 (0.060) *** 0.646 (0.068) ***
?S 0.178 (0.020) *** 0.237 (0.021) ***
?? 0.092 (0.008) *** 0.095 (0.009) ***
? 0.829 (0.051) *** 0.665 (0.053) ***
?? 0.078 (0.158) 0.078 (0.200)
V 0.062 (0.065) *** 0.069 (0.084) ***
? 6.472 (3.469) ***
??m -0.004 (0.009)
? 0.063 (0.011) ***
µ 0.121 (0.058) ** 0.121 (0.079) *
? -0.025 (0.090) -0.028 (0.106)
?? -0.002 (0.008)

Tabela 7: Estimac?a?o dos modelos CYE e CYES para dados de cobre

Esta tabela conte?m as me?dias das distribuic?o?es a posteriori para cada para?metro dos modelos
com saltos e sem saltos. Desvios padra?o das distribuic?o?es a posteriori esta?o entre parenteses. NOBS =
nu?mero de observac?o?es, *** indica significa?ncia estat??stica ao n??vel 99%, ** indica significa?ncia estat??stica
ao n??vel 95% e * indica significa?ncia estat??stica ao n??vel 90%

Figura 6: Me?dias e intervalos de confianc?a para as varia?veis de estado no modelo
CYES utilizando os dados de cobre



37

Os dados de trigo e cobre tambe?m corroboram a hipo?tese de que o convenience yield

reverta a? me?dia de longo prazo: os valores de 0.588 e 0.646 para cobre e de 1.538 e 1.425

para trigo sa?o fortemente significantes. As estimativas para o para?metro de correlac?a?o

?, assim como no caso do petro?leo, sa?o significantemente positivos e maiores no caso em

que saltos sa?o inclu??dos no modelo, coerentemente com a teoria do armazenamento. A

estimativa do prec?o do risco para os dados de cobre e? negativa, mas na?o e? estatisticamente

significante; ja? para os dados de trigo sua estimativa e? significante e bastante alta, de 0.427

para o modelo com saltos e 0.416 para o modelo sem saltos.

Os para?metros de frequencia de saltos estimados para trigo e cobre, de 8.9 e 6.7 respec-

tivamente (ambos estatisticamente significantes), parecem mais coerentes com os estudos

de saltos nos mercados de ac?o?es e com o conceito de que saltos devem ser eventos raros.

Ainda a respeito dos para?metros de salto, chama a atenc?a?o o salto percentual me?dio ??

estimado para os dados de trigo por ser positivo e estatisticamente significante, em con-

traste com estimativas do mercado acionario, que sa?o usualmente negativas, como ja? foi

exemplificado anteriormente. Uma poss??vel explicac?a?o para esta divergencia e? a de que

os choques de oferta no mercado de trigo sa?o geralmente causados ma?s colheitas, tendo

portanto um vie?s positivo no prec?o. Na?o surpreende, portanto, que sua se?rie de retornos

tenha uma assimetria positiva, de aproximadamente 0.32. A figura 7 mostra as estimativas

da probabilidade de salto e de valor percentual do salto em cada semana da amostra para

dados de trigo. Repete-se nesta figura a situac?a?o que ja? foi vista nos saltos para dados

de petro?leo: ha? agrupamento de saltos em certos per??odos de alta volatilidade, sugerindo

que um modelo de volatilidade estoca?stica poderia se ajustar de maneira mais adequada

aos dados.



38

Figura 7: Estimativas da probabilidade e da magnitude dos saltos para dados
de trigo



39

5..2 Comparac?a?o entre os modelos CYE e CYES

5..2.1 Comparac?a?o da REQM para Contratos Futuros Fora da Amostra

Antes de prosseguir com a comparac?a?o dos erros quadra?ticos me?dios na previsa?o dos

prec?os de contratos futuros, faz-se necessa?rio um esclarecimento. Utilizou-se prec?os de

contratos futuros observados no mesmo intervalo de tempo que as observac?o?es da amostra

de estimac?a?o, mas com maturidades distintas. Na?o se utilizou contratos fora do intervalo

de tempo de estimac?a?o porque isto necessitaria da estimac?a?o adicional da varia?vel de

estado nos instantes correspondentes, tornando a comparac?a?o muito mais complexa.

A comparac?a?o feita aqui na?o e?, portanto, um me?todo de comparac?a?o “legitimamente” fora

da amostra, pois os contratos futuros de diferentes maturidades apresentam correlac?a?o

temporal bastante elevada1. Na?o obstante, esta comparac?a?o e? relevante e sera? feita nesta

subsec?a?o.

REQM em Do?lares REQM em Porcentagem
Modelo CYES CYE CYES CYES

F2 1.360 (0.681) 1.839 (0.983) 2.520 (1.149) 3.333 (1.671)
F4 1.321 (0.612) 1.737 (0.880) 2.533 (0.992) 3.203 (1.456)
F6 1.265 (0.599) 1.668 (0.854) 2.347 (0.982) 3.001 (1.426)
F8 1.217 (0.609) 1.639 (0.868) 2.173 (1.020) 2.868 (1.475)
F12 1.247 (0.682) 1.733 (0.986) 2.157 (1.179) 2.977 (1.714)
F13 1.290 (0.711) 1.791 (1.032) 2.244 (1.231) 3.090 (1.796)
F20 2.003 (1.047) 2.605 (1.509) 3.713 (1.741) 4.701 (2.554)
F30 4.185 (2.088) 5.174 (2.919) 6.455 (2.891) 7.821 (4.093)

Todos 1.736 (1.383) 2.273 (1.815) 3.018 (2.058) 3.874 (2.710)

Tabela 8: Comparac?a?o entre erros de previsa?o dos modelos CYES e CYE
estimados com os dados de petro?leo do painel A

Esta tabela apresenta as ra??zes do erro quadra?tico me?dio para um grupo de contratos futuros
fora da amostra de estimac?a?o no per??odo de 6/1/1995 a 24/8/2012.

A tabela 8 apresenta as ra??zes dos erros quadra?ticos me?dios para um grupo de contratos

fora da amostra de estimac?a?o, utilizando-se as previso?es dos modelos CYE e CYES esti-

mados com os dados do painel A de petro?leo. Note que todos os contratos apresentam

uma REQM menor para o modelo CYES e, considerando todos os contratos, a REQM (em

1A correlac?a?o entre os prec?os dos contratos futuros de petro?leo F1 e F15, por exemplo, e? de 0.988



40

do?lares) e? de 2.273 para o modelo CYE e de 1.736 para o modelo CYES, uma diferenc?a

de 23%.

Uma das vatagens de se estimar os modelos CYE e CYES por me?todos MCMC e? a de

que os desvios-padra?o das ra??zes quadradas dos erros quadra?ticos me?dios sa?o facilmente

calcula?veis e esta?o entre parenteses na tabela 8. Observe que, apesar das REQM serem

sempre menores no modelo CYES, a diferenc?a nunca supera um desvio padra?o. Conclui-se

que a pura ana?lise das REQM na?o agrega evide?ncias a favor do modelo CYES.

As tabelas 9 e 10 conte?m as RMSE para os dados de trigo e cobre, respectivamente, e

contam a mesma histo?ria: o modelo CYES logra a obtenc?a?o de REQM menores, mas tal

descre?scimo na?o e? estatisticamente significante.

REQM em Do?lares REQM em Porcentagem
Modelo CYES CYE CYES CYES

F2 0.221 (0.048) 0.239 (0.073) 4.454 (1.114) 5.010 (1.789)
F4 0.175 (0.041) 0.199 (0.068) 4.065 (1.067) 4.684 (1.763)
F8 0.382 (0.145) 0.409 (0.197) 8.474 (3.285) 9.226 (4.558)
F10 0.645 (0.234) 0.690 (0.326) 14.233 (5.053) 15.419 (7.138)
F11 0.681 (0.264) 0.738 (0.372) 16.377 (6.251) 17.871 (8.892)
F13 1.162 (0.394) 1.243 (0.561) 24.994 (8.336) 27.035 (12.010)

Todos 0.544 (0.405) 0.586 (0.479) 12.100 (8.874) 13.207 (10.606)

Tabela 9: Comparac?a?o entre erros de previsa?o dos modelos CYES e CYE
estimados com os dados de trigo

Esta tabela apresenta as ra??zes do erro quadra?tico me?dio para um grupo de contratos futuros
fora da amostra de estimac?a?o no per??odo de 6/1/1989 to 20/6/2008

REQM em Do?lares REQM em Porcentagem
Modelo CYES CYE CYES CYES

F2 18.028 (20.953) 20.175 (29.308) 8.708 (10.143) 9.776 (14.182)
F4 16.620 (19.753) 18.761 (28.178) 8.098 (9.765) 9.173 (13.897)
F5 16.517 (20.083) 18.758 (29.015) 8.116 (10.014) 9.249 (14.422)
F10 22.020 (30.752) 25.770 (48.794) 10.962 (15.139) 12.842 (23.967)

Todos 18.296 (23.442) 20.866 (35.032) 8.971 (11.546) 10.260 (17.217)

Tabela 10: Comparac?a?o entre erros de previsa?o dos modelos CYES e CYE
estimados com os dados de cobre

Esta tabela apresenta as ra??zes do erro quadra?tico me?dio para um grupo de contratos futuros
fora da amostra de estimac?a?o no per??odo de 5/1/1990 to 24/8/2012



41

5..2.2 Normalidade dos Res??duos

Considere os res??duos do prec?o a? vista e do convenience yield :

?Xi = Xi+1 ?Xi ? (µ? 0.5?2S ???? ? ?)?t? log(1 + ?i)?qi (5.25)

??i = ?i+1 ? ?i ??(?? ?)?t (5.26)

Estes res??duos na?o precisam, necessariamente, ser normalmente distribu??dos, pois estamos

utilizando uma linearizac?a?o da equac?a?o de mudanc?a de estados original. Devem, no

entanto, ser aproximadamente normais se o modelo esta? bem especificado, dado que o erro

que se incorre neste tipo de aproximac?a?o e? pequeno. Um poss??vel me?todo de comparac?a?o

entre os modelos CYES e CYE e?, deste modo, a adere?ncia dos seus res??duos a? distribuic?a?o

normal. Esta subsec?a?o e? dedicada a esta comparac?a?o.

Figura 8: QQ plot para os res??duos das equac?o?es de estado para dados de cobre



42

Uma primeira comparac?a?o neste sentido e? a ana?lise dos gra?ficos dos quantis emp??ricos dos

res??duos de cada modelo contra os previstos numa variavel normal, o QQ plot 1. A figura

8 exibe o QQ plot dos res??duos de cada uma das varia?veis de estado nos modelos CYE e

CYES estimados utilizando-se dados de cobre. Nota-se que os saltos conseguem eliminar

alguns pontos extremos que esta?o presentes no QQ plot dos res??duos do logaritmo do prec?o

a? vista no modelo CYE. Chama ainda a atenc?a?o o fato de que os res??duos da equac?a?o do

convenience yield ficam mais pro?ximos da normalidade no modelo CYES, como se pode

notar nesta mesma figura, mesmo o salto ocorrendo apenas na equac?a?o do prec?o. A figura

9 mostra o QQ plot para os res??duos calculados com dados do painel A de petro?leo e tem

uma interpretac?a?o semelhante.

Figura 9: QQ plot para os res??duos das equac?o?es de estado para dados de
petro?leo do painel A

1Um conjunto de dados sera? aderente ao modelo normal se seus quantis emp??ricos forem pro?ximos aos
previstos no modelo normal; logo, seus pontos no QQ plot devem estar pro?ximos da diagonal.



43

Os QQ plots proporcionam uma boa intuic?a?o da adere?ncia de uma varia?vel aleato?ria ao

modelo normal, mas na?o sa?o capazes de responder de maneira objetiva se determinado

conjunto de dados pode ser considerado como normalmente distribu??do ou na?o. Para isso

precisamos do auxilio de um teste de hipo?teses.

Utiliza-se neste trabalho o teste de Jarque-Bera para testar a hipo?tese nula de normalidade

dos res??duos. As tabelas 11 e 12 reportam os valores de assimetria, curtose e p-valor da

estat??stica de Jarque-Bera para os res??duos dos models CYE e CYES.

Base de dados
Modelo Petro?leo (A) Petro?leo (B) Cobre Trigo

Curtose CYES 4.49 4.39 2.45 3.38
CYE 5.60 6.36 9.54 3.95

Assimetria CYES -0.39 -0.15 0.02 0.29
CYE -0.80 -0.71 -0.89 0.42

Estat??stica JB CYES 108.19 109.91 15.20 20.69
CYE 356.58 724.37 2260.70 67.88

p-valor CYES 0.00% 0.00% 0.21% 0.00%
CYE 0.00% 0.00% 0.00% 0.00%

Tabela 11: Medidas de normalidade para os res??duos da equac?a?o do prec?o a? vista

Esta tabela exibe as medidas de normalidade dos res??duos para cada modelo (CYES e CYE) e
cada base de dados. As colunas correspondem a?s bases de dados utilizadas, sendo petro?leo (A) o painel
A de petro?elo e petro?leo (B) o painel B de petro?elo. O p-valor exibido nas u?ltimas linhas e? referente a?
hipo?tese nula de normalidade para o teste de Jarque-Bera.

Base de dados
Modelo Petro?leo (A) Petro?leo (B) Cobre Trigo

Curtose CYES 4.70 4.58 3.31 3.82
CYE 5.68 6.28 4.72 3.89

Assimetria CYES -0.38 -0.15 0.19 0.46
CYE -0.68 -0.47 0.00 0.50

Estat??stica JB CYES 133.25 140.20 12.22 63.60
CYE 346.39 631.78 145.97 76.25

p-valor CYES 0.00% 0.00% 0.49% 0.00%
CYE 0.00% 0.00% 0.00% 0.00%

Tabela 12: Medidas de normalidade para os res??duos da equac?a?o do conveni-
ence yield

Observa-se que o modelo CYES sempre torna a assimetria e a curtose mais pro?ximas dos



44

valores destas varia?veis em uma distribuic?a?o normal (0 e 3, respectivamente), mas na?o o

suficiente para que os testes de Jarque-Bera na?o rejeitem a hipo?tese nula de normalidade,

como pode-se ver nas linhas que conte?m os p-valores, sempre muito pro?ximos de zero.

Estes resultados na?o da?o ind??cios de que o modelo CYES esta? melhor especificado em

termos da normalidade dos res??duos.

5..2.3 Comparac?a?o das REQM para Prec?os de Opc?o?es

Nesta subsec?a?o descreve-se a comparac?a?o dos modelos CYES e CYE em termos dos seus

erros de previsa?o para prec?os de opc?o?es americanas fora da amostra de estimac?a?o.

Para este fim se utilizou uma base de dados de prec?os de opc?o?es americanas de compra

de contratos futuros de petro?leo consistindo de um total de 1680 observac?o?es mensais de

67 contratos distintos no intervalo de tempo de 1/5/2009 a 27/4/2012. Esta amostra

contempla opc?o?es com diferentes maturidades e diferentes prec?os de exerc??cio.

Para fins de ilustrac?a?o se exibe na figura 10 a evoluc?a?o histo?rica dos prec?os de todas as

67 opc?o?es de contratos futuros de petro?leo utilizadas nesta subsec?a?o, assim como o prec?o

do contrato futuro mais curto, F1. Como esperado, os prec?os de opc?o?es apresentam certa

correlac?a?o com F1. Esta correlac?a?o, no entanto, da ordem de 0.7, na?o e? ta?o alta quanto a

que occorre entre contratos futuros (da ordem de 0.98), e permite que opc?o?es tenham uma

dina?mica pro?pria. A comparac?a?o entre os modelos CYES e CYE com base em prec?os de

opc?o?es pode, portanto, ser considerada uma comparac?a?o legitimamente fora da amostra.

A tabela 13 mostra as ra??zes quadradas dos erros quadra?ticos me?dios das previso?es dos

prec?os das opc?o?es americanas em termos moneta?rios (em do?lares) e em termos percentuais

para ambos os modelos CYES e CYE. Os prec?os previstos pelos modelos foram calculados

por meio do me?todo LSM.

Nota-se, primeiramente, que as REQM da tabela 13 sa?o excessivamente altas, ultrapas-

sando 700% para ambos os modelos com saltos e sem saltos, numa clara indicac?a?o de que

nenhum destes modelos e? capaz de explicar os prec?os de opc?o?es observados no mercado de



45

Figura 10: Evoulc?a?o histo?rica da amostra de opc?o?es americanas de petro?leo e
do contrato futuro F1

Do?lares Porcentagem
CYES 8.046 759.861
CYE 9.067 710.300

Tabela 13: Comparac?a?o entre erros de previsa?o dos modelos CYES e CYE para
dados de opc?o?es de futuros de petro?leo
Esta tabela apresenta a comparac?a?o das ra??zes quadradas dos erros quadra?ticos me?dios para ambos os
modelos CYE e CYES utilizando 67 contratos no intervalo 1/5/2009 to 27/4/2012. O tamanho da amostra
e? 1680.



46

maneira apropriada. Observe-se ainda que os resultados sa?o, a primeira vista, amb??guos:

a REQM e? menor para o modelo CYES em termos monetarios e maior para o mesmo

modelo em termos percentuais.

A explicac?a?o deste resultado aparentemente contraditorio pode ser encontrada na figura

11, que conte?m os prec?os de mercado e os prec?os estimados para a opc?a?o CLF1C 951. Note

que os prec?os previstos segundo o modelo CYES sa?o, em geral, maiores que aqueles do

modelo CYE, sendo ambos os modelos incapazes de acompanhar a evoluc?a?o temporal dos

dados de mercado; estes sa?o, na maior parte do tempo, superiores a ambas as previso?es,

fazendo com que a REQM seja menor no modelo CYES. Em certos per??odos de tempo, no

entanto, os prec?os de mercado aproximam-se de zero de maneira muito mais intensa que

as previso?es de ambos os modelos, fazendo que com o erro percentual do modelo CYES

seja muito mais elevado que aquele do modelo CYE, explicando porque este modelo logra

a obtenc?a?o de uma REQM menor em termos percentuais.

Figura 11: Dados de mercado e previso?es para o contrato CLF1C 95.00

1CLF1C 95 e? o co?digo Bloomberg do contrato em questa?o. “CL” e? o co?digo para futuros de petro?leo,
“F1” e? o co?digo para o me?s de maturidade de Janeiro de 2011, “C” e? o co?digo para uma opc?a?o de compra
e 95% e? a raza?o strike / prec?o de exerc??cio.



47

Conclui-se que o modelo CYES na?o apresenta maior adere?ncia aos dados de opc?o?es de

contratos futuros de petro?leo. Tanto o modelo sem saltos quanto o modelo com saltos

mostram-se incapazes de explicar a variac?a?o temporal dos prec?os de opc?o?es, sugerindo que

fatores de risco na?o contemplados no presente trabalho podem explicar sua dina?mica.



48



49

6. Conclusa?o

Com motivac?a?o nas contribuic?o?es recentes da literatura de derivativos de ac?o?es, como

Gurdip Bakashi &amp;amp; Chen (1997), Bates (1991) e Pan (2002), que encontra um pre?mio

de risco de saltos relevante na explicac?a?o de prec?os de opc?o?es, este trabalho verifica a

relvancia de saltos no aprec?amento de derivativos de commodities. Para tanto, estimou-se

um modelo de convenience yield estoca?stico e verificou-se o impacto da inclusa?o de saltos

no prec?o a? vista atrave?s de diversas medidas.

Em nenhum dos criterios utilizados neste trabalho encontrou-se evide?ncias de que saltos

podem aprec?ar derivativos com maior precisa?o ou gerar ganhos em termos da correta

especificac?a?o do modelo: (1) a comparac?a?o de erros de previsa?o para contratos futuros

mostrou uma pequena, pore?m estatisticamente insignificante, vantagem do modelo com

saltos; (2) a comparac?a?o dos erros de previsa?o para dados de opc?o?es na?o mostrou melhor

adarencia de nenhum dos modelos; e (3) a ana?lise de normalidade dos res??duos mostrou

que a curtose e a assimetria sa?o reduzidas com a inclusa?o de saltos, mas a hipo?tese nula

de normalidade e? rejeitada em todos os modelos.

Estes resultados na?o rejeitam a hipo?tese de trajeto?rias continuas para prec?os a? vista feita

pela grande maioria da literatura de aprec?amento de commodities, como Black (1976),

Gibson &amp;amp; Schwartz (1990) e Schwartz (1997), sedimentando caminho seguro para traba-

lhos futuros que venham a fazer este pressuposto.

Este trabalho tambe?m mostra que um modelo de dois fatores com convenience yield es-

toca?stico na?o e? capaz de descrever a dina?mica de prec?os de opc?o?es de maneira adequada,

sugerindo a presenc?a de fatores de risco na?o contemplados e gerando insumos para pes-

quisas futuras. A ana?lise da formac?a?o de grupos de saltos concentrados em determinados

per??odos de tempo da?o ind??cios de que um modelo de volatilidade estoca?stica poderia se

ajustar de maneira mais adequada aos dados e, eventualmente, aprec?ar derivativos de

commodities com maior precisa?o.



50



51

7. Ape?ndice

7..1 Aprec?amento de contratos futuros

Trata-se aqui do aprec?amento do contratos futuros no modelo CYE. Supo?e-se que as

varia?veis de estado S,? seguem o processo

dS = µSSdt + ?SSdZS (7.27)

d? = µ?dt + ??dZ? (7.28)

onde ZS e Z? sa?o movimentos Brownianos correlacionados por

dZSdZ? = ?S?dt. (7.29)

Sejam F 1 e F 2 os prec?os de dois contratos futuros da commodity. Denote por H o valor

de um portfolio auto-financia?vel com ?1 unidades de F
1, ?2 unidades de F

2 e ?S unidades

da commodity. Defina

?1 = F
2
? , ?2 = ?F

1
? , ?S = F

2
SF

1
? ?F

1
SF

2
? . (7.30)

Pelo Lemma de Ito verifica-se

dH =

[
?1µF1F

1 + ?2µF2F
2 + ?S(µS + ?)S

]
dt + (7.31)[

?1F
1
S + ?2F

2
S + ?S

]
S?SdZS +

[
?1F

1
? + ?2F

2
?

]
?cdZc (7.32)

=

[
?1µF1F

1 + ?2µF2F
2 + ?S(µS + ?)S

]
dt (7.33)

onde

µFj =
F
j
SµSS + F

j
? µ? +

1
2
F
j
SS?

2
SS

2 + 1
2
F
j
???

2
? + F

j
t + F

j
S?S?S???S?

Fj
(7.34)



52

para j ? {1, 2}, o que mostra que o portfolio em questa?o e? livre de risco. Logo, por na?o

arbitragem verifica-se dH = rHdt, isto e?,

F 2? µF1F
1 ?F 1? µF2F

2 + (F 2SF
1
? ?F

1
SF

2
? )(µS + ? ? r)S = 0 (7.35)

de modo que

F 2?

[
F 1µV 1 ?F 1SS(µS + ? ? r)

]
= F 1?

[
F 2µF2 ?F 2SS(µS + ? ? r)

]
(7.36)

e que

F 1µV 1 ?F 1SS(µS + ? ? r)
F 1?

= (7.37)

F 2µV 2 ?F 2SS(µS + ? ? r)
F 2?

.
= ??. (7.38)

Isto e?, o prec?o do risco do convenience yield, ??, e? independente do espec??fico contrato

futuro utilizado, dependendo apenas do tempo e das varia?veis de estado.

Suopo?e-se nas pro?ximas linhas que ?? e? constante. Assim, para um dado contrato F =

F(t,S,?) deve valer que

FµF ?FSS(µS + ? ? r) ?F??? = 0. (7.39)

Substitu??ndo o valor µV por 7.34 obte?m-se a seguinte equac?a?o de derivadas parciais:

1

2
FSS?

2
SS

2 +
1

2
F???

2
? + F

j
S?S?S???S? + FSS(r ? ?) + F?(µc ???) + Ft = 0. (7.40)

O movimento Browniano na medida neutra ao risco toma a forma



53

dZ?S = dZS +
µS + ? ? r

?S
dt and dZ?? = dZ? + ??dt (7.41)

de modo que a lei de movimento na medida neutra ao risco e?

dS = (r ? ?)dt + ?SSdZ?S

d? = (µ? ???)dt + ??dZ??

A hipo?tese de que ? segue um processo de reversa?o a? me?dia e?

µ? = ?(?? ?)

e o modelo fica

dS = (r ? ?)dt + ?SSdZ?S

d? = ?(??? ?)dt + ?cdZ?c

onde ?? = ?? ??
?

.

Seja F(T,S,?) o prec?o de um contrato futuro com maturidade T. Pelo Lemma de Ito,

d[ln(S)] = (r ? ? ? 0.5?2S)dt + ?SdZ
?
S (7.42)

de modo que

ln(S(T)) = ln(S(0)) +

? T
0

r(?)d? ?
? T

0

?(?)d? ? 0.5?2ST + ?S
? T

0

dZ?S(?). (7.43)

Defina

X(T) = ln(S(T)) ?
? T

0

r(?)d?, (7.44)



54

donde

X(T) = ln(S(0)) ?
? T

0

?(?)d? ? 0.5?2ST + ?S
? T

0

dZ?S(?). (7.45)

Logo, como X(T) e? normalmente distribu??do, deve-se ter

F(t,T) = E?0[e
X(T)+

? T
0
r(?)d?] = eE?0[X(T)]+

1
2
var0[X(T)]+rT .

O ca?lculo de E?t[X(T)] pode ser efetuado da seguinte maneira. Primeiramente, verifica-se

E?0[X(T)] = ln(S(0)) ? 0.5?2ST ?
? T

0

E?0[?(?)]d?. (7.46)

Para calcular a equac?a?o acima utilizamos a souluc?a?o do processo de reversa?o a? me?dia que

rege o movimento de ?

d? = ?(??? ?)dt + ?cdZ?c , (7.47)

de modo que

?(t) = ?(0)e??t + ??(1 ?e??t) + ??
? t

0

e?(??t)dZ?c (?)

o que implica que

E?0[?(?)] = ?? + (?(0) ? ??)e??? (7.48)

? T
0

E?0[?(?)]d? = ??T +
(?(0) ? ??)

?

(
1 ?e??T

)
, (7.49)

donde



55

E?0[X(T)] = ln(S(0)) ? (? + 0.5?2S)T ?
(?(0) ? ??)

?

(
1 ?e??T

)
. (7.50)

Calcula-se agora var0[X(T)]. Primeiramente,

var0[X(T)] = vart

[? T
0

?(?)d?

]
+ ?2Svar0

[? T
0

dZ?S(?)

]
(7.51)

? 2?Scov0
[? T

0

?(?)d?,

? T
0

dZ?S(?)

]
. (7.52)

E? fa?cil ver que

var0

[? T
0

dZ?S(?)

]
= T (7.53)

de modo que

var0

[? T
0

?(?)d?

]
= var0

[
??

? T
0

? ?
0

e?(s??)dZ?? (s)d?

]
(7.54)

= var0

[
??

? T
t

? T
s

e?(s??)d?dZ?? (s)

]
(7.55)

= var0

[
??

? T
0

1

?
(1 ?e?(s?T))dZ?c (s)

]
(7.56)

= ?2c E?0

[? T
0

1

?
(1 ? 2e?(s?T) + e2?(s?T))dZ?c (s)

2

]
(7.57)

=
?2c
?2
T ? 2

?2?
?3

(1 ?e??T ) +
1

2

?2?
?3

(1 ?e?2?T ) (7.58)



56

cov0

[? T
0

?(?)d?,

? T
0

dZ?S(?)

]
= ??E?0

[
?c

? T
0

1

?
(1 ?e?(s?T))dZ?c (s)... (7.59)

...

? T
0

dZ?S(?)

]
(7.60)

= ??E?0

[
??

? T
t

1

?
(1 ?e?(s?T))dZ?c (s)dZ

?
S(?)

]
(7.61)

=
???S?
?

(
T ?

1

?
(1 ?e??T )

)
(7.62)

(7.63)

e enta?o

var0[X(T)] =
?2?
?2
T ? 2

?2?
?3

(1 ?e??T +
1

2

?2?
?3

(1 ?e?2?T ) (7.64)

+ ?2ST ? 2
???S?S?

?

(
T ?

1

?
(1 ?e??T )

)
(7.65)

Finalmente,

log(F(T)) = E?0[X(T)] +
1

2
var0[X(T)] (7.66)

= log(S) ? ?
1 ?e??T

?
+ A(T) (7.67)

(7.68)

onde

A(T) =

(
r ? ?? +

1

2

?2c
?
?
?c?S?Sc

?

)
T +

1

4
?2?

1 ?e?2?T

?3
(7.69)

+

(
??? + ???S?Sc ?

??
?

)
1 ?e??T

?2
(7.70)



57

7..2 Algoritmo LSM

Esta sec?a?o e? destinada a? uma precisa descric?a?o do algoritmo de m??nimos quadrados de

Monte Carlo (LSM na sigla em ingle?s) utilizado para o ca?lculo dos prec?os de opc?o?es

americanas neste trabalho. Assume-se um espac?o de probabilidade completo (?, F,P) em

um horizonte de tempo finito [0,T1], onde ? e? o conjunto de todas as poss??veis realizac?o?es

? de trajeto?rias das varia?veis de estado em [0,T1], F ? 2? e? a ?-a?lgebra de conjuntos

menuraveis de ? e P : F ? [0, 1] e? a medida de probabilidade.

Suponha que se deseja calcular o valor de um ativo contingente que pode ser exercidos em

todos os pontos do conjunto S ? [0,T1] com a obtenc?a?o de um payoff f(t,?). No caso de

uma opc?a?o de um contrato futuro com maturidade T e prec?o strike K tem-se

S = [0,T1],

f(t,Xt,?t) = max
[
F(t,T,Xt,?t) ?K, 0

]
.

A primeira etapa da aplicac?a?o do algoritmo LSM e? a aproximac?a?o do ativo contingente

por um outro ativo, conhecido como opc?a?o de bermuda, exerc??vel apenas num subconjunto

finito {t1, t2, . . . , tK} ? S. Aqui deve-se utilizar um nu?mero suficientemente grande de

pontos para tornar o erro de aproximac?a?o desprez??vel (para mais detalhes, Longstaff &amp;amp;

Schwartz (2001)).

Para cada ti, seja Mti(?) o valor de continuac?a?o (isto e?, o valor de na?o exerc??cio) da

opc?a?o de bermuda em ti. Suporemos que cada func?a?o Mti pode ser escrita como uma

combinac?a?o de func?o?es ba?sicas {Lj}?j=0:

Mti(?) =
??
j=0

atij Lj(?).

Neste trabalho utiliza-se como func?o?es ba?sicas os polino?mios de Laguerre ponderados:



58

L0(x) = e
?x/2,

L1(x) = e
?x/2(1 ?x),

L2(x) = e
?x/2(1 ? 2x + 0.5x2),

Ln(x) = e
?x/2 e

x

n!

dn(xne?x)

dxn
.

onde, em um modelo multifatorial, deve-se tomar produtos cruzados destas func?o?es ava-

liados em cada uma das varia?veis de estado.

A estimac?a?o de todos os coeficientes atij e? imposs??vel; contarna-se este problema definindo

Mti como sendo a projec?a?o de Mti no subespac?o gerado pelas primeiras N + 1 func?o?es

ba?sicas, de modo que

MNti (?) =
N?
j=0

btij Lj(?).

Os coeficientes btij podem ser estimados por m??nimos quadrados da seguinte maneira.

Seja {?z}Zz=1 um conjunto de Z trajeto?rias das varia?veis de estado na medida neutra ao

risco. Estima-se MNtK?1 regredindo os ganhos realizados descontados pela taxa de juros{
er(tK?tK?1)f(tK,?z)

}Z
z=1

contra as func?o?es ba?sicas avaliadas nas varia?veis de estado. Uti-

lizando a estimativa M?NtK?1 pode-se calcular os ganhos realizados em tK?1 para cada tra-

jeto?ria simulada como sendo o ma?ximo entre o valor de continuac?a?o da opc?a?o e o valor de

exerc??cio. Mais precisamente, o ganho realizado sera?
{

max
(
M?NtK?1 (?z),f(tK?1,?z)

)}Z
z=1

.

O pro?ximo passo e? a estimac?a?o do valor de continuac?a?o em tK?2, M
N
tK?2

, pela regressa?o

dos ganhos realizados
{
er(tK?1?tK?2)max

(
M?NtK?1 (?z),f(tK?1,?z)

)}Z
z=1

contra as func?o?es

ba?sicas avaliadas nas varia?veis de estado em tK?2 analogamente ao que foi feito na u?ltima

regressa?o.

Proceda com estas regresso?es de maneira recursiva calculando MNtK?1,M
N
tK?2

, . . . ,MNt1 . O

valor da opc?a?o de bermuda sera?, aproximadamente, a me?dia dos ganhos realizados em t1



59

entre todas as trajeto?rias simuladas, isto e?,

1

Z

Z?
z=1

max
(
M?Nt1 (?z),f(t1,?z)

)
Utiliza-se esta me?dia para aproximar o prec?o do derivtivo original.



60



61

7..3 Prova de que a func?a?o de verossimilhanc?a pode ser ilimitada na presenc?a

de saltos

Seja z1,z2, . . . ,zN uma amostra de uma mistura de duas distribuic?o?es normais

p(z; ?,µ1,µ2,?1,?2) = ??(z; µ1,?
2
1 ) + (1 ??)?(z; µ2,?

2
2 ), (7.71)

onde ?(z; µ,?2) e? a densidade de N(µ,?2). A func?a?o de verossimilhanc?a sera?

l(?,µ1,µ2,?1,?2; z) =
N?
i=1

ln
(
p(zi; ?,µ1,µ2,?1,?2)

)
, (7.72)

com dominio no espac?o parame?trico ? ? [0, 1]×R×R×R+ ×R+ ? R5. E? fa?cil ver que

? ? (0.5,z1, 0, 0, 1)? ? ??. Se {?n}n?1 e? uma sequencia com elementos em ? que converge

para ? enta?

p(z1; ?n) ?? (7.73)

e, para, k ? 2,

lim
n??

p(zk; ?n) =
1

2
lim
n??

?(zk; proj2,4(?n))? ?? ?
0

+
1

2
lim
n??

?(zk; proj3,5(?n)) (7.74)

=
1

2
?

2?
e?

1
2
z2
k &gt; 0. (7.75)

onde proji,j : R
5 ? R2 e? a func?a?o de projec?a?o nas coordenadas i e j. Isso prova que

p(zk; ?n) vai para o infinito se k = 1 e vai para um nu?mero positivo se k ? 2, de modo

que l(?n; z) ??, como se queria demonstrar.



62



63

7..4 Especificac?a?o Bayesiana

Ambos os modelos CYE e CYES sera?o estimados por meio de uma abordagem Bayesiana

neste trabalho. O vetor de para?metros a ser estimado no modelo com saltos e?

? ? (µ,?,?, ?,??,V,?, ??,?). (7.76)

O vetor de para?metros do modelo sem saltos e? o mesmo, excluindo-se as tre?s u?ltimas

coordenadas (?,??,?), que correspondem a para?metros de saltos.

Com o objetivo de tornar a distribuic?a?o a posteriori mais trata?vel, o vetor de para?metros

? sera? reparametrizado da seguinte maneira:

µm ? µ???? ?
1

2
?2S (7.77)

??m ? ln(1 + ??) ?
1

2
?2 (7.78)

?? ? ??
??
?

(7.79)

e o vetor de para?metros a ser estimado torna-se

? ? (µm,?,?, ?, ??,V,?, ??,?). (7.80)

Assume-se as distribuic?o?es a priori da tabela 14.



64

Para?metro Prior Posteriori marginal Modelo

µm N(µ0,M0) N(·, ·) CYE &amp;amp; CYES
? N(?0,A0) N(·, ·) CYE &amp;amp; CYES
? N(?0,K0) Desconhecida CYE &amp;amp; CYES
??1 W2(R0,v0) Desconhecida CYE &amp;amp; CYES
?? N(??0,G0) N(·, ·) CYE &amp;amp; CYES
V ?2 ?(aV ,bV ) ?(·, ·) CYE &amp;amp; CYES
? B(e,E) B(·, ·) CYES
??m N(µ??,???) N(·, ·) CYES
??2 ?(a?,b?) ?(·, ·) CYES

Tabela 14: Especificac?a?o das distribuic?o?es a posteriori nos modelos CYE e CYES



65

7..5 Deduc?a?o das distribuic?o?es a posteriori

Esta sec?a?o e? destinada a deduc?a?o de todas as distribuic?o?es a posteriori marginais utilizadas

nos me?todos de Gibbs-Sampling deste trabalho.

Aqui sera? conveniente tratar o modelo CYES como uma composic?a?o de quatro niveis

hiera?rquicos: (1) a gerac?a?o dos para?metros segundo a distribuic?a?o de probabilidade a

priori ; (2) a gerac?a?o dos saltos dado os para?metros de salto; (3) a gerac?a?o do prec?o a?

vista e do convenience yield dados os para?metros e as varia?veis de salto; e (4) gerac?a?o dos

prec?os de contratos futuros dadas as varia?veis latentes e os para?metros. Mais precisamente,

? ? p(?) (7.81)

?qi ? Bernoulli(?t?), ?mi ? N(??m,?2) ?i = 1, . . . ,N ? 1 (7.82)

?i+1 = ci + Q?i + ?i, ?i ? N(0, ?), ?i = 1, . . . ,N ? 1 (7.83)

yi = d + Z?i + vi, vi ? N(0,V 2IK×K), ?i = 1, . . . ,N (7.84)

Para tornar as deduc?o?es mais simples faremos algumas convenc?o?es. Defina

?Xi = Xi+1 ?Xi ? (µm ? ?)?t??mi?qi (7.85)

??i = ?i+1 ? ?i ??(?? ?)?t (7.86)

e denote por y?(?i, ?) o vetor de log-prec?os previstos utilizando-se os para?metros ?. Dado

o para?metro ? ? ? utilizaremos a notac?a?o ??? para denotar o vetor de para?metros

excluindo-se o para?metro ?.

7..5.1 Deduc?a?o de µm|??µm, ?q,?m,?, y

Tem-se µm ? N(µ0,M0). Logo, a distribuic?a?o a posteriori p(µm|??µm, ?q,?m,?, y) sera?

proporcional a



66

exp

{
?(µm ?µ0)2

2M0
?

1

2(1 ??2)

N?1?
i=1

[
?2Xi

?t?2S
? 2

?Xi??i
?t?S??

]}
(7.87)

e a

exp

{
?

1

2

[
1

M0
+

?t(N ? 1)
(1 ??2)?2S

]
µ2m +

[
µ0
M0

(7.88)

+

?
(Xi+1 ?Xi + ?i?t??mi?qi))

?2s(1 ??2)
??

?
(?i+1 ? ?i ??(?? ?i)?t

???s(1 ??2)

]
µm

}
(7.89)

Definindo

M?0 =

[
1

M0
+

?t(N ? 1)
(1 ??2)?2S

]?1
(7.90)

µ?0 = M?0

[
µ0
M0

+

?
(Xi+1 ?Xi + ?i?t??mi?qi))

?2s(1 ??2)
??
?

(?i+1 ? ?i ??(?? ?i)?t
???s(1 ??2)

]
(7.91)

verifica-se

µm|??µm, ?q,?m,?, y ? N(µ?0,M?0) (7.92)

7..5.2 Deduc?a?o de ?|???, ?q,?m,?, y

Tem-se ? ? N(?0,A0). Logo, a distribuic?a?o a posteriori p(?|???, ?q,?m,?, y) sera? pro-

porcional a

exp

{
?(???0)2

2A0
?

1

2(1 ??2)

N?1?
i=1

[
?2Xi

?t?2S
? 2

?Xi??i
?t?S??

]}
(7.93)

e a



67

exp

{
?

1

2

[
1

A0
+
?2?t(N ? 1)

(1 ??2)?2?

]
?2 +

[
?0
A0

+ ?

?
(?i+1 ? ?i + ??i?t))

?2? (1 ??2)
(7.94)

? ??
?

(Xi+1 ?Xi ? (µ? ?i)?t??mi?qi)
???s(1 ??2)

]
µm

}
(7.95)

Definindo

A?0 =

[
1

A0
+
?2?t(N ? 1)

(1 ??2)?2?

]?1
(7.96)

µ?0 = A?0

[
?0
A0

+ ?

?
(?i+1 ? ?i + ??i?t))

?2? (1 ??2)
(7.97)

? ??
?

(Xi+1 ?Xi ? (µ? ?i)?t??mi?qi)
???s(1 ??2)

]
(7.98)

tem-se

?|???, ?q,?m,?, y ? N(??0, A?0) (7.99)

7..5.3 Deduc?a?o de ??|????, ?q,?m,?, y

Vale que ?? ? N(??0,G0). Logo, a distribuic?a?o a posteriori p(??|??, ?q,?m,?, y) sera? pro-

porcional a

exp

{
?(??? ??0)2

2G0
?

1

V 2

N?
i=1

K?
j=1

(
y
j
i ? y?j(?i, ????, ??)

)2}
(7.100)

e a



68

exp

{
?(??? ??0)2

2G0
?

1

V 2

N?
i=1

K?
j=1

[
y
j
i ?

(1 ?e??Tj
?

?Tj
)
?? (7.101)

? Xi + ?i
(1 ?e??Tj

?

)
?
(
r ?

1

2

?2?
?2
?
??S??
?

)
Tj (7.102)

?
1

4
?2?

1 ?e?2?Tj
?3

?
(
??S?? ?

?2?
?

)(1 ?e?Tj
?2

)]2}
(7.103)

Um simples argumento de completamento de quadrados mostra que

G?0 =

[
1

G0
+
N

V 2

K?
j=1

(1 ?e??Tj
?

?Tj
)2]?1

(7.104)

??0
? = G?0

[
??0
G0

+
1

V 2

N?
i=1

K?
j=1

(
1 ?e??Tj

?
?Tj

)
(7.105)

×
(
y
j
i ?Xi + ?i

(1 ?e??Tj
?

)
?
(
r ?

1

2

?2?
?2
?
??S??
?

)
Tj (7.106)

?
1

4
?2?

1 ?e?2?Tj
?3

?
(
??S?? ?

?2?
?

)(1 ?e?Tj
?2

))]
(7.107)

enta?o

??0|????0, ?q,?m,?, y ? N(??0
?, G?0). (7.108)

7..5.4 Deduc?a?o de V ?2|??V , ?q,?m,?, y

Tem-se V ?2 ? ?(a,b). Logo, p(V ?2|??V , ?q,?m,?, y) sera? proporcional a

V ?2(a?1)e?bV
2

V ?NKexp

{
?

1

2V 2

N?
i=1

K?
j=1

(
y
j
i ? y?j(?i, ??V )

)2}
(7.109)

e a



69

V ?2(a+
NK
2
?1)exp

{
?

1

2

[
2b +

N?
i=1

K?
j=1

(
y
j
i ? y?j(?i, ??V )

)2]}
(7.110)

de modo que

V ?2|??V , ?q,?m,?, y ? ?

[
a +

N

2
,b +

?N
i=1

?K
j=1

(
y
j
i ? y?j(?i, ??V )

)2
2

]
(7.111)

7..5.5 Deduc?a?o de ??m|????m, ?q,?m,?, y

Como ?mi ? iidN(??m,?2) deve-se ter

p(??m|????m, ?q,?m,?, y) ? exp
{
?

(??m ?µ??m)2

2?2??m
?

1

2?2

N?1?
i=1

(?im ? ??m)2
}

(7.112)

? exp
{
?

1

2

[
1

?2??m
+
N ? 1
?2

]
??2m

}
(7.113)

× exp
{[

µ??m
?2??m

+

?N?1
i=1 ?mi
?2

]
??m

}
(7.114)

Logo, ??m|????m, ?q,?m,?, y seguira? a distribuic?a?o

N

([
1

?2??m
+
N ? 1
?2

]?1[
µ??m
?2??m

+

?N?1
i=1 ?mi
?2

]
,

[
1

?2??m
+
N ? 1
?2

]?1)
(7.115)

7..5.6 Deduc?a?o de ??2|??, ?q,?m,?, y

Tem-se ??2 ? ?(a?,b?). Logo, p(??2|???, ?q,?m,?, y) sera? proporcional a

??2(a??1)e?b??
2

??N?1exp

{
?

1

2?2

N?1?
i=1

(
?mi ? ??m

)2}
(7.116)

e a



70

??2(a?+
N?1

2
?1)exp

{
?

1

2

[
2b? +

N?1?
i=1

(
?mi ? ??m

)2}]}
(7.117)

de modo que

??2|???, ?q,?m,?, y ? ?

[
a? +

N ? 1
2

,b? +

?N?1
i=1

(
?mi ? ??m

)2
2

]
(7.118)

7..5.7 Deduc?a?o de ?|??, ?q,?m,?, y

Tem-se ?t? ? B(e,E). Logo,

p(?t?|???, ?q,?m,?, y) ?
[
(?t?)

?
?qi(1 ? ?t?)N?1?

?
?qi
]

(7.119)

× (?t?)e?1(1 ? ?t?)E?1 (7.120)

? (?t?)
?

?qie?1(1 ? ?t?)N?1?
?

?qi+E?1 (7.121)

de modo que

?t?|???, ?q,?m,?, y ? B
(

?qie,N ? 1 ?
?

?qi + E

)
. (7.122)

7..5.8 Deduc?a?o de ?qi|?, {?qj}j 6=i,?m,?, y

?qi|?,{?qj}j 6=i,?m,?, y pode assumir valores apenas no conjunto {0, 1}. Logo, sua dis-

tribuic?a?o e? do tipo Bernoulli. Segue-se que

P(?qi = 1|?,{?qj}j 6=i,?m,?, y) ? ?t?p(?, y|?,{?qj}j 6=i,?m, ?qi = 1) (7.123)

P(?qi = 0|?,{?qj}j 6=i,?m,?, y) ?
(
1 ? ?t?

)
p(?, y|?,{?qj}j 6=i,?m, ?qi = 0) (7.124)



71

Logo, definindo

C1 = ?t?exp

{
?

1

2(1 ??2)

[
(Xi+1 ?Xi ? (µm ? ?i)?t??mi)2

?t?2S
(7.125)

? 2?
(Xi+1 ?Xi ? (µm ? ?i)?t??mi)(?i+1 ? ?i ? (?? ?i)?t)

?t?S??

]}
(7.126)

C2 =
(
1 ? ?t?

)
exp

{
?

1

2(1 ??2)

[
(Xi+1 ?Xi ? (µm ? ?i)?t)2

?t?2S
(7.127)

? 2?
(Xi+1 ?Xi ? (µm ? ?i)?t)(?i+1 ? ?i ? (?? ?i)?t)

?t?S??

]}
(7.128)

tem-se

P(?qi = 1|?,{?qj}j 6=i,?m,?, y) =
C1

C1 + C2
, (7.129)

P(?qi = 0|?,{?qj}j 6=i,?m,?, y) =
C2

C1 + C2
. (7.130)

7..5.9 Deduc?a?o de ?mi|?, ?q, {?mj}j 6=i,?, y

Tem-se

p(?mi|?, ?q,{?mj}j 6=i,?, y) ? p(?mi|?)p(?, y|?, ?q,{?mj}j 6=i,?mi) (7.131)

Logo, p(?mi|?, ?q,{?mj}j 6=i,?, y) sera? proporcional a



72

exp

{
?

(?mi ? ??m)2

2?2
?

1

2(1 ??2)

[
?2Xi

?t?2s
? 2?

?Xi??i
?t?s??

]}
(7.132)

? exp
{
?

1

2

[
1

2?2
+

?qi
(1 ??2)?t?2S

]
?2mi (7.133)

+

[
??m
?2

+
(Xi+1 ?Xi ? (µm ? ?i)?t)?qi

(1 ??2)?2S?t
(7.134)

? ?
(?i+1 ? ?i ??(?? ?i)?t)?qi

(1 ??2)?t?s??

]
?mi

}
. (7.135)

Defina

?2i =

[
1

2?2
+

?qi
(1 ??2)?t?2S

]?1
(7.136)

µi = ?
2
i

[
??m
?2

+
(Xi+1 ?Xi ? (µm ? ?i)?t)?qi

(1 ??2)?2S?t
??

(?i+1 ? ?i ??(?? ?i)?t)?qi
(1 ??2)?t?s??

]
. (7.137)

Enta?o

?mi|?, ?q,{?mj}j 6=i,?, y ? N(µi,?2i ). (7.138)



73

7..6 Descric?a?o do algoritmo MCMC

Nesta sec?a?o faz-se uma precisa descric?a?o do algoritmo MCMC utilizado para estimar os

modelos CYES e CYE.

O objetivo e? simular uma cadeia cuja distribuic?a?o estaciona?ria e? dada por

p
(

?,{?i}Ni=1,{?qi}
N?1
i=1 ,{?i}

N?1
i=1 |y

)
. (7.139)

A distribuic?a?o 7.139 sera? simulada por meio de um algoritmo MCMC composto por uma

mistura de passos do tipo Gibbs-Sampling e de passos do tipo Metropolos-Hastings gene?-

rico.

Os para?metros µm,?,??,V
?2,?, ??m,?

?2 possuem distribuic?a?o a posteriori conhecida e

sera?o simulados por Gibbs-Sampling. ? possui uma distribuic?a?o a posteriori desconhecida,

mas sua distribuic?a?o condicional apenas a?s varia?veis de estado e? Wishart e sera? utilizada

como densidade geradora de candidatos em seu passo do algoritmo. ? sera? simulado por

um passeio aleatorio. Finalmente, as varia?veis de estado {?i}Ni=1 sera?o simuladas pelo

me?todo de Jong &amp;amp; Shephard (1995)

7..6.1 Simulac?a?o de ?

A distribuic?a?o de ? condicionalmente aos outros para?metros e a?s varia?veis de estado e?

p(?|???, ?q,?m,?) ?
|?|

v0?3
2

R
v0
2

0

exp

{
?

1

2
Tr(R?10 ?)

}
(7.140)

× |?|
N
2 exp

{
?

1

2

N?1?
i=1

r&gt;i ?ri

}
(7.141)

? |?|
v0+N?4

2 exp

{
?

1

2

[
Tr(R?10 ?) +

N?1?
i=1

Tr(rir
&gt;
i ?)

]}
(7.142)

? |?|
v0+N?4

2 exp

{
?

1

2

[
Tr

(
R?10 ? +

N?1?
i=1

rir
&gt;
i ?

)]}
(7.143)



74

onde ri = ?i+1 ? ci ? Q?i. Logo, definindo

vn = v0 + N ? 1 and Rn =
(

R?10 +
N?1?
i=1

rir
&gt;
i

)?1
(7.144)

segue-se que

?|???, ?q,?m,? ? W2(vn, Rn). (7.145)

Suponha agora que todos os outros para?metros e varia?veis de estado esta?o fixados e que se

deseja amostrar ? via Metropolis-Hastings utilizando-se 7.145 como densidade geradora

de candidatos. A probabilidade de aceitar um candidato ?c dado um valor precedente ?

sera?

p(?c|???, ?q,?m,?, y)
p(?|???, ?q,?m,?, y)

p(?|???, ?q,?m,?)
p(?c|???, ?q,?m,?)

p(y|?c, ???, ?q,?m,?)
p(y|?, ???, ?q,?m,?)

(7.146)

Que e? igual a

exp

{
?

1

2V 2

[?
(y
j
i ? y?j(?i, ?c))

2 ?
?

(y
j
i ? y?j(?i, ?))

2

]}
. (7.147)

Em outras palavras, a probabilidade de aceitar o candidato sera? func?a?o da mudanc?a no

erro quadra?tico me?dio.

7..6.2 Simulac?a?o de ?

Para a simulac?a?o de ? utilizaremos um processo de passeio aleatorio conhecido como

MALA. dado um valor precedente, ?, um novo candidato ?c sera? gerado de acordo com a

seguinte densidade:

?c ? N
(
? +

?2?
2

?p(?|???, ?q,?m,?, y)
??

,?2?

)
, (7.148)



75

onde ?? e? escolhido de maneira apropriada para manter a autocorrelac?a?o da cadeia em

niveis razoaveis. A probabilidade de aceitar o candidato sera?

p(?c|???, ?q,?m,?, y)
p(?|???, ?q,?m,?, y)

exp
{
? 1

2??
(???c ?

?p(?c|???,?q,?m,?,y)
??

)2
}

exp
{
? 1

2??
(?c ???

?p(?|???,?q,?m,?,y)
??

)2
} . (7.149)

7..6.3 Simulac?a?o de {?i}Ni=i

{?i}Ni=i|?, ?q,?m, y segue uma distribuic?a?o normal multivariada com me?dia dada pelo

smoothed Kalman Filter. Utiliza-se aqui o algoritmo de Jong &amp;amp; Shephard (1995) para

gerar amostragens desta distribuic?a?o. Defina

G =

[
V IK×K, 0K×2

]
(7.150)

H =

[
02×K, ?

1
2

]
(7.151)

Sejam a1 e P1 os chutes iniciais para o primeiro valor da cadeia e para a matriz de erro

quadra?tico me?dio de a1, respectivamente. Rode, para i = 1, . . . ,N,

ei = yi ? d ? Zai (7.152)

Di = ZPiZ
&gt; + GG&gt; (7.153)

Ki = QPiZ
&gt;D?1i (7.154)

ai+1 = c + Qai + Kiei (7.155)



76

Pi+1 = QPi(Q ? KiZ)&gt; + HH&gt; (7.156)

e armazene {ei}Ni=1,{Di}Ni=1 e {Ki}Ni=1. Defina rN = 0,UN = 0, ? = HH&gt; e rode, para

i = N,.. . , 1,

Ci = ? ? ?Ui? (7.157)

?i ? N(0,Ci) (7.158)

Mi = ?Ui(Q ? KiZ) (7.159)

ri?1 = Z
&gt;D?1i ei + (Q ? KiZ)

&gt;ri + M
&gt;
i C
?1
i ?i (7.160)

Ui?1 = Z
&gt;D?1i Z + (Q ? KiZ)

&gt;Ui(Q ? KiZ) + M&gt;i C
?1
i Mi (7.161)

e armazene {ri}Ni=1,{?i}Ni=1. Jong &amp;amp; Shephard (1995) mostra que os erros das varia?veis de

estado condicionados aos valores das varia?veis de medida podem ser simulados por

?i = Qri + ?i for i = 1, . . . ,N. (7.162)

Finalmente, {?i}Ni=i|?, ?q,?m, y pode ser simulado por

??1 = a1 + ?1 (7.163)

??i+1 = c + Q??i + ?i+1 for i = 1, . . . ,N ? 1. (7.164)



77

7..6.4 Algoritmo de MCMC completo

Seja M o nu?mero de elementos a ser gerados para a cadeia. O algoritmo de MCMC

utilizado neste trabalho pode ser enunciado da seguinte maneira:

Fac?a, para z = 1, . . . ,M ? 1

• Gere µz+1m ? µm|??µm, ?qz,?zm,?z, y utilizando 7.92 (Gibbs-Sampling);

• Gere ?z+1 ? ?|???, ?qz,?zm,?z, y utilizando 7.99 (Gibbs-Sampling);

• Gere ?z+1 utilizando 7.148 como densidade geradora de candidatos e 7.149

como probabilidade de aceite (Metropolis-Hastings MALA);

• gere ?z+1 usando 7.145 como densidade geradora de candidatos e 7.147

como probabilidade de aceite (Metropolis-Hastings);

• Gere ??z+1 ? ??|????, ?qz,?zm,?z, y utilizando 7.108 (Gibbs-Sampling);

• Gere (V ?2)z+1 ? V ?2|??V , ?qz,?zm,?z, y utilizando 7.111 (Gibbs-Sampling);

• Gere ??z+1m ? ??m|????m, ?qz,?zm,?z, y utilizando 7.115 (Gibbs-Sampling);

• Gere (??2)z+1 ? ??2|???, ?qz,?zm,?z, y utilizando 7.118 (Gibbs-Sampling);

• Gere ?z+1 ? ?|???, ?qz,?zm,?z, y utilizando 7.122 (Gibbs-Sampling);

• Fac?a, para i = 1 . . . ,N ? 1

Gere ?z+1mi ? ?mi|?, ?q
z,{?mj}j 6=i,?z, y utilizando 7.138 (Gibbs-

Sampling);

• Fac?a, para i = 1 . . . ,N ? 1

Gere ?qz+1i ? ?qi|?,{?qj}j 6=i,?m,?, y utilizando 7.129 (Gibbs-

Sampling);

• Gere {?z+1i }
N
i=i ? {?i}Ni=i|?, ?qz+1,?z+1m , y utilizando o me?todo 7..6.3

(Gibbs-Sampling);



78



79

7..7 Exemplo das cadeias de Markov: modelo CYES e dados de cobre

Figura 12: Simulac?a?o de µm|y utilizando o modelo CYES e dados de cobre
O gra?fico superior exibe a cadeia simulada para o para?metro. O gra?fico intermediario e? o histograma dos
valores simulados. O gra?fico inferior e? o correlograma da cadeia simulada.



80

Figura 13: Simulac?a?o de ?|y utilizando o modelo CYES e dados de cobre
O gra?fico superior exibe a cadeia simulada para o para?metro. O gra?fico intermediario e? o histograma dos
valores simulados. O gra?fico inferior e? o correlograma da cadeia simulada.

Figura 14: Simulac?a?o de ?|y utilizando o modelo CYES e dados de cobre
O gra?fico superior exibe a cadeia simulada para o para?metro. O gra?fico intermediario e? o histograma dos
valores simulados. O gra?fico inferior e? o correlograma da cadeia simulada.



81

Figura 15: Simulac?a?o de ?S|y utilizando o modelo CYES e dados de cobre
O gra?fico superior exibe a cadeia simulada para o para?metro. O gra?fico intermediario e? o histograma dos
valores simulados. O gra?fico inferior e? o correlograma da cadeia simulada.

Figura 16: Simulac?a?o de ??|y utilizando o modelo CYES e dados de cobre
O gra?fico superior exibe a cadeia simulada para o para?metro. O gra?fico intermediario e? o histograma dos
valores simulados. O gra?fico inferior e? o correlograma da cadeia simulada.



82

Figura 17: Simulac?a?o de ?|y utilizando o modelo CYES e dados de cobre
O gra?fico superior exibe a cadeia simulada para o para?metro. O gra?fico intermediario e? o histograma dos
valores simulados. O gra?fico inferior e? o correlograma da cadeia simulada.

Figura 18: Simulac?a?o de ??|y utilizando o modelo CYES e dados de cobre

O gra?fico superior exibe a cadeia simulada para o para?metro. O gra?fico intermediario e? o histograma dos
valores simulados. O gra?fico inferior e? o correlograma da cadeia simulada.



83

Figura 19: Simulac?a?o de V |y utilizando o modelo CYES e dados de cobre
O gra?fico superior exibe a cadeia simulada para o para?metro. O gra?fico intermediario e? o histograma dos
valores simulados. O gra?fico inferior e? o correlograma da cadeia simulada.

Figura 20: Simulac?a?o de ?|y utilizando o modelo CYES e dados de cobre
O gra?fico superior exibe a cadeia simulada para o para?metro. O gra?fico intermediario e? o histograma dos
valores simulados. O gra?fico inferior e? o correlograma da cadeia simulada.



84

Figura 21: Simulac?a?o de ??m|y utilizando o modelo CYES e dados de cobre
O gra?fico superior exibe a cadeia simulada para o para?metro. O gra?fico intermediario e? o histograma dos
valores simulados. O gra?fico inferior e? o correlograma da cadeia simulada.

Figura 22: Simulac?a?o de ?|y utilizando o modelo CYES e dados de cobre
O gra?fico superior exibe a cadeia simulada para o para?metro. O gra?fico intermediario e? o histograma dos
valores simulados. O gra?fico inferior e? o correlograma da cadeia simulada.



8. Bibliografia

Bates, D. S. (1991). The crash of ’87: Was it expected? the evidence from options
markets. The Journal of Finance, 46 (3), 1009–1044.

Bjerksund, P. (1991). Contingent claims evaluation when the convenience yield is sto-
chastic: Analytic results. Working Paper, Nonvegian School of Economics and Business
Administration, 1–16.

Bjorn Eraker, M. J. &amp;amp; Polsonn, N. (2003). The impact of jumps in volatility and returns.
The Journal of Finance, 58 (3), 1269–1300.

Black, F. (1976). The pricing of commodity contracts. Journal of Financial Economics ,
5 (2), 167–179.

Chib, S. (2001). Markov chain monte carlo methods: Computation and inference. Hand-
book of Econometrics , 5 , 3569–3649.

Gibson, R. &amp;amp; Schwartz, E. S. (1990). Stochastic convenience yield and the pricing of oil
contingent claims. The Journal of Finance, 45 (3), 959–976.

Gurdip Bakashi, C. C. &amp;amp; Chen, Z. (1997). Empirical performance of alternative option
pricing models. The Journal of Finance, 102 (3), 2003–2049.

Hilliard, J. E. &amp;amp; Reis, J. (1998). The jump-risk premia implicit in options: Evidence from
an integrated time-series study. The Journal of Financial and Quantitative Analysis ,
33 (1), 81–86.

Honore?, P. (1998). Pitfalls in estimating jump-diffusion models. Centre for Analytical
Finance Working Paper Series , (18), 1–28.

Johannes, M. &amp;amp; Polson, N. (2002). Mcmc methods for continuous-time financial econo-
metrics. Handbook of Financial Econometrics , 2 , 1–72.

Jong, P. D. &amp;amp; Shephard, N. (1995). The simulation smoother for time series models.
Biometrika, 82 (2), 339–350.

Longstaff, F. A. &amp;amp; Schwartz, E. S. (2001). Valuing american options by simulation: A
simple least-squares approach. Review of Financial Studies , 14 (1), 113–147.

Merton, R. C. (1976). Option pricing when underlying stock returns are discontinuous.
Journal of Financial Economics , 3 (1), 125–144.

Pan, J. (2002). The jump-risk premia implicit in options: Evidence from an integrated
time-series study. Journal of Financial Economics , 63 (1), 3–50.

Schwartz, E. S. (1997). The stochastic behavior of commodity prices: Implications for
valuation and hedging. The Journal of Finance, 52 (3), 923–973.

Working, H. (1949). The theory of price of storage. The American Economic Review ,
39 (6), 1254–1262.

85


</field>
	</doc>
</add>