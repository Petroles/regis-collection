<?xml version="1.0" encoding="utf-8"?>
<add>
	<doc>
		<field name="docid">BR-TU.24825</field>
		<field name="filename">9316_Carmo_FredericoAugustoRosado_D.pdf</field>
		<field name="filetype">PDF</field>
		<field name="text">
i

Nu?mero:356/2006

UNIVERSIDADE ESTADUAL DE CAMPINAS

INSTITUTO DE GEOCIE?NCIAS

PROGRAMA EM GEOCIE?NCIAS

A?REA DE ADMINISTRAC?A?O E POLI?TICA

DE RECURSOS MINERAIS

Frederico Augusto Rosa do Carmo

ESTIMATIVA DAS FUNC?O?ES DE RECUPERAC?A?O DE

RESERVAS MINERAIS USANDO CO?PULAS

Tese apresentada ao Instituto de Geocie?ncias

como parte dos requisitos para obtenc?a?o do t??tulo

de Doutor em Cie?ncias, na a?rea de Administrac?a?o

e Pol??tica dos Recursos Minerais

Orientador: Prof. Dr. Armando Zaupa Remacre

CAMPINAS - SA?O PAULO

Agosto - 2006



ii

c©by Frederico Augusto Rosa do Carmo

Catalogo na Publicac?a?o elaborada pela Biblioteca

do Instituto de Geocie?ncias/UNICAMP

Frederico Augusto Rosa do Carmo
C213c Estimativa das Func?o?es de Recuperac?a?o de Reservas Minerais Usando Co?pulas
Frederico Augusto Rosa do Carmo. - Campinas, SP.:[s.n.], 2006.

Orientador: Armando Zaupa Remacre
Tese (Doutorado) Universidade de Campinas,
Instituto de Geocie?ncias.

1. Geoestat??stica. 2. Co?pulas. 3. Parametrizac?a?o de Reservas.
4. Projeto de Minerac?a?o. 5. Validac?a?o Cruzada. 6. Minerac?a?o.
I. Remacre, Armando Zaupa. Universidade Estadual de Campinas,
Instituto de Geocie?ncias. III. Estimativa das Func?o?es de Recuperac?a?o de Reservas

Minerais Usando Co?pulas.

T??tulo em Ingle?s: Estimation of Recovers Functions of Mineral Reserves Using Copulas.

Keywords: - Geostatistics;
- Copulas;
- Reserve Parametrization;
- Mining Project;
- Cross Validation;
- Mining;

A?rea de Concentrac?a?o: Administrac?a?o e Pol??tica de Recursos Minerais

Titulac?a?o: Doutor em Cie?ncias

Banca examinadora:- Armando Zaupa Remacre;
- Joa?o Felipe Coimbra Leite Costa;

- Giorgio Cesare de Tomi;
- Rodrigo de Souza Portugal;
- Denis Jose? Schiozer.

Data da defesa: 24/08/2006



iii

UNIVERSIDADE ESTADUAL DE CAMPINAS
INSTITUTO DE GEOCIE?NCIAS

PO?S-GRADUAC?A?O EM GEOCIE?NCIAS

AUTOR: Frederico Augusto Rosa do Carmo

ESTIMATIVA DAS FUNC?O?ES DE RECUPERAC?A?O DE RESERVAS

MINERAIS USANDO CO?PULAS

ORIENTADOR: Prof. Dr. Armando Zaupa Remacre

Aprovada em: 24 / 08 / 2006

EXAMINADORES:

Prof. Dr. Armando Zaupa Remacre - Orientador - Presidente

Prof. Dr. Joa?o Felipe Coimbra Leite Costa - UFRGS

Prof. Dr. Giorgio Cesare de Tomi - USP

Prof. Dr. Rodrigo de Souza Portugal - UNICAMP

Prof. Dr. Denis Jose? Schiozer - UNICAMP



iv

Dedico este trabalho a? minha fam??lia, em especial ao amor do meu ? Ange?lica e minhas filhas

Let??cia e Nata?lia.

“ ...devia ter arriscado mais e ate? errado mais

ter feito o que eu queria fazer

queria ter aceitado as pessoas como elas sa?o

cada um sabe a alegria e a dor que traz no corac?a?o...

Devia ter complicado menos, trabalhado menos

ter visto o sol se po?r

devia ter me importado menos com problemas pequenos ...

queria ter aceitado a vida como ela e?

a cada um cabe alegrias e a tristeza que vier”

(Sergio Brito - Tita?s , Epita?fio)



Agradecimentos

A Deus por ter-nos dado a oportunidade de estarmos neste plano; ao meu amigo Geden por

sempre estar disposto a ajudar; a meu orientador prof. Armando pelos ensinamentos profundos e

a severa cobranc?a dos estudos em geoestat??stica; a Moacir Cornetti, sempre quebrando o galho; ao

Doutor Fla?vio Moreira pelo apoio e seus comenta?rios de grande valia; ao prof. Rodrigo Portugal

pela ajuda; A CVRD pelo apoio; aos demais membros desta banca, professores Joa?o Felipe, Giorgio

de Tomi e Dennis Schiozer;

A meu amigo Sergio ”Serja?o” Sacani, sempre ajudando. Aos meus amigos com quem convivi

em Campinas, Rui ”Zenzo” Sansonowski, Pedro ”Scooby” Gonc?alves, Alexandre ”Horte?ncia”

Milagres, Gabriel, e outros, que tornaram agrada?vel minha estada em Campinas ;

Agradec?o em especial aos meus pais, Jose? Francisco e Marlene, meus sogros, Cirineu e Cenira,

por sempre ame poiar nos momentos dif??ceis.

Meus agradecimentos tambe?m escola pu?blica.

v



Suma?rio

1 Introduc?a?o 1

1.1 Seletividade na Minerac?a?o . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 1

1.2 Objetivos . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 5

1.3 Organizac?a?o da Tese . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 5

2 Co?pulas Estat??sticas 7

2.1 Definic?o?es Ba?sicas . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 7

2.1.1 Me?todos probabil??sticos . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 8

2.1.2 Varia?veis aleato?rias . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 8

2.1.3 Func?a?o de distribuic?a?o e func?a?o de densidade . . . . . . . . . . . . . . . . . . . 9

2.1.4 Func?o?es aleato?rias . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 10

2.1.5 Esperanc?a matema?tica . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 11

2.1.6 Varia?ncia, desvio padra?o e momentos . . . . . . . . . . . . . . . . . . . . . . . . 11

2.2 Va?rias varia?veis aleato?rias . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 13

2.2.1 Probabilidade condicional . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 14

2.2.2 Leis marginais . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 15

2.2.3 Esperanc?a Condicional . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 16

2.2.4 Varia?ncia condicional . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 18

2.2.5 Covaria?ncia e correlac?a?o . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 19

2.3 Medidas de Correlac?a?o . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 20

2.3.1 Correlac?a?o Linear . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 21

2.4 Correlac?a?o Na?o-Parame?trica . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 23

vi



vii

2.4.1 A medida ? de Kendall . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 24

2.4.2 A medida ?s de Spearman . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 25

2.5 Definic?o?es e Propriedades Ba?sicas . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 26

2.5.1 Exemplo: distribuic?a?o de Gumbel . . . . . . . . . . . . . . . . . . . . . . . . . . 28

2.6 Co?pulas Elementares . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 29

2.6.1 Lei de unia?o associada a co?pula . . . . . . . . . . . . . . . . . . . . . . . . . . . 29

2.6.2 Leis conjuntas das leis marginais . . . . . . . . . . . . . . . . . . . . . . . . . . . 29

2.7 Teoremas e Propriedades . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 30

2.8 Depende?ncia entre os dados . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 33

2.9 Distribuic?o?es Bivariadas . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 34

2.9.1 Me?todo da Inversa?o . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 35

2.10 Co?pulas Parame?tricas . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 40

2.10.1 Co?pulas Archimedianas . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 40

2.10.2 Medidas Associativas . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 43

2.11 Co?pulas Gaussianas . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 51

3 Parametrizac?a?o de Reservas 53

3.1 Geoestat??stica Mineira . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 53

3.2 Reservas Minerais . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 56

3.3 Reservas Estimadas . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 59

3.4 Geoestat??stica Na?o-Linear . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 65

3.4.1 Func?a?o tonelagem . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 67

3.4.2 Func?a?o Metal Contido . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 68

3.4.3 Func?a?o Metal x Tonelagem . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 69

3.4.4 Func?a?o Teor Me?dio . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 71

3.4.5 Esperanc?a Condicional . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 72

3.4.6 Varia?vel Normal Condicionada . . . . . . . . . . . . . . . . . . . . . . . . . . . . 73



viii

3.4.7 Mudanc?a de Suporte . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 74

4 Co?pula e a Geoestat??stica 77

4.1 Validac?a?o Cruzada . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 77

4.2 A Seletividade das Distribuic?o?es . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 86

4.3 Reserva Ideal via Co?pulas . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 89

4.4 Comparac?a?o com a Simulac?a?o Gaussiana Sequ?encial . . . . . . . . . . . . . . . . . . . . 100

5 Func?a?o de Transfere?ncia 109

5.1 Avaliac?a?o de cava final via co?pulas . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 109

5.2 Mudanc?a de Suporte via Co?pulas . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 112

6 Concluso?es 127

7 Bibliografia 129

A Walker Lake 133

A.1 Simulac?a?o Gaussiana Sequ?encial . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 136

B Distribuic?o?es emp??ricas 141

C Comparac?a?o entre Distribuic?o?es 145

C.1 Efeito Suporte . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 147

C.2 Efeito Informac?a?o . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 149

C.3 Exemplo Teo?rico . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 151

C.4 Func?o?es de Perdas . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 154

C.4.1 Estimativa por E-Type . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 155

C.4.2 Estimativa pela Mediana . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 156

C.4.3 Estimativa Inter Quartis . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 156

D Fluxograma da Metodologia da Tese 159

E Co?digo Fonte 160



Lista de Figuras

1.1 Distribuic?a?o Bivariada dos Teores Verdadeiros (Zv) e Estimados (Z?v ) (JOURNEL e

HUIJBREGTS, 1978) . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 3

2.1 Func?a?o de distribuic?a?o da co?pula Log??stica de Gumbel. A? esquerda seu gra?fico e a?

direita suas curvas de n??vel. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 29

2.2 Simulac?a?o de uma co?pula, onde as distribuic?o?es sa?o uniformes (a) e a transformac?a?o

da simulac?a?o das varia?veis para distribuic?o?es normais (b) . . . . . . . . . . . . . . . . . 32

2.3 Simulac?a?o de duas varia?veis normais independentes (a)(correlac?a?o igual a zero)

transformadas em lognormais com correlac?a?o na?o linear (b) . . . . . . . . . . . . . . . 33

2.4 Simulac?a?o de duas varia?veis dependentes normais (a) transformadas em Lognormais

(b), com grau de correlac?a?o de 0,90. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 34

2.5 Sequ?e?ncia para gerar uma distribuic?a?o lognormal por meio do me?todo da

transformac?a?o inversa . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 37

2.6 Depende?ncia entre as varia?veis aleato?rias Gamma e t . . . . . . . . . . . . . . . . . . . 38

2.7 Comportamento dos graus dos coeficientes de correlac?a?o versus a correlac?a?o linear . . 39

2.8 Co?pula Frank´s para p = 2 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 48

2.9 Co?pula Frank´s para p = 4 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 48

2.10 Co?pula Clayton´s para p = 2 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 49

2.11 Co?pula Clayton´s para p = 4 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 49

2.12 Co?pula Gumbel para p = 2 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 50

2.13 Co?pula Gumbel para p = 4 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 51

ix



x

3.1 Dispersa?o entre teor estimado e teor verdadeiro, mostrando os erros cometidos na

estimativa quando se aplica um teor de corte. . . . . . . . . . . . . . . . . . . . . . . . . 57

3.2 Curva Quantidade de Metal de Walker Lake em diversos suportes. . . . . . . . . . . . 60

3.3 Representac?a?o da regressa?o entre o estimado e o real para uma varia?vel com

distribuic?a?o normal . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 62

3.4 Representac?a?o da regressa?o entre o estimado e o real para uma varia?vel com

distribuic?a?o lognormal. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 64

3.5 Curva tonelagem x teor de corte de uma func?a?o lognormal, para diversos desvios

padro?es . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 68

3.6 Curva metal contido x teor de corte da func?a?o lognormal para diversos desvios padro?es 69

3.7 Curva metal contido versus tonelagem da func?a?o lognormal, para diversos desvios

padro?es . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 70

3.8 Curva Teor Me?dio x teor de corte da func?a?o lognormal para diversos desvios padro?es 71

3.9 Exemplo de um gra?fico de Transformac?a?o Gaussiana . . . . . . . . . . . . . . . . . . . 73

4.1 Validac?a?o Cruzada da Varia?vel V de Walker Lake, mostrando que teores baixos sa?o

subestimados e teores altos sa?o superestimados . . . . . . . . . . . . . . . . . . . . . . . 79

4.2 Erro da Validac?a?o Cruzada . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 81

4.3 Gra?fico de dispersa?o da varia?vel V estimada e os teores reais de Walker Lake,

mostrando que teores baixos sa?o subestimados e teores altos sa?o superestimados . . . 81

4.4 Curvas de Parametrizac?a?o da Estimativa e das Amostras . . . . . . . . . . . . . . . . . 83

4.5 Erro entre as Estimativas e os Dados Reais . . . . . . . . . . . . . . . . . . . . . . . . . . 84

4.6 Benef??cio de Walker Lake, para a selec?a?o perfeita, para a estimativa e o efetivo obtido

pela krigagem . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 86

4.7 Gra?fico de Dispersa?o de Walker Lake, Real vs krigagem (azul) e Co?pulas 10.000

pontos simulados (direita) - Co?pulas 50.000 pontos simulados (esquerda), com as

respectivas esperanc?as condicionais e seus histogramas . . . . . . . . . . . . . . . . . . 90



xi

4.8 Gra?fico de Dispersa?o de Walker Lake, Real vs krigagem (azul) e Co?pulas 78.000 dados

simulados (cinza), com as respectivas esperanc?as condicionais e seus histogramas . . 90

4.9 Curvas de Tonelagem vs teor de Corte (acima) e Quantidade de Metal e Teor Corte

(abaixo) . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 91

4.10 Beneficio obtido via para os dados reais, krigagem ordina?ria e co?pulas . . . . . . . . . 94

4.11 Percentagem de Tonelagem de blocos classificados erroneamente, comparando o

valor real e o valor krigado (vermelho) e a previsa?o por co?pulas (preto). . . . . . . . . 95

4.12 Diferenc?as percentuais de tonelagem nas classificac?o?es de mine?rio e este?ril entre os

dados reais versus krigagem e co?pulas. . . . . . . . . . . . . . . . . . . . . . . . . . . . . 96

4.13 Porcentagem de quantidade de metal com selec?a?o erro?nea, comparando o valor real

e o valor krigado (vermelho) e a previsa?o por co?pulas (preto). . . . . . . . . . . . . . . 97

4.14 Diferenc?as percentuais de quantidade de metal nas classificac?o?es de mine?rio e este?ril

entre os dados reais versus krigagem e co?pulas. . . . . . . . . . . . . . . . . . . . . . . 98

4.15 Benef??cio obtido por krigagem ordina?ria, co?pulas, me?dia SGS, 95% de probabilidade

de estar acima e 95% de probabilidade de estar abaixo. . . . . . . . . . . . . . . . . . . 101

4.16 Curvas de parametrizac?a?o obtidas por krigagem ordina?ria, co?pulas, me?dia SGS, 95%

de probabilidade de estar acima e 95% de probabilidade de estar abaixo. . . . . . . . . 102

4.17 Benef??cio obtido por krigagem ordina?ria, co?pulas, me?dia SGS, 85% de probabilidade

de estar acima e 85% de probabilidade de estar abaixo . . . . . . . . . . . . . . . . . . . 104

4.18 Curvas de parametrizac?a?o obtidas por krigagem ordina?ria, co?pulas, me?dia SGS, 85%

de probabilidade de estar acima e 85% de probabilidade de estar abaixo . . . . . . . . 106

5.1 Walker Lake em sec?a?o vertical pontual: dados reais (esquerda) e krigagem (direita). . 110

5.2 Cavas geradas de Walker Lake com sec?a?o vertical pontual dados reais e krigagem. . . 112

5.3 Simulac?a?o de co?pulas com 3 para?metros de entrada, correlac?o?es entre amostras e

validac?a?o cruzada, amostras no bloco e krigagem e validac?a?o cruzada no bloco e

krigagem. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 114



xii

5.4 Walker Lake com sec?a?o vertical blocos dados reais (esquerda) e krigagem ordina?ria

(direita). . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 115

5.5 Cavas geradas de Walker Lake blocos 5x5. . . . . . . . . . . . . . . . . . . . . . . . . . . 116

5.6 Sequ?enciamento e cava obtida com teor de corte de 65 ppm, via krigagem de blocos

5m x 5m, krigagem (em acima), co?pula 1 (no meio)e co?pula 2 (em baixo). . . . . . . . . 118

5.7 Fluxo de caixa obtido pelo sequ?enciamento com teor de corte de 65 ppm, caso fosse

conhecido os teores verdadeiros de blocos 5m x 5m . . . . . . . . . . . . . . . . . . . . . 119

5.8 Sequ?enciamento e cava obtida com teor de corte de 65 ppm, caso fosse conhecido os

teores verdadeiros de blocos 5m x 5m. . . . . . . . . . . . . . . . . . . . . . . . . . . . . 120

5.9 Sequ?enciamento e cava obtida com teor de corte de 150 ppm, via krigagem de blocos

5m x 5m, krigagem (em acima), co?pula 1 (no meio) e co?pula 2 (em baixo). . . . . . . . 121

5.10 Fluxo de caixa obtido pelo sequ?enciamento com teor de corte de 150 ppm, caso fosse

conhecidos os teores verdadeiros de blocos 5m x 5m. . . . . . . . . . . . . . . . . . . . 123

5.11 Sequ?enciamento e cava obtida com teor de corte de 150 ppm, caso fosse conhecidos

os teores verdadeiros de blocos 5m x 5m. . . . . . . . . . . . . . . . . . . . . . . . . . . 123

5.12 Sequ?enciamento e cava obtida com teor de corte de 260 ppm, via krigagem de blocos

5m x 5m, krigagem (em acima), co?pula 1 (no meio) e co?pula 2 (em baixo). . . . . . . . 125

5.13 Sequ?enciamento e cava obtida com teor de corte de 260 ppm, caso fosse conhecidos

os teores verdadeiros de blocos 5m x 5m. . . . . . . . . . . . . . . . . . . . . . . . . . . 126

A.1 Banco de Dados de Walker Lake, Varia?vel V (esquerda) e Varia?vel U (direita) . . . . . 133

A.2 Amostragem da Varia?vel V (esquerda) e da Varia?vel U (direita) . . . . . . . . . . . . . 134

A.3 Correlac?a?o entre as amostras V e U . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 135

A.4 Modelo de Blocos Walker Lake, Varia?vel V (esquerda) e Varia?vel U (direita) . . . . . . 135

A.5 Ajuste de variograma e vizinhanc?a de Walker Lake . . . . . . . . . . . . . . . . . . . . 136

A.6 Variograma Ajustado para Simulac?a?o Gaussiana Sequ?encial . . . . . . . . . . . . . . . 139

A.7 Exemplo de algumas simulac?o?es gaussianas sequ?enciais de Walker Lake . . . . . . . . 140



xiii

B.1 Func?a?o Emp??rica dos Dados . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 142

B.2 Histograma das amostras e dos dados simulados . . . . . . . . . . . . . . . . . . . . . . 142

B.3 Gra?fico de dispersa?o das amostras (esquerda acima), da simulac?a?o (direita acima),

Esperanc?a Condional (esquerda abaixo)e todos (direta abaixo) . . . . . . . . . . . . . . 144

D.1 Fluxograma da metodologia aplicada para a correc?a?o das curvas de parametrizac?a?o . 159



xiv

UNIVERSIDADE ESTADUAL DE CAMPINAS
INSTITUTO DE GEOCIE?NCIAS

PO?S-GRADUAC?A?O EM GEOCIE?NCIAS
A?REA ADMINISTRAC?A?O E POLI?TICA DE RECURSOS MINERAIS

ESTIMATIVA DAS FUNC?O?ES DE RECUPERAC?A?O DE RESERVAS MINERAIS

USANDO CO?PULAS

RESUMO

TESE DE DOUTORADO

Frederico Augusto Rosa do Carmo

O objetivo principal desta tese foi desenvolver a metodologia de co?pulas aplicada ao problema
de estimativas de reservas condicionadas, corrigindo erros de tonelagem e quantidade de mine?rio
de um projeto, via uma abordagem diferente da simulac?a?o estoca?stica condicional. E? apresentado
um resumo teo?rico que fundamenta o estudo de co?pulas. Inicia-se com a apresentac?a?o de definic?o?es
e conceitos importantes da estat??stica e da probabilidade. Apo?s uma discussa?o sobre medidas
de correlac?a?o, e? introduzido o conceito de co?pulas, desde sua definic?a?o e propriedades ba?sicas
ate? o estudo de alguns tipos de co?pulas essenciais para a aplicac?a?o nesta tese. E? discutida toda
a fundamentac?a?o teo?rica desenvolvida para o ca?lculo de recursos recupera?veis. Os conceitos de
curvas de tonelagem e teores sa?o introduzidos, pois sa?o a base da parametrizac?a?o de reservas
minerais. E? mostrado como a co?pula pode ser utilizada num dos pontos principais da geoestat??stica
mineira, principalmente no que diz respeito ao erro das estimativas. Discorre-se primeiramente
sobre o conceito de validac?a?o cruzada, apresentando a definic?a?o de reserva iluso?ria, o?tima e
ideal. E? definida a reserva ideal utilizando o conceito de co?pulas, onde a krigagem, a simulac?a?o
sequ?encial gaussiana e a co?pula sa?o comparadas, mostrando as consequ?e?ncias da sobreestimativa e
da subestimativa em projetos de cava e sequ?enciamento na minerac?a?o.



xv

UNIVERSIDADE ESTADUAL DE CAMPINAS
INSTITUTO DE GEOCIE?NCIAS

PO?S-GRADUAC?A?O EM GEOCIE?NCIAS
A?REA ADMINISTRAC?A?O E POLI?TICA DE RECURSOS MINERAIS

ESTIMATION OF RECOVERS FUNCTIONS OF MINERAL RESERVES USING

COPULAS

ABSTRACT

DOCTOR THESIS

Frederico Augusto Rosa do Carmo

The aim of this thesis was to develop the applied methodology of copulas in the problem of
conditional reserves estimation. The copulas have a different approach from sequential gaussian
simulation and in this thesis was used to correct the tonnage and ore quantity of a mining project.
It is presented a theoretical summary that is the bases to the study of copulas. It is also presented
a set of definitions and important concepts of the statistics and the probability. After a discussion
about correlation measures, is introducing the concept of copulas, begining with the definition and
basic properties until the study of some types of essential copulas that was applied in this thesis.
Whole the theoretical fundamentation is discussed to developed the calculation of recoverable
resources. The concepts of tonnage and grades curves are introduced, therefore they are the base
of the parametrization of mineral reserves. It is shown how the copulas can be used in the main
points of the mining geostatistics, mainly in what concerns the estimation errors. Firstly the cross
validation concept is presented and the illusory, best and ideal reserves are defined. The ideal
reserves is defined using the concept of copulas, and the results are compared with the kriging and
sequential gaussian simulation. With this comparisons is possible shown the consequences of the
upper-estimation and under estimation in an open pit projects and sequential mining layout.



Cap??tulo 1

Introduc?a?o

1.1 Seletividade na Minerac?a?o

Uma minerac?a?o apresenta incertezas em todas as suas fases. As incertezas econo?micas e geolo?gicas

sa?o fatores de maior risco neste tipo de empreendimento, portanto, deve-se ter uma estimativa

confia?vel dos recursos e reservas minerais, independente do tamanho, do tipo ou de sua localizac?a?o.

Essa previsa?o e? necessa?ria pois, uma minerac?a?o se difere da maioria dos nego?cios, visto que o

conhecimento do produto e? essencialmente baseado em estimativas, ou seja, o que se tem sa?o

expectativas de teores e volumes, cujas incertezas so? diminuira?o no decorrer do projeto.

Para se ter uma ide?ia de como a incerteza geolo?gica e? um fator cr??tico, VALLEE (2000) citou que

em 60 % das minas estudadas, no seu primeiro ano, a taxa me?dia de produc?a?o foi 70% menor do que

a capacidade projetada. Essas falhas foram causadas por problemas na planta piloto, quantidade e

teores de mine?rio.

BURMEISTER (1989) revisou 35 projetos de minerac?a?o, e constatou que dois terc?os desses

projetos na?o conseguiram atingir a meta de produc?a?o. Somente dois projetos alcanc?aram os

objetivos em termos de teores. Ele detectou a raza?o das falhas, como sendo excessiva diluic?a?o,

te?cnicas inapropriadas de estimativas, interpretac?a?o geolo?gica inadequada e furos amostrados

inadequadamente. LASSONDE (1990) mostrou que de 40 projetos de minerac?a?o que falharam no

1



1.1 Seletividade na Minerac?a?o Introduc?a?o

Canada? e nos Estados Unidos entre 1989 e 1990, 29 apresentavam algum erro na estimativa de

reservas. Estas falhas representaram uma perda de US$1.1 bilho?es em um total de US$2.1 bilho?es

investidos. CLOUT (1990) examinou 25 projetos no Canada? e somente tre?s projetos cumpriram as

expectativas. Um exerc??cio similar foi feito por HARQUAIL (1991) atribuindo 20 de 39 falhas a

erros de reservas. McCarthy (DOMINY, 2004) mostrou que os problemas encontrados nos estudo

de projetos podem ser divididos em: erros geote?cnicos (9%), testes metalu?rgicos (15%), estimativas

de reservas e recursos (17%) e planejamento de mina (32%). Ele estima que os erros ligados

diretamente a geologia sa?o aproximadamente de 66%.

O problema central que sera? abordado nessa tese na?o e? novo. Na verdade, remonta a? pro?pria

origem da geoest??stica. D. KRIGE (1951), citado por M. DAVID (1979) ja? expuseram o problema

do vie?s da estimativa. A importa?ncia desta questa?o e? histo?rica, tanto que o mesmo conceito e? o

tema central livro de JOURNEL e HUIJBREGTS (1978), cuja capa apresenta o tema exposto. A

distribuic?a?o bivariada entre o teor verdadeiro e o teor estimado (ver figura 1.1), mostra que a

varia?ncia entre eles sa?o diferentes. Como as func?o?es de parametrizac?a?o de reservas sa?o calculadas

pela distribuic?a?o da estimativa, a priori e? introduzido um erro de seletividade, quando se determina

um teor de corte. Neste exemplo, nota-se que a a?rea de Zv para o mesmo teor de corte zo e? maior

que a a?rea de Z?v , isto indica uma subestimativa. A figura 1.1 mostra que a func?a?o f(z) na?o e? linear,

implicando que a correlac?a?o entre o valor estimado e o valor real e? varia?vel para cada teor de corte.

Esta figura quantifica a sobrestimativa e a subestimativa, quando se aplica um determinado teor de

corte. Nesta tese, esses conceitos sera?o por diversas vezes retomados.

2



1.1 Seletividade na Minerac?a?o Introduc?a?o

Figura 1.1: Distribuic?a?o Bivariada dos Teores Verdadeiros (Zv) e Estimados (Z?v ) (JOURNEL e
HUIJBREGTS, 1978)

Nos u?ltimos 40 anos, os estudos em Fontainebleau tem-se concentrado no efeito

volume-varia?ncia e a escola sul-africana tem seguido o caminho do efeito regressa?o. Esses estudos

de vie?s condicionais buscam correc?o?es para a estimativa de blocos, mas por vias diferentes. O

ponto central e? que a krigagem ou qualquer outro estimador na?o possui a mesma variabilidade no

suporte a qual se deseja estimar, pois todas as curvas do tipo tonelagem e teor sa?o calculadas pela

distribuic?a?o da estimativa.

Se o objetivo e? uma estimativa pontual, os altos valores provavelmente sera?o subestimados e os

baixos valores sera?o superestimados. Se o interesse e? na me?dia geral, este vie?s na?o e? importante.

Se o interesse e? somente em uma extremidade (aplicac?a?o de um teor de corte), geralmente os altos

valores estara?o enviesados. Por exemplo, aplicando um teor de corte econo?mico, isto ira? resultar

em uma subestimativa dos teores e uma superestimativa da tonelagem.

3



1.1 Seletividade na Minerac?a?o Introduc?a?o

Se o objetivo e? estimar blocos, o vie?s reverso ira? ocorrer, os blocos com altos teores sera?o

superestimados e blocos com baixos valores sera?o subestimados. Aplicando teores de corte, o

resultado obtido e? a superestimativa dos teores e subestimativa da tonelagem.

O impacto desses erros na minerac?a?o e? crucial, porque toda a operac?a?o e planejamento de

mina e? baseada no exato conhecimento dos teores. Em face da incerteza do teor do bloco, a todo

momento, e? decidido o destino de um caminha?o carregado: ou a carga vai para o britador ou para

a pilha de este?ril. A escolha erro?nea desse blocos podem ocasionar basicamente dois resultados: o

bloco que possui teor verdadeiro abaixo do teor de corte, ou seja, este?ril, pode ser mandado para

britador; ou um bloco com teor acima do teor de corte, mine?rio, pode ser mandado para a pilha de

este?ril. Para cada decisa?o existe uma consequ?e?ncia em termos de perda.

O teor de corte implica na seletividade da mina e para cada planta de beneficiamento de uma

determinada jazida, existe um limiar onde se aplica um teor de corte com o objetivo de maximizar

o retorno econo?mico sobre o fluxo de caixa relativo a? vida u?til do empreendimento.

Os engenheiros de minas esta?o interessados na proporc?a?o de blocos selecionados pelo teor de

corte, que representa a parte do corpo geolo?gico que possui interesse econo?mico. O teor de corte e?

primordial no que tange a? operac?a?o de uma mina, pois todo o projeto de minerac?a?o esta? baseado

nas reservas recupera?veis. Para a definic?a?o de uma reserva mineral, a interpretac?a?o geolo?gica e a

estimativa de teores sa?o os fatores de maiores riscos.

Este texto abordara? a estimativa de reservas atrave?s de me?todos geoestat??sticos, usando o

paradigma proposto por G. MATHERON (1984) que consiste em estimar reservas usando a

distribuic?a?o bivariada. E? proposta uma nova metodologia baseada no uso de co?pulas.

4



1.2 Objetivos Introduc?a?o

Co?pulas constituem um me?todo para desenvolver novas fam??lias de func?o?es aleato?rias,

dissociando a estrutura de correlac?a?o entre as varia?veis da distribuic?a?o marginal. Em geral,

acredita-se que se foram especificadas as duas distribuic?o?es marginais e o coeficiente de correlac?a?o,

uma distribuic?a?o bivariada com essas propriedades ira? ocorrer. Entretanto, contras-exemplos

podem ser vistos em ARMSTRONG e GALLI (2002).

1.2 Objetivos

Devido ao exposto, o objetivo principal desta tese foi aplicar a metodologia de co?pulas ao problema

de estimativas de reservas, corrigindo as curvas de parametrizac?a?o por um me?todo de simulac?a?o,

onde a validac?a?o cruzada fornece os para?metros impostos pelo modelo correlac?a?o espacial entre os

dados reais e a estimativa. Este e? o cara?ter de originalidade deste trabalho.

1.3 Organizac?a?o da Tese

O Cap??tulo 2 refere-se a uma revisa?o bibliogra?fica sobre co?pulas que sa?o ferramentas estat??sticas

introduzidas por SKLAR em 1959. Elas foram concebidas para resolver o problema probabil??stico

enunciado por Mauricie FRE?CHET, sobre o relacionamento multidimensional entre as func?o?es

probabil??sticas e as distribuic?o?es marginais. As co?pulas sa?o caminhos que especificam uma

distribuic?a?o conjunta, quando se conhece apenas as distribuic?o?es marginais individuais,

indentificando quais partes destas distribuic?o?es sa?o mais correlacionadas.

O Cap??tulo 3 aborda as func?o?es de recuperac?a?o (ou gra?ficos do tipo Tonelagem x Teor) que sa?o um

tipo de representac?a?o dos resultados obtidos. Eles fornecem informac?o?es de ordem quantitativa,

envolvendo desde a fase de tomada de decisa?o pela implantac?a?o do empreendimento mineiro,

ate? o controle de teor no dia-a-dia de uma mina. Portanto, faz-se necessa?rio o estudo destas

func?o?es, pois elas fornecem informac?o?es importantes para o planejamento de estrate?gias gerenciais

e operacionais, que permitem maximizar o benef??cio do empreendimento mineiro.

5



1.3 Organizac?a?o da Tese Introduc?a?o

O Cap??tulo 4 aborda a seletividade das distribuic?o?es. A parametrizac?a?o de reservas seleciona a

porc?a?o da reserva que podera? ser lavrada economicamente. Tendo isto em mente, MATHERON

(1981) apresentou aplicac?o?es da validac?a?o cruzada, definindo conceitos de reservas e realizando

comparac?o?es entre elas.

A validac?a?o cruzada e? um caminho para comparar va?rias suposic?o?es sobre cada modelo

de estimativa (desde a escolha do variograma e seus para?metros ao tamanho da vizinhanc?a de

krigagem) ou sobre os dados (valores que na?o ajustam em sua vizinhanc?a gerando os valores

ano?malos.

Neste cap??tulo e? introduzida a co?pula para o condicionamento das reservas, sendo utilizado o

banco de dados de Walker Lake para explanac?a?o.

O Cap??tulo 5 se dedica a verificar o efeito da aplicac?a?o do condicionamento geoestat??stico usando

co?pulas em func?o?es de transfere?ncias. A func?a?o de transfere?ncia mais importante em um projeto de

mina a? ce?u aberto e? o otimizador de cavas. Foi constru??do um otimizador de Lerchs e Grossmann

2D no programa matlab e tambe?m um sequenciador de cava para verificar o impacto econo?mico

nas tomadas de decisa?o. No ape?ndice D, encontra-se um fluxograma que explica a metodologia

utilizada.

O Cap??tulo 6 trata das concluso?es e sugesto?es para futuros trabalhos.

Todos os programas e figuras desta tese foram feitos no programa Matlab1 e toda geoestat??stica

foi executada no programa Isatis2.

1Matlab e? uma linguagem te?cnica de computac?a?o, sendo um produto da MathWorks, Inc.
2Isatis, programa comercial de geoestat??stica, Geovariances

6



Cap??tulo 2

Co?pulas Estat??sticas

Neste cap??tulo e? apresentado um resumo teo?rico que fundamenta o estudo de co?pulas. Inicia-se com a

apresentac?a?o de definic?o?es e conceitos importantes da estat??stica e da probabilidade, tais como o espac?o de

probabilidade, varia?veis aleato?rias, esperanc?a, varia?ncia e covaria?ncia. Apo?s uma discussa?o sobre medidas de

correlac?a?o, pode-se enta?o introduzir o conceito de co?pulas, desde sua definic?a?o e propriedades ba?sicas ate? o

estudo de alguns tipos de co?pulas essenciais para a posterior aplicac?a?o nesta tese.

2.1 Definic?o?es Ba?sicas

Para a apresentac?a?o das ferramentas e resultados ba?sicos na teoria da probabilidade, comec?amos

com o conceito de eventos e espac?o amostral. Para tanto, e? necessa?rio primeiramente citar os

axiomas da teoria de probabilidades.

Axiomas de probabilidade:

1. Uma ?-a?lgebra sobre um conjunto ? e? uma fam??lia A na?o vazia de subconjuntos de ? tal que:

(a) ? ? A;

(b) Se A ? A enta?o Ac ? A;

(c) Bi ? A, i ? N, implica que
?
i?N

Bi ? A.

2. Os elementos A de uma ?-a?lgebra sobre ? sa?o denominados eventos. O par ordenado (?,A) e?

denomindado espac?o amostral.

7



2.1 Definic?o?es Ba?sicas Co?pulas Estat??sticas

3. Uma probabilidade sobre (?,A) e? uma func?a?o P : A ? R que satisfaz as seguintes

propriedades:

(a) P(A) ? 0, para todo A ? A;

(b) P(?) = 1;

(c) Dados Bi ? A, i ? N, tais que Bi ? Bj = ?, para i 6= j, implicam em

P(
?
i?N

Bi) =
?
i?N

P(Bi).

4. Se (?,A) e? um espac?o amostral e se P e? uma probabilidade sobre (?,A) enta?o (?,A,P) e? um

espac?o de probabilidade.

2.1.1 Me?todos probabil??sticos

As definic?o?es relativas aos modelos probabil??sticos sa?o especificadas pelo espac?o de probabilidade

(CHAUVET, 1999, LANTUE?JOUL, 2002), que pode ser definido como um conjunto ?, juntamente

com uma ?-a?lgebra A e uma medida P nessa ?-a?gebra tal que P(A)=1, onde:

• ?, que e? o conjunto de todas as poss??veis realizac?o?es de um modelo, tambe?m chamado de

universo;

• A, que e? um conjunto de eventos, sendo que um evento pode ser definido como uma fam??lia

de realizac?o?es;

• P e? a probabilidade medida. E? uma func?a?o de F para os nu?mero reais, determinando para

cada evento uma probabilidade entre 0 e 1 e precisa satisfazer certas condic?o?es, principalmente

que P(?)=1.

2.1.2 Varia?veis aleato?rias

A palavra aleato?ria tem como origem a palavra latina aleator??us, que e? relativo a jogo de azar ou aos

jogadores, que por sua vez e? derivada de alea?tor o?ris, que significa jogador, que tem origem em ale?a

8



2.1 Definic?o?es Ba?sicas Co?pulas Estat??sticas

ae, ou seja, dado de jogar, jogo de dados ou qualquer jogo de azar.

Uma varia?vel aleato?ria e? definida como um expressa?o nume?rica associada ao resultado de um

feno?meno aleato?rio. De fato, uma varia?vel aleato?ria e? uma func?a?o que relaciona os eventos de um

espac?o amostral a nu?meros reais.

Cada resultado particular na?o pode ser exatamente previsto, embora se possa descrever o

conjunto de todos os resultados poss??veis, como sendo o espac?o amostral. Dentre os resultados

poss??veis, na?o se tem conhecimento suficiente de qual o resultado a ser obtido, embora esses

resultados, ao fim de uma longa repetic?a?o de observac?o?es mostrem uma grande regularidade

expressa por meio de frequ?e?ncias estat??sticas de ocorre?ncias.

2.1.3 Func?a?o de distribuic?a?o e func?a?o de densidade

Seja X uma varia?vel aleato?ria, enta?o a func?a?o de distribuic?a?o de X e? definida pela seguinte equac?a?o:

FX(x) = P(X ? x). (2.1)

A interpretac?a?o da func?a?o de distribuic?a?o e? fornecer qual e? a probabilidade da varia?vel aleato?ria

X ser menor ou igual a um dado valor x. Uma observac?a?o importante a ser feita e? que uma varia?vel

aleato?ria esta? sempre associada a uma func?a?o de distribuic?a?o. O conhecimento de F(x) caracteriza

completamente x.

A partir da func?a?o de distribuic?a?o e? poss??vel definir a func?a?o de densidade de probabilidade, por

meio da equac?a?o:

f(x) =
?FX(x)
?x

, (2.2)

isto e?, a densidade e? a derivada da func?a?o de distribuic?a?o.

9



2.1 Definic?o?es Ba?sicas Co?pulas Estat??sticas

A func?a?o densidade de probabilidade fornece a probabilidade relativa da varia?vel aleato?ria X

ser igual ao valor x.

2.1.4 Func?o?es aleato?rias

Suponha que X seja uma varia?vel aleato?ria, enta?o, pode-se definir uma nova varia?vel aleato?ria Y

da seguinte forma:

Y = ?(X), (2.3)

onde ? e? uma func?a?o qualquer. A mais simples func?a?o aleato?ria e? a combinac?a?o afim, onde a

varia?vel aleato?ria Y e? func?a?o de X, por meio da seguinte equac?a?o:

Y = aX + b, (2.4)

onde a e b sa?o constantes reais.

As func?o?es aleato?rias podem ser classificadas em estaciona?rias e na?o-estaciona?rias. Um processo

e? dito estaciona?rio se, em qualquer intervalo da func?a?o, os dados estat??sticos representam toda a

func?a?o, portanto, qualquer momento da func?a?o pode ser analisado, na?o importando a origem nem

o final. Ja? uma func?a?o aleato?ria na?o-estaciona?ria esta? intrinsecamente relacionada com a origem,

apresentando sempre uma tende?ncia.

Por exemplo, uma ac?a?o na bolsa comec?a com um certo prec?o no in??cio da manha? e vai terminar

no final do dia com outro valor, sendo que as oscilac?o?es do prec?o no decorrer do dia dependera?

do valor inicial e tera? uma certa tende?ncia, de alta ou de baixa, dependendo do momento. O

mesmo ocorre com os teores de mine?rios. A variac?a?o dos teores e? considerada uma func?a?o aleato?ria

na?o-estaciona?ria, pois depende do valor inicial possuindo uma tende?ncia espacial.

10



2.1 Definic?o?es Ba?sicas Co?pulas Estat??sticas

2.1.5 Esperanc?a matema?tica

Para uma varia?vel aleato?ria cont??nua X com densidade de probabilidade f(x), a esperanc?a

matema?tica e? uma quantidade definida por

E(X) =
?
D
xf(x) dx, (2.5)

onde D e? o dom??nio de definic?a?o de X.

A interpretac?a?o da integral anterior e? uma me?dia ponderada dos poss??veis resultados de X,

com a ponderac?a?o dada pela densidade de probabilidade e em termos pra?ticos, representa o valor

mais prova?vel. Algumas observac?o?es devem ser feitas sobre a esperanc?a matema?tica:

(a) A unidade da esperanc?a e? a pro?pria unidade da varia?vel aleato?ria;

(b) A esperanc?a independe da varia?vel x;

(c) A integral 2.5 pode na?o existir, isto e?, pode na?o haver esperanc?a para uma varia?vel aleato?ria;

Algumas propriedades da esperanc?a

1. Linearidade:

E(aX + bY ) = aE(X) + bE(Y ); (2.6)

2. Idempote?ncia:

E(E(X)) = E(X); (2.7)

3. Esperanc?a de uma func?a?o aleato?ria:

E(?(X)) =
?
D
?(x) f(x) dx (2.8)

2.1.6 Varia?ncia, desvio padra?o e momentos

A partir de uma varia?vel aleato?ria X, com valor esperado finito µ = E(X), pode-se construir uma

nova varia?vel aleato?ria Z = X ? µ, a qual chamamos de varia?vel aleato?ria centrada, pois seu valor

11



2.1 Definic?o?es Ba?sicas Co?pulas Estat??sticas

esperado e? nulo.

De maneira ana?loga, outra varia?vel que pode ser constru??da e? Y = (X ?µ)2. Chama-se varia?ncia

de X a esperanc?a matema?tica de Y , que pode ser computada pela equac?a?o (2.8), isto e?,

V ar(X) = E(Y ) =
?
D

(x ? µ)2 f(x) dx, (2.9)

por meio da observac?a?o de que Y = (X ? µ)2 = X2 ? 2µX + µ2, temos que

V ar(X) = E(Y ) = E((X ? µ)2) = E(X2 ? 2µX + µ2)

Usando a propriedade da linearidade da esperanc?a, segue que

V ar(X) = E(X2) ? 2µE(X) + µ2 = E(X2) ? 2µ2 + µ2

e observando que µ = E(X), obtemos

V ar(X) = E(X2) ? E(X)2, (2.10)

que e? uma expressa?o alternativa para a varia?ncia.

A varia?ncia pode ser interpretada como uma medida de dispersa?o de valores em torno da

me?dia, e tambe?m pode ser usada para aferir o quanto a me?dia e? representativa em uma varia?vel

aleato?ria. Se a varia?ncia e? muito alta, enta?o a me?dia, apesar de ser o valor mais prova?vel, e? pouco

representativa. Ao contra?rio, se a varia?ncia e? baixa, a me?dia representa bem os valores resultantes

da varia?vel aleato?ria.

Algumas observac?o?es devem ser feitas sobre a varia?ncia:

(a) A unidade da varia?ncia e? a unidade da varia?vel aleato?ria ao quadrado;

(b) A varia?ncia independe da varia?vel x;

(c) Assim como a esperanc?a, a varia?ncia de uma varia?vel aleato?ria pode na?o existir.

12



2.2 Va?rias varia?veis aleato?rias Co?pulas Estat??sticas

Como foi observado no item (a), a varia?ncia na?o possui a mesma unidade da varia?vel aleato?ria.

Por exemplo se X esta? em metros, V ar(X) e? uma quantidade em metros quadrados. Para resolver

esta situac?a?o e? que se define o desvio padra?o, que e? a raiz quadrada da varia?ncia, denotado por

?X =
?
V ar(X) . (2.11)

Usando o desvio padra?o de uma varia?vel aleato?ria, pode-se definir uma nova varia?vel aleato?ria

X? =
X ? µ
?

, (2.12)

que e? chamada varia?vel aleato?ria padronizada. A operac?a?o acima, chamada de padronizac?a?o, e? u?til para

se criar uma varia?vel aleato?ria adimensional, que mede o nu?meros de desvios padra?o da varia?vel

original em relac?a?o a? me?dia.

Assim como foram definidas as varia?veis Z = (x ? µ) e Y = (X ? µ)2, pode-se definir uma

varia?vel com pote?ncia gene?rica n

Yn = (X ? µ)n.

A esperanc?a desta nova varia?vel chama-se de momento de ordem n. Neste caso, observa-se que

a esperanc?a e a varia?ncia sa?o momentos de ordem um e dois, respectivamente.

2.2 Va?rias varia?veis aleato?rias

Em um mesmo problema, pode-se considerar o estudo simulta?neo de probabilidade de va?rias

varia?veis associadas a? medidas distintas. Neste caso, estende-se o conceito de varia?vel aleato?ria

para o vetor aleato?rio ( ~X):

~X = (X1,X2, . . . ,Xn),

que e? o agrupamento das varia?veis aleato?rias Xi.

A func?a?o de distribuic?a?o conjunta de um vetor aleato?rio ~X e? definida como

F~X(x1,x2, . . . ,xn) = P(X1 ? x1,X2 ? x2, . . . ,Xn ? xn). (2.13)

13



2.2 Va?rias varia?veis aleato?rias Co?pulas Estat??sticas

Para um vetor aleato?rio com func?a?o de distribuic?a?o F~X(x1,x2, . . . ,xn), se existir uma func?a?o

f(x1,x2, . . . ,xn) ? 0 tal que

F~X(x1,x2, . . . ,xn) =
? x1
??

? x2
??

· · ·
? xn
??

f(?1,?2, . . . ,?n) d?1 d?2 . . . d?n.

enta?o f e? chamada de densidade conjunta do vetor aleato?rio ~X.

Pode-se demonstrar que, a partir de uma distribuic?a?o conjunta, e? poss??vel construir func?o?es de

distribuic?a?o individuais para cada varia?vel aleato?ria Xk. Para isso, basta avaliar o limite da func?a?o

de distribuic?a?o conjunta quando todas as outras varia?veis tendem ao infinito

Fk(xk) = lim
xj?+?

F~X(x1,x2, . . . ,xn), para j = 1, . . . ,n; j 6= k.

Esta nova func?a?o e? denominada distribuic?a?o marginal de Xk.

A densidade marginal de Xk e? obtida por meio da integrac?a?o da densidade conjunta em todas as

varia?veis com excec?a?o da k-e?sima varia?vel

f(xk) =
? +?
??

· · ·
? +?
??

· · ·
? +?
??

f(?1, . . . ,?j, . . . ,?n) d?1 . . . d?j . . . d?n, para j 6= k.

Em particular para o caso de um vetor bidimensional ~Z = (X,Y ), as expresso?es para as

distribuic?o?es marginais sa?o

FX(x) = lim
y?+?

F~Z(x,y), (2.14)

FY (y) = lim
x?+?

F~Z(x,y) (2.15)

e para as densidades marginais sa?o

fX(x) =
? +?
??

f(x,y) dy, (2.16)

fY (y) =
? +?
??

f(x,y) dx. (2.17)

2.2.1 Probabilidade condicional

Em um problema com mais de uma varia?vel aleato?ria, pode-se observar o comportamento

individual de cada varia?vel, quando as outras possuem valores pre?-determinados.

14



2.2 Va?rias varia?veis aleato?rias Co?pulas Estat??sticas

Neste caso, a definic?a?o da probabilidade condicional e?

P(A|B) =
P(A ? B)
P(B)

, (2.18)

onde P(A|B) se le? como probabilidade do evento A ocorrer dado que o evento B ja? ocorreu.

Em termos de uma varia?vel aleato?ria, usa-se a pro?pria definic?a?o de func?a?o de distribuic?a?o, para

se definir a distribuic?a?o condicional de X dado o evento B

FX(x|B) =
F(X ? x,B)

P(B)
. (2.19)

Para o caso em que B e? um resultado nume?rico de uma varia?vel aleato?ria.

2.2.2 Leis marginais

Nomeando as leis marginais de leis de probabilidade de X e Y separadamente. Evidentemente de

acordo com o teorema das probabilidades totais, tem-se:

Lei marginal de X : P(X = xi) =
q?
j=1

pij = pi;

Lei marginal de Y : P(Y = yi) =
p?
i=1

pij = pj.

Os eventos X = xi e Y = yi desde que as probabilidades na?o sejam nulas e definidas ao longo de

duas fam??lias de leis condicionais e sabe-se o valor cont??do em X ou em Y . Relembrando que X e Y

na?o sa?o necessariamente varia?veis aleato?rias, mas varia?veis qualitativas, enta?o as leis condicionais

podem ser escritas como:

Leis condicionais de X se Y = yj :

P(X = xi|Y = yj) =
pij
pj

=
P(X = xi ? Y = yj)

P(Y = yj)
.

Leis condicionais de Y se X = xi :

P(Y = yj|X = xi) =
pij
pi

=
P(X = xi ? Y = yj)

P(X = yi)

15



2.2 Va?rias varia?veis aleato?rias Co?pulas Estat??sticas

Assim o teorema de probabilidades totais pode ser escrito de uma segunda forma:

P(X = xi ? Y = yj) =
q?
j=1

P(X = xi|Y = yj)P(Y = yj) (2.20)

=
p?
i=1

P(Y = yj|X = xi)P(X = xi) (2.21)

Pela fo?rmula de Bayes permite-se exprimir uma lei condicional em func?a?o de outra:

P(X = x|Y = yj) =
P(Y = yj|X = x)P(X = x)

p?
i=1

P(Y = yj|X = xi)P(X = xi)
,

e tambe?m por:

P(Y = y|X = xi) =
P(X = Xi|Y = y)P(Y = y)

q?
j=1

P(X = xi|Y = yj)P(Y = yj)
.

A independe?ncia entre X e Y e?:

pij = pi·p·j.

Isto equivale a dizer que as leis condicionais de q de X em relac?a?o a? Y (enquanto variam em Y )

sa?o ide?nticas. Os mesmos para p para as leis condicionais de Y a? X.

2.2.3 Esperanc?a Condicional

Suponha que Y seja uma varia?vel real, e que a varia?vel X na?o seja necessariamente uma varia?vel

qualitativa. Enta?o, pode-se definir, com algumas reservas, a existe?ncia de uma expressa?o calcula?vel,

sendo poss??vel definir a esperanc?a e a varia?ncia de Y em relac?a?o a X. A esperanc?a condicional de

Y dado X = x e? definido por

E(Y |X = x) =
? +?
??

y fY (y|x) dy. (2.22)

Nota-se que E(Y |X = x) e? func?a?o de x, uma vez que para cada valor de x associa-se o valor

E(Y |X = x). Sendo assim, pode-se definir ?(x) = E(Y |X = x), chamada de func?a?o de regressa?o

de Y em X. Sendo seu gra?fico conhecido como momento condicional de Y em relac?a?o X.

16



2.2 Va?rias varia?veis aleato?rias Co?pulas Estat??sticas

Como E(Y |X = x) depende dos valores originados em X, pode-se definir uma varia?vel

aleato?ria com probabilidade P(X = x) por meio dos valores da esperanc?a condicional E(Y |X = x).

Portanto, a esperanc?a condicional de uma varia?vel Y condicionada a X, denotada por E(Y |X), e? de

fato uma func?a?o aleato?ria da varia?vel X:

?(X) = E(Y |X). (2.23)

Esta varia?vel apresenta um certo nu?mero de propriedades interessantes. Em primeiro lugar a

linearidade como consequ?e?ncia da definic?a?o da esperanc?a:

E(Y1 + Y2|X) = E(Y1|X) + E(Y2|X).

Especialmente neste caso, a esperanc?a desta varia?vel, e? o teorema da esperanc?a total, segundo

SAPORTA (1990, p.76):

Teorema 1 Sejam X e Y duas varia?veis aleato?rias, sabendo que E(Y |X) e? uma func?a?o aleato?ria de X, enta?o
e? poss??vel calcular sua esperanc?a, que e? dada por

E(E(Y |X)) = E(Y ). (2.24)

Demonstrac?a?o

Denotando a func?a?o aleato?ria ?(X) = E(Y |X) e usando a definic?a?o de esperanc?a matema?tica

de uma func?a?o aleato?ria, temos que

E(E(Y |X)) = E(?(X)) =
?
?(x) fX(x) dx

=
? [?

y fY (y|x) dy
]
fX(x) dx

=
? ?

y fY (y|x) fX(x) dy dx

=
?
y

[?
fY (y|x) fX(x) dx

]
dy.

Observando que a integral interna e? a expressa?o da probabilidade total, vem

E(E(Y |X)) =
?
y f(y) dy = E(Y ). (2.25)

Este teorema e? uma ferramenta muito poderosa para se calcular a esperanc?a matema?tica de uma

lei complicada, por meio de leis condicionais simples.

17



2.2 Va?rias varia?veis aleato?rias Co?pulas Estat??sticas

Pode-se notar que na?o e? necessa?rio conhecer explicitamente a lei de Y . Sendo ?(X) outra

varia?vel em func?a?o de X, com E[Y ?(x)|X] = ?(X)E[Y |X], esta demonstrac?a?o simples sera? omitida

(REMACRE, 2001).

2.2.4 Varia?ncia condicional

A varia?ncia de uma varia?vel aleato?ria Y condicionada a X = x e? denominada varia?ncia condicional e

denotada por V ar(Y |X = x), e? definida por meio da esperanc?a condicional, segundo a equac?a?o:

V ar(Y |X = x) = E[(Y ? E(Y |X = x))2|X = x]. (2.26)

Assim como no caso da esperanc?a condicional, a varia?ncia condicional tambe?m e? uma func?a?o

de x, portanto pode ser interpretada como uma func?a?o aleato?ria da varia?vel X

?(X) = V ar(Y |X) = E[(Y ? E(Y |X))2 |X] .

Teorema 2 (Teorema da varia?ncia total) A lei resultante e? chamada de teorema da varia?ncia total:

V ar(Y ) = E[V ar(Y |X)] + V ar[E(Y |X)]. (2.27)

Portanto, a esperanc?a que usualmente significa a me?dia e a varia?ncia de Y e? a soma de dois

termos: a me?dia de diversas varia?ncias condicionais e a varia?ncia de diversas me?dias condicionais.

Demonstrac?a?o

Sabendo que E(Y |X) e? uma func?a?o aleato?ria da varia?vel X, introduzimos a notac?a?o Z = g(X) =

E(Y |X). Em seguida, pode-se desenvolver a expressa?o da varia?ncia de Y do seguinte modo

V ar(Y ) = E[(Y ? EY )2] = E[(Y ? Z + Z ? EY )2].

Desenvolvendo a equac?a?o e agrupando Y ? Z e Z ? EY , temos que

V ar(Y ) = E[(Y ? Z)2] + 2E[(Y ? Z)(Z ? EY )] + E[(Z ? EY )2].

Aplicando o teorema da esperanc?a total ao primeiro termo, obtemos

E[(Y ? Z)2] = E[E[(Y ? Z)2|X]].

18



2.2 Va?rias varia?veis aleato?rias Co?pulas Estat??sticas

que e? a esperanc?a da pro?pria varia?ncia condicional, i.e.,

E[(Y ? Z)2] = E[V ar(Y |X)].

Observando que no u?ltimo termo EY = E(E(Y |X)) = EZ, tambe?m pelo teorema da esperanc?a

total, segue que

E[(Z ? EY )2] = E[(Z ? EZ)2] = V ar(Z) = V ar(E(X|Y )).

O u?ltimo termo e? igual a V ar[E(Y |X)] por definic?a?o da varia?ncia desde que E(Y ) seja a E(Y |X).

Reorganizando a expressa?o de V ar(Y |X). Nota-se que V ar(Y |X) na?o pode ser igualado

a (Y ? E(Y |X))2 que sa?o duas varia?veis que possuem a mesma esperanc?a. Pode-se verificar

que o produto de ambos e? um novo condicionamento: a esperanc?a condicional de X e? fixada

(Y ? E(Y |X)(E(Y |X) ? E(Y )] valendo enta?o:

E[(Y |X) ? E(Y )][E[(Y ? E(Y |X))|X].

Porque E(Y |X) ? E(Y ) e? uma constante.

2.2.5 Covaria?ncia e correlac?a?o

Uma func?a?o aleato?ria Z e? chamada estaciona?ria de segunda ordem se para cada varia?vel Z(x) ela

possui uma me?dia m, finita, independente de x.

A covaria?ncia centrada em relac?a?o a? me?dia e? definida como

Cov(Z,Y ) = ?ZY = E [(Z ? E(X))(Y ? E(Y ))] ,

se estas esperanc?as existem e sa?o finitas. Desenvolvendo o produto, obtemos uma expressa?o

alternativa para a covaria?ncia

Cov(Z,Y ) = E[ZY ? Y E(Z) ? ZE(Y ) + E(Z)E(Y )]

= E(ZY ) ? E(Z)E(Y ). (2.28)

19



2.3 Medidas de Correlac?a?o Co?pulas Estat??sticas

Se Cov(Z,Y ) = 0, dizemos que as varia?veis Z e Y sa?o na?o-correlacionadas. Se Z e Y sa?o

independentes e integra?veis, enta?o sa?o na?o-correlacionadas, pois neste caso E(ZY ) = E(Z)E(Y ),

mas por outro lado, E(ZY ) = E(Z)E(Y ) na?o implica em independe?ncia, ou seja, covaria?ncia nula

na?o necessariamente implica independe?ncia. Algumas propriedades da covaria?ncia sa?o:

a) Cov(Z,Z) = V ar(Z)

b) Cov(aZ,bY ) = abCov(Z,Y ).

Se Z1,Z2, . . . ,Zn sa?o varia?veis aleato?rias integra?veis, enta?o:

V ar(Z1 + Z2 + · · · + Zn) =
n?
i=1

n?
j=1

Cov(Zi,Zj),

=
n?
i=1

V ar(Zi) + 2
n?
i=1

n?1?
j=1

Cov(Zi,Zj).

Esta fo?rmula e? muito importante na geoestat??stica, pois na maioria das vezes, sa?o manipuladas

combinac?o?es lineares do tipo Y =
n?
i=1

?iZi e para deduzi-la e? necessa?rio saber o resultado alge?brico:

Y 2 =

(
n?
i=1

?iZi

)2
=

n?
i=1

n?
j=1

?i?jZiZj.

Sejam Z e Y varia?veis aleato?rias com varia?ncias finitas e positivas. O coeficiente de correlac?a?o

entre Z e Y , ? e? igual a:

?(Z,Y ) =
Cov(Z,Y )
?Z?Y

= E
[(

Z ? E(Z)
?Z

)(
Y ? E(Y )

?Y

)]

2.3 Medidas de Correlac?a?o

Suponha-se simular duas varia?veis aleato?rias X e Y , modelando a relac?a?o ou depende?ncia entre

elas. A maneira mais simples, tambe?m a mais usada, e? por meio de correlac?a?o linear. A correlac?a?o

linear e? somente um caso particular de uma medida de depende?ncia estoca?stica. E? uma medida

de depende?ncia quando as varia?veis aleato?rias sa?o distribuic?o?es multivariadas normais e tambe?m

quando as varia?veis sa?o distribuidas esfericamente ou elipticamente.

20



2.3 Medidas de Correlac?a?o Co?pulas Estat??sticas

Distribuic?o?es el??pticas incluem a distribuic?a?o normal como um caso especial, e sa?o menos

restritivas. Em particular, sob condic?o?es el??pticas, a func?a?o de distribuic?a?o multivariada pode ser

determinada so? com o conhecimento da varia?ncia e de suas correlac?o?es. Ale?m disso, correlac?a?o

linear igual a zero na?o significa que as varia?veis aleato?rias sejam independentes, a menos que se

tenha uma normalidade multivariada.

Um outro problema da correlac?a?o linear, e? que ela pode ser definida no caso da varia?ncia ser

finita. Adicionalmente, ate? mesmo onde correlac?o?es esta?o definidas, as distribuic?o?es marginais e

correlac?o?es, na?o sa?o suficientes para determinar se a distribuic?a?o multivariada e? conjunta. Portanto,

a correlac?a?o na?o descreve todos os para?metros da depende?ncia, particularmente nas caudas das

distribuic?o?es. Uma medida de depende?ncia alternativa conhecida e? a co?pula. Ela permite extrair

a estrutura de depende?ncia, em comum, da func?a?o de distribuic?a?o. Assim, pode-se separar a

estrutura de depende?ncia das func?o?es de distribuic?o?es marginais. Isto e? extremamente u?til, porque

e? um caminho natural que permite a depende?ncia, estando livre das desvantagens da correlac?a?o.

Co?pula tambe?m possui a propriedade de ser invariante para transformac?o?es de varia?veis aleato?rias

e/ou func?o?es de distribuic?o?es.

2.3.1 Correlac?a?o Linear

FRANCIS GALTON (1822-1911),foi quem usou pela primeira vez o termo correlac?a?o, cujo trabalho

influenciou de sobremaneira a estat??stica. GALTON publicou o livro Ge?nio Heredita?rio, em 1869,

onde aplicou conceitos estat??sticos a? problemas da hereditariedade. Ele ficou impressionado com

a distribuic?a?o normal aplicada a? a?rea de biologia por QUETELET, que mostrara no livro O Homem

Me?dio, que a estatura de dez mil pessoas seguiam uma distribuic?a?o normal, ou seja a maioria das

pessoas tinha sua estatura em torno da me?dia e que um nu?mero, cada vez menor de pessoas, vai

sendo encontrado a? medida que se afasta da me?dia.

GALTON cunhou o termo regressa?o quando observou que filhos de homens altos, na?o sa?o, em

21



2.3 Medidas de Correlac?a?o Co?pulas Estat??sticas

me?dia, ta?o altos quanto seus pais, enquanto que filhos de homens muito baixos sa?o, em me?dia,

mais altos que os pais. Ele concebeu uma forma gra?fica de representar as propriedades ba?sicas do

coeficiente de correlac?a?o. Ele aplicou o seu me?todo de correlac?a?o a? variac?o?es de medidas f??sicas,

por exemplo, mostrou a correlac?a?o entre a altura do corpo e o comprimento da cabec?a. Seu aluno

KARL PEARSON desenvolveu a fo?rmula matema?tica, que e? usada ate? hoje e que tem o seu nome

em sua homenagem.

Quando se estuda a relac?a?o entre duas varia?veis X e Y , o conceito de covaria?ncia e? muito

importante. Se a varia?ncia e? uma medida estat??stica por meio da qual chega-se ao desvio padra?o

que e? uma medida de dispersa?o, a covaria?ncia e? uma medida estat??stica por meio da qual chega-se

ao coeficiente de correlac?a?o, que mede o grau de associac?a?o ”linear´´ entre duas varia?veis X e Y .

Sendo, enta?o, duas varia?veis aleato?rias X e Y , com valores reais e varia?ncia finita. O coeficiente

linear de correlac?a?o (conhecido como ?l) entre X e Y e?:

?l(X,Y ) =
Cov(X,Y )?

V ar(X)
?
V ar(Y )

. (2.29)

Onde Cov(X,Y ) = E(XY ) ? E(X)E(Y ) e? a covaria?ncia entre X e Y . A V ar(X) e V ar(Y ) sa?o

as respectivas varia?ncias de X e Y . A correlac?a?o linear e? uma medida de depende?ncia linear. No

caso de uma perfeita depende?ncia linear tem-se: Y = aX + b, seguramente para a ? R e b ? R.

Onde ?l(X,Y ) ± 1. Caso contra?rio, ?1 &amp;lt;?l(X,Y ) &amp;lt;+1.

Ale?m disto a correlac?a?o linear possui a seguinte propriedade:

?l(?X + ?,?Y + ?) = sgn(??)?l(X,Y ), (2.30)

As correlac?o?es lineares podem ser manipuladas, por meio de operac?o?es lineares. Sendo A,B ?

Rmxn,a,b ? Rm e sendo X e Y vetores aleato?rios. Enta?o:

Cov(AX + a,BY + b) = ACov(X,Y )BT .

22



2.4 Correlac?a?o Na?o-Parame?trica Co?pulas Estat??sticas

Disto segue, para ? ? Rn,

V ar(?TX) = ?TCov(X,X)?.

Consequ?entemente, a varia?ncia de uma combinac?a?o linear e? completamente determinada por

meio de pares de covaria?ncia entre os componentes.

A correlac?a?o linear e? uma boa medida de depende?ncia para distribuic?o?es esfe?ricas, nas quais as

varia?veis sa?o normais. Pore?m, para distribuic?o?es que ocorrem na a?rea da geocie?ncias, na?o devem

ser utilizadas, pois a grande maioria dos feno?menos naturais, apresentam caudas ”pesadas´´ e na?o

sa?o distribuic?o?es normais.

2.4 Correlac?a?o Na?o-Parame?trica

Correlac?a?o na?o-parame?trica e? a incerteza sendo interpretada por um coeficiente linear de correlac?a?o

r, de onde sa?o retirados os graus de correlac?o?es na?o-parame?tricos, a partir de N pares de

medidas (xi,yi). A correlac?a?o linear na?o e? uma boa medida quando a func?a?o de distribuic?a?o

de probabilidade e? desconhecida. Ja? as medidas de correlac?o?es na?o-parame?tricas na?o necessitam o

pre?vio conhecimento desta func?a?o.

O conceito fundamental de correlac?a?o na?o-parame?trica, e? que, para cada xi substitu??do por

um outro valor, com um grau de correlac?a?o entre todos outros valores de xi’s da amostra, que

sa?o 1, 2, 3, ...,N, enta?o a lista resultante de valores ira? esboc?ar uma perfeita func?a?o de distribuic?a?o

conhecida. Sera? uma distribuic?a?o uniforme, com valores inteiros entre 1 e N. Na verdade,

melhor que uniforme, desde que cada xi’s sejam todos valores distintos, cada inteiro ira? ocorrer

precisamente uma vez. Se alguns destes xi’s possuirem valores ide?nticos e? necessa?rio atribuir

todos estes valores a? me?dia da correlac?a?o dos valores que sejam ligeiramente diferentes. Estas

correlac?o?es medianas, a?s vezes, sa?o inteiros ou meio-inteiros. Em todos os casos a soma de todas

23



2.4 Correlac?a?o Na?o-Parame?trica Co?pulas Estat??sticas

as correlac?o?es atribu??das tem a mesma soma dos inteiros vindos de 1 ate? N, chamados de 1
2
N(N +1).

O mesmo procedimento, e? feito para yi’s, substituindo cada valor pela correlac?a?o entre os yi’s

da amostra.

Assim, pode-se dizer, que nada impede de se criar medidas estat??sticas para detectar correlac?o?es

uniformes de conjuntos inteiros entre 1 e N, preservando a possibilidade de amarrar estes

graus de correlac?a?o. Existem perdas, quando a informac?a?o dos nu?meros originais e? substitu??da

por graus de correlac?a?o. E? fa?cil gerar exemplos artificiais onde uma correlac?a?o pode ser

detectada parametricamente (por exemplo, correlac?a?o Linear r). Mas na?o podem ser detectadas

na?o-parametricamente. Tais exemplos parame?tricos na vida real sa?o raros. Quando a correlac?a?o

se mostra presentemente como na?o-parame?trica, enta?o realmente ela o e? (para o n??vel de certeza

escolhido). A correlac?a?o na?o-parame?trica e? mais robusta que a correlac?a?o linear, mais resistente a?

variabilidade na?o planejada dos dados e tem a mesma ordem, pois tem-se o senso de que a mediana

e? mais robusta que a me?dia.

Duas equivale?ncias na?o-parame?tricas para o coeficiente de correlac?a?o linear sa?o a de Spearman

(?s) e a de Kendall (?). Se as duas varia?veis de interesse sa?o catego?ricas (Indicatrizes), a

estat??stica na?o-parame?trica apropriada para testar a relac?a?o entre as duas varia?veis sa?o o teste

de Chi-Quadrado (?2) e o Coeficiente Phi (?).

2.4.1 A medida ? de Kendall

A medida de correlac?a?o de Kendall dos pares de um vetor (X,Y ) de uma varia?vel cont??nua aleato?ria,

distribu??dos de acordo com uma func?a?o de distribuic?a?o conjunta H, pode ser definida como a

diferenc?a entre a probabilidade de concorda?ncia menos a probabilidade de discorda?ncia:

? = ?(X,Y ) = Pr[(X1 ? X2)(Y1 ? Y2) &gt; 0] ? Pr[(X1 ? X2)(Y1 ? Y2) &amp;lt;0]. (2.31)

24



2.4 Correlac?a?o Na?o-Parame?trica Co?pulas Estat??sticas

Para demonstrar a lei das medidas de associac?a?o, primeiramente define-se a func?a?o de

concorda?ncia Q, que e? a diferenc?a entre a concorda?ncia e a discorda?ncia entre dois vetores (X1,Y1)

e (X2,Y2) de varia?veis cont??nuas aleato?rias com poss??veis diferentes distribuic?o?es conjuntas, H1 e

H2, mas com marginais comuns F e G. Quando esta func?a?o depende somente da distribuic?a?o de

(X1,Y1) e (X2,Y2) enta?o existe uma co?pula associada a ela.

Teorema 3 Sejam (X1,Y1) e (X2,Y2) vetores de uma varia?vel aleato?ria independente com uma func?a?o de
distribuic?a?o conjunta H1 e H2, respectivamente, com marginais conjuntas F (de X1 e X2) e G (de Y1 e Y2).
Sendo C1 e C2 as respectivas co?pulas de (X1, Y1) e (X2,Y2), enta?o tem-se H1(x,y) = C1(F(x),G(y)) e
H2(x,y) = C2(F(x),G(y)). Chamando Q da diferenc?a entre a probabilidade de concorda?ncia e discorda?ncia
de (X1, Y1) e (X2, Y2),

Q = P[(X1 ? X2)(Y1 ? Y2) &gt; 0] ? P[(X1 ? X2)(Y1 ? Y2) &amp;lt;0].

Enta?o

Q = Q(C1,C2) = 4
? ?
I2

C2(u,v) dC1(u,v) ? 1. (2.32)

2.4.2 A medida ?s de Spearman

Uma outra medida de associac?a?o conhecida e? a de Spearman, sendo (X1,Y1), (X2,Y2) e (X3,Y3) tre?s

vetores aleato?rios independentes com uma func?a?o de distribuic?a?o conjunta H (cujas marginais

foram definidas em F e G) e a co?pula C. A concorda?ncia e? definida como a proporc?a?o da

probabilidade de concorda?ncia menos a probabilidade de discorda?ncia para dois vetores (X1,Y1) e

(X2,Y3), pares de vetores com a mesma marginal, pore?m um vetor tem uma func?a?o de distribuic?a?o

H, no qual os outros componentes sa?o independentes:

? = ?X,Y = 3(P[(X1 ? X2)(Y1 ? Y3) &gt; 0] ? P[(X1 ? X2)(Y1 ? Y3) &amp;lt;0]). (2.33)

25



2.5 Definic?o?es e Propriedades Ba?sicas Co?pulas Estat??sticas

Note que a func?a?o de distribuic?a?o conjunta de (X1,Y1) e? H(x,y), a func?a?o de distribuic?a?o

conjunta de (X2,Y3) e? F(x)G(y) (desde que X2 e Y3 sejam independentes).

Teorema 4 Sendo X e Y varia?veis aleato?rias cont??nuas cuja a co?pula e? C. A correlac?a?o de Spearman de X e
Y pode ser escrita como:

?X,Y = ?C = 3Q(C, ?),

= 12
? ?

I2
uv dC(u,v) ? 3,

= 12
? ?

I2
C(u,v) dudv ? 3. (2.34)

2.5 Definic?o?es e Propriedades Ba?sicas

O termo “co?pula” vem do latim, e se refere a conectar ou unir. Pore?m, nessa tese, o termo

co?pula refere-se a conceitos estat??sticos que expressam o modo pelo qual as varia?veis aleato?rias se

relacionam. E? uma func?a?o que combina func?o?es de distribuic?a?o univariadas em uma distribuic?a?o

de probabilidade multivariada.

Co?pula e? uma ferramenta estat??stica introduzida por Sklar em 1959. Ela foi desenvolvida, para

resolver o problema do espac?o me?trico probabil??stico enunciado por Mauricie Fre?chet (NELSEN,

1999 e RONCALLI, 2002), que e? uma generalizac?a?o do espac?o me?trico introduzido pelo pro?prio

Fre?chet em 1906. Pode-se definir co?pulas como uma func?a?o multivariada com distribuic?o?es

marginais uniformes, definida em um cubo [0, 1]n.

Uma co?pula bidimensional e? uma func?a?o C definida no dom??nio [0, 1] × [0, 1], e contradom??nio

[0, 1] que satisfaz as seguintes propriedades

(a) C(u, 0) = C(0,v) = 0;

(b) C(u, 1) = u e C(1,v) = v;

26



2.5 Definic?o?es e Propriedades Ba?sicas Co?pulas Estat??sticas

(c) Para cada reta?ngulo [u1,u2] × [v1,v2] ? [0, 1]2,

C(u2,v2) ? C(u1,v2) ? C(u2,v1) + C(u1,z1) ? 0,

onde u2 ? u1 e v2 ? v1.

Por esta definic?a?o, nota-se que se uma distribuic?a?o C e? uniforme, enta?o U e V sa?o varia?veis

aleato?rias com distribuic?a?o uniforme. Considerado como um vetor aleato?rio U = (U1,U2):

C(u,v) = P(U ? u; V ? v). (2.35)

A imagem de U e? enta?o a unidade quadra?tica [0, 1]2. A propriedade C(v, 0) = C(0,z) = 0

implica que P(U1 ? 0,U2 ? u) = P(U1 ? u,U2 ? 0) = 0. Isto e? uma func?a?o crescente e as

distribuic?o?es marginais comuns sa?o uniformes.

O teorema de SKLAR, descrito a seguir, e? o resultado mais fundamental para a teoria de co?pulas.

Basicamente, esse teorema afirma que existe uma func?a?o co?pula que relaciona uma distribuic?a?o

multivariada e suas marginais. Para o caso bidimensional, o teorema pode ser enunciado como:

Teorema de SKLAR 1 Se F e? uma func?a?o com distribuic?a?o bidimensional, cujas marginais sa?o F1 e F2.
Enta?o existe uma func?a?o C tal que

F(x1,x2) = C(F1(x1),F2(x2)) (2.36)

Se F1 e F2 sa?o cont??nuas, enta?o a co?pula C e? unicamente determinada com a imagem de F1 × F2.

Por outro lado, se C e? uma co?pula e as func?o?es F1 e F2 sa?o func?o?es de distribuic?a?o unidimensionais, enta?o
a func?a?o F(x1,x2) definida pela equac?a?o (2.36) e? uma func?a?o de distribuic?a?o bidimensional com marginais
F1 e F2.

Demonstrac?a?o: A demonstrac?a?o deste teorema pode ser encontrada em, NELSEN (1999, p. 15),

RONCALLI (2002, p.6) e LINDSKOG (2000, p.4).

Este teorema e? muito importante, pois, por meio dele, pode-se associar qualquer distribuic?a?o

bidimensional a? uma co?pula. Tendo, portanto, uma distribuic?a?o cano?nica da pro?pria distribuic?a?o.

27



2.5 Definic?o?es e Propriedades Ba?sicas Co?pulas Estat??sticas

Por um lado, tem-se as marginais F1 e F2 que sa?o denominadas direc?o?es unidimensionais. Por

outro, tem-se a co?pula que permite a junc?a?o destas marginais, expressando a depende?ncia entre as

direc?o?es unidimensionais. Assim, o teorema de Sklar pode ser utilizado para construir distribuic?o?es

bidimensionais.

2.5.1 Exemplo: distribuic?a?o de Gumbel

No que se segue, apresenta-se um exemplo da utilizac?a?o do teorema de Sklar para a construc?a?o de

uma co?pula por meio da distribuic?a?o bidimensional denominada distribuic?a?o Log??stica de Gumbel:

F(x1,x2) = (1 + e
?x1 + e?x2 )?1

definido em R2. Pode-se notar que as marginais sa?o

F1(x1) ? lim
x2??

F(x1,x2) = (1 + e
?x1 )?1

F2(x2) ? lim
x1??

F(x1,x2) = (1 + e
?x2 )?1.

Definindo-se u1 = F1(x1) e u2 = F2(x2), pode-se calcular os quantis das func?o?es acima (ver

Figura 2.1)

F?11 (u1) = ln u1 ? ln(1 ? u1)

F?12 (u2) = ln u2 ? ln(1 ? u2).

Podendo ser deduzida a func?a?o:

C(u1,u2) = F(F
?1
1 (u1),F

?1
2 (u2))

= F(ln u1 ? ln(1 ? u1), ln u2 ? ln(1 ? u2))

=
(

1 +
1 ? u1
u1

+
1 ? u2
u2

)?1
=

u1u2
u1 + u2 ? u1u2

,

cujo gra?fico e curvas de n??vel podem ser observados na Figura 2.1.

28



2.6 Co?pulas Elementares Co?pulas Estat??sticas

Figura 2.1: Func?a?o de distribuic?a?o da co?pula Log??stica de Gumbel. A? esquerda seu gra?fico e a? direita
suas curvas de n??vel.

2.6 Co?pulas Elementares

O estudo da lei de probabilidade de uma varia?vel aleato?ria Y conhecida por um valor proveniente

de uma outra varia?vel aleato?ria X e? fundamental para problemas de aproximac?a?o e tambe?m de

previsa?o. E? necessa?rio saber, primeiro, como e? a lei de distribuic?a?o de probabilidade da Co?pula

(X,Y ) que esta? aplicada no trio (?,A,P) em R2.

2.6.1 Lei de unia?o associada a co?pula

Para uma lei de co?pula (X,Y ) a PXY e? inteiramente definida pelo arranjo dos nu?meros:

PXY (xi; yj) = P(X = xi ? Y = yj), no caso de uma lei de distribuic?a?o finita, a forma desta

pode ser representada por uma tabela. Note que pela pij = P(X = xi ? Y = yj) claramente tem-se?
i

?
j
pij = 1.

2.6.2 Leis conjuntas das leis marginais

Se (X,Y ) sa?o valores de R2 tem-se a func?a?o de repartic?a?o da co?pula H(x,y) definida por:

H(x,y) = P(X &amp;lt;x ? Y &amp;lt;y).

29



2.7 Teoremas e Propriedades Co?pulas Estat??sticas

Estas func?o?es de repartic?a?o marginais deduzidas sa?o:

F(x) = H(x; ?) = P(X &amp;lt;x).

G(y) = H(?; y) = P(Y &amp;lt;y).

Se a Co?pula de (X,Y ) admite uma densidade h(x,y):

h(x,y) =
?2H

?x?y
.

As densidades marginais sa?o obtidas por:

f(x) =
?

R
h(x,y)dy.

g(y) =
?

R
h(x,y)dx.

2.7 Teoremas e Propriedades

O teorema fundamental afirma que, se uma junc?a?o ou uma func?a?o de distribuic?a?o multivariada

marginal cont??nua, pode ser escrita em termos de uma func?a?o u?nica, isto e? chamado de co?pula.

Assim, a func?a?o de co?pula descreve como a func?a?o multivariada e? unida com as func?o?es de

distribuic?o?es marginais. Este resultado e? importante, pois permite construir func?o?es de distribuic?a?o

comuns, por meio de func?o?es marginais, considerando a estrutura de depende?ncia entre elas.

Sejam X1,X2, . . . ,Xn varia?veis aleato?rias cont??nuas com func?o?es de distribuic?o?es F1,F2, . . . ,Fn,

respectivamente, e a func?a?o de distribuic?a?o conjunta H. Pode-se dizer que X1,X2, . . . ,Xn sa?o uma

Co?pula C.

Teorema 5 Sejam X1,X2, . . . ,Xn varia?veis aleato?rias cont??nuas com Co?pula CX1X2...Xn . As varia?veis
X1,X2, . . . ,Xn sa?o independentes se, e somente se, CX1X2...Xn = ?(x1,x2, . . . ,xn) ? x1x2 · · ·xn.

30



2.7 Teoremas e Propriedades Co?pulas Estat??sticas

Esta e? uma propriedade importante da teoria da co?pula, pois para transformac?o?es estritamente

mono?tonas de qualquer varia?vel aleato?ria da co?pula, sa?o invariantes, ou se transformam de modos

simples. Nota-se que, se a func?a?o de distribuic?a?o de uma varia?vel aleato?ria X e? cont??nua, e se ?

e? estritamente a func?a?o mono?tona cujo dom??nio conte?m R(X), enta?o a func?a?o de distribuic?a?o da

varia?vel aleato?ria ?(X) tambe?m e? cont??nua.

Teorema 6 Sejam X1,X2, . . . ,Xn varia?veis aleato?rias cont??nuas com Co?pula CX1X2...Xn . Considere as
func?o?es aleato?rias

Y1 = ?1(X1), Y2 = ?2(X2), . . . ,Yn = ?n(Xn),

onde as func?o?es ?k sa?o estritamente crescentes em R(X1),R(X2), . . . ,R(Xn) respectivamente. Enta?o

CY1Y2...Yn = CX1X2...Xn (2.37)

Isto e?, a co?pula CX1X2...Xn e? invariante sob transformac?o?es crescentes de X1,X2, . . . ,Xn.

A completa discussa?o e prova dos teoremas pode ser encontrada em NELSEN (1999),

RONCALLI (2002) e LINDSKOG (2000). Apesar de na?o ser um dos objetivos desta tese, sera?

apresentado o algoritmo de gerac?a?o de valores aleato?rios de co?pulas, que pode ser utilizado em

muitos outros casos.

Considere a situac?a?o geral, de uma gerac?a?o aleato?ria para n-Co?pula C. Tem-se:

Ck(u1, . . . ,un) = C(u1, . . . ,uk, 1, . . . , 1),k = 2, . . . ,n ? 1

Denomina-se k-marginais de C(u1, . . . ,un). Ale?m disto C1(u1) = u1 e Cn(u1, . . . ,un) =

C(u1, . . . ,un). Sendo (U1, . . . ,Un) uma func?a?o de distribuic?a?o conjunta de C. Enta?o a distribuic?a?o

conjunta de Uk possui valores dos primeiros k-1 componentes de (U1, . . . ,Un), sendo determinado

por:

Ck(uk|u1, . . . ,uk?1) = P[Uk ? u1|U1 = u1, . . . ,Uk?1 = uk?1], (2.38)

=
?k?1Ck(u1, . . . ,uk)
?u1 · · ·?uk?1

/
?k?1Ck(u1, . . . ,uk)
?u1 · · ·?uk?1

(2.39)

31



2.7 Teoremas e Propriedades Co?pulas Estat??sticas

Nota-se que para uma func?a?o crescente de uma das varia?veis dada por uj 7? C(u) para j =

1, . . . ,n sa?o diferencia?veis quase todo o tempo, a derivada parcial de primeira ordem existe quase

sempre (u1, . . . ,un) em Rn. O pro?ximo passo do algoritmo e? gerar um valor aleato?rio (u1, . . . ,un)

para C(u1, . . . ,un).

Algoritmo ba?sico para gerar co?pulas

1. Simular um valor u1 de U(0, 1),

2. Simular um valor u2 de C2(u2|u1),

3. Simular um valor un de Cn(un|u1, . . . ,un?1).

A Figura 2.2, exemplifica os passos 1 e 2 do algoritmo descrito acima. Primeiramente, e? feita

a simulac?a?o de uma varia?vel uniforme (u1 ? x), depois, e? simulada a segunda varia?vel (u2 ? y)

condicionada a? primeira. Geralmente, deseja-se outra distribuic?a?o estat??stica, sendo poss??vel

a transformac?a?o dos dados em qualquer outra distribuic?a?o. No exemplo da Figura 2.2 (b), a

simulac?a?o bivariada uniforme foi transformada em uma distribuic?a?o bivariada normal.

Figura 2.2: Simulac?a?o de uma co?pula, onde as distribuic?o?es sa?o uniformes (a) e a transformac?a?o da
simulac?a?o das varia?veis para distribuic?o?es normais (b)

32



2.8 Depende?ncia entre os dados Co?pulas Estat??sticas

2.8 Depende?ncia entre os dados

Em uma simulac?a?o estoca?stica, e? necessa?rio escolher a distribuic?a?o de probabilidade das varia?veis

aleato?rias de entrada. Em casos mais complexos, e? necessa?rio saber, que tipo de depende?ncia

existe entre as varia?veis. O ideal seria que os dados refletissem isso de maneira clara. Mas na

maioria dos casos, na?o se conhece com certeza a distribuic?a?o da varia?vel, sendo ainda mais dif??cil

conhecer a depende?ncia entre elas. Mesmo assim, quando se pressupo?e que estas distribuic?o?es

multivariadas sejam relativamente conhecidas, estas podem modelar um nu?mero limitado de

relac?o?es de depende?ncia.

A metodologia mais comum, quando se trata de simulac?a?o estoca?stica e se objetiva simular

varia?veis lognormais independentes, e? simular duas varia?veis aleato?rias normais e calcular a

exponencial para cada valor simulado. Mas a questa?o que surge e?: ate? que ponto essas varia?veis sa?o

independentes? Veja na Figura 2.3, que existe uma correlac?a?o na?o linear em (b), apesar da simulac?a?o

normal (a) na?o apresentar correlac?a?o. Outra considerac?a?o que deve ser feita e? como a depende?ncia

entre elas afeta os resultados. Na verdade, sabe-se que em dados reais, as condic?o?es (aleato?rias)

afetam ambas as varia?veis, e ignorar isso nas simulac?o?es pode conduzir a resultados erro?neos.

Figura 2.3: Simulac?a?o de duas varia?veis normais independentes (a)(correlac?a?o igual a zero)
transformadas em lognormais com correlac?a?o na?o linear (b)

33



2.9 Distribuic?o?es Bivariadas Co?pulas Estat??sticas

Para se obter a simulac?a?o de varia?veis aleato?rias lognormais com correlac?a?o, basta impor na

matriz de correlac?a?o entre as varia?veis o grau de associac?a?o desejado. Por exemplo: duas varia?veis

normais podem ser simuladas com correlac?a?o de 90%, seguindo o mesmo procedimento anterior.

Observa-se na Figura 2.4, que existe uma tende?ncia dos baixos valores de X estarem associados a

baixos valores de Y e similarmente altos valores de X estarem associados com altos valores de Y .

Essa depende?ncia foi determinada pelo coeficiente de correlac?a?o entre as duas varia?veis normais

subjacentes.

Figura 2.4: Simulac?a?o de duas varia?veis dependentes normais (a) transformadas em Lognormais
(b), com grau de correlac?a?o de 0,90.

A distribuic?a?o lognormal bivariada (ou outra espec??fica) e? uma soluc?a?o simples e pode ser

generalizada para mais de duas varia?veis, sempre com distribuic?o?es marginais com diferentes

para?metros. Outras distribuic?o?es multivariadas podem ser geradas, mas a escolha destas e? limitada

e so? e? aplicada quando as distribuic?o?es marginais possuem a mesma distribuic?a?o teo?rica. Na pra?tica,

isso e? uma grande restric?a?o.

2.9 Distribuic?o?es Bivariadas

O me?todo, descrito anteriormente, de gerar uma distribuic?a?o bivariada lognormal e? simples e

serve para explicar um me?todo geral e mais aplica?vel. Primeiro, geram-se pares de valores de uma

distribuic?a?o normal bivariada. Ha? uma relac?a?o de depende?ncia entre estas duas varia?veis e cada

34



2.9 Distribuic?o?es Bivariadas Co?pulas Estat??sticas

uma tem uma distribuic?a?o marginal normal. Depois, aplica-se a func?a?o exponencial sobre cada

valor, mudando assim a distribuic?a?o marginal normal para lognormal. Isto e? a pro?pria definic?a?o

de lognormal, se X e? normal eX e? lognormal. Sejam µ e ?2 a me?dia e a varia?ncia dos logaritmos,

enta?o logX ? N(µ,?2). Seja Y uma varia?vel normal N(0,1). Por definic?a?o, tem-se: log X = µ + ?Y .

Neste caso, as relac?o?es sa?o: X = eµ+?Y e Y = (log X?µ)
?

. As varia?veis assim transformadas ainda

apresentam uma depende?ncia estat??stica.

No caso em que X e Y sa?o lognormais, portanto logX e logY sa?o normais (REMACRE &amp;amp;

UZUMAKI, 1995), enta?o:

log X ? N(µx,?2x)

log Y ? N(µy,?2y)

? = corr(log X,LogY )

Se outra func?a?o fosse usada, esse me?todo poderia ser generalizado para criar varia?veis aleato?rias

bivariadas com depende?ncia e com outras distribuic?o?es marginais. De fato, ha? um outro me?todo de

criar varia?veis aleato?rias dependentes, mais complexas do que uma simples exponenciac?a?o.

2.9.1 Me?todo da Inversa?o

Um simples exemplo deste procedimento pode ser dado por meio de uma func?a?o de distribuic?a?o

bivariada H com marginais cont??nuas F e G, invertida via co?pulas.

C(u,v) = H(F (?1)(u),G(?1)(v)).

Com esta co?pula, novas distribuic?o?es bivariadas com marginais arbita?rias, ditas F ? e G? podem

ser constru??das pelo teorema de SKLAR: H(x,y) = C(F ?(x),G?(y)). Esta? claro, que esta func?a?o e?

igual a func?a?o da Co?pula de sobrevive?ncia:

C?(u,v) = H?(F? (?1)(u),G?(?1)(u)),

35



2.9 Distribuic?o?es Bivariadas Co?pulas Estat??sticas

onde F? (?1) e? chamado de quasi-inverso de F? , que e? equivalente a? F? (?1)(t) = F (?1)(1 ? t). Por

exemplo, a maneira usual para se obter estes resultados e? gerar pares de valores para distribuic?o?es

normais bivariadas. A depende?ncia estat??stica entre estas duas varia?veis e? uma distribuic?a?o

marginal normal. O pro?ximo passo, e? aplicar a transformac?a?o (por exemplo, em uma func?a?o

exponencial), sendo aplicada separadamente para cada varia?vel, mudando a distribuic?a?o marginal

para lognormal. A varia?vel transformada apresentara? uma depende?ncia estat??stica.

Se a transformac?a?o satisfato?ria e? encontrada, este me?todo pode ser generalizado. Pode-se criar

uma depende?ncia entre os vetores bivariados, que por sua vez, estara?o sujeitos a? distribuic?a?o

marginal. Pela definic?a?o, aplicando-se a distribuic?a?o normal (chamada de ?) a? uma func?a?o

densidade cumulativa (CDF), a varia?vel aleato?ria normal padra?o resulta em uma varia?vel aleato?ria

que e? uniforme no intervalo [0,1]. Sendo, Z uma distribuic?a?o normal padra?o, enta?o a CDF de

U = ?(Z) e?:

Pr(U ? u) = Pr(?(Z) ? u) = Pr(Z, = ?(?1)(u)) = u,

que e? uma CDF de U(0,1). Os histogramas das normais simuladas e seus valores transformados

demonstram este fato. Adotando-se a teoria de gerac?a?o univariada de nu?meros aleato?rios, e

aplicando-se a inversa da CDF de uma distribuic?a?o qualquer F a? uma varia?vel aleato?ria U(0,1),

tem-se como resultado uma varia?vel aleato?ria cuja a distribuic?a?o e? exatamente F . Isto e? conhecido

como me?todo da Inversa?o. Outro histograma ilustra a transformac?a?o para uma distribuic?a?o

lognormal, estes passos podem ser vistos na Figura 2.5.

Esta transformac?a?o tem dois passos que sa?o aplicados em cada uma das varia?veis bivariadas

normais, criando depende?ncia das varia?veis aleato?rias. Pode-se fazer a transformac?a?o em cada

componente separadamente, os dois resultados na?o necessitam ter a mesma distribuic?a?o marginal.

36



2.9 Distribuic?o?es Bivariadas Co?pulas Estat??sticas

Figura 2.5: Sequ?e?ncia para gerar uma distribuic?a?o lognormal por meio do me?todo da transformac?a?o
inversa

Tal transformac?a?o e? definida como:

Z = [Z1 Z2] ? N([0 0], [1 ?; ? 1]);

U = [?(Z1) ?(Z2)];

X = [G1(U1) G2(U2)].

Onde G1 e G2 sa?o as inversas da CDF de duas poss??veis diferentes distribuic?o?es. Por exemplo,

pode-se gerar vetores aleato?rios para distribuic?o?es bivariadas marginais com uma distribuic?a?o t e

outra Gamma.

A depende?ncia entre X1 e X2 e? uma construc?a?o determinada pelo para?metro de correlac?a?o (?),

da subjacente normal bivariada. Pore?m, na?o e? verdade que a correlac?a?o linear de X1 e X2 seja ?.

Por exemplo, na origem de um caso lognormal, a forma da correlac?a?o e?:

Corr(X1,X2) =
e(???

2) ? 1
e?

2 ? 1
.

Que e? estritamente menor que ?, a menos que ? seja exatamente um. Nos casos mais comuns,

embora semelhante a Gamma/t constru??da anteriormente, a correlac?a?o linear entre X1 e X2 e? dif??cil

ou imposs??vel de se expressar em termos de ?, mas simulac?o?es tambe?m podem ser utilizadas para

mostrar o mesmo efeito.

37



2.9 Distribuic?o?es Bivariadas Co?pulas Estat??sticas

Figura 2.6: Depende?ncia entre as varia?veis aleato?rias Gamma e t

Isso ocorre, pois o coeficiente de correlac?a?o linear expressa a depende?ncia das varia?veis

aleato?rias e quando transformac?o?es na?o lineares sa?o aplicadas a? estas varia?veis, a correlac?a?o

linear na?o e? preservada. Instantaneamente, um coeficiente graduado de correlac?a?o, semelhante ao

? de Kendall ou ao ??s de Spearman, sa?o os mais apropriados.

Assim, esses graus de correlac?a?o medem o grau em que os altos (ou baixos) valores de uma

varia?vel aleato?ria esta? associada com altos (ou baixos) valores de outra. Pore?m, ao contra?rio

do coeficiente linear de correlac?a?o, a medida e? associada somente em termos de graus. Como

consequ?e?ncia, o grau de correlac?a?o e? preservado. Em particular, o me?todo de transformac?a?o

descreve e preserva justamente o grau de correlac?a?o. Consequ?entemente, pode-se conhecer o grau

de correlac?a?o de uma distribuic?a?o normal bivariada Z, determinando o grau de correlac?a?o da

transformada final da varia?vel X.

38



2.9 Distribuic?o?es Bivariadas Co?pulas Estat??sticas

Enquanto que para ? e? preciso parametrizar a distribuic?a?o normal bivariada, os coeficientes de

Kendall e Spearman sa?o mais poderosos na descric?a?o de depende?ncias entre as varia?veis aleato?rias,

porque eles sa?o invariantes na escolha das distribuic?o?es marginais.

E? fa?cil criar um espec??fico grau de correlac?a?o entre X1 e X2, indiferentemente da distribuic?a?o

marginal. Isto e? feito pela escolha correta do valor do para?metro ? da correlac?a?o linear entre Z1 e Z2.

Na Figura 2.7, pode-se notar que para uma distribuic?a?o multivariada normal, o grau de

correlac?a?o de Spearman e? quase ide?ntico a? correlac?a?o linear, correspondente a? primeira bissetriz, ja?

Kendall apresenta o comportamento dos graus de correlac?a?o parabo?licos ao coefeciente linear de

correlac?a?o.

Figura 2.7: Comportamento dos graus dos coeficientes de correlac?a?o versus a correlac?a?o linear

O primeiro passo na construc?a?o descrita acima e? definir o conhecimento da co?pula. Uma

co?pula bivariada e? simplesmente uma distribuic?a?o de probabilidade de duas varia?veis aleato?rias,

cada uma com sua distribuic?a?o marginal uniforme. Estas duas varia?veis, podem ser completamente

39



2.10 Co?pulas Parame?tricas Co?pulas Estat??sticas

independentes, mas deterministicamente relacionadas (por exemplo, U2 = U1). A co?pula gaussiana

bivariada e parametrizada por ? =[1 ?; ? 1], sendo uma matriz de correlac?a?o linear. U1 e U2 sa?o

aproximac?o?es lineares, dependentes, quando as correlac?o?es possuem valores +/-1. Se o valor se

aproxima de zero, enta?o na?o existe depende?ncia de ?.

2.10 Co?pulas Parame?tricas

2.10.1 Co?pulas Archimedianas

A representac?a?o Archimediana permite reduzir o estudo de uma co?pula multivariada para uma

simples func?a?o univariada. Para simplificar, considere que uma co?pula bivariada tenha p=2.

Assume-se que uma func?a?o ? e? convexa, decrescente, com dom??nio (0, 1] e com alcance de [0, inf)

tal que ?(1) = 0. Sendo ??1 o inverso da func?a?o de ?. Tem-se a func?a?o:

C?(u,v) = ?
?1(?(u) + ?(v)) para v ? (0, 1]. (2.40)

Esta func?a?o e? chamada de co?pula Archimediana. A func?a?o ? e? chamada de gerador de co?pula

C?. Na Tabela 1, tem-se diversos geradores de diferentes fam??lias de co?pulas. Um tipo de gerador

determina uma co?pula Archimediana e esta representac?a?o ajuda sua identificac?a?o de forma.

40



2.10 Co?pulas Parame?tricas Co?pulas Estat??sticas

Tabela 1 - co?pulas Archimedianas e seus geradores

Fam??lia Gerador ?(t) Para?metro Co?pula Bivariada

de Depende?ncia (?) C?(u,v)

Independe?ncia -ln t Na?o aplica?vel uv

Clayton (1978),

Cook-Johnson (1981), t?? ? 1 ? &gt; 1 (u?? + v?? ? 1)?1/?

Oakes (1982)

Gumbel (1960), (-ln t)? ? ? 1 exp

{
?
[
(? ln u)? + (? ln v)?

]1/?}

Hougaard (1986)

Frank (1979) ln e
?t?1
e??1 ? inf &amp;lt;? &amp;lt;inf

1
?
ln
(

1 +
(e?u?1)(e?u?1)

e??1

)

Para a construc?a?o de uma co?pula, um me?todo sugerido por MARSHALL e OLKIN (1988), pode

ser descrito da seguinte forma: suponha-se que Xi e? uma func?a?o aleato?ria condicional, proveniente

de uma varia?vel positiva ?i a func?a?o de distribuic?a?o e? especificada por Hi(x|?i) = Hi(x)?i onde H(·)

e? a mesma base da func?a?o de distribuic?a?o, para i = 1, ...,p. MARSHALL e OLKIN consideram a

distribuic?a?o da func?a?o multivariada na forma:

F(x1,x2, ...,xp) = E[K(H1(x1)
?1, ...,Hp(xp)

?p )],

onde, K e? uma func?a?o de distribuic?a?o com marginais uniformes. MARSHALL e OLKIN ainda

mostraram que para um caso especial, todas as varia?veis sa?o iguais umas a?s outras, tendo ?1 = ?2 =

... = ?p = ?, assim:

41



2.10 Co?pulas Parame?tricas Co?pulas Estat??sticas

F(x1,x2, ...,xp) = E?(H1(x1)
?, ...,Hp(xp)

?), (2.41)

F(x1,x2, ...,xp) = ?(?
?1(F1(x1)) + ... + ?

?1(F1(x1))), (2.42)

onde Fi e? integrante da distribuic?a?o marginal de F e ?(·) e? a transformac?a?o Laplace de ?, definida

por ?(s) = E?e?s?.

A transformac?a?o de Laplace tem uma inversa bem definida. Pela equac?a?o anterior, nota-se

que a func?a?o inversa ??1 serve de gerador de co?pula Archimediana. Na Tabela 2 e? mostrada a

transformac?a?o inversa de Laplace para os geradores listados na Tabela 1. Assim, pode-se ver como

devem ser usadas distribuic?o?es conhecidas para gerar distribuic?o?es comuns. Esta transformac?a?o

inversa de Laplace representa, portanto, um importante tipo de gerador de co?pulas Archimedianas.

Tabela 2 - Geradores Archimedianos e suas inverso?es

Fam??lia Gerador ?(t) Gerador Inverso Distribuic?a?o Transformada

de Laplace (?(s) = ??1(s)) de Laplace

Independe?ncia -ln t exp(?s) Degenerativa

Clayton (1978),

Cook-Johnson (1981), t?? ? 1 (1 + s)?1/? Gama

Oakes (1982)

Gumbel (1960), (-ln t)? exp(?s?1/?) Positiva Esta?vel

Hougaard (1986)

Frank (1979) ln e
?t?1
e??1 ?

?1ln[1 + es(e? ? 1)] Se?rie Logar??tmicas

42



2.10 Co?pulas Parame?tricas Co?pulas Estat??sticas

Sintetizando, assumindo que X1,X2, ...,Xp sa?o condicionais, tem-se ?, independentemente da

func?a?o de distribuic?a?o Hi(x)?. Enta?o, a distribuic?a?o multivariada oriunda da co?pula e? obtida por

um gerador de uma transformac?a?o inversa de Laplace da varia?vel ?. Por causa da forma desta

distribuic?a?o, foi chamada de distribuic?a?o de mistura de poderes, onde tem-se:

?[?lnH1(x)] = E?exp(?(?lnH1(x))?) = Fi(x)

Logo:

Hi(x) = exp(???1(Fi(x))).

Isto providencia um caminho para especificac?a?o das func?o?es vindas das distribuic?o?es marginais.

2.10.2 Medidas Associativas

A distribuic?a?o na?o parame?trica ranqueada (tambe?m conhecida como uma distribuic?a?o livre) foi

proposta por SPEARMAN em 1904, como a medida direta entre duas varia?veis. Sendo Ri um valor

de xi entre outros de xi’s, Si um valor de yi entre outros de yi’s. O coeficiente de correlac?a?o, para

cada ranqueamento de dados e? definido pelo coeficiente de correlac?a?o linear ordenado, sendo:

rs =
?

i (Ri ? R)(Si ? S)??
i (Ri ? R)

2
??

i (Si ? S)
2

(2.43)

SCHWEIZER e WOLFF (1981) estabeleceram que as co?pulas consideram toda a depende?ncia

entre duas varia?veis aleato?rias e que a medida de correlac?a?o na?o parame?trica padra?o pode ser

expressa em termos de uma func?a?o de co?pula. O coeficiente de correlac?a?o de Spearman e? definido

por:

?(X,Y ) = 12E {(F1 (x1) ? 1/2) (F2 (y1) ? 1/2)}

? = 12
? ?

{C(u,v) ? uv}dudv (2.44)

43



2.10 Co?pulas Parame?tricas Co?pulas Estat??sticas

O coeficiente de correlac?a?o de Kendall ? para varia?veis aleato?rias cont??nuas pode ser definido

similarmente. Sendo (X1,Y1) e (X2,Y2) independentes e com vetores com distribuic?o?es aleato?rias

ide?nticas, enta?o para cada distribuic?a?o conjunta H, tem-se:

? = ?X,Y = Pr[(X1 ? X2)(Y1 ? Y2) &gt; 0] ? Pr[(X1 ? X2)(Y1 ? Y2) &amp;lt;0]

? = 4
? ?

(C(u,v)dC(u,v) ? 1.) (2.45)

Para estas expresso?es, deve-se assumir que X1 e X2 possuem uma func?a?o de distribuic?a?o

cont??nua conjunta. O coeficiente de correlac?a?o de Pearson, Cov(X1,X2)/(V arX1,V arX2)1/2

depende na?o somente da co?pula, mas tambe?m da distribuic?a?o marginal. Vale lembrar que esta

medida e? afetada pelas mudanc?as (na?o-lineares) de escala.

Na Tabela 3 ilustra-se o ca?lculo destas medidas de correlac?a?o. A correlac?a?o da co?pula de Frank,

tambe?m chamada de func?a?o de ”Debye”, sendo definida por:

Dk(x) =
k

xk

? x
0

tk

et ? 1
dt.

44



2.10 Co?pulas Parame?tricas Co?pulas Estat??sticas

Tabela 3 - co?pulas Archimedianas e suas Medidas de Depende?ncia

Fam??lia Co?pula Bivariada Kendall´s Spearman´s

C?(u,v) ? ?

Independe?ncia uv 0 0

Clayton (1978),

Cook-Johnson (1981), (u?? + v?? ? 1)?1/? ?
?+2

Fo?rmula

Oakes (1982) Complicada

Gumbel (1960), exp

{
?
[
(? ln u)? + (? ln v)?

]1/?} 1 ? ?1 Fo?rmula
Hougaard (1986) na?o resolvida

Frank (1979) 1
?
ln
(

1 +
(e?u?1)(e?u?1)

e??1

)
1 ? 4

?
(D1(??) ? 1) 1 ? 12? (D2(??)

?D1(??))

Para iniciar a construc?a?o de uma co?pula Archimediana, o objetivo do algoritmo e? gerar

X1,X2, ...,Xp de uma func?a?o de distribuic?a?o conhecida F(x1,x2, ...,xp) = C(F1(x1),F2(x2), ...,Fp(xp)),

onde a func?a?o da Co?pula e?:

C(u1,u2, ...,up) = ?
?1(?(u1) + ... + ?(up)).

Para esta construc?a?o, GENEST e RIVEST (1986) e GENEST (1987), introduziram a ide?ia da

simulac?a?o completa da distribuic?a?o de (X1,X2, ...,Xp) por meio de uma simulac?a?o condicional

recursiva de Xk vinda de X1,...,Xk?1, para k=2,...,p. Com esta ide?ia, subsequ?entemente LEE (1993)

desenvolveu que para simplificar, assume-se que a func?a?o de densidade probabilidade conjunta de

X1,X2, ...,Xp existe. Usando a co?pula para a construc?a?o da func?a?o de densidade probabilidade

conjunta de X1,X2, ...,Xk, tem-se:

45



2.10 Co?pulas Parame?tricas Co?pulas Estat??sticas

fk(x1, ...,xk) =
?k

?x1, ...,?xk
??1 {?[F1(x1)] + · · · + ?[Fk(xk)]} (2.46)

= ??1(k) {?[F1(x1)] + · · · + ?[Fk(xk)]} (2.47)

=
k?
j=1

?(1)[Fj(xj)]F
(1)
j (xj). (2.48)

Onde, a notac?a?o subscrita (j) significa que o j e? a derivada parcial. Condicionando a densidade

de X1,...,Xk?1, tem-se:

fk(xk|x1, ...,xk?1) =
fk(x1, ...,xk)

fk?1(x1, ...,xk?1)
(2.49)

= ?(1)[Fk(xk)]F
(1)(xk) (2.50)

=
??1(k?1) {?[F1(x1)] + · · · + ?[Fk(xk)]}

??1(k?1) {?[F1(x1)] + · · · + ?[Fk?1(xk?1)]}
. (2.51)

Logo, a func?a?o de distribuic?a?o condicional de Xk oriunda de X1,...,Xk?1 e?

Fk(xk|x1, ...,xk?1) =
? xk
??

fk(xk|x1, ...,xk?1) dx (2.52)

=
??1(k?1) {?[F1(x1)] + · · · + ?[Fk(xk)]}

??1(k?1) {?[F1(x1)] + · · · + ?[Fk?1(xk?1)]}
(2.53)

=
??1(k?1) {Ck?2 + ?[Fk(xk)]}

??1(k?1)(Ck?1)
. (2.54)

Onde Ck=?[F1(x1)] + · · · + ?[Fk?1(xk?1)]. Com esta func?a?o de distribuic?a?o, pode-se resolver a

func?a?o de distribuic?a?o inversa, sendo avaliada atra?ves de nu?meros aleato?rios uniformes, tal como,

F?1 = Xk. Sumarizando os algoritmos, tem-se:

46



2.10 Co?pulas Parame?tricas Co?pulas Estat??sticas

Algoritmo para Gerar co?pulas Archimedianas

1. Gerar valores aleato?rios U1, U2, ... ,Up uniformemente independentes com (0, 1).

2. Ajustar X1 = F
?1
1 (U1) e C0 = 0.

3. Para k = 2, ...,p calcular recursivamente Xk, por meio da soluc?a?o de:

Uk = Fk(Xk|x1, ...,xk?1) =
??1(k?1) {Ck?2 + ?[Fk(xk)]}

??1(k?1)(Ck?1)
.

Este algoritmo introduz implicitamente o contexto da co?pula de Frank para p=2. Podendo o

mesmo ser visto a seguir.

Algoritmo para Gerar co?pulas de Frank

1. Gerar valores aleato?rios U1, U2 uniformemente independentes com (0, 1).

2. Ajustar X1 = F
?1
1 (U1).

3. Calcular X2 com a seguinte soluc?a?o:

U2 = e
??U1

(
e?? ? e??F2(X2)

e??F2(X2) ? 1
+ 1

)?1
.

Com isto calcula-se X2 = F
?1
1 (U?2), onde:

U?2 =
U2e

?? ? e??U1 (1 ? U?2)
U2 + e??U1 (1 ? U?2)

.

Alguns exemplos de Co?pula de Frank, sa?o apresentados nas pro?ximas Figuras.

47



2.10 Co?pulas Parame?tricas Co?pulas Estat??sticas

Figura 2.8: Co?pula Frank´s para p = 2

Figura 2.9: Co?pula Frank´s para p = 4

Este algoritmo tambe?m pode ser usado para simular distribuic?o?es da fam??lia de Clayton. Pela

Tabela 2, tem-se ??1(1) = (1 + s)?1/?, onde:

??1(1)(s) = ???1(1 + s)?(1/?)?1.

Esta expressa?o com p=2, tem-se:

U2 =
???1

(
1 + F2(X2)?1/? ? 1 + U

?1/?
1 ? 1

)?(1/?)?1
???1

(
1 + U?1/?1 ? 1

)?(1/?)?1 .
Para o ca?lculo de X2 = F

?1
1 (U?2), tem-se:

U?2 = (1 + U
?1/?
1 (U

??/(?+1)
1 + 1))

??.

48



2.10 Co?pulas Parame?tricas Co?pulas Estat??sticas

Alguns exemplos, da co?pula de Glayton, podem ser observados nas pro?ximas Figuras.

Figura 2.10: Co?pula Clayton´s para p = 2

Figura 2.11: Co?pula Clayton´s para p = 4

Para a co?pula Gumbel-Hougaard, determinando o valor de X2, a equac?a?o necessita de uma

soluc?a?o interativa, e embora seja um me?todo direto, em muitas aplicac?o?es requer um grande nu?mero

de simulac?o?es. Um algoritmo alternativo foi introduzido por MARSHALL e OLKIN (1988) para a

construc?a?o da co?pula.

49



2.10 Co?pulas Parame?tricas Co?pulas Estat??sticas

Algoritmo para Gerar co?pulas Gumbel

1. Gerar um valor aleato?rio para varia?vel ?, tendo esta uma transformada laplaciana ?,

2. Gerar valores aleato?rios U1, U2, ... ,Up uniformemente independentes com (0, 1).

3. Para k = 1, ...,p calcular Xk = F
?1
1 (U?k), onde:

U?k = ?(???1lnUk).

Relembrando, a func?a?o marginal de distribuic?a?o pode ser calculada pela func?a?o de distribuic?a?o

Fk(x) = ?(?lnHk(x)), logo para co?pula de Gumbel, tem-se:

U?k = exp[?(???1lnUk)?1/?].

O resultado destas co?pulas podem ser observados nas Figuras.

Figura 2.12: Co?pula Gumbel para p = 2

50



2.11 Co?pulas Gaussianas Co?pulas Estat??sticas

Figura 2.13: Co?pula Gumbel para p = 4

2.11 Co?pulas Gaussianas

A co?pula gaussiana esta? associada a? uma distribuic?a?o normal multidimensional, a partir de agora

sera? definida como a seguinte func?a?o:

c(u1, ...,un; ?) = ?p(?
?1(u1), ..., ?

?1(un))

Teorema 7 (Teorema Co?pula Normal) A densidade da co?pula gaussiana e?

c(u1, ...,un; ?) =
1

|?|
1
2

exp
(
?

1
2
?T (??1 ? I)?

)
(2.55)

Onde ?i = ?1(ui) e I e? a matriz de dimensa?o ide?ntica (n x n).

Prova Utilizando-se a relac?a?o de junc?a?o das densidades multivariadas, tem-se a densidade da

co?pula:

f(x1, ...,xn) = c(F1(x1), ...,F(xn))
n?
i=1

fi(xi) (2.56)

Aplicando-se esta relac?a?o normal multivariada, tem-se:

1

(2?)
n
2 |?|

1
2

exp
(
?

1
2
xT??1x

)
= c((?(u1), ..., ?(un))

(
n?
i=1

1
?

2?
exp

(
?

1
2
x2i

))
(2.57)

Obtendo-se a seguinte deduc?a?o:

c(u1, ...,un) =

1

(2?)
n
2 |?|

1
2

exp
(
?1

2
?T??1?

)
1

(2?)
n
2

exp
(
?1

2
?T?

) (2.58)
51



2.11 Co?pulas Gaussianas Co?pulas Estat??sticas

Assim, para o caso bivariado, a expressa?o pode ser escrita:

c(u1,u2; ?) =
1?

1 ? ?2
exp

(
?
?21 + ?

2
2 ? ??1?2

2(1 ? ?2)
+
?21 + ?

2
2

2

)
(2.59)

Deduzindo:

C(u1,u2; ?) =
? u1

0

? u2
0

1?
1 ? ?2

exp
(
?
?21 + ?

2
2 ? ??1?2

2(1 ? ?2)
+
?21 + ?

2
2

2

)
dx1dx2 (2.60)

Sendo ?1 = ?
?1
(x1)

e ?2 = ?
?1
(x1)

. Se for utilizada a decomposic?a?o cano?nica para distribuic?a?o

bivariada, a expressa?o C e?:

C(u1,u2; ?) =
? ??1(u1)
??

? ??1(u2)
??

1

2?
?

1 ? ?2
exp

(
?
x21 + x

2
2 ? 2?x1x2

2(1 ? ?2)

)
dx1dx2 (2.61)

A equac?a?o seguinte, como forma simplificada, foi proposta por JOUANIN e sua deduc?a?o pode

ser vista em RONCALLI (2002):

C(u1,u2; ?) =
? u1

0
?

(
?

??1(u2) ? 2???1(u)?
(1 ? ?2)

)
du (2.62)

A co?pula escolhida para ser utilizada nesta tese foi a gaussiana, porque o objetivo na?o era

amarrar o modelo a uma espec??fica distribuic?a?o. Assim, as varia?veis podem ser transformadas por

meio de polino?mios de hermite ou ranqueadas para que assumam a forma gaussiana. O algoritmo

de co?pulas gaussinas e descrito a seguir:

Algoritmo para Gerar co?pulas gaussianas

1. Gerar um valor aleato?rio para varia?vel gaussiana;

2. Gerar valores aleato?rios N1, N2, ... ,Np normalmente independentes com (0, 1);

3. Impor correlac?a?o exp(?0.5 ? ?? ? ?inv ? ?/
?

1 ? ?2).

52



Cap??tulo 3

Parametrizac?a?o de Reservas

Neste cap??tulo e? apresentado o problema que deu origem a? geoestat??stica: o ca?lculo de reservas. E? discutida

toda a fundamentac?a?o teo?rica desenvolvida para o ca?lculo de recursos recupera?veis, apresentando os pontos

fortes e tambe?m os pontos fracos. Os conceitos de curvas de tonelagem e teores sa?o introduzidos, pois sa?o a

base da parametrizac?a?o de reservas minerais.

3.1 Geoestat??stica Mineira

A geoestat??stica surgiu como uma ferramenta de estudo do comportamento das varia?veis aleato?rias

no espac?o. Em trabalhos de H.S. SICHEL (1949 e 1952), D.G KRIGE (1951) e H.J. de WIJS (1952),

sobre uma mina de ouro, bastante estudada, na A?frica do Sul, as te?cnicas cla?ssicas de regressa?o eram

insuficientes para se estudar este jazimento. Assim, a geoestat??stica foi originalmente desenvolvida

com o objetivo de melhorar a acura?cia das estimativas locais de teores de blocos de mine?rio,

melhorando as regresso?es rudimentares que ate? enta?o eram utilizadas.

Nota-se, que, os desenvolvimentos teo?ricos feitos pelos sul-africanos, sa?o originados de

observac?o?es pra?ticas dessa mina de ouro. Basicamente, os trabalhos consistiam em fazer regresso?es

nos valores de teores de blocos de mine?rio. Eram pautados por aplicac?o?es de estat??stica, pois

ainda na?o utilizavam o variograma. G. MATHERON em 1962, ja? trabalhava com os mesmos tipos

de problemas em jazimentos de ura?nio e tambe?m com permeabilidade de depo?sitos petrol??feros.

53



3.1 Geoestat??stica Mineira Parametrizac?a?o de Reservas

tendo tido acesso a? dissertac?a?o de mestrado de D. KRIGE, MATHERON com sua base teo?rica

probabil??stica, estabeleceu a teoria da krigagem. Isto foi feito utilizando o conceito de func?o?es

aleato?rias, desenvolvida nos anos 30 pela escola francesa e sovie?tica (P. LE?VY, A. KOLMOGOROV,

A. KHINTCHINE), tambe?m utilizou os m??nimos quadrados, desenvolvidos nos anos 40 (H.

CRTAME?R, N. WIENER, S. BOCHENER). Esse resultado foi apresentado na publicac?a?o intitulada

de Teoria das Varia?veis Regionalizadas, onde esta? o desenvolvimento, com todo formalismo

matema?tico, de um novo me?todo de estimativa. Uma completa discussa?o do tema pode ser

encontrada em CHAUVET (1999), JOURNEL &amp;amp; HUIJBREGTS (1978), CHILES &amp;amp; DELFINER (1999).

A novidade em relac?a?o a? regressa?o dos m??nimos quadrados ponderados e? a modelagem anal??tica

de um modelo de variograma. Com o variograma, foram introduzidos os conceitos de estruturas

embricadas, efeito pepita e anisotropia, efeito de suporte e de informac?a?o, dentre outros.

A simulac?a?o estoca?stica geoestat??stica foi introduzida no in??cio dos anos 1970 para corrigir

(substituir) o efeito de suavizac?a?o da krigagem e assim gerar mapas que representassem o

comportamento da varia?ncia espacialmente, previstos por meio de um modelo de variograma

(MATHERON, 1973; JOURNEL, 1974). O primeiro algoritmo de simulac?a?o estoca?stica desenvolvido

foi o de Bandas Rotativas (Turning Band), originado de uma ide?ia sugerida em 1960 por

MATHERON. Os algoritmos de simulac?a?o sequ?encial sa?o atualmente a esse?ncia da geoestat??stica

teo?rica e pra?tica (JOURNEL, 1983; ISAAKS, 19990; SRIVASTAVA, 1992; GOOVAERTS, 1997;

CHILES &amp;amp; DELFINER, 1999). A simulac?a?o estoca?stica e? derivada da distribuic?a?o condicional

de probabilidade, sendo que os valores sa?o simulados, via amostragem de Monte Carlo.

As simulac?o?es sa?o geradas por meio de func?o?es aleato?rias, condicionadas a?s leis espaciais

multigaussianas. Isto significa que todas as combinac?o?es lineares seguem uma distribuic?a?o

gaussiana. Muitos destes algoritmos surgiram por meio de simulac?o?es na?o-condicionais e o

54



3.1 Geoestat??stica Mineira Parametrizac?a?o de Reservas

problema do condicionamento dos dados foi resolvido pela krigagem e pela varia?ncia de krigagem.

Previamente, a varia?vel regionalizada deve ser transformada em uma varia?vel gaussiana. Tal

transformac?a?o e? conhecida como anamorfose gaussiana (MATHERON, 1974, JOURNEL and

HUIJBREGTS, 1978, REMACRE, 1984 e RIVOIRARD, 1994) ou simplesmente transformac?a?o

gaussiana.

As distribuic?o?es multigaussianas sa?o extremamentes co?modas ao ser utilizadas, pois de-

pendem apenas dos momentos de 1a e 2a ordem ( Esperanc?a Condional e Covaria?ncia) para ser

representadas, o que facilita a infere?ncia estat??stica. Pore?m, isto acarreta va?rias restric?o?es:

• Dificuldade de se conseguir a anamorfose gaussiana, quando o histograma da varia?vel

regionalizada e? fortemente dissime?trico ou apresenta uma proporc?a?o importante de valores

extremos (MATHERON, 1980, RIVOIRARD, 1994, EMERY, 2002);

• Simetria das distribuic?o?es de probabilidades em relac?a?o ao valor mediano: caracter??sticas

estruturais de valores elevados (anisotropia, continuidade, ...) ocorrendo tambe?m com valores

baixos;

• Propriedade de desestruturac?a?o de valores extremos (MATHERON, 1989, GOOVAERTS,

1997): A ocorre?ncia de valores extremos causa incerteza, prevenindo que valores altos ou

baixos sejam conectados espacialmente.

Estas caracter??sticas motivam a pesquisa de algoritmos de simulac?a?o estoca?stica na?o-gaussiana.

Pore?m, existem alguns problemas quando se deseja simular distribuic?o?es que na?o sa?o gaussianas,

dentre eles, pode-se citar: a especificac?a?o para uma coerente lei espacial que pode ser modelada

matematicamente; infere?ncia dos para?metros do modelo por meio de dados experimentais;

construc?o?es de realizac?o?es para este modelo e condicionamento da simulac?a?o aos dados.

Todos estes esforc?os, de me?todos de estimativas de simulac?a?o estoca?stica, buscam o mesmo

55



3.2 Reservas Minerais Parametrizac?a?o de Reservas

objetivo, que e? saber se as expectativas sobre um determinado empreendimento sera?o atendidas, ou

seja, se existe uma reserva.

3.2 Reservas Minerais

Segundo JOURNEL e HUIJBREGTS (1978), “os recursos in situ sa?o determinados pelo ambiente geolo?gico

do depo?sito. As reservas dependem, na?o somente, dos recursos in situ e de suas caracter??sticas peculiares, mas

tambe?m do contexto te?cnico e econo?mico da regia?o onde o projeto mineral esta? inserido´´. Para a minerac?a?o,

o ca?lculo da reserva constitui-se um important??ssimo para?metro, no que concerne a? tomada de

decisa?o de se lavrar ou na?o o mine?rio, sendo fator decisivo no sucesso do empreendimento.

Define-se reserva, como a porc?a?o da reserva mineral a qual os teores de metal (Z(xi)) dos blocos

xi foram estimados (Z?(xi)) com valores acima de um determinado teor de corte z. No ca?lculo

da reserva, a escolha de cada bloco e? realizada dentro de um limite de cava preestabelecido. A

definic?a?o do teor de corte e? feita dentro do contexto te?cnico e econo?mico, no qual o projeto de

minerac?a?o esta? inserido. Tal teor de corte refere-se ao teor m??nimo de metal necessa?rio capaz de

pagar os custos envolvidos na lavra, no tratamento e transporte de um volume unita?rio da reserva

mineral, para extrac?a?o de um metal ou o intervalo de teor de mine?rio que pode ser comercializado.

As Func?o?es de Recuperac?a?o (gra?ficos do tipo Tonelagem x Teor) sa?o de suma importa?ncia para

a minerac?a?o, pois as informac?o?es de ordem financeira (lucro pela venda da tonelagem de material

lavrado) por elas fornecida, envolve desde a fase de tomada de decisa?o pela implantac?a?o, ate? o

controle de teor no dia-a-dia de uma mina. Elas fornecem dados importantes para o planejamento

de estrate?gias gerenciais e operacionais, que permitem maximizar o benef??cio do empreendimento

mineiro. Os erros ocasionados por esta tomada de decisa?o podem ser vistos na Figura 3.1. Ela

apresenta o gra?fico da dispersa?o Z(vi)×Z?(vi) obtido pela validac?a?o cruzada dos teores verdadeiros

56



3.2 Reservas Minerais Parametrizac?a?o de Reservas

Z(vi) e os teores estimados Z?(vi) . Dado um teor de corte z o gra?fico pode ser dividido em quatro

a?reas, apresentando as seguintes informac?o?es:

Figura 3.1: Dispersa?o entre teor estimado e teor verdadeiro, mostrando os erros cometidos na
estimativa quando se aplica um teor de corte.

• Blocos de mine?rio classificados como este?ril: todos os blocos sera?o destinados ao depo?sito de

este?ril, pois Z?(vi) &amp;lt;z. Mas, de fato tem-se Z(vi) ? z.

• Blocos de mine?rio corretamente classificados: os dois crite?rios de selec?a?o sa?o satisfeitos, ou

seja, Z(vi) ? z e Z?(vi) ? z. Enta?o, todos os blocos desta a?rea sera?o selecionados para compor

a reserva recupera?vel.

• Blocos de este?ril corretamente classificados: os dois crite?rios de selec?a?o na?o foram satisfeitos,

pois tem-se que Z(vi) &amp;lt;z e Z?(vi) &amp;lt;z. Portanto, todos os blocos na?o sera?o selecionados, pois

sa?o considerados este?ril, e realmente o sa?o, dado um teor de corte.

• Blocos de este?ril classificados como mine?rio: todos os blocos sera?o selecionados, pois Z?(vi) ?

57



3.2 Reservas Minerais Parametrizac?a?o de Reservas

z. Pore?m Z(vi) &amp;lt;z, o que significa que os blocos estimados como mine?rio sa?o blocos de fato

este?ril.

Basicamente, o ca?lculo da reserva recupera?vel constitui o problema de estabelecer relac?o?es entre

tonelagem e teor, aos quais podem ser representadas sob diversos tipos de curvas (func?o?es), sendo

poss??vel responder, rapidamente, importantes questo?es relevantes a? implantac?a?o de projetos de

minerac?a?o e tambe?m para o planejamento de lavra, tais como:

• Qual a tonelagem de mine?rio da reserva mineral cujos blocos possuem teores com valores

maiores que o teor de corte? Para o dimensionamento de todos os equipamentos de

minerac?a?o, tanto os da lavra como os da usina de tratamento, e? necessa?rio a determinac?a?o da

quantidade de mine?rio que sera? movimentada na mina e processada na usina de tratamento.

Determinando-se assim, o tempo de vida u?til da mina ate? a sua exausta?o econo?mica.

• Qual a quantidade de metal contida na porc?a?o da reserva, cujos blocos possuem teores com

valores maiores que o teor de corte? Ao se selecionar os blocos que sera?o inclu??dos em um

planejamento de lavra a curto prazo, e? importante saber se a quantidade de metal contida

nesses blocos sera? suficiente para suprir a demanda prevista do bem mineral.

• Qual o teor me?dio dos blocos com teores maiores que teor de corte? Sa?o preocupantes as perdas

econo?micas provocadas pela flutuac?a?o do teor meta?lico do mine?rio com o qual a usina de

tratamento e? alimentada. Por um lado, pela produc?a?o de material de baixa qualidade, por

outro, pela perda de metal na?o recuperado. Enta?o, e? noto?ria a importa?ncia econo?mica da

incerteza do teor me?dio a? adequac?a?o da flutuac?a?o do teor de alimentac?a?o (especificac?a?o da

usina). E, ainda, o teor me?dio esta? associado a quanto da jazida podera? ser lavrada, ja? que

mine?rio de alto teor pode ser blendado com mine?rio marginal, aumentando a quantidade de

metal extra??do.

• E a questa?o mais importante: Qual o benef??cio (lucro financeiro) da lavra e tratamento do

mine?rio dos blocos que possuem teores de metal com valores maiores que teor de corte?

58



3.3 Reservas Estimadas Parametrizac?a?o de Reservas

Qualquer empreendimento mineiro e? concebido sobre alguns crite?rios de execuc?a?o, dentre eles

destacam-se os seguintes: atender o suprimento do mercado com o bem mineral (metal) e/ou

maximizar o benef??cio econo?mico do empreendimento. Para satisfazer o primeiro crite?rio, se

faz necessa?ria a parametrizac?a?o de reservas de maneira a se ter conhecimento da quantidade

de metal que podera? ser lavrado e disponibilizado ao mercado. O segundo crite?rio, e talvez

o mais importante, e? a maximizac?a?o do benef??cio econo?mico. No planejamento da lavra, a

longo prazo, deve-se considerar quais blocos sera?o lavrados em cada per??odo de operac?a?o

da mina, de modo a satisfazer os objetivos de produc?a?o. As func?o?es de recuperac?a?o sa?o de

grande utilidade para o planejamento de estrate?gias gerenciais e operacionais que da?o maior

garantia da maximizac?a?o do benef??cio econo?mico.

3.3 Reservas Estimadas

As Func?o?es de Recuperac?a?o podem ser obtidas usando func?o?es de densidade de probabilidade

(FDP) ajustadas aos histogramas experimentais aos dados (me?todo cont??nuo), ou ainda, traba-

lhando diretamente sobre os dados estimados (me?todo discreto).

Os conceitos de efeito suporte e informac?a?o refere-se ao volume sobre o qual e? definido

um para?metro do recurso mineral, como por exemplo, o teor. O suporte pode apresentar

qualquer geometria e a informac?a?o representa os dados existentes ate? o momento. De acordo com

MATHERON (1984), os dois princ??pios da geoestat??stica usados na mudanc?a de suporte sa?o:

• A me?dia permanece constante;

• As curvas de parametrizac?a?o se degradam quando o suporte aumenta (ver Figura 3.2).

Uma reserva mineral dividida em paine?is V (blocos grandes) e subdividida em blocos menores

v (Unidade Seletiva de Mina), definem-se os teores de blocos Z(v) e sobre os dois suportes V e v.

Tem-se E [Z(vi)] = E [Z(Vi)] e var [Z(vi)] &gt; var [Z(Vi)]. Logo, existem duas populac?o?es de teores

distintas entre si, que produzem histogramas diferentes. Esta diferenc?a nos histogramas entre os

59



3.3 Reservas Estimadas Parametrizac?a?o de Reservas

dois suportes, e? chamada de efeito suporte, isto pode ser visto na Figura 3.2, utilizando o exemplo de

Walker Lake1.

Figura 3.2: Curva Quantidade de Metal de Walker Lake em diversos suportes.

Sendo z o teor de corte, para o estabelecimento das func?o?es de recuperac?a?o, a selec?a?o de

blocos se da? pelo teor estimado do bloco Z?(vi) ? z e na?o sobre seu teor verdadeiro Z(vi) ? z,

por ser desconhecido. Como todo processo de estimativa e? pass??vel de erro, e? comum encontrar

Z?(vi) 6= Z(vi). Esta diferenc?a provoca uma degradac?a?o das func?o?es de recuperac?a?o. Este efeito,

devido ao desconhecimento do teor verdadeiro Z(vi), e? chamado de efeito informac?a?o.

Sempre que ocorre Z?(vi) 6= Z(vi), leva-se ao vie?s Z?(vi) 6= Z(vi), que e? a diferenc?a me?dia

entre os valores verdadeiros e os estimados sobre todos os blocos. Na?o basta que E[Zv ? Z?v ] = 0,

pois podem ocorrer casos em que esta esperanc?a e? nula, mas a correlac?a?o entre Z(vi) e Z?(vi) e?

inexistente ou muito fraca. Existem va?rios fatores que levam a? ocorre?ncia deste vie?s, tais como

amostragem na?o representativa do depo?sito, erros cometidos nas ana?lises qu??micas, mineralo?gicas

e granulome?tricas das amostras, ale?m de erros cometidos no processo de estimativa.

Sejam as varia?veis aleato?rias Z e Y . De acordo com REMACRE (1997), conceitua-se esperanc?a

condicional de Z dado que Y = y (simbolizada por E [Z|Y &gt; y]) da seguinte forma, para o caso
1Banco de dados dispon??vel para pesquisa. Ver ape?ndice A

60



3.3 Reservas Estimadas Parametrizac?a?o de Reservas

cont??nuo:

E [Z|Y &gt; y] =
?
z · f(z|y)dz (3.1)

Aplicando-se o conceito de esperanc?a condicional na ana?lise do efeito de informac?a?o, segundo

RIVOIRARD (1987), constata-se a ocorre?ncia do vie?s condicional E[Z(vi) ? Z?(vi)|Z?(vi)] quando

se toma um valor Z?(vi) = z.

Na verdade, tem-se uma diferenc?a no teor me?dio E[Z?(vi)|Z?(vi) = z]. Neste caso, os blocos

com teor me?dio acima do teor de corte apresentam como a E[Z(vi)|Z?(vi) ? z], que e? diferente do

teor me?dio estimado. Assim, o vie?s condicional E[Z(vi) ? Z?(vi)|Z?(vi)] e? responsa?vel por um vie?s

no teor selecionado, dado por E[Z(vi) ? Z?(vi)|Z?(vi) ? z] que e? a me?dia do vie?s condicionado

para os blocos selecionados.

Em geral, Z(vi) na?o e? conhecido. Dessa forma, a selec?a?o de blocos e? feita por meio dos seus

valores estimados Z?(vi), o que podera? conduzir a? escolha de blocos de teores reais baixos que

foram estimados com o de teores altos e ao abandono de blocos de teores reais altos que foram

estimados com o de teores baixos.

Como citado anteriormente, ocorre que Z?(vi) 6= Z(vi), o que implica no vie?s E[Z(vi) ? Z?(vi)],

que e? a diferenc?a me?dia entre os valores verdadeiros e os estimados sobre todos os blocos, sem que

tenha havido, ainda, qualquer selec?a?o.

Na?o basta que E[Z(vi) ? Z?(vi)] = 0. Existem casos em que esta esperanc?a e? nula, mas na?o

existe correlac?a?o entre Z(vi) e Z?(vi), caso no qual a func?a?o Z(vi) × Z?(vi) e? sime?trica em relac?a?o a?

primeira bissetriz, mas os pontos sa?o dispersos.

Supondo que a regressa?o E[Z(vi)|Z?(vi)] seja linear, isto e?, que Z(vi) e Z?(vi) tenham func?o?es

61



3.3 Reservas Estimadas Parametrizac?a?o de Reservas

de densidade de probabilidade, como e? ilustrada pela Figura 3.3, tem-se que:

E[Z(vi) ? Z?(vi)|Z?(vi) ? zc] ? m
?

=
?[Z?(vi) ? m]

??
.

Na qual:

m = E[Z(vi)] = E[Z
?(vi)], (3.2)

?2 = V ar[Z(vi)], (3.3)

?? 2 = V ar[Z?(vi)], (3.4)

? = [Z(vi),Z
?(vi)]. (3.5)

Logo:

E[Z(vi)|Z?(vi)] ? m = p[Z?(vi) ? m],

onde p e? a inclinac?a?o da regressa?o, e e? dada por:

p = ?
?

??
=

cov[Z(vi),Z?(vi)]
var[Z?(vi)]

.

6

?
?

?
?

?
?

?
?

?
?

?
?

-?
?

?
?

?
?

?
?

?
?

?
?
































p &gt; 1

p = 1
1a Bissetriz

Z(vi)

Z?(vi)

p &amp;lt;1

Figura 3.3: Representac?a?o da regressa?o entre o estimado e o real para uma varia?vel com distribuic?a?o
normal

Quando ha? um na?o-vie?s condicional, a regressa?o tem inclinac?a?o igual a 1 (primeira bissetriz).

Enta?o, um valor de p diferente de 1, implica em um vie?s condicional. Se p &amp;lt;1, o teor recuperado sera?

62



3.3 Reservas Estimadas Parametrizac?a?o de Reservas

menor que o estimado. O estimador Z?(vi) sobrestima o teor selecionado. ?? 2 &gt; ?2 ? p = ? ??? &amp;lt;1.

Se p &amp;lt;1, o teor recuperado sera? maior que o estimado. Ocorre uma subestimativa, e isto pode levar

a decisa?o de na?o implementar, ou postergar o projeto, alegando que o mesmo e? economicamente

invia?vel no momento.

Em geral, Z(vi) na?o e? conhecido, assim, se a selec?a?o dos blocos for feita por meio de seus valores

estimados Z?(vi) que podera? conduzir a:

1. escolha de blocos pobres que foram estimados como sendo ricos;

2. abandono de blocos ricos que foram estimados como blocos pobres.

Estes erros correspondem a? dispersa?o vertical dos pontos do gra?fico da figura 3.1, ao redor da

1a bissetriz : V ar[Z(vi) ? Z?(vi)|Z?(vi)]. A diferenc?a Z(vi) 6= Z?(vi), provoca uma degradac?a?o das

func?o?es de recuperac?a?o. Como dito anteriormente, este efeito, devido ao desconhecimento do teor

verdadeiro Z(vi) e? chamado de efeito informac?a?o. Tem-se que:

Z(vi) ? Z?(vi) = {Z(vi) ? E[Z(vi)|Z?(vi)]} + {E[Z?(vi)|Z?(vi)] ? Z?(vi)}.

O segundo termo do segundo membro da expressa?o acima E[Z?(vi)|Z?(vi)] ? Z?(vi) depende

apenas de Z?(vi), por isto na?o e? correlacionada com o primeiro termo. Portanto, a varia?ncia do erro

de estimativa e? dado por:

V ar[Z(vi) ? Z?(vi)] = V ar{Z(vi) ? E[Z(vi)|Z?(vi)]} + V ar{E[Z?(vi)|Z?(vi)] ? Z?(vi)}.

Em que o segundo termo, do segundo membro, corresponde ao vie?s condicional, enquanto

o primeiro corresponde a? dispersa?o vertical do diagrama Z(vi) × Z?(vi) ao redor da regressa?o.

[Z(vi)|Z?(vi)]

A varia?ncia de estimativa e? o compromisso de minimizar a diferenc?a entre o teor recuperado e

o estimado, com o intuito de minimizar o erro global de estimativa. Em geocie?ncias e? comum

a varia?vel apresentar uma distribuic?a?o lognormal. Para este tipo de distribuic?a?o, tem-se que a

regressa?o E[Z(vi)|Z?(vi)], pode ser representada pela Figura 3.4.

63



3.3 Reservas Estimadas Parametrizac?a?o de Reservas

6

?
?

?
?

?
?

?
?

?
?

?
?

-

p &gt; 0 e ? ?
??
&gt; 1

p = 1
1a Bissetriz

Z(vi)

Z?(vi)

p &gt; 0 e ? ?
??
&amp;lt;1

p &amp;lt;0

Figura 3.4: Representac?a?o da regressa?o entre o estimado e o real para uma varia?vel com distribuic?a?o
lognormal.

A noc?a?o de varia?ncia de dispersa?o, que esta? sendo introduzida e? bastante singular na

geoestat??stica. Primeiramente, por razo?es histo?ricas, pois para a estat??stica cla?ssica, na?o existe a

varia?ncia de dispersa?o. Mas em termos pra?ticos, o seu ca?lculo pode ser deduzido como:

?2(v|V ) = E[S2(v|V )] = E

[
1
n

n?
i=1

(Zi ? Z)2
]

Uma soluc?a?o para estas correc?o?es e? a aplicac?a?o de te?cnicas na?o-lineares. Para qualquer me?todo

de estimativa linear (krigagem, Inverso do Quadrado da Dista?ncia, etc) usa-se a combinac?a?o dos

dados: z? =
?
?
??z?. Na estimativa na?o-linear, por exemplo, pode-se escolher a soma de n func?o?es

de cada dado avaliado: z? =
?
?
f?(z?). Ou melhor, considerar uma u?nica func?a?o de n dados:

z? = f(z1, ...,zn).

Mas existe uma grande dificuldade devido ao alto grau de complexidade no ajuste desta

func?a?o e ainda a existe?ncia de va?rios pre?-requisitos para praticar estes me?todos de estimativa. A

grande vantagem destes me?todos e? que, diferentemente dos me?todos lineares, estes reproduzem

a variabilidade espacial dos teores verdadeiros. Consequentemente, e? poss??vel derivar suas

proporc?o?es aplicando teores de corte.

64



3.4 Geoestat??stica Na?o-Linear Parametrizac?a?o de Reservas

Os me?todos na?o-lineares, apresentam a correc?a?o dos blocos e amostras, e a isto foi chamado de

relac?a?o de Cartier. Considere-se que um ponto aleato?rio x em um bloco v. A esperanc?a condicional

de Z(x)condicionada ao valor do bloco v e? igual ao momento de Z de seu Bloco:

E[Z(x)|Z(v)] = Z(v),

Por uma Anarmofose Gaussiana,

Z(x) = ?(Y (x)) =
??

k=0

?k
k!
Hk(Y (x)),

Onde Hk(Y (x)) sa?o polino?mios de Hermite, de uma anamorfose ?v(Y (v)) dos blocos

correspondentes, a relac?a?o pode ser re-escrita:

E(?(Y (x))|Z(v)) = E(?(Y (x))|?v(Y (v))) = ?v(Y (v))

A anamorfose gaussiana dos blocos pode ser expressa pelos coeficientes ?k (ajustados aos dados)

da anamorfose pontual e? introduzido um coeficiente positivo r de correlac?a?o ponto-bloco:

?v(Y (v)) = E(?(Y (x))|Z(v)) =
??

k=0

?k
k!
E(Hk(Y (v))|?v(Y (v))) =

??
k=0

?k
k!
rkHk(Y (v)),

A correc?a?o ponto bloco e? determinada a partir da varia?ncia de dispersa?o dos blocos,

var(Z(v)) = var(?v(Y (v))) =
??

k=0

?2k
k!
r2k,

3.4 Geoestat??stica Na?o-Linear

A geoestat??stica linear foi desenvolvida para resolver combinac?o?es lineares de uma varia?vel de

estudo Z(x) e tambe?m providenciar a varia?ncia de estimativa. Mas quando e? necessa?rio calcular

uma estimativa da variabilidade de Y (x) por meio de uma ou mais func?o?es f[Y (x)], os me?todos

na?o-lineares sa?o os mais indicados. Um engenheiro de minas estara? buscando predizer quais blocos

elementares possuem teores me?dios acima do teor de corte econo?mico e a quantidade de metal que

estes blocos conte?m. Segundo CHILE?S e DELFINER (1999, pg.375), quando existe um corte em

65



3.4 Geoestat??stica Na?o-Linear Parametrizac?a?o de Reservas

uma varia?vel, o problema ba?sico e? a determinac?a?o da distribuic?a?o acumulativa F(z) = Pr Z(x) &amp;lt;z.

Portanto, e? necessa?rio especificar o aspecto espacial que distingue este problema da estimativa

padra?o em relac?a?o a? distribuic?a?o.

A elaborac?a?o de um modelo e? a etapa primordial para resolver um problema pra?tico. Os

me?todos na?o-lineares na?o sa?o melhores que a krigagem linear para estimar os teores de um bloco,

mas sa?o essenciais para resolver problemas de reservas. Segundo REMACRE (1984) via de regra, um

modelo responde a um certo nu?mero de hipo?teses . A validac?a?o dessas hipo?teses e? que garantem

a validac?a?o do modelo e somente com a adaptac?a?o do modelo a? realidade, obtem-se me?todos de

estimativas eficazes. Para se ajustar este modelo e? necessa?rio o conhecimento de quatro fatores

importantes:

1. Dom??nio A distribuic?a?o na?o e? necessariamente estimada em apenas uma unidade seletiva de

lavra, mas em um dom??nio (um painel, uma bancada ou uma sequ?e?ncia de lavra). Talvez este

dom??nio de interesse D, possa ser usado utilizando-se todos os dados dispon??veis (estimativa

global). Ou talvez, possa ser localmente distribu??do baseado somente nos valores dentro de

uma vizinhanc?a (estimativa local). Uma t??pica aplicac?a?o, e? a determinac?a?o da distribuic?a?o de

teores de pequenos blocos em um painel de lavra. Se o espac?o entre as amostras e? grande

comparado com as dimenso?es do bloco, a previsibilidade dos blocos e? pobre. O mais razoa?vel

seria predizer o nu?mero de blocos que esta? acima de teor de corte.

2. Mudanc?a de Suporte Embora as medidas usadas na estimativa sejam obtidas por meio de

um suporte amostral pontual (amostras regularizadas), frequentemente o interesse esta? em

estimar grandes suportes. Um depo?sito mineral na?o pode ser minerado em pequenos

volumes. Portanto, a unidade seletiva deve ter um suporte adequado com o porte e a

seletividade dos equipamentos.

3. Efeito Informac?a?o Na seletividade da mina, as selec?o?es dos blocos sa?o baseados em estimativas

Z? na qual o resultado econo?mico e? comparado com a selec?a?o feita em teores verdadeiros.

66



3.4 Geoestat??stica Na?o-Linear Parametrizac?a?o de Reservas

Esta avaliac?a?o requer o modelamento da func?a?o de distribuic?a?o conjunta Z e Z?, ou seja, os

dados obtidos pela lavra e a estimativa.

4. Efeito Correlac?a?o As varia?veis da geocie?ncias geralmente esta?o correlacionadas, sendo

importante definir se um bloco esta? acima de um teor de corte na?o apenas por uma varia?vel,

mas pelo conjunto, de forma que se maximize o valor agregado da unidade seletiva.

3.4.1 Func?a?o tonelagem

Sendo f(z) a func?a?o densidade de probabilidade dos teores Z(v) e F(z), sua acumulada crescente

(fdpa), definida por:

F(z) = P(Z(v) ? z) =
z?

??

f(z)dz.

A func?a?o tonelagem T(z), tambe?m chamada de tonelagem de mine?rio ou curva de proporc?a?o,

por definic?a?o e? a probabilidade do teor Z(v) ser maior que um dado teor de corte z, ou seja, o

complemento de F(z).

T(z) = P(Z(v) &gt; z) =

??
z

f(z)dz.

Logo, tem-se 0 ? T(z) ? 1. Podendo-se tambe?m escrever:

P(Z(v) ? z) + P(Z(v) &gt; z) = 1,

e

F(z) + T(z) = 1.

Portanto:

T(z) = 1 ? F(z).

Pode-se ver que T(z) e? a proporc?a?o do nu?mero de blocos que possui teor de metal maior que o

teor de corte. Sendo uma func?a?o de densidade acumulada na?o-crescente, definida no intervalo [0,1].

A Figura 3.5 mostra, para uma func?a?o lognormal, com me?dia igual a 1 e diversos desvios padro?es,

suas respectivas curvas de Tonelagem.

67



3.4 Geoestat??stica Na?o-Linear Parametrizac?a?o de Reservas

Figura 3.5: Curva tonelagem x teor de corte de uma func?a?o lognormal, para diversos desvios
padro?es

3.4.2 Func?a?o Metal Contido

A func?a?o metal contido Q(z), tambe?m chamada de quantidade de metal, refere-se a? proporc?a?o de

metal contido nos blocos selecionados que possuem teores de metal acima do valor de corte z. Ou

seja, Q(z) e? a proporc?a?o de metal da reserva mineral contido nos blocos selecionados pelo crite?rio

Z(vi) &gt; z. Logo, pela definic?a?o, a func?a?o metal contido e? definida, em proporc?a?o, pela integral:

Q(z) =

??
z

z · f(z)dz.

E? importante observar que para z = 0, tem-se, Q(0) que corresponde ao teor me?dio (m) do

depo?sito mineral inteiro.

68



3.4 Geoestat??stica Na?o-Linear Parametrizac?a?o de Reservas

Q(0) =

??
0

z · f(z)dz = E [Z] = m

A E [Z] refere-se a esperanc?a matema?tica dos teores Z(v). Neste caso, Q(0) e? definida pela

expressa?o de centro de massa.

Figura 3.6: Curva metal contido x teor de corte da func?a?o lognormal para diversos desvios padro?es

3.4.3 Func?a?o Metal x Tonelagem

O metal contido em func?a?o da tonelagem [Q(T)] fornece o metal contido Q(z), em uma porc?a?o da

reserva T(z), a qual seus blocos possuem teores Z(vi) maiores que o teor de corte z. Tal func?a?o e?

de vital importa?ncia para o estudo da seletividade. Q(T) representa a concentrac?a?o de metal (de

riqueza) de um depo?sito mineral. Isto e?, uma pequena quantidade de blocos do depo?sito pode

conter uma grande proporc?a?o de metal contido em todo o depo?sito. A func?a?o Q(T) e? definida pela

expressa?o:

Q(T) =

+??
0

min (T,T(u)) du

A func?a?o e? sempre crescente e co?ncava. A representac?a?o gra?fica desta func?a?o e? de grande

importa?ncia para o estudo da seletividade, pois, a a?rea delimitada pela func?a?o Q(T) e a primeira

bissetriz, e? igual a metade do ??ndice de seletividade S. Sendo o mesmo uma medida de dispersa?o

69



3.4 Geoestat??stica Na?o-Linear Parametrizac?a?o de Reservas

da varia?vel aleato?ria Z, semelhante a varia?ncia ?.

O ??ndice de seletividade e? dado por S = ?
2m

, onde ?, para o caso teo?rico:

? =
? ?
??

? ?
??

|x ? y|f(x)f(y)dxdy.

Para o caso experimental:

? =
2

n(n ? 1)

n?
i=1

n?
j=i+1

|xi ? xj|.

Onde n e m sa?o o nu?mero de dados e o teor me?dio, respectivamente.

Figura 3.7: Curva metal contido versus tonelagem da func?a?o lognormal, para diversos desvios
padro?es

70



3.4 Geoestat??stica Na?o-Linear Parametrizac?a?o de Reservas

3.4.4 Func?a?o Teor Me?dio

A func?a?o Teor Me?dio m(z) corresponde ao teor me?dio dos blocos selecionados (daqueles com teor

Z(vi) &gt; z), os quais va?o compor a reserva recupera?vel. m(z) e? calculado pela relac?a?o:

m(z) =
Q(z)
T(z)

m(z) e? uma func?a?o crescente, pois a? medida em que o teor de corte (z) aumenta, os blocos mais

pobres sera?o abandonados. Assim, apenas os blocos mais ricos sera?o selecionados, fazendo com

que o teor me?dio dos blocos selecionados [m(z)] cresc?a cada vez que se aumenta z.

Figura 3.8: Curva Teor Me?dio x teor de corte da func?a?o lognormal para diversos desvios padro?es

71



3.4 Geoestat??stica Na?o-Linear Parametrizac?a?o de Reservas

3.4.5 Esperanc?a Condicional

Sendo Z(x) uma varia?vel aleato?ria e deseja-se estimar a probabilidade desta varia?vel ser maior que

um corte s. Uma medida teo?rica do valor x0, de N pontos amostrais x? : ? = 1, ...,N de uma func?a?o

F(z,z1, ...,zN) e? definida por:

F(z,z1, ...,zN) = Pr Z(x0) &amp;lt;z,Z(x1) &amp;lt;z1, ...,Z(xN) &amp;lt;zN.

Para esta distribuic?a?o, pode-se deduzir que:

• As marginais F0(z) = Pr Z(x0) &amp;lt;z,F1(z) = Pr Z(x1) &amp;lt;z,...,FN(z) = Pr Z(xN) &amp;lt;z;

• A distribuic?a?o condicional F0(z|z1, ...,zN) de Z(x0) quando Z(x?) sa?o os valores de z?.

O estimador o?timo de I(z) no ponto x0, e? a esperanc?a condicional de 1Z(x0)&lt;z, isto e? precisamente

F0(z|z1, ...,zN). Considere tambe?m Y , uma transformac?a?o gaussiana de Z pela func?a?o de

anamorfose ? : Z = ?(Y ). Logo, Z pode ser expressado por:

Z(x) = ?[Y ?(x) + ??(x)W(x)] (3.6)

Onde, Y ? e ?? sa?o respectivamente a krigagem simples de Y avaliada nos dados de Y? e o desvio

padra?o da krigagem. W(x) e? a func?a?o gaussiana normalizada, espacialmente independente de Y ?.

A probabilidade de Z ser maior que o teor de corte s e? diretamente derivada da equac?a?o precedente:

Pr[Z(x) &gt; s] = Pr[Y ?(x) + ??(x)W(x) &gt; s] (3.7)

= Pr
[
W(x) &gt;

??1(s) ? Y ?(x)
??(x)

]
(3.8)

= 1 ? G
(
??1(s) ? Y ?(x)

??(x)

)
(3.9)

Onde G e? func?a?o de distribuic?a?o acumulada. Na pra?tica, o modelo gaussiano possui boas

propriedades. Como e? raro encontrar na geocie?ncia uma varia?vel com distribuic?a?o gaussiana, e?

poss??vel transformar uma varia?vel com qualquer distribuic?a?o em uma com distribuic?a?o gaussiana.

72



3.4 Geoestat??stica Na?o-Linear Parametrizac?a?o de Reservas

Se Z e? uma func?a?o aleato?ria com uma distribuic?a?o marginal cont??nua F(dz) e se G(y) e? uma

func?a?o de distribuic?a?o acumulada normal (ou gausssiana), a transformac?a?o Y = G?1(F(Z)) e? a

transformac?a?o de Z em uma func?a?o aleato?ria com uma distribuic?a?o marginal gaussiana padra?o.

A transformac?a?o gaussiana pode ser definida graficamente (figura 3.9) por meio de histograma

emp??rico. Cada ponto (z,F(z)) do gra?fico e? associado a um ponto (y,G(y)) tal que F(z) = G(z).

Z tambe?m pode ser obtido por meio de uma transformac?a?o Y por Z(x) = ?(Y (x)), a esta func?a?o

? = F?1G denomina-se func?a?o anamorfose, que pode ser obtida pela expansa?o de um polino?mio

de Hermite.

Figura 3.9: Exemplo de um gra?fico de Transformac?a?o Gaussiana

3.4.6 Varia?vel Normal Condicionada

Sendo (Y0,Y1) um par de varia?veis aleato?rias com distribuic?o?es normais bivariadas e coeficiente de

correlac?a?o ?:

U =
Y0 ? ?Y1?

1 ? ?2
. (3.10)

Para uma varia?vel normal padra?o, tem-se:

E(U) = 0

V ar(U) = 1

73



3.4 Geoestat??stica Na?o-Linear Parametrizac?a?o de Reservas

Consequ?entemente, U e? uma varia?vel normal padra?o. Portanto, cov(U,Y1) = 0. Enta?o, U e Y1 na?o

sa?o correlacionadas. Note que os pares (U,Y1) sa?o distribuic?o?es normais bivariadas (porque os pares

U e Y1 sa?o combinac?o?es lineares de Y0 e Y1, que sa?o bivariados normais). Logo, pode-se escrever a

seguinte expressa?o:

Y0 = ?Y1 +
?

1 ? ?2U.

Onde U e? uma varia?vel normal independente de Y1. Portanto, como se conhece que Y1 = y1,

tem-se:

(Y0|Y1 = y1) = ?y1 +
?

1 ? ?2U. (3.11)

Por esta deduc?a?o de condicionamento da varia?vel Y0, a me?dia e? E(Y0|Y1 = y1) = ?y1 e com

varia?ncia igual 1 ? %2.

Se Y1 = y1, pode-se usar o valor E(Y0|Y1 = y1) e estimar Y0. Nota-se, que a estimativa de

varia?ncia de Y0 e? originado de Y1 = y1 e 1 ? %2 que na?o depende de y1. Deduzindo-se a equac?a?o de

regressa?o de Y0, conhecendo Y1, tem-se:

E(Y0|Y1) = ?Y1.

A equac?a?o acima e? linear. Assim, usando a expressa?o do estimador de I(Y0 &amp;lt;y), vinda de

Y1 = y1, tem-se:

E(IY0&lt;y|Y1 = y1) = P(Y0 &amp;lt;y|Y1 = y1) = G

(
y ? ?y1?

1 ? ?2

)
.

3.4.7 Mudanc?a de Suporte

Quando se quer obter uma distribuic?a?o de blocos Z(v) por meio de teores conhecidos Z(x), e?

necessa?rio que o modelo satisfac?a certas condic?o?es. Primeiramente, a me?dia dos valores deve

permanecer constante, E[Z(x)] = E[Z(v)]. O segundo ponto, e? que o ca?lculo da varia?ncia da

distribuic?a?o de Z(v) pode ser feita por meio do variograma ?(h) de Z(v), V arZ(v) = varZ(x) ?

?(v,v). O termo ?(v,v) representa o comportamento da variabilidade do bloco, ou seja, a dispersa?o

74



3.4 Geoestat??stica Na?o-Linear Parametrizac?a?o de Reservas

de varia?ncia dos pontos dentro do bloco v.

?(v,v) =
1
v2

? ?
?(x ? y)dxdy.

O resultado entre os pontos e o bloco e? chamado de relac?a?o de Cartier´s e pode ser expressa pela

relac?a?o:

E[z(x)|Z(v)] = Z(v).

Onde x e? chamado de ponto aleato?rio localizado dentro do bloco v. MATHERON provou

que esta relac?a?o garante ordem de relacionamento entre as curvas de quantidade de metal e de

tonelagem de mine?rio em relac?a?o ao benef??cio convencional nas curvas de teores de corte.

Assim, um modelo discreto gaussiano pode ser constru??do, tendo uma varia?vel Z(v) que pode

ser representada pela func?a?o ?v de uma varia?vel normal Yv:

Z(v) = ?v(Yv).

Reescrevendo a equac?a?o de Cartier´s, para determinar ?v:

E[?(Y (x))|?v(Yv)] = ?v(Yv),

ou

?v(Yv) = E[?(Y (x))|(Yv)].

Para avaliar algumas hipo?teses, assume-se que os pares (Yv,Y (x)) sa?o uma distribuic?a?o normal

bivariada com coeficiente de correlac?a?o r. Desde que Yv e Y (x) sejam varia?veis normais, a

distribuic?a?o condicional de Y (x) ve?m de Yv = yv sendo normal com me?dia ryv e varia?ncia 1 ? r2:

Y (x) = rYv +
?

1 ? r2U.

Usando-se a func?a?o anamorfose ?v dos blocos:

?v(Yv) =
? +?
??

?(rYv +
?

1 ? r2u) g(u) d(u). (3.12)

75



3.4 Geoestat??stica Na?o-Linear Parametrizac?a?o de Reservas

Onde g(u) e? a func?a?o de densidade da distribuic?a?o normal. Na pra?tica, e? mais conveniente usar

os polino?mios de Hermite. Sendo Yv e Y (x) varia?veis normais, a relac?a?o e? similar:

E[Hn(Y (x)|Yv] = rnHn(Yv).

Enta?o:

?v(Yv) = E[?(Y (x))|Yv]

= E

[?
0

?nHn(Y (x))|Yv

]
=

?
0

?nE [Hn(Y (x))|Yv] .

Logo:

Z(v) = ?n(Yv) =
?

0

?nr
nHn(Yv). (3.13)

Pode-se obter o coeficiente de anamorfose dos blocos pela multiplicac?a?o dos correspondentes

pontos ?n por rn. A correlac?a?o entre os diferentes polino?mios pode ser obtida por:

varZ(v) = V ar?v(Yv) =
?

1

(?n)
2r2n. (3.14)

Desde que varZ(v) = V arZ(x) ? ?(v,v), o valor de mudanc?a de suporte r pode ser calculado,

o que corresponde ao conhecimento da varia?ncia dos blocos.

No caso da krigagem Disjuntiva, para a mudanc?a de suporte de estimativas locais para uma

func?a?o de Indicatriz I(Z(v) &amp;lt;z), pode ser expressa em termos de polino?mio de Hermite Hn(Yv):

IYv&lt;y = G(y) +
?

1

1
?
n
Hn?1(y)g(y)Hn(Yv).

76



Cap??tulo 4

Co?pula e a Geoestat??stica

Neste cap??tulo, sera? mostrado como a co?pula pode ser utilizada num dos pontos principais da geoestat??stica

mineira, principalmente no que diz respeito ao acesso das incertezas. Discorre-se, primeiramente, sobre o

conceito de validac?a?o cruzada, apresentando a definic?a?o de reserva iluso?ria, o?tima e ideal: e? introduzido

o conjunto de dados de Walker Lake, para exemplificar os resultados obtidos via co?pula, e por fim, sa?o

comparadas a krigagem, a simulac?a?o sequ?encial gaussiana e a co?pula .

4.1 Validac?a?o Cruzada

Para aumentar o grau de certeza do valor real de uma jazida, e? necessa?rio realizar uma amostragem

muito adensada, pore?m isto e? impratica?vel devido aos altos custos envolvidos. Uma alternativa

comum e? optar pela operac?a?o de validac?a?o cruzada, permitindo comparac?o?es entre os valores

estimados Z?(xi) e os valores verdadeiros Z(xi).

A validac?a?o cruzada e? uma via para comparar as suposic?o?es impostas em cada modelo de

estimativa (desde a escolha dos para?metros do variograma ate? o tamanho da vizinhanc?a de

krigagem) ou sobre os dados (valores que na?o se ajustam em sua vizinhanc?a gerando os valores

ano?malos). Para a realizac?a?o de estimativas e? importante verificar a adequac?a?o do modelo de

variograma (ou de covaria?ncia) para assegurar resultados mais confia?veis.

77



4.1 Validac?a?o Cruzada Co?pula e a Geoestat??stica

O procedimento para realizar a validac?a?o cruzada consiste em remover o valor amostrado

Z(xi) do banco de dados e fazer uma estimativa Z?(xi), na mesma posic?a?o xi, usando as outras

n ? 1 amostras localizadas na vizinhanc?a escolhida, e assim procedendo-se com todos os valores

amostrais separadamente. A diferenc?a entre o valor amostrado Z(xi) e o estimado Z?(xi), isto

e?: Z(xi) ? Z?(xi), constitui o erro cometido na estimativa, indicando o efeito dos para?metros

escolhidos (vizinhanc?a e modelo de variograma). Segundo REMACRE e CORNETTI (1996), a

validac?a?o cruzada auxilia a ana?lise de uma se?rie de fatores de estimativa, tais como:

• Comparar valor me?dio estimado com valor me?dio amostrado (na?o vie?s);

• Comparar histograma amostral com histograma dos dados estimados;

• Verificar a independe?ncia do erro Z(xi) ? Z?(xi) e da varia?ncia da krigagem;

• Verificar o na?o vie?s condicional atrave?s do estudo da nuvem de dispersa?o Z(xi) ? Z?(xi) .

Utilizando o projeto de Walker Lake, para a varia?vel V , foi feito o variograma experimental e o

mesmo foi ajustado conforme ISAAKS e SRIVASTAVA (1998), a vizinhanc?a utilizada foi a mesma

sugerida pelos autores, conforme ape?ndice.

Um exemplo de gra?fico de dispersa?o da validac?a?o cruzada e? apresentado na Figura 4.1 . O

estudo da nuvem de dispersa?o Z(xi)?Z?(xi) gerada pela validac?a?o cruzada e? de grande importa?ncia

para a estimativa de reservas, devendo apresentar as seguintes caracter??sticas:

• simetria em relac?a?o a primeira bissetriz;

• concentrac?a?o dos pontos ao redor da primeira bissetriz.

78



4.1 Validac?a?o Cruzada Co?pula e a Geoestat??stica

Na Figura 4.1, a linha vermelha representa a primeira bissetriz, em verde e? mostrada a curva de

regressa?o e os pontos vermelhos indicam a esperanc?a condicional. A partir desse gra?fico e? poss??vel

constatar que os valores baixos teores sa?o superestimados e os valores altos sa?o subestimados. Os

dados desta tabela comprovam os resultados mostrados por ARMSTRONG e GALLI (2002).

Figura 4.1: Validac?a?o Cruzada da Varia?vel V de Walker Lake, mostrando que teores baixos sa?o
subestimados e teores altos sa?o superestimados

Embora o variograma seja bem ajustado, nota-se que existe um vie?s na krigagem dos pontos

amostrados. Ale?m disso, e? poss??vel observar que de acordo com o teor de corte adotado, mudanc?as

significativas ocorrem nas correlac?o?es, o que pode ser comprovado ao se analisar a Tabela 4.1, na

qual sa?o apresentados os coeficientes de correlac?a?o em func?a?o do teor de corte adotado.

79



4.1 Validac?a?o Cruzada Co?pula e a Geoestat??stica

Tabela 4.1 - Alterac?a?o nos coeficientes de correlac?a?o em func?a?o do teor de corte adotado

Teor de Corte 100 200 300 400 500 600 700 800 900 1000

Abaixo do Corte 0.245 0.245 0.331 0.429 0.516 0.582 0.659 0.696 0.746 0.764

Acima do Corte 0.776 0.740 0.735 0.689 0.686 0.651 0.590 0.539 0.577 0.492

Normalmente quando se procede a validac?a?o de qualquer me?todo de estimativa espera-se que,

globalmente, na?o se tenha vie?s.

Para se assegurar de que o modelo de variograma, adotado na validac?a?o cruzada, seja adequado

para a estimativa de reservas por krigagem (ou cokrigagem) deve-se verificar se o erro me?dio

fornecido pela validac?a?o cruzada e? pro?ximo a zero:

E [Z(xi) ? Z?(xi)] =
1
n

n?
i=1

[Z(xi) ? Z?(xi)] ?= 0.

Para o problema em estudo, tem-se E [Z(xi) ? Z?(xi)] = 0.0137, ou seja, muito pro?ximo do valor

desejado, ja? que a me?dia dos dados e? 436,35 ppm. Pore?m, ao se analisar o histograma dos dados

(Figura 4.2), observa-se que existe uma certa variabilidade e grandes erros podem ser cometidos.

Verificando-se apenas o valor global do vie?s, pode-se dizer que na?o existe vie?s aparente. Se

o erro fosse um valor significativo negativo (ou positivo) representaria sistematicamente uma

sobrestimativa (ou uma subestimativa). Assim, antes do in??cio do projeto, e? poss??vel estar ciente

dos efeitos econo?micos envolvidos em reservas minerais sobrestimadas ou subestimadas. Pore?m

em casos como o apresentado, onde o erro esta? pro?ximo a zero, uma ana?lise realizada somente

observando o valor global, o vie?s condicional estaria encoberto (conforme Figura 4.1).

80



4.1 Validac?a?o Cruzada Co?pula e a Geoestat??stica

Figura 4.2: Erro da Validac?a?o Cruzada

Com os dados apresentados anteriormente, foi executada a krigagem ordina?ria pontual de

Walker Lake, e os dados foram comparados com os dados reais, como e? mostrado na Figura 4.3.

Comparando a primeira bissetriz (linha vermelha) com a reta de regressa?o (linha verde) pode-se

concluir que o valor estimado realmente foi enviesado.

Figura 4.3: Gra?fico de dispersa?o da varia?vel V estimada e os teores reais de Walker Lake, mostrando
que teores baixos sa?o subestimados e teores altos sa?o superestimados

81



4.1 Validac?a?o Cruzada Co?pula e a Geoestat??stica

O coeficiente de correlac?a?o dos dados da validac?a?o cruzada e? de 0.795 e o da estimativa e? 0.809,

ou seja, valores bem pro?ximos. Contudo, na Tabela 4.2, onde se apresentam os coeficientes de

correlac?a?o em func?a?o do teor de corte, nota-se que dependendo do teor de corte, a correlac?a?o se

inverte, podendo ocorrer superestimativa ou subestimativa.

Tabela 4.2 - Comparac?a?o entre os coeficientes de correlac?a?o em func?a?o do teor de corte

Teor de Corte 100 200 300 400 500 600 700 800 900 1000

Abaixo do Corte 0.320 0.441 0.519 0.577 0.635 0.682 0.721 0.748 0.768 0.783

Acima do Corte 0.765 0.744 0.724 0.701 0.685 0.676 0.663 0.659 0.642 0.636

O efeito da escolha do teor de corte e do coeficiente de correlac?a?o respectivo e? refletido nas

curvas de parametrizac?a?o de reservas. Para esta krigagem pontual, os impactos em termos

de previsa?o da tonelagem e quantidade de metal sa?o afetados diretamente pelo teor de corte.

Observa-se que a tonelagem pode ser superestimada ate? um determinado valor de teor de corte

e depois passa a ser subestimada. Ja? em termos de quantidade de metal a curva apresenta um

valor maior que o valor esperado da krigagem, apesar da curva da validac?a?o cruzada apresentar a

quantidade de metal maior que os valores das amostras (Figura 4.4).

82



4.1 Validac?a?o Cruzada Co?pula e a Geoestat??stica

Figura 4.4: Curvas de Parametrizac?a?o da Estimativa e das Amostras

Comparando o erro entre os valores estimados e os valores verdadeiros, ou seja, entre as

amostras e a validac?a?o cruzada, krigagem e dados reais (Figura 4.5 ), conclui-se, por meio da

validac?a?o cruzada, que as curvas de reservas estimadas pela krigagem apresentaram um vie?s.

83



4.1 Validac?a?o Cruzada Co?pula e a Geoestat??stica

O vie?s condicional na krigagem e? o problema geral apresentado pelos sul-africanos nas minas

de ouro, estudadas de maneira quantitativa por KRIGE (1951), em que ele utilizou um modelo

emp??rico (linear) para determinar as diferenc?as entre as me?dias das amostras e a superestimativa e

subestimativa dos blocos de mine?rio. KRIGE assumiu que esta relac?a?o era linear e desenvolveu um

sistema de regressa?o linear que quantificava o vie?s condicional.

Figura 4.5: Erro entre as Estimativas e os Dados Reais

A regressa?o e? feita em func?a?o da varia?ncia dos blocos reais e dos blocos estimados, isto pode

ser visto no cap??tulo 5 do livro Teoria das Varia?veis Regionalizadas e suas Aplicac?o?es (MATHERON,

1971), quando a regressa?o e? pro?xima de um (1), o vie?s e? pequeno, mas quando os valores sa?o

84



4.1 Validac?a?o Cruzada Co?pula e a Geoestat??stica

diferentes o vie?s e? grande. O problema esta? descrito tambe?m em JOURNEL e HUIJBREGTS (1978).

MATHERON mostrou que a krigagem e? um estimador linear que minimiza o vie?s condicional,

isto pode ser visto nas figuras anteriores. O problema esta? em minimizar os erros da incorreta

estimativa pela reduc?a?o da superestimativa e subestimativa. Ele provou que a krigagem e? o me?todo

que mais se aproxima do na?o-vie?s condicional.

Todas as tentativas de corrigir este vie?s, utilizam me?todos lineares, buscando o ajuste das curvas

por meio de correlac?o?es gerais. Como foi visto, estas correlac?o?es mudam com o teor de corte

utilizado.

Co?pula e? uma nova maneira de modelar a estrutura de correlac?a?o entre as varia?veis. Por meio de

co?pula na?o se dissocia a estrutura de correlac?a?o das distribuic?o?es marginais. A co?pula e? um me?todo

na?o-linear para correlacionar os dados. Foi criada uma func?a?o benef??cio para o Walker Lake, mais

elaborada que a func?a?o Q ? zc ? T , levando em conta custos de minerac?a?o e processamento, sendo

expressa pela equac?a?o:

FBv(zc) = ?(zc) · [Qv(zc) ? Tv(zc) · zc] ? ? · (T ? Tv(zc) · zc)

Onde o ?(zc) representa a varia?vel de prec?o por conteu?do meta?lico. Qv(zc) e? a quantidade de

metal em um volume v, quando se aplica um teor de corte zc e Tv(zc) e? a tonelagem para o mesmo

caso. ? e? uma constate de custos e T e? a tonelagem lavrada.

O resultado da selec?a?o e? apresentado na Figura 4.6. Pode-se observar que a curva do benef??cio

calculado para os dados reais (linha vermelha com c??rculo vermelho) e? maior que aos dados

estimados pela krigagem ordina?ria (linha azul, com asterisco). E ainda, dependendo do teor de

corte da jazida, o benef??cio efetivo obtido pela selec?a?o dos valores estimados por K.O. (linha azul,

c??rculo azul) seria menor que o valor calculado, ou seja, as expectativas de teores, tonelagem e lucro

do empreendimento na?o seriam alcanc?adas. Neste exemplo, ate? 400 ppm, o benef??cio esperado pela

krigagem na?o e? atingido, a curva mostra que a selec?a?o feita por meio dos teores da krigagem na?o

85



4.2 A Seletividade das Distribuic?o?es Co?pula e a Geoestat??stica

alcanc?a seu objetivo em termos de benef??cios.

Figura 4.6: Benef??cio de Walker Lake, para a selec?a?o perfeita, para a estimativa e o efetivo obtido
pela krigagem

4.2 A Seletividade das Distribuic?o?es

A parametrizac?a?o de reservas seleciona a porc?a?o da reserva que podera? ser lavrada

economicamente. MATHERON (1981) apresentou aplicac?o?es da validac?a?o cruzada, definindo

conceitos de reservas e realizando comparac?o?es entre elas.

MATHERON (1981) da? um exemplo t??pico, em que se tem Z(vi) como o teor de um bloco de

volume vi e Z(xi) o teor de uma amostra, quase pontual, localizada aleatoriamente, segundo uma

lei uniforme, na posic?a?o xi dentro do bloco vi, sendo FZ(x) mais seletiva que FZ(v)(efeito suporte).

Fazendo ? = E[Z(vi)|Z(xi)] a esperanc?a condicional de Z(vi) em Z(xi), tem-se que FZ(v) e? mais

seletiva que F? (que representa o efeito informac?a?o).

Para o ca?lculo de reservas minerais, a princ??pio dispo?e-se apenas dos valores amostrais, quase

pontuais, dos teores Z(xi). Enta?o, MATHERON (1981) define reserva iluso?ria como aquela formada

86



4.2 A Seletividade das Distribuic?o?es Co?pula e a Geoestat??stica

pelos blocos, os quais foram selecionados de modo a conter amostra com teor de metal Z(xi) ? z.

Enta?o, as func?o?es de recuperac?a?o podem ser definidas pela parametrizac?a?o diretamente dos teores

Z(xi) ? z, sendo expressas por:

Til(z) = TZ(x)(z).

Qil(z) = QZ(x)(z).

Bil(z) = BZ(x)(z).

O ??ndice il significa iluso?ria, e Z(x) a parametrizac?a?o sobre os teores das amostras. O termo

iluso?ria refere-se ao fato de se estimar o teor de metal do bloco Z?(vi) pelo teor de metal da amostra

Z?(xi), ou seja, a reserva iluso?ria poderia ser, tambe?m, denominada de reserva estimada ou reserva

esperada.

O mesmo autor define reserva efetiva como aquela que e? efetivamente recuperada, com base no

crite?rio de selec?a?o Z(xi) ? z:

Tef (Z(xi) ? z) = TZ(x)(z).

Qef (Z(xi) ? z) =
+??

Z(x)?z

? (Z(x)) FZ(x) (dZ(x)).

Bef (Z(xi) ? z) =
+??

Z(x)?z

[h (Z(x) ? z)] FZ(x) (dZ(x)).

O ??ndice ef significa efetiva. De posse dos valores amostrados Z(xi), e com o uso de um

estimador, realiza-se a estimativa dos teores dos blocos Z?(vi). Como foi mencionado, Z?(vi) e? uma

estimativa, portanto, pass??vel de erro.

Seriam obtidas as melhores relac?o?es tonelagem teor poss??veis se os teores verdadeiros dos

blocos Z(vi) fossem conhecidos (ause?ncia de efeito informac?a?o), o que e? inacess??vel antes da lavra.

MATHERON (1981) define reserva ideal como aquela que foi parametrizada por meio dos valores

87



4.2 A Seletividade das Distribuic?o?es Co?pula e a Geoestat??stica

dos teores verdadeiros dos blocos Z(vi), com corte em Z(vi) ? z:

Tid(z) = TZ(v)(z).

Qid(z) = QZ(v)(z).

Bid(z) = BZ(v)(z).

Em que o ??ndice id significa ideal. Como a reserva ideal e? inacess??vel, ou seja, se conhece apenas

Z(xi) e na?o Z(vi) antes da lavra, MATHERON propo?s uma pol??tica de otimizac?a?o que consiste em

tomar o corte em ?, segundo o qual ? ? z, onde ? e? a seguinte func?a?o condicional:

? = h (Z(x)) = E [Z(v)|Z(x)] (4.1)

e, com base nisto define-se a reserva o?tima como:

Topt (z) =

+??
?(Z(x))?z

FZ(x) (dZ(x)). (4.2)

Qopt (Z(xi) ? z) =
+??

?(Z(x))?z

h (Z(x)) FZ(x) (dZ(x)). (4.3)

Bopt (Z(xi) ? z) =
+??

?(Z(x))?z

[h (Z(x)) ? z] FZ(x) (dZ(x).) (4.4)

Que e? o que se pode obter de uma situac?a?o real, onde o ??ndice opt significa o?tima. Com base

nessas definic?o?es, conclui-se que:

Bef (z) ? Bopt(z) ? Bid(z) ? Bil(z).

A equac?a?o 4.1 exprime simplesmente que ?(Z(x)) ? z e? o melhor crite?rio poss??vel quando se

conhece o teor da amostra Z(xi) (da estimativa). E a diferenc?a Bopt(z)?Bef (z) resulta da escolha do

crite?rio inadequado Z(x) ? z. A segunda inequac?a?o representa o efeito da informac?a?o e a terceira

inequac?a?o o efeito do suporte. Se a parametrizac?a?o for feita em T ao inve?s de z, tem-se que:

Qef (T) = Qopt (T) .

88



4.3 Reserva Ideal via Co?pulas Co?pula e a Geoestat??stica

Com a restric?a?o que a func?a?o ?(Z(x)) seja crescente. E se assim for, tem-se:

Tef (z) = Topt(z1).

Qef (z) = Qopt(z1).

Com ?(z) = z1, onde se tem que os mesmos blocos sa?o selecionados, mas para cortes diferentes,

ou seja, consiste em obter uma colec?a?o de ?(Z(vi)), transformando cada um dos teores Z(vi) em

?(Z(vi)) utilizando a esperanc?a condicional acima.

Como FZ(x) e? mais seletiva que FZ(v), e esta mais seletiva que F?, tem-se que:

Qopt (T) ? Qid (T) ? Qil (T) .

4.3 Reserva Ideal via Co?pulas

Para a krigagem pontual, utilizando co?pulas gaussianas, e? poss??vel construir a func?a?o que define

reserva ideal, utilizando informac?o?es obtidas por meio da validac?a?o cruzada com retorno via

distribu??c?a?o emp??rica 1 da krigagem.

A Figura 4.7, exemplifica como e? a forma de distribuic?a?o bivariada entre os dados reais e a

krigagem dos 78.000 pontos (em azul); na mesma figura e? apresentada a esperanc?a condicional

(linha com c??rculos preenchidos de azul); e em cinza tem-se o mesmo para a co?pula.

O crite?rio para se escolher o nu?mero de dados a serem simulados igual ao nu?mero de dados

krigados e? uma forma de reproduzir todos os para?metros que sa?o desejados, sem a necessidade de

transformac?o?es (Figura 4.8).

1Ver ape?ndice B

89



4.3 Reserva Ideal via Co?pulas Co?pula e a Geoestat??stica

Figura 4.7: Gra?fico de Dispersa?o de Walker Lake, Real vs krigagem (azul) e Co?pulas 10.000 pontos
simulados (direita) - Co?pulas 50.000 pontos simulados (esquerda), com as respectivas esperanc?as
condicionais e seus histogramas

Figura 4.8: Gra?fico de Dispersa?o de Walker Lake, Real vs krigagem (azul) e Co?pulas 78.000 dados
simulados (cinza), com as respectivas esperanc?as condicionais e seus histogramas

90



4.3 Reserva Ideal via Co?pulas Co?pula e a Geoestat??stica

Pode-se verificar a inversa?o da krigagem nas curvas de tonelagem, sendo que a curva de

tonelagem ?(TZc?(x)|Tz(x)) e a curva de quantidade de mine?rio ?(QZc?(x)|Qz(x)) representam uma

co?pula condicionada pelos valores da krigagem; a outra, curva de tonelagem ?(TZc?(x)|Tz?(x)); e a

outra curva de quantidade de mine?rio ?(QZc?(x)|Qz?(x)) representam a co?pula condicionada pela

validac?a?o cruzada. Nota-se que ate? uma determinada quantidade de tonelagem que sera? retirada,

a krigagem subestima o valor poss??vel. As curvas de parametrizac?a?o da co?pulas, na estimativa

pontual, sa?o ide?nticas a?s curvas dos valores reais (Figura 4.9). Apesar de a forma da curva da

validac?a?o cruzada via co?pulas ser praticamente a mesma dos dados reais, e? interessante considerar

as duas curvas, como espac?o de incerteza dos valores de tonelagem e qualidade do mine?rio.

Figura 4.9: Curvas de Tonelagem vs teor de Corte (acima) e Quantidade de Metal e Teor Corte
(abaixo)

91



4.3 Reserva Ideal via Co?pulas Co?pula e a Geoestat??stica

Aplicando alguns valores de teores de corte (Tabela 4.3) pode-se notar depois de um certo valor,

a krigagem passa a subestimar a tonelagem acima de um determinado teor de corte. Mas, sem o

conhecimento dos teores verdadeiros, na?o se sabe o risco de sua estimativa, podendo-se ter lucro

em um projeto, ou seja, uma tonelagem a mais de mine?rio em um projeto que ja? tinha um retorno

garantido, ou uma tonelagem menor que a esperada, obtendo-se preju??zo no projeto. A quantidade

de mine?rio na krigagem e? sempre subestimada, devido a? suavizac?a?o imposta pelo estimador.

Tabela 4.3 - Porcentagens da tonelagem acima de alguns teores de corte

Teor de Corte Teores Verdadeiros krigagem Ordina?ria ?(TZc?(x)|Tz(x)) ?(TZc?(x)|Tz?(x))

065 (ppm) 75.50 88.45 88.58 72.87

260 (ppm) 44.39 47.98 48.23 47.67

425 (ppm) 25.49 20.66 21.00 25.94

620 (ppm) 10.75 6.98 7.13 10.85

750 (ppm) 5.26 3.05 3.11 5.42

850(ppm) 2.91 1.71 1.74 2.89

Em termos de quantidade de mine?rio, nota-se que os valores previstos pela krigagem somente

sa?o atingidos para o primeiro teor de corte. Os outros valores sa?o subestimados. Ja? para as co?pulas,

o valor real esta? entre os valores previstos. Isto garante uma regia?o de incerteza, onde o valor real e?

uma das soluc?o?es poss??veis (Tabela 4.4).

92



4.3 Reserva Ideal via Co?pulas Co?pula e a Geoestat??stica

Tabela 4.4 - Porcentagens da quantidade de mine?rio obtidas de alguns teores de corte

Teor de Corte Teores Verdadeiros krigagem Ordina?ria ?(QZc?(x)|Qz(x)) ?(QZc?(x)|Qz?(x))

065 (ppm) 98.34 98.69 99.12 98.51

260 (ppm) 80.72 75.72 76.25 83.97

425 (ppm) 57.73 43.40 44.11 57.81

620 (ppm) 30.53 19.03 19.42 30.85

750 (ppm) 17.13 9.65 9.85 17.84

850 (ppm) 10.41 5.89 6.00 10.76

De posse desses valores, foram calculadas as curvas de benef??cio. Na Figura 4.10, tem-se a curva

de uma func?a?o benef??cio para os dados reais e consequ?entemente a selec?a?o perfeita. O valor obtido

pela krigagem foi bem abaixo do valor real, e isto ocorre, pois a quantidade de metal estimada e?

sempre menor que os valores reais, para este exemplo. As curvas obtidas por meio das co?pulas

conseguem acessar a incerteza do valor real, onde se tem uma regia?o de valores poss??veis para o

benef??cio esperado.

93



4.3 Reserva Ideal via Co?pulas Co?pula e a Geoestat??stica

Figura 4.10: Beneficio obtido via para os dados reais, krigagem ordina?ria e co?pulas

A quantificac?a?o do erro da estimativa tambe?m pode ser feita, ou seja, antes do projeto iniciar,

pode-se saber qual a quantidade de mine?rio e a tonelagem que foram classificadas erroneamente

pela krigagem ordina?ria. A Tabela 4.5 mostra que, dependendo do teor de corte, podem existir

grandes erros de blocos de mine?rio classificados como este?ril e blocos de este?ril classificados como

mine?rio.

Tabela 4.5 - Benef??cio obtido para diferentes teores de corte. (em MM US$)

Teor de Corte Teores Verdadeiros k.O. K.O.Efetiva BF?(c?|x?) BF?(c?|x??)

065 (ppm) 12.2 12.1 11.9 12.7 12.2

260 (ppm) 23.1 19.0 18.1 24.5 19.2

425 (ppm) 17.4 11.2 11.1 18.2 11.5

620 (ppm) 7.31 3.28 3.31 8.56 3.43

750 (ppm) 2.35 -0.03 0.13 3.58 0.05

850 (ppm) -0.02 -0.17 -0.15 -0.11 -0.16

94



4.3 Reserva Ideal via Co?pulas Co?pula e a Geoestat??stica

A tonelagem de mine?rio classificado como este?ril prevista pela co?pula, neste exemplo, e? maior

que a diferenc?a entre os dados reais em relac?a?o a krigagem ordina?ria, mas esta diferenc?a e? no

ma?ximo de 2.15% (ver Figura 4.11). Por exemplo, no projeto de Walker Lake, para um teor de

corte de 200 ppm, atrave?s das co?pulas sabe-se que a krigagem tera? classificado 7.5% dos blocos de

mine?rio como este?ril e no final da lavra em posse dos teores verdadeiros a diferenc?a seria menor

que 1% do valor previsto antes de iniciar a lavra pela simulac?a?o via co?pulas.

Figura 4.11: Percentagem de Tonelagem de blocos classificados erroneamente, comparando o valor
real e o valor krigado (vermelho) e a previsa?o por co?pulas (preto).

O mesmo acontece para a tonelagem de este?ril que foi classificada como mine?rio, com

implicac?o?es diretas sobre a qualidade do produto. A Figura 4.12 mostra as diferenc?as percentuais

95



4.3 Reserva Ideal via Co?pulas Co?pula e a Geoestat??stica

entre a tonelagem real e a tonelagem krigada em relac?a?o ao teor de corte. Assim, os valores

poss??veis, dos blocos classificados erroneamente, podem ser supostos antes de se conhecer os

valores reais.

Figura 4.12: Diferenc?as percentuais de tonelagem nas classificac?o?es de mine?rio e este?ril entre os
dados reais versus krigagem e co?pulas.

A quantidade de metal recuperada, tambe?m e? de grande importa?ncia, pois todo o benef??cio esta?

relacionado com a quantidade de metal produzida. A expectativa de teores esta? na quantidade

de mine?rio lavrado. Como pode ser observado na F??gura 4.13, a simulac?a?o via co?pulas esta? muito

pro?xima do que realmente vai ser lavrado.

96



4.3 Reserva Ideal via Co?pulas Co?pula e a Geoestat??stica

Figura 4.13: Porcentagem de quantidade de metal com selec?a?o erro?nea, comparando o valor real e
o valor krigado (vermelho) e a previsa?o por co?pulas (preto).

As diferenc?as percentuais podem ser vistas na Figura 4.14. Mais uma vez, o erro cometido na

estimativa da quantidade de metal e? calculado, antes de se conhecer os valores verdadeiros. A

maior diferenc?a chegou a 4% entre o valor verdadeiro e a previsibilidade via co?pulas. A diferenc?a

entre este?ril classificado como mine?rio, ficou bem ajustada, sendo seu valor sempre menor que 2%,

tanto sobrestimando como subestimando. Para um novo projeto, sem o conhecimento do efeito

informac?a?o, considerando-se uma previsibilidade de quanto sera? o erro da estimativa em termos

de quantidade de metal via uma simulac?a?o, e estas diferenc?as comparadas com dados reais serem

menores que 4%, mostra o potencial deste me?todo.

97



4.3 Reserva Ideal via Co?pulas Co?pula e a Geoestat??stica

Figura 4.14: Diferenc?as percentuais de quantidade de metal nas classificac?o?es de mine?rio e este?ril
entre os dados reais versus krigagem e co?pulas.

Utilizando os mesmo teores de corte, definidos na tabela anterior, nota-se que o erro cometido

pode ser previsto por co?pulas, sem o conhecimento dos dados reais, cujos valores sa?o pro?ximos dos

valores verdadeiros. Por exemplo, se o teor de corte aplicado no projeto de Walker Lake for 260

ppm, a quantidade de mine?rio classificada como este?ril sera? de 8.60%, e a previsa?o por co?pulas de

10.42%. Para um teor de corte de 620 ppm, a quantidade de este?ril classificada como mine?rio sera?

1.59%, e por co?pulas 2.46%. Na Tabela 4.6 sa?o resumidas as demais comparac?o?es para diferentes

teores de corte.

98



4.3 Reserva Ideal via Co?pulas Co?pula e a Geoestat??stica

Tabela 4.6 - Diferenc?as de Tonelagem e Quantidade de Mine?rio no projeto

Tonelagem (%)

Teor de Corte Mine?rio 7? Este?ril Mine?rio 7? Este?ril Este?ril 7? Mine?rio Este?ril 7? Mine?rio

Real Co?pulas Real Co?pulas

065 (ppm) 1.08 1.71 14.04 17.42

260 (ppm) 8.60 10.42 12.19 10.98

425 (ppm) 9.42 10.68 4.60 5.73

620 (ppm) 5.35 6.18 1.59 2.46

750 (ppm) 2.84 3.56 0.63 1.24

850 (ppm) 1.58 2.00 0.38 0.85

Quantidade de Mine?rio (%)

Teor de Corte Mine?rio 7? Este?ril Mine?rio 7? Este?ril Este?ril 7? Mine?rio Este?ril 7? Mine?rio

Real Co?pulas Real Co?pulas

065 (ppm) 0.55 0.99 1.26 0.94

260 (ppm) 11.48 13.76 6.42 5.68

425 (ppm) 18.27 20.71 4.681 6.19

620 (ppm) 13.81 16.373 2.70 4.10

750 (ppm) 8.57 11.16 1.37 2.60

850 (ppm) 5.27 7.19 0.95 2.05

99



4.4 Comparac?a?o com a Simulac?a?o Gaussiana Sequ?encial Co?pula e a Geoestat??stica

4.4 Comparac?a?o com a Simulac?a?o Gaussiana Sequ?encial

Uma outra maneira de acessar as incertezas e? por meio da simulac?a?o estoca?stica. Para isso foi

utilizada a simulac?a?o gaussiana sequ?encial (SGS) com o objetivo de verificar a variabilidade do

feno?meno. O banco de dados de Walker Lake, com 470 amostras e? de dif??cil simulac?a?o, pois existe

uma grande variac?a?o de teores e de classes, sendo algumas mais representativas que outras. Em

muitos trabalhos, utilizando -se esse mesmo banco de dados, sa?o feitas amostragens aleato?rias de

195 dados, com isto tem-se uma amostragem melhor distribu??da e me?dia dos dados mais pro?xima

dos 78.000 pontos. Em projetos de minerac?o?es reais, os dados sa?o mais amostrados em regio?es

ricas, os furos sa?o programados por geo?logos e o que se espera deles e? que furem em regio?es

ricas de mine?rio. Por isto, e? importante a utilizac?a?o das 470 amostras de ISSAKS e SRIVASTAVA

(1989), pois representam um cena?rio realista encontrado no dia-a-dia de uma mina. Foram geradas

100 simulac?o?es para o depo?sito. A partir destes dados foram criados cena?rios probabil??sticos; o

primeiro, e? a me?dia das simulac?o?es, cujo valor e? pro?ximo da krigagem; os outros dois utilizados

foram 95% de probabilidade de estar acima ou abaixo de um determinado teor de corte. O benef??cio

obtido pelos cena?rios da simulac?a?o condicional, na?o atingiram os valores reais, obtidos pela selec?a?o

perfeita (Figura 4.15).

100



4.4 Comparac?a?o com a Simulac?a?o Gaussiana Sequ?encial Co?pula e a Geoestat??stica

Figura 4.15: Benef??cio obtido por krigagem ordina?ria, co?pulas, me?dia SGS, 95% de probabilidade de
estar acima e 95% de probabilidade de estar abaixo.

A Tabela 4.7, mostra que o objetivo da simulac?a?o de atingir as incertezas na?o foi alcanc?ado; o

benef??cio dentro do intervalo probabil??stico so? foi atingido para o corte de 65 ppm; pore?m neste

corte, a krigagem ordina?ria foi o melhor estimador, enquanto que as co?pulas, em todos os valores

de teores de cortes aplicados, envolveu a curva de teor real.

Tabela 4.7 - Benef??cio obtido por teores de corte diferentes (em MM US$)

T. C. Real k.O. BF?(c?|x?) BF?(c?|x??) SGS Me?dio 95% Acima 95% Abaixo

065 (ppm) 12.20 12.10 12.70 12.20 12.50 13.20 11.50

260 (ppm) 23.10 19.00 24.50 19.20 19.40 21.30 17.20

425 (ppm) 17.40 11.20 18.20 11.5 11.80 13.30 10.60

620 (ppm) 7.31 3.28 8.56 3.43 4.22 4.92 3.56

750 (ppm) 2.35 -0.03 3.58 0.05 0.42 0.49 0.36

850 (ppm) -0.02 -0.17 -0.11 -0.16 -0.12 -0.11 -0.16

101



4.4 Comparac?a?o com a Simulac?a?o Gaussiana Sequ?encial Co?pula e a Geoestat??stica

As curvas de tonelagem e quantidade de metal, em relac?a?o ao teor de corte obtidos via

simulac?a?o, mostram que os valores ficaram pro?ximos dos valores da krigagem. Todos os valores

da me?dia das simulac?o?es, exceto para o primeiro teor de corte, obtiveram melhores resultados que

a krigagem ordina?ria. O intervalo de probabilidade de 95% na?o alcanc?ou os dados de tonelagem e

quantidade de metal que poderiam ser estimados se fosse conhecida a reserva real (Figura 4.16).

Figura 4.16: Curvas de parametrizac?a?o obtidas por krigagem ordina?ria, co?pulas, me?dia SGS, 95%
de probabilidade de estar acima e 95% de probabilidade de estar abaixo.

102



4.4 Comparac?a?o com a Simulac?a?o Gaussiana Sequ?encial Co?pula e a Geoestat??stica

A Tabela 4.8, e? a representac?a?o nu?merica dos valores apresentados na Figura 4.16 . Pode-se

observar que no primeiro teor de corte nenhum me?todo atingiu o objetivo. No corte em 260 ppm,

a simulac?a?o alcanc?ou sua meta. Nos outros cortes, principalmente na cauda das distribuic?o?es as

co?pulas foram as curvas que fizeram o seu papel de contornar a curva real .

Tabela 4.8 - Porcentagens da tonelagem acima de alguns teores de corte

T.C. Real K.O. ?(TZc?(x)|Tz(x)) ?(TZc?(x)|Tz?(x)) SGS Me?dio 95% Acima 95% Abaixo

065 (ppm) 75.50 88.45 88.58 72.87 92.62 93.10 88.90

260 (ppm) 44.39 47.98 48.23 47.67 48.35 51.15 43.61

425 (ppm) 25.49 20.66 21.00 25.94 20.31 22.67 17.92

620 (ppm) 10.75 6.98 7.13 10.85 7.52 8.26 6.94

750 (ppm) 5.26 3.05 3.11 5.42 3.62 3.99 3.27

850 (ppm) 2.91 1.71 1.74 2.89 2.02 2.20 1.83

Em termos de quantidade de metal, a co?pula obteve os melhores resultados. Em especial para

altos teores de corte, onde os outros me?todos subestimaram a quantidade de metal do projeto

(Tabela 4.9).

103



4.4 Comparac?a?o com a Simulac?a?o Gaussiana Sequ?encial Co?pula e a Geoestat??stica

Tabela 4.9 - Porcentagens da quantidade de metal obtidas de alguns teores de corte

T.C. Real K.O. ?(QZc?(x)|Qz(x)) ?(QZc?(x)|Qz?(x)) SGS Me?dio 95% Acima 95% Abaixo

065 (ppm) 98.34 98.69 99.12 98.51 99.00 99.09 98.50

260 (ppm) 80.72 75.72 76.25 83.97 74.07 76.28 71.71

425 (ppm) 57.73 43.40 44.11 57.81 42.01 44.88 40.24

620 (ppm) 30.53 19.03 19.42 30.85 20.13 21.24 19.89

750 (ppm) 17.13 9.65 9.85 17.84 11.09 11.75 10.76

850 (ppm) 10.41 5.89 6.00 10.76 6.79 7.11 6.56

Uma outra ana?lise pode ser realizada aumentando o intervalo de confianc?a, para isso foram

executados diversos testes para este banco de dados e com um intervalo de 85% de confianc?a,

obtendo curvas que acessariam os valores reais (Figura 4.17).

Figura 4.17: Benef??cio obtido por krigagem ordina?ria, co?pulas, me?dia SGS, 85% de probabilidade de
estar acima e 85% de probabilidade de estar abaixo

104



4.4 Comparac?a?o com a Simulac?a?o Gaussiana Sequ?encial Co?pula e a Geoestat??stica

Ao se aumentar o intervalo de confianc?a, o problema encontrado e? que o espac?o de incerteza e?

muito amplo e de dif??cil ana?lise. Quando se aplica um teor de corte de 260 ppm, tem-se um benef??cio

variando de US$14.40 milho?es ate? US$ 29.10 milho?es, uma diferenc?a de US$ 14.70 milho?es, podendo

assim, variar mais que o dobro da probabilidade menor, tornando dif??cil defender um projeto que

tenha uma incerteza ta?o alta. Observando-se a Tabela 4.10, essa comparac?a?o torna-se mais clara.

Tabela 4.10 - Benef??cio obtido por teores de corte diferentes (em MM US$)

T. C. Real k.O. BF?(c?|x?) BF?(c?|x??) SGS Medio 85% Acima 85% Abaixo

065 (ppm) 12.20 12.10 12.70 12.20 12.50 15.90 9.90

260 (ppm) 23.10 19.00 24.50 19.20 19.40 29.10 14.40

425 (ppm) 17.40 11.20 18.20 11.50 11.80 19.40 8.90

620 (ppm) 7.31 3.28 8.56 3.43 4.22 7.38 2.68

750 (ppm) 2.35 -0.03 3.58 0.05 0.42 2.40 -0.40

850 (ppm) -0.02 -0.17 -0.11 -0.16 -0.12 -0.15 -1.98

As curvas de tonelagem em relac?a?o ao teor de corte, obtidos via simulac?a?o, mostram que os

valores probabil??sticos atigiram o objetivo de acessar as incertezas. Com 85% de probabilidade a

curva de tonelagem verdadeira foi envolvida. Apenas alguns valores, com baixos teores de corte,

na?o foram envoltos nas curvas probabil??sticas (Figura 4.18).

105



4.4 Comparac?a?o com a Simulac?a?o Gaussiana Sequ?encial Co?pula e a Geoestat??stica

Figura 4.18: Curvas de parametrizac?a?o obtidas por krigagem ordina?ria, co?pulas, me?dia SGS, 85%
de probabilidade de estar acima e 85% de probabilidade de estar abaixo

Nota-se que o espac?o probabil??stico continua muito amplo. Utilizando-se ainda o teor de corte

de 260 ppm, a tonelagem prevista pode ser de 36.71% ate? 62.38% (Tabela 4.11). Como pode-se

projetar uma usina de tratamento, onde a tonelagem de metal tem um intervalo de probabilidade

ta?o amplo? O valor de 260 ppm e? justamente o teor onde ha? a inversa?o da superestimativa pela

subestimativa onde todos os me?todos falham na curva de tonelagem.

106



4.4 Comparac?a?o com a Simulac?a?o Gaussiana Sequ?encial Co?pula e a Geoestat??stica

Tabela 4.11 - Porcentagens da tonelagem acima de alguns teores de corte

T. C. Real K.O. ?(TZc?(x)|Tz(x)) ?(TZc?(x)|Tz?(x)) SGS Me?dio 85% Acima 85% Abaixo

065 (ppm) 75.50 88.45 88.58 72.87 92.62 95.15 82.37

260 (ppm) 44.39 47.98 48.23 47.67 48.35 62.38 36.71

425 (ppm) 25.49 20.66 21.00 25.94 20.31 33.10 15.12

620 (ppm) 10.75 6.98 7.13 10.85 7.52 10.82 6.11

750 (ppm) 5.26 3.05 3.11 5.42 3.62 5.25 2.84

850(ppm) 2.91 1.71 1.74 2.89 2.02 2.86 1.57

Em termos de quantidade de metal, a co?pula obteve os melhores resultados. Acima de um

determinado teor de corte, os outros me?todos subestimaram a quantidade de metal do projeto. Isto

faz com que o benef??cio diminua a? medida em que tenha um corte maior, podendo inviabilizar

projetos que seriam implementados caso o teor verdadeiro fosse conhecido (Tabela 4.12).

Tabela 4.12 - Porcentagens da quantidade de metal obtidas de alguns teores de corte

T. C. Real K.O. ?(QZc?(x)|Qz(x)) ?(QZc?(x)|Qz?(x)) SGS Me?dio 85% Acima 85% Abaixo

065 (ppm) 98.34 98.69 99.12 98.51 99.00 99.44 97.60

260 (ppm) 80.72 75.72 76.25 83.97 74.07 83.74 68.12

425 (ppm) 57.73 43.40 44.11 57.81 42.01 55.71 38.66

620 (ppm) 30.53 19.03 19.42 30.85 20.13 24.03 19.63

750 (ppm) 17.13 9.65 9.85 17.84 11.09 13.39 10.46

850 (ppm) 10.41 5.89 6.00 10.76 6.79 8.03 6.28

107



Cap??tulo 5

Func?a?o de Transfere?ncia

Neste cap??tulo, e? apresentada a func?a?o de transfere?ncia mais importante em um projeto de mina a ce?u aberto,

o otimizador de cavas. Em qualquer projeto de minerac?a?o, a primeira pergunta gerencial a ser feita e? se a cava

o?tima foi escolhida e qual e? seu valor presente l??quido. Foi programado um otimizador baseado no algoritmo

de Lerchs e Grossmann 2D em matlab e tambe?m um sequ?enciador de cava, para explanac?a?o deste cap??tulo,

mostrando as consequ?e?ncias da sobrestimativa e da subestimativa em projetos de minerac?a?o, o banco de dados

de Walker Lake foi utilizado para suportar os problemas ocasionados pelo erro de estimativa.

5.1 Avaliac?a?o de cava final via co?pulas

Um aspecto fundamental no desenvolvimento de qualquer projeto de minerac?a?o a ce?u aberto e?

a determinac?a?o das reservas minerais, obtidas por meio dos chamados limites finais da cava. Os

limites finais da cava definem o tamanho e a forma de uma mina a ce?u aberto no final de sua

vida u?til, buscando a maximizac?a?o do lucro. Eles definem a extensa?o das reservas lavra?veis e

a quantidade de material este?ril a ser retirado. Normalmente, marcam a fronteira ale?m da qual

a explotac?a?o de um dado depo?sito na?o sera? mais econo?mica. Os limites da cava na superf??cie

delimitam uma fronteira dentro da qual as estruturas de superf??cie da mina, tais como plantas de

beneficiamento e escrito?rios da mina, na?o devem ser locados.

109



5.1 Avaliac?a?o de cava final via co?pulas Func?a?o de Transfere?ncia

A verdadeira revoluc?a?o em otimizac?a?o de cavas de minas surgiu em 1965, com o aparecimento

do algoritmo idealizado por HELMUT LERCHS e INGO F. GROSSMANN e desde enta?o

muitos autores o desenvolveram e muitas te?cnicas de programac?a?o lhe foram aplicadas. Ate?

o aparecimento do algoritmo LG, a otimizac?a?o de cavas finais sempre foi feita por um me?todo

manual de tentativas. Nele se procurava, por meio de tentativas, chegar a uma cava que deveria ser

interessante e, se viesse a parecer muito este?ril dentro desta cava, ela deveria ser fechada (em nova

tentativa) para desmontar mine?rio de maior teor e menos este?ril, mas se ao contra?rio, houvesse

possibilidade de alargar mais a cava, tal tambe?m deveria ser feito (em nova tentativa) e assim

sucessivamente ate? se alcanc?ar uma cava final satisfato?ria.

O algoritmo de LERCHS e GROSSMAN e? um algoritmo dual para o problema de fechamento

ma?ximo e corte m??nimo que trabalha com a soluc?a?o o?tima poss??vel. Sua relac?a?o para fluxo ma?ximo

e? bastante evidente, uma completa abordagem pode ser vista em LERCHS e GROSSMANN (1965).

O banco de dados de Walker Lake, rotacionado em 900, foi utilizado como uma sec?a?o geolo?gica

vertical representando uma jazida em 2D. Observa-se na Figura 5.1, que o resultado da krigagem e?

uma imagem suavizada dos dados reais.

Figura 5.1: Walker Lake em sec?a?o vertical pontual: dados reais (esquerda) e krigagem (direita).

110



5.1 Avaliac?a?o de cava final via co?pulas Func?a?o de Transfere?ncia

Assim, foram geradas as cavas o?timas para se verificar os efeitos da krigagem em um projeto

de minerac?a?o quando se utiliza uma func?a?o de transfere?ncia, no caso, a otimizac?a?o de cavas. Os

valores da func?a?o foram alterados, pois a lavra na?o sera? mais feita como um painel, mas sim

como um modelo de blocos com mine?rio e este?ril. Para este caso, utilizando o teor de corte de

65 ppm, o valor obtido pela krigagem foi de US$ 1.80 milho?es. Seguindo a geometria proposta

pelo otimizador de cavas por meio dos dados estimados, o valor efetivo recuperado seria de US$

2.26 milho?es. Mas se os valores verdadeiros fossem conhecidos, o benef??cio obtido seria de US$

2.42 milho?es. Esta diferenc?a e? de 25.84% menor do que o projeto poderia realizar. Um resultado

satisfato?rio e? que o projeto teria um lucro de 20.41% maior. O questionamento que deve ser feito

e?: se os investidores soubessem antes do projeto que existe uma alta probabilidade de o lucro do

empreendimento ser maior que o da estimativa, quanto seria a sua fatia na carteira investida? O

inverso tambe?m pode acontecer, se o projeto foi superestimado, portanto, va?rias deciso?es podem

ser tomadas dependendo da incerteza da estimativa.

Segundo MATHERON (REMACRE, 1984), os teores provenientes da amostragem sa?o em geral

medidos sobre suportes pequenos. Tais teores sa?o muitos dispersos, sendo iluso?rio pensar em

recuperar so? estes teores elevados: com efeito, na?o se lavram amostras, mas unidades muito

maiores, cujos teores sa?o menos dispersos e apresentam poucos valores extremos. Por isto, foram

estimados os teores de Walker Lake para um suporte de 5 x 5 metros, de modo a verificar o

comportamento das co?pulas, sobre um outro volume.

111



5.2 Mudanc?a de Suporte via Co?pulas Func?a?o de Transfere?ncia

Figura 5.2: Cavas geradas de Walker Lake com sec?a?o vertical pontual dados reais e krigagem.

5.2 Mudanc?a de Suporte via Co?pulas

Durante um certo tempo, perdeu-se a verdadeira raza?o da krigagem: a de evitar o erro sistema?tico,

cultivando-se a varia?ncia m??nima. O controle de lavra tinha pouca importa?ncia. Hoje, a?s exige?ncias

sa?o outras, e para cada bloco o problema e? o mesmo: mine?rio ou este?ril? Esta preocupac?a?o na?o e?

nova, KRIGE buscava a construc?a?o de um estimador que evitasse o erro sistema?tico. Foi a partir

da?? que nasceu a geoestat??stica, o outro aspecto, que esta? sendo esquecido e? a extrema simplicidade

das ferramentas utilizadas por MATHERON: noc?o?es de regressa?o linear da estat??stica aplicada.

112



5.2 Mudanc?a de Suporte via Co?pulas Func?a?o de Transfere?ncia

Em termos pra?ticos, a krigagem consiste em encontrar a melhor estimativa linear do teor de um

bloco em func?a?o da informac?a?o dispon??vel, ou seja, dos teores das diferentes amostras dispon??veis,

seja no interior, seja no exterior do bloco que se quer estimar. A krigagem e? uma ponderac?a?o

na qual se atribui um peso ao teor de cada amostra, peso este calculado de maneira a tornar

m??nima a varia?ncia de estimativa e ainda ser func?a?o das caracter??sticas geome?tricas do problema

(formas, dimenso?es e disposic?a?o mu?tua das amostras e do bloco). A soluc?a?o de um problema de

krigagem somente e? poss??vel de ser resolvido quando calcula-se efetivamente o peso o?timo de

cada amostra, assumindo-se certas hipo?teses sobre as caracter??sticas geoestat??sticas do depo?sito

estudado, correlacionado com a func?a?o variograma ou a func?a?o covaria?ncia. E? necessa?rio notar que

no momento de se estimar estas func?o?es, a partir dos dados, e? que se coloca o questionamento das

hipo?teses de estacionaridade (de 2a ordem ou intr??nseca).

Como foi visto no Cap??tulo 3, a mudanc?a de suporte causa a degenerac?a?o das curvas de parame

trizac?a?o. Assim, para a simulac?a?o via co?pulas ale?m da validac?a?o cruzada, foi inserido o efeito de

suporte.

Na Figura 5.3, tem-se uma visa?o tridimensional dos dados simulados. A simulac?a?o e?

condicionada pelas covaria?ncias entre os dados que foram mudados de suporte pela validac?a?o

cruzada no suporte de 5 metros e pelo pro?prio valor krigado.

113



5.2 Mudanc?a de Suporte via Co?pulas Func?a?o de Transfere?ncia

Figura 5.3: Simulac?a?o de co?pulas com 3 para?metros de entrada, correlac?o?es entre amostras e
validac?a?o cruzada, amostras no bloco e krigagem e validac?a?o cruzada no bloco e krigagem.

Tem-se ?(c ? |x) como a simulac?a?o da co?pula condicionada aos valores das amostras no bloco,

?(c?|x?) representa o condicionamento da validac?a?o cruzada e ?(c?|x??) o condicionamento com

o bloco krigado.

A primeira vantagem da krigagem aparece devido a sua pro?pria definic?a?o. Minimizando

a varia?ncia de estimativa, garante-se tirar o melhor partido das informac?o?es dispon??veis. Esta

vantagem nota?vel na?o justifica, muitas vezes, as complicac?o?es suplementares da pro?pria krigagem.

O interesse pra?tico mais importante da krigagem prove?m na?o apenas da melhor precisa?o poss??vel,

114



5.2 Mudanc?a de Suporte via Co?pulas Func?a?o de Transfere?ncia

mas do que ela permite evitar, ou seja, o erro sistema?tico. Na maior parte dos depo?sitos, pratica-se

uma operac?a?o, chamada de selec?a?o, que consiste em extrair certos blocos julgados renta?veis e

abandonar outros julgados na?o renta?veis. A Figura 5.4, mostra a sec?a?o vertical krigada e os dados

reais, e nota-se que a krigagem ordina?ria, como qualquer estimador, cometeu alguns erros, pois

algumas regio?es perto de valores altos foram superestimadas.

Figura 5.4: Walker Lake com sec?a?o vertical blocos dados reais (esquerda) e krigagem ordina?ria
(direita).

Para a explanac?a?o deste cap??tulo, foram geradas tre?s cavas com teores de corte diferentes, uma

com 65 ppm, outra com 150 ppm e a terceira com 260 ppm. Acima desse teor de corte, o valor

descontado da cava foi negativo, na?o gerando assim cava o?tima.

A cava gerada com o teor de corte de 65 ppm, e? apresentada na Figura 5.5. A sec?a?o transversal

da figura foi cortada no n??vel 25, para uma melhor visualizac?a?o. As cavas apresentam o mesmo

aspecto, mas seus valores sa?o bem diferentes.

115



5.2 Mudanc?a de Suporte via Co?pulas Func?a?o de Transfere?ncia

Figura 5.5: Cavas geradas de Walker Lake blocos 5x5.

O benef??cio obtido pela cava, sem o sequ?enciamento, ou seja, como se a lavra fosse feita em

todos os blocos ao mesmo tempo, apresenta valores bem pro?ximos dos valores reais. O resultado

obtido via co?pulas, aproximou-se mais dos dados reais, esses resultados esta?o resumidos na Tabela

5.1.

116



5.2 Mudanc?a de Suporte via Co?pulas Func?a?o de Transfere?ncia

Tabela 5.1 - Valor Presente obtido pelo teor de corte de 65 ppm

Cava Obtida Benef??cio

Ideal 1.7369 x 106

Krigagem Ordina?ria 1.6858 x 106

Efetivo Krigagem Ordina?ria 1.7049 x 106

Co?pula ?(c?|x?) 1.6888 x 106

Efetivo Co?pulas ?(c?|x?) 1.7049 x 106

Co?pula ?(c?|x??) 1.7342 x 106

Efetivo Co?pula ?(c?|x??) 1.7015 x 106

Contudo, em uma mina tem-se uma sequ?e?ncia de extrac?a?o de mine?rio. Portanto, foi programado

um sequ?enciador de cavas em Matlab, para que fosse feito o ca?lculo correto do fluxo de caixa obtido

pela cava gerada. Foi aplicada uma taxa de desconto de 12% ao ano e a capacidade de produc?a?o foi

aumentada, para que a lavra fosse sempre em um nu?mero fixo de anos.

Desse modo, e? poss??vel analisar o real impacto do estimador. Nas expectativas depositadas

no projeto, o foco esta? orientado no benef??cio obtido, que e? o objetivo principal de todo

empreendimento. Na Figura 5.6, nota-se que, para este teor de corte, os investidores obtiveram

resultados satisfato?rios. O benef??cio final e? superior ao in??cio do projeto. A grande questa?o e? prever

se o valor obtido antes de iniciar um projeto, vai superar a estimativa ou sera? um projeto que ira?

falhar, obtendo um retorno financeiro aque?m do valor esperado.

Na Figura 5.6, apresenta-se o valor esperado da krigagem e das co?pulas (na cor preta). Pode-se

notar, que os valores de benef??cio obtidos (pontilhado) sa?o superiores aos estimados.

117



5.2 Mudanc?a de Suporte via Co?pulas Func?a?o de Transfere?ncia

Figura 5.6: Sequ?enciamento e cava obtida com teor de corte de 65 ppm, via krigagem de blocos 5m
x 5m, krigagem (em acima), co?pula 1 (no meio)e co?pula 2 (em baixo).

Os valores presentes l??quidos, encontram-se apresentados na Tabela 5.2. Eles mostram que o

valor esperado pela krigagem e? 21,94% inferior ao valor ideal que poderia ser obtido pela cava. E a

diferenc?a entre o valor esperado e o valor efetivo e? de 13,66%.

118



5.2 Mudanc?a de Suporte via Co?pulas Func?a?o de Transfere?ncia

Tabela 5.2 - Valor Presente L??quido obtido pelo teor de corte de 65 ppm

Sequenciamento Obtido Benef??cio L??quido

Ideal 4.9256 x 105

Krigagem Ordina?ria 3.8442 x 105

Efetivo Krigagem Ordina?ria 4.4525 x 105

Co?pulas ?(c?|x?) 3.8801 x 105

Efetivo Co?pula ?(c?|x?) 4.4868 x 105

Co?pulas ?(c?|x??) 4.0236 x 105

Efetivo Co?pula ?(c?|x??) 4.5875 x 105

Caso os teores reais sejam conhecidos, o melhor sequ?enciamento da cava pode ser visto na

Figura 5.7 e 5.8, onde se prioriza lavrar toda a regia?o de altos teores primeiro, buscando recuperar

os investimentos.

Figura 5.7: Fluxo de caixa obtido pelo sequ?enciamento com teor de corte de 65 ppm, caso fosse
conhecido os teores verdadeiros de blocos 5m x 5m .

119



5.2 Mudanc?a de Suporte via Co?pulas Func?a?o de Transfere?ncia

Figura 5.8: Sequ?enciamento e cava obtida com teor de corte de 65 ppm, caso fosse conhecido os
teores verdadeiros de blocos 5m x 5m.

Foi gerada uma cava com o teor de corte de 150 ppm. O benef??cio obtido para esta cava, sem

o sequ?enciamento, pode ser visto na Tabela 5.3. A geometria da cava foi a mesma para todas as

estimativas, portanto, o valor econo?mico efetivamente lavrado foi o mesmo para todas.

Tabela 5.3 - Valor Presente obtido pelo teor de corte de 150 ppm

Cava Obtida Benef??cio

Ideal 1.4681 x 106

Krigagem Ordina?ria 1.4662 x 106

Efetivo Krigagem Ordina?ria 1.4156 x 106

Co?pula ?(c?|x?) 1.4665 x 106

Efetivo Co?pula ?(c?|x?) 1.4156 x 106

Co?pula ?(c?|x??) 1.5126 x 106

Efetivo Co?pula ?(c?|x??) 1.4156 x 106

120



5.2 Mudanc?a de Suporte via Co?pulas Func?a?o de Transfere?ncia

Foi aplicada a mesma taxa de desconto de 12% ao ano e a capacidade de produc?a?o foi

aumentada, para que a lavra fosse sempre em um nu?mero fixo de anos.

Figura 5.9: Sequ?enciamento e cava obtida com teor de corte de 150 ppm, via krigagem de blocos 5m
x 5m, krigagem (em acima), co?pula 1 (no meio) e co?pula 2 (em baixo).

Os valores presentes l??quidos, encontram-se resumidos na Tabela 5.4. Pode-se observar que o

valor esperado pela krigagem foi 28,23% inferior ao valor ideal que poderia ser obtido pela cava.

As diferenc?as aumentaram em relac?a?o ao teor de corte anterior. Uma das co?pulas conseguiu obter

uma diferenc?a de 7,01%, ou seja, o valor do projeto ficou pro?ximo do valor esperado.

121



5.2 Mudanc?a de Suporte via Co?pulas Func?a?o de Transfere?ncia

Mais uma vez pode-se analisar o impacto do estimador nas expectativas depositadas no projeto,

cujo foco esta? orientado para o benef??cio obtido, que e? o objetivo principal de todo empreendimento.

A Figura 5.9 mostra que para este teor de corte, o benef??cio final sera? superior ao in??cio do projeto.

A grande questa?o e? prever, se o valor obtido antes de iniciar um projeto, vai superar a estimativa

ou sera? um projeto que ira? falhar, obtendo um retorno financeiro abaixo do valor esperado.

Tabela 5.4 - Valor Presente L??quido obtido pelo teor de corte de 150 ppm

Sequ?enciamento Obtido Benef??cio L??quido

Ideal 3.5139 x 105

Krigagem Ordina?ria 2.5254 x 105

Efeitvo Krigagem Ordina?ria 2.9961 x 105

Co?pula ?(c?|x?) 3.2679 x 105

Efetivo Co?pula ?(c?|x?) 3.3534 x 105

Co?pula ?(c?|x??) 2.2908 x 105

Efetivo Co?pula ?(c?|x??) 2.4812 x 105

Na Figura 5.10, tem-se o valor esperado da krigagem e das co?pulas (na cor preta). Os valores de

benef??cio obtidos (pontilhado) sa?o superiores aos estimados. Caso os teores reais fossem conhecidos,

o melhor sequ?enciamento da cava pode ser visto na Figura 5.10, onde se busca lavrar toda a regia?o

de altos teores primeiro, auferindo maior lucro, e buscando recuperar os investimentos.

122



5.2 Mudanc?a de Suporte via Co?pulas Func?a?o de Transfere?ncia

Figura 5.10: Fluxo de caixa obtido pelo sequ?enciamento com teor de corte de 150 ppm, caso fosse
conhecidos os teores verdadeiros de blocos 5m x 5m.

A geometria do sequ?enciamento ideal tambe?m pode ser observada na Figura 5.11, isto seria

poss??vel, se fossem conhecidos os teores reais.

Figura 5.11: Sequ?enciamento e cava obtida com teor de corte de 150 ppm, caso fosse conhecidos os
teores verdadeiros de blocos 5m x 5m.

A u?ltima cava que sera? apresentada e? a gerada com o teor de corte de 260 ppm. Os valores

calculados para o benef??cio obtido pela cava, sem o sequenciamento, podem ser resumidos na

Tabela 5.5. Sem a utlizac?a?o de taxas de descontos, o valor da krigagem foi o melhor resultado. As

diferenc?as entre o valor esperado e o ideal foram baixas.

123



5.2 Mudanc?a de Suporte via Co?pulas Func?a?o de Transfere?ncia

Tabela 5.5 - Valor Presente obtido pelo teor de corte de 260 ppm

Cava Obtida Benef??cio

Ideal 0.8532 x 106

Krigagem Ordina?ria 0.7608 x 106

Efetivo Krigagem Ordina?ria 0.7826 x 106

Co?pula ?(c?|x?) 0.6877 x 106

Efetivo Co?pula ?(c?|x?) 0.7794 x 106

Co?pula ?(c?|x??) 0.1560 x 106

Efetivo Co?pula ?(c?|x??) 0.7528 x 106

Como anteriormente, foi aplicada a mesma taxa de desconto de 12% ao ano, e a capacidade de

produc?a?o foi aumentada para que a lavra fosse sempre em um nu?mero fixo de anos.

Na Figura 5.12, apresenta-se o valor esperado, da krigagem e das co?pulas (na cor preta). Os

valores de benef??cio efetivamente obtidos (pontilhado) sa?o superiores em todas as estimativas.

Nota-se que, a primeira co?pula conseguiu obter resultados satisfato?rios, principalmente nos anos

onde o benef??cio seria negativo, devido a alta quantidade de este?ril a ser removida para alcanc?ar o

segundo corpo de mine?rio.

124



5.2 Mudanc?a de Suporte via Co?pulas Func?a?o de Transfere?ncia

Figura 5.12: Sequ?enciamento e cava obtida com teor de corte de 260 ppm, via krigagem de blocos
5m x 5m, krigagem (em acima), co?pula 1 (no meio) e co?pula 2 (em baixo).

Os valores presentes l??quidos, encontram-se na Tabela 5.6. Eles mostram que o valor esperado

pela krigagem foi 28,13% inferior ao valor ideal que poderia ser obtido pela cava. As diferenc?as

aumentaram em relac?a?o ao teor de corte anterior. Uma das co?pulas conseguiu obter o valor mais

pro?ximo do valor ideal.

125



5.2 Mudanc?a de Suporte via Co?pulas Func?a?o de Transfere?ncia

Tabela 5.6 - Valor Presente L??quido obtido pelo teor de corte de 260 ppm

Sequenciamento Obtido Benef??cio L??quido

Ideal 0.1068 x 105

Krigagem Ordina?ria 0.0353 x 105

Efeitvo Krigagem Ordina?ria 0.0783 x 105

Co?pula ?(c?|x?) 0.0614 x 105

Efetivo Co?pula ?(c?|x?) 0.1051 x 105

Co?pula ?(c?|x??) 0.0034 x 105

Efetivo Co?pula ?(c?|x??) 0.0213 x 105

Caso os teores reais fossem conhecidos, o melhor sequ?enciamento da cava pode ser observado

na Figura 5.13.

Figura 5.13: Sequ?enciamento e cava obtida com teor de corte de 260 ppm, caso fosse conhecidos os
teores verdadeiros de blocos 5m x 5m.

126



Cap??tulo 6

Concluso?es

Estudos especializados sobre falhas em projetos de minerac?a?o mostram que alguns fracassos dos

empreendimentos sa?o diretamente atribu??dos a erros de estimativa de mine?rio. Muitos me?todos

ve?m sendo propostos para solucionar o velho problema mineiro. Cada vez mais e? preciso gerenciar

as poss??veis falhas, para verificar a opc?a?o de investir ou na?o em um projeto.

Respostas ra?pidas sa?o exigidas para diversos projetos. A simulac?a?o estoca?stica foi formulada

com o objetivo de verificar a variabilidade de um depo?sito, seu objetivo e? diferente da krigagem.

Apesar da velocidade dos computadores atuais, como gerar 50 ou 100 cavas oriundas de simulac?o?es

condicionais e aplicar teores de cortes diferentes, seriam gerados milhares de cena?rios deste

exerc??cio. O processo de definic?a?o da cava matema?tica e seu sequ?enciamento sa?o demorados,

ale?m disso, deve-se rodar uma func?a?o benef??cio para cada cena?rio e os processos de importac?a?o

e exportac?a?o de modelos de blocos reais sa?o lentos, e muitas vezes, os resultados obtidos, pela

simulac?a?o, na?o sa?o satisfato?rios. O compromisso de reproduzir a variabilidade do depo?sito

(conhecida no jarga?o geoestat??stico como cabeleira de variograma) na?o garante que as incertezas,

utilizando um teor de corte, sejam acessadas. A utilizac?a?o do banco de dados de Walker Lake

com 470 em vez dos tradicionais 190, mostram a influe?ncia de dados enviesados, isto foi visto no

cap??tulo 4, onde o cena?rio na qual se definiu as incertezas do projeto foi o de probabilidade de

85%, mas como saber que o cena?rio de probabilidade de 95% na?o acessaria estas incertezas, se em

127



Concluso?es

projetos reais na?o se conhece o valor verdadeiro. A probabilidade de 85% acarretou um problema,

pois o intervalo entre as probabilidades de estar acima e abaixo, ficaram amplos, sendo imposs??vel

tomar qualquer decisa?o; o sucesso e o fracasso do empreendimento ficaram com probabilidades

altas.

O objetivo principal desta tese foi atingido, o me?todo de condicionamento utilizando co?pulas

obteve sucesso de uma maneira simples, atrave?s do condicionamento da krigagem e da validac?a?o

cruzada, definindo o intervalo de incertezas de um projeto. Em posse da melhor ferramenta de

estimativa na?o enviesada e os erros locais impostos pela definic?a?o do variograma e vizinhanc?a

de krigagem (validac?a?o cruzada) foram utilizados em uma simulac?a?o que buscava reproduzir a

forma da distribuic?a?o conjunta, entre o valor estimado e o valor real (que na?o existe na pra?tica).

Com isto, foi poss??vel estimar curvas do tipo tonelagem x teor e definir um intervalo de poss??veis

valores para o projeto. Dependendo do teor de corte, a krigagem sobrestima ou subestima e com

os valores obtidos por co?pulas foi poss??vel detectar a regia?o onde existe a inversa?o dos teores, pois

tem-se uma estimativa. Os resultados obtidos na otimizac?a?o de cava e no sequ?enciamento mostram

o efeito da krigagem na otimizac?a?o de cavas. Principalmente no que tange o erro econo?mico

que uma sequ?e?ncia definida por uma estimativa pode levar, devida a selec?a?o erro?nea de blocos.

Os resultados obtidos no capitulo 5, mostram que o condicionamento utilizando co?pulas, obteve

resultados efetivamente melhores que a krigagem.

Como sugesta?o para trabalhos futuros, ale?m de testar em outros bancos de dados sinte?ticos ou

reais; bancadas com valores conhecidos, verificando o comportamento das co?pulas, pode-se impor

distribuic?o?es conhecidas, como a co?pula lognormal, mudando o suporte, em termo de teo?rico, por

meio da varia?ncia. Na?o sendo necessa?rio a utilizac?a?o da transformac?a?o gaussiana.

128



Cap??tulo 7

Bibliografia

[1] ARMSTRONG, M.; GALLI, A. Copulas. In: SPE ATW Risk Analysis Applied to Field

Development Under Uncertainty, Rio de Janeiro, Agosto 2002.

[2] BURMEISTER, B. From Resources to Reality-A Critical Review of the Achievement of New

Australian Gold Mining Projects During the Period January 1983 to September 1987, Sydney, 1989.

MSc Thesis (unpublished), Macquarie University.

[3] CLOUT, J. M. F.; CLEGHORN, J. H.; EATON, P. C. Geology of the Kalgoorlie gold field. In:

HUGHES, F. E. ed., Geology of the Mineral Deposits of Australia and Papau New Guinea, AusIMM,

Melbourne, 1990, p.411-431.

[4] CHAUVET, P. Aide-me?moire de ge?ostatistique line?aire. Presses de l’Ecole des mines de Paris.

Fontainebleau: 1999, 367 p.

[5] CHILE?S, J. P.; DELFINER, P. Geostatistics: Modeling Spatial Uncertainty. Wiley Series in

Probability and Statistics, 1999. 720p.

[6] DOMINY; SIMON C.; NOPPE?; MARK A.; ANNELS, A. E. Errors and Uncertainty in Mineral

Resource and Ore Reserves Estimation: The Importance of Getting it Right. Explor. Mining Geol.

v.11, n.1-4, p.77-98, 2002.

[7] EMERY, X. Simulation conditionnelle de mode?les isofactoriels. Paris, 2004. The?se de doct. en

ge?ostatistique, Ecole des Mines de Paris.

[8] GALTON, F.. Hereditary Genius: An Inquiry Into Its Laws and Consequences. Macmillan

and CO, London, 1892. 390p.

129



Bibliografia

[9] GOOVAERTS, P. Geostatisitcs for Natural Resources Evaluation. Oxford University Press,

New York, 1997. 483 p.

[10] HARQUAIL, D. Investing in Junior Mining Companies. In: 6th Mineral Economics

Symposium of CIM, Montreal, Canada, 1991. Proceedings, 10p, 1991.

[11] ISAAKS, E. H. The application of Monte Carlo Methods to the Analysis of Spatially

Correlated Data. Stanford, 1990. Ph.D. Thesis, Stanford University.

[12] ISAAKS, E., H.; SRIVASTAVA, M. R. Introduction to Applied Geostatistics. Oxford

University Press, Boston, 1990. 592p.

[13] JOURNEL, A. G.; HUIJBREGTS, C. J. Mining geostatistics. London, Academic Press, 1978.

600p.

[14] JOURNEL, A. G. Nonparametric estimation of spatial distributions. Mathematical Geology,

v. 15, n. 3, p. 445-468, jun. 1983.

[15] JOURNEL, A.G. Geostatistics for conditional simulation of ore body. Economic Geology,

n.69, p.673-687, 1974.

[16] KRIGE, D. G. A statistical approach to some basic mine valuation problems on the

Witwatersrand. Journal of the Chemical, Metallurgical and Mining Society of South Africa. n.52, p.

119-139, 1951.

[17] LASSONDE, P. The Gold book: The complete investment guide to precious metals.

Financial Times of Canada, Toronto, 1990. 130p.

[18] LANTUE?JOUL, C. Geostatistical Simulation, Models and Algorithms. Springer, Berlin.

Olea, RA, 2002. 256p.

[19] LINDSKOG, F. Modeling Dependences with Copulas and Application to the Risk

Management. Working Paper, Department of Mathematics ETH Zurich, sep. 2000.

[20] MATHERON, G. The Selectivity of the Distributions and The Second Principle of

Geostatistics In: Verly et al. ed., Geostatistics, Kluwer for Natural Resources Characterization,

Part I, 1984, p. 421-433.

130



Bibliografia

[21] MATHERON, G. The Intrinsic Random Functions and Their Applications. Adv. Appl. Prob.

v.5, p.439-468, 1973.

[22] MATHERON, G. La Se?lectivite? des Distributions. Centre de Ge?ostatistique, Ecole des Mines

de Paris, Fontainebleau: 1981. (Internal Report N-395).

[23] MARSHALL, A. W.; OLKIN, I. Families of Multivariate Distributions. Journal of the

American Statistical Association. v. 83, n. 403, sep. 1988.

[24] NELSEN, Roger, B. An Introducion to Copulas. Lecture notes in Statistics. Springer Verlag,

New York, 1999. 139p.

[25] REMACRE, A. Z. L’estimation du re?cupe?rable local : le conditionnement uniforme. Paris,

1984. The?se de Doct. Ing. en sciences et techniques minie?res, Ecole des Mines de Paris.

[26] RIVOIRARD, J. Introduction to disjunctive kriging and non-linear geostatistics. Oxford

University Press, 1994. 180p.

[27] RONCALLI, T. Gestion des risques multiples ou copules et aspects multidimensionnels du

risque. Cours ENSAI 3ie?me anne?e, 2002. 320p.

[28] SICHEL, H. S. New Methods in the Statistical Evaluation of Mine Sampling Data. Trans.

Inst. Mining and Metall. v.61, p.261-288, 1952.

[29] SICHEL, H. S. Mine valuation and Maximum likelihood, Witwatersrand, 1949. Thesis,

University of Witwatersrand.

[30] SRIVASTAVA, R. M. Reservoir characterization with probability field simulation. In: SPE

Annual Conference and Exhibition, Washington, D.C, Number: 24753, p.927 - 938, 1992.

[31] REMACRE, A. Z. e CORNETTI, M. A. , Analise de Variabilidade - ANAVAR, VI Simposio

de Quantificacao em Geociencias, I, P. 139-141, 1995.

[31] SPEARMAN, C.E. The Proof and Measurement of Association Between Two Things.

American Journal of Psychiatri. v.15, p.72-101, 1904.

[32] SCHWEIZER, B.; WOLFF, E. F. On Nonparametric Measures of Dependence for Random

Variables. The Annals of Statistics. v.9, p.879-885, 1981.

131



Bibliografia

[33] WIJS de H. J. Statistics of ore deposition. Geologie en Mijubouw. v. 30, p. 365-375, 1951.

[34] LERCHS, H. e GROSSMANN, I.F.Optimun Design of Open Pit Mines, CIM Bulletim,

Montreal, Canada, 1965.

132



Ape?ndice A

Walker Lake

Para exemplificar esta tese, sera? utilizado um banco de dados, conhecido pelos geoestat??sticos como

Walker Lake. Este banco de Dados e? derivado de um levantamento digital de altitude de uma

a?rea em Nevada, no oeste dos Estados Unidos. Os dados originais continham 2 milho?es de pontos

em um gride regular (ISAAKS e SRIVASTAVA, 1989, p.4). Estes dados foram transformados em 3

varia?veis cada uma com 78.000 pontos em um gride regular. Existem duas varia?veis cont??nuas, que

foram utilizadas nesta tese (ver figura A.1) e uma varia?vel de indicatriz. As varia?veis V e U, para

nosso caso de minerac?a?o, represetaram seu valor em ppm.

Figura A.1: Banco de Dados de Walker Lake, Varia?vel V (esquerda) e Varia?vel U (direita)

Uma amostragem foi feita no banco de dados, sendo que foram retiradas 470 amostras da

133



Walker Lake

varia?vel V e 275 amostras da varia?vel U, ver figura A.2. A diferenc?a entre o nu?mero de amostras

e? t??pica em uma minerac?a?o, algumas varia?veis sa?o amostradas mais que outras, devido de custos,

falta de recuperac?a?o de massa, novas tecnologias etc.

Figura A.2: Amostragem da Varia?vel V (esquerda) e da Varia?vel U (direita)

Tabela A.1 - Estat??stica da Amostragem

Varia?vel Amostras M??nimo Me?dia Ma?ximo Desvio Padra?o Coef. de Var.

V 470 0.00 436.35 1528.10 299.92 0.69

U 275 0.00 613.27 5190.10 767.32 1.25

Na maioria dos projetos, um outro fator importante e? a correlac?a?o entre varia?veis, pois em alguns

casos, apenas um tipo de mine?rio na?o e? suficiente para pagar todos os custos ou maximizar o valor

da jazida. Por exemplo, e? muito comum uma minerac?a?o produzir cobre e ouro, e a venda dos

dois mine?rios garant??rem o fluxo de caixa positivo. Uma forma de verificar a correlac?a?o entre as

varia?veis e? o gra?fico de dispersa?o (pode ser visto na figura A.3). Para Walker Lake a correlac?a?o

entre as varia?veis V e Ue? de 0.55.

134



Walker Lake

Figura A.3: Correlac?a?o entre as amostras V e U

Outro ponto importante e? que todo projeto de minerac?a?o e? baseado em um modelo de blocos,

que possui um suporte muito maior que uma amostra e todo planejamento da mina e? feito em

sequ?e?ncias de lavra ou paine?is de lavra. Assim, o tamanho de blocos adotado para esta jazida foi de

5 x 5 metros (ver figura A.4).

Figura A.4: Modelo de Blocos Walker Lake, Varia?vel V (esquerda) e Varia?vel U (direita)

135



A.1 Simulac?a?o Gaussiana Sequ?encial Walker Lake

Utilizando o projeto de Walker Lake, para a varia?vel V , foi feito o variograma experimental e o

mesmo foi ajustado conforme ISAAKS e SRIVASTAVA (1998), a vizinhanc?a utilizada foi a mesma

sugerida pelos autores, conforme figura a seguir.

Figura A.5: Ajuste de variograma e vizinhanc?a de Walker Lake

A tabela A.2 mostra as alterac?o?es estat??sticas entre o gride 1x1 e o gride 5x5, ocorridas durante a

reblocagem.

Tabela 3.2 - Estat??stica da mudanc?a de suporte

Varia?vel Blocos M??nimo Q25 Me?dia Q75 Ma?ximo Desvio Padra?o Coef. de Var.

V 1x1 7800 0.00 67.79 277.98 429.34 1631.16 249.84 0.89

V 5x5 3120 0.00 92.81 277.98 414.32 1378.12 228.66 0.82

U 1x1 7800 0.00 6.67 266.04 316.35 9499.51 488.45 1.84

U 5x5 3120 0.00 22.82 266.04 361.87 2844.55 358.80 1.35

A.1 Simulac?a?o Gaussiana Sequ?encial

Considere uma func?a?o aleato?ria Z(•), conhecida com N amostras x?, ? = 1, 2, ...,N. Assume-se

que ha? uma simulac?a?o na?o-condicional S(•) independente de Z(•) com a mesma covaria?ncia de

136



A.1 Simulac?a?o Gaussiana Sequ?encial Walker Lake

Z(•). Uma maneira de condicionar os dados e? atrave?s da krigagem. O princ??pio proposto por

MATHERON, e? muito simples. Sendo Z?(x) chamado de uma estimativa de Z(x) no ponto x

baseado no dado Z(x?), sendo isso o in??cio de um decomposic?a?o:

Z(x) = Z?(x) + [Z(x) ? Z?(x)],

V alor V erdadeiro = EstimativaKrigada + Erro de Krigagem.

O erro de krigagem e? verificado desde que Z(x) seja conhecido. Agora, considere a mesma

igualdade para S(x), onde S?(x) e? uma estimativa da krigagem obtida por simulac?a?o, onde se

conhece somente os pontos amostrais x?:

S(x) = S?(x) + [S(x) ? S?(x)].

Como o valor verdadeiro de S(x) e? conhecido, enta?o o erro S(x) ? S?(x) tambe?m o e?.

Consequ?entemente a ide?ia e? substituir, na decomposic?a?o de Z(x), o erro na?o conhecido por meio

do erro da simulac?a?o, assim temos uma simulac?a?o condicional:

Y (x) = Z?(x) + [S(x) ? S?(x)]

Simulac?a?o Condicional = Estimativa por Krigagem + Erro de Krigagem Simulado.

Desde que a krigagem seja um interpolador exato, para cada amostra tem-se Z?(x?) = Z(x?)

e S?(x?) = S(x?) e tambe?m Y ?(x?) = Z(x?). Como consequ?e?ncia, em termos de covaria?ncia,

Cov(Z(x),Z(x?)) = Cov(Z?(x),Z?(x?))+Cov(Z(x)?Z?(x),Z(x?)?Z?(x?)), desde que Z(x)?Z?(x)

na?o seja correlacionado com Z?(x?) para todo x?. Sendo S e Z independente, a covaria?ncia de T e?

tambe?m a soma das covaria?ncias de Z? tal que S ? S?, igualando-se a isso a Z ? Z?. Logo:

Cov(T(x),T(x?)) = Cov(Z(x),Z(x?)).

A fam??lia de procedimentos sequ?enciais envolve a escolha de um caminho aleato?rio atrave?s

dos no?s da malha a ser simulada; a estimativa de distribuic?a?o de probabilidade condicional local a

137



A.1 Simulac?a?o Gaussiana Sequ?encial Walker Lake

partir dos dados condicionantes e os ja? simulados e, finalmente, sortear um valor desta.

Esses me?todos sequ?enciais, propostos por JOURNEL e ALABERT (1989,1990) sa?o uma

aplicac?a?o do teorema de Bayes. Os n eventos dependentes Ai, i = 1, ...,n podem ser simulados

sequ?encialmente usando a expressa?o:

P(A1,A2, ...,An) = P(An|A1, ...,An?1).P(An?1|A1, ...,An?2)...P(A2|A1).P(A1)

P {zM+1 ? ZM+1 + dzM+1, ...,zN ? ZN &amp;lt;zN + dzN|z1, ...,zM}

= P {zM+1 ? ZM+1 &amp;lt;zM+1 + dzM+1|z1, ...,zM}

×P {zM+2 ? ZM+2 &amp;lt;zM+2 + dzM+2|z1, ...,zM,zM+1}

•

•

•

P {zN ? ZN &amp;lt;zN + dzN|z1, ...,zM,zM+1,zN?1} .

A te?cnica requer a infere?ncia de n?1 sucessivas distribuic?o?es de probabilidade condicionais, por

meio de uma transformac?a?o Gaussiana. O algoritmo de simulac?a?o Gaussiana sequ?encial consiste

dos seguintes passos:

1. transformar os dados condicionantes em valores Gaussianos padra?o;

2. calcular e modelar o variograma dos dados condicionantes transformados;

3. definir um caminho aleato?rio atrave?s de todos os pontos da malha de simulac?a?o;

4. em cada ponto da malha, krigar um valor baseado em outros valores (condicionantes e ja?

simulados);

138



A.1 Simulac?a?o Gaussiana Sequ?encial Walker Lake

5. o valor krigado e a varia?ncia de krigagem associada, sa?o os para?metros da distribuic?a?o

Gaussiana condicional no ponto da malha, dado os dados condicionantes e os valores

previamente simulados. Sorteia-se um nu?mero aleato?rio dessa distribuic?a?o e o adiciona ao

conjunto dos valores simulados;

6. retornar ao passo 4 ate? que os valores sejam simulados em todos os pontos da malha;

7. aplicar a transformac?a?o inversa nos valores Gaussianos simulados condicionalmente.

As maiores vantagens desse me?todo sa?o: a) o condicionamento e? parte integrante da simulac?a?o

e na?o um passo separado; b) as anisotropias sa?o manuseadas automaticamente, pode ser aplicado

a qualquer func?a?o de covaria?ncia; c) requer apenas um algoritmo de krigagem eficiente (com busca

de vizinhanc?a mo?vel).

O variograma para a varia?vel V simulada, pode ser visto na pro?xima figura, os para?metros

utilizados para o ajuste do modelo foram rotac?a?o de 14 graus da direc?a?o noroeste, onde foi ajustado

um efeito pepita de 0.067. Duas estruturas esfe?ricas foram ajustadas, sendo a primeira ( 30.00m,

18.00m, 18.00m) e a segunda ( 78.00m, 36.00m, 36.00m). Com os respectivos patamares: 0.51 e 0.42.

Figura A.6: Variograma Ajustado para Simulac?a?o Gaussiana Sequ?encial

Foi utilizada uma vizinhanc?a de 42 x 42 metros, onde o nu?mero ma?ximo de dados escolhido

139



A.1 Simulac?a?o Gaussiana Sequ?encial Walker Lake

para a simulac?a?o de um bloco foi de 16, onde 12 desdes, poderiam advir da simulac?a?o. A semente

utilizada foi 54760341. Foram feitas 100 simulac?o?es no programa Isatis.

Figura A.7: Exemplo de algumas simulac?o?es gaussianas sequ?enciais de Walker Lake

140



Ape?ndice B

Distribuic?o?es emp??ricas

Para simular dados multivariados dependentes, usando co?pulas, e? necessa?rio especificar os

seguintes para?metros:

1. A fam??lia de co?pulas (e? o para?metro da forma);

2. O rank de correlac?a?o entre as varia?veis;

3. A distribuic?a?o marginal para cada varia?vel.

Tendo dois conjuntos de dados reais, (Ferro e S??lica de uma jazida de ferro) e tendo como

objetivo rodar uma simulac?a?o de Monte Carlo com entradas que seguem a mesma distribuic?a?o dos

conjuntos. (os dois vetores possuem o mesmo nu?mero de dados, mas isto na?o e? necessa?rio).

Pode-se ajustar um modelo parame?trico separado para cada conjunto de dados e usa?-los como

sendo as distribuic?o?es marginais. Contudo, um modelo parame?trico talvez na?o seja suficientemente

flex??vel. Enta?o, em vez disso, pode-se usar um modelo emp??rico para as distribuic?o?es marginais. So?

necessita-se de uma maneira de calcular a inversa da distribuic?a?o func?a?o cumulada.

A func?a?o emp??rica inversa acumulada para esse conjuntos de dados e? exatamente a func?a?o

escada, com passos de 1/No. observac?o?es., 2/ No. observac?o?es, ..., 1. A altura dos passos e?

simplesmente os dados ranqueados, ver Figura B.1.

141



Distribuic?o?es emp??ricas

Figura B.1: Func?a?o Emp??rica dos Dados

Para as simulac?o?es devemos experimentar diferentes co?pulas e correlac?o?es. Usaremos aqui uma

co?pula bivariada lognormal com um coeficiente de correlac?a?o igual a -0.60, correspondente aos

dados de entrada, ver Figura B.2.

Figura B.2: Histograma das amostras e dos dados simulados

Foram simuladas 10.000 valores. Os resultados estat??sticos podem ser vistos na tabela B.1,

juntamente com os respectivos histogramas dos dados originais e dos simulados.

142



Distribuic?o?es emp??ricas

Tabela B.1 - Estat??sticas da Simulac?a?o

Estat??stica Dados de Entrada Simulac?a?o

Nu?mero de Dados 828 10.000

Me?dia Ferro 66.50 66.51

Me?dia S??lica 1.377 1.373

Varia?ncia Ferro 3.0234 3.0304

Varia?ncia S??lica 1.1627 1.2053

As simulac?o?es, na geoestat??stica, sa?o geradas atrave?s de func?o?es aleato?rias, condicionadas

a?s leis espaciais multigaussianas. Isto significa que todas as combinac?o?es lineares seguem uma

distribuic?a?o gaussiana, sendo que o problema do condicionamento dos dados foi resolvido

pela krigagem e pela varia?ncia de krigagem. Previamente a varia?vel regionalizada deve ser

transformada em uma varia?vel marginal gaussiana.

As distribuic?o?es multigaussianas sa?o extremamentes co?modas na utilizac?a?o, pois dependem

apenas dos momentos de 1a e 2a ordem ( Esperanc?a Condicional e Covaria?ncia) o que facilita a

infere?ncia estat??stica. Pore?m, isto acarreta va?rias restric?o?es, entre elas, a dificuldade de se conseguir

a anamorfose gaussiana, quando o histograma da varia?vel regionalizada e? fortemente dissime?trico

ou apresenta uma proporc?a?o importante de valores extremos.

Este me?todo de simulac?a?o abre caminho para resoluc?o?es de alguns problemas da geoestat??stica,

principalmente na a?rea da geoestat??stica na?o-linear, onde pode ser vastamente aplicada.

143



Distribuic?o?es emp??ricas

Figura B.3: Gra?fico de dispersa?o das amostras (esquerda acima), da simulac?a?o (direita acima),
Esperanc?a Condional (esquerda abaixo)e todos (direta abaixo)

A Figura B.3 mostra a dispersa?o da simulac?a?o. Note que nesse caso foi feita uma simulac?a?o

com apenas duas varia?veis, mas a metodologia na?o se restringe a dados bivariados. Em termos de

esperanc?a condicional, verifica-se que os resultados sa?o muito pro?ximos, tornando a simulac?a?o na?o

enviesada, apesar dos valores altos correlacionados com valores baixos.

144



Ape?ndice C

Comparac?a?o entre Distribuic?o?es

Considere duas varia?veis aleato?rias X e Y positivas (esta restric?a?o na?o e? essencial), e designadas

por FX, FY , TX, TY , etc. As diversas func?o?es esta?o condicionadas a estas varia?veis.

Parece bastante natural dizer que a lei de FX e? melhor que a lei de FY , na minerac?a?o, se:

QX(T) ? QY (T)paratodoo ? E(O, 1).

ou se VX(z) ? VY (z) para todo o z ? 0.

Estas duas definic?o?es sa?o equivalentes:

QX ? QY (=)VX ? VY

Isto e? suficiente para usar as fo?rmulas de dualidade (ver MATHERON, 1981) entre as func?o?es de

V e Q: ??????
?????

V (z) = Sup
T

(Q(T) ? zT)

Q(T) = Inf
z

(V (z) ? zT)

Por exemplo, suponha que QY ? QX. Enta?o, para todo T e todo z:

QY (T) ? zT ? QX(T) ? zT ? Sup
T

QX(T) ? zT) = VX(z).

Por consequ?e?ncia:

VY (z) = Sup
T

QY (T) ? zT) ? VX(z).

145



Comparac?a?o entre Distribuic?o?es

Assim QY ? QX requer que VY ? VX e a rec??proca e? demonstrado, da mesma maneira.

A relac?a?o de ordem, FX mais seletivo que FY , na geoestat??stica mineira, esta? demonstrada

especialmente entre distribuic?o?es de mesmo momento, que e? a comparac?a?o de presente interesse.

Para dizer que a lei de FX e? mais seletiva que a lei de FY , a condic?a?o necessa?ria e?:

E(X) = E(Y ) eVX ? VY (ou QX ? QY ). (C.1)

Uma condic?a?o necessa?ria e suficiente, para que a lei de FX seja mais seletiva que a lei de FY e?

que E[?(X)] ? E[?(Y )], isso significa:

?
?(x)FX(dx) ?

?
?(y)FY (dy). (C.2)

Para toda func?a?o convexa ?.

Realmente, toda a func?a?o convexa em R+ adquire a forma abaixo:

?(x) = a + bx +
? x

0
(x ? t)µ(dt)

Para uma medida positiva µ em R+. Enta?o, para a varia?vel aleato?ria X, tem-se (MATHERON,

1981):

E [?(x)] = a + bE(X) +
? ?

0
FXdx

? ?
0

(x ? t)µ(dt)

= a + bE(X) +
? x

0
VX(t)µ(dt).

Inversamente, tendo ?(x) = bx, vee?m bE(X) ? bE(Y ). Como b pode ser positivo ou negativo,

enta?o E(X) = E(Y ). Levando enta?o ?(x) = (x?x0)+, a relac?a?o de VX(x0) ? VY (y0), enta?o a u?ltima

equac?a?o e? verdadeira.

146



C.1 Efeito Suporte Comparac?a?o entre Distribuic?o?es

C.1 Efeito Suporte

Sera? apresentado aqui um exemplo simples, feito por MATHERON, mas seu entendimento e?

muito importante para a compreensa?o do efeito suporte. Sendo Z(x),x ? Rn uma func?a?o

aleato?ria (estaciona?ria ou na?o), ? =
?
wi de um painel constituiu da reunia?o blocos disjuntos wi.

Considerando o volume de ? como unidade seletiva de volume, designando ?i como o volume do

bloco wi, de forma que
?
?i = 1.

Sendo Y um valor mediano de Z(x) no volume ? e o mesmo para Xi de Z(x) no bloco wi, de

forma que esta func?a?o aleato?ria possa ser expressa pela seguinte equac?a?o:

Y =
?

?iXi. (C.3)

Como o ?i constitui a probabilidade no espac?o indexada, chamando esta func?a?o aleato?ria com

Pr(I = i) = ?i e por X = XI de uma varia?vel aleato?ria composta, obtida pela substituic?a?o de I em

i em Xi (aleatoriamente i). tem-se a esperanc?a condicional de X em relac?a?o Y :

E(X|Y ) =
?

?iE(Xi|Y ).

E, como consequ?e?ncia, tem-se a seguinte relac?a?o:

E(X|Y ) = Y.

Isto resulta que a lei de X (lei dos blocos) e? mais seletiva que a lei de Y (lei dos paine?is). Este

feno?meno, fundamental na geoestat??stica, e? conhecido como efeito suporte.

Realmente, para toda func?a?o convexa ? e toda lei de probabilidade de F , tem-se:

?

[?
zF(dz)

]
?
?
?(z)F(dz)

Em particular, aplicando a lei condicional de X:

?(Y ) = ? [E(X|Y )] ? E [?(X)|Y ] .

147



C.1 Efeito Suporte Comparac?a?o entre Distribuic?o?es

Levando a esperanc?a para dentro da equac?a?o, obtem-se:

E [?(Y )] ? E [?(X)] .

Isto significa exatamente que FX e? mais seletivo que FY .

A relac?a?o de ordem FX e? mais disperso que FY . Geralmente, a lei de FX se deduz pela

dispersa?o de uma lei de FY , pode-se achar uma lei de duas varia?veis F(dx,dy) admitindo para

as leis marginais de FX e FY tal que:

E(X|Y ) = Y.

Isto e? o mesmo que dizer que para FY todo y pode ser achado com uma probabilidade de

transic?a?o de Py(dx) verificando a condic?a?o barice?ntrica:

?
xPy(dx) = y.

Por consequ?e?ncia,

?
FY (dy)Py(A) = FX(A)

Para todo o boreliano de A. Debaixo desta forma markoviana, e? suficiente para verificar que a

relac?a?o: FX e? mais dispersa que FY sendo uma relac?a?o de ordenamento.

No exemplo pre?vio, a lei dos blocos apresenta-se mais dispersa que a lei dos paine?is. Enta?o,

pode-se dizer que FX e? mais disperso que FY , enta?o FX e? mais seletivo que FY . Segundo

MATHERON (1981), o rec??proco e? verdade (e ate? mesmo em espac?os vetoriais mais gerais que R).

Este teorema muito importante e? chamado de teorema de Cartier (cuja demonstrac?a?o encontra-se

d’Alfsen, sobre espac?os compactos convexos). Assim:

Uma lei de FX e? mais seletiva que uma lei de FY se e somente se FX pode ser deduzido pela

148



C.2 Efeito Informac?a?o Comparac?a?o entre Distribuic?o?es

dispersa?o de FY .

Ou seja, tem-se E?(X) ? E?(Y ) para toda func?a?o convexa ?(EX = EY e VX ? VY ), se e

somente se pode-se deduzir a lei das duas varia?veis F(dx,dy) admitindo as marginais FX e FY e

tendo como E(X|Y ) = Y .

C.2 Efeito Informac?a?o

O efeito informac?a?o e? outro problema, tambe?m inspirado da pra?tica mineira. Qualquer varia?vel

aleato?ria Y pode representar o conteu?do de um bloco, a decisa?o de selecionar ou na?o, pode ser

representada por Xi, i = 1, 2...n que sa?o os teores das amostras na qual se tomou a escolha. O teor

de corte y e? definido com crite?rios que buscam escolher um boreliano em Rn e selecionar os blocos

se (X1...Xn) ? A, e rejeitar, caso contra?rio. Entre todos os borelianos A poss??veis, o melhor, para o

teor de corte e? o boreliano Ay do que alcanc?a o Sup de:

E [(Y ? y) IA] =
?
A
E

[
(Y ? y)
x1, ...,xn

]
F(dx1, ...,dxn).

Ou F(dx1, ...,dxn) e? uma lei multivariada de Xi. Pode-se, abreviar:

h(x1, ...,xn) = E(Y |X1 = x1, ...,xn = Xn).

Enta?o:

E [(Y ? y) IA] =
?
A
E(h(x) ? y)F(dx1, ...,dxn)

Enta?o o boreliano Ay:

A+y = {h(x) ? y} e A
?
y = {h(x) &gt; y}

Pode-se trabalhar com estas quantidades como sendo uma varia?vel aleato?ria:

H = h(X1, ...,Xn) = E(Y |X1, ...,Xn).

149



C.2 Efeito Informac?a?o Comparac?a?o entre Distribuic?o?es

Realmente, esta? varia?vel H leva a? uma o?tima selec?a?o, e a func?a?o VH(y) = E((H ? y)+) representa

bem o valor ma?ximo recupera?vel para um dado teor de corte. Da mesma maneira, para as

tonelagens e as quantidades de metal:

T?H (y) = E(IH&gt;y) ; T
+
H (y) = E(IH?y)

Q?H(y) = E(HIH&gt;y) = E(Y IH&gt;y)

Q+H(y) = E(HIH?y) = E(Y IH?y).

Isto, esta? de acordo com a mesma definic?a?o da esperanc?a condicional de H. Da mesma maneira,

tem-se T ? (0, 1), a func?a?o QH(T) representando o metal recupera?vel para uma tonelagem T dada.

Como H e? uma esperanc?a condicional, tem-se E(H) = E(Y ) = m0. Isto comprova que a varia?vel

H e? menos seletiva que Y , resta verificar se VY ? deVH. Mas e? o?bvio, desde que VY (y0) alcance o

Sup de:

?
B

(y ? y0)F(dy,...,dxn)

Tem-se o boreliano de B no Rn + 1, de onde resulta:

VY (y0) ?
?

R X A
(y ? y0)F(dy,...,dxn)

=
?
A

(y ? y0)?y0F(dy,...,dxn)

Para todo o boreliano de R, e por continuac?a?o com A = Ay:

VY (y0) ? VH(y0).

Pode-se notar que a mesma definic?a?o de H = E(Y |X1, ...Xn) e? ide?ntica a E(Y |H) = H. Assim a lei

FH e? mais dispersa e mais seletiva que Fy.

Assim, a varia?vel H e? sempre menos seletiva que Y . Este feno?meno leva o nome de efeito de

informac?a?o: a selec?a?o indireta (i.e, a selec?a?o foi feita nos teores das amostras de Xi e na?o nos teores

de Y , sendo as mesmas) sempre tem o efeito de danificar as func?o?es V (y) e Q(T).

150



C.3 Exemplo Teo?rico Comparac?a?o entre Distribuic?o?es

C.3 Exemplo Teo?rico

Sendo Y o teor de um painel e X o de uma amostra quase pontual ( suponha que esta amostra foi

implantada aleatoriamente dentro do decorrente painel, de acordo com uma lei uniforme), de forma

que FX seja mais seletivo que FY . Sendo H = E(Y |X) a esperanc?a condicional de Y em relac?a?o a

X, tem-se que FY e? mais seletivo que FH, ou simbolicamente:

FX ? FY ? FH.

A primeira desigualdade representa o efeito de suporte e a segunda o efeito informac?a?o.

Analisando ingenuamente (ignorando a geoestat??stica). Sendo y0 o teor de corte (inserido por meio

do qual as despesas de tratamento sa?o pagas e se obtem o lucro com a venda do valor contido).

A selec?a?o dos paine?is para os quais a amostra correspondente possui X ? y0 ( ou X &gt; y0),

espera-se recuperar a tonelagem de TX(y0) e o metal QX(y0) e o valor VX(x0). Para a tonelagem,

esta esperanc?a e? razoa?vel, mas na?o o e?, para nenhuma das outras duas func?o?es. Enta?o Matheron

convencionou isto como iluso?rio. ???????????
??????????

Till(y0) = TX(y0)

Qill(y0) = QX(y0)

Vill(y0) = VX(y0)

A quantidade efetivamente recuperada (a partir de um crite?rio ruim) sera?:

Teff (X ? y0) = TX(y0)

Qeff (X ? y0) =
?
X?y0

h(x)FX(dx)

Veff (X ? y0) =
?
X?y0

(h(x) ? y0)FX(dx).

Nota-se imediatamente que:

Veff (X ? y0) ? VH(y0).

151



C.3 Exemplo Teo?rico Comparac?a?o entre Distribuic?o?es

Porque:

VH(y0) = Sup
A

?
A

(h(x) ? y0)FX(dx).

Para descrever a fam??lia boreliana do eixo x: A = x ? y0, vinda da desigualdade anterior.

Na ause?ncia do efeito informac?a?o (isso significa se o teor Y fosse conhecido e se a selec?a?o fosse

Y ? y0) a obtenc?a?o das melhores relac?o?es tonelagem/teor poss??veis, e? feita atrave?s do ca?lculo do

efeito suporte. Isto e? um ideal inacess??vel na pra?tica, que pode ser expresso pelas equac?o?es:???????????
??????????

Tid(y0) = TY (y0)

Qid(y0) = QY (y0)

Vid(y0) = VY (y0)

Considerando o fato que se conhece somente X e na?o Y (efeito informac?a?o), as melhores

pol??ticas consistem em cortar H ? y0, onde H = h(X) = E(Y |X). Esta pol??tica de otimizar leva a:

Topt(y0) = TH(y0) =
?
h(x)?y0

FX(dx)

Qopt(y0) = QH(y0) =
?
h(x)?y0

h(x)FX(dx)

Vopt(y0) = VH(y0) =
?
h(x)?y0

(h(x) ? y0)FX(dx)

Que e? o melhor que se pode obter em uma situac?a?o real. As desigualdades seguintes sa?o

ineluta?veis:

Veff (y0) ? Vopt(y0) ? Vid(y0) ? Vill(y0).

A primeira desigualdade expressa simplesmente que h(X) ? y0 sendo o melhor crite?rio poss??vel

quando so? conhecido o teor de X. A perda correspondente Vopt ? Veff e? o resultado da ma? escolha

baseada nos crite?rios de X ? y0: isto na?o deve ser feito. A segunda desigualdade representa o efeito

152



C.3 Exemplo Teo?rico Comparac?a?o entre Distribuic?o?es

de informac?a?o (FY e? mais seletivo que FH), e o terceiro e? o efeito suporte (FX e? mais seletivo que FY ).

Eliminando o para?metro y0 de maneira que a func?a?o Q(T) correspondente, tem-se: Qeff (T)

sera? igual Qopt(T), consequ?entemente se a func?a?o h(x) e? crescente em x: se h(x) e? crescente, tem-se

efetivamente:

Topt(y0) = Teff (y1)Qopt(y0) = Qeff (y1).

Para h(yl) = y0: estes sera?o os mesmos paine?is que sera?o selecionados, mas com cortes

diferentes. Portanto tem-se:

Qopt(T) ? Qid(T) ? Qill(T)

Pelas mesmas razo?es (seletividade crescente das varia?veis H,Y e X).

Caso Lognormal

Para ilustrar isto, suponha que X e Y sejam varia?veis lognormais como a me?dia m0 e sendo ?2X

e ?2Y as varia?ncias de logX e logY . A condic?a?o E(X|Y ) = Y mostra que o coeficiente de correlac?a?o

deve ser:

? =
?Y
?X

.

Que implica que: ?2Y ? ?
2
X. Enta?o:

h(x) = E(Y |X) = m0
x

m0

?2

e
1
2
?2

Y
(1??2 )

Assim, se H e? lognormal, com esperanc?a m0 e seu logaritmo admite varia?ncia:

?2H = ?
4?2X = ?

2?2Y .

Sendo, ?2H ? ?
2
Y ? ?

2
X, que traduz o efeito informac?a?o e o efeito de suporte.

153



C.4 Func?o?es de Perdas Comparac?a?o entre Distribuic?o?es

Para um teor de corte y0, tem-se:

z =
1
?
log

y0
m0

+
1
2
?.

z tera? ao memso ??ndice H, Y ou X que ? e as func?o?es opt, id e ill, tera?o a mesma forma.

T?(y0) = 1 ? G(z?)

Q?(y0) = m0[1 ? G(z? ? ??)]

V?(y0) = Q?(y0) ? y0T?(y0).

A indicac?a?o * substitui opt, id e ill. Teff (y0) e Qeff (y0) coincidem com Topt(y1) e Qopt(y1) com

Y1 tendo h(y1) = y0.

C.4 Func?o?es de Perdas

A selec?a?o de uma u?nica estimativa com um alcance de poss??veis valores de z, requerem um

crite?rio de avaliac?a?o. Um crite?rio comum e? minimizar o impacto anexado a? estimativa do erro

e(x) = z?(x) ? z(x) que provavelmente ocorre. A esta func?a?o e? dado o nome de Func?a?o de

Perda L(.), onde L(e(x)) = [e(x)]2. Sendo que esta, minimiza o resultado da perda z?
L(x)

que e?

aproximadamente L(z?(x)?z(x)). A determinac?a?o da perda L(z?(x)?z(x)) requer o valor de z(x),

o qual na?o e? conhecido na pra?tica. Portanto, a incerteza sobre z(x) e? modelada por uma func?a?o

densidade acumulativa condicional (ccdf) F(x; z|(n)), que e? avalia?vel. A ide?ia de se usar o modelo

de incerteza e? determinar a esperanc?a da perda:

?L(z ? (x)|(n)) = E{L(z ? (x) ? Z(x)}

=
? +?
?? L(z ? (x) ? z) dF(x; z|(n))

154



C.4 Func?o?es de Perdas Comparac?a?o entre Distribuic?o?es

Na pra?tica, usa-se a discreta aproximac?a?o:

?L(z ? (x)|(n)) '
K+1?
k=1

L(z ? (x) ? zk) · F(x; zk|(n)) ? F(x; zk?1|(n)) (C.4)

Onde zk e? o valor de k do corte discretizado pelo o alcance da variac?a?o do valor de z, por

convenc?a?o, F(x; z0|(n)) = 0 e F(x; zk?1|(n)) = 1. Os outros cortes de zk podem ser identificados

com os p-quartiles correspondentes a um espac?o regularizado de uma ccdf, zk = F?1(x; k/[K +

1]|(n)). Sendo zk definido como a me?dia na classe (zk?1,zk] que depende do modelo de interpolac?a?o,

por exemplo, para o modelo linear, zk = (zk?1 + zk)/2.

A o?tima estimativa da func?a?o de perda L(.) do valor de z e? minimizada pela esperanc?a de perda:

z?L(x) e? semelhante tal que ?L(z
?(x)|(n)) e? m??nimo.

A determinac?a?o da o?tima estimativa procede atrave?s de dois passos:

1. A incerteza sobre o valor na?o conhecido de z(x) no primeiro modelo atrave?s do

condicionamento de uma cdf .

2. Atrave?s de um modelo, a estimativa e? deduzida de acordo com um crite?rio especifico de busca

do o?timo.

O acesso a? incerteza e a estimativa claramente mostram que na?o ha? a melhor estimativa para

todas as situac?o?es. Uma boa estimativa depende da intenc?a?o do uso. Um modelo de incerteza pode

ser obtido dependendo da func?a?o de perda escolhida.

C.4.1 Estimativa por E-Type

Considere primeiramente o crite?rio dos m??nimos quadrados, que e? a perda modelada pela func?a?o

quadra?tica de qualquer erro de subestimativa e superestimativa:

L(e(x)) = [e(x)]2 (C.5)

A estimativa o?tima e? mostrada como o valor esperado da ccdf na localizac?a?o x, tambe?m chamado

155



C.4 Func?o?es de Perdas Comparac?a?o entre Distribuic?o?es

de estimativa E-type, vindo da relac?a?o:

z?L(x) = z
?
E(x) '

k+1?
k=1

z?K · [F(x; zK|(n) ? F(x; zK?1|(n)] (C.6)

As estimativas por E-Type e (co)krigagem sa?o usualmente diferentes, embora o?timos para o

crite?rio dos m??nimos quadrados. Essa diferenc?a esta? na cdf vinda para a estimativa do E-Type que

deriva dos valores dos dados. Uma excec?a?o ocorre quando o valor original z sa?o normalmente

distribu??dos e sua ccdf e? modelada usando uma aproximac?a?o multigaussiana. Em todas outras

situac?o?es, a vantagem da estimativa do E-Type e? avaliar a incerteza sobre o erro das zonas mais

ricas do que a varia?ncia da krigagem.

O quadrado da estimativa do erro na expressa?o anterior (L(e(x)) = [e(x)]2), os valores extremos

do erro, tendem a ter um grande impacto sobre a esperanc?a de perda. Assim, a estimativa E-Type,

pode exceder, dependendo do modelo de subida ou descida da cauda da distribuic?a?o F(x; z|(n)).

C.4.2 Estimativa pela Mediana

Usando a func?a?o linear da estimativa do erro, que e? uma func?a?o quadra?tica, reduz-se o impacto

do modelo da cauda na expectativa da perda. Por exemplo, a perda pode ser modelada em uma

proporc?a?o absoluta da estimativa do erro:

L(e(x)) = |e(x)| (C.7)

O crite?rio da o?tima estimativa do desvio absoluto da me?dia e? a mediana da ccdf:

z?L(x) = q0.5(x) = F
?1(x; 0.5|(x)) (C.8)

O valor da mediana usualmente na?o e? afetado pela escolha de um modelo particular de

extrapolac?a?o de subida de cauda.

C.4.3 Estimativa Inter Quartis

Semelhante a? func?a?o de perda sime?trica, esta penaliza a subestimativa e superestimativa

igualmente, em muitas aplicac?o?es, a perda e? assime?trica. Para a tomada destas deciso?es claramente,

156



C.4 Func?o?es de Perdas Comparac?a?o entre Distribuic?o?es

por exemplo, o impacto da subestimativa em concentrac?o?es to?xicas e? provavelmente maior que

uma superestimativa de igual amplitude.

Considere a seguinte assimetria linear da func?a?o de perda:

L(e(x)) =

??????
?????

w1 · e(x) para e(x) ? 0 (Superestimativa)

w2 · |e(x) | para e(x) &amp;lt;0 (Sub ? estimativa)

(C.9)

Onde os para?metros w1 e w2 sa?o relativos ao impacto anexado a superestimativa e subestimativa,

respectivamente. A o?tima estimativa e? mostrada pelo p-quartil da ccdf (Journel,1984).

z?L(x) = qp(x) = F
?1(x; p|(n))

onde p = w1
w1+w2

? [0, 1]

Podem ser distingu?idos tre?s casos:

1. w1 = w2 Uma func?a?o linear sime?trica, e? a o?tima estimativa do 0.5 quartil, ou seja, a mediana

previamente discutida.

2. w1 &gt; w2 O impacto da superestimativa e? maior que o da subestimativa de mesma magnitude.

Assim, p¡0.5, a o?tima estimativa e? menor que a mediana (uma conservativa escolha para

detecc?a?o de deficie?ncias). Considere uma assime?trica func?a?o de perda, onde w1=0.9 e w2=0.1.

O quartil e? estimado pela interpretac?a?o do valor de corte de 90% da probabilidade de exceder

o valor na?o conhecido:

PrZ(x) &gt; q0.1(x)|(n) = 0.9

Uma grande estimativa de q 0.1(x) indica que o valor na?o conhecido e? certamente maior que

o da localizac?a?o x.

3. w1 &amp;lt;w2 O impacto da superestimativa e? menor que o da subestimativa de mesma

magnitude. Assim, p &gt; 0.5, a o?tima estimativa e? maior que a mediana. O quartil e?

157



C.4 Func?o?es de Perdas Comparac?a?o entre Distribuic?o?es

estimado pela interpretac?a?o do valor de corte de 10% da probabilidade de exceder o valor

na?o conhecido:

PrZ(x) &gt; q0.1(x)|(n) = 0.1

Uma pequena estimativa de q 0.9(x) indica que o valor na?o conhecido e? certamente menor que

o da localizac?a?o x.

Incrementando o contraste entre o relativo impacto w1 e w2 na estimativa dos campos de

quartiles correspondentes, ha? um ajuste na probabilidade acumulativa muito pequena ou muito

grande.

158



Ape?ndice D

Fluxograma da Metodologia da Tese

Figura D.1: Fluxograma da metodologia aplicada para a correc?a?o das curvas de parametrizac?a?o

159



Ape?ndice E

Co?digo Fonte

%########################################################################%
%## UNIVERSADE ESTADUAL DE CAMPINAS -UNICAMP ##%
%## INSTITUTO DE GEOCIENCIAS ##%
%## DEPARTAMENTO DE GEOLOGIA E RECURSOS NATURAIS ##%
%##--------------------------------------------------------------------##%
%## Autor : Frederico Augusto Rosa do carmo ##%
%## Orientador : Armando Zaupa Remacre ##%
%##--------------------------------------------------------------------##%
%## RESERVA_COPULAS_2006 ##%
%########################################################################%
% Entrada ASCII dos Furos de Sonda ---------------------------------------
clear all;
valida_cruz; %Arquivo com os dados em uma tabela -------------------------
Var_1 = V;
Val_C = Cross_V;
n2A= length(Val_C);
% Corrige valores negativos da ValidaA?§ao Cruzada -------------------------
for i=1: n2A

if Val_C(i)&lt;0
Val_C(i)=0;

end
end
%------------------------------------------------------------------------
krig5x5_2; % Busca no Isatis Valores Krigados ---------------------------
fid = fopen(’C:\Frederico\ISATIS\WALKER LAKE\GTX\DIRE.2\FILE.2\ ...

VARI.12/datavar’,’r’,’b’);
AMOSTRAS=fread(fid,[dx*dy],’float’);
fclose(fid);
fid = fopen(’C:\Frederico\ISATIS\WALKER LAKE\GTX\DIRE.2\FILE.2\ ...

VARI.14/datavar’,’r’,’b’);
VCAMOST=fread(fid,[dx*dy],’float’);
fclose(fid);
% Procurando lugares onde existem amostras-------------------------------
AMOST_5X5=AMOSTRAS(find(AMOSTRAS&lt;100000)); % Amostras para o bloco -----

160



Co?digo Fonte

KAMOS_5X5=V1_Est(find(AMOSTRAS&lt;100000)); % Krigagem para a amostra ----
VAMOS_5X5=VCAMOST(find(AMOSTRAS&lt;100000)); % ValidaA?§ao das Amostras -----

%------------------------------------------------------------------------
t = cputime;
nobs =size(Var_1,1);
% Transformando os dados em Variaveis Normais ...........................
[NS_AMOST,o_nscore1]=nscore(Var_1,2,2,0,1600);
[NS_VC,o_nscore2]=nscore(Val_C,2,2,0,1600);
[NS_EST,o_nscore3]=nscore(V1_Est);
[NS_AMOST_5X5,o_nscore4]=nscore(AMOST_5X5);
[NS_VAMOS_5X5,o_nscore5]=nscore(VAMOS_5X5);
[NS_KAMOS_5X5,o_nscore6]=nscore(KAMOS_5X5);

% Relacionamento entre as Variaveis -------------------------------------
Sig1 =corrcoef(NS_AMOST_5X5,NS_KAMOS_5X5);
Sig2 =corrcoef(NS_AMOST_5X5,NS_VAMOS_5X5);
Sig3 =corrcoef(NS_AMOST,NS_VC);
Sig = [ 1 Sig1(2,1) Sig2(2,1);Sig1(2,1) 1 Sig3(2,1);...

Sig2(2,1) Sig3(2,1) 1];
% verificando as diferenA?§as entre amostras e Val cruz e Krigagem.........
s_origdata=sort(o_nscore4.d);
id=find(˜isnan(o_nscore4.normscore));
PAMOST = interp1(o_nscore4.normscore(id),o_nscore4.d(id),...

o_nscore3.normscore,’pchip’);
s_origdata=sort(o_nscore5.d);
id=find(˜isnan(o_nscore5.normscore));
PAVC = interp1(o_nscore5.normscore(id),o_nscore5.d(id),...

o_nscore3.normscore,’pchip’);
o_nscore7=o_nscore3;
% .......................................................................
[DA P1]=sort(PAMOST);
[DVC P2]=sort(PAVC);
[DK P3]=sort(o_nscore3.d);
dumm1 = DVC-DA;
dumm2 = sort(o_nscore3.d)-dumm1;
o_nscore7.d(P3) =dumm2(P3);
%........................................................................
L= mvnrnd( [0 0 0] , Sig , n );
X = [inscore(L(:,1),o_nscore7) inscore(L(:,2),o_nscore3) ...

inscore(L(:,3),o_nscore3)];
%........................................................................
e = cputime-t
% ParametrizaA?§ao de Reservas -------------------------------------------
Paramet_Rsv
% Otimizador de Cavas --------------------------------------------------
Otimizador

161



Co?digo Fonte

%Sequenciamento de Cava ------------------------------------------------
[SeqEst,fcEst,recEst,recRReal,fcREf,qaz]=SequencKrig(mascEst, ...

cavaEst,dx,dy,Bver);
[SeqR,fcR,recR,recRReal,fcRReal]=SequencReal(mascVer,cavaVer, ...

dx,dy,Bver);
%########################################################################%
%## UNIVERSADE ESTADUAL DE CAMPINAS -UNICAMP ##%
%## INSTITUTO DE GEOCIENCIAS ##%
%## DEPARTAMENTO DE GEOLOGIA E RECURSOS NATURAIS ##%
%##--------------------------------------------------------------------##%
%## Autor : Frederico Augusto Rosa do carmo ##%
%## Orientador : Armando Zaupa Remacre ##%
%##--------------------------------------------------------------------##%
%## Sub-rotina: Paramet_Rsv ##%
%########################################################################%
vr =V1_Ver;
vr2=V1_Est;
vr3 =X(:,2);
vr4=X(:,1);
cl= [floor(min(vr)):((round(max(vr))-floor(min(vr)))/50):round(max(vr))];
ncl = length(cl) ;
zmax = max(vr);

for i=1:ncl-1,
% Variavel Real------------------------------------------------------
iaux = find(vr &gt;=cl(i));
TonVer(i) = length(iaux);
QminVer(i) = sum(vr(iaux));
TMVer(i) = mean(vr(iaux));
% Variavel Estimada -------------------------------------------------
iaux2 = find(vr2 &gt;=cl(i));
TonEst(i) = length(iaux2);
QminEst(i) = sum(vr2(iaux2));
TMEst(i) = mean(vr2(iaux2));
TMEstEf(i) = mean(vr(iaux2));
QminEstEf(i) = sum(vr(iaux2));
% Variavel Real------------------------------------------------------
iaux = find(vr3 &gt;=cl(i));
TonVer2(i) = length(iaux);
QminVer2(i) = sum(vr3(iaux));
TMVer2(i) = mean(vr3(iaux));
% Variavel Estimada -------------------------------------------------
iaux2 = find(vr4 &gt;=cl(i));
TonEst2(i) = length(iaux2);
QminEst2(i) = sum(vr4(iaux2));
TMEst2(i) = mean(vr4(iaux2));
% Minerio classificado como Esteril ---------------------------------

162



Co?digo Fonte

iaux3 = find(vr &gt;=cl(i) &amp;amp; vr2&lt;=cl(i));
TonMcE(i) = length(iaux3);
QminMcE(i) = sum(vr(iaux3));
% Esteril classificado como Minerio ---------------------------------
iaux4 = find(vr2&gt;=cl(i) &amp;amp; vr&lt;=cl(i));
TonEcM(i) = length(iaux4);
QminEcM(i) = sum(vr(iaux4));
% Minerio classificado como Esteril ---------------------------------
iaux3 = find(vr4 &gt;=cl(i) &amp;amp; vr3&lt;=cl(i));
TonMcE2(i) = length(iaux3);
QminMcE2(i) = sum(vr4(iaux3));
% Esteril classificado como Minerio ---------------------------------
iaux4 = find(vr3&gt;=cl(i) &amp;amp; vr4&lt;=cl(i));
TonEcM2(i) = length(iaux4);
QminEcM2(i) = sum(vr4(iaux4));

end
%-----------------------------------------------------------------------

cl1 = cl(1:ncl-1);
id=find(˜isnan(vr4));
id2=find(˜isnan(vr3));
TR =length(vr);
TE =length (vr2);
Tc1 =length(vr4);
Tc2 =length (vr3);
QR =sum(vr);
QE =sum(vr2);
Qc1 =sum(vr4(id));
Qc2 =sum(vr3(id2));
aux =[(0:0.35:17.15)];

%-----------------------------------------------------------------------
BenVer = (aux.*(QminVer - TonVer.*cl1))-(0.05*(TR-TonVer).*cl1);
BenEst = (aux.*(QminEst- TonEst.*cl1))-(0.05*(TR-TonEst).*cl1);
BenVer2= (aux.*(QminVer2 - TonVer2.*cl1))-(0.05*(TR-TonVer2).*cl1);
BenEst2= (aux.*(QminEst2 - TonEst2.*cl1))-(0.05*(TR-TonEst2).*cl1);
BenEstEf= (aux.*(QminEstEf - TonEst.*cl1))-(0.05*(TR-TonEst).*cl1);

%-----------------------------------------------------------------------
figure
subplot(2,1,1)
plot(cl1,BenVer,’-rd’,’MarkerSize’,5);hold on;
plot(cl1, BenEst,’-b*’,’MarkerSize’,5);hold on;
plot(cl1, BenEstEf,’-bo’,’MarkerSize’,5);hold on;
plot(cl1, BenEst2,’-kx’,’MarkerSize’,5);hold on;
plot(cl1, BenVer2,’-kp’,’MarkerSize’,5);hold on;
stem_handles = stem(cl1,BenVer,’r’);
grid on;
legend(’BF_{Real}’, ’ BF_{KO}’, ’BF_{KO-Efetivo}’, ’BF_{\phi(c*|x)}’,...

’BF_{\psi(c*|x*)}’);

163



Co?digo Fonte

xlabel(’Teor de Corte’)
ylabel(’Lucro em US$’)

%-----------------------------------------------------------------------
TonVer = TonVer/TR;
QminVer = QminVer/QR;
TonEst = TonEst/TE;
QminEst = QminEst/QE;
TonVer2 = TonVer2/Tc1;
QminVer2= QminVer2/Qc1;
TonEst2 = TonEst2/Tc2;
QminEst2= QminEst2/Qc2;
TonMcE = TonMcE/TR;
QminMcE = QminMcE/QR;
TonEcM = TonEcM/TR;
QminEcM = QminEcM/QR;
TonMcE2 = TonMcE2/Tc1;
QminMcE2 = QminMcE2/Qc1;
TonEcM2 = TonEcM2/Tc1;
QminEcM2 = QminEcM2/Qc1;

%-----------------------------------------------------------------------
figure
subplot(2,1,1)
plot(cl1,TonVer,’-rp’,’MarkerSize’,5);hold on;
plot(cl1,TonEst,’-bo’,’MarkerSize’,5);hold on;
plot(cl1,TonVer2,’-k*’,’MarkerSize’,5);hold on;
plot(cl1,TonEst2,’-kx’,’MarkerSize’,5);hold on;
axis([0 zmax 0 1]);
xlabel(’Teor de Corte’);
ylabel(’Tonelagem’);
legend(’T_{Z(x)}’,’T_{Zˆ*(x)}’,’\phi (T_{Zˆ{c*}(x)}|T_{z(x)})’, ...

’\psi(T_{Zˆ{c*}(x)}|T_{zˆ*(x)})’);
grid on;
subplot(2,1,2)
plot(cl1,QminVer,’-rp’,’MarkerSize’,5);hold on;
plot(cl1,QminEst,’-bo’,’MarkerSize’,5);hold on;
plot(cl1,QminVer2,’-k*’,’MarkerSize’,5);hold on;
plot(cl1,QminEst2,’-kx’,’MarkerSize’,5);hold on;
axis([0 zmax 0 1]);
xlabel(’Teor de Corte’);
ylabel(’Quantidade de Minerio’);
legend(’Q_{Z(x)}’,’Q_{Zˆ*(x)}’, ’\phi (Q_{Zˆ{c*}(x)}|Q_{z(x)})’, ...

’\psi(Q_{Zˆ{c*}(x)}|Q_{zˆ*(x)})’);
grid on;
%-----------------------------------------------------------------------
figure
subplot(2,1,1)

164



Co?digo Fonte

stairs(cl1,TonMcE,’r’);hold on;
stairs(cl1,TonMcE2,’k’);hold on;
xlabel(’Teor de Corte’);
ylabel(’Tonelagem’);
legend(’Minerio Classificado como Esteril Real’, ’Minerio ...

Classificado como Esteril Copulas’);
grid on;
subplot(2,1,2)
stairs(cl1,TonEcM,’r’);hold on;
stairs(cl1,TonEcM2,’k’);hold on;
xlabel(’Teor de Corte’);
ylabel(’Tonelagem’);
legend(’Esteril Classificado como Minerio Real’, ’Esteril ...

Classificado como Minerio Copulas’);
grid on;
%-----------------------------------------------------------------------
figure
subplot(2,1,1)
stairs(cl1,TonMcE2-TonMcE,’r’); hold on;
stairs(cl1,TonEcM2-TonEcM,’b’); hold on;
legend(’DiferenA?§a entre Minerio Classificado como Esteril’, ...

’DiferenA?§a entre Esteril Classificado como Minerio’);
xlabel(’Teor de Corte’);
ylabel(’DiferenA?§as de Tonelagem’);
axis([0 zmax -0.075 0.075]);
grid on;

subplot(2,1,2)
stairs(cl1,QminMcE2-QminMcE,’r’); hold on;
stairs(cl1,QminEcM2-QminEcM,’b’); hold on;
legend(’DiferenA?§a entre Minerio Classificado como Esteril’, ...

’DiferenA?§a entre Esteril Classificado como Minerio’);
xlabel(’Teor de Corte’);
ylabel(’DiferenA?§as de Quantidade de Minerio’);
axis([0 zmax -0.075 0.075]);
grid on;
%-----------------------------------------------------------------------
figure
subplot(2,1,1)
stairs(cl1,QminMcE,’r’);hold on;
stairs(cl1,QminMcE2,’k’);hold on;
xlabel(’Teor de Corte’);
ylabel(’Quantidade de Minerio’);
legend(’Minerio Classificado como Esteril Real’, ’Minerio ...
Classificado como Esteril Copulas’);
grid on;
subplot(2,1,2)

165



Co?digo Fonte

stairs(cl1,QminEcM,’r’);hold on;
stairs(cl1,QminEcM2,’k’);hold on;
%plot(cl1,QminEcM3,’--b’,’MarkerSize’,3);hold on;
xlabel(’Teor de Corte’);
ylabel(’Quantidade de Minerio’);
legend(’Esteril Classificado como Minerio Real’, ...

’Esteril Classificado como Minerio Copulas’);
grid on;
%-----------------------------------------------------------------------
%########################################################################%
%## UNIVERSADE ESTADUAL DE CAMPINAS -UNICAMP ##%
%## INSTITUTO DE GEOCIENCIAS ##%
%## DEPARTAMENTO DE GEOLOGIA E RECURSOS NATURAIS ##%
%##--------------------------------------------------------------------##%
%## Autor : Frederico Augusto Rosa do carmo ##%
%## Orientador : Armando Zaupa Remacre ##%
%##--------------------------------------------------------------------##%
%## Sub-rotina: Otimizador ##%
%########################################################################%
BenBloco_Ver=[length(vr) 4];
BenBloco_Est=[length(vr) 4];
%-----------------------------------------------------------------------
cutoff = [65, 150, 260, 300, 425, 550];
for i=1:6

aux3 = find(vr&gt;= cutoff(i));
aux4 = find(vr&amp;lt;cutoff(i));
BenBloco_Ver(aux3,i) = (3.27*vr(aux3))-1200;
BenBloco_Ver(aux4,i) = -1200;

aux5 = find(vr2&gt;= cutoff(i));
aux6 = find(vr2&amp;lt;cutoff(i));
BenBloco_Est(aux5,i) = (3.27*vr2(aux5))-1200;
BenBloco_Est(aux6,i) = -1200;

end
%-----------------------------------------------------------------------
Bver =[dx dy];
Best =[dx dy];
aux=1;
corte =3;
for i=1:dx,

for j=1:dy,
Bver(i,j)=BenBloco_Ver(aux,corte);
Best(i,j)=BenBloco_Est(aux,corte);
aux=aux+1;

end
end
%-----------------------------------------------------------------------

166



Co?digo Fonte

[mascVer cavaVer]=LG2D(Bver,dx,dy);
%-----------------------------------------------------------------------
[mascEst cavaEst]=LG2D(Best,dx,dy);
%-----------------------------------------------------------------------
figure
subplot(2,1,1)
imagesc(cavaVer);
axis equal;
axis([1 dy 1 (dx/2)]);
title(’Cava Otima Real’);
%-----------------------------------------------------------------------
subplot(2,1,2)
imagesc(cavaEst);
axis equal;
axis([1 dy 1 (dx/2)]);
title(’Cava Otima Krigagem’);
%-----------------------------------------------------------------------
BEN_REAL =sum(sum(cavaVer))
BEN_KRIG =sum(sum(cavaEst))
BEN_EFE =sum(sum(mascEst.*Bver))
TON_REAL =sum(sum(mascVer));
TON_KRIG =sum(sum(mascEst));
QM_REAL =sum(sum(mascVer.*Zver));
QM_KRIG =sum(sum(mascEst.*Zest));
QM_EFE =sum(sum(mascEst.*Zver));
%########################################################################%
%## UNIVERSADE ESTADUAL DE CAMPINAS -UNICAMP ##%
%## INSTITUTO DE GEOCIENCIAS ##%
%## DEPARTAMENTO DE GEOLOGIA E RECURSOS NATURAIS ##%
%##--------------------------------------------------------------------##%
%## Autor : Frederico Augusto Rosa do carmo ##%
%## Orientador : Armando Zaupa Remacre ##%
%##--------------------------------------------------------------------##%
%## Funcao: LG2D ##%
%########################################################################%
function [masc2, cava2, EMKrig, Valor_Krig]=LG2D(ModBlock,dx,dy);
%Inserindo uma linha de zeros -------------------------------------------
m=ModBlock;
mij=zeros(dx+1,dy);
mij(2:dx+1,:)=m ;
%Fazendo Mij=Soma das colunas -------------------------------------------
Mjk=cumsum(mij);
% Procurando o maximo valor na coluna anterior --------------------------
P=Mjk;
for j=2:dy
for i=2:dx+1

k=[-1 0 1];

167



Co?digo Fonte

if i==dx+1
kk=i+k(1:2);

else
kk=i+k;

end
maxx=max(P(kk,j-1));
P(i,j)=Mjk(i,j)+maxx;

end
end
%Desenhando a Cava -------------------------------------------------------
masc2 = zeros(dx+1,dy);
indmax = find(P(2,:)==max(P(2,:)));
masc2(2,indmax)=1;
ii=2;
for j=indmax: -1: 2

k=[-1 0 1];
if ii==dx+1

kk=ii+k(1:2);
elseif ii==1

kk=ii+k(2:3);
else

kk=ii+k;
end
maxx =max(P(kk,j-1));
ii = find(P(kk,j-1)==maxx );
ii =kk(ii);
masc2(ii,j-1)= 1;
masc2(:,j-1)=[ ones(ii,1); zeros(dx+1-ii,1)];

end
masc2= masc2(2:dx+1,:);
cava2=masc2.*m;
Valor_Krig=sum(sum(cava2));
%-----------------------------------------------------------------------
mascara01=cava2&gt;0;
mascara02=cava2&lt;0;
VE = cava2.*mascara02;
VM = cava2.*mascara01;
Valor_Est_Krig = sum(sum(VE));
Valor_Min_Krig = sum(sum(VM));
%-----------------------------------------------------------------------
Valor_Tonel=sum(sum(masc2));
SomaEst = cava2;
ii = find (SomaEst&gt;0);

SomaEst(ii)=0;
jj = find (SomaEst&lt;0);

SomaEst(jj)=1;
%-----------------------------------------------------------------------

168



Co?digo Fonte

TonEsterilKrig=sum(sum( SomaEst));
TonMinerioKrig=Valor_Tonel-TonEsterilKrig;
EMKrig = TonEsterilKrig/TonMinerioKrig;

%########################################################################%
%## UNIVERSADE ESTADUAL DE CAMPINAS -UNICAMP ##%
%## INSTITUTO DE GEOCIENCIAS ##%
%## DEPARTAMENTO DE GEOLOGIA E RECURSOS NATURAIS ##%
%##--------------------------------------------------------------------##%
%## Autor : Frederico Augusto Rosa do carmo ##%
%## Orientador : Armando Zaupa Remacre ##%
%##--------------------------------------------------------------------##%
%## Funcao: SEQUENCIAMENTO ##%
%########################################################################%
% dx = Numero de dados na direA?§ao X
% dy = Numero de dados na direA?§ao Y
% ns = Numero de simulaA?§oes
% Gamma = Matrix que vai liberar os blocos
% Cap_Min = Capacidade de MineraA?§ao por periodo de Tempo
% Ton_Cavas = Tonelagem Total a ser extraida
%-----------------------------------------------------------------------
%-----------------------------------------------------------------------
% OUTPUT
%-----------------------------------------------------------------------
% Seq =
% fc = Fluxo de Caixa do Sequenciamento
%
%-----------------------------------------------------------------------
function [SeqR,fcR,recR,recRReal,fcRReal,qaz]=SequencKrig(masc, ...

cava,dx,dy,ModBlockR);
%-----------------------------------------------------------------------
Vj=dx;
Vi=dy;
NBB = sum(sum(masc));
ns =1;
%-----------------------------------------------------------------------
Cap_Min = floor(NBB/15);% 15 = anos
%-----------------------------------------------------------------------
Gamma = ones(dx,dy,ns);
SeqR= zeros(dx,dy,ns);
Bloc_teor = ones(dx,dy,ns);
Gamma(:,:,:) = -9999999;
Bloc_teor(:,:,:) = -9999999;
% Achando os Blocos que podem ser extraidos ----------------------------
Block_Liber = find (masc ==1);
Gamma(Block_Liber) = -999999;
% Liberando a camada para retirar os blocos ----------------------------

169



Co?digo Fonte

for i=1:ns
for j=1:dy
if Gamma(1,j,i)==-999991
Gamma(1,j,i) = 0;

end;
end;

end;
% restringindo a capacidade de mineraA?§ao -------------------------------
for i=1:ns

NB=1;
ano=1;
aaa =1;
aa=find(Gamma(:,:,i)==0);
aa=aa+((i-1)*dx*dy);
Bloc_teor(aa)=cava(aa);
Ach_Max = max(max(Bloc_teor(:,:,i)));
num_bl=find(Bloc_teor==Ach_Max);
esc_bloco =cava;
uu=find(cava==0);
esc_bloco(uu) =-99999999;

if num_bl&gt;1
if num_bl&gt;dx &amp;amp; num_bl&lt;(dx*dy)-dx

triang_m = esc_bloco(num_bl+1)+esc_bloco(num_bl-dx)...
+ esc_bloco(num_bl+dx);
al = find(max(triang_m));

else
al=1;

end
else

al=1
end

Gamma(num_bl(al))=1 ;
SeqR(num_bl(al))=ano;

%-----------------------------------------------------------------------
Bloc_teor(:,:,i)=-9999999;% Seguindo a Sequencia -----------------
while NB&lt;=NBB(i)

%Restringir pela capacidade anual------------------------------
bb = find(Gamma(:,:,i)==1);
bb = bb+((i-1)*Vj*Vi);
z = ceil(bb./(Vj*Vi));
z2 = z-1;
f = bb -(z2.*(Vj*Vi));
x = ceil(f./Vj);
y = f -((x-1)*Vj);
Pos = (z2).*(Vj*Vi)+((x-1).*Vj)+y;
% PosiA?§oes onde os blocos estao liberados----------------------
PosD = (z2).*(Vj*Vi)+((x).*Vj)+y;

170



Co?digo Fonte

PosE = (z2).*(Vj*Vi)+((x-2).*Vj)+y;
PosB = (z2).*(Vj*Vi)+((x-1).*Vj)+(y+1);
% -------------------------------------------------------------
tm= length(PosB);
if PosD&amp;lt;= (z.*(dx*dy))&amp;amp; PosD&gt;0
iii = find(Gamma(PosD) == 0) ;
Bloc_teor(PosD(iii))=cava(PosD(iii));

end
if PosE&amp;lt;= (z.*(dx*dy))&amp;amp; PosE&gt;0
iii = find(Gamma(PosE) == 0);
Bloc_teor(PosE(iii))=cava(PosE(iii));
end
if PosB&amp;lt;= (z.*(dx*dy))&amp;amp; PosB&gt;0
iii = find(Gamma(PosB) == 0);
Bloc_teor(PosB(iii))=cava(PosB(iii));
end
% -----------------------------------------------------------
Ach_Max = max(max(Bloc_teor(:,:,i)));
num_bl=find(Bloc_teor==Ach_Max);

- if num_bl&gt;1
%---------------------------------------------------------
if num_bl&gt;dx &amp;amp; num_bl&lt;(dx*dy)-dx

triang_m = esc_bloco(num_bl+1)+esc_bloco(num_bl-dx)...
+esc_bloco(num_bl+dx);

al = find(max(triang_m));
if length(al)&gt;1

triang_m = esc_bloco(num_bl+2)+triang_m;
al = find(max(triang_m));

end
else

al=1;
end
%----------------------------------------------------------
ale = length(num_bl);
al = floor(rand*ale)+1 ;
Gamma(num_bl(al))=1 ;
SeqR(num_bl(al))=ano;
Bloc_teor(num_bl(al))=-9999999;

else
Gamma(num_bl(1))=1 ;
SeqR(num_bl(1))=ano;
Bloc_teor(num_bl(1))=-9999999;

end
LBl_Bai = find(Gamma(:,:,i)==1);
LBl_Bai = LBl_Bai+((i-1)*Vj*Vi);
zl = ceil(LBl_Bai./(Vj*Vi));
z2l = zl-1;

171



Co?digo Fonte

fl = LBl_Bai -(z2l.*(Vj*Vi));
xl = ceil(fl./Vj);
yl = fl -((xl-1)*Vj);

PosDC = (z2l).*(Vj*Vi)+((xl).*Vj)+(yl);
PosEC = (z2l).*(Vj*Vi)+((xl-2).*Vj)+(yl);
PosCC = (z2l).*(Vj*Vi)+((xl-1).*Vj)+(yl);
Pos2 = (z2l).*(Vj*Vi)+((xl-1).*Vj)+(yl+1);

T2= length(PosCC);
for iiii=1:T2
if (PosDC(iiii)&gt;0)&amp;amp;(PosEC(iiii)&gt;0)&amp;amp; (PosCC(iiii)&gt;0)&amp;amp;...

(PosDC(iiii)&lt;=(dx*dy*ns))&amp;amp;(PosEC(iiii)&lt;=(dx*dy*ns))&amp;amp; ...
(PosCC(iiii)&lt;=(dx*dy*ns))

if ((Gamma(PosDC(iiii))==1) &amp;amp; (Gamma(PosEC(iiii))==1)&amp;amp; ...
(Gamma(PosCC(iiii))==1)&amp;amp; (Gamma(Pos2(iiii))==-999991))

Gamma(Pos2(iiii))=0;
end;
end;

end;
aaa=aaa+1;
if aaa==Cap_Min

ano=ano+1;
aaa=1;

end;
NB=NB+1;

end; % while
end;% for
SeqR(1,1)=0;
%-----------------------------------------------------------------------
aa =max(max(SeqR(:,:,:)));
aa= reshape(aa,ns,1);
for i=1:ns
for j=1:aa(i)
asdf = find(SeqR(:,:,i)==j);
recR(i,j) = sum (cava(asdf));
recRReal(i,j) = sum(ModBlockR(asdf));
end

end
as =max(aa);
fcR = zeros(ns,as);
fcRReal = zeros(ns,as);
Inv_Inic = -0;
fcR(:,1) =recR(:,1);
fcRReal(:,1) =recRReal(:,1);
G_anual = 0.5;
for i=1:ns

172



Co?digo Fonte

for j=2:aa(i)
fcR(i,j) = fcR(i,j-1)+recR(i,j);
fcRReal(i,j) = fcRReal(i,j-1)+recRReal(i,j);
%fcR(i,j) = fcR(i,j-1)+recR(i,j)-G_anual;
%fcRReal(i,j) = fcRReal(i,j-1)+recRReal(i,j)-G_anual;

end
end
qaz = 0:1:as-1;
%-----------------------------------------------------------------------

VPLEstimado = pvvar(fcR,0.12);
VPLReal = pvvar(fcRReal,0.12);

%-----------------------------------------------------------------------
figure
subplot(2,1,1)
imagesc(SeqR)
axis equal
axis([1 dy 1 dx/2]);
Title (’Sequenciamento cava Krigada’)
for i=1:dx

for j=1:dy
if SeqR(i,j,1)&gt;0

text(j,i,num2str(SeqR(i,j,1)),’HorizontalAlignment’,...
’center’,’VerticalAlignment’,’middle’,’FontSize’,6)

end
end

end
subplot(2,1,2)
imagesc(cava)
axis equal;
axis([1 dy 1 dx/2]);
Title (’Cava Krigada’)
%-----------------------------------------------------------------------
figure
subplot(2,1,1)
bar (qaz,fcR,0.9); hold on
bar (qaz,fcRReal,0.7,’r’)
%-----------------------------------------------------------------------
[n1,ctr1] = hist(X(:,2),15);
[n2,ctr2] = hist(X(:,1),15);
[n3,ctr3] = hist(V1_Est,15);
[n4,ctr4] = hist(V1_Ver,15);
nn1 = 100.*n1./(sum(n1));
nn2 = 100.*n2./(sum(n2));
nn3 = 100.*n3./(sum(n3));
nn4 = 100.*n4./(sum(n4));
Min_Var_1 = floor (min(Var_1));

173



Co?digo Fonte

Min_Var_2 = floor (min(V1_Est));
Max_Var_1 = round (max(Var_1));
Max_Var_2 = round (max(V1_Est));
aa = [Min_Var_1; Min_Var_2; Max_Var_1; Max_Var_1];
minimo = min(aa);
maximo = max(aa);
%-----------------------------------------------------------------------
figure
subplot(3,3,5);
plot(V1_Ver,V1_Est,’rˆ’);hold on;
plot(X(:,1),X(:,2),’b.’);
h1 =gca;legend(’Dados Originais’, ’SimulaA?§ao’);
%econd2(V1_Ver,V1_Est,X(:,1),X(:,2));
econdf(V1_Ver,V1_Est);
[econd,medvr,cl,Beta]=econdf2(X(:,1),X(:,2));
axis([minimo maximo minimo maximo]);

subplot(3,3,8); bar(ctr1,-nn1,1,’b’); h2 =gca; axis([minimo ...
maximo -max(nn1)*1.1 0]); axis(’off’);

subplot(3,3,4); barh(ctr2,-nn2,1,’b’); h3 =gca; axis ...
([-max(nn2)*1.1 0 minimo maximo]);axis(’off’);

subplot(3,3,2); bar(ctr3,nn3,1,’r’); h4 =gca; axis ...
([minimo maximo 0 max(nn3)*1.1]); axis(’off’);

subplot(3,3,6); barh(ctr4,nn4,1,’r’); h5 =gca; axis ...
([0 max(nn4)*1.1 minimo maximo]);axis(’off’);

set(h1,’Position’,[0.25 0.25 0.55 0.55]);
set(h2,’Position’,[.25 .05 .55 .15]);
set(h3,’Position’,[.05 .25 .15 .55]);
set(h4,’Position’,[.25 .85 .55 .15]);
set(h5,’Position’,[.85 .25 .15 .55]);
%-----------------------------------------------------------------------
figure
plot(VAMOS_5X5,KAMOS_5X5,’rd’,’MarkerSize’,5)
hold on
plot(AMOST_5X5,KAMOS_5X5,’bp’,’MarkerSize’,5)
plot(AMOST_5X5,VAMOS_5X5,’ko’,’MarkerSize’,5)
%-----------------------------------------------------------------------
figure
plot3(X(:,1),X(:,2),X(:,3),’kp’);
grid on;
axis([0 1600 0 1600 0 1600]);
xlabel(’\phi(c*|x)’); ylabel(’\psi(c*|x*)’); zlabel(’\tau(c*|x**)’)
%-----------------------------------------------------------------------

174


	Introdução
	Seletividade na Mineração
	Objetivos
	Organização da Tese

	Cópulas Estatísticas
	Definições Básicas
	Métodos probabilísticos
	Variáveis aleatórias
	Função de distribuição e função de densidade
	Funções aleatórias
	Esperança matemática
	Variância, desvio padrão e momentos

	Várias variáveis aleatórias
	Probabilidade condicional
	Leis marginais 
	Esperança Condicional 
	Variância condicional 
	Covariância e correlação

	Medidas de Correlação
	Correlação Linear

	Correlação Não-Paramétrica
	A medida  de Kendall
	A medida s de Spearman 

	Definições e Propriedades Básicas
	Exemplo: distribuição de Gumbel

	Cópulas Elementares 
	Lei de união associada a cópula 
	Leis conjuntas das leis marginais

	Teoremas e Propriedades
	Dependência entre os dados
	Distribuições Bivariadas
	Método da Inversão

	Cópulas Paramétricas
	Cópulas Archimedianas
	Medidas Associativas 

	Cópulas Gaussianas

	Parametrização de Reservas
	Geoestatística Mineira
	Reservas Minerais
	Reservas Estimadas
	Geoestatística Não-Linear
	Função tonelagem
	Função Metal Contido
	Função Metal x Tonelagem
	Função Teor Médio
	Esperança Condicional
	Variável Normal Condicionada
	Mudança de Suporte


	Cópula e a Geoestatística
	Validação Cruzada
	A Seletividade das Distribuições
	Reserva Ideal via Cópulas
	Comparação com a Simulação Gaussiana Seqüencial

	Função de Transferência
	Avaliação de cava final via cópulas
	Mudança de Suporte via Cópulas

	Conclusões
	Bibliografia
	Walker Lake
	Simulação Gaussiana Seqüencial

	Distribuições empíricas
	Comparação entre Distribuições
	Efeito Suporte
	Efeito Informação
	Exemplo Teórico
	Funções de Perdas
	Estimativa por E-Type
	Estimativa pela Mediana
	Estimativa Inter Quartis


	Fluxograma da Metodologia da Tese
	Código Fonte



</field>
	</doc>
</add>