<?xml version="1.0" encoding="utf-8"?>
<add>
	<doc>
		<field name="docid">BR-TU.09540</field>
		<field name="filename">14521_Morelatto_Rodrigo_M.pdf</field>
		<field name="filetype">PDF</field>
		<field name="text">UNICAMP
RODRIGO MORELATTO
FILTRAGEM DE DADOS SÍSMICOS UTILIZANDO O TENSOR ESTRUTURAL
CAMPINAS
2013
UNICAMP
UNIVERSIDADE ESTADUAL DE CAMPINAS FACULDADE DE ENGENHARIA MECÂNICA E INSTITUTO DE GEOCIÊNCIAS
RODRIGO MORELATTO
FILTRAGEM DE DADOS SÍSMICOS UTILIZANDO O TENSOR ESTRUTURAL
Orientador: Prof. Dr. Ricardo Caetano Azevedo Biloti
Dissertação de Mestrado apresentada ao Programa de Pós-Graduação em Ciências e Engenharia de Petróleo da Faculdade de Engenharia Mecânica e Instituto de Geociências da Universidade Estadual de Campinas como parte dos pré-requisitos para obtenção do título de Mestre em Ciências e Engenharia de Petróleo na área de Reservatórios e Gestão.
no Rodrigo Mo. Dr. Ricardo
a pelo P
o
Este exemplar corresponde à versão final da dissertação defendid relatto Cãetano
Orientador
CAMPINAS 2013
FICHA CATALOGRÁFICA ELABORADA PELA
BIBLIOTECA DA ÁREA DE ENGENHARIA E ARQUITETURA - BAE - UNICAMP
M814f
Morelatto, Rodrigo
Filtragem de dados sísmicos utilizando o tensor estrutural / Rodrigo Morelatto. - Campinas, SP: [s.n.], 2013.
Orientador: Ricardo Caetano Azevedo Biloti.
Dissertação de Mestrado - Universidade Estadual de Campinas, Faculdade de Engenharia Mecânica e Instituto de Geociências.
1.	Prospecção sísmica. 2. Geofísica. 3. Processamento de imagens. I. Biloti, Ricardo Caetano Azevedo, 1974-. II. Universidade Estadual de Campinas. Faculdade de Engenharia Mecânica e Instituto de Geociências. III. Título.
Título em Inglês: Seismic data filtering with the structure tensor
Palavras-chave em Inglês: Prospecting seismic, Geophysics, Image Processing Área de concentração: Reservatórios e Gestão
Titulação: Mestre em Ciências e Engenharia de Petróleo
Banca examinadora: Lúcio Tunes dos Santos, Hélio Pedrini
Data da defesa: 28-02-2013
Programa de Pós Graduação: Engenharia Mecânica
UNICAMP
UNIVERSIDADE ESTADUAL DE CAMPINAS FACULDADE DE ENGENHARIA MECÂNICA E INSTITUTO DE GEOCIÊNCIAS
DISSERTAÇÃO DE MESTRADO ACADÊMICO
FILTRAGEM DE DADOS SÍSMICOS UTILIZANDO O TENSOR ESTRUTURAL
Autor: Rodrigo Morelatto
Orientador: Prof. Dr. Ricardo Caetano Azevedo Biloti
A banca examinador	posta petas membrosbbaNoaprovov estd dizrertação:
prof. Dr. Ricardo CauAano Azevedo Biloti - Orientador DMA/IMECC/UNICAMP
Prof. Dr. Lúcio Tunes dos Santos DMA/IMECC/UNICAMP
Prof.Dr.Hélio Pedrini
IC/UNICAMP
Campinas, 28 dz fzvzrziro dz 2013
AGRADECIMENTOS
Agradeço primeiramente a Deus, pela força e guia nesses dois anos de mestrado.
Ao meu orientador, pelos conselhos, apoio e pela oportunidade de trabalhar na GêBR.
Aos meus familiares pelo apoio durante esses anos.
Aos meus colegas de república, pela companhia e força durante o mestrado.
Ao Ian, pelas discussões e ideias, que se mostraram sempre produtivas.
Ao meu amigo Carlos, por ter auxiliado na revisão da dissertação.
Ao pessoal do laboratório, principalmente o João e o Alber, por sempre atenderem aos nossos pedidos com eficácia impar.
Por fim, ao INCT-GP, pela bolsa de estudos para realização deste trabalho.
Bem aventurado o homem que acha sabedoria, e o homem que adquire conhecimento; Porque é melhor a sua mercadoria do que artigos de prata, e maior o seu lucro que o ouro mais fino. Mais preciosa é do que os rubis, e tudo o que mais possas desejar não se pode comparar a ela.
Provérbios 3:13-15
RESUMO
O tensor estrutural é uma ferramenta muito versátil, e pode ser utilizado para detectar bordas, estimar coerência e inclinações locais. Neste trabalho, o tensor estrutural é empregado para estimar inclinações locais em dados sísmicos. As inclinações estimadas com essa ferramenta são comparadas com as inclinações obtidas com duas implementações diferentes de destruidores de onda plana. Esses três métodos são testados contra diferentes conjuntos de dados, quatro sintéticos e um real. As inclinações estimadas com o tensor estrutural foram robustas e precisas o suficiente para aplicações práticas, comparáveis às inclinações obtidas com os destruidores de onda plana. Por fim, é apresentada uma aplicação prática para as inclinações estimadas com o tensor. Essas inclinações são empregadas para filtrar dados sísmicos ao longo dos eventos, utilizando dois métodos diferentes: filtragem adaptativa e o filtro preditor de estruturas. Esse tipo de filtragem é especialmente útil para interpretação, pois os dados são filtrados ao longo dos eventos, reduzindo a perda de informação e atenuando o ruído.
Palavras-Chave: Prospecção sísmica, Geofísica, Processamento de imagens.
ABSTRACT
The structure tensor is a very versatile tool, which can be used to detect edges, estimate coherency and local slopes. In this work we employ the structure tensor to estimate local slopes. We compare the slopes obtained with this tool with the slopes obtained by two different implementations of plane-wave destruction filters. Those three methods were tested against different datasets, four synthetic and one real. The slopes detected through the structure tensor were reliable and comparable to the ones obtained with plane-wave destruction filters. Finally, we present an application for the slopes detected by the structure tensor. We show how to employ them to filter seismic data along structures using two different methods: adaptive filtering and structure prediction filtering. This kind of filtering is useful for interpretation, because it filters the data along the seismic events, reducing the loss of information and noise at the same time.
Keywords: Prospecting seismic, Geophysics, Image Processing.
SUMÁRIO
LISTA DE FIGURAS	xxxi
LISTA DE TABELAS	xxxiii
1	INTRODUÇÃO	1
1.1	Estrutura da dissertação..................................... 3
2	O TENSOR ESTRUTURAL	5
2.1	Dedução do tensor ........................................... 5
2.2	Autovalores e estrutura local da imagem...................... 7
2.3	Obtenção dos autovalores.................................... 10
2.4	Medindo a linearidade local................................. 11
3	INCLINAÇÃO LOCAL	12
3.1	Estimando a inclinação com os destruidores de onda	plana.... 13
3.2	Estimando a inclinação com o tensor estrutural ............. 14
4	FILTRAGEM DE DADOS SÍSMICOS	16
4.1	Filtragem adaptativa........................................ 17
4.2	Filtro preditor de estruturas............................... 18
5	RESULTADOS NUMÉRICOS	20
5.1	Dados de teste.............................................. 20
5.2	Testes com o dado o plano................................... 23
5.3	Estudando critérios para escolha de tamanho da janela....... 25
5.4	Autovalores e coerência dos dados........................... 32
5.5	Estimativas de inclinação local para filtragem dos dados ... 37
5.6	Tempos de execução das estimativas de inclinação............ 42
5.7	Filtragem dos dados sintéticos e real ...................... 42
6	MELHORANDO AS TÉCNICAS DE FILTRAGEM	48
6.1	Utilizando similaridade como pesos para filtragem adaptativa.. 48
6.2	Filtro preditor de estruturas combinado à similaridade local . 54
6.3	Quantificando os resultados................................... 57
7	CONCLUSÕES	61
REFERÊNCIAS BIBLIOGRÁFICAS	63
Figura 2.1
Figura 2.2
Figura 3.1
Figura 4.1
LISTA DE FIGURAS
Parâmetros da função de diferenças quadráticas. O quadrado vermelho indica a posição da janela fixa em torno do ponto de análise (x0,t0). Por sua vez, o quadrado azul indica uma janela deslocada de (Ax,At)...........................................
Versão simplificada de possíveis cenários em uma imagem, bem como sua relação com a função de diferenças quadráticas. O quadrado vermelho indica a posição da janela fixa em torno do ponto de análise (x0,t0). Por sua vez, o quadrado azul indica uma janela deslocada de (Ax,At). A função de diferenças quadráticas é uma soma ponderada ponto a ponto das diferenças quadráticas de amplitude da imagem entre os dois quadrados. Em (a) E(Ax, At) ~ 0, em qualquer direção na vizinhança de (x0,t0). Em (b), a seta vermelha indica uma direção onde E não varia, já que as amplitudes da imagem nas regiões delimitadas por ambos quadrados é a mesma, ponto a ponto. Em (c) não há direção ao longo da qual ambos quadrados cobrem as mesmas amplitudes, ponto a ponto..................................................
Exemplo esquemático de imagem com estruturas lineares. A imagem possui duas regiões distintas, a primeira delas, somente com estruturas lineares planas e paralelas, ou seja, com inclinação local constante. E a segunda região, com estruturas curvas, e portanto, com inclinação local variável..................................
Comparação entre diferentes esquemas de filtragem para a imagem em (a). Essa imagem é filtrada com um filtro Gaussiano convencional em (b) e utilizando filtragem estrutural em (c). . .
6
8
12
Figura 4.2 Duas implementações diferentes para filtragem adaptativa (a): A implementação utilizando apenas um núcleo alongado (b) e a implementação combinando diversos núcleos isotrópicos (c). Na primeira implementação, o tamanho do núcleo Gaussiano é determinada pelos parâmetros cx e ct da equação (4.4) (adaptado de Bakker, 2002)...................................................... 17
Figura 4.3 Esquema de funcionamento para o filtro preditor de estruturas, para o traço em azul. Depois de estimar a inclinação local para todos os pontos nos dados, o traço original pode ser predito deslocando as amostras dos traços vizinhos de acordo com as inclinações locais. Traços mais distantes podem ser utilizados com recursão. Nessa figura, apenas os vizinhos imediatos são utilizados. Após a predição, é realizada uma média dos valores dos traços preditos juntamente com os valores do traço original,
realizando assim a filtragem preditora de estruturas................. 19
Figura 5.1 Dado sintético composto de cinco eventos planos.......................... 20
Figura 5.2 Dado sintético para testes de inclinação. Composto de 250 x 250 amostras, espaçadas de 4 m em x e 4 ms em t. Em verde os diversos tamanhos de janelas (escala de integração) utilizados para testes com o tensor estrutural e os outros métodos estudados. 21
Figura 5.3	Modelo sedimentar sintético........................................ 21
Figura 5.4	Modelo sintético de meio domo...................................... 22
Figura 5.5 Seção sísmica histórica migrada em tempo do Golfo do México.
O dado é exibido somenta a partir de t = 0,3 s.................... 23
Figura 5.6 Comparação das inclinações locais obtidas com o tensor estrutural
(a), e as implementações local (b) e global (c) dos destruidores
de onda plana para o dado com eventos planos (Figura 5.1). . .	24
Figura 5.7
Figura 5.8
Figura 5.9
Figura 5.10
Figura 5.11
Inclinações estimadas para os cinco eventos planos utilizando o tensor estrutural (vermelho) e as implementações local (verde) e global (azul) dos destruidores de onda plana. Cada uma das curvas foi construída amostrando as inclinações estimadas na posição central de cada evento, e cada linha reta representa um dos respectivos eventos presentes no dado..................... 25
Comparação entre as inclinações locais para o dado sintético para testes de inclinação local (Figura 5.2). São comparadas as inclinações obtidas com o tensor estrutural (a), e as inclinações locais estimadas utilizando a implementação local (b) e global (c) dos destruidores de onda plana com a inclinação local analítica (d). Para as figuras (a) e (b), foi utilizada uma janela de 5 x 11 amostras na estimativa de inclinação.......................... 27
Inclinações locais estimadas para o dado sintético para testes de inclinação. São exibidas as inclinações estimadas utilizando o tensor estrutural (vermelho) e as implementações local (verde) e global (azul) dos destruidores de onda plana. Também são mostradas as inclinações teóricas (preto). Cada uma das curvas foi construída amostrando as inclinações estimadas para t = 0,5 s. 28
Comparação de estimativas de inclinação local entre o tensor estrutural (em vermelho) e a implementação global dos destruidores de onda plana (em verde). Cada gráfico ilustra os resultados para um tamanho de escala de integração em pixels. É importante ressaltar que as faixas são semi-transparentes................ 30
Comparação de estimativas de inclinação local entre o tensor estrutural (em vermelho) e a implementação local dos destruidores de onda plana (em azul). Cada gráfico ilustra os resultados para um tamanho de escala de integração (ou janela W) em pixels. É importante ressaltar que as faixas são semi-transparentes. ...	31
Figura 5.13 Coerência e autovalores do tensor estrutural para o modelo com
eventos planos. Na máscara de coerência, os valores associados a
altas coerências se encontram em cinza............................ 33
Figura 5.14 Coerência e autovalores do tensor estrutural para o dado para
teste de inclinação local......................................... 34
Figura 5.15 Coerência e autovalores do tensor estrutural para o modelo sedi-
mentar sintético. Na máscara de coerência, os valores associados
a altas coerências se encontram em cinza.......................... 35
Figura 5.16 Coerência e autovalores do tensor estrutural para o meio domo
sintético. Na máscara de coerência, os valores associados a altas
coerências se encontram em cinza.................................. 36
Figura 5.17 Autovalores do tensor estrutural para o dado de campo histórico. 37
Figura 5.18 Comparação entre as inclinações locais para o modelo sedimentar
sintético (Figura 5.3). As inclinações obtidas com o tensor estru-
tural estão em (a) e (b). Em (e) uma versão suavizada de (b). Por
fim, as inclinações locais estimadas utilizando a implementação
local (c) e global (d) dos destruidores de onda plana............. 39
Figura 5.19 Comparação entre as inclinações locais para o meio domo sintético
(Figura 5.4). As inclinações obtidas com o tensor estrutural estão
em (a) e (b). Em (e) uma versão suavizada de (b). Por fim, as
inclinações locais estimadas utilizando a implementação local (c)
e global (d) dos destruidores de onda plana....................... 40
Figura 5.20	Comparação entre as inclinações locais para o dado histórico migrado no tempo (Figura 5.5). As inclinações obtidas com o tensor estrutural estão em (a). Uma segunda versão (d) dessas inclinações foi obtida suavizando (a) três vezes com uma janela triangular de 7 x 7 amostras. Por fim, as inclinações locais para o mesmo dado, estimadas utilizando a implementação local (b) e global (c) dos destruidores de onda plana		41
Figura 5.21	Comparação entre os tipos de filtragem para o dado sedimentar sintético: (a) filtragem Gaussiana convencional com suporte de 5x 5 amostras, (c) filtragem adaptativa com suporte aproximado de 7 x 3 amostras e (e) filtro preditor de estruturas utilizando traços preditos a partir dos seis vizinhos mais próximos. As diferenças entre os dados filtrados e o original se encontram em (b), (d) e (f) para cada tipo de filtro		45
		
Figura 5.22	Comparação entre os tipos de filtragem para o meio domo sintético: (a) filtragem Gaussiana convencional com suporte de 5 x 5 amostras, (c) filtragem adaptativa com suporte aproximado de 7 x 3 amostras e (e) filtro preditor de estruturas utilizando traços preditos a partir dos seis vizinhos mais próximos. As diferenças entre os dados filtrados e o original se encontram em (b), (d) e (f) para cada tipo de filtro		46
		
Figura 5.23	Comparação entre os tipos de filtragem para o dado real histórico: (a) filtragem Gaussiana convencional com suporte de 5 x 5 amostras, (c) filtragem adaptativa com suporte aproximado de 7 x 3 amostras e (e) filtro preditor de estruturas utilizando traços preditos a partir dos seis vizinhos mais próximos. As diferenças entre os dados filtrados e o original se encontram em (b), (d) e (f) para cada tipo de filtro		47
Figura 6.1
Figura 6.2
Figura 6.3
Figura 6.4
Comparação entre os tipos de filtragem para o dado sedimentar sintético: (a) filtragem bilateral convencional com suporte 5 x 5 amostras, (c) filtragem bilateral adaptativa, com suporte aproximado de 7 x 3 amostras e (e) a versão combinada o filtro de medianas. As diferenças entre os dados filtrados e o original se encontram em (b), (d) e (f) para cada tipo de filtro..........
Comparação entre os tipos de filtragem para meio domo sintético:
(a)	filtragem bilateral convencional com suporte 5 x 5 amostras, (c) filtragem bilateral adaptativa, com suporte aproximado de 7 x 3 amostras e (e) a versão combinada o filtro de medianas. As diferenças entre os dados filtrados e o original se encontram em
(b)	, (d) e (f) para cada tipo de filtro......................
Comparação entre os tipos de filtragem para o dado real histórico:
(a)	filtragem bilateral convencional com suporte 5 x 5 amostras,
(c)	filtragem bilateral adaptativa, com suporte aproximado de 7 x 3 amostras e (e) a versão combinada o filtro de medianas. A diferença entre os dados filtrados e o original se encontram em
(b)	, (d) e (f) para cada tipo de filtro......................
Esboço da medida de similaridade local entre o Traço I e II. A similaridade local tende a um quando os dois traços são localmente similares, como é o caso do evento no meio dos dois traços. Quando os traços diferem localmente, a similaridade tende a zero, como é o caso de regiões dominadas por ruído aleatório........
50
51
52
54
Figura 6.5
Figura 6.6
Figura 6.7
Esquema de funcionamento do filtro preditor de estruturas, melhorado utilizando similaridade local como pesos para o empilhamento. Depois de estimar a inclinação local para todos os pontos nos dados, o traço original, em azul, pode ser predito deslocando as amostras dos traços vizinhos de acordo com as inclinações locais. Traços mais distantes podem ser utilizados com recursão. Nessa figura, apenas os vizinhos imediatos são utilizados. Após a predição, é calculada a similaridade local entre o traço original e cada um dos traços preditos. Os traços preditos são então empilhados juntamente com o traço original, utilizando a similaridade local entre eles como pesos para o empilhamento. Assim, é realizada a filtragem preditora de estruturas melhorada. . . .
Resultados para o filtro preditor de estruturas, melhorado com empilhamento utilizando similaridade local como pesos. ....
RMSE utilizando janela móvel de 7 x 7 amostras, para o filtro preditor de estruturas.....................................
55
56
60
LISTA DE TABELAS
Tabela 2.1 Relaçao esperada entre os autovalores do tensor estrutural e a estrutura local da imagem (Faraklioti e Petrou, 2005).......................... 10
Tabela 6.1 Raiz quadrada do erro quadrático médio (RMSE), dada pela
equaçao (6.7), para o dado sedimentar sintético, para o meio domo sintético e para o dado real. O RMSE foi calculado para a filtragem Gaussiana, bilateral, adaptativa e bilateral adaptativa. 57
Tabela 6.2 Raiz quadrada do erro quadrático médio (RMSE), dada pela
equaçao (6.7), para o dado sedimentar sintético, para o meio domo sintético e para o dado real. O RMSE foi calculado para o filtro preditor de estruturas, com e sem similaridade.......... 58
1	INTRODUÇÃO
Motivada pelo crescimento do consumo energético em escala mundial, a demanda por petróleo tem crescido significativamente nos últimos anos. Somado a esse desafio, está o fato de que as jazidas de petróleo mais acessíveis estarem se esgotando. Isso leva as empresas desse ramo a constantemente procurar novas reservas de petróleo. Uma das partes chaves dessa busca está na aquisição de dados sísmicos.
Juntamente com a aquisição dos dados sísmicos, está o seu processamento e por fim a sua interpretação. Mesmo com as ferramentas atuais, o processo de interpretação tipicamente consome muito tempo dos intérpretes. A automatização desse processo também se mostrou um grande desafio, sendo que parte do trabalho ainda feita com intervenção humana (Bakker, 2002).
Um dos maiores problemas reside no fato de o número de intérpretes crescer mais lentamente do que a quantidade de dados a serem interpretados. Somado a isso, existe a pressão por parte das empresas para resultados mais rápidos, pois os dados obtidos através da interpretação são utilizados em processos de análise de risco (Fehmers e Hocker, 2003).
Uma possível forma de amenizar esse problema é reduzir o ruído presente nos dados, a fim de facilitar a sua interpretação. Técnicas convencionais de redução de ruídos são úteis para esse fim. Essas técnicas supõem que cada ponto nos dados é espacialmente correlacionado com os pontos próximos. Porém, essa suposição falha na presença de bordas ou descontinuidades, que podem ser representadas por falhas geológicas em um dado sísmico. Uma possível solução está em filtrar os dados somente ao longo dos eventos sísmicos, respeitando suas terminações.
A esse tipo de filtragem denominamos filtragem estrutural, pois essa filtragem é realizada ao longo das estruturas presentes nos dados sísmicos. Esse processo também tende a realçar a continuidade dos refletores, facilitando ainda mais o processo de interpretação, pois a identificação de estruturas de interesse é simplificada. Uma das maiores vantagens da filtragem estrutural, em relação a filtragem convencional, reside em facilitar
o processo de identificação automática dos refletores sísmicos, pois a continuidade dos refletores é realçada. Isso pode reduzir muito o tempo gasto na interpretação de uma imagem sísmica.
O tensor estrutural foi escolhido como um dos objetos de estudo desta dissertação, pois é uma ferramenta utilizada no processamento de imagens em geral, na filtragem ao longo das estruturas de uma imagem. Essa ferramenta tem diversas utilidades, como estudo de caraterísticas de imagens, para fins de comparação e correspondência de padrões (Forstner, 1986). Dentre as características que podem ser estudadas pelo tensor, se destacam a detecção de bordas e cantos em imagens (Harris e Stephens, 1988) e a análise da orientação de texturas em imagens (Kass e Witkin, 1987; Rao e Schunck, 1991).
O principal uso do tensor estrutural nesta dissertação é a obtenção da orientação ou inclinação local das estruturas em imagens sísmicas. Esse problema é de grande interesse na análise de dados sísmicos, pois pode-se utilizar inclinações locais para diversas tarefas de imageamento sísmico no domínio do tempo, como normal moveout e migração pré-empilhamento (Ottolini, 1983; Fomel, 2007c). Ademais, pode-se utilizar as inclinações locais para interpolação de dados (Fomel, 2002; Liu et al., 2010).
A utilização do tensor estrutural em dados sísmicos foi estudada diversas vezes no passado. Bakker (2002) fornece uma descrição abrangente das aplicações do tensor estrutural para filtragem de dados sísmicos. O tensor estrutural também pode ser utilizado para segmentar e identificar regiões de interesse em imagens sísmicas (Faraklioti e Petrou, 2005). Um dos exemplos desta aplicação consiste em detectar estruturas de importância geológica em dados sísmicos 3D, como paleocanais (Bakker et al., 2001). Por fim, um dos usos mais comuns do tensor estrutural, em Geofísica, reside na filtragem de imagens sísmicas por difusão anisotrópica (Hale, 2009; Lavialle et al., 2007; Fehmers e Hocker, 2003).
Neste trabalho, propõe-se estudar a utilização do tensor estrutural na obtenção da inclinação local de dados sísmicos. Em Geofísica, se utiliza comumente destruidores de onda plana (Claerbout, 1992) para obtenção dessas inclinações. Neste trabalho, é realizada uma comparação entre esse método e o tensor estrutural, para essas estimativas de inclinação. Como argumentado ao longo deste trabalho, a qualidade das estimativas de inclinação de ambos os métodos é comparável, porém o tensor tem a vantagem de ser rápido, conceitualmente simples e de implementação simples. Além disso, é possível
utilizar, sem maiores custos computacionais, as diversas propriedades derivadas do tensor estrutural no auxilio da interpretação das imagens sísmicas.
Como citado anteriormente, o tensor estrutural é comumente utilizado para filtragem por difusão anisotrópica. Diferindo dessa tendencia, é testada a possibilidade de utilizar as inclinações estimadas com o tensor estrutural para a filtragem preditora de estruturas (Liu et al., 2010). Esse filtro utiliza originalmente destruidores de onda plana para estimar as inclinações locais. Dentre as vantagens do filtro, destacam-se o fato de ser local e não-iterativo, além de numericamente estável, ao contrário da difusão anisotrópica. A possibilidade de utilizar as inclinações locais do tensor estrutural, com essa filtragem, é algo que não havia sido testado anteriormente, fazendo parte da contribuição desta dissertação de mestrado. É realizada a comparação desse método de filtragem com outro método, conhecido como filtragem adaptativa. Esse método consiste em rotacionar filtros gaussianos alongados, de acordo com a inclinação local, filtrando assim os dados ao longo das estruturas presentes na imagem.
1.1	Estrutura da dissertação
No Capítulo 2 é realizada a apresentação da teoria envolvendo a utilização do tensor estrutural. Nesse capítulo, é exibida a dedução do tensor estrutural a partir da função de diferenças quadráticas, bem como a sua relação com a estrutura local da imagem. Também é revisado como se estimar a linearidade local da imagem, a partir do tensor estrutural. A linearidade local indica o quão bem as estruturas de uma imagem podem ser aproximadas localmente por uma estrutura linear.
O Capítulo 3 apresenta como estimar a inclinação local a partir do tensor estrutural. Como é necessário comparar o tensor estrutural com outros métodos, a fim de aferir sua qualidade, nesse capítulo também são apresentadas duas implementações de destruidores de onda plana.
As duas técnicas de filtragem estrutural testadas neste trabalho são apresentadas no Capítulo 4. A primeira delas, chamada de filtragem adaptativa, consiste em rotacionar filtros gaussianos alongados ao longo da inclinação local da imagem. O segundo método apresentado é a filtragem preditora de estruturas (Liu et al., 2010). Como comentado anteriormente, propomos utilizar as inclinações do tensor estrutural para a realização
dessa filtragem, algo ainda nao testado em outros trabalhos.
No Capítulo 5 sao comparados os resultados dos testes de estimativa de inclinaçao local para diferentes dados de testes, utilizando o tensor estrutural e os destruidores de onda plana. Além disso, é estudado como a variaçao de certos parâmetros do tensor estrutural afeta as estimativas de inclinaçao. Também é mostrado como utilizar as estimativas de linearidade local, obtidas com o tensor estrutural, para melhorar as estimativas de inclinaçao local. Por fim, os dois métodos de filtragem estrutural, apresentados no Capítulo 4, sao testados em três conjuntos de dados, dois sintéticos e um real. Nesse capítulo sao apontadas algumas falhas dos métodos de filtragem apresentados, como a perda de sinal nas descontinuidades do dado.
O Capítulo 6 ilustra como utilizar medidas de similaridade para melhorar ambos métodos de filtragem estrutural, a fim de diminuir a perda de sinal nas descontinuidades dos dados sísmicos. Assim, os dados do Capítulo 5 sao filtrados novamente com essas melhorias e é realizada uma discussao final sobre os métodos de filtragem com as melhorias descritas anteriormente.
No último capítulo sao apresentadas as conclusões do trabalho, obtidas a partir das análises realizadas nos capítulos 5 e 6. Sao discutidas as diferenças entre as abordagens testadas para estimar a inclinaçao local. Ademais, é discutida a eficácia de cada filtro testado, em reduzir o ruído, preservando ao mesmo tempo o sinal e as descontinuidades presentes no dado.
2	O TENSOR ESTRUTURAL
O tensor estrutural é obtido através de operações simples de suavização utilizando janelas e diferenciação simples da imagem. Ele é comumente utilizado para detectar linhas e regiões de interesse em imagens. O tensor estrutural é conhecido por diferentes nomes, dependendo do campo de aplicação: gradient structure tensor, second-moment matrix, scatter matrix, interest operator e windowed covariance matrix (Faraklioti e Petrou, 2005).
2.1	Dedução do tensor
Há vários modos de se deduzir o tensor estrutural (Faraklioti e Petrou, 2005; Kothe, 2003; Fehmers e Hocker, 2003), sendo que cada um possui seu valor didático ou teórico. Kothe (2003), deduz o tensor estrutural a partir de operações simples sobre o vetor gradiente da imagem. Neste trabalho, optou-se por seguir a abordagem sugerida por Faraklioti e Petrou (2005), deduzindo o tensor estrutural por uma expansão de Taylor de primeira ordem da squared difference function ou função de diferenças quadráticas. Essa escolha foi feita para justificar, de modo mais didático, algumas relações do tensor estrutural com a estrutura local da imagem.
A função de diferenças quadráticas soma o quadrado das diferenças entre uma janela fixa W em torno do ponto de análise (x0,t0) e uma janela deslocada de (Ax,At), ponderada por pesos wi,j não negativos, como
E(xo,to)(Ax,At) =	Wij [P(xj + Ax,tj + At) - P(xi,tj)]2,	(2.1)
(i,j)ew
sendo (i,j) são os índices dentro da janela W, que podem ser dados por uma Gaussiana ou serem constantes, por exemplo. A intensidade do campo de onda registrado em (x,t) é dada por P(x,t). Por fim, todos os elementos chaves da função de diferenças quadráticas estão sumarizados na Figura 2.1.
Para pequenos deslocamentos (Ax, At), a função P(xi + Ax,tj + At) pode ser aproximada no em torno do ponto (xi,tj) utilizando a expansão em série de Taylor de
Figura 2.1: Parâmetros da função de diferenças quadráticas. O quadrado vermelho indica a posição da janela fixa em torno do ponto de análise (x0,t0). Por sua vez, o quadrado azul indica uma janela deslocada de (Ax,At).
primeira ordem, dada por
P(xi + Ax,tj + At) « P(xi, tj) + AxPx + AtPt.
(2.2)
As derivadas em x e t, denotadas respectivamente por Px e Pt, sao computadas no ponto (xi,tj). Manipulando os termos da equaçao anterior, obtemos
(P(xi + Ax,tj + At) - P(xi,tj))2 « (AxPx + AtPt)2
= Ax2 Px2 + 2AxAtPxPt + At2Pt2
= (Ax,At)
P2
x
PxPt
PxPt
Pt2
(Ax,At)T.
(2.3)
Substituindo a aproximação da equação 2.3 na equação 2.1, obtém-se uma aproximação de primeira ordem para a função de diferenças quadráticas
E(x0,t0)(Ax,At) = E wi;j (Ax,At)
(i,j)ew
Px2
x
PxPt
PxPt
Pt2
(Ax,At)T.
(2.4)
Como apenas as derivadas parciais e a função janela dependem de (xi,tj), a equação
anterior pode ser reescrita como
p(x0,t0) (Ax,At)	E (A x, A t)
(i,j)ew
= (Ax,At)
wi,j PX
wi,j PxPt
P	(PxPt)
(PxPt) P2)
wi,j PxPt
wi,j Pt2
(Ax,At)T
(Ax,At)T
(2.5)
= (Ax,At)M(Ax,At)T,
onde o símbolo {■) representa o valor médio produzido pela operação de suavização com os pesos Wi,j. A matriz M é o tensor estrutural e T denota a transposta de uma matriz.
O tamanho da janela, nesse caso, é denominado escala de integração. Devido à presença de ruído na imagem, é necessário suavizá-la antes de estimar as derivadas, de outro modo as derivadas estimadas serão muito ruidosas. Denomina-se escala local o tamanho da janela utilizada no procedimento de suavização (Faraklioti e Petrou, 2005).
2.2	Autovalores e estrutura local da imagem
Antes de explorar os autovalores é interessante estudar algumas características relacionadas ao tensor estrutural. De acordo com a equação (2.5), o tensor estrutural é simétrico, ou seja, M = MT. Também é possível mostrar que a matriz M é semi-definida positiva, ou seja,
(Ax,At)M(Ax,At)T &gt; 0.	(2.6)
para todo Ax e At. Esta relação provem diretamente da construção do tensor. De 2.5 e
2.3	provém
(Ax,At)M(Ax,At)T = E?(x0;Í0)(Ax, At) &gt; 0,	(2.7)
desde que os pesos witj sejam positivos.
Desse modo, como M é simétrica e semi-definida positiva os seus autovalores serão sempre reais e não-negativos. Esses autovalores podem ser utilizados para detectar linhas, bordas e regiões com intensidade constante em uma imagem. Esses cenários estão esboçados na Figura 2.2, juntamente com a função de diferenças quadráticas. Como citado no início do capítulo, escolheu-se deduzir o tensor estrutural a partir da função de diferenças quadráticas. Isso permite explorar a relação entre ambos para justificar as relações do
tensor estrutural com a estrutura local da imagem. As explicações que se seguem para os três casos apresentados na Figura 2.2 foram deduzidas para este trabalho.
(a) Intensidade constante.
(b) Linearidade local.
Figura 2.2: Versão simplificada de possíveis cenários em uma imagem, bem como sua relação com a função de diferenças quadráticas. O quadrado vermelho indica a posição da janela fixa em torno do ponto de análise (x0,t0). Por sua vez, o quadrado azul indica uma janela deslocada de (Ax,At). A função de diferenças quadráticas é uma soma ponderada ponto a ponto das diferenças quadráticas de amplitude da imagem entre os dois quadrados. Em (a) E(Ax, At) ~ 0, em qualquer direção na vizinhança de (x0,t0). Em (b), a seta vermelha indica uma direção onde ET não varia, já que as amplitudes da imagem nas regiões delimitadas por ambos quadrados é a mesma, ponto a ponto. Em (c) não há direção ao longo da qual ambos quadrados cobrem as mesmas amplitudes, ponto a ponto.
O primeiro caso a ser estudado será o de intensidade constante ou região homogênea na imagem. Nesse caso, é possível mover a janela azul em qualquer direção e a função de diferenças quadráticas será aproximadamente zero, devido ao ruído. Esse fato sugere que qualquer vetor x = (Ax, At)T não nulo é autovetor de M. Isso implica que todos os autovalores são aproximadamente zero. Mesmo considerando o ruído, é possível ver que (Px) 0 e (Pt) 0 devido ao fato de esses valores serem versões suavizadas das derivadas em uma região homogênea. Considerando esses conceitos e retomando a equação 2.5 é possível observar ainda que M « 0, logo
Mx « 0
(2.8)
Mx	0x
como x = 0, conclui-se que os autovalores associados com regiões homogêneas são aproximadamente zero.
O segundo caso de estudo contempla linhas ou qualquer região da imagem que possa ser descrita como localmente linear. Matematicamente falando, uma região localmente linear não apresenta variação em apenas uma direção (Bakker, 2002). Como indicado na Figura 2.2b, existe apenas uma possível direção onde não há variações do valor da função de diferenças quadráticas. Essa direção é paralela à linha ou região linear. Retomando a equação 2.5 novamente e assumindo que E &amp;amp; E &amp;amp; 0, obtém-se
xT Mx = 0.	(2.9)
É possível utilizar essa equação para mostrar que x é um autovetor de M. O primeiro passo consiste em realizar a decomposição espectral de M como
M = UAUt ,	(2.10)
sendo U uma matriz ortogonal cujas colunas são os autovetores normalizados de M e A uma matriz diagonal, sendo sua diagonal composta pelos autovalores de M. Como o tensor é uma matriz real, simétrica e semi-definida positiva, todos os seus autovalores são reais e não negativos. Pode-se, então, reescrever sua decomposição da seguinte forma
M = UA1/2A1/2Ut ,	(2.11)
onde A1/2 denota a raiz quadrada elemento a elemento da matriz A. Logo,
xT Mx = xT UA1/2A1/2Utx
= (xT UA1/2)(A1/2Ut x)
= (A1/2Utx)T (A1/2Utx)	(2.12)
= ||(A1/2Ut x)||2
= 0.
Logo, A1/2Ut x = 0, já que se trata de um vetor e sua norma Euclidiana é zero. Portanto Mx = UA1/2(A1/2Ut x)
= UA1/20	(2.13)
= 0.
Assim, x é um autovetor de M, associado ao autovalor zero. O outro autovalor é maior que zero, pois corresponde à direção ortogonal à região linear, onde há maior variação. Por fim, no caso de haver um canto na imagem, não é possível encontrar uma direção ao longo da qual não haja variação do valor da função de diferenças quadráticas, como ilustrado na Figura 2.2c. Portanto, ambos autovalores serão maiores do que zero. Para finalizar, o comportamento esperado para cada um dos três cenários descritos está sumarizado na Tabela 2.1.
Estrutura local	Autovalores
intensidade constante região linear canto	Ai « A2 « 0 Ai (T A2 ~ 0 Ai » A2 » 0
Tabela 2.1: Relaçao esperada entre os autovalores do tensor estrutural e a estrutura local da imagem (Faraklioti e Petrou, 2005).
2.3	Obtenção dos autovalores
Na seçao anterior foi discutida a relaçao dos autovalores da matriz M com a estrutura local da imagem. O próximo passo é determinar como calcular os autovalores adequadamente. Os autovalores de M sao as raízes da equaçao característica
A2 - ((PÓ + (P?)) A + (P?) (P2) - {Pjtf = 0.	(2.14)
As duas soluções dessa equaçao sao
Aj.2 = 2 ((Pb + (Pó) ± 2^(P) + (P?))? - 4 (&lt;P?)&amp;lt;P?) - (P-PÓ)	(2.15)
Observando a equaçao 2.15 é possível notar que ambos autovalores sao nao negativos e, da forma como foram ordenados, satisfazem a relaçao Ai &gt; A2 &gt; 0. De modo a evitar a perda de algarismos significativos, é recomendável computar os autovalores como
Ai = 2 ((p?) + (p,2)) + 2d((P?) +&amp;lt;P12&gt;)2 - 4 ((P?)&amp;lt;p,2) -	■	(2.16)
e
A2 —
(p2) (Pt2) - {PxPt}2
Ai
(2.17)
Os pesos para cada amostra dentro de cada janela são
Wi,j — exp
c2
(2.18)
sendo cx a metade da largura da janela W e ct a metade de sua altura, ou seja, para uma janela de 5 x 11 amostras, cx = 2,5 e ct = 5,5. Ademais, os pesos também foram normalizados antes do uso, dividindo o peso de cada amostra pela soma de todos os pesos da janela W.
2.4	Medindo a linearidade local
Como comentado anteriormente, os autovalores do tensor estrutural têm uma alta correlação com a estrutura local da imagem. Portanto, é natural que haja um modo de utilizar os valores de Ai e A2 para estimar quão lineares são as estruturas de uma imagem. De fato, isso pode ser realizado utilizando a seguinte expressão
A1 — A2
Ai + A2
(2.19)
Por definição C = 0 se Ai = A2 = 0.
Comparando a expressão anterior com os valores na Tabela 2.1 é possível observar claramente que 0 &amp;lt;C &amp;lt;1. Também é possível concluir que C 1 quando os dados podem ser representados localmente por estruturas lineares, i.e. quando A2 0 e A1 » 0. Em áreas com intensidade constante, C se aproxima de zero. Em caso de cantos na imagem, C assumirá num valor intermediário entre zero e um, pois A1 » A2 » 0, ou seja A1 — A2 &amp;lt;A1 + A2, logo 0 &amp;lt;C &amp;lt;1. Devido a essas propriedades, C pode ser considerada como uma medida de linearidade local dos dados (Bakker, 2002). Essa medida estima quão bem os dados podem ser representados localmente por uma estrutura linear, ou seja, que apresenta variação somente em uma direção.
3	INCLINAÇAO LOCAL
Figura 3.1: Exemplo esquemático de imagem com estruturas lineares. A imagem possui duas regiões distintas, a primeira delas, somente com estruturas lineares planas e paralelas, ou seja, com inclinaçao local constante. E a segunda regiao, com estruturas curvas, e portanto, com inclinaçao local variável.
As inclinações locais têm uma grande gama de aplicações no processamento de dados sísmicos, e podem ser utilizadas em praticamente todas as tarefas de imageamento sísmico no domínio do tempo, como normal moveout e migraçao pré-empilhamento em tempo (Ottolini, 1983; Fomel, 2007c). Além disso, as inclinações locais podem ser utilizadas para interpolar dados e filtrar ao longo das estruturas sísmicas (Fomel, 2002; Liu et al., 2010).
Para julgar a qualidade das inclinações locais estimadas com o tensor estrutural é necessário compará-las com as inclinações estimadas por métodos já bem estabelecidos em Geofísica. Para tanto, foram escolhidas duas implementações de destruidores de onda plana (Fomel, 2002; Schleicher et al., 2009). Assim, neste capítulo serào apresentadas três formas de estimar as inclinações locais de uma imagem sísmica: utilizando os autovetores do tensor estrutural ou uma das duas implementações de destruidores de onda plana.
3.1
Estimando a inclinação com os destruidores de onda plana
Os destruidores de onda plana foram propostos inicialmente por Claerbout (1992). A primeira formulação aqui estudada, sugerida por Fomel (2002), trata do destruidor de onda plana como um filtro preditor de erro em (t-x). Essa formulação utiliza minimização iterativa com regularização, para encontrar a inclinação local em cada ponto. Assim, seja a equação de onda plana dada por
Px + aPt = 0,	(3.1)
sendo P o campo de onda. Assumindo que a inclinação a = a(x,t) varia em ambas direções, é possível desenvolver um filtro local para propagar um traço a partir de seus vizinhos. Esse filtro foi desenvolvido com o auxílio de um esquema implícito de diferenças finitas para a equação de onda plana. Para esse método, foi utilizada a versão implementada no programa sfdip do pacote de processamento de dados multidimensionais Madagascar (Madagascar Development Team, 2012). Esse programa permite selecionar a precisão da aproximação do operador desenvolvido com o esquema de diferenças finitas implícitas. Assim, foi utilizada a aproximação de segunda ordem, suficientemente precisa para os testes propostos.
Seja a seção sísmica s = [si s2 s3 ... sn]T uma coleção de traços. O destruidor de ondas planas pode ser definido como um operador linear
r = D(a)s,	(3.2)
sendo D o destruidor de onda plana e r o seu resíduo. O destruidor de onda plana é representado como um operador linear não estacionário. A equação anterior leva ao sistema de equações
ri		I	0
r2		-Pi,2 (ai)	I
r3	=	0	-P2,3(a2)
rN		0	0
0	... 0		si
0	... 0		s2
I	. . . 0		s3
	— PN—i,N (aN—i)	1		sN
(3.3)
sendo I o operador identidade, ai o campo de inclinações locais e Pi;j(ai) um operador para predição do traço j à partir do traço i. O resíduo da operação é minimizado utilizando quadrados mínimos regularizados. Em essência, esse é o método proposto por Fomel (2010) para estimar a.
O segundo método, proposto por Schleicher et al. (2009), se baseia no ajuste dos dados à equação de onda plana dentro de uma janela móvel. As derivadas são estimadas para x e t, então a inclinação local é estimada ajustando a equação 3.1 aos dados dentro de uma pequena janela. Esse ajuste se dá por quadrados mínimos totais normalizados, com a inclinação a considerada constante dentro de cada janela. Sejam et(xi,tj-) e ex(xi,tj) os erros associados as estimativas de Px(xi,tj) e Pt(xi,tj), respectivamente, resolver o problema de mínimos quadrados anterior, se resume a minimizar
Rt(a, ex, et) =
E e2(xi,tj)	E e2t(xi,tj)
(w)ew______________+ (m)€W____________
E R2(xi,tj) E	Pt2(xi,tj)
(i,j)ew	(i,j)ew
sujeito a
(Px(xi,tj) + €x(xi,tj)) + a(Pt(xitj) + et(xi,tj)) = 0,
(3.4)
(3.5)
sendo i e j os índices dentro da janela W. Assim, para estimar a inclinação, é apenas necessário utilizar
am = -sinal I	Px(Xi,tj)Pt(xi,tj) I
\(i,j)ew	/
E	pX(xi, tj)
(i,j)eW__________
E	pt2(xi,tj),
(3.6)
\ (i,j)ew
sendo am a inclinação local estimada.
3.2	Estimando a inclinação com o tensor estrutural
O cálculo necessário para obter as inclinações locais a partir dos autovetores do tensor estrutural é simples. Sejam v1 e v2 autovetores correspondentes aos autovalores Ai e A2. Como discutido no capítulo 2, o autovetor v2 é paralelo às estruturas presentes nos dados, sendo assim perpendicular ao gradiente. É simples determinar que v2 = a((PxPt) ,A2 — (Px2))T, para qualquer escalar não nulo a, e v1 ortogonal a v2. Portanto, é
	A2	(Px	se (P Pt) » 0 (P,Pt) '	(P’Pt)* 0
a =&amp;lt;	(3.7) (PxPt) - -	, caso contrário. . Ai - r
4	FILTRAGEM DE DADOS SÍSMICOS
No Capítulo 3, foram apresentados três modos de se obter as inclinações locais de imagens, utilizando o tensor estrutural ou duas implementações distintas de destruidores de ondas planas. Sendo este último método, específico para dados sísmicos. Este capítulo apresenta como filtrar dados sísmicos utilizando diferentes técnicas. Um exemplo introdutório dessas técnicas, utilizando uma imagem de teste (adaptada de Bakker, 2002), é apresentado na Figura 4.1, comparando a imagem de exemplo com as versões filtradas utilizando suavização Gaussiana convencional e filtragem estrutural.
(a) Dados originais.
(b) Filtragem Gaussiana. (c) Filtragem estrutural.
Figura 4.1: Comparação entre diferentes esquemas de filtragem para a imagem em (a). Essa imagem é filtrada com um filtro Gaussiano convencional em (b) e utilizando filtragem estrutural em (c).
Como exibido na figura anterior, as duas filtragens são bem sucedidas em reduzir o ruído da imagem. Entretanto, a filtragem estrutural filtra ao longo das inclinações locais das estruturas da imagem de exemplo, preservando melhor as estruturas e texturas da imagem, como ilustrado comparando a imagem original na Figura 4.1a com as versões filtradas nas figuras 4.1b e 4.1c. Filtragem ao longo das estruturas presentes em uma imagem é uma das aplicações do tensor estrutural (Weickert, 1999). Por esse motivo, escolheu-se utilizar esse tipo de filtragem como exemplo de uso do tensor estrutural, embora haja outras aplicações interessantes para essa ferramenta, como detecção de bordas e cantos (Kothe, 2003).
4.1
Filtragem adaptativa
Existem vários meios de filtrar ao longo das estruturas presentes em uma imagem sísmica, como filtragem utilizando difusão anisotrópica (Lavialle et al., 2007) ou rotacio-
nando núcleos Gaussianos alongados ao longo das inclinações locais dos eventos sísmicos (Haglund, 1991), como ilustrado na Figura 4.2a. Para fins de testes de desempenho, escolheu-se comparar dois tipos diferentes de filtragem: filtragem adaptativa utilizando
núcleos alongados e filtragem estrutural utilizando predição de ondas planas (Liu et al.,
2 c2
2 Ci
(a) Rotaçao ao longo das estruturas.
(b) Implementaçao simples. (c) Implementação combi-
nando filtros isotrópicos.
Figura 4.2: Duas implementações diferentes para filtragem adaptativa (a): A implementação utilizando apenas um núcleo alongado (b) e a implementação combinando diversos núcleos isotrópicos (c). Na primeira implementação, o tamanho do núcleo Gaussiano é determinada pelos parâmetros cx e ct da equação (4.4) (adaptado de Bakker, 2002).
G(xo,ío) = —
Kc
A fim de facilitar a compreensão e testar a eficácia da filtragem adaptativa, também será testada a filtragem Gaussiana convencional, dada por
wi,j PL	(4-
sendo (i,j) os índices dentro da janela W centrada no ponto filtrado (x0,t0). Os pesos wi,j são dados pela equação (2.18) e Kc, dado por
Kc	yw wi,j■	(4.2)
(i,j)ew
É possível implementar a filtragem adaptativa utilizando núcleos alongados de dois modos: utilizando apenas um núcleo alongado (Figura 4.2b) ou combinando diversos núcleos isotrópicos (Figura 4.2c). Por simplicidade foi escolhida a primeira implementação, que é análoga à implementação da filtragem Gaussiana convencional. Assim, o valor
filtrado do ponto (xo,to) é dado por
Gd (xo,tQ) =
1
Ke (xo,to)
(4.3)
gi,j (0) P (xi,tj ),
sendo (i,j) os índices dentro da janela W centrada no ponto filtrado e 0 o ângulo da inclinação local estimada para esse ponto. O tamanho do núcleo Gaussiano
...	( (i sin 0—j cos 0)2	(i cos 0 + j sin 0)2\
9i,j (0) = exp —---------2-------- - --------T-------- ,	(4.4)
\	Cx	ct	/
é determinado pelos parâmetros cx e ct. Os valores filtrados também são divididos pelo
fator de normalização	K(xo,to) =	gi,j(0).	(4.5) (i,j)ew
Desse modo, para um núcleo Gaussiano com suporte de aproximadamente 11 x 5 amostras, os parâmetros serão cx = 5.5 e ct = 2.5, respectivamente. O ângulo 0 da inclinação local não precisa ser calculado, pois é possível obter diretamente os senos e cossenos utilizando somente a inclinação local e relações trigonométricas básicas. Por fim, a janela W deve ser grande o bastante para permitir a livre rotação do núcleo Gaussiano.
4.2	Filtro preditor de estruturas
Como citado anteriormente, o segundo método de filtragem ao longo das estruturas estudado é a filtragem estrutural utilizando predição de ondas planas (Liu et al., 2010). Um esboço com o esquema de filtragem é exibido na Figura 4.3.
Um traço pode ser predito deslocando suas amostras de acordo com a inclinação local. Considerando o operador de predição Pi;j- (ai) como um operador para predizer o traço j a partir do traço i, de acordo com as inclinações locais ai (consulte Fomel (2002) e Fomel (2010) para maiores detalhes), é possível predizer um traço a partir de um vizinho distante utilizando recursão simples. Então, predizer o traço k a partir do traço 1 é simplesmente
Pi,k = Pfe-i,fc ••• P2,3 Pi,2.	(4.6)
Liu et al. (2010) utilizaram com sucesso o filtro preditor de estruturas com as
Estimar inclinação local Predizer traço à partir Empilhar
dos vizinhos
Figura 4.3: Esquema de funcionamento para o filtro preditor de estruturas, para o traço em azul. Depois de estimar a inclinação local para todos os pontos nos dados, o traço original pode ser predito deslocando as amostras dos traços vizinhos de acordo com as inclinações locais. Traços mais distantes podem ser utilizados com recursão. Nessa figura, apenas os vizinhos imediatos são utilizados. Após a predição, é realizada uma média dos valores dos traços preditos juntamente com os valores do traço original, realizando assim a filtragem preditora de estruturas.
inclinações estimadas com os destruidores de onda plana. Propõe-se então, utilizar as inclinações estimadas com o tensor estrutural, a fim de testar seu desempenho. Depois de estimar as inclinações, os traços são preditos a partir de seus vizinhos. Então, é realizada uma média entre os valores das amostras correspondentes dos traços originais juntamente com os traços preditos, realizando desse modo a filtragem estrutural.
5	RESULTADOS NUMÉRICOS
Nos capítulos anteriores foi revisado como obter a inclinação local das estruturas de uma imagem, bem como utilizar essas inclinações para filtrar as imagens ao longo de suas estruturas. Neste capítulo, propõe-se testar a teoria apresentada anteriormente, utilizando para tanto diversos dados sísmicos sintéticos e um dado sísmico real.
5.1	Dados de teste
A fim de estudar as propriedades do tensor estrutural foram escolhidos quatro dados diferentes. O primeiro, ilustrado na Figura 5.1, é composto de cinco eventos planos com diferentes inclinações: 0,3; 0,17; 0,0; -0,17 e -0,3 s/km, respectivamente. Todos os eventos tem a mesma intensidade e são compostos de pulsos de Ricker, com frequência central de 20 Hz. A resolução desse dado é de 200 x 200 pixels, espaçados de 4 m no eixo x e 4 ms no eixo t. Por fim, foi adicionado ruído branco sintético ao dado.
x (km)
0	0.1	0.2	0.3	0.4	0.5	0.6	0.7
Figura 5.1: Dado sintético composto de cinco eventos planos.
O segundo dado foi criado para uma análise mais criteriosa das estimativas de inclinação com o tensor estrutural e os outros métodos estudados. Esse dado é descrito pela equação
P (x,t) = sin(20nt — 10n sin(2nx))
(5.1)
e exibido na Figura 5.2. O dado é composto por 250 x 250 amostras, com espaçamento de 4 m em x e 4 ms em t. A vantagem desse dado é a possibilidade de se obter valores analíticos para as derivadas e inclinações locais.
x (km)
Figura 5.2: Dado sintético para testes de inclinação. Composto de 250 x 250 amostras, espaçadas de 4 m em x e 4 ms em t. Em verde os diversos tamanhos de janelas (escala de integração) utilizados para testes com o tensor estrutural e os outros métodos estudados.
O terceiro dado, representado na Figura 5.3, é um ambiente sedimentar sintético. Proposto por Claerbout (1992), esse dado tem resolução de 200 x 200 amostras, espaçadas de 8 m no eixo x e 4 ms no eixo t.
Figura 5.3: Modelo sedimentar sintético.
O quarto dado, representado na Figura 5.4, simula metade de um domo, composto
x (km)
0	0.2	0.4 0.6	0.8	1	1.2	1.4	1.6	1.8
;- L... . .....	------
Figura 5.4: Modelo sintético de meio domo.
Por fim, foram realizados testes utilizando o dado exibido na Figura 5.5. Esse dado é uma seção sísmica histórica do Golfo do México (Claerbout e Green, 2010). Essa seção sísmica em tempo tem resolução de 250 x 876 amostras, sendo a taxa de amostragem no tempo de 4 ms. Cada traço é composto de dados CMP (Common midpoint) empilhados e migrados em tempo, por simplicidade o espaçamento entre traços foi considerado unitário.
O dado também foi filtrado com um filtro AGC (Automatic Gain Control). Esse filtro tem por objetivo equalizar as amplitudes dos eventos em um dado sísmico. Para isso, cada amostra do dado é dividida pelo valor da amostra respectiva em uma versão suavizada do dado. Nesse caso, para a suavização do dado, foi realizada a convolução de cada traço com uma janela triangular de meio segundo, dada por
w(t) = 1 — |4t|.
(5.2)
cmp
0	50	100	150	200
Figura 5.5: Seção sísmica histórica migrada em tempo do Golfo do México. O dado é exibido somenta a partir de t = 0,3 s.
5.2	Testes com o dado o plano
Como o dado plano é o mais simples dentre os dados escolhidos para estudo, optouse por iniciar a comparação dos métodos de estimativa de inclinação local por este dado. Para esse caso, foi utilizada uma janela de 5 x 11 amostras para o tensor estrutural e os destruidores de onda plana local. Essa escolha é baseada em testes empíricos, explicados mais adiante na seção 5.3.
As derivadas em x e t do campo de ondas P, utilizadas pelo tensor estrutural, na equação 3.7, e pelos destruidores de onda plana local, na equação 3.6, foram estimadas utilizando o programa sfsmoothder do pacote Madagascar (Madagascar Development Team, 2012). Esse programa utiliza regularização para estimar a primeira derivada de modo suave. Para esse procedimento foram utilizados os parâmetros padrões do programa. Para melhorar os resultados, as derivadas foram submetidas a suavização Gaussiana, dada pela equação 4.1, com suporte de 5 x 5 amostras, ou seja, cx = ct = 2.5.
Na Figura 5.6, os três métodos de estimativa de inclinação local, apresentados no Capítulo 3, são comparados para o dado com eventos planos. Comparando as figuras 5.6a e 5.6b é possível concluir que o tensor estrutural e a implementação local dos destruidores de onda plana são visualmente equivalentes, para esse dado. Apesar de mais suaves, as inclinações locais estimadas pela implementação global dos destruidores de onda plana são comparáveis as estimativas do tensor estrutural. Isso pode ser aferido comparando-se
os valores de inclinação apenas nas posições dos eventos, pois são nessas regiões onde a inclinação local está definida.
Como é simples amostrar as inclinações estimadas para cada evento plano, foi construído o gráfico da Figura 5.7. Cada curva foi construída amostrando as inclinações estimadas por cada método na posição central de cada evento. As linhas retas pretas representam o valor real de inclinação de cada evento.
inclinação (s/km)
(a) Tensor estrutural.
inclinação (s/km)
(b) Destruidor de onda plana local.
-0.6	-0.4	-0.2	0	0.2	0.4	0.6
inclinação (s/km)
(c) Destruidor de onda plana global.
Figura 5.6: Comparação das inclinações locais obtidas com o tensor estrutural (a), e as implementações local (b) e global (c) dos destruidores de onda plana para o dado com eventos planos (Figura 5.1).
Comparando as três curvas para cada evento plano, ilustradas na Figura 5.7, é possível reafirmar que as inclinações do tensor estrutural são praticamente equivalentes
Figura 5.7: Inclinações estimadas para os cinco eventos planos utilizando o tensor estrutural (vermelho) e as implementações local (verde) e global (azul) dos destruidores de onda plana. Cada uma das curvas foi construída amostrando as inclinações estimadas na posição central de cada evento, e cada linha reta representa um dos respectivos eventos presentes no dado.
A maior diferença observada entre os métodos, está na inclinação estimada para o evento horizontal, que é bem mais ruidosa para o destruidor de onda plana local. Esse problema pode ser facilmente contornado utilizando uma medida de coerência para descartar valores mal estimados (Schleicher et al., 2009). Com exceção desse último caso, as inclinações exibidas nesse gráfico oscilam próximas aos valores reais de inclinação para os cinco eventos: 0,3; 0,17; 0; -0,17 e -0,3 s/km, respectivamente.
5.3	Estudando critérios para escolha de tamanho da janela
Para estudar melhor como o tamanho da janela utilizada afeta os resultados, o dado sintético da Figura 5.2 foi criado. Esse dado é descrito pela equação (5.1). Embora seja simples obtê-lo, esse dado possui várias propriedades interessantes. A primeira delas é a presença de vários valores de inclinação, bem como curvaturas positivas e negativas. Alguns desses valores de inclinação são acentuados, permitindo uma melhor análise de precisão. Além disso, é importante avaliar como a curvatura afeta os métodos testados, o que não é possível com o dado plano testado anteriormente.
A inclinação local desse dado em qualquer ponto (x,t) é dada por
a = —
—- = n cos(2nt)
—x
(5.3)

As inclinações teóricas da equação (5.3) estão ilustradas na Figura 5.8d, ao lado das inclinações estimadas com o tensor estrutural na Figura 5.8a, e com os destruidores de onda plana local e global, exibidos nas figuras 5.8b e 5.8c, respectivamente. Foi utilizada, como exemplo, uma janela de 5 x 11 amostras para o tensor estrutural e para os destruidores de ondas planas locais, essa escolha será justificada mais adiante.
inclinação (s/km)
(a) Tensor estrutural.
inclinação (s/km)
(b) Destruidor de onda plana local.
x (km)
-3-2-10	1	2	3
inclinação (s/km)
x (km)
-3-2-10	1	2	3
inclinação (s/km)
(d) Inclinação local real.
(c) Destruidor de onda plana global.
Figura 5.8: Comparação entre as inclinações locais para o dado sintético para testes de inclinação local (Figura 5.2). São comparadas as inclinações obtidas com o tensor estrutural (a), e as inclinações locais estimadas utilizando a implementação local (b) e global (c) dos destruidores de onda plana com a inclinação local analítica (d). Para as figuras (a) e (b), foi utilizada uma janela de 5 x 11 amostras na estimativa de inclinação.
De modo análogo ao dado plano, foram amostradas as inclinações locais estimadas nas figuras anteriores para t = 0,5 s. Essas inclinações estão comparadas na Figura 5.9. Nessa figura fica claro que todos os métodos estimados possuem problemas com inclinações muito acentuadas. Entretanto, é difícil extrair maiores informações deste gráfico. Dessa forma, propõe-se analisar a precisão de cada método de modo simples: criando gráficos que ilustram como o erro médio para a inclinação estimada varia em função da inclinação teórica. Para tanto, basta apenas calcular a média e desvio padrão
Figura 5.9: Inclinações locais estimadas para o dado sintético para testes de inclinação. São exibidas as inclinações estimadas utilizando o tensor estrutural (vermelho) e as implementações local (verde) e global (azul) dos destruidores de onda plana. Também são mostradas as inclinações teóricas (preto). Cada uma das curvas foi construída amostrando as inclinações estimadas para t = 0,5 s.
Esse procedimento foi realizado para diferentes tamanhos de janela nas figuras 5.10 e 5.11, comparando o tensor e as implementações global e local dos destruidores de onda plana, respectivamente. Nestas figuras, a posição central de cada faixa corresponde ao valor médio do erro entre a inclinação teórica e a estimada. A espessura de cada faixa, por sua vez, corresponde a duas vezes o desvio padrão do erro associado. Essa análise é mais informativa que a análise simples da Figura 5.9, pois contém mais informações e estimativas de inclinação. Por fim, para facilitar a comparação, todos os tamanhos de janela utilizados também estão representados na Figura 5.2.
Uma tendência interessante é o fato de o tensor estrutural superestimar as inclinações muito acentuadas, enquanto o destruidor de ondas planas global parece subestimar ou superestimar, dependendo do sinal da inclinação. O erro médio do tensor estrutural, indicado pela altura da faixa, não parece mudar significativamente com o tamanho da janela. Analisando as figuras 5.10e e 5.10f, é possível argumentar que, com uma escolha adequada para o tamanho da janela, o tensor estrutural pode ser mais preciso que o destruidor de ondas planas global.
A comparação entre o tensor estrutural (em vermelho) e os destruidores de onda plana locais (em azul) é realizada na Figura 5.11. De maneira geral, esse método apresenta menos variação nos erros de estimativa de inclinação local, em comparação ao tensor estrutural, como visto nas figuras 5.11e e 5.11f, por exemplo. Isso é ilustrado pelo fato da espessura das suas faixas serem sempre um pouco menores, para cada tamanho de janela. Porém, sua precisão é menor, subestimando e superestimando muito mais as inclinações mais acentuadas.
Outro efeito observado, para esse método, é o salto entre as inclinações intermediárias, que parece piorar à medida que o tamanho da janela aumenta. Esse efeito também está presente em janelas menores, como evidenciado na Figura 5.11a. Entretanto, é possível contornar esse problema, utilizando alguma medida de coerência para descartar valores anômalos, como por exemplo a correlação cruzada normalizada (Schleicher et al., 2009). Também é possível utilizar um procedimento similar para o tensor, utilizando a medida de linearidade local estimada pela equação (2.19).
Como comentado anteriormente, os experimentos sobre acurácia do tensor estrutural, das figuras 5.10 e 5.11, sugerem que a janela mais adequada para o tensor estrutural é a janela de 5 x 11 amostras. Ainda sim, cuidado deve ser tomado, pois esse resultado é apenas fruto de um estudo empírico sobre o tensor estrutural e não pode ser facilmente generalizado.
inclinação (s/km)
(a)	Janela de 5 x 5
inclinação (s/km)
(b)	Janela de 5 x 7
inclinação (s/km)
inclinação (s/km)
(c) Janela de 5 x 11
(d) Janela de 7 x 7
inclinação (s/km)
(e) Janela de 7 x 11
inclinação (s/km)
(f) Janela de 11 x 11
Figura 5.10: Comparação de estimativas de inclinação local entre o tensor estrutural (em vermelho) e a implementação global dos destruidores de onda plana (em verde). Cada gráfico ilustra os resultados para um tamanho de escala de integração em pixels. É importante ressaltar que as faixas são semi-transparentes.
inclinação (s/km)
inclinação (s/km)
(a) Janela de 5 x 5
inclinação (s/km)
(b) Janela de 5 x 7
inclinação (s/km)
(c) Janela de 5 x 11
(d) Janela de 7 x 7
inclinação (s/km)
(e) Janela de 7 x 11
inclinação (s/km)
(f) Janela de 11 x 11
Figura 5.11: Comparação de estimativas de inclinação local entre o tensor estrutural (em vermelho) e a implementação local dos destruidores de onda plana (em azul). Cada gráfico ilustra os resultados para um tamanho de escala de integração (ou janela W) em pixels. É importante ressaltar que as faixas são semi-transparentes.
Antes de calcular a inclinação para os demais dados, é interessante estudar os autovalores do tensor, já que deles se derivam diversos tipos de atributos, que podem ser utilizados para melhorar as estimativas de inclinação. Um desses atributos é a medida de linearidade local, dada pela equação (2.19). Essa medida pode ser utilizada para estimar a coerência de dados sísmicos. Os dados sísmicos são compostos de diferentes tipos de texturas, alguns desses tipos estão indicados na Figura 5.12.
(b) Divergente.
(c) Ondulada.	(d) Caótica.
Figura 5.12: Exemplos esquemáticos de diferentes tipos de texturas presentes em dados sísmicos. (adaptado de Schlaf et al., 2005).
As texturas indicadas nas figuras 5.12a, 5.12b e 5.12c são exemplos de texturas coerentes, ou seja, possuem uma direção preferencial e linearidade local. A textura caótica da Figura 5.12d, por sua vez, não é considerada coerente, pois não possui linearidade local bem definida. Assim, como a coerência está relacionada à presença de linearidade local, pode-se utilizar a medida de linearidade local da equação (2.19), para estimar a coerência.
Pode-se então criar máscaras de coerência, a fim de remover valores de inclinação possivelmente mal estimados. Neste trabalho, optou-se por manter as inclinações associadas a coerências maiores que 0,7. Também foi utilizada uma janela de 5 x 11 amostras para o cálculo dos autovalores, como sugerido pelos testes da seção 5.3.
Para o dado com os eventos planos, os autovalores, coerência e a respectiva máscara, se encontram na Figura 5.13. Para o dado de teste de inclinação e o dado sedimentar sintético, os autovalores e coerência estão registrados nas figuras 5.14 e 5.15, respectivamente. A coerência e os autovalores do tensor estrutural no caso do meio domo sintético se encontram na Figura 5.16. Por fim, os autovalores do dado real histórico estão representados na Figura 5.17.
ó
ó
ó
50	100 150 200 250 300 350 400 450
magnitude
x (km)
magnitude
(b) Segundo autovalor.
(a) Primeiro autovalor.
x (km)
0	0.1	0.2	0.3	0.4	0.5	0.6	0.7
0.1	0.2	0.3	0.4	0.5	0.6	0.7	0.S	0.9
coerência
x (km)
0	0.1	0.2	0.3	0.4	0.5	0.6	0.7
(c) Coerência.
(d) Máscara de coerência.
Figura 5.13: Coerência e autovalores do tensor estrutural para o modelo com eventos planos. Na máscara de coerência, os valores associados a altas coerências se encontram em cinza.
Com exceção de poucas amostras espalhadas pelo dado, os valores de coerência do dado para testes de inclinação são todos maiores que 0,7, assim optou-se por omitir sua máscara. Os valores de coerência calculados para o dado real, por sua vez, foram muito altos, sempre acima de 0,9, e por esse motivo optou-se por não exibi-los aqui. Isso provavelmente se deve ao fato de A2 ser muito menor que A1, nesse caso em particular, como ilustrado comparando as figuras 5.17a e 5.17b. Com isso, podem haver problemas numéricos não desejados na equação 2.19.
0.8	0.6	0.4	0.2
x (km)
0	0.1	0.2 0.3	0.4 0.5 0.6	0.7 0.8	0.9
1000 2000 3000 4000 5000 6000 7000 8000
magnitude
50	100	150	200	250	300	350
magnitude
(a)	Primeiro autovalor.
(b)	Segundo autovalor.
x (km)
0	0.1	0.2 0.3	0.4 0.5	0.6	0.7	0.8 0.9
0.1	0.2	0.3	0.4	0.5	0.6	0.7	0.8	0.9
coerência
(c)	Coerência.
Figura 5.14: Coerência e autovalores do tensor estrutural para o dado para teste de inclinação local.
0.01	0.02	0.03	0.04
magnitude
(a)	Primeiro autovalor.
x (km)
0	0.2	0.4	0.6	0.8	1	1.2	1.4
0.0005	0.001	0.0015
magnitude
(b)	Segundo autovalor.
x (km)
O 0.2	0.4	0.6	0.8	1	1.2	1.4
0.1	0.2	0.3	0.4	0.5	0.6	0.7	0.8	0.9
coerência
(c)	Coerência.
x (km)
0	0.2	0.4	0.6	0.8	1	1.2	1.4
(d)	Máscara de coerência.
Figura 5.15: Coerência e autovalores do tensor estrutural para o modelo sedimentar sintético. Na máscara de coerência, os valores associados a altas coerências se encontram em cinza.
x (km)
O 0.2	0.4	0.6	0.8	1	1.2	1.4	1.6	1.8
0.01	0.02	0.03	0.04	0.05
magnitude
x (km)
0	0.2	0.4	0.6	0.8	1	1.2	1.4	1.6	1.8
0.0005	0.001	0.0015	0.002
magnitude
(a)	Primeiro autovalor.
(b)	Segundo autovalor.
x (km)
0	0.2	0.4	0.6	0.8	1	1.2	1.4	1.6	1.8
x (km)
0	0.2	0.4	0.6	0.8	1	1.2	1.4	1.6	1.8
0.2	0.3	0.4	0.5	0.6	0.7	0.8	0.9
coerência
(c)	Coerência.
(d) Máscara de coerência.
Figura 5.16: Coerência e autovalores do tensor estrutural para o meio domo sintético. Na máscara de coerência, os valores associados a altas coerências se encontram em cinza.
5000	10000	15000	20000
0	50	100	150	200
co
0.02	0.04	0.06	0.08	0.1	0.12
magnitude
(b) Segundo autovalor.
magnitude
(a) Primeiro autovalor.
Figura 5.17: Autovalores do tensor estrutural para o dado de campo histórico.
É importante ressaltar que os valores de A2 são claramente maiores nas falhas normais presentes no dado real, como ilustrado na Figura 5.17b. Esse comportamento é previsível. Retomando as relações entre A1 e A2, listadas na Tabela 2.1, é possível ver que as falhas podem ser consideradas como cantos ou bordas. Esse comportamento para os autovalores é condizente com interpretação geológica, considerando que as falhas são registradas como terminações e descontinuidades na superfície dos eventos sísmicos. Por fim, como comentado no Capítulo 2, os valores de coerência também refletem a linearidade local dos dados, como ilustrado nas figuras 5.13c e 5.13d, onde os valores próximos de zero se encontram nas áreas homogêneas entre os planos.
5.5	Estimativas de inclinação local para filtragem dos dados
Nas sessões anteriores, foi revisado como o tamanho da janela afeta os dados e como criar máscaras de coerência a fim de remover estimativas de inclinação pouco confiáveis. Nesta seção, essas informações são utilizados para auxiliar nas estimativas de inclinação dos dados que serão utilizados para filtragem. Assim, foi escolhida uma janela de 5 x 11 amostras, como sugerido na seção 5.3. As máscaras de coerência da seção 5.4 também foram utilizadas. Os valores de inclinação removidos por essas máscaras, são substituídos por valores criados a partir dos pixels na vizinhança da área removida.
Esse tipo de procedimento de preenchimento, ou reconstrução, de regiões de uma
imagem é conhecido como inpainting. A essência do inpainting reside em preencher as regiões reconstruídas de modo suave, sem borrar a imagem. Para essa tarefa, foi escolhido o algoritmo criado por Telea (2004), por sua simplicidade e boa velocidade de execução. De modo geral, esse algoritmo preenche as regiões danificadas de uma imagem utilizando informações dos pixels próximos a borda, como por exemplo o gradiente. O preenchimento dessas regiões se dá de forma iterativa, preenchendo primeiro os valores mais próximos da borda, e então avançando mais um passo na direção do interior da região a ser preenchida. Dessa forma, as regiões danificadas de uma imagem são preenchidas das bordas para dentro, de forma iterativa.
Assim, foram estimadas as inclinações da seção sedimentar sintética, do meio domo sintético e do dado histórico de campo. Esses resultados estão ilustrados nas figuras 5.18, 5.19 e 5.20 respectivamente. As linhas pretas nas figuras 5.18a, 5.18b, 5.19a e 5.19b, representam as regiões afetadas pelas máscaras de coerência de cada dado, ilustradas nas figuras 5.15d e 5.16d. É possível perceber que alguns valores anômalos de inclinação foram removidos, comparando as estimativas de inclinação, com e sem máscara, nas figuras 5.18a e 5.18b, para o dado sedimentar sintético. O mesmo efeito também pode ser percebido comparando as figuras 5.19a e 5.19b, para o meio domo sintético.
Ao comparar as figuras 5.18a e 5.18d, é possível perceber que as estimativas de inclinação do tensor estrutural ainda são um pouco menos suaves que a implementação global dos destruidores de onda plana. Esse fato também é observável comparando as figuras 5.19a e 5.19d ou 5.20a e 5.20c. As inclinações obtidas com o tensor estrutural são baseadas em somas sobre as derivadas do dado. Essas derivadas podem ser um pouco ruidosas, mesmo depois de suavizadas. Uma possível saída para esse problema é aumentar a suavização dos dados. Esse procedimento pode ser realizado mudando as escalas local e de integração. Um dos problemas em se aumentar demais a suavização é o aumento associado da degradação das inclinações estimadas.
u H	'	1
o
ó
02
O
co
ó
ó
ó
co
ó
ó
x (km)
0	0.2	0.4	0.6	0.8	1	1.2	1.4
ó
-0.6	-0.4	-0.2	0	0.2	0.4	0.6
inclinação (s/km)
-0.6	-0.4	-0.2	0	0.2	0.4	0.6
inclinação (s/km)
(a) Tensor estrutural (sem máscara).
o
ó
02
Ó
CO
ó
(w
ó
m
ó
co
o
o-
ó
x (km)
0	0.2	0.4	0.6	0.8	1	1.2	1.4
-0.6	-0.4	-0.2	0	0.2	0.4	0.6
inclinação (s/km)
(b) Tensor estrutural (com máscara).
x (km)
0	0.2	0.4	0.6	0.8	1	1.2	1.4
o-|^=-
ó'
02
-0.6	-0.4	-0.2	0	0.2	0.4	0.6
inclinação (s/km)
(d) Destruidor de onda plana global.
(c)	Destruidor de onda plana local.
x (km)
0	0.2	0.4	0.6	0.8	1	1.2	1.4
o
02
o
-0.6	-0.4	-0.2	0	0.2	0.4	0.6
inclinação (s/km)
(e)	Tensor estrutural suavizado.
Figura 5.18: Comparação entre as inclinações locais para o modelo sedimentar sintético (Figura 5.3). As inclinações obtidas com o tensor estrutural estão em (a) e (b). Em (e) uma versão suavizada de (b). Por fim, as inclinações locais estimadas utilizando a implementação local (c) e global (d) dos destruidores de onda plana.
(a) Tensor estrutural (sem máscara).
inclinação (s/km)
(b) Tensor estrutural (com máscara).
(c) Destruidor de onda plana local.
x (km)
(d) Destruidor de onda plana global.
inclinação (s/km)
(e) Tensor estrutural suavizado.
Figura 5.19: Comparação entre as inclinações locais para o meio domo sintético (Figura 5.4). As inclinações obtidas com o tensor estrutural estão em (a) e (b). Em (e) uma versão suavizada de (b). Por fim, as inclinações locais estimadas utilizando a implementação local (c) e global (d) dos destruidores de onda plana.
cmp (s)
-0.01	-0.005	0	0.005	0.01
inclinação (s/cmp)
(a) Tensor estrutural.
cmp (s)
0	50	100	150	200
-0.01	-0.005	0	0.005	0.01
inclinação (s/cmp)
(b) Destruidor de onda plana local.
-0.01	-0.005	0	0.005	0.01
inclinação (s/cmp)
(d)	Tensor estrutural suavizado.
-0.01	-0.005	0	0.005	0.01
inclinação (s/cmp)
(c) Destruidor de onda plana global.
Figura 5.20: Comparação entre as inclinações locais para o dado histórico migrado no tempo (Figura 5.5). As inclinações obtidas com o tensor estrutural estão em (a). Uma segunda versão (d) dessas inclinações foi obtida suavizando (a) três vezes com uma janela triangular de 7 x 7 amostras. Por fim, as inclinações locais para o mesmo dado, estimadas utilizando a implementação local (b) e global (c) dos destruidores de onda plana.
Essas inclinações são visualmente similares aos resultados obtidos com a implementação global dos destruidores de onda plana, como visto comparando as figuras 5.18d e 5.18e para o dado sedimentar sintético e as figuras 5.19d e 5.19e, para o meio domo sintético. É possível chegar a conclusões similares comparando as figuras 5.20c e 5.20d para o dado real histórico. Com isso, é possível argumentar com maior certeza que as inclinações do tensor estrutural são equivalentes as do destruidor de ondas planas global, sendo esta última apenas um pouco mais suave.
5.6	Tempos de execução das estimativas de inclinação
Foram realizados testes de tempo de execução gasto nas estimativas de inclinação. Foram medidos os tempos de execução da implementação global dos destruidores de onda plana, contra o tensor estrutural. Os destruidores de onda plana local não foram testados porque sua implementação é muito similar a do tensor estrutural.
O tensor estrutural foi implementado utilizando os programas de convolução, derivação e operações matemáticas presentes no Madagascar, ou seja, não é uma implementação totalmente otimizada. Os testes de velocidade de execução foram executados utilizando um desktop equipado com um Intel Core i5 e 8 GB de RAM. Foram realizados 100 testes para os tempos de execução para o dado histórico do Golfo do México, foi calculada a média e o desvio padrão dos tempos de execução de cada método. Nos testes, o tensor estrutural foi aproximadamente dez vezes mais rápido, com um tempo médio de execução de 56 ± 9 ms, contra 680 ± 3 ms dos destruidores de onda plana.
5.7	Filtragem dos dados sintéticos e real
Os métodos de filtragem apresentados anteriormente foram aplicados para filtragem do dado sedimentar sintético (Figura 5.3), para o meio domo sintético (Figura 5.4) e para o dado histórico do Golfo do México (Figura 5.5). O primeiro filtro testado foi a filtragem Gaussiana convencional, dada pela equação (4.1). O filtro utilizado possui suporte de 5 x 5 amostras, e consequentemente cx = ct = 2,5. Os resultados para essa filtragem estão ilustrados na Figura 5.21a para o dado sedimentar sintético, na Figura 5.22a para o meio domo sintético e na Figura 5.23a para o dado real. A diferença entre os dados originais e filtrados é mostrada nas figuras 5.21b, 5.22b, 5.23b para os dados sintéticos e real, respectivamente.
As inclinações utilizadas para os outros dois filtros, foram as inclinações do tensor estrutural utilizando a janela de 5 x 11 amostras, mostradas nas figuras 5.18b, 5.19b e 5.20a, para os dados sintéticos e real. O resultado para a filtragem adaptativa do dado sedimentar sintético é mostrado na Figura 5.21c, e do meio domo sintético na Figura 5.22c. De modo análogo, o resultado para o dado histórico do Golfo do México se encontra na Figura 5.23c. Foi utilizada a primeira implementação do filtro, com um núcleo Gaussiano com suporte aproximado de 7 x 3 amostras i.e. cx = 3,5 e ct = 1,5. A diferença entre
os dados originais e filtrados é mostrada nas figuras 5.21d, 5.22d, 5.23d para os dados sintéticos e real, respectivamente.
Analisando somente os dados filtrados, resultados da filtragem adaptativa parecem um pouco superiores aos da filtragem convencional, como melhor evidenciado observando as partes inclinadas do dado da Figura 5.21c. O desempenho da filtragem convencional foi melhor nos eventos planos e pouco inclinados do dado sedimentar sintético. Uma explicaçao provável reside no fato de a filtragem Gaussiana utilizar um núcleo pequeno, possivelmente menos agressivo que o da filtragem adaptativa. Isso resulta em menores perdas de sinal para regiões quase horizontais.
Embora a filtragem adaptativa tenha reduzido o ruído, como fica claro nas figuras 5.21c e 5.22c, houve perda de sinal para os dados filtrados, como ilustrado nas figuras 5.21d, 5.22d e 5.23d. Essa perda de sinal tem várias explicações possíveis, como o fato da filtragem adaptativa nao lidar apropriadamente com curvatura, ou erros na estimativa de mergulho desviarem o núcleo Gaussiano da posiçao ideal, resultando em perda de sinal. Em geral, filtros Gaussianos atuam como filtros passa baixa, talvez esse efeito se repita com a filtragem adaptativa, resultando em alguma perda na componente de alta frequência do sinal.
Para a filtragem com o filtro preditor de estruturas, foram utilizados os traços preditos a partir dos seis vizinhos mais próximos. Esses traços foram entao empilhados juntamente com os originais. Para realizar essa filtragem, foi utilizado o programa sfpws-pray, do pacote Madagascar. Assim, o resultado dessa filtragem para o dado sedimentar sintético está ilustrado na Figura 5.21e, a diferença entre o dado filtrado e o original se encontra na Figura 5.21f. De modo análogo para o meio domo, o dado filtrado com o filtro preditor de estruturas é exibido na Figura 5.22e, sendo a respectiva diferença exibida na Figura 5.22f. Por fim, os resultados para o dado real estao ilustrados na Figura 5.23e, com a diferença associada exibida na Figura 5.23f. Para todos os casos foram utilizados os mesmos parâmetros do dado sedimentar sintético.
O filtro preditor de estruturas teve melhores resultados, como ilustrado nas figuras 5.21e, 5.22e e 5.23e. Pelas figuras 5.21f, 5.22f e 5.23f é possível ver que houve pouca perda de sinal, estando a maior parte da perda concentrada nas descontinuidades, como as falhas normais. Esse efeito já era esperado, visto que a prediçao tende a falhar quando há descontinuidades no dado. Também houve alguma perda de sinal nas regiões com
inclinação mais acentuada, esse comportamento também pode ser explicado pelo fato de haver um maior erro na estimativa de inclinação nesse caso, como ilustrado na Figura 5.10. No caso do dado real, ilustrado na Figura 5.23f, esse efeito não é perceptível, já que a maioria dos eventos desse dado são quase planos. Somado a esse efeito, traços preditos a partir de traços distantes podem possuir maiores erros de predição.
x (km)	X (km)
0	0.2	0.4	0.6	0.8	1	1.2	1.4	0	0.2	0.4	0.6	0.8	1	1.2	1.4
(e) Filtro preditor de estruturas.	(f) Diferença entre o original e (e).
(e) Filtro preditor de estruturas.
x (km)
0	0.2 0.4 0.6 0.8	1	1.2 1.4 1.6 1.8
o ........ .
(b) Diferença entre o original e (a).
x (km)
(d) Diferença entre o original e (c).
x (km)
(f) Diferença entre o original e (e).
cmp
50	100	150	200
(a) Filtro Gaussiano convencional.
cmp
50	100	150	200
(c) Filtragem adaptativa.
cmp
0	50	100	150	200
(e) Filtro preditor de estruturas.
cmp
cmp
0	50	100	150	200
(f) Diferença entre o original e (e).
6	MELHORANDO AS TÉCNICAS DE FILTRAGEM
Como exibido no Capítulo 5, ambos métodos de filtragem apresentados no Capítulo 4 sofrem com perdas de informação nas descontinuidades dos dados sísmicos. Para prevenir perdas de sinal e suavização dos dados próximos a falhas, e outras interfaces estratigráficas,
é desejável melhorar ambos os métodos de filtragem. A abordagem utilizada para ambos
métodos é parecida, em essência, e visa aplicar pesos ao processo de suavização.
Esses pesos se baseiam na similaridade entre as amostras, e não apenas na distância entre elas na imagem, como é o usual. Apesar desta escolha, há outras alternativas para filtragem de dados sísmicos respeitando as bordas, como o filtro de Kuwahara generalizado
(Bakker et al., 1999). Esse filtro move a janela de filtragem de forma a evitar que ela
se sobreponha a bordas e descontinuidades na imagem. Alternativas similares a essa também foram bem sucedidas na filtragem de dados sísmicos ao longo das estruturas, respeitando as descontinuidades (e.g. Luo et al., 2002).
6.1	Utilizando similaridade como pesos para filtragem adaptativa
Proposta por Tomasi e Manduchi (1998), a filtragem bilateral é um filtro não linear, local e não iterativo. Uma das suas maiores vantagens é preservar bordas e descontinuidades presentes na imagem e ser conceitualmente simples. Para um pixel (x0,t0), o valor da filtragem bilateral, utilizando funções Gaussianas, pode ser definido como
(6.1)
sendo W uma janela em torno no pixel (x0,t0) e wi,j os pesos para essa janela, definidos na equação (2.18). A função
r(x) = exp
(6.2)
mede a similaridade entre o pixel (xo,to) e os outros pixels dentro da janela. Quanto menor for o parâmetro cr, mais similares os pixels utilizados serão. Por fim,
K(xo,to)	XI	r(P(xo,to) - P(xi,tj)),	(6.3)
é um fator de normalização.
Assim como anteriormente, antes de propor melhorias, é interessante testar primeiramente os resultados da filtragem convencional. Desse modo, os três dados filtrados anteriormente foram filtrados utilizando a filtragem bilateral convencional, com núcleos Gaussianos. Foi utilizado um filtro com suporte de 5 x 5 amostras. O parâmetro cr deve refletir o tamanho típico das bordas. Para estimar essa grandeza pode-se utilizar uma média da norma do gradiente da imagem (Paris et al., 2007). Logo, utilizou-se cr = 1,12 • 10-3 para a seção sedimentar sintética, cr = 1,28 • 10-3 para o meio domo sintético e cr = 6,19 • 10-1 para o dado real. Esses parâmetros são próximos dos parâmetros estimados por tentativa e erro, em tentativas de filtragem anteriores para essas imagens. Os resultados para a filtragem bilateral convencional, com esses parâmetros, estão ilustrados nas figuras 6.1a, 6.2a e 6.3a, para a seção sedimentar sintética, o meio domo sintético e o dado real, respectivamente.
Embora tenham sido utilizadas funções Gaussianas, pode-se fazer uso de outros tipos de funções no lugar de r e wi;j-. Propõe-se então utilizar os pesos gitj (0) da equação (4.4) no lugar de wi;j-. Desse modo, os valores que podem ser utilizados para suavização na filtragem bilateral são maximizados, pois o filtro será direcionado ao longo das estruturas presentes na imagem. Essa abordagem é similar às modificações da filtragem bilateral propostas por Choudhury e Tumblin (2003). Foram utilizados os mesmos parâmetros da filtragem adaptativa (cx = 3,5 e ct = 1,5), o que resulta em um suporte aproximado de 7 x 3 amostras para o filtro. Os valores de cr são os mesmos da filtragem bilateral. Esse novo filtro, denominado filtragem bilateral adaptativa, provê melhores resultados que a filtragem adaptativa simples, como ilustrado na Figura 6.1c para o dado sedimentar sintético, e na Figura 6.2c para o meio domo sintético. O dado real também foi filtrado de maneira mais efetiva, como exibido na Figura 6.3c.
Em todos os testes realizados, as perdas de sinal da filtragem bilateral adaptativa foram menores que as perdas associadas a filtragem bilateral. Isso pode ser aferido
0	0.2	0.4	0.6	0.8	1	1.2	1.4	0	0.2	0.4	0.6	0.8	1	1.2	1.4
x (km)
O 0.2	0.4	0.6	0.8	1	1.2	1.4	1.6	1.8
CO
Ó
w co
o
o
o
o
02
O
O
Ó
O
02
O
O
Ó
xh
o o
o
(a) Filtragem bilateral convencional.
(b) Diferença entre o dado original e (a).
x (km)
0	0.2	0.4	0.6	0.8	1	1.2	1.4	1.6	1.8
(c) Filtragem bilateral adaptativa.
x (km)
0	0.2 0.4 0.6 0.8	1	1.2 1.4 1.6 1.8
(d) Diferença entre o dado original e (c).
x (km)
0	0.2	0.4	0.6	0.8	1	1.2	1.4	1.6	1.8
o
(f) Diferença entre o dado original e (e).
(e) Filtragem bilateral adaptativa com medianas.
cmp
0	50	100	150	200
(a) Filtragem bilateral convencional.
cmp
50
cmp
100	150
(c) Filtragem bilateral adaptativa.

CO
in
cd
cmp
50	100	150	200
(d) Diferença entre o dado original e (c).
cmp
0	50	100	150	200
(f) Diferença entre o dado original e (e).
50
cmp
100	150
(e) Filtragem bilateral adaptativa com medianas.
comparando as figuras 6.1b e 6.1d, para o dado sedimentar sintético. Esse mesmo efeito pode ser notado para o meio domo sintético, comparando as figuras 6.2b e 6.2d. Para o dado real também houve melhoras na perda de sinal, como ilustrado comparando as figuras 6.3b e 6.3d. Por isso, é possível afirmar com certeza que a combinação da filtragem adaptativa com a filtragem bilateral foi bem sucedida.
Pela sua definição na equação (6.1), é possível perceber que o filtro bilateral não remove eficientemente ruídos isolados de grande intensidade (i.e. salt-and-pepper noise). Por construção, esse efeito se propaga para a filtragem bilateral adaptativa. É possível amenizar isso, substituindo o valor da imagem em (x0,t0), na equação (6.1), pelo valor da imagem original filtrada por um filtro de medianas (Paris et al., 2007), como
com
km(xo,to) =	gi,j r(M(xo,to) - P(xi,tj))
(6.5)
sendo M(x,t) o valor da imagem original filtrada por um filtro de medianas. Essa filtragem, combina a filtragem bilateral adaptativa com um filtro de medianas, com o intento de melhorar a remoção de ruídos isolados de alta intensidade. Dessa forma, para as filtragens a seguir, foi utilizado um filtro de medianas de 3 x 3 amostras para o valor de M(x,t).
Essa filtragem foi realizada nos dados sintéticos e real, como mostrado nas figuras 6.1e, 6.2e e 6.3e, respectivamente. É possível observar que o resultado final é um pouco mais suave do que a filtragem bilateral adaptativa sem medianas. Comparando as diferenças entre os dados filtrados sem e com as melhorias adicionais, exibidas nas figuras 6.1d e 6.1f para a seção sedimentar sintética e nas figuras 6.2d e 6.2f para o meio domo sintético, é possível concluir houve uma perda de sinal equivalente aos resultados anteriores. Esse efeito também ocorre com o dado real, como ilustrado pelas figuras 6.3d e 6.3f. Assim, como essa última filtragem resulta em imagens mais suaves, é possível concluir que a filtragem bilateral adaptativa, combinada com medianas, produz melhores resultados.
6.2
Filtro preditor de estruturas combinado à similaridade local
De modo análogo ao que foi realizado para a filtragem adaptativa, é possível melhorar o filtro preditor de estruturas utilizando similaridade local (Figura 6.4) como peso na etapa de empilhamento entre os traços preditos e o original (Liu et al., 2010). O esquema básico de filtragem também é esboçado na Figura 6.5. A definição de similaridade local utilizada foi proposta por Fomel (2007a). Nessa versão, a similaridade local é definida utilizando shapping regularization e correlação local.
1
0
Traço I
Traço II
Similaridade
Figura 6.4: Esboço da medida de similaridade local entre o Traço I e II. A similaridade local tende a um quando os dois traços são localmente similares, como é o caso do evento no meio dos dois traços. Quando os traços diferem localmente, a similaridade tende a zero, como é o caso de regiões dominadas por ruído aleatório.
A regularização citada anteriormente expande a regularização de Tikhonov, utilizando um operador de suavização como operador de regularização (Fomel, 2007b). Para as estimativas de similaridade utilizadas nas filtragens a seguir, foi utilizado um operador de suavização triangular com suporte de 10 amostras. Esse operador está embutido no programa sfsimilarity do Madagascar, utilizado nos cálculos. Essa formulação faz com que a similaridade varie suavemente, o que não ocorre com a medida de similaridade da filtragem bilateral, por exemplo. A similaridade local é próxima de um quando os dois traços comparados são localmente similares, e tende a zero quando eles diferem localmente.
A fim de melhorar ainda mais a etapa de empilhamento do filtro, pesos Gaussianos foram aplicados aos traços. Isso resulta em pesos menores para traços preditos a partir de traços mais distantes do original, o que diminui o efeito de possíveis erros de predição
Estimar inclinação local
Predizer traço à partir dos vizinhos
Similaridade local em relação ao original
Empilhar com
pesos
Figura 6.5: Esquema de funcionamento do filtro preditor de estruturas, melhorado utilizando similaridade local como pesos para o empilhamento. Depois de estimar a inclinação local para todos os pontos nos dados, o traço original, em azul, pode ser predito deslocando as amostras dos traços vizinhos de acordo com as inclinações locais. Traços mais distantes podem ser utilizados com recursão. Nessa figura, apenas os vizinhos imediatos são utilizados. Após a predição, é calculada a similaridade local entre o traço original e cada um dos traços preditos. Os traços preditos são então empilhados juntamente com o traço original, utilizando a similaridade local entre eles como pesos para o empilhamento. Assim, é realizada a filtragem preditora de estruturas melhorada.
na etapa de empilhamento (Liu et al., 2010). Nessa etapa, cada traço é multiplicado por
(6.6)
sendo wk os pesos Gaussianos, k é o índice do afastamento entre o traço original e o predito, i.e. para o traço original k = 0 e para um traço predito a partir de um vizinho imediato k = 1. O parâmetro Z altera o formato da Gaussiana, para os dados sintéticos foi utilizado Z = 2 e para o dado real Z = 0,02. Os resultados do filtro preditor de estruturas, com empilhamento usando pesos de similaridade, são mostrados na Figura 6.6a para a seção sedimentar sintética, na Figura 6.6c para o meio domo sintético e na Figura 6.6e para o dado real. Fica claro, a partir desta comparação, o fato de o ruído ter sido atenuado, com pouca perda de sinal nas falhas e descontinuidades presentes nos dados. Isso pode ser confirmado analisando a diferença entre os dados originais e os dados filtrados, mostrada nas figuras 6.6b, 6.6d e 6.6f.
o
(a) Sessão sedimentar sintética filtrada.
1.2	1.4
x (km)
0	0.2	0.4	0.6	0.8	1
Ul Tt1
LO
Ó
(b) Diferença entre o dado original filtrado em (a).
x (km)
0	0.2	0.4	0.6	0.8	1	1.2	1.4	1.6	1.8
(c) Meio domo sintético filtrado.
x (km)
C\2
Ó
Ó
CO
O
CO ó
o
0.004 -0.002	0	0.002	0.004	_	-0.004 -0.002	0	0.002	0.004
(d) Diferença entre filtrado em (c).
dado original e o

(e) Dado real histórico filtrado.
(f) Diferença entre o dado original e o filtrado em (e).
Figura 6.6: Resultados para o filtro preditor de estruturas, melhorado com empilhamento utilizando similaridade local como pesos.
6.3
Quantificando os resultados
A fim de concluir a discussão sobre os métodos de filtragem testados, decidiuse utilizar uma medida quantitativa para a perda de sinal proveniente de cada tipo de filtragem. Essa perda pode ser resumida, e avaliada de forma quantitativa, por uma medida denominada root mean squared error (RMSE), ou raiz quadrada do erro quadrático médio (Gonzalez e Woods, 2008), dada por
1 nx-1 nt-1
RMSE =	—-	(P) - Pf	))2	(6.7)
i=0 j=0
sendo nx e nt a altura e largura da imagem, em número de amostras. O valor do campo de pressão da imagem original e da imagem filtrada são dados por, P(x,t) e Pf (x,t), respectivamente. Essa medida pode ser utilizada para comparar a perda de sinal entre as diferentes melhorias propostas para as técnicas de filtragem. Assim, os resultados para o RMSE da filtragem adaptativa, com e sem similaridade, estão listados na tabela 6.1. Nesta tabela também foi listado o RMSE das filtragens Gaussiana e bilateral. Essas filtragens podem ser comparadas a filtragem adaptativa, devido ao principio de filtragem ser similar, i.e. todas elas se baseiam em adaptações e melhorias da filtragem Gaussiana convencional. O RMSE do filtro preditor de estruturas, com e sem similaridade, por sua vez, se encontra na tabela 6.2.
filtragem	dado		
	sedimentar	meio domo	real
Gaussiana	9,83 • -0-4	-,03 • -0-3	5,06 • -0-1
bilateral	-,83 • -0-3	-,98 • -0-3	-,47 • -0+0
adaptativa	-,08 • -0-3	-,28 • -0-3	6,95 • -0-1
bilateral adaptativa	2,66 • -0-4	2,93 • -0-4	-,2- • -0-1
Tabela 6.1: Raiz quadrada do erro quadrático médio (RMSE), dada pela equação (6.7), para o dado sedimentar sintético, para o meio domo sintético e para o dado real. O RMSE foi calculado para a filtragem Gaussiana, bilateral, adaptativa e bilateral adapta-tiva.
A primeira conclusão importante, observando os valores de RMSE da tabela 6.1, é a maior perda de sinal por parte da filtragem bilateral, se comparada a filtragem gaussiana
filtragem	dado		
	sedimentar	meio domo	real
filtro preditor de estruturas	6,40 • 10 1	5,94 • 10 1	3,44 • 10 1
filtro preditor de estruturas com similaridade	4,41 • 10 1	4,11 • 10 1	1,67 • 10 1
Tabela 6.2: Raiz quadrada do erro quadrático médio (RMSE), dada pela equação (6.7), para o dado sedimentar sintético, para o meio domo sintético e para o dado real. O RMSE foi calculado para o filtro preditor de estruturas, com e sem similaridade.
convencional. Isso pode ser causado pelo fato de a filtragem bilateral não lidar bem com bordas em forma de rampas, ou regiões da imagem com esse tipo de perfil e gradiente acentuado (Choudhury e Tumblin, 2003), o que é comum em um dado sísmico, devido a sua natureza senoidal. A filtragem adaptativa, sem similaridade, também tem uma performance pior que a filtragem gaussiana, dados os altos valores de RMSE da tabela 6.1. Porém, quando combinada a filtragem bilateral, a filtragem adaptativa tem um valor de RMSE menor do que as filtragens citadas anteriormente. Isso confirma a menor perda de sinal ilustrada pelas diferenças entre os dados originais e filtrados, analisadas anteriormente para a filtragem bilateral adaptativa.
Esses resultados podem ser explicados pelo fato da filtragem adaptativa ter o seu núcleo de filtragem rotacionado ao longo da direção ortogonal ao gradiente da imagem. Assim, quando combinada a filtragem bilateral, a filtragem adaptativa reduz os problemas encontrados com gradientes acentuados, e regiões da imagem com bordas em forma de rampa. Essa solução é semelhante a solução proposta por Choudhury e Tumblin (2003), que também rotaciona a direção do núcleo utilizado na filtragem, utilizando para tanto o gradiente da imagem. Entretanto, essa solução também utiliza a estrutura local e gradiente da imagem para modificar o tamanho e forma do núcleo de filtragem.
Embora os valores do RMSE da filtragem adaptativa com similaridade sejam menores do que os valores associados ao filtro preditor de estruturas, fica claro que houveram maiores perdas de sinal na filtragem bilateral adaptativa, como ilustrado nas figuras 6.1d, 6.2d e 6.3d. O filtro preditor de estruturas, por sua vez, só apresenta perdas próximo as descontinuidades presentes nos dados, como exibido nas figuras 5.21f, 5.22f e 5.23f. Isso mostra que o RMSE é uma ferramenta útil para comparar perdas devido a variações de uma mesma filtragem, e não para filtros com implementações completamente diferentes.
Propõe-se realizar uma nova análise para ressaltar a diferença entre as melhorias do filtro preditor de estruturas, calculando o RMSE no interior de uma janela móvel de 7 x 7 amostras, como ilustrado na Figura 6.7. Comparando as figuras 6.7a, 6.7c e 6.7e as figuras 6.7b, 6.7d e 6.7f, é possível perceber que os maiores valores de RMSE janelado estão concentrados ao redor das descontinuidades dos dados, para o filtro preditor de estruturas sem similaridade.
Os valores do RMSE janelado da filtragem estrutural sem similaridade também são maiores em regiões homogêneas, como ilustrado na Figura 6.7c, por exemplo. Isso se deve ao fato dessa filtragem ser mais agressiva, suavizando mais os dados nessas regiões, como ilustrado comparando as figuras 5.21e e 6.6a, ou comparando as figuras 5.22e e 6.6c.
RMSE (IO”5)
0.2	0.4
x (km)
0.6 0.8 1
1.2	1.4
(a) Sessão sedimentar sintética sem similaridade.
(b) Sessão sedimentar sintética com similaridade.
RMSE (IO”5)
x (km)
0	0.2	0.4	0.6	0.8	1	1.2	1.4	1.6
o
1.8
0.2 0.4 0.6 0.8	1	1.2	1.4	1.6	1.8
RMSE (IO”5)
(d)	Meio domo sintético com similaridade.
(c)	Meio domo sintético sem similaridade.
(e)	Dado real sem similaridade.
Figura 6.7: RMSE utilizando janela móvel de estruturas.
(f)	Dado real com similaridade.
7 x 7 amostras, para o filtro preditor de
7	CONCLUSÕES
O tensor estrutural é altamente correlacionado com as estruturas locais presentes nas sessões sísmicas. O tensor provê estimativas precisas e robustas para a inclinação local, e ainda pode ser utilizado diretamente para outras aplicações, como estimativas de coerência (Faraklioti e Petrou, 2005) ou para detectar bordas (Harris e Stephens, 1988). Neste trabalho as estimativas de coerência, ou linearidade local, dadas pelo tensor estrutural, foram utilizadas para melhorar as estimativas de inclinação através da criação de máscaras de coerência. Esse procedimento foi bem sucedido, como evidenciado pelos testes com dados sintéticos.
A capacidade do tensor estrutural de estimar inclinações locais também foi comparada a outros métodos, já bem estabelecidos em Geofísica, como discutido ao longo do Capítulo 5. Ao analisar as inclinações estimadas para dados sintéticos, foi possível confirmar que o tensor tem desempenho similar, ou superior em alguns casos, aos outros métodos testados. Isso embasa as afirmações de que o tensor pode ser utilizado para estimar propriedades de dados sísmicos, como já foi estudado por outros autores no passado (Bakker, 2002; Faraklioti e Petrou, 2005). Ademais, esses resultados somam-se a outras vantagens desse método, como o fato de ele ser rápido, local, não iterativo, conceitual-mente simples e de fácil implementação, sendo composto basicamente por suavizações e somas ao longo dos dados.
Entretanto, deve-se tomar cuidado na escolha dos parâmetros do tensor, para não ignorar características importantes da seção sísmica, como terminações dos eventos. Em geral, essas terminações delimitam estruturas geológicas importantes, como falhas e descontinuidades erosivas. Além da suavização anterior ao cálculo das derivadas do dado, outro parâmetro de suma importância é o tamanho da escala de integração. Dois cenários possíveis foram discutidos, a escala de integração ser pequena demais, resultando em estimativas ruidosas para as inclinações locais, ou ser grande demais em relação ao tamanho característico dos eventos sísmicos. Nesse último caso, as estimativas serão mais suaves, porém certos detalhes importantes da seção sísmica poderão ser ignorados.
Inclinações locais podem ser utilizadas em diversas tarefas em imageamento sísmico,
como migração pré-empilhamento em tempo ou normal moveout (Ottolini, 1983; Fomel, 2007c). Dentre as várias aplicações possíveis, foi escolhido testar as inclinações estimadas através do tensor estrutural para filtragem de sessões sísmicas utilizadas para interpretação geológica. Esse problema é de grande interesse, já que as informações extraídas da interpretação geológica podem, por exemplo, ser utilizadas para análise de risco pela indústria (Fehmers e Hocker, 2003).
Uma das abordagens mais comuns é utilizar o tensor estrutural para filtragem por difusão anisotrópica (Fehmers e Hocker, 2003; Weickert, 1999). Diferindo dessa tendência, neste trabalho foram estudados dois métodos diferentes de filtragem: filtragem adaptativa, utilizando núcleos Gaussianos alongados (Bakker, 2002) e filtragem estrutural utilizando predição de ondas planas (Liu et al., 2010). Nos primeiros testes, com dados sintéticos e real, o segundo filtro citado teve um melhor desempenho, atenuando ruído sem grandes perdas de sinal.
Porém, ambos métodos de filtragem falham quando se deparam com descontinuidades nos dados, como falhas geológicas e descontinuidades erosivas. Foram então testadas abordagens similares para melhorar o resultado de ambos os métodos, que consistem em levar em conta a similaridade das amostras utilizadas no processo de suavização. A filtragem adaptativa foi então combinada com a filtragem bilateral (Tomasi e Manduchi, 1998). O filtro preditor de estruturas, por sua vez, foi melhorado utilizando similaridade local como pesos para o empilhamento dos traços preditos (Liu et al., 2010; Fomel, 2007a). Ambas abordagens foram bem sucedidas em melhorar a preservação das descontinuidades dos dados sísmicos e reduzir a perda de sinal, embora ainda haja alguma perda de sinal para a filtragem adaptativa melhorada.
A extensão das técnicas utilizadas neste trabalho para dados sísmicos em 3D é direta. Entretanto, é necessário tomar alguns cuidados, como calcular os autovalores do tensor apropriadamente e diferenciar entre estruturas lineares e planares nos dados em 3D, o que pode ser feito utilizando os próprios autovalores do tensor.
REFERÊNCIAS BIBLOGRÁFICAS
Bakker, P. (2002). Image structure analysis for seismic interpretation. Tese de doutorado, Delft University of Technology, Delft, Holanda.
Bakker, P., Van Vliet, L., e Verbeek, P. W. (1999). Edge preserving orientation adaptive filtering. In IEEE Computer Society Conference on Computer Vision and Pattern Recognition, volume 1. IEEE.
Bakker, P., van Vliet, L., e Verbeek, P. W. (2001). Confidence and curvature estimation of curvilinear structures in 3-D. In Eighth IEEE International Conference on Computer Vision, volume 2, páginas 139-144. IEEE.
Choudhury, P. e Tumblin, J. (2003). The trilateral filter for high contrast images and meshes. In Proceedings of the 14-th Eurographics Workshop on Rendering, páginas 186-196. Eurographics Association.
Claerbout, J. (1992). Earth Soundings Analysis: Processing Versus Inversion, volume 6. Blackwell Scientific Publications.
Claerbout, J. e Green, I. (2010). Basic Earth Imaging. Stanford University.
Claerbout, J. F. e Fomel, S. (2008). Image Estimation by Example: Geophysical Soundings Image Construction - Multidimensional Autoregression. Stanford University.
Faraklioti, M. e Petrou, M. (2005). The use of structure tensors in the analysis of seismic data. In Iske, A. e Randen, T., editores, Mathematical Methods and Modelling in Hydrocarbon Exploration and Production, volume 7 de Mathematics in Industry, páginas 47-88. Springer.
Fehmers, G. e Hocker, C. (2003). Fast structural interpretation with structure-oriented filtering. Geophysics, 68(4):1286-1293.
Fomel, S. (2002). Applications of plane-wave destruction filters. Geophysics, 67(6):1946-1960.
Fomel, S. (2007a). Local seismic attributes. Geophysics, 72(3):A29-A33.
Fomel, S. (2007b). Shaping regularization in geophysical-estimation problems. Geophysics, 72(2):R29-R36.
Fomel, S. (2007c). Velocity-independent time-domain seismic imaging using local event slopes. Geophysics, 72(3):S139-S147.
Fomel, S. (2010). Predictive painting of 3D seismic volumes. Geophysics, 75(4):A25-A30.
Forstner, W. (1986). A feature based correspondence algorithm for image matching. International Archives of Photogrammetry and Remote Sensing, 26(3):150-166.
Gonzalez, R. e Woods, R. (2008). Digital Image Processing, volume 1. Prentice Hall, terceira edition.
Haglund, L. (1991). Adaptive multidimensional filtering. Tese de doutorado, Linkoping University, Linkoping, Suécia.
Hale, D. (2009). Structure-oriented smoothing and semblance. CWP Report 635, Center Wave Phenomena.
Harris, C. e Stephens, M. (1988). A combined corner and edge detector. In Alvey Vision Conference, volume 15, página 50. Manchester, UK.
Kass, M. e Witkin, A. (1987). Analyzing oriented patterns. Computer Vision, Graphics, and Image Processing, 37(3):362-385.
Kothe, U. (2003). Edge and junction detection with an improved structure tensor. In Michaelis, B. e Krell, G., editores, Pattern Recognition, volume 2781 de Lecture Notes in Computer Science, páginas 25-32. Springer.
Lavialle, O., Pop, S., Germain, C., Donias, M., Guillon, S., Keskes, N., e Berthoumieu, Y. (2007). Seismic fault preserving diffusion. Journal of Applied Geophysics, 61(2):132-141.
Liu, Y., Fomel, S., e Liu, G. (2010). Nonlinear structure-enhancing filtering using planewave prediction. Geophysical Prospecting, 58(3):415-427.
Luo, Y., Marhoon, M., Al Dossary, S., e Alfaraj, M. (2002). Edge-preserving smoothing and applications. The Leading Edge, 21(2):136-141.
Madagascar Development Team (2012). Madagascar Software, Versão 1.4. http://www.ahay.org/.
Ottolini, R. (1983). Velocity independent seismic imaging. SEP-37: Stanford Exploration Project, páginas 59-68.
Paris, S., Kornprobst, P., Tumblin, J., e Durand, F. (2007). A gentle introduction to bilateral filtering and its applications. In ACM SIGGRAPH 2007 Courses. ACM.
Rao, A. e Schunck, B. G. (1991). Computing oriented texture fields. CVGIP: Graphical Models and Image Processing, 53(2):157-185.
Schlaf, J., Randen, T., e Spnneland, L. (2005). Introduction to seismic texture. In Iske, A. e Randen, T., editores, Mathematical Methods and Modelling in Hydrocarbon Exploration and Production, volume 7 de Mathematics in Industry, páginas 3-21. Springer.
Schleicher, J., Costa, J., Santos, L., Novais, A., e Tygel, M. (2009). On the estimation of local slopes. Geophysics, 74(4):P25-P33.
Telea, A. (2004). An image inpainting technique based on the fast marching method. Journal of Graphics Tools, 9(1):23-34.
Tomasi, C. e Manduchi, R. (1998). Bilateral filtering for gray and color images. In Sixth International Conference on Computer Vision, páginas 839-846. IEEE.
Weickert, J. (1999). Coherence-enhancing diffusion filtering. International Journal of Computer Vision, 31(2):111-127.</field>
	</doc>
</add>