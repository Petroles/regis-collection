<?xml version="1.0" encoding="utf-8"?>
<add>
	<doc>
		<field name="docid">BR-TU.20264</field>
		<field name="filename">3735_344655.pdf</field>
		<field name="filetype">PDF</field>
		<field name="text">
Lauvir Ramos Neto

MODELOS QUADRÁTICOS POR PARTES PARA OTIMIZAC?ÃO DA
PRODUC?ÃO DE CAMPOS DE PETRÓLEO E GÁS

Dissertac?ão submetida ao Programa
de Pós-Graduac?ão em Engenharia
de Automac?ão e Sistemas da Uni-
versidade Federal de Santa Catarina
para a obtenc?ão do Grau de Mestre
em Engenharia de Automac?ão e Sis-
temas.

Orientador: Prof. Eduardo Camponogara, Ph.D.

Florianópolis

2016





Lauvir Ramos Neto

MODELOS QUADRÁTICOS POR PARTES PARA OTIMIZAC?ÃO DA
PRODUC?ÃO DE CAMPOS DE PETRÓLEO E GÁS

Esta Dissertac?ão foi julgada adequada para a obtenc?ão do Título de
“Mestre em Engenharia de Automac?ão e Sistemas”, e aprovada em
sua forma final pelo Programa de Pós-Graduac?ão em Engenharia de
Automac?ão e Sistemas.

Florianópolis, 22 de Agosto de 2016.

Prof. Dr. Daniel Ferreira Coutinho
Coordenador do Curso

Universidade Federal de Santa Catarina

Banca Examinadora:

Prof. Eduardo Camponogara, Ph.D.
Orientador

Universidade Federal de Santa Catarina





Prof. Agustinho Plucênio, Dr.
Universidade Federal de Santa Catarina

Prof. Max Hering de Queiroz, Dr.
Universidade Federal de Santa Catarina

Prof. Sérgio Fernando Mayerle, Dr.
Universidade Federal de Santa Catarina

Prof. Rodrigo Castelan Carlson, Dr.
Universidade Federal de Santa Catarina





Este trabalho é dedicado aos meus que-
ridos pais e esposa.





AGRADECIMENTOS

Primeiramente, gostaria de expressar meus sinceros agradeci-
mentos ao meu orientador Eduardo Camponogara, o qual me deu todo
suporte necessário, conselhos, ensinamentos e dedicou horas de seu
tempo para me ajudar a concluir esse trabalho.

À Universidade Federal de Santa Catarina e ao Programa de Re-
cursos Humanos da Petrobras PRH-34, por me fornecerem toda a infra-
estrutura e suporte necessários durante todo o período do mestrado.

Agradec?o aos meus colegas do GOS por todos os conselhos e
amizade. Fac?o questão de destacar um imenso agradecimento ao inte-
grante do grupo e amigo Eduardo Otte Hülse, o qual foi um dos grandes
responsáveis por me ajudar a concluir essa dissertac?ão.

Por fim agradec?o aos meus familiares, principalmente à minha
esposa e pais, por todo o suporte e carinho.





A tarefa não é tanto ver aquilo que ninguém
viu, mas pensar o que ninguém ainda pensou
sobre aquilo que todo mundo vê.

(Arthur Schopenhauer)





RESUMO

A otimizac?ão da produc?ão de poc?os de petróleo operados por
injec?ão contínua de gás (gas-lift) sob restric?ões de roteamento e pressão
é um problema que tem sido bastante abordado na literatura técnica.

Na busca por uma representac?ão da relac?ão em regime per-
manente entre variáveis do processo, recorre-se, frequentemente, a
func?ões algébricas. Func?ões essas derivadas a partir de um conjunto de
dados obtidos de medic?ões reais ou de simuladores fenomenológicos
do processo. Dois métodos são comumente usados para aproximar es-
sas relac?ões: modelos não lineares e lineares por partes. Modelos não
lineares são resolvidos por abordagens "caixa-preta" ou fazem uso de
substituic?ões obtidas por meio de ajustes nas func?ões que envolvem o
problema, o que permite resolver problemas difíceis.

Já os modelos lineares por partes são bastante eficientes no sen-
tido de permitirem que se alcance ótimos globais, entretanto, inserem
no problema de otimizac?ão um número elevado de variáveis quando
são utilizadas muitas curvas para a representac?ão do modelo.

Nessa dissertac?ão é proposta uma abordagem genérica para a
soluc?ão do problema a partir de aproximac?ões lineares ou quadráti-
cas côncavas para curvas de produc?ão de poc?os e func?ões lineares ou
quadráticas convexas para curvas de queda de pressão. O resultado
é uma formulac?ão em Programac?ão Convexa Inteira Mista a qual é
mais compacta e permite que se alcance o ótimo global. No entanto,
utilizando somente aproximac?ões lineares para curvas de produc?ão de
poc?os e queda de pressão, o modelo se torna de Programac?ão Linear
Inteira Mista, o qual é mais eficiente quando aplicado a modelos com
um menor fatiamento do domínio.

Duas formulac?ões foram desenvolvidas e suas eficiências foram
analisadas em termos de análise computacional para um campo de
petróleo sintético representativo. Além disso, demonstra-se que essas
formulac?ões são equivalentes e podem ser utilizadas para a soluc?ão do
problema de otimizac?ão da produc?ão de petróleo

Palavras-chave: Otimizac?ão da produc?ão de petróleo. gas-lift. Pro-
gramac?ão convexa inteira mista. Modelos quadráticos por partes.





ABSTRACT

The optimization of oil wells operated by gas-lift under facility,
routing and pressure constraints is a problem that is being addressed in
the technical literature.

Due to the presence of unknown functions that are not given in
explicit form, two methods are commonly used to approximate such re-
lations: nonlinear and piecewise-linear models. The nonlinear methods
fall into derivative-free or black-box approaches, or make use of sur-
rogates obtained by curve fitting procedures, which can entail solving
challenging problems.

Piecewise linear models are efficient in order to reach globally
optimal solutions, but their models tend to get very large because of
the number of variables inserted in the problem.

In this work, it is proposed a generic approach relying on linear
or concave quadratic approximations for well production curves and
linear or convex quadratic functions for pressure drops combining all
possibilities of approximations. The result is a Mixed-Integer Convex
Programming (MICP) formulation which is more compact and allows
the global optimum to be reached. However, using only linear curves for
well production and pressure-drop curves the model becomes a Mixed-
Integer Linear Programming (MILP) formulation which is more efficient
when applied in smaller domain divisions.

Two formulations were developed and their performance were
assessed by means of computational analysis for a representative syn-
thetic oil field.

Keywords: Oil production optimization. gas-lift. Mixed-integer con-
vex programming. Piecewise quadratic models.





LISTA DE FIGURAS

2.1 Sistema de produc?ão . . . . . . . . . . . . . . . . . . . . 29
2.2 Poc?o operado por gas-lift . . . . . . . . . . . . . . . . . . 32
2.3 Curva de desempenho do poc?o . . . . . . . . . . . . . . 34

3.1 Conjunto convexo representado por uma reta . . . . . . 44
3.2 Exemplos de conjuntos convexos e não convexos . . . . 44
3.3 Exemplo de func?ão convexa . . . . . . . . . . . . . . . . 45
3.4 Subestimador global de uma func?ão convexa . . . . . . . 46
3.5 Gráfico da func?ão descrita na Eq. (3.7) . . . . . . . . . . 48
3.6 Ilustrac?ão geométrica de um problema de otimizac?ão qua-

drática . . . . . . . . . . . . . . . . . . . . . . . . . . . . 49
3.7 Aproximac?ão linear por partes . . . . . . . . . . . . . . . 50
3.8 Aproximac?ão quadrática por partes . . . . . . . . . . . . 50
3.9 Utilizac?ão de aproximac?ões quadráticas na síntese de mo-

delo MICP . . . . . . . . . . . . . . . . . . . . . . . . . . 52
3.10 Aproximac?ão quadrática côncava de uma curva de produc?ão 53
3.11 Domínio da func?ão dividido em 4 politopos . . . . . . . 53
3.12 Aproximac?ão quadrática por partes . . . . . . . . . . . . 54
3.13 Parâmetros do problema de programac?ão semi-definida . 55

4.1 Cenário sintético de campo de petróleo . . . . . . . . . . 74
4.2 Limites de injec?ão e pressão para 4 politopos . . . . . . . 78
4.3 Limites de injec?ão e pressão para 25 politopos . . . . . . 79
4.4 Curva de queda de pressão em func?ão das vazões de pe-

tróleo e gás . . . . . . . . . . . . . . . . . . . . . . . . . 83

1 Exemplo de combinac?ão afim . . . . . . . . . . . . . . . 106
2 Triângulo formado por pontos P1, P2 e P3 . . . . . . . . . 107
3 Exemplo de combinac?ão afim e combinac?ão convexa . . 108





LISTA DE TABELAS

4.1 Limites do compressor e separadores . . . . . . . . . . . 74
4.2 Dados nominais da instância . . . . . . . . . . . . . . . . 75
4.3 Cenários utilizados para as aproximac?ões das curvas de

produc?ão de petróleo . . . . . . . . . . . . . . . . . . . . 78
4.4 Aproximac?ão Linear – Minimizac?ão erro absoluto – Norma

1 – 2 politopos por eixo . . . . . . . . . . . . . . . . . . 79
4.5 Aproximac?ão Côncava – Minimizac?ão erro absoluto – Norma

1 – 2 politopos por eixo . . . . . . . . . . . . . . . . . . 80
4.6 Aproximac?ão Linear – Minimizac?ão erro relativo – Norma

1 – 2 politopos por eixo . . . . . . . . . . . . . . . . . . 80
4.7 Aproximac?ão Côncava – Minimizac?ão erro relativo – Norma

1 – 2 politopos por eixo . . . . . . . . . . . . . . . . . . 80
4.8 Análise da aproximac?ão da curva de produc?ão de petró-

leo para 25 politopos . . . . . . . . . . . . . . . . . . . . 81
4.9 Cenários utilizados para as aproximac?ões das curvas de

queda de pressão . . . . . . . . . . . . . . . . . . . . . . 83
4.10 Limites máximos e mínimos utilizados nas vazões para 1

politopo . . . . . . . . . . . . . . . . . . . . . . . . . . . 84
4.11 Limites máximos e mínimos utilizados por politopo para

8 politopos . . . . . . . . . . . . . . . . . . . . . . . . . 84
4.12 Análise de erro para curvas de queda de pressão para 1

politopo . . . . . . . . . . . . . . . . . . . . . . . . . . . 84
4.13 Aproximac?ão Linear – Minimizac?ão erro absoluto – 2 po-

litopos por eixo . . . . . . . . . . . . . . . . . . . . . . . 85
4.14 Aproximac?ão Quadrática Convexa - Minimizac?ão erro ab-

soluto - 2 politopos por eixo . . . . . . . . . . . . . . . . 86
4.15 Aproximac?ão Linear - Minimizac?ão erro relativo - 2 poli-

topos por eixo . . . . . . . . . . . . . . . . . . . . . . . . 86
4.16 Aproximac?ão Convexa - Minimizac?ão erro relativo - 2 po-

litopos por eixo . . . . . . . . . . . . . . . . . . . . . . . 87
4.17 Resumo das aproximac?ões da curva de queda de pressão

para 8 politopos . . . . . . . . . . . . . . . . . . . . . . . 87
4.18 Casos simulados para os modelos Agregado e Desagre-

gado de otimizac?ão da produc?ão de petróleo . . . . . . . 89
4.19 Modelo Agregado . . . . . . . . . . . . . . . . . . . . . . 90
4.20 Modelo Desagregado . . . . . . . . . . . . . . . . . . . . 92
4.21 8 casos selecionados para a análise de simulac?ão . . . . 93
4.22 Comparac?ão entre resultados do modelo Agregado e Si-

mulador . . . . . . . . . . . . . . . . . . . . . . . . . . . 94
4.23 Tempo de soluc?ão dos problemas de otimizac?ão e erros

em relac?ão ao simulador . . . . . . . . . . . . . . . . . . 95





SUMÁRIO

1 Introduc?ão 23
1.1 Descric?ão do Problema . . . . . . . . . . . . . . . . . 24
1.2 Objetivos . . . . . . . . . . . . . . . . . . . . . . . . . 25

1.2.1 Objetivo Geral do Trabalho . . . . . . . . . . . 25
1.2.2 Objetivos Específicos . . . . . . . . . . . . . . 25

1.3 Estrutura do documento . . . . . . . . . . . . . . . . 25

2 Fundamentos e Definic?ões 27
2.1 Cadeia Produtiva do Petróleo . . . . . . . . . . . . . . 27
2.2 Sistemas Típicos de Produc?ão de Petróleo . . . . . . . 28
2.3 Métodos de Elevac?ão Artificial . . . . . . . . . . . . . 30

2.3.1 Elevec?ão artificial por injec?ão contínua de gás
– gas-lift . . . . . . . . . . . . . . . . . . . . . 31

2.4 Definic?ão do Problema . . . . . . . . . . . . . . . . . 35
2.5 Revisão de Literatura . . . . . . . . . . . . . . . . . . 38
2.6 Sumário . . . . . . . . . . . . . . . . . . . . . . . . . 42

3 Modelos Quadráticos para Otimizac?ão da Produc?ão 43
3.1 Introduc?ão a Modelos Quadráticos Convexos . . . . . 43

3.1.1 Conjuntos Convexos . . . . . . . . . . . . . . . 43
3.1.2 Func?ões Convexas . . . . . . . . . . . . . . . . 44
3.1.3 Modelos Quadráticos Convexos . . . . . . . . 47

3.2 Síntese de Curvas . . . . . . . . . . . . . . . . . . . . 51
3.3 Modelos Quadráticos Por Partes para Otimizac?ão da

Produc?ão . . . . . . . . . . . . . . . . . . . . . . . . . 57
3.3.1 Modelo Agregado . . . . . . . . . . . . . . . . 58
3.3.2 Modelo Desagregado . . . . . . . . . . . . . . 63
3.3.3 Demonstrac?ão de Equivalência . . . . . . . . . 65

3.4 Sumário . . . . . . . . . . . . . . . . . . . . . . . . . 70

4 Análises dos Resultados 73
4.1 Cenário Experimental . . . . . . . . . . . . . . . . . . 73
4.2 Síntese de Aproximac?ão de Curvas . . . . . . . . . . 76

4.2.1 Análise das aproximac?ões de curvas de produc?ão 76
4.2.2 Análise das aproximac?ões de curvas de queda

de pressão . . . . . . . . . . . . . . . . . . . . 82
4.3 Análise Computacional . . . . . . . . . . . . . . . . . 88
4.4 Análise de Simulac?ão . . . . . . . . . . . . . . . . . . 93
4.5 Sumário . . . . . . . . . . . . . . . . . . . . . . . . . 96



5 Conclusão 97

Referências Bibliográficas 101

Apêndice A - Conceitos Matemáticos 105
Combinac?ões . . . . . . . . . . . . . . . . . . . . . . . . . 105

Combinac?ão Linear . . . . . . . . . . . . . . . . . . . 105
Combinac?ão Afim . . . . . . . . . . . . . . . . . . . . 105
Combinac?ão Cônica . . . . . . . . . . . . . . . . . . . 107
Combinac?ão Convexa . . . . . . . . . . . . . . . . . . 108

Apêndice B - Formulac?ões Alternativas para o problema
de programac?ão semi definida 109



1 INTRODUC?ÃO

A indústria petrolífera está continuamente buscando manei-
ras de ampliar suas fronteiras com o intuito de satisfazer uma de-
manda crescente por óleos fósseis, sendo que esta ainda tende a
aumentar nos próximos anos [1]. Para suprir esta exigência do mer-
cado, novos investimentos são realizados em tecnologias que am-
pliem a capacidade produtiva e otimizem os processos de extrac?ão
e processamento, bem como os tornem mais eficientes, econômicos
e sustentáveis.

No entanto, antes que estas tecnologias possam ser completa-
mente aplicadas aos campos de petróleo, há ainda muitos desafios
científicos a serem superados. A pesquisa descrita nesse documento
tem o intuito de contribuir com a sobreposic?ão desses desafios por
meio de uma abordagem para otimizac?ão matemática da produc?ão
de petróleo em poc?os operados por elevac?ão artificial utilizando mo-
delos quadráticos côncavo-convexos por partes.

Em um cenário real de operac?ão, muitas vezes as distâncias
entre poc?os de grandes campos de petróleo e destes aos respectivos
separadores podem ser consideráveis. Normalmente, adota-se uma
configurac?ão em que os fluidos produzidos por um grupo de poc?os
são concentrados em um manifold, e deste uma única linha que
escoa os fluidos ao separador onde o fluxo multifásico é separado
em água, gás e petróleo [2, 3, 4].

A classe de problemas que se adota neste presente trabalho
é a de poc?os de petróleo tendo pressão de reservatório insuficiente
para produzir naturalmente os fluidos de formac?ão. Nestes casos,
algumas técnicas de elevac?ão artificial podem ser utilizadas, como
bombeio mecânico, bombeio centrífugo submerso, bomba de cavi-
dade progressiva, gas-lift, entre outras [2].

Especificamente o gas-lift consiste em injetar gás pressurizado
pelo espac?o anular. Em determinadas profundidades este gás é redi-
recionado para dentro da coluna de produc?ão e se dissolve ao fluido
a ser produzido. Ao se dissolver, o fluido resultante diminui sua den-
sidade e tem mais facilidade de ser produzido pela pressão de fundo.
Este efeito aumenta à medida que o fluido da mistura se aproxima
da cabec?a do poc?o, uma vez que o gás se expande gradativamente,
elevando com ele o petróleo.

Nestes poc?os a produc?ão de petróleo (vazão de petróleo) é
func?ão da injec?ão de gás pressurizado e da pressão na cabec?a do
poc?o. Em contrapartida a pressão na cabec?a do poc?o é func?ão da
pressão nominal do separador e das quedas de pressão nas linhas
de produc?ão. Ou seja, a pressão na cabec?a do poc?o é uma pressão

23



24 Capítulo 1. Introduc?ão

de equilíbrio, resultante de duas fronteiras de pressão (pressão de
reservatório e separador) da curva de influxo do poc?o e das quedas
de pressão por atrito na coluna de produc?ão do poc?o e linhas de
produc?ão na superfície.

Tanto a curva de produc?ão de petróleo, quanto a curva de
queda de pressão são não-lineares e não-convexas, o que se apre-
senta como uma das maiores dificuldades para se resolver o pro-
blema de otimizac?ão de um campo de petróleo com elevac?ão por
gas-lift, uma vez que o problema subjacente é da classe não-linear
inteira-mista.

1.1 DESCRIC?ÃO DO PROBLEMA

Utilizando-se curvas não-lineares para se aproximar os valo-
res das curvas de produc?ão de petróleo e queda de pressão se pode
formular o problema de otimizac?ão da produc?ão em um problema
de programac?ão matemática da classe Não-Linear Inteira Mista (do
inglês Mixed-Integer NonLinear Programming - MINLP), ao qual os
principais solvers da atualidade não são aplicáveis[2, 4, 3].

Para resolver esse problema, uma das abordagens adotada
pela literatura faz uso da aproximac?ão da func?ão de produc?ão utili-
zando a combinac?ão convexa linear por partes de amostras do do-
mínio da curva original [4]. Como resultado, obtém-se um modelo
linear por partes que pode ser mais ou menos refinado dependendo
do número de pontos amostrados e do número de curvas que re-
presentam a func?ão original em seu domínio factível. Este método
permite alcanc?ar ótimos globais nas aproximac?ões correspondentes.
Contudo, eles inserem no problema de otimizac?ão um número ele-
vado de variáveis para poderem ser representados. Este acréscimo
é tão maior quanto mais precisa se quiser ter a representac?ão da
curva não-linear e acarreta o aumento de complexidade do modelo
final, aumentando também o custo computacional para se resolver
o problema.

Uma abordagem alternativa é o uso de aproximac?ões cônca-
vas ou convexas quadráticas por partes [2]. Nela igualmente se di-
vide o domínio da func?ão e utilizando um método adequado é possí-
vel encontrar uma func?ão côncava ou convexa que aproxime os va-
lores da curva em uma determinada divisão do domínio. Apesar de
também inserir variáveis extras no problema de otimizac?ão dos cam-
pos de petróleo, esta abordagem é mais compacta, impactando de
forma menos dura no custo computacional. Usando esta técnica pro-



1.2. Objetivos 25

posta é possível reformular o problema de otimizac?ão da produc?ão
como um problema de Programac?ão Convexa Inteira Mista (do in-
glês Mixed-Integer Convex Progamming - MICP) e resolvê-lo com um
solver comercial.

No entanto, dependendo do número de divisões do domínio e
em modelos de maiores dimensões, nos quais a curva de produc?ão
considera mais variáveis além da injec?ão de gás, a complexidade
dos modelos se acentua e se pode elevar demasiadamente a con-
vergência para o ótimo ou mesmo nem se alcanc?ar a soluc?ão do
problema.

Na busca por técnicas que possam resolver esse problema, o
presente trabalho pretende desenvolver aproximac?ões das curvas
de produc?ão e queda de pressão com base em modelos quadráticos
côncavo-convexos por partes na tentativa de identificar uma relac?ão
de custo benefício entre um modelo suficientemente mais compacto
dentro de um custo computacional aceitável.

1.2 OBJETIVOS

1.2.1 Objetivo Geral do Trabalho

Buscando contribuir ao estado da arte da teoria e prática em
métodos de otimizac?ão, esta dissertac?ão de mestrado irá desenvol-
ver aproximac?ões côncava-convexas por partes para a otimizac?ão
da produc?ão integrada de campos de petróleo e gás.

1.2.2 Objetivos Específicos

\bullet Propor modelos côncavo-convexos por partes, identificando
suas propriedades e limitac?ões em contextos científicos e prá-
ticos.

\bullet Avaliar a eficiência de modelos côncavo-convexos por partes
tomando como base uma aplicac?ão à otimizac?ão integrada da
produc?ão de campos de petróleo e gás, considerando func?ões
não-lineares complexas tais como a queda de pressão em li-
nhas de escoamento.

1.3 ESTRUTURA DO DOCUMENTO

Essa dissertac?ão está segmentada em cinco capítulos: o Capí-
tulo 2 busca fornecer ao leitor informac?ões gerais sobre a cadeia pro-
dutiva do petróleo, detalhando aspectos que são relevantes a essa



26 Capítulo 1. Introduc?ão

pesquisa como técnicas de elevac?ão artificial de fluidos, mais espe-
cificamente a de gas-lift. Além disso, o problema de otimizac?ão da
produc?ão de petróleo é definido conceitualmente com formulac?ões
matemáticas de eventos físicos que fazem parte do sistema e, por
fim, o capítulo se encerra com uma revisão de literatura contendo
trabalhos relacionados ao tema.

O Capítulo 3 tem por objetivo apresentar o desenvolvimento
dessa pesquisa propriamente dito, a partir de modelos para a otimi-
zac?ão da produc?ão de petróleo tomando como base a síntese de
curvas quadráticas aproximativas de func?ões que envolvem os fenô-
menos físicos mencionados no capítulo anterior.

O Capítulo 4 apresenta os resultados simulados da pesquisa.
Primeiramente, define-se o cenário experimental considerado na
pesquisa e, em seguida, os resultados alcanc?ados após análise com-
putacional.

O Capítulo 5 apresenta o sumário da pesquisa realizada, sin-
tetizando os resultados alcanc?ados e as perspectivas de trabalhos
futuros.

Por fim, o Anexo A traz conceitos matemáticos fundamentais
para o universo de problemas em que este trabalho está inserido, os
quais podem auxiliar no entendimento do leitor. Já o Anexo B tem
por objetivo mostrar outras formulac?ões de síntese de curvas.



2 SISTEMAS DE PRODUC?ÃO DE PETRÓLEO E DEFINIC?ÃO DO
PROBLEMA

Esse capítulo traz informac?ões a respeito do universo de ex-
plorac?ão e produc?ão de petróleo e gás, fornecendo primeiramente
uma visão geral sobre a cadeia produtiva de combustíveis fósseis a
fim de justificar o investimento em esforc?os para otimizar os proces-
sos subjacentes. Em seguida, será apresentado um típico sistema de
produc?ão de petróleo e gás, identificando os elementos principais
que compõem esse tipo de sistema. O capítulo tem continuidade
com a discussão sobre os principais métodos de elevac?ão artificial
de fluidos, enfatizando a técnica de gas-lift, utilizada na composic?ão
desse trabalho. Em seguida o problema abordado nessa dissertac?ão
é definido conceitualmente com destaque para a formulac?ão mate-
mática de fenômenos físicos ocorridos dentro do sistema de produ-
c?ão de petróleo. Por fim, o capítulo se encerra com uma revisão de
literatura em torno da problemática apresentada, salientando pes-
quisas inseridas nesse contexto e a contribuic?ão gerada por esse
trabalho.

2.1 CADEIA PRODUTIVA DO PETRÓLEO

No decorrer do último século houve um forte aumento na
demanda por hidrocarbonetos como fonte de combustíveis e, por
consequência, esse fato fez com que a explorac?ão de petróleo se
espalhasse por diversas regiões do planeta. Ainda que a produc?ão
de petróleo e gás tenha ocupado uma parcela menor na oferta de
energia mundial, reduzida de 62% em 1973 para 53,7% em 2010;
em números absolutos, o consumo de petróleo se elevou, partindo
de 55,638 milhões para 87,381 milhões de barris por dia no mesmo
período. A perspectiva é que esse número se eleve à casa dos 100
milhões de barris por dia até o ano de 2030, no entanto, acompa-
nhado de uma melhora na eficiência energética, regulamentac?ões e
políticas governamentais e ambientais mais severas [1].

Todos esses desafios que a indústria do petróleo deve enfren-
tar nos próximos anos fazem com que haja investimentos em novas
tecnologias, melhores sistemas de gestão e reduc?ão de custos ope-
racionais em toda a cadeia de produc?ão.

Os sistemas e processos da indústria de petróleo e gás são am-
plamente definidos e podem ter diversas nomenclaturas, entretanto,
pode-se dividir a cadeia produtiva da indústria petrolífera em dois
grandes grupos:

27



28 Capítulo 2. Fundamentos e Definic?ões

\bullet Upstream: Caracteriza-se pelas operac?ões de explorac?ão e pro-
duc?ão (E&amp;amp;P). Consiste nas atividades relacionadas à extrac?ão
de petróleo e gás e inclui atividades como estudo de reser-
vas e reservatórios, planejamento, perfurac?ão e o processo de
produc?ão [5, 6, 7].

\bullet Downstream: As atividades que se enquadram nessa parte do
processo envolvem o transporte e armazenamento, como tam-
bém refino e distribuic?ão [5, 6, 7].

Esta dissertac?ão envolve o setor de upstream da cadeia de
produc?ão, mais especificamente, a produc?ão de petróleo e gás.

2.2 SISTEMAS TÍPICOS DE PRODUC?ÃO DE PETRÓLEO

De forma genérica, a finalidade de um sistema de produc?ão
submarino é produzir hidrocarbonetos de maneira eficiente, porém
seguindo normas de seguranc?a e políticas ambientais. Tipicamente,
um sistema de produc?ão é formado por componentes como mos-
trado na Figura 2.1, sendo os principais elementos descritos a seguir
[8, 9]:

\bullet Poc?os: A func?ão principal de um poc?o é transferir os hidro-
carbonetos contidos em um reservatório para os manifolds.
Um poc?o pode ter um ou vários ramos perfurados vertical-
mente ou direcionados para alcanc?ar áreas do reservatório
com maior probabilidade de se obter alta produc?ão de hidro-
carbonetos. Depois da perfurac?ão de um poc?o, ele recebe tubu-
lac?ões com a func?ão de isolar os fluidos contidos no reservató-
rio até a sua transferência para os manifolds. Além disso, um
poc?o pode conter várias válvulas em sua extensão, as quais
permitem uma operac?ão mais segura durante o processo de
produc?ão, assim como possibilitam operac?ões de manutenc?ão.

\bullet Manifold: O objetivo de instalar manifolds em um sistema de
produc?ão é misturar os fluxos vindos de vários poc?os em uma
quantidade menor de tubulac?ões que transferem o fluxo de hi-
drocarbonetos para o sistema de tratamento e separac?ão. Essa
mistura de fluxos é realizada a partir de tubulac?ões e válvulas
on/off que definem alinhamentos entre poc?os e manifolds.

\bullet Tubulac?ões e risers: As tubulac?ões conectam os poc?os aos ma-
nifolds, e esses às instalac?ões de superfície. Especificamente,



2.2. Sistemas Típicos de Produc?ão de Petróleo 29

Oil
Separated

Oil

SeparatedGas
to Compressor

Compressed
Gas to Wells

Oil/Gas
FromWells

Separated
Oil

SeparatedGas
to Compressor

Compressed
Gas to Wells

Oil/Gas
FromWells

Óleo-Água

Reservatório

Manifolds

     
Gás Separado

Gás Pressurizado para
Injetar nos Poços

Poço A Poço B Poço C Poço D Poço E

Óleo + Gás + Água

Válvulas de Alinhamento

C h o k e s d e I n j e ç ã o

d e G á s

Compressor

Sistema de tratamento de 
água e exportação de óleo

Sistema de tratamento e separação de gás

Figura 2.1: Sistema de produc?ão de petróleo com alinhamento e
injec?ão de gás [4].

tubulac?ões verticais que elevam o fluido aos manifolds são de-
nominadas risers.

\bullet Separador: O fluido produzido a partir de um reservatório
é enviado a um separador, podendo conter petróleo, gases,
água e outros contaminantes. Dessa forma, o separador atua
como um sistema de tratamento primário de produc?ão, onde
ocorre a separac?ão dos componente da mistura provinda da
produc?ão.

\bullet Compressor: Dentro da cadeia de produc?ão de petróleo e gás,
há a utilizac?ão de diversos tipos de compressores. Especifica-
mente o compressor da Figura 2.1 tem a func?ão de disponibi-
lizar gás para poc?os com elevac?ão artificial por injec?ão de gás,
os quais foram utilizados para a realizac?ão desse trabalho e
que serão discutidos em maiores detalhes adiante.

O sistema representado na Figura 2.1 conta com cinco poc?os
produtores em um reservatório. O fluido (petróleo, gás e água) é le-



30 Capítulo 2. Fundamentos e Definic?ões

vado até o manifold de acordo com a configurac?ão das válvulas de
alinhamento. A mistura provinda dos poc?os é redirecionada ao sepa-
rador, o qual desmembra as fases do fluido: água é tratada e petró-
leo exportado. Já o gás produzido é em parte exportado, enquanto
outra quantidade é recondicionada ao sistema para o processo de
elevac?ão artificial.

É importante salientar que cada sistema de produc?ão tem pe-
culiaridades e que a produc?ão de petróleo é condicionada aos reser-
vatórios, poc?os, limites e capacidades de processamento de fluidos
nas instalac?ões. Essas restric?ões devem ser consideradas durante o
processo de operac?ão de produc?ão, de forma que se defina algumas
configurac?ões, tais como, válvulas reguladoras de vazão, escolha
dos poc?os produtores e alinhamento entre poc?os, manifolds e sepa-
radores [4].

2.3 MÉTODOS DE ELEVAC?ÃO ARTIFICIAL

A produc?ão de um poc?o é definida pela diferenc?a de pres-
são obtida na cabec?a do poc?o e no reservatório. Basicamente, poc?os
produtores podem ser de dois tipos de acordo com essa diferenc?a
de pressão: free flowing ou lifted. No primeiro caso, o poc?o possui
pressão de fundo suficientemente alta para alcanc?ar a cabec?a do
poc?o mantendo uma vazão aceitável. Já em poc?os em que a pres-
são no reservatório é baixa, ou em casos em que se deseja elevar
a produc?ão, há a necessidade de métodos artificias de elevac?ão do
fluido pela tubulac?ão de produc?ão [9]. Existem algumas técnicas
que permitem isso:

\bullet Bombeamento Mecânico: É um método normalmente utili-
zado em poc?os terrestres. A unidade de bombeamento mecâ-
nico é instalada próxima à cabec?a do poc?o. A partir da rotac?ão
de um motor, uma haste posicionada dentro da tubulac?ão de
produc?ão passa a executar um movimento alternado ascen-
dente e descendente. A haste é conectada a um êmbolo que
desce até atingir o nível do fluido no poc?o e depois sobe fa-
zendo emergir o petróleo [9].

\bullet Bomba Centrífuga Submersa: É um sistema composto por
bombas centrífugas instaladas nos fundos dos poc?os que tem
como func?ão gerar pressão de fundo desejada para a elevac?ão
de fluidos. Essas bombas são movidas por motores elétricos



2.3. Métodos de Elevac?ão Artificial 31

que podem variar sua velocidade permitindo uma produc?ão
mais flexível [10].

\bullet Gas-lift: Esse método consiste em injetar gás pressurizado na
boca do poc?o pelo anular. Em determinadas profundidades
este gás e redirecionado para dentro da coluna de produc?ão e
se dissolve ao fluido a ser produzido. Ao se dissolver, o fluido
resultante diminui sua densidade e tem mais facilidade de ser
produzido pela pressão de fundo. Este efeito aumenta à me-
dida que o fluido da mistura se aproxima da cabec?a do poc?o,
uma vez que o gás se expande gradativamente elevando com
ele o petróleo [10].

Especialmente essa última técnica mencionada é a conside-
rada nesse trabalho e, por esse motivo, será melhor detalhada.

2.3.1 Elevec?ão artificial por injec?ão contínua de gás – gas-lift

Gas-lift é um método de elevac?ão artificial no qual gás de
alta pressão é injetado na tubulac?ão de produc?ão com o objetivo
de aumentar a produc?ão a partir da inserc?ão de energia no sistema.
No entanto, tendo em vista que por vezes o custo de compressão
do gás é superior ao custo de instalac?ão dos equipamentos, deve-se
considerar primeiramente a disponibilidade e custo de compressão
do gás antes da utilizac?ão de gas-lift para a elevac?ão de fluidos em
poc?os [10, 11]. Ainda assim, gas-lift é amplamente utilizado em
razão de seu custo-benefício favorável quando comparado a outras
técnicas de elevac?ão artificial [12]. A Figura 2.2 ilustra o método
de elevac?ão artificial por gas-lift.

Por meio de uma válvula chamada choke de injec?ão de gás, o
gás a alta pressão entra no sistema e é injetado no anular, o qual
consiste em um espac?o entre o revestimento do poc?o e a coluna de
produc?ão. O gás presente no anular é então injetado na tubulac?ão
de produc?ão por meio de válvulas de gas-lift que podem se estender
pela coluna de produc?ão.

A produc?ão de um poc?o é determinada pelos fluidos que saem
da tubulac?ão de produc?ão e é por meio dela que se conduz o óleo, a
água e o gás produzido e injetado até o choke de produc?ão. A injec?ão
de gás diminui a densidade média da mistura. Como o volume do
tubo de produc?ão é constante a ocupac?ão de parte do volume por
um fluido mais leve resulta em uma pressão hidrostática menor no
fundo do poc?o.



32 Capítulo 2. Fundamentos e Definic?ões

Reservatório

Válvula de
gas-lift

Entrada
de gás

Válvula de
produção

Saída da
produção

Válvula de
injeção

Anular
Tubulação de

produção

Tubing

Annulus

Reservoir

Injection
valve

Production
choke

Gas Lift
Choke

Casing

Packer

as in

Productio
out

Reservoir

Injection
valve

P

Gas Lift
Choke

Gas in

Figura 2.2: Poc?o operado por gas-lift. Adaptado de [13].

Quando se obtém uma mistura de menor densidade na tu-
bulac?ão de produc?ão por meio da injec?ão de gás pressurizado, a
diferenc?a de pressão entre o reservatório e a pressão de fundo do
poc?o induz a elevac?ão dos hidrocarbonetos do reservatório para o
poc?o.

A diferenc?a de pressão de reservatório e pressão de reservató-
rio e pressão de fundo é o que vai determinar a vazão de influxo do



2.3. Métodos de Elevac?ão Artificial 33

poc?o em func?ão da característica do reservatório representado pela
relac?ão IPR (Inflow Performance Relationship). A diminuic?ão da den-
sidade diminui a parcela da perda de pressão no tubo de produc?ão
devido a gravidade. Assim a pressão do reservatório consegue ven-
cer a contra pressão total resultando em uma vazão de produc?ão de
interesse.

Contudo, a injec?ão de gás no poc?o com a intenc?ão de reduc?ão
da densidade do fluido tem um aspecto bastante relevante: após
atingir um ponto de injec?ão considerado ótimo, a inserc?ão de gás
pressurizado comec?a a causar efeitos que não permitem o bom fun-
cionamento do sistema, uma vez que o alto volume de gás inten-
sifica o efeito do atrito da mistura com a tubulac?ão de produc?ão,
elevando a pressão de saída, e por consequência, reduzindo a va-
zão.

Para determinar pontos de operac?ão na injec?ão de gás em
um poc?o, é comum que se utilize a curva de desempenho de um
poc?o, ou WPC (Well Performance Curve). A Figura 2.3(a) ilustra duas
curvas de desempenho de poc?os.

A curva A apresenta características de um poc?o surgente, ou
seja, com pressão no reservatório suficientemente elevada para fa-
zer os fluidos produzidos subirem naturalmente pela coluna de pro-
duc?ão. Nesse poc?o, qualquer quantidade de gás injetado trará al-
terac?ões à produc?ão do poc?o. Todavia, no caso da curva B, o mes-
mo comportamento não ocorre, sendo necessária a injec?ão de uma
quantidade mínima de gás para que o poc?o passe a produzir [10].

Já a Figura 2.3(b) tem por objetivo ilustrar a região ótima de
injec?ão de gás em uma WPC típica. Como se pode perceber, na re-
gião (I) a produc?ão do poc?o se eleva com a injec?ão de gás, enquanto
na região (II) a produc?ão é reduzida, mesmo com o aumento de
injec?ão. O ponto de inflexão da curva é a taxa ótima de injec?ão
de gás no poc?o no caso em que a capacidade de compressão de
gás é ilimitada. No entanto, limitac?ões como a capacidade dos com-
pressores, fazem com que o ponto ótimo de operac?ão se encontre
normalmente na região de operac?ão destacada na Figura 2.3(b).

Sendo assim, o problema de otimizac?ão da produc?ão de pe-
tróleo em poc?os operados por gas-lift consiste em encontrar taxas
de injec?ão de gás para os poc?os considerandos os limites de capaci-
dade dos compressores, além de limitac?ões operacionais, de modo
que se obtenha a maior produc?ão possível.



34 Capítulo 2. Fundamentos e Definic?ões

Taxa de injeção de gás
(a)

Ta
x
a
 d

e
 p

ro
d
u
ç
ã
o
 d

e
 p

e
tr

ó
le

o

Taxa de injeção de gás
(b)

Ta
x
a
 d

e
 p

ro
d
u
ç
ã
o
 d

e
 p

e
tr

ó
le

o

A

B

qoil

qinj

qoil

qinj

qmax  oil

(I)      (II)

Região
econômica

Figura 2.3: Curva de desempenho do poc?o. Baseado em [10].



2.4. Definic?ão do Problema 35

2.4 DEFINIC?ÃO DO PROBLEMA

Como mencionado anteriormente, em poc?os nos quais a pres-
são no reservatório não é suficientemente alta para a elevac?ão dos
fluidos, faz-se necessário o uso de algum método de elevac?ão artifi-
cial.

No caso desse trabalho, considerou-se a utilizac?ão de gas-lift.
Nestes poc?os, a produc?ão de petróleo (vazão de petróleo) é func?ão
da injec?ão de gás e da pressão na cabec?a do poc?o. Já esta é func?ão
da pressão nominal do separador e das quedas de pressão nas linhas
de produc?ão.

De forma equivalente, o problema de otimizac?ão da produc?ão
apresentado a seguir considera a curva de desempenho do poc?o, ou
WPC (Well Performance Curve), como func?ão da injec?ão de gás e da
pressão no manifold, o qual recebe a produc?ão do poc?o.

O problema de otimizac?ão da produc?ão consiste em definir
taxas de injec?ão de gás para cada poc?o, roteamento entre poc?os e
manifolds e pressões que maximizam a produc?ão de petróleo para
um campo operado por gas-lift.

Conceitualmente, o problema pode ser formulado como um
problema não-linear inteiro misto, ou simplesmente MINLP (Mixed-
Interger Non-Linear Programming):

P : \mathrm{m}\mathrm{a}\mathrm{x} f =
\sum 

m\in \scrM 
\bfq mo (2.1a)

sujeito a:\sum 
n\in \scrN 

qninj \leq q
U
inj, (2.1b)

Para todo n \in \scrN :

q
n,L
inj y

n \leq qninj \leq q
n,U
inj y

n, (2.1c)

\sum 
m\in \scrM n

zn,m = yn, (2.1d)

\bfq n,m = qn,m(pm, qninj)z
n,m, \forall m \in \scrM n, (2.1e)

zn,m\bfq n,L \leq \bfq n,m \leq zn,m\bfq n,U, \forall m \in \scrM n, (2.1f)



36 Capítulo 2. Fundamentos e Definic?ões

Para todo m \in \scrM :

\bfq m =
\sum 

n\in \scrN m

\bfq n,m, (2.1g)

\bfq m,L \leq \bfq m \leq \bfq m,U, (2.1h)

pm,L \leq pm \leq pm,U, (2.1i)

pm = pm,S + \Delta pm(\bfq m), (2.1j)

yn \in \{ 0, 1\} , \forall n \in \scrN , (2.1k)

zn,m \in \{ 0, 1\} , \forall n \in \scrN , \forall m \in \scrM n. (2.1l)
com os seguinte parâmetros:

\bullet \scrN = \{ 1, . . . , N\} é o conjunto de poc?os, N sendo o número
de poc?os e \scrN m \subseteq \scrN o subconjunto de poc?os que podem ser
conectados ao manifold m;

\bullet \scrM = \{ 1, . . . , M\} é o conjunto de manifolds, M sendo o nú-
mero de manifolds e \scrM n \subseteq \scrM o subconjunto de manifolds
que podem receber produc?ão de um poc?o n, a qual é transfe-
rida para o respectivo separador.

\bullet \scrH = \{ o, g, w\} representa o fluxo multifásico: petróleo (o), gás
(g) e água (w);

\bullet qUinj é o limite de gás de elevac?ão fornecido pelos compresso-
res;

\bullet qn,Linj e q
n,U
inj são limites de injec?ão de gás no poc?o n;

\bullet pm,L and pm,U são limites de pressão no manifold m;

\bullet pm,S é a pressão nominal do separador que recebe a produc?ão
do manifold m;

\bullet \bfq n,L e \bfq n,U são vetores que limitam o fluxo multifásico do
poc?o n;

\bullet \bfq m,L e \bfq m,U são vetores com as taxas mínima e máxima de
fluxo multifásico no manifold m, as quais representam a capa-
cidade dos separadores ligados ao manifold m;



2.4. Definic?ão do Problema 37

variáveis:

\bullet qninj é a taxa de fluxo de gás de elevac?ão alocada para o poc?o
n;

\bullet yn assume o valor 1 quando o poc?o n está produzindo, e 0
caso contrário;

\bullet zn,m é 1 se a produc?ão do poc?o n é direcionada ao manifold
m, e 0 caso contrário;

\bullet \bfq n,mh é o fluxo da fase h \in \scrH enviada do poc?o n ao manifold
m e \bfq n,m = (\bfq n,mh : h \in \scrH ) é um vetor com o fluxo de todas
as fases. O fluxo de gás recebido no manifold é a soma do gás
de elevac?ão injetado no poc?o n (Inj) e o gás produzido no
reservatório (R), assim \bfq n,mg = q

n,m
g,R + q

n,m
g,Inj;

\bullet \bfq m é o fluxo total recebido de todos os poc?os conectados ao
manifold m para todas as fases;

\bullet pm é a pressão do manifold m;

e func?ões:

\bullet qn,m(pm, qninj) é a func?ão de produc?ão do poc?o n se conectado
ao manifold m em func?ão da pressão no manifold pm e da taxa
de injec?ão do gás de elevac?ão qninj;

\bullet \Delta pm(\bfq m) é a queda de pressão na linha que conecta o mani-
fold m ao seu separador dedicado como func?ão de \bfq m.

O problema P visa maximizar a func?ão objetivo f a qual re-
presenta todo o petróleo produzido e coletado pelos manifolds. Ou-
tras func?ões objetivo poderiam ter sido utilizadas, como maximizar
o ganho econômico. Porém, func?ões que consideram a maximizac?ão
do petróleo produzido (ou, equivalentemente, considerando gás)
são mais utilizadas, uma vez que é mais fácil medir a produc?ão.

O problema apresenta restric?ões operacionais e físicas em
cada equac?ão como descrito abaixo:

\bullet Eq. (2.1b) garante que todo o gás recebido pelos poc?os é me-
nor que o limite dos compressores.

\bullet Eq. (2.1c) mantém a injec?ão de gás entre limites superior e
inferior se o poc?o está ativo.



38 Capítulo 2. Fundamentos e Definic?ões

\bullet Eq. (2.1d) assegura que cada poc?o está conectado somente a
um manifold quando o poc?o estiver produzindo.

\bullet Eq. (2.1e) define o fluxo multifásico recebido de um poc?o
pelo manifold como uma func?ão da pressão no manifold e da
injec?ão do gás de elevac?ão.

\bullet Eq. (2.1f) limita o fluxo produzido por um poc?o quando este
está ativo.

\bullet Eq. (2.1g) afirma que a soma dos fluxos produzidos por todos
os poc?os conectados a um manifold é igual ao fluxo de entrada
no manifold.

\bullet Eqs. (2.1h) e (2.1i) estabelecem, respectivamente, limites pa-
ra o fluxo multifásico produzido e a pressão para os manifolds.

\bullet Eq. (2.1j) afirma que a pressão no manifold é dada pela pres-
são nominal no separador e a queda de pressão nas linhas de
produc?ão.

O problema MINLP apresentado é complexo e consideravel-
mente difícil de ser resolvido, uma vez que apresenta func?ões não
lineares (curvas de produc?ão e queda de pressão) e variáveis discre-
tas.

Efetivamente, o problema de otimizac?ão da produc?ão P só
é conhecido conceitualmente, uma vez que a WPC e as curvas de
queda de pressão não são conhecidas explicitamente. Embora se
consiga métodos aproximativos para contornar essa dificuldade, es-
sas técnicas são por si só problemas bastante desafiadores.

2.5 REVISÃO DE LITERATURA

No modelo de poc?os operados por gas-lift, a curva de produ-
c?ão de óleo é func?ão da injec?ão de gás e da pressão na cabec?a do
poc?o. Essa curva é não-linear, induzindo grande complexidade na
resoluc?ão do problema de otimizac?ão de campos de petróleo que
utilizam essa técnica de elevac?ão artificial.

Alguns trabalhos na área propuseram alternativas para a so-
luc?ão desse problema. Na pesquisa de Misener, R.; Gounaris, C. E. e
Floudas, C. A. [14] foi proposta a resoluc?ão global de um problema
de otimizac?ão da produc?ão de petróleo. No trabalho foram desen-
volvidos quatro modelos que utilizam a técnica de linearizac?ão por
partes, ou seja, a curva original é discretizada e aproximada por



2.5. Revisão de Literatura 39

segmentos de planos e hiperplanos. O foco do trabalho, no entanto,
concentrou-se na comparac?ão entre os quatro modelos.

No trabalho de Geibler, B. [15], outra maneira de resolver o
problema foi proposta: os refinamentos nas aproximac?ões lineares
não são feitos de forma uniforme, isso significa, que fatias do domí-
nio da func?ão original podem ter diferentes níveis de refinamento,
dependendo da necessidade. A técnica é composta de refinamentos
iterativos que comparam os erros das aproximac?ões em relac?ão à
curva original e usam essa informac?ão para novas iterac?ões.

Codas, A. e Camponogara, E. [16] propuseram duas formu-
lac?ões Lineares Inteiras-Mistas para um problema de alocac?ão de
gas-lift considerando restric?ões de roteamento entre os poc?os e res-
pectivos separadores. As duas formulac?ões adotadas foram obtidas
por meio de linearizac?ão por partes das curvas não lineares origi-
nais. Na primeira formulac?ão do problema, chamada de formulac?ão
compacta, utilizou-se variáveis binárias para explicitar o intervalo
de linearizac?ão e outra para roteamento. Já na segunda formulac?ão,
denominada de formulac?ão integrada e que apresentou melhores
resultados, a diferenc?a se concentrou na troca das variáveis de ro-
teamento por outra que considera, além do roteamento, a região
linearizada do problema.

No trabalho de Silva, T. L. [4] foram também utilizadas for-
mulac?ões lineares inteiras-mistas para o problema de alocac?ão de
gás a partir de técnicas de linearizac?ão por partes para func?ões mul-
tidimensionais. Nesse trabalho, porém, além de restric?ões de rote-
amento, foram consideradas restric?ões de pressão no sistema de
produc?ão. Sete formulac?ões lineares inteiras-mistas foram propos-
tas considerando aproximac?ões por hipercubos e por simplexes. No
caso dos hipercubos a formulac?ão se tornou mais simples se com-
parada a por simplexes, pois possua menos variáveis. Mostrou-se
também que, em modelos que consideram mais variáveis além da
injec?ão de gás, a complexidade e resoluc?ão dos modelos fica gra-
dativamente mais difícil, com bastante lentidão para o alcance do
ótimo.

Os resultados obtidos no trabalho anterior foram utilizados
para continuidade da pesquisa em [17]. Nesse caso, foi desenvol-
vido um modelo não-linear inteiro misto para alocac?ão de gás. Nes-
se estudo, adotou-se restric?ões de alinhamento e pressão entre po-
c?os e manifolds. Considerando-se que o problema original é da clas-
se não-linear inteira mista, foram propostas duas alternativas com
modelos aproximativos lineares inteiros-mistos: o primeiro utilizan-
do combinac?ão convexa, e um segundo logarítmico. Como resul-



40 Capítulo 2. Fundamentos e Definic?ões

tado se observou que o modelo logarítmico foi mais eficiente em
virtude de possuir um número menor de variáveis e restric?ões intro-
duzidas no problema.

Em [18], Rocha, V. G. propôs uma técnica de gerac?ão de cur-
vas lineares adaptativa, na qual também se faz uso de um processo
iterativo para a gerac?ão de aproximac?ões com diferentes níveis de
refinamento, dependendo da região considerada para a aproxima-
c?ão. Nessa estratégia se busca uma aproximac?ão na região do ótimo
o mais próxima possível da curva original. A gerac?ão de novas apro-
ximac?ões (mais refinadas) se dá a partir de três heurísticas propos-
tas durante o trabalho: uma em que somente a região em torno do
ótimo é adaptada, outra que fixa pontos em torno do ótimo para
gerar uma nova adaptac?ão e uma terceira, denominada logarítmica,
com estratégia similar a uma busca binária. Após o refinamento, as
curvas lineares adaptadas são utilizadas no problema de otimizac?ão
da produc?ão de óleo. A técnica foi aplicada também para func?ões
unidimensionais e bidimensionais, mas não apresentou grandes ga-
nhos computacionais se comparado a um modelo sem adaptac?ões
iterativas.

Em [2], o problema original de otimizac?ão da produc?ão que
é não linear inteiro-misto passou a ser tratado por uma abordagem
que considera linearizac?ões por partes bidimensionais para func?ões
de produc?ão dos poc?os, as quais dependem da injec?ão de gás e pres-
são na cabec?a do poc?o. Já para as func?ões de queda de pressão
que são tridimensionais, considerou-se func?ões quadráticas conve-
xas contínuas. As aproximac?ões convexas foram adotadas por serem
mais compactas quando comparadas às aproximac?ões lineares para
modelos de maior dimensão, diminuindo assim a quantidade de va-
riáveis e a velocidade na procura pelo ótimo. Com essa formulac?ão
o que se obtém no final é um problema de programac?ão convexa
intera-mista, que segundo resultados, apresentou melhor desempe-
nho computacional, principalmente para aproximac?ões mais refina-
das.

Na pesquisa de Grimstad, B. [8] foi proposto um framework
para modelagem e otimizac?ão de redes de fluxo multifásico por
meio de um modelo aproximativo baseado em splines. O objetivo
principal do framework é encontrar um equilíbrio entre velocidade
e precisão na resoluc?ão de problemas de otimizac?ão diária da pro-
duc?ão de petróleo e gás. Um ponto importante dessa pequisa é que
no modelo genérico proposto foram adotadas, além de restric?ões
relacionadas aos eventos de vazão e perda de carga no sistema,
equac?ões que lidam com a entalpia do processo, tornando o modelo



2.5. Revisão de Literatura 41

ainda mais completo. Nesse trabalho foram obtidos bons resultados
em relac?ão ao objetivo inicial, uma vez que modelos desenvolvidos
a partir do framework atingiram ótimos globais e, quando compa-
rada a outros métodos não-lineares, a técnica adotada se apresen-
tou mais eficaz.

Com base nas pesquisas mencionadas nessa sec?ão, essa dis-
sertac?ão vem contribuir com uma abordagem alternativa para reso-
luc?ão do problema. Assim como em [2], serão utilizadas aproxima-
c?ões quadráticas para tratar o problema de otimizac?ão da produc?ão,
colocando-o na categoria de convexo inteiro-misto.

No entanto, diferentemente do trabalho mencionado anteri-
ormente, o qual adota aproximac?ões quadráticas para a curva de
perda de carga na linha e lineares para a func?ão de produc?ão, a pre-
sente pesquisa visa adotar um modelo genérico com aproximac?ões
quadráticas, tanto para a curva de queda de pressão, quanto para
a curva de produc?ão. A partir desse modelo genérico será possível
realizar diversas combinac?ões e abordagens que se adaptem a um
determinado cenário, uma vez que, zerando o termo quadrático das
aproximac?ões, essas passam a ser lineares, permitindo que o mo-
delo vá de uma abordagem que fac?a somente uso de aproximac?ões
lineares até uma outra com somente aproximac?ões quadráticas.

Além disso, de forma semelhante a [16], foram adotadas duas
formulac?ões para representar o modelo genérico de produc?ão de
fluidos fósseis, as quais serão apresentadas no próximo capítulo: a
primeira, denominada de agregada, considera apenas uma variá-
vel binária que contem informac?ões a respeito de roteamento entre
poc?os e manifolds e intervalos ativos nos domínios das func?ões de
produc?ão e pressão. Já a segunda formulac?ão, chamada desagre-
gada, possui um conjunto de variáveis binárias para tratar indepen-
dentemente o roteamento e os intervalos ativos das func?ões.

Tendo isso em mente, é viável, dentro de um mesmo cenário
de produc?ão de petróleo e gás, abrir múltiplas opc?ões para resolver
o problema de otimizac?ão da produc?ão, visto que é possível combi-
nar os dois modelos (agregado e desagregado) a diferentes tipos de
aproximac?ões (combinac?ão de aproximac?ões lineares e quadráticas
para curvas de produc?ão e perda de carga) e identificar a melhor
soluc?ão em termos de desempenho computacional.



42 Capítulo 2. Fundamentos e Definic?ões

2.6 SUMÁRIO

Nesse capítulo foram apresentados conceitos importantes pa-
ra a fundamentac?ão da dissertac?ão, incluindo informac?ões que per-
mitem entender a motivac?ão para a realizac?ão da pesquisa, bem
como conceitos dentro do contexto de produc?ão de petróleo e gás,
que serão adotados na sequência dos próximos capítulos.

Inicialmente foi apresentado o ambiente de produc?ão de flui-
dos fósseis, apontando os elementos básicos que estão contidos em
uma malha de produc?ão, os quais são fundamentais para entendi-
mento de fenômenos físicos e, consequentemente, para a formula-
c?ão do problema. Logo em seguida, foram, apresentados métodos
de elevac?ão artificial de fluidos em poc?os, com destaque para gas-
lift, o qual é adotado no trabalho em virtude de seu amplo emprego
dentro da indústria.

Tendo em vista as definic?ões apresentadas, foi possível expor
o problema conceitual para a otimizac?ão da produc?ão de petróleo
e gás, a partir do qual se consegue informac?ões importantes dentro
da dinâmica do problema como roteamento, alocac?ão de gás, cur-
vas de desempenho dos poc?os e queda de pressão na linha. Além
disso, como o problema é da classe MINLP e de difícil soluc?ão, é
comum a adoc?ão de métodos aproximativos para lidar com o pro-
blema. Essas abordagens, as quais foram apresentadas na revisão de
literatura, são eficazes por atingirem otimalidade global ainda que
não precisem lidar com não-linearidades no modelo. Por fim, foi
apresentada a contribuic?ão desse trabalho, apontando as diferenc?as
e os objetivos que serão detalhados na sequência do texto.



3 MODELOS QUADRÁTICOS POR PARTES PARA OTIMIZAC?ÃO
DA PRODUC?ÃO DE PETRÓLEO

Esse capítulo tem por objetivo apresentar os modelos para
a otimizac?ão da produc?ão de petróleo a partir da síntese de cur-
vas quadráticas aproximativas das func?ões de produc?ão e queda de
pressão em poc?os operados por gas-lift.

O texto inicia com uma breve introduc?ão teórica que busca
elucidar a escolha por uma abordagem quadrática e, em seguida,
duas formulac?ões baseadas em aproximac?ões quadráticas por par-
tes para o problema P proposto na Sec?ão 2.4 são apresentadas. Em
seguida, é desenvolvida uma demonstrac?ão matemática da equiva-
lência entre as duas formulac?ões e, por fim, a síntese de curvas, ou
seja, a maneira encontrada para a obtenc?ão de aproximac?ões qua-
dráticas das func?ões de produc?ão e queda de pressão.

3.1 INTRODUC?ÃO A MODELOS QUADRÁTICOS CONVEXOS

Antes de apresentar os modelos propostos nesse trabalho, faz-
se necessária uma breve introduc?ão a conceitos importantes utiliza-
dos nas proposic?ões dos modelos. Por esse motivo, essa sec?ão apre-
senta conceitos básicos sobre conjuntos e func?ões convexas, bem
como modelos quadráticos convexos, os quais facilitarão o entendi-
mento da prosposta da pesquisa.

3.1.1 Conjuntos Convexos

Um subconjunto Q de um espac?o vetorial é considerado con-
vexo se todo segmento de reta conectando dois pontos de Q está
contido dentro do subconjunto [19].

Supondo x1 \not = x2 \in \BbbR n pontos descritos como:

\alpha x1 + (1  - \alpha )x2 (3.1)
Tomando 0 \leq \alpha \leq 1, então a combinac?ão convexa de x1, x2

representa o segmento de reta entre esses pontos como mostrado
na Figura 3.1.

Em uma definic?ão menos formal, um conjunto pode ser consi-
derado convexo se quaisquer dois pontos dentro do conjunto podem
ser conectados por um caminho reto entre eles que também esteja
contido no conjunto. A Figura 3.2 apresenta três conjuntos: no caso
(a) e (b) os conjuntos atendem a definic?ão anterior. Já no caso (c)
não é possível que todos os pontos se conectem por uma linha reta
contida no conjunto.

43



44 Capítulo 3. Modelos Quadráticos para Otimizac?ão da Produc?ão

Figura 3.1: Conjunto convexo representado por uma reta.

(a) (b) (c)

convexo convexo não convexo

Figura 3.2: Exemplos de conjuntos convexos e não convexos.

3.1.2 Func?ões Convexas

Para que uma func?ão f : \BbbR n \rightarrow \BbbR seja considerada convexa
é preciso que, primeiramente, o domínio de f seja um conjunto
convexo e para todo x, y \in domf, e \theta no intervalo 0 \leq \theta \leq 1 [19]:

f(\theta x + (1  - \theta )y) \leq \theta f(x) + (1  - \theta )f(y) (3.2)
Em uma interpretac?ão geométrica da Eq. (3.2), pode-se afir-

mar que o segmento de reta (x, f(x)) a (y, f(y)) está acima do grá-
fico de f em todos os pontos para qualquer variac?ão no intervalo \theta .
A Figura 3.3 ilustra um exemplo de uma func?ão convexa. Caso  - f
seja uma func?ão convexa, então denominamos essa func?ão como
côncava.

Para uma func?ão afim, a equac?ão 3.2 sempre é satisfeita com
a igualdade. Dessa forma, func?ões lineares também são func?ões con-



3.1. Introduc?ão a Modelos Quadráticos Convexos 45

Figura 3.3: Exemplo de func?ão convexa.

vexas e côncavas.
Em complemento a isso, uma func?ão é convexa se e somente

se é convexa quando restrita a um segmento de reta que intercepta
seu domínio. Ou seja, f : \BbbR n \rightarrow \BbbR é convexa se e somente se a
func?ão g : \BbbR \rightarrow \BbbR 

g(t) = f(x + tv), dom g = \{ t : x + tv \in domf\} (3.3)
é convexa em t para todo x \in domf, v \in \BbbR n.

Essa propriedade é bastante importante, uma vez que permite
verificar a convexidade de uma func?ão restringindo-a a uma reta.

Ainda dentro do contexto de func?ões convexas, é essencial
que se apresente as condic?ões que caracterizam a convexidade de
uma func?ão [19]:

\bullet Condic?ão de primeira ordem: Suponha que o gradiente de
func?ão f (\bigtriangledown f) existe em um domínio aberto, ou seja, f é di-
ferenciável em domf. Então pode-se afirmar que f é convexa
se e somente se domf é um conjunto convexo e a seguinte
condic?ão é satisfeita:

f(y) \geq f(x) + \bigtriangledown f(x)T (y  - x), \forall x, y \in domf (3.4)
Geometricamente o lado direito da desigualdade (3.4), o qual
é a expansão de Taylor de primeira ordem de f, pode ser in-
terpretado como um subestimador global da func?ão como é
mostrado na Figura 3.4. Sendo assim, assumindo-se que a ex-
pansão de Taylor de primeira ordem sempre é um subestima-
dor global, então a func?ão é convexa. A partir de (3.4) ainda



46 Capítulo 3. Modelos Quadráticos para Otimizac?ão da Produc?ão

diz que a partir de uma informac?ão local, ou seja, na derivada
de um ponto, podemos obter informac?ão global (subestimador
global).

Figura 3.4: Subestimador global de uma func?ão convexa.

\bullet Condic?ão de segunda ordem: Assumindo que a Hessiana de f
existe, ou seja, a matriz \bigtriangledown 2f está definida em todos os pontos
de domf aberto, então f é convexa se e somente se domf é
um conjunto convexo e sua Hessiana é positiva semidefinida,
ou seja:

\bigtriangledown 2f(x) \succeq 0, \forall x \in domf (3.5)

A condic?ão da Eq. (3.5) pode ser interpretada geometrica-
mente como uma func?ão que possui curvaturas não-negativas.
De forma análoga, uma func?ão f é côncava se \bigtriangledown 2f \preceq 0 para
todo x \in domf.

Exemplos:
Com o objetivo de ilustrar as propriedades anteriormente ci-

tadas, são apresentados os seguintes exemplos:



3.1. Introduc?ão a Modelos Quadráticos Convexos 47

\bullet Func?ão quadrática: Considerando uma func?ão f : \BbbR n \rightarrow \BbbR 
com domf = \BbbR n dada por:

f(\bfx ) =
1

2
\bfx T P\bfx + qT \bfx + r (3.6)

com P sendo uma matriz simétrica n \times n, q \in \BbbR n um vetor e
r \in \BbbR um escalar. Sendo que \bigtriangledown 2f = P para todo x, então f é
convexa se e somente se P \succeq 0.

Esse exemplo é bastante importante, uma vez que é utilizado
para obtenc?ão das curvas utilizadas como aproximac?ões nos
modelos de otimizac?ão da produc?ão de petróleo. Essa proprie-
dade será melhor discutida na Sec?ão 3.2.

\bullet Func?ão quadrática sobre linear: Seja a func?ão:

f(x, y) =
x2

y
(3.7)

mostrada na Figura 3.5. Com Hessiana:

\bigtriangledown 2f(x, y) =
2

y3

\biggl[ 
y
 - x

\biggr] \biggl[ 
y
 - x

\biggr] T
(3.8)

Pode-se afirmar que \bigtriangledown 2f é positiva semidefinida para domf =
\BbbR \times \BbbR ++ = \{ (x, y) \in \BbbR 2 : y &gt; 0\} .

3.1.3 Modelos Quadráticos Convexos

Um modelo quadrático convexo de uma func?ão f : \BbbR n \rightarrow \BbbR 
pode ser representado como [19]:

f(\bfx ) =
1

2
\bfx T Q\bfx + \bfb T \bfx + c (3.9)

Na Eq. (3.9) a matriz Q é positiva definida, ou seja, com autovalores
todos positivos, \bfb é um vetor e c uma constante. A func?ão f é con-
vexa pois obedece a todas as propriedades citadas na sec?ão anterior.
Esse modelo de aproximac?ão será utilizado para a representac?ão
das curvas de produc?ão e queda de pressão no problema de otimi-
zac?ão da produc?ão.

Um problema de programac?ão quadrática é de otimizac?ão
convexa se a func?ão objetivo é quadrática convexa e as func?ões de
restric?ão são afins. Um problema de otimizac?ão quadrática pode ser



48 Capítulo 3. Modelos Quadráticos para Otimizac?ão da Produc?ão

Figura 3.5: Gráfico da func?ão descrita na Eq. (3.7).

expressado como [19]:

minimize
1

2
\bfx T Q\bfx + \bfq T \bfx + c

sujeito a: G\bfx \preceq \bfh 
A\bfx = \bfb 

(3.10)

em que Q é uma matriz simétrica n \times n positiva semidefinida, G \in 
\BbbR m\times n, A \in \BbbR p\times n e q, b e h são vetores. Em um problema de progra-
mac?ão quadrática minimiza-se a func?ão quadrática convexa sobre
um poliedro como mostrado na Figura 3.6.

Na Figura 3.6 a região factível \sigma (região mais escura) é o
poliedro e as linhas sobre ele representam as curvas de nível da
func?ão objetivo quadrática convexa. Já o ponto x\ast é o ótimo.

Trazendo esses conceitos para o contexto de otimizac?ão da
produc?ão de petróleo, verifica-se que as curvas de produc?ão e queda
de pressão são não lineares e não convexas, o que induz, em muitos



3.1. Introduc?ão a Modelos Quadráticos Convexos 49

Figura 3.6: Ilustrac?ão geométrica de um problema de otimizac?ão
quadrática (Adaptado de [19]).

casos, a adoc?ão de alguma abordagem que fac?a uso de aproximac?õ-
es convexas sobre os modelos originalmente não convexos.

Boa parte dos trabalhos citados na Sec?ão 2.5 fazem uso de
aproximac?ões lineares por partes. Na aproximac?ão linear por partes,
o domínio é dividido em pequenas regiões denominadas politopos,
os quais possuem uma aproximac?ão linear da func?ão original em
cada segmento. O problema então está em buscar o ótimo em cada
uma dessas regiões quando estiverem ativas durante a soluc?ão do
problema. A Figura 3.7 ilustra uma func?ão não linear aproximada a
partir de linearizac?ão por partes.

Apesar de bastante eficiente no sentido de permitir que se-
jam alcanc?ados ótimos globais nas aproximac?ões correspondentes,
essa abordagem pode inserir no problema de otimizac?ão um nú-
mero elevado de variáveis em sua representac?ão. Este acréscimo
é tão maior quanto mais precisa se quiser ter a representac?ão da
curva não-linear e acarreta o aumento da complexidade do modelo



50 Capítulo 3. Modelos Quadráticos para Otimizac?ão da Produc?ão

Função não-linear
Aproximação linear por partes

breakpoints

Função não-linear
Aproximação linear por partes

breakpoints

Figura 3.7: Aproximac?ão linear por partes.

Função não-linear
Aproximação quad?atica por partes

breakpoints

Função não-linear
Aproximação quad?atica por partes

breakpoints

Figura 3.8: Aproximac?ão quadrática por partes.



3.2. Síntese de Curvas 51

final, elevando também o custo computacional para se resolver o
problema [14, 16, 18, 2].

Uma abordagem alternativa é o uso de aproximac?ões côn-
cavas ou convexas quadráticas por partes como mostrado na Fi-
gura 3.8. Nela igualmente se divide o domínio da func?ão em po-
litopos e para cada sec?ão se utilizam func?ões quadráticas para a
representac?ão da curva original.

Apesar de também inserir variáveis extras no problema de
otimizac?ão dos campos de petróleo, esta abordagem é mais com-
pacta, e pode reduzir o custo computacional. Usando esta técnica,
é possível reformular o problema de otimizac?ão da produc?ão como
um problema de Programac?ão Convexa Inteira Mista e resolvê-lo
com um solver comercial.

Portanto, a próxima sec?ão se dedica à síntese de aproxima-
c?ões das func?ões de produc?ão e perda de carga em um sistema de
produc?ão de petróleo e gás.

3.2 SÍNTESE DE CURVAS

Para lidar com um modelo não-linear e não convexo como no
caso da otimizac?ão de campos de petróelo e gás, é comum adotar
alguma abordagem aproximativa que ainda mantenha as caracterís-
ticas do sistema, mas que permita ao modelo ser mais facilmente
tratado e resolvido. Dentro desse contexto, esse trabalho também
optou por utilizar uma abordagem de aproximac?ão quadrática das
curvas de produc?ão e queda de pressão em um sistema de produc?ão
de petróleo e gás.

A Figura 3.9 mostra que, a partir de uma aproximac?ão qua-
drática, deixa-se de trabalhar com um modelo MINLP e passa-se a
utilizar um modelo MICP mais compacto. As curvas de produc?ão e
queda de pressão geradas por um simulador (assunto discutido na
Sec?ão 4.1) são aproximadas a partir de um problema de Progra-
mac?ão Semi-Definida (SDP) que as torna quadráticas e garante
convexidade. A programac?ão semi-definida se enquadra como uma
subdivisão da programac?ão convexa e foi objeto de pesquisa in-
tensa na área da matemática por possuir aplicac?ão em vários proble-
mas. O problema consiste em maximizar ou minimizar uma func?ão
objetivo, que é uma func?ão linear, colocando como restric?ão uma
combinac?ão afim de matrizes simétricas positiva ou negativa semi-
definidas.

A curva de perda de carga em uma linha é func?ão das vazões



52 Capítulo 3. Modelos Quadráticos para Otimizac?ão da Produc?ão

Problema de
otimizacão da 

produção MINLP 

Aproximações 
Quadráticas

Problema de
otimização

da produção MICP

Curvas de produção
e queda de pressão

 não lineares

Curvas de produção
e queda de pressão

quadráticas

Figura 3.9: Utilizac?ão de aproximac?ões quadráticas na síntese de
modelo MICP.

de óleo, gás e água na tubulac?ão e, em virtude de ser uma func?ão
tridimensional, justifica-se o uso de uma aproximac?ão quadrática
convexa em busca de um modelo mais compacto do que um modelo
linear por partes, por exemplo.

Já no caso de uma WPC, estabelece-se uma relac?ão entre
injec?ão de gás e produc?ão de petróleo para uma dada pressão no
manifold. O formato real dessa curva (não-linear) tem, por vezes,
um comportamento que assemelha-se a uma func?ão quadrática. Sen-
do assim, é intuitivo buscar uma aproximac?ão por uma func?ão de se-
gunda ordem para a curva de produc?ão, a fim de conseguir também
modelos mais compactos, mas que possuam informac?ão suficiente
sobre a curva original.

No caso de uma WPC, dependendo da região do domínio, a
curva pode se apresentar de forma bastante irregular, comprome-
tendo a aproximac?ão com apenas uma quadrática para todo o do-
mínio, como ilustrado na Figura 3.10. Nesse caso, para uma melhor
qualidade na aproximac?ão das curvas de produc?ão e queda de pres-
são, adotou-se a aproximac?ão quadrática convexa por partes das
func?ões, dividindo-se o domínio em politopos como mostrado na
Figura 3.11, o qual induz a uma aproximac?ão quadrática para cada
um dos quatro politopos adotados como mostrado no exemplo de
uma WPC na Figura 3.12, reduzindo erros em relac?ão à curva real.

Entretanto, quanto maior o número de divisões no domínio,
ou seja, quanto mais politopos são utilizados, maior o custo compu-
tacional para obtenc?ão das aproximac?ões. Dessa forma é necessário



3.2. Síntese de Curvas 53

que seja estabelecida uma relac?ão de custo-benefício entre quali-
dade das aproximac?ões e número de politopos.

Figura 3.10: Aproximac?ão quadrática côncava de uma curva de
produc?ão.

0
300

550

800

1.135 2.27

(1,1)

(1,2)

(2,1)

(2,2)

(j)

(i)

Pm (psia)

qinj (sm3/d)
x10 5

Figura 3.11: Domínio da func?ão dividido em 4 politopos, com (i, j)
sendo o par que define os índices de um politopo.

Uma aproximac?ão quadrática para a curva de produc?ão de
petróleo q : \BbbR 2 \rightarrow \BbbR pode ser representada como:

\widetilde qn,mi,j (qn,minj , pm) =
[q

n,m
inj p

m]Q
n,m
i,j [q

n,m
inj p

m]\prime + [q
n,m
inj p

m]\bfb 
n,m
i,j + c

n,m
i,j (3.11)



54 Capítulo 3. Modelos Quadráticos para Otimizac?ão da Produc?ão

Figura 3.12: Aproximac?ão quadrática por partes.

Na qual, para cada poc?o n conectado a um manifold m, os
pares (i, j) são os índices de um politopo, Qn,mi,j é uma matriz nega-
tiva semi-definida, \bfb n,mi,j é um vetor e c

n,m
i,j é uma constante, q

n,m
inj é

a taxa de gás de elevac?ão e pm é a pressão no manifold. De forma
análoga, uma aproximac?ão quadrática para a curva de queda de
pressão \Delta P : \BbbR 3 \rightarrow \BbbR pode ser representada como:

\Delta P mo,g,w(q
m) = \bfq m\prime Qmo,w,g\bfq 

m + (\bfb mo,w,g)
\prime \bfq m + cmo,w,g (3.12)

Em que, para cada manifold m, as triplas (o, g, w) são os ín-
dices de um politopo, Qmo,g,w é uma matriz positiva semi-definida,
\bfb mo,g,w é um vetor e c

m
o,g,w é uma constante e \bfq 

m é um vetor de
vazões das fases do fluido multifásico (petróleo, gás e água) no ma-
nifold m, no qual \bfq m = [qmo , q

m
w , q

m
g ].

Para obter uma aproximac?ão quadrática mais adequada, é ne-
cessário estabelecer um método para o ajuste das curvas e verificar
se os resultados são aceitáveis. Para tanto, como mencionado ante-
riormente, uma aproximac?ão côncava ou convexa para as curvas de
produc?ão e queda de pressão é obtida resolvendo um problema de
programac?ão semi-definida, o qual minimiza o erro em relac?ão a
um conjunto de pontos gerado por um simulador multifásico. Em
outras palavras, a partir dos pontos que representam relac?ões consi-
deradas representativas entre as variáveis do processo para as cur-
vas de produc?ão e queda de pressão, se resolve um problema de
otimizac?ão a fim de se obter uma func?ão quadrática minimizando a



3.2. Síntese de Curvas 55

distância dos valores induzidos pela func?ão em relac?ão aos valores
originais.

Antes de definir um problema de programac?ão semi-definida
para a aproximac?ão das curvas de produc?ão e queda de pressão,
é importante definir os parâmetros que fazem parte do problema.
A Figura 3.13 apresenta esses parâmetros e as condic?ões que se
podem estabelecer dentro do problema.

Número de
Breakpoints

Aproximação 
Côncava, Convexa

ou Linear

Norma 1,
Norma 2 ou 

Norma Infinita

Número de 
Politopos

SDP
Erro relativo

ou
absoluto

Figura 3.13: Parâmetros do problema de programac?ão semi-defini-
da.

\bullet Aproximac?ão: A aproximac?ão quadrática é obtida usando co-
mo restric?ão uma func?ão de segunda ordem \bfx T Q\bfx +\bfb T \bfx +c e
a restric?ão Q \preceq 0 para o caso de uma aproximac?ão côncava e
Q \succeq 0 para uma aproximac?ão convexa. Já para o caso de uma
aproximac?ão linear, se considera a matriz Q como uma matriz
de zeros e se elimina a restric?ão de desigualdade.

\bullet Erro: Os erros representam a distância entre o valor real e
o valor calculado pela aproximac?ão quadrática em um dado
ponto do domínio. O vetor de erros é a variável a ser mini-
mizada pelo problema de otimizac?ão. Ele pode ser tanto re-
presentado em sua forma absoluta, quanto relativa. Conside-
rando uma aproximac?ão quadrática q(\bfx ) = \bfx T Q\bfx + \bfb T \bfx + c,



56 Capítulo 3. Modelos Quadráticos para Otimizac?ão da Produc?ão

os erros absoluto e relativo são representados pelas Equac?ões
abaixo, respectivamente.

 - \epsilon ab \leq q(\bfx )  - q \leq \epsilon ab (3.13)

 - \epsilon rel \leq 
q(\bfx )  - q
q(\bfx )

\leq \epsilon rel (3.14)

\bullet Norma: Na prática existe um vetor de erros \bfitepsilon = (\epsilon j : j =
1, . . . , n). Portanto, a func?ão que se deseja minimizar é a nor-
ma de um dos vetores dos erros. Os três tipos de normas po-
dem ser modeladas da seguinte forma para erro \epsilon :

Norma 1 (\ell 1):

\| \epsilon \| 1 =
n\sum 

j=1

| \epsilon j| (3.15)

Norma Infinita (\ell \infty ):
\| \epsilon \| \infty = \mathrm{m}\mathrm{a}\mathrm{x}\{ | \epsilon j| : j = 1, . . . , n\} (3.16)

Norma 2 (\ell 2):

\| \epsilon \| 2 =

\sqrt{}    n\sum 
j=1

\epsilon 2j (3.17)

\bullet Breakpoints e Politopos: Os breakpoints definem a região
de cada politopo de um particionamento do domínio de uma
func?ão e, por consequência, o número de quadráticas que se-
rão utilizadas para representar as func?ões de produc?ão e perda
de carga. No exemplo da Figura 3.11 há três breakpoints em
cada eixo (um no início, outro no meio e outro no fim do do-
mínio de cada eixo), fazendo com que o domínio seja divido
em duas partes em cada eixo, totalizando quatro politopos.
Ainda em relac?ão ao número de breakpoints, o que se deseja é
obter uma estimac?ão que seja representativa da sua curva uti-
lizando o menor número de pontos possível, pois quanto mais
pontos utilizados maior o custo computacional de se obter os
parâmetros da curva de aproximac?ão. Com relac?ão ao número
de politopos, deseja-se obter um resultado satisfatório (erros



3.3. Modelos Quadráticos Por Partes para Otimizac?ão da Produc?ão57

relativos e/ou absolutos dentro de uma margem aceitável) de
modo que o número de fatias do domínio que representam a
curva não linear (ou seja, o número de politopos) seja o menor
possível.

Tendo conhecimento sobre os parâmetros que envolvem o
problema de programac?ão semi-definida, é possível modelar um
problema exemplo.

Utilizando m pontos amostrais \{ (\bfx i, qi) : i = 1, . . . , m\} , nor-
ma \ell 1, e erro absoluto na func?ão objetivo, um exemplo de pro-
blema de programac?ão semi-definida para aproximac?ão da curva
de produc?ão de poc?os de petróleo e gás pode ser definido como
segue:

CF : \mathrm{m}\mathrm{i}\mathrm{n}
Q,b,c,\epsilon a

i

f =
m\sum 
i=1

\epsilon ai (3.18a)

s.t. : qi =
1

2
\bfx \prime iQ\bfx i + b

\prime \bfx i + c, i = 1, . . . , m (3.18b)

 - \epsilon ai \leq q(\bfx i)  - qi \leq \epsilon 
a
i , i = 1, . . . , m (3.18c)

Q \preceq 0 (3.18d)
em que Q \in \BbbR 2\times 2 é uma matriz simétrica negativa semi-definida,
\bfb \in \BbbR 2 \times \BbbR , c \in \BbbR , \bfx i \in [injec?ão de gás \times pressão no manifold] é
um ponto no domínio da func?ão de produc?ão, e q(\bfx i) é o valor da
vazão produzida na WPC no ponto \bfx i obtido no simulador.

Outros exemplos utilizando norma \ell 1, \ell 2 e \ell \infty a partir da
minimizac?ão dos erros absoluto e relativo são apresentadas no Apên-
dice B.

De posse das curvas quadráticas aproximadas tanto de produ-
c?ão, quanto queda de pressão, pode-se agora apresentar os mode-
los MICP para a otimizac?ão da produc?ão de campos de petróleo e
gás, os quais farão uso das aproximac?ões quadráticas obtidas para
a resoluc?ão do problema.

3.3 MODELOS QUADRÁTICOS POR PARTES AGREGADO E DESA-
GREGADO PARA OTIMIZAC?ÃO DA PRODUC?ÃO DE PETRÓ-
LEO

A escolha por uma abordagem de investigac?ão em torno de
modelos MICP que fazem uso de aproximac?ões quadráticas para
as func?ões não lineares de produc?ão e queda de pressão se deu,



58 Capítulo 3. Modelos Quadráticos para Otimizac?ão da Produc?ão

principalmente, pelos resultados alcanc?ados no trabalho de [2], no
qual, obteve-se um modelo misto, com aproximac?ões lineares por
partes para WPC dos poc?os e utilizac?ão de curvas quadráticas para
representar a func?ão de queda de pressão. Provou-se no estudo que
um modelo mais compacto pode produzir resultados melhores do
que modelos puramente lineares por partes, dependendo da região
do domínio analisada.

Nesse sentido, procurou-se apurar o desempenho de um mo-
delo puramente quadrático para ambas func?ões não lineares e não
convexas envolvidas no problema de otimizac?ão da produc?ão. É im-
portante salientar que os modelos propostos nesse trabalho têm por
características serem mais genéricos que os apresentados nos traba-
lhos da Sec?ão 2.5, uma vez que podem ser representados tanto por
modelos MICP com 1 ou n politopos, por um modelo misto como
o de [2] ou mesmo por um modelo MILP a partir da eliminac?ão
dos termos quadráticos das aproximac?ões obtidas, ou seja, pode-se
zerar a matriz Q, utilizando-se somente func?ões lineares.

Nas duas formulac?ões a seguir (Modelo Agregado e Modelo
Desagredado) um modelo quadrático-côncavo é utlizado para apro-
ximar as func?ões de produc?ão dos poc?os \bfq n,m no interior de cada
região do espac?o de decisão de (pm, qninj), enquanto a queda de
pressão \Delta P m é aproximada por um modelo quadrático-convexo. As
aproximac?ões levam a modelos quadráticos por partes multidimen-
sionais dentro de cada região do domínio de \bfq m.

3.3.1 Modelo Agregado

Essa formulac?ão utiliza uma família de variáveis binárias
\{ zn,mi,j \} para decidir simultaneamente a respeito do roteamento do
poc?o n ao manifold m, o intervalo ativo i de injec?ão de gás qninj e o
intervalo ativo para a pressão no manifold pm.

Uma variável de decisão qn,minj,i,j é associada a cada região
aproximada \scrP n,mi,j considerando cada conexão possível de um poc?o
n a um manifold m.
A formulac?ão do problema é dada por:

\widetilde Pag : \mathrm{m}\mathrm{a}\mathrm{x} f = \sum 
m\in \scrM 

\widetilde \bfq mo (3.19a)



3.3. Modelos para a Otimizac?ão da Produc?ão 59

sujeito a: \sum 
n\in \scrN 

qninj \leq q
U
inj, (3.19b)

\sum 
m\in \scrM n

\sum 
(i,j)\in \scrK n,m

z
n,m
i,j = y

n, \forall n \in \scrN , (3.19c)

e para todo n \in \scrN , m \in \scrM n, (i, j) \in \scrK n,m:

q
n,m,L
inj,i z

n,m
i,j \leq q

n,m
inj,i,j \leq q

n,m,U
inj,i z

n,m
i,j , (3.19d)

\widetilde \bfq n,mi,j \leq \Phi n,mi,j (qn,minj,i,j, pm) + \bfq n,\mathrm{m}\mathrm{a}\mathrm{x}(1  - zn,mi,j ), (3.19e)
\bfq n,Lz

n,m
i,j \leq \widetilde \bfq n,mi,j \leq \bfq n,Uzn,mi,j , (3.19f)

z
n,m
i,j \in \{ 0, 1\} , (3.19g)

e para todo n \in \scrN :

qninj =
\sum 

m\in \scrM n

\sum 
(i,j)\in \scrK n,m

q
n,m
inj,i,j, (3.19h)

\widetilde \bfq n,m = \sum 
(i,j)\in \scrK n,m

\widetilde \bfq n,mi,j , \forall m \in \scrM n, (3.19i)
yn \in \{ 0, 1\} , (3.19j)



60 Capítulo 3. Modelos Quadráticos para Otimizac?ão da Produc?ão

e para todo m \in \scrM :\sum 
i\in \scrI n,m

z
n,m
i,j \leq \zeta 

m
j , \forall n \in \scrN m, \forall j \in \scrJ 

m, (3.19k)

\sum 
j\in \scrJ m

\zeta mj = 1, (3.19l)

p
m,L
j \zeta 

m
j + p

m,L(1  - \zeta mj ) \leq p
m, \forall j \in \scrJ m, (3.19m)

pm \leq pm,Uj \zeta 
m
j + p

m,U(1  - \zeta mj ), \forall j \in \scrJ 
m, (3.19n)

\widetilde \bfq m = \sum 
n\in \scrN m

\widetilde \bfq n,m, (3.19o)
\bfq m,L \leq \widetilde \bfq m \leq \bfq m,U, (3.19p)

\sum 
(o,w,g)\in \scrD m

wmo,w,g = y
m, (3.19q)

\bfq m,Lo,w,gw
m
o,w,g \leq \bfq 

m
o,w,g \leq \bfq 

m,U
o,w,gw

m
o,w,g, (3.19r)

0 \leq \Delta pmo,w,g \leq \Delta p
m,\mathrm{m}\mathrm{a}\mathrm{x}wmo,w,g, (3.19s)

\Omega mo,w,g(\bfq 
m
o,w,g)  - \Delta p

m,max(1  - wmo,w,g) \leq \Delta p
m
o,w,g, (3.19t)

\widetilde \Delta pm = \sum 
(o,w,g)\in \scrD m

\Delta pmo,w,g, (3.19u)

\widetilde \bfq m = \sum 
(o,w,g)\in \scrD m

\bfq mo,w,g, (3.19v)

pm = pm,S + \widetilde \Delta pm, (3.19w)
wmo,w,g \in \{ 0, 1\} , \forall (o, w, g) \in \scrD 

m, (3.19x)



3.3. Modelos para a Otimizac?ão da Produc?ão 61

ym \in \{ 0, 1\} , (3.19y)

\zeta mj \in \{ 0, 1\} , \forall j \in \scrJ 
m, (3.19z)

com os seguintes parâmetros adicionais:

\bullet \scrJ m = \{ 1, . . . , Jm\} é o conjunto de índices dos intervalos de
pressão do manifold m;

\bullet \scrI n,m = \{ 1, . . . , In,m\} é o conjunto de índices dos intervalos
de lift-gas para o poc?o n se conectado ao manifold m;

\bullet [qn,m,Linj,i , q
n,m,U
inj,i ] define o intervalo i \in \scrI 

n,m para a injec?ão de
gás de elevac?ão no poc?o n quando conectado ao manifold m.
Assume-se que qn,m,Uinj,i = q

n,m,L
inj,i+1 para todo i &amp;lt;I

n,m, qn,m,Linj,1 =
q
n,L
inj , e q

n,m,U
inj,In,m = q

n,U
inj ;

\bullet [pm,Lj , p
m,U
j ] define a faixa de pressão para o intervalo j \in \scrJ 

m

para o manifold m. Assume-se que pm,Uj = p
m,L
j+1 para todo

j &amp;lt;Jm, pm,L1 = p
m,L e pm,UJm = p

m,U ;

\bullet \scrK n,m = \scrI n,m \times \scrJ m define as regiões (politopos) para a apro-
ximac?ão local das func?ões de produc?ão dos poc?os;

\bullet \scrP n,mi,j = [q
n,m,L
inj,i , q

n,m,U
inj,i ] \times [p

m,L
j , p

m,U
j ], (i, j) \in \scrK 

n,m, é um
politopo no qual a func?ão de produc?ão é aproximada;

\bullet \bfq n,\mathrm{m}\mathrm{a}\mathrm{x} é um vetor constante para implementar uma estratégia
de Big-M; a constante deve ser suficientemente grande para
garantir que o lado direito da equac?ão (3.19e) seja não nega-
tivo se zn,mi,j = 0;

\bullet \Delta pm,\mathrm{m}\mathrm{a}\mathrm{x} é um escalar que deve ser suficientemente grande
para garantir a relaxac?ão da equac?ão (3.19t) quando wmo,w,g =
0;

\bullet \scrD m é o conjunto de índices (o, w, g) correspondente ao poli-
topo \scrP mo,w,g do domínio da func?ão de queda de pressão \Delta pm;

\bullet \scrP m = \{ \scrP mo,w,g : (o, w, g) \in \scrD m} é o conjunto de politopos que
define a partic?ão do domínio da func?ão de queda de pressão
\Delta pm;



62 Capítulo 3. Modelos Quadráticos para Otimizac?ão da Produc?ão

\bullet \bfq m,Lo,w,g e \bfq m,Uo,w,g definem o menor e maior valor respectivamente
para todas as fases h \in \scrH dentro do politopo \scrP mo,w,g \in \scrP m.
Note que \scrP mo,w,g = \{ \bfq \in \BbbR 3 : \bfq m,Lo,w,g \leq \bfq \leq \bfq m,Uo,w,g\} é o poli-
topo consistindo do fluxo das fases, as quais estão dentro do
hipercubo com o menor valor em \bfq m,Lo,w,g e o maior valor \bfq 

m,U
o,w,g;

\bullet A func?ão

\Phi 
n,m
i,j (q

n,m
inj , p

m) =

[q
n,m
inj , p

m]Q
n,m
i,j [q

n,m
inj , p

m]\prime + (\bfb 
n,m
i,j )

\prime [q
n,m
inj , p

m] + c
n,m
i,j

é a aproximac?ão quadrática côncava da curva de produc?ão do
poc?o n no politopo \scrP n,mi,j , (i, j) \in \scrK 

n,m, quando conectado ao
manifold m

\bullet A func?ão

\Omega mo,w,g(\bfq 
m
o,w,g) =

[\bfq mo,w,g]
\prime Qmo,w,g[\bfq 

m
o,w,g] + (\bfb 

m
o,w,g)

\prime [\bfq mo,w,g] + c
m
o,w,g

é a aproximac?ão quadrática convexa da curva de queda de
pressão no manifold m quando as vazões no manifold \bfq mo,w,g
estão dentro do politopo \scrP mo,w,g;

\bullet Qn,mi,j , \bfb 
n,m
i,j e c

n,m
i,j são a matriz, o vetor e a constante que

definem a aproximac?ão quadrática de uma WPC do poc?o n
dentro do politopo \scrP i,j, (i, j) \in \scrK n,m, quando conectado ao
manifold m;

\bullet Qmo,w,g, \bfb mo,w,g e cmo,w,g são a matriz, vetor e constante que de-
finem a aproximac?ão quadrática de uma curva de queda de
pressão no manifold m dentro do politopo \scrP m

(o,w,g)
, (o, w, g) \in 

\scrD m, conectado ao separador adjunto;
variáveis:

\bullet qn,minj,i,j é a taxa de gás de elevac?ão do poc?o n se conectado
manifold m e situado dentro do intervalo [qn,m,Linj,i,j, q

n,m,U
inj,i,j ];

\bullet zn,mi,j assume o valor 1 se o poc?o n está conectado ao manifold
m e sua WPC está aproximada dentro do politopo \scrP n,mi,j , e 0
caso contrário;

\bullet \widetilde \bfq n,mh,i,j é o fluxo de fase h \in \scrH enviado do poc?o n ao manifold
m se o politopo \scrP n,mi,j está ativo, com \widetilde \bfq n,mi,j = (\widetilde \bfq n,mh,i,j : h \in \scrH )
representando o vetor do fluxo de fases;



3.3. Modelos para a Otimizac?ão da Produc?ão 63

\bullet \bfq mo,w,g é o fluxo de cada fase h \in \scrH enviadoa ao manifold m
dentro do politopo \scrP mo,w,g \in \scrP m

\bullet \widetilde \bfq m é o fluxo total recebido dos poc?os conectados ao manifold
m para todas as fases;

\bullet \zeta mj assume o valor 1 se a pressão do manifold m está no inter-
valo [pm,Lj , p

m,U
j ], e 0 caso contrário;

\bullet \Delta pmo,w,g é uma variável com o limite superior da queda de pres-
são na linha do manifold m quando seu fluxo \widetilde \bfq m \in \scrP mo,w,g

\bullet \widetilde \Delta pm é a queda de pressão entre o manifold m e o separador
adjunto;

\bullet wmo,w,g assume o valor 1 se o politopo da curva de queda de
pressão \scrP mo,w,g está ativo, 0 caso contrário;

\bullet ym assume o valor 1 se o manifold m está ativo, ou 0 caso
contrário;

3.3.2 Modelo Desagregado

Esta formulac?ão difere da anterior no aspecto de conside-
rar uma decomposic?ão entre produc?ão do poc?o, alinhamento entre
poc?os e manifolds e pressão de operac?ão em três variáveis binárias
independentes. O modelo desagregado é dado por:

\widetilde Pdag : \mathrm{m}\mathrm{a}\mathrm{x} f = \sum 
m\in \scrM 

\widetilde \bfq mo (3.20a)
sujeito a: \sum 

n\in \scrN 
qninj \leq q

U
inj, (3.20b)

e para todo n \in \scrN :



64 Capítulo 3. Modelos Quadráticos para Otimizac?ão da Produc?ão

\sum 
m\in \scrM n

zn,m = yn, (3.20c)

\sum 
i\in \scrI n

xni = y
n, (3.20d)

q
n,L
inj,ix

n
i \leq q

n
inj \leq q

n,U
inj,ix

n
i + q

n,U
inj (1  - x

n
i ), \forall i \in \scrI 

n, (3.20e)

qninj \leq q
n,U
inj y

n, (3.20f)

yn \in \{ 0, 1\} , (3.20g)

xni \in \{ 0, 1\} , \forall i \in \scrI 
n, (3.20h)

zn,m \in \{ 0, 1\} , \forall m \in \scrM n, (3.20i)

e para todo n \in \scrN , m \in \scrM n, i \in \scrI n, j \in \scrJ m:

\widetilde \bfq n,mi,j \leq \Phi n,mi,j (qninj, pm)
+ \bfq n,\mathrm{m}\mathrm{a}\mathrm{x}(3  - xni  - z

n,m  - \zeta mj ), (3.20j)

\widetilde \bfq n,mi,j \geq \bfq n,L(xni + zn,m + \zeta mj  - 2), (3.20k)
\left\{        
       

\widetilde \bfq n,mi,j \leq \bfq n,Uzn,m,
\widetilde \bfq n,mi,j \leq \bfq n,Uxni ,
\widetilde \bfq n,mi,j \leq \bfq n,U\zeta mj ,
\widetilde \bfq n,mi,j \geq 0,

(3.20l)



3.3. Modelos para a Otimizac?ão da Produc?ão 65

e para todo m \in \scrM :

\widetilde \bfq n,m = \sum 
i\in \scrI n

\sum 
j\in \scrJ m

\widetilde \bfq n,mi,j , \forall n \in \scrN m, (3.20m)
Eqs. (3.19l) - (3.19z), (3.20n)

com os seguintes parâmetros adicionais:

\bullet \scrI n = \{ 1, . . . , In\} é o conjunto de índices de intervalos de
injec?ão de gás para o poc?o n;

\bullet [qn,Linj,i, q
n,U
inj,i] define o intervalo i \in \scrI 

n para a injec?ão do gás de
elevac?ão do poc?o n;

\bullet \bfq n,\mathrm{m}\mathrm{a}\mathrm{x} deve ser suficientemente grande para garantir que a
equac?ão (3.20j) permanec?a inócua quando zn,mi,j = 0, indepen-
dentemente dos valores de qninj e p

m;

variáveis:

\bullet zn,m assume o valor 1 se o poc?o n está conectado ao manifold
m;

\bullet xni tem valor igual a 1 quando a injec?ão de gás no poc?o n está
dentro intervalo i, denominado [qn,Linj,i, q

n,U
inj,i];

\bullet \widetilde \bfq n,m é o fluxo multifásico que sai do poc?o n em direc?ão ao
manifold m.

3.3.3 Demonstrac?ão de Equivalência

Como foram apresentadas duas formulac?ões para o mesmo
problema, faz-se necessário identificar se ambas são equivalentes
entre si.

A demonstrac?ão a seguir têm por objetivo mostrar matemati-
camente que os modelos agregado e desagregado são equivalentes
e, portanto, podem ser utilizados para se obter o mesmo resultado
quando sujeitos às mesmas condic?ões iniciais.



66 Capítulo 3. Modelos Quadráticos para Otimizac?ão da Produc?ão

Inicialmente, define-se os vetores:

\bfittheta ag = (q
n
inj, q

n,m
inj,i,j, \widetilde \bfq n,mi,j , \widetilde \bfq n,m, \widetilde \bfq m, pm, \widetilde \Delta pm, yn, ym, zn,mi,j , \zeta mj ,

wmo,w,g, \bfq 
m
o,w,g, \Delta p

m
o,w,g)

\bfittheta dag = (q
n
inj, \widetilde \bfq n,mi,j , \widetilde \bfq n,m, \widetilde \bfq m, pm, \widetilde \Delta pm, yn, ym, xni , zn,m, \zeta mj ,
wmo,w,g, \bfq 

m
o,w,g, \Delta p

m
o,w,g)

com as variáveis de decisão de \widetilde Pag e \widetilde Pdag, respectivamente.
Assumindo que \scrI n = \scrI n,m e [qn,m,Linj,i , q

n,m,U
inj,i ] = [q

n,L
inj,i, q

n,U
inj,i]

para todo n \in \scrN , m \in \scrM n e i \in \scrI n, relac?ões podem ser estabeleci-
das entre as formulac?ões \widetilde Pag e \widetilde Pdag.

Assumindo \bfittheta ag como uma soluc?ão factível para \widetilde Pag. Pode-se
definir qninj, \widetilde \bfq n,mi,j , \widetilde \bfq n,m, \widetilde \bfq m, pm, \widetilde \Delta pm, yn, ym, \zeta mj , wmo,w,g, \bfq mo,w,g, e
\Delta pmo,w,g em \bfittheta dag exatamente como em \bfittheta ag. Por fim, define-se:

zn,m =
\sum 

(i,j)\in \scrK n,m
z
n,m
i,j , (3.21a)

xni =
\sum 

m\in \scrM n

\sum 
j\in \scrJ m

z
n,m
i,j . (3.21b)

O que define todas as variáveis que compõem \bfittheta dag. Resta saber se
todas as restric?ões de \widetilde Pdag são atendidas por \bfittheta dag. As restric?ões
(3.20b)-(3.20d) são obviamente satisfeitas. Para qualquer n \in \scrN e
i \in \scrI n, a soma da desigualdade da esquerda da Eq. (3.19d) para
todo m \in \scrM n e j \in \scrJ m, leva a\sum 

m\in \scrM n

\sum 
j\in \scrJ m

q
n,m,L
inj,i z

n,m
i,j \leq 

\sum 
m\in \scrM n

\sum 
j\in \scrJ m

q
n,m
inj,i,j

=\Rightarrow 
\sum 

m\in \scrM n

\sum 
j\in \scrJ m

q
n,L
inj,iz

n,m
i,j = q

n,L
inj,i

\sum 
m\in \scrM n

\sum 
j\in \scrJ m

z
n,m
i,j

= q
n,L
inj,ix

n
i \leq q

n
inj,



3.3. Modelos para a Otimizac?ão da Produc?ão 67

assegurando a validade do lado esquerdo de (3.20e).
Similarmente, adicionando a desigualdade direita de (3.19d)

para todo m \in \scrM n e j \in \scrJ m, chega-se a\sum 
m\in \scrM n

\sum 
j\in \scrJ m

q
n,m
inj,i,j \leq 

\sum 
m\in \scrM n

\sum 
j\in \scrJ m

q
n,m,U
inj,i z

n,m
i,j

=\Rightarrow 
\sum 

m\in \scrM n

\sum 
j\in \scrJ m

q
n,m
inj,i,j \leq q

n,U
inj,ix

n
i =\Rightarrow 

\sum 
m\in \scrM n

\sum 
j\in \scrJ m

q
n,m
inj,i,j +

\sum 
l\in \scrI n:l \not =i

\sum 
m\in \scrM n

\sum 
j\in \scrJ m

q
n,m
inj,l,j

\leq qn,Uinj,ix
n
i +

\sum 
l\in \scrI n:l \not =i

\sum 
m\in \scrM n

\sum 
j\in \scrJ m

q
n,m
inj,l,j =\Rightarrow 

qninj \leq q
n,U
inj,ix

n
i +

\sum 
l\in \scrI n:l \not =i

\sum 
m\in \scrM n

\sum 
j\in \scrJ m

q
n,m,U
inj,l z

n,m
l,j =\Rightarrow 

qninj \leq q
n,U
inj,ix

n
i + q

n,U
inj

\sum 
l\in \scrI n:l \not =i

\sum 
m\in \scrM n

\sum 
j\in \scrJ m

z
n,m
l,j

=\Rightarrow qninj \leq q
n,U
inj,ix

n
i + q

n,U
inj (1  - x

n
i ),

em que a última implicac?ão advém do fato que zn,ml,j = 0 para todo
l \not = i quando xni = 1. Caso contrário, se x

n
i = 0, então a soma z

n,m
l,j

irá assumir o valor máximo 1. Consequentemente, a Eq. (3.20e) é
satisfeita.

Para qualquer n \in \scrN , adicionando a desigualdade direita de
(3.19d) para todo m \in \scrM n, (i, j) \in \scrK n,m resulta em\sum 

m\in \scrM n

\sum 
(i,j)\in \scrK n,m

q
n,m
inj,i,j \leq 

\sum 
m\in \scrM n

\sum 
(i,j)\in \scrK n,m

q
n,m,U
inj,i z

n,m
i,j

=\Rightarrow 
\sum 

m\in \scrM n

\sum 
(i,j)\in \scrK n,m

qninj \leq 
\sum 

m\in \scrM n

\sum 
(i,j)\in \scrK n,m

q
n,U
inj z

n,m
i,j

=\Rightarrow qninj \leq q
n,U
inj y

n,



68 Capítulo 3. Modelos Quadráticos para Otimizac?ão da Produc?ão

que, por sua vez, implica a validade de Eq. (3.20f).
As restric?ões binárias (3.20g)–(3.20i) são obviamente váli-

das.
Para a Eq. (3.20j), toma-se qualquer n \in \scrN , m \in \scrM n, i \in \scrI n

e j \in \scrJ m. Se zn,mi,j = 0, então (3.20j) é induzida por (3.19e) uma
vez que \bfq n,\mathrm{m}\mathrm{a}\mathrm{x} é suficientemente alto para tornar (3.19e) e (3.20j)
inócuas. Por outro lado, se zn,mi,j = 1 então q

n,m
inj,i,j = q

n
inj e (3.19e)

torna-se (3.20j) uma vez que xni = z
n,m = \zeta mj = 1. Além disso,

as Eqs. (3.20k)–(3.20l) são obviamente induzidas por (3.19f) e as
definic?ões em (3.21). Finalmente, as Eqs. (3.20m)–(3.20n) seguem
diretamente de (3.19i) e das Eqs. (3.19l) -(3.19z).

Os desenvolvimentos acima mostram que para qualquer solu-
c?ão factível \bfittheta ag para \widetilde Pag existe uma soluc?ão factível correspondente
\bfittheta dag para \widetilde Pdag.

A outra direc?ão também pode ser estabelecida da mesma ma-
neira.

Assumindo \bfittheta dag como uma soluc?ão factível para \widetilde Pdag, pode-
se obter uma soluc?ão equivalente \bfittheta ag factível para \widetilde Pag. Inicialmente,
define-se: qninj, \widetilde \bfq n,mi,j , \widetilde \bfq n,m, \bfq m, pm, \widetilde \Delta pm, yn, ym, \zeta mj , wmo,w,g, \bfq mo,w,g,
e \Delta pmo,w,g para \bfittheta ag como em \bfittheta dag.

Por fim, define-se as variáveis restantes seguindo:

z
n,m
i,j = x

n
i z

n,m\zeta mj (3.22a)

q
n,m
inj,i,j = q

n
injz

n,m
i,j (3.22b)

A questão é saber se todas as restric?ões de \widetilde Pag serão satisfeitas por
\bfittheta ag.

A restric?ão (3.19b) é diretamente satisfeita. Expandindo a Eq.
(3.19c) para algum n \in \scrN ,\sum 

m\in \scrM n

\sum 
(i,j)\in \scrK n,m

z
n,m
i,j =

\sum 
m\in \scrM n

\sum 
i\in \scrI n

\sum 
j\in \scrJ m

zn,mxni \zeta 
m
j

=
\sum 

m\in \scrM n

zn,m
\sum 
i\in \scrI n

xni
\sum 

j\in \scrJ m
\zeta mj =

\sum 
m\in \scrM n

zn,m
\sum 
i\in \scrI n

xni

=
\sum 

m\in \scrM n

zn,myn = (yn)2 = yn,



3.3. Modelos para a Otimizac?ão da Produc?ão 69

demonstrando a validade da Eq. (3.19c).
Para a Eq. (3.19d), toma-se qualquer n \in \scrN , m \in \scrM n e

(i, j) \in \scrK n,m. Se zn,mi,j = 0 então Eq. (3.19d) é induzida pelas
definic?ões em (3.22). Por outro lado, se zn.mi,j = 1, então x

n
i = 1,

e a Eq. (3.20e) para este i leva a

q
n,L
inj,ix

n
i \leq q

n
inj \leq q

n,U
inj,ix

n
i + q

n,U
inj (1  - x

n
i )

=\Rightarrow qn,m,Linj,i \leq 
q
n,m
inj,i,j

z
n,m
i,j

\leq qn,m,Uinj,i

=\Rightarrow qn,m,Linj,i z
n,m
i,j \leq q

n,m
inj,i,j \leq q

n,m,U
inj,i z

n,m
i,j ,

estabelecendo a validade de (3.19d).
Para a Eq. (3.19e), considera-se qualquer n \in \scrN , m \in \scrM n e

(i, j) \in \scrK n,m. Nota-se que a Eq. (3.19e) é satisfeita se zn,mi,j = 0 por-
que \bfq n,\mathrm{m}\mathrm{a}\mathrm{x} é suficientemente grande para garantir que a restric?ão
fique inócua. No entanto, se zn,mi,j = 1, então (3.20j) resulta em

\widetilde \bfq n,mi,j \leq \Phi n,mi,j (qninj, pm) \Leftarrow \Rightarrow \widetilde \bfq n,mi,j \leq \Phi n,mi,j (qn,minj,i,jzn,mi,j , pm)
\Leftarrow \Rightarrow \widetilde \bfq n,mi,j \leq \Phi n,mi,j (qn,minj,i,j, pm),

o que implica a validade de (3.19e). A Eq. (3.19f) é induzida por
(3.20k)–(3.20l) e as definic?ões em (3.22). A Eq. (3.19g) evidente-
mente é assegurada por definic?ão.

Considerando qualquer n \in \scrN . Se yn = 0, então qninj = 0
tendo em vista a Eq. (3.20f) e consequentemente xni = 0, z

n,m = 0,
z
n,m
i,j = 0 e q

n,m
inj,i,j = 0 para todo m \in \scrM n e (i, j) \in \scrK 

n,m, o que sig-
nifica que a Eq. (3.19h) é satisfeita. Por outro lado, se yn = 1, então
z
n, \^m
\^i,\^j

= 1 para algum \^i, \^j e \^m, o que implica zn,mi,j = 0 e q
n,m
inj,i,j = 0

para todos os outros i, j, e m, e, além disso, qn, \^m
inj,\^i,\^j

= qninj. Con-
sequentemente, a Eq. (3.19h) também é satisfeita em relac?ão às
condic?ões operacionais do poc?o n.

A Eq. (3.19i) é garantida pela Eq. (3.20m). A Eq. (3.19j) é
obviamente satisfeita.

Para qualquer n \in \scrN , m \in \scrM n e j \in \scrJ m, a Eq. (3.20d) leva



70 Capítulo 3. Modelos Quadráticos para Otimizac?ão da Produc?ão

a \sum 
i\in \scrI n

xni = y
n =\Rightarrow 

\sum 
i\in \scrI n

xni \zeta 
m
j = y

n\zeta mj

=\Rightarrow 
\sum 
i\in \scrI n

xni \zeta 
m
j z

n,m \leq \zeta mj =\Rightarrow 
\sum 

i\in \scrI n,m
z
n,m
i,j \leq \zeta 

m
j ,

que é precisamente (3.19k). Uma vez que as Eqs. (3.19l)–(3.19z)
são obviamente induzidas por (3.20n), pode-se concluir que a Eq.
(3.20n) é assegurada.

Esses desenvolvimentos mostram que para qualquer soluc?ão
factível \bfittheta dag para \widetilde Pdag existe uma soluc?ão factível correspondente
\bfittheta ag para \widetilde Pag.

A relac?ão entre as soluc?ões factíveis de \widetilde Pag and \widetilde Pdag são for-
malizadas pela seguinte proposic?ão:

Proposic?ão 1. Assumindo que \scrI n = \scrI n,m e [qn,m,Linj,i , q
n,m,U
inj,i ]

= [q
n,L
inj,i, q

n,U
inj,i] para todo n \in \scrN , m \in \scrM n e i \in \scrI 

n, as formulac?ões\widetilde Pag e \widetilde Pdag são equivalentes.
3.4 SUMÁRIO

Nessa sec?ão foram apresentados conceitos fundamentais para
o desenvolvimento do trabalho, bem como os modelos propostos
para a otimizac?ão da produc?ão de petró?leo.

O capítulo se iniciou com uma breve explicac?ão sobre con-
juntos convexos e em seguida func?ões convexas. Esses tópicos são
de extrema importância, uma vez que os modelos MICP propostos
utilizam domínios e func?ões convexos na resoluc?ão do problema de
otimizac?ão da produc?ão de campos de petróleo.

Em seguida, foi mostrado o procedimento para a síntese de
curvas que representam as aproximac?ões quadráticas das func?ões
de produc?ão e queda de pressão de um poc?o. A partir dessa síntese
de curvas, pode-se converter um modelo MINLP em um modelo
MICP e resolvê-lo mais facilmente com um solver comercial.

Após isso, foram apresentados os modelos MICP agregado e
desagregado. Nas duas formulac?ões um modelo quadrático-côncavo
é utilizado para aproximar as func?ões de produc?ão dos poc?os \bfq n,m,
enquanto um modelo quadrático convexo é utilizado para represen-
tar a queda de pressão \Delta P m, a qual é aproximada com modelos



3.4. Sumário 71

quadráticos por partes multidimensionais dentro de cada região de
seu domínio. No modelo agregado utiliza-se uma família de variá-
veis binárias \{ zn,mi,j \} para decidir simultaneamente a respeito do ro-
teamento do poc?o n ao manifold m, o intervalo ativo i de injec?ão de
gás qninj e o intervalo ativo para a pressão no manifold p

m. No mo-
delo desagregado considera-se uma decomposic?ão entre produc?ão
do poc?o, alinhamento entre poc?os e manifolds e pressão de operac?ão
em três variáveis binárias independentes. Por fim, foi comprovado
que as duas formulac?ões devem produzir as mesmas soluc?ões uma
vez que são matematicamente equivalentes.





4 ANÁLISES DOS RESULTADOS

O capítulo a seguir é uma síntese de todos os resultados al-
canc?ados nessa dissertac?ão. O texto se inicia com a apresentac?ão
do cenário experimental, no qual são fornecidos detalhes sobre o
campo de produc?ão de petróleo sintético utilizado para as análises.

Em seguida são apresentados os resultados das sínteses de
curvas a partir dos modelos e parâmetros adotados para resolver
o problema de programac?ão semi-definida. Uma análise criteriosa
sobre os dados obtidos é proposta a fim de definir as melhores
aproximac?ões para serem utilizadas no modelo de otimizac?ão da
produc?ão de petróleo.

De posse das curvas aproximadas, a sequência do capítulo se
destina a apresentar os resultados dos modelos Agregado e Desa-
gregado propostos durante o trabalho. Variou-se o fatiamento do
domínio e o tipo de aproximac?ão (linear ou quadrática) com o ob-
jetivo de identificar qual combinac?ão possui o melhor resultado em
termos de custo computacional.

O capítulo se encerra com a discussão acerca da análise de
simulac?ão, no qual as soluc?ões encontradas nos modelos Agregado
e Desagregado são testadas no simulador do campo de petróleo ado-
tado.

4.1 CENÁRIO EXPERIMENTAL

O campo de petróleo utilizado nesse trabalho possui uma
configurac?ão similar à utilizada em [3], o qual consiste em um com-
pressor de gás, dois separadores conectados aos seus respectivos
manifolds adjuntos e oito poc?os, os quais possuem as opc?ões de ro-
teamento para ambos manifolds.

A Figura 4.1 apresenta uma configurac?ão estrutural do mo-
delo de campo adotado. O compressor e separadores possuem ca-
pacidades limitadas segundo a Tabela 4.1. Ainda em relac?ão aos
separadores a pressão nominal destes foi fixada em 150 psia (pS).
Entretanto, o separador 1 está conectado ao manifold adjunto por
uma tubulac?ão de 328 m, enquanto o separador dois está conectado
ao outro por uma tubulac?ão de 164 m. Como mencionado, todos os
8 poc?os podem ser roteados a qualquer manifold, embora os poc?os
de número 1 a 4 estejam mais próximos do manifold 1, conectados
por uma tubulac?ão de 1000 pés e mais distantes do manifold 2, liga-
dos por uma tubulac?ão de 10000 pés. De forma análoga, os poc?os
de número 5 a 8 estão mais próximos do manifold 2 e mais distantes

73



74 Capítulo 4. Análises dos Resultados

do manifold 1.

1 4

1

1 2

2

5 8

Compressor

Manifold de
gás de elevação

Manifolds

Poços

Separadores

Figura 4.1: Cenário sintético de campo de petróleo.

Tabela 4.1: Limites do compressor e separadores.

Compressor Separadores 1 e 2

4 mmscf/d 3500 STB/d



4.1. Cenário Experimental 75

Ta
be

la
4

.2
:

D
ad

os
n

om
in

ai
s

d
a

in
st

ân
ci

a.

P
o
c?o

#
1

2
3

4
5

6
7

8

G
L
R

[s
cf

/S
T

B
]

2
0
0

1
8
0

1
6
0

1
2
0

3
0
0

2
7
0

2
4
0

1
8
0

W
C

[%
]

0
1
0

2
0

4
0

0
1
0

2
0

4
0

P
re

ss
ão

d
o

re
se

rv
at

ór
io

[p
si

a]
2

1
0

0
1

9
0

0
2

3
0

0
2

2
0

0
1

8
5

0
1

9
5

0
2

3
0

0
2

0
5

0

P
I

a
[S

T
B

/d
/p

si
]

1
5

5
2

9
1

1
1

2
6

1
5

Te
m

p
er

at
u

ra
d

o
re

se
rv

at
ór

io
[
o
F
]

2
5

0
2

5
0

2
5

0
2

5
0

2
5

0
2

5
0

2
5

0
2

5
0

P
ro

fu
n

d
id

ad
e

d
as

p
er

fu
ra

c?õ
es

[f
t]

1
2

0
0

0
1

2
0

0
0

1
2

0
0

0
1

2
0

0
0

1
2

0
0

0
1

2
0

0
0

1
2

0
0

0
1

2
0

0
0

D
I

b
d

as
tu

bu
la

c?õ
es

[p
ol

eg
ad

as
]

3
3

3
3

3
3

3
3

Te
m

p
er

at
u

ra
n

a
ca

be
c?a

d
o

p
oc?

o
[
o
F
]

5
0

5
0

5
0

5
0

5
0

5
0

5
0

5
0

D
I

d
as

li
n

h
as

[p
ol

eg
ad

as
]

4
4

4
4

4
4

4
4

a
Ín

d
ic

e
d

e
p
ro

d
u

ti
vi

d
ad

e
d

o
p
oc?

o
b
D

iâ
m

et
ro

In
te

rn
o



76 Capítulo 4. Análises dos Resultados

O campo de petróleo representado foi instanciado por um
simulador multifásico. A Tabela 4.2 apresenta parte dos valores uti-
lizados nos 8 poc?os instanciados. Os demais valores foram deixados
como padrão.

Uma vez que os valores dos parâmetros adotados para o cam-
po de petróleo são passados ao simulador, o mesmo gera valores
para os pontos de curvas artificiais de produc?ão e queda de pressão.
São esses os pontos utilizados para a gerac?ão de aproximac?ões.

Tendo em vista que a ideia principal do trabalho é comparar
a otimizac?ão de vários cenários a partir de diferentes aproximac?ões
das curvas de produc?ão e queda de pressão, a próxima sec?ão é dedi-
cada a apresentar os resultados computacionais para a gerac?ão das
aproximac?ões.

4.2 SÍNTESE DE APROXIMAC?ÃO DE CURVAS

Para definir as aproximac?ões de curvas do problema CF na
Sec?ão 3.2, bem como suas variantes disponíveis no Apêndice B,
de acordo com os parâmetros citados também na Sec?ão 3.2 (erro,
norma, divisões do domínio e tipo de aproximac?ão), foi necessário
definir as ferramentas utilizadas.

A modelagem dos problemas SDP foi realizada a partir do
toolbox para Matlab R\bigcirc YALMIP [20] e resolvidos a partir do solver
SeDuMi na versão 1.3 [21].

Os problemas foram executados em um computador com sis-
tema operacional Ubuntu Linux na versão 14.04 64 bits, com um
processador Intel Core i5-4210U de 1,70GHz com 8GB de RAM.

Vale salientar que não é trivial definir a melhor aproximac?ão
para as curvas de produc?ão e queda de pressão. Dessa forma, faz-
se necessário trac?ar uma estratégia para descobrir qual a melhor
aproximac?ão para as curvas de produc?ão e queda de pressão.

4.2.1 Análise das aproximac?ões de curvas de produc?ão

Ao analisar as aproximac?ões das curvas de produc?ão, dois as-
pectos são bastante importantes: o modo como serão aproximadas
as curvas e se essas aproximac?ões possuem uma representatividade
satisfatória em relac?ão às curvas originais.

Para entender qual cenário possibilita alcanc?ar uma melhor
relac?ão de custo benefício entre as aproximac?ões das curvas de
produc?ão, foi proposto resolver problemas SDP variando-se alguns
dos parâmetros citados na Sec?ão 3.2.



4.2. Síntese de Aproximac?ão de Curvas 77

Tendo em vista que a curva de produc?ão possui um aspecto
geral com formato côncavo, como apresentado na Figura 3.10, bus-
cou-se formular os problemas de SDP a partir de func?ões lineares
ou quadráticas côncavas para representá-la.

Em relac?ão ao erro, procurou-se analisar a minimizac?ão do
erro absoluto e relativo. Já a norma utilizada foi a norma \ell 1, em
virtude de apresentar melhores resultados em relac?ão à norma infi-
nita \ell \infty e norma \ell 2 (as formulac?ões de problemas SDP com norma
2 e norma infinita, bem como algumas simulac?ões realizadas são
discutidas no Apêndice B).

Para o refinamento das curvas de produc?ão, optou-se por uti-
lizar duas variac?ões de divisões do domínio: a primeira com 4 poli-
topos (2 divisões no eixo de injec?ão de gás e 2 divisões no eixo de
pressão), e a segunda com 25 politopos (5 divisões por eixo).

A Tabela 4.3 apresenta os parâmetros utilizados nos proble-
mas SDP para as curvas de produc?ão, expondo todos os casos simu-
lados de acordo com a variac?ão de parâmetros. Já as Figuras 4.2 e
4.3 representam as divisões dos limites de cada politopo na curva
de produc?ão para 4 e 25 politopos, respectivamente.

É importante observar que foram coletados 21 pontos por
eixo (21 pontos para o eixo da pressão e 21 para o eixo da injec?ão)
espac?ados de forma não uniforme e que cada politopo possui a
mesma quantidade de pontos amostrados. Isso se deve ao fato de
que, para regiões mais instáveis da curva, representadas pelos poli-
topos (1,1) e (1,2) na Figura 4.2, é necessária uma maior amostra-
gem para se chegar a uma aproximac?ão suficientemente adequada
da curva, enquanto para regiões mais estáveis, a amostragem dos
pontos pode ser feita de forma mais espac?ada.

O mesmo comportamento pode ser observado na Figura 4.3,
uma vez que, no eixo de injec?ão de gás, os politopos comec?am
com regiões menores e ficam maiores conforme a curva vai apre-
sentando um comportamento mais estável.

Aplicando os parâmetros definidos no problema CF da Sec?ão
3.2 bem como em seus variantes, iniciou-se o processo de teste.

O primeiro passo foi solucionar o problema para o modelo
com 4 politopos. Uma análise criteriosa politopo a politopo foi re-
alizada para entender melhor o comportamento das aproximac?ões
em cada divisão do domínio da curva.

Para cada resultado, foram coletados os valores do objetivo,
erro absoluto máximo, erro absoluto médio, erro relativo máximo e
erro relativo médio.



78 Capítulo 4. Análises dos Resultados

Tabela 4.3: Cenários utilizados para as aproximac?ões das curvas de
produc?ão de petróleo.

Refinamento
(no de politopos)

Tipo de
Aproximac?ão

Tipo do erro

4 (2 \times 2) Linear Abs
Rel

Côncava Abs
Rel

25 (5 \times 5) Linear Abs
Rel

Côncava Abs
Rel

150

325

500

0 1.4 4

(i)

(j)

Pm (psia)

qinj (sm3/d)

(1,1) (2,1)

(1,2) (2,2)

Figura 4.2: Limites de injec?ão e pressão para 4 politopos.

As Tabelas 4.4, 4.5, 4.6 e 4.7 apresentam respectivamente
os resultados para a minimizac?ão do erro absoluto somente com a-
proximac?ões lineares, minimizac?ão do erro absoluto para somente
aproximac?ões quadráticas côncavas, minimizac?ão do erro relativo
apenas para aproximac?ões lineares e minimizac?ão do erro relativo
apenas para aproximac?ões quadráticas côncavas.

Como era esperado, para regiões mais instáveis da curva origi-
nal (politopos (1,1) e (1,2)), tanto as aproximac?ões lineares quanto



4.2. Síntese de Aproximac?ão de Curvas 79

(1,1)

150

220

290

360

430

500

0 0.3 1 1.8 2.8 4

(2,1) (3,1) (4,1) (5,1)

(1,2) (2,2) (3,2) (4,2) (5,2)

(1,3) (2,3) (3,3) (4,3) (5,3)

(1,4) (2,4) (3,4) (4,4) (5,4)

(1,5) (2,5) (3,5) (4,5) (5,5)

(i)

(j)

Pm (psia)

qinj (sm3/d)

Figura 4.3: Limites de injec?ão e pressão para 25 politopos.

Tabela 4.4: Aproximac?ão Linear – Minimizac?ão erro absoluto –
Norma 1 – 2 politopos por eixo.

erro abs
(STB/d)

erro rel
(%)

Param Politopo
Objetivo

*104
Max Med Max Med

Abs (1,1) 1,7 263,0 147,0 260% 121%
- (1,2) 1,1 350,8 94,0 350% 79%

Norma 1 (2,1) 0,2 75,5 17,2 0,09% 0,02%
- (2,2) 0,2 56,3 17,1 0,09% 0,02%

Linear Resultado 3,2 350,8 68,8 350% 50,3%

as quadráticas possuem valores de erros mais altos, uma vez que se
torna difícil encontrar uma curva com boa representac?ão para es-
sas regiões. No entanto, as curvas quadráticas obtiveram um valor
do objetivo, erro relativo e absoluto médios mais baixos tanto para
minimizac?ão do erro absoluto quanto do relativo.

Ainda na tentativa de obter um cenário mais adequado, foi re-
alizado um teste que propõe as aproximac?ões que melhor se adap-
tarem para cada politopo, ou seja, cada politopo pode ser aproxi-
mado por uma curva côncava ou linear. Entretanto, como os resul-



80 Capítulo 4. Análises dos Resultados

Tabela 4.5: Aproximac?ão Côncava – Minimizac?ão erro absoluto –
Norma 1 – 2 politopos por eixo.

erro abs
(STB/d)

erro rel
(%)

Param Politopo
Objetivo

*104
Max Med Max Med

Abs (1,1) 0,9 313,3 74,8 58,2% 4,4%
- (1,2) 0,85 380,6 70,6 320% 50,6%

Norma 1 (2,1) 0,04 14,9 3,3 0,01% 0,003%
- (2,2) 0,03 11,5 3,0 0,01% 0,004%

Côncavo Resultado 1,82 380,6 37,9 320% 13,8%

Tabela 4.6: Aproximac?ão Linear – Minimizac?ão erro relativo –
Norma 1 – 2 politopos por eixo.

erro abs
(STB/d)

erro rel
(%)

Param Politopo
Objetivo

*104
Max Med Max Med

Rel (1,1) 0,0069 660,5 315,6 4,5% 0,6%
- (1,2) 0,0100 845,3 319,5 1,0% 0,8%

Norma 1 (2,1) 0,00021 74,1 17,2 0,08% 0,02%
- (2,2) 0,00027 54,6 17,1 0,09% 0,02%

Linear Resultado 0,0180 845,3 167,4 4,5% 0,4%

Tabela 4.7: Aproximac?ão Côncava – Minimizac?ão erro relativo –
Norma 1 – 2 politopos por eixo.

erro abs
(STB/d)

erro rel
(%)

Param Politopo
Objetivo

*104
Max Med Max Med

Rel (1,1) 0,0068 630,4 326,6 4,2% 0,5%
- (1,2) 0,0097 795,4 280,9 1,0% 0,7%

Norma 1 (2,1) 0,00004 13,2 3,3 0,01% 0,003%
- (2,2) 0,00005 10,8 3,0 0,02% 0,004%

Côncavo Resultado 0,0166 795,4 153,5 4,2% 0,3%

tados das Tabelas 4.5 e 4.7 mostraram números melhores em to-
dos os politopos que os das Tabelas 4.4 e 4.6, respectivamente, já
era esperado que os resultados apontassem o melhor cenário como



4.2. Síntese de Aproximac?ão de Curvas 81

sendo todos os politopos aproximados por curvas côncavas, tanto
na minimizac?ão do erro absoluto, quanto do erro relativo.

O segundo passo na análise de curvas de queda de pressão
foi resolver os mesmos problemas simulados anteriormente para
um fatiamento maior do domínio, agora com 5 divisões por eixo,
totalizando 25 politopos. Os resultados são apresentados na Tabela
4.8.

Tabela 4.8: Análise da aproximac?ão da curva de produc?ão de petró-
leo para 25 politopos.

erro abs
(STB/d)

erro rel
(%)

Min Erro Modelo Objetivo Max Med Max Med
Linear 1,3\times 104 456,9 21,4 254% 11%

Abs Côncavo 0,86\times 104 453,8 13,8 329% 15%
Linear 92,4 609,7 39,7 1,69% 0,15%

Rel Côncavo 82,4 609,7 29,1 1,69% 0,13%

Novamente, os resultados apontaram números com o mesmo
comportamento que as aproximac?ões menos refinadas. A minimiza-
c?ão do erro absoluto gera erros absolutos menores e a minimizac?ão
do erro relativo gera erros relativos máximos e médios menores.
Contudo, a utilizac?ão do erro relativo produz melhores resultados
tanto para aproximac?ões lineares quanto para côncavas.

Um fato interessante a ser observado é que, com o maior fatia-
mento do domínio, os erros mensurados pelo objetivo são reduzidos
a menos da metade se comparados aos resultados com 4 politopos.

A partir das análises das curvas de produc?ão de petróleo con-
seguiu-se provar que para as condic?ões adotadas, as aproximac?ões
quadráticas possuem menores erros se comparadas às aproximac?ões
puramente lineares, sendo essa comprovac?ão um dos objetivos desse
trabalho.

Resta, no entanto, verificar a melhor relac?ão de custo benefí-
cio entre resultado e custo computacional quando essas aproxima-
c?ões são aplicadas ao problema de otimizac?ão da produc?ão, isso
porque, aproximac?ões mais refinadas tendem a ter melhores resulta-
dos a um custo computacional maior se comparadas a aproximac?ões
menos refinadas. Esses resultados serão discutidos em seguida, na
Sec?ão 4.3.



82 Capítulo 4. Análises dos Resultados

4.2.2 Análise das aproximac?ões de curvas de queda de pressão

De forma análoga, a análise das curvas de queda de pres-
são passam pelos mesmos critérios: a forma como serão geradas
as aproximac?ões e a qualidade das mesmas.

O processo adotado como estratégia para soluc?ão dos proble-
mas é similar ao das aproximac?ões da curva de produc?ão: foram
resolvidos problemas SDP formulados a partir de variac?ões do pro-
blema CF representados pela Eq. (3.18) minimizando-se o erro ab-
soluto e relativo segundo a norma l1. O número de divisões do domí-
nio, porém, foi realizado com nenhuma divisão do domínio (apenas
1 politopo) e com uma divisão do domínio por eixo (8 politopos). O
menor fatiamento do domínio para as curvas de queda de pressão
se deve ao fato de a func?ão ter um domínio tridimensional (queda
de pressão em func?ão das vazões de gás, petróleo e água), o que
acarreta o aumento considerável da soluc?ão do problema SDP para
maiores refinamentos.

Em relac?ão ao tipo de aproximac?ão, optou-se por definir a
escolha das aproximac?ões entre lineares e quadráticas, uma vez que
o comportamento da curva original possui um formato ligeiramente
convexo.

Como não é possível visualizar a curva de queda de pressão
em func?ão das vazões de água, gás e petróleo, a Figura 4.4 repre-
senta a curva original para uma vazão fixa de água (830 STB/d)
variando-se as vazões de petróleo e gás. A partir dessa figura, pode-
se observar o formato convexo das curva.

Para representar essas curvas, primeiramente foram obtidos
os pontos gerados por meio do simulador multifásico para o mani-
fold 1, segundo a instância exemplificada na Figura 4.1. De posse
dos pontos, bastou-se fixar o valor de um dos eixos e obter o com-
portamento da func?ão a partir do Matlab.

Sendo assim, a Tabela 4.9 apresenta todos os casos analisados
para as aproximac?ões das curvas de queda de pressão.

As Tabelas 4.10 e 4.11 representam as divisões dos limites de
cada politopo na curva de queda de pressão para 1 e 8 politopos,
respectivamente.

Assim como para as curvas de produc?ão, iniciou-se a resolu-
c?ão dos problemas SDP a partir do menor fatiamento do domínio,
realizando-se somente aproximac?ões lineares e, posteriormente, ape-
nas aproximac?ões quadráticas.

Foram coletados os valores do objetivo, erro absoluto máximo
e médio e erro relativo máximo e médio para todos os casos. Os



4.2. Síntese de Aproximac?ão de Curvas 83

Figura 4.4: Curva de queda de pressão em func?ão das vazões de
petróleo e gás. A vazão de água fixada em 830 STB/d, vazão de gás
dada em mmscf/d e vazão de petróleo em STB/d.

resultados são apresentados na Tabela 4.12.

Tabela 4.9: Cenários utilizados para as aproximac?ões das curvas de
queda de pressão.

Refinamento
(no de politopos)

Tipo de
Aproximac?ão

Tipo do erro

Linear Abs
1 Rel

(1 \times 1 \times 1) Convexo Abs
Rel

Linear Abs
8 Rel

(2 \times 2 \times 2) Convexo Abs
Rel

Como se pode observar na Tabela 4.12, os resultados apon-
tam para uma melhor representac?ão da curva (erros menores) quan-
do são utilizadas aproximac?ões convexas. Novamente, pode-se afir-



84 Capítulo 4. Análises dos Resultados

Tabela 4.10: Limites máximos e mínimos utilizados nas vazões para
1 politopo.

qo
(STB/d)

qg
(mmscf/d)

qw
(STB/d)

politopo min 0 0 0
(o,g,w) (1,1,1) max 16000 28.8 6400

Tabela 4.11: Limites máximos e mínimos utilizados por politopo
para 8 politopos.

qo
(STB/d)

qg
(mmscf/d/d)

qw
(STB/d)

(1,1,1) min 0 0 0
max 6500 11,7 2600

(2,1,1) min 6500 0 0
max 16000 11,7 2600

(1,2,1) min 0 11,7 0
max 6500 28,8 2600

(2,2,1) min 6500 11,7 0
Politopo max 16000 28,8 2600
(o,g,w) (1,1,2) min 0 0 2600

max 6500 11,7 6400
(2,1,2) min 6500 0 2600

max 16000 11,7 6400
(1,2,2) min 0 11,7 2600

max 6500 28,8 6400
(2,2,2) min 6500 11,7 2600

max 16000 28,8 6400

Tabela 4.12: Análise de erro para curvas de queda de pressão para
1 politopo.

erro abs
(psia)

erro rel
(%)

Min erro Modelo Objetivo Max Med Max Med
Linear 4,5*104 61,8 4,88 2,6% 0,2%

Abs Convexo 3,6*104 58,1 3,86 3,4% 0,1%
Linear 0,13*104 62,9 4,90 2,2% 0,1%

Rel Convexo 0,10*104 59,5 3,90 3,0% 0,1%



4.2. Síntese de Aproximac?ão de Curvas 85

mar que a minimizac?ão do erro relativo apresenta resultados mais
equilibrados para o cenário simulado.

Na sequência, foram feitos os testes para o fatiamento do do-
mínio com 8 politopos. Nessa simulac?ão foi realizada a análise po-
litopo a politopo para entender melhor o comportamento da curva
no domínio adotado.

Mais uma vez, pode-se perceber, a partir das Tabelas 4.13,
4.14, 4.15 e 4.16, que as aproximac?ões realizadas variam em qua-
lidade dependendo do politopo. Isso ocorre porque, independente-
mente do tipo de curva utilizada (linear ou convexa), há regiões em
que o domínio possui um comportamento bastante irregular, princi-
palmente para baixas vazões de água, petróleo e gás.

Tabela 4.13: Aproximac?ão Linear – Minimizac?ão erro absoluto – 2
politopos por eixo.

erro abs
(psia)

erro rel
(%)

Min
erro

Modelo Politopo
Obj.
\ast 103 Max Med Max Med

(1,1,1) 7,6 59,7 5,7 2,8% 0,2%
(2,1,1) 1,5 4,4 1,1 0,9% 0,1%
(1,2,1) 8,1 53,7 6,1 0,7% 0,1%
(2,2,1) 1,2 5,2 0,9 0,2% 0,04%

Abs Linear (1,1,2) 7,5 39,2 5,6 0,6% 0,1%
(2,1,2) 0,85 2,2 0,6 0,1% 0,02%
(1,2,2) 7,5 40,0 5,6 0,5% 0,1%
(2,2,2) 0,85 2,2 0,6 0,07% 0,02%
Total 35,1 59,7 3,3 2,8% 0,09%

Mesmo assim, é possível perceber que, de modo geral, as a-
proximac?ões convexas apresentam menores erros (objetivo e erros
médios) se comparadas às curvas lineares, tanto para minimizac?ão
do erro absoluto, quanto do erro relativo.

Nota-se ainda que a utilizac?ão do erro relativo na func?ão ob-
jetivo dos problemas SDP gera resultados muito mais satisfatórios
que os problemas que minimizam erros absolutos.

Quando comparadas as Tabelas 4.12 e 4.17, verifica-se, tam-
bém, que a adic?ão de apenas uma divisão em cada eixo do domí-
nio faz com que os erros sejam reduzidos da casa de 104 para 103

no caso da minimizac?ão do erro absoluto e de 103 para 102 para
minimizac?ão do erro relativo.



86 Capítulo 4. Análises dos Resultados

Tabela 4.14: Aproximac?ão Quadrática Convexa - Minimizac?ão erro
absoluto - 2 politopos por eixo.

erro abs
(psia)

erro rel
(%)

Min
erro

Modelo Politopo
Obj.
\ast 103 Max Med Max Med

(1,1,1) 6,9 57,1 5,2 3,1% 0,2
(2,1,1) 1,3 4,2 1,0 1,4% 0,09%
(1,2,1) 6,7 47,2 5,04 0,6% 0,1%
(2,2,1) 0,76 4,4 0,57 0,2% 0,02%

Abs Convexa (1,1,2) 5,5 28,0 4,1 0,4% 0,1%
(2,1,2) 0,34 1,27 0,25 0,05% 0,01%
(1,2,2) 5,2 21,5 3,9 0,3% 0,09%
(2,2,2) 0,37 1,3 0,3 0,04% 0,01%
Total 27,1 57,1 2,55 3,1% 0,08%

Tabela 4.15: Aproximac?ão Linear - Minimizac?ão erro relativo - 2
politopos por eixo.

erro abs
(psia)

erro rel
(%)

Min
erro

Modelo Politopo
Obj.
\ast 103 Max Med Max Med

(1,1,1) 0,23 61,56 5,87 2,2% 0,2%
(2,1,1) 0,12 4,46 1,22 0,6% 0,09%
(1,2,1) 0,18 55,2 6,2 0,8% 0,1%
(2,2,1) 0,057 5,62 0,9 0,2% 0,04%

Rel Linear (1,1,2) 0,15 41,3 5,8 0,6% 0,1%
(2,1,2) 0,037 2,49 0,6 0,1% 0,02%
(1,2,2) 0,13 39,3 5,7 0,6% 0,1%
(2,2,2) 0,029 2,1 0,7 0,075 0,02%
Total 0,93 61,56 3,39 2,2% 0,09%

Portanto, utilizando os cenários simulados, verificou-se que
a minimizac?ão do erro relativo e a utilizac?ão de norma \ell 1 produ-
zem resultados mais satisfatórios. De posse de curvas mais ou me-
nos refinadas, a próxima sec?ão se dedica a apresentar os resultados
para o problema de otimizac?ão da produc?ão de petróleo a partir da
combinac?ão entre as curvas de produc?ão de petróleo (lineares ou
côncavas com 4 ou 25 politopos) e as curvas de queda de pressão



4.2. Síntese de Aproximac?ão de Curvas 87

Tabela 4.16: Aproximac?ão Convexa - Minimizac?ão erro relativo - 2
politopos por eixo.

erro abs
(psia)

erro rel
(%)

Min
erro

Modelo Politopo
Obj.
\ast 103 Max Med Max Med

(1,1,1) 0,21 59,7 5,4 2,4% 0,16%
(2,1,1) 0,11 4,4 1,1 0,7% 0,08%
(1,2,1) 0,14 52,7 5,2 0,7% 0,1%
(2,2,1) 0,036 4,5 0,6 0,2% 0,02%

Rel Convexo (1,1,2) 0,11 36,5 4,5 0,6% 0,08%
(2,1,2) 0,014 1,2 0,2 0,05% 0,01%
(1,2,2) 0,11 34,9 4,3 0,5% 0,07%
(2,2,2) 0,012 1,2 0,2 0,04% 0,01%
Total 0,74 59,7 2,71 2,4% 0,07%

Tabela 4.17: Resumo das aproximac?ões da curva de queda de pres-
são para 8 politopos.

erro abs
(psia)

erro rel
(%)

Tipo Modelo Objetivo Max Med Max Med
Linear 35,1*103 59,7 3,3 2,8% 0,09%

Abs Convexo 27,1*103 57,1 2,5 3,1% 0,08%
Linear 9,3*102 61,6 3,4 2,2% 0,09%

Rel Convexo 7,4*102 59,7 2,7 2,4% 0,07%

(lineares ou convexas com 1 ou 8 politopos).



88 Capítulo 4. Análises dos Resultados

4.3 ANÁLISE COMPUTACIONAL

Uma vez obtidas as curvas aproximadas, tanto lineares, quan-
to quadráticas, das func?ões de produc?ão (com 4 e 25 politopos) e
das curvas de queda de pressão (com 1 e 8 politopos), o próximo
passo é utilizá-las como dados de entrada nos modelos Agregado e
Desagregado de otimizac?ão da produc?ão de petróleo descritos nas
Sec?ões 3.3.1 e 3.3.2.

Os cenários considerados podem ser divididos em quatro gru-
pos: aproximac?ões lineares para curvas de produc?ão e queda
de pressão, aproximac?ões côncavas para a curva de produc?ão
e convexas para queda de pressão, aproximac?ões lineares para
curvas de produc?ão e convexas para queda de pressão ou a-
proximac?ões côncavas para curvas de produc?ão e lineares para
queda de pressão.

Além disso, para cada experimento, há a variac?ão do número
de politopos para cada curva, ou seja, a curva de produc?ão pode ter
refinamento de 4 ou 25 politopos e a curva de queda de pressão 1
ou 8 politopos.

A combinac?ão entre essas variac?ões é dividida em 16 cenários
distintos descritos na Tabela 4.18. É importante salientar que esses
16 cenários se aplicam tanto ao modelo Agregado, quanto ao mo-
delo Desagregado, o que eleva o número de casos analisados para
32.

Os modelos Agregado e Desagregado foram formulados utili-
zando a linguagem matemática AMPL[22] e resolvidos com CPLEX
11 em um computador com processador Intel Core i5-4210U de
2.40GHz, 4GB de RAM com sistema operacional Ubuntu 14.10. To-
dos os experimentos têm tempo máximo de computac?ão de 10000
segundos (\approx 2, 8 horas).

As Tabelas 4.19 (Modelo Agregado) e 4.20 (Modelo Desagre-
gado) apresentam os resultados computacionais para diferentes a-
proximac?ões, resoluc?ões e formulac?ões consideradas nesta disserta-
c?ão. Nas duas tabelas é possível observar o tempo de soluc?ão de
cada cenário em segundos e o GAP1 percentual entre a soluc?ão en-
contrada e o valor ótimo (valor 0.0 nos casos em que se atinge a

1O algoritmo CPLEX calcula o GAP percentual da seguinte forma:
| bestbound  - bestinteger| (10 - 1 + | bestinteger| ). O valor padrão é
0,0001, o que significa que o CPLEX irá interromper a resoluc?ão
do poblema uma vez que encontre uma soluc?ão factível com valor
de 0,01% do valor ótimo.



4.3. Análise Computacional 89

Tabela 4.18: Casos simulados para os modelos Agregado e Desagre-
gado de otimizac?ão da produc?ão de petróleo.

Cenário Produc?ão Queda de pressão
Tipo de
Aprox.

Refinamento
(no politopos)

Tipo de
Aprox.

Refinamento
(no politopos)

1 Linear 4 Linear 1
2 Linear 25 Linear 1
3 Linear 4 Linear 8
4 Linear 25 Linear 8
5 Côncava 4 Convexa 1
6 Côncava 25 Convexa 1
7 Côncava 4 Convexa 8
8 Côncava 25 Convexa 8
9 Linear 4 Convexa 1
10 Linear 4 Convexa 8
11 Linear 25 Convexa 1
12 Linear 25 Convexa 8
13 Côncava 4 Linear 1
14 Côncava 4 Linear 8
15 Côncava 25 Linear 1
16 Côncava 25 Linear 8

otimalidade, ou outro valor se não se atingiu a otimidade em um
tempo de 10000 segundos, aproximadamente 2,8 horas).



90 Capítulo 4. Análises dos Resultados

Ta
be

la
4

.1
9

:
M

od
el

o
A

gr
eg

ad
o.

Q
u

ed
a

d
e

P
re

ss
ão

1
p
ol

it
op

o
8

p
ol

it
op

os
Li

n
ea

r
C

on
ve

xo
Li

n
ea

r
C

on
ve

xo
Te

m
p
o

(s
)

0
,3

2
0

,4
4

0
,5

4
2

,9
4

Li
n

ea
r

G
A

P
(%

)
0

,0
0

,0
0

,0
0

,0
p
ol

it
op

os
Te

m
p
o

(s
)

2
,8

0
,9

5
6

1
,4

1
,7

6
C

u
rv

as
d

e
C

ôn
ca

vo
G

A
P

(%
)

0
,0

0
,0

0
,0

0
,0

p
ro

d
u

c?ã
o

Te
m

p
o

(s
)

0
,5

8
1

,0
0

,9
8

2
0

,7
2

5
Li

n
ea

r
G

A
P

(%
)

0
,0

0
,0

0
,0

0
,0

p
ol

it
op

os
Te

m
p
o

(s
)

2
2

6
3

,1
1

2
,1

&gt;
1

0
0

0
0

1
2

9
,5

C
ôn

ca
vo

G
A

P
(%

)
0

,0
0

,0
-

0
,0



4.3. Análise Computacional 91

No cenário 16 do modelo Agregado (curva de produc?ão côn-
cava com 25 politopos e queda de pressão linear com 8 politopos) e
nos cenários 6, 7, 8 e 16 do modelo Desagregado não se conseguiu
encontrar nenhuma soluc?ão factível para o problema.

O primeiro resultado importante a ser considerado é que em
ambas formulac?ões o valor alcanc?ado no objetivo foi o mesmo para
os casos em que se atingiu a otimalidade, apontado para o fato que
as duas formulac?ões, Agregada e Desagregada, são equivalentes.

Outro ponto que pode ser observado é que o modelo Agre-
gado possui desempenho melhor que o Desagregado quando con-
siderado o tempo de soluc?ão para todos os cenários. Ainda assim,
nos dois modelos, quando se utiliza resoluc?ões menores, a soluc?ão
do problema é atingida mais rapidamente. Esse comportamento é
esperado, uma vez que, com a introduc?ão de mais variáveis nos mo-
delos, esses tendem a ser resolvidos de forma mais lenta, porém
com uma qualidade melhor em termos do objetivo.

Analisando somente o tempo de soluc?ão dos problemas é
possível afirmar também que a utilizac?ão de aproximac?ões linea-
res para a curva de produc?ão permite que se atinja o valor ótimo
com mais rapidez, tanto para o modelo Agregado quanto para o
Desagregado. Já quando se utiliza aproximac?ões lineares para as
curvas de queda de pressão, os tempos computacionais se elevam
consideravelmente para fatiamentos de 8 politopos.

Por fim, a criac?ão de um modelo genérico para combinar
aproximac?ões quadráticas e lineares nas curvas de produc?ão e perda
de carga proporcionou um avanc?o se comparados com os resultados
atingidos em Ramos Neto et al. [3], em que foi proposta a utilizac?ão
de um modelo quadrático somente para a curva de produc?ão, en-
quanto se utilizou apenas aproximac?ões lineares para as curvas de
queda de pressão.



92 Capítulo 4. Análises dos Resultados

Ta
be

la
4

.2
0

:
M

od
el

o
D

es
ag

re
ga

d
o. Q

u
ed

a
d

e
P

re
ss

ão
1

p
ol

it
op

o
8

p
ol

it
op

os
Li

n
ea

r
C

on
ve

xo
Li

n
ea

r
C

on
ve

xo
Te

m
p
o

(s
)

0
,3

7
0

,6
2

0
,9

7
5

,9
4

Li
n

ea
r

G
A

P
(%

)
0

,0
0

,0
0

,0
0

,0
p
ol

it
op

os
Te

m
p
o

(s
)

8
7

6
,5

2
,3

2
6

2
3

,2
&gt;

1
0

0
0

0
C

u
rv

as
d

e
C

ôn
ca

vo
G

A
P

(%
)

0
,0

0
,0

0
,0

-
p
ro

d
u

c?ã
o

Te
m

p
o

(s
)

2
,6

1
,5

8
,3

7
4

,1
2

5
Li

n
ea

r
G

A
P

(%
)

0
,0

0
,0

0
,0

0
,0

p
ol

it
op

os
Te

m
p
o

(s
)

4
5

1
2

,7
&gt;

1
0

0
0

0
&gt;

1
0

0
0

0
&gt;

1
0

0
0

0
C

ôn
ca

vo
G

A
P

(%
)

0
,0

-
-

-



4.4. Análise de Simulac?ão 93

4.4 ANÁLISE DE SIMULAC?ÃO

Tendo os resultados obtidos da otimizac?ão da produc?ão a par-
tir dos modelos Agregado e Desagregado, a última etapa de análi-
ses é a validac?ão dos resultados obtidos dos modelos quadráticos
no simulador. A partir dessa análise de simulac?ão se pode concluir
a eficácia dos modelos propostos nessa dissertac?ão.

Os dados utilizados como entrada no simulador multifásico
são obtidos a partir dos resultados de alinhamento e injec?ão de
gás nos poc?os determinados pelos modelos Agregado e Desagre-
gado. Por serem modelos equivalentes e produzirem o mesmo re-
sultado, optou-se por utilizar as soluc?ões daquele que apresentou
resultados computacionalmente mais eficientes, ou seja, o modelo
Agregado.

Além disso, como mostrado na Tabela 4.18, a partir das com-
binac?ões de resoluc?ão (divisões do domínio) e modelos (quadráti-
cos ou lineares), são 16 os cenários obtidos pelas análise do modelo
Agregado. Pretendendo apresentar resultados mais objetivos para a
análise de simulac?ão, foram escolhidos somente 8 dos 16 cenários
como apresentado na Tabela 4.21

Tabela 4.21: 8 casos selecionados para a análise de simulac?ão.

Cenário Produc?ão Queda de pressão
Tipo de
Aprox.

Refinamento
(no politopos)

Tipo de
Aprox.

Refinamento
(no politopos)

1 Linear 4 Linear 1
4 Linear 25 Linear 8
5 Côncava 4 Convexa 1
8 Côncava 25 Convexa 8
9 Linear 4 Convexa 1
12 Linear 25 Convexa 8
13 Côncava 4 Linear 1
15 Côncava 25 Linear 1

A escolha dos 8 cenários se deu pelo fato de representarem
todas as combinac?ões entre modelos lineares e quadráticos para as
curvas de produc?ão de petróleo e queda de pressão. Além disso,
esses casos escolhidos compreendem os de menor e maior resoluc?ão
possível.

Um ponto a se observar é que o caso de número 16 da Tabela
4.18 não foi adotado como o de maior resoluc?ão para o modelo



94 Capítulo 4. Análises dos Resultados

côncavo-linear. Isso se deve ao fato de esse cenário não ter apresen-
tado soluc?ão factível como informado na Tabela 4.19. Sendo assim,
escolheu-se o cenário 15, o qual possui a maior resoluc?ão possível
dentre os modelos analisados.

Uma vez definidos os cenários utilizados, o passo seguinte foi
simular as soluc?ões apresentadas pelos modelos de otimizac?ão no si-
mulador. Para facilitar o entendimento dos resultados da simulac?ão,
a Tabela 4.22 apresenta os cenários simulados, os tipos de aproxima-
c?ões de cada cenário e o erro percentual entre a soluc?ão encontrada
no problema de otimizac?ão Agregado e a soluc?ão dada pelo simu-
lador. O erro é dado pela diferenc?a entre a produc?ão de petróleo
resultante no simulador em relac?ão à produc?ão de petróleo dada
como soluc?ão do problema de otimizac?ão Agregado2.

Tabela 4.22: Comparac?ão entre resultados do modelo Agregado e
Simulador.

Cenários
Tipo de

aproximac?ão
Erro
(%)

1 Linear/Linear 10,5%
4 Linear/Linear 9,2%
5 Côncavo/Convexo 6,9%
8 Côncavo/Convexo 6,4%
9 Linear/Convexo 11,3%
12 Linear/Convexo 9,5%
13 Côncavo/Linear 9,4%
15 Côncavo/Linear 7,8%

Por meio da Tabela 4.22 pode-se levantar alguns pontos que
levam a uma conclusão sobre os modelos propostos nessa disserta-
c?ão.

A observac?ão mais importante é que os modelos puramente
quadráticos apresentaram resultados com menor erro do que aque-
les que mesclam curvas lineares com quadráticas ou puramente line-
ares. Esse resultado era aguardado, uma vez que modelos quadráti-
cos possuem uma representatividade mais adequada que os lineares
paras as curvas de produc?ão de petróleo e queda de pressão para as
resoluc?ões Côncavo/Convexo adotadas.

Outro ponto importante a ser ressaltado é o fato de que re-
soluc?ões maiores produzem resultados mais próximos dos apresen-

2Erro\% = (100 \ast | ressim  - resAg| )/resAg



4.4. Análise de Simulac?ão 95

tados pelo simulador. Esse efeito da resoluc?ão no resultado é inte-
ressante no sentido de estabelecer uma relac?ão de custo-benefício
entre desempenho computacional e qualidade da soluc?ão. A Tabela
4.23 apresenta o tempo de soluc?ão do modelo Agregado nos cená-
rios analisados e o erro em relac?ão às soluc?ões apresentadas pelo
simulador.

Pode-se perceber que, de modo geral, para a obtenc?ão de
cerca de 1,3% na melhora do resultado, o tempo computacional
cresce consideravelmente (o melhor caso é entre os cenários 1 e 4
em que o tempo de soluc?ão cresce 68%) quando comparados mo-
delos que utilizam os mesmos tipos de aproximac?ões, porém com
resoluc?ões diferentes.

Tabela 4.23: Tempo de soluc?ão dos problemas de otimizac?ão e erros
em relac?ão ao simulador.

Cenários
Tipo de

aproximac?ão
Tempo de soluc?ão

(s)
Erro
(%)

1 Linear/Linear 0,32 10,5%
4 Linear/Linear 0,54 9,2%
5 Côncavo/Convexo 12,1 6,9%
8 Côncavo/Convexo 129,5 6,4%
9 Linear/Convexo 0,44 11,3%
12 Linear/Convexo 1,0 9,5%
13 Côncavo/Linear 2,8 9,4%
15 Côncavo/Linear 2263,1 7,8%

Ainda em relac?ão aos resultados da Tabela 4.22, é possível
perceber que a utilizac?ão de um modelo linear para representar as
curvas de produc?ão não teve efeito positivo, devido ao fato de os
cenários 1, 4, 9 e 12 apresentarem os maiores erros em relac?ão ao
simulador.

A explicac?ão para esse fato está no fato de as curvas de produ-
c?ão apresentarem comportamentos mais irregulares que as curvas
de queda de pressão (com curvaturas mais suaves), o que acarreta
maior dificuldade para representá-las por aproximac?ões lineares.

Esse resultado é interessante também no sentido de ser um
contraponto a outro resultado apresentado na Sec?ão 4.3. Isso por-
que, na análise computacional, verificou-se que o uso de aproxima-
c?ões lineares para a curva de produc?ão traz soluc?ões com tempos
computacionais menores. Porém, como é visto agora, esses resulta-



96 Capítulo 4. Análises dos Resultados

dos não possuem boa qualidade.
Para finalizar, verificou-se que todos os resultados obtidos por

meio do problema de otimizac?ão apresentaram erros relativamente
altos em relac?ão aos do simulador. Isso pode ser em decorrência da
utilizac?ão de poucos pontos de amostragem das curvas de produc?ão
e queda de pressão ou mesmo o fato de as resoluc?ões (quantidade
de politopos) utilizadas não serem suficientes para alcanc?ar resulta-
dos melhores.

4.5 SUMÁRIO

Nesse capítulo foram apresentadas as análises e resultados de
todo o trabalho desenvolvido.

Primeiramente foram apresentados os resultados para as sín-
teses de curvas. Notou-se que, para a gerac?ão das aproximac?ões das
curvas de produc?ão e queda de pressão, a utilizac?ão de norma \ell 1 e
erro relativo no problema de programac?ão semi-definida apresenta
resultados mais satisfatórios se comparados aos outros parâmetros
analisados.

Definidas as aproximac?ões lineares e quadráticas para as cur-
vas de produc?ão e perda de carga, essas foram utilizadas como en-
trada para os modelos Agregado e Desagregado de otimizac?ão da
produc?ão de petróleo propostos nesse trabalho.

Os resultados apontaram a equivalência entre os modelos de-
monstrada matematicamente na Sec?ão 3.3.3, e também indicam
uma maior eficácia do modelo Agregado em relac?ão ao tempo com-
putacional.

O capítulo se encerrou com a análise de simulac?ão, a qual
busca verificar a qualidade dos resultados atingidos pelos proble-
mas de otimizac?ão da produc?ão definidos. Verificou-se que a utiliza-
c?ão de modelos quadráticos apresentou menor erro se comparada
ao uso dos modelos mistos ou lineares.



5 CONCLUSÃO

A competitividade, a crescente demanda de combustíveis fós-
seis e os altos custos com o processo de extrac?ão de petróleo estão
entre os principais fatores pelos quais a indústria petrolífera une
esforc?os para ampliar suas fronteiras a partir de tecnologias que re-
duzem os custos e aumentem a produtividade de suas instalac?ões.

Nesse sentido, a economia de recursos a partir de taxas óti-
mas de injec?ão de gás em poc?os com elevac?ão artificial e a obtenc?ão
de uma configurac?ão correta de alinhamento entre poc?os e mani-
folds são fundamentais para a indústria do petróleo.

A contribuic?ão do trabalho apresentado se concentrou em
propor dois modelos genéricos para a otimizac?ão da produc?ão de pe-
tróleo, os quais podem ser utilizados para diferentes configurac?ões.

Diferentemente de outros trabalhos, foram propostos dois mo-
delos que fazem uso de aproximac?ões lineares ou quadráticas cônca-
vas para as curvas de produc?ão de poc?os e lineares ou quadráticas
convexas para as curvas de queda de pressão. Dessa forma, esses
problemas podem ser combinados com a variac?ão de parâmetros co-
mo fatiamento de domínio e tipo de aproximac?ões, podendo estar
na classe de problemas convexos inteiros mistos ou mesmo lineares
inteiros mistos.

Em relac?ão aos modelos de otimizac?ão da produc?ão desen-
volvidos, o primeiro, denominado modelo Agregado, faz uso de va-
riáveis binárias contendo informac?ões a respeito de roteamento e
intervalos ativos de injec?ão de gás e pressão no manifold. Já o mo-
delo Desagregado possui um conjunto de três variáveis binárias que
decidem a respeito de roteamento, intervalos de injec?ão e intervalos
de pressão. A partir da formulac?ão dos modelos, foi proposta uma
análise de equivalência, a qual prova que os dois modelos são, ne-
cessariamente, equivalentes e podem ser utilizados para a obtenc?ão
dos mesmos resultados.

Por se tratar de modelos que fazem utilizac?ão de aproxima-
c?ões para curvas de produc?ão e queda de pressão, primeiramente,
fez-se necessário identificar o modo de obtenc?ão das curvas aproxi-
madas (quadráticas ou lineares) e, a partir da variac?ão dos parâme-
tros do modelo, tais como, norma, fatiamento do domínio e tipo de
erro, obter as melhores aproximac?ões. Sendo assim, problemas de
programac?ão semi-definida foram formulados a partir da variac?ão
de parâmetros do problema. Verificou-se que o modelo utilizando
norma \ell 1 e a minimizac?ão do erro relativo permitiram alcanc?ar me-
lhores resultados tanto para as aproximac?ões da curva de produc?ão,
quanto para as curvas de queda de pressão, considerando qualquer

97



98 Capítulo 5. Conclusão

fatiamento.
Uma vez identificadas as melhores aproximac?ões, essas foram

utilizadas como entradas para a soluc?ão do problema de otimizac?ão
da produc?ão de petróleo a partir dos modelos Agregado e Desagre-
gado. Notou-se que em todos os ensaios computacionais, variando-
se as aproximac?ões entre lineares e quadráticas e para diferentes fa-
tiamentos, o custo computacional do modelo Agregado se mostrou
menor se comparado ao do modelo Desagregado. Além disso, con-
seguiu-se, por meio das soluc?ões alcanc?adas, verificar que os dois
modelos são equivalentes como provado matematicamente.

Outros dados importantes obtidos para o campo de petró-
leo utilizado no trabalho foram, analisando-se o custo computaci-
onal, os melhores resultados com a utilizac?ão de aproximac?ões line-
ares para as curvas de produc?ão. No entanto, quando são utilizadas
aproximac?ões quadráticas em fatiamentos maiores do domínio para
as curvas de queda de pressão, o resultado apresenta custo compu-
tacional elevado.

Por fim, foi necessário verificar a qualidade dos resultados en-
contrados nos problemas de otimizac?ão propostos. Para tanto, con-
siderando que o modelo Agregado apresentou melhor desempenho
que o Desagregado, utilizou-se as soluc?ões encontradas dentre oito
cenários analisados do modelo Agregado como entrada para um si-
mulador multifásico.

Os resultados do simulador foram comparados aos do mo-
delo Agregado e verificou-se que a utilizac?ão de modelos quadrá-
ticos alcanc?am resultados com menor erro quando comparadas as
soluc?ões do modelo Agregado e do simulador.

Além disso, percebeu-se que a utilizac?ão de aproximac?ões li-
neares para curvas de produc?ão geram resultados com maiores er-
ros quando comparados aos modelos que fazem uso de aproxima-
c?ões quadráticas. Somado a isso, todos os oito cenários simulados
apresentaram erros entre 6,4% e 11,3%, o que indica que a quanti-
dade de politopos utilizada pode ter sido insuficiente. No entanto,
o uso de fatiamentos maiores pode ocasionar altos custo computaci-
onais para para a soluc?ão do problema de otimizac?ão da produc?ão.

Considerando esses resultados, como perspectivas de traba-
lhos futuros, pode-se propor uma análise do modelo Agregado com
outros fatiamentos do domínio na tentativa de buscar a melhor
relac?ão de custo-benefício entre custo computacional e qualidade
de resultados.

Outro ponto importante é fazer o uso dos modelos Agregado
e Desagregado para outros campos de petróleo além do utilizado



99

como exemplo nessa dissertac?ão. Isso permitirá que se verifique a
eficiência dos modelos propostos de uma forma mais genérica.





REFERÊNCIAS BIBLIOGRÁFICAS

1 FAVARETO, A.; MORALEZ, R. Energia, desenvolvimento e
sustentabilidade. Porto Alegre, RS: Editora Zouk, 2014.

2 AGUIAR, M. A. S.; CAMPONOGARA, E.; SILVA, T. L. A
mixed-integer convex formulation for production optimization of gas-
lifted oil fields with routing and pressure constraints. Brazilian Journal
of Chemical Engineering, v. 31, p. 439–455, 2014.

3 NETO, L. R. et al. A piecewise linear-quadratic approximation for
production optimization of gas-lifted oil fields. Proceedings of the IEEE
International Conference on Automation Science and Engineering (CASE),
p. 793–798, 2015.

4 SILVA, T. L. Formulac?ões inteiras mistas para modelos lineares
por partes multidimensionais: aplicac?ões naotimizac?ão da produc?ão
de petróleo sob restri?cões de pressão. Dissertac?ão (Mestrado) —
Universidade Federal de Santa Catarina, 2012.

5 LUSTOSA, M. C. J. Meio ambiente, inovac?ão e competitividade na
indústria brasileira: a cadeia produtiva do petróleo. Tese (Doutorado) —
Universidade Federal do Rio de Janeiro, 2002.

6 WRIGHT, C. J.; GALLUN, R. A. Fundamentals of oil &amp;amp; gas accounting.
Oklahoma, USA: PennWell Corporation, 2008.

7 ANDRADE, L. F. C. de. Análise de investimentos na cadeia de
suprimentos downstream da indústria petrolífera: proposta de um
modelo de programac?ão linear inteira mista. Dissertac?ão (Mestrado) —
Pontífica Universidade Católica do Rio de Janeiro, 2012.

8 GRIMSTAD, B. Daily production optimization of subsea production
systems. Tese (Doutorado) — Norwegian University of Science and
Technology, 2015.

9 DEVOLD, H. Oil and gas production handbook: an introduction to oil
and gas production, transport, refining and petrochemical industry. Oslo,
Norway: ABB, 2013.

10 HULSE, E. O. Robust production optimization of gas-lifted oil fields.
Dissertac?ão (Mestrado) — Universidade Federal de Santa Catarina,
2015.

11 BRADLEY, H. B.; GIBSON, F. W. Petroleum engineering handbook.
TX, USA: Richardson : Society of Petroleum Engineers, 1987.

101



102 Referências Bibliográficas

12 ALARCÓN, G. A.; TORRES, C. F.; GÓMEZ, L. E. Global
optimization of gas allocation to a group of wells in artificial lift using
nonlinear constrained programming. Journal of Energy Resources
Technology, v. 124, n. 4, p. 262–268, 2002.

13 EIKREM, G. O. Stabilization of gas-lift wells by feedback control.
Tese (Doutorado) — Department of Engineering Cybernetics
Norwegian University of Science and Technology, 2006.

14 MISENER, R.; GOUNARIS, C. E.; FLOUDAS, C. A. Global
optimization of gas lifting operations: a comparative study of piecewise
linear formulations. Industrial &amp;amp; Engineering Chemistry Research, v. 48,
n. 13, p. 6098–6104, 2009.

15 GEIBLER, B. Towards globally optimal solutions for MINLPs
by discretization techniques with applications in gas network
optimization. Tese (Doutorado) — Naturwissenschaftlichen fakultat
der Friedrich-Alexander-Universitat Erlangen-Nurnnberg, 2011.

16 CODAS, A.; CAMPONOGARA, E. Mixed-integer linear optimization
for optimal lift-gas allocation with well-separator routing. European
Journal of Operational Research, v. 217, p. 222–231, 2012.

17 SILVA, T. L.; CODAS, A.; CAMPONOGARA, E. A computational
analysis of convex combination models for multidimensional
piecewise-linear approximation in oil production optimization.
Proceedings of the IFAC Workshop on Automatic Control in Offshore Oil
and Gas Production, Trondheim, Norway, 2012.

18 ROCHA, V. G. da. Estratégias de linearizac?ão por partes adaptativas
com aplicac?ões à atimizac?ão da produc?ão de petróleo e gás. Dissertac?ão
(Mestrado) — Programa de Pós-Graduac?ão em Engenharia de
Automac?ão e Sistemas, UFSC, 2013.

19 BOYD, L. V. S. Convex optimization. [S.l.]: Cambridge University
Press, 2004.

20 LöFBERG, J. YALMIP: A toolbox for modeling and optimization
in matlab. Proceedings of the IEEE International Symposium on
Computer-Aided Control System Design, p. 284–289, 2004.

21 STURM, J. F. Using sedumi 1.02, a matlab toolbox for optimization
over symmetric cones. Optimization Methods and Software, v. 11, p.
625 – 653, 1999.



Referências Bibliográficas 103

22 FOURER, R.; GAY, D. M.; KERNIGHAN, B. W. AMPL A modeling
language for mathematical programming. New York, NY: Thomson
Brooks/Cole, 2003.





APÊNDICE A - CONCEITOS MATEMÁTICOS

COMBINAC?ÕES

Combinac?ão Linear

Uma importante característica de um espac?o vetorial é a obtenc?ão
de vetores a partir de um subconjunto de vetores desse espac?o. Por
exemplo, definindo um vetor \bfu \in \BbbR 3 como \bfu = (2,–1, 3), podemos
obter, a partir de \bfu , qualquer vetor \bfv com a forma \bfv = \alpha \bfu , onde
\alpha \in \BbbR . Assim, um vetor \bfw = (4, -2, 6) pode ser obtido de \bfu quando
\alpha = 2.

Partindo para uma definic?ão formal: seja uma espac?o vetorial
\BbbV , diz-se que um vetor \bfv \in \BbbV é uma combinac?ão linear de vetores
\bfv 1, \bfv 2, . . . , \bfv n \in \BbbV , se existem \alpha 1, \alpha 2, . . . \alpha n \in \BbbR tais que:

\bfv = \alpha 1\bfv 1 + \alpha 2\bfv 2 + . . . + \alpha n\bfv n (1)

Exemplo
O vetor v = (1, 2, 0) \in \BbbR 3 é uma combinac?ão linear de v1 =

(2, 4, 6) e v2 = (3, 6, 10), uma vez que v pode ser definido como
v = 5v1  - 3v2.

Um espac?o vetorial \BbbV é gerado por um conjunto de vetores
\{ \bfv 1, \bfv 2, . . . , \bfv n\} (denota-se \BbbV = [\bfv 1, \bfv 2, . . . , \bfv n]), se qualquer ve-
tor em \BbbV pode ser definido como uma combinac?ão linear desses
vetores. Em outras palavras, para todo \bfv \in \BbbV , existem escalares
\alpha 1, \alpha 2, . . . , \alpha n tais que \bfv = \alpha 1\bfv 1 + \alpha 2\bfv 2 + . . . + \alpha n\bfv n

Combinac?ão Afim

Fazendo \bfP 1 e \bfP 2 serem pontos em um espac?o afim 1, consi-
dere a seguinte expressão:

\bfP = \bfP 1 + t(\bfP 2  - \bfP 1) (2)
1Seja U um conjunto não vazio cujos elementos são pontos. Seja

V um espac?o vetorial. O conjunto U é chamado de espac?o afim
associado ao espac?o V se forem verdadeiros os axiomas:

\bullet Dados um ponto A em U e um vetor v em V , existe apenas um
ponto B tal que v = AB, o qual é o vetor determinado pelo
par (A, B).

\bullet Se v = AB e w = BC, então v + w = AC.

105



106 Apêndice A - Conceitos Matemáticos

Analisando a equac?ão, pode-se perceber que \bfP 2  - \bfP 1 é um
vetor e, por consequência, t(\bfP 2  - \bfP 1) também é. Portanto, \bfP é uma
soma de um ponto com um vetor, o qual é, novamente, um ponto.
Este ponto \bfP representa, em um espac?o afim de pontos e vetores
bidimensionais, um ponto na linha que passa através de \bfP 1 e \bfP 2,
assim como mostrado na Figura 1.

Figura 1: Combinac?ão afim dos pontos P1 e P2, \forall t \in [0, 1].

Nota-se que se 0 \leq t \leq 1 então \bfP está em algum lugar no
segmento de linha que une \bfP 1 e \bfP 2. Esta expressão permite definir
a operac?ão básica sobre pontos. Pode-se utilizar a notac?ão \bfP = (1 - 
t)\bfP 1 + t\bfP 2, a qual representa que \bfP é um ponto definido pela Eq.
(2).

Sendo assim, é possível definir a combinac?ão afim de dois
pontos \bfP 1 e \bfP 2 como:

\bfP = \alpha 1\bfP 1 + \alpha 2\bfP 2 (3)

em que \alpha 1 + \alpha 2 = 1. A Eq. 2 na forma \bfP = (1  - t)\bfP 1 + t\bfP 2 pode
ser obtida fazendo \alpha 2 = t na Eq. (9).

Partindo dessa definic?ão inicial, pode-se agora generalizar
uma combinac?ão afim para um número arbitrário de pontos. Se
\bfP 1, \bfP 2, . . . , \bfP n são pontos e \alpha 1, \alpha 2, . . . , \alpha n são escalares tais que
\alpha 1 + \alpha 2 + . . . + \alpha n = 1, então \alpha 1\bfP 1 + \alpha 2\bfP 2 + . . . + \alpha n\bfP n é definido
como o ponto:

\bfP 1 + \alpha 2(\bfP 2  - \bfP 1) + . . . + \alpha n(\bfP n  - \bfP 1) (4)

Exemplo
Considerando que três pontos \bfP 1, \bfP 2 e \bfP 3 fornecem um tri-

ângulo \bfP 1, \bfP 2, \bfP 3. Tomando um ponto \bfP definido por:

\bfP = \alpha 1\bfP 1 + \alpha 2\bfP 2 + \alpha 3\bfP 3 (5)



Combinac?ões 107

em que \alpha 1 + \alpha 2 + \alpha 3 = 1. Pela definic?ão de combinac?ão afim forne-
cida, um ponto \bfP é caracterizado como:

\bfP = \bfP 1 + \alpha 2(\bfP 2  - \bfP 1) + \alpha 3(\bfP 3  - \bfP 1) (6)

A Figura 2 apresenta o ponto \bfP gerado quando \alpha 1 = \alpha 2 =
1
4

e \alpha 3 =
1
2
.

Figura 2: Triângulo formado por pontos P1, P2 e P3.

Nesse exemplo, caso 0 \leq \alpha 1, \alpha 2, \alpha 3 \leq 1, então o ponto \bfP 
estará dentro ou na borda do triângulo. Se \alpha 1 é menor que zero ou
maior que 1, então o ponto \bfP estará fora do triângulo.

Combinac?ão Cônica

Para um dado número de vetores x1, x2, . . . , xn em um espac?o
real de vetores, a combinac?ão cônica desses vetores é um vetor com
a forma

\alpha 1x1 + \alpha 2x2 + . . . + \alpha nxn (7)

em que os coeficientes reais \alpha i satisfazem \alpha i \geq 0.
O conjunto de todas as combinac?ões para um dado conjunto

S, denominado casco cônico e denotado por cone(S) é definido



108 Apêndice A - Conceitos Matemáticos

como:

cone(S) =

\biggl\{ k\sum 
i=1

\alpha ixi| xi \in S, \alpha i \in \Re , \alpha i \geq 0, i, k = 1, 2, . . .
\biggr\} 

(8)

Por definic?ão, a origem pertence a todos os cascos cônicos e o
casco cônico de um conjunto S é um conjunto convexo. Na verdade,
o casco cônico é a intersecc?ão de todos os cones convexos contendo
S mais a origem.

Combinac?ão Convexa

Dado um conjunto de pontos \bfP 0, \bfP 1, . . . , \bfP n, a combinac?ão
afim desses pontos selecionando \alpha 0, \alpha 1, . . . , \alpha n com \alpha 0 + \alpha 1 + . . . +
\alpha n = 1 tem a seguinte forma:

\bfP = \alpha 0\bfP 0 + \alpha 1\bfP 1 + . . . + \alpha n\bfP n (9)

No entanto, se cada \alpha i tem valor 0 \leq \alpha i \leq 1, então o ponto
\bfP é chamado de combinac?ão convexa dos pontos \bfP 0, \bfP 1, . . . , \bfP n.

Para um exemplo de fácil entendimento, considera-se dois
pontos \bfP 0 e \bfP 1. Qualquer ponto \bfP sobre a linha que passa entre
esses dois pontos pode ser escrito como \bfP = \alpha 0\bfP 0 + \alpha 1\bfP 1, o qual
será uma combinac?ão afim desses dois pontos. A Figura 3 mostra
dois pontos \bfQ e \bfR , os quais são combinac?ões afim dos pontos \bfP 0 e
\bfP 1

No entanto, o ponto \bfQ é uma combinac?ão convexa de \bfP 0 e
\bfP 1, uma vez que 0 \leq \alpha 0, \alpha 1 \leq 1 e \alpha 0 +\alpha 1 = 1, assim como qualquer
ponto que esteja sobre a linha que liga esses dois pontos e entre eles.

Figura 3: Ambos pontos \bfQ e \bfR são combinac?ões afim dos pontos \bfP 0
e \bfP 1, mas somente o ponto \bfQ é combinac?ão convexa deles.



APÊNDICE B - FORMULAC?ÕES ALTERNATIVAS PARA O
PROBLEMA DE PROGRAMAC?ÃO SEMI DEFINIDA

Na Sec?ão 3.2 foi apresentada a seguinte formulac?ão do pro-
blema de programac?ão semi-definida:

CF : \mathrm{m}\mathrm{i}\mathrm{n}
Q,b,c,\epsilon a

i

f =
m\sum 
i=1

\epsilon ai (10a)

sujeito a : qi =
1

2
\bfx \prime iQ\bfx i + b

\prime \bfx i + c, i = 1, . . . , m (10b)

 - \epsilon ai \leq q(\bfx i)  - qi \leq \epsilon 
a
i , i = 1, . . . , m (10c)

Q \preceq 0 (10d)

em que Q \in \BbbR 2\times 2 é uma matriz simétrica negativa semi-definida,
\bfb \in \BbbR 2 \times \BbbR , c \in \BbbR , \bfx i \in [injec?ão de gás \times pressão no manifold] é
um ponto no domínio da func?ão de produc?ão, e q(\bfx i) é o valor da
vazão produzida na WPC no ponto \bfx i obtido no simulador.

A formulac?ão do problema CF, o qual utiliza norma \ell 1, erro
absoluto, pode ser refeita utilizando-se o erro relativo. Para tanto,
basta remodelar a Eq. (10c) da seguinte forma:

 - \epsilon reli \leq 
q(\bfx i)  - qi

qi
\leq \epsilon reli (11)

Tratando-se da formulac?ão do problema com a variac?ão da
norma, para uma implementac?ão com norma \ell \infty , basta fazer a rela-
c?ão de equivalência mostrada na Eq. (12). Como se pode observar,
é necessária a introduc?ão de uma variável adicional \alpha , a qual repre-
senta o maior erro.

\mathrm{m}\mathrm{i}\mathrm{n} \| \epsilon \| 2 \equiv \mathrm{m}\mathrm{i}\mathrm{n} \alpha 
sujeito a: \epsilon i \leq \alpha , \forall i \in \{ 1, . . . , m\} 

(12)

Para a implementac?ão do problema com norma \ell 2 são feitas
as equivalências apresentadas na Eq. (13):

\mathrm{m}\mathrm{i}\mathrm{n} \| \epsilon \| 2 \equiv \mathrm{m}\mathrm{i}\mathrm{n} \| \epsilon \| 22 \equiv \mathrm{m}\mathrm{i}\mathrm{n}
m\sum 
i=1

(\epsilon i)
2 (13)

Como se pode observar, nesse caso, existe a inconveniência
de se utilizar uma func?ão quadrática no objetivo. Entretanto, como
forma alternativa, pode-se adicionar um vetor de variáveis \sigma \in \Re m

109



110
Apêndice B - Formulac?ões Alternativas para o problema de

programac?ão semi definida

ao problema, o qual representa o erro quadrático a partir da adic?ão
de uma restric?ão (\epsilon i)2 \leq \sigma i, \forall i \in \{ 1, . . . , m\} .

Ainda assim, por ser uma restric?ão quadrática, a qual não
é comportada pelo SDP, pode-se reeditar essa restric?ão como um
conjunto de desigualdades matriciais lineares por meio do Comple-
mento de Schur, obtendo-se o sistema representado pelas Eq. (14).

\mathrm{m}\mathrm{i}\mathrm{n}
m\sum 
i=1

\sigma i (14a)

sujeito a :
\biggl[ 

I \epsilon i
(\epsilon i)

T \sigma i

\biggr] 
\preceq 0, \forall i \in \{ 1, . . . , m\} (14b)

Exemplos
A partir das definic?ões utilizadas para o erro relativo e utiliza-

c?ão das normas \ell \infty e \ell 2 são apresentadas algumas formulac?ões as
quais exemplificam a utilizac?ão desses parâmetros nos problemas
de programac?ão semi definida para estimac?ões côncavas das curvas
de produc?ão de petróleo.

\bullet Estimac?ão com erro relativo e norma \ell 1

CF2 : \mathrm{m}\mathrm{i}\mathrm{n}
Q,b,c,\epsilon rel

i

f =
m\sum 
i=1

\epsilon reli (15a)

sujeito a : qi =
1

2
\bfx \prime iQ\bfx i + b

\prime \bfx i + c, i = 1, . . . , m (15b)

 - \epsilon reli \leq 
q(\bfx i)  - qi

qi
\leq \epsilon reli (15c)

Q \preceq 0 (15d)



111

\bullet Estimac?ão com erro relativo e norma \ell \infty 

CF3 : \mathrm{m}\mathrm{i}\mathrm{n} \alpha (16a)

sujeito a : qi =
1

2
\bfx \prime iQ\bfx i + b

\prime \bfx i + c, i = 1, . . . , m (16b)

 - \epsilon reli \leq 
q(\bfx i)  - qi

qi
\leq \epsilon reli (16c)

\epsilon reli \leq \alpha , \forall i \in \{ 1, . . . , m\} (16d)
Q \preceq 0 (16e)

\bullet Estimac?ão com erro absoluto e norma \ell 2

CF4 : \mathrm{m}\mathrm{i}\mathrm{n}
m\sum 
i=1

\sigma i (17a)

sujeito a : qi =
1

2
\bfx \prime iQ\bfx i + b

\prime \bfx i + c, i = 1, . . . , m (17b)

 - \epsilon ai \leq q(\bfx i)  - qi \leq \epsilon 
a
i , i = 1, . . . , m (17c)\biggl[ 

I \epsilon i
(\epsilon i)

T \sigma i

\biggr] 
\preceq 0, \forall i \in \{ 1, . . . , m\} (17d)

Q \preceq 0 (17e)


	Resumo
	Abstract
	Lista de Figuras
	Lista de Tabelas
	Sumário
	Introdução
	Descrição do Problema
	Objetivos
	Objetivo Geral do Trabalho
	Objetivos Específicos

	Estrutura do documento

	Fundamentos e Definições
	Cadeia Produtiva do Petróleo
	Sistemas Típicos de Produção de Petróleo
	Métodos de Elevação Artificial
	Eleveção artificial por injeção contínua de gás – gas-lift

	Definição do Problema
	Revisão de Literatura
	Sumário

	Modelos Quadráticos para Otimização da Produção
	Introdução a Modelos Quadráticos Convexos
	Conjuntos Convexos
	Funções Convexas
	Modelos Quadráticos Convexos

	Síntese de Curvas
	Modelos Quadráticos Por Partes para Otimização da Produção
	Modelo Agregado
	Modelo Desagregado
	Demonstração de Equivalência

	Sumário

	Análises dos Resultados
	Cenário Experimental
	Síntese de Aproximação de Curvas 
	Análise das aproximações de curvas de produção
	Análise das aproximações de curvas de queda de pressão

	Análise Computacional
	Análise de Simulação
	Sumário

	Conclusão
	Referências Bibliográficas
	Apêndice A - Conceitos Matemáticos
	Combinações
	Combinação Linear
	Combinação Afim
	Combinação Cônica
	Combinação Convexa


	Apêndice B - Formulações Alternativas para o problema de programação semi definida

</field>
	</doc>
</add>