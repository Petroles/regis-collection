<?xml version="1.0" encoding="utf-8"?>
<add>
	<doc>
		<field name="docid">BR-TU.09342</field>
		<field name="filename">14325_2010001038.pdf</field>
		<field name="filetype">PDF</field>
		<field name="text">Universidade de Aveiro
2009
Departamento de Electrónica, Telecomunicações e Informática
Vítor Morgado Ribeiro
Eolitor: Sistema de geração eólica
monitorização em micro-
Vítor Morgado Ribeiro
Eolitor: Sistema de monitorização em micro-geração eólica
Dissertação apresentada à Universidade de Aveiro para cumprimento dos requisitos necessários à obtenção do grau de Mestre em Engenharia Electrónica e de Telecomunicações (Mestrado Integrado), realizada sob a orientação científica do Prof. Doutor João Paulo Cunha - Professor Associado do Departamento de Electrónica, Telecomunicações e Informática da Universidade de Aveiro e do Prof. Doutor Bernardo Cunha - Professor Auxiliar do Departamento de Electrónica, Telecomunicações e Informática da Universidade de Aveiro.
Universidade de Aveiro
Universidade de Aveiro
ii
Universidade de Aveiro
iv
o júri
presidente	Prof. Doutor Dinis Gomes Magalhães Santos Professor Catedrático da Universidade de Aveiro
vogal arguente	Prof. Doutor Luís Paulo Gonçalves dos Reis Professor Auxiliar da Faculdade de Engenharia da Universidade do Porto
vogal orientador	Prof. Doutor João Paulo Trigueiros da Silva Cunha Professor Associado da Universidade de Aveiro
vogal co-orientador	Prof. Doutor Manuel Bernardo Salvador Cunha Professor Auxiliar da Universidade de Aveiro
Universidade de Aveiro
vi
Aos Professores João Paulo Cunha e Bernardo Cunha pela orientação em todo o processo de elaboração deste trabalho;
Ao colega David Ribeiro por toda a disponibilidade, colaboração e sugestões apresentadas;
Aos meus Pais e Avós por toda a força que obtive deles;
Aos meus Irmãos por estarem sempre presentes;
À minha namorada por toda a paciência, apoio e ajuda;
Por último, aos meus amigos Pedro Gaspar, Ricardo Matos, Rui Rebelo, Marco Oliveira, Nelson Medina e Nuno Balula por toda a amizade e estima;
agradecimentos
Universidade de Aveiro
viii
Nos últimos anos tem ocorrido um aumento gradual do interesse na utilização de fontes renováveis para a produção de energia eléctrica. Uma das razões principais em destaque foi a necessidade de encontrar alternativas que ajudem a reduzir a dependência dos combustíveis fósseis, devido á sua limitação física, o seu elevado custo, e por serem muito poluentes. Na base desta mudança de paradigma estão os graves problemas ambientais causados pela emissão de gases de efeito de estufa e a grave crise energética de petróleo e seus derivados.
As energias renováveis são um novo auxílio no combate ao aquecimento global. A instalação de sistemas produtores de energia eléctrica a partir de fontes renováveis tem aumentado, tanto a nível doméstico, sob a forma de pequenos sistemas de produção de energia, mas sobretudo a nível industrial com a instalação de parques eólicos capazes de gerarem quantidades abundantes de MW.
O sistema Eolitor surgiu da necessidade de monitorizar o comportamento de um Aerogerador de pequeno porte instalado pela Universidade de Aveiro no seu campus universitário. Esta iniciativa foi concebida de acordo com as necessidades actuais da sociedade, e tem como objectivo verificar a viabilidade de produção de energia eólica no âmbito da Investigação e Desenvolvimento da temática Energias Renováveis.
palavras-chave resumo
Universidade de Aveiro
x
keywords	Renewable Energy, Wind Energy, Wind Generators, Micro-Wind Generation, Sensors, Monitoring.
abstract	In recent times it has occurred a gradual increase of interest in the use of renewable sources to obtain electricity. One of the main reasons to use those types of sources was the necessity to found solutions that help to replace fossil fuels, because they are physically limited, expensive, and cause high levels of pollution. Behind this change are the serious environmental problems caused by emission of gases resulting from the greenhouse effect, and the severe energy crisis of petroleum and its derivatives. Renewable energy is the new way to fight against global warming. The installation of electric energy-producing systems from renewable sources has increased both at home through small power systems, but especially at industrial level through the installation of wind farms with capacity of production many MW of energy. Eolitor system arose with the need to monitor the behavior of a small wind turbine, installed at the University of Aveiro. This initiative is designed to meet the needs of today's society, with the aim to assess the feasibility of wind generation, under the Research and Development of Renewable Energies issue.
Universidade de Aveiro
xii
Sumário
Índice de Figuras	4
Índice de Diagramas	6
Índice de Tabelas	7
Índice de Equações	9
Capítulo 1 - Introdução	11
1.1.	Objectivos	11
1.1.1.	Objectivos Específicos	11
1.2.	Motivação	11
1.3.	Estrutura da Dissertação	12
Capítulo 2 - Revisão da Literatura	15
2.1.	Introdução	15
2.2.	Energia Mundial	15
2.3.	Protocolo de Quioto, Japão	16
2.4.	Energias Renováveis	17
2.5.	Energia Eólica	18
2.5.1.	Vento - Fonte Natural Renovável	19
2.5.2.	Panorama Actual	27
2.5.3.	Aspectos Económicos da Energia Eólica	34
2.6.	Aerogeradores	35
2.6.1.	Tipos de Aerogeradores	37
2.6.2.	Dimensões dos Aerogeradores	40
2.6.3.	Componentes de um Aerogerador	41
2.6.4.	Mecanismos de controlo	43
2.6.5.	Impacto Ambiental	46
2.7.	Sistema Eólico	48
2.7.1.	Sistema de Armazenamento de Energia	48
2.7.2.	Aplicações dos Sistemas Eólicos	49
2.7.3.	Sistemas em "Offshore"	50
Capítulo 3 - Modelação do Sistema Eolitor	51
3.1.	Introdução	51
3.1.1.	Visão geral do sistema	51
3.1.2.	Âmbito	52
3.1.3.	Cliente	53
3.1.4.	Fontes e material de referência	53
3.2.	Modelo de caso de utilização	54
3.2.1.	Visão geral	54
3.2.2.	Actores	54
3.3.	Especificação Suplementar	62
3.3.1.	Funcionalidades Comuns	62
3.3.2.	Requisitos de Usabilidade	62
3.3.3.	Requisitos de desempenho	63
3.3.4.	Requisitos de Segurança e integridade de dados	63
3.3.5.	Requisitos de interface com sistemas externos e com ambientes de execução	64
3.3.6.	Requisitos de Hardware	64
3.4.	Modelo do Domínio	65
3.5.	Protótipo Exploratório	66
3.5.1.	Arquitectura aplicacional	66
3.5.2.	Arquitectura de Instalação	67
3.5.3.	Protótipos dos Produtos	67
3.6.	Plano de Implementação do Projecto	80
3.7.	Modelo de Dados Persisten te	81
3.7.1.	Dicionário de dados	81
Capítulo 4 - Eolitor - Sistema de Monitorização	83
4.1.	Introdução	83
4.2.	Aerogerador 20kW	84
4.3.	Sensores	86
4.3.1.	Sensor de Velocidade do Vento (Anemómetro)	86
4.3.2.	Sensor de Direcção do Vento	87
4.3.3.	Bússola Magnética	88
4.3.4.	Sensor de Temperatura	89
4.3.5.	Sensor de Rotação	89
4.3.6.	Sensor de Corrente	91
4.4.	Arquitectura do Sistema	93
4.5.	Tecnologias Implementadas	96
4.6.	Processamento de Tramas - Envio	97
4.7.	Módulo de Armazenamento de Dados Local	100
4.8.	Sistema de Alimentação	102
4.8.1.	Regulador de Tensão	105
4.8.2.	Carregador de Baterias Lithium	105
4.8.3.	Charge Pump	106
4.8.4.	Supervisor	107
4.9.	Ligação Wireless	108
4.9.1.	Bluetooth	108
4.9.2.	ZigBee	109
4.10.	Eolitor Server	112
4.10.1.	Servidor TCP	112
4.10.2.	Processamento de Tramas - Recepção	114
Capítulo 5 - Eolitor - Sistema de Informação	117
5.1.	Introdução	117
5.2.	Arquitectura do Sistema	118
5.3.	Tecnologias Implementadas	119
5.3.1.	Microsoft Visual Studio	119
5.3.2.	Visual Basic.Net	120
5.3.3.	C#	121
5.3.4.	MS SQL Server 2005	121
5.4.	Processamento de Dados	124
5.5.	Interface Visual	125
5.5.1.	Home	127
5.5.2.	Monitor	127
5.5.3.	Connection to Database	128
5.5.4.	Eolitor Database	129
5.5.5.	Eolitor DB Charts	130
5.5.6.	Emailer	131
5.5.7.	^SD Terminal	132
5.6.	Instalação e Execução do Programa	133
5.7.	Instalação da Base de Dados	134
5.8.	Eolitor - Web Page	135
Capítulo 6 - Resultados	137
6.1.	Sistema de Monitorização	137
6.2.	Sistema de Informação	138
Capítulo 7 - Comentários Finais	145
7.1.	Conclusões	145
7.1.1.	Base de Dados	145
7.1.2.	Sistema de Monitorização	145
7.1.3.	Sistema de Informação	146
7.2.	Desenvolvimentos Futuros	147
Bibliografia	149
ANEXO A - Parques Eólicos em "offshore"	153
ANEXO B - Relatório de Especificação de Requisitos	161
ANEXO C - Módulo do Sistema de Ficheiros FatFS	175
ANEXO D - Projectos Visual Studio	179
ANEXO E - PCB do Sistema de Monitorização	190
ANEXO F - Programa do Sistema de Monitorização	199
Índice de Figuras
Figura 2.1 - Moinho Holandês	21
Figura 2.2 - Mapa Europeu de Vento a 50 metros	23
Figura 2.3 - Mapa Europeu de Vento em “offshore”	24
Figura 2.4 - Características Eléctricas do Sistema Eólico	26
Figura 2.5 - Sensor de direcção e Anemómetro	26
Figura 2.6 - Anemómetro ultra sónico	27
Figura 2.7 - Capacidade de Energia Eólica na EU no final de 2007 [EWEA]	30
Figura 2.8 - Capacidade de Energia Eólica dos estados membros da EU-27 até ao final de 2007 [EWEA]	30
Figura 2.9 - Capacidade de Energia Eólica dos estados membros da EU-27 durante 2007 [EWEA]
31 Figura 2.10 - Capacidade de Energia Eólica global 1990-2007 (em MW)	32
Figura 2.11 - Capacidade de Energia Eólica anual 1990-2007 (em MW)	32
Figura 2.12 - Capacidade anual de instalação de Energia Eólica por região 2003-2007 [GWEC] 34 Figura 2.13 - Aerogerador inventado por Charles Brush	35
Figura 2.14 - Aerogeradores descobertos por Poul la Cour	36
Figura 2.15 - Aerogerador de Gedser	36
Figura 2.16 - Relação potência x tamanho dos Aerogeradores [EWEA] [11]	37
Figura 2.17 - Aerogerador Darrieus e Savonius, respectivamente	39
Figura 2.18 - Aerogerador de 3 pás e eixo horizontal	40
Figura 2.19 - Componentes de um Gerador Eólico NORDEX N54 [1]	41
Figura 2.20 - Curvas de potência: pitch (Bonus) e stall (NEG e Nordex) [DanishAssoc]	45
Figura 2.21 - Ângulo de yaw	46
Figura 2.22 - Aerogerador em "offshore"	50
Figura 3.1 - Modelo do Domínio do Sistema	65
Figura 3.2 - Eolitor Server	68
Figura 3.3 - Eolitor System - Home	68
Figura 3.4 - Eolitor System - Monitor	69
Figura 3.5 - Eolitor System - SQL Database	69
Figura 3.6 - Eolitor System - pSD Terminal	70
Figura 3.7 - Eolitor System - Options	70
Figura 3.8 - Eolitor System - Emailer	71
Figura 3.9 - Eolitor System - Connection to Database	71
Figura 3.10 - Eolitor System - Database Charts	72
Figura 3.11 - Eolitor System - Logs	72
Figura 3.12 - Eolitor System - Reports	73
Figura 3.13 - Eolitor System - Box	79
Figura 3.14 - Eolitor System - PCB	79
Figura 3.15 - Modelo da base de dados	81
Figura 4.1- Aerogerador de 20kW instalado perto do IEETA	84
Figura 4.2 - Gráfico da curva de potência (em condições óptimas) do Aerogerador de 20 kW, potência de saída (kW) em função da velocidade do vento (m/s) [48]	85
Figura 4.3 - Anemómetro	87
Figura 4.4 - Sensor de Direcção	88
Figura 4.5 - Bússola Magnética Módulo HM55B [Parallax]	88
Figura 4.6 - Circuito de ligação e sinal de saída do módulo [Parallax]23	88
Figura 4.7 - Sensor de temperatura MAX6608 [Maxim]	89
Figura 4.8 - Efeito de Hall	90
Figura 4.9 - Sensor de Rotação efeito de Hall [Hamlin]	90
Figura 4.10 - Bloco de diagrama e exemplo de aplicação (Geartooth)	91
Figura 4.11 - Princípio de funcionamento dos sensores	91
Figura 4.12 - Sensor de Corrente efeito de Hall [Tamura]	92
Figura 4.13 - Resposta em Tensão do Sensor L01Z [Tamura]27	92
Figura 4.14 - Resposta em Frequência do Sensor L01Z [Tamura]27	92
Figura 4.15 - Arquitectura de montagem do Sistema de Monitorização	95
Figura 4.16 - Programador de Microcontroladores ICD2 [Microchip]	97
Figura 4.17 - Frequência de processamento de tramas	99
Figura 4.18 - Módulo Armazenamento Local	100
Figura 4.19 - Sistema de Alimentação remoto	104
Figura 4.20 - Sistema de Alimentação local	104
Figura 4.21 - Diagrama de Blocos do TL2575-05 [TI]	105
Figura 4.22 - Perfil de carregamento típico [TI]	106
Figura 4.23 - Diagrama de Blocos do Charge Pump TPS60130 [TI]	107
Figura 4.24 - Diagrama de Blocos do ADM696 [Analog Devices]	108
Figura 4.25 - Topologia em estrela (star)	110
Figura 4.26 - Topologia malha (mesh)	110
Figura 4.27 - Topologia árvore (cluster tree)	110
Figura 4.28 - Posição das várias tecnologias wireless	111
Figura 4.29 - Lista de mensagens que são trocadas entre Servidor/Cliente	113
Figura 4.30 - Rede Servidor/Cliente do projecto Eolitor	114
Figura 5.1 - Microsoft Visual Studio 2008	119
Figura 5.2 - Arquitectura do LINQ	120
Figura 5.3 - Principais componentes do SQL Server 2005	122
Figura 5.4 - Opções do	interface Eolitor System - Home	127
Figura 5.5 - Opções do	interface Eolitor System - Monitor	128
Figura 5.6 - Opções do	interface Eolitor System - Connectionto Database	129
Figura 5.7 - Opções do	interface Eolitor System - SQL Database	130
Figura 5.8 - Opções do	interface Eolitor System - Database Charts	131
Figura 5.9 - Opções do	interface Eolitor System - Emailer	132
Figura 5.10 - Opções do interface Eolitor System - Terminal	132
Figura 5.11 - Executável de instalação do Programa Eolitor	133
Figura 5.12 - Executável de instalação da base de dados EolitorDB	134
Figura 6.1 - Programa Servidor Eolitor Server em execução	137
Figura 6.2 - Interface Monitor do Programa Eolitor System em execução, recepção da monitorização do comportamento do tempo	138
Figura 6.3 - Interface Database Charts do Programa Eolitor System em execução, variável Wind
Speed e tipo de gráfico Line	139
Figura 6.4 - Interface Database Charts do Programa Eolitor System em execução, variável Wind
Dir e tipo de gráfico Radar	139
Figura 6.5 - Interface Database Charts do Programa Eolitor System em execução, variável
Temperature e tipo de gráfico Combo	140
Figura 6.6 - Interface Reports do Programa Eolitor System em execução, Info Report	140
Figura 6.7 - Interface Logs do Programa Eolitor System em execução	141
Figura 6.8 - Interface Web Browser do Programa Eolitor System em execução, página Web do
Projecto Eolitor	141
Figura 6.9 - Guia de Início Rápido de suporte aos programas do projecto Eolitor	142
Figura 6.10 - Guia de Início Rápido de suporte aos programas do projecto Eolitor, interface
Monitor do programa Eolitor System	143
Figura A.1 - Desenvolvimento da energia eólica "offshore" na UE 1998-2008 e previsão até 2030 [EWEA]	159
Figura A.2- Total de energia eólica "offshore" instalada até Novembro 2008 [EWEA]	160
Figura A.3 - Total de energia eólica "offshore" prevista até 2015 [EWEA]	160
Figura C.4 - Ligações dos cartões MMC / SD	175
Figura C.5 - Camadas do Modulo de Sistema de Ficheiros	176
Figura D.6 - Projecto Microsoft Visual Studio	179
Figura D.7 - Projecto DBI	179
Figura D.8 - Projecto Eolitor Client	180
Figura D.9 - Projecto Eolitor Server	181
Figura D.10 - Projecto TCPServer	182
Figura D.11 - Projecto Eolitor System	183
Figura D.12 - Projecto Setup	189
Índice de Diagramas
Diagrama 3.1 - Diagrama do Âmbito do Projecto	52
Diagrama 3.2 - Diagrama de Pacotes	54
Diagrama 3.3 - Diagrama de CaU do Administrador e de um Utilizador	56
Diagrama 3.4 - Diagrama de CaU do Técnico Instalador	57
Diagrama 3.5 - Diagrama de CaU de Técnico de Manutenção	57
Diagrama 3.6 - Diagrama da Arquitectura Aplicacional	66
Diagrama 3.7 - Diagrama de instalação	67
Diagrama 4.1 - Diagrama de processamento de tramas - Envio	99
Diagrama 4.2 - Diagrama Armazenamento de dados Local	101
Diagrama 4.3 - Diagrama do Sistema de Alimentação remoto	104
Diagrama 4.4 - Diagrama do Sistema de Alimentação local	104
Diagrama 4.5 - Diagrama do carregador de baterias	107
Diagrama 4.6 - Diagrama do supervisor ADM696	107
Diagrama 4.7 - Diagrama de Estados do Servidor TCP	112
Diagrama 4.8 - Diagrama de processamento de tramas - Recepção	115
Diagrama 5.1 - Diagrama da arquitectura do Sistema de Informação	118
Diagrama 5.2 - Estrutura do Programa	125
Índice de Tabelas
Tabela 2.1 - Capacidade de Energia Eólica na EU no final de 2008 [EWEA]	29
Tabela 2.2 - Capacidade de Energia Eólica em África e Médio Oriente no final de 2007 [GWEC] 33 Tabela 2.3 - Capacidade de Energia Eólica na Ásia no final de 2007 [GWEC]	33
Tabela 2.4 - Capacidade de Energia Eólica na América do Sul no final de 2007 [GWEC]	33
Tabela 2.5 - Capacidade de Energia Eólica em América do Norte no final de 2007 [GWEC]	33
Tabela 2.6 - Capacidade de Energia Eólica na região do Pacífico no final de 2007 [GWEC]	33
Tabela 3.1 - Tabela de descrição dos Actores do Sistema	56
Tabela 3.2 - Tabela de descrição do CaU1 Instalar Sensores	58
Tabela 3.3 - Tabela de descrição do CaU2 Criar Sistema de Monitorização	58
Tabela 3.4 - Tabela de descrição do CaU3 Projectar Base de Dados	59
Tabela 3.5 - Tabela de descrição do CaU4 Criar Sistema de Informação	59
Tabela 3.6 - Tabela de descrição do CaU5 Registar novo Aerogerador	59
Tabela 3.7 - Tabela de descrição do CaU6 Monitorização	60
Tabela 3.8 - Tabela de descrição do CaU7 Envio dos Dados	60
Tabela 3.9 - Tabela de descrição do CaU8 Visualizar desempenho do Sistema (Dados e Eventos)
61 Tabela 3.10 - Tabela de descrição do CaU9 Pedir relatório de Produção	61
Tabela 3.11 - Tabela de Requisitos de Usabilidade	62
Tabela 3.12 - Tabela de Requisitos de Desempenho	63
Tabela 3.13 - Tabela de Requisitos de segurança, privacidade e integridade de dados	63
Tabela 3.14 - Tabela de Requisitos de interface com sistemas externos e com ambientes de execução	64
Tabela 3.15 - Tabela de prioridades dos CaU	80
Tabela 4.1 - Parâmetros do Aerogerador de 20kW [48]	85
Tabela 4.2 - Estrutura da Trama	98
Tabela 4.3 - Identificadores dos dados da Trama	98
Tabela 4.4 - Funções dos Módulos de acesso ao Disco I/O e RTCC	102
Tabela 4.5 - Funções do Sistema de Ficheiros FatFS	102
Tabela 4.6 - Alcance e potência máxima das diferentes Classes Bluetooth	109
Tabela 4.7 - ZigBee vs Bluetooth	111
Tabela 4.8 - ZigBee vs Bluetooth	111
Tabela A.1 - Energia Eólica	em “Offshore" instalada na Bélgica [EWEA]	153
Tabela A.2 - Energia Eólica	em “Offshore" instalada na Dinamarca [EWEA]	154
Tabela A.3 - Energia Eólica	em “Offshore" instalada no Reino Unido [EWEA]	155
Tabela A.4 - Energia Eólica	em “Offshore" instalada na Holanda [EWEA]	156
Tabela A.5 - Energia Eólica	em “Offshore" instalada na Suécia [EWEA]	156
Tabela A.6 - Energia Eólica	em “Offshore" instalada na Irlanda [EWEA]	157
Tabela A.7 - Energia Eólica	em “Offshore" instalada na Noruega [EWEA]	157
Tabela A.8 - Energia Eólica	em “Offshore" instalada na Itália [EWEA]	157
Tabela A.9 - Energia Eólica	em “Offshore" instalada na Alemanha[EWEA]	159
Tabela B.10 - Tabela de descrição do CaU10 Orçamentar Sistema Eólico.	161
Tabela B.11 - Tabela de descrição do CaU11 Vender Sistema Eólico.	161
Tabela B.12 - Tabela de descrição do CaU12 Contratar Responsável Instalação.	162
Tabela B.13 - Tabela de descrição do CaU13 Estudo do local de Instalação	162
Tabela B.14 - Tabela de descrição do CaU14 Instalar Sistema Eólico.	162
Tabela B.15 - Tabela de descrição do CaU15 Documentação do Sistema Eólico.	163
Tabela B.16 - Tabela de descrição do CaU16 Verificar funcionamento do Sistema Eólico. 163 Tabela B.17 - Tabela de descrição do CaU17 Registar novo Parque Eólico.	164
Tabela B.18 - Tabela de descrição do CaU18 Registar novo Modelo de Aerogerador.	164
Tabela B.19 - Tabela de descrição do CaU19 Gerir comportamento do Parque Eólico.	164
Tabela B.20 - Tabela de descrição do CaU19 Gerir Sistema de Monitorização e Base de Dados.
165
Tabela B.21 - Tabela de descrição do CaU21 Desenvolvimento do Sistema de Monitorização. 165
Tabela B.22 - Tabela de descrição do CaU22 Desenvolvimento do Sistema de Informação. 166
Tabela B.23 - Tabela de descrição do CaU23 Pedir/Contratar Manutenção do Sistema.	166
Tabela B.24 - Tabela de descrição do CaU24 Fazer Manutenção do Sistema.	167
Tabela B.25 - Tabela de descrição do CaU25 Recepção dos Dados.	167
Tabela B.26 - Tabela de descrição do CaU26 Tratamento dos Dados.	167
Tabela B.27 - Tabela de descrição do CaU27 Armazenar os Dados.	168
Tabela B.28 - Tabela de descrição do CaU28 Disponibilizar os Dados.	168
Tabela B.29 - Dicionário de Dados	-	Entidade WindFarms	169
Tabela B.30 - Dicionário de Dados -	Entidade Aeros	169
Tabela B.31 - Dicionário de Dados	-	Entidade Models	169
Tabela B.32 - Dicionário de Dados	-	Entidade Manufactures	170
Tabela B.33 - Dicionário de Dados	-	Entidade SellEnergy	170
Tabela B.34 - Dicionário de Dados	-	Entidade Meteo	170
Tabela B.35 - Dicionário de Dados	-	Entidade Productions	171
Tabela B.36 - Dicionário de Dados	-	Entidade Payments	171
Tabela B.37 - Dicionário de Dados	-	Entidade Interruptions	171
Tabela B.38 - Dicionário de Dados	-	Entidade Maintenances	172
Tabela B.39 - Dicionário de Dados	-	Entidade Companies	172
Tabela B.40 - Dicionário de Dados	-	Entidade Pieces	172
Tabela B.41 - Dicionário de Dados	-	Entidade ModelPiece	173
Tabela B.42 - Dicionário de Dados	-	Entidade Logs	173
Tabela B.43 - Dicionário de Dados	-	Entidade StatisticsAeros	173
Tabela B.44 - Dicionário de Dados	-	Entidade StatisticsMeteo	174
Tabela C.45 - Lista de Comandos	177
Índice de Equações
Equação 2.1 - Potência do vento	22
Equação 4.1 - Velocidade do Vento	87
Equação 4.2 - Velocidade do Vento	em função de n	87
Equação 4.3 - Valor da ADC para o	sensor de Direcção	87
Equação 4.4 - Valor da ADC para o	sensor de Temperatura	89
Equação 4.5 - Valor da ADC para o	sensor de Corrente	92
Universidade de Aveiro
10
Capítulo 1 - Introdução
1.1.	Objectivos
O objectivo desta dissertação é a criação e instalação de um sistema que permita a monitorização de um Aerogerador e o armazenamento de toda a informação inerente ao estado do tempo (velocidade e direcção do vento) e ao comportamento do aparelho, por forma a que essa informação venha a estar disponível para posteriores consultas.
1.1.1.	Objectivos Específicos
Os objectivos específicos deste trabalho são:
-Concepção e desenvolvimento de um conjunto de sensores;
-Monitorização do estado do tempo medindo a velocidade e a direcção;
-Monitorização do estado do Aerogerador influenciado pelo vento, medindo a velocidade de rotação das pás, a direcção do Aerogerador e a quantidade de energia produzida;
-Comunicação com um sistema de informação;
-Envio da informação para uma unidade central de processamento que recebe essa informação, efectua o tratamento da mesma e por fim a armazena;
-Visualização e consulta do estado actual do vento e aerogerador num interface gráfico;
-Consulta do histórico da informação armazenada localmente e remotamente.
1.2.	Motivação
As energias renováveis são cada vez mais importantes no combate ao aquecimento global e à poluição ambiental. Destas energias a Eólica é uma das mais desenvolvidas e mais utilizadas em todo o mundo [2] [5] [6], desde a instalação de parques eólicos com capacidade de produção de grandes quantidades de MW e a produção de energia eléctrica doméstica produzida por micro geradores eólicos. A exploração deste tipo de energia é cada vez maior e Portugal encontra-se bem posicionado na lista dos maiores produtores de energia eólica do mundo.
Esta tese enquadra-se nos projectos de inovação, que têm aumentado a par das grandes preocupações correntes, influenciadas pela grave crise energética actual e pelo aumento substancial dos gases propagados provocando efeito de estufa, que estão a afectar significativamente o equilíbrio dos ecossistemas. No âmbito do combate a esta problemática torna-se necessário o contributo de todas as pessoas, e a consciencialização das mesmas acerca dos problemas actuais.
A escolha desta tese pelo autor foi precisamente o facto de esta se enquadrar no desenvolvimento e inovação de sistemas de micro geração com base na energia eólica,
porque se a produção deste tipo de energia aumentar, a dependência das energias não renováveis, especialmente o petróleo e seus derivados vai diminuir. A exploração deste tipo de energia tem sido evidente nos últimos anos. No entanto a energia eléctrica produzida continua a ser obtida essencialmente por empresas de exploração privadas. A utilização de micro-aerogeradores domésticos ainda não é uma realidade consolidada.
Para além da exploração desta energia estar relacionada com as preocupações actuais, os pré-requisitos a nível de conhecimento para a realização da mesma são igualmente motivadores. Isto deve-se à grande diversificação de conteúdos, para poder desenvolver e explorar novos conhecimentos. Desde a electrónica de baixo nível, com a criação de placas impressas (do esquema do projecto ao desenho final, e soldadura dos circuitos integrados), à programação do microcontrolador, até ao desenvolvimento de software utilizando as mais avançadas ferramentas disponíveis, para a implementação de um programa que proporciona a interacção com o utilizador; e ainda a criação de uma base de dados de suporte a todo o sistema em questão.
1.3.	Estrutura da Dissertação
A dissertação está organizada em 7 capítulos e 6 anexos.
O capítulo 1 - Introdução, insere uma breve apresentação da dissertação. Nos subcapítulos, o autor expõe os objectivos genéricos da dissertação, apresentando as motivações que estiveram na base da escolha deste tema e os desenvolvimentos importantes para a realização dos objectivos. O capítulo é finalizado com estrutura da Dissertação, que contém um resumo dos capítulos que a constituem.
O capítulo 2 - Revisão da Literatura, apresenta o enquadramento teórico da tese estruturado em vários subcapítulos: uma breve Introdução, Energia Mundial, Protocolo de Quioto, Japão, Energias Renováveis, Energia Eólica, Aspectos Económicos da Energia Eólica, Aerogeradores, e Sistema Eólico. Na Introdução é feita uma pequena descrição do mesmo, começando por enquadramento do estado actual da energia no subcapítulo seguinte. É feita uma referência ao Protocolo de Quioto, Japão explicando a sua importância constituindo um ponto de viragem especialmente para a produção das Energias Renováveis. No subcapítulo Energia Eólica, o tipo de energia central na presente dissertação, é explicada de forma mais pormenorizada começando por referenciar as primeiras utilizações, até ao panorama actual, passando pelos seus elementos básicos, como o vento e as suas características que são extremamente importantes para a produção de energia eléctrica. Os aspectos mais técnicos do elemento central são detalhados no ponto Aerogeradores, onde é feita uma classificação quanto ao tipo e ao tamanho, incluindo todas as suas componentes, e os vários mecanismos de controlo. Em Sistema Eólico, são referenciadas as várias aplicações da energia eólica, incluindo os sistemas "offshore" que estão a ser instalados em grande escala. Em suma, neste capítulo é feito um enquadramento do que motivou a produção de energias renováveis, bem como o estado actual das mesmas, principalmente a energia eólica, passando depois à exposição das principais aplicações e componentes necessários à produção de energia eléctrica a partir do vento.
No capítulo 3 - Modelação do Sistema Eolitor, é descrito todo o sistema em linguagem UML (Unified Modeling Language) utilizando o método SLiM do grupo SIAS. Inicia-se com uma breve Introdução, a visão geral do sistema, respondendo às perguntas para quê, e para quem se destina o sistema. No subcapítulo seguinte são expostos os Casos de Utilização do sistema pelos vários utilizadores. Para cada caso de utilização é especificado o âmbito, a finalidade, os utilizadores (Actores), as pré-condições, e os aspectos em aberto. No subcapítulo Especificação Suplementar são referidos as funcionalidades mais comuns do sistema e os vários requisitos do mesmo, de desempenho, de usabilidade, de segurança e de interface. Em Modelo do Domínio é feita uma representação lógica e estrutural dos elementos do domínio e os seus relacionamentos. Por sua vez, no ponto Protótipo Exploratório, é demonstrada a arquitectura aplicacional e de instalação do sistema, através da utilização de um diagrama de pacotes e de um diagrama de instalação, terminando com o protótipo de produtos, onde é feita a exposição da grande maioria dos interfaces do sistema. Na secção, Plano de Implementação do Projecto é apresentada uma tabela de prioridades contendo os vários casos de utilização pontuados segundo os critérios do método SLiM. Por fim em, Modelo de Dados Persistente, é representada a base de dados de suporte à informação do sistema e explica todas as suas tabelas no dicionário de dados.
No capítulo 4 - Eolitor - Sistema de Monitorização, é descrito todo o Sistema de Monitorização, incluindo os sensores utilizados, e a forma como este organiza a informação para ser enviada para o programa servidor. Inicia-se, com a apresentação do Aerogerador que foi instalado seguido pelo subcapítulo Sensores com uma abordagem dos sensores disponíveis no mercado mais indicados à utilização neste sistema para medir as variáveis necessárias. No segmento seguinte, Arquitectura do Sistema, são expostas as várias soluções e alternativas de instalação dos referidos sensores para proporcionar uma melhor leitura das grandezas em jogo. As tecnologias utilizadas para o desenvolvimento do sistema de monitorização são explicadas no subcapítulo, Tecnologias Implementadas. A forma como este sistema de monitorização “lê” os sensores e processa todos os dados no formato de uma trama com cabeçalho, dados e código de erros, e a frequência com que envia os dados é explicada no subcapítulo Processamento de Tramas - Envio. No que diz respeito ao ponto subsequente, Módulo de Armazenamento de Dados Local, são referidas todas as funções necessárias para a criação de um sistema de ficheiros, suportado num cartão SD/MMC, um dos requisitos para não serem perdidos os dados da monitorização. Os circuitos electrónicos presentes no sistema de monitorização, a começar pelo microcontrolador e por todos os sensores, necessitam de energia eléctrica para poderem funcionar correctamente. Devido a este princípio básico, é necessária a adopção de um Sistema de Alimentação, explicado no subcapítulo seguinte, que permite o fornecimento de energia eléctrica aos circuitos. Em Ligação Wireless, refere-se as tecnologias de comunicação utilizadas, Bluetooth e ZigBee, juntamente com a exposição das características mais importantes de ambas, que permitem o envio da informação através de uma ligação sem fios. Este capítulo termina com o ponto Eolitor Server que faz referência ao programa que foi desenvolvido com o mesmo nome, para juntamente com a placa de circuito impresso, constituírem o sistema de monitorização. Este programa é responsável por receber e processar as tramas criadas pela placa, para seguidamente guardar a informação na base de dados, e é também intermediário entre o
O capítulo 5 - Eolitor - Sistema de Informação, descreve toda a unidade central de processamento de informação, com um interface gráfico para a interacção com o utilizador e com capacidade de armazenamento da informação numa base de dados. Inicialmente é exposta uma breve introdução do mesmo, passando a ser explicada a Arquitectura do Sistema no segundo subcapítulo. Na secção subsequente, Tecnologias Implementadas, são de algum modo explicadas e justificadas as opções tomadas pelo autor, em comparação com as alternativas, no que refere à programação de todo o sistema de informação, desde a plataforma, até às ferramentas utilizadas. De seguida é desenvolvido o tema Processamento de Dados. No âmbito da Interface Visual, são explicadas todas as opções que estão disponíveis aos utilizadores para consultar e visualizar os dados nas várias interfaces do sistema de informação. A forma como os programas do projecto Eolitor e a base de dados podem ser instalados é explicada nos subcapítulos, Instalação e Execução do Programa e Instalação da Base de Dados, respectivamente. No último subcapítulo é feita referência à Web Page desenvolvida para disponibilizar informações do projecto.
No capítulo 6 - Resultados, são expostos os efeitos que derivam do desenvolvimento dos vários sistemas que compõem o projecto Eolitor. A atenção é dada em especial aos interfaces que correspondem à execução dos vários programas.
No capítulo 7 - Comentários Finais, são relatadas todas as conclusões e explicadas algumas alternativas e desenvolvimentos futuros que poderão ser introduzidos no sistema Eolitor de modo a tornar o sistema mais eficiente, mais robusto e inovador.
O texto desta dissertação é concluído com os 6 anexos. No ANEXOS A - Parques Eólicos em "offshore" são mencionados os parques eólicos instalados em operação, em construção e planeados até 2015 em alguns dos principais países exploradores deste tipo de tecnologia. No ANEXO B - Relatório de Especificação de Requisitos, apresenta-se as restantes informações menos importantes que constam do método SLiM e que não foram colocadas no decorrer do capítulo 3 - Modelação do Sistema Eolitor. No ANEXO C - Módulo do Sistema de Ficheiros FatFS, é mencionado o Sistema de Ficheiros FatFS e é feita uma descrição das funções de baixo nível que permitem interacção com a unidade de I/O e as funções do sistema de ficheiros FatFS. No ANEXO D - Projectos Visual Studio, apresentam-se os vários projectos desenvolvidos na plataforma Microsoft Visual Studio, as várias informações da estrutura e interfaces desenvolvidas. No ANEXO E - PCB do Sistema de Monitorização são apresentados os circuitos "schematics" resultantes do desenvolvimento da placa de circuito impresso deste sistema. Por fim, no ANEXO F - Programa do Sistema de Monitorização são detalhadas algumas funções mais importantes do programa, escrito em Linguagem C, que irá correr no microcontrolador da placa de circuito impresso.
2.1.	Introdução
Neste capítulo vai ser feita uma exposição dos assuntos mais importantes e significativos no âmbito das Energias Renováveis, com especial atenção e destaque à Energia Eólica e todos os seus elementos necessários. Desta exposição vão constar as motivações que estiveram na base da exploração e crescimento das Energias Renováveis, comparativamente com as Energias Não Renováveis, bem como o actual estado de produção de energia relativamente ao consumo necessário. No decorrer do capítulo vão ser também detalhados os componentes e os tipos de instalação, necessários à produção de Energia Eólica.
2.2.	Energia Mundial
O mundo está a enfrentar uma grande crise energética e climática.
Globalmente, o sector da energia emite 26 bilhões de toneladas de CO2 por ano e a produção de electricidade, representa cerca de 41% das emissões. A Agência Internacional de Energia prevê que as emissões de CO2 em 2030 tenham aumentado 55%, atingindo mais de 40 bilhões de toneladas de CO2. Por sua vez, as emissões provenientes da produção de energia eléctrica iram aumentar para 44% em 2030, chegando a 18 bilhões de toneladas de CO2 [14].
A Europa tem de investir em novas capacidades, e no período 2005-2030, precisa de instalar novas estruturas com capacidade de gerar 862 GW de electricidade para satisfazer as crescentes necessidades. A capacidade necessária excede o total de capacidade disponível na Europa (723 GW). A satisfação das necessidades energéticas vai ser, nas próximas décadas, um grande desafio. Actualmente a Europa importa cerca de 56%1 da energia, com tendência para atingir os 70% nos próximos 20 a 30 anos2.
Os recursos energéticos fósseis estão a esgotar-se rapidamente, os preços dos combustíveis estão a aumentar e o ambiente é quem mais sofre, devido ao actual política energética. Em 2030 a União Europeia estará a importar 84% de gás, 59% de carvão e 94% de petróleo, ficando assim, extremamente vulnerável à disponibilidade e preços destes compostos energéticos. Todos os dias, as empresas europeias e os consumidores estão a pagar o seu abastecimento energético, cujo preço é alvo de controlo externo. Comparando a factura anual actual da importação de gás com a factura de alguns anos atrás, quando o barril de petróleo custava cerca de 20 Euros, a Europa paga 50 bilhões de Euros a mais. A Europa não tem os recursos energéticos fósseis para poder disputar a liderança do abastecimento de combustível e diminuir as reservas remanescentes, mas tem uma enorme riqueza de recursos energéticos renováveis disponíveis, e as indústrias europeias são líderes mundiais em transformar esses recursos em energia [7].
1	Eurostat, News Release 126/2006 21 Setembro 2006
2	Comissão Europeia, A European Strategy for Sustainable, Competitive and Secure Energy, 8 Março 2006
		
Universidade de Aveiro	15	
2.3.	Protocolo de Quioto, Japão
Durante o ultimo século, com o desenvolvimento da industrialização, o consumo de energia e os níveis de poluição ambientais dispararam em flecha deixando o planeta em estado preocupante.
Assim, os países mais industrializados promoveram em meados da década de noventa um Tratado Internacional, do qual surge o Protocolo de Quioto3, com o objectivo de mudar o rumo do planeta, nomeadamente promover a estabilização da concentração de gases efeito de estufa na atmosfera. Este tratado resultou da iniciativa de vários eventos que culminaram, em Junho de 1992 na ECO 92 no Rio de Janeiro, na CQNUAC, Conferência Quadro das Nações Unidas para as Alterações Climáticas. Aqui não foram estabelecidos limites obrigatórios para as emissões de gases efeito de estufa, mas foram criados protocolos, entre os quais se destaca o Protocolo de Quioto que ficou mais conhecido que a própria convenção.
Este protocolo discutido e negociado no Japão em 1997, que foi aberto para assinatura em 16 de Março de 1998, vigora oficialmente desde 16 de Fevereiro de 2005 depois de a Rússia o ratificar em Novembro de 2004. No total, estão vinculados a esta iniciativa 175 países, nomeadamente os países mais desenvolvidos, dos quais se destacam: Argentina, Brasil, México, Dinamarca, França, Espanha, Alemanha, Itália, Portugal, Reino Unido, Japão e a China. Por outro lado, entre as ausências destaca-se os Estados Unidos da América que negaram comprometer-se com o protocolo, pois segundo o Presidente George W. Bush, interferia com a economia norte-americana.
Através deste acordo os países têm a obrigação de reduzir, no período de 2008 a 2012, a emissão dos gases provenientes do efeito de estufa em pelo menos 5.2% em relação aos níveis atingidos em 1990. Esta redução corresponde a cerca de 15 % das emissões esperadas para 2008. Para que realmente se impulsione a redução dessas emissões devem ser tidas em conta várias actividades económicas.
O protocolo estimula os países signatários a cooperarem entre si, através de algumas acções básicas:
-Reformar os sectores de energia e transportes;
-Implementar Fontes de energia renováveis;
-Eliminar mecanismos financeiros e de mercado inapropriados aos fundos da contenção;
-Limitar as emissões de metano;
-Proteger as florestas.
Se o Protocolo de Quioto for comprido com sucesso, estima-se que a temperatura global venha a comportar uma redução entre 1,4°C e 5,8°C até ao final do século, apesar de
3 Protocolo de Quioto - http://pt.wikipedia.org/wiki/Protocolo_de_Quioto
		
Universidade de Aveiro	16	
2.4.	Energias Renováveis
No âmbito da redução da emissão dos gases do efeito de estufa as energias renováveis passaram a assumir um papel dominante. Estas são consideradas como energias alternativas ao modelo energético actual, tanto pela sua disponibilidade ilimitada (presente e futura) como pelo seu menor impacto ambiental. São estas as principais características em que as energias renováveis se mostram mais benéficas que as energias ditas não renováveis (Petróleo, Carvão, Gás natural).
As Fontes de Energia Renovável (FER) são praticamente ilimitadas pois a sua utilização “hoje” não põe em causa a sua disponibilidade de “amanha”. São exemplos destas fontes: a energia solar, eólica, hidráulica, das ondas, biomassa e geotérmica.
Praticamente inesgotável, a energia solar pode ser usada para a produção de energia eléctrica. A conversão deverá ser feita através de painéis solares e células foto voltaicas e será tão mais elevada quanto maior for a exposição solar. Desta forma a produção da energia solar torna-se mais estimulante nos países onde o sol é mais predominante.
A energia solar é essencialmente utilizada através de duas formas: activa e passiva. O método activo consiste em transformar os raios solares em outras formas de energia (térmica ou eléctrica) enquanto o passivo é utilizado para o aquecimento de edifícios ou prédios, aprimorando as concepções e as estratégias construtivas. Os painéis foto voltaicos são uma das mais promissoras fontes de energia renovável, sendo a sua principal benesse a quase total ausência de poluição. No entanto, uma das limitações actuais dos dispositivos foto voltaicos é seu baixo rendimento e os custos de produção elevados devido à pouca disponibilidade de materiais semicondutores.
A energia hidráulica (ou hídrica) baseia-se na utilização da força cinética das águas de um rio e posterior conversão em energia eléctrica, que é feita com base na rotação de uma turbina hidráulica. Actualmente, a produção desta energia está associada a grandes indústrias hidroeléctricas, no entanto, há a considerar a utilização da energia hídrica em outras aplicações, tais como pequenas centrais hidroeléctricas (mini-hidricas) fundadas em rios de pequeno porte.
A energia biomassa provém de três classes de biomassa: a biomassa sólida, líquida e gasosa. A primeira é composta por produtos e resíduos da agricultura (incluindo substâncias vegetais e animais), por resíduos florestais e parte dos resíduos industriais e urbanos biodegradáveis. A biomassa líquida está presente em biocombustíveis líquidos com elevado potencial de utilização, tais como: o biodiesel, obtido a partir de óleos de girassol; o etanol, produzido com a fermentação de hidratos de carbono (açúcar, amido, celulose); e o metanol, gerado pela síntese do gás natural. Por sua vez, a biomassa gasosa pode ser encontrada nos resíduos agro-pecuários provenientes da agro-indústria e do meio urbano, poderá também ser descoberta nos aterros de RSU (resíduos sólidos urbanos). Estes resíduos são resultado da degradação biológica anaeróbia da matéria orgânica, e são constituídos por uma mistura
2.5.	Energia Eólica
A energia eólica é outra das formas de produção de energia proveniente de fontes renováveis. Esta é gerada pelo vento, fonte de energia natural e inesgotável. Utilizada há anos sob a forma de moinhos de vento, pode ser actualmente captada pelos modernos aerogeradores, também conhecidos por turbinas ou geradores eólicas.
Os aerogeradores têm como função transformar a energia cinética do vento, resultante do deslocamento das massas de ar, em energia mecânica e consequentemente em energia eléctrica. Este é o princípio básico de um aerogerador. Primeiro o rotor retira a energia cinética do vento e converte-a em energia mecânica de rotação possibilitando em seguida o gerador a converter esta energia em energia eléctrica.
Um aerogerador, contudo não tem capacidade de transformar a totalidade da energia do vento em energia eléctrica. Assim, a produção de energia é limitada, e em condições ideais, o valor da energia captada por um rotor eólico é dado pelo limite de Betz (ver 2.5.1.4 - Lei de Betz). O rendimento global do sistema eólico relaciona a potência disponível do vento com a potência final que é entregue pelo sistema. Os rotores eólicos ao extraírem a energia do vento induzem a sua velocidade; ou seja, a velocidade do vento frontal ao rotor (velocidade não perturbada) é maior do que a velocidade do vento atrás do rotor. Uma redução muito grande da velocidade do vento faz com que o ar circule em volta do rotor, ao invés de passar através dele.
Todos os sistemas eólicos só começam a funcionar a partir de uma certa velocidade, chamada de velocidade de entrada ou inicial, que é necessária para vencer algumas perdas e atritos. No outro extremo, quando o sistema atinge a chamada velocidade de corte um mecanismo de protecção é accionado com a finalidade de não causar riscos ao rotor e à estrutura. Para os sistemas eólicos, a velocidade de rotação óptima do rotor varia com a velocidade do vento. Um sistema eólico tem o seu rendimento máximo a uma dada velocidade do vento (chamada de velocidade nominal) e diminui para velocidades diferentes desta.
Projectar um sistema eólico, para um determinado tamanho de rotor e para uma carga pré-fixada, supõe trabalhar no intervalo óptimo de rendimento do sistema com relação a curva de potência disponível do vento local. Isto requer encontrar uma relação de multiplicação, de maneira que se tenha um bom acoplamento rotor/carga. É necessário também, ter mecanismos de controlo apropriados para melhorar o rendimento noutras velocidades de vento e aumentar o intervalo de funcionamento do sistema eólico.
Para a produção de energia eléctrica em grande escala, só são interessantes regiões que tenham ventos com velocidade média de 6 m/seg ou superior. Ventos com velocidade inferior a 2 ou 3m/seg não são suficientes para fazer funcionar os aerogeradores. Vamos ver quais as características dos ventos bem como todas as componentes de um sistema eólico posteriormente. Este tipo de produção de energia é a que se tem destacado mais de entre todos os tipos de produção de energia renováveis.
2.5.1.	Vento - Fonte Natural Renovável
2.5.1.1.	Origem
O vento é a fonte responsável pela produção de energia eólica. A sua origem está relacionada com o aquecimento diferenciado da superfície da Terra e resulta do deslocamento de massas de ar. A não uniformidade na temperatura da superfície da Terra, e consequentemente, na atmosfera, é devida principalmente à orientação da Terra no espaço e aos seus movimentos de rotação e translação. Assim, os ventos são causados pela diferente distribuição de incidência de energia solar na superfície da Terra. A energia cinética contida nas massas de ar, e que pode originar energia eólica, é cerca de 1 a 2%4 da energia proveniente do sol5. Esta, e comparando com a biomassa disponível no planeta produzida por todas as plantas, é cerca de 50 a 100 vezes superior (0.011%).
As regiões Equatoriais (com latitude 0°) são aquecidas pelo sol mais do que as restantes zonas do globo. Como o ar quente é mais leve que o ar frio, este sobe até uma altura aproximada de 10 km e estende-se para norte e para sul, se a terra não tivesse movimento rotacional, esse ar chegaria ao Pólo Norte e ao Pólo Sul, para posteriormente voltarem ao Equador. Devido ao movimento rotacional da terra, entre outros factores, os ventos pode ter diferentes características, no que respeita á sua origem:
-	Ventos globais;
-	Ventos locais;
-	Ventos superficiais.
Ventos globais
Os ventos globais são ventos que circulam pelas camadas mais altas da atmosfera. Estes com origem no Equador deslocam-se em direcção aos Pólos. A zona de altas pressões, que se encontra por volta do 30° de latitude, faz com que o vento comece a descer em direcção ao Equador. Este movimento do vento origina uma zona de baixas pressões perto do solo o que atrai ventos do Norte e do Sul. Nos pólos, devido á temperatura e ao ar frio, são originadas zonas de altas pressões. Estes ventos na realidade são considerados como ventos geostróficos, e ocorrem a partir da altitude dos 1.000 m. As velocidades destes ventos podem ser medidas por balões meteorológicos.
Ventos superficiais
Os ventos são muito influenciados pela superfície terrestre até altitudes de 100 metros e são travados pela rugosidade da superfície da terra e pelos obstáculos. As direcções perto da superfície são ligeiramente diferentes das direcções dos ventos globais, devido à rotação da terra.
Ventos locais
4	Vento - http://pt.wikipedia.org/wiki/Vento
5	O sol irradia cerca de 174.423.000.000.000 kWh
Brisas Marinhas: Durante o dia, pela influência do sol, a terra aquece mais rapidamente que o mar. O ar sobe e circula em direcção ao mar, originando uma depressão ao nível do solo, atraindo o ar frio, resultando daí a chamada brisa marinha. Normalmente, durante a tarde, quando as temperaturas do solo e do mar estão mais semelhantes, existe um período em que a brisa marítima é mais suave, já durante a noite os ventos sopram em sentido contrário, tendo a brisa terrestre, normalmente, velocidades inferiores, uma vez que a diferença entre a temperatura do solo e do mar também é inferior.
Ventos da montanha: têm origem nos declives orientados a sul (no hemisfério sul) e nos declives orientados a norte (no hemisfério norte), como por exemplo o vento dos vales. Quando o ar próximo dos declives está quente, a sua densidade diminui, fazendo-o subir seguindo a superfície do declive, e á noite a direcção do vento inverte-se, passando a descer o declive.
O vento é definido essencialmente por dois parâmetros: velocidade e direcção. A sua intensidade não é regular e a sua disponibilidade depende do local. Como tal, para a instalação de um dispositivo promotor de energia eólica, é necessário um estudo do local para determinar as características locais do vento. Será tanto melhor quanto menores forem as alterações do relevo, pois serão menos as barreiras físicas e assim o vento será mais regular. Esta constitui uma das razões principais porque está a aumentar consideravelmente o número de parques eólicos em "offshore"6 (ver 2.7.3 - Sistemas em “Offshore”).
2.5.I.2.	História do uso
Segundo algumas publicações o vento começou a ser utilizado por volta de 4000 a.C., recentemente testemunhadas por um barco encontrado num túmulo sumeriano da época. Por volta de 1.000 a.C. os fenícios, pioneiros na navegação comercial, utilizavam barcos movidos exclusivamente a força dos ventos. Ao longo de muitos anos vários tipos de embarcações à vela foram desenvolvidos, com grande destaque para as Caravelas - surgidas na Europa no século XIII e que tiveram papel importante nas Grandes Descobertas Marítimas. As embarcações à vela dominaram os mares durante séculos, até o surgimento do navio a vapor, em 1807, que veio dividir este domínio. No início do século XX, foram praticamente abandonados em favor do vapor.
As primeiras máquinas que aproveitaram o vento foram provavelmente os moinhos de vento de eixo vertical usados para moer grãos na Pérsia (actualmente Irão) por volta de 200AC.
Os moinhos de vento de eixo horizontal apareceram na região mediterrânea por volta do século X e estavam colocados de forma permanente de cara para os ventos marítimos que eram predominantes.
6	Parques eólicos instalados em alto mar perto da costa terrestre.
O moinho de vento holandês do século XV tinha um corpo fixo e uma parte rotativo com uma componente que apontava as pás em direcção ao vento. Estas máquinas tinham pás com diâmetros de até 25 m e espalharam-se muito pela Europa até o final do século XIX.
Figura 2.1 - Moinho Holandês7
Mediante o evoluir da tecnologia e as recentes necessidades de produção de energia, essencialmente proveniente de fontes renováveis, o vento passou a ser aproveitado para a produção de energia eléctrica com a introdução dos aerogeradores.
2.5.1.3.	Energia do Vento
O aerogerador obtém energia convertendo a energia do vento num binário actuando sobre as pás do rotor. A quantidade de energia transferida ao rotor pelo vento depende: da densidade do ar, da área de varrimento do rotor e da velocidade do vento.
-	Densidade do ar: A energia cinética de um corpo em movimento é proporcional a sua massa, assim a energia cinética do vento depende da densidade do ar, i.e., da sua massa por unidade de volume. Quanto “mais pesado ou denso” for o ar, maior quantidade de energia transmite ao aerogerador. A pressão atmosférica normal a densidade do ar é de 1,225 Kg/m3. Quanto maior for a altitude, menor a pressão do ar e o ar é menos denso.
-	Área de varrimento do rotor: É a área de uma circunferência que determina quanta energia, contida no vento, o aerogerador é capaz de captar. Assim quanto maior for a dimensão das paz maior a área de varrimento e maior a capacidade de captar energia. Dado que a área do rotor aumenta com o quadrado do raio, um aerogerador duas vezes maior recebe 4 vezes mais energia.
-	Desvio do Vento: Na realidade o aerogerador desvia o vento antes de o vento chegar ao plano do rotor, pelo que nunca será possível capturar toda a energia do vento. (ver 2.5.1.4 - Lei de Betz). O rotor do aerogerador trava a velocidade do vento quando captura a sua energia cinética e a converte em energia rotacional. Isto implica que a velocidade do vento
7 Imagem retirada de http://olhares.aeiou.pt/galerias/detalhe foto.php?tc=1&amp;amp;origem=&amp;amp;id=1588591
		
Universidade de Aveiro	21	
que sai do aerogerador é menor do que a velocidade do vento inicial. Assim, uma vez que a quantidade de ar (por segundo) que passa através da área de varrimento do rotor deve ser igual á quantidade de vento que abandona a área do rotor, o ar ocupará uma maior secção transversal (diâmetro), por trás do plano do rotor.
- Distribuição da pressão no rotor: A pressão do ar aumenta gradualmente à medida que o vento se aproxima do rotor, uma vez que o rotor actua como barreira ao vento. Detrás do rotor a pressão cai imediatamente, estabilizando gradualmente a medida que a distância do rotor aumenta.
2.5.I.4.	Lei de Betz
Como já vimos, a energia cinética resultante das deslocações de massas de ar, pode ser transformada em:
-	Energia mecânica: através de aeromotores;
-	Energia eléctrica: através de geradores eólicos.
A potência mecânica disponível (P) num gerador depende essencialmente (factor cúbico) da velocidade do caudal de ar que passa através dela, o que faz com que o interesse e o aproveitamento deste recurso variem muito com a intensidade e a direcção do vento.
A potência do vento que passa perpendicularmente através de uma área circular, pode-se resumir em:
P = 1P v 3 n r 2
2	H
Equação 2.1 - Potência do vento
Onde:
P = potência média do vento em Watts [W]
p = densidade do ar seco = 1,225 [kg/m3] (PTN)
v = velocidade média do vento [m/s]
n « 3.141592...
r = raio do rotor em m [metros]
Quanto maior for a energia cinética extraída do vento pelo aerogerador, maior será o abrandamento do vento que deixa o aerogerador. Teoricamente se fosse possível extrair toda a energia, o vento sairia com energia cinética nula, i.e., com velocidade nula. Isto significaria que, o ar não poderia abandonar o aerogerador. No outro caso extremo, consideramos que o ar passa pelo rotor sem nenhum abrandamento, também não seria possível extrair energia do vento. Entre estes dois extremos existe um valor para o qual é mais eficiente a conversão da energia do vento em energia mecânica: um aerogerador ira travar até cerca de 2/3 da sua velocidade inicial. Este valor resulta da formulação de 1919, realizada pelo físico Albert Betz, e conhecida como Lei de Betz8. A Lei de Betz diz que só se pode converter até 16/27 (59%) da energia cinética em energia mecânica. Por outras palavras, 59,3% da energia cinética do ar pode ser teoricamente extraída por um aerogerador. Na prática, esse valor vai ser reduzido
8 Lei de Betz - http://en.wikipedia.org/wiki/Betz'_law
2.5.1.5.	Caracterização de Locais com potencial eólico
Já foi referido que a potência varia com o cubo da velocidade do vento, e proporcionalmente com a densidade do ar, para a produção de energia eléctrica, quanto maior for a velocidade do vento maior o potencial eólico do local e maior a viabilidade do projecto. Para tal, só locais com valores de velocidades média anuais superiores a 5 ou 6 metros por segundos (m/seg) são interessantes, abaixo deste valor não existe viabilidade para este tipo de aplicações. O que significa que a potência média do vento para a viabilidade de parques eólicos deve ser superior a 415.6r2 W (r igual ao raio do rotor ver 2.5.1.4).
Para a determinação de locais com potencial são utilizadas regras básicas e de primeira análise:
-Os topos das montanhas são, em geral, locais muito ventosos.
-Os planaltos e as planícies elevadas podem ser locais com bastante vento, assim como as zonas costeiras.
-Os vales são normalmente locais com menos vento, embora, por vezes, possam ocorrer efeitos de concentração local.
Seguidamente podemos ver que os países mais perto do pólo norte têm médias de vento, tanto terrestres como marítimas, superior aos países mediterrânicos. Logo, a energia eólica é atractiva, sendo os projectos nesta área muito mais viáveis.
Figura 2.2 - Mapa Europeu de Vento a 50 metros9
9 Imagem retirada de http://www.windatlas.dk/Europe/landmap.html
Figura 2.3 - Mapa Europeu de Vento em offshore
2.5.I.6.	Efeitos
A variação do vento é muito influenciada pela altura relativamente ao solo (rugosidade). A turbulência ou a presença de obstáculos, são outros factores que influenciam o aproveitamento desta fonte de energia.
-Rugosidade: só a partir dos mil metros de altura é que a superfície terrestre deixa de ter influência significativa sobre o vento. Nas camadas mais baixas a velocidade do vento é afectada pela superfície terrestre, e em geral, quanto maior a rugosidade do terreno maior o abrandamento do vento. Numa floresta ou numa cidade, onde existem arvores e prédios respectivamente, abrandam muito o vento, classe de rugosidade 3 a 4 (definição utilizada pela industria eólica para classificar a rugosidade de uma superfície). Já numa planície, o abrandamento sofrido pelo vento é muito menor, classe 0,5-1, enquanto a superfície do mar tem uma influência quase nula, classe 0.
-Variabilidade do vento: a velocidade do vento está sempre a flutuar, pelo que a sua energia cinética varia continuamente. A magnitude destas flutuações depende das condições climatéricas e das condições locais. A produção energética de um aerogerador varia com este fenómeno, no entanto pequenas variações rápidas podem ser compensadas pela inércia do rotor.
-Turbulência: a turbulência pode estar associada a fenómenos naturais como tempestades com rajadas de vento em várias direcções, ou em áreas em que a superfície é muito acidentada (grande rugosidade), e por detrás de obstáculos como edifícios. A turbulência reduz a possibilidade de utilizar o vento de forma efectiva num aerogerador, e
-Obstáculos: os obstáculos ao vento tais como edifícios, árvores, formações rochosas, entre outros, para além de causarem turbulência, também diminuem a velocidade do vento de forma significativa. Grande parte da turbulência é gerada na região por detrás do obstáculo, e pode propagar-se até 3 vezes a dimensão do objecto, pelo que é de evitar grandes obstáculos perto dos aerogeradores.
-Efeito da esteira: o vento que abandona o rotor de um aerogerador tem um conteúdo energético inferior, criando um “abrigo” na direcção a favor do vento. De facto, existe uma esteira por trás da cabine, i.e., uma “cauda” de vento muito turbulenta e abrandada, em comparação com o vento que chega ao aerogerador. Nos parques eólicos, de forma a evitar a turbulência ao redor dos aerogeradores, deve existir uma distância mínima entre aerogeradores equivalente à distância de três diâmetros de rotor. Nas direcções do vento dominante esta distância ainda deve ser maior.
-Efeito do Parque: como referido no efeito esteira, cada aerogerador irá travar o vento ao extrair energia. O Ideal seria poder separar os aerogeradores o máximo possível na direcção dominante do vento. Isto fazia aumentar o custo dos parques eólicos, por causa dos custos do terreno e da ligação à rede. As perdas típicas de energia devida e este efeito situam-se em 5%, já tendo em conta as formas de minimizar este tipo de efeitos.
-Efeito Túnel: o vento que passa numa passagem estreita (como dois edifícios altos ou entre duas montanhas) é comprimido na parte exposta ao vento e a sua velocidade cresce consideravelmente entre os dois obstáculos. Este efeito tem o nome de “efeito túnel”. Assim seria possível, na teoria, obter velocidades de vento 1/3 superiores. A colocação de um aerogerador entre duas colinas, sobretudo em colinas muito acidentadas pode haver efeitos da turbulência que poderão anular as eventuais vantagens do efeito túnel e criar problemas de fadiga nos materiais.
-Condições marítimas: a rugosidade da superfície da água é muito baixa, muito menor que na terra pelo que as condições para a instalação de aerogeradores é mais indicada. Contudo não deve ser desprezados alguns obstáculos como, ondas, ilhas, faróis. Assim, no mar a turbulência é menor do que em terra, devido às menores diferenças de temperatura a diferentes alturas, os aerogeradores tem todas as condições para poderem produzir mais energia eléctrica e o tempo de vida ser mais prolongado.
2.5.I.7.	Medição
Idealmente, a caracterização do recurso eólico num local deve ser feita com base em medições realizadas em vários pontos da zona e ao longo de um período significativo. Na prática, as decisões de instalar um parque são, muitas vezes baseadas num único registo medido ao longo de pouco tempo.
Como já foi referido, a velocidade média do vento deve ser superior a 5 ou 6 metros por segundos (m/seg). A velocidade à qual os aerogeradores começam a rodar situa-se nos 35 (m/s), pelo que abaixo de 5 (m/s) a quantidade de energia no vento é muito baixa e não permite ao aerogerador a produção de energia. Os valores ideais de aproveitamento andam a
volta do 10-12 (m/seg), no entanto os aerogeradores podem ser desenhados para serem o mais eficiente possível dependendo da velocidade média do vento numa determinada zona. O valor limite dessa velocidade é por volta dos 25 (m/seg) A estas velocidades os geradores têm de ser capazes de dissipar a energia em excesso contida no vento.
A medição das características do vento é feita com instrumentos específicos: anemómetros para medir a velocidade e sensores de direcção para medir a direcção. É essencial que estes instrumentos de medida estejam bem expostos a todas as direcções do vento, isto para o resultado das medições não ser muito afectado pelos obstáculos em redor.
Figura 2.5 - Sensor de direcção e Anemómetro
A Figura 2.5 ilustra o tipo de anemómetro mais difundido, o chamado anemómetro de copos, e um sensor de direcção. A principal desvantagem do anemómetro de copos reside no facto de a sua constante de tempo ser inversamente proporcional à velocidade do vento, i.e., aceleram mais rapidamente do que desaceleram. Na prática, se o vento desacelerar rapidamente, a informação da velocidade do vento dada pelo anemómetro é superior á real. A medição do vento deve ser efectuada a uma altura próxima da altura a que vai ficar o rotor. A frequência de amostragem está dependente dos objectivos da aplicação mas dever andar entre os 0.1 e o 1 Hertz.
Figura 2.6 - Anemómetro ultra sónico
A frequência de amostragem destes anemómetros é muito mais elevada do que os anemómetros de copos, cerca de 50 Hz, implicaria armazenar muitos dados pelo que alguns são descartados. Estes já não têm o problema da constante de tempo de desaceleração ser mais elevada do que a constante de tempo de aceleração presente nos anemómetros de copos.
A velocidade de rotação dos anemómetros é proporcional à velocidade do vento, sendo medida através de uma tensão variável. A calibração dos anemómetros deve ser efectuada antes da sua aplicação (idealmente num túnel de vento) e em utilizações durante períodos longos, deve ser periódica a sua recalibração no local com o auxílio a outro anemómetro de referência. Os sensores de direcção fornecem uma tensão proporcional à direcção. Tipicamente, a tensão máxima é obtida para a direcção do norte relativo ao sensor, pelo que tem de ser adequadamente orientado.
2.5.2.	Panorama Actual
O ano de 2007 foi o melhor ano na indústria mundial do vento com perto de 20.000 MW instalados [5] [6]. Este constituiu um aumento de 31%, comparando com o ano de 2006, liderado por os E.U.A, China, Espanha, Índia e Alemanha.
Os E.U., em 2007 e pelo terceiro ano consecutivo, foram o país que mais contribuiu para o aumento da produção de energia eléctrica a partir da energia eólica, com cerca de 5244 MW instalados, mais do dobro de 2006. Globalmente a capacidade de produção de energia eólica dos E.U. cresceu 45% em 2007, com capacidade total instalada de 16.8 GW. Os parques eólicos nos E.U. têm capacidade de gerar cerca de 48 mil milhões de kWh de electricidade em 2008, pouco mais de 1% da energia eléctrica consumida nos E.U., o equivalente a mais de 4.5 milhões de lares. Em 2007, 34 estados dos E.U. produziram electricidade a partir do vento. Dos estados que mais influenciaram o aumento da produção de energia eólica fazem parte: Texas (4356 MW), Califórnia (2439 MW), Minnesota (1.299 MW), Iowa (1.273 MW) e Washington (1.163 MW). Como este ritmo de crescimento verificado é esperado que os E.U. ultrapassem a Alemanha como o maior produtor de energia eólica até ao final de 2009, segundo estimativas da AWEA (American Wind Energy Association, em português, Associação Americana de Energia Eólica), que estima a instalação de cerca de 5GW durante o ano de 2008.
A China foi também um dos países que mais contribuiu, com a instalação de 3304 MW de capacidade eólica durante 2007, representando crescimento de 145% do mercado em relação a 2006, e já ocupa quinta posição na lista dos maiores produtores mundiais, com capacidade de 5906 MW no final de 2007. No entanto, os peritos estimam que este é apenas o começo, e que o crescimento real da China ainda está para vir. Com base nas actuais taxas de crescimento, o chinês Renewable Energy Industry Association (CREIA) prevê uma capacidade de cerca de 50,000 MW até 2015. As regiões com os melhores regimes de vento estão localizadas principalmente ao longo da costa sudeste e interior da Mongólia, Xinjiang, província de Gansu Hexi e em algumas partes do Nordeste, do Noroeste, e do Norte da China e da Qinghai-tibetano Plateau.
A indústria eólica na China está portanto a crescer. Enquanto no passado, as importações de geradores eólicas dominou o mercado chinês, a tendência actual está a mudar rapidamente como o crescente mercado de energia eólica e a clara orientação política têm incentivado a produção interna. No final de 2007, eram 40 os fabricantes chineses envolvidos em energia eólica, responsável por cerca de 56% dos equipamentos instalados ao longo do ano, aumentando 41% em relação a 2006. Enquanto em 2006, apenas cerca de 400 MW foram fabricados por fabricantes chineses, em 2007, apenas duas empresas chinesas (Gold Wind e Sinovel) contabilizaram 1460 MW de capacidade instalada, representando cerca de 42% do mercado anual [Global Wind 2007 Report GWEC].
Na Europa, o ano de 2007 será recordado como um ano crucial na história da política energética europeia. Um enorme passo em frente foi dado em Março, com os 27 chefes de Estado aprovaram, por unanimidade, uma meta vinculativa de 20% da energia que provêm de fontes renováveis até 2020. Em Janeiro de 2008, a Comissão Europeia publicou o seu projecto de legislação das energias renováveis, que propõe um quadro estável e flexível da UE e deverá garantir uma enorme expansão da energia eólica na Europa. A combinação das medidas apresentadas no quadro proposto irá reduzir as barreiras administrativas e privilegiar acesso à rede para as energias renováveis, ao mesmo tempo que introduz um mecanismo de negociação voluntária controlada pelos Estados-Membros. A decisão de 2007, e a proposta legislativa do início de 2008, mostram que a Europa compreendeu a gravidade da situação energética e climática, e da necessidade urgente de encontrar e entregar soluções. Para a meta de 20% da energia ser cumprida, a Europa precisa de aumentar a produção de electricidade a partir de fontes renováveis 15% do consumo de hoje para mais de um terço em 15 anos. A Comissão Europeia estima que, para que isso aconteça, a quota da electricidade proveniente da energia eólica, deve subir do nível actual de 3,7% para 12%.
O actual abastecimento energético da União Europeia é insustentável. A Europa depende dos combustíveis não renováveis, principalmente do petróleo. Os preços estão a subir de forma constante e atingiu um recorde superior a 140€ por barril de petróleo durante o primeiro semestre de 2008. Muitos países importadores, e as suas economias nacionais, dependem muito dos países exportadores que fazem parte da OPEP (Organização dos Países Exportadores de Petróleo) que tem o monopólio da produção de petróleo com cerca de 78% das reservas mundiais. Este sistema energético tradicional também tem repercussões muito conhecido no ambiente. Agora, reduzir as emissões de CO2 de modo à redução das alterações climáticas tornaram-se uma das prioridades mundiais e a janela de tempo que nos resta para agir é cada vez menor. A energia eólica oferece uma solução imediata e concreta para a
energia. Vento é uma limpa, abundante, omnipresente e inesgotável forma de energia. Se a Europa atingir a meta de 12% da electricidade gerada, proveniente da energia eólica, até 2020, os benefícios serão concretos e visíveis. A procura de petróleo e gás iria cair, como resultado, e a pressão inflacionista sobre a economia seria flexibilizada. Com esses 12% da energia eólica, seria também muito importante para o desemprego, na criação de cerca de 368.000 novos postos de trabalho nos próximos 12 anos (até 2020), para aumentar a independência energética, para manter a liderança global da UE na produção de energia eólica, para geração de riqueza e poderia resultar na poupança de cerca de 330 milhões de toneladas de emissões de CO2 por ano. Em 2010, isso seria equivalente à redução de um terço das emissões de CO2 actuais da EU, alvo no âmbito do Protocolo de Quioto.
Europa	Final de 2006	Durante 2007	Final de 2007	Durante 2008	Final de 2008
Austria	965	20	985	14	999
Bélgica	194	93	287	104	384
Bulgária	36	34	70	101	171
Chipre	0	0	0		
República Checa	54	63	116	34	150
Dinamarca	3,136	3	3,125	77	3,180
Estónia	32	26	58	20	78
Finlândia	86	24	110	33	143
França	1,567	888	2454	950	3.404
Alemanha	20,622	1,667	22,247	1,665	23,903
Grécia	746	125	871	114	985
Hungria	64	4	65	62	127
Irlanda	746	59	805	208	1,012
Itália	2,123	603	2,726	1,010	3,736
Letónia	27	0	27	0	27
Lituânia	48	7	51	3	54
Luxemburgo	35	0	35	0	35
Malta	0	0	0	0	0
Holanda	1,558	210	1,746	500	2,225
Polónia	153	123	276	196	472
Portugal	1,716	434	2,150	712	2,862
Roménia	3	5	8	2	10
Eslováquia	5	0	5	0	3
Eslovénia	0	0	0	0	0
Espanha	11,623	3,522	15,145	1,609	16,740
Suécia	571	217	788	236	1,021
Reino Unido	1,962	427	2,389	836	3,241
Total EU-12	419	263	675	417	1,078
Total EU-15	47,651	8,291	55,860	8,067	63,857
Total EU-27	48,069	8,554	56,535	8,484	64,935
Tabela 2.1 - Capacidade de Energia Eólica na EU no final de 2008 [EWEA]
Faroe Islands
4
Rep al Ireland
805
Finland
	Norway 333		110
		Sweden	Estonia
			
			
			Latvia
	Danmark		27
UK	3,125		Lithuania
2,389			59
Netherlands			
		Poland	
Belgium	Germany	276	
287	22.247		
Luxembourg
35
France
2,454
Portugal
2.150
Spain
15,145
Switzerland
12
Hungary
Croatia
Austria
987
Czech Republic
116 Slovakia
Ukraine
89
Romania
8
Bulgaria
70
Turkey
146
Greece
871
European Union: 56.535 MW Candidate Countries: 163 MW EFTA: 345 MW
Total Europe: 57,136 MW
Figura 2.7 - Capacidade de Energia Eólica na EU no final de 2007 [EWEA]
Belgium 0.51%
Ireland 1.42%	, Sweden 1.39%
'Czech Republic, Finland, Bulgaria, Hungary, Estonia, Latvia, Romania and Slovakia represent less than 0.5% of the EU cumulative capacity.
Cyprus, Malta and Slovenia have no wind power installed.
Figura 2.8 - Capacidade de Energia Eólica dos estados membros da EU-27 até ao final de 2007 [EWEA]
Em 2007, a capacidade eólica cresceu mais do que qualquer outra tecnologia na Europa, um aumento impulsionado pela Espanha. Estatísticas fornecidas pela associação EWEA (European Wind Energy Association, em português, Associação Europeia de Energia Eólica, em princípios de Fevereiro de 2008 mostrou que a capacidade eólica instalada aumentou 18% em 2007 para atingir um nível de 56.535 MW. Apesar deste aumento, o crescimento não foi tão elevada como previsto em alguns países da UE. No entanto, a energia eólica continuou a ser uma das mais populares fontes de novas centrais de produção na União Europeia durante o ano de 2007, sendo responsável por 40% de todas as novas instalações. A capacidade total dos novos geradores eólicas instalados, em toda a União Europeia no ano passado, foi de 8554 MW, um aumento de 935 MW em relação ao ano 2006. A capacidade instalada no final de 2007 vai produzir 119 TW horas de electricidade com uma média do vento ano, igual a 3,7% da energia da UE.
Figura 2.9 - Capacidade de Energia Eólica dos estados membros da EU-27 durante 2007 [EWEA]
Em 2007, o desempenho mais impressionante veio de Espanha. Foram instalados 3522 MW de energia eólica - que representam 40% do total europeu instalado no mesmo ano. O sucesso espanhol resultou de um claro incentivo nacional na energia renovável, assim como fortes metas regionais. Os outros principais países são: Alemanha (1667 MW de nova capacidade), França (888 MW), Itália (603 MW), Portugal (434 MW) e Reino Unido (427 MW). França aumentou o seu nível de energia eólica para 2454 MW, uma indicação de que o regime de incentivos e regras de planeamento introduzidas há alguns anos, estão agora a obter os resultados. Outros países que tiveram bom desempenho foram a Suécia, que instalou 218 MW até atingir um total de 788 MW, e a Polónia, a mais bem sucedida dos novos Estados-Membros, com um total de 276 MW. A República Checa também instalados 63 MW e da Bulgária, 34 MW.
É muito positivo que a energia eólica está actualmente a aumentar mais rapidamente do que qualquer outra tecnologia na Europa. No entanto, se excluirmos os números da Espanha, o mercado europeu de energia eólica teve um pequeno declínio no decorrer do ano de 2007.
Como resultado, o crescimento global de 12% não foi tão impressionante como poderia ter sido. O mercado global para geradores eólicos cresceu em cerca de 30% no ano passado para 20000 MW, e as empresas europeias continuam a ser líderes na área. O mercado europeu estima que tenha sido no valor de cerca de € 25 mil milhões em 2007. A diferença de ritmo em alguns países pode ser explicadas por uma mistura de lentidão de processos administrativos, com problemas no acesso à rede e incertezas legislativas.
O crescimento da produção da Energia Eólica tem estimulado a crescimento das economias europeias contribuindo também, para o aumento da percentagem de energia eléctrica proveniente do vento, no total de energia eléctrica necessária. A Espanha obtém agora 10% da sua electricidade a partir de energia eólica, a Alemanha 7,2% [EWEA 2007 ANNUAL REPORT, EWEA]. Em termos globais, a Europa contribui actualmente com 61% da capacidade mundial de energia eólica, que agora atingiu mais de 94 GW (20 GW foram instalado em 2007), de acordo com a Global Wind Energy Council (GWEC - Global Wind 2007 Report).
Figura 2.10 - Capacidade de Energia Eólica global 1990-2007 (em MW)
Figura 2.11 - Capacidade de Energia Eólica anual 1990-2007 (em MW)
África e Médio Oriente	Final de 2006	Durante 2007	Final de 2007
Egipto	230	80	310
Marrocos	64	60	124
Irão	48	19	67
Tunísia	20	0	20
Outros	16	1	17
Total	378	160	538
Tabela 2.2 - Capacidade de Energia Eólica em África e Médio Oriente no final de 2007 [GWEC]
Ásia	Final de 2006	Durante 2007	Final de 2007
Índia	6,270	1,575	7,845
China	2,599	3,304	5,906
Japão	1,309	229	1,538
Tailândia	188	100	282
Korea do Sul	173	18	191
Filipinas	25	0	25
Outros	5	0	5
Total	10,569	5,226	15,831
Tabela 2.3 - Capacidade de Energia Eólica na Ásia no final de 2007 [GWEC]
América do Sul	Final de 2006	Durante 2007	Final de 2007
Brasil	237	10	247
México	87	0	87
Costa Rica	74	0	74
Caraíbas	35	0	35
Argentina	27	2	29
Colômbia	20	0	20
Jamaica	20	0	20
Chile	2	18	20
Cuba	5	0	5
Total	507	30	537
Tabela 2.4 - Capacidade de Energia Eólica na América do Sul no final de 2007 [GWEC]
América do Norte	Final de 2006	Durante 2007	Final de 2007
USA	11,575	5,244	16,818
Canada	1,460	386	1,846
Total	13,035	5,630	18,664
Tabela 2.5 - Capacidade de Energia Eólica em América do Norte no final de 2007 [GWEC]
Região do Pacífico	Final de 2006	Durante 2007	Final de 2007
Austrália	817	7	824
Nova Zelândia	171	151	322
Ilhas Pacífico	12	0	12
Total	10,000	158	1,158
Tabela 2.6 - Capacidade de Energia Eólica na região do Pacífico no final de 2007 [GWEC]
Figura 2.12 - Capacidade anual de instalação de Energia Eólica por região 2003-2007 [GWEC]
2.5.3.	Aspectos Económicos da Energia Eólica
A questão energética está sempre ligada ao desenvolvimento de uma região ou pais. É nos países mais desenvolvidos que estão os grandes parques eólicos com capacidade para produção de muitos MWs [9] [12] [13]. Hoje, é necessária muito mais energia eléctrica, e cada vez mais, do que em qualquer outro período da historia industrial. Em consequência, também são muito mais visíveis os efeitos dessa elevada necessidade de energia, ligada à industrialização, com os crescentes índices de poluição.
As abordagens económicas de sistemas eólicos com ligação à rede podem ser feitas do ponto de vista das autoridades governamentais que regulam os custos anuais de energia €/kWh para as diferentes formas de produção de energia. Esta abordagem é feita ao nível da economia internacional não incluindo factores sociais ou influências governamentais tais como taxas de inflação, taxas de CO2 ou outro tipo de taxas. O outro tipo de abordagem é da perspectiva dos investidores privados na produção de energia eléctrica. Nesta abordagem já estão incluídos as taxas10 aplicadas por cada país. Como consequência, e devido ao nível da economia de cada país, a viabilidade dos sistemas de energia eólica difere muito de país para país. Ainda na perspectiva dos investidores privados, a análise económica poderá ser feita de duas formas diferentes: considerando os custos anuais de energia €/kW; ou fazendo um estudo individual para cada projecto onde se tem em conta o montante do investimento, o cash-flow e o tempo de amortização do investimento.
Estudos da EWEA demonstram que o preço €/kWh de energia eólica está inflacionado e pode ter uma elevada redução (cerca de 25%), com o incentivo e ajuda em novos desenvolvimentos da tecnologia e com o aumento do volume da produção.
Portugal, no âmbito da Estratégia de Sustentabilidade Económica, Social e Ambiental, tem vindo a investir cada vez mais em energias renováveis, o que lhe faculta uma maior independência energética e um aumento da competitividade. Considera-se assim, que o investimento neste tipo de energias é um elemento das políticas económicas anti-crise.
10 Taxa de inflação, taxa de actualização, entre outras taxas.
2.6.	Aerogeradores
Como referido no ponto 2.5.1.2 - História do uso os moinhos foram uma das primeiras aplicações com suporte no vento, que evoluiu para os aerogeradores com o elevado aumento de produção de energia e a necessidade de esta ser produzida utilizando os recursos naturais (inesgotáveis) possíveis. Assim, no decorrer do último século existiram grandes avanços para chegar dos moinhos aos aerogeradores com MW que são instalados actualmente.
Em finais do séc. XIX construiu-se o primeiro aerogerador para a produção eléctrica [1]. Este moinho de vento foi construído por Charles Brush (1849 - 1929) e tinha 17 metros de altura e um rotor de 144 pás, totalmente construído de madeira de cedro. Charles Brush foi um dos fundadores da energia eléctrica. Entre as suas descobertas destaca-se o dínamo11 utilizado na rede eléctrica pública.
Figura 2.13 - Aerogerador inventado por Charles Brush12
Pouco depois, o dinamarquês Poul la Cour (1846-1908), que teve, originalmente, uma formação como meteorologista, descobriu que os geradores de vento que rodavam rapidamente e possuíam rotores com poucas pás geravam electricidade mais eficientemente que os geradores de vento de movimento lento com rotores de muitas pás. Ele preocupou-se com o armazenamento de energia e por essa razão, utilizava a electricidade produzida pelos geradores eólicos para obter hidrogénio para as lâmpadas de gás. 11 12
11	Sistema de rotação que transforma energia mecânica em eléctrica.
12	Imagem retirada de www.naosmm.org/confer/cleveland/first.html
Figura 2.14 - Aerogeradores descobertos por Poul la Cour13
Isto proporcionou inúmeros avanços nos geradores eólicos durante o séc. XX. Estes avanços incluem a introdução dos geradores de corrente alterna, a normalização do modelo com rotor, das equipas de orientação electromecánicas para assegurar-se de que o rotor está sempre virado directamente de para vento, e de freios de controlo para prevenir que o rotor rode demasiado rápido face a ventos fortes. Os aerogeradores modernos têm poucas pás mas estas são muito mais largas para capturar energia do vento.
Em 1956, foi construído um inovador aerogerador, por J. Juul para a companhia eléctrica SEAS, na costa de Gedser, na parte sul da Dinamarca. O aerogerador constituído por 3 pás, com orientação electromecánica e um gerador assíncrono, foi um desenho pioneiro, apesar do rotor, com cabos de apoio, parecer um modelo ultrapassado. Este gerador possuía a opção de regulação aerodinámica. Foram inventados freios aerodinámicos de emergência na ponta das pás, que se soltavam com o aumento da velocidade (força centrífuga). Basicamente, é o mesmo sistema utilizado nos actuais aerogeradores de regulação aerodinámica. Durante muitos anos, este gerador foi o maior do mundo.
Figura 2.15 - Aerogerador de Gedser14
13 Imagem retirada de www.windpower.org/en/pictures/lacour.htm
O aerogerador de Gedser foi evoluído, em 1975, a pedido da NASA, para os Estados Unidos verificarem a viabilidade da produção da energia eólica, isto depois da primeira crise do petróleo, em 1973. O interesse pela energia eólica disparou e nos Estados Unidos foram instalados, entre 1980 e 1995 cerca de 1700 MW de capacidade eólica, mais de metade depois de 1985 quando as taxas de crédito foram reduzidas 15%.
No inicio dos anos 80, muitas das questões tecnologias ligadas aos rotores foram investigadas. Os rotores de aço, foram rejeitados por serem demasiado pesados, o alumínio foi considerada demasiado incerto no contexto de fadiga. A construção foi dominada pela fibra de poliéster.
O crescimento da energia eólica na Califórnia não foi sustentado, em contrapartida, na Europa existiu um marcante desenvolvimento, por exemplo, na Alemanha com uma taxa de instalação de cerca de 200 MW por ano, no inicio da década de 1990. Desde então, na Europa, o número de fabricantes ligados á exploração da energia eólica é maior, e têm evoluído muito tecnologicamente na produção de aerogeradores.
Actualmente tem existido uma grande diversificação na produção e instalação de aerogeradores. Cada vez mais os aerogeradores instalador nos parques eólicos são de maior potência, na ordem dos 2/5 MW, e de maiores dimensões, na ordem da centena de metros (ver Figura 2.16), mas por seu lado a produção de micro aerogeradores caseiros ou para pequenos sistemas (na ordem dos poucos KW) também tem vindo a crescer a um ritmo bastante elevado na última década.
Figura 2.16 - Relação potência x tamanho dos Aerogeradores [EWEA] [11]
2.6.1.	Tipos de Aerogeradores
Apesar do princípio de funcionamento de um aerogerador ser fácil de entender, e já referido pelo autor da tese, esta máquina é um sistema complexo que resulta de várias áreas
14Imagem retirada de
httD://www.intranet.cathedralgrammar.school.nz/Inhouse%20web%20sites/WindPower/fr/pictures/iuul.htm
de conhecimento tais como aerodinâmica, mecânica, eléctrica e controlo. As pás das máquinas modernas são dispositivos aerodinâmicos com perfis especialmente desenvolvidos, equivalentes às asas dos aviões, e que funcionam pelo princípio físico da sustentação. São as pás juntamente com a velocidade do vento permitem rodar
Actualmente os principais geradores existentes no mercado são de três tipos. As principais diferenças entre eles dizem respeito ao sistema de geração e o modo como a eficiência aerodinâmica do rotor é limitada durante as altas velocidades do vento de maneira a prevenir sobrecargas mecânicas. Os três tipos são:
-	Gerador de indução de rotor em gaiola;
-	Gerador de indução duplamente alimentado (rotor bobinado);
-	Gerador síncrono acoplado directamente ao rotor do gerador eólico;
O primeiro sistema de geração é o mais antigo. Este sistema consiste num gerador de indução de rotor em gaiola conectado directamente a rede eléctrica. O escorregamento e, consequentemente, a velocidade, variam com a quantidade de potência gerada. A variação de velocidade, contudo, é pequena, aproximadamente 1% a 2%. Dessa forma, este tipo de sistema é chamado de velocidade constante ou aerogerador de velocidade fixa. De referir que o gerador de indução de rotor em gaiola usado em aerogeradores pode girar em duas velocidades diferentes, mas constantes, pela mudança do número de pólos do enrolamento do estator. O gerador de indução de rotor em gaiola consome energia reactiva. Na maioria dos casos isto é particularmente indesejado por causa dos problemas de nível de tensão no ponto de conexão devido ao fluxo de potência reactiva na rede eléctrica. Dessa forma, o consumo de potência reactiva pelo gerador de indução é compensado, em parte ou totalmente, por condensadores. Os outros dois sistemas de geração são os de velocidade variável. Para permitir a operação em velocidade variável, a velocidade mecânica e a frequência da rede devem estar desacopladas. Para tal, são usados dispositivos electrónicos. No gerador de indução duplamente alimentado um conversor alimenta o enrolamento trifásico do rotor. Desse modo, a frequência mecânica e eléctrica do rotor estão desacopladas e a frequência eléctrica do estator e do rotor são equivalentes, independente da velocidade mecânica do rotor. Este sistema tem as seguintes vantagens:
-Redução de custo do inversor, pois a potência do mesmo é da ordem de 25% da potência total do sistema;
-Redução de custo dos filtros, pois os mesmos são dimensionados para 25% da potência total do sistema, e os harmónicos produzidos pelo inversor representa apenas uma pequena fracção da distorção harmónica total;
-Ganho de eficiência de aproximadamente 2% a 3%;
-Desacoplamento das potências activa e reactiva do gerador;
-Implementação do controlo do factor de potência, pois o conjunto gerador de indução e inversor operam basicamente como um gerador síncrono. O inversor fornece a potência de excitação para a máquina de indução.
No caso do gerador síncrono acoplado directamente ao eixo do gerador eólico, o mesmo é completamente desacoplado da rede eléctrica por um dispositivo electrónico conectado aos enrolamentos do estator. O gerador síncrono é excitado usando um enrolamento de campo ou ímãs permanentes. Este sistema tem como principal vantagem
-O inversor deve ser dimensionado para suportar a potência total do sistema;
-Como consequência a eficiência do inversor vai afectar a eficiência total do sistema.
Os aerogeradores são normalmente caracterizados pela orientação do eixo do rotor: vertical e horizontal. Apesar de os geradores eólicos de eixo vertical terem as grandes vantagens o facto de o gerador estar na base e de poder captar os ventos sem nenhum mecanismo de orientação, os geradores eólicos de eixo horizontal são as mais produzidas e comercializadas. Poucos são os aerogeradores de eixo vertical que se encontram disponíveis comercialmente.
2.6.1.1.	Aerogeradores de Eixo Vertical
Os aerogeradores de eixo vertical têm a vantagem de não necessitarem de mecanismos para variações em função da direcção do vento, o que reduz a complexidade do projecto. Estes também podem ser movidos por forças de sustentação (lift) e por forças de arrasto (drag). Os principais tipos de rotores de eixo vertical são Darrieus e Savonius. Os rotores do tipo Darrieus são movidos por forças de sustentação e constituem-se de lâminas curvas (duas ou três) de perfil aerodinâmico, atadas pelas duas pontas ao eixo vertical. Apesar de os aerogeradores com eixo vertical existirem há séculos, não são menos comuns, devido ao facto de aproveitarem menos as velocidades altas dos ventos em grandes elevações e à sua incapacidade de auto-arranque necessitando de meios externos de auxílio.
Figura 2.17 - Aerogerador Darrieus e Savonius, respectivamente15
2.6.1.2.	Aerogeradores de Eixo Horizontal
Os rotores de eixo horizontal são os mais explorados mundialmente na produção de energia eólica. São movidos por forças aerodinâmicas chamadas de forças de sustentação
15 Imagens retiradas de http://www.bellera.org/molins/aerogeneradors darrieus.htm e www.oswego.edu/nova/facts/wind/wind.html
(lift) e forças de arrasto (drag). Os projectos das pás deste tipo de rotores, beneficiaram da tecnologia das asas dos aviões, que têm o mesmo princípio de funcionamento. Ambas as forças aerodinâmicas que actuam nas pás do rotor são proporcionais ao quadrado da velocidade relativa do vento. Adicionalmente, as forças de sustentação dependem da geometria do corpo e do ângulo de ataque16.
Os rotores de eixo horizontal ao são predominantemente movidos por forças de sustentação e devem possuir mecanismos capazes de permitir as pás estejam sempre em posição perpendicular ao vento. Estes rotores podem ser constituídos de uma pá e contrapeso, duas pás, três pás ou múltiplas pás. As pás podem ser dos mais variados materiais e ter as mais variadas formas. Em geral, utilizam-se pás rígidas de madeira, alumínio ou fibra de vidro reforçada. Os rotores mais utilizados para geração de energia eléctrica são os de eixo horizontal (tipo hélice), ultimamente compostos de 3 pás. A Figura
2.18 ilustra um gerador eólico de grande porte.
Figura 2.18 - Aerogerador de 3 pás e eixo horizontal17
2.6.2.	Dimensões dos Aerogeradores
A dimensão dos aerogeradores depende da potência que desejamos. Quanto mais energia for produzida pelo aerogerador maior é o seu tamanho. Actualmente existe uma grande gama de geradores eólicas, que podem ser divididos quanto ao seu tamanho (potência):
Pequeno porte: possuem potências nominais na faixa de centenas de W a unidades de kW e diâmetros de rotor de 2m a 10m, sendo destinadas tipicamente à utilização em sistemas isolados
Médio porte: potências nominais na faixa de unidades a dezenas de kW e diâmetros de rotor de 10m a 15m;
Grande porte: potências nominais variando de centenas de kW a unidades de MW e diâmetros de rotor de 30m a 100m, sendo destinadas à utilização em parques eólicos. As maiores máquinas disponíveis comercialmente têm potência nominal entre 2 e 5 MW.
16	Ângulo entre o vento e a superfície das pás
17	Imagem retirada de httD://engambiente3.blogspot.com/2007/08/turbina-de-eixo-vertical.html
		
Universidade de Aveiro	40	
Todos estes geradores eólicos produzem energia para fornecerem a rede eléctrica mas a produção de energia pode ter outros fins (ver 2.7.2 - Aplicações dos Sistemas Eólicos).
Para estimar a energia produzida por uma máquina eólica é necessário conhecer, além das características da máquina que será utilizada (curva potência x velocidade do vento), a distribuição estatística da velocidade do vento no local onde ela será instalada.
2.6.3.	Componentes de um Aerogerador
Na Figura 2.19 estão identificados os componentes de um sistema eólico de um aerogerador de eixo horizontal, dos mais comuns e mais modernos para interligar à rede eléctrica [1], entre os quais se destacam:
-o vento: fonte de energia natural responsável pela instalação do sistema eólico;
-o rotor: responsável por transformar energia cinética do vento em energia mecânica de rotação;
-a cabine: que contém o sistema mecânico;
-a transmissão ou caixa de velocidades: responsável por transmitir a energia mecânica entregue pelo eixo do rotor até ao gerador. Alguns geradores não utilizam este componente, neste caso o eixo do rotor está directamente acoplado;
-o gerador eléctrico: responsável pela produção de energia eléctrica a partir de energia mecânica;
-os mecanismos de controlo: responsável pela orientação do rotor, controlo de velocidade, controlo de carga;
-a torre: que permite elevar as pás e todo o sistema mecânico e eléctrico para ventos mais regulares;
Figura 2.19 - Componentes de um Gerador Eólico NORDEX N54 [1]
1 - pás do rotor; 2 - cubo do rotor; 3 - cabine; 4 - chumaceira do rotor; 5 - veio do rotor; 6 - caixa de velocidades; 7 - travão de disco; 8 - veio do gerador; 9 - gerador; 10 -sistema de arrefecimento; 12 - anemómetro e sensor de direcção; 13 - sistema de controlo; 14 - sistema hidráulico; 15 - mecanismo de orientação direccional; 16 - chumaceira do mecanismo de orientação direccional; 17 - cobertura da cabine; 18 - torre;
2.6.3.I.	Rotor Eólico
Sendo o rotor o componente do sistema eólico responsável por captar a energia cinética dos ventos e transformá-la em energia mecânica de rotação, é também, o componente mais característico de um sistema eólico. A sua configuração influenciará directamente no rendimento global do sistema. Estes são classificados segundo vários critérios sendo o mais importante a orientação do eixo. Assim, existem os rotores de eixo horizontal e os rotores de eixo vertical (ver 2.6.1 Tipos de Aerogeradores).
2.6.3.2.	Transmissão
A transmissão possui a finalidade de expedir a energia mecânica entregue pelo eixo do rotor até ao gerador. É composta por eixos, mancais, engrenagens de transmissão e acoplamentos.
Este mecanismo é responsável por adaptar as velocidades reduzidas do rotor à velocidade de rotação muito mais elevada dos geradores. A velocidade angular dos rotores geralmente varia na faixa de 20 a 150 RPM, limitada pela velocidade na ponta das pás que superior (tip speed). Os geradores (principalmente os geradores síncronos) trabalham a rotações muito mais elevadas (normalmente, entre 1200 a 1800 RPM), sendo portanto necessário a instalação de um sistema de multiplicação entre os eixos. Actualmente, alguns aerogeradores construídos por alguns fabricantes não têm transmissão. Assim, em vez de ser utilizada uma caixa de velocidades para adaptar as velocidades do rotor e do gerador, são utilizados geradores de baixa velocidade. Ambos os sistemas, com ou sem transmissão, têm vantagens e desvantagens. A escolha deve ser feita mediante os objectivos do sistema eólico.
2.6.3.3.	Geradores
A transformação da energia mecânica de rotação em energia eléctrica através de equipamentos de conversão electromecânica é um problema tecnologicamente evoluído. Contudo, muitos fabricantes tem dado uma resposta a este problema tecnológico e cada vez mais têm sido instalados sistemas eólicos e com geradores capazes de produzir mais energia eléctrica, por todo o mundo. As características dos geradores eólicos podem ser consultadas no ponto 2.6 - Aerogeradores.
2.6.3.4.	Torre
A torre suporta a cabine e eleva o rotor até uma altura onde a velocidade do vento é maior, com menos perturbações e mais constante. As torres modernas podem ter 100m, pelo que a estrutura tem de ser dimensionada para suportar a carga significativa da cabine, bem como para resistir à exposição de condições naturais rigorosas durante a sua vida útil (cerca de 20 anos).
A produção destas torres tem sido dividida em dois tipos: tubulares, de betão ou aço, sendo constituída por vários elementos montados no local com auxílio a uma grua; ou entrelaçadas, mais baratas, com suportes mais ligeiros, contudo têm vindo a ser menos utilizadas devido a questões de impacto visual.
2.6.4.	Mecanismos de controlo
Os mecanismos de controlo são essenciais ao funcionamento do aerogerador evitando danos estruturais e permitindo a orientação do rotor, o controlo de velocidade, o controlo de carga, entre outros. Estes mecanismos permitem limitar a potência extraída do vento pelas pás, evitando que a potência obtida com ventos superiores ao nominal provoque a destruição dos componentes do sistema eólico.
Os mecanismos de controlo podem ser mecânicos (velocidade, passo, freio), aerodinâmicos (posicionamento do rotor), ou electrónicos (controlo da carga).
Devido à actuação das forças aerodinâmicas nas pás do rotor, uma torre eólica converte a energia cinética do vento em energia mecânica rotacional. Estas forças aerodinâmicas são geradas ao longo das pás do rotor que necessitam de perfis especialmente projectados. Com a velocidade do fluxo de ar aumentando, as forças de sustentação aerodinâmica aumentam com a segunda potência (i.e., elevada ao quadrado) e a energia extraída do rotor com a terceira potência (i.e., elevada ao cubo) da velocidade do vento. Esta situação necessita de um controlo de potência do rotor muito efectivo e rápido de modo a evitar sobre carregamento eléctrico e mecânico no sistema de transmissão.
Os modernos de aerogeradores utilizam dois diferentes princípios de controlo aerodinâmico para limitar a extracção de potência à potência nominal do aerogerador, chamados de controlo de perdas aerodinâmicas (stall) e controlo do ângulo de passo (pitch).
2.6.4.1.	Controlo de Ângulo de Passo (Pitch)
O controlo de passo é um sistema activo que normalmente necessita de uma informação vinda do controlador do sistema. Sempre que a velocidade do vento aumente e leve a que a potência produzida pelo aerogerador ultrapasse uma potência específica, o controlador envia um sinal ao mecanismo de mudança do ângulo de passo e as pás do rotor giram em torno do seu eixo longitudinal, i.e., as pás mudam o seu ângulo de passo para reduzir o ângulo de ataque de forma a diminuir a oposição ao vento. Esta redução diminui as forças aerodinâmicas (sustentação e de arrasto) e, consequentemente, a extracção de potência.
Para velocidades do vento superiores à velocidade nominal do aerogerador, o ângulo é alterado e mantido de forma a produzir apenas a potência nominal. Os aerogeradores com este mecanismo são mais sofisticados porque necessitam de um sistema de variação do ângulo de passo, que funciona de forma hidráulica.
Este mecanismo de controlo tem como vantagens permitir o dito controlo de produção de potência para quase todas as condições do vento, alcançando a potência nominal mesmo para condições em que a massa de ar é baixa. Verifica-se, portanto, que a instalação deste tipo de aerogeradores em grandes altitudes é aconselhável permitindo inúmeras vantagens, tais como: uma maior produção de energia sob as mesmas condições, a inutilidade de sistemas de travagem e possibilidade de as pás serem colocadas de modo a permitirem a passagem de ventos elevados sem grande obstáculo.
2.6.4.2.	Controlo de Perdas (Stall)
Ao contrário do controlo de perdas de ángulo de passo, em que o sistema para velocidades elevadas reage apenas com informação vinda do sistema de controlo (sistema activo), o controlo de perdas aerodinámicas (stall) é um sistema passivo que reage à velocidade do vento. As pás do rotor são fixas e não podem girar em torno do seu eixo longitudinal. Como tal, o ángulo de passo tem de ser escolhido de forma que, para velocidades de vento superiores a velocidade nominal, o aerogerador entre em perdas aerodinámicas, reduzindo as forças de sustentação e aumentando as forças de arrasto. Assim, e devido a menores forças de sustentação e maiores de arrasto, o rotor mantém a velocidade não aumentando a velocidade com o vento. Para evitar que o efeito stall ocorra em todas as posições radiais das pás ao mesmo tempo, o que reduziria significativamente a potência do rotor, as pás possuem uma pequena torção longitudinal que as levam a um suave desenvolvimento deste efeito.
A produção deste modelo de aerogeradores apresenta certas vantagens, tais como: ter uma estrutura da cabine do rotor muito mais simples e mais robusto, uma vez não ser necessário o sistema de controlo de passo. A manutenção dos sistemas com este tipo de controlo também é menor devido ao facto de existirem menos peças móveis, tornando o sistema muito mais simples. Contudo, como a aerodinámica das pás é maior, estas têm de ser cuidadosamente projectadas para uma potência nominal.
2.6.4.3. Controlo Stall Activo
Ultimamente têm sido produzidos aerogeradores com um mecanismo de controlo denominado stall activo, que consiste na junção dos dois tipos de sistemas de controlo stall e de passo (pitch), cujo objectivo é aproveitar as vantagens de ambos.
Tecnicamente as máquinas de regulação activa por perda aerodinámica (stall) são parecidas com as de controlo de pitch, contudo o controlo de perdas aerodinámicas permite uma maior regulação da produção de potência do que com regulação passiva (pitch). Outra
2.6.4.4. Pitch vsStall
A discussão em torno de qual o método de controlo mais vantajoso tem sido grande na industria eólica. Até ao aparecimento da produção de Aerogeradores com capacidades de MW, em meados da década de 1990, o controlo do tipo Stall era predominante em relação ao controlo Pitch [1]. No entanto, actualmente o controlo Picth é o favorito para os Aerogeradores de grande porte, existindo hoje mais do dobro de Aerogeradores com controlo Picth no mercado. Este facto acontece devido a uma combinação de vários factores. Os Custos globais são bastante semelhantes para cada tipo de desenho, mas o controlo Picth oferece potencialmente melhor qualidade e potência de saída (este talvez tenha sido o factor mais importante no mercado alemão). As vibrações induzidas pelo controlo Stall, tem motivado uma certa preocupação, especialmente para as maiores máquinas. Têm sido poucos os indícios de que ocorram estas vibrações em grande escala, embora tenha havido problemas específicos associados com perdas de amortecimento aerodinâmico. No entanto, esta tem sido abordada através da introdução de amortecedores de pás do rotor.
|—Ou» 100064—ICGMw 1CQ064 —*fcrifc«4rlÕÕÕ]
Figura 2.20 - Curvas de potência: pitch (Bonus) e stall (NEG e Nordex) [DanishAssoc]18
2.6.4.5.	Controlo de Azimute
Uma técnica para regulação da potência que está a cair em desuso é o desvio do rotor de modo a criar um erro de azimute em relação ao vento. Esta técnica é na prática, apenas utilizada por torres eólicas de pequeno porte devido à fadiga que provoca no rotor e que se transmite a toda a estrutura. O aerogerador apresenta um erro de yaw se o rotor não se apresentar perpendicular ao vento. Isto significa que apenas uma fracção da energia (cos j) disponível no vento pode ser aproveitada. No entanto, a parte do rotor que se apresenta mais avançada face ao vento é sujeita a uma força de torção superior á parte de trás do rotor, o que
18 Danish Wind Turbine Manufacturers Association
2.6.5.	Impacto Ambiental
A Energia Eólica é uma fonte produção de electricidade que além de ter uma grande rentabilidade e eficiência, tem também as vantagens de ter como fonte o vento, sendo este inesgotável, livre e abundante. É portanto, uma energia limpa que veio trazer enormes vantagens relativamente à redução da emissão de gases poluentes, mas apesar destas evidentes vantagens existem alguns efeitos secundários consideráveis que não podem ser esquecidos relativamente ao uso de aerogeradores. Destes constam elementos tais como: emissão de ruído, morte de aves, utilização de terrenos, impacto nas paisagens, interferências electromagnéticas e segurança, devem ser tomados em conta.
2.6.5.1.	Emissão de Ruído
O ruído produzido pelo funcionamento dos aerogeradores resulta da actividade mecânica e do efeito aerodinâmico dos mesmos. Para aerogeradores de médio/grande porte os efeitos aerodinâmicos contribuem de forma significativa para a emissão de ruídos, embora existam no mercado aerogeradores de baixo ruído19.
Os ruídos emitidos variam entre os 50dB junto do aerogerador e os 35dB a uma distância de 450m deste [1].
Os efeitos fisiológicos, sobre o sistema auditivo, que estes ruídos podem provocar, variam de organismo para organismo, mas só para valores superiores a 65dB é que o ruído pode ser considerado gravemente prejudicial. No entanto, para valores superiores a 30dB, o ruído pode provocar efeitos psíquicos sobre o homem, sedo claramente recomendado valores inferiores. O ruído com intensidade igual a 40dB corresponde a uma distância dos aerogeradores por volta dos 200m. Como tal esta deve ser a distância mínima das habitações ao aerogeradores. Esta distância é respeitada na Europa.
19 Nos sistemas que funcionam com velocidade variável, o gerador é de baixa rotação e a caixa de velocidades é dispensada.
2.6.5.2.	Impacto Visual nas Paisagens
O impacto visual dos aerogeradores modernos, com alturas da torre superiores a 40m e comprimento das pás de 20m, é perfeitamente visível nas paisagens e a alguns quilómetros de distância. Este impacto tem suscitado algumas controvérsias e restrições á colocação destes aerogeradores em determinadas paisagens. Para além do impacto óbvio, os efeitos das sombras em movimento e das reflexões intermitentes, devido a incidência do sol nas pás são também efeitos incomodativos que podem ser ultrapassados com um prévio planeamento do parque.
Por vezes, e com vista a minimizar o impacto visual, os aerogeradores são pintados em conformidade com a paisagem.
2.6.5.3.	Aproveitamento de Terrenos
A construção de parques eólicos inviabiliza a utilização do terreno para diferentes fins, contudo, a actividade agrícola poderá ser continuada em alguns casos. A instalação das torres eólicas constitui um princípio de compromisso, uma vez que a área ocupada pelos parques não pode ser muito grande para não encarecer o projecto do parque mas também não pode ser muito reduzida. A redução da área dos parques eólicos provocaria um mau funcionamento dos aerogeradores devido a estes serem afectados por perturbações aerodinâmicas dos aerogeradores vizinhos. A colocação de obstáculos entre os aerogeradores iria contribuir também para a criação de perturbações e instabilidades aerodinâmicas afectando a produção de energia do parque. Apesar disso, e de uma forma geral, os aerogeradores e os parques eólicos não alteram significativamente o habitat natural.
A área ocupada pelos parques eólicos não é excessiva, comparando com outras energias alternativas, como o caso das hídricas. A relação entre a área das pás e a potência dos aerogeradores é de aproximadamente 3 m2/kW. Como exemplo, podemos observar que um aerogerador de 500 kW terá um comprimento de pás de aproximadamente 21 m.
Estes factos implicam que a distância entre aerogeradores respeite uma distância mínima de 4 a 5 vezes o comprimento das pás. Assim, podemos admitir que a área necessária para a instalação de um parque eólico anda á volta dos 8 a 12 MW/km2.
2.6.5.4.	Balanço Energético
O balanço energético resultante da energia necessária para produzir, instalar e manter um parque eólico é claramente positivo, apesar de a produção de energia estar muito dependente de factores externos como a existência de vento. Contudo, ao fim de um ano de funcionamento normal e regular do parque eólico, essa energia terá sido produzida. O balanço energético na energia eólica é dos melhores, tornando a produção desta energia muito atractiva.
2.6.5.5.	Impacto sobre Aves Migratórias
Uma descuidada planificação prévia da instalação de um parque eólico pode provocar a colisão de aves com as pás do aerogerador provocando a morte, sobretudo se o parque estiver localizado na rota de aves migratórias. Apesar disso, estes incidentes não são significativos na grande maioria dos parques actualmente instalados.
2.6.5.6.	Interferências electromagnéticas
Em casos pontuais, a reflexão de ondas electromagnéticas podem perturbar sistemas de telecomunicações, no entanto, essas interferências não costumam ser significativas. Contudo, poderá ser necessário um estudo mais aprofundado em alguns casos.
2.6.5.7.	Segurança
No que diz respeito á segurança, verifica-se que os parques eólicos instalados são bastante seguros, constituindo esta uma das formas mais seguras de produzir energia eléctrica. Apenas há a referir pequenos pedaços de pás que provocaram alguns ferimentos.
2.7.	Sistema Eólico
Os sistemas eólicos são constituídos por um aerogerador e por todas as suas componentes mas também, dependendo da aplicação para o qual é utilizado, pode ser constituído por inversores, transformadores, sistemas de armazenamento de energia.
2.7.1.	Sistema de Armazenamento de Energia
Como a velocidade e direcção do vento é muito instável, nem sempre o sistema eólico está a produzir energia por forma a poder ter uma distribuição mais uniforme e a necessidade de um fornecimento mais adequado (mais constante), pode ser necessário, mediante a aplicação, um sistema de armazenamento de energia.
Nos casos em que a energia eólica é produzida para ser injectada directamente na rede não é necessário o armazenamento da energia.
Quando a energia eólica é utilizada como fonte primária de energia, é necessário armazenamento da energia produzida para estar disponível para consumo. Este armazenamento é indispensável devido à aleatoriedade dos períodos de intensidade da velocidade do vento e de produção de energia, para poder ser utilizada posteriormente. As formas mais utilizadas de armazenamento de energia eólica são através de baterias ou sob a forma de energia potencial gravitacional [1].
2.7.2.	Aplicações dos Sistemas Eólicos
Os sistemas de energia eólica são caracterizados por diferentes dimensões e para diferentes aplicações consoante a disponibilidade financeira ou natural (vento). No entanto, os sistemas eólicos instalados obedecem a uma configuração tipo, são constituídos por uma unidade central de controlo de produção de potência, e dependendo da aplicação e das necessidades, por um sistema de armazenamento da energia. Contudo, as instalações dos sistemas eólicos generalizam-se em aplicações de sistemas distribuídos de grandes dimensões (ligados à rede), isolados de pequenas dimensões e híbridos de dimensões médias.
2.7.2.I.	Sistemas Isolados
Os sistemas de pequenas dimensões, geralmente, encontram-se privados de energia eléctrica e são usados para armazenar energia em baterias de modo a serem usada quando necessária. Estes sistemas eólicos com capacidade de produção de potência, até algumas dezenas de kW, são muito bem sucedidos comercialmente. Alguns sistemas isolados não necessitam de armazenamento de energia, como no caso dos sistemas de rega ou aquecimento. Estes sistemas de bombagem de água são numericamente os mais representativos.
2.7.2.2.	Sistemas Híbridos
Os sistemas híbridos são aqueles que apresentam mais do que uma fonte de energia como, por exemplo, torres eólicas, geradores diesel, módulos foto voltaicos, entre outras. Representando esta, a grande diferença em relação aos sistemas isolado. Contudo, a utilização de várias fontes de geração de energia eléctrica aumenta a complexidade do sistema e exige a optimização do uso de cada uma das fontes. Nesses casos, é necessário realizar um controlo de todas as fontes para que haja máxima eficiência e optimização dos fluxos energéticos na entrega da energia para o usuário. Estes podem ter ou não sistemas de armazenamento de energia.
Em geral, a capacidade de produção dos sistemas híbridos varia entre as dezenas e centenas de kW (sistemas de médio porte) sendo dimensionados consoante as necessidades implicando um estudo prévio para o seu dimensionamento. Como tal, o valor deste sistema é elevado pela necessidade do referido estudo.
2.7.2.3.	Sistemas Distribuídos
Os sistemas interligados à rede não necessitam de sistemas de armazenamento de energia pois toda a energia produzida é entregue directamente à rede eléctrica. Estes sistemas apresentam as vantagens inerentes aos sistemas de geração distribuída, tais como: a
redução de perdas e do custo proveniente da expansão de rede. A geração durante o regime dos ventos coincide com o pico da curva de carga.
Estes sistemas encontram-se normalmente agrupados num parque eólico com capacidades actuais de dezenas ou centenas de MW ligados directamente á rede.
2.7.3. Sistemas em "Offshore"
Actualmente, as instalações offshore constituem apenas uma pequena parte do mercado e contribuem de forma menos significativa na produção de energia. Contudo, os sistemas "offshore" têm grande potencial, e esse tem sido o principal motivo de desenvolvimento tecnológico para a concepção de Aerogeradores de grande porte [3] [4].
Há 10 anos atrás começaram a dar-se os primeiros passos na instalação "offshore", mas actualmente, com a concepção dos Aerogeradores de maior porte, o desenvolvimento deste tipo de projectos está mais atractivo. Ironicamente, as condições ambientais são frequentemente mais hostis do que as condições terrestres onde são instalados os parques eólicos "onshore". Toda a logística de transporte, montagem e manutenção de Aerogeradores em "offshore" é um grande desafio e bem mais difícil de sustentar.
Em 2003, a EWEA publicou um cenário de previsões para a energia eólica, onde incluía a meta de 70 GW para a energia eólica em "offshore". Por diversas razões, politicas e industriais, essa meta ainda não foi cumprida, mas se a energia eólica em "offshore" crescer ao mesmo ritmo da energia em "onshore", cuja taxa média anual foi de 33,4% nos últimos anos, em 2020 estarão instalados cerca de 50GW de energia eólica em "offshore". No final de 2007, a energia eólica instalada em "offshore" é cerca de 1100MW mas muitos projectos já estão planeados até 2015 e muitos mais aerogeradores serão instalados nos próximos anos [3] [4].
Pode ser consultado no ANEXO A os parques eólicos instalados em "offshore", os que estão em construção e os que estão planeados até 2015, em alguns dos principais países produtores de energia eólica em "offshore" do mundo.
Figura 2.22 - Aerogerador em "offshore”
3.1.	Introdução
Neste capítulo o autor irá modelar o Sistema Eolitor em notação UML, utilizando o modelo de especificação baseado no método SLiM do grupo SIAS20 (Sistemas de Informação na Área da Saúde). As informações mais relevante irão ser mantidas no prolongar deste documento, as restantes poderão ser consultadas no ANEXO B do mesmo.
3.1.1.	Visão geral do sistema
Nos últimos anos tem ocorrido um aumento significativo no interesse da utilização de fontes renováveis para a produção de energia eléctrica. Uma das razões principais em destaque foi a necessidade de encontrar alternativas que ajudem a minimizar o uso de combustíveis fósseis, devido á sua limitação física, o seu elevado custo, e por serem muito poluentes. Como já foi referido anteriormente, na base desta mudança de paradigma estão os graves problemas ambientais causados pela emissão de gases de efeito de estufa e a grave crise energética de petróleo e seus derivados.
Grandes empresas mundiais da área das energias têm feito um grande investimento no desenvolvimento da tecnologia para permitir a produção de energia a partir de fontes naturais renováveis (sol, vento, ondas, biomassa, são exemplos). Na base deste investimento, estão objectivos como por exemplo, até 2010, 40% da produção de energia deverá resultar da exploração das energias alternativas. A liderança desta mudança de paradigma deverá ser assumida pelos governos e pelas próprias empresas, também responsáveis por ensinar os seus clientes a consumirem energia de forma mais eficiente (outro dos grandes problemas tem sido o aumento do consumo de forma descontrolada).
As energias renováveis são um novo folgo no combate ao aquecimento global. Como tal, para optimizar a produção é necessário optimizar a monitorização e controlo de todo o sistema eólico. O objectivo deste sistema é precisamente monitorizar e controlar um sistema eólico.
20	www.ieeta.pt/sias
		
Universidade de Aveiro	51	
3.1.2.	Âmbito
A proposta deste projecto aponta para criação e implementação de um sistema de monitorização e controlo de parâmetros eólicos e eléctricos de um sistema eólico. Este sistema eólico caracteriza-se pela instalação de um aerogerador de 20kW, de um controlador e um inversor. Para tal, devem ser implementadas as seguintes funcionalidades:
Sistema de Monitorização - um sistema que permita o controlo de todo o sistema eólico de modo a poder monitorizar e optimizar o seu desempenho na produção de energia eléctrica. Ao nível do hardware serão usados microcontroladores e diferentes sensores que serão integrados em PCBs. Será igualmente usada tecnologia sem fios (Bluetooth ou ZigBee) para comunicação com um PC como Servidor que recebe, processa e armazena os dados da monitorização numa base de dados.
Sistema de Informação - um sistema que permita a visualização das informações da monitorização em tempo real ou de posteriores consultas através da criação de gráficos e configuração do sistema. Este sistema deve ser constituído por uma interface Web (desenvolvida em ASP.NET), por uma interface móvel (PDAs/SmartPhones) e por uma interface local/remota (programa de computador desenvolvido em VB.NET).
Base de Dados - uma base de dados (em MSSQL Server) que permita armazenar dados relativos ao sistema, ao histórico de eventos e de resultados da produção de energia.
Fora do âmbito deste sistema fica o estudo prévio que foi feito para ver a disponibilidade e viabilidade da instalação de um Aerogerador, bem como toda a negociação para a compra e instalação do Aerogerador, no qual participaram o Administrador/Cliente e o Vendedor como principais e únicos actores.
Monitorizar
Fabricante/Vendedor
Administrador/Cliente
Técnico Instalador
Visualizar Resultados
Instalação do
Aerogerador
Estudar Viabilidede do Local
Sistema Eolitor
A
Utilizador
Diagrama 3.1 - Diagrama do Âmbito do Projecto
		
Universidade de Aveiro	52	
©
SUM ////'
3.1.3.	Cliente
Este sistema será produzido no âmbito de um projecto de mestrado21 no IEETA22 (Instituto de Electrónica e Telemática de Aveiro) o qual será proprietário de todo o sistema, sendo responsável pelo desenvolvimento e manutenção do mesmo.
3.1.4.	Fontes e material de referência
AMBLER, Scott W.; The elements of UML 2.0 style. Cambridge: Cambridge University Press, 2005.
NAIBURG, Eric J.; UML for database design. Boston: Addison - Wesley, 2001.
PILONE, Dan; PITMAN, Neil; UML 2.0 in a Nutshell. United States of America: O'Reilly Media, Inc, 2005.
RIORDAN, Rebecca M.; Designing Relational Database Systems. Washington: Microsoft Press, 1999.
CUNHA, João Paulo; SLiM: SIAS Light Method. Aveiro. - http://www.ieeta.sias
CUNHA, João Paulo; CUNHA, Bernardo; Proposta de tema de dissertação. Aveiro -http://www.av.it.pt/mi/docs/128.pdf
21	Proposta em http://www.av.it.pt/mi/docs/128.pdf
22	IEETA online http://www.ieeta.pt/
		
Universidade de Aveiro	53	
3.2.	Modelo de caso de utilização
3.2.1.	Visão geral
O projecto está organizado em vários packages tendo como objectivo facilitar a percepção mesmo. Pode ainda ser dividido em três camadas:
Base de dados: Camada de suporte do projecto onde são armazenados todos os valores de forma persistente.
Monitorização: Camada intermédia que permite a recolha de todas as informações do aerogerador e o processamento das mesmas informações. Composta por Hardware e Software desenvolvidos pelo autor.
Visualização: Camada superior de interface com os utilizadores do sistema, permitindo a visualização de todos os valores, incluindo gráficos e relatórios.
Em seguida são apresentados todos os Actores do sistema com uma descrição respectiva. Depois são apresentados todos os casos de utilização relativos a cada um dos Actores do sistema, sendo deita uma descrição dos mais importantes.
Diagrama 3.2 - Diagrama de Pacotes
3.2.2. Actores
Actor	Descrição
Administrador/Cliente	Responsável por adquirir e pagar o Aerogerador ao F abricante /Vendedor Participa no estudo prévio da viabilidade do projecto e do local da instalação do Aerogerador
		
Universidade de Aveiro	54	
Actor	Descrição
	Pode efectuar o pedido de manutenção do sistema eólico, aquando de uma avaria, ou em caso uma peça exceda o tempo de vida Responsável por negociar e vender a energia produzida para entrega à rede Responsável pela criação e gestão de todo o sistema de dados (hardware e software) de controlo do sistema eólico e pelo funcionamento do parque eólico Gestor de toda plataforma de sistemas de dados (local e remota) Providencias as alterações e desenvolvimento que achar convenientes tanto no sistema de dados e base de dados como na forma de aceder a eles (Interface gráfica), redimensionando o sistema com possíveis necessidades
F abricante /Vendedor	Proprietário das componentes do sistema eólico Parte responsável do negócio do Aerogerador e de todos os componentes Responsável pelo estudo prévio da viabilidade do projecto e do local da instalação do Aerogerador
Técnico de Instalação do Equipamento	Providencia pelas condições necessárias à execução da instalação, desde o local de instalação até à montagem de todo o sistema eólico garantindo o bom estado de funcionamento do equipamento. Responsável por instalar todos os componentes do Sistema Eólico Procede aos ensaios de forma a garantir o desempenho global do sistema aquando do arranque
Técnico Manutenção de equipamento	Efectua o diagnóstico de anomalias, reparação ou substituição das componentes responsáveis por dessas mesmas anomalias e efectua o ensaio do sistema eólico reparado. Autorização Pode ser avisado de alguma anomalia através do Administrador para substituir/reparar alguma componente. Pode coincidir com o técnico de Instalação.
Sistema Monitorização Local	Sistema responsável por registar o valor dos vários sensores instalados localmente e de enviar essa informação para o Sistema remoto por tecnologia Wireless
Sistema de Informação Remoto (Tratamento de Dados/Base de dados)	Sistema responsável por receber os dados e os descodificar armazenando-os num base de dados Permite também a visualização e o tratamento dos dados bem como o registo de alterações e novas componentes do Sistema Eólico
Utilizador geral	Utente do sistema que apenas pode observar o estado e informações publicas do sistema Apenas pode ver os resultados da produção do sistema e tem restrição
		
Universidade de Aveiro	55	
Actor	Descrição
	em toda a área de controlo e alterações do sistema
Tabela 3.1 - Tabela de descrição dos Actores do Sistema
Receber dados
Visualizar Dados
¡include»
«include»
Armazenar dados
Enviar Dados
Consultar Eventos
¡include»
Consultar Histórico
Utilizador
«include»
¡include»
Ler RTCC
Gerar Gráficos
Gerir e Desenvolver
Gerir e Desenvoh/er
Gerir e Desenvolver
Administrador
Comportamento
Aerogerador
Comportamento Aerogerador
Eolitor System
Sistema Monitorização
Sistema Informação
Base de dados
Preencher Trama
¡include»
Disponibilizar dados
Diagrama 3.3 - Diagrama de CaU do Administrador e de um Utilizador
Contratar grúa
«include»
Montar Aerogerador
(include»'
Avaliar local Instalação
Documentação Sistema Eólico
Verificar funcionamento
(extend »
I
I
I
Técnico Instalador
(include»
Abrir buraco
«include»
«include»
Fazer Suporte torre Eólica
Fazer ligações de
cabos
Diagrama 3.4 - Diagrama de CaU do Técnico Instalador
Substituir Peças
(include»1
(include»
Administrador
Notificar fim reparação
Actualizar Documentação
Verificar Funcionamento
Ensaiar e testar Sistema
Manutenção do Sistema
Sistema Eólico
(include»
«extend»
I /
A x
Técnico Manutenção
Diagrama 3.5 - Diagrama de CaU de Técnico de Manutenção
3.2.3.	Descrição dos Casos de Utilização
São descritos de seguida, os casos de utilização do sistema mais importante, incluindo as suas principais funcionalidades, e para os casos de utilização com uma sequência mais elaborada, é apresentado um diagrama de actividades, com o objectivo de tornar mais explícita a sua descrição.
Os restantes casos de utilização podem ser consultados no Anexo B.
3.2.3.I.	CaU1 Instalar Sensores
Nome:	CaU1 Instalar Sensores
Âmbito:	Sistema Eolitor.
Finalidade:	Permitir recolher dados de todo o sistema desde o estado do tempo até ao comportamento do Aerogerador e a produção de energia
Actores:	Administrador, Sistema de Monitorização
Pré-condições:	A cabine ainda não ter sido instalada em cima da torre uma vez depois ser impossível instalar os sensores no seu interior devido à altura da cabine
Requisitos especiais:	Ter sido feito um levantamento dos sensores mais convenientes para este sistema e quais os locais mais próprios para a sua instalação
Tabela 3.2 - Tabela de descrição do CaU1 Instalar Sensores
3.2.3.2.	CaU2 Criar Sistema de Monitorização
Nome:	CaU2 Criar Sistema de Monitorização
Âmbito:	Sistema Eolitor.
Finalidade:	Permitir recolher dados provenientes dos sensores e enviar para o sistema de informação
Actores:	Administrador, Sistema de Monitorização
Pré-condições:	O sistema eólico estar instalado juntamente com todos os sensores necessários à recolha de informação
Requisitos especiais:	Efectuar levantamento de quais as tecnologias mais indicadas para a criação do sistema de monitorização
Tabela 3.3 - Tabela de descrição do CaU2 Criar Sistema de Monitorização
3.2.3.3.	CaU3 Projectar Base de Dados
Nome:	CaU3 Projectar Base de Dados
Âmbito:	Sistema Eolitor.
Finalidade:	Permitir armazenar dados recebidos e tratados pelo sistema de informação ou introduzidos no sistema de informação
		
Universidade de Aveiro	58	
Nome:	CaU3 Projectar Base de Dados
Actores:	Administrador, Sistema de Informação
Pré-condições:	Efectuar levantamento de quais os dados que devem ficar armazenados na base de dados. Estudo das várias tabelas da base de dados e as relações entre si.
Requisitos especiais:	Ter disponível um computador para instalar o programa de base de dados MS Server da Microsoft
Aspectos em aberto:	Base de dados estar armazenada num servidor para poder ser acedida através de uma ligação de internet
Tabela 3.4 - Tabela de descrição do CaU3 Projectar Base de Dados
3.2.3.4.	CaU4 Criar Sistema de Informação
Nome:	CaU4 Criar Sistema de Informação
Âmbito:	Sistema Eolitor.
Finalidade:	Permitir receber e tratar os dados provenientes do sistema de monitorização Permitir registar novos parque eólicos, aerogeradores e o seu respectivo modelo entre outras informações relevantes do sistema eólico
Actores:	Administrador, Sistema de Monitorização, Sistema de Informação
Pré-condições:	A base de dados de suporte a todas as informações do sistema estar instalada e poder ser acedida pelo sistema de informação
Requisitos	Efectuar levantamento de quais as tecnologias mais indicadas para a criação do
especiais:	sistema de informação
Aspectos em aberto:	Sistema de informação poder ser executado num computador comum com ligação à internet e com todos as ferramentas instaladas e poder aceder à base de dados para armazenar e consultar dados
Tabela 3.5 - Tabela de descrição do CaU4 Criar Sistema de Informação
3.2.3.5.	CaU5 Registar novo Aerogerador
Nome:	CaU5 Registar novo Aerogerador
Âmbito:	Sistema Eolitor.
Finalidade:	Permitir registar os dados dos diferentes Aerogeradores instalados nos Parques Eólicos
Actores:	Administrador, Sistema de Informação
Pré-condições:	O sistema de informação e a Base de dados estarem correctamente criadas e instaladas
Requisitos especiais:	Existir registo do Modelo do Aerogerador e do Parque Eólico onde será instalado
Tabela 3.6 - Tabela de descrição do CaU5 Registar novo Aerogerador
		
Universidade de Aveiro	59	
3.2.3.6.	CaU6 Monitorização
Nome:	CaU6 Monitorização
Âmbito:	Sistema Eolitor.
Finalidade:	Permitir recolher informação do estado do vento e dos Aerogeradores
Actores:	Sistema Monitorização Local
Pré-condições:	O Sistema de Monitorização estar correctamente instado, todos os sensores estarem a funcionar e este estar ligado computador para a recolha e processamento dos dados.
Requisitos	A Alimentação do Sistema de Monitorização estar assegurada.
especiais:	O estado do Sistema de Monitorização deve ser consultado regularmente com o objectivo de verificar o seu estado físico como o funcionamento correcto do mesmo. O incorrecto funcionamento do Sistema de Monitorização inviabiliza inevitavelmente a leitura de dados e consequentemente a inexistência de dados resultantes da monitorização. A placa de Monitorização estar ligada ao computador que irá receber os dados e processa-los (através de uma ligação sem fios ou com fios), e ambos estarem ligados e a comunicar entre si. Os dados enviados pelo Sistema de Monitorização, resultantes da leitura dos sensores, têm de ser enviados em tramas e o computador que irá receber os dados tem de conhecer o formato da trama.
Aspectos em aberto:	Instalação de mais sensores de modo a recolher mais informações sobre o comportamento do Aerogerador permitindo uma melhor análise. Interpretar os dados recolhidos e utilizar algoritmos de análise dos dados para previsão do comportamento do Aerogerador
Tabela 3.7 - Tabela de descrição do CaU6 Monitorização
3.2.3.7.	CaU7 Envio dos Dados
Nome:	CaU7 Envio dos Dados
Âmbito:	Sistema Eolitor.
Finalidade:	Permitir a visualização e o armazenamento do estado do vento e dos Aerogeradores
Actores:	Sistema Monitorização Local
Pré-condições:	O Sistema de Monitorização estar a funcionar e ligado correctamente através de um fio ou por tecnologia wireless
Requisitos especiais:	A função de processamento das tramas recebidas pelo programa servidor do sistema de monitorização deve estar em sintonia com as tramas geradas pelo processo de geração das tramas realizado pelo microcontrolador do sistema de monitorização
Aspectos em aberto:	Alguma alteração do formato da trama no microcontrolador deve ser repercutida no programa de recepção do sistema de monitorização
Tabela 3.8 - Tabela de descrição do CaU7 Envio dos Dados	
		
Universidade de Aveiro	60	
©
SUM SEW*
Nome:	CaU8 Visualizar desempenho do Sistema (Dados e Eventos)
Âmbito:	Sistema Eolitor.
Finalidade:	Consultar e analisar os dados do estado do vento e dos Aerogeradores e os respectivos eventos gerados pelo sistema guardados na Base de Dados
Actores:	Sistema de Informação, Administrador, Utilizador
Pré-condições:	O Sistema de Informação ter armazenado correctamente os dados e o sistema de informação estar correctamente programado para ir ler os dados à base de dados e disponibiliza-los na interface
Requisitos	A Base de Dados com os dados armazenados deve estar disponível.
especiais:	O Sistema de Informação deve poder estabelecer a conexão com a Base de Dados.
Tabela 3.9 - Tabela de descrição do CaU8 Visualizar desempenho do Sistema (Dados e Eventos)
3.2.3.9.	CaU9 Pedir relatório de Produção
Nome:	CaU9 Pedir relatório de Produção
Âmbito:	Sistema Eolitor.
Finalidade:	Permitir consultar os dados relativos a produção de energia pelos vários Aerogeradores
Actores:	Sistema de Informação, Administrador, Utilizador
Pré-condições:	O Sistema de Informação ter armazenado correctamente os dados e o sistema de informação estar correctamente programado para ir ler os dados à base de dados e gerar um relatório de produção
Requisitos	A Base de Dados com os dados armazenados deve estar disponível.
especiais:	O Sistema de Informação deve poder estabelecer a conexão com a Base de Dados.
Aspectos em aberto:	Escolher a informação que pretende que venha no relatório (valores, gráfico, escala temporal)
Tabela 3.10 - Tabela de descrição do CaU9 Pedir relatório de Produção	
		
Universidade de Aveiro	61	
©
SLiM SSS*
3.3.	Especificação Suplementar
3.3.1.	Funcionalidades Comuns
Para além dos casos de utilização descritos nas secções anteriores, existem requisitos não funcionais gerais do sistema, comuns a alguns casos de utilização descritos.
-Sempre que possível, a origem dos erros deve ser identificada.
-Deve existir um mecanismo eficaz de tratamento de erros, que reporte correctamente e armazene de forma persistente os erros que são gerados no sistema.
-Sempre que existir um erro de maior gravidade, tanto ao nível do Aerogerador com a possibilidade avaria de alguma componente, como ao nível da monitorização impossibilitando o correcto armazenamento dos dados, deve ser notificado o Administrador e responsável do Sistema para solucionar o problema.
3.3.2.	Requisitos de Usabilidade
Ref-	Requisito de interface e usabilidade	CaU relacionados
RInt.1	A informação deverá aparecer de um modo natural e lógico	CaU4, CaU5, CaU8
Rint.2	Usar fontes e cores que facilitem a legibilidade da informação	CaU4, CaU8
Rint.3	As mensagens de erros devem ser claras e sem ambiguidades	CaU4, CaU8
Rint.4	O sistema deverá permitir aos técnicos identificar facilmente a origem de erros	
Rint.5	O sistema deve fornecer sempre dados actualizados sobre o que se está a passar no sistema	CaU6
Rint.6	Nas opções importantes e sensíveis deveram aparecer mensagem de confirmação da realização da opção	CaU4
Rint.7	O sistema de informação deve disponibilizar na interface inicial a opção de escolha do tipo de utilizador	CaU4
Rint.8	O sistema de informação deve disponibilizar sempre na interface a opção para ver o histórico dos resultados	CaU4
Rint.9	O sistema poderá informar o técnico de controlo do mau desempenho de alguma componente do sistema	CaU4
Rint.10	O sistema deverá disponibilizar informação das características das componentes do sistema eólico	CaU4
Rint.11	O sistema deve permitir visualizar a informação do estado do sistema e dos seus parâmetros, para permitir alterá-los	CaU4
Rint.12	Existe informação do gestor/utilizador e das respectivas credenciais	CaU3
Tabela 3.11 - Tabela de Requisitos de Usabilidade
		
Universidade de Aveiro	62	
©
SLiM SSS*
3.3.3.	Requisitos de desempenho
ReP	Requisito de desempenho	CaU relacionados
RDes.1	O técnico de instalação deve ter garantia de que o sistema foi instalado com sucesso e que todos os componentes do Sistema Eólico (Aerogerador, Controlador, Inversor) estão a funcionar antes de notificar o Administrador Este deve ser responsabilizado em caso de avaria de algum componente devido a algum erro cometido durante a instalação	
RDes.2	O técnico de manutenção deve ter garantia de que o sistema foi reparado com sucesso antes de notificar o Administrador Este deve ser responsabilizado em caso de avaria de algum componente devido a algum erro cometido durante a reparação	
RDes.3	As anomalias ou alterações do desempenho das componentes do sistema devem ser notificadas ao Administrador	
RDes.4	Se o sistema aparentar alguma anomalia de alguma componente ou se o tempo de vida de alguma componente tiver sido ultrapassado deverá ser pedido uma reparação no sistema	
RDes.5	O sistema eólico deve parar durante uma rajada de vento (velocidade do vento superior a 25m/S).	
RDes.6	O sistema eólico para estar ligado a rede eléctrica deve produzir corrente alterna a 50 Hz. Caso não seja possível o sistema deve parar para não danificar nenhuma componente	
Tabela 3.12 - Tabela de Requisitos de Desempenho
3.3.4.	Requisitos de Segurança e integridade de dados
ReP	Requisito de segurança, privacidade e integridade de dados	CaU relacionados
RSeg.1	Apenas o Técnico de Instalação com conhecimento pode instalar as componentes do sistema eólico e determinar quando este pode ser ligado	
RSeg.2	Apenas o Técnico de Manutenção pode reparar componentes do sistema eólico após de alguma anomalia notificando o fim da mesma	
RSeg.3	Apenas o Administrador pode desenvolver o sistema de monitorização, o sistema de informação do Sistema Eólico e a base de dados de suporte do Sistema	CaU2, CaU3, CaU4, CaU6
RSeg.4	O Administrador é o responsável pela gestão de Logins dos Utilizadores mantendo as informações consideradas mais importantes restritas	CaU3
RSeg.5	Apenas o Administrador pode alterar a Base de Dados em conformidade com o Sistema de Informação	CaU3, CaU4
RSeg.6	Apenas o Administrador pode receber notificações de eventos anormais ao correcto funcionamento do sistema	CaU4, CaU8
Tabela 3.13 - Tabela de Requisitos de segurança, privacidade e integridade de dados
		
Universidade de Aveiro	63	
©
SUM SEW*
3.3.5.	Requisitos de interface com sistemas externos e com ambientes de execução
Ref-	Requisito de interface com sistemas externos e com ambientes de execução	CaU relacionados
RSeg.1	Sistema de Monitorização deve conter os vários circuitos integrados (Microcontrolador, Sensores, Reguladores, etc) montados numa PCB (placa de circuito impressa)	CaU2, CaU6
RSeg.2	Tecnologia Bluetooth, como solução alternativa, para comunicação sem fios entre a placa do Sistema de Monitorização e o computador de suporte da base de dados.	CaU2, CaU3
RSeg.3	Servidor para interface web deve ser IIS num sistema operativo Windows 2000 ou posterior.	CaU4
RSeg.4	Base de dados utilizada Microsoft SQL Server 2005	CaU3
RSeg.5	PC com os SDK's .NET Framework 2.0 e .NET Framework 3.5 instalados para permitir a execução do Servidor do Programa Eolitor System	
RSeg.6	Necessidade de ligação à Internet para permitir a ligação do Cliente do Programa Eolitor System ao Servidor e assim poder visualizar o comportamento do Aerogerador resultante da monitorização.	
Tabela 3.14 - Tabela de Requisitos de interface com sistemas externos e com ambientes de execução
3.3.6.	Requisitos de Hardware
Na sua totalidade, o sistema poderá ser executado na mesma máquina, desde que esta possua capacidade de processamento e memória disponíveis. No entanto, devido à arquitectura do sistema Eolitor, este poderá ser separado em dois módulos distintos (servidor/cliente), os quais podem ser executados cada um em computadores diferentes. Os módulos são: o módulo servidor constituído pela base de dados e pelo programa servidor Eolitor Server; e o módulo cliente constituído pelo programa cliente Eolitor System e pela aplicação da interface Web.
Para isso é necessário que exista uma boa conectividade TCP/IP entre o computador servidor e os diferentes computadores clientes. Qualquer que seja a configuração, o computador que executa a aplicação Eolitor Server e os computadores que executarem a aplicação Eolitor System ou a aplicação da interface Web, devem possuir ligação à Internet.
O sistema de monitorização deverá ser constituído por diversos sensores que permitem recolher informação tais como: velocidade do vento (anemómetro), direcção do vento, velocidade do aerogerador, tensão e corrente produzida. Estes sensores devem estar ligados a um microcontrolador, juntamente com circuitos de condicionamento de sinal e de regulação e alimentação, que devem estar integrados numa PCB. A placa do sistema de monitorização deve estar correctamente alimentada e este deve estar ligada ao programa de servidor através de uma ligação USB, ou através de uma ligação Bluetooth/ZigBee para permitir a comunicação entre ambos.
		
Universidade de Aveiro	64	
3.4.	Modelo do Domínio
§ Torre Eólica
Eg tamanho iLa tipo controlo ¡ti tipo rotor
@ Sistema Controlo
lÊg data ocorrência EJ prioridade evento
{■' medirVelocidadeVento () medirDirecçãoVento () CalcPotêmciaProduzida ()
vento
tipo vento Eg velocidade
Resol. Produção
teg data
1..
2 Interface
Êg tipo interface
E Login
i^gid
Eg pass
Figura 3.1 - Modelo do Domínio do Sistema
3.5.	Protótipo Exploratório
3.5.1.	Arquitectura aplicacional
O projecto do sistema Eolitor pode ser dividido basicamente em três camadas:
A camada “Database” inclui todos os dados armazenados de forma persistente na base de dados de suporte a todo o Sistema.
A camada “Monitoring System” inclui todos os circuitos do sistema de monitorização, (microcontrolador, sensores, comunicação Wireless, sistema de alimentação, sistema de armazenamento num cartão SD) bem como as ferramentas usadas para o desenvolvimento do programa de computador que recebe, processa os dados e os armazena na base de dados.
A comunicar com esta camada está a camada “Information System”, camada superior, que é basicamente toda a Interface Gráfica que permite interacção dos utilizadores com todo o sistema. Esta camada permite a visualização, através de um programa ou de uma página Web.
information System
MonUoringSystam
PC Server
O PCB
: Microcontroller
tUADC	t±j Timer
	
r UART	&amp;amp;RTCC
	
	
&amp;amp;$P1	1' Interruptions
	
nosc	DuSD
C] SerialPort
E3TCP
E3 C Sharp
Database
t“1 DBProvider
C2 Framework})
EjLIHQ
•prop* am
E3 IIS SOL Serve»2005
Diagrama 3.6 - Diagrama da Arquitectura Aplicacional
3.5.2.	Arquitectura de Instalação
Como já referido no ponto 3.3.6, o Sistema de Informação é constituído por um programa com interface gráfico e por uma página Web que podem ser acedidos a partir de qualquer PC que esteja ligado à internet. Conectada com o interface está a base de dados MS SQL Server onde é armazenada toda a informação do sistema. Esta encontra-se instalada num PC Servidor onde está a correr o programa de servidor do sistema de monitorização Eolitor Server.
TCP/IP
[J PC Server
f-j Eolitor Client
V eb Server (IS)
Web Browser
TCP/IP
f-| Eolitor Server
Internet
EolitorSystem
TCP
TCP/IP
■ial P rt
Eolitor PCB
«component» d Sockets
«component» d Socket
«component» d uSD
«component» d UART
«component» d Serial Port
«component» d Microcontroller
«component» d SQL Database
Desktop ° Web browser
«process» d EolitorSystem
«process» d TCP Server
«process» d Eolitor Server
□ MS SQL Server 2005
«process» d Web Browser
EolitorSystem
«component» d Bluetooth Module
Diagrama 3.7 - Diagrama de instalação
3.5.3.	Protótipos dos Produtos
No protótipo são apresentados os ecrãs de ambas as interfaces gráficas do Sistema de Informação e a placa de circuito impresso do sistema de monitorização.
3.5.3.I.	Eolitor Server
&lt;&lt;&lt;EolitorServer has connected the Eolitor TCP Server»&gt;
11 -06-2009 15:39:23^M«BaEBg8amiBmM
Figura 3.2 - Eolitor Server
Ambos os interfaces pertencem ao Servidor do sistema de monitorização. No interface da esquerda é possível configurar a porta de comunicação com a placa de circuito impresso do sistema de monitorização, permitindo a recepção dos dados. Após o processamento destes e paralelamente ao armazenamento na base de dados, estes são enviados para o Eolitor TCP Server, à direita, que por sua vez aceita ligações TCP dos vários clientes Eolitor System.
3.5.3.2.	Eolitor System - Home
Figura 3.3 - Eolitor System - Home
3.5.3.3. Eolitor System - Monitor
Figura 3.4 - Eolitor System - Monitor
3.5.3.4. Eolitor System - SQLDatabase
Figura 3.5 - Eolitor System - SQL Database
3.5.3.5.	Eolitor System - pSD Terminal
Figura 3.6 - Eolitor System - pSD Terminal
3.5.3.6.	Eolitor System - Options
Figura 3.7 - Eolitor System - Options
©
SLiM SSS*
3.5.3.7.	Eolitor System - Emailer
Figura 3.8 - Eolitor System - Emailer
3.5.3.8.	Eolitor System - Connections
Figura 3.9 - Eolitor System - Connection to Database
©
SUM SEW*
3.5.3.9. Eolitor System - Database Charts
Figura 3.10 - Eolitor System - Database Charts
3.5.3.10. Eolitor System - Logs
Figura 3.11 - Eolitor System - Logs
©
SLiM SSS*
3.5.3.11. Eolitor System - Reports
Figura 3.12 - Eolitor System - Reports
©
SUM SEW*
3.5.3.12.	Eolitor System - Web Page
Slide S of 12
Torre de Supcte
bebebsb
terça-fera, 7 de Mho de 2009 22:10:24
				
			Vetocidade(m/s):	J	
Velocidade(m/s):
Voltagem(V):
Conente(A):
Potência(W):
—	’	Em: 18-06-2009 19:20:51
[ Entrar &gt; J

End» Eupore 0*--/
f U renewables sector to create
400,000 new jobs
... .vx* y&gt;e second j/er^ooon froten
»*• oãi'	rte
t^~On ■*'*“ ■r5¿*rt-V*&lt;e nd gather to celebrate the tómense poner and...
2009-06 0S SoK.m
t nergus renovables tamaño XXI -. .sdccoon de las nstaiaoones hemos contado con el asesor amento de: turopean Wmdtnergy Associatton (ÍWLA), Amencan Wrtd Energ, Assoaabon...
2009-06-02 Gut Tew*
Green eneryy goal to boost tU jobs .. - ie seen n many years. sard Christian Kjaer, ch*f executive of the furopean Wind Energy Association I think it nd have a large mpact. GDP...
.tui-c' VALERIA AO VIVO
Links
■•INKS _
•S.ÍI
N°vidades, Cahoot ¿J0'0 Para v
d«'OO&lt;« tr^M« •wdem a
ReS,,nwd«PrOkno
N°« último® ano_
d"“
dee. mJ! ■ 0 M“ '‘««.do	eom'xm,v„, l0MJ•?«'»«
d. Drod	“*W, «mo . doXS^“ ’ A””' A'
H~^2SSS==.-:
Outras Notícias
v«r mete foto.
Videos
Maglkal Powe£-_Mega Wind Turbine
*'"d GenZrX?
Ener0,a E&lt;M.ca
Altemet.ve Energv newer end w,nd Ener„v
CleenTechn.ee
North American w.nrin--,,
Ler Feeds RSS
ooo/ro« a . efl O
^Renov,
En'r0la Eóho,
’anOr#"’«MUndla;
^Quoto
Aer°geradores
S'aem« Eólio»
Le,deBttz
munoIal
— neroia Cólica	"KS ¡¡J aov^
A	Q Blâcx • u,.
. A ^rgia	*Me
■^rr'XXsdas,°"^
xa-^tém
’’^ersdorT "" e"'rg.a eX"“SS“ de ar, em '"'r°'a “*.c. do 'm en«rg,a	0 rotor rabn, ' Es" ' o	'
“"verte,	d' '«»Çâo L?'?3 °^ce * * **“ »= um
.¿T.........
•*««-* Pelo Slstema"£	do «mo XTX' 00 «""&gt;
ndueem . veloQ(j * eólicos « X ’ T	W ê
(velocidade nj0 perturbai *’*' * ''"“'“’de do vento^’ * '**°
=S~j===^: chamada velood.de de corte um mcc.nL"'™' ° s®'™ «•"* a neLdade de nâc causar nscos ,o Xe7X”^*° ‘ ™ • Xxex:;::
(-adade^XXZX:^—^ do Sirtem. «mXZ?; rabalhar "° ,rtBVato Ó*"» de rendimento r~u™ r°
Xo	L	”• E n'“S“n° tarnbe,r" "' ™“™™ de
controlo apropnados para melhorar o rendimento noutras veloodades de vento e aumentar o intervalo de funoonamento do sistema eólico.
Para a produção de energia eléctrica em grande escala, só sâo interessantes regiões que tenham ventos com veloodade media de 6 m/seg ou superior. Ventos com velocidade inferior a 2 ou 3m/seg nào sào suficientes para fazer funcionar os aerogeradores. Vamos ver quais as características dos ventos bem como todas as componentes de um sistema eólico postenormente. Este tipo de produção de energia é a que se tem destacado mais de entre todos os tipos de produção de energia renováveis.
Instalação
EWEA Wind is Power
EWEA OFFSHORE'
EWEA No Fuel'
'EWEA Seize the Opportunity*
/ Escrever um Comentário
pro^olitor links galeria ao vivo
home ENERGIA MUNDIAL ------------------
Copyright © I EETA 2009. Vítor Morgado R.be.ro. vitormnbeiroQua.pt
h°me &gt; GAL£Ria
home energi	'/IM0S 1 "“C“"S£SS‘O
' ENERGIA MUNDIAL „
' ' ’	‘	01 EOLrr°« I LINKS r
5 ^eria AOwvo
^m-vindoà Galeria de Videos
3.5.3.13. Eolitor System - PCB Monitoring
Figura 3.13 - Eolitor System - Box
Figura 3.14 - Eolitor System - PCB
3.6.	Plano de Implementação do Projecto
De seguida é apresentado um quadro com a pontuação dada a cada um dos casos de utilização, segundo os critérios definidos na SLiM.
Caso de Utilização	Impacto	Risco	Novidade	Crucial	Conhecimento	Rank	Notas
CaU1 Instalar Sensores	4	3	2	4	4	17	Necessários para recolher informações
CaU2 Criar Sistema de Monitorização	4	3	2	4	3	16	Indispensável ao projecto
CaU3 Projectar Base de Dados	4	2	2	4	3	15	Suporte de informação do sistema
CaU4 Criar Sistema de Informação	3	1	2	4	3	13	Necessário para visualizar informação do sistema
CaU5 Registar novo Aerogerador	3	1	1	3	1	9	
CaU6 Monitorização	4	2	2	4	2	14	Essencial para recolha de dados
CaU8 Visualizar desempenho do Sistema (Dados e Eventos)	2	2	2	3	2	11	
CaU9 Pedir relatório de Produção	2	2	3	2	3	12	
Tabela 3.15 - Tabela de prioridades dos CaU
		
Universidade de Aveiro	80	
3.7.	Modelo de Dados Persistente
PowerCurve
Aeros
Pieces
Modelpieces
Moteo
Company
-ID: Integer -name: String -email: String -phone: Integer
+GetData()
Maintenances
-ID: Integer -companylD: Integer -mainType: String -dt: Date
-time: Integer -price: Decimal
+GetData()
Interruptions l&gt;
. i...
4GetDa-.au
■ID: Integer -aerolD: Integer ■modellD: Integer ■mainlD: Integer •dt start: Date
+GetData()
Logs
-ID : Integer -logID: Integer ■aerolD: Integer -loginfo ■ String -priority: Integer -dt: Date
■ID: Integer ■name; String -price: Decimal -timetolrve: Integer
+GetP5ta()
+GetData()
Productions
■ID: Integer ■aerolD: Integer ■aerospeed : Decimal -aerodir! Integer ■aerodiir_c: String ■aerovolt: Decimal -aerocurrent: Decimal ■aeropower: Decimal -inveurrent: Decimal ■dt: Date
4GetData()
SelEnergy
-ID: Integer -farmID : Integer ■dt: Date -pricettW: Decimal -quantity! Integer -price: Decimal
WindFarms
+GetDats()
-ID: Integer -Name: String -Location ; String -di stant: Date -numAeros: Integer -powerinstalled: Decimal
StetisticsAerosMonth
-ID: Integer -manlD: Integer ■model: Integer ■powerrate: Integer ■powermax! Integer -voltout: Integer -speedstartup: Integer ■speedrate: Integer ■speedmax: Integer -cortrolpltch: Boolean ■diameterrotor: Integer -speedrotor: Integer ■nblades: Integer ■height: integer ■weight: Integer
i-GetDatai)
Payments
*GetData()
-ID: Integer -statisticID: Integer -num: Integer -aerospeed Decimal -aerodir: Decimal -aerovott: Decimal -aerocurrent: Decimal -aeropower. Decimal -inveurrent: Decimal -emlsson CO2 : Decimal -dt_year: Integer +GetData()
-ID : Integer -modellD: Integer -farmID: Integer -ref: String -state: Boolean -description : String -dt: Date
-ID: Integer -aerolD: Integer -paymenttype: String -paymentstate: String ■price: Decimal -dt: Date
-ID: Integer -statisticID: Integer -num: Integer ■windspeed : Decimal -winddir: Decimal -tempe: Decimal -dt_year: Integer
+ C3«t I lr.lr.il
-ID : Integer ■Name: String ■Email : String -Phone: Integer
+GetData()
-modellD: Integer -speed: Decimal ■power: Decimal
+GetDataQ
StatisticsAero5_Day
+Get
+GetData()
-ID Integer olD: Integer ri : Integer ospeed: Decimal •odir: Decimal woll: Decimal 'ocurrent: Decimal opower: Decimal current: Decimal isson_CO2: Decimal Dale_______________________
BiDataf)
■ID: Integer -aerolD: Integer -num : Integer -windspeed : Decimal -winddir: Decimal -tempe: Decimal -dt: Date +GetData() I
-ID: Integer -statisticID; Integer -num • Integer -aerospeed: Decimal -aerodir: Decimal -aerovolt: Decimal -aerocurrent: Decimal -aeropower; Decimal -inveurrent: Decimal -emisson_CO2: Decimal -dt_day: Date
■ID: Integer ■statisticID: Integer -num ■ Integer -aerospeed: Decimal -aerodir: Decimal -aerovolt: Decimal ■aerocurrent ? Decimal -aeropower: Decimal -inveurrent: Decimal -emisson_CO2: Decimal ■dt_month: Integer +GetData()
Statistics Meteo_Month		StatisticsMeteo_Day
-ID: Integer -statisticID: Integer		-ID; Integer -statisticID: Integer
-num: Integer		-num: Integer
■windspeed: Decimal		■windspeed: Decimal
-winddir: Decimal		-winddir: Decimal
-tempe: Decimal		-tempe: Decimal
-dt_momii: Integer		-dt_day: Date
+GetData()		+GelData()
Figura 3.15 - Modelo da base de dados
3.7.1.	Dicionário de dados
O dicionário de dados descreve cada entidade da base de dados do sistema. É composto pelo nome, por uma breve descrição da entidade, por uma tabela que contém os atributos, a descrição de cada atributo, o valor que este atributo pode assumir e um campo que identifica se esse atributo pode assumir o valor nulo. Este dicionário pode ser consultado no ANEXO B.
		
Universidade de Aveiro	81	
		
Universidade de Aveiro	82	
4.1.	Introdução
O Sistema de Monitorização foi pensado de modo a satisfazer a necessidade de conhecer o comportamento do Aerogerador mediante o estado do tempo. As variáveis mais importantes para caracterizar o estado do tempo são a sua velocidade e direcção. Da mesma forma, a velocidade, a corrente produzida e a tensão gerada (formando a potência) são indispensáveis para exprimir o comportamento do Aerogerador. A estas informações adicionou-se, o valor da temperatura e a direcção do rotor do Aerogerador. Efectuou-se então um levantamento sobre as tecnologias mais usadas e mais disponíveis com a finalidade de solucionar esta necessidade.
Faz parte ainda do sistema de monitorização, uma unidade central que recebe os dados, através de uma ligação USB ou através de uma ligação sem fios, os processa e armazena na base de dados.
Sendo o objectivo final deste sistema, disponibilizar os dados para a camada superior (Sistema de Informação - Interface com o utilizador), foi desenvolvido também um servidor TCP que permite a ligação de múltiplos clientes através de uma rede de Internet ou Intranet.
No presente capítulo são referidas todas as informações que permitiram a criação e desenvolvimento do sistema de monitorização, desde os sensores e microcontrolador, ou diagrama de processamento de dados, até ao programa de servidor.
		
Universidade de Aveiro	83	
4.2.	Aerogerador 20kW
O aerogerador instalado, que através do projecto Eolitor se pretende monitorizar, pode ser observado na figura seguinte. Este aerogerador tem como características principais: gerador de três fases imãs permanentes, com uma potência nominal de 20 kW, alcançada para vento com velocidade próxima dos 12 m/s; tensão de saída entre 360V e 420V, e velocidade óptima de rotação do rotor de 160 rpm, sem caixa multiplicadora nem controlo de Pitch. Todos os parâmetros caracetristicos deste aerogerador podem ser consultados na Tabela 4.1 [48]. A curva caracteristica, potência de saída (kW) em função da velocidade do vento (m/s) nas condições óptimas de funcionamento e de vento, pode ser observada na Figura 4.2.
Figura 4.1- Aerogerador de 20kW instalado perto do IEETA
Parâmetros	
Tipo	LT10-20000W
Potência Nominal	20 kW
Potência Máxima	22 kW
Tensão de Saída	360-420V
		
Universidade de Aveiro	84	
Gerador	Três fases, ímãs permanentes
Velocidade do vento inicial	2 m/s
Velocidade do vento nominal	12 m/s
Velocidade do vento máxima	25 m/s
Velocidade do rotor óptima	160 rpm
Número de Pás	3
Diâmetro do rotor	10
Largura da Pá	60 cm
Espessura da Pá	23 cm
Material das Pás	fibra de vidro reforçada
Peso do turbina com as pás	525 kg
Transmissão	Não, transmissão directa
Controlo Pitch	Não
Caixa de velocidades	Não
Protecção	Automático
Dimensões (altura)	12 m ou 18 m
Características funcionais	Slow-Mode, Brake
Tabela 4.1 - Parâmetros do Aerogerador de 20kW [48]
Figura 4.2 - Gráfico da curva de potência (em condições óptimas) do Aerogerador de 20 kW, potência de saída (kW) em função da velocidade do vento (m/s) [48]
4.3.	Sensores
Os sensores são dispositivos tecnológicos que permitem obter informação proveniente das mais variadas naturezas recebendo e respondendo a um estímulo. Estes podem ser constituídos por um transdutor e por uma parte eléctrica que convertem a energia que resulta do transdutor em um sinal eléctrico. A informação gerada pelo sensor é legível ou é disponibilizada directamente, como o caso dos termómetros, ou então, resulta num sinal analógico ou digital quantificável. A lista actual de sensores é bastante extensa e é caracterizada de acordo com a natureza do sinal. Esta lista é integrada por sensores de calor, potência, velocidade, temperatura, aceleração, magnética, orientação, pressão, entre outros.
4.3.1.	Sensor de Velocidade do Vento (Anemómetro)
Para medir a velocidade do vento os sensores que são utilizados, como já foi referido na secção 2.5.1.7, é utilizado um de dois tipos de Anemómetros, de três copos ou ultra sónicos.
Devido aos requisitos deste projecto, os sensores ultra sónicos não eram os mais aconselhados pelo seu elevado preço relativamente aos Anemómetros de três copos. Assim, para este projecto foi disponibilizado um Anemómetro de três copos. O comportamento deste sensor, alimentado a uma tensão de 3.3V e 0V e com um consumo de aproximadamente de 20mA, tem uma saída em frequência proporcional à velocidade do vento. A onda quadrada de saída (aproximadamente 3.3V ou 0V) é dada por um sensor óptico que detecta a presença, ou ausência, das saliências de uma roda dentada durante o seu movimento de rotação.
O valor da velocidade do vento tem diferentes formas de ser medido, tais como:
-Ligar o sinal de saída do sensor a uma entrada de relógio de um timer e configurá-lo para funcionar como contador durante um período de tempo definido.
-Ligar o sinal de saída do sensor a uma entrada de relógio de um timer e configurá-lo para funcionar como timer, medindo a frequência do sinal.
-Ligar o sinal de saída do sensor a uma linha de interrupção e contar o número de interrupções durante um período de tempo definido.
No nosso caso como o microcontrolador, como é limitado quanto ao número de entradas de relógio dos timers, optou-se pela última solução.
Outros tipos de sensores de três copos são também utilizados para medir a velocidade de vento mas com diferentes características. Têm uma tensão de saída proporcional à velocidade do vento e são normalmente mais dispendiosos. Para estes sensores a solução seria ligar a saída a um canal da ADC interna do microcontrolador de modo a medir o valor da tensão e obter o valor da velocidade do vento.
		
Universidade de Aveiro	86	
Figura 4.3 - Anemómetro
Como o sensor tem resposta em frequência, a velocidade do vento é dada pela expressão: n
v = —f 2 nr [m/s]
N
Equação 4.1 - Velocidade do Vento
Onde:
v = velocidade do vento [m/s]
n = número de transições contadas pelo timer
f = frequência de contagem do timer [Hz] =1 Hz
N = número de dentes por volta = 16 n = 3.141592...
r = raio do anemómetro em m [metros] = 0.155 m
v = 60.87x10 3n [m/s]
Equação 4.2 - Velocidade do Vento em função de n
4.3.2.	Sensor de Direcção do Vento
O sensor de direcção é o sensor que comanda a direcção da cabine da torre eólica. Este sensor é alimentado a 3.3V e 0V (com um consumo aproximado de 20mA) e com um sinal de saída proporcional ao valor da resistência do potenciómetro, e consequentemente, à direcção do Aerogerador.
A leitura deste sensor é feita utilizando um dos canais que integram a ADC interna do microcontrolador. Sabendo que o sensor é constituído por um potenciómetro linear, a tensão de saída depende da posição e varia entre as tensões de alimentação. Assim a tensão de saída pode variar entre 0V e 3.3V e o valor da ADC por sua vez, varia entre 0 e 1023,
respectivamente.	Vdir	10 ADC =	x (2	-1) Vcc
Equação 4.3 - Valor da ADC para o sensor de Direcção
Figura 4.4 - Sensor de Direcção
4.3.3.	Bússola Magnética
Para medir a direcção da cabina já vimos que temos um sensor de direcção, mas também pode ser utilizada uma bússola.
A bússola magnética da Parallax, constituída pelo sensor da HM55B da Hitachi que tem um duplo eixo campo magnético. Este aparelho permite determinar o ângulo que o sensor faz com o Norte. O tipo de comunicação com o módulo é serie, e a leitura e escrita são simples, utilizando os comandos PBASIC SHIFTIN, SHIFTOUT e ATN. Este sensor é sensível a variações de campo magnético na ordem dos microteslas (T), tem 8 bits de resolução angular, uma resposta cerca de 30 a 40 ms, resistência de protecção para os pinos de dados e tudo numa pequena placa de cerca de 0,3 polegadas.
Este sensor é utilizado na orientação de robôs, em bússolas electrónicas de bolso, em automóveis, estações meteorológicas e noutras aplicações similares a estas, em que a precisão não seja muito importante e o sensor não seja influenciado por campos magnéticos externos ao da terra.
Figura 4.5 - Bússola Magnética Módulo HM55B [Parallax]23
Figura 4.6 - Circuito de ligação e sinal de saída do módulo [Parallax]23
23 Informação desta bússola em http://info.hobbyengineering.com/specs/PX-29123.pdf
4.3.4.	Sensor de Temperatura
Para medir a temperatura existe uma grande variedade de sensores com vários protocolos de comunicação (I2C, SPI, SMBus, Two-Wire), dos mais variados fabricantes (Texas Instruments, Maxim, Analog Devices, ST), com diferentes resoluções e em diferentes packages. O modelo escolhido foi um sensor de temperatura analógico da Maxim, o MAX6608. Este tem um sinal de saída analógico disponível com 5 pinos, é alimentado a 3.3V e 0V e funciona a baixa corrente 15uA, com mais ou menos 2 graus de resolução, com uma escala de funcionamento que pode ir de -20°C a 85°C e com um deslocamento de 500mV em relação a temperatura de 0 Graus.
A leitura deste sensor é feita utilizando um canal da ADC do microcontrolador. Como o sensor tem resolução de 10mV/°C, uma escala de funcionamento de -20°C a 85°C e a 0°C, uma tensão de 500mV, o valor devolvido pela ADC de 10 bits varia entre 93 (-20°C) e 418,5 (+85°C).
Vtemp 10 ADC =	x (2 -1)
Vcc
Equação 4.4 - Valor da ADC para o sensor de Temperatura
-Para -20eC a tensão de saída do sensor MAX6608 é 500mV + (-20*10mV) = 300mV.
0,300
ADC	x (1024 - 1) = 93
3.3
-Para 85°C a tensão de saída do sensor MAX6608 é 500mV + (85*10mV) = 1.350V.
1,350
ADC	x(1024 - 1) = 418 ,5
3.3
Figura 4.7 - Sensor de temperatura MAX6608 [Maxim]24
4.3.5.	Sensor de Rotação
O sensor para medir a velocidade de rotação das pás foi escolhido de entre sensores baseados no efeito de Hall com capacidade de detectar materiais ferro magnéticos. O efeito de Hall foi descoberto por Edwin H. Hall, quando este verificou que se colocar uma placa fina de ouro perpendicular a um campo magnético é percorrida por uma corrente originando uma diferença de potencial (potencial de Hall).
24 Informação retirada de http://www.maxim-ic.com/quick view2.cfm/qv pk/2575/t/al
O princípio deste sensor é o efeito de hall que permite detectar a passagem de um corpo ferro magnético, agarrado ao eixo do rotor, que roda à mesma velocidade das pás. Assim o sinal de saída deste sensor é aproximadamente uma onda quadrada com uma frequência igual à velocidade das pás do rotor.
Legenda:
1. Electrões; 2. Elemento (Sensor) Hall; 3. Imanes; 4. Campo magnético; 5. Fonte de alimentação
Descrição:
Na figura A, o elemento Hall fica polarizado negativamente na extremidade superior (simbolizado pela cor azul) e positivamente na extremidade inferior (cor vermelha). Em B e C, tanto a corrente eléctrica ou o campo magnético são invertidos, causando a polarização inversa relativamente á situação em A. Invertendo ambas, corrente e campo magnético, (figura D) faz com que o elemento Hall polarizado de igual forma em relação a A.
O sensor escolhido com estas características para esta aplicação foi o modelo 55075 da Hamlin. Este é um sensor robusto em aço inoxidável do formato de um M12 e com 46 milímetros de comprimento, que aufere protecção para ambientes severos, tem capacidade de comutação até 27V e um consumo de 20mA, tem auto-ajusto magnético, protecção EMC, contra curto-circuito e tensão inversa, e detecção de velocidade nula. A vida útil do sensor é elevada (até 20 mil milhões de operação) e destina-se a aplicações de geartooth, encoders industriais e comerciais, linear e de rotação. A leitura deste sensor é feita utilizando uma linha de interrupção externa do microcontrolador.
Figura 4.9 - Sensor de Rotação efeito de Hall [Hamlin]26
25	Imagem retirada de http://pt.wikipedia.org/wiki/Imagem:Hall effect.png
26	Informação retirada de http://www.hamlin.com/product-detail.cfm?productid=102
		
Universidade de Aveiro	90	
Figura 4.10 - Bloco de diagrama e exemplo de aplicação (Geartooth)
4.3.6.	Sensor de Corrente
O sensor utilizado para medir a corrente eléctrica tem o mesmo princípio do anterior, o efeito de Hall. Para aplicações onde a corrente é muito elevada, para medir o seu valor, o contacto com o fio que transporta a corrente é perigoso. Assim é necessário medir o valor de corrente por outro método. Como cada fio que conduz uma corrente gera um campo electromagnético em seu redor, que pode ser medido e com base no seu valor determinar o valor da corrente eléctrica no condutor. Esta é uma das grandes vantagens deste tipo de sensores, a medição de fluxo de corrente, sem a necessidade de contacto. Comercialmente existem dois tipos de sensores baseados no efeito de Hall, os sensores de malha aberta (open loop) e os sensores de malha fechada (closed loop). Os sensores de malha fechada têm uma grande precisão, de resposta rápida, excelente linearidade e com pequenas variações de temperatura. O princípio de funcionamento (ver Figura 4.11) deste tipo de sensores de efeito de Hall consiste na utilização de uma bobine auxiliar e uma malha de feedback. O fluxo magnético criado pela corrente primária (que se pretende medir), origina uma corrente na bobine secundária. O sensor de efeito de Hall constituído por um circuito electrónico, e isolado galvanicamente, gera o sinal de saída com base na corrente induzida na bobina que é uma amostra real da corrente primária.
O princípio de funcionamento dos sensores de efeito de Hall de malha aberta tem por base um fluxo magnético, que é introduzido pela corrente primária que se pretende medir originando, na saída do sensor de efeito de Hall, uma réplica do sinal de entrada, garantindo o isolamento galvánico na saída.
Figura 4.11 - Princípio de funcionamento dos sensores
Efeito de hall open e closed loop, respectivamente
Para medir a corrente produzida o sensor de corrente com efeito de Hall escolhido foi o modelo L01Z da Tamura. Este sensor destinado à montagem num circuito impresso (PCB -Print Circuit Boad), é alimentado a 0V e 5V, e têm um consumo de corrente na ordem dos
rw
Figura 4.12 - Sensor de Corrente efeito de Hall [Tamura]27
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
-120	-©0	-60	-30	0	30	60	©0	120
Input current (A)
Figura 4.13 - Resposta em Tensão do Sensor L01Z [Tamura]27
A leitura deste sensor é feita utilizando um canal da ADC do microcontrolador. Neste sensor, temos um caso particular de a tensão de saída do sensor de corrente ter uma gama superior á gama da ADC, a tensão do sensor pode variar de 0V a 5V e a gama de leitura da ADC varia de 0V a 3.3V. A solução para resolver este problema foi proceder à implementação de um divisor resistivo de modo a dividir a tensão de saída do sensor por dois. Assim, a gama de saída do sensor vai de 0V a 2.5V.
ADC
Vcurr
Vcc
x (2'	1)
x
R1
R1 + R 2
Equação 4.5 - Valor da ADC para o sensor de Corrente
27 Informação retirada de http://www.tamuracorp.com/clientuploads/Technical Documents/TCA-Current Sensor Data.pdf
-Para Vcurr=0V, ADC = 0; -Para Vcurr=5V, ADC = 775;
5	100 k&amp;amp;
ADC	x	(1024 -1) = 775
3.3	100 k^ + 100 k--
4.4.	Arquitectura do Sistema
Este sistema de monitorização foi pensado para poder dar resposta a duas formas possíveis de instalação, local e remota. Assim, o sistema pode ser instalado no Aerogerador e ligar-se com suporte numa tecnologia de rede sem fios (Wireless) à unidade de processamento, ou então, pode ser instalado junto à caixa de controlo do Aerogerador, recorrendo à utilização de vários fios ligados aos sensores.
A primeira opção de instalação, local, tem a vantagem de não necessitar de tantos fios ligados dos sensores ao sistema de monitorização, mas em contrapartida é necessário um sistema de Alimentação local para ultrapassar a necessidade de energia eléctrica e a inexistência de rede eléctrica no local de instalação. Este sistema de alimentação tem de ser suportado num painel solar e num carregador de baterias para manter a alimentação durante a ausência de luz , necessária para a produção de energia eléctrica. Nesta instalação também é necessário garantir total isolamento dos circuitos, necessitando assim de uma caixa à prova de água e humidade.
Na segunda opção de montagem, remota, as desvantagens da primeira opção de instalação são as vantagens desta, uma vez que existe energia eléctrica local e não é necessário o painel solar, nem um carregador de baterias, diminuindo assim a complexidade do sistema.
Para este Aerogerador, a opção de instalação do sistema de monitorização foi a remota, uma vez que a distância do Aerogerador ao sistema de controlo (controlador) é reduzida, aproximadamente 30m. Neste âmbito, o sistema foi montado perto do controlador, onde se ligam e reúnem todos os dados provenientes dos sensores e os cabos de corrente provenientes do gerador.
Cada sensor foi colocado numa posição estratégica para proporcionar uma melhor qualidade de recolha da informação vinda do meio. Os sensores de velocidade e direcção do vento foram instalados no topo da Torre Eólica de modo a informação inerente ao estado do vento ser mais aproximada do local de captura do mesmo pelo Aerogerador. O sensor de direcção, pelo facto de estar instalado na parte móvel do rotor, não fornece a informação da direcção absoluta, mas sim a informação relativa deste. De forma a ultrapassar este problema, existem as seguintes soluções:
Solução 1 - Colocar um outro sensor de direcção auxiliar. Para este sensor informar a posição absoluta do Aerogerador, teria de ser colocado numa parte fixa, como por exemplo na torre, ou mesmo na parte superior do edifício IEETA. Assim, teríamos a informação absoluta do vento, a informação relativa do aerogerador face à direcção do vento, e por diferenciação, ainda se iria obter a direcção absoluta do Aerogerador.
desvantagens: Utilização de mais um sensor de direcção do vento; o facto do sensor auxiliar estar sujeito a perturbação causadas pela torre, principalmente em regime estacionário, o que logo influencia a direcção absoluta do Aerogerador.
Solução 2 - Colocar na parte móvel, cabine da torre, uma bússola magnética que iria disponibilizar, à saída, a informação do ângulo do Aerogerador relativamente ao Norte, obtendo assim o valor de direcção absoluto.
vantagens: Simplicidade de instalação e de leitura do mesmo sensor.
desvantagens: Esta opção como é baseada na informação magnética e devido à elevada quantidade de corrente produzida pelo aerogerador (logo o aparecimento de campo magnético), pode influenciar o funcionamento do mesmo sensor e saturar a sua saída. O funcionamento do sensor magnético também pode ser influenciado pela existência de superfícies de ferro, e como a instalação é relativamente próxima da cabine do Aerogerador, a sua utilização tem de ser equacionada. A precisão deste sensor não é muito grande para o objectivo desta aplicação.
Solução 3 - Instalar dentro da cabine do Aerogerador, um sensor que detecte o movimento rotacional da cabine. Assim, correlacionando os valores podemos determinar também a posição absoluta do Aerogerador.
vantagens: Não existem vantagens desta solução em relação às anteriores, sendo apenas uma alternativa.
desvantagens: Mais difícil e mais crítica a montagem, podendo pôr em risco o funcionamento do Aerogerador em caso dos sensores se desprenderem; mais complicado e mais propício a obtenção de erros no cálculo da direcção absoluta do Aerogerador; e torna-se mais complexo também no que respeita à troca de sensores em caso de avaria.
Solução 4 - Instalar dentro da cabine um potenciómetro na parte fixa, com o princípio de funcionamento igual ao sensor de direcção, e conectar a este uma vareta que vá ligar à parte móvel, e que acompanhe os seus movimentos. Isto significa que uma volta deste potenciómetro teria de ser igual a uma volta da cabine do aerogerador.
vantagens: Simplicidade de leitura do sensor e informação absoluta do seu movimento.
desvantagens : Impossibilidade de uniformizar e generalizar a leitura da posição da cabine através deste método; e dificuldade de instalação do respectivo sensor.
Tendo em conta as vantagens e desvantagens referidas, a solução que pareceu mais adequada e de fácil instalação, foi a utilização de um sensor de direcção auxiliar.
O sensor de temperatura foi instalado na própria placa PCB, obtendo assim a temperatura ambiente a que os circuitos integrados estão a funcionar.
Para medir a velocidade de rotação das pás do Aerogerador tínhamos igualmente algumas soluções. As mais simples de implementar eram:
Solução 1 - O sensor de rotação das Pás do Aerogerador ser montado dentro da cabine, fixo à estrutura da torre. Este sensor estar virado perpendicularmente à normal do eixo de rotação.
		
Universidade de Aveiro	94	
vantagens : Simplicidade de leitura da velocidade de rotação das pás devida à onda quadrada de saída do sensor com frequência variável; fiabilidade de um mecanismo que tem como função detectar a passagem de um parafuso ferro magnético pelo sensor de rotação, devido à robustez do sensor escolhido.
desvantagens: Possíveis oscilações da torre Eólica, o que pode resultar na deslocação do sensor e no aumento da distância mínima do sensor ao parafuso deixando de o detectar, inviabilizando deste modo, a monitorização da velocidade de rotação das pás; elevado preço do sensor relativamente a outras soluções; impossibilidade de generalizar a medição da velocidade utilizando esta solução, devido ao facto de não ser sempre possível a instalação deste sensor, em outros Aerogeradores.
Solução 2 - Devido à utilização de um sensor de corrente de efeito de hall para medir corrente alterna, este também pode ser utilizado para determinar a frequência da mesma corrente. Assim pode ser obtido o valor da velocidade de rotação através da frequência da corrente alterna produzida pelo Aerogerador.
vantagens : Mais simples e mais barato do que a solução 1, utilizando um sensor para medir duas variáveis.
desvantagens: Devido à utilização de um sensor para medir duas variáveis, a monitorização de ambas ficaria sujeita ao funcionamento do mesmo.
Neste caso optamos por instalar ambas as soluções, uma vez que o sensor utilizado para a solução 2, já estava previsto a sua utilização para medir a corrente produzida. Assim, e como este projecto não se trata de um sistema terminal, mas sim de testes, podemos determinar qual a melhor solução.
Para medir a corrente produzida instalamos o sensor de corrente efeito de Hall perto do controlador (sistema de controlo).
Todo o sistema de monitorização (PCB), com todos os circuitos impressos e os conectores para ligar aos sensores, foi então instalado perto do controlador que ficou instalado no Edifício do IEETA a cerca de 30 metros do Aerogerador. Como já foi referido, o sistema está também preparado para ser instalado localmente (no aerogerador - Solução B).
Aerogerador 20kW
Eolitor Server
Controlador
,.g«.a 4.15 - Arquitectura de montagem do Sistema de Monitorização
4.5.	Tecnologias Implementadas
Para implementar os vários sensores num sistema de monitorização local é necessária a utilização de uma unidade de processamento que permita a recepção do valor dos sensores e o envio para uma unidade central. No mercado, existem muitos microcontroladores dos mais variados fabricantes (Microchip, Motorola, Atmel), capazes de resolver esta necessidade. A escolha de um fabricante também é influenciada pela escolha do compilador e do programador do microcontroladores. Neste sentido, a escolha recaiu pelo Microchip, devido a este ser o mais utilizado nos projectos abrangidos pelo IEETA, e por isso existirem programadores e compilador da Microchip disponíveis. A gama de microcontroladores da Microchip de 8, 16 e 32 bits é muito grande cobrindo quase todas as necessidades possíveis. Com o desenvolvimento das tecnologias, os microcontroladores disponibilizam cada vez mais mecanismos, e por um tamanho mais reduzido. Estes integram: Timers de 8 e/ou 16 bis, ADC de 10/12 bits, comunicação série (UART, CAN, MSSP), memória flash, memória EEPROM, vários portes I/O Digitais de vários bits, Interrupções, registos de estado e dados.
Inicialmente, a opção do microcontrolador a usar recaiu pelo PIC18F458 da Microchip de 8 bits. Este é constituído 4 Timers, um de 8 bits (Timer2), um de 8/16 bits (Timer0) e 2 de 16 bits (Timer 1 e 3), por uma UART, por módulos de comunicação série I2C e SPI, por uma ADC com 8 canais de entrada e pelos portos de I/O A, B, C e D. Este microcontrolador tinha todas as características necessárias para o processamento de dados necessário para o sistema de monitorização, sendo a única falha relativamente aos pré-requisitos, o facto de não ter integrado nenhum RTCC (Real Time Clock and Calendar). Contudo, pode ser ultrapassado recorrendo a um externo com protocolo de comunicação SPI ou I2C, exemplo DS1388 da Maxim.
Com a necessidade do sistema de monitorização local obter capacidade de armazenamento dos dados, caso não exista ligação wireless com o sistema de informação, foi necessária a introdução no projecto de um módulo de armazenamento (ver ponto 4.7).
No sentido de dar resposta à introdução de um módulo de armazenamento constituído por um cartão SD, as necessidades do microcontrolador aumentaram, especialmente a memória de programa necessária para processar o código devido á carência da criação de um sistema de ficheiros. Assim sendo, a escolha recaiu pela alteração do microcontrolador para 16 bits, e foi feito um novo levantamento de qual o microcontrolador de 16 bits da Microchip que se deveria utilizar. Optou-se então por utilizar um microcontrolador PIC24FJ128GA006 que disponibiliza mais memória para o programa, mais capacidade de processamento e mais pinos I/O.
Com quase todos os componentes do circuito escolhidos, é necessário passar do papel para um circuito impresso onde podem ser soldados todos os componentes. O programa utilizado para fazer o respectivo schematics foi o Orcad 15.7 com a ferramenta Orcad Capture CIS. Para desenhar os caminhos respeitantes às ligações feitas no schematics, e os footprint dos vários circuitos impressos, foi utilizada a ferramenta Orcad Layout Plus, obtendo assim o desenho real da placa de circuito impresso do sistema de monitorização (ver ANEXO E). Esta ferramenta permitiu também criar os diferentes footprint dos vários componentes utilizados.
		
Universidade de Aveiro	96	
Resumindo, o programa do microcontrolador que irá controlar os sensores e processar os dados foi escrito em linguagem C, utilizando o MPLAB IDE v8.10 e compilado utilizando o compilador C30 da Microchip. A placa do circuito foi desenvolvida utilizando as ferramentas do Orcad 15.7. Para programar o programa no microcontrolador, foi utilizado, também da Microchip, o ICD2, que faculta o envio do resultado do compilador para o microcontrolador.
Figura 4.16 - Programador de Microcontroladores ICD2 [Microchip]28
4.6.	Processamento de Tramas - Envio
Os sistema de monitorização recebe os dados dos vários sensores instalados a uma frequência programada e organiza esses mesmos dados para serem enviados para a unidade central (servidor) os poder processar. Os dados são introduzidos num buffer (trama) juntamente com um identificador respectivo do sensor e a diferença de tempo entre o instante de tempo da recolha dos dados e o instante inicial. Os dados são o resultado da conversão da ADC ou então, a soma do número de interrupções que ocorrem durante um segundo, isto para os sensores de velocidade do vento ou velocidade do aerogerador (as gamas dos dados introduzidos na trama podem ser consultados na Tabela 4.3). Por sua vez, a trama é enviada para o PC a uma determinada frequência ou então quando o buffer da trama estiver cheio.
A trama tem um cabeçalho que identifica o aerogerador da fonte de informação e o tamanho da trama. No final da trama é calculado e anexado um CRC (Cyclic redundancy check) com dois bytes que permite verificar a detecção de erros. CRC é um código de detector de erros que é gerado em poucos bits, de modo a detectar erros de transmissão ou armazenamento.
A trama (ou buffer) de dados que vai ser enviada placa do sistema de monitorização para o programa de servidor tem os seguintes campos; Cabeçalhos, Dados e CRC.
Cabeçalhos	Número Bytes	Valor
Byte 0	1	00000000
Byte 1NNNNNNN	1	NNNNNNN = Tamanho total da trama
Dados	Número Bytes	Valor
Byte AAAASSSS	1	AAAA = ID do Aerogerador SSSS = ID do Sensor/Informação
28 Todas as informações de microcontroladores, do programador ICD2 e do MPLAB IDE em http://www.microchip.com
		
Universidade de Aveiro	97	
Bytes D	variável	D = Data
Byte T	1	T = Diferença de tempo
CRC	Número Bytes	Valor
Byte C0	1	CO = CRC0
Byte C1	1	C1 = CRC1
Tabela 4.2 - Estrutura da Trama
ID do Sinal	Sinal	Frequência Default (Hz)	Número de Bytes	Gama de Valor
1	Sensor Velocidade Vento	1	2	0 a 65535
2	Sensor Direcção Vento	1	2	0 a 1023
3	Sensor Temperatura	1	2	93 a 419
4	Sensor Velocidade Aero	1	2	0 a 65535
5	Sensor Direcção Aero	1	2	0 a 1023
6	Sensor Voltagem Aero	1	2	0 a 1023
7	Sensor Corrente Aero	1	2	0 a 775
8	Sensor Potência Aero	1	2	
9	Sensor Corrente Inversor	1	2	0 a 775
10	Bateria	Minuto a Minuto	2	0 a 1023
11	Ligação Estabelecida		0	-
12	Teste Ligação	Minuto a Minuto	0	-
13	Obter Datetime do PC	Semana a semana	0	-
14	Diferença de tempo	-	0	-
15	Enviar Datetime do PIC	-	6	-
Tabela 4.3 - Identificadores dos dados da Trama
		
Universidade de Aveiro	98	
Diagrama 4.1 - Diagrama de processamento de tramas - Envio
Para marcar a frequência de leitura dos vários sensores utilizou-se o timer5 para gerar interrupções com uma frequência de 1000Hz. Assim, na rotina de interrupção do timer5, programou-se de modo a ao fim de 1000 interrupções, era guardado um novo registo para leitura do estado do aerogerador (velocidade e corrente), e ao fim de também 1000 interrupções, era guardado outro registo para leitura dos valores do estado do tempo (velocidade, direcção e temperatura) na tabela de registo. Assim, a frequência de leitura do estado do tempo e do aerogerador é de 1 Hz.
Sempre que é gerado um novo evento, é escrita informação associada numa trama (buffer) que é enviada para o sistema de monitorização de 3 em 3 segundos (frequência de 0.33Hz). Estes são os valores de monitorização por defeito. No programa de informação Eolitor System é possível alterar a frequência de monitorização do vento e do aerogerador e a frequência de envio das tramas.
Figura 4.17 - Frequência de processamento de tramas
		
Universidade de Aveiro	99	
4.7.	Módulo de Armazenamento de Dados Local
Este módulo surgiu da necessidade de armazenamento da informação durante a perda da ligação entre a placa e o servidor do sistema de monitorização, responsável pelo tratamento dos dados e pelo armazenamento dos mesmos na base de dados. Assim, quando a ligação se perder, o sistema de monitorização tem capacidade de armazenar os dados localmente sem perder informação, podendo também efectuar o papel de descarregador para a base de dados através do PC na próxima ligação. Foi feito um pesquisa de qual a melhor forma de guardar esses dados localmente para este tipo de aplicação. Assim, para implementar localmente este requisito, foram encontradas duas soluções pelo autor:
Solução 1 - A introdução de um módulo de escrita e leitura de um cartão flash SD/MMC.
vantagens: Possibilidade do cartão poder ser retirado e a informação ser descarregada directamente no PC ou em qualquer dispositivo com capacidade de leitura de cartões SD/MMC; a fácil leitura e escrita da informação no cartão devido ao sistema de ficheiros; e a possibilidade programação de uma árvore de directórios com ficheiros contendo informação. A outra vantagem é o facto de esta opção ser menos dispendiosa.
desvantagens: Maior complexidade do projecto e do software, pela necessidade de implementação de um sistema de ficheiros FAT; desgaste dos contactos do cartão como tempo e com a utilização.
Solução 2 - A introdução de uma memória flash NOR com comunicação SPI. vantagens: Circuito integrado simples de instalar na PCB.
desvantagens: Solução mais dispendiosa em relação há anterior	A informação
é armazenada na forma de páginas.
A solução implementada neste projecto foi a primeira com a introdução de um socket de cartões SD, controlado pelo microcontrolador através do protocolo série SPI, e a escrita de um módulo de software para a criação de um sistema FAT, e funções que permitam: criar um sistema de ficheiros, criar uma pasta, criar um ficheiro, ler um ficheiro, escrever num ficheiro, renomear um ficheiro, alterar um ficheiro, entre outras. A estrutura deste módulo está representada na Figura 4.18 e no Diagrama 4.2.
Figura 4.18 - Módulo Armazenamento Local
Diagrama 4.2 - Diagrama Armazenamento de dados Local
File Allocation Table (FAT) é um sistema de ficheiros desenvolvido para o MS-DOS e que continuou a ser utilizado pela Microsoft em sistemas operativos posteriores. Um sistema de ficheiros é uma forma dos Sistema Operativos armazenarem dados num suporte de armazenamento de dados, frequentemente, discos rígidos, discos flash/pendrzves, ou cartões SD/MMC. Sabendo interpretar o sistema de arquivos, que corresponde a um mapa de utilização de um suporte de informação (disco), o Sistema Operativo pode descodificar os dados (localizar os blocos físicos do disco onde os dados se encontram), lendo-os e gravando-os.
As implementações mais comuns de sistema de ficheiros têm o inconveniente de, com a utilização, à medida que se apagam ficheiros e escrevem novos, os blocos que constituem a informação dos ficheiros criados começam a ficar dispersos, ficando o suporte de informação fragmentado, aumentando assim, os requisitos necessários para o seu processamento (PC ou microcontroladores).
Este módulo de armazenamento é composto, como demonstra a Figura 4.18, por uma camada de baixo nível composta pelas funções de leitura e escrita num suporte físico e para obter a data do RTCC, das quais fazem parte, disk_initialize, disk_status, disk_read, disk_write, disk_ioctl e get_fattime. Na camada intermédia estão as funções do sistema de Ficheiros FatFS. Na camada superior, que permite a interface com o utilizador estão as aplicações que vão utilizar as funções do sistema de ficheiros FatFS. As funções estão descritas nas tabelas seguintes, e podem ser consultadas no ANEXO C onde se encontram com mais detalhe.
O módulo FatFs / Tiny-FatFs é um software livre que está aberto para a educação, investigação e desenvolvimento, e pode ser utilizado para uso pessoal sem qualquer restrição, e está disponível na internet através do endereço&amp;lt;http://elm-chan.org/fsw/ff/00index_e.html&gt;.
Modulo Disk I/O e RTCC	
Funções	Descrição
disk initialize	Inicializa Unidade de Disco
disk status	Obtêm o estado do Disco
disk read	Leitura do Disco
disk write	Escrita no Disco
disk ioctl	Controlo de funcionalidades que dependem do Dispositivo
get fattime	Obtêm date e hora do RTCC
Tabela 4.4 - Funções dos Módulos de acesso ao Disco I/O e RTCC
Modulo FatFS	
Funções	Descrição
f mount	Registar/Anular àrea de trabalho
f open	Abrir/Criar Ficheiro
f close	Fechar Ficheiro
f read	Ler Ficheiro
f lseek	Mover ponteiro de ficheiro
f truncate	Truncar ficheiro
f sync	Apagar dados da Cache
f opendir	Abrir Directoria
f readdir	Ler conteúdo de um Directório
f getfree	Obter Clusters Livres
f stat	Obter estado do Ficheiro
f mkdir	Criar um Directório
f unlink	Remover um Ficheiro ou um Directório
f chmod	Alterar atributo
f utime	Alterar Timestamp
f rename	Renomear um Ficheiro ou Directório
f mkfs	Criar um sistema de Ficheiros numa Drive
f forward	Encaminhar caminho de dados
f gets	Ler uma string
f putc	Escrever um caractere
f puts	Escrever uma string
f printf	Escrever uma string formatada
Tabela 4.5 - Funções do Sistema de Ficheiros FatFS
4.8.	Sistema de Alimentação
O sistema de alimentação é um requisito fundamental para o funcionamento do sistema e é diferente dependendo das soluções de instalação. Como já foi referido, se a instalação do sistema de monitorização for feita no local do Aerogerador, devido à falta de rede eléctrica, é necessário projectar um sistema de produção de energia que mantenha o sistema de monitorização funcional. Nos casos em que o sistema de monitorização é instalado
		
Universidade de Aveiro	102	
Assim, foi pensado um sistema que transforme a energia solar em energia eléctrica. Com objectivo de atingir este princípio, recorreu-se a um painel solar. Comercialmente, estes variam consoante a sua “capacidade de captar” energia solar e a “capacidade de fornecer” energia eléctrica. Para as necessidades deste projecto, o painel solar tem de ter a capacidade de disponibilizar uma corrente de saída por volta dos 300mA, o que corresponde a uma potência entre 3W e 5W.
Como a energia eléctrica produzida pelo painel solar não é constante, uma vez que os períodos de exposição solar também não são constantes, torna-se necessária a aplicação de uma bateria capaz de armazenar energia, a utilizar nos períodos em que a produção é mínima. Para carregar a bateria é necessário um dispositivo electrónico (carregador) que monitorize a carga de modo a não danificar a bateria nem a diminuição da sua capacidade. Assim sendo, procedeu-se ao estudo de um mini projecto com capacidade de alimentar o sistema de monitorização. O tipo de Bateria (NiCd, NiMH ou Lithium), a capacidade (Ah), a tensão (V) e corrente (mA) de saída foram algumas das questões levantadas.
A primeira resposta dada para a implementação deste sistema foi o tipo de bateria a utilizar, para a qual é necessária a informação da potência e da quantidade de corrente que o circuito consome instantaneamente, desde os vários sensores, ao módulo de comunicação Wireless e módulo de armazenamento local. Os sensores de corrente, os sensores de velocidade (anemómetro) e de rotação (rpm) consomem cerca de 20mA. O módulo de comunicação consome cerca de 30mA a 70mA consoante a tecnologia utilizada (ver 4.9 -Ligação Wireless). A opção Bluetooth consome mais relativamente à ZigBee. O módulo de armazenamento também consome na ordem das dezenas de mA. O consumo do sistema de monitorização necessita assim de uma potência de cerca de 1W equivalente a cerca de 200mA. Tendo em conta este valor de consumo podemos escolher uma bateria que armazene energia suficiente para ser utilizada nos períodos de ausência de produção de energia por parte do painel solar. Assim, assumindo que durante o dia o painel tem capacidade de produção de energia de forma a carregar a bateria, a capacidade desta tem de ser auto-suficiente para alimentar o sistema de monitorização durante a noite. Tendo em conta que no Inverno as noites podem ter cerca de 14 horas, a capacidade da bateria não pode ser inferior a 2800mAh (200mA x 14h). Esta foi a capacidade mínima estabelecida para a bateria.
Foi dada especial atenção: à capacidade da bateria e o local da aplicação; os preços (€/mAh); a forma como as baterias são carregadas, pois a duração das mesmas é influenciada consoante os vários tipos de bateria. Perante estes requisitos foram encontradas as seguintes opções
Solução 1 - A primeira opção ponderada foi a utilização de baterias de NiMH (Niquel Metal Hidreto). Estas são o tipo de baterias mais usado actualmente, pois oferecem maior capacidade (20% em média comparando com as NiCd), têm maior vida útil, em geral suportam mais recargas comparado com as NiCd, são menos poluentes, já que não utilizam materiais pesados, como o Cádmio, tempo de recarga inferior e maior resistência a variações de temperatura. Outra vantagem desse tipo é a ausência do efeito memória que caracteriza as baterias de NiCd. As baterias de NiMH são normalmente carregadas por uma corrente constante.
		
Universidade de Aveiro	103	
Solução 2 - A outra opção considerada foi a aplicação das baterias de Lithium. Este tipo de baterias é mais pequeno em relação às anteriores, mas consideram-se mais vantajosas, pois a vida útil é maior e podem ter maior capacidade de carga, contudo são mais caras comparativamente às baterias de NiMH.
Tanto para as baterias de NiMH, como para as baterias de Lithium, existem várias opções de fornecedores (Maxim, Analog Devices, Texas Instrument, ST) com circuitos integrados capazes de controlar o processo de carregamento da bateria, garantindo a preservação da mesma. A escolha do carregador de baterias só deverá ser feita depois de seleccionada a bateria.
Figura 4.19 - Sistema de Alimentação remoto
Diagrama 4.3 - Diagrama do Sistema de Alimentação remoto
Figura 4.20 - Sistema de Alimentação local
Diagrama 4.4 - Diagrama do Sistema de Alimentação local
		
Universidade de Aveiro	104	
4.8.1.	Regulador de Tensão
O regulador de tensão foi utilizado com o objectivo de poder ligar a alimentação do sistema, tanto a um painel solar como a um transformador, cuja tensão de saída seja superior a 5V. Assim, este vai estabilizar a tensão em 5V, caso tenha à entrada a gama de tensões necessárias para o poder fazer.
O regulador escolhido foi o TL2575-05 da Texas Instruments (circuito pode ser consultado no ANEXO E), é um regulador STEP-DOWN, cujas características principais são: uma grande gama de tensões de entrada (4.75V até 40V), capacidade de corrente de saída até 1A, grande eficiência (tipicamente 88%), e apenas 4 componentes externas necessárias para o seu funcionamento. O esquema do circuito pode ser consultado no ANEXO E, e a informação relativamente ao regulador TL2575-05 pode ser consultada no site da Texas Instruments29.
Figura 4.21 - Diagrama de Blocos do TL2575-05 [TI]
4.8.2.	Carregador de Baterias Lithium
Para poder ter a bateria no nível de carga considerado óptimo é necessário um circuito electrónico que vá controlar todo o processo de carga, para evitar danificar a bateria. Devido a esta necessidade foi pensado e projectado um circuito para carregar a bateria. Vários fabricantes de circuitos integrados, como a Analog Devices, a ST, a Maxim, a Texas Instruments, entre outros, têm na sua gama de produtos circuitos integrados destinados a todo o processo de carregamento de baterias. O carregador escolhido foi o modelo BQ24002 da Texas Instruments que tem as seguintes características:
-Transistor FET integrado, Bloqueio-inverso Schottky e Protecção de temperatura; -Regulação de tensão e corrente integrada, com programação da corrente de carga; -Alta precisão de tensão;
-Até 1.2A de corrente de carga;
-Temporizador de segurança durante a pré-carga e o carregamento rápido;
-Monitorização da temperatura durante a fase de carga;
-Saídas que indicam o estado do processo de carga.
29	Mais informações em http://focus.ti.com/docs/prod/folders/print/tl2575-05.html
Durante o carregamento de uma bateria, existem três fases; pré-carga, regulação de corrente (fonte de corrente) e regulação de tensão (fonte de tensão). A pré-carga é necessária quando a tensão da bateria está abaixo de um limiar mínimo (estado da bateria pode ser critico). Durante esta fase que dura tipicamente 20min, o carregador injecta uma corrente baixa constante na bateria. A tensão da bateria vai subindo até atingir esse limiar mínimo, passado então para a fase de regulação de carga. Nesta fase, o carregador vai fornecer uma corrente mais elevada, que depende da capacidade da bateria a carregar e pode ser programada, até atingir praticamente a tensão da bateria. Neste ponto, o processo de carregamento comuta de uma fonte de corrente para uma fonte de tensão, e a corrente de carga vai diminuindo exponencialmente. O esquema do circuito de carga da bateria e os cálculos do seu dimensionamento, podem ser consultados no ANEXO E. O diagrama de estados do processo de carga, do carregador BQ24002, pode ser consultado no site da Texas Instruments30.
4.8.3.	Charge Pump
A tensão de alimentação do circuito é 5V, por isso é necessário elevar a tensão da bateria de Lithuim de 4.2V, quando esta for a fonte de alimentação do circuito (sistema de monitorização e sensores). Para tal, foi escolhido um Charge Pump (Conversor DC/DC) TPS60130 da Texas Instruments, que disponibiliza 5V±4% à saída, para tensões de entrada na gama de 2.7V a 5.4V. Este, com eficiência de 90% na referida gama, têm capacidade de disponibilizar até 300mA de corrente à saída. O esquema do circuito pode ser consultado no ANEXO E, juntamente com todos os cálculos auxiliares de dimensionamento, e no site da Texas Instruments31.
30	Mais informações, incluindo o Datasheet em http://focus.ti.com/docs/prod/folders/print/bq24002.html
31	Mais informações em http://focus.ti.com/docs/prod/folders/print/tps60130.html
Figura 4.23 - Diagrama de Blocos do Charge Pump TPS60130 [TI]
Diagrama 4.5 - Diagrama do carregador de baterias
4.8.4.	Supervisor
Como já foi referido anteriormente pelo autor, o circuito de monitorização tem duas fontes de alimentação possíveis, o painel solar e a bateria. Para o painel solar alimentar o circuito, a energia eléctrica produzida, tem de ser superior ao mínimo necessário. Caso essa energia não seja suficiente, devido à ausência de sol, o supervisor vai comutar a saída para a bateria, passando esta a ser fonte do circuito, e mantendo assim o circuito funcional.
Para solucionar este problema, foi seleccionado um supervisor que tem o mesmo princípio, comutar a saída para a entrada da bateria, caso a entrada Vcc seja menor do que um limiar, dimensionado externamente. Assim, o supervisor adoptado foi o modelo ADM696 da Analog Devices. A entrada Vcc deste supervisor vai estar ligada à saída do regulador de tensão de 5V (TL2575-05) e a entrada da bateria vai estar ligado à saída do charge pump (TPS64130). O esquema do circuito pode ser consultado no ANEXO E, juntamente com todos os cálculos de dimensionamento do circuito. O diagrama do circuito de alimentação incluindo o Supervisor, e o diagrama de blocos do Supervisor estão representados nos diagramas seguintes.
Diagrama 4.6 - Diagrama do supervisor ADM696
BATTON
Figura 4.24 - Diagrama de Blocos do ADM696 [Analog Devices]32
4.9.	Ligação Wireless
A Ligação Wireless só é necessária se o sistema de monitorização for instalado no mesmo local que o Aerogerador, ou então, caso o PC Servidor onde estiver a ser executado o programa Eolitor Server, não estiver perto do controlador do Aerogerador. Isto devido à necessidade de enviar os dados para o servidor.
As duas tecnologias que foram analisadas para a transmissão de dados foram a Bluetooth e a ZigBee.
4.9.1.	Bluetooth
Bluetooth, ou IEEE 802.15.133, é uma tecnologia para comunicação sem fios entre dispositivos, nomeadamente computadores, telemóveis, impressoras, auto-rádios, câmaras digitais, entre outros. Baseia-se numa ligação de rádio de curto alcance e baixo custo.
A tecnologia Bluetooth depende da tecnologia de rádio frequência e do protocolo de software que permita transmitir os dados entre dois dispositivos. Os dispositivos com este padrão podem comunicar entre si, mas existem algumas limitações, tais como a quantidade de dados que serão enviados, o tipo de comunicação entre os dispositivos e as frequências de rádio onde a comunicação ocorrerá.
Os dispositivos com tecnologia Bluetooth operam em três bandas de rádio conhecidas como ISM (Industrial, Scientifical and Medical) centrada em 2,45 GHz. Nos Estados Unidos, a faixa ISM varia de 2400 a 2483,5 MHz, e no Japão a faixa varia entre 2400 a 2500 MHz. Na maioria dos países da Europa, a mesma banda também está disponível.
Os dispositivos equipados com Bluetooth estão capacitados para comunicar uns com os outros quando estão dentro do raio de alcance. Estes empregam um sistema de comunicação via rádio, por isso para poderem comunicar é necessário que a potência seja
32	Mais informações em http://www.analog.com/en/power-management/supervisors/ADM696/products/product.html
33	Informação relativo ao Bluetooth em http://www.bluetooth.com/bluetooth/ e https://www.bluetooth.org/apps/content/
		
Universidade de Aveiro	108	
		
Classe	Potência máxima permitida (mW/dBm)	Alcance
Classel	100 mW (20 dBm)	~ 100 metros
Classe2	2.5 mW (4 dBm)	~ 10 metros
Classe3	1 mW (0 dBm)	~ 1 metros
Tabela 4.6 - Alcance e potência máxima das diferentes Classes Bluetooth
4.9.2.	ZigBee
ZigBee, ou IEEE 802.15.4, representa um tipo de tecnologia de redes sem fios ainda em aperfeiçoamento, definida por um conjunto de empresas chamado ZigBee Alliance34, cujo objectivo é realizar a interligação de pequenas unidades de comunicações de dados em áreas muito limitadas recorrendo a sinais de rádio frequência não licenciados. Estas ligações são equiparadas às redes Wi-Fi e Bluetooth, mas diferenciam-se na medida em que necessitam de menos consumo, por um alcance reduzido (cerca de 10 metros, apesar de actualmente existirem módulos de comunicação com ampliação com alcance da ordem dos km) e, distinguem-se ainda, pelo facto da comunicação entre duas unidades poder ser repetida sucessivamente pelas unidades existentes. Esta faculdade constitui uma rede de comunicações, que admite diferentes topologias: estrela (star), malha (mesh) ou árvore (cluster tree), permitindo o estabelecimento de redes de nós “ad-hoc”. Outra característica relevante é o facto de poder suportar até um máximo de 65535 dispositivos por cada ZigBee Coordinator, muito superior aos 8 do Bluetooth e 30 do Wi-Fi.
Com estas características o ZigBee tem uma vasta área de aplicação, desde o controlo industrial à automação de residências (domótica), e pode ser encontrado na faixa ISM que estão isentas de licenciamento.
Globalmente, corresponde à banda de 2.4GHz que permite obter taxas de transmissão de 250Kbps com 16 canais disponíveis. Existem ainda as bandas de 915MHz, instituídas nos Estados Unidos, que permitem uma taxa de transmissão de 40Kbps e 10 canais de comunicação e bandas de 868 MHz aqui na Comunidade Europeia, que possibilitam apenas 1 canal de comunicação com uma taxa de transmissão de 20Kbps.
Em termos de modulação, utiliza-se O-QPSK (Offset Quadrature Phaseshift Keying) para a banda dos 2.4Ghz e BPSK (Binary Phase Shift Keying) para os 915 ou 868Mhz. Perante estas características, esta tecnologia foi criada essencialmente como uma alternativa de comunicação a aplicar em redes que não necessitem de soluções muito complexas, diminuindo assim os custos da aplicação. Trata-se de uma tecnologia de relativa simplicidade e de baixo custo, utilizando um protocolo de pacotes de dados com características específicas, projectada para oferecer flexibilidade quanto aos tipos de dispositivos que pode controlar.
34 Informação relativa à ZigBee Alliance em http://www.zigbee.org/en/index.asp
		
Universidade de Aveiro	109	
Atendendo á categoria da rede poder-se-ão instalar três tipos de dispositivos lógicos: Coordinator, Router e Endpoint.
Na topologia estrela cabe ao ZigBee Coordinator todo o controlo da rede assumindo uma comunicação directa com todos os dispositivos Endpoint - é portanto o Coordinator que
inicia e mantém os dispositivos na rede. Toda a informação em circulação na rede passa pelo
nó Coordinator.
Figura 4.25 - Topologia em estrela (star)
ZigBee Coordinator
ZigBee Router
ZigBee Endpoint
Na categoria de rede em malha os dispositivos Coordinator/Routers são livres de comunicar com outros dispositivos iguais, o que faz com que haja expansão física da rede (maior alcance), sempre que se verifique conveniente. O Coordinator, quando relacionado com esta topologia, não demonstra tanto protagonismo registando apenas todas as entradas
e saídas de dispositivos.
Figura 4.26 - Topologia malha (mesh)
No que diz respeito á topologia árvore, a distribuição de dados e mensagens de
controlo é feita numa estrutura hierárquica. Desta forma, os Endpoint comunicam com os
Routers mais próximos e estes, por sua vez, com o Coordinator da rede.
Figura 4.27 - Topologia árvore (cluster tree)
Pelas características apontadas anteriormente, podemos identificar que a utilização de Bluetooth é mais vantajosa para aplicações como: a sincronização de PCs, telemóveis e PDAs; aplicações de áudio com microfone sem fio; e transferência de arquivos entre PDAs, PCs e Impressoras. Apresenta ainda outra grande vantagem pelo facto de ser uma tecnologia mais padronizada do que o ZigBee. Já o ZigBee tem melhor performance em outro tipo de aplicações, tais como: redes de sensores e de controlo; redes com muitos dispositivos; com pequenos pacotes de dados; e onde consumo de bateria se verifique crítico.
		
Universidade de Aveiro	110	
	ZigBee	Bluetooth
Padrão (MAC + PHY)	IEEE 802.15.4	IEEE 802.15.1
Taxa de Transferência	250kbps	750kbps
Corrente Transmissão	30mA	40 mA
Corrente Standby	3uA	200uA
Memória	&gt;32Kb	&lt;100Kb
Tabela 4.7 - ZigBee vs Bluetooth
Outra das diferenças relevantes entre estes dois padrões é o tipo de alimentação dos dispositivos: em aplicações Bluetooth, geralmente, os dispositivos são recarregados periodicamente, como é o caso dos Telemóveis e PDAs, enquanto que o padrão Zigbee permite duração superior a 2 anos, apenas alimentados com pilhas alcalinas.
	ZigBee	Bluetooth
Tempo de acesso a rede	30ms	3s
Tempo de transição do estado Standby para Transmissão	15ms	3s
Tempo de acesso ao canal	15ms	2ms
Tabela 4.8 - ZigBee vs Bluetooth
Com a análise destas diferenças, pode-se concluir que ZigBee e Bluetooth são duas tecnologias diferentes com distintas aplicações. Mesmo que seja possível a alteração destas características por software, as características principais não são alteradas, pois dizem respeito à arquitectura em que estes padrões foram desenvolvidos, para darem resposta a diferentes aplicações e pré-requisitos.
Actualmente é utilizada a tecnologia bluetooth para a ligação entre a placa de circuitos impressos e o programa que está a ser executado no PC.
Figura 4.28 - Posição das várias tecnologias wireless35
35 Imagem retirada de http://www.zigbee.org/imwp/idms/popups/pop download.asp?ContentID=12394
4.10.	Eolitor Server
Como já foi referido anteriormente, o sistema de monitorização não é apenas constituído pela placa de circuito integrado, mas também por um programa Eolitor Server e por uma ligação entre estes, com fios (USB) ou sem fios (Bluetooth). Contudo, a execução do servidor Eolitor Server deve ser independente da ligação.
Este programa é responsável, através da abertura de uma porta de comunicação, que pode ser configurada (ver Figura 3.2 - Eolitor Server), para recepção dos dados contidos nas tramas enviadas pela placa, e o armazenamento dos mesmos na base de dados, ficando assim completo todo o sistema de monitorização. Os dados que foram inseridos nas tramas pela placa do sistema de monitorização, têm o formato que já foi referido anteriormente (ver 4.6 -Processamento de Tramas - Envio). Assim é necessário programar o processador de dados do servidor em conformidade com o formato da trama. Este é explicado em seguida.
Paralelamente ao armazenamento dos dados na base de dados, o programa Eolitor Server permite também o envio dos mesmos dados, através do servidor TCP desenvolvido para aceitar ligações TCP/IP, de vários clientes.
4.10.1.	Servidor TCP
Com o objectivo de dar resposta à necessidade de visualizar a monitorização do aerogerador, independentemente do local, foi desenvolvido um servidor TCP para permitir ligações remotas através do protocolo TCP/IP, com base na abertura de Sockets (System.NetSockets).
Após o início do programa, é criado um Socket (Begin) e o programa fica à escuta até ter pedidos de ligação no porto configurado. Depois de existir um pedido, o programa vai para o estado de aceitação da ligação (Accept). Caso o pedido de ligação seja aceite, a ligação está criada e o servidor fica à espera de receber dados (Receive). No entanto, é criado um novo Theard (fio de processamento) que mantém o servidor TCP à escuta de novos pedidos de ligação. No caso de o cliente enviar dados para o servidor, esses são replicados para todos os clientes ligados ao servidor (send). Neste caso, também é criado um novo Theard que fica à espera da existência de dados vindos dos clientes já aceites. O servidor pode então ser representado pelos seguintes estados.
_________/	\	BeginReceive
Receive
BeginSend
Diagrama 4.7 - Diagrama de Estados do Servidor TCP
Login	•	Novo cliente estabelece ligação com o Servidor •	Servidor aceita ligação e adiciona novo cliente à lista de clientes
Logout	•	Um cliente terminou a sua ligação com o Servidor •	Servidor apaga cliente da lista de clientes •	Envia para todos os clientes o nome do cliente que terminou ligação
Message	• Mensagem que o cliente envia para o servidor e o servidor replica para os restantes clientes
List	•	Lista com todos os clientes que estão actualmente ligados ao servidor •	Servidor envia a lista quando um novo cliente estabelece ligação
Null	• Sem Comando
Figura 4.29 - Lista de mensagens que são trocadas entre Servidor/Cliente
Com base no diagrama de estados e na lista de mensagens, foi desenvolvido um cliente TCP, com objectivo de ser o servidor de dados da monitorização. A junção destes dois programas constitui o servidor do projecto, denominado Eolitor Server.
Este programa permite configurar a porta de comunicação (System.IO.PortSerialPort) que foi aberta devido à ligação física entre a placa do sistema de monitorização e o computador, de forma a poder receber as tramas. Em seguida o programa processa essas mesmas tramas, obtendo os valores da monitorização, para posterior armazenamento na base de dados através da execução de store procedures, que foram mapeadas pela classe DataContext criada a partir do recurso LINQ to SQL. Ao mesmo tempo os dados são enviados para o servidor TCP, que por sua vez, envia para os clientes que estiverem ligados. Deste modo, todos os clientes que se ligarem ao Eolitor Server começam a receber de imediato dados, podendo visualizar o estado da monitorização, em tempo real.
Existe um caso particular para as ligações que são estabelecidas a partir do interface da Figura 3.6 - Eolitor System - p.SD Terminal. Para estes clientes, a comunicação é feita ponto a ponto, isto é, cada cliente envia mensagens para o servidor, e este envia as mensagens de volta apenas para esse cliente, após contactar o microcontrolador e o cartão p.SD que estão inseridos na placa do sistema de monitorização. Para os clientes que estabelecerem ligações a partir do interface da Figura 3.4 - Eolitor System - Monitor, as mensagens são envidas ponto multiponto, isto é, o servidor é a fonte das mensagens enviando a mesma mensagem para todos os clientes.
A implementação desta arquitectura cliente - servidor no projecto, tem como grandes vantagens:
-Possibilidade de ligação com o servidor em qualquer lugar, bastando para isso um acesso à internet, assumindo que o PC servidor ou o router de interligação entre a internet e a intranet, não tenha o acesso ao MS SQL Server e ao porto TCP do programa Eolitor TCP Server bloqueados;
-Distribuição do processamento, ficando o programa de servidor menos exigente.
Eolitor Server
Monitor
pSD Terminal
X—K
Figura 4.30 - Rede Servidor/Cliente do projecto Eolitor
4.10.2.	Processamento de Tramas - Recepção
Os dados, em forma de tramas, que chegam ao PC Servidor, têm de ser processados de forma a obter, correctamente, a informação contida. Assim, a programação do processador de tramas tem de ser feita em conformidade com a programação do microcontrolador que edita e envias as tramas, i.e., o programa tem de ser programado para receber tramas com o formato descrito na Tabela 4.2 - Estrutura da Trama e os dados têm de ser correctamente etiquetados com os identificadores descritos na Tabela 4.3 - Identificadores dos dados. O diagrama de estados para processar os dados tem de ser igual ao Diagrama 4.8. Sempre que existem dados no buffer da porta de comunicação para serem processados, o processador de tramas vai sincronizar (syncro) com o inicio de uma trama, procurando um Byte igual a 0. Se encontrar esse Byte, esse pode ser o inicio de uma nova trama se o Byte seguinte for igual a 1NNNNNNN (length), em que o valor do NNNNNNN é igual ao tamanho da trama. Caso contrário, o processador de tramas vai para o estado de sincronização. Este é o primeiro mecanismo de detecção de erros que existe. Se o tamanho da trama for válido, o processador vai para o estado de dados (Data) e depois para o estado do código de erros (CRC). Este código CRC é o segundo mecanismo de detecção de erros na trama e é gerado e introduzido na final da trama. O PC está também programado para gerar o mesmo código CRC de modo a poder verificar a existência de erros no envio da trama. Caso o código gerado pelo PC seja igual ao código da trama então a trama não contem erros e consequentemente os dados
Se todo o mecanismo anterior não tiver erros, o processador de dados vai continuar, importando agora ler o identificador dos dados de forma a saber interpretar o seu valor. Consoante o identificador os dados vão ser convertidos de modo a informação fazer sentido para o sistema. Se o tamanho de dados processados ainda não é igual ao tamanho da trama inicial então significa que ainda existem dados para ser processados e o processo de identificação dos dados vota a ser repetido.
Sempre que existirem tramas para serem processadas, o ciclo de processamento é sempre repetido com o aspecto do diagrama seguinte. Caso exista a necessidade de introduzir informação na trama proveniente do sistema de monitorização, que leve à alteração do formato da trama, essas alterações tem de ser repercutidas no processador de dados de modo
Diagrama 4.8 - Diagrama de processamento de tramas - Recepção
Como foi mencionado no diagrama anterior, o processador de tramas tem 4 estados, Syncro, Length, Data e CRC
Ao fim de os dados contidos na trama serem processados e validados, estes vão ser invocados numa função que converte o seu valor mediante o valor do identificador. Os dados que vêm na trama, são o resultado directo da leitura de ADC, logo o seu valor pode variar de 0 a 1023, e do número de interrupções verificadas durante 1 segundo (valor máximo com 2 bytes, igual a 65535). Assim, é a função de conversão que vai transformar este valor na unidade do Sistema Internacional SI, consoante o identificador.
Após o processo de conversão, os dados nas respectivas unidades SI (exemplo, velocidade em m/seg, tensão em Volt, corrente em A), existe um buffer com uma determinada dimensão, onde são guardados os dados convertidos, e quando é completamente escrito é invocada automaticamente a função que permite guardar estes dados na base de dados nas respectivas colunas. A forma como é escrita a informação na base de dados é através da classe
		
Universidade de Aveiro	116	
5.1.	Introdução
Projectado o sistema de monitorização que recolhe os dados do estado do vento e do comportamento causado no aerogerador, juntamente com o programa Eolitor Server que os recolhe, processa e armazena, surge a necessidade de desenvolver interfaces que possibilitem a consulta dos dados. Assim foi desenvolvido um sistema de informação, que consiste num programa (software) destinado a ser executado num computador, para ir ao encontro destes pré-requisitos. Este computador poder ser o mesmo onde está a ser executado o programa de servidor Eolitor Server, ou qualquer um desde que esteja ligado a este através de uma ligação de internet. Deste modo todo o Sistema Eolitor foi projectado com base na arquitectura de Servidor/Cliente.
Foi realizado um levantamento das tecnologias mais apropriadas à realização deste sistema que irá ser explicado mais detalhadamente durante este capítulo, desde as tecnologias utilizadas para desenvolver o programa de interface do sistema, e processamento de dados, até à ligação com a Base de Dados de suporte do sistema.
		
Universidade de Aveiro	117	
5.2.	Arquitectura do Sistema
O sistema de informação está ligado ao servidor Eolitor Server através de uma ligação TCP/IP. A execução do sistema de informação deve ser independente do local da ligação. O sistema de informação é responsável por receber os dados provenientes do sistema do servidor, processá-los permitindo aos utilizadores (clientes do sistema) a visualização do comportamento instantâneo do Aerogerador. Este tem de permitir também a interligação com uma base de dados de modo a poder guardar não só o estado do Aerogerador, mas toda a informação associada ao sistema Eólico desde os vários modelos de aerogeradores instalados e fabricantes, até a duração das peças e reparações existentes ou ainda informação da quantidade de energia produzida e entregue à rede. O tipo de informação que pode ser armazenada na Base de Dados pode ser consultada no Modelo de Dados Persistente (ver ponto 3.7) onde estão descritas todas as tabelas que compõem a Base de Dados. A ligação entre o programa do sistema de informação e a base de dados também é suportada numa ligação TCP/IP.
Este sistema é composto por um PC onde está a ser executado o programa facultando: -recepção dos dados, através de uma ligação TCP/IP local ou remota;
-tratamento dos dados e de todas as informações relevantes do sistema;
-armazenamento de todos os dados e informações, através de uma ligação à Base de Dados;
-consulta, através do interface gráfico, de todas as informações relevantes do sistema;
-consulta, através da geração de gráficos e relatórios.
Diagrama 5.1 - Diagrama da arquitectura do Sistema de Informação
		
Universidade de Aveiro	118	
5.3.	Tecnologias Implementadas
Com base na informação dos pré-requisitos do sistema de informação foi feita uma pesquisa de quais as tecnologias ao nível do software que mais se adaptavam à realização deste sistema. A primeira pesquisa incidiu em programas de desenvolvimento de software destinados ao sistema operativo Linux, uma vez que a disponibilidade de aplicações existentes para Linux é grande e sem necessidade de licenças. A contrapor com esta opção estavam as ferramentas da Microsoft para desenvolvimento de aplicações de software suportadas pelos vários SDK disponibilizados e pelo programa de desenvolvimento Microsoft Visual Studio.
5.3.1.	Microsoft Visual Studio
O Visual Studio é um conjunto de ferramentas integradas para o desenvolvimento de software, desde aplicações básicas, até aplicações profissionais. A versão mais recente é a 2008 e dá suporte a projectos de desenvolvimento destinados à Web (incluindo o AJAX e ASP.NET), ao Windows Vista, ao Windows Server 2008, ao Microsoft Office 2007, ao SQL Server 2008 e a dispositivos Windows Mobile. Este permite criar aplicações destinadas às varias versões do .NET Framework (2.0, 3.0 e 3.5). Do ponto de vista dos programadores, o ".NET Framework" é o sistema operacional. É através dele que são invocadas todas as funções necessárias ao funcionamento dos programas, sob os sistemas de operação Windows.
Figura 5.1 - Microsoft Visual Studio 2008
A escolha recaiu pelas tecnologias da Microsoft pela facilidade e disponibilidade, maturidade das tecnologias, documentação e programas de exemplos associados. A escolha da Framework 3.5 deveu-se pelo aparecimento de um conjunto de recursos, denominado Language integrated Query (LINQ) que permitem realizar consultas directas em várias estruturas de dados, documentos XML, base de dados, colecção de objectos, usando sintaxe idêntica à SQL. Em particular, o LINQ to SQL foi utilizado para converter consultas (escritas em VB.NET) em SQL dinâmico, permitindo mapear os objectos da base de dados gerando as classes para realizar as operações usando a sintaxe LINQ. É também muito útil para realizar alterações e actualizações nos objectos e na base de dados. Este veio inovar e facilitar as ligações à Base de dados permitindo diminuir o código necessário, devido ao mapeamento dos objectos da base de dados, e com isso as ligações à Base de dados e os respectivos erros.
		
Universidade de Aveiro	119	
Arquitetura do LINQ
c#	Visual Basic	i	Outras inguagem
NET LINQ (language Integrated Query)		
Fontes de dados habilitadas para LINQ		
	ADO.NET habilitado para LINQ	
LINQ para objetos	UNQ para	UNQ para	UNO conjuntos	co,	para de dados	entidades	LINQ para XML
		
A	B		
Objetos	Relational	xml
Figura 5.2 - Arquitectura do LINQ36
Escolhido a plataforma de desenvolvimento (Microsoft Visual Studio), as ferramentas (.NET Framework SDK) falta escolher a linguagem de programação do sistema. As duas linguagens mais administradas para o desenvolvimento desta aplicação, disponibilizadas pela plataforma de desenvolvimento, são o VB.NET (Visual Basic.NET) e C# (C Sharp). Ambas são linguagens orientadas a objectos, e com suporte a UML, criadas pela Microsoft e distribuídas com o Visual Studio.Net que poderiam ser utilizadas, uma vez que têm as ferramentas necessárias para o desenvolvimento.
5.3.2.	Visual Basic.Net
O Visual Basic.Net é uma das linguagens do Microsoft .Net Framework que possui muitos recursos, inclusive para trabalhar com XML36 37. O Visual Basic.NET é a ultima versão, extremamente diferente do antigo Visual Basic 6.0. Não só a maneira de programar foi alterada, mas com a introdução de todo o conceito de programação orientada a objectos, transformaram a linguagem permitindo muitos mais recursos. A Microsoft descontinuou o Visual Basic 6.0, tornando a linguagem mais próxima das linguagens do Visual Studio, embora ainda seja diferente de outras como o Visual C++, C#, etc. Contudo, o Visual Basic.Net ainda continua a ser preterido relativamente ao C#, preferido por programadores de Java.
Nas primeiras versões do Visual Basic, não era permitido acesso a Base de dados, sendo destinado a iniciantes, mas devido ao sucesso entre as empresas (partilha de componentes), o Visual Basic passou a incorporar as tecnologias de ligação a Base de dados DAO, RDO e ADO, também da Microsoft, permitindo o acesso fácil a Base de dados. ADO.NET consiste num conjunto de classes, definidas pelo .NET framework, que pode ser utilizado para receber os dados armazenados numa base de dados remota.
36	Imagem retirada de http://www.macoratti.net/07/12/net linq.htm
37	O XML é a abreviação de Extensible Markup Language que foi desenvolvida em 1996 pelo XML Working Group do World Wide Web Consortium (W3C)
5.3.3.	C#
Como já foi referido existem várias linguagens distribuídas com a plataforma .NET da Microsoft (VB.NET, C++, J#), contudo a considerada da .NET, é a C#, porque foi criada totalmente para funcionar nesta plataforma, e o seu compilador foi o primeiro a ser construídos, e a maior parte das classes do .NET Framework foram desenvolvidas em C#.
A opção recaiu por VB.NET, pela falta de experiência do autor na programação de ambas as linguagens e por, mediante a consulta de pequenos programas, analisar que a linguagem VB.NET é mais intuitiva do que C#. Isto, porque ambas poderiam ser utilizadas para nesta aplicação.
5.3.4.	MS SQL Server 2005
Outra das escolhas a fazer no âmbito deste projecto, tem a ver com a base de dados a utilizar para armazenar todas as informações do sistema. A lista de base de dados existentes que podem ser utilizadas neste sistema é extensa, das quais se destacam: MySQL, Microsoft Access, Firebird, Microsoft SQL Server e Oracle. Destas a base de dados MySQL por ser “open source” e por existirem programas para criação e desenvolvimento da mesma também “open source”, pode ser considerada uma escolha viável. Contudo, e devido à maior disponibilidade de ferramentas de ligação com o programa do Visual Studio, ao número de demonstrações e à documentação disponibilizada na internet e na MSDN38 (Microsoft Developer Network), a base de dados escolhida foi a MS SQL Server Express.
O MS SQL Server é um software que permite gerir Base de Dados relacionais pessoais e amadoras, até às mais robustas e profissionais, com a integração da ferramenta Business Intelligence (BI). Do suporte ao Microsoft .NET Framework, à estreita integração com o Microsoft Visual Studio, os novos recursos do MS SQL Server facultam a mais fácil e mais rápida criação de aplicações seguras e sólidas de base de dados. Actualmente encontra-se na versão 2008, contudo a versão escolhida foi a MS SQL Server Express 2005 que pode ser adquirida no site da Microsoft.
O motor de base de dados SQL Server 2005 garante um armazenamento mais seguro e fiável, tanto para dados relacionais como estruturados, permitindo criar e gerir aplicações de dados de elevada disponibilidade e desempenho. Esta versão de SQL Server disponibiliza também as mais avançadas ferramentas de análise, reporting, integração e notificação, que permite criar e implementar soluções de BI eficientes em termos de custos que ajudam a transportar dados para qualquer parte através de scorecards, dashboards, Web services e dispositivos móveis.
38 Documentação disponível na internet na pagina http://msdn.microsoft.com/pt-pt/default(en-us).aspx
		
Universidade de Aveiro	121	
CD
¡motramaaangEa
aanimiraeiiEHa
Figura 5.3 - Principais componentes do SQL Server 200539
A plataforma de dados MS SQL Server inclui as seguintes ferramentas:
Base de Dados Relacional. Um motor de base de dados relacional mais seguro, fiável, escalável e de elevada disponibilidade, com uma melhor performance e suporte para dados estruturados e não estruturados (XML).
Serviços de Replicação. Replicação de dados para aplicações móveis de processamento de dados distribuídas, elevada disponibilidade de sistemas, concorrência escalável com repositórios de dados secundários para soluções empresariais de reporting e integração com sistemas heterogéneos, incluindo bases de dados Oracle existentes.
Notification Services. Capacidades de notificação acrescidas para o desenvolvimento e implementação de aplicações escaláveis susceptíveis de oferecer actualizações de informação personalizadas e atempadas a uma diversidade de dispositivos fixos e móveis.
Integration Services. Capacidades de extracção, transformação e carregamento (ETL) de dados para o seu armazenamento e integração ao nível de toda a empresa.
Analysis Services. Capacidades de processamento de operações de análise online (OLAP) para uma análise rápida e sofisticada de conjuntos de dados complexos e de grande dimensão, através do recurso a armazenamento multidimensional.
Reporting Services. Uma solução abrangente para a criação, gestão e entrega de relatórios, tanto tradicionais, em papel, como interactivos, baseados na Web.
Ferramentas de Gestão. O SQL Server inclui ferramentas de gestão integradas para uma melhor gestão da base de dados, bem como uma estreita integração com ferramentas como o Microsoft Operations Manager (MOM) e o Microsoft Systems Management Server (SMS). Protocolos padrão de acesso a dados reduzem drasticamente o tempo de integrar dados com sistemas existentes no SQL Server. Por outro lado, o suporte nativo para Web services integrado no SQL Server assegura a interoperabilidade com outras aplicações e plataformas.
Ferramentas de Implementação. O SQL Server oferece ferramentas de desenvolvimento integradas para o motor da base de dados, extracção, transformação e carregamento de dados, data mining, OLAP e reporting estreitamente integradas com o Microsoft Visual Studio, propiciando assim capacidades de desenvolvimento da aplicação
39 Informação retirada do sitio da Microsoft Portugal em http://www.microsoft.com/portugal/sal/default.mspx
Estas funcionalidades ajudarão as empresas a progredir em três grandes áreas:
Gestão de Dados Empresariais. O SQL Server 2005 proporciona uma plataforma de dados mais fiável, segura e produtiva para aplicações da linha de negócio e de análise.
Produtividade do Programador. O SQL Server 2005 proporciona um ambiente de desenvolvimento end-to-end rico numa série de novas tecnologias que reforçam o poder dos programadores e aumentam significativamente a sua produtividade.
Business Intelligence. As funcionalidades abrangentes de análise, integração e migração de dados do SQL Server 2005 permitem às empresas ampliar o valor das suas aplicações existentes, independentemente da plataforma subjacente. Soluções de BI construídas no SQL Server 2005 colocam informação crítica e atempada nas mãos de todos os colaboradores, permitindo-lhes tomarem melhores decisões em menos tempo.
		
Universidade de Aveiro	123	
5.4.	Processamento de Dados
Os dados que são recebidos pelo programa cliente, Eolitor System, do sistema de informação, são os dados enviados pelo servidor Eolitor Server. Estes dados que o servidor envia para todos os programas clientes, derivam da replicação dos mesmos dados, que recebe no buffer da porta de comunicação, provenientes da placa do sistema de monitorização, sem introduzir nenhuma alteração. Deste modo, as tramas que o programa do sistema de informação recebe, são iguais às tramas que o servidor recebe provenientes da placa do sistema de monitorização. Assim, o processador de dados do sistema de informação (programa cliente) é exactamente o mesmo que o processador de tramas do sistema de monitorização (programa servidor). A única diferença entre os dois, é que no caso do programa de servidor, ao fim de este processar os dados, são armazenados na base de dados, enquanto no caso do programa do sistema de informação, são utilizados para actualizar os gráficos e indicadores da interface de monitorização (ver Figura 3.4 - Eolitor System -Monitor). Deste modo, os detalhes do processador de dados são os mesmos do processador do sistema de informação, e podem ser consultados em 4.10.2 - Processamento de Tramas -Recepção.
		
Universidade de Aveiro	124	
5.5.	Interface Visual
O interface gráfico visual é uma das necessidades básicas dos sistemas de informação que permite aos utilizadores interagirem com o sistema, admitindo uma diferente perspectiva. Este ambiente gráfico foi feito para facilitar, e permitir, uma utilização prática do sistema pelo utilizador, e tem de ser desenvolvido sempre com estas características
presentes.
Para este sistema de informação já foram referidas as necessidades, e quais os dados que são fundamentais disponibilizar na interface visual. Foram também mostrados algumas figuras das várias interfaces dos programas desenvolvidos no subcapítulo Protótipo Exploratório do capítulo de Modelação (ver 3.5 Protótipo Exploratório). Os percursos, das opções mais importantes, que podemos fazer pelas interfaces estão de forma resumida no
diagrama seguinte.
Eólitor System
Monitor
DB Connection
SD Terminal
^Fechar Programa^
Escolher
Aerogerador
Escolher Tabela
Escolher Aerogerador
Porta de Comunicação
Escolher Tipo de Gráfico
Tipo
Utilização’
Tempo Real
Escrever utilizador e password
Escolher Instante de tempo
Data de Inldo Simulação
Escolher Porta de Comunicação
Introduzir Dados
Escolher Dados
Escolher Variáveis
Iniciar Simulação
Iniciar
Monitonzaçâo
Ligação?
Guardar Dados
Existem Dados?

Ver dados no interface
Escolher		Escolher
Inpressora		Nome
Escolher Formato e Directório
Diagrama 5.2 - Estrutura do Programa
Do diagrama anterior podemos perceber que todo o programa tem, basicamente, seis interfaces diferentes; o interface inicial, o interface principal de monitorização, o interface de configuração da ligação à Base de Dados, o interface da base de dados, o interface de comunicação com o SD e o interface de gráficos e histórico. Para além destes existem também
		
Universidade de Aveiro	125	
No interface inicial (ver Figura 3.3 - Eolitor System - Home) é possível escolher a abrir todos os restantes interfaces do programa. No de monitorização (ver Figura 3.4 - Eolitor System - Monitor) é possível observar os dados da monitorização em tempo real. Para tal, basta apenas escolher qual o Aerogerador que pretendemos monitorizar, escolher o endereço de IP do servidor e estabelecer a comunicação. Neste mesmo interface é possível escolher, em vez de visualizar a monitorização em tempo real, uma simulação de monitorizações anteriores, cujo conteúdo está armazenado na base de dados, escolhendo apenas o aerogerador e o instante inicial de simulação. No interface da Base de dados (ver Figura 3.5 -Eolitor System - SQL Database) podem ser adicionados, alterados ou apagados dados referentes do sistema. O tipo de dados que podem ser adicionados pode ser consultado em Modelo de Dados Persistente.Já no interface do pSD (ver Figura 3.6 - Eolitor System - pSD Terminal) é possível comunicar com o cartão SD utilizando os comandos que estão demonstrados no mesmo interface e através das funções do sistema de ficheiros FatFS efectuar as alterações respectivas no cartão pSD, vendo os resultados na janela de dados. No que concerne ao Interface Emailer (ver Figura 3.8 - Eolitor System - Emailer) é possível enviar um email para, por exemplo, o Administrador do Sistema ou para algum responsável de manutenção, avisando de alguma anomalia do Aerogerador ou seus componentes ou simplesmente o comportamento do aerogerador. Outra das opções é o envio e um email automático para um endereço de email previamente configurado. Este email poderia ser motivado por diversas acontecimentos. São exemplos os seguintes casos; o sistema detecte alguma anomalia, como o fim de validade de alguma peça ou a sobrecarga do sistema ou a perda de ligação com o sistema de monitorização ou apenas os relatórios gerados. No âmbito do interface DB Charts (ver Figura 3.10 - Eolitor System - Database Charts) é possível ver estatísticas da produção e desempenho do Sistema Eolitor através da geração de gráficos. Para tal, é necessária a escolha do aerogerador, do tipo de gráficos e das variáveis que se pretendem visualizar. Os tipos de gráficos que podem ser visualizados são os clássicos gráficos de barras horizontais ou verticais e linha ou então circular, pirâmide ou radar para os gráficos de percentagens. Tendo escolhido o gráfico a representar este interface, é possível no fim da criação do gráfico, guarda-lo com vários formatos de destino, entre os quais pdf, bmp, jpg, png, entre outros, ou então permite imprimir o mesmo caso o PC esteja ligado a uma impressora.
Outra das opções que o autor desejava introduzir neste interface era a possibilidade de, mediante a escolha dos dados e intervalo temporal, ser produzido um relatório com esses mesmos dados, facilitando a consulta do comportamento e estado da produção de energia.
Em qualquer momento o utilizador pode optar pelo fim da execução do programa ou o fecho das interfaces abertas. O programa apenas termina a execução após o fecho da interface inicial.
		
Universidade de Aveiro	126	
5.5.1.	Home
No interface inicial o utilizador tem a possibilidade de escolher qualquer dos restantes interfaces do programa, clicando sobre o respectivo botão. Associado ao evento clique do botão é instanciado e aberto o interface respectivo.
A execução do programa só termina depois do utilizado fechar este interface.
Figura 5.4 - Opções do interface Eolitor System - Home
5.5.2.	Monitor
O interface Monitor permite a visualização instantânea do estado do aerogerador e do estado do tempo. Para iniciar a visualização da monitorização é imprescindível configurar o endereço de IP do PC onde está a ser executado o programa Eolitor Server. Ao fim dessa configuração, é necessário escolher o aerogerador que pretendemos visualizar, através de um clique na lista de aerogeradores. Se não existir nenhum aerogerador na lista, significa que ainda não foi adicionado nenhum aerogerador à base de dados. Sendo assim, é essencial adicionar um aerogerador.
Concluída esta configuração podemos clicar no botão Connect para estabelecer uma ligação TCP/IP com o servidor Eolitor Server. Se a ligação for constituída com sucesso, e o servidor Eolitor Server estiver a enviar dados da monitorização, então o programa que vai receber esses mesmos dados, vai processá-los através das funções Update_Data e Convert_Data, e actualizar o interface e os respectivos gráficos através da função Update_UI.
Ao mesmo tempo que são processados os dados da monitorização e actualizados os gráficos, são também actualizados os estados; do Aerogerador, da comunicação e alertas.
Para ver as informações mais importantes associadas a este aerogerador, basta abrir a segunda página “Informations". Essas informações são descarregadas directamente da base de dados. Na terceira página “Simulation" é possível visualizar o comportamento do vento e do aerogerador no passado (mediante consultas à base de dados) através de simulação, escolhendo um instante temporal inicial e final do respectivo aerogerador. Com estes dados e clicando no botão Run, é iniciada a simulação com consultas à base de dados para verificar a existência de dados, do respectivo aerogerador, no intervalo de tempo configurados. A simulação termina quando não existem mais dados referentes à simulação ou quando o utilizador entender, clicando no botão Stop.
Este Interface permite ainda configurar algumas opções, como por exemplo, as escalas dos vários gráficos, na página “Variables", ou escolher a frequência de monitorização e de envio dos dados por parte do microcontrolador do sistema de monitorização, na página “Frequency".
Figura 5.5 - Opções do interface Eolitor System - Monitor
5.5.3.	Connection to Database
Neste interface é possível alterar os dados de ligação à base de dados. Este interface é útil quando a base de dados está instalada num PC diferente do PC onde estamos a executar o programa. É possível também testar a ligação à base de dados através do botão Test Connection.
Figura 5.6 - Opções do interface Eolitor System - Connection» Database
5.5.4.	Eolitor Database
Neste interface é possível aceder à base de dados, para consultar, alterar, adicionar ou apagar informações importantes do sistema. As várias tabelas da base de dados estão disponíveis nas várias TabPage. Em cada TabPage são apresentados os dados provenientes da consulta à base de dados através dos recursos do LINQ.
O LINQ é uma das grandes novidades na nova versão da plataforma .NET, e de entre as variações possíveis do LINQ, o LINQ To SQL. Para usar o LINQ To SQL basta incluir uma referência usando o template LINQ To SQL classes. Fazendo isso é possível o acesso ao Descritor Objecto Relacional ou Object Relational Designer (O/R Designer). Este fornece uma interface visual para criar e editar classes LINQ to SQL, classes das entidades - entity classes -que são baseadas em objectos da base de dados.
O descritor O/R é usado para criar um modelo de objectos na aplicação que efectua o mapeamento para os objectos da base de dados gerando um DataContext fortemente tipado que é usado para enviar e receber dados entre as classes das entidades e a base de dados; além disso o descritor O/R também permite efectuar o mapeamento de stored procedures e funções para os métodos do DataContext.
A classe DataContext é uma classe LINQ to SQL que actua como uma ponte entre a base de dados SQL Server e as classes das entidades LINQ To SQL mapeadas para a base de dados. Ela contém a informação e os métodos para efectuar a ligação com a base de dados e manipular os dados. Essa classe possui diversos métodos, como o método SubmitChanges que envia as actualizações das classes LINQ To SQL para a base de dados. Além disso, é possível criar métodos adicionais na classe DataContext para mapear stored procedures e funções de forma que executando os métodos criados as stored procedures e as funções que foram mapeadas pela classe DataContext serão executadas.
Os dados da consulta utilizando o LINQ to SQL são carregados num BindingSource. O BindingSource fornece uma camada de acção indirecta entre uma fonte de dados e os controlos ligados a ela. Deve-se anexar um BindingSource a uma fonte de dados, definindo as propriedades DataSource e DataMember do BindingSource e, em seguida, ligar os controlos ao BindingSource adicionando a colecção DataBindings dos controlos. Toda interacção com os dados, como navegação, classificação, filtragem e edição de registos, é feita através de
Para facilitar a navegação dos dados utilizamos um BindingNavigator. O BindingNavigator é um controlo ToolStrip com um conjunto de botões pré-configurados. Conectando um BindingSource como fonte de dados é possível o controlo da navegação pelos dados disponíveis, devido aos botões da barra de ferramentas criados. Além de existirem botões de navegação, também existem os botões AddNew, Update, Delete e Save que permitem adicionar, actualizar, apagar ou guardar registos na base de dados. Os dados do BindingSource são também escritos num DataGridView relativo a cada tabela, como se pode ver na imagem seguinte na tabela WindFarms (Parques Eólicos). Nesta TabPage, é apresentada a informação da entrada corrente do BindingNavigator. À medida que o utilizador muda de TabPage, os dados das tabelas são importados pelo BindingSource, através de uma consulta à tabela respectiva, e o BindingNavigator é carregado com os dados do BindingSource.
No BindingNavigator também existe um botão Find que permite fazer diferentes pesquisas consoantes a fonte de dados do BindingSource, i.e, da TabPage corrente.
Figura 5.7 - Opções do interface Eolitor System - SQL Database
5.5.5.	Eolitor DB Charts
Neste interface podemos consultar, através de gráficos, informações relativas ao comportamento passado do aerogerador e do estado do tempo. Nele é possível escolher um intervalo temporal que pretendemos, e através de consultas à base de dados, visualizar os
mesmos dados graficamente. Neste interface primeiro é necessário escolher o aerogerador, isto se existirem mais do que um aerogerador armazenados na base de dados, caso contrário as consultas são feitas a todos os aerogeradores. Em segundo lugar, deve ser escolhido o intervalo temporal correspondente à consulta que pretendemos realizar. Em seguida, tem de ser escolhida uma variável do estado do tempo (velocidade e direcção) ou do estado do aerogerador (velocidade, corrente, potência, voltagem, direcção e velocidade) que pretendemos visualizar. Após a escolha desta variável podem ser alteradas as opções do gráfico, faltando apenas clicar no botão Create para poder visualizar o novo gráfico. O gráfico gerado pede ser depois imprimindo clicando no botão Print ou então gravado localmente clicando no botão Save.
Figura 5.8 - Opções do interface Eolitor System - Database Charts
5.5.6.	Emailer
Neste interface é possível o envio de um email. Esta possibilidade foi pensada, como já foi referido anteriormente, para ser possível ao programa contactar, através de um email, o Administrador ou algum Técnico responsável pelo funcionamento, informando-o do estado do Aerogerador e de seus componentes. Assim, caso os dados de email do destinatário estejam configurados previamente, será possível o envio de informações como, o fim da duração de uma componente, o relatório da produção semanal de um aerogerador, alerta de velocidade do aerogerador elevada, entre outras. Para o envio de um email e necessário estar configurada uma conta de email e instalado, localmente no PC, o serviço SMTP. É possível adicionar anexos clicando no botão browser e para enviar o email basta clicar no botão Send.
Figura 5.9 - Opções do interface Eolitor System - Emailer
5.5.7.	^SD Terminal
Este interface permite ao utilizador a comunicação com o cartão gSD do sistema de monitorização. Neste está a lista de comandos disponível e uma descrição para cada comando. Para tal, é necessário configurar o endereço de IP do servidor para estabelecer uma ligação TCP/IP. No instante imediato à abertura da ligação, através da clique no botão Connect, é enviado um comando do programa Eolitor Server para o microcontrolador da placa de monitorização notificando que um utilizador deseja, mediante o envio de comandos para o gSD, verificar ou alterar o seu estado. A partir deste momento o microcontrolador deixa de escrever no cartão gSD. Depois basta escrever a instrução correcta, associada às funções do sistema de ficheiros FatFS que podem ser consultadas na Tabela 4.5, e clicar no botão Send. A resposta pode ser visualizada na área Data. Por fim, após clicar no botão Disconnect (mesmo botão de Connect) para desligar a ligação TCP/IP entre o gSD Terminal e o Eolitor Server, é enviado para o microcontrolador o comando que informa a conclusão da comunicação com o cartão gSD retornando o programa do microcontrolador ao estado normal de monitorização.
Figura 5.10 - Opções do interface Eolitor System - Terminal
5.6.	Instalação e Execução do Programa
Com o desenvolvimento do programa Eolitor, foi criado um executável msi que permite instalar este programa, tendo como pré-requisito o Windowns Installer. Todos os ficheiros necessários para a execução do programa são criados numa nova pasta escolhida durante a instalação. Com a instalação é criado um atalho do executável do programa no ambiente de trabalho com o nome Eolitor System, e uma pasta nos Programas do Menu Iniciar com o nome IEETA. Esta pasta contém um atalho do executável dos programas Eolitor System, DB Installer e Eolitor Server, um atalho para a página Web do IEETA, outro para a página Web criada para este projecto e mais um atalho para o guia de início rápido que foi desenvolvido para facilitar o uso dos programas por parte dos utilizadores em especial nas primeiras experiências.
Figura 5.11 - Executável de instalação do Programa Eolitor
		
Universidade de Aveiro	133	
5.7.	Instalação da Base de Dados
Como já foi referido, o projecto Eolitor está suportado numa base de dados SQL Server 2005. Assim, o correcto funcionamento do programa Eolitor Server só é possível se no PC onde for executado, esteja instalada a base de dados.
Antes da execução do programa Eolitor, é necessário instalar o programa MS SQL Server 2005 seguindo os passos do executável sqlexpr32.exe fornecido com o projecto ou disponível na internet no site da Microsoft, caso não esteja instalado. A instalação do servidor de base de dados vai permitir a instalação da base de dados de suporte nesse PC, que poderá ser acedida de outro PC através de uma ligação TCP/IP.
Foi criado um programa auxiliar DBInstaller, que pode ser executado clicando no atalho do Menu Iniciar que foi criado com a instalação do programa Eolitor. Este programa permite listar todos os servidores de bases de dados MS SQL Server que sejam acedidos a partir do PC, através do componente SQLDMO. Escolhido o servidor é necessário introduzir o username e password de acesso, clicar no botão Install e será instalada a base de dados com o nome EolitorDB nesse servidor. A instalação da base de dados é feita através de um script SQl. Este script, escrito em linguagem SQL, que permite a criação das tabelas, das chaves primárias e estrangeiras, dos constraints, dos store procedures e dos triggers que contem a base de dados. O script SQL é executado a partir do programa sqlcmd ("sqlcmd -S “ServDBName" -d "Database" -U "UserName" -P "Pwd" -o C:\sqlout.txt -i "fileName").
Figura 5.12 - Executável de instalação da base de dados EolitorDB
		
Universidade de Aveiro	134	
5.8.	Eolitor - Web Page
No seguimento de um dos objectivos do Projecto, o de disponibilizar informação localmente ou remotamente, foi desenvolvido uma Web Page em ASP.NET que será instalado no PC servidor. A criação desta Web Page foi virada essencialmente para a disponibilização de informações ligadas ao Projecto, como são o caso das energias renováveis em especial a energia eólica. Mas o grande destaque da Web Page é o Aerogerador que foi instalado. Podem ser consultadas fotos e vídeos do seu interior, da fase de instalação e em pleno funcionamento.
No sentido de tornar o Web Page mais interactiva foram adicionados componentes em Silverlight (última tecnologia da Microsoft para o desenvolvimento de páginas Web) que facilita a visualização dos vários álbuns de fotos e de vídeos. Os álbuns de fotos estão guardados numa base de dados MS SQL Server.
Com o desenvolvimento deste Web Page foi utilizada uma base de dados ASPNETDB que permite armazenar o registo de vários utilizados e de vários perfis de utilizadores. Deste modo foi possível definir dois perfis de utilização designados por Administrator e Friend, para além dos utilizadores comuns. Os utilizadores com privilégios Administrator podem adicionar fotografias e vídeos ao Web Page para além dos restantes conteúdos. Os utilizadores Friend podem visualizar todas as páginas de um utilizador comum, incluindo as páginas de estatísticas que permitem gerar relatórios e gráficos do comportamento do Aerogerador. Para ser um utilizador Friend é necessário efectuar um registo e posteriormente o login na página inicial da Web Page.
Na página “Ao Vivo” é possível acompanhar em tempo real e em vídeo o comportamento do Aerogerador através da câmara que será instalado no IEETA.
Foi também adicionado um leitor de Feeds RSS que após a subscrição permite ler as informações dos Feeds ligados a esta temática.
A interface da Web Page é muito simples, fácil de utilizar e perceptível a todos utilizadores. Esta foi desenvolvida também para facilitar a introdução de novos conteúdos. No ponto 3.5.3.12 Eolitor System - Web Page existem algumas figuras da Web Page.
		
Universidade de Aveiro	135	
		
Universidade de Aveiro	136	
Até este momento já foram explicados quase todos os detalhes do desenvolvimento da íntegra do sistema Eolitor, incluindo todos os interfaces com o utilizador. Assim como resultado desta dissertação, foi concebido um sistema de monitorização de um Aerogerador, que será apresentado no corrente capítulo, incluindo as figuras referentes à execução dos vários programas desenvolvidos para demonstrar todo o sistema Eolitor em funcionamento.
6.1.	Sistema de Monitorização
Um dos principais problemas encontrado no desenvolvimento deste sistema foi a concepção da PCB, desde o desenho do footprint até à fase de soldar os componentes, principalmente o microcontrolador, devido ao número elevado de pinos e à sua reduzida dimensão. Outro dos problemas encontrados foi a integração do sistema de ficheiros no projecto da PCB pela complexidade do mesmo.
A primeira versão da PCB do projecto era mais elaborada devido à existência de um circuito integrado para carregar a bateria de Lithium, um Charge Pump para regular e estabilizar a tensão da bateria e um supervisor para comutar a alimentação do sistema entre a tensão da bateria e a tensão de saída do painel solar. A versão final da PCB pode ser observada no ponto 3.5.3.13 Eolitor System - PCB Monitoring.
Na Figura seguinte podemos ver o programa Eolitor Server e o programa Eolitor TCP Server em execução e podemos ver os dados que estão a ser recebidos através da PCB do sistema de monitorização, no rectángulo denominado Send Data.
Í3 Eolitor Sorver
Settings
Serial Port:
Disconnect
□E®
Clients
Eolito rServer
Send Data
00A311002B1203FF1300DB1E0111002C1203FF1300DB1E0111002B1203FF1 300DB1E0100A700A311002C1203FF1300DB1E0111002C1203FF1300DB1E01 11002C1203FF13OODB1E0100A700A311002B1203FF1300DB1E0111002C120 3FF1300DB1E0111002D1203FF1300DB1E0100A1
Send
Data Received
&lt;&lt;&lt;EolitorServerhas connected the Eolitor TCP Server&gt;&gt;&gt; 27-06-2009 13:58:34
Output
Figura 6.1 - Programa Servidor Eolitor Server em execução
6.2.	Sistema de Informação
O sistema de informação é a camada superior de interface com os utilizadores do projecto Eolitor. O desenvolvimento deste sistema provocou algumas dificuldades ao autor do projecto devido à inexistente experiência em programação de alto nível, mais concretamente na plataforma Visual Studio da Microsoft. Contudo, foi desenvolvido o programa Eolitor System que permite receber todas as informações em tempo real dos seguintes elementos: estado do Aerogerador, estado tempo, gerando gráficos e relatórios com as informações de monitorizações anteriores armazenadas na base de dados.
Faz ainda parte do sistema de informação do projecto Eolitor, a Web Page desenvolvida que permite também aos utilizadores a recepção de informação do sistema, desde a temática das energias renováveis, em especial a energia eólica, ou a difusão de imagens e vídeos do Aerogerador, até à informação do seu comportamento resultante da criação de gráficos e relatórios.
O resultado do desenvolvimento deste sistema pode ser observado nas figuras seguintes que constam no programa Eolitor System. A Figura 6.2 representa a execução do interface Monitor que faculta a recepção e visualização dos dados da monitorização da PCB, enviados pelo programa Eolitor Server. Na área Meteo podemos ver os indicadores que demonstram o valor actual da temperatura, velocidade e direcção do vento. No que respeita à área Aero não foi possível recolher dados dos sensores até à data de redacção da dissertação, devido a dificuldades de instalação do Aerogerador. Os estados do Aerogerador, da comunicação com o servidor e alertas estão indicados do lado esquerdo do interface.
Figura 6.2 - Interface Monitor do Programa Eolitor System em execução, recepção da monitorização do comportamento do tempo
Figura 6.3 - Interface Database Charts do Programa Eolitor System em execução, variável Wind Speed e tipo de gráfico Line
Figura 6.4 - Interface Database Charts do Programa Eolitor System em execução, variável Wind Dir e tipo de gráfico Radar
As Figuras 6.3, 6.4 e 6.5 referem-se à execução do Interface Database Charts do programa Eolitor System que permite gerar gráficos das várias variáveis inerentes à monitorização. Para além da variável, é possível escolher o tipo de gráfico, entre outras opções: 3D, apresentação de valores e/ou legendas e em formato percentagem. Nos casos referidos, foi gerado a média da velocidade de vento (m/s), média da direcção do vento e a média da temperatura (oC), respectivamente.
Figura 6.5 - Interface Database Charts do Programa Eolitor System em execução, variável Temperature e tipo de gráfico
Combo
Figura 6.6 - Interface Reports do Programa Eolitor System em execução, Info Report
A Figura 6.6 representa a execução do interface Reports que faculta a criação de relatórios dos vários modelos pré-programados. No relatório em questão, Info Report, são obtidas informaçõs dos parques eólicos, dos modelos dos aerogeradores instalados e dos fabricantes. Podem ainda ser observados os relatórios Production Report e Meteo Report, contendo informações da produção do aerogerador e do estado do tempo, respectivamente.
Figura 6.7 - Interface Logs do Programa Eolitor System em execução
Figura 6.8 - Interface Web Browser do Programa Eolitor System em execução, página Web do Projecto Eolitor
No interface referente à Figura 6.7 podem ser observados logs da utilização do sistema e a Figura 6.8 refere-se à Web Page que foi criada no âmbito do projecto.
Figura 6.9 - Guia de Início Rápido de suporte aos programas do projecto Eolitor
Figura 6.10 - Guia de Início Rápido de suporte aos programas do projecto Eolitor, interface Monitor do programa Eolitor System
Cficar aquí para	
	1
escolher	
Aprneprador.	
Ss		
As Figuras 6.9 e 6.10 concernem ao guia que foi desenvolvido em linguagem HTML para servir de suporte à utilização dos programas Eolitor Server, Eolitor System e Database Installer do projecto Eolitor. Este guia destina-se aos utilizadores para a melhor percepção de como devem interagir com o sistema para poderem tirar o máximo partido. Como referido anteriormente, este guia pode ser acedido, depois da instalação do projecto Eolitor, no menu Iniciar do Windows.
		
Universidade de Aveiro	144	
7.1.	Conclusões
Em virtude dos aspectos mencionados, percebe-se que os objectivos propostos foram alcançados. O desenvolvimento consistiu na criação de um sistema que permitisse monitorizar o comportamento de um Aerogerador e do estado do tempo. Este sistema de monitorização foi conseguido com êxito. Nos capítulos anteriores já foram apresentados todos os elementos deste projecto durante o seu desenvolvimento, incluindo algumas alternativas. De referir que a diversidade de tecnologias de suporte existentes permitiria o desenvolvimento de soluções diferentes desta.
7.1.1.	Base de Dados
Analisando com detalhe cada módulo do sistema individualmente, entendemos que, no que concerne à base de dados de suporte, foram adicionadas para além dos dados de monitorização, outras tabelas que permitem armazenar mais informações do sistema através do interface Eolitor Database. A camada da base de dados está completamente operacional, transparente ao sistema de monitorização e ao sistema de informação.
7.1.2.	Sistema de Monitorização
No que respeita à placa de circuitos impressos, as possibilidades de implementação eram muito mais abrangentes, graças à grande variedade de microcontroladores e de circuitos integrados existentes no mercado. Como foi visto anteriormente no Capítulo 4, a placa de monitorização foi pensada para dar resposta a duas formas diferentes de instalação. Nesse sentido, foram desenvolvidas duas soluções distintas. Contudo, a leitura dos vários sensores e o processamento do qual resulta uma trama a ser enviada para um PC, é similar em ambas. Entende-se que os objectivos presentes foram alcançados. Mais detalhadamente, esta placa tem uma unidade local de armazenamento (cartão pSD) que está funcional, permitindo assim armazenar os dados no cartão, (sob formato de um ficheiro de texto txt), quando o programa servidor, de recepção dos dados, não estiver em comunicação com a placa. Localmente também existe um RTCC (Real Time Clock and Calender) que faculta identificar o instante temporal em que os dados foram recolhidos, indispensável em projectos de monitorização.
Em virtude do que foi mencionado relativamente ao programa de servidor executável num PC, que se conecta à placa de monitorização através de uma ligação com fios (USB), ou sem fios (Bluetooth), considera-se que preenche todos os requisitos propostos à partida, disponibilizando ainda funcionalidades adicionais. Este programa, Eolitor Server, é responsável pela recepção, processamento e armazenamento da informação do sistema numa base de dados. Todos estes requisitos foram superados com sucesso. Este programa é simples, mas robusto, não perde tramas e é rápido na execução. Neste momento este programa permite ainda a ligação remota de vários clientes através duma ligação TCP/IP.
		
Universidade de Aveiro	145	
7.1.3.	Sistema de Informação
Com todos estes aspectos considerados era necessário o desenvolvimento de um programa de modo a obter o retorno de toda a informação Este foi detalhado no Capítulo 5 -. Para além das necessidades básicas que foram criadas, de encontro com os objectivos iniciais, foram também adicionadas algumas funcionalidades como forma de tornar o programa mais robusto e disponibilizar aos utilizadores mais informação. Destas funcionalidades, pode ser destacado o simulador, que permite a visualização do comportamento do aerogerador, através dos dados de monitorizações precedentes guardadas na base de dados. Outra das funcionalidades implementadas com sucesso foi a visualização do histórico das diversas variáveis do aerogerador e do tempo, através da geração de gráficos. Foi também criada uma interface para demonstrar a concepção de relatórios, podendo ser posteriormente criados mais modelos personalizados. Como suporte à geração de relatórios, foi também implementado um mecanismo de envio de emails para possibilitar precisamente o envio dos relatórios por email, para algum utilizador (destinatário) previamente configurado. Esta função extra requer ainda alguns ajustes de configuração de modo a torná-la mais funcional no caso de necessária. Como funcionalidade acessória foi criada uma interface onde é possível visualizar os logs gerados pelo programa referentes ao comportamento do aerogerador e da utilização do programa. Para além deste programa, foi ainda criada uma página Web no âmbito das informações relacionadas com este projecto: fotos e vídeos do Aerogerador, e ainda a possibilidade de geração de gráficos e relatórios. Tendo em conta o exposto, pensa-se que os objectivos foram atingidos, com a criação deste sistema de informação.
		
Universidade de Aveiro	146	
7.2.	Desenvolvimentos Futuros
O objectivo deste trabalho foi atingido e pode-se dizer que o método proposto apresenta resultados satisfatórios. Porém, numa perspectiva futura, como complemento e desenvolvimento deste trabalho, foram pensadas algumas funcionalidades que podem ser adicionadas e aplicadas, com vista a tornar o projecto numa solução mais robusta, diversificada, atractiva e competitiva comercialmente. De algumas dessas perspectivas futuras fazem parte:
No que concerne à base de dados de suporte:
-Adicionar tabelas, ou alterar a relação entre as mesmas, de modo à informação estar armazenada de forma mais eficiente;
No que diz respeito à placa de monitorização:
-Adicionar mais sensores, permitindo assim obter mais informações do sistema eólico, implica redesenhar a PCB e interligar o sinal de saída do sensor ou a um canal da ADC do microcontrolador se o sinal for analógico ou se o sinal for em frequência pode ser ligado a uma linha de interrupções ou à entrada de um timer;
-Melhorar ou modificar a forma de armazenamento da informação no cartão pSD, implica alterar a estratégia de ciação de ficheiros para superar a perda da informação armazenada que ocorre com a falta de alimentação na PCB;
-Integrar o módulo de comunicação Bluetooth F2M03GLA numa única placa de circuito impresso;
-Integrar na placa um servidor Web TCP/IP, permitindo enviar os dados directamente para um computador pela internet através de uma ligação TCP/IP [49];
-Optimizar as dimensões da placa de circuito impresso;
-Alterar o formato da trama enviada da placa de monitorização para o PC, de acordo com necessidades pontuais (exemplo: aumento de sensores, aumento de aerogeradores). Neste formato é possível a exitência de até 16 identificadores de aerogeradores e o envio de até 16 identificadores de sensores por aerogerador.
No âmbito do programa de servidor, Eolitor Server:
-Adicionar um algoritmo para previsão da capacidade de produção do aerogerador, baseada nos dados actuais e passados [50].
No que respeita ao programa de cliente, Eolitor System:
-Optimizar a programação que foi desenvolvida de modo a reduzir o tempo de processamento e a memória necessária para execução;
-Optimizar o número de ligações estabelecidas com base de dados durante a execução do programa;
		
Universidade de Aveiro	147	
Por fim, no que se refere à Web Page:
-Adicionar gráficos e indicadores do estado e da produção recente do aerogerador, permitindo aumentar a informação disponível do sistema aos utilizadores;
-Adicionar novos conteúdos de informação, fotografias e vídeos.
		
Universidade de Aveiro	148	
Bibliografia
[1]	- EWEA, Wind Energy - The Facts, Disponível&amp;lt;http://www.ewea.org/fileadmin/ewea_documents/documents/publications/WETF/WETF. pdf&gt;
[2]	- EWEA, Wind Energy Statistics, Disponível&amp;lt;http://www.ewea.org/fileadmin/ewea_documents/documents/publications/factsheets/E WEA_F S_Statistics_FIN AL_lr.pdf&gt;
[3]	- EWEA, Offshore Wind Farms 2008, Disponível&amp;lt;http://www.ewea.org/fileadmin/ewea_documents/documents/statistics/Offshore_Wind_F arms_2008.pdf&gt;
[4]	- EWEA, Offshore Wind Energy, Disponível&amp;lt;http://www.ewea.org/fileadmin/ewea_documents/documents/publications/factsheets/E WEA_FS_Offshore.pdf&gt;
[5]	- EWEA, Annual Report 2008 - Winning with European Wind, Disponível&amp;lt;http://www.ewea.org/fileadmin/ewea_documents/documents/publications/Annual_Repor t_2008.pdf&gt;
[6]	- EWEA, Annual Report 2007 - Delivering Energy and Climate Solutions, Disponível&amp;lt;http://www.ewea.org/fileadmin/ewea_documents/documents/publications/reports/ar07-ewea.pdf&gt;
[7]	- EWEA, Pure Energy - Wind Energy Scenarios up to 2030, Disponível&amp;lt;http://www.ewea.org/fileadmin/ewea_documents/documents/00_POLICY_document/PP.p df&gt;
[8]	- EWEA - Wind at Work, Disponível&amp;lt;http://www.ewea.org/fileadmin/ewea_documents/documents/publications/Wind_at_wor k_FINAL.pdf&gt;
[9]	- EWEA, Economics of Wind Energy, Disponível&amp;lt;http://www.ewea.org/fileadmin/ewea_documents/documents/publications/reports/Econ omics_of_Wind_Main_Report_FINAL-lr.pdf&gt;
[10]	- The Wind Turbines and WindFarm Database, France: The Wind Power. Disponível&amp;lt;http://www.thewindpower.net/index_en.php&gt;
[11]	- European Wind Energy Technology Platform, Strategic Research Agenda / Market Deployment Strategy, Disponível
		
Universidade de Aveiro	149	
[12]	- Global Wind 2007 Report, Global Wind Energy Council. Second edition, May 2008
[13]	- GWEC Press Release 2008, Global Wind Energy Council, Disponível
&lt;http://www.ewea.org/fileadmin/ewea_documents/documents/press_releases/2009/GWE C_Press_Release_-_tables_and_statistics_2008.pdf&gt;
[14]	- Internacional Energy Agency, World Energy Outlook 2006, Disponível
&lt;http://www.worldenergyoutlook.org/docs/weo2 006/portuguese_sum_06.pdf&gt;
[15]	- Internacional Energy Agency, World Energy Outlook 2007, Disponível
&lt;http://www.iea.org/T extbase/npsum /WE O2007SUM.pdf &gt;
[16]	- Wind Power, Denmark: Danish Wind Industry Association. Disponível&amp;lt;http://www.windpower.org&gt;
[17]	- Wind Energy, Washington: American Wind Energy Association. Disponível&amp;lt;http://www.awea.org&gt;
[18]	- Wind Energy, Marseille: European Wind Energy Association. Disponível&amp;lt;http://www.ewea.org&gt;
[19]	- Energy and Environmental Data, Denmark : EMD International. Disponível&amp;lt;http://www.emd.dk&gt;
[20]	- Wind Energy, Ottawa: Canadian Wind Energy Association. Disponível&amp;lt;http://www.canwea.ca/index_e.php&gt;
[21]	- Wind Power, Ontario: Total Alternative Power. Disponível&amp;lt;http://www.totalalternativepower.com/faq.htm&gt;
[22]	- Wind Turbines, WOBBEN WINDPOWER Inc. Disponível&amp;lt;http://www.wobben.com.br&gt;
[23]	- Energy Efficiency and Renewable Energy, USA: US Department of Energy. Disponível&amp;lt;http://www.eere.energy.gov&gt;
[24]	- RETScreen Clean Energy Project, Canada: Natural Resources Canada. Disponível&amp;lt;http://www.retscreen.net/ang/home.php&gt;
[25]	- Power Technology, London: SPG Media. Disponível&amp;lt;http://www.power-technology.com&gt;
		
Universidade de Aveiro	150	
[26]	- ZigBee; ZigBee Alliance, Wireless Control that Simply Works. Disponível&amp;lt;http://www.zigbee.org/en&gt;
[27]	- Bluetooth; Bluetooth Technology: Disponível&amp;lt;http://www.bluetooth.com/bluetooth&gt;
[28]	- GROFF, James R.; WEINBERG, Paul N.; SQL: The Complete Reference, Second Edition. California: McGraw-Hill/Osborne, 2002.
[29]	- BOWMAN, Judith S.; EMERSON, S. L.; DARNOVSKY, M.; The practical SQL handbook: using structured query language. Addison - Wesley, 1998 reprint.
[30]	- DATE, Christopher John; DARWEN, Hugh; A guide to the SQL standard: a user's guide to the standard database language SQL. Addison - Wesley, 1997.
[31]	- AMBLER, Scott W.; The elements of UML 2.0 style. Cambridge: Cambridge University Press, 2005.
[32]	- NAIBURG, Eric J.; UML for database design. Boston: Addison - Wesley, 2001.
[33]	- PILONE, Dan; PITMAN, Neil; UML 2.0 in a Nutshell. United States of America: O'Reilly Media, Inc, 2005.
[34]	- RIORDAN, Rebecca M.; Designing Relational Database Systems. Washington: Microsoft Press, 1999.
[35]	- HALVORSON, Michael; Microsoft Visual Basic passo a passo. Bookman, 2005. 504p.
[36]	- Estanqueiro, Ana. Curso de Energias Renováveis, Energia Eólica. Disponível&amp;lt;http://disciplinas.dcm.fct.unl.pt/cce/ficheiros%20pdf/eolica1.pdf&gt;
[37]	- Peças Lopes, J. A. Tipos de Aerogeradores Modelização, Controlo e Protecções, FEUP. Disponível&amp;lt;http://paginas.fe.up.pt/~jpl/textos/EE_Tipos_Aerog.pdf&gt;
[38]	- Free2move: Bluetooth Module, Datasheet F2M03GLA, Free2move 2007.&amp;lt;http://www.free2move.se/pdf/F2M03GLA.pdf&gt;
[39]	- ELM, FAT File System Module, Disponível&amp;lt;http://elm-chan.org/fsw/ff/00index_e.html&gt;
[40]	- PIC24FJ128GA006, Microchip, Datasheet&amp;lt;http://ww1.microchip.com/downloads/en/DeviceDoc/39747d.pdf&gt;
[41]	- FT232R USB UART, FTDI Chip, Datasheet&amp;lt;http://www.ftdichip.com/Documents/DataSheets/DS_FT232R_v104.pdf&gt;
		
Universidade de Aveiro	151	
[42]	- MAX6608 Low-Voltage Analog Temperature Sensors, Maxim, Datasheet&amp;lt;http://datasheets.maxim-ic.com/en/ds/MAX6607-MAX6608.pdf&gt;
[43]	- ADM696 Microprocessor Supervisory Circuits, Analog Device, Datasheet&amp;lt;http://www.analog.com/static/imported-files/data_sheets/ADM696_697.pdf&gt;
[44]	- REG103GA-33, Texas Instruments, Datasheet&amp;lt;http://www.ti.com/lit/gpn/reg103-33&gt;
[45]	- TPS6013 Charge Pump, Texas Instruments, Datasheet
&lt;http://www.ti.com/lit/gpn/tps60130&gt;
[46]	- TL2575-05 VOLTAGE REGULATORS, Texas Instruments, Datasheet&amp;lt;http://focus.ti.com/lit/ds/symlink/tl2575-05.pdf&gt;
[47]	- BQ24002 LI-ION Charge Management, Texas Instruments, Datasheet&amp;lt;http://focus.ti.com/lit/ds/symlink/bq24002.pdf&gt;
[48]	- 20kW Wind Turbine Generator, Liten Windpower Co., Ltd; Disponível&amp;lt;http://www.wind-turbine.cn/20kW-wind-turbine-generator.htm&gt;
[49]	- Olimex, PIC-MICRO-WEB, Disponível&amp;lt;http://www.olimex.com/dev/pic-micro-web.html&gt;
[50]	- Shuhui Li, Donald C. Wunsch, Edgar A. O’Hair, and Michael G. Giesselmann, "Using neural networks to estimate wind turbine power generation" IEEE Trans. ON ENERGY CONVERSION, VOL. 16, NO. 3, Sep. 2001
		
Universidade de Aveiro	152	
ANEXO A - Parques Eólicos em “offshore"
Em seguida são apresentados os vários parques eólicos em "offshore" que estão em operação, juntamente com os que estão a ser instalados e os que estão planeados até 2015, em alguns dos principais produtores de energia eólica em "offshore" [3] [4].
Bélgica				
Projectos em operação	Localização	Capacidade (MW)	Aerogeradores	Ano de Instalação
Thornton Bank phase 1	Off Zeebrugge	30	6	2008
				
Projectos em construção	Localização	Capacidade (MW)	Aerogeradores	Ano de Instalação
Thornton Bank phase 2	Off Zeebrugge	90	18	2010
				
Projectos planeados até 2015	Localização	Capacidade (MW)	Aerogeradores	Ano de Instalação
Thornton Bank phase 3	Off Zeebrugge	180	-	2012
Bligh Bank	Off Zeebrugge	330	-	2010
Bank Zonder Naam phase 1	Off Zeebrugge	72	-	2012
Bank Zonder Naam phase 2	Off Zeebrugge	144	-	2014
Tabela A.1 - Energia Eólica em ‘‘Offshore’’ instalada na Bélgica [EWEA]
Dinamarca				
Projectos em operação	Localização	Capacidade (MW)	Aerogeradores	Ano de Instalação
Vindeby	Btesenborg Odde, NW off Vindeby, Lolland	4.95	11	1991
Tuno Knob	off Aarhus, Kattegat Sea	5	10	1995
Middelgrunden	Oresund, east of Copenhagen harbour	40	20	2001
Horns Rev	Blâvandshuk, Baltic Sea	160	80	2002
Nysted Havmollepark	R0dsand, Lolland	165.6	72	2003
Samso	Paludans Flak, South of Sams0	23	4	2003
Frederikshavn	Frederikshavn Harbour	10.6		2003
R0nland	Lim fjord, off Ronland peninsula	17.2	8	2003
				
Projectos em construção	Localização	Capacidade (MW)	Aerogeradores	Ano de Instalação
Horns Rev II	Blâvandshuk, Baltic Sea	200	10 a 18	2009
Nysted Havmollepark II	9km off Rodsand, Lolland in the Baltic Sea	200	6 a 9	2010
				
Projectos planeados até 2015	Localização	Capacidade (MW)	Aerogeradores	Ano de Instalação
Sprogo	Off Sprogo	150		2009
Djursland-Anholt	Between east Jutland and Anholt in the Kattegat	15	-	2012
Gedser Rev	Off Falster	207		-
Horns Rev II Test Site	Blâvandshuk, Baltic Sea (10km W of Horns Rev)	15	-	-
Rodsand II (Nysted II)	9km off Rodsand, Lolland in the Baltic Sea	21	-	-
Rodsand II (Nysted II) Test Site	9km off Rodsand, Lolland in the Baltic Sea	400	-	-
Tabela A.2 - Energia Eólica em "Offshore" instalada na Dinamarca [EWEA]
Reino Unido				
Projectos em operação	Localização	Capacidade (MW)	Aerogeradores	Ano de Instalação
Barrow	7km Walney Island	90	30	2006
Beatrice	Beatrice Oilfield, Moray Firth	10	2	2007
Blyth Offshore	1km Blyth Harbour	3.8	2	2000
Burbo Bank	5.2km Crosby	90	25	2007
Kentish Flats	8.5km offshore from Whitstable	90	30	2005
North Hoyle	7.5km Prestatyn &amp;amp; Rhyl	60	30	2003
Scroby Sands	3km NE Great Yarmouth	60	30	2004
				
Projectos em construção	Localização	Capacidade (MW)	Aerogeradores	Ano de Instalação
Inner Dowsing	5.2km Ingoldmells	90	27	
Lynn	5.2km Skegness	97	30	
Ryhl Flats	8km Abergele	90	25	-
Solway Firth/	9.5km Maryport/	90	30	-
Robin Rigg A	8.5km off Rock Cliffe			
Solway Firth/	9.5km Maryport/	90	30	-
Robin Rigg B				-
				
Projectos planeados até 2015	Localização	Capacidade (MW)	Aerogeradores	Ano de Instalação
Aberdeen Offshore Windfarm	N of Aberdeen Harbour	115	-	-
Gwynt y Mor	N of Wales	750		-
Docking Shoal	Off Skegness/Hunstanton, Greater Wash	500	-	-
Dudgeon East	Off Cromer, Greater Wash	300		-
Humber Gateway	Off Spurn Head, Greater Wash	300		-
Lincs	Off Skegness, Greater Wash	250		-
London Array East	Thames Estuary, London	475	-	-
London Array West	Thames Estuary, London	525	-	-
Race Bank	Greater Wash	300		-
Shell Flat (Cirrus Array)	Off Cleveleys, Morecambe Bay	270	-	-
Sheringham Shoal	Off the Norfolk Coast in the Greater Wash	315	-	-
Walney phase 2	Off Walney Island	450		-
West Duddon	Off Walney Island	500		-
Westermost Rough	N of Spurn Head	240	-	-
Tabela A.3 - Energia Eólica em "Offshore” instalada no Reino Unido [EWEA]
Holanda				
Projectos em operação	Localização	Capacidade (MW)	Aerogeradores	Ano de Instalação
Offshore Wind Farm Egmond aan Zee (OWEZ)	Egmond aan Zee	108	36	2006
				
Projectos em construção	Localização	Capacidade (MW)	Aerogeradores	Ano de Instalação
Offshore Wind Q7	Ijmuiden	120	60	2006
				
Projectos planeados até 2015	Localização	Capacidade (MW)	Aerogeradores	Ano de Instalação
Scheveningen Buiten	Off Scheveningen	300	-	2011
Tromp	Off Ijmuiden	1150		2012
Ruyter	Off Groingen	514		2012
West Rijn	Off schevingen	284	-	2012
Tabela A.4 - Energia Eólica em "Offshore" instalada na Holanda [EWEA]
Suécia				
Projectos em operação	Localização	Capacidade (MW)	Aerogeradores	Ano de Instalação
Bockstigen	Gotland	2.8	5	1998
Utgrunden I	Kalmarsund	10.5	7	2001
Yttre Stengrund	Kalmarsund	10.0	5	2002
Lillgrund	Malmo	110.0	48	2007
				
Projectos em construção	Localização	Capacidade (MW)	Aerogeradores	Ano de Instalação
Gâsslingegrund	Vânern	30	10	2009
				
Projectos planeados até 2015	Localização	Capacidade (MW)	Aerogeradores	Ano de Instalação
Finngrunden	Baltic sea	1050		
Kârehamn	Oland	50		
Klasarden	Off Nasudden, Gotland	48		
Kriegers Flak II	NW of island of Rugen, Baltic Sea	640	-	-
Skottarevet	Kattegatt, Falkenberg	120		
Sodra Midsjobanken	Midsjobanken	900	-	-
Trolleboda (Karlskrona)	Kalmarsund	180	-	-
Utgrunden I	Midsjobanken, Kalmar Straight	86.4	-	-
Tabela A.5 - Energia Eólica em "Offshore” instalada na Suécia [EWEA]
Irlanda				
Projectos em operação	Localização	Capacidade (MW)	Aerogeradores	Ano de Instalação
Arklow Bank	off Arklow, Co Wicklow	25.2	7	2004
				
Projectos planeados até 2015	Localização	Capacidade (MW)	Aerogeradores	Ano de Instalação
Arklow Bank phase 2	Arklow Bank, off Arklow, Co Wicklow	118.8	-	-
Codling Wind Park phase 1	E. coast between Greystones and Wicklow	200	-	-
Codling Wind Park phase 2	E. coast between Greystones and Wicklow	300	-	-
Kish and Bray Banks	Off Wicklow, Dublin Bay	48	-	-
Oriel Windfarm (Dundalk)	SE of Dundalk	330	-	-
Tabela A.6 - Energia Eólica em "Offshore" instalada na Irlanda [EWEA]
Norway				
Projectos em construção	Localização	Capacidade (MW)	Aerogeradores	Ano de Instalação
Floating Hywind	Off Karmoy	3	1	2009
				
Projectos planeados até 2015	Localização	Capacidade (MW)	Aerogeradores	Ano de Instalação
Havsul 1	Off More and Romsdal	350		
Siragrunnen	S of Stavanger	200	-	-
Tabela A.7 - Energia Eólica em "Offshore” instalada na Noruega [EWEA]
Itália				
Projectos em operação	Localização	Capacidade (MW)	Aerogeradores	Ano de Instalação
Brindisi	Puglia	0.08	1	2008
				
Projectos planeados até 2015	Localização	Capacidade (MW)	Aerogeradores	Ano de Instalação
Molise	Off Termoli	162		
Sicily	Gulf of Gela, 5.5km off Sicily	575	-	-
Tabela A.8 - Energia Eólica em "Offshore” instalada na Itália [EWEA]
Alemanha				
Projectos em construção	Localização	Capacidade (MW)	Aerogeradores	Ano de Instalação
Alpha Ventus	Off the island of Borkum	60	12	2009
Baltic 1 (Rostock)	Off Mecklenburg	52.5		2009
Borkum Riffgat	NW of island of Borkum	220	44	2012
BARD	Off the island of Borkum	400	80	2012
				
Projectos planeados até 2015	Localização	Capacidade (MW)	Aerogeradores	Ano de Instalação
Amrumbank West	SW of Amrum	400		
Arkona-Becken Südost phase 1	SE of Arkona basin Baltic Sea	400	-	-
Austerngrund	North Sea	400		
Beltsee	NW of Rostock	415		
Borkum Riffgrund phase 1	Off the island of Juist	231	-	
Borkum Riffgrund phase 2	Off the island of Juist	515	-	-
Borkum Riffgrund West phase 1	45km NW of Borkum	400	-	-
Borkum West phase 2	45km N of island of Borkum	400	-	
Butendiek	Butendiek, W of Sylt	300		
Nordergründe	Jade-Weser estuary	90		
Nordlicher Grund phase 1	W of Sylt	309	-	-
Nordsee Ost phase 1	Off Helgoland	400	-	-
DanTysk phase 1	Dan-Tysk	400		
Deutsche Bucht	North Sea	400		
GEOFReE	Bay of Lubeck	25		
Globaltech 1 phase 1	102 km North of Helgoland	400	-	-
Godewind phase 1	NW of Helgoland	400		
He Dreiht	75km N of island of Borkum	400		
Hochsee Windpark Nordsee phase 1	75km N of island of Borkum	400	-	-
Kriegers Flak I phase 1	Baltic Sea	183.6	-	-
Kriegers Flak I phase 2	Baltic Sea	145	-	-
North Sea Windpower phase 1	N of island of Juist	400	-	-
Sandbank 24 phase 1	120km W of island of Sylt	240	-	-
Sky 2000	Bay of Lubeck	150		-
Ventotec Nord 1 phase 1	North Sea	150	-	-
Ventotec Nord 1 phase 2	North Sea	450	-	-
Ventotec Nord 2 phase 1	North Sea	150	-	-
Ventotec Ost 2 phase 1	NE of Ruegen	150	-	-
Tabela A.9 - Energia Eólica em “Offshore" instalada na Alemanha[EWEA]
4.000
L 40.000
2,000
L 20,000
■ Annual installation
Annual installation (Ref. scenario)
■	Cumulative installation
■	Cumulative installation (Ref. scenario)
.0
2008 2010 2020 2030
2000 2002	2004	2006
120,000
100,000
12,000
10.000
8.000
80,000
GO.000
LU
o
o u
Figura A.1 - Desenvolvimento da energia eólica "offshore" na UE 1998-2008 e previsão até 2030 [EWEA]
Germany 9.5MW 0.64%
U.K. 590.8MW 39.76%
Netherlands 246.8MW 16.61%
Italy 0.08MW 0.01%
Denmark 426.35MW 28.69%
Finland 24MW 1.62%
Sweden 133.25MW 8.97%
Ireland 25.2MW 1.7%
Belgium 30MW 2.02%
Figura A.2- Total de energia eólica "offshore" instalada até Novembro 2008 [EWEA]
Finland 1330MW 4.31%
Denmark 1443.35MW 4.67%
Norway 553MW 1.79%
Poland 533MW 1.73%
Ireland 1022MW 3.31%
Sweden 3237.65MW 10.48%
Italy 737.08MW 2.39%.
Figura A.3 - Total de energia eólica "offshore" prevista até 2015 [EWEA]
B.1Descrição dos Casos de Utilização
B.1.1 CaU10 Orçamentar Sistema Eólico
Nome:	CaU10 Orçamentar Sistema Eólico
Âmbito:	Sistema Eolitor.
Finalidade:	Negociar sistema eólico de modo a ser economicamente o mais viável como objectivo de ser instalado para produção de energia eléctrica
Actores:	Administrador, Fabricante/Vendedor
Pré-condições:	Fabricante/Vendedor de Aerogeradores e componentes eólicas
Requisitos especiais:	O preço do Aerogerador ser o economicamente melhor em relação aos preços de outros Fabricantes/Vendedores de Aerogeradores
Aspectos em aberto:	O Fabricante/Vendedor realizar um estudo do local mais apropriado para a instalação do Aerogerador, qual será a previsão da produção e do retorno do investimento
Tabela B.10 - Tabela de descrição do CaU10 Orçamentar Sistema Eólico.
B.1.2 CaU11 Vender Sistema Eólico
Nome:	CaU11 Vender Sistema Eólico
Âmbito:	Sistema Eolitor.
Finalidade:	Adquirir Aerogerador e restantes componentes com o objectivo de ser instalado para produção de energia eléctrica
Actores:	Administrador, Fabricante/Vendedor
Pré-condições:	Fabricante/Vendedor de Aerogeradores e componentes eólicas
Requisitos especiais:	O preço do Aerogerador ser o economicamente melhor em relação aos preços de outros Fabricantes/Vendedores de Aerogeradores
Aspectos em aberto:	O Fabricante/Vendedor ser responsável pela instalação do sistema eólico
Tabela B.11 - Tabela de descrição do CaU11 Vender Sistema Eólico.
B.1.3 CaU12 Contratar Responsável Instalação
Nome:	CaU12 Contratar Responsável Instalação
Âmbito:	Sistema Eolitor.
Finalidade:	Garantir um responsável para instalar de todas as componentes de um sistema eólico necessárias à produção de energia eléctrica
Actores:	Administrador, Fabricante/Vendedor, Técnico de Instalação
Pré-condições:	Ter sido adquirido um Aerogerador e todas as restantes componentes de um sistema
Nome:	CaU12 Contratar Responsável Instalação
Eólico	
Requisitos	O responsável para instalar o sistema ter conhecimentos necessários para o fazer e ter
especiais:	todo o material (ex: grua)
Aspectos em aberto:	
Tabela B.12 - Tabela de descrição do CaU12 Contratar Responsável Instalação.
B.1.4 CaU13 Estudo do local de Instalação
Nome:	CaU13 Estudo do local de Instalação
Âmbito:	Sistema Eolitor.
Finalidade:	Garantir o melhor local para instalar de todas as componentes de um sistema eólico de modo a aumentar a produção de energia eléctrica
Actores:	Administrador/Cliente, Fabricante/Vendedor, Técnico de Instalação
Pré-condições:	Ter sido contratado um responsável para instalar o Aerogerador e as restantes componentes de um sistema Eólico
Requisitos especiais:	Ter sido feito um estudo prolongado do comportamento do tempo em diferentes locais para verificar os vários potenciais eólicos
	Analisar o comportamento do vento para caracterizar o potencial eólico do local
Aspectos em aberto:	O estudo englobar mais do que um determinado local, com objectivo de a decisão da viabilidade da instalação ser tomada com o maior conhecimento possível.
Tabela B.13 - Tabela de descrição do CaU13 Estudo do local de Instalação	
B.1.5 CaU14 Instalar Sistema Eólico
Nome:	CaU14 Instalar Sistema Eólico
Âmbito:	Sistema Eolitor.
Finalidade:	Instalação de todas as componentes de um sistema eólico necessárias à produção de energia eléctrica
Actores:	Técnico de Instalação
Pré-condições:	Ter sido adquirido um Aerogerador e as restantes componentes de um sistema Eólico Ter sido contratado uma grua para montar o Aerogerador O local de instalação ter um potencial eólico elevado e atractivo para o negócio
Requisitos	O técnico de instalação ter sido contratado
especiais:	O técnico de Instalação ter conhecimento necessário para a instalação do sistema. O sistema deve ser testado antes de ser dado apto para funcionamento.
Aspectos em aberto:	-
Tabela B.14 - Tabela de descrição do CaU14 Instalar Sistema Eólico.	
B.1.6 CaU15 Documentação do Sistema Eólico
Nome:	CaU15 Documentação do Sistema Eólico
Âmbito:	Sistema Eolitor.
Finalidade:	Registar todas as componentes de um sistema eólico de modo a poder ser consultado posteriormente
Actores:	Administrador/Cliente, Técnico de Instalação, Fabricante/Vendedor
Pré-condições:	Ter sido instalado um Aerogerador e as restantes componentes de um sistema Eólico Todo o sistema ter sido testado e estar operacional
Requisitos especiais:	Deixar claro quais as componentes do sistema desde o seu modelo, tempo de vida útil e as características mais importantes bem como todos os procedimentos de instalação e futuras manutenções de modo a permitir ser consultado e não deixar ambiguidades relativamente ao Sistema
	Este documento importante e imprescindível e deve ser feito pelo Instalador e entregue ao Administrador aquando do pagamento da instalação
Aspectos em aberto:	-
Tabela B.15 - Tabela de descrição do CaU15 Documentação do Sistema Eólico.
B.1.7 CaU16 Verificar funcionamento do Sistema Eólico
Nome:	CaU16 Verificar funcionamento do Sistema Eólico
Âmbito:	Sistema Eolitor.
Finalidade:	Verificar a instalação do sistema Eólico de modo a detectar falhas no funcionamento das várias componentes deste sistema regularmente
Actores:	Técnico de Instalação
Pré-condições:	A instalação do sistema estar concluída
Requisitos especiais:	O Sistema deve estar ligado durante algum tempo, acompanhado pelo responsável, de modo a verificar possíveis falhas antes de este ser dado como apto e de ser entregue ao Administrador/Cliente
Aspectos em aberto:	O Fabricante/Vendedor deve ser responsabilizado pelo mau funcionamento de alguma componente, que deve ser trocada por uma nova
Tabela B.16 - Tabela de descrição do CaU16 Verificar funcionamento do Sistema Eólico.
B.1.8 CaU17 Registar novo Parque Eólico
Nome:	CaU17 Registar novo Parque Eólico
Âmbito:	Sistema Eolitor.
Finalidade:	Permitir ter registo dos diferentes parques eólicos instalados
Actores:	Administrador, Sistema de Informação
Nome:
CaU17 Registar novo Parque Eólico
Pré-condições:	O sistema de informação e a base de dados estarem correctamente criados e
interligados entre si, de modo a poder correr o programa e adicionar esta informação do sistema na base de dados
Requisitos especiais:
Aspectos em aberto:
Tabela B.17 - Tabela de descrição do CaU17 Registar novo Parque Eólico.
B.1.9 CaU18 Registar novo Modelo de Aerogerador
Nome:	CaU18 Registar novo Modelo de Aerogerador
Âmbito:	Sistema Eolitor.
Finalidade:	Permitir registar os dados dos diferentes Modelos de Aerogeradores instalados nos Parques Eólicos
Actores:	Administrador, Sistema de Informação
Pré-condições:	O sistema de informação e a base de dados estarem correctamente criados e interligados entre si, de modo a poder correr o programa e adicionar esta informação do sistema na base de dados
Requisitos especiais:	Saber os dados do modelo do Aerogerador para introduzir na base de dados através do sistema de informação
Aspectos em aberto:	-
Tabela B.18 - Tabela de descrição do CaU18 Registar novo Modelo de Aerogerador.
B.1.10CaU19 Gerir comportamento do Parque Eólico
Nome:	CaU19 Gerir comportamento do Parque Eólico
Âmbito:	Sistema Eolitor.
Finalidade:	Permitir que o Parque Eólico mantenha as melhores condições de funcionamento com objectivo de maximizar a produção de energia eléctrica
Actores:	Administrador, Sistema de Informação
Pré-condições:	Consultar regularmente o histórico de estado e produção dos Aerogeradores Todos os Aerogeradores devem estar em condições de funcionamento caso contrário deve ser pedido a manutenção do mesmo para permitir aumentar a produção de energia
Requisitos especiais:	Todo o sistema de recolha (monitorização) de dados e de disponibilização da informação deve estar operacional de modo a ser possível a monitorização permitindo gerir o parque eólico
Aspectos em aberto:	Estudo da viabilização de obtenção de mais Aerogeradores
Tabela B.19 - Tabela de descrição do CaU19 Gerir comportamento do Parque Eólico.
Nome:	CaU20 Gerir Sistema de Monitorização e Base de Dados
Âmbito:	Sistema Eolitor.
Finalidade:	Permitir a monitorização dos dados dos sensores instalados nos Aerogeradores
Actores:	Administrador, Sistema de Monitorização
Pré-condições:	Sistema de monitorização estar correctamente instalado A base de dados estar projectada, instalada e seja possível aceder
Requisitos	Conhecimento do funcionamento do Sistema de Monitorização
especiais:	Estudo de novos pressupostos a serem instalados com objectivo de evolução do sistema
Aspectos em aberto:	Evolução e desenvolvimento do mesmo Sistema de modo a recolher mais informação e esta estar cada vez mais coincidente com a realidade
Tabela B.20 - Tabela de descrição do CaU19 Gerir Sistema de Monitorização e Base de Dados.
B.1.12CaU21 Desenvolvimento do Sistema de Monitorização
Nome:	CaU21 Desenvolvimento do Sistema de Monitorização
Âmbito:	Sistema Eolitor.
Finalidade:	Permitir melhorar a monitorização dos dados dos sensores instalados nos Aerogeradores Permitir recolher novos dados consoante a existência de novos requisitos
Actores:	Administrador, Sistema de Monitorização
Pré-condições:	Sistema de monitorização estar correctamente instalado e todos os sensores estarem em funcionamento.
Requisitos	Conhecimento do funcionamento do Sistema de Monitorização e a existência de novos
especiais:	requisitos em relação aos existentes
Aspectos em aberto:	Instalação de novos sensores ou a alteração dos sensores instalados
Tabela B.21 - Tabela de descrição do CaU21 Desenvolvimento do Sistema de Monitorização.
B.1.13CaU22 Desenvolvimento do Sistema de Informação
Nome:	CaU22 Desenvolvimento do Sistema de Informação
Âmbito:	Sistema Eolitor.
Finalidade:	Permitir consultar os dados do sistema eólico e adicionar novos
Actores:	Administrador, Sistema de Informação
Pré-condições:	Alterações no sistema de informação e na base de dados de modo a armazenar novas informações
Nome:	CaU22 Desenvolvimento do Sistema de Informação
Requisitos especiais:	Alteração dos interfaces do sistema de informação de acordo com as alterações na base de dados
	Alteração de algum interface com objectivo de ter utilização mais amigável
Aspectos em aberto:	Mudança de tecnologia de suporte do sistema de informação
Tabela B.22 - Tabela de descrição do CaU22 Desenvolvimento do Sistema de Informação.
B.1.14CaU23 Pedir/Contratar Manutenção do Sistema
Nome:	CaU23 Pedir/Contratar Manutenção do Sistema
Âmbito:	Sistema Eolitor.
Finalidade:	Repor o funcionamento correcto e optimizado do Sistema Eólico
Actores:	Administrador, Técnico de Manutenção
Pré-condições:	O sistema aparentar ter alguma anomalia ou a tempo de vida útil da alguma componente do sistema ter chegado ao fim
Requisitos especiais:	O técnico de manutenção deve receber a notificação pelo Administrador (ou pelo próprio sistema se já tiver esta opção implementada) e deve resolver o problema o mais rápido possível porque quanto mais tempo o sistema tiver desligado menos energia produz A manutenção deve ter tempo limite e o técnico de manutenção deve ser responsabilizado pelo prolongar do tempo da reparação
Aspectos em aberto:	O sistema detectar automaticamente o mau funcionamento de alguma componente notificar o sucedido (enviando um email para o Administrador e para um técnico de Manutenção caso esteja contratado à partida e o sistema tiver guardado os seus dados de contacto)
Tabela B.23 - Tabela de descrição do CaU23 Pedir/Contratar Manutenção do Sistema.
B.1.15CaU24 Fazer Manutenção do Sistema
Nome:	CaU24 Fazer Manutenção do Sistema
Âmbito:	Sistema Eolitor.
Finalidade:	Repor o funcionamento correcto e optimizado do Sistema Eólico
Actores:	Administrador/Cliente, Técnico de Manutenção
Pré-condições:	O técnico responsável por realizar a manutenção do sistema ter sido contratado
Requisitos especiais:	Deve resolver o problema o mais rápido possível ao fim de ser contratado porque quanto mais tempo o sistema tiver desligado menos energia produz O sistema deve ser ensaiado antes de ser dado como pronto para voltar a ser ligado A manutenção deve ter tempo limite e o técnico de manutenção deve ser responsabilizado pelo prolongar do tempo da reparação Caso a anomalia que originou uma interrupção para reparação persista, deve ser
Nome:	CaU24 Fazer Manutenção do Sistema
	contactado novamente o Técnico e ser responsabilizado Estes dois pontos devem ver claramente mencionados no contracto com o Técnico de Manutenção
Aspectos em aberto:	Caso a manutenção pedida ocorra sem problemas, o técnico contratado poderá ser novamente contratado em futuras manutenções, dependendo da disponibilidade Caso o Administrador/Cliente responsável pelo sistema eólico, não tenha ficado completamente agradado com o processo de manutenção, deve ser contratado um novo técnico para futuras manutenções
Tabela B.24 - Tabela de descrição do CaU24 Fazer Manutenção do Sistema.
B.1.16CaU25 Recepção dos Dados
Nome:	CaU25 Recepção dos Dados
Âmbito:	Sistema Eolitor.
Finalidade:	Permitir a visualização e o armazenamento do estado do vento e dos Aerogeradores
Actores:	Sistema Monitorização Local
Pré-condições:	O Sistema de Monitorização estar a funcionar e ligado correctamente através de um fio ou por tecnologia wireless
Requisitos especiais:	A função de processamento das tramas recebidas pelo programa servidor do sistema de monitorização deve estar em sintonia com as tramas geradas pelo processo de geração das tramas realizado pelo microcontrolador do sistema de monitorização
Aspectos em aberto:	Alguma alteração do formato da trama no microcontrolador deve ser repercutida no programa de recepção do sistema de monitorização
Tabela B.25 - Tabela de descrição do CaU25 Recepção dos Dados.
B.1.17CaU26 Tratamento dos Dados
Nome:	CaU26 Tratamento dos Dados
Âmbito:	Sistema Eolitor.
Finalidade:	Permitir o armazenamento do estado do vento e dos Aerogeradores
Actores:	Sistema de Monitorização
Pré-condições:	O Sistema de Monitorização estar a funcionar correctamente e ter recebido as tramas
Requisitos especiais:	O Sistema de Monitorização após ter recebido as tramas deve retirar os dados contidos e processa-los de acordo com o tipo de dados (sensor)
	Este deve estar ligado a uma Base de Dados previamente programada para receber os e armazenar os dados anteriormente tratados
Aspectos em aberto:	A falha de ligação com a Base de Dados dever ser ultrapassada de modo a não existir perda dos dados
Tabela B.26 - Tabela de descrição do CaU26 Tratamento dos Dados.	
B.1.18CaU27 Armazenar os Dados
Nome:	CaU27 Armazenar os Dados
Âmbito:	Sistema Eolitor.
Finalidade:	Disponibilizar os dados do estado do vento e dos Aerogeradores para consulta
Actores:	Sistema de Monitorização, Sistema de Informação
Pré-condições:	O Sistema de Monitorização estar a funcionar correctamente, ter recebido as tramas e ter realizado o tratamento dos dados
	O Sistema de Informação estar a funcionar correctamente e a base de dados disponível
Requisitos especiais:	Após o Sistema de Monitorização ter realizado o tratamento dos dados contidos nas tramas, relativos à monitorização, este devem ser armazenados na base de dados
	O Sistema de Informação deve ser capaz de estabelecer ligação com a Base de Dados com o objectivo de poder armazenar outras informações relevantes para o sistema, através do interface com a base de dados
Aspectos em aberto:	A falha de ligação com a Base de Dados dever ser ultrapassada de modo a não existir perda dos dados
Tabela B.27 - Tabela de descrição do CaU27 Armazenar os Dados.
B.1.19CaU28 Disponibilizar os Dados
Nome:	CaU28 Disponibilizar os Dados
Âmbito:	Sistema Eolitor.
Finalidade:	Consultar e analisar os dados do estado do vento e dos Aerogeradores
Actores:	Sistema de Informação, Administrador, Utilizador
Pré-condições:	O Sistema de Monitorização ter armazenado correctamente os dados e o sistema de informação estar correctamente programado para ir ler os dados à base de dados e disponibiliza-los nas várias interfaces
Requisitos	A Base de Dados com os dados armazenados deve estar disponível
especiais:	O Sistema de Informação deve ter capacidade de estabelecer a ligação com a Base de Dados
Aspectos em aberto:	-
Tabela B.28 - Tabela de descrição do CaU28 Disponibilizar os Dados.
B.2Dicionário de Dados
Entidade: WindFarms
Descrição: Entidade que armazena os parques eólicos
Nome	Descrição	Valor	Não Nulo
ID	Chave Primária	Integer	X
name	Nome do Parque Eólico	Varchar(50)	X
location	Localização do Parque Eólico	Varchar(50)	X
dt star	Data de Implementação do Parque Eólico	Datetime	X
numAeros	Número de Aerogeradores do Parque Eólico	Integer	
powerInstalled	Potência instalada no Parque Eólico	Decimal(10,2)	
Tabela B.29 - Dicionário de Dados - Entidade WindFarms
Entidade: Aeros
Descrição: Entidade que armazena os aerogeradores do sistema
Nome	Descrição	Valor	Não Nulo
ID	Chave Primária	Integer	X
modelID	Chave Estrangeira. Referencia a Entidade Models	Integer	X
farmID	Chave Estrangeira. Referencia a Entidade WindFarms	Integer	X
Ref	Referencia do Aerogerador	Varchar(50)	X
state	Estado de funcionamento do Aerogerador	bit	X
description	Descrição do aerogerador	Varchar(max)	
energyProd	Energia Produzida pelo Aerogerador	Decimal(10,3)	
Dt	Data em que o Aerogerador foi instalado no parque eólico	Datetime	X
Tabela B.30 - Dicionário de Dados - Entidade Aeros
Entidade: Models
Descrição: Entidade que armazena os vários modelos dos aerogeradores do sistema
Nome	Descrição	Valor	Não Nulo
ID	Chave Primária	Integer	X
manufactured	Chave Estrangeira. Referencia a Entidade Manufactures	Integer	X
model	Nome do Modelo do Aerogerador	Integer	X
powerrate	Valor da potência nominal do Modelo (W)	Integer	
powermax	Valor da potência máxima do Modelo (W)	Integer	
voltout	Valor da tensão de saída do Modelo (V)	Integer	
speedstartup	Valor de velocidade inicial do Modelo (m/s)	Integer	
speedrate	Valor de velocidade nominal do Modelo (m/s)	Integer	
speedmax	Valor de velocidade máxima do Modelo (m/s)	Integer	
controlpitch	Indica se o mecanismo de controlo é Picth	Bool	
speedrotor	Valor de velocidade do rotor do Modelo (m/s)	Integer	
nblades	Indica o número de Pás do Modelo	Integer	
height	Valor da altura do Modelo (m)	Integer	
weight	Valor do peso do Modelo (kg)	Integer	
price	Preço do Modelo do Aerogerador	Decimal(10,2)	
Tabela B.31 - Dicionário de Dados - Entidade Models
Nome	Descrição	Valor	Não Nulo
ID	Chave Primária	Integer	X
name	Nome do fabricante do Aerogerador	Varchar(50)	X
email	Email do fabricante do Aerogerador	Varchar(50)	X
phone	Número de telefone do fabricante do Aerogerador	Integer	
Tabela B.32 - Dicionário de Dados - Entidade Manufactures
Entidade: SellEnergy
Descrição: Entidade que armazena as várias vendas de energia
Nome	Descrição	Valor	Não Nulo
ID	Chave Primária	Integer	X
farmID	Chave Estrangeira. Referencia a Entidade WindFarms	Integer	X
dt	Data da venda de energia	Datetime	X
pricekW	Valor do preço de energia por kW	Integer	
quantity	Valor da quantidade de energia vendida	Integer	X
price	Valor da venda de energia (€)	Integer	X
Tabela B.33 - Dicionário de Dados - Entidade SellEnergy
Entidade: Meteo
Descrição: Entidade que armazena os vários estados do tempo de cada Aerogerador do sistema
Nome	Descrição	Valor	Não Nulo
ID	Chave Primária	Integer	X
aeroID	Chave Estrangeira. Referencia a Entidade Aeros	Integer	X
windspeed	Valor da velocidade do vento (m/s)	Decimal(3, 2)	
winddir	Valor da direcção do vento (°)	Integer	
winddir c	Siglas da direcção do vento	Char(2)	
tempe	Valor da temperatura (°)	Decimal(3, 1)	
dt	Data da monitorização do vento	Datetime	X
Tabela B.34 - Dicionário de Dados - Entidade Meteo
Entidade: Productions
Descrição: Entidade que armazena os vários estados de produção de cada Aerogerador do sistema
Nome	Descrição	Valor	Não Nulo
ID	Chave Primária	Integer	X
aeroID	Chave Estrangeira. Referencia a Entidade Aeros	Integer	X
aerospeed	Valor da velocidade do Aerogerador (rpm)	Integer	
aerodir	Valor da direcção do Aerogerador	Integer	
aerodir c	Siglas da direcção do Aerogerador	Char(2)	
aerocurrent	Valor da corrente produzida pelo Aerogerador (A)	Decimal(10, 3)	
aerovolt	Valor da tensão do Aerogerador (V)	Decimal(10, 3)	
aeropower	Valor da potência produzida pelo Aerogerador (W)	Decimal(10, 3)	
invcurrent	Valor da corrente do inversor (A)	Decimal(10, 3)	
dt	Data da monitorização do aerogerador	Datetime	X
Tabela B.35 - Dicionário de Dados - Entidade Productions
Entidade: Payments
Descrição: Entidade que armazena os pagamentos dos Aerogeradores do sistema
Nome	Descrição	Valor	Não Nulo
ID	Chave Primária	Integer	X
aeroID	Chave Estrangeira. Referencia a Entidade Aeros	Integer	X
paymenttype	Tipo de pagamento do Aerogerador	Varchar(20)	X
paymentstate	Estado do pagamento do Aerogerador	Varchar(20)	X
price	Valor do preço do Aerogerador (€)	Decimal(10, 2)	X
dt	Data do pagamento do Aerogerador	Datetime	X
Tabela B.36 - Dicionário de Dados - Entidade Payments
Entidade: Interruptions
Descrição: Entidade que armazena as várias interrupções dos funcionamento Aerogeradores do sistema
Nome	Descrição	Valor	Não Nulo
ID	Chave Primária	Integer	X
aeroID	Chave Estrangeira. Referencia a Entidade Aero	Integer	X
mainID	Chave Estrangeira. Referencia a Entidade Maintenances	Integer	X
dt start	Data de inicio da interrupção	Datetime	X
dt end	Data de fim da interrupção	Datetime	X
Tabela B.37 - Dicionário de Dados - Entidade Interruptions
Entidade: Maintenances
do sistema
Nome	Descrição	Valor	Não Nulo
ID	Chave Primária	Integer	X
companyID	Chave Estrangeira. Referencia a Entidade Companies	Integer	X
maintype	Tipo de manutenção ao Aerogerador	Varchar(50)	X
dt	Data de Inicio da manutenção	Datetime	X
time	Tempo de demorou a manutenção (horas)	Integer	X
price	Valor do preço da manutenção (€)	Decimal(10,2)	X
Tabela B.38 - Dicionário de Dados - Entidade Maintenances
Entidade: Companies
Descrição: Entidade que armazena as várias Companhias que realizaram a manutenção dos Aerogeradores do sistema
Nome	Descrição	Valor	Não Nulo
ID	Chave Primária	Integer	X
aeroID	Nome da companhia que realizou a manutenção	Varchar(50)	X
email	Email da companhia que realizou a manutenção	Varchar(50)	X
phone	Telefone da companhia que realizou a manutenção	Integer	
Tabela B.39 - Dicionário de Dados - Entidade Companies
Entidade: Pieces
Descrição: Entidade que armazena as várias peças dos Aerogeradores do sistema
Nome	Descrição	Valor	Não Nulo
ID	Chave Primária	Integer	X
aeroID	Chave Estrangeira. Referencia a Entidade Aero	Integer	X
modelID	Chave Estrangeira. Referencia a Entidade Models	Integer	X
mainID	Chave Estrangeira. Referencia a Entidade Maintenances	Integer	X
time	Tempo de funcionamento da peça	Integer	X
Tabela B.40 - Dicionário de Dados - Entidade Pieces
Entidade: ModelPieces
Descrição: Entidade que armazena os vário modelos de peças dos Aerogeradores do sistema
Nome	Descrição	Valor	Não Nulo
ID	Chave Primária	Integer	X
name	Nome do modelo da Peça	Varchar(30)	X
price	Valor do preço da Peça	Decimal(5,2)	X
timetolive	Tempo de vida da Peça	Integer	X
Tabela B.41 - Dicionário de Dados - Entidade ModelPiece
Entidade: Logs
Descrição: Entidade que armazena os vários Logs do sistema
Nome	Descrição	Valor	Não Nulo
ID	Chave Primária	Integer	X
logID	Chave Estrangeira. Referencia a Entidade LogsTable	Integer	X
aeroID	Chave Estrangeira. Referencia a Entidade Aeros	Integer	X
loginfo	Descrição do Log de Sistema	Varchar(255)	X
priority	Prioridade do Log de Sistema	Integer	
dt	Data da realização do Log	Datetime	X
Tabela B.42 - Dicionário de Dados - Entidade Logs
Entidade: StatisticsAeros
Descrição: Entidade que armazena as estatísticas de produção dos város Aerogeradores do sistema
Nome	Descrição	Valor	Não Nulo
ID	Chave Primária	Integer	X
aeroID	Chave Estrangeira. Referencia a Entidade Aeros	Integer	X
num	Número de entradas da tabela Aeros	Integer	
aerospeed	Valor da velocidade do Aerogerador (rpm)	Integer	
aerodir	Valor da direcção do Aerogerador	Integer	
aerovolt	Valor da tensão do Aerogerador (V)	Decimal(18, 3)	
aerocurrent	Valor da corrente produzida pelo Aerogerador (A)	Decimal(18, 3)	
aeropower	Valor da potência produzida pelo Aerogerador (W)	Decimal(18, 3)	
invcurrent	Valor da corrente do inversor (A)	Decimal(18, 3)	
dt	Data de inicio da estatística	Datetime	X
Tabela B.43 - Dicionário de Dados - Entidade StatisticsAeros
Entidade: StatisticsMeteos
Descrição: Entidade que armazena as estatísticas do estac		o do tempo do sistema	
Nome	Descrição	Valor	Não Nulo
ID	Chave Primária	Integer	X
aeroID	Chave Estrangeira. Referencia a Entidade Aeros	Integer	X
num	Número de entradas da tabela Meteo	Integer	
H Universidade de Aveiro
windspeed	Valor da velocidade do vento (m/s)	Decimal(18, 2)	
winddir	Valor da direcção do vento (°)	Integer	
tempe	Valor da temperatura (°)	Decimal(18, 1)	
dt	Data de inicio da estatística	Datetime	X
Tabela B.44 - Dicionário de Dados - Entidade StatisticsMeteo
O módulo do Sistema de Ficheiros FatFs / Tiny-FatFs40 é um software livre que está aberto para a educação, investigação e desenvolvimento, foi utilizado pelo autor para poder utilizar um cartão SD para armazenar os dados do sistema de monitorização.
Neste módulo fazem parte uma camada de funções que permite criar o sistema de ficheiros, juntamente com a camada de funções de baixo nível que permitem aceder ao SD. Neste Anexo será detalhado algumas das funções que pertencem ao Sistema de Ficheiros FatFS.
C.1 - Hardware
C.1.1 - Ligações
A comunicação entre a Sistema de Monitorização e o Cartão MMC / SD é realizada utilizando o protocolo SPI. Existem dois interruptores ligados ao socket, detecção do cartão e protecção da escrita no cartão. Os cartões MMC / SD só pode ser utilizado em sistemas de 3,3 V.
8. DAT1--1
7. DATO/DO
6. Vss2---
5. CLK ---
4. Vcc ---
3. Vss1---
2. CMD/DI—
1. DAT3/CS-
Figura C.4 - Ligações dos cartões MMC / SD
SDC
MMC
7. DAT/DO
6. Vss2
5. CLK
4. Vcc
3. Vss1
2. CMD/DI
1. RES/CS
C.2 - Software
O software é implementado em camadas e para descreve-lo vamos partir da camada física para a camada de interface.
40 Sistema de Ficheiros FatFS disponível em httD://elm-chan.org/fsw/ff/00index e.html
Figura C.5 - Camadas do Modulo de Sistema de Ficheiros
C.2.1 - Camada Física
C.2.1.1 - Protocolo
O protocolo de comunicação utilizado neste projecto MMC / SD é o protocolo SPI. Este protocolo tem uma estrutura de dados de comandos. Os comandos são enviados para o cartão MMC / SD pelo microcontrolador e este recebe uma resposta ou dados. Para acelerar a transferência de dados o cartão MMC / SD também suporta ciclos múltiplos de blocos de 512 Butes de dados.
O SPI é um modo alternativo de funcionamento que define a utilização dos cartões de memória MMC / SD sem interface nativa. O protocolo de comunicação SPI é bastante simples comparado com o modo nativo. O MMC / SD podem ser associadas a vários microcontroladores através de uma interface genérica SPI. Assim, o modo SPI é adequado para aplicações de baixo custo.
C.2.1.2 - Comandos
Um comando tem o tamanho de 6 bytes e recebe uma resposta positiva, se for aceite. A sequência de comando tem um comando com um tamanho de 1 byte seguido com 4 bytes argumento e 1 byte de CRC.
Comando	Argumento		CRC
CMD[7..0]	ARG[31..24]	ARG[23..16]	ARG[15..8]	ARG[7..0]	CRC
A lista dos comandos executados neste projecto está listada abaixo:
Comando	Valor SPI	Descrição
CMD0	(0x40+0)	GO IDLE STATE
CMD1	(0x40+1)	SEND OP COND (MMC)
ACMD41	(0xC0+41)	SEND OP COND (SDC)
CMD8	(0x40+8)	SEND IF COND
CMD9	(0x40+9)	SEND CSD
CMD10	(0x40+10)	SEND CID
CMD12	(0x40+12)	STOP TRANSMISSION
ACMD13	(0xC0+13)	SD STATUS (SDC)
CMD16	(0x40+16)	SET BLOCKLEN
CMD17	(0x40+17)	READ SINGLE BLOCK
CMD18	(0x40+18)	READ MULTIPLE BLOCK
CMD23	(0x40+23)	SET BLOCK COUNT (MMC)
ACMD23	(0xC0+23)	SET WR BLK ERASE COUNT (SDC)
CMD24	(0x40+24)	WRITE BLOCK
CMD25	(0x40+25)	WRITE MULTIPLE BLOCK
CMD55	(0x40+55)	APP CMD
CMD58	(0x40+58)	READ OCR
Tabela C.45 - Lista de Comandos
C.2.2 - Camada Disk I/O
A camada de Disk I/O é composta por funções que acedem directamente com a camada física do cartão MMC/ SD. Deste módulo fazem parte as seguintes funções.
-DSTATUS disk_imtialize (void)
Esta função é utilizada aquando do progresso de inicialização do disco e retorna o estado disco após a inicialização.
-DSTATUS disk_status (BYTE);
Esta função retorna o estado actual do disco. O estado do disco é permanente actualizado com actualizações a cada 10ms. O disco pode ter 3 estados diferentes:
#	define STA_NOINIT	0x01
#	define STA_NODISK	0x02
#	define STA_PROTECT	0x04
/ * A unidade não inicializada * /
/ * Socket vazio* /
/ * Escrita protegida * /
-DRESULT disk_read (BYTE, BYTE*, DWORD, BYTE);
Esta função é utilizada para ler os dados de um armazenamento na posição em que o ponteiro para a memória os dados estão armazenados.
-DRESULT disk_write (BYTE, const BYTE*, DWORD, BYTE);
A função escreve os dados para armazenamento.
-DRESULT disk_ioctl (BYTE, BYTE, void*);
Esta função processa diversas funções, que são mais específicas sobre o armazenamento que é utilizado.
C.2.3 - Camada Transport (FatFS)
A versão do módulo usada neste projecto da Elm Charg (http://elmchan. org/fsw/ff/00index_e.html) é “R0.07a”.
A estrutura do sistema de ficheiros FatFS é a seguinte:
/* File system object structure */ typedef struct _FATFS {
WORD	id;	/* File system mount ID */
WORD	n_rootdir;	/* Number of root directory entries */
DWORD	winsect;	/* Current sector appearing in the win[] */
DWORD	sects_fat;	/* Sectors per fat */
DWORD	max_clust;	/* Maximum cluster# + 1 */
DWORD	fatbase;	/* FAT start sector */
DWORD	dirbase;	/* Root directory start sector (cluster# for FAT32) */
DWORD	database;	/* Data start sector */
#if !_FS_READONLY		
DWORD	last_clust;	/* Last allocated cluster */
DWORD	free_clust;	/* Number of free clusters */
#if _USE_FSINFO		
DWORD	fsi_sector;	/* fsinfo sector */
BYTE	fsi_flag;	/* fsinfo dirty flag (1:must be written back) */
BYTE	pad2;	
#endif		
#endif		
BYTE	fs_type;	/* FAT sub type */
BYTE	csize;	/* Number of sectors per cluster */
#if S_MAX_SIZ &gt; 512U		
WORD	s_size;	/* Sector size */
#endif		
BYTE	n_fats;	/* Number of FAT copies */
BYTE	drive;	/* Physical drive number */
BYTE	winflag;	/* win[] dirty flag (1:must be written back) */
BYTE	pad1;	
BYTE	win[S_MAX_SIZ];	/* Disk access window for Directory/FAT */
} FATFS;
ANEXO D - Projectos Visual Studio
No seguimento deste anexo são expostos os projectos suportados pela ferramenta Microsoft Visual Studio. Como é possível ver na figura seguinte, todo o projecto desenvolvido é composta pelos vários programas.
Figura D.6 - Projecto Microsoft Visual Studio
D.1 - DBI
O projecto DBI é um projecto Windows Form Application desenvolvido em linguagem C#, destinado à criação do interface de instalação da base de dados EolitorDB de suporte a todo o Sistema Eolitor. Este é composto apenas por uma interface (ver Figura 5.12).
Figura D.7 - Projecto DBI
-Forml.cs: É o Windows Form correspondente ao interface principal e único deste Projecto. Este tem as funções básicas de criação do interface, exemplo as funções associadas
-ScriptInstall.es: É o módulo onde residem as funções de criação da base de dados através da execução do script SQL EolitorDB.sql.
-EolitorDB.sql: É o script escrito em linguagem SQL responsável pela criação da base de dados e de todas as tabelas, dos store procedures e dos triggers.
-SQLInfoEnumerator.es: É uma classe que permite instanciar e retornar uma lista de servidores SQL e uma lista de todas as suas Base de Dados.
-RijndaelCryptography.es: É uma classe que permite a increpação de dados ou a desencriptação de dados.
-AssemblyInfo.es: Informações gerais de assemblagem.
D.2 - Eolitor Client
O projecto Eolitor Client é um projecto Windows Form Application desenvolvido em linguagem vb.net, destinado à criação de interface cliente do servidor Eolitor Server. Este permite testar a ligação com o servidor, listar os clientes actualmente ligados ao servidor e trocar mensagens com esses clientes.
Figura D.8 - Projecto Eolitor Client
-ClientForm.vb: É o Windows Form correspondente ao interface principal e único deste Projecto. Este tem essencialmente as funções necessárias à criação do interface e as funções para estabelecer ligação TCP com o servidor. Aqui também é definido a classe Data que define a estrutura das mensagens que são enviadas entre o servidor e os clientes TCP. São também definidos os comandos para a interacção entre o servidor e o cliente.
D.3 - Eolitor Server
O projecto Eolitor Server é um projecto Windows Form Application desenvolvido em linguagem vb.net, destinado à criação de interface que juntamente com o Projecto TCPServer formam o servidor Eolitor Server. Este ao ser executado inicia também a execução do servidor TCP e estabelece ligação TCP/IP com este. Do ponto de vista da ligação TCP/IP, este programa é um cliente do servidor TCPserver.
Figura D.9 - Projecto Eolitor Server
-Server.vb: É o Windows Form correspondente ao interface principal e único deste Projecto. Este tem essencialmente as funções necessárias à criação do interface e as funções que permitem estabelecer ligação com o servidor TCP/IP, para recepção e envio de dados. Aqui também é definido a classe Data que define a estrutura das mensagens que são enviadas entre o servidor e os clientes TCP. São também definidos os comandos para a interacção entre o servidor e o cliente.
-EolitorDB.dbml: É uma classe Data Context gerada pelo Object Relational Designer (O/R Designer) - fornece uma interface visual para criar e editar classes LINQ to SQL - que permite criar um modelo de objectos na aplicação e efectua o mapeamento para os objectos da base de dados onde estão mapeadas todos os objectos relacionais.
-Comm.vb: Neste módulo são definidas todas as funções necessárias para abertura e fecho da porta serie de ligação com o microcontrolador (startSerialPort e stopSerialPort) e o envio de dados deste programa para o microcontrolador (sendPIC).
-CRC.vb: Módulo onde está definida a função de calculo do CRC utilizado nas mensagens que são enviadas entre este programa e o microcontrolador, ou vice versa.
-include.vb: É o módulo onde estão definidas algumas variáveis globais do programa.
-signals.vb: É o módulo onde estão definidos os sinais que são enviados do microcontrolador para este programa.
-SQLServerDB.vb: É uma classe auxiliar que contem todas as funções Public Shared que permitem executar as store procedures da base de dados mapeadas na classe Data Context, para armazenarem os dados nas respectivas tabelas. Esses dados são passados nas funções desta classe como parâmetros de entradas.
-ConnectTCPServer: Função que permite listar a ligação TCP/IP com o servidor.
-OnConnect: Função que estabelece a ligação com o servidor.
-OnReceive: Função que inicia o processo de recepção de mensagens vindas do servidor.
-OnSend: Função que permite o envio de mensagens para o servidor através da ligação TCP/IP estabelecida utilizando sockets.
-CloseClient: Função que é chamada para fechar o socket e a ligação com o servidor depois de enviar para este a mensagem de Logout.
-BroadcastData: Função que inicia o processo de envio de mensagens para o servidor.
D.4 - TCPServer
O projecto TCPServer é um projecto Windows Form Application desenvolvido em linguagem vb.net, destinado à criação de interface que juntamente com o Projecto Eolitor Server formam o servidor Eolitor Server. Este é executado no mesmo instante, e permite criar ligações TCP/IP formando assim uma arquitectura cliente/servidor. Deste modo, é possível aceitar clientes e enviar os dados da monitorização, instantaneamente.
Figura D.10 - Projecto TCPServer
-ServerForm.vb: É o Windows Form correspondente ao interface principal e único deste Projecto. Este tem essencialmente as funções necessárias à criação do interface e as funções que permitem aceitar clientes TCP/IP, receber e enviar dados. Aqui também é definido a classe Data que define a estrutura das mensagens que são enviadas entre o
-OnAccept: Função que permite listar e aceitar nos clientes TCP/IP utilizando sockets (System.Net.Sockets).
-OnReceive: Função que permite receber mensagens de todos os clientes através das ligações TCP/IP (socketes aceites).
-OnSend: Função que permite enviar mensagens para todos os clientes.
D.5 - Eolitor System
O projecto EolitorSystem2008 é um projecto Windows Form Application desenvolvido em linguagem vb.net, destinado à criação de todas as interfaces do programa de sistema de informação. Este é o projecto principal do ponto de vista da visualização da informação.
Solution Explorer -EoütorSystem2OO8	▼ 4 X
A
3 Solution 'EolitorSystemProject' (7 projects)
S 5*1 DBI
IS ¿3 DockDotNET
3	.í) EolitorCIient
.J EolitorServer

EolitorSystem2008
i... My Project
S • I ~j bin
ffi F3 Components
a ■ LJ DE
+	□ Dockable Panels
±	□ Forms
SI F~J Generic Panels
+ O Modules and Classes i+ □ Options Panels jl ■ □ Reports
+	□ Resources
SI i □ Skins
i app.config
i... i**l Config.xml
EolitorDB.dbml
Editor DBDataSet. xsd EolitorSystem2008_TemporaryKey.pfx
5)	._*e] TCPServer
SI -0 Setup
Figura D.11 - Projecto Eolitor System
Pasta Forms
-About.vb: Windows Form com informações sobre a aplicação.
-Connection.vb: Windows Form que permite configurar a ligação à base de dados de suporte: endereço do servidor, nome da base de dados, utilizador e senha.
-DBCharts.vb: É o Windows Form que foi desenvolvido para permitir gerar gráficos recorrendo à base de dados como suporte dos dados e ao dll do programa .netCharting que possibilita essa geração. A utilização deste interface é fácil e intuitiva com a possibilidade de configuração do instante temporal, das variáveis do gráfico e do tipo de gráfico. A função responsável pela criação do gráfico é a função CreateChart que é invocada com o evento clique do botão Create. A função SaveChart é invocada com o evento clique do botão Save e permite armazenar a imagem diferentes formatos do gráfico gerado. A função getSQLData é chamada para obter os dados da base de dados através da abertura de uma ligação SqlClient.SqlConnection com a base de dados EolitorDB.
-Emailer.vb: É o Windows Form que foi criado para possibilitar o envio de emails. Deste modo o interface tem vários TextBox para permitir a escrita do remetente, do destinatário, do assunto e da mensagem. Associado ao evento clique do botão Browse, é possivel adicionar (função Browse_Click) um ficheiro de anexo para ser enviado após o clique no botão Send (função Send_Click). Durante o Load do interface é verificado se o servico SMTP está instalado, caso contrário não será possivel o envio de emails.
-Home.vb: É o Windows Form inicial que permite a abertura de todos os interfaces do programa Eolitor System. Essencialmente neste interface estão funções associados ao evento clique nos vários botões e nos vários itens do MenuStrip.
-Logs.vb: É o Windows Form onde é possível visualizar todos os logs gerados pelo sistema através de uma componente DataGridView.
-Monitor7.vb: É a última versão do Windows Form correspondente ao interface de monitorização. Neste é possível através dos vários gráficos a visualização do comportamento do aerogerador e do tempo. Para iniciar a monitorização basta apenas clicar no botão Connect para criar um socket de ligação TCP/IP com o servidor Eolitor Server, através das funções do módulo TCPServer. É necessária a configuração do endereço IP do servidor e do porto TCP no interface Options. Fazem parte ainda deste interface as seguintes funções:
-Reports.vb: É o Windows Form onde são visualizados os modelos de relatórios que estão na pasta Reports. Os valores armazenados na base de dados são carregados através dos objectos do DataSet EolitorDBDataSet que correspondem às diferentes tabelas da base de dados. A função btnReport1_Click relativa ao evento clique do botão btnReport1 permite carregar o modelo de relatório EolitorReport1.rdlc no ReportViewer do interface. De forma similar, as funções btnReport2_Click e btnReport3_Click associadas ao evento clique dos
-SplashScreen.vb: É o SplashScreen do programa que apresenta uma imagem do Aerogerador e o nome do Programa nos primeiros segundos após o início da execução do mesmo.
-uSD.vb: É o Windows Form que foi desenvolvido para possibilitar a comunicação com o cartão pSD que se encontra na placa do sistema de monitorização.
-WebBrowser: É um Windows Form simples que permite substituir o programa Internet Explorer para a visualização de páginas de Internet.
Pasta Generic Panels
-Graph.vb: É um User Control que corresponde á criação de uma área para gráfico através de uma PictureBox. Este contém funções associadas a eventos e métodos que permite o aumento e diminuição da área destinada ao gráfico e do Zoom da imagem do gráfico, com limites previamente configurados. É possível através das funções CreateGraphSinal e AddLineGraph a geração do gráfico na PictureBox. A função AddLineGraph cria um array de pontos que corresponde a um pixel na área da PictureBox enquanto que a função CreateGraphSinal modifica a grama do sinal para a grama do gráfico (0 a 1023).
-Graph2.vb: É um User Control de uma versão mais reduzida para a geração de gráficos sem as funções de aumento e diminuição da área e do Zoom da PictureBox correspondente à imagem do gráfico.
-OutputTextBox.vb: É um User Control constituído por um RichTextBox que permite criar uma área de mensagem de texto de saída. Existem diferentes tipos de mensagens de saída: Normal, Warning, Error e Other.
Pasta Modules and Classes
-Comm.vb: Neste módulo são definidas todas as funções necessárias para abertura e fecho da porta serie de ligação com o microcontrolador (startSerialPort e stopSerialPort) e o envio de dados deste programa para o microcontrolador (sendPIC).
-ConnDB.vb: É neste módulo que estão as funções: TestConnectionDB para testar a ligação à base de dados; TestNewConnectionDB para testar uma nova ligação à base de dados defenindo novos parâmetros; SaveChange_To_App_Config para guardar a nova sting de ligação com a base de dados no ficheiro de configurações do programa.
-CRC.vb: Módulo onde está definida a função de calculo do CRC utilizado nas mensagens que são enviadas entre este programa e o microcontrolador, ou vice versa.
-Email.vb: Módulo com funções relacionadas com o envio de emails: Load_Mail para a formação da mensagem de email e Send_Mail para o envio de email e a função testSMTPService para testar a instalação do serviço SMTP no PC local.
-include.vb: É o módulo onde estão definidas algumas variáveis globais do programa.
-Report.vb: Módulo contendo funções relacionadas com a criação de relatórios.
-signals.vb: É o módulo onde estão definidos os sinais que são enviados do microcontrolador para este programa.
-SQLServerDB.vb: É uma classe auxiliar que contem todas as funções Public Shared que permitem executar as store procedures da base de dados mapeadas na classe Data Context, para armazenarem os dados nas respectivas tabelas. Esses dados são passados nas funções desta classe como parâmetros de entradas.
-TCPServer.vb: É neste módulo que estão definidas todas as funções reponsáveis pela criação de um socket TCP/IP de comunicação com o servidor para o envio e recepção de mensagens. As funções que fazem parte deste módulo são: NewClient, OnSend, OnConnect, OnReceive, LoadData, BroadcastData e CloseClient. São também definidos a classe Data e a o formato o tipo de comandos que são enviados nas mensagens.
-XML.vb: Neste módulo existem algumas funçõs para a criação de um ficheiro de configurações no formato xml. A função CheckXML permite verificar se o ficheiro existe. A função CreateXMLFileDefault possibilita a criação de um ficheiro xml com os valores iniciais.A função LoadXMLFile permite carregar todos os elementos dentro do elemento root. Com a função UpdateXMLElement é possível actualizar os valores dentro do ficheiro xml. Finalmente, a função RemoveXMLElement perite a remoção de um elemento no ficheiro xml.
Pasta Options Panels
-Options.vb: É o Windows Form que através da instanciação dos vários painéis seguintes permite ao utilizador a configuração do programa. São definidas as funções de criação e conclusão do interface, associadas ao evento clique no botão OK (button_OK_Click que permite actualizar os vários parâmetros globais do programa) e Cancel (button_Cancel_Click que possibilita a conclusão do interface) e a função associada à selecção do nó correnpondente aos vários painéis treeViewParameters_AfterSelect. É definida a classe validDataEventArgs de validação dos dados introduzidos nos vários painéis deste interface e declarado o delegate ValidDataEventHandler.
-PanelDatabase.vb: É um User Control que corresponde a um Painel que permite configurar a ligação à base de dados através da personalização do servidor, do nome da base de dados, do utilizador e da senha.
-PanelPorts.vb: É um User Control que corresponde a um Painel onde é configurável a porta de comunicação do PC que foi aberta devido a ligação entre a PCB e o PC servidor.
-PanelReports.vb: É um User Control que corresponde a um Painel que possibilita a configuração dos endereços de email e do servidor para o envio de emails. Mediante a configuração destes parâmetros será possível o envio de emails contendo os relatórios gerados no intervalo de tempo também configurado.
-PanelServer.vb: É um User Control que corresponde a um Painel onde é possível a configuração dos endereço IP do servidor, o porto TCP em que o servidor está à escuta e o nome do cliente TCP/IP estabelecido através deste programa.
-PanelStartup.vb: É um User Control que corresponde a um Painel que permite configurar se o programa inicia com o interface minimizado e se ao minimizar o programa vai para a barra de tarefas ou para a área de notificações.
Pasta Reports
-EolitorReportl.rdlc, EolitorReport2.rdlc e EolitorReport3.rdlc: São três Reports que correspondem a três modelos de relatórios.
Pasta Resources
Nesta pasta onde estão armazenadas todos os ficheiros de imagens nos formatos png, jpg, gif e ico.
Pasta Skins
É nesta paste que contem todos os ficheiros skf correspondentes aos vários skins que podem ser carregados no programa através do dll do programa SkinCrafter.
-EolitorDB.dbml: É uma classe Data Context gerada pelo Object Relational Designer (O/R Designer) - fornece uma interface visual para criar e editar classes LINQ to SQL - que permite criar um modelo de objectos na aplicação e efectua o mapeamento para os objectos da base de dados onde estão mapeadas todos os objectos relacionais.
Universidade de Aveiro
188
D.6 - Setup
O projecto Setup é um projecto Setup Project que foi desenvolvido com objectivo de criar um executável msi, para permitir a instalação em qualquer PC de todos os ficheiros necessários para a execução de todos os programas. Este projecto é composto pelos ficheiros de saída (primary output) dos restantes projectos.
Com a instalação é criada uma pasta em Programas (pode ser configura durante a instalação) onde são colocados todos os ficheiros. São também criados atalhos no ambiente de trabalho e na pasta Iniciar.
Juntamente com os ficheiros necessários para a execução de todos os programas foi também criado um guia de iniciação rápido em formato Web, onde podem ser encontradas algumas instruções para a utilização dos vários interfaces.
A execução do ficheiro msi resultante deste projecto tem com pré-requisitos a instalação das ferramentas .NET Framework e o Microsoft Windows Installer.
Figura D.12 - Projecto Setup
Neste anexo estão todos os circuitos, e os cálculos necessários para o dimensionamento de ambas as placas do sistema de Monitorização.
E.1- Opção Local
No esquema seguinte estão representadas todas as ligações ao microcontrolador, tanto as ligações de alimentação, incluindo o regulador de 3.3V, como as ligações de dados. Estão também os dois cristais, um de 7.37MHz para o funcionamento do microcontrolador e outro de 32.768 kHz para o funcionamento do RTCC do PIC.
E.1.1 - Microcontrolador
-PIC24FJ128GA006
-REG103GA-33
Datasheet
Datasheet
E.1.2 - Conectores I/O
No esquema seguinte estão todos os conectores para ligar aos vários sensores, os conectores para a bateria e o painel solar ou transformador, o conector para a ligação módulo de comunicação sem fio, o conector RJ45 para programação do microcontrolador, o sensor de temperatura analógico MAX6608 integrado na placa e as ligações respectivas da placa do sistema de monitorização.
Datasheet
-MAX6608
SíTiíor Tempe						
			IJ7 MAM06O8			ADC2 C13 inF
		1	NC	d IJT	5	11
		2				II I
	3		GND	vcc	4	+3.3V 9
			A			. I . . . .
						ZZZZ C14 _L D.2uF
4		J +5V
3	
2	III	
J		|l'&amp;lt;&lt;ADC3	
4	J +5V
3	
2	I	
J I&amp;lt;&amp;lt;INT2	
E.1.3 - Regulador 5V
Na figura seguinte está o regulador TL2575-05 da TI com todos os componentes necessários para o seu funcionamento. A tensão de entrada pode ir até 40V e a saída é regulada a 5V@1.2A.
TL2575-Ü5A
—15	ON"/OFF
	FEEDBACK
	VIN
	OUTPUT
	GND
-TL2575-05	Datasheet
-L22uH	Datasheet
-L330uH	Datasheet
E.1.4 - Carregador de Baterias Lithium
Na figura seguinte estão todas as ligações e componentes necessárias para o funcionamento do carregador de baterias Lithium BQ24002 da TI. A tensão de alimentação deste carregador é a tensão de saída do regulador TL2575-05. Por isso, o carregador só
Carregador de Bate ri aí		Lithium					
		R1 0.					
5 VI T					v 1 " 2	N/C	NC2LI OUT19 OUT18 VSENSE AG ND STAT2 STAT1 7MR SEL
				3		IN2	
C4				4		1N3 V cc ISNS NC6 APG EN Ví EL ij HD	
IDuF	X	T		5			
	C5				.. 6		
	O.luF	T	APG		- 7		
					R		
			h ■		9		
					10		NC11
			X-				
						bq240025MP	
20-,.				
19’	t t				
is	n		os		
17	1			......	
16	III		luF 1	F		
15	|P		“=■ “=■	5 VI	
14		□ 1 LED R2 500		
13				
12 ,			/ r4	
X7L_1 |_J		XX	"	&gt; 8.2k	
* 11 r? Ü.22uF		02 LED	R3 500 L4	1 APG	
		xx n		/ R5 &gt; 2.2k	
-BQ24002
Datasheet
E.1.5 - Charge Pump
Na figura anterior estão todas as ligações e componentes necessárias ao funcionamento do Charge Pump TPS60130. Para o funcionamento do mesmo apenas e necessário o ligar ENABLE a Vcc. Apenas é necessário programar o Low-Battery Detector utilizando 3 resistências R1, R2 e R3 (ver figura seguinte). Enquando a tensão Vlbi for superior à tensão de referência Vref, a saida LBO está a “1”, quando a tensão Vlbi baixar ficando inferior a Vref, a saida LBO passa a “0”. A tensão da bateria que corresponda Vlbi igual a Vref é Vbat igual a 3.5V.
-TPS60130	Datasheet
Para calcular o valor dessas resistâncias, utilizamos as seguintes equações:
VouT
R 3 = 1M--
y
R 1 = 1 M	—	R 2 = 1 M^-R1
V
' BAT
Para VBAT=3.5V e VLBI=1.3V:
R1 = 370	R 2 = 630
R1	+ R 2
R 1 (min) R 2 (max)
BAT (min) V LBI (min)
R2
(max)
R1 R2,
(max)	(min)
BAT (max)	LBI (max)
R (min)
E.1.6 - Supervisor
Na figura em baixo estão os componentes necessários para o funcionamento do supervisor ADM696 da Analog Devices. Este tem na entrada VCC a saída do regulador TL2575-05 e na entrada da bateria VBATT a saída do charge pump TPS60130. Conforme o valor das resistências R9 e R10, a saída VOUT é comutada.
Foi utilizado um transistor PNP externo para passar a corrente, devido à corrente necessária para alimentar o microcontrolador e sensores ser superior a 100mA.
Datasheet
-ADM696
E.1.7- ConectorpSD
Na figura em baixo estão as ligações SPI necessárias do microcontrolador ao socket do cartão |iSD.
Datasheet
-Socket p.SD
E.1.7 - Módulo Bluetooth
Nas figuras seguintes estão o schematics com as ligações necessárias para o módulo F2M03GLA poder funcionar e o layout resultante.
Datasheet
-Módulo F2M03GLA
E.1.8 - Layout da PCB
A figura seguinte ilustra o Layout da placa circuito impresso que resoltou dos esquemas anteriores. Esta placa tem duas camadas “TOP” e “BOTTON” com todos os footprints das componentes utilizadas e as vias de ligação entre elas.
E.2- Opção Remota
A PCB que foi desenvolvida para esta opção é uma versão reduzida da anterior visto não existir a necessidade de alimentar o circuito a partir da energia solar nem de armazenar energia, uma vez que existe energia eléctrica no local.
E.2.1 - Microcontrolador
No esquema seguinte estão representadas todas as ligações ao microcontrolador, tanto as ligações de alimentação, incluindo o regulador de 3.3V, como as ligações de dados. Estão também os dois cristais, um de 7.37MHz para o funcionamento do microcontrolador e outro de 32.768 kHz para o funcionamento do RTCC do PIC.
-PIC24FJ128GA006 Datasheet
		T3	
	Z C17 23 pF		-2.	□
	zzL cie T	MVSTA.1-4?SM	
E.2.2 - Conector pSD
Na figura em baixo estão as ligações SPI necessárias do microcontrolador ao socket do
cartão pSD.
Datasheet
CS1»
MOS»
SCK»
MIS(»
-Socket pSD
E.2.3 - Conectores I/O
No esquema seguinte está o conector para ligar os vários sensores, a ligação ao módulo de comunicação com fios, o conector RJ45 para programação do microcontrolador, o sensor de temperatura analógico MAX6608 e os reguladores de tensão de 5V e 3.3V.
E.2.4 - USB
Datasheet
-FT232R
Datasheet
-FT232R
E.2.5 - Módulo Bluetooth
Nas figuras seguintes estão o schematics com as ligações necessárias para o módulo F2M03GLA poder funcionar e o layout resultante.
Datasheet
-Módulo F2M03GLA
E.2.6 - Layout da PCB
A figura seguinte ilustra o Layout da placa circuito impresso que resoltou dos esquemas anteriores. Esta placa tem duas camadas “TOP” e “BOTTON” com todos os footprints das componentes utilizadas e as vias de ligação entre elas.
Como já foi referido anteriormente, para este sistema precisamos de configurar a ADC, um Timer para gerar interrupções a uma frequência determinada, o RTCC, os registos dos Portos, um módulo SPI, as interrupções e uma UART. Assim, neste anexo vamos detalhar o programa geral (firmware), incluindo a configuração do microcontrolador e o módulo para de interacção como SD para criar um sistema de ficheiros FatFS, tudo escrito em linguagem C. Foi utilizado a ferramenta VDI do ORCAD para confirmar o valor dos registos para configurar o microcontrolador.
F.1 - adc
Na biblioteca adc.h fazem parte as funções adc_init e adr_read. Na primeira função, sem parâmetros de entrada, é feita a configuração da ADC; os canais analógicos através do registo AD1PCFG, o modo de funcionamento através dos registos ADCON1, ADCON2 e ADCON3. Na segunda função é escolhido o canal da ADC no registo AD1CHS, através do parâmetro de entrada e iniciada a conversão. O módulo da ADC é iniciado colocando o bit ADON do registo AD1CON a “1”. Depois é iniciado o amostragem de forma manual escrevendo o bit SAMP do registo AD1CON a “1” e a conversão é iniciada passando 31Tad. O final da conversão é detectado quando o bit DONE no registo AD1CON passa a “1” (ver figura seguinte).
-Constantes
#define WINDDIR_AN	2
#define TEMPE_AN	3
#define AEROCUR_AN	4
#define INVCUR_AN	5
#define VOLT_AN	6
#define BATTERY_AN	7
-Protótipos das funções void adc_init(void);
int adc_read (unsigned int an);
void adc_init (void) {
AD1PCFG=0x9F02;
AD1CON1=0x000E;
AD1CON3=0x1F02;
AD1CON2=0;
AD1CSSL=0;
}
//AD1PCFG: A/D PORT CONFIGURATION REGISTER
//AD1CON1: A/D CONTROL REGISTER 1
//AD1CON3: A/D CONTROL REGISTER 3
//AD1CON2: A/D CONTROL REGISTER 2
//AD1CSSL: A/D INPUT SCAN SELECT REGISTER
int adc_read (unsigned int an) {
switch (an) {
//AD1CHS: A/D INPUT SELECT REGISTER
case
case
case
case
case
case
case
case
case
case
case
case
case
0: AD1CHS=0x0000; break;
1: AD1CHS=0x0001; break;
2: AD1CHS=0x0002; break;
3: AD1CHS=0x0003; break;
4: AD1CHS=0x0004; break;
5: AD1CHS=0x0005; break;
6: AD1CHS=0x0006; break;
7: AD1CHS=0x0007; break;
8: AD1CHS=0x0008; break;
9: AD1CHS=0x0009; break;
10:AD1CHS=0x000A; break;
11:AD1CHS=0x000B; break;
12:AD1CHS=0x000C; break;
IFS0bits.AD1IF = 0;
// Clear A/D conversion interrupt.
// Configure A/D interrupt priority bits (AD1IP&lt;2:0&gt;) here, if
// required. Default priority level is 4.
IEC0bits.AD1IE = 0;	// Enable A/D conversion interrupt
AD1CON1bits.ADON = 1;
AD1CON1bits.SAMP = 1;
while (!AD1CON1bits.DONE);
// Turn on A/D
// start sampling then...
// after 31Tad go to conversion
// conversion done?
}
AD1CON1bits.ADON = 0;	// Turn off A/D
return *(&amp;amp;ADC1BUF0);	// yes then get ADC value
}
F.2 - comm
Na biblioteca comm.h estão as funções de configuração da UART, de escrita e leitura do buffer da UART. A UART foi configurada com uma baudrate igual a 460800, com 8 bits de dados, sem paridade e com 1 stop bit.
-Constantes
#define BUFFER_SIZE	128
#define BPS	460800UL
-Protótipo da Função
void uart_init (void);
int uart_test (void);
void clear_RXBuf (void);
void uart_put (BYTE);
BYTE uart_get (void);
static int TxRun;
static volatile struct
{
int	rptr;
int	wptr;
int	count;
BYTE	buff[BUFFER_SIZE];
} TxFifo, RxFifo;
void _attribute_((mterrupt, auto_psv)) _U1RXInterrupt (void) {
BYTE d;
int n;
d = (BYTE)U1RXREG;
_U1RXIF = 0;
n = RxFifo.count;
if (n &amp;lt;BUFFER_SIZE) {
n++;
RxFifo.count = n;
n = RxFifo.wptr; RxFifo.buff[n] = d; RxFifo.wptr = (n + 1) % BUFFER_SIZE;
}
}
void __attribute__((interrupt, auto_psv)) _U1TXInterrupt (void) {
int n;
_U1TXIF = 0;
n = TxFifo.count;
if (n) {
n--;
TxFifo.count = n;
n = TxFifo.rptr; U1TXREG = TxFifo.buff[n]; TxFifo.rptr = (n + 1) % BUFFER_SIZE;
} else {
TxRun = 0;
}
}
int uart_test (void)
{
return RxFifo.count;
}
void clear_RXBuf (void)
{
RxFifo.count=0;
}
BYTE uart_get (void)
BYTE d; int n;
while (!RxFifo.count);
n = RxFifo.rptr;
d = RxFifo.buff[n];
RxFifo.rptr = (n + 1) % BUFFER_SIZE;
-DIO;
RxFifo.count--;
_EI();
return d;
}
void uart_put (BYTE d)
{
int n;
while (TxFifo.count &gt;= BUFFER_SIZE);
n = TxFifo.wptr;
TxFifo.buff[n] = d;
TxFifo.wptr = (n + 1) % BUFFER-SIZE;
-DIO;
TxFifo.count++;
if (!TxRun) {
TxRun = 1;
-U1TXIF = 1;
}
_EI();
}
void uart_init (void)
{
/* Disable Tx/Rx interruptrs */
_U1RXIE = 0;
_U1TXIE = 0;
/* Initialize UART1 */
U1BRG = FCY / 16 / BPS - 1;
_UARTEN = 1;
_UTXEN = 1;
/* Clear Tx/Rx FIFOs */
TxFifo.rptr = TxFifo.wptr = TxFifo.count = 0;
RxFifo.rptr = RxFifo.wptr = RxFifo.count = 0;
TxRun = 0;
/* Enable Tx/Rx interruptrs */
_U1RXIE = 1;
_U1TXIE = 1;
}
F.3 - crc
Na biblioteca crc.h está a função add2crc que é utilizada na formação da trama para gerar o código CRC.
-Protótipo da Função
unsigned short add2crc(unsigned char newData, unsigned short oldCRC)
unsigned short add2crc(unsigned char newData, unsigned short oldCRC)
{
oldCRC A= newData;
oldCRC a= (oldCRC &amp;amp; 0xFF00)&amp;lt;&amp;lt;4;
oldCRC A= (oldCRC &gt;&gt; 8)&gt;&gt;4;
oldCRC a= ((oldCRC &amp;amp; 0xFF00)&gt;&gt;4) &gt;&gt; 1;
return oldCRC;
}
F.4 - events
Na biblioteca eventsh estão definidos todos os eventos, as funções que permitem criar uma lista de eventos, caracterizados por um id, e a função que devolve o próximo evento da lista.
-Constantes
#define EVENT_CONNECTION_OPEN	11
#define EVENT_TEST_CONNECTION	12
#define EVENT_CONN_PING	13
#define EVENT_CONN_ACK	14
#define EVENT_HELLO	15
#define EVENT_READ_METEO	1
#define EVENT_READ_AERO	2
#define EVENT_READ_BAT	3
#define EVENT_SEND_SETTINGS	4
#define EVENT_SEND_TRAMA	5
#define EVENT_GET_DATETIME_PC	6
#define EVENT_SEND_DATETIME_PIC	7
#define EVENT_SET_RTC	8
#define EVENT_SET_FREQ	9
#define EVENT_READ_DIFFTIME	10
#define EVENT_FATFS	100
#define EVENT_FF_DUMPSECTOR	101
#define EVENT_FF_INITPHYSICAL	102
#define EVENT_FF_SHOWDISK	103
#define EVENT_FF_DUMPBUFFER	104
#define EVENT_FF_EDITBUFFER	105
#define EVENT_FF_READDISKBUFFER	106
#define EVENT_FF_WRITEDISKBUFFER 107 #define EVENT_FF_FILLWORKBUFFER	108
#define EVENT_FF_INITLOGICAL	109
#define EVENT_FF_SHOWLOGICAL	110
#define EVENT_FF_DIRLIST	111
#define EVENT_FF_OPENFILE	112
#define EVENT_FF_CLOSEFILE 113
#define EVENT_FF_SEEKFILEPTR	114
#define EVENT_FF_READFILE	115
#define EVENT_FF_READDUMPFILE	116
#define EVENT_FF_WRITEFILE	117
#define EVENT_FF_CHANGENAME	118
#define EVENT_FF_UNLINK	119
#define EVENT_FF_TRUNCATE120
#define EVENT_FF_CREATEDIR	121
#define EVENT_FF_CHANGEFILE	122
#define EVENT_FF_CHANGETIME	123
#define EVENT_FF_COPYFILE	124
#define EVENT_FF_CREATEFILESYS	125
#define EVENT_FF_TIME	126
#define EVENTLISTLENGTH	30
#define PRIORITYLEVELS	2
#define LOWPRIORITY	1
#define HIGHPRIORITY	0
#define ERROREV	-1
#define EVENTOK	0
#define EVENTLISTFULL	1
#define NULLEVENT	0
#define NULLDATA	0
typedef struct { unsigned char id; void* data;
} EVENT;
EVENT *nextEvent_priority(unsigned char);
#define get_eventList_errors() eventList_errors
-Protótipos das Funções
signed char registerEvent(unsigned char event_id, void* event_data) signed char registerEvent_async(unsigned char event_id, void* event_data) EVENT *nextEvent(void)
signed char registerEvent(unsigned char event_id, void* event_data) {
unsigned char Swrite = write;
EVENT* event;
if(++Swrite == EVENTLISTLENGTH) Swrite = 0;
if (Swrite == read)
{
eventList_errors++; return EVENTLISTFULL;
}
event = &amp;amp;eventList[Swrite];
write = Swrite;
event-&gt;id = event_id;
event-&gt;data = event_data;
return EVENTOK;
}
signed char registerEvent_async(unsigned char event_id, void* event_data) {
signed char aux;
-DIO;
aux = registerEvent(event_id, event_data);
_EI();
return aux;
}
EVENT *nextEvent(void)
{
EVENT *event_aux = NULLEVENT;
while (event_aux == NULLEVENT)
{
_DI();
if (read ! = write)
{
if(++read == EVENTLISTLENGTH) read = 0; event_aux = &amp;amp;eventList[read];
}
_EI();
}
return event_aux;
}
F.5-isr
Na biblioteca isr.h estão todas as rotinas de serviço para as várias interrupções do PIC e as funções read_windSp e read_aeroSp. O sensor de velocidade do vento está ligado à entrada da interrupção INT2 e o sensor da velocidade do Aerogerador está ligado À entrada da interrupção INT3.
-Constantes
#define SECOND	1000
#define HALFSECOND	500
#define QUARTERSECOND	250
-Protótipos das Funções
int read_windSp (void);
int read_aeroSp (void);
void clear_windSp (void);
void clear_aeroSp (void);
static unsigned int windspVal;
static unsigned int aerospVal;
void _attribute_((interrupt, auto_psv)) _INT2Interrupt (void) {
windspVal++;
IFS1bits.INT2IF = 0; /* clear interrupt flag */
}
void __attribute__((interrupt, auto_psv)) _INT3Interrupt (void) {
aerospVal++;
IFS3bits.INT3IF = 0; /* clear interrupt flag */
}
int read_windSp (void)
{
return windspVal;
}
int read_aeroSp (void)
{
return aerospVal;
}
void clear_windSp (void)
{
windspVal=0;
}
void clear_aeroSp (void)
{
aerospVal=0;
}
F.6 - ports
Na biblioteca ports.h está a função ports_init, que permite configurar os pinos I/O, como entrada ou saída, dos vários portos através dos registos TRISB, TRISC, TRISD, TRISE, TRISF e TRISG
-Protótipo da Função
void ports_init(void)
void ports_init(void)
{
/*Programacao dos registos TRISB, TRISC, TRISD, TRISE, TRISF e TRISG*/
TRISB=0xC6FF;
TRISC=0xC000;
TRISD=0x06FF; TRISE=0x00E7; _LATE3=1;
_LATE4=0;
TRISF=0x007F; TRISG=0x028F;
_LATG6=0;
_LATG7=1;
_LATG8=1;
_CN13PUE = 1;
_CN14PUE = 1;
}
F.7 - rtc
Na biblioteca rtc.h estão as funções que permitem configurar a RTCC do PIC e ler o seu valor. A função RTCCInit permite iniciar a RTCC. Uma data e hora (RTCC_time), podem ser configuradas através da função RTCCSet(_time). A função que permite a leitura da data e hora da RTCC é a função RTCCRead. A estrutura RTCC tem o formato seguinte:
typedef union tagRTCC {
struct {
unsigned char sec;
unsigned char min;
unsigned char hr;
unsigned char wkd;
unsigned char day;
unsigned char mth; unsigned char yr;
};
struct {
unsigned int prtOO;
unsigned int prtO1;
unsigned int prt1O;
unsigned int prt11;
};
} RTCC;
-Constantes
#define mRtccIsSync() (RCFGCALbits.RTCSYNC)
#define mRtccWaitSync() while((BOOL)RCFGCALbits.RTCSYNC)
#define mRTCCDec2Bin(Dec) (10*(Dec&gt;&gt;4)+(Dec&amp;amp;0x0f))
#define mRTCCBin2Dec(Bin) (((Bin/10)&lt;&lt;4)|(Bin%10))
-Protótipos das Funções
void RTCCgrab(RTCC _time, RTCC _time_chk);
void RTCCInit(RTCC _alarm, RTCC _time);
void RTCCSet(RTCC _time);
void RTCCRead(RTCC* pTD);
void RTCCALMSet(RTCC _alarm);
void RTCCUnlock(void);
void RTCCSetBinSec(RTCC* pTD,unsigned char ); void RTCCSetBinMin(RTCC* pTD,unsigned char ); void RTCCSetBinHour(RTCC* pTD,unsigned char ); void RTCCCalculateWeekDay(RTCC* pTD);
void RTCCSetBinDay(RTCC* pTD,unsigned char ); void RTCCSetBinMonth(RTCC* pTD,unsigned char ); void RTCCSetBinYear(RTCC* pTD,unsigned char ); RTCC transformDateTime(RTCC* pTD);
void RTCCInit(RTCC _alarm, RTCC _time)
{
asm("mov.b #0x46, W2");	// unlock byte 1 for OSCCONL(low byte)
asm("mov.b #0x57, W3");	// unlock byte 2 for OSCCONL(low byte)
// move 8-bit of Wn to OSCCON register asm("mov.b W2, [W1]");	// write unlock byte 1
asm("mov.b W3, [W1]");	// writeRTCC _time, RTCC _time_chk127 unlock byte 2
asm("mov.b W0, [W1]");	// enable SOSCEN
// Unlock sequence must take place for RTCEN to be written
RCFGCAL = 0x0000;
RTCCUnlock();
RCFGCALbits.RTCEN = 1;	// bit15
//RTCC pin pad conected to RTCC second clock
PADCFG1bits.RTSECSEL = 1;
RCFGCALbits.RTCOE = 1;	//RTCC Output Enable bit
/* Enable the RTCC interrupt*/
IFS3bits.RTCIF = 0;	//clear the RTCC interrupt flag
IEC3bits.RTCIE = 0;	//enable the RTCC interrupt
// TO DO: Write the time and date to RTCC as follow. // Set it after you change the time and date. RTCCSetBinYear(&amp;amp;_time,9); RTCCSetBinMonth(&amp;amp;_time,1); RTCCSetBinDay(&amp;amp;_time,1); RTCCCalculateW e ekDay(&amp;amp;_time); RTCCSetBinHour(&amp;amp;_time,1); RTCCSetBinMin(&amp;amp;_time,1); RTCCSetBinSec(&amp;amp;_time,1);
RTCCSet(_time);
// Set alarm
_alarm.sec	=	0x01;
_alarm.min	=	0x01;
_alarm.hr = 0x01;
_alarm.wkd	=	0x01;
_alarm.day	=	0x01;
_alarm.mth	=	0x01;
}
//RTCCALMSet(_alarm);
void RTCCSet(RTCC _time) {
RTCCUnlock();
// Unlock the RTCC
RCFGCALbits.RTCPTR = 3;
RTCVAL = _time.prt11;
RTCVAL = _time.prt10;
RTCVAL = _time.prt01;
RTCVAL = _time.prt00;
// Set the time
// setyear
// set month:day
// set week:hour
// set min:sec
RCFGCALbits.RTCWREN = 0;
// Lock the RTCC
// Here, the watch the RTCC register, the new time and date has been updated.
}
void RTCCRead(RTCC* pTD)
{
RTCC currTD;
do
{
RCFGCALbits.RTCPTR = 3;
pTD-&gt;prt11=RTCVAL;
pTD-&gt;prt10=RTCVAL;
pTD-&gt;prt01=RTCVAL;
pTD-&gt;prt00=RTCVAL;
RCFGCALbits.RTCPTR = 3;
currTD.prt11=RTCVAL;
currTD.prt10=RTCVAL;
currTD.prt01=RTCVAL;
currTD.prt00=RTCVAL;
}while(pTD-&gt;sec!=currTD.sec);
}
// read the user value
// read the user value
// make sure you have the same sec
void RTCCUnlock()
{
asm volatile("disi #5");
asm volatile("mov #0x55, w7");
asm volatile("mov w7, _NVMKEY");
asm volatile("mov #0xAA, w8");
asm volatile("mov w8, _NVMKEY");
asm volatile("bset _RCFGCAL, #13"); asm volatile("nop");
asm volatile("nop");
}
// write 0x55 and 0xAA to
// NVMKEY to disable
// write protection
// set the RTCWREN bit
RTCC transformDateTime(RTCC* pTD)
{
RTCC currTD;
pTD-&gt;sec = ((pTD-&gt;sec &amp;amp; 0x70) &gt;&gt; 4)*10 + (pTD-&gt;sec &amp;amp; 0x0F); pTD-&gt;min = ((pTD-&gt;min &amp;amp; 0x70) &gt;&gt; 4)*10 + (pTD-&gt;min &amp;amp; 0x0F); pTD-&gt;hr = ((pTD-&gt;hr &amp;amp; 0x30) &gt;&gt; 4)*10 + (pTD-&gt;hr &amp;amp; 0x0F);
pTD-&gt;day = ((pTD-&gt;day &amp;amp; 0x30) &gt;&gt; 4)*10 + (pTD-&gt;day &amp;amp; 0x0F); pTD-&gt;mth = ((pTD-&gt;mth &amp;amp; 0x10) &gt;&gt; 4)*10 + (pTD-&gt;mth &amp;amp; 0x0F); pTD-&gt;yr = ((pTD-&gt;yr &amp;amp; 0xF0) &gt;&gt; 4)*10 + (pTD-&gt;yr &amp;amp; 0x0F);
currTD.prt11=pTD-&gt;prt11;
currTD.prt10=pTD-&gt;prt10;
currTD.prt01=pTD-&gt;prt01;
currTD.prt00=pTD-&gt;prt00;
return currTD;
}
F.8 - timers
Na biblioteca timers.h estão a função de configuração do Timer5 tmr5_setup e a função tmr5_start. O Timer5 foi configurado para gerar interrupções de 1 em 1 milissegundo, com a prioridade 1, e com clock de entrada interno.
-Protótipos das Funções
void tmr5_start (void)
void tmr5_setup(void)
void tmr5_start (void)
{
T5CONbits.TON=0;
TMR5=0; T5CONbits.TON=1;
}
void tmr5_setup(void)
{
//T5CON: TIMER5 CONTROL REGISTER
T5CON = 0x00;	//Stops the Timer5 and reset control reg.
TMR5 = 0x00;	//Clear contents of the timer register
PR5 = FCY / 8 / 1000;	//Load the Period register with the value
IPC7bits.T5IP = 0x01; IFS1bits.T5IF = 0; IEC1bits.T5IE = 1; T5CONbits.TCS=0; T5CONbits.TCKPS1=0; T5CONbits.TCKPS0=1; T5CONbits.TON = 0;	//Setup Timer5 interrupt for desired priority level //Clear the Timer5 interrupt status flag //Enable Timer5 interrupts //External clock from TxCK pin //Timer5 Input Clock Prescale Select bits //Timer5 Input Clock Prescale Select bits //Start Timer5 with prescaler settings at 1:1 and //clock source set to the internal clock (FOSC/2)
}
F.9 - -trama
Na biblioteca trama.h estão duas funções que permitem a escrita dos dados na trama (buffer) e o envio da trama. A função de escrita writeTrama armazena os dados no buffer trama com um respectivo id até um determinado tamanho (TRAMA_SIZE_MAX). A função sendTrama adiciona à trama o cabeçalho e um checksum, resultado da função add2crc da biblioteca crc.h.
-Constantes
#define TRAMA_SIZE_MAX 100
#define MSGOK	0
#define MSGERR	-1
#define SYNCRO	0
#define LENGTH	1
#define ID	2
#define DATA	3
-Protótipos das Funções
void writeTrama(unsigned char id, unsigned char nbyte, short *data);
void sendTrama(void);
void sendTramaPC(void);
void sendTramaSD(void);
void writeTrama(unsigned char id, unsigned char nbyte, short *data) {
unsigned char i=0,k=0;
if( (trama_size+nbyte+1)&gt;(TRAMA_SIZE_MAX) )
sendTrama();
trama[trama_size] = id;	// Write ID
trama_size++;
while(i&lt;nbyte)	// Write DATA
{
if (i==nbyte-1)
{
trama[trama_size+(i++)]=(unsigned char)(data[k]&amp;amp;0x00FF); }else{
trama[trama_size+(i++)]=(unsigned char)(data[k]&gt;&gt;8); trama[trama_size+(i++)]=(unsigned char)(data[k++]&amp;amp;0x00FF);
}
} trama_size+=nbyte;
}
void sendTrama (void)
{
if (_sendPC ==1 )
{
sendTramaPC();
}else if (_sendPC ==0 ){
sendTramaSD();
}
}
void sendTramaPC(void)
{
short crc;
unsigned char i,k;
if(trama_size&gt;2)
{
trama[0] = 0x00;
trama[1] = 0x80 + trama_size;
crc = 0;
for(i=1;i &amp;lt;trama_size; i++) crc=add2crc(trama[i],crc);
trama[trama_size++] = (unsigned char)(crc&gt;&gt;8); trama[trama_size++] = (unsigned char)(crc&amp;amp;0x00FF);
for (k=0;k&lt;trama_size;k++)
{
if (trama[k]&lt;16)
{ xprintf("%X",0); xprintf("%X",trama[k]);
}else{ xprintf("%X",trama[k]);
}
trama[k]=0;
} trama_size = 2;
}
}
F.10 - vars
Na biblioteca vars.h estão definidas algumas variáveis do programa, entre as quais o identificador id dos vários sensores e dados da trama.
#define AEROID	1
#define WINDSPEED	1
#define WINDDIRECTION #define TEMPERATURE #define AEROSPEED #define AERODIRECTION #define AEROVOLT #define AEROCURRENT #define AEROPOWER #define INVERTERCURRENT #define BATTERY	2 3 4 5 6 7 8 9 10
#define CONNECTION_OPEN #define CONNECTION_PING #define GETDATETIMEPC #define DIFFDATETIME #define DATETIMEPIC	11 12 13 14 15</field>
	</doc>
</add>