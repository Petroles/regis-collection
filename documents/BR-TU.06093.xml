<?xml version="1.0" encoding="utf-8"?>
<add>
	<doc>
		<field name="docid">BR-TU.06093</field>
		<field name="filename">10603_ulfc104729_tm_Catarina_Rua.pdf</field>
		<field name="filetype">PDF</field>
		<field name="text">Faculdade de Ciências
Departamento de Física
Analysis in Magnetic Resonance Elastography: Study and Development of Image Processing Techniques Catarina Henriques Lopes dos Santos Rua
Dissertação
Mestrado Integrado em Engenharia Biomédica e Biofísica
Radiações em Diagnóstico e Terapia
Faculdade de Ciências
Departamento de Física
Analysis in Magnetic Resonance Elastography: Study and
Development of Image Processing Techniques
Catarina Henriques Lopes dos Santos Rua
Dissertação orientada pelos Prof. Doutores Marius Mada e
Alexandre Andrade
Mestrado Integrado em Engenharia Biomédica e Biofísica
Radiações em Diagnóstico e Terapia
Dedico a tese às minhas avós,
Carminda dos Santos e
Maria Pereira Lopes.
Valeu a pena? Tudo vale a pena
Se a alma nao é pequena.
Quem quer passar além do Bojador
Tem que passar além da dor.
Deus ao mar o perigo e o abismo deu,
Mas nele é que espelhou o céu.
Fernando Pessoa, in Mensagem
Abstract
The term “Elastography” unifies biomechanics with imaging sciences and was driven by the well-documented effectiveness of palpation as a diagnostic technique for detecting cancer and other diseases.
Notoriously, during the last decade Magnetic Resonance Elastography (MRE) has emerged as the most accurate imaging modality to non-invasively assess the rheological properties of tissue. Using a phase-contrast MRI technique together with an external mechanical actuation device, it is possible to detect propagating shear waves inside the human body. Viscoelastic properties can then be extracted by applying inversion methods to the acquired phase data. Due to the richness and significance of the data, and in spite of enduring challenges related to the complexity of the computations involved, MRE attracted strong interest and is now a thriving area of research.
The computations necessary to calculate maps of viscoelastic tissue properties are indeed substantial and are generally done on remote computers after completion of experiments. T he need for higher flexibility in large scale clinical studies led to the development, in the current project, of an automated toolbox for real time MRE data processing implemented within the scanner environment.
The most commonly used direct inversion methods, Algebraic Helmholtz Inversion (AHI) and Local Frequency Estimation, show considerable performance differences under similar initial conditions. Assumptions underlying such algorithms were studied by comparing noise sensitivity and resolution on synthetic, phantom and in vivo brain datasets.
Finally, a clinical application of the AHI approach was performed on brain and abdominal data from healthy individuals. The ensuing values of brain viscoelasticity suggest higher stiffness in white matter compared to grey matter. Preliminary results also show a pronounced age-related decrease in brain stiffness and viscosity. The liver, kidney and spleen were assessed with abdominal MRE and the results support a statistically significant higher stiffness in the spleen compared to liver and kidney.
Keywords: Magnetic Resonance Elastography, image processing, algebraic Helmholtz inversion, tissue viscoelasticity.
Resumo
A rigidez e viscosidade são das propriedades mecânicas intrínsecas dos tecidos com maior relevância fisiopatológica. Segundo as fontes conhecidas, desde 400 a.C., a palpação tem sido o método mais utilizado como primeira fonte de avaliação médica, de forma a detectar pequenas massas ou tumores em tecidos moles. No entanto, a experiência profissional do médico e a própria localização da massa têm um grande impacto na qualidade do diagnóstico efectuado.
Sabendo que o módulo de elasticidade possui uma variabilidade nos tecidos moles superior à de outras propriedades físicas, como a absorção de raios X ou o tempo de relaxamento em ressonância magnética nuclear, e que a ressonância magnética é das técnicas que, até à data, foi capaz de produzir imagens com maior qualidade e resolução espacial, surgiu uma forte motivação para unificar a biomecânica com a imagiologia por ressonância magnética.
Deste modo, a Elastografia por Ressonância Magnética (MRE, do inglês “Magnetic Resonance Elastography”) apareceu em meados d os anos 90 do século passado, permitindo avaliar e medir com um elevado grau de exactidão as propriedades reológicas dos tecidos, de modo não invasivo. Utilizando uma técnica de contraste de fase em MRI, em conjunto com um dispositivo dinâmico de oscilação mecânica, a MRE mostra um potencial muito grande para detectar a propagação de ondas mecânicas no corpo humano, com uma precisão da ordem de grandeza dos mícrons. Posteriormente à aquisição das chamadas “imagens de fase”, o processamento de imagem, através da aplicação de algoritmos de inversão, permite quantificar o comportamento reológico do meio.
Esta nova modalidade de diagnóstico deu até hoje lugar a um conjunto de estudos pré-clínicos que permitiram a investigação das condições mecânicas associadas a alterações fisiológicas e patológicas, em tecidos nos quais esta abordagem nunca tinha sido possível. Éntre esses tecidos, é de destacar o caso do cérebro, um órgão onde a palpação ou aplicação de elastrografia convencional, associada a ultrassons, é inviável devido à presença da caixa craniana. Podem-se, assim, enumerar alguns estudos empreendidos com esta técnica até hoje, de inquestionável impacto científico e clínico: a fibrose hepática, o envelhecimento do cérebro, a esclerose múltipla, a hidrocefalia e os tumores cerebrais.
Uma das áreas que actualmente atrai maior interesse consiste na correcta quantificação da viscoelasticidade a partir dos dados adquiridos no scanner. Tendo como base premissas diferentes, muitos algoritmos foram propostos para inverter a equação de ondas, calculando parâmetros relevantes a partir da simples propagação das ondas nos tecidos. Os métodos mais
intuitivos designam-se por métodos directos, sendo os mais comuns a Inversão Algébrica da equação de Helmholtz (AHI, do inglês “Algebraic Helmholtz Inversión”) e a Estimação da Frequência Local (LFE, do inglês “Local Frequency Estimation”). O primeiro tem por base uma origem matemática, realizando a inversão local em cada ponto da matriz da imagem segundo a equação de Helmholtz. A técnica de LFE, por outro lado, resolve o problema através de métodos de processamento, onde a aplicação de uma cadeia de filtros permite extrair a frequência espacial local das ondas de shear, estando esta relacionada com o módulo da elasticidade através de uma simples relação algébrica.
Neste contexto, a tese apresentada prende-se com os métodos de análise de imagem em MRE, nomeadamente tanto no estudo como no desenvolvimento de técnicas que permitem uma avaliação das propriedades dinâmicas do meio, com precisão, exactidão e flexibilidade.
Um dos problemas da baixa aplicabilidade da técnica de MRE a grandes estudos clínicos é, de facto, a falta de flexibilidade na obtenção de mapas de elasticidade . O volume de cálculos necessários para a construção desses mapas é muito grande, e por isso esses cálculos são geralmente efectuados em computadores independentes, depois de terminada a etapa da aquisição dos dados. Desta forma, o primeiro projecto consistiu no desenvolvimento de uma toolbox que permitisse o processamento de imagem em tempo real, embutido no proprio scanner. Assim, aquando da aquisição de uma experiência de elastografia, será possível obter não só a disposição espacial e intensidade da propagação das ondas mecânicas, mas também um mapa adicional correspondente à elasticidade do tecido, directamente na sala de controlo. Para este efeito, foi desenvolvido um algoritmo de reconstrução codificado num ambiente compatível com o sistema de computação de scanners da Siemens. Depois de várias fases de avaliação, desenvolvimento, debugging e validação do algoritmo, tanto offline como inline em simuladores, foram realizados testes no próprio scanner em fantomas e no cérebro de um voluntário saudável, utilizando várias frequências de oscilação. Desta forma, pôde-se verificar o sucesso global da toolbox implementada. Ainda assim, será necessária uma fase de optimização no sentido de criar uma toolbox de uso mais familiar e melhorar o algoritmo em si, corrigindo alguns problemas da versão actual.
Os dois algoritmos de reconstrução mais utilizados a nível clínico, AHI e LFE, anteriormente apresentados e contextualizados, revelam um desempenho surpreendentemente diferente , sob condições iniciais idênticas e não obstante os princípios físicos subjacentes serem semelhantes. Estas inconsistências reflectem-se numa vasta gama de valores para o módulo de elasticidade verificados na literatura. Por conseguinte, foi efectuado um estudo para testar a qualidade das reconstruções em termos de sensibilidade, resolução espacial e eficácia na reconstrução em fantomas gerados sinteticamente, onde ruído, atenuação, ondas de compressão e padrões de interferência foram adicionados a uma equação de ondas básica.
Para avaliar o desempenho dos algoritmos em dados de MRE extraídos do scanner, utilizaram-se jogos de dados obtidos com fantomas de gel sem e com inclusões de elasticidade dissemelhante entre regiões, assim como dados cerebrais de indivíduos saudáveis. Em geral, os resultados demonstram que o método LFE é mais eficaz em condições ideais, mas carece de precisão na análise de imagens sintéticas com artefactos tal como em dados reais. Isto é devido essencialmente a uma filtragem excessiva, assim como ao facto de o algoritmo não considerar a atenuação como uma premissa do modelo. Pelo contrário, os mapas obtidos pelo método AHI são mais nítidos mas são altamente susceptíveis a ruído. Mais se concluiu, que certas metodologias que antecedem a inversão são de extrema importância, destacando-se o processo de filtragem espacial. Finalmente, a medição das propriedades físicas dos fantomas através de reometria convencional permitiu verificar uma disparidade nas duas técnicas, podendo levar à conclusão de que as reconstruções obtidas em MRE são sobrestimadas. No entanto, deve ser efectuada uma análise mais profunda em condições experimentais tão idênticas quanto possível, para que se possam confirmar estes efeitos.
O método AHI foi escolhido para estudar o cérebro de nove indivíduos saudáveis com idades compreendidas entre os 19 e os 62 anos. Neste estudo foram identificadas diferenças significativas, tanto na elasticidade como na viscosidade da matéria branca e cinzenta em todos os indivíduos, constatando-se que a última é a menos rígida. Além disso, um modelo linear regressivo foi ajustado aos valores obtidos com o método AHI tendo em conta a idade do sujeito, de forma a verificar tendências relativas esta variável. Resultados preliminares evidenciam uma distribuição linear com um declive negativo indicativo de um decréscimo pronunciado da elasticidade do tecido cerebral com a idade: a percentagem de decréscimo anual previsto foi de 0,75%. Apesar de não ser estatisticamente significativo, foram ainda identificadas pequenas diferenças nas taxas de decréscimo da elasticidade e viscosidade da matéria branca e cinzenta. No entanto, os resultados obtidos fazem parte de um estudo em curso e, como tal, será necessário testar um amostra superior para confirmar os resultados mencionados, assim como métodos mais sofisticados para analisar os dados.
Por fim, realizou-se um estudo sobre as propriedades viscoelásticas de tecidos do abdómen. Sendo a sequência utilizada baseada em “Echo Planar Imaging” (EPI), as inomogeneidades do campo magnético e artefactos de ghosting são mais pronunciados na aquisição de imagem em tecidos moles no abdómen. Foi necessário assim, numa primeira fase, optimizar o protocolo de aquisição: o uso de bandas de saturação para suprimir o tecido adiposo, ajustes no ”Field of View”, o uso de técnicas de shimming e aquisição de imagem apenas durante apneia expiratória. O dispositivo que permite a distribuição de propagação das ondas nos tecidos também foi explorado, de forma a obter uma propagação uniforme com elevada amplitude ao longo da totalidade do corte. A aquisição de dados de cinco voluntários
saudáveis permitiu avaliar três tecidos com níveis de elasticidade distintos: o fígado, os rins e o baço. As principais conclusões retiradas indicam que o fígado e rins apresentam uma elasticidade menor que o baço, sob o modelo linear de tensão-deformação no qual se baseia o método AHI. Ainda assim, todo o processo de optimização está longe de se dar por concluído, pretendendo-se obter uma reprodutibilidade entre experiências com um protocolo de implementação expedito para ser possível aumentar a quantidade de dados e fazer uma análise estatística com um nível de confiança superior.
Em conclusão, a técnica de MRE mostra um enorme potencial para detectar alterações na elasticidade dos tecidos através de pequenas deformações periódicas induzidas durante a aquisição de imagem numa ressonância magnética. A tese apresentada aborda pontos importantes relativos à fase do processamento e análise de dados, contribuindo para a evolução da MRE no sentido da aceitação desta técnica em ambiente clínico. Soluções concretas para uma análise rápida a tempo real foram dadas através do desenvolvimento da toolbox. Numa outra perspectiva, foram estudados nesta tese aspectos técnicos relevantes relativos aos algoritmos de inversão, críticos para a obtenção de um processamento profundo e correcto dos dados obtidos. Por fim, os trabalhos desta tese resultaram na identificação e reconhecimento de diferenças entre a viscoelasticidade dos tecidos, medida in vivo, a um nível pré-clínico, deixa em aberto todo um conjunto de ideias para estudos inovadores na área da biomecânica aplicada ao ser humano em conjunção com imagiologia
Palavras-Chave: Elastografia por Resonância Magnética, processamento de imagem, inversão algébrica da equação de Helmholtz, viscoelasticidade dos tecidos.
Acknowledgments
A year in Cambridge with a life changing experience. This thesis reflects not only my work, but also the help and support of special people without whom this would never have been possible.
First and foremost, I would like to thank my supervisor, Dr. Marius Mada, for all the effort and guidance given, and specially for being my friend. I would not be where I am without you. A special thanks to Dr. Guy Williams, for the patience you had with my endless problems with the code. I am also grateful to my second supervisor, Dr. Alexandre Andrade, for all the insightful advice throughout the thesis.
I thank Dr. Adrian Carpenter and all the people at the WBIC for accepting me and providing a great work environment every day. I would like to acknowledge the MRE groups from Charite in Berlin and from CRIC in Edinburgh for all the help you gave us to set-up MRE at the WBIC. And to all the volunteers that spared their time to have us shake their brains and livers, a huge thank you.
A great thanks Joana for being my friend, co-worker and wonderful MRE volunteer, personal advisor, cooking buddy, travelling partner, etc etc etc. When tough times came, you still believed in me, thanks for not letting me go. Also to Rafael, our DTI geek at home, I will never forget our friendship.
A very special thanks to Carolina, Ines and Marco who make my life happier like no others can. A skype call is all it takes.
And finally, the deepest thanks to my parents and my brother. Throughout my 23 years I recognize and truly appreciate the unconditional support you gave me on so many levels. Obrigada por tudo.
Contents
Resumo..................................................................................vi
Acknowledgments..........................................................................x
Contents................................................................................xi
List of Tables.........................................................................xiv
List of Figures.........................................................................xv
List of Acronyms.....................................................................xxiii
Chapter 1.	Introduction...............................................................1
Chapter 2.	Mechanical Properties of the Living Tissue.................................4
2.1.	Introduction....................................................................4
2.2.	Stress and strain concepts......................................................5
2.3.	The constitutive equation for Hookean elastic solids............................7
2.4.	Viscoelasticity.................................................................8
2.5.	Biomechanics on a clinical setting.............................................11
2.5.1.	Motivation................................................................11
2.5.2.	Elastography Imaging......................................................12
Chapter 3.	MR Elastography: A New Quantitative Biomarker.............................15
3.1.	Introduction...................................................................15
3.2.	MRE Theory.....................................................................16
3.3.	Setup and Workflow.............................................................17
3.3.1.	Motion generation.........................................................18
3.3.2.	Wave Image Acquisition....................................................21
3.4.	Data Processing................................................................22
3.4.1.	A direct approach to solve the equation of motion in a harmonic field.....22
3.4.2.	The Algebraic Helmholtz Inversion (AHI)...................................23
3.4.3.	Other direct inversion techniques.........................................25
Chapter 4.	Development of a Toolbox for Real Time Magnetic Resonance Elastography.....27
4.1.	Introduction...................................................................27
4.1.1.	The Image Calculation Environment.........................................29
4.2.	Methods........................................................................30
4.2.1.	The AHI process coded in Matlab...........................................31
4.2.2.	C++ implementation offline................................................35
4.2.3.	The ICE wrapper for ICE_SimEnv and inline processing......................36
4.3.	Results........................................................................38
4.3.1.	C++ coding validation and comparison with Matlab..........................38
4.3.2.	ICE simulator.............................................................42
4.3.3.	In-line processing........................................................43
4.3.4.	Software run time ....................................................... 46
4.4.	Discussion ................................................................... 46
4.5.	Chapter Summary............................................................... 48
Chapter 5.	Evaluation of DI Algorithms for Elastogram Reconstruction.................49
5.1.	Introduction...................................................................49
5.2.	Methods........................................................................50
5.2.1.	AHI and LFE Methods.......................................................50
5.2.2.	Software Phantoms.........................................................51
5.2.3.	Gel phantoms..............................................................52
5.2.4.	MRE on healthy brain tissue...............................................54
5.3.	Results........................................................................55
5.3.1.	Software phantom evaluation...............................................55
5.3.2.	Real phantom evaluation...................................................62
5.3.3.	Rheometer measurements of homogeneous phantoms............................64
5.3.4.	Brain data evaluation.....................................................68
5.4.	Discussion.....................................................................70
5.5.	Chapter Summary.............................................................72
Chapter 6.	In-vivo AHI Analysis	in MRE.............................................74
6.1.	Introduction................................................................74
6.2.	Healthy Brain Study.........................................................75
6.2.1.	Methods.................................................................75
6.2.2.	Results ............................................................... 77
6.2.3.	Discussion..............................................................82
6.3.	Abdominal MRE...............................................................83
6.3.1.	Methods.................................................................84
6.3.2.	Results ............................................................... 88
6.3.3.	Discussion..............................................................96
6.4.	Chapter Summary............................................................100
Chapter 7.	Summary and Future	Work.............................................101
7.1.	Summary of the results.....................................................102
7.2.	Future Work................................................................104
Appendix.............................................................................106
References...........................................................................108
List of Tables
Table 6.1. Isotropic lower and upper threshold wavelengths used on the spatial Butterworth band pass filter for brain experiments.....................................................76
Table 6.2. Mean (standard deviation) G' and G” results obtained from the brain experiments to assess WM and GM elasticity. These values originate from a mean over all subjects.
For each subject, the mean G' &amp;amp; G” value over the 5 slices was taken............79
Table 6.3. Extracted model coefficients for brain, and white and gray matter, separately.....80
Table 6.4. Isotropic lower and upper threshold wavelengths, in mm, used on the spatial band pass filter for liver experiments................................................................85
Table 6.5. SNR values of the different phantom structures without (w/o) and with the fat bands.
(SNR=mean/std)..................................................................89
Table 6.6. Literature and present results of liver viscoelasticity using different analysis methods. 98
List of Figures
Representation of normal and shearing stresses on three sides of a cubic body.5
Figure 2.2. Patterns of deformation on different shapes................................6
Figure 2.3. Deformation of a body......................................................6
Figure 2.4. Stress-strain curves for a pure elastic material (a) and a viscoelastic material (b). The blue area is the hysteresis loop, showing the amount of energy lost in loading and unloading..........................................................................................8
Figure 2.5. Three mechanical models of viscoelastic material. (a) Maxwell body, (b) Voigt body, (c) Kelvin body (a standard linear solid) and (d) Springpot body.....................................10
Figure 3.1. Typical MRE experiment on a human brain to illustrate the different processes: motion generation, wave image acquisition and image processing. Adapted from [37].......................18
Figure 3.2. Loudspeaker systems for vibration generation in MR Elastography. (a) MR-Touch: this system has an active driver outside the magnet room and generates alternating pressures at a controlled frequency. The air is transmitted by a tube to a passive driver at the skin surface [23]. (b) Head cradle unit and mechanical wave generator to
be positioned inside the magnet room for studies in the brain [33].................19
Figure 3.3. (a) Brain and (b) liver MRE setups using the piezoelectric actuation device.........20
Figure 3.4. CAD design of the piezoelectric actuator which is mounted on the MRI bed at the patient's feet in (a) the brain and (b) liver setups. The blue arrows indicate the direction of motion..........................................................................21
Figure 3.5. Pulse sequence diagram. The trigger pulses are synchronized with the motion encoding gradient (MEG), such that the frequency and number of gradient cycles N of the MSG
is variable.....................................................................21
Figure 3.6. Configuration of the optimal gradient encoding vector G in respect to the displacement
vector u........................................................................24
Figure 4.1. MRE-Touch interface for post-acquisition processing on a General Electric (GE) MR
host computer machine...........................................................28
Figure 4.2. A simplistic version of the ICE workflow on a Siemens MR scanner.................30
Figure 4.3. Workflow of the Simulation Environment for an ICE programme. Adapted from [53]. 30
phase and (b) the final results.....................................................34
Figure 4.5. Block diagram of the MRE processing C++ code structure...............................35
Figure 4.6. A basic diagram block of the inline processing with the ICE wrapper. The MREProcess Functor includes the code that will be added to normal the image acquisition and storage pipeline..........................................................................37
Figure 4.7. (a) Raw images of six phase off-sets of the homogeneous phantom at 100 Hz excitation frequency. (b) Unwrapped images after the application of the Flynn's approach.............39
Figure 4.8. Temporal Fourier transformation technique. Image maps of f=0Hz, and the first and second harmonics after tFFT. Most of the energy is accumulated of the first harmonic................................................................................. 39
Figure 4.9. Filtering process of the AHI algorithm implemented in C++. (a) k-space of the 1st harmonic; (b) application of the k-space shift; (c) k-band of the spatial 4th order butterworth band-pass filter; (d) application of the filter in (c) to the k-space in (b); (e) result after he fftshift routine changing higher frequencies to the image limits and lower frequencies to the image centre.....................................................40
Figure 4.10. Results of filters with different low-cut (lc) and high-cut (hc) wavelengths, in mm, on the cylinder phantom excited at 200 Hz. (a) lc=10.8 &amp;amp; hc=27.7; (c) lc=6.67 &amp;amp; hc=200;
(c) lc=11.1 &amp;amp; hc=12.5; (d) lc=25.0 &amp;amp; hc=50.0..................................41
Figure 4.11. N-G Laplacian directional terms (dUdxdx on the left and dUdydy on the right) computed with the (a) matlab and (b) C++ codes............................................41
Figure 4.12. G' map before and after application of the median smoothing filter with a window of 3x3 pixels with (a) Matlab implementation (c) C code implementation.......................42
Figure 4.13. Single slice of a homogeneous phantom 1:3 (gelatine:water) excited at 200 Hz vibration frequency. (a) Unwrapped and filtered wave image at excitation frequency acquired with Matlab. (b) Matlab processed G' result; (c) G' result of the C++ code compiled on a Linux system (c) G' result obtained with the ICE simulator..................42
Figure 4.14. A two cylinder inclusion phantom with 1:1 background and 1:2 cylinder inclusion stiffnesses. Results obtained with the real time MRE toolbox acquiring coronal and transverse slices.........................................................................43
Figure 4.15. MRE Experiments on brain using the real-time processing toolbox for MR Elastography. (a) Overall view of the scanner and host computer showing three computed frequency dependent G' maps. (b) Detail of the sequence descriptions. . 44
Figure 4.17. (a) Original amplitude and phase brain data at 25 Hz and its processed G' map. Zero valued regions pointed by green arrow indicate spurious results from to the algorithm itself. (b) Amplitude and phase brain data at 37.5 Hz. Green arrow points to zero-valued regions in the real time computed G' map, showing that automatic ROI was not performed correctly. (c) Amplitude and phase of a liver scan, with corresponding colour G' map................................................................45
Figure 4.18. Estimative of the relative processing time between Matlab and the C++ codes...46
Figure 4.19. Screenshot of the MRE-EPI sequence special card to configure specific parameters for acquisition............................................................................... 48
Figure 5.1. (a) Example of a gel phantom sample used in rheometer tests; (b) ARES controlled strain rheometer; (c) BOHLIN controlled stress rheometer...................................53
Figure 5.2. Approximated imaging region of the 5 slices in the brain for planar MRE........54
Figure 5.3. Noise induction simulations. First phase offset from phantoms with (a) 10%, (b) 50% and (c) 90% Gaussian noise. Resultant G' maps are represented in the two rows below ((d)-(i)), comparing no filter, left, with the application of a pre-inversion filter on the right (low-cut wavelength = 0.0109 m)...............................................55
Figure 5.4. Spatial mean phase velocity results for the simulated software phantom at 50 Hz mechanical frequency, cp=1.45 m/s with increasing Gaussian noise corruption levels from 1 to 100%. Measurements in green and light blue result from AHI and LFE inversions, respectively, with pre-filtering: low-pass filter with low-cut wavelength of 10.9 mm. The expected result is represented by the dashed black line.......................56
Figure 5.5. Damping effects evaluation on software phantoms with wave motion at different frequencies (25.0, 37.5, 50.0, 62.5 and 75.0 Hz). Top row represents the first phase offset, the middle row shows the G' maps estimated by AHI inversion, and the bottom row shows the G' reconstructions using the LFE method. The green dashed line represents the profile direction for Figure 5.6 and Figure 5.7........................57
Figure 5.6. G'estimation along the direction of motion propagation at 5 driving frequencies (25.0,
37.5,	50.0, 62.5 and 75.0 Hz) using: (a) the AHI inversion method and (b) the LFE method. In (c) the G" profile from AHI inversion was obtained which suggests the damping effects along the direction of motion propagation..................................57
Figure 5.7. Evaluation of software phantom at 50 Hz driving frequency and phase velocity of 1.45 m/s. The phase velocity of the Gaussian envelopes were varied from 0.6 to 1.4 m/s. (a) Result of the wave propagation along the direction of motion with the application of the envelopes. (b) Profile of G' maps estimated using the AHI inversion technique.
(c) Profile of G' maps estimated using the LFE inversion technique (a close-up of the first 45 pixels is also shown in the smaller graph)..............................58
Figure 5.8. Simulation of phantoms with shear wave propagation at 50 Hz in an elastic medium (cp=1.45 m/s) with added compressional interference waves (cp=1.20 m/s; freq = 0-25
Hz). The plot shows the mean phase velocity over the FoV estimated with AHI and LFE methods. Lines in red and light blue represent results with pre-inversion high-pass filtering: filter cut-off wavelengths according to each longitudinal frequency were, respectively, 0, 0.20, 0.11, 0.07, 0.05 and 0.04 m. The expected result is represented by the discontinued black line.......................................59
Figure 5.9. Three examples of high-pass spatial filter corrections on simulated phantoms with 50
Hz wave propagation, phase velocity of 1.45 m/s, and added compressional waves with the following characteristics: (a) 25 Hz, cp=1.20 m/s; (b) 30 Hz, cp=1.20 m/s; (c)
25 Hz, cp=1.20 m/s and an additional n/4 dephasing component. Respective C'maps for AHI and LFE inversions are shown on two columns on the right.................60
Figure 5.10. Simulated software phantoms with different directional wave components. (a)-(d) show the phase images and white arrows represent the relative amplitude and direction vectors of each wave component. Example of results for (e) AHI and (f) LFE inversions from the above phase images. (g) Spatial mean phase velocity results estimated for AHI and LFE methods for each of the tested phantoms............................61
Figure 5.11. Simulated software phantom with two oblique wave components (a) and (b) (wave vectors represented in white). (c) Resulting phase offset; (d) y-axis profile of the phase offset (red) and two diagonal components (blue and green) taken in the position represented by the discontinued white line. (e) and (f) are G' results of the AHI and LFE inversions, respectively.........................................................61
Figure 5.12. 61'variations with filter type for the homogeneous phantom at 50, 100, 200, 250 and 350 Hz. Spatial mean values were obtained from an ROI covering the field of view of the phantom. Low-cut wave numbers were chosen with the following values at the 5 increasing driving frequencies, respectively: 70, 90, 150, 170 and 200 m-1...................62
Figure 5.13. Homogeneous 1:3 phantom at 200 Hz excitation frequency. (a) Top row represents the complex wave images after temporal FFT. The values on top are the high-cut wavelengths used in the spatial filter. The bottom row shows reconstructions using AHI algorithm from the respective filtered wave images. (b) SNR variations with the high-cut wavelength calculated from the reconstructed maps (SNR=mean/standard deviation)...................................................................................62
Figure 5.14. Filter variations with the type of algorithm used for reconstructions on the homogeneous phantom. lc and hc represent the lower and upper bounds, in mm, of the 4th order Butterworth band pass filter...................................................63
Figure 5.16. Spatial mean G'values determined using different computational algorithms in ROIs placed both in the background and cylinder at 100, 200, 250 and 350 Hz mechanical frequency stimulations...................................................................64
Figure 5.17. Amplitude sweeps of the homogeneous phantoms (a) 1:1, (b) 1:2 and (c) 1:3 at 10rad/s. The limit of linear viscoelastic behaviour of the samples is marked by the black dashed line on each graph..........................................................65
Figure 5.18. Viscoelastic model fits to 1:1 homogeneous phantom on rheology data. G' results are shown in blue and G'' results in red. MRE data is represented in black...................66
Figure 5.19. Springpot fits on rheometer measurements of the three types of homogeneous phantoms: (a) 1:3, (b) 1:2; (c) 1:1. G' results are shown in blue and G'' results in red, while MRE data is presented in black markers.............................................66
Figure 5.20. Viscoelastic model fits on rheology data for PDMS. G' results are in blue and G" results in red...........................................................................67
Figure 5.21. Bohlin rheometer measurements on the 1:1, 1:2, 1:3 homogeneous phantoms with springpot fit to the datasets. G'results are shown in blue and G"results in red. MRE results are also represented in black symbols. Rheometer measurements inside the black dashed line are compromised........................................................68
Figure 5.22. Rheometer stability: (a) ARES and (b) BOHLIN. The dashed lines represent the frequency band in which the performance of the rheometer is not compromised. .. 68
Figure 5.23. (a) Real part of the complex wave amplitude maps of one volunteer after temporal
Fourier transformation at the 5 driving frequencies. The images were scaled according to the factors shown on the bottom right corner. (b) and (c) represent the reconstructed maps using the AHI and LFE algorithms respectively.............69
Figure 5.24. Mean and standard deviation G' results obtained from the brain experiments using the AHI and LFE processing schemes. These values originate from an average over all subjects. For each subject, the mean G'value over the 5 slices was taken.................69
Figure 5.25. Filter variations with the type of algorithm used for reconstructions in brain. lc and hc represent the lower and upper bounds, in mm, of the 4th order Butterworth bandpass filter..............................................................................70
Figure 6.2. (a) G" estimation with AHI algorithm; (c) segmented white matter G" maps; (d) segmented grey matter G'maps..........................................................78
Figure 6.3. Average storage modulus (a) and loss modulus (b) obtained from brain MRE experiments on nine subjects at the 5 chosen frequencies. For each subject, brain excluding ventricles (blue), WM (red) and GM (green) G'and G" was measured with a 2-D inversion process for each slice. The average over all slices was taken as a global value for each subject................................................................78
Figure 6.4. Viscoelastic model fits on brain, GM and WM G' and G'measurements (a) Voigt fit; (b) Maxwell fit; (c) Zenner fit; (d) Springpot fit........................................79
Figure 6.5. Scatter plot of the G'measurements at the 5 driving frequencies for the 9 volunteers according to their age. Linear fits were plotted at each frequency and are represented by the colored lines......................................................80
Figure 6.6. Extracted Springpot coefficients of each volunteer's data according to age: (a) shear elasticity in kPa, (b) shear viscosity in Pa.s and (c) weighting factor a. A linear trend is plotted for each graph in red.........................................................81
Figure 6.7. Linear regressions on WM and GM Springpot parameters: (a) shear elasticity in kPa and (b) shear viscosity in Pa.s.......................................................81
Figure 6.8. MRE of the abdomen. (a) Model with location of the imaging region in respect to the
passive actuator. (b) Structural image slice acquired to locate the vitamin marker
which points the position of the passive actuator................................84
Figure 6.9. (a) Schematics of a transverse slice showing the location of the phantoms used the
tests. (b) Location of the five saturation bands.................................86
Figure 6.10. Schematics of acoustic actuator prototype for MR Elastography...................87
Figure 6.11. Vibration tests made with an accelerometer to three oscillation devices: the commercialized MRE-Touch device from Mayo clinic, the low quality subwoofer acoustic actuator prototype and the piezoelectric device. (a) Schematic of the measurement setups. (b) Acceleration values measured in the three spatial directions over 16 wave periods. Vibrations were induced by the devices at 50 Hz.................87
Figure 6.12. (a) Phase offsets acquired with no mechanical stimulation on the liver setup. (b) Corresponding amplitude images without and with fat saturation bands. Blue/Red
dashed squares show the location of the ROIs for SNR and CNR measurements. (c) Contrast-to-noise ratios for the different phantom structures for the three imaging slices.........................................................................88
Figure 6.13. Different imaging slices of one phase offset of a liver MRE dataset. The isocenter is located at slice number 3. Slice 5 shows difference in the liver between normal phase wrapping (blue region) and loss of signal due to ghosting (red region).....................90
Figure 6.14. (a) Liver dataset presenting ghosting problems and image distortion. Corresponding phase offset showing no delineation of liver or wave propagation. (b) Improvements of the previous acquisition: different Field of View and application of fat saturation bands......................................................................................90
Figure 6.15. Bar plot of liver MRE G'and G"results at 50, 62.5 and 75.0 Hz. Blue bars: ROIs would always include the entire liver region. Red bars: ROIs drawn only on liver region where full wave propagation was found......................................................91
Figure 6.16. Comparison between the piezoelectric and custom-built pneumatic mechanical stimulation. (a) Results obtained on an individual that was subjected two the two types of mechanical stimulation. For each frequency, wave propagation maps are shown first, and respective stiffness maps are shown on the bottom. (b) Interindividual averaged G'results of the whole liver (WL) and partial liver (PL) with both devices.............................................................................. 91
Figure 6.17. Study of heart interference waves: (a) displacement images of 8 time points; (b) magnitude, G' and G'' of the analyzed dada; (c) plots of the displacement against time of two chosen spatial points (P1 located around the blue marker, P2 in the red marker of the magnitude image).............................................................92
Figure 6.18. Abdominal MRE processing results. (a) Magnitude image with liver delineated by the discontinued white ROI. (b) Complex wave images at excitation frequency; (c) Resultant G'maps of the abdomen with delineated liver ROI..................................93
Figure 6.19. Zenner and Springpot fits from one volunteer's acquired liver MRE G'and G" results at 50, 62.5 and 75.0 Hz. ROIs drawn in liver region where full wave propagation was found..................................................................................... 93
Figure 6.20. (a) 50 Hz wave on the liver showing with full wave propagation (b) Damping at 75 Hz enables wave propagation to deeper liver regions, which we rejected from spatial mean G' and G" estimations.................................................................94
Figure 6.21. Results of a volunteer's MRE spleen experiments. (a) The spleen is marked with a green coloured ROI on the real part of the complex wave images at excitation frequency (b) G' and (c) G" results in kPa. The complex wave images were scaled according to the factors shown on the corresponding bottom right corner....................95
Figure 6.23. (a) Mean (standard deviation) obtained AHI results over all subjects from kidney analysis. For each volunteer, the spatial mean value was taken over an ROI placed on the kidney, and subsequently average G' and G" values were taken from all slices. (b) Viscoelastic fits to one volunteers G' &amp;amp; G'moduli............................................96
Figure 6.24. (a) Zenner and (b) Springpot models' averaged extracted coefficients for kidney, spleen and liver over all individuals. Error bars represent interindividual standard deviation....................................................................................99
List of Acronyms
AHI	Algebraic Helmholtz Inversion
BMI	Body Mass Index
CNR	Contrast-to-Noise Ratio
DI	Direct Inversion
DICOM	Digital Imaging and Communications in Medicine
DTI	Diffusion Tensor Imaging
EM	Electromagnetic
EPI	Echo Planar Imaging
FEA	Finite Element Analysis
FFT	Fast Fourier Transform
FSL	FMRIB Software Library
GCC	GNU Compiler Collection
GE	General Electrics
GM	Grey Matter
GRE	Gradient Echo
GUI	Graphical User Interface
GUIDE	GUI Development Environment
ICA	Independent Component Analysis
ICE	Image Calculation Environment
ICE SimEnv	ICE Simulation Environment
IDEA	Integrated Development Environment for Applications
MEG	Motion Encoding Gradient
MRE	Magnetic Resonance Elastography
MRI	Magnetic Resonance Imaging
N-G	Numerical Gradient
NIfTI	Neuroimaging Informatics Technology Institute
Pa	Pascal
PDMS	Polydimethylsiloxane
RF	Radio frequency
SD	Standard Deviation
SE-EPI	Spin Echo EPI
S-G	Savitzky and Golay
SNR	Signal-to-Noise Ratio
SP	Springpot
TE	Echo Time
TFR	Trigger Forerun
TR	Repetition Time
WBIC	Wolfson Brain Imaging Centre
WM	White Matter
Chapter 1.
Introduction
In the mid-90s of the previous century, a new imaging modality combining MRI with mechanically induced motion in tissue emerged, known as Magnetic Resonance Elastography (MRE) [1]. The low frequency propagating mechanical waves can be detected with a phasecontrast MRI technique and translated into mapping displacement patterns corresponding to harmonic shear waves with amplitudes of microns or less. The richness of the acquired data allows for local quantification of the shear modulus and generation of images that depict tissue stiffness and viscosity. Many algorithms to perform such calculations have been proposed to solve the correct inverse problem, varying on the model's assumptions or image processing methods [2].
Under certain circumstances, direct approaches to invert the wave equation have proven to be sensitive enough to detect global changes in tissue elasticity and/or viscosity [3]. As a consequence, these have been extensively used for pre-clinical MRE studies of the effect of a broad variety of physiological and pathological conditions on tissue mechanics. Most notably, the following systems have been studied:
•	hepatic fibrosis [4], [5];
•	physiologically aging brain [6], [7];
•	multiple sclerosis [8], [9];
•	normal pressure hydrocephalus [10], [11].
Within this context, the thesis focuses on image analysis for MRE. The overall aim was to develop and study image processing tools for easy and useful clinical applications in the brain and abdominal organs. It was, thus, divided into seven chapters, organized as follows:
In Chapter 1, an overview and the aims of the project are given setting the context for the work developed in the thesis.
In Chapter 2, the basis of mechanics are first addressed, namely definitions of the theoretical concepts of stress, strain and viscoelasticity in gel-like materials. The chapter ends with the description of the impact of mechanics on clinical medicine and, specifically, in the medical imaging field.
Chapter 3 describes the principles of MRE, from the methods to generate motion in tissue, to image acquisition and analysis of the data. The following direct inversion processing approaches are emphasized: Algebraic Helmholtz Inversion (AHI) and Local Frequency Estimation (LFE).
In Chapter 4, the development of an MRE toolbox that processes images directly in the scanner is presented. Four main stages were covered and explained. The first stage concerns the implementation of an AHI processing algorithm in Matlab so as to investigate a delineated simplistic automatic workflow. The second stage consists of the offline coding of the algorithm pipeline in C++ for purposes of compatibility with the MRI scanner environment. A third stage will be the implementation of the ICE wrapper, an input/ouput functionality code that will allow inline analysis. This phase was debugged with the ICE simulation system. Finally, a validation and testing stage in the MR scanner itself are described.
An extensive study on the two most common direct inversion algorithms, the AHI and LFE, is performed in Chapter 5. Synthetic simulated phantom data were created to test noise sensitivity, resolution with damping and wave interference effects of both methods in close to ideal situations. Then, tests were carried out on MRE acquired datasets from gelatine phantoms, and compared with rheology extracted viscoelastic constants. This is followed by brain MRE, for in vivo comparison of the algorithms performance.
Chapter 6 describes the extension of the AHI method to clinical experiments in order to investigate brain elasticity on healthy volunteers. White and grey matter, as well as whole brain analysis were processed and the ensuing values were parameterized for healthy individuals. The cohort group also enabled a preliminary study on aging, in which a decrease in the viscoelastic properties of brain was observed with increasing age. Further, these
methods were applied to the abdominal area. The adjusted protocol from brain to liver was studied in order to have a good quality of data and obtain reproducible results across acquisitions. Consistent rheological measurements of liver, spleen and kidneys could be derived from healthy volunteers.
Finally, Chapter 7 summarizes all of the important findings and achievements of the current study and leaves some suggestions for future research.
Chapter 2.
Mechanical Properties of the Living
Tissue
2.1.	Introduction
Biomechanics is a science that seeks to understand the mechanics of living systems. Although extensively scrutinized over the past centuries, it is still considered a very modern subject. As early as 1638, Galileo introduced “mechanics” as a subtitle to his book “Two New Sciences”, where he described the force, motion and strength of materials. It has since been applied to countless fields of studies, such as material sciences or biological sciences. A comprehensive review of this field is out of the scope of this work, but some basic concepts and definitions directly related to elastic imaging were considered.
2.2.	Stress and strain concepts
The concept of stress is generally related to the interaction of a material in one part of the body to another [1], [2]. If, for example, a force Fwas to act on a cross-sectional area A of a tendon, the stress applied would be:
o = F/A
(2.1)
The basic unit of stress will be newtons per square meter (N/m2) or Pascal (Pa) (1MPa = 1N/mm2). Thus, only the force relative to the size is important, not the absolute size of the specimen.
Figure 2.1. (a) The stress principle demonstrated on a body B with random form. The section AS is exerting a positive force, AF, on the negative side of the normal v. (b) Representation of normal and shearing stresses on three sides of a cubic body.
Considering a continuum material B occupying a spatial region (Figure 2.1 (a)), one can define the stress components in every spatial direction. Assuming that dS is as small as possible, a new vector, T designated as stress vector can be expressed as the force per unit area acting on the surface: Tv = dF /dS) Replacing the surface S by a cube it is possible to define a stress tensor having three normal components T11, T22, T33, called the normal stresses, and other components called the shearing stresses denoted as T12, T13, etc (Figure 2.1 (b)).
1	The superscript indicates the direction of the normal v of the surface AS.
Figure 2.2. Patterns of deformation on different shapes.
On the other hand, the deformation that a solid can experience related to its stress is designated as strain (Figure 2.2). In order to quantify this deformation, we can take a string of an initial length Lo. The following dimensionless ratios can define strain measures:
L-Lo
(2.2)
The selection of proper strain measure is dictated by the stress-strain relationship (i.e. the constitutive equation of the material). It was found that for most of the engineering materials subjected to an infinitesimal strain in uniaxial stretching, the relation:
o = Ee,
(2.3)
called Hooke’s law, is valid within a certain range of stresses, where E is a constant designated Young’s modulus. Again, if we were to consider the deformations that most of nature’s bodies experience, they would need to be addressed in a more complex manner. When a body is deformed each of its particles takes up a new position in space.
Figure 2.3. Deformation of a body.
As seen in Figure 2.3, the vector u is called the displacement vector of a particle that underwent deformation. If this displacement vector is known for every particle in the body, we can construct the deformed body from the original and calculate its strain tensor. The infinitesimal strain tensor, also known as Cauchy’s tensor, £¡¡, is written as2:
1/duj duA
£iJ = 2\dxX'i+Ihcj)	(2.4)
2.3.	The constitutive equation for Hookean elastic solids
Generally, for most materials, one of three stress-strain relationships, namely, the nonviscous fluid3, the Newtonian viscous fluid4 and the Hookean elastic solid, give a good description of their mechanical properties. Due to its interest in the following sections, the Hookean elastic property will be thoroughly described.
The Hookean elastic solid is a solid that obeys Hooke’s law, which states that the stress tensor is linearly proportional to the strain tensor, i.e.:
(2.5)
where is the stress tensor, is the strain tensor, and is a tensor of elastic constants, or moduli, evidently independent of stress or strain. This tensor, in the most general form, is composed of complex relationships between the moduli that can be greatly reduced when considering a material to be isotropic5. Thus, an isotropic material has exactly two independent elastic constants p and called the Lame constants. Hooke’s law will then state:
aij = Peaa3ij + Pe ¡j
(2.6)
where describes only the normal components of the stress tensor. The second Lame constant, p, is identified as the shear modulus. Writing this equation for e¡-:
2	In this thesis the Einstein notation or also called Einstein summation convention was adopted.
3	A Nonviscous fluid in one for which the stress tensor is of the form: oy = — p3— p is the scalar pressure and 3tj is the Kronecker data.
4	A Newtonian viscous fluid is a fluid for which the shear stress is linearly proportional to the strain rate.
5	When the constitutive equation is isotropic, the array of elastic constants ; remains unchanged with respect to rotation and reflection of coordinates.
1 + v v
(2.7)
The constants Eand v are related to the Lame constants	and p.. (Eis Young’s modulus
and v is Poisson’s ratio6) For isotropic materials their relationship is defined through the following equation:
E = 2 G ( 1 + v)
(2.8)
The last fundamental elastic constant, which relates the change of volume to external stress, is the bulk modulus of elasticity, K[3]. The compressibility, k, is the reciprocal of the bulk modulus. For a homogeneous, isotropic material the bulk modulus is:
E
3(1 - 2u)
(2.9)
2.4.	Viscoelasticity
The responses of most materials inside or outside the body have a temporal dependency, to some degree. This very important type of mechanical behaviour is called viscoelasticity.
Materials with such property exhibit both viscous and elastic characteristics when undergoing
deformation [4].
When a material is subjected to a constant strain, the induced stress decreases with time. This phenomenon is called stress relaxation. If the body is suddenly stressed and the stress is maintained constant afterwards, the body continues to deform - creep. If the body undergoes cyclic loading, the stress-strain relationship from the loading process is different from the unloading process - hysteresis. The creep and hysteresis concepts characterize a viscoelastic body (Figure 2.4).
(a)
/
/
/
✓
/
/
Figure 2.4. Stress-strain curves for a pure elastic material (a) and a viscoelastic material (b). The blue area is the hysteresis loop, showing the amount of energy lost in loading and unloading.
Ratio of transverse contraction per unit width divided by longitudinal extension per unit length.
These phenomena occur only if the materials are linear in its response, i.e., the stress in a sheared body is taken to be proportional to the amount of shear. For a Hookean body, the strain-stress relation is linear as seen in equation (2.5).
Studying these properties on viscoelastic materials is only possible with dynamic mechanical analysis: the stress (or strain) resulting from a sinusoidal strain (or stress) is measured. When a viscoelastic material is submitted to a sinusoidally varying stress, a steady state will eventually be reached in which the resulting strain is also sinusoidal, having the same angular frequency but retarded in phase, 8.
Consequently, it should be noticed that purely elastic materials have stress and strain in phase. On the other hand, for pure viscous materials, strain lags stress by a 90° phase lag. Viscoelastic materials exhibit behaviour somewhere in the middle.
Similar to reactive electrical circuitry, it is convenient to write the stress function as a complex quantity, , designated as the complex shear modulus, where two dynamic moduli are defined:
G* = G' + tG"
(2.10)
G' is designated as the storage modulus, or the ratio of the in-phase stress to the strain, and the G'' is called the loss modulus, or the ratio of the out-of-phase stress to the strain:7
G' = — cos8 £o
(2.11)
G" = —sin8 £o
(2.12)
Many mechanical models have been proposed and are often used to discuss these viscoelastic properties, making use of linear springs and dashpots: the Maxwell model, the Voigt model, the Zenner model (also known as the standard linear solid) and the Springpot (SP) model [5].
7&amp;lt;r0 and e0 are the amplitudes of stress and strain.
(a) Maxwell body	(c) Zenner body
0
n	M		1		wwv
1			WM	 —		Mz	
		Mamv-		
(b) Voigt body
Figure 2.5. Three mechanical models of viscoelastic material. (a) Maxwell body, (b) Voigt body, (c) Kelvin body
n
P
(a standard linear solid) and (d) Springpot body.
While a perfect harmonic elastic behaviour can be modelled by a spring, with spring constant ^, a perfectly viscous behaviour can be modelled by a dashpot, with coefficient of viscosity ^. A linear spring is supposed to produce instantaneously a deformation proportional to the load, and a dashpot should produce a velocity proportional to the load, at any instant. Therefore, the force Facting on a spring is: F = pu, where u is its extension. In a similar way, if the force F acts on a dashpot, it will produce a velocity deflection u: F = ^u.
In the case of a Maxwell body Figure 2.5 (a), the spring is placed in series with the dashpot, and their compliances are additive. If we assume that the velocity of the spring extension is F/u, the total velocity with the two components is: u = F/Ju + F/^. For the Maxwell solid, the sudden application of a load induces an immediate deflection by the elastic spring which is followed by “creep” of the dashpot. For the Voigt model (Figure 2.5 (b)), the spring and the dashpot have the same displacement. If the displacement is u, the total force F should be: F = ^.u + ^u. Models like the Zenner and Springpot have in comparison more ambitious and complex designs.
In the hierarchical structure of the Springpot model, one can find springs (with spring constants ^0, Mi, •••) and dashpots (with viscosities ^0,	•••) organized sequentially. A
constant a with 0 &amp;lt;a &amp;lt;1 is necessary, so that equation (2.6) is true for the determined structural constants, and 1] [6]. The Springpot can precisely be reduced to a spring, and to a dashpot for and , respectively.
The governing equations for the stated designs in Figure 2.5 when steady-state sinusoidal loading is applied relate the complex shear modulus with the Lame constants:
Maxwell: G * ( a ) =
11	+ lMT]
Voigt: G* (a) =	+ icaij
(2.13)
(2.14)
^2 + i a
(2.15)
Springpot: G* (a ) = k 1 - a (ia ) a k1 - a = p.1 - a if
(2.16)
In modelling a material, despite generally giving the best solutions, complex designs are not always preferred since they can sometimes diverge or even converge to erroneous constants. Also, it is important to point out that almost all real materials have a more heterogeneous behaviour than the stated principles. For example, one way or another, virtually every known solid material can be broken or tare under sufficiently large stresses or strains, and the breaking/tarring property clearly disobeys Hooke’s law. Also, for large finite deformations (as for example, a soft tissue under deformation) the linear viscoelastic equations are not applicable since the non-linear region is reached [2]. Until just a decade ago, the constitutive equations for most biological tissues were unknown. This lack of knowledge was the most significant handicap to the development of biomechanics, because without constitutive equations boundary problems cannot be formulated, detailed analysis cannot be made, and predictions cannot be tested and evaluated.
However, surprisingly for some soft biological tissues, such the liver or brain, simplifications can be made. Many researchers have chosen to model the elastic properties of the soft tissue as linear, isotropic and with a Hookean behaviour (for example [7], [8]). In the scope of this work the same reasoning was considered, since it implies a great simplification in the moduli estimates.
2.5.	Biomechanics on a clinical setting
2.5.1.	Motivation
From a clinical point of view, abnormalities in the stiffness or mechanical environment in tissue may have profound impact on how a disease progresses. Over the past centuries, tissue elasticity of the human organs was considered a very important physiopathological marker. With a simple palpation technique, physicians detected a variety of masses, mainly tumours in
soft tissues of the human body. However, the physicians’ clinical ex perience and the location of the mass had a major effect on the success of the diagnosis. For instance, a brain mass is not viable to palpation unless during a surgical environment. Yet, most of the times clinicians need to know the tumour’s elastic properties to have a better procedure plan bef orehand.
The recognition of the potential diagnostic value of characterizing mechanical properties has led to the development of imaging methods to describe tissue elasticity.
2.5.2.	Elastography Imaging
In material science, the conventional measurement method requires to cut off a piece of material from the body and, by directly applying a known stress or strain, one could calculate the respective force (strain or stress). This is an expanding field of science designated as rheometry testing. In a clinical field, the in vitro quantification of stiffness is made in a similar way, where rheometers are also used for the purpose, generally producing very reliable results [9-12].
However, in non-invasive imaging, the term elastography was first suggested by Ophir et al. in the early 1990s [13], but the studies that perhaps prompt this work were carried out long before in the 1950s by Oestreicher and his colleagues [14], [15]. They studied the human tissue properties subjected to sound fields and mechanical vibrations, and showed how the constants of elasticity and viscosity maybe estimated from impedance measurements carried out on the body surface. By using a strobe light and photography they acquired surface wave propagation patterns, obtaining the wavelength and wave speed.
Since then, the elastography concept has established itself as a quantitative and qualitative technique to map tissue elasticity. Various modalities such as ultrasound, MRI or optics, have been adapted to be capable of measuring elastic properties by employing different tissue excitations and extracting different parameters of tissue motion.
Even so, much of the pioneering and important work in elasticity imaging has been accomplished using ultrasound based techniques, applying a static, a quasi-static, a dynamic stress or a transient method [16].
Ophir et al. (1991) [13] introduced static elastography which was then applied to breast and prostate in vivo. However, the use of this technique is limited by high sensitivity to boundary conditions that would certainly induce artefacts in the elastogram, when applied to organs such as the liver that cannot be placed under controlled compression in vivo.
The quasi-static elastography technique requires the application of a small compression in the tissue with an ultrasound transducer. However, the key element of the system is in its algorithm. Anatomical displacement in the axial direction is calculated everywhere in the
ultrasound image by optimizing similarity measures between pre- and post-deformation data. This is followed by a gradient estimation in order to generate axial strain. Filtering is essential, since differentiating consecutive samples amplifies the high-frequency components of the measurement noise. As the formation of an elastogram only requires two frames of ultrasound data (one before and one after axial deformation of the tissue) local strain will depend on the magnitude of compression and on the elastic modulus of the material. To avoid this dependency, one common approach to this problem is to create elastograms between pairs of frames and then select the ‘best’ pair, either manually or with the use of quality metrics. Many groups have focused on this field [17-19] and there are even some commercial systems available such as eSieTouch (Siemens Healthcare, http://www.medical.siemens.com), ElastoQ (Toshiba Medical Systems, http://www.medical.toshiba.com), Elastoscan (Medison, http://www.medison.com) and Elastography (GE Healthcare, http://www.geheathcare.com and Philips Heathcare, http://www.healthcare.philips.com).
One of the first dynamic elastography imaging or sonoelasticity imaging procedures, called vibration amplitude sonoelastography, was presented by Lerner and Parker in 1987 [16]. They employed a low frequency8 vibrational mechanical stress, typically in the range of 20-1000 Hz, to excite internal vibrations within the tissue under inspection. Tissue is imaged with Doppler Ultrasonography to observe the regional amplitude of the resulting standing wave pattern. A stiff homogeneity inside surrounding soft tissue will produce a disturbance in the amplitude of the wave pattern. Another dynamic technique, Vibration phase gradient sonoelastography, was developed in the 1980s by Yamakoshi and Sato [20]. Their technique maps both the amplitude and the phase of low-frequency wave propagation inside tissue, and from these maps the wave propagation velocity and dispersion properties are derived. These parameters are directly linked to the elastic and viscous characteristics of tissue.
Finally, transient elastography started as 1-D only, which was not intended to produce elasticity images because data was collected on the axis of a single-element transducer. The time resolved 2-D transient elastography requires the use of ultrafast ultrasonic imaging - up to 10,000 frames/s managed by a linear array of transducers connected to electronics that have 64 channels sampled at 30 MHz [21]. The displacement measurements are induced by the LF propagation (50 to 200 Hz) of pulsed shear waves in a 2-D area, and can be measured using cross-correlation of the ultrasonic signals. This technique is less sensitive to boundary conditions and has the shortest acquisition time (typically less than 100 ms), which enables measurements to be made on moving organs such as the liver.
8 The low frequency modes are preferred, as they are the easiest to excite and the easiest to interpret.
Many of the above methods assume boundary conditions and complex models for processing which might not give accurate quantitative measures of the elastic properties. Longitudinal mechanical waves are limited by the long wavelength (on the order of meters) of such wave. Also, they are highly restricted by physical limitations of the acoustic window, which might not reach the tissue of interest. Moreover, none of the above mentioned methods measure the three-dimensional strain effects within materials. Also as a final remark, elasticity moduli measured by these conventional imaging techniques are known to have a very small range of values, whilst for shear modulus, measured by magnetic resonance elastography, these are more scattered [3].
Chapter 3.
MR Elastography: A New Quantitative
Biomarker
3.1.	Introduction
Magnetic Resonance Elastography (MRE) emerged recently as an alternative to the Ultrasonography technique s and other conventional elasticity measuring methods, imaging the tissue’s mechanical properties non -invasively with a greater spatial resolution. It combines one of the most powerful tools in medical imaging - Magnetic Resonance Imaging (MRI) -with underlying biomechanics, by applying frequency controlled mechanical vibrations whilst acquiring MRI data in a tissue of interest. The primary objective is to spatially map and quantify displacement patterns corresponding to harmonic mechanical waves with amplitudes
of 1 pm or less in tissue, using the phase of transverse magnetization in a magnetic resonance environment.
A group from Mayo Clinic led by Richard Ehman described this technique for the first time in 1995 [22]. Since then, it has experienced a great level of expansion, not only in terms of technical development to improve measurements, but also into pre-clinical and clinical research. Nowadays, solid studies are already carried out in liver [23-25], heart [26], [27], muscle [28], and even brain [29-34], where manual palpation is restricted.
3.2.	MRE Theory
From the basic theory of MRI, it is known that in the presence of a magnetic field gradient, a phase shift p is induced in the motion of nuclear spins in an NMR signal given by:
(3.1)
where Gr ( t) is the time-dependent magnetic field gradient, r ( t) is the position vector of a moving spin, y is the gyromagnetic ratio characteristic of the nuclear spin under investigation and t is the time duration of the gradients after excitation [35]. Equation (3.1) shows the important relationship that exists between the observed phase shift in the NMR signal and both the gradient and position vectors.
Considering simple linear motion, the position vector is given by r ( t) = r0-s¡-vot where r0 and v 0 are the position and velocity at time t = 0 . However, if the duration of motion is comparable to or smaller than the echo time (TE) or if the trajectory of the position vector is more complicated than the linear movement, other generalizations may be more appropriate. In case of complex motion, the spins will follow this general equation:
r ( t) = r o + -T (r,t) .
(3.2)
((r, t) is the displacement of the spin about its mean position (represented by r0). Now, if a strain wave propagates in the continuum, the position vector may be a pure sinusoid and, therefore, re-writing equation (3.2):
r ( t) = r o + £0 e XP0 (k • r - ot + a))
(3.3)
co is the angular frequency of the harmonic mechanical excitation causing the strain wave, a is the initial phase offset between the mechanical excitation and the gradient waveform, k is the wave number, is the peak displacement of the spin from its mean position.
If the gradient were to be represented by a sinusoidal function switched in polarity at the same frequency as the mechanical vibration (and, thus, the position vector), the magnitude of this gradient could be described by:
(G0cos(a&gt;ty, t e [0, NT]
Gr ( t) = {
I 0;	otherwise
(3.4)
where N is the number of gradient cycles, T = 2 tt/o, Gr is the gradient vector. Substituting equations (3.3) and (3.4) into equation (3.1) and manipulating the integral, the resulting phase shift is:
0(r,a) =
yNT(G0 ■ f0)
2
cos(k ■ r + a).
(3.5)
Very important deductions can be promptly made from equation (3.5). The phase shift is proportional to the scalar product of the displacement vector and the gradient vector and to the period, to the number of gradient cycles and to the phase offset [35]. The high sensitivity to small cyclic displacement in this particular elastography technique (shear waves with displacements of less than 100 nanometers can be observed [22]) comes directly from the proportionality between the phase shift and the number of gradient cycles, as there is a constructive accumulation of phase shifts over multiple cycles of mechanical excitation and gradient waveforms.
Another relevant aspect to point out in equation (3.5) is related to the scalar products. This indicates that components of the displacement vector along any desired axis can be estimated. Note that the maximum value of the scalar product operation presents itself whenever the vectors are parallel to each other, i.e., particles whose component of motion along the gradient vector are exactly in phase or out of phase with the magnetic oscillation and, thus, have maximum phase shifts.
3.3.	Setup and Workflow
The MR Elastography technology has different designs and characteristics that will be here analysed [36]. The three basic components in an MRE experiment are [37]:
•	motion generation, where shear waves with frequencies ranging from 10-400 Hz are induced in the tissue using an external driver;
•	wave image acquisition, where the MR protocol is chosen to fit and acquire phase image displacement maps;
•	data processing, to generate quantitative images displaying the stiffness of tissue.
Data Processing Wave Data Acquisition Motion Generation
Phase contrast MRI sequence
25 Hz 37.5 Hz 50 Hz 62.5 Hz 75 Hz
Figure 3.1. Typical MRE experiment on a human brain to illustrate the different processes: motion generation,
wave image acquisition and image processing. Adapted from [37].
3.3.1.	Motion generation
The mechanical vibration apparatus is a controversial subject among researchers [38].
MRE devices with pneumatic actuation methods can be found in the literature [33], [39], [40]
because of the good MR compatibility and relatively simple and inexpensive design. In the design of Ehman et al. (2006) [39], a commercial loudspeaker for vibration generation is placed outside the scanner room to avoid any electromagnetic (EM) interference and a passive driver is placed on top of the patient body, as shown in Figure 3.2 (a). The speaker emits the mechanical vibrations that are transmitted via a pneumatic tube to the end effector. This type of setup allows all the magnetic components and electronics that control the system to be placed outside the magnet room, while having effective displacements delivered by the MR-compatible drum onto the tissue. However, one of the main problems with this arrangement is the phase lag in the mechanical motion and subsequent difficulty in synchronization control. This issue precludes the use of pneumatic actuators with frequencies higher than 100 Hz. Nonetheless, this type of design has improved over the years, and is now commercially available as the package MR-Touch for GE systems (found in: http://www.gehealthcare.com/ euen/mri/products/MR-Touch/index.html).
Figure 3.2. Loudspeaker systems for vibration generation in MR Elastography. (a) MR-Touch: this system has an active driver outside the magnet room and generates alternating pressures at a controlled frequency. The air is transmitted by a tube to a passive driver at the skin surface [23]. (b) Head cradle unit and mechanical wave generator to be positioned inside the magnet room for studies in the brain [33].
The device based on the loudspeaker for brain MR Elastography has a slight different design [33] (Figure 3.2 (b)). A flexible joint mounted in the centre of the loudspeaker membrane was coupled via a telescopic carbon fibre rod of variable length (2-3 m) to a pin joint on top of a head cradle. The head cradle enables maximum deflection amplitudes on the head surface of 0.3-0.5 mm. The disadvantages to this design are clear: the loudspeaker and the control electronics need to be placed in the scanner room (although far from the isocentre), leading to a certain amount of signal-to-noise ratio (SNR) degradation and potentially inducing attractive forces or torques and EM interference.
A novel approach of actuation was created using piezoelectric material9. Uffmann et al. [41] developed a piezo-actuation device capable of operating at an excitation frequency of up to 500 Hz and a peak-to-peak amplitude up to 1 mm. A piezoelectric stack generates a maximum of 200 pm displacement that can be amplified with a lever mechanism (motion amplification of 1:5). As a high-voltage signal of a few hundred volts is required for the piezostack, the device is coupled to a signal amplifier linked to a PC synchronized with the image sequence. This design has a fast frequency response, high accuracy, and simple calibration, allowing stable and controllable mechanical excitation. However, its huge cost and complex design make the product sometimes less attractive to researchers. Also, EM interference effects might corrupt the ensuing images.
Figure 3.3. (a) Brain and (b) liver MRE setups using the piezoelectric actuation device.
A version of rigid rod-to-cradle system for brain measurements was developed for the piezoelectric system (Figure 3.3 (a)). The piezoceramic actuator and the lever are mounted into a structure at the patient’s feet and a carbon fibre transmission rod transmits the mechanical excitation signal to the head cradle mounted inside the radio-frequency (RF) coil. Alternatively, the piezoelectric actuator can be easily adapted for liver experiments ( Figure 3.3 (b)). Switching the direction of the generated motion from horizontal (Figure 3.4 (a)) to vertical (Figure 3.4 (b)), one end of a wooden rod is secured to the piezo and the other end is simply placed on the patient’s abdomen. This setup generates the tapping motion similar to the MR-Touch device previously described; however, its wave generation source is very different.
9	Piezoelectric crystals are used to convert electrical energy to mechanical motion, and vice-versa. They expand if a certain voltage is applied.
Figure 3.4. CAD design of the piezoelectric actuator which is mounted on the MRI bed at the patient’s feet in (a)
the brain and (b) liver setups. The blue arrows indicate the direction of motion.
3.3.2.	Wave Image Acquisition
The pulse sequence used in MRE undergoes slight changes from a standard sequence, such as the normal Echo Planar Imaging (EPI). As seen in Figure 3.5, a new gradient, called motion-encoding gradient (MEG), incorporating harmonic motion waveforms (sinusoidal or trapezoidal) is imposed along a specific direction, switched in polarity at some adjustable frequency. Trigger pulses synchronize the wave generator and amplifier unit that drive the mechanical actuator, inducing shear waves at exactly the same frequency as the motion -encoding gradient. Any cyclic motion of the spins in the presence of the MEGs causes a measurable phase shift in the received MR signal, building up a 2-D displacement map.
Figure 3.5. Pulse sequence diagram. The trigger pulses are synchronized with the motion encoding gradient (MEG), such that the frequency and number of gradient cycles N of the MSG is variable.
The MEG is usually applied collinear with the direction of motion and perpendicular to the direction of initial wave propagation. A 2-D acquisition captures only two of the three components of the wave propagation vector, and may result in misleading calculations on the image post-processing. 3-D MRE pulse sequences have also been developed [7], [42-44] and are increasingly being used.
3.4.	Data Processing
The third and final step of the MRE procedure is the application of an algorithm which processes the data in order to solve appropriately the inverse problem i.e., estimating the mechanical properties using the MRI measured displacements [45]. Obtaining stiffness from these measurements requires a reconstruction process similar to the inverse scattering methods. Inverse scattering problems deal with detection and identification of unknown objects through the use of acoustic, electromagnetic or elastic waves [46].
Two general approaches to stiffness estimation were developed using the displacement measurements: static and dynamic. The former method images the tissue before and after the application of a known stress load. Tissue strain estimated from these measurements is used to estimate relative tissue stiffness. The absolute values require the knowledge of the material -property boundary conditions, which sometimes is a strong source of bias.
Dynamic MR Elastography re-interprets the phase-difference time series, reconstructing the absolute displacement directly. Thus, an absolute estimate of the elastic parameters can be obtained just based on local knowledge of displacement and its temporal and spatial derivatives.
A variety of approaches can be used to invert the displacement data to recover mechanical properties [47]. The most common use a direct inversion technique [7], [8], [48], but certain assumptions and simplifications of the wave equation need to be made. More robust algorithms use iterative processes such as Finite Element Analysis (FEA) as a tool for inverting the wave equ ation. Van Houten’s group [49] created a 3-D reconstruction process capable of discerning elastic properties in the presence of motion, but this is still a project under development since the long computation times are a problem. Yet, the main focus of the remainder of the chapter and of the present work will be direct techniques to invert the wave equation, thus the theory will be thoroughly described next.
3.4.1.	A direct approach to solve the equation of motion in a harmonic field
The major goal of elastography is to make a useful characterization of the constitutive relationship between the stress tensor T and material displacement [50]. One can assume linearity between these two quantities since the displacement measurements are very small (in the order of microns). In a linear model, stress and strain are related by a rank 4 tensor with
up to 36 independent quantities as was already described by equation (2.5). If assuming isotropicity, this equation simplifies greatly into only two independent quantities, the Lame constants A and p, equation (2.6). The strain tensor, e-, can be defined in terms of the displacement tensor,
eij — d" uj,i)/2
(3.6)
where indices after comma indicate differentiation. In the absence of body forces10, the general equation of a harmonic motion of the displacement field is then given by:
[Au—], i + [p(n ij + rq- ¿)]^. —
—p&lt;Jt)2Ui
(3.7)
where is the density of the medium and the angular frequency of the sinusoidal motion. The most general solution of this equation requires prior knowledge of the full 3-D displacement field, since equations for the individual components are coupled [7]. However, further assuming local homogeneity of the medium, A and p become independent of the position vector, and equation (3.7) simplifies into:
pV2u + (A + p) V ( V • u) — — pm2 u
(3.8)
Since for MR Elastography the main source of motion are propagating shear waves, it can be further assumed that the displacements due to the longitudinal components vary slowly and thus are negligible. This corresponds to approximating A (V • u) to zero. The equation simplifies to a single vector equation in p, but still the 3-D vector field is required.
[V (V • u) V2 u] p — —pm2 u
(3.9)
Assuming incompressibility (which mathematically means	) the Helmholtz
equation is obtained:
[V2 u] p — —pm2 u
(3.10)
3.4.2.	The Algebraic Helmholtz Inversion (AHI)
Equation (3.10) expresses a purely 2-D inversion problem, in which only measurements of the through-plane shear mode are required. If the medium is viscoelastic, the Lame constants will appear in complex form, denoted as 6*, having a real part (G') corresponding to
10	A body force, also designated normal force, is a force that acts throughout the volume of a body, and opposes contact forces.
the viscoelasticity fraction and an imaginary part (G'') corresponding to the attenuation fraction. Thus, if we define U(r,m) to be the Fourier transformation of the time series collected with motion encoding in the through-plane or direction of motion (Figure 3.6), the complex modulus can be readily determining by solving equation (3.10):
G*(r, m) = — pa&gt;2
U (r, oj)
V2U(r,M)
(3.11)
where r is the 2-D position vector, m is the angular mechanical frequency, and p is the density of the material (usually assumed as 1000 kg/m3) [8].
Figure 3.6. Configuration of the optimal gradient encoding vector G in respect to the displacement vector u.
Thus, in the Algebraic Helmholtz Inversion method, the temporal Fourier transformation is applied to the acquired phase series, from where the volume at the harmonic frequency can be extracted. A spatial band-pass filter is usually subsequently applied to suppress noise and any longitudinal wave components. Finally, by estimating the Laplacian terms of equation (3.11), and solving the algebraic relationship one can determine the storage and loss modulus of the medium on a pixel-by-pixel basis. G'p and G'p defined respectively as the real and imaginary parts of G*/p , can be used to compute shear wave speed and attenuation with the formulas:
2(g;2 + g;2)

g'+I g'2 + g''2
(3.12)
2(g;2 + g;2)
/(") =
N
(3.13)
Even so, these relationships above provide the same information as the storage and loss modulus themselves, hence the following chapters will be usually reported in the original quantities: G' and G''.
3.4.3.	Other direct inversion techniques
A variety of approaches can be used to directly invert the displacement data and recover mechanical properties. It was seen that the AHI method treats the data as complex, calculating both elasticity and viscosity related moduli. Nevertheless, some processing techniques like the Local Frequency Estimation (LFE) or phase gradient calculate only the local wavelength and do not tackle attenuation.
Local Frequency Estimation. The LFE algorithm is based on Knutsson's work published in 1994 [51]. In an attempt to analyse non-stationary signals in a frequency-like manner, the concept of instantaneous frequency is introduced and defined as the rate of change in phase of the analytical signal. Instantaneous frequency is a global entity in the sense that the local alteration of the signal will affect the instantaneous frequency everywhere. Also, Knutsson found that an isotropic estimate of signal strength, that is local both spatially and in the frequency domain, is obtained by summing the magnitudes of the outputs of orthogonally oriented lognormal filters11. Thus, the LFE algorithm involves estimating the frequency locally by combining outputs from two or more sets of filters applied directly to the phase data. The shear stiffness, in Pa, is then = p f-mech /fsp with the assumption that p = for all soft tissues.
Phase Gradient. The Phase Gradient method is a simple technique that assumes propagation of a single shear wave [50]. Thus, after extracting the harmonic component at the driving frequency, the gradient of its phase component is estimated. On an ideal situation this analysis can have very high resolution. However, it is very sensitive to noise, and yields inaccurate
11	The lognormal filter is a quadrature filter with a radial frequency function which is Gaussian on a logarithmic scale.
results when two or more waves are superimposed as it is the case of reflected waves or when the motion is complex [52].
Many other algorithms were created in the attempt to seek the best solution to deduce quantitatively accurate values of the tissue properties, such as shear modulus, in favourable situations. In general, however, in spite of the data and the variety of processing techniques, the extraction of accurate results from the intrinsically noisy data at high resolution in complex, heterogeneous objects remains a challenge.
Chapter 4.
Development of a Toolbox for Real
Time Magnetic Resonance
Elastography
4.1.	Introduction
In MRE, substantial computation is needed to calculate maps of viscoelastic tissue from primary phase images. This is generally done on remote computers after completion of experiments. Inherent problems of this approach are (i) inability to instantly assess the quality of primary data used for calculation of viscoelastic parameters and (ii) complexity, time consumption and high degree of interaction by the user.
In order to address these issues affecting data quality and applicability to large scale clinical studies, highly automated real time processing of MRE data functioning directly during scanning would be ideal. The MR-Touch package developed by Mayo Clinic comes
with an integrated software routinely used for post-acquisition processing (Figure 4.1). However, one of its major disadvantages is that it is not executed on a real-time basis, preventing an instant evaluation of the quality of the acquired results.
Figure 4.1. MRE-Touch interface for post-acquisition processing on a General Electric (GE) MR host computer machine.
The present chapter concerns the development of an MRE toolbox prototype to be fully integrated on MRI scanners. Ultimately, the key features that such software could provide would be:
•	real time calculation of viscoelastic parameters on the scanner;
•	immediate estimation of the quality of MRE related data;
•	direct control of the impact of MRE acquisition parameters on calculated maps of viscoelastic parameters;
•	error detection and correction of MRE parameters during the experiment;
•	workflow accustomed to clinical settings;
•	user interaction reduced to a minimum;
•	no data transfer to remote computers;
•	reduced number of errors.
Due to the research infrastructure of the Wolfson Brain Imaging Centre (WBIC) at the Addenbrooke’s hospital, Cambridge, United Kingdom, where the toolbox would firstly be tested, Siemens MR scanners were the target medical imaging systems. For these scanners integrated development environments are provided for programming pulse sequences
(Integrated Development Environment for Applications, IDEA) and image calculation (Image Calculation Environment, ICE).
4.1.1.	The Image Calculation Environment
The ICE, or Image Calculation Environment, is an integral part of all measurement related operations on a syngo®MR operating system, covering the processes and programs of the imaging computer related to data acquisition and image calculation and reconstruction [53].
Since it uses a MS Visual C++ compiler, all developed calculation/reconstruction programs must be coded in C/C++ language. Basic functionalities for image reconstruction can be found in the ICE Library, such as image subtraction, FFT calculation, etc.
Within the newer versions, the ICE framework is divided into two parts: (i) Configuration of image reconstruction pipeline on the Host (Spice pipeline) and (ii) execution of the image reconstruction pipeline on the Imager (Iris pipeline) (Figure 4.2).
A general pipeline is composed of a chain of IceFunctors12. The first element of the Iris pipeline is the data acquisition module followed by a variable number of image reconstruction modules. The last element transfers calculated images to Spice. Spice stores pixel data and DICOM header in the syngo database and optionally sends images to the inline display.
It is important to note that the hardware on the imager uses 64-bit CPUs and consequently a 64-bit operating system (Linux), while the host remains on a Windows 32-bit based platform. Hence, data types in C++ code must be treated carefully: (i) int remains 32-bit on both platforms, (ii) long is 32-bit on the Windows platform but 64-bit on the Linux system and (iii) pointer types always have the ‘native length’ of the operating system (32-bit on Windows, and 64-bit on Linux).
An ICE simulation environment is also offered, ICE_SimEnv, to simulate and test ICE programs on stand-alone PCs (Figure 4.3). In the simulator only the imager part of the pipeline is started; the Spice component is simulated during reconstruction. The Twix platform is an external tool on the host computer used to retrieve measurement data for the simulations - meas.dat files. They contain both measurement and header data, that will be used to input image volumes for simulation. The measurement header, meas.evp, contains all necessary header information to simulate a measurement in ICE_SimEnv.
12	A Functor is a function block that performs a certain encased functionality.
	
Scanner	
	
Scanner Controller (MPCU) vxWorks
Console (HOST)
Windows 32bit
—►
Linux 64bit
Post Processing
Functors
Figure 4.2. A simplistic version of the ICE workflow on a Siemens MR scanner.
Figure 4.3. Workflow of the Simulation Environment for an ICE programme. Adapted from [53].
4.2.	Methods
The challenges that arise when dealing with the development of an MRE toolbox are mainly the complexity of the programming language. Thus, the strategy involved on a first approach the study, development and evaluation of algorithms on the scripting language MATLAB (The MathWorks Inc., Natick, USA). The algebraic Helmholtz inversion process
was chosen to be implemented, and a simple graphical user interface (GUI) was designed and developed with the GUIDE features of Matlab.
Then, the algorithm was translated into C++, a lower level language, where the Matlab code was simplified in order to run a basic processing scheme, reducing the number of possible sources of error. In order to be readily transferable to the ICE environment the functionality of the code was carefully separated into separate classes for data input/output and analysis. The latter classes could be transferred to the ICE environment without modification. The C++ code went through debugging off-line, on a gnu compiler, and was then ported to run on the ICE simulator (using different input/output code designated as the ICE wrapper, the development of which is outside the scope of this thesis). The final step involved testing on the scanner itself, acquiring real time elasticity measurements of the data.
Therefore, to sum up, the four main stages that were carried out in order to develop a real time MRE toolbox prototype where:
1.	Matlab implementation of the AHI, as well as evaluation of approaches for a simplistic automatic workflow;
2.	C++ coding and debugging offline using a stand-alone PC;
3.	Incorporation of the C++ code classes into the ICE environment for inline analysis -the ICE wrapper;
4.	Evaluation and testing of the finished code whilst acquiring data in the scanner.
4.2.1.	The AHI process coded in Matlab
The approach for developing Matlab code implementing the algebraic Helmholtz inversion algorithm aimed for a fluid processing stream with the lowest level of user interaction as possible. Controlled input parameters were kept to a minimum, and the basic output incorporated G’ and G’’ maps of the processed dataset.
Accordingly, amplitude and phase datasets from a single measurement data were required as inputs in DICOM format. Reading its header structures allowed access to some image parameters: matrix and pixel size, number of time points and slices. Parameters from the special card box related to specific MRE protocol could be accessed via private fields in the header structure. These included the mechanical/MEG frequency, the MEG amplitude in mT/m, and the number of MEG cycles used. Nevertheless, a mask threshold had to be specified by the user, as well as the spatial filter bandwidth values.
The main processing streamline was thus, as follows. First, phase unwrapping13 is performed using Flynn’s two-dimensional minimum discontinuity approach [54] (the full algorithm description is not relevant to this work). Then, a region of interest is selected on the corrected phase images. The ROI creation is based on a pixel thresholding segmentation method [55]. For a specific slice, amplitude images were averaged from all the acquired time points. This process improved the automatic structure delineation, avoiding patches with nonselected tissue. In addition, a flood-fill algorithm which is implemented in the Matlab function ‘imfill’ enabled filling the inside of the ROI structure from regions that still remained classified as zero in the binary image.
At each spatial point in the phase image, the temporal FFT is calculated over the time points using the Matlab function ‘fft’. The first harmonic is then chosen from the Fourier transformed dataset, which is where most of the mechanical energy is found.
The next step involved the application of a spatial filter. Although type and order of the filter were kept unchanged (choosing a 4th order Butterworth band-pass filter), the bandwidth, as was already mentioned, was chosen by the user. These limits are highly dependent on the vibrational frequency and the tissue type imaged, hence, it was not viable to restrain them to a non-interactive method. The spatial filter is built on a mesh with the same dimensions of the image to be filtered. After performing a 2-D fft of the latter to obtain the k-space (function ‘ifftn ’), the filter is multiplied point-by-point independently with the image matrix. Finally, the matrix is inverted back with the 2-D inverse Fourier transform, ‘ifftn ’.
For inversion, the Laplacian terms of the complex image, U = u1 + u2i, need to be estimated. Two approaches were tested, using the Numerical Gradient (N-G) and the Savitzky-Golay (S-G) [56] methods. Nevertheless, the primary choice for derivative estimation was the N-G technique, since it is proven more accurate and precise (discussed in Chapter 5). To compute the N-G in Matlab, the function gradient is used.
The complex division inherent to the inversion equation of the AHI method (3.12) is computed in the following manner. If,
VU - UXX + Uyy
(U1,XX T U2,XxO T (Uyyy
+ U-2,yy0 — ^3 T U4i
(4.1)
then,
U	u4 + u2i	uAu3	+	u2u4	u2u3	— uAu4
V U	u 3 + u4 i u 32	+	u42	u 32	+ u42	(4.2)
13	Accumulated phase shifts sometimes lay outside the range ±z. Extracting the absolute phase from the wraps is done by applying unwrapping algorithms.
provided that u32 + u42 #= 0. Matlab software already treats complex division internally and the arithmetic computation of G* point-by-point on the two dimensional array are straightforward.
Taking separately the real part of the complex shear modulus or storage modulus and the imaginary part or the loss modulus (G* (r,a) ) ,= G' (r,a) ) + i G'' (r,a) ) ), some regularization measures were applied to both types of maps, in order to reduce levels of uncertainty. First, negative values of G ' and G '' were forced to zero. A median filter with a 3x3 window was used to smooth the resulting images (Matlab function ‘medfilt2’). Also, the Laplacian computation is known to induce boundary artefacts on the image borders [7]. For this reason, a function was built in order to select a smaller portion of the previous selected ROI, eroding a three pixel border from the initial ROI boundaries.
In addition to the basic processing in Matlab, added features were coded in order to obtain further advanced processed measurements. Another type ROI selection option was included to have user interaction. When dealing with liver data, for example, the quality of the amplitude images most of the times is poor, thus an interactive ROI is the ideal choice. Further, this is useful when the rheological measures of a specific abdominal organ are required.
Specifically for brain, a new feature was included where segmented WM and GM regions were used as inputs obtained using FSL software, to obtain tissue type viscoelastic measures. Also, CSF segmented maps were used to exclude the ventricles from all the computed G' and G'' maps.
Additional maps were added to the basic code, namely of phase velocity and attenuation, computed with equations (3.12) and (3.13), respectively. Another implemented feature in Matlab was to output filtered displacement time steps. Thus, after filtering the 1st harmonic, an inverse Fourier transformation is applied to the frequency spectrum in order to obtain the filtered phase time-series, 0, in radians. Converting to displacement amplitude, X, in units of ym is then achieved by the following formula [57]:
7T(1 — T2/2)
A (r 4 ) = rg ts I n (n Nrf S	(4.3)
where g, t and N denote amplitude duration and number of sinusoidal MEG periods, respectively; y the gyromagnetic ratio.
Finally, an option was added for post-processing viscoelastic constants from the frequency dependent ' and '' measurements. Four models were included and can be chosen separately: the Voigt, Maxwell, Zenner and Springpot models. A non-linear procedure was
used to perform fitting, where the function ‘¡sqnonlin' called the appropriate function with two or three free parameters according to the type of model used (equations (2.13) to (2.16)).
For easy user functionality, some of these features were incorporated into a graphical user interface (GUI) designed with GUIDE of Matlab (Figure 4.4).
(a)
(b)
Figure 4.4. GUI screenshots of the offline Matlab-based MRE processing toolkit (a) in processing phase and (b) the final results.
4.2.2.	C++ implementation offline
Only a simplistic version of the Matlab programme was translated into C++ code, to avoid problematical bugs and unknown sources of error. The main goal here is to obtain a basic measurement of elasticity so as to quickly assess the quality of the acquired data. Thus, complex computations were kept to a minimum. The block diagram in Figure 4.5 represents the process structure assumed for this project.
mre_image_new&amp;lt;Amp lmage&gt;&amp;lt;Phase lmage&gt;&amp;lt;vib freq&gt; dowciit k&gt; chighcut k&gt;&amp;lt;thresh&gt;
I
mre_image_main.c
shiftmatrix.cpp
Derive_Num.cpp
run_median.cpp
Figure 4.5. Block diagram of the MRE processing C++ code structure.
regstar, nii
runflynn.cpp
Derive_SG.cpp

To run the process on an offline basis a routine is created, called mreimagemain, in order to input the amplitude and phase data (required to be in NIfTI format) and the user defined processing parameters: the mask threshold, the spatial filter bandwidth and the vibration frequency. This routine will return a 3-D G’ matrix stored also in NIfTI format and with the string name regstar.nii.
A new class14 identified as MREImageProcess was created where some routines are kept. The main processing routine, designated as Process, is where the Algebraic Helmholtz Inversion platform was integrated (shaded blue box in Figure 4.5). Additional functions were also coded for specific tasks. For example, allocation of memory was necessary for 12 matrices with varying dimensions (from 1-D to 4-D): mask, spatial filter, pre- and postfiltering volumes, calculated second derivatives, pre - and post- median filter G’ maps, etc.
Other routines were kept in individual scripts, for organization purposes. Importantly, the phase unwrapping code was adapted into C++ from the one provided in [58]. Here, optional prior input parameters are kept as default. Regarding derivative computation, the two already studied options can also be found in the C++ code: Derive_Num.cpp for the numerical gradient and the Derive_SG.cpp for the Savitzky and Golay technique. The first was hard coded using the central difference estimation technique for each pixel in the image. However, conditions on the boundaries were set to estimate the derivative from the forward or backward difference instead. Regarding Derive_SG.cpp, the routines savegol and convlv were obtained from [59] and adapted to compute the derivative.
The code is compiled on a Linux system using a makefile on the GCC15, and the syntax of the resulting executable file is:
mre image new&amp;lt;Amplitude Image&gt;&amp;lt;Phase Image&gt;&amp;lt;vib freq&gt;&amp;lt;lowcut k&gt;&amp;lt;highcut k&gt;&amp;lt;thresh&gt;
4.2.3.	The ICE wrapper for ICE_SimEnv and inline processing
As was already mentioned, this project then involved the offline code to be integrated into the ICE environment, so as to be able to run inline during scanning. Although this stage was developed by another member of the project, it is crucial to give a brief description of the role of the ICE wrapper for the MRE processing code.
14	In C++, a class is an expanded concept of a structure: instead of holding only data, it can hold both data and functions.
15	GCC, the GNU Compiler Collection, is a suite of libraries and compilers for a number of computer programming languages, namely, C and C++.
A general diagram block is presented in Figure 4.6 of this new adapted workflow. Here, the previously used routine script mreimagemain becomes unnecessary, since the measurement data is obtained directly from the source. Thus, after the image acquisition and sorting pipeline in the MRIR and prior to directly storing the data into the syngo database in the host computer, a new functor is created and inserted in the MRIR pipeline, designated MREProcess Functor. This will contain all the code which enables the added functionality of processing MRE data directly in the scanner. Its role is to add the image volumes and to call the processing functors. The output will be a three dimensional image, the G'(r, o&gt;) , which is additionally stored with the non-processed amplitude and phase volumes into the database.
Image Acquisition Pipeline
MREProcess Functor
Database
Operator (Functionality)
Finalize (Clean-up)
Figure 4.6. A basic diagram block of the inline processing with the ICE wrapper. The MREProcess Functor includes the code that will be added to normal the image acquisition and storage pipeline.
In the MREProcess Functor, a Configurator Functor was specifically created to access both parameters from the sequence GUI (the mechanical frequency) and other parameters from the sequence description itself (the mask fractional threshold, and the filter bandwidth). They must always be set prior to initializing a new scanning sequence. The adopted convention to set parameters from the sequence description is the following: the threshold of the mask is set using the string "_t0.1", and the low and high filter wavenumber thresholds are set using a string like "_sf150:50". So, as an example, a sequence string named mre_t0.1_sf150:50 would set the mask threshold to be 0.1 and the low and high cut-offs would be 150 and 50, respectively. As was already mentioned, the mechanical frequency is taken from the headers of the MRE sequence itself, thus it does not need to be directly set in the sequence string. Also, the image dimensions as well as the voxel size are easily accessed via the header files of the acquired volumes. The Operator Functor is where all the previously
described C++ processing block of code was inserted. Additional functors were programmed according to the ICE specifications (constructor, destructor, finalization, etc) with various specified roles.
As the type of computational machine changed, the compiler will handle numbers differently. Hence, new specific regularization measures need to be applied after the processing block mentioned. It was found that some results of the computation of the Helmholtz division (equation (4.2)) were unstable and varied wildly. Thus, a limit to the highest possible elasticity value needed to be set at 32600 Pa to prevent spurious values appearing in the image voxels. Also, since the data needs to output 16-bit integers, the values of ' were set in Pa, and not in kPa, as non-integer numbers would be rounded up and precision would lower.
4.3.	Results
4.3.1.	C++ coding validation and comparison with Matlab
All processing stages of the AHI inversion were studied with Matlab in order to validate the C++ code. Phantom data with different elasticity indexes and at various vibrations frequencies were used to make this assessment.
The performance of the unwrapping algorithm applying Flynn’s mini mum discontinuity approach is displayed in Figure 4.7. Six raw phase offsets are shown with clear wrapping artefacts that appear as high intensity spots and with a low intensity ring around them. The effectiveness of the algorithm can be seen on Figure 4.7 (b) where the spots corresponding to an overshoot to values over k were corrected to values around -k.
Figure 4.7. (a) Raw images of six phase off-sets of the homogeneous phantom at 100 Hz excitation frequency. (b) Unwrapped images after the application of the Flynn’s approach.
Following unwrapping, the temporal Fourier transformation is performed. A cylinder phantom phase dataset after temporal Fourier transformation shows that in fact the first harmonic contains most of the wave energy, whereas for other harmonics the displacement values are very low (Figure 4.8). Also, the first image corresponding to f = 0 H z is correctly computed, where no waves were found. Due to Fourier analysis, phase-offsets can only be acquired in a number which has to be a power-of-two.
Figure 4.8. Temporal Fourier transformation technique. Image maps of f=0Hz, and the first and second harmonic s after tFFT. Most of the energy is accumulated of the first harmonic.
Figure 4.9. Filtering process of the AHI algorithm implemented in C++. (a) k-space of the 1st harmonic; (b) application of the k-space shift; (c) k-band of the spatial 4th order butterworth band-pass filter; (d) application of
the filter in (c) to the k-space in (b); (e) result after he fftshift routine changing higher frequencies to the image
limits and lower frequencies to the image centre.
To convolve the filter with the first harmonic of the dataset, transformation of the data into k-space had to be performed first (Figure 4.9 (a)) followed by a shift in frequency order (Figure 4.9 (b)), meaning that higher k values were shifted towards the image centre and the borders would contain low k values. The Butterworth filter was hard coded in k-space and an output example is shown in Figure 4.9 (c). The resulting arithmetical point-by-point multiplication of the filter with the shifted k-space wave image is shown in Figure 4.9 (d). The image is then shifted back (Figure 4.9 (e)), as well as Fourier transformed. In Figure 4.10 different filters were tested on the cylinder phantom data excited at 200 Hz to validate the code implementation in C++. Depending on the type of filter one can select, for example, only higher wavelengths (Figure 4.10 (c)) or the low wavelengths felt inside the cylinder inclusion (Figure 4.10 (d)).
Figure 4.10. Results of filters with different low-cut (lc) and high-cut (hc) wavelengths, in mm, on the cylinder phantom excited at 200 Hz. (a) lc=10.8 &amp;amp; hc=27.7; (c) lc=6.67 &amp;amp; hc=200; (c) lc=11.1 &amp;amp; hc=12.5; (d) lc=25.0 &amp;amp; hc=50.0.
To perform inversion, computing the Laplacian of the complex wave image was required. Since the process is known to induce heavy noise into the data, the two algorithms were tested in order to choose the one with the best overall performance. However, no significant differences were found on the directional terms of the estimated Laplacian matrices with both implementations in C++. Also, comparing with Matlab, there were no apparent differences in the images of the estimated directional terms (Figure 4.11).
Figure 4.11. N-G Laplacian directional terms (dU/dxdx on the left and dU/dydy on the right) computed with the (a) matlab and (b) C++ codes.
Equation (4.2) computes G* at excitation frequency excluding averaging with the constant parameters: angular excitation frequency and density. In order to prove the effectiveness of the algorithm in C++, results before and after regularizing with a median filter were compared with Matlab (Figure 4.12). Here it is evident a lower performance of the Laplacian calculation with the N-G approach in C++. Still, for the purpose of a basic analysis in the scanner, we assume that the computed G ' maps are acceptable.
Figure 4.12. G’ map before and after application of the median smoothing filter with a window of 3x3 pixels with (a) Matlab implementation (c) C code implementation.
4.3.2.	ICE simulator
Before running the code in the scanner, try-out experiments were performed on the ICE simulator. A measurements data file (designated meas.dat) is extracted directly from the scanner with the Twix tool and used on the simulator pipeline. Comparative results using three forms of processing data are presented in Figure 4.13. All forms of the processed G' modulus are similar, in particular the ones derived from the C++ processing, as expected, but the ICE simulator returns a flipped image. Nonetheless, this does not pose any problems in the evaluation of the effectiveness of the algorithm running in the simulator.
Figure 4.13. Single slice of a homogeneous phantom 1:3 (gelatine:water) excited at 200 Hz vibration frequency. (a) Unwrapped and filtered wave image at excitation frequency acquired with Matlab. (b) Matlab processed G’ result; (c) G’ result of the C++ code compiled on a Linux system (c) G’ result obtained with the ICE simulator.
4.3.3.	In-line processing
In-line tests were performed on a Siemens 3T MRI machine (Magnetom Verio; Siemens, Erlangen, Germany) using the piezoelectric based actuator described in Chapter 3 (Figure 3.3 (a)) to excite the medium at a desired frequency. Results on phantom data are presented in Figure 4.14. The phantom comprised a mixture of gelatine and water (1:1 background and 1:2 inside the cylinders of gelatine:water), in which the elasticity property is prominent.
The sequence description for each of the three experiments was: at 100 Hz mre_t0.1_sf81:14, at 250 Hz mre_t0.1_sf109:41 and at 350 Hz mre_t0.1_sf136:50. The acquired 16 phase offsets, coronal and transverse, produced very good results, clearly differentiating the inclusions stiffness from the background at all frequencies.
100Hz
250Hz
15000
350Hz
G- (Pa)
Figure 4.14. A two cylinder inclusion phantom with 1:1 background and 1:2 cylinder inclusion stiffnesses. Results obtained with the real time MRE toolbox acquiring coronal and transverse slices.
Finally, a healthy volunteer was subjected to brain MRE with real time automatic computation of G ', where the 2-D Helmholtz algorithm processed each imaging slice.
In Figure 4.15 a photograph from the MRI control room shows the scanning process with the inline analysis. Each map could be visualized on the host computer directly after scanning of each acquisition dataset. Figure 4.15 (b) shows a detail of the workstation GUI of the Siemens MRI system where the user must modify the sequence string prior to scanning, in order to set the desired input parameters.
Figure 4.15. MRE Experiments on brain using the real-time processing toolbox for MR Elastography. (a) Overall view of the scanner and host computer showing three computed frequency dependent G’ maps. (b) Detail of the sequence descriptions.
In order to assess the quality of the processed brain data, the G’ volumes are displayed with FSLView (Figure 4.16). As expected, at higher frequencies there is a global increase in the storage modulus. This is present consistently across all imaging slices of the brain. Nonetheless, a ring artefact appears on the image borders, with underestimation of stiffness, where most of the cortical grey matter is located. These artefacts are known to be induced during Laplacian computation. In the Matlab version, this border was eroded for display purposes. However, we chose not to implement this in C++, since we prevent additional memory allocation, simplifying the code and optimizing the speed of the algorithm.
Figure 4.16. Real time MRE results performed on a healthy brain at three different driving frequencies acquired over 5 slices.
One of the major issues that might originate during acquisition with the inline analysis concerns the selection of fractional threshold for mask segmentation. An improper choice of the threshold produces a G’ map such as the one shown in Figure 4.17 (b).
Figure 4.17. (a) Original amplitude and phase brain data at 25 Hz and its processed G’ map. Zero valued regions pointed by green arrow indicate spurious results from to the algorithm itself. (b) Amplitude and phase brain data at 37.5 Hz. Green arrow points to zero-valued regions in the real time computed G’ map, showing that automatic ROI was not performed correctly. (c) Amplitude and phase of a liver scan, with corresponding colour G’ map.
It will result on incorrectly estimated zero regions, which can be very misleading, as this problem presents similar artefacts to those inherent to the AHI algorithm (Figure 4.17 (a)). Also, for liver MRE, the threshold technique will not be the best choice (Figure 4.17 (c)), due to the very low quality EPI amplitude maps. Here, manual delineation of the region would assure a totally filled, smooth region selection.
4.3.4.	Software run time
An estimate of the software run time was taken from each technique, and the results are shown in a bar plot of Figure 4.18. Quantification was made relative to the Matlab computation time. The C++ inline processing is the fastest (over 90% faster than Matlab) due to the power of the MRIR machine. Furthermore, the C++ offline version performs also quicker than Matlab, since the latter interprets the language when the programme is executed slowing down considerably any analysis [60]. The simulator’s run time is similar, since it tests the C++ code on a stand-alone computer. Thus, these two were not differentiated in the bar plot. Within this project, none of the programmed codes were optimized for speed, since the total run time didn’t exceed what was considered acceptable (under the minute ra nge).
Figure 4.18. Estimative of the relative processing time between Matlab and the C++ codes.
4.4.	Discussion
The project presented in this chapter concerned the construction of software for the purpose of performing real time calculation of viscoelastic maps from phase data obtained in the MRI scanner. After overtaking the four main stages of development explored in the
methods section, the testing confirms the achievement of a successful prototype that can be routinely used in the imaging protocol.
On an offline basis, the Matlab implementation of the AHI process offers great advantages, allowing for a thorough analysis. The analysis can go as far as calculating Lame constants for a determined tissue, processing only a desired region of interest or even having access to the different stages of the process directly. This tool enables a vaster range of functionalities, and a more reliable, steadier evaluation of data. However, it takes up more run time and also a trained individual to perform a designated analysis.
In contrast, the C++ implementation was kept to a basic level, since the purpose was to develop a tool that would perform an initial computation of elastic maps to assess the quality of the data acquired.
With the developed tool, it was possible to scan and obtain high-quality G' maps in phantom data with inclusions of dissimilar elasticity in respect to its background. Reproducibility tests were effective over various types of phantoms, and by applying different vibrational frequencies. The inline software was also tested on brain, presenting also successful and reproducible results.
Nonetheless, an optimization stage is still required. Mainly, algorithm improvements should be concentrated on the masking technique, to avoid the knock-out of large portions of the tissue region.
Intensity variations in the amplitude maps within an image volume and from an acquisition to another even using the same sequence parameters are very common. The threshold technique is most effective when the intensity is high with a short range of values. The dense brain structure as well as the higher quality EPI signal obtained, generally enables the simple application of this threshold ROI technique. On the other hand, when imaging soft abdominal tissue, the EPI is fairly low quality, and thus other masking methods should be explored.
The computational time of the code is already short, such that during a typical brain scan acquisition of 5 slices and 32 phase offsets would take around 2.5 minutes with just a maximum added 3 seconds for the inline processing. Nonetheless, it was found that the phase unwrapping section takes over 80% of the computational time. Optimization of the code is an option, but perhaps the most effective technique would be to unwrap image volumes separately in different clusters. The process algorithm would speed up by a factor dependent on the number of clusters available.
In addition, at the moment only grey colour-maps of the G' can be viewed on the scanner control room computer. However, prospectively, it is possible to output the G' maps with a colour-map, such that post-processing data evaluation by the user can become easier.
Returning also G' maps or the filtered complex wave image at excitation frequency would complement the toolbox providing more information for a complete analysis.
Finally, in order to optimize the code for clinical usage, the input values for inline processing (threshold of the ROI and filter cut-off frequencies) would need to be included in the special card box for MRE (Figure 4.19), allowing a fluid workflow for a radiographer or, generally, an individual not familiar with the coding structure .
Figure 4.19. Screenshot of the MRE-EPI sequence special card to configure specific parameters for acquisition.
4.5.	Chapter Summary
In this chapter a basic prototype for in-line analysis of MRElastography data was developed based on the known direct inversion approach, the Algebraic Helmholtz Inversion. Code development, evaluation and debugging stages were successfully carried out and reliable results were obtained at the final testing phase within the scanner structure itself, using, firstly, phantoms as the probe, and finally brain data of a healthy individual at various excitation frequencies.
Nonetheless, an optimization stage is still to be achieved. The masking technique is the main issue in the algorithm. Also, regarding user functionality aspects, the most important improvements ware related to the selection of processing parameters which should be inserted the special card box, and not on the sequence string. Finally, even if it does not present as a major issue, the speed of the process could eventually be increased by optimizing the code structure .
Chapter 5.
Evaluation of DI Algorithms for
Elastogram Reconstruction
5.1.	Introduction
As it was mentioned in Chapter 3, the two most common direct approaches to invert the wave equation are the Algebraic Helmholtz Inversion and the Local Frequency Estimation. Ultimately, for the AHI method we apply to the acquired phase data p (ra) a Fourier transformation of the time series to obtain the complex shear modulus,	at the driving
frequency (assuming p=1000 kg/m3). [7] The LFE approach to invert the simplified wave equation is based on combining local estimates of instantaneous frequency over a large number of scales. [51] In practice, this technique implies the application of two or more log
normal filters which differ only in their centre frequency. Mathematically, it requires a further simplification to the wave equation assuming no wave attenuation in the medium.
The amount of information needed for a successful processing using both techniques is small, making them ideal from a clinical perspective. [61] Hence, they have been widely used to stage liver fibrosis [24], [62], [63], detect liver tumours [64], study global changes in brain elasticity in aging [65] and in pathologies such as multiple sclerosis [37], normal pressure hydrocephalus [31] or pre-surgical gliomas [66]. In 2008, Papazoglou et al. [8] studied and evaluated the setup issues within an MRE experiment to be used for a planar AHI approach. However, the cost of oversimplification in the algorithm itself and a wrong processing scheme may also lead to incorrect elastogram reconstruction and, thus, to wrong mechanical property quantification of tissue. It is expected that for a complex tissue anatomy such as the brain, the method’s performance will decrease, since structures like the mechanical shielding of the skull will cause a higher degree of wave attenuation and assumptions of local homogeneity and isotropy are not globally verified. Thus, in this chapter, the aim is to examine and technically compare both AHI and LFE performances on different experimental conditions, to understand the advantages and disadvantages of one algorithm over the other.
5.2.	Methods
This study was divided into three separate experiments. For the purpose of evaluating the algorithms’ efficiency in close to ideal situations, simulations were carried out using software phantoms. The second set of analysis regards evaluation in acquired MRE data from gelatinbased phantoms, as well as validation of the measured stiffness with rheometer readings. A final brain analysis is further carried on healthy volunteers to address the model assumptions in human tissue with a high complex wave pattern distribution.
5.2.1.	AHI and LFE Methods
AHI Inversion. The algorithm was implemented in MATLAB (The MathWorks Inc., Natick, USA). To find the elastic properties, equation (3.11) was evaluated point-to-point on a quadrangular grid using harmonic data. The processing technique implemented here followed the same recipe that was described in section 4.2.1 of Chapter 4.
Thus, after the temporal FFT, images were filtered with a spatial Butterworth band pass filter with adapted lower and upper threshold wavelengths to the type of medium. Unless stated otherwise, the Laplacian terms are then estimated with the N-G approach. Lastly, G* is
estimated by performing the complex division of equation (3.11), and the final regularizations measures are applied.
LFE Inversion. To compute the inversion and estimate the elastogram maps, the unwrapped phase data was fed into the MRE/Wave software from Mayo Clinic (http://mayoresearch.mayo.edu/mayo/research/ehman_lab/mrw-wave.cfm). Filtering is here applied to each time offset image (the same spatial forth-order Butterworth band-pass filter was applied). For inversion of each single phase image, the centre frequencies of the six radial LFE filters used were 1, 2, 4, 8, 16 and 32 waves/FoV. The stiffness maps were computed by the squared ratio of the mechanical frequency and the spatial frequencies estimates and an average over all the time-series maps was taken as the output result.
5.2.2.	Software Phantoms
Tests of noise sensitivity, damping, and interference effects were made by creating software phantoms from the following basic one dimensional wave equation with known viscoelastic properties:
&lt;p(r,t) = Ael2n:f(r cp^
(5.1)
This expression describes a vibration of frequency	, where is the wave number,
travelling with principal direction vector r, with a constant phase velocity cp = 2 tt f/k.
A mesh of 128x128 points with pixel dimension, in mm, of 1.8359x1.8359 was created to represent a two dimensional phantom. From 16 time steps, the raw data was evaluated using either the AHI or the LFE approaches.
Gaussian noise was introduced on software phantoms with shear wave propagation in the y cartesian direction, at 50 Hz excitation frequency, phase velocity cp = 1.4 5 m/s , assuming no attenuation on the medium, no boundary effects due to the physical limits of the phantom, hence, modelled without wave reflections/refractions. Corrections with low-pass filtering were experienced on both algorithms to compare with uncorrected results.
To test damping effects, a Gaussian envelope was used to probe attenuation on the wave equation.
XoC/cJ = Ne-^i-^2/2
(5.2)
where is the amplitude of the wave and is the spread of about . Both of these variables were maintained constant, while varied according to the type of attenuation.
Equation (5.3) states the result of the multiplication of the envelope with the propagating shear wave equation.
(patent, t) =	X&amp;lt;p(x, t)
(5.3)
Software phantoms were tested with different vibration frequencies and phase velocities, as well as varying Gaussian wave types.
The third effect studied was the consequence of compressional wave components interfering on shear wave propagation. A software phantom at 50 Hz vibration frequency and	was used to model shear wave propagation. Compressional waves were
added following equation (5.1) ( cp = 1.2 0 m/ s) at different vibration frequencies.
The principle of superposition is a very useful tool, applicable to many problems in engineering science. Under the assumption of small deformations and linear elastic constitutive behaviour, all elasticity equations are also linear. Furthermore, the usual boundary conditions are also linear. Thus, under these conditions it is possible to apply the superposition concept. [2] Directional waves with different amplitudes were therefore studied in order to assess constructive and destructive interference of shear waves according to the superposition principle.
5.2.3.	Gel phantoms
5.2.3.1.	MRE testing
MRE experiments were made on inclusion phantoms, comprised of background of 1:3 with a cylinder inclusion at 1:1 parts of gel16:water. Additionally, 1:1, 1:2 and 1:3 (gel:water) homogeneous phantoms were also used to serve as controls, to test filtering techniques and for rheometry comparison. Single slice images were acquired on a 3T MRI scanner (Magnetom Verio; Siemens, Erlangen, Germany) with a modified single-shot spin-echo EPI sequence that incorporated a sinusoidal MEG in the through-plane direction synchronized with the mechanical vibrations (2-12 cycles, 5-35 mT/m); 16 phase off-sets were acquired. General sequence parameters were: TR=1650 ms, TE=100 ms, FoV=235x235 mm2, matrix= 128x128, slice thickness=5 mm. The piezoelectric device [41] coupled to a head cradle via transmission rod was used to produce the vibrations at the frequencies: 100, 200, 250 and 350 Hz. The rocking setup (Figure 3.3 (a)) and the use of the highest number of MEG cycles were optimized for maximum phase-shift detection. [8]
16	Manufactured by Wirogel M.
5.2.3.2.	Oscillatory rheometer testing
To compare with the MRE measurements on the gelatine phantoms, cylindrical samples from the 1:1, 1:2 and 1:3 gel:water phantoms (Figure 5.1 (a)) were tested on two different rheometers. The ARES17 is a controlled strain rheometer, treated as the gold standard in the experiments (Figure 5.1 (b)). 50 mm diameter samples were placed on 50 mm parallel plates with temperature controlled at 20°C using a water jacket fitted to the bottom plate. The linear regime of viscoelasticity was estimated by a strain sweep at a frequency of 10 rad/s. Then, a frequency sweep of 30 equally spaced points was acquired within the frequency range from 0.1 to 100 rad/s.
Figure 5.1. (a) Example of a gel phantom sample used in rheometer tests; (b) ARES controlled strain rheometer; (c) BOHLIN controlled stress rheometer.
Tests were also performed on a controlled stress rheometer, the BOHLIN CVO12018. (Figure 5.1 (c)) For these experiments 40 and 20 mm parallel plate geometries were used on samples with the respective diameter sizes. The temperature was controlled by the Bohlin ETO (Extended Temperature Option) and set to a constant 20°C. First, strain sweeps were acquired at a frequency of 1 Hz, where the limit of linear stress was obtained for input on the posterior frequency sweeps. These were acquired for the three phantom types on a frequency range of 0.1 to 100 Hz, with 30 equally spaced points.
17	It was manufactured by Rheometric Scientific Ltd with serial number 500014312. It is controlled using TA Orchestrator software (version 6.6.3) and uses a 2K force re-balance N1 transducer.
18	It was manufactured by Malvern Instruments Ltd with serial number 01007870CURA144. It is controlled using the Bohlin software (version 6.50.5.7).
The same rheometry procedure of the ARES machine was applied to a well-known material with a gel like behaviour at room temperature, the Polydimethylsiloxane (PDMS), i.e. it has both viscous and elastic properties [67], [68].
After obtaining the frequency dependent G' and G" results, the Voigt, Maxwell, Zenner and Springpot viscoelastic models of equations (2.13)-(2.16) were used to extract the Lame constants of the material, as well as interpolated results to frequencies in the range of what was achieved using MRE (from 50 to 350 Hz).
5.2.4.	MRE on healthy brain tissue
Brain tests were performed with the same setup and scanner as for the gelatine phantoms from five healthy volunteers without any history of severe brain injuries or neurological disorders (2 female; mean age of 24.2), with induced monofrequency vibrations at 25.0, 37.5, 50.0, 62.5 and 75.0 Hz. Institutional review board approval was acquired, and informed consent was obtained from all participants. For this study, 32 phase difference images with 5 brain slices were acquired, all positioned approximately in the region shown in Figure 5.2.
Figure 5.2. Approximated imaging region of the 5 slices in the brain for planar MRE.
5.3.	Results
5.3.1.	Software phantom evaluation
5.3.1.1.	Noise
Figure 5.3 shows wave maps with different levels of Gaussian noise introduced in the software phantom excited at 50 Hz. AHI and LFE processing results without and with low-pass filtering are shown below. It is visibly clear an improvement in the SNR in both techniques, however some filtering artefacts affect LFE which can be identified by the higher intensity horizontal lines.
Figure 5.3. Noise induction simulations. First phase offset from phantoms with (a) 10%, (b) 50% and (c) 90% Gaussian noise. Resultant G' maps are represented in the two rows below ((d)-(i)), comparing no filter, left, with the application of a pre-inversion filter on the right (low-cut wavelength = 0.0109 m).
Figure 5.4. Spatial mean phase velocity results for the simulated software phantom at 50 Hz mechanical frequency, cp=1.45 m/s with increasing Gaussian noise corruption levels from 1 to 100%. Measurements in green and light blue result from AHI and LFE inversions, respectively, with pre-filtering: low-pass filter with low-cut wavelength of 10.9 mm. The expected result is represented by the dashed black line.
Using the relationship in eq. (3.12), the spatial mean phase velocity is estimated from the determined G' maps, with varying percentages of Gaussian noise. (Figure 5.4) The black dashed line marks the 1.45 m/s expected value, which serves as a reference. Although the LFE method estimated phase velocity values more precisely in case of no noise corruption, the images degrade when using higher levels of noise, thus underestimating the mean cp values. The AHI method, on the other hand, seems to produce an intrinsic bias of around 0.05 m/s. However, noise does not affect the end result as much, and, for this case, filtering will cut off any noise corruptions, having consistent cp estimation through all noise levels (green line results).
5.3.1.2.	Damping
Damping was achieved using the Gaussian envelope of the equation (5.2). Figure 5.5 shows results of wave damping at five different frequencies: 25, 37.5, 50, 62.5 and 75 Hz. The AHI and LFE G’ maps are shown on the two bottom rows. Visually, there is a prominent overshoot of the G' estimation at higher frequencies in the LFE inversion map. However, for AHI only very subtle changes can be visible in the output image. These results are supported by the G'map profiles of Figure 5.6 (a) and (b) taken along the y direction on the software phantom excited at 50 Hz (location shown by the dashed green line on one of the wave images in Figure 5.5). The imaginary part of G*can only be estimated from the algebraic inversion,
and is related to the damping by equation (3.13). Figure 5.6 (c) shows the profiles on the same direction of the G" computed with the AHI method. As expected, there is a linear effect produced by the Gaussian envelopes on the wave propagation.
37.5, 50.0, 62.5 and 75.0 Hz). Top row represents the first phase offset, the middle row shows the G' maps
estimated by AHI inversion, and the bottom row shows the G' reconstructions using the LFE method. The green
dashed line represents the profile direction for Figure 5.6 and Figure 5.7.
Figure
5.6. G' estimation along the direction of motion propagation at
5 driving frequencies (25.0, 37.5, 50.0,
62.5	and 75.0 Hz) using: (a) the AHI inversion method and (b) the LFE method. In (c) the G'' profile from AHI
inversion was obtained which suggests the damping effects along the direction of motion propagation.
Five different phase velocities used in the Gaussian envelopes were experimented on the software phantom with excitation frequency of 50 Hz (cp=1.45 m/s) (Figure 5.7). With increased damping, the AHI and LFE methods perform very differently (Figure 5.7 (b) and (c)). Whereas for the first method, the amplitude of the signal itself is not very problematic having G' variations of lower than one order of magnitude, for LFE the damping effect overestimates G' reaching up to two orders of magnitude variations from the expected result.
140
-----phasevel=0,6 m/s
-----phasevel=0,8 m/s
phaseveb 1,0 nVs
— phasevek 1.2 m/s
-----phasevel= 1,4 m/s
20	40	60	80	100	120
pixel #
10
Wave propagation profile - Damping Effects
-20
60 80 pixel #
100
(b)
G' profile ■ AHI inversion with variation of gaussian envelope
2.51’----------&gt;----=---■------
(c)
G' profile - LFE inversion with variation of gaussian envelopes
-10
20
400
250
Q_
J200
-----phasevel=0.6 m/s
-----phasevel=0.8 m/s phasevelsLO m/s
-----phasevel= 1.2 m/s
-----phasevel= 1.4 m/s
-----phasevel=0.6 m/s -----phasevel=U8 m/s -----phasevel-1.0 m/s phasevel-1.2 m/s
— phasevel-1,4 m/s
Figure 5.7. Evaluation of software phantom at 50 Hz driving frequency and phase velocity of 1.45 m/s. The phase velocity of the Gaussian envelopes were varied from 0.6 to 1.4 m/s. (a) Result of the wave propagation along the direction of motion with the application of the envelopes. (b) Profile of G’ maps estimated using the AHI inversion technique. (c) Profile of G’ maps estimated using the LFE inversion technique (a close-up of the first 45 pixels is also shown in the smaller graph).
5.3.I.3.	Compressional wave interference
The compressional wave effect was achieved by adding longitudinal components at lower frequencies, 0-25 Hz, cp=1.20 m/s, to waves following equation (5.1) which represent the
transverse/shear components (at 50 Hz vibration frequency; cp=1.45 m/s). Figure 5.8 shows the spatial mean phase velocity estimated from the G' maps acquired using AHI and LFE techniques. Also, results using a pre-inversion high-band pass filter were obtained to correct for artefacts induced by compressional waves. We can see that, the higher the frequency, the poorer the phase velocity is estimated: the LFE has a linear overshoot, while for AHI the process seems non-linear. This non-linearity is essentially due to taking only the required harmonic and rejecting all other frequency components in the AHI processing scheme. With filtering, the results regain stability approximating the mean velocity estimations to the expected 1.45 m/s in both algorithms. Image profiles (before and after high-pass filtering) of three different induced longitudinal wave experiments and resulting G’ estimations are shown in Figure 5.9.
Figure 5.8. Simulation of phantoms with shear wave propagation at 50 Hz in an elastic medium (cp=1.45 m/s) with added compressional interference waves (cp=1.20 m/s; freq = 0-25 Hz). The plot shows the mean phase velocity over the FoV estimated with AHI and LFE methods. Lines in red and light blue represent results with pre-inversion high-pass filtering: filter cut-off wavelengths according to each longitudinal frequency were, respectively, 0, 0.20, 0.11, 0.07, 0.05 and 0.04 m. The expected result is represented by the discontinued black line.
High pass filter corrections - suppression of compression wave components G' map (AHI inversion) G' map (LFE inversion)
20	40	60	80	100	120
Dixel i
20	40	60	80	100	120
Dbcel#
0	2	4	6 (kPa)
Figure 5.9. Three examples of high-pass spatial filter corrections on simulated phantoms with 50 Hz wave propagation, phase velocity of 1.45 m/s, and added compressional waves with the following characteristics: (a) 25 Hz, cp=1.20 m/s; (b) 30 Hz, cp=1.20 m/s; (c) 25 Hz, cp=1.20 m/s and an additional n/4 dephasing component. Respective G' maps for AHI and LFE inversions are shown on two columns on the right.
5.3.1.4.Wave superposition
In Figure 5.10 four software phantoms were created by adding different directional transverse waves always at the same frequency and phase velocity (50 Hz; 1.45 m/s). The wave vectors are shown by the white arrows. Figure 5.10 (e) and (f) show G' results by applying the AHI and LFE, respectively on the wave map of Figure 5.10 (a). Figure 5.10 (g) represents a plot of the mean phase velocity measures estimated from the wave maps (a) -(d). Although the wave patterns have different propagating effects, the stable results obtained for both processing algorithms point to situations of non-destructive interference of the superposed waves.
Figure 5.11 shows a different situation. Two oblique components (a) and (b) were added point-to-point, and the result of the wave map is shown in (c). In (d) a plot of the image profiles of the two components and their sum (red line) were drawn. The combination of the two components creates a destructive effect, yielding very low values for the displacement
profile. This will translate into a huge underestimation of the G' everywhere in the phantom mesh grid in both inversion processes (Figure 5.11 (e) and (f)).
Figure 5.10. Simulated software phantoms with different directional wave components. (a)-(d) show the phase images and white arrows represent the relative amplitude and direction vectors of each wave component. Example of results for (e) AHI and (f) LFE inversions from the above phase images. (g) Spatial mean phase velocity results estimated for AHI and LFE methods for each of the tested phantoms.
&lt;i&gt; (rad)
Figure 5.11. Simulated software phantom with two oblique wave components (a) and (b) (wave vectors represented in white). (c) Resulting phase offset; (d) y-axis profile of the phase offset (red) and two diagonal components (blue and green) taken in the position represented by the discontinued white line. (e) and (f) are G’ results of the AHI and LFE inversions, respectively.
5.3.2.	Real phantom evaluation
The graph in Figure 5.12 shows spatial mean G' variations with different high-cut wavelengths for the Butterworth band-pass filter on the 1:3 homogeneous phantom at 50 Hz, 100 Hz, 200 Hz, 250 Hz and 350 Hz. At lower vibration frequencies the influence of the filter in G' estimation is much more pronounced, and, thus, its non-linearity is observed. The impact of these variations at 200 Hz in displacement and elastogram maps can be observed in Figure 5.13 (a). SNR was also measured from the reconstructions and is displayed in the graph of Figure 5.13 (b). The best stiffness estimation was achieved in the elastograms with the highest SNR (shaded region in the graph), which supports previous observations.
Figure 5.12. G’variations with filter type for the homogeneous phantom at 50, 100, 200, 250 and 350 Hz. Spatial mean values were obtained from an ROI covering the field of view of the phantom. Low-cut wave numbers were chosen with the following values at the 5 increasing driving frequencies, respectively: 70, 90, 150, 170 and 200 m-1.
0 m1	40 m1	60 m1	80 m1	140 m l
Figure 5.13. Homogeneous 1:3 phantom at 200 Hz excitation frequency. (a) Top row represents the complex wave images after temporal FFT. The values on top are the high-cut wavelengths used in the spatial filter. The bottom row shows reconstructions using AHI algorithm from the respective filtered wave images. (b) SNR variations with the high-cut wavelength calculated from the reconstructed maps (SNR=mean/standard deviation).
Also, the effect that the nine filters had on the type of algorithm chosen was assessed with the 1:3 homogeneous phantom (Figure 5.14 (a)). Whereas for the AHI method, the maximum phantom stiffness variation is 0.177 kPa, the LFE method yielded a maximum stiffness variation of 0.854 kPa.
Figure 5.14. Filter variations with the type of algorithm used for reconstructions on the homogeneous phantom. lc and hc represent the lower and upper bounds, in mm, of the 4th order Butterworth band pass filter.
The cylinder inclusion phantom was processed using both algorithms in order to evaluate their overall reconstruction efficiency. The reconstructed maps for LFE and AHI using the N -G and the S-G approach at 200 Hz excitation frequency are shown in Figure 5.15 (c)-(e). Since the wave data (Figure 5.15 (b)) already shows a significant difference in wavelength in the cylinder medium, the difference in stiffness from the algorithms was generally well succeeded in all cases. The LFE method produces smoother maps with a higher SNR, but wave attenuation seen in the cylinder causes non-uniform stiffness estimation throughout the whole structure.
Boundary artefacts and noise are more problematic in the AHI algorithms. In order to obtain the influence of the S-G filter in derivative estimation, Figure 5.15 (g) shows stiffness profiles obtained with different window sizes and polynomial orders.
Finally, the graph in Figure 5.16 was obtained from the spatial mean stiffness values of ROIs placed in the background and in the cylinder. Although there is a significant degree of dispersion in stiffness quantification, we can see that all methods follow the same trend, for the background and for the inclusion.
Figure 5.15. Cylinder phantom at 200 Hz excitation frequency. (a) T2-weighted magnitude image; (b) real part of the complex wave image; (c)-(e) reconstructed elasticity maps using the AHI N-G, AHI S-G and LFE methods, respectively; (f) plot of image profiles of the expected G' and what was obtained with the 3 reconstructed maps; (g) image profiles for the AHI S-G algorithm varying polynomial orders and pixel window lengths.
10
150	200	250	300
mechanical frequency (Hz)
350	400
Cylinder phantom stiffness evaluation
30
40 -
20 -
—El
— AHI(NG) background AHI(NG) cylinder ■e— LFE background ■e— LFE cylinder ■* AHI(SG) background AHI(SG) cylinder
Figure 5.16. Spatial mean G’ values determined using different computational algorithms in ROIs placed both in the background and cylinder at 100, 200, 250 and 350 Hz mechanical frequency stimulations.

5.3.3.	Rheometer measurements of homogeneous phantoms
The amplitude sweeps on the three phantom specimens was performed at 10 rad/s to ensure determination of G* in the linear viscoelastic regime. Figure 5.17 presents the strain
sweeps obtained with the ARES. Hence, the dashed line sets the strain limit (y=0.5% for all 3 phantom specimens) used for the frequency sweeps.
Figure 5.17. Amplitude sweeps of the homogeneous phantoms (a) 1:1, (b) 1:2 and (c) 1:3 at 10rad/s. The limit of linear viscoelastic behaviour of the samples is marked by the black dashed line on each graph.
1 1 1	
. .. ...... ... 1 •,	A’’ ++++++++++++... .1...	** • N
4-	1 1 1 1	
1 1 1 1	
1 1 1	
	1" 1 	1		
	1" 1 1 +H ■ ■ ■ 1 1 1	+
1 1 1 1	
The set of measurements presented below result from the application of the four viscoelastic models (Voigt, Maxwell, Zenner and Springpot (SP)) to the acquired G' (blue) and G” (red) variations with frequency from the ARES rheometer on the homogeneous phantom samples: 1:1 (Figure 5.18). MRE measurements were also plotted for comparison, marked with black symbols. In Figure 5.19, the three types of homogeneous phantom measurements and resulting SP fits are presented for comparison. The derived viscoelastic constants were obtained and are shown in Table 5.1. For all three phantoms, the Springpot model performed the best fit to the rheology data. It is shown that this type of gel has a high elastic component (p values range from 1338.90 to 9258.76 Pa extracted from the SP model) as opposed to a low viscosity component (from the SP fit, the extracted r/ values range from 37.11 to 1217.84 Pa.s). However, viscosity results were inconsistent and the fits were very poor, therefore they should not be taken as definite. Further, the a value is a weighting factor related to the structure of the material extracted from the SP model. Generally, it did not change with gel density variations.
Figure 5.18. Viscoelastic model fits to 1:1 homogeneous phantom on rheology data. G’ results are shown in blue and G’’ results in red. MRE data is represented in black.
Figure 5.19. Springpot fits on rheometer measurements of the three types of homogeneous phantoms: (a) 1:3, (b) 1:2; (c) 1:1. G’ results are shown in blue and G’’ results in red, while MRE data is presented in black markers.
Phantom type	Springpot			Zenner			Maxwell		Voigt	
	P (Pa)	a	n (Pa.s)	p1 (Pa)	p 2 (Pa)	n (Pa.s)	n (Pa.s)	P (Pa)	n (Pa.s)	P (Pa)
1 : 3	1338.9	0.028	1217.8	1005.9	337.9	13291.0	32450.2	1316.5	5.38	1309.9
1 : 2	5469.7	0.048	37.1	3819.9	893.7	791.5	77001.8	4204.2	40.17	4165.8
1 : 1	9258.8	0.032	286.8	6429.5	1906.6	55259.0	19522.7	8122.0	43.74	8078.0
Table 5.1. Viscoelastic constants determined by the Springpot, Zenner, Maxwell and Voigt fits for the homogeneous phantoms 1:3, 1:2, and 1:1.
To judge the quality of the ARES rheometer and validate the implementation of the viscoelastic models, results on the Polydimethylsiloxane (PDMS) were plotted (Figure 5.20). Rheology G' and G" curves were consistent with the literature [69]. A better fit with the Springpot model was obtained, with extracted viscoelastic constants J = 2.21x104 Pa, r/ = 1.31x104 Pa.s and a = 0.37.
Figure 5.20. Viscoelastic model fits on rheology data for PDMS. G’ results are in blue and G’’ results in red.
BOHLIN measurements in the same operating conditions were obtained. Figure 5.21 presents the Springpot fits for the three types of phantom samples. However, in this case, the performance of the machine was questioned, since for frequencies above 10 Hz the measurements were not reliable when compared with the trend obtained (these regions are marked by the black dashed boxes). Consequently, the viscoelastic fits were inevitably biased. Figure 5.22 shows the stability of both rheometers: the regions between the dashed lines limit the area where the ARES had a stable application of strain (Figure 5.22 (a)) and where the BOHLIN used a constant stress at all frequencies (Figure 5.22 (b)). The flatter, more regular regime in the first graph, support the use of the ARES for rheometry testing over the BOHLIN.
Figure 5.21. Bohlin rheometer measurements on the 1:1, 1:2, 1:3 homogeneous phantoms with springpot fit to the datasets. G' results are shown in blue and G'' results in red. MRE results are also represented in black symbols. Rheometer measurements inside the black dashed line are compromised.
ARES rheometer stability
BOHL IN rheometer stability
------phantom 1:1
------phantom 1:2
phantom 1:3
o
10
frequency (Hz)
o	1
10 10 frequency (Hz)
-------phantom 1:1
-------phantom 1:2 phantom 1:3 I
,l
Figure 5.22. Rheometer stability: (a) ARES and (b) BOHLIN. The dashed lines represent the frequency band in which the performance of the rheometer is not compromised.
5.3.4.	Brain data evaluation
For brain MRE experiments, five volunteers’ data were evaluated in a 2-D approach for 5 slices located above the third ventricle. Both algorithms (AHI implemented with the N-G algorithm) were tested with the same pre-processing filtering technique and inversion parameters for each brain slice. An example of the outcome of the inversion process is
depicted in Figure 5.23. Averaged results obtained for brain G'measurements over the five healthy volunteers are presented in Figure 5.24. Each subject’s measurement resulted from an average over all 5 slices. Whole brain analysis was processed excluding the ventricles in order to be comparable with literature results. Finally, in Figure 5.25 nine different filter types were tested in brain data at 75 Hz and spatial mean G' measurements were obtained from maps processed with the AHI and LFE methods.
Figure 5.23. (a) Real part of the complex wave amplitude maps of one volunteer after temporal Fourier transformation at the 5 driving frequencies. The images were scaled according to the factors shown on the bottom
right corner. (b) and (c) represent the reconstructed maps using the AHI and LFE algorithms respectively.
Figure 5.24. Mean and standard deviation G' results obtained from the brain experiments using the AHI and LFE processing schemes. These values originate from an average over all subjects. For each subject, the mean G' value over the 5 slices was taken.
Figure 5.25. Filter variations with the type of algorithm used for reconstructions in brain. lc and hc represent the lower and upper bounds, in mm, of the 4th order Butterworth band-pass filter.
5.4.	Discussion
In this chapter AHI and LFE techniques were studied to assess their ability to reconstruct elasticity maps.
Software phantom evaluation enabled the study of noise, damping and some wave interference effects. It was demonstrated that the LFE process is more affected by noise even with low pass filtering methods, since the standard deviation of the G' estimates were higher for this technique. Also, with respect to damping, as expected the AHI process had a better performance. LFE methods overestimate G' results when the signal amplitude is poor since it does not account for the influence of attenuation in the model itself.
Compressional waves were added to the software phantoms in order to assess the ability of a high-pass filter to overcome these interference effects. The observed results indicate a lower standard deviation of G' values (a more accurate estimation of the mean phase velocity) by the AHI process, due to the fact that the unwanted frequency components are discarded after temporal Fourier transform.
Finally, some oriented waves were superimposed to judge destructive and non-destructive interference. It was found that, when two waves are travelling obliquely, their superposition will generate a combined wave with low amplitude that consequently will underestimate G' overall by both algorithms . This is a possibility when applying motion in abdomen regions, where the shear wave propagation is generalized throughout various slices, which may cause
internal organs to create different wave orientations destroying the wanted shear wave components for correct G' estimation.
When applying the algorithms to real MRE data, pre-inversion filtering was also studied. Preferably, a 4th order Butterworth band-pass filter with lower and upper thresholds adapted to the type of medium and frequency should be used. Propagating waves with higher wavelengths are more sensitive to the filter due to the filter’s non-linear performance. This can be seen in the graph of Figure 5.12. Thus, for example, in brain or liver studies, where very low frequencies are applied and waves generally propagate with higher wavelengths, the correct use of the filter is an absolute requirement. It was found that the high-cut wavelength of the filter should be chosen as the maximum wavelength that waves can travel on that medium, i.e., it can be approximated by the number of pixels of one wave period multiplied by the pixel dimension of the image.
Pre-inversion filtering was found to be most critical for the Local Frequency Estimation algorithm since a high variability was verified when using different filter cut-off values. This is due to the fact that filtering is done in temporal domain to each time offset map, as opposed to a single harmonic map in the AHI method. A bias is introduced to each phase difference image, which is subsequently enhanced with inversion procedures.
Reconstructed maps of the cylinder-inclusion phantom showed that the current inversion techniques are able to obtain elasticity measures from regions with localized stiffness differences. The LFE algorithm performs better in terms of SNR. For the AHI, the temporal FFT induced some noise; however Laplacian estimation is responsible for most of image quality reduction and appearance of boundary artefacts.
For this set of data, the type of derivative estimation was also studied. It was observed that the numerical gradient approximation produces less noisy data compared to the S -G approach. For the latter, ideally a lower polynomial order and a broader window length would produce the smoothest results, but underfitting becomes an issue and spatial resolution is lost. This would represent loss of signal in the stiffness maps. As a compromise, a fixed five pixel length window with a third order polynomial filter should be used in this situation. Still, the results showed that this method is the least successful in reconstructing the full cylinder’s stiffness.
None of the algorithms seemed affected by wave orientation propagation, as was generally shown in the software phantom studies. However, wave attenuation within the cylinder (Figure 5.15 (b)) influences LFE algorithm: the cylinder stiffness reconstruction presents discontinuities related to this problem. Nonetheless, although the AHI algorithm accounts for attenuation, reconstruction shows sensitiveness to the cylinder’s boundaries.
Rheometer measurements were made from samples of the gelatine phantoms with three different stiffness types. It was shown that the viscosity factor in the phantoms is very low, thus being essentially an elastic gel. Also, the MRE data had a slight offset to the trend created by the viscoelastic fits on the rheometry data. This might be due to the induced processing artefacts in MRE that will overestimate the viscoelasticity of the media. Other factors like the type of rheometer used and the quality of the measurements can be discarded since these were likewise assessed.
Brain was chosen for in-vivo stiffness evaluation experiments since it presents rich tissue-type variation and anisotropic regions throughout the field of view. The model’s isotropic assumption is not verified though the whole brain volume, hence both methods will partially fail. The LFE method is further influenced by assuming no attenuation in the medium. These effects can be observed in the wave data of Figure 5.23 (a). The amplitude in microns of the shear waves in the brain shows wave damping towards the centre essentially due to different orientation of white matter tracks. It is also important to point out that the higher the mechanical frequency, the lower the wave amplitude (at 25 Hz typical wave amplitude is in the order of 50 ^m, whereas at 75 Hz the waves only present up to 10 amplitude). Reconstructions derived from both algorithms show clear tissue type stiffness distribution and differences with increasing driving frequencies. As expected, the ventricles show very low stiffness directly related to its high concentration in water content. Comparing both algorithms, the LFE produced again smoother reconstructed maps but the problem of overfiltering, (caused both by the lognormal filters, and the pre -inversion filtering) might be responsible for the bias observed between the LFE and AHI brain elasticity measures. Also, attenuation is a big issue within the LFE algorithm that can cause these deviations s een in the graph of Figure 5.24. The AHI reconstructed maps are much noisier as expected. In particular, at lower frequencies the algorithm estimates regions with negative-valued stiffness that had to be forced to zero. However, the sharpness increases, having a clearer definition of WM and GM regions.
5.5.	Chapter Summary
Overall both algorithms studied, the Algebraic Helmholtz Inversion and the Local Frequency Estimation methods, produced similar results in phantom and brain data. Phantom studies were essential to point out some technical drawbacks in both techniques. Also, this study showed that not only the type of direct inversion technique used will affect the quantification of stiffness of a tissue, but also the processing scheme. The methods and
parameters chosen for spatial filtering and estimation of derivatives are very important and should be used carefully.
Rheometry proved the general overestimation of measurements obtained with MRE. This is a great disadvantage of the DI algorithms to quantify elasticity. Moreover, when applying them to tissue such as brain, stiffness quantification is still far from perfect. Assumptions made of the medium such as isotropicity are not applicable in this situation, thus the stiffness reported will be very subjective.
Chapter 6.
In-vivo AHI Analysis in MRE
6.1. Introduction
One of the most important achievements of planar 2-D MR Elastography has been the non-invasive parameterisation of elasticity and viscosity for in vivo tissue, producing a new MR imaging biomarker with great potential for diagnosis. [50]
As was discussed in Chapter 5, an effective processing scheme for measuring tissue stiffness is the use of the Algebraic Helmholtz Inversion. The purpose of this chapter is to first clinically investigate mechanical properties of healthy brain tissue, studying the white matter and grey matter stiffness differences, as well as extracting its Lame coefficients. Also, a pilot experiment was taken upon to study aging effects, in order to identify trending patterns on viscoelastic parameters, while comparing with previous findings reported in literature.
Further on, liver MRE is also here explored on healthy subjects. During the last decade MRE has been developed into the most accurate imaging modality for staging hepatic fibrosis [24]. However, the long scan times imposed by the long TR (around 100 ms), gradient echo
(GRE) sequence routinely used may make the imaging procedure uncomfortable for the patient. This limitation could be mitigated by the use of the single shot sequence such as the SE-EPI, promising fast acquisitions that could be easily integrated on a routine liver diagnosis protocol. However, some drawbacks related to low bandwidth along the phase encoding axis will cause several difficult artefacts due to fat-water chemical shifts to occur in EPI [70-72]. Also, the fast on and off switching of the gradients result in current induction effects called eddy currents. This turns out to be a severe problem in EPI. The gradient amplitude and particularly the gradient switching rates are much greater and induce larger eddy currents. A common artefact resulting from the frequency shifts induced by time-dependent eddy currents is called ‘ghosting’. These problems were he re addressed when treating data, and what effects they might cause on the computed viscoelasticity.
The quality of mechanical excitation is also explored in abdominal regions. Dealing with soft tissue in the abdomen will induce a variety of shear waves. We exploit this issue by comparing data of two excitation induction types: low and high quality. Likewise, wave interference due to the beating heart is a variable also to take into account when imaging abdominal regions. Even at low frequency, the heart can induce phase shift artefacts felt in phase images potentially leading to processing errors.
Finally, as overall measurements, a group analysis comprised of healthy volunteers is made, to parameterize liver, spleen and kidney elasticity, and compare with previous reported findings.
6.2.	Healthy Brain Study
6.2.1.	Methods
6.2.1.1.	Wave image acquisition
For this study, MRE data was obtained from nine healthy volunteers with no reported health conditions (3 female; aged from 19 to 62 years) acquired with a Siemens 3T Verio system using the same imaging protocol as for the previous chapter. Details on the acquisition parameters can be found in Appendix A and volunteer personal information in Appendix B. The typical applied mechanical frequencies for these experiments were 25.0, 37.5, 50.0, 62.5 and 75.0 Hz (a 100 Hz trial run was also performed for one of the subjects).
6.2.1.2.	Data processing
Elasticity and viscosity maps were obtained using the planar 2-D algebraic Helmholtz inversion approach described previously in section 4.2.1 of Chapter 4; all image processing was operated using MATLAB (The MathWorks Inc., Natick, USA).
For each brain slice, the unwrapped phase data was Fourier transformed on the timeoffsets for each spatial position. The resulting complex wave image at excitation frequency, U(r, w), was filtered with the Butterworth band-pass filter. The isotropic cut-off values were chosen according to the frequency dependent wave propagation method discussed in the previous chapter; Table 6.1 presents the values used in these studies. For inversion and determination of the complex shear modulus, the Laplacian terms of equation (3.11) were computed using the numerical gradient estimation.
Frequency (Hz)	Low-cut wavelength (mm)	High-cut wavelength (mm)
25.0	1.26	10.10
37.5	1.13	8.26
50.0	1.09	5.49
62.5	1.07	4.59
75.0	1.06	3.68
100.0	0.92	3.46
Table 6.1. Isotropic lower and upper threshold wavelengths used on the spatial Butterworth band pass filter for brain experiments.
Regularization methods consisted on forcing negative values on the storage and loss modulus maps to zero, and eroding a three pixel border from the images boundaries. Finally, the median filter was used with a 3x3 window to smooth the final images.
In order to evaluate white matter and grey matter brain stiffness, the T2-weighted magnitude images from the MRE dataset were used to build tissue-type ROIs. A 3-region based segmentation was obtained with the FAST Segmentation tool of FSL (http://www.fmrib.ox.ac.uk/fsl/index.html). Therefore, for each brain slice, spatial mean values of G'and G"of whole brain (excluding the ventricles), WM and GM separately were determined. It should be noted that the G and G maps with eroded borders were the ones used to subsequently obtain segmented tissue-type G' &amp;amp; G"measures. Essentially, this will affect GM to be eroded such that only inner GM regions are considered, not being influenced by the Laplacian induced artefacts of the processing algorithm.
Finally, an average over all five slices was taken to improve levels of confidence. G' and G" results were then related to the rheological models (equations (2.13) to (2.16)) where an overall quantification of brain, WM and GM viscoelasticity can be obtained. The number of
free parameters varied with the type of model used. For the Voigt and Maxwell models, J and n were the parameters fitted. As for the Zenner and Springpot models a 3-parameter fit was chosen: for the Zenner model the Ji, J2 and n were fitted and for the Springpot the fitted parameters were J, n and a.
6.2.2.	Results
6.2.2.1.	Quantification of brain tissue elasticity and viscosity
A volunteer was subjected to six different vibration frequencies (25, 37.5, 50, 62.5, 75 and 100 Hz) and the results of the processing with WM and GM G’(Figure 6.1) and G" (Figure 6.2) variations are shown. The high damping experienced at 100 Hz (Figure 6.1 (a)) made the processing not very effective. Thus, this frequency was not included on the MRE imaging protocol for the rest of the volunteers.
Figure 6.1. MRE data processing of a single subject at six vibration frequencies (25, 37.5, 50, 62.5, 75 and 100 Hz). (a) Wave displacement in microns, scaled according to the factors shown on the bottom right corner. The images were scaled according to the factors shown on the bottom right corner. (b) G' estimation with AHI algorithm; (c) segmented white matter G' maps; (d) segmented grey matter G' maps.
25.0 Hz
37.5 Hz
50.0 Hz
62.5 Hz
75.0 Hz
100Hz
G’(kPa
— 7
• L *
j *
’ 4
V ■	'	•
*
A
* ’ I*
	25.0 Hz	37.5 Hz	50.0 Hz	62.5 Hz	75.0 Hz	100Hz		
(a)	( t /	* ' «t *■ /	r •,		,"•5	. r &gt;	. &gt;.		
		•	V • • •	L,’ &amp;lt;• ’ • *• 4	• _	i	•			
(b)	✓ ♦ *	*	;J» B	Ci . - / , -• • *	/-X	, x		G'(kPa) ■ ' 6	
	*	j|	•					5
								4
(c)				1 • %	r, .. ' ' •	1 - k *		3
				’ 7	• *•$		■	2
		*	*■.	* ■ •				
		a			i	•	-J ■		1
				*	A			I	
Figure 6.2. (a) G" estimation with AHI algorithm; (c) segmented white matter G" maps; (d) segmented grey
matter G" maps.
For the remaining five chosen frequencies, AHI processing results for whole brain excluding ventricles, white matter and grey matter G’ and G" are shown in the graphs of Figure 6.3. There is a significant differentiation in tissue stiffness and viscosity between WM and GM, generally following the same trend at all frequencies. Table 6.2 depicts the mean (standard deviation) values of these results.
Figure 6.3. Average storage modulus (a) and loss modulus (b) obtained from brain MRE experiments on nine subjects at the 5 chosen frequencies. For each subject, brain excluding ventricles (blue), WM (red) and GM (green) G' and G'' was measured with a 2-D inversion process for each slice. The average over all slices was taken as a global value for each subject.
Loss Modulus
frequency (Hz)	G' (kPa)	G" (kPa)	WM G' (kPa)	GM G' (kPa)	WM G" (kPa)	GM G" (kPa)	WM/GM G'	WM/GM G"
25.0	0.77 (0.13)	0.40 (0.10)	0.87 (0.16)	0.66 (0.11)	0.43 (0.10)	0.35 (0.08)	1.32	1.23
37.5	1.14 (0.23)	0.52 (0.09)	1.25 (0.28)	0.98 (0.18)	0.58 (0.10)	0.46 (0.09)	1.28	1.27
50.0	1.45 (0.21)	0.65 (0.12)	1.57 (0.24)	1.29 (0.18)	0.69 (0.13)	0.58 (0.11)	1.21	1.19
62.5	1.86 (0.17)	0.77 (0.10)	1.96 (0.18)	1.71 (0.18)	0.81 (0.10)	0.70 (0.10)	1.15	1.16
75.0	2.18 (0.17)	0.79 (0.09)	2.27 (0.17)	2.05 (0.17)	0.84 (0.10)	0.71 (0.09)	1.11	1.19
Table 6.2. Mean (standard deviation) G' and G" results obtained from the brain experiments to assess WM and GM elasticity. These values originate from a mean over all subjects. For each subject, the mean G' &amp;amp; G" value over the 5 slices was taken.
To extract the Lame coefficients, the four studied viscoelastic models so far were used to fit the brain MRE results obtained by AHI processing. (Figure 6.4) Whole brain as well as tissue-type based fits were applied to observe trends in the obtained parameters. Table 6.3 shows the acquired viscoelastic results for the different structures. Observing the plots, the more accurate models that fitted the data were the Zenner and Springpot models. Still, the large deviations between the estimated curves and MRE results demonstrate that these model equations are too simplistic for this type of data.
Figure 6.4. Viscoelastic model fits on brain, GM and WM G' and G" measurements (a) Voigt fit; (b) Maxwell fit; (c) Zenner fit; (d) Springpot fit.
Model		Tissue Type		
		Brain	White Matter	Grey Matter
Voigt	H (kPa)	1.49	1.59	1.35
	n (Pa.s)	12.14	13.00	10.95
Maxwell	H (kPa)	1.92	2.04	1.75
	n (Pa.s)	74.31	80.49	65.57
Zenner	U1 (kPa)	0.87	0.94	0.78
	(kPa)	1.58	1.68	1.46
	n (Pa.s)	26.44	27.77	24.14
Springpot	H (kPa)	2.08	2.20	1.91
	a	0.28	0.28	0.28
	n (Pa.s)	19.48	21.06	17.10
Table 6.3. Extracted model coefficients for brain, and white and gray matter, separately.
6.2.2.2.	Aging brain: a pilot study
The pilot group study presented concerns a population of nine healthy volunteers, with ages ranging from 19 to 62 years. In Figure 6.5 linear age trends were observed at all five frequencies for the spatial mean G' measures.
Figure 6.5. Scatter plot of the G' measurements at the 5 driving frequencies for the 9 volunteers according to their age. Linear fits were plotted at each frequency and are represented by the colored lines.
Thus, SP derived viscoelastic constants were obtained from individual fits to each of the volunteers G' and G'' measurements, and then plotted according to the age variable (Figure 6.6). Although the population group is very small and with a low mean age value, statistically significant linear trends with negative slopes were observed for the shear elasticity and the
shear viscosity. In contrast, the alpha factor did not present any significant variations with age. Subsequently, linear regressions were experimented on individual tissue-type shear modulus, i, and shear viscosity, r/, according to age (Figure 6.7). The annual decay rates extracted from the regressions were: for shear elasticity WM -0.56% (R2=0.86) and GM -0.50% (R2=0.66), while for shear viscosity WM -0.41% (R2=0.74) and GM -0.39% (R2=0.60).
Figure 6.6. Extracted Springpot coefficients of each volunteer’s data according to age: (a) shear elasticity in kPa,
(b) shear viscosity in Pa.s and (c) weighting factor a. A linear trend is plotted for each graph in red.
Figure 6.7. Linear regressions on WM and GM Springpot parameters: (a) shear elasticity in kPa and (b) shear viscosity in Pa.s.
6.2.3.	Discussion
The previous chapter compared AHI and LFE algorithms on brain data. Both demonstrated effective in differentiating white matter and grey matter elasticity. However, the sharpness obtained with AHI produced a clearer definition of WM and GM regions. Moreover, the LFE method does not account for wave attenuation, most of the times overestimating the elasticity results. Thus, in this chapter, the complex wave inversion preocess was chosen to parameterize tissue elasticity, by taking the spatial average over tissue type segmented ROIs.
Green et al. (2008) [30] report higher stiffness in grey matter than in white matter. However, in accordance with other published studies ([29], [73], [74]) white matter was found stiffer and more elastic than grey matter at all driving frequencies. Also, WM/GM G'and G" ratios demonstrate that the higher the frequency, the lower these ratios are, i.e. a larger WM-to-GM stiffness difference is obtained for lower frequencies. This might be due to the reduced attenuation effect at these lower frequencies, and fact that the signal is not lost in deeper brain regions. The SP model produced better fits to the measured G' and G''. The elastic modulus found for brain matter (2.08 kPa) is in accordance to what was obtained by Sack et al. (2009), where a healthy group of subjects aged between 18 and 59 years old yielded an average J of 1.94±0.39 kPa [32]. White matter and grey matter’s stiffness modulus was also extracted and produced values consistent with a higher elasticity in WM. The alpha parameter remained unchanged for all brain regions and the second Lame constant for brain revealed a value of 19.46 Pa.s.
The low consistency and variety of shear modulus data obtained with MRE and indentation techniques for brain over the last few years reveals the subj ectivity of the methods. The wave analysis methods used here and in most of the studies are still very simplistic and do not adapt to the complex anatomy of the brain: issues like anisotropy have to be taken into account. Also, boundary and partial volume artefacts are observed in the reconstructed maps. These problems are directly related to incorrectly assuming homogeneity within a brain voxel and to the computation of the methods themselves.
Other inversion algorithms that break away from the 2-D planar inversion of the Helmholtz equation have since been developed and applied to brain studies. A hyperelastic approach is explored by Kaster et al. (2006) [74] on ex vivo brain tissue slices. Hamhaber developed a novel method using 3-D wave field acquired with EPI-MRE [44]. Romano and his colleagues introduce a new concept, waveguide elastography, that combines Diffusion Tensor Imaging (DTI), MRE, spatial-spectral filtering, a Helmholtz decomposition and inversions for the assessment of anisotropic elastic constants [42], [75]. Recently, Papazoglou
et al. developed a multifrequency wave inversion as a method to calculate viscoelastic parameter maps from time-harmonic wave data at different oscillation frequencies still relying on the direct Helmholtz inversion approach [76]. However, the effectiveness together with simplicity of the AHI technique in quantifying relative stiffness and viscosity is definitely a great advantage. It enabled a series of clinical studies in brain diseases such as the study of normal pressure hydrocephalus [31] or chronic-progressive multiple sclerosis [37].
The aging study carried out in the current project, was based on a group of only nine healthy volunteers within a relative small age range. However, differences in the Lame constants were already detected . The study published by Sack et al. in 2011 with 66 volunteers aged from 18 to 72 years showed that there is a prominent statistically significant decrease in elasticity with age: a loss on an annual rate of -0.75% (R2=0.59) [65]. The annual rate loss in elasticity found in this pilot study was lower: the predicted rate was -0.46% (R2=0.81). This can be explained by the shorter age range limiting the measurements to younger individuals. Moreover, the alpha factor remains steady indicating that the geometry of the mechanical tissue matrix does not suffer apparent changes. Viscosity, however, showed a decay rate of -0.58% (R2=0.83) per year in brain.
Considering individual tissue type alterations, no immediate conclusions can be made on the viscoelastic decay slopes between WM and GM. Although the WM presents slightly higher decay rates compared to GM, these are not statistically significant. However, results might also show that the model together with the processing algorithm are not sensitive enough to detect these changes.
With this preliminary study we demonstrated that MRE can be effective in predicting biomechanical changes in the brain with age. Although structural integrity might be preserved as the brain ages, damaged neurons and/or fibre connections due to loss myelin may atrophy the mechanical environment making the brain more soft and gelatine-like, with a higher water content. However, it still remains to understand how WM and GM independently loose its rigid properties over the lifespan.
6.3.	Abdominal MRE
Development and reproducibility studies of the processing scheme were also exploited with AHI-MRE in abdominal organs, namely the liver, spleen and kidneys. Here, viscoelastic constants are parameterized for healthy subjects. The protocol and acquisition parameters are a major factor when imaging these abdominal regions. The natural breath-hold time limit (around 20 seconds) constrains the echo time, thus EPI based sequences will suffer
significantly with ghosting and distortion artefacts. These issues along with high frequency damping in liver and heart interference waves were examined on what effects they might cause within an AHI G' and G" estimations.
6.3.1.	Methods
6.3.1.1.	Abdominal wave image acquisition
The piezoelectric actuator with an attached wooden rod (Figure 3.3 (b)) was used to generate motion in the tissue of interest. Placement of the passive actuator (wooden rod’s end) was around the 7th or 8th rib as shown on Figure 6.8, so as to use the ribcage as a diffusive mechanism of the shear waves throughout the abdominal region.
Vitamin marker
Placement of passive actuator y&amp;lt;b)
Imaging region v	.
Figure 6.8. MRE of the abdomen. (a) Model with location of the imaging region in respect to the passive actuator.
(b) Structural image slice acquired to locate the vitamin marker which points the position of the passive actuator.
Five healthy volunteers without any history of liver disease (4 female; mean age of 30.6 years; BMI index characteristics of non-overweight/underweight individuals) were scanned on a 3T MRI scanner (Magnetom Verio; Siemens, Erlangen, Germany). The study protocol was approved by the ethics committee and the volunteers were enrolled after giving written informed consent. First, 24 slices of a T1-wheighted FLASH sequence were acquired in order to localize the liver tissue and the passive actuator (observed in images by placing a vitamin E capsule appearing bright on the structural scans) (Figure 6.8 (b)). MRE images were then acquired using the modified single-shot spin-echo, echo planar sequence with added motion encoding gradients (1-2 cycles; 40mT/m) in the through-plane direction synchronized with the mechanical motion. General imaging parameters were: matrix size=128x128, pixel size=2.3x2.3mm, slice thickness=10mm, phase offsets=16, TR=1600ms and TE=50-56ms19.
19	For one of the volunteers the field-of-view was reduced: matrix size=128x96; pixel size=2.7x2.7mm.
Due to EPI ghosting constrictions the number of slices obtained between volunteers varied from 1 to 5. These were positioned around the location of the passive actuator. Five to six suppression bands were used on two of the volunteers to reduce ghosting problems.
Four runs were obtained corresponding to four monochromatic vibrations on the tissue: 50.0, 62.5, 75.0 and 100 Hz. Acquisition time for each run was around 20 seconds, during which the volunteer was asked to hold breath in expiration.
6.3.1.2.	Image processing and evaluation
For each selected slice, an AHI based algorithm was chosen to process the data programmed in MATLAB (The MathWorks Inc., Natick, USA). Phase images were first unwrapped and then scaled to values in the range of -k to k,&amp;lt;p (x,y,t) . After manual ROI selection of the entire abdominal section, to each spatial point, the temporal Fourier transformation was performed and the first harmonic vibration was spatially filtered using the spatial 2-D 4th order Butterworth band-pass filter with frequency dependent isotropic thresholds (Table 6.4). Using equation (2.11) the complex modulus was estimated from the harmonic data. The same regularization measures described for brain MRE processing were here applied.
Finally, still for each individual slice, manual ROIs were placed on the tissue of interest (liver, spleen or kidney), to determine tissue type elasticity and viscosity. The average taken over all slices is presented as the overall result for each individual at a determined frequency. The Zenner and Springpot rheological models were experimented on the computed interindividual mean G' and G'' values with three free parameters, and extracted viscoelastic constants were parameterized.
Frequency (Hz)	Low-cut wavelength (mm)	High-cut wavelength (mm)
50.0	1.11	4.69
62.5	1.06	3.52
75.0	1.03	2.80
100	1.01	2.34
Table 6.4. Isotropic lower and upper threshold wavelengths, in mm, used on the spatial band pass filter for liver experiments.
6.3.1.3.	Image quality tests
Ghosting. The sequence chosen for abdominal MRE experiments was EPI based. The major advantage of this sequence is the well-known gain in acquisition speed, such that 16 time
Thus, phantom images were acquired with the modified EPI-MRE sequence where no mechanical excitation was induced. The phantoms were constructed to include most of the tissue type structures that surround the liver: fat (regular bottled sunflower oil) and water (two bags of saline solution for intravenous infusion). Liver tissue was also reproduced using a 9% NaCl solution ball. Figure 6.9 (a) shows a schematic of a transverse slice demonstrating how these structures were organized and how they will appear on the structural scans. Saturation bands were located around the liver to suppress water and fats, saving the “liver” contents (Figure 6.9 (b)).
Figure 6.9. (a) Schematics of a transverse slice showing the location of the phantoms used the tests. (b) Location of the five saturation bands.
Low quality mechanical stimulation. Shear wave propagation in tissue also requires attention, as it can also be responsible for a wrong estimation of viscoelasticity.
This problem was first evaluated applying two approaches on acquired MRE data excited with the piezoelectric actuator device. In the first approach, ROIs covering the whole liver were used to estimate the spatial mean G’ and G”. As an alternative, the portion of the liver where high intensity waves are detected is manually selected to estimate the viscoelastic parameters. Both of these approaches were tested on all slices of all volunteers.
Another experiment was carried out where the piezoelectric performance is compared to a lower quality mechanical actuation device. (Figure 6.10) A custom pneumatic actuator was built based on the design of Ehman (US Pat. 7,034,534 B2) [39], consisting on a commercial active subwoofer driven by a function generator, both placed outside the magnet room. The sound waves produced in the loudspeaker were transmitted through a PVA hose measuring 23mm of diameter and 6m of length. A plastic bottle was attached to the end of the hose to act as a passive actuator onto the tissue of interest.
Figure 6.10. Schematics of acoustic actuator prototype for MR Elastography.
The actuator has a lower mechanical performance, since the vibrations produced carried background noise and very low amplitude periodical motion, in comparison with the equivalent commercialized product, MRE-Touch by Mayo Clinic, or even the piezo-device routinely used in the present experiments (Figure 6.11). The volunteers were also tested with the custom-built device, with the same imaging protocol, and images were analyzed in the same manner at all frequencies.
(a)
Figure 6.11. Vibration tests made with an accelerometer to three oscillation devices: the commercialized MRE-Touch device from Mayo clinic, the low quality subwoofer acoustic actuator prototype and the piezoelectric device. (a) Schematic of the measurement setups. (b) Acceleration values measured in the three spatial directions over 16 wave periods. Vibrations were induced by the devices at 50 Hz.
(b)	2000
MRE-Touch Acoustic Setup
Acoustic Prototype Setup
Piezoelectric Setup
Heart beat interference. At rest, a normal heart beats at a frequency of around 1.17 Hz (70bpm). Vibrations at this very low frequency are hardly encoded by the motion encoding gradient in MRE, since this operates on a determined frequency in the range of 25-100 Hz. Still, to test this particular artefact an abdominal image slice containing a visible portion of the heart was analysed.
6.3.2.	Results
6.3.2.1.	Image quality tests
Results of images acquired using the modified EPI sequence without and with saturation bands to test the ghosting artefacts are observed in Figure 6.12.
LK'CrvsFat Lr.t» v» Water Wot» V5 Fat	LiuerusFat Lrver v» Water 'Aater v* Fat
Figure 6.12. (a) Phase offsets acquired with no mechanical stimulation on the liver setup. (b) Corresponding amplitude images without and with fat saturation bands. Blue/Red dashed squares show the location of the ROIs for SNR and CNR measurements. (c) Contrast-to-noise ratios for the different phantom structures for the three imaging slices.
From the magnitude images, Figure 6.12 (b), ghosts of each of the structures are clearly visible on the borders of the field of view. Ghosting due to water and fat are more problematic since these appear bright on the magnitude images and are of no clinical interest. However, saturation bands will cut the majority of the signal of these structures, hence ghosting of these is mostly avoided. The contrast to noise ratios (CNR) were computed by measuring first the standard deviation (SD) of noise, calculated by placing an ROI on a background area of the image that was free from signal artefacts (red dashed squares). Then, CNR was calculated between each of the structures (liver vs fat, liver vs water, and water vs fat) using the
following formula: (S1-S2)/SD, where S1 and S2 correspond to the signal intensity of structures that are being compared and SD the standard deviation of noise. The SNR of each structure was also obtained and is shown in Table 6.5.
slice #			Background	Fat	Liver	Water
		1	2.27	4.24	16.23	3.17
w/o	FB	2	2.54	3.70	17.99	4.44
		3	2.60	3.51	19.67	4.93
		1	2.01	2.00	15.50	0.97
w	FB	2	2.28	1.84	17.36	1.00
		3	2.03	1.65	16.52	0.99
Table 6.5. SNR values of the different phantom structures without (w/o) and with the fat bands. (SNR=mean/std).
It is clear that when saturation bands were used, the water and fat contents had a similar CNR measure. In addition, the middle slice seems to be unaffected by ghosting, producing a better distinction between the liver and the other structures (CNR is higher and the SNR of the liver had also a higher estimation).
Figure 6.13 shows objective differences on in-vivo images with the type of slice imaged. The dataset was acquired with five different slices, in which the middle slice (containing the vitamin marker) is located at the isocentre. The fifth slice, one of the furthest away from the isocentre, shows severe ghosting and image distortion. Differences between normal phase wrapping artefacts and distortion artefacts are shown in blue and red, respectively.
Lastly, in Figure 6.14 (a) a dataset is presented with clear EPI related ghosting problems. The abdomen region in the magnitude image is “replicated” on top of the real image with a slight shift which, in turn, disables a clear differentiation of wave propagation in the phase image. However, some techniques were used to suppress the ghosting and the result is shown in Figure 6.14 (b). The FoV was modified in the read-out direction and saturation bands were placed on the surroundings of the abdomen. With these techniques, the liver structure is recuperated within the phase image, yet some noise is still present.
Figure 6.13. Different imaging slices of one phase offset of a liver MRE dataset. The isocenter is located at slice number 3. Slice 5 shows difference in the liver between normal phase wrapping (blue region) and loss of signal due to ghosting (red region).
Figure 6.14. (a) Liver dataset presenting ghosting problems and image distortion. Corresponding phase offset showing no delineation of liver or wave propagation. (b) Improvements of the previous acquisition: different Field of View and application of fat saturation bands.
To test how the mechanically induced oscillations affect G' and G'' estimations, analysis of whole liver is compared with an analysis only on the portion of the liver where strong amplitude vibrations are detected. Mean and standard deviations at the three induced frequencies are plotted in the bar graphs of Figure 6.15.
Figure 6.15. Bar plot of liver MRE G' and G" results at 50, 62.5 and 75.0 Hz. Blue bars: ROIs would always include the entire liver region. Red bars: ROIs drawn only on liver region where full wave propagation was found.
Differences between both sets are detected in the extension of the error bars, i.e. the standard deviation between individuals. The absolute mean values are higher when using the partial liver analysis, but are not statistically significant, since the new G’ &amp;amp; G" measurements are in the range of the whole liver standard deviation bars. This demonstrates the effectiveness of the AHI algorithm to accurately estimate mean values of elasticity and viscosity with a quality device in organs such as liver, where vibrations propagate in unusual patterns and attenuation is very high.
Figure 6.16 shows stiffness comparison between the piezoelectric device and the lower quality acoustic prototype.
Figure 6.16. Comparison between the piezoelectric and custom-built pneumatic mechanical stimulation. (a) Results obtained on an individual that was subjected two the two types of mechanical stimulation. For each frequency, wave propagation maps are shown first, and respective stiffness maps are shown on the bottom. (b) Interindividual averaged G’ results of the whole liver (WL) and partial liver (PL) with both devices.
The wave propagation maps using the acoustic device illustrate that there is a very low wave amplitude in most of the frequencies due to factors such as small amplitude range of the applied displacement (Figure 6.11 (b)) and a non-synchronism with the MEG.
Wave propagation artifacts induced by the beating heart were analyzed and are presented in Figure 6.17. Even with beating at very low frequency, residual artefacts can still be detected over the time course of the displacement images (Figure 6.17 (a)). The result of the interference of both wave types (heart beat and the mechanically induced shear waves) is destructive, as can be seen by the red line plot in Figure 6.17 (c). It was shown for phantom data that destructive interference usually causes underestimation of the obtained results using AHI methods (discussed in Chapter 5). More zero-valued regions were found around the heart area on the estimated real and imaginary G* maps (Figure 6.17 (b)). Also, higher attenuation was felt adjoining the heart ventricles. To avoid this, slice selection of the abdominal data is limited to lower liver regions, where these interference effects were minimized or nonexistent.
Figure 6.17. Study of heart interference waves: (a) displacement images of 8 time points; (b) magnitude, G’ and G’’ of the analyzed dada; (c) plots of the displacement against time of two chosen spatial points (P1 located around the blue marker, P2 in the red marker of the magnitude image).
6.3.2.2.	Quantification of liver elasticity and viscosity
With spatial filters adapted to view full wave propagation in liver, one example of the outcome of AHI processing for abdomen data is presented in Figure 6.18. Excluding 100 Hz, all studied frequencies present a higher stiffness distribution inside the red dotted region
shown in Figure 6.18 (c), representing the liver dimensions. On the other hand, at 100 Hz the stiffness variations from liver to the rest of the abdomen structures was not evident, thus results at this frequency were not included into further viscoelasticity analysis.
Figure 6.18. Abdominal MRE processing results. (a) Magnitude image with liver delineated by the discontinued white ROI. (b) Complex wave images at excitation frequency; (c) Resultant G' maps of the abdomen with delineated liver ROI.
The Zenner and Springpot were the chosen viscoelastic models to fit the obtained frequency dependent elasticity and viscosity for each individual. (Figure 6.19) To have an accurate measure of the liver’s mechanical properties between individuals, G'and G" result from the spatial mean over the liver region where there is significant wave amplitude (Figure 6.20). Then, an average over all slices is obtained.
Figure 6.19. Zenner and Springpot fits from one volunteer’s acquired liver MRE G' and G" results at 50, 62.5 and 75.0 Hz. ROIs drawn in liver region where full wave propagation was found.
Figure 6.20. (a) 50 Hz wave on the liver showing with full wave propagation (b) Damping at 75 Hz enables wave propagation to deeper liver regions, which we rejected from spatial mean G' and G'' estimations.
In accordance to what was already reported, the Zenner model produced a better fit to MRE data, yielding the following viscoelastic constants (intersubject mean (standard deviation)): ^=1.49 (0.13) kPa, g2=1.22 (0.15) kPa and n=19.45 (2.7) Pa.s. The Springpot model’s extracted Lame constants were: g=2.40 (0.23) kPa, n=21.89 (1.52) Pa.s and a=0.18 (0.017).
Previous reported results stand in a slightly lower range. Asbach et al. (2008) [57] presents ^=1.16 (0.18) kPa, g2=1.21 (0.30) kPa and n=7.3 (2.3) Pa.s. Klatt et al. in 2007 [77] published the following Zenner derived parameters: g1=1.36 (0.26) kPa, g2=1.86 (0.21) kPa and n=5.5 (1.2) Pa.s.
6.3.2.3.	Elasticity and viscosity evaluation of the spleen and kidney
The abdominal MR Elastogram enables analysis on other organs besides liver. Therefore, the spleen and kidney’s rheological behaviour were also examined.
Although the actuator was not placed in the optimal position to have high amplitude wave propagation in the spleen, it was possible to detect changes in the viscoelastic moduli with frequency for some volunteers, while processing with the AHI algorithm (Figure 6.21). The spatial filter highcut (hc) wavelengths were positioned to higher values following the longer wavelengths in the spleen. The new filter parameters were: at 50.0 Hz hc=64.4mm, at 62.5 Hz hc=46.0mm, at 75.0 Hz hc=35.7mm and at 100 Hz hc=26.2mm. However, the previous chosen lowcut limits for the liver were maintained for these experiments since noise levels were the same within the whole slice. Due to the small dimensions of the spleen, damping from the border to the deeper tissue regions becomes less evident, thus data at 100 Hz was also processed and included in viscoelastic fits.
Figure 6.21. Results of a volunteer’s MRE spleen experiments. (a) The spleen is marked with a green coloured ROI on the real part of the complex wave images at excitation frequency (b) G' and (c) G" results in kPa. The complex wave images were scaled according to the factors shown on the corresponding bottom right corner.
(a)
Mech. Frequenc y (Hz)	50.0	62.5	75.0	100
G’ (kPa)	2.11	2.47	2.55	3.46
	(0.57)	(0.46)	(0.57)	(0.34)
G" (kPa)	1.72	1.49	1.26	1.37
	(0.42)	(0.31)	(0.28)	(0.11)
cp (m/s)	2.19	2.23	2.31	2.15
	(0.30)	(0.23)	(0.19)	(0.11)
y (1/m)	47.38	45.11	46.78	50.28
	(8.88)	(9.28)	(1.18)	(7.81)
S-3000
Q_
(5 2000 oi
&lt;5 1000
(b)
4000
3000 nJ o_
^5 2000
cS
&lt;5 1000
40	60
frequency (Hz)
Zenner Fit
60
frequency (Hi)
Springpot Fit
+ MRE G-
+ MRE G”
-----model lit G‘
model fit G"
Figure 6.22. (a) Table of mean (standard deviation) values between subjects of the spleen. For each volunteer, the spatial mean value was taken over an ROI placed on the spleen, and subsequently average G' and G" values were taken from all slices. (b) Plots of Zenner and Springpot fits for a volunteer’s G' and G".
For three healthy subjects the spleen was clearly visible in the magnitude images and presented good wave propagation in the phase images, hence these were all assessed to determine the spleen’s mechanical properties. The AHI process yielded the frequency dependent results presented in Figure 6.22 (a). When attempting on the viscoelastic models, better fits were obtained again with the Zenner for all volunteers (Figure 6.22 (b)). Yet, the extracted coefficients from both models were, respectively: p1=1.03 (0.35) kPa, p2=2.43 (0.78) kPa and n=39.63 (6.86) Pa.s for the Zenner model, and p= 3.42 (0.47) kPa, n=29.86 (2.17) Pa.s and a=0.33 (0.035) for the SP model.
As for the kidneys, the location of the MR imaging region only enabled the evaluation of the right kidney, since, for the majority of the population, this is located in a higher anatomical position. Again, for three of the volunteers phase data was viable for processing. Filter high cut-off values were altered according to the maximum empirical wavelengths occurring in the kidney at each frequency (50.0 Hz: hc=69.0mm; 62.5 Hz: hc=46.0mm; 75.0 Hz: hc=34.5mm; 100 Hz: hc=23.0mm).
Averaged AHI extracted results are presented in Figure 6.23 (a). The Zenner and SP models were tested on all subjects (Figure 6.23 (b)) obtaining the following interindividual averaged model dependent complex moduli for kidney: p.i=0.86 (0.21) kPa, p.2=1.98 (0.31) kPa and n=25.40 (8.23) Pa.s for the Zenner model, and p.=2.28 (0.23) kPa, n=19.63 (3.23) Pa.s and a=0.30 (0.032) for the SP model.
(a)
(b)
Mech. Frequency (Hz)	50.0	62.5	75.0	100
G’ (kPa)	0.90	1.28	1.80	2.95
	(0.16)	(0.33)	(0.11)	(0.20)
G" (kPa)	0.58	0.56	0.65	0.86
	(0.27)	(0.07)	(0.14)	(0.07)
cp (m/s)	1.62	1.53	1.60	1.92
	(0.41)	(0.24)	(0.14)	(0.13)
y (1/m)	57.82	62.83	50.10	43.45
	(7.09)	(3.55)	(9.00)	(5.20)
-----model fit G"
rrequency (Hz)
Springpot Fit
* MRE G'
+ MRE G"
----model fit G'
Figure 6.23. (a) Mean (standard deviation) obtained AHI results over all subjects from kidney analysis. For each volunteer, the spatial mean value was taken over an ROI placed on the kidney, and subsequently average G' and G" values were taken from all slices. (b) Viscoelastic fits to one volunteers G' &amp;amp; G'' moduli.
6.3.3.	Discussion
Characterizing the liver’s mechanical properties non-invasively became possible with the MRE technique . Unlike ultrasound methods, its great potential lies in the ability to generate high-quality contrast images, hence producing quantitative and qualitative results that are more reliable to the clinician.
Our basic findings point to the feasibility of the MRE technique, previously optimized for brain, into the abdomen. We were able to obtain good wave propagation with the setup used, in which a simple wooden rod acts as a passive actuator placed on the abdomen area
producing a tapping effect. The uniformly longitudinal movement produced by the piezoelectric device, will be transformed into shear waves propagating in soft tissue. The ribcage acts as natural intrinsic means of spreading the movement throughout the body region.
Yet, the optimization of MRE to the abdomen was here studied to be able to obtain reproducible results throughout volunteer scanning. The aim to apply an EPI sequence for this study enabled a shorter acquisition, but led to low image quality. To obtain the best SNR levels, acquisition should be held only during breath-hold in expiration. Also, because of the back and forth trajectory in k-space used in EPI, artefacts related to time-dependent eddy currents appear with a ghosting effect on the magnitude images, shifted half way from the true image. In addition, the inefficient fat suppression methods at a distance from the isocentre will superimpose a high intensity fat tissue on the true image. This is more pronounced on large bore scanners where homogeneity is an issue, like the MAGNETOM Verio from Siemens which used in these experiments.
Performing AHI on this data is, thus, unsound. We found the use of saturation bands on fat tissue will reduce on a certain extent these effects. The location of these bands should not encompass the imaging region of interest, thus they should primarily be located on the abdomen borders, to suppress subcutaneous fat. Shimming can also be applied to reduce the inhomogeneity of the magnetic field. For liver EPI on a large bore scanner, a 3-D shim is an absolute requirement prior to image acquisition . It will optimize the magnetic field over the patient’s abdomen, from the isocentre outwards. Reducing the FoV was also found to be effective, but it will create a pixelated image with lower resolution for the detection of the propagating waves.
Low input accelerations by the passive actuator, usually causes low displacements highly damped in the tissue, producing very short travelling periods. On a processing point of view, it is useful to select the organ region where high wave propagation is experienced when tissue experiences low amplitude, irregular displacements, in order to obtain more accurate, reproducible results across subjects.
In Chapter 5, interference waves were examined in software phantoms. Here, this issue was shown to be relevant with heart beat wave propagation interfering on the applied shear waves. It was shown that these can be destructive and would underestimate the obtained mean stiffness. To avoid this occurrence one could, again, reject them by selecting an ROI in the liver where empirically one would only find shear wave propagation due to mechanical excitation. Placing the imaging region in the lower portions of the liver can also diminish or even eliminate these effects. Conversely, as a processing based alternative, the use of a shorter wave band in the spatial filtering process is viable, namely placing a lower high-cut threshold wavelength. This will enable the rejection of waves with lower k numbers, which is
the case of wave propagation due to the beating heart. However, a fine balance exists between correct low frequency wave suppression and overfiltering which is the main cause for underestimation of elastic moduli (Chapter 5).
From a preformed group analysis on liver data we were able to obtain measurable displacements so as to extract rheological properties using the Algebraic Helmholtz Inversion methods at 50.0, 62.5 and 75.0 Hz. The heterogeneity in viscoelastic constants related to liver that were previously reported can be explained by the various types of procedures to extract mechanical properties (Table 6.6). The results derived here are in the order of magnitude to what was published by Klatt et al. (2007) and Asbach et al. in 2008 and 2010, due to similarity in processing schemes.
	Method of data analysis	# of Volunteers	Main Results
Present Analysis	AHI with Zenner fits	5	g1 = 1.49 (0.13) kPa g2 = 1.22 (0.15) kPa H = 19.45 (2.7) Pa.s
	AHI	with	three parameter SP fits	5	g = 2.40 (0.23) kPa H = 21.89 (1.52) Pa.s a = 0.18 (0.017)
Klatt et al. (2007) [77]	AHI with Zenner fits	5	g1 = 1.36 (0.26) kPa g2 = 1.86 (0.21) kPa H = 5.5 (1.2) Pa.s
Asbach et al. (2008) [57]	AHI with Zenner fits	8	g1 = 1.16 (0.28) kPa g2 = 1.97 (0.30) kPa H = 7.3 (2.3) Pa.s
Asbach et al. (2010) [78]	AHI with two parameter SP fits (n=7.3 Pa.s)	16	g = 2.25 (0.43) kPa a = 0.266 (0.011)
Kamphues et al. (2012) [79]	AHI with two parameter SP fits (n=7.3 Pa.s)	10	g = 1.99 kPa (range, 1.65 - 2.37 kPa)
Dresner et al. (2004) [80]	LFE	5	g = 1.93 (0.23) kPa; freq=50 Hz g = 1.80 (0.98) kPa; freq=80 Hz
Rouviere et al. (2006) [81]	LFE	12	g = 2.00 (0.30) kPa; freq=90 Hz
Yin et al. (2007) [62]	LFE	35	g = 2.20 (0.31) kPa; freq=60 Hz
Huwart et al. (2006) [82]	Curl operator	5	g = 2.06 (0.26) kPa; freq=80 Hz H = 1.72 (0.15) Pa.s
Table 6.6. Literature and present results of liver viscoelasticity using different analysis methods.
We were able to obtain statistically significant results for spleen and kidney elasticity. Only very few past studies have focused on this question, and computation of frequency independent viscoelasticity is generally not present.
Similarly to what was done by Klatt et al. (2007) [77], we compared the mechanical properties of the three studied abdominal regions: liver, spleen and kidney (Figure 6.24).
Considering the Zenner model, the kidney was found less stiff and viscous than the spleen. However, the same does not apply to liver. The model proposed converges at static deformation to ii and at high frequencies to	Liver elasticity findings indicate that, at
lower frequencies, the liver appears more elastic compared to other organs, as opposed to higher frequencies, where spleen and kidneys are less stiff. Springpot model results generally support these findings. The spleen is the most stiff and viscous of all organs, as was reported by Mannelli [83]. The lower wavelengths experienced in the spleen were already conclusive of this: waves changed their propagation profile when passing though the splenic tissue.
Figure 6.24. (a) Zenner and (b) Springpot models’ averaged extracted coefficients for kidney, spleen and liver over all individuals. Error bars represent interindividual standard deviation.
In comparison to the spleen, kidneys seem to be softer and more dissipative. To date, there is little MRE derived renal stiffness. Though, Yin et al. (2011) [84] demonstrated the feasibility of such technique to determine its properties though an axial plan. Bensamoun et al. (2011) reported a mean kidney stiffness value of 4.12 (0.24) kPa vibrated at 60 Hz from 11
healthy volunteers. [85] With this study, the obtained values were significantly lower. This is again explained by the approach on the processing algorithm to compute the rheological constants.
6.4.	Chapter Summary
This chapter demonstrates the feasibility of the AHI technique together with an SS-EPI modified MR sequence to characterize tissue’s stiffness and viscosity.
Brain MRE on healthy volunteers clearly differentiated white matter and grey matter. Although the processing algorithm is based on an inadequate model for this type of data, it is safe to consider relative WM/GM stiffness measures to study different groups of subjects, for example to study aging effects on brain. Our preliminary results of the aging study point to a decrease in stiffness and viscosity of the brain, WM and GM with age.
In an extended analysis, this AHI technique measuring white matter and grey matter elastic and viscous properties can be also applied to brain diseases such as normal pressure hydrocephalus or multiple sclerosis.
We were also successful on determining non-invasive rheological studies for the abdominal regions. Reproducible results could be obtained for liver, spleen and kidney tissue on a healthy volunteer cohort, revealing a possible higher stiffness in spleen compared to kidneys and liver. Thus, the technique can be useful to study patients suffering from stiffness related diseases such as liver fibrosis, portal hypertension and to detect possible kidney stones and tissue related tumours.
Still, challenges remain on obtaining better image quality and more adequate processing methods. Also, extending the dynamic range of MRE acquisitions would allow better fits to rheological models.
Chapter 7.
Summary and Future Work
Imaging viscoelasticity was made possible, with the utmost accuracy to date, through MR Elastography. MRE is currently a growing field: from the development of new actuator mechanisms to deliver steady-state high amplitude oscillatory motion to tissue, perfecting image quality without compromising on acquisition speed and, most notoriously, on postacquisition image analysis improving the processing techniques, research within this modality is currently thriving.
The work presented in the thesis concerned the development and evaluation of methods for analysis in MRE. This chapter will report the main results, while outlining considerations which may be useful for future work and for better interpretation of MRE data acquired in clinical research contexts.
7.1. Summary of the results
As previously stated, the computation of viscoelastic parameters and the control of the appropriate setting of MRE related acquisition values require a number of extensive timeconsuming steps that involve a high degree of interaction, concerning data transfer to remote computers, selection of appropriate data from cumbersome data structures, definition of masks and basic knowledge of programming languages like Matlab. The first task within the current project was the implementation of a general MRE toolbox in the MR scanner to process inline datasets, for purposes of making a primary assessment of the acquired data. Evaluation of the algorithm and code debugging were important to produce a fluid workflow with minimum interaction with the user, returning consistent measurements over re-runs of the process both offline and inline. The final testing step in the scanner environment itself was necessary to prove the correct functionality of the implemented elasticity parameter reconstruction methods under a different type of computer technology, and with varying initial acquisition conditions. For this purpose, experiments were carried out on gel phantoms and on a healthy volunteer’s brain. The added inline processing to the usual data acquisition did not slow down the experimental protocol and measurements were consistent with those obtained by conventional data computation on a remote computer. Thus, it can be confirmed that the overall success of the inline processing was verified.
Another task within this project was the comparison, under various experimental conditions, of two direct techniques to invert the phase data into measurable viscoelastic constants, namely Algebraic Helmholtz Inversion and Local Frequency Estimation. Image processing fundamentals were tested with close to ideal situations using software phantoms. Noise, damping, compression and interference patterns were added to the basic transverse wave equation, and the performance of the algorithms was evaluated in terms of spatial resolution, sensitivity SNR and effectiveness of reconstructions. Gel phantoms without and with compartments using different viscoelastic quantities and brain MRE datasets were also assessed by both methods. Altogether, the LFE proved to be more effective when no image corruption effects were added, but lacked accuracy when processing software phantoms with artefacts and on real acquired data. LFE results are smoother, but have poor spatial resolution when compared with AHI. On the other hand, the latter produced images that were sharper but more susceptible to noise. Also, LFE does not account for attenuation, thus it does not give any information about the viscosity of the medium. Spatial filtering proved to be the crucial turning point on both processing schemes, yet a higher influence in the LFE approach was detected. Finally, the rheological testing estimated viscoelastic moduli far lower than the ones
derived from MRE. In principle, this might demonstrate the general overestimation of MRE derived quantities, but further studies under the exact same experimental conditions should be applied.
While there is no clinical precedent for non-invasive ‘brain palpation’ it is possible that measurements of elastic as viscous properties might be useful to mechanically characterize the brain. A research study was carried out within the current project using the AHI method to analyse acquired brain data from nine healthy volunteers with varying age. General measurements showed a lower stiffness and viscosity in GM compared to WM. These results are supported by the fact that we only accounted for deep GM, since the computational algorithm will induce artefacts biasing the boundaries near the cortex of the brain. Furthermore, preliminary results were obtained on a pilot study of the ageing brain. It was possible to detect the impact of brain viscoelasticity over a lifespan with MRE using a planar AHI approach. The aged brain was found less stiff and viscous, which hypothetically might be related to the loss of neurons and myelinated nerve fibres in the human brain during aging.
Furthermore, the protocol used for brain MRE was adapted to clinical research of abdomen viscoelasticity. Due to the low quality imaging obtained with EPI sequences and inconsistent wave propagation in the abdominal area, the most accurate acquisition scheme was investigated to obtain reproducibility between subjects. Ghosting artefacts with field inhomogeneities are an important issue in abdominal studies since the high intensity fat tissue is superimposed on top of the true image blocking the effective imaging of the tissue slice. This could be suppressed with prior shimming, use of saturation bands and reducing the FoV. It was also found that imaging on breath-hold in expiration raises SNR on the images. For a better shear wave propagation throughout the tissue slice, a good mechanical stimulation is advised, since it was observed that low amplitude wave propagation underestimates viscoelasticity. In addition, the heartbeat might influence wave analysis, which can be avoided by imaging only lower abdomen regions or possibly using ECG or pulse triggering.
Acquisition of abdominal MRE data of five healthy volunteers within this project enabled rheological parameterization of liver, spleen and kidney viscoelasticity. The main findings indicate that the liver and kidneys are softer and more dissipative than the spleen. Nonetheless, the methods still need to be improved in order to find a gold standard technique, with an easy reproducible acquisition protocol allowing more reliable results on analysis.
To summarize, the work presented in this thesis showed the advantages that the MRE technique can bring by measuring the biomechanical properties of tissue non-invasively. Important aspects were pointed on three different levels related to image processing, contributing to the progression of MRE onto a clinical setting.
7.2.	Future Work
With regards to the development of the real time MRE processing toolbox, the next step should be the code and workflow optimization. A more user-friendly environment could be created by using the sequence GUI as a means to select the parameters for MRE analysis. Also, the output G maps could be colour coded, which would create an easier setting for clinical purposes. Code improvements should essentially involve the optimization of the masking algorithm, in order to enable real time analysis of abdominal regions where magnitude images are noisier with lower spatial resolution. Furthermore, plans for an additional feature consist on integrating the unwrapping algorithm during the acquisition stage. This would allow an instant inline view of each unwrapped phase offset, coded with ICE Scan Functors in the Image Acquisition Pipeline. Subsequently, the remaining processing would be performed with previously unwrapped volumes in the MREProcess Functor. Code optimization in terms of speed could also be done by unwrapping each volume on a separate cluster of the scanner computer machines, as opposed to sequential unwrapping on a single cluster.
In Chapter 5 the evaluation and comparison of the two main direct inversion techniques showed their strengths and weaknesses. However, it was found that new, more effective forms of pre-inversion processing are the key to having a more reliable analysis. Particularly, the filtering procedure should be improved to select the wave propagation at the correct frequencies, possibly using spatially oriented filters in k-space. Independent Component Analysis (ICA), for example, could also be a viable alternative, allowing for the selection of the component that would sustain the wave energy, eliminating other noisy/unwanted elements of the time course.
The in vivo AHI analysis showed promising results for further developments in brain research as well as in abdominal regions. Particularly, ageing is a hot topic of debate within the scientific community. Thus, analysis of the mechanical changes of brain with age should certainly be explored in a bigger cohort group with a wider age range. Also, the 2-D inversion process should be extended to 3-D using the full wave tensor theory and coverage of the whole brain. Finally, the viscoelastic ageing study could be complemented by MRI volumetry and other possible morphology biomarkers of a developing brain like curvature analysis and gyrification.
Likewise, abdominal MRE should be explored with a bigger subject group to yield accurate quantitative measurements for viscoelasticity of liver, kidneys and spleen. Although possibilities were presented to enhance the quality of EPI images, new alternative methods
should also be addressed. An easy solution would be to use a small bore MR scanner, where field inhomogeneities are lower, volumes appear less noisy and with less ghosting. Moreover, improvement of image quality using pre-processing techniques prior to analysis could be studied, where DTI techniques like eddy current correction could be adapted to the MRE analysis pipeline. For future studies it might also be interesting to compare the viscoelasticity of brain and liver with both EPI and GRE to test how these ghosting effects might influence the images.
To summarize, it should be noticed that the direct inversion algorithms, in particular the AHI, are too simplistic to fully understand and analyse the type of data that is acquired. New developments in image processing using more complex theoretical models will benefit MRE. Characterizing elasticity using a non-linear approach, designated hyperelasticity, [74] is of particular interest for brain MRE, since the structured tissue of WM should not be modelled as linear. Another example is the anisotropic parameter reconstruction using the wave-guide approach of Romano et al. [42] allowing a better viscoelastic quantification also in brain and possibly muscle, where fibre bundles are highly structured and organized.
Catarina H. L. S. Rua
October 2012
Appendix
A. Imaging protocol of all volunteers subjected to brain MRE.
Brain MRE Imaging Protocol		
matrix size		128x128
number of slices		5
pixel size (mm)		1.8x1.8
slice thickness (mm)		3
TE (ms)		100
TR (ms)		1650
Amplitude of Amplifier (%)		40
Number of vibration cycles		12
Amplitude MSG (mT/m)		40
number of MSGs frequency dependent	25	1
	37,5	1
	50	2
	62,5	2
	75	3
	100	4
TFR (ms) frequency dependent	25	400
	37,5	250
	50	180
	62,5	144
	75	107
	100	80
B. Personal information sheet of volunteers subjected to brain MRE.
Volunteer #	1	2	3	4	5	6	7	8	9
Gender	M	F	F	M	M	M	M	M	F
Age (y)	19	22	23	25	26	30	49	61	62
Weight (kg)	71	54	65	70	82	96	114	95	80
Volunteer #		1	2	3	4	5
Gender		F	F	F	F	M
Age (y)		23	22	23	60	25
Weight (kg)		65	54	50	50	75
BMI (kg/m2)		25.23	18.47	19.53	20.81	22.40
Matrix size		128x128	128x128	128x128	128x128	96x128
Pixel size (mm)		2.3x2.3	2.3x2.3	2.3x2.3	2.3x2.3	2.7x2.7
TE (ms)		56	56	50	50	56
TR(ms)		1600	1600	1600	1600	1600
Slice thickness (mm)		10.0	10.0	10.0	10.0	10.0
Number of Slices frequency dependent	50.0	3	3	3	1	3
	62.5	3	5	5	1	3
	75.0	3	3	5	1	3
	100	3	3	5	1	3
Amp MSG (mT/m)		40	40	40	40	40
Amp Amplifier (%)		40	40	40	40	40
Number of mechanical vibration periods		12	12	12	12	12
Number of MSGs frequency dependent	50.0	1	1	1	1	1
	62.5	1	1	1	1	1
	75.0	1	1	1	1	1
	100	2	2	2	2	2
TFR (ms) frequency dependent	50.0	300	300	300	300	300
	62.5	240	240	240	240	240
	75.0	200	200	200	200	200
	100	140	140	140	140	140
References
[1]	Y. C. Fung, Biomechanics: Mechanical Properties of Living Tissues, Second. Springer, 1993.
[2]	M. H. Sadd, Elasticity: Theory, Applications and Numerics. Oxford: Elsevier, 2005, pp. 27-77.
[3]	F. Duck, Physical properties of tissue: a comprehensive reference book. London: Accademic Press, 1990.
[4]	A. C. Pipkin, Lectures on Viscoelasticity Theory. New York: Springer, 1972.
[5]	K. Graff, Wave motion in elastic solids, vol. 13, no. 5. New York: Dover Publications, 1975, pp. 235-236.
[6]	H. Schiessel, R. Metzler, A. Blumen, and T. F. Nonnenmacher, “Generalized viscoelastic models : their fractional equations with solutions,” J. Phys. A: Math. Gen., vol. 28, no. 23, pp. 6567-84, 1995.
[7]	T. E. Oliphant, A. Manduca, R. L. Ehman, and J. F. Greenleaf, “Complex-valued stiffness reconstruction for magnetic resonance elastography by algebraic inversion of the different ial equation.,” Magn. Reson. Med., vol. 45, no. 2, pp. 299-310, Mar. 2001.
[8]	S. Papazoglou, U. Hamhaber, J. Braun, and I. Sack, “Algebraic Helmholtz inversion in planar magnetic resonance elastography.,” Physics in Medicine and Biology, vol. 53, no. 12, pp. 3147-58, Jun. 2008.
[9]	G. T. Fallenstein and V. D. Hulce, “Dynamic Mechanical Properties of Human Brain Tissue,” J. Biomechanics, vol. 2, no. 3, pp. 217-26, 1969.
[10]	K. B. Arbogast, K. L. Thibault, B. S. Pinheiro, K. I. Winey, and S. S. Margulies, “A High-Frequency Shear Device for testing soft biological tissues,” J. Biomechanics, vol. 30, no. 7, pp. 757-9, 1997.
[11]	J. Vappou, E. Breton, P. Choquet, C. Goetz, R. Willinger, and A. Constantinesco, “Magnetic resonance elastography compared with rotational rheometry for in vitro brain tissue viscoelasticity measurement,” MAGMA, vol. 20, no. 5-6, pp. 273-8, Dec. 2007.
[12]	D. Klatt, C. Friedrich, Y. Korth, R. Vogt, J. Braun, and I. Sack, “Viscoelastic properties of liver measured by oscillatory rheometry and multifrequency magnetic resonance elastography,” Biorheology, vol. 47, no. 2, pp. 133-41, Jan. 2010.
[13]	J. Ophir, “Elastography: A quantitative method for imaging the elasticity of biological tissues,” Ultrasonic Imaging, vol. 13, no. 2, pp. 111-34, Apr. 1991.
[14]	H. L. Oestreicher, “Field and Impedance of an Oscillating Spere in a Viscolastic Medium with an Application to Biophysics,” J. Acoust. Soc. Am., vol. 23, no. 6, pp. 707-14, 1951.
[15]	H. E. Gierke, H. L. Oestreicher, E. K. Franke, H. O. Parrack, and W. W. V. Wittern, “Physics of vibrations in living tissues,” Journal of Applied Physiology, vol. 4, no. 12, pp. 886-900, Jun. 1952.
[16]	L. Gao, K. J. Parker, R. . Lerner, and S. F. Levinson, “Imaging of the elastic properties of tissue -Review,” Ultrasound in Medicine &amp;amp; Biology, vol. 22, no. 8, pp. 959-77, 1996.
[17]	G. Treece, J. Lindop, L. Chen, J. Housden, R. Prager, and A. Gee, —Real-time quasi-static ultrasound elastography,” Interface Focus, vol. 1, no. 4, pp. 540-52, Apr. 2011.
[18]	M. O’Donnell, A. R. Skovoroda, B. M. Shapo, and S. Y. Emelianov, “Internal displacement and strain imaging using ultrasonic speckle tracking,” IEEE transactions on ultrasonics, ferroelectrics, and frequency control, vol. 41, no. 3, pp. 314-325, May 1994.
[19]	I. Céspedes, J. Ophir, H. Ponnekanti, and N. Maklad, “Elastography: Elasticity Imaging Using Ultrasound with Application to Muscle and Breast In Vivo,” Ultrasonic Imaging, vol. 15, no. 2, pp. 7388, Apr. 1993.
[20]	Y. Yamakoshi, J. Sato, and T. Sato, “Ultrasonic Imaging of Internal Vibration of Soft Tissue under Forced Vibration,” IEEE transactions on ultrasonics, ferroelectrics, and frequency control, vol. 37, no. 2, pp. 45-53, 1990.
[21]	L. Sandrin, S. Catheline, M. Tanter, X. Hennequin, and M. Fink, “Time-resolved pulsed elastography with ultrafast ultrasonic imaging.,” Ultrasonic Imaging, vol. 21, no. 4, pp. 259-72, Oct. 1999.
[22]	R. Muthupillai, D. J. Lomas, P. J. Rossman, J. F. Greenleaf, A. Manduca, and R. L. Ehman, “Magnetic resonance elastography by direct visualization of propagating acoustic strain waves.,” Science, vol. 269, no. 5232, pp. 1854-57, Sep. 1995.
[23]	M. Yin, J. A. Talwalkar, K. J. Glaser, A. Manduca, R. C. Grimm, P. J. Rossman, J. L. Fidler, and R. L. Ehman, “Assessment of Hepatic Fibrosis With Magnetic Resonance Elastography,” Clinical Gastroenterology and Hepatology, vol. 5, pp. 1207-1213, 2007.
[24]	J. A. Talwalkar, M. Yin, J. L. Fidler, S. O. Sanderson, P. S. Kamath, and R. L. Ehman, “Magnetic resonance imaging of hepatic fibrosis: emerging clinical applications,” Hepatology, vol. 47, no. 1, pp. 332-42, Jan. 2008.
[25]	J. Chen, J. A. Talwalkar, M. Yin, K. J. Glaser, S. O. Sanderson, and R. L. Ehman, “Early detection of nonalcoholic steatohepatitis in patients with nonalcoholic fatty liver disease by using MR elastography.,” Radiology, vol. 259, no. 3, pp. 749-56, Jun. 2011.
[26]	I. Sack, J. Rump, T. Elgeti, A. Samani, and J. Braun, “MR elastography of the human heart: noninvasive assessment of myocardial elasticity changes by shear wave amplitude variations.,” Magn. Reson. Med., vol. 61, no. 3, pp. 668-77, Mar. 2009.
[27]	T. Elgeti, M. Beling, B. Hamm, J. Braun, and I. Sack, “Elasticity-based determination of isovolumetric phases in the human heart.,” Journal of Cardiovascular Magnetic Resonance, vol. 12, no. 60, pp. 1-8, Jan. 2010.
[28]	D. Klatt, S. Papazoglou, J. Braun, and I. Sack, “Viscoelasticity-based MR elastography of skeletal muscle.,” Physics in Medicine and Biology, vol. 55, no. 21, pp. 6445-59, Nov. 2010.
[29]	S. A. Kruse, G. H. Rose, K. J. Glaser, A. Manduca, J. P. Felmlee, C. R. Jack, and R. L. Ehman, “Magnetic resonance elastography of the brain,” NeuroImage, vol. 39, no. 1, pp. 231-7, Jan. 2008.
[30]	M. A. Green, L. E. Bilston, and R. Sinkus, “In vivo brain viscoelastic properties measured by magnetic resonance elastography,” NMR in Biomedicine, vol. 21, no. 7, pp. 755-64, 2008.
[31]	F. B. Freimann, K.-J. Streitberger, D. Klatt, K. Lin, J. McLaughlin, J. Braun, C. Sprung, and I. Sack, “Alteration of brain viscoelasticity after shunt treatment in normal pressure hydrocephalus.,” Neuroradiology, vol. 54, no. 3, pp. 189-96, May 2011.
[32]	I. Sack, B. Beierbach, J. Wuerfel, D. Klatt, U. Hamhaber, S. Papazoglou, P. Martus, and J. Braun, “The impact of aging and gender on brain viscoelasticity.,” NeuroImage, vol. 46, no. 3, pp. 652-7, Jul. 2009.
[33]	I. Sack, B. Beierbach, U. Hamhaber, D. Klatt, and J. Braun, “Non-invasive measurement of brain viscoelasticity using magnetic resonance elastography,” NMR in Biomedicine, vol. 21, no. 3, pp. 26571, 2007.
[34]	S. A. Kruse, M. A. Dresner, P. J. Rossman, J. P. Felmlee, C. R. Jack, and R. L. Ehman, Palpation of the Brain ’ Using Magnetic Resonance Elastography,” in Proc. Int. Soc. Mag. Reson. Med., 1999, p. 258.
[35]	R. Muthupillai, P. J. Rossman, D. J. Lomas, J. F. Greenleaf, S. J. Riederer, and R. L. Ehman, “Magnetic resonance imaging of transverse acoustic strain waves.,” Magn. Reson. Med., vol. 36, no. 2, pp. 266-74, Aug. 1996.
[36]	Y. K. Mariappan, K. J. Glaser, and R. L. Ehman, “Magnetic resonance elastography: a review.,” Clinical Anatomy, vol. 23, no. 5, pp. 497-511, Jul. 2010.
[37]	K.-J. Streitberger, I. Sack, D. Krefting, C. Pfuller, J. Braun, F. Paul, and J. Wuerfel, “Brain Viscoelasticity Alteration in Chronic-Progressive Multiple Sclerosis,” PloS one, vol. 7, no. 1, p. e29888, 2012.
[38]	Z. T. H. Tse, H. Janssen, A. Hamed, M. Ristic, I. Young, and M. Lamperth, “Magnetic resonance elastography hardware design: a survey,” in Proceedings of the Institution of Mechanical Engineers, Part H: Journal of Engineering in Medicine, 2009, vol. 223, no. 4, pp. 497-514.
[39]	R. L. Ehman, P. J. Rossman, T. C. Hulshizer, and M. A. Dresner, “Pressure Activated Driver for Magnetic Resonance Elastography,” U.S. Patent US 7,034,534 B22006.
[40]	P. Latta, M. L. H. Gruwel, P. Debergue, B. Matwiy, U. N. Sboto-Frankenstein, and B. Tomanek, “Convertible pneumatic actuator for magnetic resonance elastography of the brain.,” Magnetic Resonance Imaging, vol. 29, no. 1, pp. 147-52, 2011.
[41]	K. Uffmann, C. Abicht, W. Grote, H. H. Quick, and M. E. Ladd, “Design of an MR-compatible piezoelectric actuator for MR elastography,” Concepts in Magnetic Resonance, vol. 15, no. 4, pp. 23954, Dec. 2002.
[42]	A. Romano, M. Scheel, S. Hirsch, J. Braun, and I. Sack, “In Vivo Waveguide Elastography of White Matter Tracts in the Human Brain,” Magn. Reson. Med., p. [Epub ahead of print], 2012.
[43]	A. J. Romano, J. A. Bucaro, R. L. Ehnan, and J. J. Shirron, “Evaluation of a material parameter extraction algorithm using MRI-based displacement measurements.,” IEEE transactions on ultrasonics, ferroelectrics, and frequency control, vol. 47, no. 6, pp. 1575-81, Jan. 2000.
[44]	U. Hamhaber, I. Sack, S. Papazoglou, J. Rump, D. Klatt, and J. Braun, “Three-dimensional analysis of shear wave propagation observed by in vivo magnetic resonance elastography of the brain,” Acta Biomaterialia, vol. 3, no. 1, pp. 127-37, Jan. 2007.
[45]	T. E. Oliphant, R. L. Ehman, and J. F. Greenleaf, “Magnetic Resonance Elastography Revisited: Reinterpreting Phase-Difference Data as the Output of a Linear Filter,” in Proc. Int. Soc. Mag. Reson. Med., 2000, vol. 36, no. June, p. 539.
[46]	F. Cakoni and D. Colton, Qualitative Methods in Inverse Scattering Theory. Berlin: Springer, 2006, p. 227.
[47]	E. Park and A. M. Maniatty, “Shear modulus reconstruction in dynamic elastography: time harmonic case.,” Physics in Medicine and Biology, vol. 51, no. 15, pp. 3697-721, Aug. 2006.
[48]	A. Manduca, T. E. Oliphant, M. A. Dresner, D. S. Lake, J. F. Greenleaf, and R. L. Ehman, “Comparative Evaluation of inversion Algorithms for Magnetic Resonance Elastography,” in IEEE transactions on biomedical engineering, 2002, pp. 997-1000.
[49]	E. E. W. Van Houten, M. I. Miga, J. B. Weaver, F. E. Kennedy, and K. D. Paulsen, “Three-Dimensional Subzone-Based Reconstruction Algorithm for MR Elastography,” Magn. Reson. Med., vol. 45, no. 5, pp. 827- 37, 2001.
[50]	A. Manduca, T. E. Oliphant, M. A. Dresner, J. L. Mahowald, S. A. Kruse, E. Amromin, J. P. Felmlee, J. F. Greenleaf, and R. L. Ehman, “Magnetic resonance elastography: non-invasive mapping of tissue elasticity.,” Medical Image Analysis, vol. 5, no. 4, pp. 237-54, Dec. 2001.
[51]	H. Knutsson, C.-F. Westin, and G. Granlund, “Local Multiscale Frequency and Badwidth Estimation,” in Proceedings of the IEEE International Conference on Image Processing, 1994, pp. 36-40.
[52]	A. Manduca, D. S. Lake, S. A. Kruse, and R. L. Ehman, “Spatio-temporal directional filtering for improved inversion of MR elastography images.,” Medical Image Analysis, vol. 7, no. 4, pp. 465-73, Dec. 2003.
[53]	H. Werthner, “VB15B ICE User’ s Guide: Manual for ICE programmers,” 2007.
[54]	T. J. Flynn, “Two-Dimensional phase unwrapping with minimum weighted discontinuity,” JOSA A, vol. 14, no. 10, pp. 2692-2701, 1997.
[55]	J. L. Semmlow, Biosignal and Biomedical Image Processing: MATLAB-based Applications. New York: Marcel Dekker, Inc., 2004.
[56]	A. Savitzky and M. J. E. Golay, “Smoothing and Differentiation of Data by Simplified Least Squares Procedures.,” Analytical Chemistry, vol. 36, pp. 1627-39, Jul. 1964.
[57]	P. Asbach, D. Klatt, U. Hamhaber, J. Braun, R. Somasundaram, B. Hamm, and I. Sack, “Assessment of liver viscoelasticity using multifrequency MR elastography.,” Magn. Reson. Med., vol. 60, no. 2, pp. 373-9, Aug. 2008.
[58]	D. C. Ghiglia and M. D. Pritt, Two-Dimensional Phase Unwrapping: Theory, Algorithms, and Software. New York: John Wiley &amp;amp; Sons, Inc., 1998.
[59]	W. H. Press, S. A. Teukolsky, W. T. Vetterling, and B. P. Flannery, Numerical Recipes in C The Art of Scientific Computing, Second. Cambridge: Cambridge Univerisity Press, 1992.
[60]	H. Fangohr, “A Comparison of C , MATLAB , and Python as Teaching Languages in Engineering,” in 4th International Conference ICCS, 2004, pp. 1210-17.
[61]	M. D. J. McGarry, E. E. W. Van Houten, A. J. Pattison, J. B. Weaver, and K. D. Paulsen, “Comparison of Iterative and Direct Inversion MR Elastography Algorithms,” in SEM Annual Conference, 2011.
[62]	M. Yin, J. A. Talwalkar, K. J. Glaser, A. Manduca, R. C. Grimm, P. J. Rossman, J. L. Fidler, and R. L. Ehman, “Assessment of Hepatic Fibrosis With Magnetic Resonance Elastography,” Clinical Gastroenterology and Hepatology, vol. 5, no. 10, pp. 1207-13.e2, 2007.
[63]	P. Asbach, D. Klatt, B. Schlosser, M. Biermer, M. Muche, A. Rieger, C. Loddenkemper, R. Somasundaram, T. Berg, B. Hamm, J. Braun, and I. Sack, “Viscoelasticity-based Staging of Hepatic Fibrosis with Multifrequency MR Elastography,” Radiology, vol. 257, no. 1, pp. 80-86, 2010.
[64]	S. K. Venkatesh, M. Yin, J. F. Glockner, N. Takahashi, P. A. Araoz, J. A. Talwalkar, and R. L. Ehman, “MR Elastography of Liver Tumors : Preliminary Results,” A JR, vol. 190, no. 6, pp. 1534-40, 2008.
[65]	I. Sack, K.-J. Streitberger, D. Krefting, F. Paul, and J. Braun, “The influence of physiological aging and atrophy on brain viscoelastic properties in humans.,” PloS one, vol. 6, no. 9, p. e23451, Jan. 2011.
[66]	K. Uffmann, C. J. Galban, S. Maderwald, T. Paul, M. U. Schlamann, A. D. Greiff, and M. E. Ladd, “MR Elastography of the Human Brain: Case Study Involving a Patient with a Temporal Glioma,” in Proc. Int. Soc. Mag. Reson. Med., 2005, vol. 13, p. 757.
[67]	J. C. Scanlan and H. H. Winter, “Composition Dependence of the Viscoelasticity of End-Linked Poly(dimethylsiloxane) at the Gel Point,” Macromolecules, vol. 24, no. 1, pp. 47-54, 1991.
[68]	F. Chambon and H. H. Winter, “Linear Viscoelasticity at the Gel Point of a Crosslinking PDMS with Imbalanced Stoichiometry,” The Society of Rheology, vol. 31, no. 8, pp. 683-97, 1987.
[69]	J. A. Walberer and A. J. McHugh, “The linear viscoelastic behavior of highly filled polydimethylsiloxane measured in shear and compression,” Journal of Rheology, vol. 45, no. 1, pp. 187-201, 2001.
[70]	D. Klatt, P. Asbach, J. Rump, S. Papazoglou, R. Somasundaram, J. Modrow, J. Braun, and I. Sack, “In Vivo Determination of Hepatic Stiffness Using Steady-State Free Precession Magnetic Resonance Elastography,” Investigative Radiology, vol. 41, no. 12, pp. 841 -8, 2006.
[71]	F. Schmitt, M. K. Stehling, and R. TUrner, Echo-planar imaging: theory, technique and application. Berlin, Germany: Springer, 1998.
[72]	E. M. Haacke, R. W. Brown, M. R. Thompson, and R. Venkatesan, Magnetic Resonance Imaging Physical Principles and Sequence Design. USA: John Wiley &amp;amp; Sons, Inc., 1999.
[73]	K. Uffmann, S. Maderwald, A. D. Greiff, and M. E. Ladd, “Determination of Gray and White Matter Elasticity with MR Elastography,” in Proc. Int. Soc. Mag. Reson. Med., 2004, vol. 11, no. 2003, p. 1768.
[74]	T. Kaster, I. Sack, and A. Samani, “Measurement of the hyperelastic properties of ex vivo brain tissue slices.,” Journal of Bomechanics, vol. 44, no. 6, pp. 1158-63, Apr. 2011.
[75]	A. Romano, P. B. Abraham, P. J. Rossman, J. A. Bucaro, and R. L. Ehman, “Determination and analysis of guided wave propagation using magnetic resonance elastography,” Magn. Reson. Med., vol. 54, no. 4, pp. 893-900, Oct. 2005.
[76]	S. Papazoglou, S. Hirsch, B. Jurgen, and I. Sack, “Multifrequency inversion in magnetic resonance elastography,” Physics in Medicine and Biology, vol. 57, no. 8, pp. 2329-46, 2012.
[77]	D. Klatt, U. Hamhaber, P. Asbach, J. Braun, and I. Sack, “Noninvasive assessment of the rheological behavior of human organs using multifrequency MR elastography: a study of brain and liver viscoelasticity,” Physics in Medicine and Biology, vol. 52, no. 24, pp. 7281-94, Dec. 2007.
[78]	P. Asbach, D. Klatt, B. Schlosser, M. Biermer, M. Muche, A. Rieger, C. Loddenkemper, R. Somasundaram, T. Berg, B. Hamm, J. Braun, and I. Sack, “Viscoelasticity-based Staging of Hepatic Fibrosis with Multifrequency MR Elastography,” Radiology, vol. 257, no. 1, pp. 80-6, 2010.
[79]	C. Kamphues, D. Klatt, R. Bova, A. Yahyazadeh, M. Bahra, J. Braun, F. Klauschen, P. Neuhaus, I. Sack, and P. Asbach, “Viscoelasticity-Based Magnetic Resonance Elastography for the Assessment of Liver Fibrosis in Hepatitis C Patients after Liver Transplantation,” RoFo, p. [Epub ahead of print], 2012.
[80]	M. Dresner, J. Fidler, and R. Ehman, “MR Elastography of in vivo Human Liver,” in Proc. Int. Soc. Mag. Reson. Med., 2004, vol. 11, no. 1, p. 502.
[81]	O. Rouviere, M. Yin, M. A. Dresner, P. J. Rossman, L. J. Burgart, J. L. Fidler, and R. L. Ehman, “MR Elastography of the Liver: Perliminary Results,” Radiology, vol. 240, no. 2, pp. 440-8, 2006.
[82]	L. Huwart, F. Peeters, R. Sinkus, L. Annet, N. Salameh, L. C. Beek, Y. Horsmans, and B. E. V. Beers, “Liver fibrosis : non-invasive assessment with MR elastography,” NMR in Biomedicine, vol. 19, no. 2, pp. 173-9, 2006.
[83]	L. Mannelli, E. Godfrey, I. Joubert, A. J. Patterson, M. J. Graves, F. A. Gallagher, D. J. Lomas, L. Mannelli, E. Godfrey, and I. Joubert, “MR Elastography : Spleen Stiffness Volunteers — Preliminary Experience,” A JR, vol. 195, no. 2, pp. 387-92, 2010.
[84]	M. Yin, C. Jun, K. J. Glaster, J. A. Talwalkar, and R. L. Ehman, “Abdominal Magnetic Resonance Elastography,” Topics in Magnetic Resonance Imaging, vol. 20, no. 2, pp. 79-87, 2009.
[85]	S. F. Bensamoun, L. Robert, G. E. Leclerc, L. Debernard, and F. Charleux, “Stiffness imaging of the kidney and adjacent abdominal tissues measured simultaneously using magnetic resonance elastography,” Clinical Imaging, vol. 35, no. 4, pp. 284-7, 2011.</field>
	</doc>
</add>