<?xml version="1.0" encoding="utf-8"?>
<add>
	<doc>
		<field name="docid">BR-TU.25206</field>
		<field name="filename">982_Camara_PauloSergio_M.pdf</field>
		<field name="filetype">PDF</field>
		<field name="text">UNIVERSIDADE ESTADUAL DE CAMPINAS
INSTITUTO DE GEOCIÊNCIAS
ÁREA DE GEOLOGIA DE PETRÓLEO
Dissertação apresentada ao Instituto de Geociências como requisito parcial à obtenção do
Título de Mestre em Geoengenharia de Reservatórios
CARACTERIZAÇÃO DE RESERVATÓRIOS
COM
TÉCNICAS DE OTIMIZAÇÃO COMBINATORIAL
Autor:
Orientador:
PAULO SÉRGIO CÂMARA ' /z i
ARMANDO ZAUPA REMACRE í
■sponae a x ^ofendida
CA^A^A
Julgadora
Es'/? exenipfar corr r e d c ç d o fino? d n /■; po y ¿«o y y yc? pp
ORIENTADOK
CAMPINAS
Estado de São Paulo - Brasil
Dezembro, 1992
J / c Á M i*
I	A CEHTRAL
Agradecimentos
À meus pais, José e Mécia, pela atenção à minha formação moral e acadêmica.
À minha esposa Rejane e minhas filhas Ana Paula e Renata, ]&gt;&amp;lt;’• &gt; amor, compreensão e apoio em todos os instantes.
Ao meu orientador, Armando Zaupa Remacre, pela dedicação e incentivo.
À Petrobrás, pela oportunidade, priorizando a capacitação científica e tecnológica mesmo em momentos difíceis.
À todos os professores pelo idealismo e ensinamentos transmitidos.
Aos colegas de mestrado, pela amizade sincera.
Â todos aqueles que colaboraram na elaboração desta dissertação, com sugestões, envio de dados ou apoio, em particular os colegas da RPNS Paulo Roberto Costa, Newton Ram alho Jr. e Auci ornar Soares Cerqueira, do DEBAR Carlos Alberto Poletto e Olinto de Souza Gomes, do CENPES Luciane Bonet, Mauro Becker e Cláudio Bettini.
Resumo
A modelagem estocástica vem recebendo interesse crescente na indústria do petróleo, consolidando-se como ferramenta cada vez mais rotineira na elaboração de planos deexplotação em reservatórios produtores.
Técnicas de otimização combinatorial, como o “simulated annealing”, permitem gerar modelos equiprováveis de variáveis do reservatório, reproduzindo a princípio qualquer característica que possa ser expressa como uma função objetivo, além do histograma e variograma, que podem ser honrados com os métodos tradicionais da geoestatística.
Nesta dissertação, a capacidade do algoritmo de “annealing” em aproveitar informações geológicas e de produção (testes de formação), diminuindo as incertezas dos modelos gerados é revista. Conclusões de trabalhos recentes (Pérez, 1991; Deutsch, 1992) são confirmadas e extendidas para casos mais abrangentes.
Um algoritmo recentemente desenvolvido, denominado evolução estocástica, é introduzido na modelagem probabilística, sendo comparado com o “simulated annealing” em termos de tempo de execução e capacidade de reproduzir características com niveis de complexidade diversos, em problemas de diferentes dimensões. A qualidade dos modelos simulados também é analisada com alguns critérios apresentados (tempos, tolerâncias, coeficiente de correlação entre as imagens simulada e real e comportamentos de fluxo).
É verificada a capacidade dos algoritmos em simular seções verticais de reservatórios com diferentes niveis de informação. São analisados o efeito da inclusão do variograma global, de variogramas e médias de regiões do reservatório e finalmente, aproximações da permeabilidade equivalente obtidas de testes de formação por dois métodos existentes.
Abstract
Stochastic modeling has received increasing attention in the oil industry, being established a ordinary tool for helping the elaboration of development plans in producing reseTVO-|rSi
Combinatorial optimization techniques, such as simulated annealing, allow to produce equiprobable models of reservoir variables, reproducing a priori any characteristic that can be stated as an objective function, besides the histogram and the variogram, which can be honored with traditional geostatistics methods.
In this thesis, the ability of the simulated annealing algorithm to incorporate geological and production (well test) data, reducing uncertainties in simulated models is reviewed. Recent works results (Pérez, 1991; Deutsch, 1992) are reinforced and extended for a wider range of properties.
Stochastic evolution, a newly developed algorithm, is introduced in probabilistic modeling. A comparison between this technique and annealing is performed, taking into account computing times and capacity of reproducing several complexity levels characteristics for different size problems. The quality of simulated models is also studied using some criteria, such as CPU time, tolerances, correlation coefficients between simulated and real images, and flow performance.
The algorithms ability for generating reservoir vertical cross sections with several constraining information levels is verified. The effect of including global (whole reservoir) variogram, local variograms, local averages and well test derived permeability with two approximations methods is analyzed.
Conteúdo
1	INTRODUÇÃO	1
2	MODELAGEM E OTIMIZAÇÃO	4
...2.1 Modelagem Estocástica	.............. . . .	4
2.1.1	Modelagem estocástica para a caracterização de reservatórios . ...	4
2.2	Otimização Combinatorial (OC) ................................    6
2.3	“Simulated Annealing” - Conceituaçao ...........................  8
2.3.1	Introdução.........................................        8
2.3.2	“Simulated Annealing” - Descrição do Algoritmo ..........	9
2.4	“Simulated Annealing” - Aplicações Gerais ...................... 14
2.5	“Simulated Annealing” ~ Aplicações em Modelagem	Estocástica .....14
2.6	Implementação de Novas Funções Objetivo........................  17
2.6.1	Estatísticas de Múltiplos Pontos .......................  20
2.6.2	Conectividade ........................................    21
2.6.3	Permeabilidade Equivalente .............................  24
2.6.4	Tempo de Execução - Comentários.......................    25
2.7	Evolução Estocástica.........................................    26
3	ALGORITMOS DE OTIMIZAÇÃO COMBINATORIAL - APLICA-
ÇÃO EM MODELAGEM ESTOCÁSTICA	30
3.1	Características dos Programas Utilizados.........................30
3.1.1	Programas Desenvolvidos - “Simulated Annealing” ..........32
3.1.2	Programas Desenvolvidos - Evolução Estocástica ........... 34
3.2	Formulação da Função Objetivo - Variogramas ...................  34
3.3	Erros e Tolerâncias............................................  36
3.3.1	Erros Amostrais.......................................    40
3.3.2	Tolerância da Função Objetivo ........................    40
3.4	Performance dos Algoritmos - “Simulated Annealing” e Evolução Estocástica 43
3.5	Mínimos Locais ................................................  44
3.6	Critérios de Quantificação da Qualidade .........................48
3.6J Coeficiente de correlação entre os valores das células das imagens
simuladas e das imagens padrão ......................  48
3.6.2	Comportamentos de fluxo simulados ...................  49
4	REPRODUÇÃO DE CARACTERÍSTICAS DE RESERVATÓRIOS -INFORMAÇÕES GEOLÓGICAS	51
4.1	Geração de Imagens Padrão  ................................  52
4.1.1	Imagem Padrão 1 ...................................    52
4.1.2	Imagem Padrão 2..................................    .	64
4.1.3	Imagem Padrão 3 ............. .......................  67
4.1.4	Imagem Padrão 4..................................      67
4.1.5	Quadro Resumo e Distribuições........................  72
4.2	Reprodução de Variogramas e Médias - Procedimento	. .........72
4.2.1	Seleção de pontos do variograma global ................ 77
4.2.2	Pontos Condicionais e Distribuições..................  77
4.2.3	Parâmetros Utilizados nas Simulações...................79
4.2.4	Escolha das Tolerâncias .............................  79
4.2.5	Médias e Variogramas Regionais.......................  80
4.3	Resultados Obtidos - Tempos, Tolerâncias e Coeficientes de Correlação . . 80
4.4	Resultados Obtidos - Comportamentos de Produção ...........  89
5 REPRODUÇÃO DE CARACTERÍSTICAS DE RESERVATÓRIOS ™
INFORMAÇÕES DE PRODUÇÃO	100
5.1	Testes de Formação .................................    101
5.2	Aproximações da Permeabilidade Equivalente . .........  103
5.2.1	Aproximação pela média potencial ...............  104
5.2.2	Aproximação de Le Loc’h ........................  105
5.3	Inclusão de Informações de Testes - Procedimento .............. 105
5.3.1	Calibração para Estimativa do Volume Equivalente e Expoente cu . 106
5.3.2	Definição das Funções Objetivo ..............    .118
5.3.3	Processamento x Pds-Processamento ..............  119
5.4	Resultados Obtidos - Tempos, Tolerâncias e Coeficientes de Correlação . . 120
5.4.1	Fases 3, 4 e 5 .... .......................... 120
5.4.2	Fase 6.......	. ..................................  127
5.5	Resultados Obtidos - Comportamentos de Produção . ......... . 128
6	CONCLUSÕES E RECOMENDAÇÕES	139
6.1	Conclusões..............................................  139
...6.2 Recomendações e Sugestões ..............................  140
A	Simulação Sequencial Gaussiana	143
A,1 Krigagem..............................................    143
A.2 Simulação Sequencial Gaussiana..........................  144
B Estimativa da Temperatura Inicial no Algoritmo de “Simulated Annea-
ling”.	147
C Atualização Local do	Variograma	148
D Arquivos de Entrada	dos Programas	149
E Correção do Efeito de Suporte	152
F Regiões de Médias e Variogramas Reproduzidas nas Imagens Modeladas 154
Lista de Tabelas
2.1	Resultados do “simulated annealing” e evolução estocástica para o proble-
ma do vendedor ambulante. ..........................	28
3.1	Características das imagens geradas para testar critérios de seleção de pontos do variograma e condições impostas. ............................    .	35
3.2	Tempos de execução e número de trocas necessário para atingir a tolerância
£ = 0.0002 em cada caso (vide tabela 3.1). .........................  36
3.3	Tempos de execução e número de trocas dos algoritmos de “simulated an-
nealing” (SA) e evolução estocástica (EE) para o exemplo do item 3.3.	. . 44
3.4	Critérios de seleção de pontos do variograma utilizados nas imagens com
25600 células (160 x 160).........................................    45
3.5	Tempos de execução, número de trocas e valor final da função objetivo para
os casos da tabela 3.4. ............................................  46
4.1	Descrição das fácies observadas no afloramento da Fm. Açu. . .......  56
4.2	Regiões de médias impostas para a imagem intermediária. .........	61
4.3	Regiões de médias impostas para a imagem padrão 2. . . . .............66
4.4	Características variográficas e dimensões das imagens padrão..........72
4.5	Características estatísticas das imagens padrão. ...............	74
4.6	Parâmetros utilizados no algoritmo de “annealing” para a simulação de
seções verticais. . ...............................................   79
4.7	Resultados obtidos na simulação de imagens associadas ao padrão 1 com
os parâmetros da tabela 4.6. .....................................    82
4.8	Resultados obtidos na simulação de imagens associadas ao padrão 2 com
os parâmetros da tabela 4.6.........................................  83
4.9	Resultados obtidos na simulação de imagens associadas ao padrão 3 com
os parâmetros da tabela 4.6.........................................  84
4.10	Resultados obtidos na simulação de imagens associadas ao padrão 4 com
os parâmetros da tabela 4.6 ......................................    85
4.11	Resultados obtidos na simulação de imagens associadas ao padrões 1 e 2
com parâmetros de “annealing” fixos e sementes diferentes.............86
4.12	Resultados obtidos na simulação de imagens associadas ao padrões 3 e 4
com parâmetros de “annealing” fixos e sementes diferentes. .........	86
4.13	Características das simulações de fluxo monofásico utilizadas para as imagens padrão e imagens modeladas. ...................................  91
5.1	Permeabilidades de teste interpretadas das imagens padrão e intervalos de
tempo considerados. .....................................  106
5.2	Valores mínimos e máximos do coeficiente angular e permeabilidade de
teste das imagens simuladas na fase 2.	.................. 115
5.3	Valores ótimos dos pares (A,u;) obtidos empíricamente para a utilização da aproximação da média potencial. ....................... 118
5.4	Células investigadas pelos testes de formação simulados. .......... 119
5.5	Tempos e número de trocas necessárias para as imagens atingirem a to-
lerância especificada. ................... ................. ....	121
5.6	Coeficientes de correlação (psr) obtidos para as imagens associadas à ima-
gem padrão 1 - fase 3 (com pós-processamento). ..................122
5.7	Coeficientes de correlação (psr) obtidos para as imagens associadas à ima-
gem padrão 2 - fases 3 (processamento normal), 3 (pós-processamento), 4
e 5. ...................... .................................    122
5.8	Coeficientes de correlação (p3r) obtidos para as imagens associadas à ima-
gem padrão 3 - fases 3, 4 e 5..............................      123
5.9	Coeficientes de correlação (psr) obtidos para as imagens associadas à ima-
gem padrão 4 - fases 3S 4 e 5. ................................  123
5.10	Resumo dos resultados obtidos nas simulações da fase 6........  128
F.l Regiões de variogramas locais considerados como condição reproduzida nas
imagens simuladas.  ...........................................  154
F.2 Regiões de médias consideradas como condição reproduzida nas imagens
simuladas..................................................      154
Lista de Figuras
2.1	Algoritmo genérico para o método de “simulated annealing”. ..............10
2.2	Fluxograma exemplificado para o método de “simulated annealing” ....	11
2.3	Comportamentos de pressões no poço em imagens fictícias geradas estocas-
ticamente.  ..........................................................    17
2.4	Ocorrência de viés causada pela ausência de informação sobre o variograma
na direção horizontal.  ................................................  19
2.5	Exemplos de configurações possíveis para 1, 2 e 3 pontos para o cálculo de
uma estatística de n pontos. .........................................    20
2.6	Dois reservatórios hipotéticos com diferentes continuidades da litologia a-
renito e variogramas indicadores iguais. . .............................  21
2.7	Gráfico da função conectividade correspondente à direção N55W de uma
seção do arenito Berea. ................................................  22
2.8	Influência da inclusão de aproximações de permeabilidade nos histogramas
de óleo recuperável...............................................      .	25
2.9	Algoritmo genérico do método de Evolução Estocástic....................  27
2.10	Rotas geradas com os algoritmos de “simulated annealing” e evolução es-
tocástica para o problema do vendedor ambulante. .......................  29
3.1	Imagens e variogramas (experimental e modelo) correspondentes aos casos
A, B eC da tabela 3.1. ...............................................    37
3.2	Imagens e variogramas (experimental e modelo) correspondentes aos casos
D,	E e F da tabela 3.1.........................................          38
3.3	Imagens e variogramas (experimental e modelo) correspondentes aos casos
G,	H e I da tabela 3.1. ...............................................  39
3.4	Evolução das Imagens e Variogramas em função do valor da função objetivo
(tolerância). ..........................................................  41
3.5	Imagem gerada pelo método de simulação sequencial gaussiana (SSG) e
variogramas correspondentes. .........................................    42
3.6	Imagem gerada com o algoritmo de evolução estocástica (EE) e variogramas
correspondentes. ...................................................      42
3.7	Comportamento da função objetivo durante a modelagem com “simulated
annealing” (SA) e evolução estocástica (EE). ...........................  43
3.8	Comportamento das razão de aceitação (x) e razão de melhoria (V’) nos
algoritmos de “simulated annealing” (SA) e evolução estocástica (EE).	. . 45
3.9	Imagens correspondentes aos casos Le N da tabela 3.4 e variograma resultante (direção horizontal).......................................    .	47
3.10	Coeficiente de correlação (p«r) em função da número mínimo de iterações
em cada temperatura (Mo), para diversas velocidades de esfriamento (a). ,	49
4.1	Localização relativa dos poços correspondentes às análises petrofísicas em
. . amostras de testemunhos. ...........................	53
4.2	Distribuição dos valores de log(Â'h) obtidos de medições em plugues. ...	53
4.3	Relações entre as variáveis secundárias (&lt;/&gt; e log(Â'v)) e a variável principal
(log(A'Zi)), medidas em pingues...............................  .	54
4.4	Variograma da variável log(Kh) na direção vertical, com os valores medidos
em pingues no laboratório. . ...................................  55
4.5	Variograma da variável indicadora (fácies), obtida do afloramento da Fm.
Açu. .......................................................      57
4.6	Variograma na direção vertical da variável log(Kà) para o suporte da imagem intermediária (4.0 x 0.4 m). ..............................      .	60
4.7	Perfis da variável log(Kà) nos poços condicionantes, regularizada para o
suporte intermediário. .............................	62
4.8	Perfis de raios gama dos poços condicionantes da imagem intermediária do
padrão 1.	................................... ..................63
4.9	Imagem intermediária com 192 x 48 células gerada para a construção da
imagem padrão 1. . ...........................................    64
4.10	Imagem Padrão 1 e variogramas	nas	direções horizontal e	vertical..65
4.11	Distribuição de probabilidade dos	valores	da imagem padrão 2....  66
4.12	Imagem Padrão 2 e variogramas............................... 68
4.13	Imagem Padrão 3 e variogramas.....................................69
4.14	Fotografia do afloramento da Fm. Piramboia (bacia do Paraná)....  70
4.15	Fotografias de detalhes do afloramento da Fm. Piramboia (bacia do Paraná). 71
4.16	Imagens digitalizadas do afloramento da Fm. Piramboia (bacia do Paraná),
^destacando a região selecionada para a construção da imagem padrão 4. . .	73
4.17	Detalhe do afloramento da Fm. Piramboia após transformação da distribuição de tonalidades para a distribuição de log(Jíà)............. 74
4.18	Imagem Padrão 4 e variogramas nas direções horizontal e vertical. .....	75
4.19	Distribuições dos valores de logfJKh) utilizados nas imagens padrão 1 a 4. .	76
4&lt;20 Representação das distâncias e direções selecionadas para a simulação de imagens associadas ao padrão 1. ..................................... 76
4&lt;21 Representação das distâncias e direções selecionadas para a simulação de imagens associadas ao padrão 4....................................    76
4.22	Comportamentos do coeficiente de correlação (p5r) em função da tolerância .......da-funçâo objetive especificada (c) e tempos de CP-U- correspondentes. . . * 78
4.23	Exemplos de imagens geradas na primeira e na segunda fase, comparando
com a imagem padrão correspondente (4) e seus variogramas............	.	79
4.24	Exemplos de imagens relacionadas ao padrão 3.  .......................86
4.25	Imagem E12 (evolução estocástica e seus variogramas.................  87
4.26	Comportamentos da função objetivo e razões de aceitação e melhoria para
um caso onde um mínimo local não é ultrapassado (imagem El2)	.....	88
4.27	Comportamentos de pressões simulados das imagens relacionadas ao padrão
1	nas fases 1 e 2. .................................................  90
4.28	Comportamentos de pressões simulados das imagens relacionadas ao padrão
2	nas fases 1 e 2.............................................      .	91
4.29	Comportamentos de pressões simulados das imagens relacionadas às faces
1 (esquerda) e 2 (direita) do padrão 3 na fase 1. .... .............  92
4.30	Comportamentos de pressões simulados das imagens relacionadas à face 1
(esquerda) do padrão 4 nas fases 1 e 2................  ..............93
4.31	Comportamentos de pressões simulados das imagens relacionadas à face 2
(direita) do padrão 4 nas fases 1 e 2...............................  94
4.32	Imagens geradas na primeira e segunda fase, em comparação com o padrão 1. 95
4.33	Imagens geradas na primeira e segunda fase com comportamentos de pres-
sões próximos ao real, em comparação com o padrão 2.................  96
5.1	Função de peso para diversos instantes em função da distância adimensional.100
5.2	Esquema da função peso atribuida a cada posição x na influência da mesma
na permeabilidade obtida em um teste de formação. ............. 101
5.3	Mapas de isodesvios, isoerros e iso(desvios -f erros) para as imagens simuladas na fase 2 associadas ao padrão 1 (face esquerda). ........... 105
5.4	Mapas de isodesvios, isoerros e iso(desvios + erros) para as imagens simuladas na fase 2 associadas ao padrão 2 (face esquerda). ..................106
5.5	Mapas de isodesvios, isoerros e iso(desvios + erros) para as imagens simuladas na fase 1 associadas ao padrão 3 (face esquerda, intervalo de tempo
tl). .........................................................      .	107
5.6	Mapas de ísodesvios, isoerros e iso(desvios + erros) para as imagens simuladas na fase 1 associadas ao padrão 3 (face esquerda, intervalo de tempo
12)......... . ........ ............ ................. ....... 108
5.7	Mapas de ísodesvios, isoerros e iso(desvios -f- erros) para as imagens simuladas na fase 1 associadas ao padrão 3 (face direita). ............. 109
5.8	Mapas de ísodesvios, isoerros e iso(desvios + erros) para as imagens simuladas na fase 2 associadas ao padrão 4 (face esquerda, intervalo de tempo
tl).........................................................    110
5.9	Mapas de ísodesvios, isoerros e iso(desvios + erros) para as imagens simuladas na fase 2 associadas ao padrão 4 (face esquerda, intervalo de tempo
12)................................................. 111
5.10	Mapas de ísodesvios, isoerros e iso(desvios + erros) para as imagens simuladas na fase 2 associadas ao padrão 4 (face direita). .........112
5.11	Gráficos de verificação da calibração do par (X,^^) para as imagens simuladas associadas aos padrões 1, 2 e 3. .........................114
5.12	Gráficos de verificação da calibração do par (4,u?oít) para as imagens simuladas associadas ao padrão 4................................    115
5.13	Imagens geradas nas fases 3 e 5, e comparação com o padrão 2....122
5.14	Imagens geradas nas fases 3 e4, e comparação com o padrão 4..  .	123
5.15	Imagens geradas nas fases 3 e 4, comparando com o padrão 3...  .	124
5.16	Imagem associada ao padrão 3 gerada com as condições da fase 4 através
de pós-processamento......................................      125
5.17	Imagem gerada com os procedimentos da fase 6..................  127
5.18	Comportamentos de pressões simulados das imagens relacionadas aos padrões 1 e 2 na fase 3 (com pós-processamento).................  128
5.19	Comportamentos de pressões simulados das imagens relacionadas ao padrão
2	nas fases 3 e 4.............................................  129
5.20	Comportamentos de pressões simulados das imagens relacionadas ao padrão
2	na fase 5. .................................................  130
5.21	Comportamentos de pressões simulados das imagens relacionadas ao padrão
3	(faces esquerda e direita) na fase 3. ........................131
5.22	Comportamentos de pressões simulados das imagens relacionadas ao padrão
3	(faces esquerda e direita) na fase 4. . ....................  132
5.23	Comportamentos de pressões simulados das imagens relacionadas ao padrão
3	(faces esquerda e direita) na fase 5. ......................  133
5.24	Comportamentos dc pressões simulados das imagens relacionadas ao padrão
4	(faces esquerda e direita) na fase 3...........................134
5.25	Comportamentos de pressões simulados das imagens relacionadas ao padrão
4	(faces esquerda e direita) na fase 4.......................    135
5.26	Comportamentos de pressões simulados das imagens relacionadas ao padrão
4	(faces esquerda e direita) na fase 5.	........136
A.l Representação gráfica da transformação de uma variável com distribuição cumulativa de probabilidades Fz para outra com distribuição Fy e vice-versa. 144
A.2 Representação gráfica do processo de geração de uma realização zt de uma variável aleatória com distribuição de probabilidade Fz&gt; ........... 144
D.l Exemplo de arquivo de entrada para o programa sasim7..............148
D.2 Exemplo de arquivo de entrada para o programa sesim3............  149
1	INTRODUÇÃO
A caracterização de propriedades dos reservatórios é unia atividade que vem ganhando importância crescente na indústria do petróleo, principalmente a partir da década de 80.
Após as grandes crises do petróleo na década de 70, provocando aumentos de preço substanciais, a busca por novas jazidas e pela explotação mais eficaz dos reservatórios já descobertos teve um grande impulso. Técnicas de recuperação suplementar, estudos de completação seletiva mais detalhados e análises econômicas visando a otimização do número de poços nos diversos estágios da vida produtiva dos campos, são exemplos de atividades que vem se tornando cada vez mais rotineiras como subsídio à decisões técnicas e gerenciais visando a obtenção de maiores lucros ou recuperações, particularmente quando as reservas de hidrocarbonetos justifica.
Diversas ferramentas são utilizadas quando um estudo cuidadoso é elaborado. Com o contínuo e rápido desenvolvimento dos computadores, a simulação numérica de fluxo passou a desempenhar um papel importante, partindo de um modelo físico onde o reservatório é discretizado em células, com os valores das variáveis de maior importância (permeabilidades, porosidades, saturações, espessuras efetivas, etc.) sendo atribuidos a cada uma delas.
Descrições detalhadas do reservatório são fundamentais para tais estudos serem bem sucedidos, tendo motivado recentes conferências sobre o assunto (Lake Carroll, 1986; Lake et al.y 1991).
O principal problema na caracterização de reservatórios de petróleo está relacionado à escassez de dados. Somente nos pontos atravessados pelos poços os valores de algumas das propriedades de interesse são conhecidos, representando um percentual baixíssimo do volume total do reservatório. Embora o futuro aponte para o desenvolvimento de técnicas que procurem a obtenção dos parâmetros de interesse no restante do reservatório, como a geofísica de explotação (Johnston, 1989), limitações severas ainda existem sob os aspectos técnicos e econômicos para se trabalhar com o nível de detalhe necessário.
Desta maneira, torna-se conveniente a utilização de técnicas de modelagem que permitam gerar valores estocásticos das variáveis desejadas nas regiões desconhecidas impondo-se certas condições, com o intuito de representar as heterogeneidades do reservatório considerando o que se conhece do mesmo e a experiência que se possa ter de outros.
Existem diversas técnicas de modelagem estocástica que podem ser utilizadas na geração de imagens do reservatório. No capítulo 2 são apresentados alguns comentários sobre estas técnicas.
Nesta dissertação é apresentada uma abordagem de modelagem estocástica relacionada a técnicas de otimização combinatoria!, cuja característica é a possibilidade de gerar
1
Capítulo 1 —
2
imagens equiprováveis que reproduzam a princípio qualquer característica do reservatório desejada que possa ser quantificada. Os objetivos propostos são:
-	Apresentar e rever as aplicações, características e o potencial do algoritmo conhecido como “simulated annealing” na modelagem estocástica de variáveis de reservatórios, verificando a validade de conlusões obtidas em trabalhos recentes (Pérez, 1991; Deutsch, 1992) para casos mais abrangentes;
-	Introduzir e testar um novo algoritmo de otimização, denominado evolução estocástica na modelagem probabilística de reservatórios, comparando-o em casos diversos com o “simulated annealing” em termos de execução e qualidade das imagens (modelos) gerados;
-	Propor e verificar novas formas de se introduzir informações de produção como característica a ser reproduzida nos modelos gerados com técnicas de otimização combinatorial, comparando com a metodologia utilizada por Deutsch (1992).
O capítulo 2 aborda conceitos básicos de modelagem estocástica, com ênfase para as técnicas de otimização combinatorial. E feita uma revisão teórica do algoritmo de “simulated annealing” e sua aplicação na modelagem estocástica para a caracterização de reservatórios, sendo apresentados os principais resultados e conclusões dos trabalhos pu-blicados sobre o assunto. E apresentado o algoritmo de evolução estocástica, desenvolvido recentemente com aplicações bem sucedidas em outras áreas.
No capítulo 3 são apresentadas características dos algoritmos de “annealing” e e-volução estocástica quando aplicados à modelagem probabilística em geral. Os programas desenvolvidos para reproduzir algumas informações geológicas e de produção são descritos. Alguns critérios a serem obedecidos na definição da função objetivo e na escolha da tolerância são comentados, com o exemplo da reprodução de variogramas. O comportamento típico dos algoritmos é mostrado, em casos onde os mesmos atingem a tolerância desejada e em um caso onde o “simulated annealing” não é capaz de reproduzir as características desejadas na imagem simulada (mínimo local). Finalmente, são apresentados os critérios utilizados nos capítulos subsequentes para verificar a qualidade das imagens simuladas.
O capítulo 4 apresenta exemplos de aplicações dos algoritmos na modelagem de seções verticais de reservatórios. E descrito com detalhes o procedimento de construção de imagens padrão, com a finalidade de comparação com as imagens simuladas que tentam reproduzir algumas características das mesmas. A influência da introdução de características adicionais (médias e variogramas locais) com os critérios apresentados no capítulo 3 é discutida.
No capítulo 5 são descritas e utilizadas funções que procuram representar informações de produção, no caso a permeabilidade obtida de testes de formação. Duas aproximações são incluidas como termos da função objetivo, uma delas previamente implementada por Deutsch em sua tese de doutoramento (Deutsch, 1992). O efeito na qualidade das imagens é verificado e comentado.
3
— Capítulo 1 —
O capítulo 6 resume as principais conclusões obtidas ao longo da dissertação. Algumas recomendações e sugestões são apresentadas para estudos futuros.
2	MODELAGEM E OTIMIZAÇÃO
2.1	Modelagem Estocástica
A modelagem estocástica consiste na geração de modelos de um processo ou estado de um sistema (estático ou dinâmico), onde existe um componente probabilístico (estocástico) envolvido.
A característica probabilísima do processo de modelagem ou simulação estocástica pode ser tanto intrínseca ao sistema como consequência da falta de conhecimento de um sistema determinístico. No primeiro caso, por exemplo, poderia se desejar simular o volume de tráfego em uma auto-estrada, ou os números resultantes ao se lançar um conjunto de dados não viciados. O segundo caso podería representar a simulação de uma propriedade de uma rocha reservatório, por exemplo a porosidade. Sua distribuição espacial é determinística, oriunda dos processos sedimentares e diagenéticos que ocorreram ao longo de milhões de anos. Entretanto, o conhecimento do sistema reservatório é bastante limitado, restringindo-se aos pontos atravessados pelos poços. Em outros pontos nada se conhece, ou apenas se pode inferir possíveis valores da variável com base em interpretações geológicas ou medições de outras variáveis (X, F) que guardam alguma relação com aquela sendo simulada (Z), Por exemplo, Z(x) = permeabilidade absoluta; Y(x) ~ porosidade; X(x) — energia sísmica.
Desta forma, é conveniente neste caso tratar o reservatório como um processo de natureza probabilística, associado a variáveis aleatórias que podem ser simuladas es tocas-ticamente.
Para que modelar ?
De maneira geral, a modelagem estocástica tem objetivos diversos, sendo impossível separar diretrizes universais na prática (Ripley, 1987). Pode-se citar desde casos de treinamento (ex.i simulador de voo) ou lazer (jogos eletrônicos) como a obtenção de modelos de reservatórios com finalidade de previsão do comportamento de fluxo (característica dinâmica) ou previsão da espessura de rocha antes da perfuração de um poço (característica estática). Neste caso, a modelagem estocástica constitui-se em uma ferramenta importante para a tomada de decisões.
2.1.1	Modelagem estocástica para a caracterização de reservatórios
A modelagem estocástica de reservatórios é motivada principalmente pela escassez de dados conhecidos. A necessidade de se tornar decisões relacionadas aos planos de explotação (recuperações primária e suplementar) e elaborar-se previsões de produção e reservas, tendo-se uma mensuração dos riscos envolvidos, sugere que se analise as inúmeras possibilidades existentes.
4
— Capítulo 2 —
5
Haldorsen &amp;amp; Damsleth (1990) afirmam que “a descrição de reservatórios é urna combinação de observações (o componente determinístico), interpretação ‘educada’ (geología, sedimentologia) e ‘adivinhação’ formalizada (o componente estocástico)”.
Os mesmos autores fazem uma apresentação abrangente das técnicas de modelagem estocástica que podem ser utilizadas para a geração sintética de propriedades do reservatório e de sua arquitetura geológica. Estas técnicas procuram honrar algumas características estatísticas e correlações espaciais desejadas, através de histogramas, vari-ogramas e geometrias de fácies, por exemplo. Outra propriedade comum a maior parte dos métodos é honrar os pontos onde as variáveis são conhecidas no reservatório (simulação condicional).
Os modelos estocásticos podem ser classificados em discretos e contínuos, dependendo se permitem a descrição de características geológicas de natureza discreta (ex.: localização e dimensão de fácies) ou contínuas (ex.: permeabilidade absoluta, porosidade, saturações, velocidades sísmicas). Estes últimos pertencem ao ramo da geoestatística ou da teoria das variáveis regionalizadas , cujo formalismo ou aplicações podem ser encontradas em diversos trabalhos (refs. em Haldorsen &amp;amp; Damsleth, 1990).
Geralmente, cada modelo estocástico possui vantagens e desvantagens particulares. Nenhum modelo é perfeito para substituir o que a natureza fez, e a escolha daquele a ser adotado depende de fatores diversos, como: quantidade e qualidade dos dados disponíveis; objetivo principal da modelagem; programas e equipamentos disponíveis; conhecimentos teóricos e práticos do pessoal envolvido (Haldorsen &amp;amp; Damsleth, 1990).
A tendência atual, que vem ganhando cada vez mais interesse, é combinar duas técnicas (uma discreta e outra contínua) gerando um modelo híbrido que em um primeiro estágio procura descrever as heterogeneidades de larga escala (macrogeometria ou fácies), e no segundo estágio gera os valores das variáveis contínuas no interior de cada fácie (Omre, 1988 Apud Damsleth et al, 1992; Rudkiewicz et al., 1990 Apud Damsleth et al., 1992; Damsleth et al. , 1992). Damsleth et al, por exemplo, apresentam os resultados da aplicação de um modelo híbrido para a geração de modelos equiprováveis de um reservatório do Mar do Norte. Para cada seção vertical gerada estocas! icamen te, foi simulada a injeção de água em uma extremidade e a produção de óleo e água na face oposta, plotando-se os comportamentos das produções dos finidos. Concluiu-se que um modelo determinístico baseado em mapas construidos manualmente (“suavizados”), sem o compromisso de reproduzir as variações de fácies (através de variogramas) e propriedades petrofísicas existentes, sempre leva a resultados otimistas, além de não permitir o acesso a informações a respeito das incertezas na previsão do comportamento de produção.
A Função Variograma
Nos modelos probabilísimos de reservatórios, uma função que quase sempre é imposta como característica a ser reproduzida é o semivariograma1, que fornece uma
1 Nesta dissertação o termo variograma é utilizado com o mesmo significado do semivariograma.
— Capítulo 2 —
6
medida da correlação espacial de uma determinada variável Z(x). Esta função é definida
com oi
7(h) = l£{[Z(x+h)-Z(x)]2}	(2.1)
onde:
.......h	é o vetor espaçamento;
x é a localização da variável Z na área analisada;
E é o operador esperança matemática.
Nas aplicações práticas, o semi-variograma é estimado por:
1	A&gt;(h)
5(h) = W(h) g [z(x + h) “ Z(x)p	(2'2)
onde Np(h) é o número de pares de pontos separados pela distância associada ao vetor h.
2.2	Otimização Combinatorial (OC)
O processo de otimização consiste em se obter a melhor solução, ou a solução ótima de um problema. Em particular, as teorias e técnicas matemáticas utilizadas na busca de soluções ótimas em problemas que tem um número finito de soluções pertencem ao ramo denominado “otimização combinatorial” (Foulds, 1984:3). Técnicas como programação linear, programação inteira e programação dinâmica são aplicáveis em inúmeros problemas de ciências e engenharia, encontrando amplas aplicações na área de pesquisa operacional.
Existem problemas para os quais foram desenvolvidos algoritmos efetivos para solução. O conceito de efetividade foi apresentado por Edmonds (Edmonds, 1965 Apud Foulds, 1984:112), e relata que: “um algoritmo é considerado efetivo se garante resolver qualquer exemplo do problema para o qual foi desenvolvido através da execução de um número de passos computacionais elementares, podendo este número ser expresso como uma função polinomial da dimensão do problema”.
Para uma vasta classe de problemas, entretanto, é possível o desenvolvimento de algoritmos particulares, mas nenhum algoritmo efetivo é conhecido. São denominados “polinomiais não determinísticos” (PN). Para esta classe justifica-se o desenvolvimento de procedimentos heurísticos, ou seja, algoritmos que não garantem como produto final uma solução ótima para todos os exemplos do problema, mas que geralmente procuram uma
— Capítulo 2 —
7
estratégia para obter soluções suficientemente boas para fins práticos. Esses algoritmos
são também denominados algoritmos de aproximação, embora a distinção entre algoritmos
de otimização e de aproximação muitas vezes não seja rigorosa para fins práticos (Aarts
Korst, 1989).
Foulds cita três razões para justificar a elaboração de métodos heurísticos (Foulds, 1984):
1.	As dimensões do problema são tão grandes que mesmo o algoritmo mais rápido conhecido exige um tempo computacional proibitivo para a obtenção de uma solução ótima;
2.	Impossibilidade de definir o problema claramente em termos explícitos. Os objetivos de diferentes gerentes na operação de um sistema podem ser diferentes, ou algumas características não podem ser definidas em termos quantitativos;
3.	A coleta de dados pode envolver problemas de precisão e magnitude; nestes casos a utilização de dados aproximados torna a busca de uma solução ótima sem sentido.
A primeira destas razões, caracterizada por um leque imenso de soluções possíveis, pode ser batizada de “explosão combinatoria^, tendo um grande número de e-xemplos existentes em áreas diversas como finanças, alocação de recursos, engenharia, economia, psicologia e biologia (Glover &amp;amp; Greenberg, 1989). Para a resolução prática destes problemas, cinco métodos heurísticos tem sido pesquisados recentemente: “simula-ted annealing”2, redes neurais, algoritmos genéticos, “tabu search” e análise de objetivos (“target analysis”). 0 “simulated annealing” foi inspirado nos princípios das ciências físicas (2- lei da Termodinâmica); os algoritmos genéticos e as redes neurais inspiram-se em princípios das ciências biológicas; o “tabu search” e o “target analysis” nos dogmas da resolução inteligente de problemas (Glover &amp;amp; Greenberg, 1989). Mais recentemente, uma nova técnica denominada evolução estocástica foi desenvolvida (Saab &amp;amp; Rao, 1991), seguindo um conceito de evolução não baseado na evolução biológica.
Na comparação entre métodos heurísticos quanto ao esforço computacional e qualidade das soluções obtidas, o procedimento mais correto é realizar-se comparações utilizando-se o problema particular sendo estudado. Entretanto é comum a utilização de problemas clássicos de pesquisa operacional nestas comparações. O problema do “vendedor ambulante”3 é a referência mais comum para as comparações, por ser um problema facilmente formulado mas de solução difícil. Este problema consiste em determinar a melhor rota a ser adotada por alguém que necessite visitar n cidades e retornar ao ponto de
2A tradução literal do termo em português é “recozimento simulado”, ou “cristalização simulada”, havendo semelhança com os processos físicos de recozimento de metais ou cristalização de sólidos, onde a temperatura é reduzida lentamente. Optamos nesta dissertação por manter o termo original em inglês, pelo fato destas traduções não serem ainda de uso consagrado.
3Em inglês traveling salesman problem
Capítulo 2 —
8
partida. Conhecendo-se os custos (ou distâncias) d,; entre as cidades i e j, o problema é minimizar a função /(x) definida como:
= È d'.4-)	(2-3)
»=1
onde 7r(z), i = 1,... ,n denota a cidade sucessora da cidade i na rota representada por 7T........... ■■■■■■■■■■■■■■■■-	...■.■■■■■■.■■■■■■.■...■■.■....■.■.■■■■■■■■■■■■.■....
Nos itens seguintes são descritas as duas técnicas de OC usadas para a modelagem probabilística nesta dissertação: o “simulated annealing” e a evolução estocástica, que tem a vantagem de possuir uma conceituaçâo relativamente simples. As demais técnicas ficam como sugestão para implementação futura. Em particular, na fase final de elaboração desta dissertação foi publicado o primeiro trabalho descrevendo a utilização de um algoritmo genético na modelagem estocástica de reservatórios (Sen et al^ 1992).
2*3 “Simulated Annealing” -- Conceituaçâo
2.3.1	Introdução
O “simulated annealing” é uma técnica que vem recebendo muita atenção nos últimos anos, tendo sido baseada em um modelo para simular a cristalização ou recozimento (“annealing”) de sólidos proposto por Metrópolis et al. (1953). O interesse recente iniciou-se com os trabalhos de Kirkpatrick et al. (1983) e Cerny (1985). Estes autores mostraram que o modelo proposto por Metrópolis ei al. poderia ser utilizado em problemas de otimização, devido ao paralelo que se podia fazer entre a função objetivo a ser minimizada e a energia dos estados do sólido (Eglese, 1990).
No caso, Kirkpatrick et al. apresentaram a técnica aplicada ao projeto de computadores (“layout” e conexão de “chips”), enquanto Cerny apresentou um algoritmo para o problema do vendedor ambulante.
O algoritmo de Metrópolis é baseado nos conceitos de mecânica estatística, podendo ser utilizado eficientemente para simular um conjunto de átomos em equilíbrio numa determinada temperatura. Em cada passo um pequeno deslocamento aleatório é proposto para um átomo, e a mudança de energia resultante (AE) é computada. A nova configuração proposta é aceita conforme:
onde:
— Capítulo 2
9
AEk é a mudança de energia do sistema com a nova configuração na iteração k do passo r do programa;
Prob(AEk,TT) é a probabilidade da nova configuração ser aceita;
TT é a temperatura do sistema no passo r
ks é a constante de Boltzmann.
..... Observação: Cada passo r corresponde a uma temperatura TT.
A analogia com problemas de otimização pode ser feita considerando a energia do sistema (E) como a função objetivo a ser minimizada e a temperatura (T) um parâmetro de controle do algoritmo. As soluções do problema de otimização combinatorial equivalem aos estados do sistema físico.
A medida que a temperatura é reduzida, o sistema tende a atingir a configuração de mínima energia. As pequenas flutuações em torno do comportamento médio do sistema fazem com que algumas configurações propostas que provoquem incremento na energia do sistema também sejam aceitas (principalmente nas temperaturas altas). Com isto se procura evitar que o sistema fique preso em mínimos locais, sendo esta uma característica importante na utilização do algoritmo em problemas de otimização ou de aproximação.
Em termos práticos, para a obtenção do estado de mínima energia de um material não é suficiente atingir-se temperaturas baixas. As experiências para este fim, que procuram obter cristais partindo-se do material fundido (em alta temperatura), são efetivadas através de uma redução lenta de temperatura (recozimento), passando-se um longo tempo nas temperaturas mais baixas. Isto permite que o sistema atinja o equilíbrio em cada temperatura, evitando que uma rede cristalina muito defeituosa ou mesmo uma estrutura amorfa (metaestável) seja formada, correspondendo a mínimos locais (Kirkpatrick et aL, 1983). Este procedimento corresponde a um número suficientemente grande de passos em cada temperatura para que o equilíbrio seja atingido na otimização.
2.3.2	“Simulated Annealing” — Descrição do Algoritmo
Neste item são abordadas as principais características do algoritmo de “simulated an-nealing” em aplicações gerais. Para um tratamento teórico mais detalhado, incluindo a relação das sequências de estados do sistema modelado com cadeias de Markov e provas formais da convergência assintótica do método para o mínimo global, recomenda-se o livro de Aarts &amp;amp; Korst (1989) e o artigo de Romeo &amp;amp; Sangiovanni-Vincentelli (1991).
0 algoritmo genérico frequentemente utilizado na prática segue o esquema da figura 2.1 (Saab &amp;amp; Rao, 1991).
O fluxograma correspondente aos procedimentos da figura 2.1 é mostrado na figura
2.2.
— Capítulo 2 —
10
Algoritmo SA :
S	— So;	/* estado inicial */
T = T°;	/* temperatura inicial */
REPITA
REPITA
Sr^o = PERTURBAsa(S);
S	= ACEITA (Rnow,5,T);
ATE (o critério de iteração interior ser satisfeito);
T = ATUALIZA (T);
ATE (o critério de parada ser satisfeito);
IMPRIMA S; /* imprima o estado final */ FIM	/* fim do programa */
Figura 2.1: Algoritmo genérico para o método de “simulated annealing” - Adaptado de
Saab &amp;amp; Rao, 1991.
No fluxograma da fig. 2.2, o critério para o término das iterações em cada temperatura (critério de iteração interior) é dado pelo teste m &amp;lt;Mt. Quando se atinge um número suficientemente grande de iterações, considera-se que o sistema já atingiu o equilíbrio naquela temperatura, sendo a mesma diminuida de um fator a (0 &amp;lt;a &amp;lt;1) neste caso. No algoritmo de “annealing” utilizado nas simulações estocásticas deste trabalho (capítulos 3, 4 e 5), um critério adicional de mudança de temperatura (ou parâmetro de contróle) é utilizado, visando reduzir o tempo de execução dos programas: quando um número suficiente de alterações de estado aceitas pelo critério da equação 2.4 (Mo) é atingido, a temperatura é reduzida, sem a necessidade de ser atingido o número máximo de iterações Os critérios para alteração de temperatura e o número especificado de iterações para que isto ocorra formam o “plano de esfriamento7’ do algoritmo. Juntamente com o critério de parada (encerramento da execução) e a temperatura inicial (T°) utilizados formam o “plano de ‘annealing’”.
Quanto ao procedimento para perturbação do sistema (função PERTURBA na figura 2.1) basicamente existem duas opções, dependendo do tipo de problema. Pode-se trocar os valores da variável entre dois elementos distintos (ex.: células representando regiões discretizadas de um reservatório, ordem na rota entre duas cidades visitadas no problema do vendedor ambulante). Outra opção é alterar individualmente o valor da variável em um ponto, através da adição de um determinado valor.
— Capítula 2
11
inicialização
S = Sç T = Tc m ~ 0 ■
¿ = 0(S)
GERE N*
ALEATÓRIO ne[Otl[
Figura 2.2: Fluxograma exemplificado para o método de “simulated annealing”
— Capítulo 2 —
12
El ano de esfriamento
Para o plano de esfriamento existem diversos criterios publicados. 0 plano descrito anteriormente, ou soja:
0 &amp;lt;a &amp;lt;1
r = a O
(2.5)
é denominado plano geométrico.
Não existe um critério universal para a escolha do fator a, devendo o mesmo ser testado para cada aplicação. Um valor de a excessivamente alto (esfriamento “lento”) provoca um número grande de iterações desnecessárias em altas temperaturas, aceitando muitas perturbações que não melhoram a função objetivo. Já um valor muito baixo de a (esfriamento rápido) pode fazer com que o sistema fique preso em um mínimo local distante do mínimo global da função objetivo, devido à baixa probabilidade de novos estados que provoquem acréscimo nesta função serem eventualmente aceitos segundo o critério de Metropolis (equação 2.4).
Uma grande variedade de planos de esfriamento é referenciada por Collins et al. (Collins et al^ 1988 Apud Eglese, 1990). Como exemplo, Lundy &amp;amp; Mees (Lundy &amp;amp; Mees, 19S6 Apud Eglese, 1990) propõem um plano com apenas uma iteração em cada temperatura, sendo esta alterada seguindo a equação:
rr = ppgf r-1 ’	B = constante.	(2.6)
Em outro extremo, Connoly sugere que a maior parte das iterações devem ser conduzidas em uma temperatura fixa (Connoly, 1988 Apud Eglese, 1990).
Outros planos de esfriamento permitem alterar a velocidade de decréscimo da temperatura ao longo do processo (Aarts &amp;amp; Laarhoven, 1985 Apud Eglese, 1990; Aarts &amp;amp; Korst, 1989). O plano proposto por Aarts e Korts, por exemplo, utiliza um parâmetro adicional definido como calor específico do sistema C(T) (Kirkpatrick et al.^ 1983) para definir a velocidade conveniente de redução da temperatura:
C(T) =
dE(T) dT
Entretanto, em testes preliminares conduzidos por Pérez em sua tese de doutorado (1991), não foram verificadas vantagens na utilização de um plano iterativo como este na modelagem estocástica com ajuste de variogramas, em comparação com o esquema simples da equação 2.5.
Neste trabalho é utilizado apenas o plano da equação 2.5, mas sugere-se que testes mais detalhados sejam executados com outros planos de esfriamento com a utilização de diversas funções objetivo.
Capítulo 2
13
Convergência e Solução Ótima
Pode-se provar que se a temperatura inicial (T°) for escolhida suficientemente alta, o sistema converge assintoticamente para o mínimo global se o seguinte plano de esfriamento for utilizado (Hajek, 1988 Apud Saab &amp;amp; Rao, 1991; Aarts &amp;amp; Korst, 1989:53):
T°log(r0) , log(r + r0) ’
r0 &gt; 1
(2.8)
onde rQ é uma constante inteira.
Entretanto, este critério leva a um esfriamento excessivamente lento, proibitivo em termos práticos. Em geral é melhor utilizar um plano que gere várias soluções boas do que um que gere apenas a solução ótima no mesmo tempo de execução (Eglese, 1990).
Temperatura Inicial
A escolha da temperatura inicial (T°) é um dos passos fundamentais para o sucesso da execução do algoritmo de “annealing”. A metodologia mais simples é arbitrar uma temperatura inicial e verificar experimentalmente a razão de aceitação inicial, definida para a temperatuta inicial T°. A razão de aceitação inicial para uma temperatura TT qualquer é definida como:
na temperatura T
2.
número de perturbações aceitas número de perturbações propostas
Em alguns programas utilizados nesta dissertação foi implementada uma rotina que permite estimar a temperatura inicial a partir da razão de aceitação inicial desejada. O procedimento utilizado foi desenvolvido por Aarts e Korts (Aarts &amp;amp; Korts, 1989:60) e a rotina desenvolvida por Pérez (1991). Este procedimento consiste em gerar um número de iterações iniciais com perturbações no sistema, calculando as funções objetivo O*n em cada iteração. A partir dai estima-se a temperatura inicial T° conforme descrito no Anexo B.
Critérios de Parada
E necessário ainda especificar um ou mais critérios para encerrar a execução do programa de “annealing”. O critério comum em qualquer implementação do método é terminar a execução quando a função objetivo atingir um valor mínimo (O &amp;lt;e). Muitas vezes, entretanto, este critério isolado exige um tempo excessivo no caso da tolerância e ser muito pequena, ou pode até mesmo ser impossível de ser atingido. Por isto, é recomendável impor-se critérios adicionais, como:
a)	encerrar a execução se a temperatura atingir um valor mínimo jV,naí;
b)	encerrar a execução se um número máximo de iterações (Afi) for atingido em k temperaturas consecutivas;
— Capítulo 2 —
14
c)	encerrar a execução se no final de um determinado passo (correspondente a uma temperatura T^), uma razão de aceitação mínima for atingida, ou seja:
x(7”-) &amp;lt;Xn..„.(T0	(2.10)
onde:
.......x(rr)	é a razão de aceitação definida de acordo com a equação 2.9.
Considera-se que o prosseguimento da execução contribuirá muito pouco para reduzir o valor da função objetivo.
2.4	“Simulated Annealing” - Aplicações Gerais
A técnica de “simulated annealing” vem recebendo grande interesse. Dezenas de artigos são publicados anualmente reportando aplicações diversas como: projetos de trocadores de calor, restauração de imagens, otimização de “layouts”, reconstrução de imagens tomográficas, etc.
Uma das primeiras aplicações diretas em fenômenos espaciais foi publicada por Geman &amp;amp; Geman na restauração de imagens (Geman &amp;amp; Geman, 1984 Apud Deutsch &amp;amp; Journel, 1991). Na área de geofísica o método vem recebendo contínuo interesse, podendo ser aplicado na inversão sísmica nao linear (Rothman, 1985 Apud Deutsch &amp;amp; Journel, 1991; Vestergaard &amp;amp; Mosegaard, 1991). Em perfilagem de poços destaca-se a aplicação na determinação de litologias (Cheng-Dang ef a/., 1992).
2.5	“Simulated Annealing” - Aplicações em Modelagem Es-
tocástica
O paralelo existente entre otimização combinatoria! e modelagem estocástica é baseado no fato de que é possível impor como função objetivo a ser minimizada diferenças entre propriedades de modelos (desejadas) e experimentais das variáveis simuladas.
A aplicação da técnica de “simulated annealing” na modelagem estocástica para a caracterização de reservatórios teve início com o artigo de Farmer (1990). Nesse trabalho é apresentada a geração de imagens de variáveis discretas, onde o objetivo é a reprodução de um histograma de dois pontos de litologias para um número especificado de espaçamentos e direções. Para cada espaçamento h em uma dada direção, a função objetivo O a ser minimizada é:
— Capítulo 2
15
h~l
E?=1 E?=i(iv/. - Ç02
(2.11)
onde:
tijh é o número de pares de pontos separados pela distância h onde a litologia muda de i para j na imagem simulada;
t^h ¿ ° número de pares de pontos separados pela distancia h onde a litologia muda de i para j na imagem padrão (característica desejada);
nh é o número total de pares de pontos separados pela distancia h;
ncsp é o número de espaçamentos (distâncias) considerados;
n é o número de fitologías considerado.
A limitação principal da aplicação desenvolvida por Farmer é a escassez de dados (valores de nos reservatórios a serem reproduzidos. 0 que se propõe é a obtenção destes dados de imagens “padrões de controle”, onde os valores do histograma padrão podem ser obtidos de afloramentos supostamente semelhantes ao reservatório simulado quanto as características geológicas.
A abordagem de se extrair parâmetros estatísticos de afloramentos para aplicá-los em reservatórios tem sido bastante utilizada (Smith, 1981; Goggin et aL, 1986; Kittridge et al, 1990; Goggin et al., 1989). Procura-se comparar as litologias e propriedades como permeabilidade absoluta (medida com minipermeâmetro) com os valores de subsuperfície (análises de testemunhos) de reservatórios gerados em ambientes sedimentares semelhantes, verificando-se a validade de se utilizar informações como modelos variográficos, histogramas, percentuais de folhelho, etc. na modelagem estocástica de reservatórios.
Os trabalhos de Pérez (1991) e Deutsch (1992) introduziram a utilização do “si-mulated annealing” na modelagem estocástica com a função objetivo a ser minimizada correspondendo a um ajuste de variogramas com os modelos desejados, como:
(2.12)
onde:
7s(&amp;amp;/,í) é o valor do variograma da imagem simulada para o espaçamento hi e direção z;
é o valor do variograma modelo para o espaçamento A/ e direção í;
Nd é o número direções consideradas;
Nh,i é o total de espaçamentos na direção i;
— Capítulo 2 —
16
Eq é uma constante de normalização, utilizada para o valor da função objetivo da imagem inicial ser 1. Esta constante é calculada como (Pérez. 1991):
Wki) - 7„,(M
(=1 1=1
(2.13)
onde:
7?(^fi«) é o valor do variograma da imagem inicial sendo simulada.
Nota-se que com a função objetivo da equação 2.13, os valores dos variogramas correspondentes a distâncias pequenas tem pesos maiores (l/7m(M,í)X uma vez que normalmente tais valores são mais baixos nos espaçamentos menores.
Nos programas desenvolvidos por Pérez (1991) e Deutsch (Deutsch &amp;amp; Journel, 1992a) a imagem inicial é gerada obedecendo a função de probabilidade acumulada da variável simulada, com os valores desta sendo atribuidos aleatoriamente a cada célula através de uma simulação de Monte Cario. Desta forma, parte-se de uma imagem sem correlação espacial (com efeito pepita puro) e prossegue-se a execução até os variogramas experimentais atingirem os valores dos variogramas teóricos (modelos) com a tolerância desejada, ou outro critério de parada ser atingido.
As perturbações no sistema (vide algoritmo da figura 2.1) são introduzidas mediante a troca de duas células escolhidas aleatoriamente. Os novos variogramas com a troca proposta são calculados e a troca é aceita ou não conforme o critério de Metrópolis (equação 2.4).
Os dois autores implantaram como critério de parada principal a condição da função objetivo atingir um valor mínimo. Deutsch implementou também a condição de que quando o número máximo de iterações Mt é atingido em um certo número de temperaturas consecutivas, o programa é encerrado previamente, conforme o item b) na página 13. Já Pérez acrescentou a condição de razão de aceitação mínima xmin(T), conforme descrito no item c) da mesma página.
Como os programas desenvolvidos nesta dissertação foram baseados nos programas de Pérez e Deutsch, comentários adicionais são apresentados no capítulo 3, juntamente com as modificações introduzidas.
Atualização da Função Objetivo
Em qualquer implementação da técnica de “simulated annealing”, a função objetivo necessita ser calculada um grande número de vezes. Desta maneira, uma característica importante é que este cálculo não exija um tempo muito grande em cada passo. Cuidados especiais devem ser tomados na elaboração da rotina que atualiza as variáveis e funções que constituem a função objetivo. No caso do ajuste variográfico, Pérez e Deutsch &amp;amp; Journel implementaram uma atualização do variograma experimental após cada pertur-
Capítulo 2 —
17
Figura 2.3: Comportamentos de pressões no poço em imagens fictícias geradas estocasti-camente. Somente as imagens 2 e 4 tem comportamento “aceitável”.
bação (troca de células), não sendo necessário recalculá-lo novamente. Esta atualização é explicada no capítulo 3 e detalhada no Apêndice 3. Nesta dissertação denomina-se localmente atualizável uma função que pode ser atualizada apenas alterando a influência das células envolvidas em um passo da execução do algoritmo.
2.6	Implementação de Novas Funções Objetivo
A principal vantagem da utilização de técnicas de otimização combinatorial para modelagem probabilística de reservatórios em relação aos métodos tradicionais de simulação es tocas tica tem sido a possibilidade de inclusão de outras características além das distribuições de probabilidades e variogramas das variáveis.
Algumas informações importantes, muitas vezes disponíveis, como o comportamento de pressões no poço em testes de formação e interpretações a respeito da continuidade das camadas produtoras ou selantes, não podem ser aproveitadas na geração de modelos do reservatório estudado. Um procedimento usual é selecionar entre as imagens simuladas aquelas que tenham as características desejadas que não puderam ser consideradas no processo de simulação. A figura 2.3 ilustra um caso fictício onde o comportamento de pressões (obtido com um simulador numérico de fluxo) das imagens modeladas é comparado com o comportamento real (conhecido). Somente as imagens modeladas 2 e 4 tem comportamento próximo ao real, descartan do-se as demais.
Consequências da limitação de informações
A utilização de imagens simuladas nas tomadas de decisões através de análises de
— Capít ulo 2
18
previsão de produção ou espessuras porosas deve sempre scr vista com restrições. Embora o objetivo básico seja quantificar os riscos envolvidos, a impossibilidade da inclusão de todas as informações disponíveis (através de medições diretas ou interpretações qualitativas) pode induzir a conclusões errôneas, seja pelo aumento na dispersão dos valores possíveis de ocorrência, como pela geração de imagens viciadas4.
No primeiro caso, tem-se como exemplo a impossibilidade de inclusão de dados de. testes de formação nos algoritmos convencionais da geoestatística. 0 efeito principal disso em termos práticos é um acréscimo na variância dos valores de pressões P(f) das imagens simuladas.
0 segundo caso é mais grave, pois induz mais facilmente a conclusões erradas. Suponhamos, por exemplo, que dispõe-se de uma quantidade suficiente de dados para obter com segurança um variograma na direção vertical, mas um número limitado de poços para a construção do variograma na direção horizontal (infelizmente é o que muitas vezes ocorre na utilização de técnicas da geoestatística na modelagem de reservatórios de petróleo).
Um procedimento possível de ser seguido seria gerar imagens honrando apenas o variograma vertical. 0 que ocorrerá neste caso com o comportamento variográfico na direção horizontal das imagens simuladas é a ausência de correlação espacial. Como nada foi imposto ao modelo nesta direção, o variograma na horizontal tenderá a apresentar um efeito pepita puro. A figura 2.4 (a) representa um histograma fictício dos valores da função variograma na direção horizontal para uma distância pequena (ãt &amp;lt;alcance).
Observa-se que os valores de 7(ãt) das imagens simuladas da maneira anterior apresentam baixa dispersão, mas totalmente distantes da realidade geológica. Através da execução de uma simulação de fluxo com as imagens simuladas, como um deslocamento de óleo com injeção de água, são obtidos comportamentos de produção semelhantes entre as várias imagens simuladas, mas provavelmente com uma tendência otimista devido a pequena continuidade das camadas simuladas (sem canais preferenciais de fluxo). A figura 2.4 (b) esquematiza o comportamento do tempo de erupção (breakthrough) da frente de água das imagens simuladas em comparação com o comportamento real.
Conclui-se portanto que o melhor procedimento é construir um variograma na direção horizontal com base no conhecimento geológico da área, e na experiência com reservatórios semelhantes ou afloramentos. Outra possibilidade é propor vários valores de anisotropias entre as direções horizontal e vertical, analisando as con sequências para cada caso.
O exemplo anterior é um caso extremo para ilustrar de maneira intuitiva as limitações de qualquer método de modelagem estocástica para informar os valores esperados reais das variáveis simuladas, devido a escassez de informações. Logo, a capacidade de aproveitamento de novos dados é uma característica altamente desejável no sentido de
4ou seja, E(ZS) E{Zry onde E(Zt) é a esperança dos valores simulados da variável aleatória Z e E(Zr) a esperança dos valores reais.
— Capítulo 2
19
Figura 2.4: Ocorrência de viés causada pela ausência de informação sobre o variograma na direção horizontal: (a) viés no valor de um espaçamento menor que o range do variograma real na horizontal (q(/q)); (b) viés nos tempos de erupção simulados (t^) em um processo de injeção de água.
diminuir tais limitações.
Reprodução de Características Adicionais
A idéia da inclusão de novas propriedades como parte da função objetivo na modelagem estocástica de reservatórios, tem sido acompanhada com grande interesse, como se pode verificar em trabalhos recentes5 (Deutsch, 1992; Deutsch &amp;amp; Journel, 1992b; Ouenes, 1991 Apud Ghori et al., 1992; Deutsch, 1992; Hird &amp;amp; Kelkar, 1992; Sen et al). Destaca-se a possibilidade de honrar estatísticas de ordem superior e a utilização de dados de testes de formação de forma indireta (permeabilidade equivalente aproximada).
A seguir é apresentada uma breve revisão das principais funções implementadas por Deutsch (1991; 1992) em programas de “annealing” em conjunto com o histograma e o variograma, bem como os principais resultados obtidos. A primeira é uma função cujo objetivo é medir a conectividade em urna camada ou de uma faixa de valores de uma variável contínua, o que não é possível com o variograma isoladamente. Esta função, inicialmente proposta por Journel &amp;amp; Alabert (1989), é uma estatística de múltiplos pontos. Em seguida, é mostrada uma forma de se implementar uma aproximação da permeabilidade equivalente de testes de formação para a obtenção de imagens que tenham um comportamento de produção simulado mais próximo do real. A aproximação, proposta por Alabert (1989), também é utilizada nesta dissertação (capítulo 5) como condição a ser reproduzida em seções verticais6 (fluxo linear), em conjunto com outros tipos de a-
5Alguns publicados durante a elaboração desta dissertação.
6Deutsch utilizou esta aproximação em modelos de reservatório bidimensional no plano z-y.
— Capítulo 2 —
20
Figura 2.5: Exemplos de configurações possíveis para 1, 2 e 3 pontos para o cálculo de uma estatística de n pontos.
proximações da permeabilidade equivalente, baseados no conceito de mudança de escala proposto por Le Loc^h (1989).
2.6.1	Estatísticas de Múltiplos Pontos
Quando técnicas e funções da geoestatística são utilizadas em problemas práticos, normalmente até dois valores são envolvidos em cada cálculo a ser realizado.
No cálculo de um histograma convencional, por exemplo, apenas um valor Z(x) associado a um ponto é usado em cada termo, sendo considerado uma estatística de um ponto. Já o variograma utiliza pares de pontos separados por uma distância descrita pelo vetor h. Em cada termo [Z(x + h) — Z(x)] dois pontos estão envolvidos. Diz-se que a função variograma 7(h) é uma estatística de dois pontos.
Embora se tenha pouca experiência prática, estatísticas de ordem superior (múltiplos pontos) podem ser definidas, sendo apropriadas para caracterizar propriedades geológicas (Deutsch, 1992). Estas características trabalham com n pontos em conjunto, dispostos de acordo com as diversas configurações possíveis de ocorrer. A figura 2.5 ilustra exemplos de configurações para n — 1, 2 e 3 pontos.
Para cada configuração com n pontos, se forem utilizadas C classes de realizações possíveis de ocorrer em cada ponto (posição), existem Cn possibilidades de ocorrência. Por exemplo, se n = 2 pontos e C = 2 (ex.: C(l) = arenito; C(2) = folhelho), tem-se as
1
— Cãpítulo 2
21
Figura 2.6: Dois reservatórios hipotéticos com diferentes continuidades da litologia arenito e variogramas indicadores iguais - Adaptado de Yuan &amp;amp; Strobl, 1991.
4	possibilidades abaixo com a configuração da figura 2.5:
Possibilidade	Posição 1	Posição 2
(1)	Arenito	Folhelho
(2)	Folhelho	Arenito
(3)	Arenito	Arenito
(4)	Folhelho	Folhelho
2.6.2	Conectividade
Uma das características que mais influencia o comportamento de fluxo em um reservatório, seja na fase de recuperação primária como em projetos de recuperação suplementar, é a continuidade ou grau de conexão das camadas sejam portadoras de hidrocarbonetos ou selantes. Desta forma, é interessante definir funções que representem de algum modo esta propriedade para inclusão como parte integrante da função objetivo em técnicas de OC.
Apesar de reservatórios que tenham camadas com boa continuidade apresentarem via de regra variogramas com alcance elevado, esta função é apenas um tipo de medida de dimensão (Yuan &amp;amp; Strobl, 1991). Dois reservatórios com variogramas idênticos podem ter continuidades completamente diferentes, como ilustra a figura 2.6.
Deutsch (1992) incluiu como característica a ser reproduzida em modelos de re-
servatórios gerados com a técnica de SA a função conectividade definida por Journel &amp;amp;
Alabert (1989)7
7Esta função é uma estatística de n pontos.
— Capítulo 2 —-
22
Conectividade
Figura 2.7: Gráfico da função conectividade correspondente à direção N55W de uma seção do arenito Berea. E incluída a curva correspondente a uma imagem simulada com o método de simulação sequencial gaussiana (honrando o histograma e o variograma). -Adaptado de Journel &amp;amp;. Alabert, 1989.
^(h;n;zc) = £{fj I(x + (J ™ l)h;zc}
(2.14)
onde:
h é o vetor que representa a distância entre dois pontos adjacentes;
E é o operador esperança;
zc é um valor de corte escolhido.
Z(x; zc} é uma variável indicadora definida como 1 se o valor na posição x é menor que zc e 0 caso contrário;
Para um determinado valor de h e n, a função mede a probabilidade de n pontos separados pela distância h serem do mesmo tipo (no caso da variável ser discreta) ou serem simultaneamente menores (ou maiores) que o valor de corte zc. Em outras palavras, é uma medida da probabilidade de ocorrer continuidade na distância n.h .
Com a utilização de vários valores de n pode-se construir um gráfico de probabilidade de conexão, como o obtido por Journel &amp;amp; Alabert para uma amostra do arenito Berea, mostrado na figura 2.7.
Verifica-se pela na figura 2.7 que imagens geradas com a técnica de simulação sequencial gaussiana (SSG), honrando os variogramas e o histograma apresentam conectividade inferior à real. Imagens que honrem a curva real da figura 2.7 podem ser geradas
— Capftu/o 2 —
23
com as técnicas de OC, como o “simulated annealing\ Deutsch incluiu dez pontos do gráfico da figura 2.7 adicionando como componente da função objetivo o seguinte termo:
10
=	*'c)]	(2.15)
¿=1
Partindo-se de imagens previamente geradas com a SSG ou mesmo com o algoritmo de €tannealmg”, Deutsch pós-processou as imagens incluindo o termo Oc da equação 2-15- Para não prejudicar as características previamente reproduzidas (varió-gramas), utilizou-se o algoritmo com resfriamento intantâneo, com a — 0. As imagens pós-processadas apresentaram conectividade mais próxima da real, mas sem reproduzir integralmente a curva mostrada na figura 2.7; este procedimento levou o processo a ficar preso em mínimos locais (Deutsch, 1992:158). A inclusão do termo correspondente à função conectividade também provocou uma diminuição na variância dos valores simulados de respostas de fluxo, como tempos de “breakthrough” e recuperação final de óleo num processo de deslocamento imiscível.
Nos reservatórios de petróleo, infelizmente não existem dados suficientes para a obtenção direta da função de conectividade. Análises em afloramentos podem ser feitas para a construção de curvas de conectividade. Outra possibilidade é relacionar curvas de conectividade com o comportamento de produção. Hird &amp;amp; Kelkar (1992), por exemplo, verificaram que existe uma boa correlação entre os tempo de “breakthrough” e as razões agua/óleo com parâmetros de conectividade. Estes autores simularam o deslocamento de óleo em quadrados representando 1/4 de um esquema “five-spot”8. Também propuseram novas medidas de conectividade e utilizaram a técnica de “annealing” para implementa-las, mostrando as diminuições nos riscos das previsões de comportamento de produção.
Nesta dissertação não são utilizadas funções de conectividade. Mas a continuidade de camadas, interpretadas a partir de correlações de variáveis simuladas entre os poços existentes é considerada através da inclusão na função objetivo de médias regionais (capítulos 4 e 5), verificando-se também reduções nas incertezas das previsões dos valores dos comportamento de pressões simulados.
A técnica de simulação sequencial gaussiana, um dos métodos convencionais mais usados da geoestatística também é utilizada no capitulo 4 na geração de uma imagem padrão para comparação com imagens geradas com os algoritmos de OC. No Anexo A é apresentada uma breve revisão da SSG, bem como da krigagem, utilizada em um dos passos desta técnica.
^Configuração com 4 poços injetores de água nos vértices e um poço produtor no centro do quadrado.
— Capítulo 2 —
24
2.6.3	Permeabilidade Equivalente
A inclusão de informações relacionadas ao comportamento de pressões, em particular apro-
veitando dados de testes de formação com vazão constante , também é uma possibilidade
existente com as técnicas de OC.
Idealmente, para a reprodução de um histórico de produção observado nas imagens modeladas com SA, em cada passo do algoritmo (troca entre células, por exemplo), deveria ser feita uma simulação de fluxo completa, até que os históricos observado e simulado coincidissem. Este procedimento é inviável, exigindo um tempo de processamento absurdamente alto, já que as respostas do simulador de fluxo nao são ¡ocalmente atualizáveis.
A solução proposta é o desenvolvimento de equações para o cálculo aproximado da permeabilidade equivalente àquela obtida no teste de formação. Pode-se demonstrar que no caso de ausência de correlação espacial em um campo de permeabilidades com distribuição lognormal, a permeabilidade equivalente corresponde à média geométrica das permeabilidades individuais de cada célula que compõe o bloco (Matheron, 1967 Apud Desbarats, 1987). Nos reservatórios reais, existe correlação espacial, descrita pelo variograma. Para a estimativa da permeabilidade absoluta equivalente de um determinado volume a partir dos valores conhecidos dos blocos que o compõe (mudança de escala), diversos métodos foram propostos recentemente.
Desbarats (1987) propôs a realização de uma simulação de fluxo permanente para a obtenção da permeabilidade absoluta equivalente em seções do reservatório. Deutsch utilizou a média potencial proposta por Alabert (1989), descrita por:
(2.16)
onde:
&amp;amp;(u;) é a permeabilidade equivalente aproximada do volume V; k(xj) é a permeabilidade de uma das células componentes do volume V;
N éo número de células existentes no interior do volume V.
Outro método é o descrito por Le Loc’h (1989), que propõe uma combinação de médias aritméticas e harmônicas (capítulo 5). Estudos comparativos elaborados por Cruz (1991) mostraram que para diversos casos esta aproximação gera resultados semelhantes aos obtidos atravé das simulações de fluxo em regime permanente propostas por Desbarats (1987), com a vantagem de propiciar um cálculo mais rápido.
Além do problema de mudança de escala, outra questão é saber qual o volume
— Capítulo 2 —
25
Figura 2.8: Comparação entre os histogramas dos valores de óleo “in place” obtidos com as imagens geradas sem incluir as permeabilidades equivalentes de testes de formação (esquerda) e com a inclusão das mesmas (direita). - Adaptado de Deutsch &amp;amp;¿ Journel, 1992b.
correspondente à permeabilidade de teste. Para isto é necessária a realização de cali-brações com imagens previamente geradas com as demais características observadas (ex.: vari ogr amas).
No capítulo 5 são feitas considerações sobre o volume correspondente aos testes de formação e os procedimentos necessários para a implementação da aproximação proposta por Alabert (equação 2.16) na modelagem estocástica de reservatórios. Nesta dissertação, além desta aproximação é implementado o método de Le Loc’h de duas maneiras distintas e em conjunto com a aproximação de Alabert. Também é verificado o impacto da inclusão deste tipo de informação em imagens geradas com características diversas. Deutsch, por exemplo, verificou um decréscimo significativo na dispersão e no viés dos valores simulados de volumes de óleo recuperados com injeção de água. A figura 2.8 mostra os histogramas correspondentes às imagens geradas antes e após a inclusão do termo com a permeabilidade equivalente aproximada (equação 2.16).
2.6.4	Tempo de Execução - Comentários
A principal desvantagem da aplicação da técnica de SA em modelagem estocástica é o tempo elevado de processamento se funções objetivo que exijam uma quantidade relativamente grande de cálculos forem utilizadas.
As pesquisas atuais concentram-se na implementação da técnica em processamento paralelo, permanecendo ainda um vasto campo a ser estudado no que diz respeito a novos critérios e modificações no plano de “annealing” visando a redução de tempo. Contudo,
— Capítulo 2 —
26
no caso da simulação estocástica com “simulated annealing", nem sempre a redução de tempo é vantajosa. Mesmo que haja poucos ou mesmo nenhum mínimo local na função objetivo, a redução de tempo através de um esfriamento mais rápido (reduzindo-se o fator a da equação 2.5 ou o número de iterações Ma ou A/t) pode produzir imagens de pior qualidade. A influência de diversos parâmetros do algoritmo de SA nos tempos de execução e na qualidade das imagens geradas é abordada nos capítulos 3 e 4.
2.7	Evolução Estocástica
0 algoritmo denominado evolução estocástica foi introduzido por Saab e Rao (1991) Um resumo deste algoritmo é mostrado na figura 2.9, juntamente com as subrotinas principais.
Uma das características principais deste algoritmo é aceitar perturbações que provoquem acréscimo no valor da função objetivo sómente se necessário, para escapar de um mínimo local, ao contrário da versão tradicional do “simulated annealing”, onde boa parte destas perturbações são aceitas nas altas temperaturas. Isto é feito através da modificação no parâmetro de controle p, fazendo-se p — f(p) (subrotina ATUALIZA).
Outra característica do método é que a função de perturbação consiste numa sequência de alterações de estado proposta, ao contrário do “simulated annealing”, onde a perturbação corresponde a apenas uma alteração. Além disto, os elementos m do sistema M a ser otimizado são envolvidos nas alterações obedecendo a uma sequência específica. A geração de um movimento (ou troca) neste caso é determinística, ao contrário do “simulated annealing” convencional, onde os dois elementos trocados são escolhidos aleatoriamente.
O algoritmo inicia com uma imagem (estado) inicial Sq, um valor inicial do parâmetro de controle po e um parâmetro R usado como critério de parada. O estado correspondente à mínima energia entre aqueles produzidos pela função PERTURBA^ é retido. Cada vez que um estado melhor é gerado, o contador p é diminuido de uma quantidade jR; com isto algoritmo se auto-recompensa através do acréscimo no número de iterações possíveis (Saab &amp;amp; Rao, 1991). Outro parâmetro do algoritmo (opcional) é o número F: a cada P ciclos o valor de p passa a ser zero, e o algoritmo só passa a a-ceitar trocas que melhorem a função objetivo, até que seja necessária nova alteração no parâmetro de controle p (quando Cpre ~ Catua¡)'
Saab e Rao utilizaram o algoritmo no posicionamento de microcomponentes e-letrônicos de diversos tamanhos e configurações em “chips”. O objetivo imposto foi a otimização do “layout”, minimizando a área total do “chip”.
Foram feitas também comparações com o algoritmo de “simulated annealing” em outros problemas, incluindo o problema clássico do caixeiro-viajan te. A tabela 2.1 mostra os resultados em termos de tempo e função objetivo (custo) para vários números de cidades. A figura 2.10 mostra as rotas produzidas com os dois algoritmos para o caso de 500 cidades. Para este problema, verificou-se que a evolução estocástica gerou rotas
— Capítulo 2 —
27
Algoritmo EE :
S “ Soí
S/tf elher ~
P = Rí
P - 0;
REPITA
CPr&amp;lt;= CUSTO (S);
S = PERTU JRBAEe(S,p),
/* estado inicial */
/* salve o estado inicial */
/* inicialize o parâmetro de controle */
/* inicialize o contador */
Caíu0Í = CUSTO (5); ATUALIZA Çpí Cpre í Catual^i
SE (CUSTO (S) &amp;lt;CUSTO (Sweihor)) Sfâ elhor p = p — /?;
CASO CONTRÁRIO p- H 1;
FIM DO SE;
ATÉ p &gt; R;
RETORNE Sjtâ&amp;amp;ihor\
FIM
ENTÃO;
/* salve o melhor estado */
/* diminua o contador de R */
/* aumente o cont ador */
/* imprima o melhor estado */
/* fim do programa * /
funça.o PERTURBAIS, p) :
PARA CADA (m G M) FAÇA
S! = MOVA (S,m);
GANHO (m) - CUSTO (S) - CUSTO (£')
SE (GANHO (m) &gt; ALEATÓRIO (-p,0)) ENTÃO
5	= S'
FIM DO SE;
FIM DO PARA;
RETORNE (S);
/* faça movimento associado com m */
/* calcule o ganho do movimento */
/* compare com um n° aleatório entre — p e 0 */
/* aceite o movimento */
/* retorne um novo estado */
sub rotina ATUALIZA (p, F, Cpre,CafUaf) :
7 = 7 + 1	/* atualize o contador interno */
SE (7 = F) ENTÃO
7	= 1;
P~ 0;
CASO CONTRÁRIO SE (Qre = Catuai) ENTÃO
P = /(p);	(f(p) &gt; p)
CASO CONTRÁRIO
P = Poi FIM DO SE;
— Capítulo 2
28
Cidades	CESTO		TEMPO (s)	
	SA	EE	SA	EE
100	8300	8247	125.1	53.8
150	9424	9399	184.6	66.5
200	11652	11172	209.0	80.5
250	13494	12632	238.7	83.0
300			317.6	108.2
400	16404	16026	421.8	185.5
500	20823	18041	519.9	253.9
Tabela 2.1: Resultados do “simulated annealing” e evolução estocástica para o problema do vendedor ambulante - Adaptado de Saab e Rao, 1991.
com custos menores em tempos menores que o “annealing”. Isto motivou a inclusão deste algoritmo nesta dissertação (capítulos 3 e 4).
Infelizmente, na utilização em modelagem estocástica de reservatórios, apesar de se apresentar mais rápida que o SA, a EE apresentou alguns problemas como geração de imagens de pior qualidade (segundo os critérios descritos no capítulo 3) e dificuldade em escapar de mínimos locais se funções objetivo mais complexas forem utilizadas.
Isto não significa que novos testes não devam ser feitos. No capítulo 6 são apresentadas sugestões de modificação no programa utilizado nesta dissertação para tentativas de melhoras.
Capítulo 2
29
Algoritmo: “Simulated Annealing”
Algoritmo: Evolução Estocástica
Figura 2.10: Rotas geradas com os algoritmos de “simulated annealing” e evolução es-
tocástica para o problema do vendedor ambulante (500 cidades - Adaptado de Saab e Rao,
1991.
3	ALGORITMOS DE OTIMIZAÇÃO COMBINA-TORIAL - APLICAÇÃO EM MODELAGEM ES-TOCÁSTICA
Neste capítulo sao apresentadas e comentadas algumas características e o comportamento típico dos algoritmos de “simulated annealing” e evolução estocástica em problemas de geração de imagens com alguns exemplos de funções a serem reproduzidas.
No item 3.1 são descritos os programas utilizados nesta dissertação, com funções objetivo diversas a serem minimizadas. Além da reprodução do variograma e histograma, objetivos comuns aos métodos convencionais da geoestatística, novos componentes foram implantados na função objetivo.
O item 3.2 discute algumas recomendações uteis para a definição da função objetivo, em particular comentando sobre a seleção dos pontos dos variogramas a serem reproduzidos, considerando o esforço computacional e a qualidade das imagens produzidas.
No item 3.3 é abordado um importante parâmetro a ser definido para os algoritmos: a tolerância da função objetivo. Um exemplo simples mostra a evolução e as difernças entre os variogramas experimentais e desejados, a medida que a função objetivo dimimui. Uma comparação é feita com o mesmo problema utilizando o método de SSG, abordando os problemas de erros amostrais e flutuações ergódicas. E importante ressaltar que a comparação dos tempos de execução entre os métodos de SA, EE e SSG depende do caso estudado, já que o número de parâmetros envolvidos nestes algoritmos é grande. Desta forma não existe um item específico que aborda os tempos de CPU, e as comparações são feitas individualmente para os exemplos apresentados ao longo da dissertação.
O item 3.4 apresenta os comportamentos típicos dos algoritmos de SA e EE durante a execução, através dos valores da função objetivo e de dois outros parâmetros que são definidos: as razões de aceitação (x) e de melhoria (^).
Finalmente, o item 3.5 aborda os critérios para quantificação da qualidade das seções verticais de reservatórios simuladas,, a serem usadas nos capítulos 4 e 5. Embora limitados, estes critérios são uteis para se analisar a influência dos parâmetros principais de cada algoritmo na modelagem estocástica.
3,1	Características dos Programas Utilizados
Os programas de SA utilizados nesta dissertação foram baseados no programa sasim desenvolvido por Deutsch, que faz parte do aplicativo GSLIB (versão 1.0) (Deutsch &amp;amp;
30
— Capítulo 3 —
31
Journel, 1992a). Este programa tem como objetivo gerar imagens que honrem um deter-
minado modelo variográfico, sendo fornecidos um modelo e o número de pontos a serem
reproduzidos.
0 programa original sasim tem algumas características importantes com o objetivo de otimizar os cálculos, diminuindo os tempos de execução. A principal delas é a atualização local da função variograma, como mencionado no ítem 2.5 e descrito no Apéndice 3. As primeiras modificações correspondem ao programa sasirol, que inclui novas informações a serem geradas (e novos dados de entrada), baseadas no programa de SA desenvolvido por Pérez (1991) e descritas a seguir:
(a)	Escolha automática da temperatura inicial (T°):
Como visto no item 2.3.2 (pg.13), existe a possibilidade de se calcular de forma aproximada a temperatura inicial a ser utilizada, correspondente a uma razão de aceitação inicial Xín.j usando o procedimento descrito no Apêndice 2.
Na maioria das imagens geradas nesta dissertação é utilizado o valor de Xin. = 0.98 ou 0.99, ou seja, espera-se que 98 ou 99 % das perturbações propostasi na temperatura i-nicial sejam aceitas, independentemente do fato de contribuirem ou não para o decréscimo da função objetivo. Utilizou-se a rotina originalmente desenvolvida por Pérez, com algumas pequenas modificações nos nomes das variáveis.
(b)	Acompanhamento da razão de aceitação (x) e razão de melhoria
Os valores de x9 correspondentes a cada temperatura Tr são calculados. Com isto é possível o acompanhar a execução do programa e analisar o comportamento destes parâmetros para diversas funções objetivo. O sucesso na estimativa de T° pode ser verificado pela comparação dos valores de x»n. informado e experimental. Nos programas desta dissertação foi introduzido outro parâmetro, a razão de melhoria definida como:
V&gt;(r) =
ne de perturbações que provocaram melhora na função objetivo
ne de perturbações propostas
(c)	Possibilidade de geração automática da imagem inicial ou utilização de imagem inicial fornecida pelo usuário (para ser pós-processada):
O programa original sasim só permitia a geração automática de uma imagem inicial sem correlação espacial. Foi incluída a segunda possibilidade, que atualmente já consta de versões mais recentes em programas de “annealing” do GSLIB.
No Anexo D é mostrado como exemplo um arquivo de entrada do programa de
SA que exige o maior número de informações dos utilizados nesta dissertação (sasim7) e
de um programa de evolução estocástica (sasim3).
^Definidos de acordo com a equação 2.9
— Capítulo 3
32
3.1.1 Programas Desenvolvidos * “Simulated Annealing”
Além do sasiml, outras modificações foram feitas com a finalidade de introduzir termos adicionais na função objetivo:
sasim2: O programa sasim2 permite a escolha dos pontos do variograma a serem ajustados, além de não ser necessário que o variograma padrão obedeça a um modelo equacionável e positivo definido. Na versão original (sasim), informa-se ao programa o número de pontos a serem ajustados, correspondentes aos primeiros pontos do variograma. No sasizn2, os variogramas padrão são informados através de um arquivo com valores de espaçamentos (distâncias), sendo possível a escolha de qualquer ponto. Como será discutido no item 3.2, é conveniente escolher-se sómente alguns pontos “estratégicos” para o ajuste. A escolha de todos os pontos aumentaria substancialmente o tempo de execução, com pouco benefício prático;
sasim3: Neste programa, que mantém todas as características do sasim2, foi acrescentada a possibilidade de inclusão de médias e variogramas regionais (de partes do reservatório)10. Com a existência de um novo termo na funcao objetivo, passa a ser necessário informar os pesos que cada um deve receber;
sasim4: Além dos componentes da função objetivo incluidos no sasim3, este programa permite incluir um “ajuste de histórico de produção” de maneira indireta. A idéia é executar uma mudança de escala pelo método de Le Loc’h em cada passo do algoritmo e realizar uma simulação de fluxo na escala mais grosseira, com menor número de células. Foi implantado como subrotina um simulador bidimensional monofásico. Apesar da redução da malha, este programa mostrou-se pouco prático, como será visto no capítulo 5;
sasim5: Este programa incorpora a metodologia introduzida por Deutsch (Deutsch &amp;amp; Journel, 1992b; Deutsch, 1992) para o aproveitamento da permeabilidade equivalente obtida de testes de formação, através da aproximação proposta por Alabert (1989). Também inclui os termos do programa sasim3. Para a implementação da aproximação da permeabilidade (equação 2.16) é necessário estimar o volume correspondente à mesma, através de uma cali br ação prévia (capítulo 5);
sasini6: Neste programa a aproximação da permeabilidade equivalente é feita pelo método descrito por Le Loc’h (1989). Este método de mudança de escala é influenciado pela posição relativa das células, o que não acontece na aproximação proposta por Alabert. A cali br ação prévia para a estimativa do volume correspondente ao teste de formação também é necessária;
sasim7: Este programa incorpora as duas aproximações de permeabilidade introduzidas nos programas sasimS e sasim6, com a finalidade de procurar gerar imagens compatíveis com as duas metodologias.
10Uma região em tres dimensões deve ter a forma de um paralelepípedo, sendo dados de entrada cs valores das coordenadas Xmín.j	t/mín-i ymaz&gt; ¿min. e
Capítulo 3 —
33
O programa sasirn? inclui o maior número de termos na função objetivo de todos
os programas usados nesta dissertação. A função objetivo “geraT, com os termos incluídos
em cada programa é dada por:
1	J1!v*
O

+
7,(M-7&lt;(Mr , A v 1 Nv!'Vv’MM-1'M
.	J + 1 ££,(&gt;) ¿i v .
j i,j.u«ai ¿ffJ&lt;w&gt;.-jmw&gt;i»'Jn&gt;x. M-.uiaArixiauia*^ .
L,2,3,4,5,6,7	sasim3,4,5,6,7
[^s(Í) " mi« + ^3vr(A\4ev&gt; ~ Ktfr)2 + A4™(A^evL ~~ Ktfr)2
&amp;amp;3	r^4
sasim6,7
sasim5,7
+
n2 ¿^1 = 1 Po
sasim4
(3.2)
onde:
são termos de normalização, definidos de forma a cada termo ter o valor inicial 1. São definidos de maneira semelhante à equação 2.13;
7t(Zq,i) é o variograma teórico (modelo), com h¡ denotando uma distância entre pontos e i uma direção considerada;
iys(hi,i) é o variograma da imagem simulada;
N¿ é o número de direções consideradas;
Nh¿ é o número de distâncias consideradas em uma determinada direção Z;
7tr(^,ñj) é o variograma teórico de uma região J;
7?r(&amp;amp;Mj) é o variograma de uma região j da imagem simulada;
nrv é o número de regiões de variogramas considerado;
AZár(j) é o número de direções consideradas para o variograma da região J;
Nh,i(j) é o número de distâncias consideradas para a direção i do variograma da região j;
é a média teórica de uma região J;
ma(j) é a média de uma região j da imagem simulada;
nrm é o número de regiões de média considerados;
Ktfr é a permeabilidade interpretada de um teste de formação;
Kxevx a aproximação da permeabilidade equivalente dada pela aproximação proposta por Alabert, relacionada ao volume
— Capítulo 3 —
34
J\ L€V é a aproximação da permeabilidade equivalente dada pela aproximação proposta por Le Loc’h, relacionada ao volume Ir;
pv(i) é a pressão observada na face produtora da seção verticalpadrão (real) no tempo ?;
pg(i) é a pressão na face produtora no tempo i da seção vertical simulada;
nph é o número de intervalos de tempo considerados;
A, são pesos atribuídos a cada termo da função objetivo.
3.1.2 Programas Desenvolvidos - Evolução Estocástica
Nos programas de EE foram mantidas várias subrotinas dos programas de SA, como as de atualização da função objetivo. Na seleção das duas células a serem trocadas, a primeira obedece a um critério determinístico, sendo escolhida de forma sequencial; a segunda é selecionada aleatoriamente no interior de um determinada distância da primeira. Caso uma das células coincida com uma condicionante, outra é escolhida em seu lugar.
A atualização do parâmetro de controle (p) é feita após cada ciclo concluído, em função dos valores do custo (objetivo) anterior e posterior à execução da função PERTURBALE (figura 2.1). Nos programas desta dissertação, a atualização p — f(p) é dada por:
Pnwo = (1 + 3)p	(3.3)
onde $ é uma constante positiva com valor pequeno (ex.: 0.1)
Os programas também informam na saída o número acumulado de trocas com melhora (decréscimo na função objetivo) e trocas aceitas.
Quanto aos termos da função objetivo, existe uma correspondência entre os programas de EE e SA: o programa sesiml corresponde ao sasiml, por exemplo. Foram desenvolvidos os programas sesiml, sesim2 e sesim3.
3.2	Formulação da Função Objetivo - Variogramas
Na maior parte dos programas desenvolvidos nesta dissertação os variograma faz parte da função objetivo. A inclusão de todos os pontos do variograma a ser reproduzido provoca um esforço computacional excessivo, não justificável tendo em vista a incerteza de variogramas obtidos de amostras limitadas. Desta forma, é conveniente a adoção de critérios para a seleção dos pontos que tomarão parte na função objetivo.
— Capítulo 3 —
35
Caso	Método	Número de células	Espaçamento máximo do variograma	Critério de seleção dos pontos (h)	Pontos selecionados
A	SA	40 x 40	16		1,...,16
B	SA	40 x 40	16	sómente h pares	2,4,6,. ..,16
C	SA	40 x 40	16	h pares e 1° ponto	1,2,4,6,..16
D	SA	80 x 80	32		1,...,32
E 1	SA	80x80	32	h múltiplo de 4	4,8,12,...,32
F	SA	80 x 80	32	h múltiplos de 4 e l9 ponto	1,4,8,12,. ..,32
G	EE	40 x 40	16		1,...,16
H	EE	40x40	16	sómente 1 pares	2,4,6,...,16
I	EE	40 x 40	16	h pares e 1- ponto	1,2,4,6,..., 16
Tabela 3.1: Características das imagens geradas para testar critérios de seleção de pontos do variograma e condições impostas.
Não existem regras rígidas para a seleção dos pontos, mas empiricamente obser-vou-se que os espaçamentos menores devem ser incluidos (em especial o primeiro), em conjunto com alguns pontos “estratégicos” selecionados para os espaçamentos maiores. No caso do variograma possuir efeito periódico, é necessário um número maior de pontos para representá-lo..
A importância dos primeiros pontos é exemplificada a seguir. Com os programas sasim2 e sesim2 gerou-se imagens com n x n células de uma variável Z com distribuição normal reduzida (p = 0; o2 — 1) com critérios diversos de seleção dos pontos. O variograma padrão adotado corresponde a um modelo esférico com patamar c — 1.1 e alcance a = n/3 na direção horizontal11. A tabela 3.1 mostra as características de cada caso simulado.
Para os casos A a F da tabela 3.1 (com SA), foram usados os seguintes parâmetros: a — 0.2; Xin. — 0.98; tolerância £ = 0.0002; Ma — 8 ciclos; = 100 ciclos. Nos casos G, Hei (com EE) usou-se: po — 0.00001; T — 10 ciclos; R = 15 e 0 — 0.2.
A figura 3.1 mostra as imagens e os variogramas experimentais obtidos para os casos A, B e C. Os casos D, E e F são mostrados na figura 3.2 e os casos G, H e I na figura 3.3. Os tempos de CPU e os números de trocas são apresentados na tabela 3.2, sendo a tolerância e atingida em todos os casos. Em todos os exemplos reportados nesta
11 Como na direção vertical nada foi imposto, os modelos gerados não tem correlação espacial nesta direção.
Capítulo 3 —
36
Tabela 3.2: Tempos de execução e número de trocas necessário para atingir a tolerância £ = 0.0002 em cada caso (vide tabela 3.1).
dissertação, os tempos correspondem a uma estação Sun SPARC - IPC,
Foi verificado que nos casos onde todos os pontos até kmax. foram considerados os tempos foram significativamente maiores. Quando apenas os espaçamentos pares ou múltiplos de 4 foram selecionados, os demais pontos do variograma permaneceram com valores altos, gerando imagens com aparência de “tabuleiro”. Este problema também foi reportado por Deutsch (Deutsch, 1992:126). Com a inclusão do espaçamento h — 1, os variogramas resultantes sofreram melhora radical, praticamente coincidindo com o modelo teórico comm tempos razoáveis. Para comparação de tempos, foi feita uma simulação com o mesmo modelo variográfico com o algoritmo de simulação sequencial gaussiana com 40 x 40 células; o tempo de execução foi de 0.22 min.
3,3	Erros e Tolerâncias
Com a utilização de métodos de OC na modelagem estocástica de reservatórios, pode-se obter imagens com a função objetivo tão pequena quanto se queira, desde que o algoritmo não fique preso prematuramente em um mínimo local.
No caso dos métodos convencionais da geoestatística (simulação sequencial gaussiana, “turning bands”, etc.) isto não ocorre; o variograma experimental tende a reproduzir o modelo desejado, com os erros diminuindo quando se aumenta o número de nós simulados. As diferenças entre os valores obtidos experimentalmente e os teóricos são denomi-nadas flutuações ergódicas. E importante ressaltar que estas flutuações estão relacionadas com o número de pontos simulados, não devendo ser confundida com os erros decorrentes do processo de estimativa de parâmetros de uma população através de amostras (erros amostrais).
Capitulo 3
37
Figura 3.1: Imagens e variogramas (experiméntale modelo) correspondentes aos casos A,
B eC da tabela 3.1.
Capítulo 3
38
Figura 3.2: Imagens e vari ogramas (experimental e modelo) correspondentes aos casos D,
E e F da tabela 3.1.
Capítulo 3
39
Varíogramâ experimental • ráetelo
1.2Ü„
Dtetanct» (cekslas)
Figura 3-3: Imagens e variogramas (experimental e modelo) correspondentes aos casos G,
H e I da tabela 3.1.
— Capítulo 3
40
3.3.1	Erros Amostrais
Uma das vantagens do uso das técnicas de OC é a possibilidade a priori de reprodução fiel das características desejadas. Entretanto, como na maioria das aplicações práticas existem erros amostrais na estimativa das propriedades reais, a utilização de imagens que nao os considerem pode reduzir artificialmente o domínio das possibilidades existentes, além de introduzir um “viés” nos resultados. O procedimento rigorosamente correto seria considerar estes erros na função objetivo, somando-se ao valor teórico esperado um erro com a variância amostrai.
No caso da função variograma, os erros amostrais associados a cada espaçamento não podem ser calculados de maneira trivial, com as técnicas da estatística convencional. Isto se deve ao fato dos pontos não serem independentes entre si. Para esta finalidade métodos empíricos como o “jacknife” podem ser utilizados (Shafer et aL, 1990).
Nesta dissertação não foram considerados os erros amostrais nas propriedades reais. Contudo, estes erros não devem ser esquecidos, e sua influência nos resultados finais pode ser um interessante tema a ser pesquisado.
3.3.2	Tolerância da Função Objetivo
Independente de se considerar funções objetivo constantes ou com erro amostrai, deve-se escolher uma tolerancia suficientemente pequena para reproduzir satisfatoriamente o modelo desejado, o que é feito por tentativas ou simplesmente bom senso.
Como exemplo foram geradas imagens estocas ti cas não condicionais bidimensionais com 40 x 40 células de uma variável aleatória Z com distribuição normal reduzida honrando um modelo variográfico esférico com os seguintes parâmetros: alcance na direção horizontal ~ 20 células; patamar ~ 1.2; anisotropia geométrica — 3:1; efeito pepita = 0.
Foram utilizados os algoritmos de SA e EE (programas sasim2 e sesim2) com tolerâncias diversas e a mesma semente inicial. No caso do algor imo de SA foram usados os fatores de esfriamento ct de 0.2 e 0.0.
A figura 3.4 mostra o comportamento das imagens e variogramas gerados com SA (a = 0.2) e as tolerâncias especificadas até 10~5, quando os pontos experimentais praticamente coincidem com os do modelo. Nota-se que o valor de e = 10"4 é suficiente para reproduzir satisfatoriamente o modelo. Os tempos gastos e parâmetros utilizados são reportados no item 3.4.
A figura 3.5 apresenta uma imagem com o mesmo modelo variográfico gerada com o método de SSG. O tempo de CPU gasto foi de 23.5 segundos. Nota-se as diferenças entre os variogramas experimentais e modelos, devido às flutuações ergódicas. Na figura 3.6 é mostrada a imagem gerada com o algoritmo de EE com tolerância e — 10"4. O tempo gasto foi de 26.1 segundos, com uma melhor reprodução dos variogramas e histogramas32.
12Para a imagem gerada com SSG, obteve-se média m ~ —0.164 e variância s2 = 1.222. Para a obtida
Capítulo 3
4l
SA -	Intoí»? * TWedl/wJ» k 1,0
SA - TetorSncla js 0.02
SA * T&amp;amp;f&amp;amp;r&amp;amp;r&amp;amp;fa - 0.0001
SA •	= 0.00001
Figura 3.4: Evolução das Imagens e Variogramas em função do valor da função objetivo (tolerância).
Capítulo3
42
Figura 3.5: Imagem gerada pelo método de simulação sequencial gaussiana (SSG) e vari-ogramas correspondentes.
- 40 x 40
Figura 3.6: Imagem gerada com o algoritmo de evolução estocástica (EE) e variogramas correspondentes. Parâmetros utilizados: £ = 0.0001; p$ — 10~5; $ = 0.2; R = 20; F = 5.
— Capítulo 3 —
43
Figura 3.7: Comportamento da função objetivo durante a modelagem com “simulated annealing” (SA) e evolução estocástica (EE).
3.4	Performance dos Algoritmos — “Simulated Annealing” e Evolução Estocástica
Neste item são mostrados comportamentos típicos da função objetivo e dos parâmetros razão de aceitação (y) e razão de melhoria (ip) para exemplos em que os algoritmos atingiram a tolerância desejada (casos onde isto não ocorreu são apresentados no item 3.5 e nos capítulos 4 e 5).
Analisando os casos apresentados no item 3.3.2, verifica-se o comportamento da função objetivo em função do número total de trocas entre células, mostrado na figura
3.7.	Os tempos de CPU são apresentados na tabela 3.3.
Considerando-se sómente os tempos gastos, a conclusão seria que o algoritmo de EE é superior ao SA. No capítulo 4 são feitas comparações sob outros aspectos, mostrando que o algoritmo de EE tem limitações sérias.
No algoritmo de SA com a — 0.2, verifica-se que a função objetivo se comporta
alternando quedas bruscas com estabilizações. Cada queda corresponde a uma mudança
no parâmetro de controle (temperatura Tr).
com EE, os valores foram m = 0.037 e s2 = 0.982.
Capítulo 3
44
	SA (a = 0.2)		SA (o = 0.0)		EE	
Tolerância	Tempo (s)	Trocas	Tempo (s)	Trocas	Tempo (s)	Trocas
0.5	41.1	42166	2.7	995	3.2	1005
0.1	67.8	68901	6.8	5414	6.3	4512
0.02	79.7	81315	14.0	13115	11.1	10162
0.0001	217.2	221235	32.1	32206	26.1	27233
0.00001	243.6	247601	35.6	35692	29.2	30799
Tabela 3.3: Tempos de execução e número de trocas dos algoritmos de “simulated annealing” (SA) e evolução estocástica (EE) para o exemplo do item 3.3.
A figura 3.8 mostra o comportamento das razões de aceitação (x) e de melhoria (V5) para os algoritmos de SA (com a ~ 0.2) e EE. Nota-se que para o SA o valor de se manteve aproximadamente a metade de x* Já na EE, praticamente estes valores coincidiram neste caso onde a tolerância e foi atingida sem qualquer dificuldade13.
Neste exemplo o tempo de execução com o algoritmo de EE e tolerância de 10~4 foi ligeiramente superior ao da SSG, enquanto com o SA (q ~ 0.2) foi cerca de 9 vezes maior. A inclusão do variograma em duas direções e o número maior de pontos a serem reproduzidos provocou um acréscimo no tempo relativo dos algoritmos de OC, em comparação com o exemplo do item 3.2.
3.5	Mínimos Locais
Nos casos apresentados no item 3.2 a tolerância desejada foi atingida sem dificuldades para os algoritmos de SA e EE, indicando sucesso na estratégia de ultrapassar mínimos locais através de eventuais perturbações propostas que nao melhorem a função objetivo Nos capítulos 4 e 5 são apresentados casos em que isto não ocorre com a formulação de funções objetivo mais complexas, particularmente com o algoritmo de EE e SA se o esfriamento for muito rápido (o &amp;lt;0.1). Entretanto, mesmo para funções objetivo relativamente simples, como a usada no item 3.2 (variograma em uma direção), o algoritmos de SA pode falhar, ficando preso em mínimos locais prematuramente, como é exemplificado a seguir.
O mesmo modelo variográfico e parâmetros empregados nos algoritmos do item
3.2	foram utilizados para a geração de imagens de 160 x 160 células, com os seguintes critérios de seleção de pontos do variograma mostrados na tabela 3.4.
Os resultados obtidos, em termos de tempos e valor final da função objetivo são mostrados na tabela 3.5.
13O valor do parâmetro de controle p não ultrapassou po-
Capitulo 3
45
Figura 3.8: Comportamento das razão de aceitação (x) e razão de melhoria (V?) nos algoritmos de “simulated annealing” (SA) e evolução estocástica (EE).
Caso	Método	Número de células	Espaçamento máximo do variograma	Critério de seleção dos pontos (A)	Pontos selecionados
J	SA	160 x 160	64	XodoS hXO	1,...,64
L	SA	160 x 160	64	h múltiplos de 8 e 1- ponto	1,8,16,24,...,64
M	EE	160 x 160	64	Xoclos	&lt;	1,...,64
N	EE	160 x 160	64	h múltiplos de 8 e l9 ponto	1,8,16,24,...,64
Tabela 3.4: Critérios de seleção de pontos do variograma utilizados nas imagens com 25600 células (160 x 160).
— Capítulo 3 —
46
Caso	Tempo de CPU (min.)	Número de Trocas —	Objetivo Final
J	393.34	11798594	0.080
L	62.46	10582062	0.042
M	27.33	829480	&amp;lt;£
N	8.93	1409200	&amp;lt;£
Obs.: £ = 0.0002.
Tabela 3.5: Tempos de execução, número de trocas e valor final da função objetivo para os casos da tabela 3.4.
A figura 3.9 mostra as imagem dos casos L e N, com os variogramas resultantes. Foi verificado que o modelo não foi satisfatoriamente reproduzido com o algoritmo de “simulated annealing”, que ficou preso em um mínimo local. Já o método de evolução estocástica foi capaz de atingir a tolerância desejada (0.0002) sem dificuldades.
Foi concluido que para problemas de modelagem estocástica com número elevado de células o algoritmo de “simulated annealing” apresenta baixa performance, pois mesmo em um caso com função objetivo simples (variograma em apenas uma direção) a reprodução das características desejadas foi insatisfatória, alé do tempo de execução ter crescido substancialmente.
Os casos J e L foram repetidos com esfriamento lento (o — 0.9). Apesar da função objetivo ter chegado a valores menores (0.035 e 0.019) a tolerância também não foi atingida, mesmo com esforços computacionais excessivos (tempos de 2391.03 e 683.64 minutos; totais de trocas = 71767345 e 72764527). Para estes casos o método de evolução estocástica foi superior. Uma última tentativa foi feita com o caso L, modificando-se o programa de SA com a introdução de uma característica existente no algoritmo de EE: a escolha sequencial de uma das células a serem trocadas. O resultado também não foi satisfatório, com o algoritmo ficando preso em um mínimo local (O = 0.0833) após 10365630 trocas e 84.37 minutos de CPU.
No capítulo 4 são mostrados exemplos onde o algoritmo de “annealing” foi melhor, sendo considerada a reprodução de características mais complexas e utilizados outros critérios de qualidade.
3.6	Critérios de Quantificação da Qualidade
Para as imagens produzidas nesta dissertação, em particular nas obtidas com os algoritmos de SA e EE para comparação com imagens “padrão” (capítulos 4 e 5), foi conveniente definir-se critérios para verificar a qualidade da simulação. Dois critérios são imediatos e
Capítulo 3
47
caso N - EvoHjcsg Estcrcsstica
Figura 3.9: Imagens correspondentes aos casos L e N da tabela 3.4 e vari ograma resultante (direção horizontal). O algoritmo de “simulated annealing” mostrou-se limitado para problemas de grande dimensão, em casos onde o algoritmo de evolução estocástica teve sucesso em atingir a tolerancia desejada.
— Capítulo 3 —
48
já foram mencionados: o tempo de execução do algoritmo e a capacidade de reprodução
das características desejadas (possibilidade de atingir a tolerância e). Outros critérios que
foram utilizados são detalhados a seguir:
3.6.1 Coeficiente de correlação entre os valores das células das imagens simuladas e das imagens padrão
Sendo Z/?(xj) o valor da variável Z na célula de posição Xj da imagem padrão (real) e Zs(xí) o valor simulado por um dos métodos na mesma posição, este critério é definido por:
P*r =
Cov(Zs, Zfi)
^Zs *
(3-4)
Experimentalmente, o coeficiente de correlação é calculado pela equação:
E&amp;amp; [^s(xj) - Z$] [zR{xj) - ZR] p" ~	- z^
(3.5)
onde :
Ncé o número de células da imagem;
Zr é a média dos valores da imagem real;
Zs é a média dos valores da imagem simulada;
Embora não seja o objetivo das técnicas de simulação estocástica gerar em cada nó um valor com a menor variância do erro de estimação (este é o objetivo da krigagem), é desejável que os valores simulados com alguns pontos conhecidos (condicionantes) se aproximem dos valores reais o máximo possível.
Imagens “defeituosas”, com concentração de valores extremos nas bordas foram reportadas por Deutsch (Deutsch, 1992:48) em alguns casos utilizando o SA com esfriamento muito rápido (o &amp;lt;0.1).
Este critério foi originalmente utilizado por Pérez (1991). Em um caso onde se comparou os valores simulados com SA com uma imagem padrão obtida com o método de SSG, sendo o objetivo a reprodução de variogramas, Pérez verificou a influência da velocidade de esfriamento (a) e o número mínimo de trocas em cada temperatura (Afa) no valor de p8T. Os resultados são reproduzidos na figura 3.10.
Com base neste resultados, concluiu-se que a reprodução das características desejadas não é suficiente para a obtenção de imagens de boa qualidade. A utilização de fatores de esfriamento q altos (tempos maiores) é recompensada com melhor qualidade, segundo este critério. Pérez recomenda a utilização de a &gt; 0.5 e Ma &gt; 6 ciclos; valores
Capítulo 3 —
49
Figura 3.10: Coeficiente de correlação (psr) em função da número mínimo de iterações ern cada temperatura (Ma), para diversas velocidades de esfriamento (o). - Adaptado de Pérez (1991:54)
muito maiores exigem esforços computacionais desnecessários. Entretanto estes valores e o gráfico da figura 3.10 correspondem a um caso particular, devendo ser considerados critérios aproximados.
Dependendo das particularidades dos reservatórios simulados e dos componentes da função objetivo, verifica-se maior ou menor relação entre psr e o, como será visto no capítulo 4. Como não existem valores ideais destes parâmetros válidos para todos os caso, é recomendável utilizar-se na primeira simulação valores elevados (como a — 0-9), diminuindo nas simulações subsequentes (Deutsch, 1992:123).
3.6.2 Comportamentos de fluxo simulados
A previsão do comportamento de produção e dos riscos envolvidos é um dos motivos principais para a geração de modelos estocásticos de reservatórios. Modelos que reproduzam os comportamentos reais são desejáveis, devendo-se desprezar aquelas cujo comportamento simulado não reproduza satisfatoriamente o histórico observado.
Nos capítulos 4 e 5 são feitas comparações entre os comportamentos de pressões
em testes com vazão constante simulados com as imagens modeladas com SA e com as
imagens padrão.
4	REPRODUÇÃO DE CARACTERÍSTICAS DE RESERVATÓRIOS - INFORMAÇÕES GEOLÓGICAS
Neste capítulo sâo estudados os comportamentos dos algoritmos de “simulated annealing” (SA) e evolução estocástica (EE) na geração de imagens probabilísimas de reservatórios, representados por seções verticais com discretização de 48 x 24 células. 0 objetivo principal foi verificar a influência de alguns parâmetros destes métodos e da inclusão de informações geológicas adicionais na qualidade das imagens, de acordo com os critérios vistos na seção 3.6.
Para a comparação sistemática pelos critérios de reprodução de características desejadas e coeficiente de correlação pjr, é necessário conhecer-se a imagem real. Isto não ocorre nas aplicações práticas34, onde só é possível a verificação dos outros critérios.
O procedimento usualmente adotado é a construção de imagens “padrão”, que supostamente representam um reservatório real. Estas imagens podem ser obtidas sinteticamente através de simulações com qualquer método, ou usando propriedades geológicas reais, medidas ou observadas em afloramentos, testemunhos ou amostras quaisquer. No primeiro caso existe a desvantagem de se trabalhar com uma imagem artificial, com todos os defeitos e limitações (conhecidos ou não) do método utilizado. A vantagem é a possibilidade de construir imagens com características específicas, permitindo análises mais abrangentes. O segundo caso geralmente é preferível, já que representa mais fielmente as peculiar!edades de um reservatório. Os dois casos podem ser utilizados em conjunto, gerando-se imagens sintéticas com algumas características observadas em reservatórios reais.
O ítem 4.1 apresenta em detalhe como foram construidas as quatro imagens padrão utilizadas nesta dissertação, com características diversas.
No item 4.2 são apresentados os parâmetros dos algoritmos usados nas simulações condicionais, e as hipóteses e procedimentos adotados. Os resultados obtidos na geração de imagens que reproduzem variogramas e médias locais, em termos de tempos de execução, tolerâncias e coeficientes de correlação (psr), são mostrados no item 4.3, com as conclusões iniciais. Os algoritmos de “simulated annealing” e evolução estocástica são comparados por estes critérios.
O item 4.4 apresenta os comportamentos simulados de pressões das imagens simuladas, comparando com as imagens padrão correspondentes e analisando a influência das novas informações incluidas nesta fase. 14
14E se ocorresse não seria necessário modelar.
51
— Capítulo 4 —
52
4.1	Geração de Imagens Padrão
Nesta dissertação quatro imagens padrão foram geradas: duas obtidas sinteticamente com o algoritmo de SA utilizando informações de reservatórios reais (padrões 1 e 2); uma gerada com o algoritmo de SSG com anisotropia bastante diferente das duas primeiras (padrão 3) e outra obtida indiretamente de um afloramento com óleo residual, sem a necessidade de modelagem (padrão 4).
A variável modelada foi a permeabilidade absoluta na direção horizonta (Kh), A porosidade (d&gt;) e a permeabilidade absoluta na direção vertical (A'v), necessárias para as simulações de fluxo monofásico, foram obtidas por relações diretas com a permeabilidade horizontal. A exceção foí a primeira imagem padrão, onde foi obedecida a correlação observada entre os valores de e Kh e entre Kv e Kh das análises petrofísicas.
A seguir são descritas com detalhe como foram geradas as imagens padrão bidimensionais (valores de Kh) com 1152 células:
4.1.1	Imagem Padrão 1
A imagem padrão 1 representa uma seção vertical com 768 m de comprimento e 19.2 m de espessura. Para a sua construção utilizou-se medidas de permeabilidade absoluta (direções horizontal e vertical) e porosidade de plugues, retirados de testemunhos de um reservatório cujo ambiente deposicional é interpretado como fluvial. Devido à diferença entre os volumes dos plugues amostrados e o das células da imagem padrão, a geração desta foi feita em três passos distintos: (a) construção de variogramas no suporte (volume) dos plugues; (b) mudança de suporte e construção de uma imagem intermediária com 192 x 48 células; (c) mudança de escala para a obtenção da imagem padrão 1. O procedimento é descrito a seguir:
(a) Construção de Variogramas no Suporte dos Plugues:
Foram utilizadas medidas de 624 plugues amostrados em 17 poços do reservatório pesquisado. Dois poços foram selecionados para representarem as extremidades da seção a ser gerada. A figura 4.1 mostra a localização relativa dos poços, destacando os dois que fizeram parte da imagem gerada.
A figura 4.2 apresenta a distribuição (histograma) dos valores do logaritmo decimal da permeabilidade absoluta na direção horizontal (log(Kã)). Foi selecionada como variável aleatória Z(x) o log(Kã), mas a relação com as demais variáveis (porosidade e logaritmo decimal da permeabilidade absoluta na direção vertical (log(/fv)) foi respeitada15. A figura 4.3 mostra a relação entre as variáveis secundárias e o log(Kà), onde se verificam boas correlações,
15Estas últimas foram utilizadas nas simulações de fluxo e são denominadas nesta dissertação variáveis secundarias.
Capítulo 4
53
Figura 4.1: Localização relativa dos poços correspondentes às análises petrofísicas em amostras de testemunhos. Os dois poços condicionantes da seção vertical intermediaria do padrão 1 são destacados.
654
1.3658
1.1105
0.8131
3-7243
23668
1.4298
0.4624 -1.0000
Figura 4.2: Distribuição dos valores de log(Kà) obtidos de medições em plugues.
— Capítulo 4
54
fojf (Kh) x Poro»id»d»
1.00_
&amp;amp;
3 00_
.
4.00
-
2.00 -
•s
Toai de pomos	654
Variável X. media	15.717
variância	23.251
Variave! Y: meãia	1.366
variância	1233
correlação	0852
4.00 fog (Kv) x log (Kh)
*

3.00
2.00-
è	■
S	:
1.00.
0.00 _
••
« »
»
♦
s.r ik
•f í*/
í’
* *. • • l • ' ;z %v ••. *
*’tt % • *• s * •.
» «*».. *
•?£*&amp;lt;\
• * * *
t	«*■	•	•
Total de pontos 255
Vartavef X: média variância
Variávei Y. média variância
correlação 0.905
1.436
1.225
1.214
1.167
* ■


4 »


-1.00
hg(Kh)
Figura 4.3: Relações entre as variáveis secundárias ($ e log(Kv)) e a variável principal (log(KA)), medidas em plugues.
Capít ulo 4
55
Figura 4.4: Variograma da variável log(Kà) na direção vertical, com os valores medidos em plugues no laboratório.
0 variograma da variável Z(x) foi facilmente obtido na direção vertical, devido à abundância de dados. Foi utilizado o programa gam2v do GSLIB (Deutsch &amp;amp; Jour-nel, 1992a:51), próprio para a construção de variogramas experimentais com dados irregularmente espaçados. A figura 4.4 mostra o variograma obtido e uma ampliação nos espaçamentos menores. A linha cheia corresponde a um modelo ajustado com duas estruturas: uma exponencial, com parâmetro a — 0.45 m (alcance efetivo — 3a) e patamar c = 0.75, e outra potencial (fractal) com potência a ~ 0.25 e inclinação c = 0.20.
Na direção horizontal, como o espaçamento médio entre os poços é superior ao alcance do variograma, não foi possível a construção direta do mesmo. Foi adotada então a hipótese de que teria a mesma forma da direção vertical, mas com um alcance maior, sendo modelado através de uma anisotropia geométrica. Para a estimativa desta anisotropia, foram utilizadas informações de fácies observadas em um afloramento da mesma formação e sistema deposicional dos plugues analisados (Fm. Açu, bacia Potiguar). Na tabela 4.1 são apresentadas as litologias e estruturas sedimentares das fácies observadas no afloramento.
Foi definida uma variável indicadora /(x) a partir da variável discreta VF(x) que representa a ocorrência de fácies da seguinte forma:
í 1, seh(x)&lt;7
[ 0, se Hz(x) &gt; 7
Em seguida, foi construido o variograma da variável indicadora, mostrado na figura 4.5. Embora as fácies não correspondam exatamente a unidades de fluxo, pode-se associar grosseiramente os valores de J(x) — 0 às fácies produtoras e J(x) = 1 às fácies
— Capítulo
56
Fácies	Litologia	Principais Estruturas Sedimentares
1	Conglomerado	Estratificações Cruzadas Acanaladas (Maciços)
2	Conglomerado Intraformação	Estratificações Cruzadas (Maciços)
3	Arenitos Conglomeráticos	Estratificações Cruzadas Acanaladas de grande porte (estrat. plano-paralelas)
4	Arenitos Grosseiros	Estratificações Cruzadas Acanaladas de grande porte
5	Arenitos Grosseiros	Estratif. plano-paralelas ou cruz, baixo ângulo a assintótica
6	Arenitos Grosseiros	Maciço
7	Arenitos Médios	Estratif. plano-paralelas, bx. ângulo, cruzadas acanal. e tabulares (maciços)
8	Arenitos Finos	Estratif. plano-paralelas, maciços (“climbing ripples”)
9	Pelitos Arn./Argil.	Estratif. plano-par alei as, “climbing ripples” maciços
Tabela 4.1: Descrição das fácies observadas no afloramento da Fm. Açu.
— Capítulo 4 ■ —
57
Figura 4.5: Varíograma da variável indicadora definida pela equação 4.1, obtida do afloramento da Fm. Açu. Modelo ajustado: esférico; alcance (horizontal) — 1.3 m; patamar = 0.18; anisotropia geométrica " 10:1.
não produtoras.
O varíograma da figura 4.5 ajustou-se bem a um modelo com anisotropia geométrica de 10:1. Este valor foi adotado também para a variável Z = log(Kâ).
É importante lembrar que as diversas simplificações e hipóteses introduzidas, como a comparação direta entre parâmetros de variogramas de variáveis discretas (fácies) e contínuas (log(Kâ)), foram feitas tendo em vista que o objetivo foi gerar uma imagem padrão para testar algoritmos de OC, e não modelos estocásticos do reservatório que originou os dados.
(b)	Imagem Intermediária - Correção do Efeito Suporte:
Como os valores de Z — log(Kâ), das variáveis secundárias e dos variogramas correspondem ao suporte do plugue cilíndrico (diâmetro — 1 pol.; comprimento = 1 poh), foi necessário proceder-se a uma mudança de escala para as células da imagem padrão (16 x 0.8 m), corrigindo-se o “efeito suporte”.
No caso de variáveis aditivas16, existem métodos desenvolvidos para a obtenção de variogramas em suportes diferentes (Journel, 1978:77; Isaaks &amp;amp; Srivastava, 1989:459).
16 Uma variável é denominada aditiva se seu valor em uma escala maior equivale à média aritmética das partes (escala menor). Neste caso toda combinação linear da variável ainda gu ar dao sentido original.
Capítulo 4 —
58
Para a permeabilidade, que é uma variável não aditiva1', embora existam alguns métodos que propõem a mudança de escala quando todos os valores são disponíveis, nada existe para a obtenção direta do variograma em outro suporte com alguns pontos conhecidos. Neste caso, a utilização dos métodos de mudança de suporte mencionados acima não tem comprovação prática.
A mudança de suporte para as variáveis log(Kâ) e log(Kr) foi feita em duas etapas: na primeira mudou-se para um suporte intermediário, com 192 x 48 células (de dimensão 4.0 x 0.4 m); nesta fase foi feita a simplificação de considerar estas variáveis aditivas, de maneira semelhante à porosidade. Numa fase posterior (c), tendo-se valores para todas as células da imagem intermediária, utilizou-se o método de mudança de escala descrito por Le Loc’h (1989). O procedimento mais correto, que praticamente evitaria erros seria gerar uma imagem intermediária com as dimensões do suporte original (0.025 x 0.025 m)18 seria utilizando o método de Le Loc’h diretamente. Entretanto, isto seria muito trabalhoso, já que seria necessária a construção de uma imagem de 23592960 células
(malha de 30720 x 768).
Foi utilizado o método de correção afim, provavelmente o mais simples dos proce-
dimentos de correção do efeito suporte (Isaaks &amp;amp; Srivastava, 1989:471). Este método se propõe a transformar quantis (ou valores) q de uma distribuição original correspondente
a variância o'2 de uma distribuição pode ser reduzida sem alterar a média m “comprimindo” todos os valores em direção à média (Isaaks &amp;amp; Srivastava, 1989:471). Neste caso, a seguinte relação é válida por hipótese:
qf — m q — rn
(4.2)
Pode-se definir um fator de ajuste f que relaciona as variâncias das duas distribuições como:
(4-3)
Usando 4.3 em 4.2, a equação para o cálculo dos valores de q' é dada por:
(4.4)
transformação dos valores experimentais medidos em plugues para as variáveis log(Jíâ),
17No caso particular de ausência de correlação espacial, a variável Z = log(K) pode ser considerada aditiva.
18Como nesta dissertação foram produzidas imagens em duas dimensões, considerou-se que um plugue corresponde à esta área.
Capítulo 4 —
58
Para a permeabilidade, que é uma variável nâo aditiva1' , embora existam alguns métodos que propõem a mudança de escala quando todos os valores são disponíveis, nada existe para a obtenção direta do variograma em outro suporte com alguns pontos conhecidos. Neste caso, a utilização dos métodos de mudança de suporte mencionados acima não tem comprovação prática.
A mudança de suporte para as variáveis log(A'A) e log(A'v) foi feita em duas etapas: na primeira mudou-se para um suporte intermediario, com 192 x 48 células (de dimensão 4.0 x 0.4 m); nesta fase foi feita a simplificação de considerar estas variáveis aditivas, de maneira semelhante à porosidade. Numa fase posterior (c), tendo-se valores para todas as células da imagem intermediária, utilizou-se o método de mudança de escala descrito por Le Loc*h (1989). O procedimento mais correto, que praticamente evitaria erros seria gerar uma imagem intermediária com as dimensões do suporte original (0.025 x 0.025 m)17 18 seria utilizando o método de Le Loc’h diretamente. Entretanto, isto seria muito trabalhoso, já que seria necessária a construção de uma imagem de 23592960 células (malha de 30720 x 768).
Foi utilizado o método de correção afim, provavelmente o mais simples dos procedimentos de correção do efeito suporte (Isaaks &amp;amp; Srivastava, 1989:471). Este método se propõe a transformar quantis (ou valores) q de uma distribuição original correspondente a um suporte puntual para quantis (ou valores) q' em outro suporte. A idéia básica é que a variância cr2 de uma distribuição pode ser reduzida sem alterar a média m “comprimindo51 todos os valores em direção à média (Isaaks &amp;amp; Srivastava, 1989:471). Neste caso, a seguinte relação é válida por hipótese:
c'	a
Pode-se definir um fator de ajuste / que relaciona as variâncias das duas distribuições como:
Usando 4.3 em 4.2, a equação para o cálculo dos valores de qf é dada por:
O Anexo E mostra como o valor de f é obtido e a obtenção das equações da transformação dos valores experimentais medidos em plugues para as variáveis log(AA),
17No caso particular de ausência de correlação espacial, a variável Z = log(K) pode ser considerada aditiva.
18Como nesta dissertação foram produzidas imagens em duas dimensões, considerou-se que um pingue corresponde à esta área.
— Capítulo 4 ~~
59
Figura 4.6: Variograma na direção vertical da variável log(A'fi) para o suporte da imagem intermediária (4.0 x 0.4 m).
log(Kv) e
Variogramas da imagem intermediária
Após efetuadas as transformações pela equação 4.4, os variogramas para o suporte intermediário foram construidos. A figura 4.6 mostra o variograma na direção vertical com este suporte. Foi observada redução significativa do patamar em relação ao variograma com o suporte dos pingues (figura 4.4), devido à redução da variância de dispersão.
Pontos Condicionais da Imagem Intermediária
Os dois poços selecionados como condicionantes correspondem às células das extremidades esquerda e direita da seção intermediária. A figura 4.7 mostra perfis das variáveis log(Kfi) e porosidade das medidas petrofísicas após a transformação para o novo suporte. Verificou-se uma boa correlação de alguns pontos entre os dois poços, salientados pelas regiões Rl a R7, cujos valores médios foram utilizados como condição a ser reproduzida na imagem intermediária.
Para dirimir dúvidas, foram também usados os perfis de raios gama dos poços para conferir a correlação lateral. A figura 4.8 mostra estes perfis, destacando a região correspondente à seção vertical gerada (k = 19.2 m).
Os pontos correspondentes às medidas realizadas foram atribuidos às células condicionantes, após uma mudança de coordenada estrutural para estratigráfica (vide por exemplo Campozana, 1990:33,35).
— Capítulo 4 —
60
Figura 4.7: Perfis da variável log(K/i) nos poços condicionantes, regularizada para o suporte intermediário.
Figura 4.8: Perfis de raios gama dos poços condicionantes. Verifica-se boa correlaçã áreas destacadas.
y
£
Capítulo 4
— Capítulo 4 —
62
Região	Z médio	(célula)	/ J/mar. (célula)
1	2.278	1/192	8/11
2	1.955	1/192	10/10
3	2.759	1/192	11/11
4	0.761	1/192	29/32
5	0.212	1/192	32/32
6	2.339	1/192	35/35
7	0.811	1/192	47/47
Tabela 4.2: Regiões de médias impostas para a imagem intermediária.
Regiões de Médias
Foi verificado pelos perfis de log(A'A) que algumas feições aparentemente tem boa continuidade, representadas pelas regiões destacadas na figura 4.7. Nesta dissertação foram definidas regiões de médias para representar as zonas com boa correlação entre poços, impondo-se valores para determinadas áreas das seções simuladas. A tabela 4.2 mostra a abrangência de cada região de média imposta como condição a ser honrada na imagem intermediária e os valores médios áe Z ~ log(/éâ) correspondentes.
Geração da Imagem Intermediária
Com os pontos condicionais (total de 78 pontos), variogramas, distribuição da variável log(JÍ^) após a regularização e as regiões de médias definidas, utilizou-se o programa sasimS para gerar a imagem intermediária com 192 x 48 células. Os parâmetros utilizados foram : xtTi. = 0.99; a = 0.60; Ma = 6 ciclos; Mt ~ 270 ciclos; tolerância £ = 10~6. Nestas condições a imagem foi gerada em 9.25 horas, e o valor final da função objetivo foi 3.9 x 10“5.
A imagem intermediária é mostrada na figura 4.9. Os pontos do variograma experimental (não mostrados) praticamente coincidiram com o modelo da figura 4.4, assim como os valores de médias impostos19.
(c)	Mudança de Escala e Obtenção da Imagem Padrão 1:
Com a imagem intermediária, procedeu-se à mudança de escala com o método de Le Loc’h utilizando o programa leloc.for, desenvolvido por Cruz (1991). Obteve-se a imagem da variável Z(x) com 1152 células (48 x 24), apresentada na figura 4.10 com os variogramas. As distâncias são representadas em número de células20. Foi constatada uma nova redução na variância de dispersão e o aparecimento de uma anisotropia zonal.
19A exceção foi a região 3, onde a média da obtida na imagem intermediária foi 2.488 (erro de 10 %).
20Neste caso, uma célula equivale a 16 m na direção horizontal e 0.8 m na vertical.
— Capítulo 4 —
63
Figura 4.9: Imagem intermediária com 192 x 48 células gerada para a construção da imagem padrão 1. - Exagero Vertical ~ 20 X.
Apesar do alcance dos variogramas ter continuado pequeno (cerca de 50 m na direção horizontal), as regiões de médias correspondentes aos pontos com boa correlação se destacam, simulando canais preferenciais de fluxo e barreiras de permeabilidade. Embora aparentemente a seção da figura 1 em nada se assemelhe a feições geológicas observadas em afloramentos, isto também ocorre para imagens oriundas de afloramentos após a mudança de escal, como será visto no item 4.1.4. Alé disto, deve-se salientar que o exagero vertical da figura 4.10 é de 20 X, mascarando a anisotropia geométrica.
Foram selecionados os pontos destacados no variograma para as simulações es-tocásticas (capítulos 4 e 5).
4.1.2	Imagem Padrão 2
Esta imagem corresponde a uma seção vertical com 480 m de comprimento e 24 m de espessura (células de 10 x 1 m). Para a sua construção foram utilizados variogramas com efeito periódico pronunciado, originários de dois poços de um reservatório turbi dítico da bacia de Campos. Estes variogramas correspondem à variável Vsh (volume de argila) ao longo dos poços, e foram extraídos da dissertação de Campozana (Campozana, 1990:93).
As distâncias dos variogramas originais foram multiplicadas por 4 para a obtenção do variograma modelo na direção horizontal e divididas por 2.5 para gerar o modelo na vertical. Os valores dos variogramas por sua vez foram multiplicados por 2.5 e 4.5, respectivamente, para produzir uma anisotropia zonal. Foram impostas ainda duas regiões de médias, com os valores da tabela 4.3.
Os valores da tabela 4.3 obedeceram à distribuição da figura 4.11, construída
— Capítulo 4
64
Figura 4.10: Imagem Padrão 1 e variogramas nas direções horizontal e vertical. - Exagero Vertical = 20 X.
Região	Z médio	3-mtn. / ^max. (célula)	y-min. / ymax. (célula)
1	2.750	1/36	6/7
2	0.300	1/48	21/21
Tabela 4.3: Regiões de médias impostas para a imagem padrão 2.
Capítulo 4
65
Figura 4.11: Distribuição de probabilidade dos valoTes da imagem padrão 2. manualmente.
Utilizando-se o programa sasiin3 com os mesmos parâmetros empregados para a imagem intermediária da seção padrão 1 (item 4.1.1), foi gerada a imagem padrão 2, mostrada na figura 4.12 com os respectivos variogramas. As linhas cheias correspondem a um modelo ajustado21 com duas estruturas exponenciais com os parâmetros a = 6.0 células; c — 0.47 (horizontal) e a ~ 3.5 células; c — 0.35 (adicionado na direção vertical). Para a geração dos valores de porosidade (&lt;£) e permeabilidade vertical, as seguinte relações foram adotadas:
-6.1og(Kh) + 12
4.1.3	Imagem Padrão 3
A imagem padrão 3 corresponde a uma seção vertical de 960 m de comprimento e 24 m de espessura (células de 20 x 1 m). Para gerá-la foi utilizado o método de simulação sequncial gaussiana (SSG), com um modelo variográfico esférico com os parâmetros: alcance a ~ 400
21 Usado no item 4.2
Capítulo 4
66
120 Varlogramas nas direções horizontal e vertical

Figura 4.12: Imagem Padrão 2 e vari ogramas. ~ Exagero Vertical -•= 10 X.
67
— Capít uto 4 —
m (horizontal); patamar c = LO; anisotropia geométrica = 4:1; efeito pepita = 0. Após a obtenção dos valores com distribuição normal,.foi feita a transformação de variáveis para a mesma distribuição usada na imagem padrão 2, segundo o procedimento esquematizado na figura A.l22.
A figura 4.13 mostra a imagem padrão 3, com os variogramas experimentais. Devido ao exagero vertical utilizado (20 X), aparentemente existe uma maior continuidade na direção vertical. Observa-se que esta imagem é nitidamente não estacionária, com uma concentração de valores baixos na parte esquerda.
4.1.4	Imagem Padrão 4
Esta imagem padrão corresponde a uma seção vertical com 480 m de comprimento e 24 m de largura. Para a sua obtenção foi utilizada uma fotografia de parte de um afloramento da Fm. Piramboia (bacia do Paraná) cujo ambiente sedimentar é interpretado como eólico. Este afloramento tem a característica de ser portador de óleo residual, sendo mostrado nas fotografias das figuras 4.14 e 4.15 (detalhe).
Este afloramento localiza-se na Fazenda Betumita, situada no município de A-nhembi (SP), a cerca de 20 km da cidade de mesmo nome.
A permeabilidade absoluta está relacionada às áreas mais escuras da fotografia, já que houve migração seletiva do óleo para as regiões de melhor permo-porosidade. Uma parte do afloramento, mostrada na fotografia inferior da figura 4.15 foi usada para a geração de uma imagem digitalizada com o equipamento I2S, com discretizaçao de 681 x 249 células. Selecionou-se uma região da mesma, com 192 x 192 células, procurando evitar os ruídos existentes, oriundos de sombras e intempéries. A figura 4.16 mostra imagens em greyscale das imagens digitalizadas, destacando a região selecionada para a construção da imagem padrão 423. Destaca-se a ocorrência de dois eventos deposicionais, com estratificações plano-paralelas em duas direções.
O passo seguinte foi transformar a distribuição de tonalidades da imagem digitalizada (valores entre 0 e 250) para uma distribuição típica de tog(JKh) de um reservatório. Foi adotada a distribuição dos valores da imagem intermediária obtida na geração da imagem padrão 1. A imagem resultante é mostrada na figura 4.1724.
Para construir a imagem padrão 4 (48 x 24 células) foi usado o método de Le Loc’h para a mudança de escala. A imagem resultante é mostrada na figura 4.18, juntamente com os seus variogramas. Verifica-se que as características principais foram mantidas,
22Na distribuição da imagem padrão 2, entretanto, foi evitada a geração de valores de Z(x) menores que -0.5 e maiores que 3.0 (extrapolação potencial), o que não ocorreu -com a distribuição da imagem padrão 3 (extrapolação linear).
23Observa-se que os ruídos correspondentes à sombras não puderam ser totalmente evitados.
24Nesta figura as tonalidades mais claras correspondem aos valores de log(Kh) maiores. A dimensão vertical foi reduzida à metade.
— Capítulo 4
68
Figura 4.13: Imagem Padrão 3 e variogramas. - Exagero Vertical = 20 X.
Capítulo 4 —
69
Figura 4.14: Fotografia do afloramento da Fm. Piramboia (bacia do Paraná)
Capítulo 4 —
70
Figura 4.15: Fotografias de detalhes do afloramento da Fm. Piramboia (bacia do Paraná).
A foto inferior foi utilizada para a geração da imagem padrão 4.
— Capítulo 4
71
Figura 4.16: Imagens digitalizadas do afloramento da Fm. Piramboia (bacia do Paraná), destacando a região selecionada para a construção da imagem padrão 4.
Capítulo 4
72
Figura 4.17: Detalhe do afloramento da Fm. Piramboia após transformação da distribuição de tonalidades (fig. 4.17) para a distribuição de log(Ar/i).
como a presença de “canais preferenciais” de alta permeabilidade.
4.1.5	Quadro Resumo e Distribuições
As tabelas 4.4 e 4.5 mostram quadros resumo das principais características estruturais e estatísticas das imagens padrão, onde se verifica a diversidade das propriedades.
A figura 4.19 mostra os histogramas dos valores de Z(x) das imagens padrão.
Imagem Padrão	Método Utilizado	Comprimento (m)	Espessura (m)	Anisotropia Geométrica	Anisotropia Zonal	Efeito Periódico
1	SA	768	19.2	20:1	1.36	NÂO
2	SA	480	24.0	10:1	1.74	SIM
3	SSG	960	24.0	3.5:1	1.00	NÃO
4	Foto de Afloramento	480	24.0	44:1	1.45	NÂO
Tabela 4.4: Características variográficas e dimensões das imagens padrão.
Capítulo 4
73
Dista roa (estalas)
Figura 4.18: Imagem Padrão 4 e variogramas nas direções horizontal e vertical.
Imagem Padrão	Média	Variância	Coeficiente de Variação	Valor Mínimo	le Quartil	39 Quartil	Valor Máximo
1	1.252	0.329	0.458	-0.181	0.794	1.686	2.460
2	1.857	0.702	0.451	-0.506	1.354	2.545	2.897
3	1.826	0.900	0.519	-2.074	1.382	2.545	3.380
4	1.449	0.406	0.439	-0.201	0.997	1.958	2.784
Tabela 4.5: Características estatísticas das imagens padrão.
Capítulo 4 ~
74
P&amp;amp;dríb 2
Frequenda	Frequência
Pnsg&amp;amp;rn Pstdr&amp;amp;b 3	Ims^m Pidrso 4
iog(Kh)
íog(Kh)
Figura 4.19: Distribuições dos valores de log(/fã) utilizados nas imagens padrão 1 a 4.
Capítulo 4 —
75
4,2	Reprodução de Variogramas e Médias - Procedimento
Neste item sâo analisadas imagens modeladas com “simulated annealing" e evolução es* tocástica que honram algumas características das imagens padrão geradas com os procedimentos detalhados na seção 4.1. Foram impostos como condições a serem reproduzidas numa primeira fase valores conhecidos de poços fictícios, o histograma da variável Z(x) e os variogramas (representados por alguns pontos selecionados). Na fase 2 foi acrescentado como objetivo a reprodução de valores de médias regionais e, em alguns casos, de pontos de variogramas regionais25.
Em cada etapa foram inicialmente simuladas 10 imagens com o algoritmo de SA com parâmetros diferentes e uma imagem com o método de EE, com o objetivo de verificar a influência dos mesmos no coeficiente de correlação entre as imagens simuladas e as imagens padrão (psr). A mesma semente inicial foi utilizada para o gerador de números aleatórios. Em seguida, fixou-se os parâmetros de uma das imagens geradas com SA e produziu-se mais 5 imagens com sementes diferentes, com a finalidade de estudar o efeito da inclusão de novas informações no valor de psr e no comportamento de produção simulado. Em fases posteriores (capítulo 5) também foi verificada a influência de informações relacionadas indiretamente à permeabilidade de testes de formação.
4.2.1	Seleção de pontos do variograma global
Como foi visto no item 3.2, é conveniente escolher-se alguns pontos do variograma para serem reproduzidos. Com base nos experimentos descritos naquele item e nas recomendações de Deutsch (Deutsch, 1992:126), foram selecionados alguns pontos dos variogramas nas direções horizontal e vertical das imagens padrão, destacados nas figuras 4.10, 4.12, 4.13 e 4.18. Alguns pontos em outras direções também foram incluidos nos espaçamentos menores para os padrões 1 e 4; as figuras 4.20 e 4.21 esquematizam os vetores que representam os espaçamentos escolhidos para estes dois casos.
No caso das imagens associadas à imagem padrão 2, utilizou-se na primeira fase um modelo variográfico que não considerou os efeitos periódicos existentes26.
4.2.2	Pontos Condicionais e Distribuições
Foi adotada a hipótese da existência de poços fictícios onde os valores das células são conhecidos. Em todos os casos as células das extremidades direita e esquerda foram reproduzidas (r = 1 e r = 48). Para as seções simuladas relacionadas às imagens padrão 2 e 4 foi acrescentado um poço central (x = 25) como supostamente conhecido.
A distribuição dos valores gerados obedeceu aos histogramas das imagens padrão,
25Esta fase não foi executada para a imagem padrão 3.
26Na fase 2 foi utilizado o variograma original da imagem padrão 2.
Capítulo 4 —
76
Figura 4.20: Representação das distâncias e direções selecionadas para a simulação de imagens associadas ao padrão 1.
Figura 4.21: Representação das distâncias e direções selecionadas para a simulação de imagens associadas ao padrão 4.
Capítulo 4
77
Imagens	Tolerância (é)	Fator de Esfriamento (a)	Ma (ciclos)	(ciclos)
Pza	0.00001	0.9	10	300
Pr'b	0.00001	0.6	10	300
Pzc	0.00001	0.1	10	300
Psd	0.00010	0.9	10	300
Pxe	0.00010	0.6	10	300
Pxf	0.00010	0.1	10	300
Pzg	0.00010	0.6	6	65
P^h	0.00010 n	0.1	40	300
Pari	0.00010	0.0	10	300
Pu	0.00010	0.0	10	300
Pad	0.00010	0.9	40	300
Obs.: Foi utilizada a taxa de aceitação inicial y1Tl. = 0.99, com exceção das imagens Pad, onde foi usada x»n. — 0.997.
Tabela 4.6: Parâmetros utilizados no algoritmo de “annealing” para a simulação de seções verticais.
com exceção das imagens baseadas no padrão 2, onde foi utilizada a distribuição das células condicionantes.
4.2.3	Parâmetros Utilizados nas Simulações
A tabela 4.6 apresenta os parâmetros principais do algoritmo de SA usados para as 10 imagens iniciais para cada caso. Foi usada a nomenclatura Pxyz(i), onde x identifica a imagem padrão associada, y é uma letra correspondente a um determinado conjunto de parâmetros utilizado, z é a fase da simulação, em função dos componentes introduzidos na função objetivo e i denota as 5 imagens adicionais geradas em cada fase (com sementes diferentes).
Nas imagens geradas com o algoritmo de EE, os parâmetros foram escolhidos de modo a aceitar inicialmente poucas trocas que não provocassem melhora na função objetivo, o que só e feito caso necessário, através do parâmetro (3. Os valores usados na maior parte dos casos foram: p0 — 0.00001; $ — 0.2; F — 10 e R ~ 1527. Em relação à nomenclatura, a letra P foi substituida por E.
2?Nos casos em que a tolerância desejada não foi atingida com estes parâmetros (funções objetivo mais complexas), utilizou-se 72 = 50 ou 100 para aumentar o tempo de execução.
— Capítulo 4 —
78
	Ps#		x t ~ com a = O.f		
0 b ™i					
	c				
					
		„ _ - -			
			e -,		
	■ -■	**			
					
				\	
					
					\	«p			
				\	
				o	*	
0 2				\	
					
0 1					
		eetoente	- 3317		
	C• € Ç $ €	wrnente	» 160		
c.o -					
0.00001		0 0001	0.001 0.01	0.1	1
			Tolerância		
Figura 4.22: Esquerda: Comportamento do coeficiente de correlação (psr) em função da tolerancia da função objetivo especificada (e) - Testes preliminares relativos à imagem padrão 1 (fase 2); Direita: Tempos de CPU correspondentes às tolerancias adotadas.
4.2.4	Escolha das Tolerâncias
Para cada imagem simulada foram ad otad as tolerancias que não provocassem diferenças significativas entre as funções desejadas (teóricas) e experimentais. O gráfico da figura 4.22 apresenta os valores de pír28 obtidos em testes preliminares com as imagens relacionadas ao padrão 1 (fase 2) utilizando-se tolerancias diversas e os parámetros de “annealing” iguais aos das imagens Pxc2 (tabela 4.6). Observa-se que com este critério é recomendável a escolha de e &amp;lt;0.004.
4.2.5	Médias e Variogramas Regionais
Nas imagens geradas na segunda fase, informações associadas a regiões específicas das seções foram incluidas. No Anexo F são descritas as regiões de médias e variogramas locais impostos para cada caso, correspondente a uma determinada imagem padrão. Nos padrões 2 e 4 estes dados foram obtidos somente com os pontos condicionantes, enquanto para o padrão 1 todos os valores foram considerados.
28No cálculo de pír foram incluídos os pontos condicionais, que coincidem nas imagens padrão e simuladas.
Capítulo 4
79
Figura 4.23: Exemplos de imagens geradas na primeira e na segunda fase, comparando com a imagem padrão correspondente (4) e seus variogramas..
4.3 Resultados Obtidos — Tempos, Tolerâncias e Coeficientes de Correlação
As tabelas 4.7 a 4.10 apresentam os valores dos coeficientes de correlação par para cada imagem modelada, além dos tempos de CPU gastos e números de trocas necessárias. O sucesso do algoritmo em atingir as tolerâncias da tabela 4.6 são reportados; nos casos em que o algoritmo ficou preso em um mínimo local consta o valor atingido da função objetivo. Nas tabelas 4.11 e 4.12 são mostrados os valores de p3T para as imagens adicionais, geradas com parâmetros de “annealing” fixos e sementes diferentes.
A figura 4.23 mostra como exemplo as imagens P4el e P4e2 com os variogramas experimentais e teóricos e a repetição da imagem padrão 4. Nota-se o efeito da inclusão das médias como informação e a boa reprodução do variograma imposto.
Capítulo 4 —
60
	I---	 	•	       •	•			1	1					
						
	Imagem	Tempo de CPU (minutos)	lotai de Trocas	Psr (1)	Psr (2)	Tolerância da Função Objetivo (e)
F a. s e 1	Plal	40.86	2209842	0,199		Atingida
	Plbl	6.23	450021	0.092	—	Atingida
	Plcl	1.52	106183	0.161		Atingida
	Pldl	18.02	1314010	0.276	■—™	Atingida
	Plel	4.09	294997	0.222	—__	Atingida
	Plfl	0.97	67067	0.170	——	Atingida
	Plgl	2.44	173923	0.224	—	Atingida
	Plhl	3.49	251299	0.167	—	Atingida
	Plil	0.07	3521	0.209	—	Atingida
	Pljl	73.47	5257268	0.212	—„	Atingida
	Eli	0.10	2983	0.234	—	Atingida
F a s e 2	Pla2	104.45	3462837	0.410	0.454	Atingida
	Plb2	17.00	746134	0.490	0.415	Atingida
	Plc2	4.79	205750	0.339	0.443	Atingida
	Pld2	61.27	2085734	0.419	0.357	Atingida
	Ple2	10.22	443435	0.386	0.478	Atingida
	Plf2	2.73	116857	0.398	0.365	Atingida
	Plg2	6.25	269513	0.367	0.432	Atingida
	Plh2	10.33	'449472	0.414	0.452	Atingida
	Pli2	15.88	691202	0.452	0.407	(1) 0.00016; (2) 0.00011
	Plj2	184.38	8148184	0.420	0.352	Atingida
	El 2	20.65	956064	0.384	0.237	(1) 0.13248; (2) 0.13309
Tabela 4.7: Resultados obtidos na simulação de imagens associadas ao padrão 1 com os
parâmetros da tabela 4.6.
Capítulo 4 —
81
					
	Imagem	Tempo de CPU (minutos)	lotai de Trocas	Psr	Tolerância da Função Objetivo (e)
F a s e 1	P2al	25.58	2270600	0.394	Atingida
	P2bl	5.35	476891	0.234	Atingida
	P2cl	1.26	111381	0.131	Atingida
	P2dl	28.19	1854609	0.490	Atingida
	P2el	4.50	396900	0.191	Atingida
	P2fl	1.79	114610	0.212	Atingida
	P2gl	3.67	236749'	0.451	Atingida
	P2hl	6.33	407932	0.422	Atingida
	P2il	0.25	14629	0.158	Atingida
	P2jl	106.19	6840530	0.497	Atingida
	E21	0.24	14778	0.079	Atingida
F a s e 2	P2a2	55.24	3672883	0.566	Atingida
	P2b2	11.92	799011	0.546	Atingida
	P2c2	2.99	196317	0.471	Atingida
	P2d2	39.76	2655670	0.651	Atingida
	P2e2	8.26	546479	0.501	Atingida
	P2Í2	2.43	156065	0.654	Atingida
	P2g2	5.28	354890	0.587	Atingida
	P2h2	7.29	489301	0.483	Atingida
	P2i2	0.80	53853	0.517	Atingida
	P2j2	153.69	10176081	0.623	Atingida
	E22	0.66	32360	0.492	Atingida
Tabela 4.8: Resultados obtidos na simulação de imagens associadas ao padrão 2 com os
parâmetros da tabela 4.6.
Capít ulo 4 —
82
	|	Imagem Padrão 3				
	Imagem	Tempo de CPU (minutos)	lotai de Trocas	Psr	Tolerância da Função Objetivo (e)
F a s e 1	P3a2	47.78	3010525	-0.367	Atingida
	P3b2	35.85	1665619	0.219	Atingida
	P3c2	13.78	598813	0.664	Atingida
	P3d2	27.73	1752574	0.677	Atingida
	P3e2	9.55	600610	-0.193	Atingida
	P3f2	2.37	147621	-0.273	Atingida
	P3g2	5.09	319026	-0.467	Atingida
	P3h2	7.67	482643	-0.012	Atingida
	P3Í2	1.53	94398	0.320	Atingida
	P3J2	109.61	6923392	0.528	Atingida
	E32	1.99	132354	0.589	Atingida
Observações:
(a)	Não foi executada a fase 2 para as imagens associadas a esta imagem padrão.
(b)	Repeti use a simulação com EE na fase 2 com outra semente inicial, obtendo-se psr ~ —0.141.
Tabela 4.9: Resultados obtidos na simulação de imagens associadas ao padrão 3 com os parâmetros da tabela 4.6.
Capítulo 4
83
	5		Imagem Padrão 4		
	i				
	Imagem	Tempo de CPU (minutos)	Total de Trocas	Psr	Tolerância da Função Objetivo (f)
F a s e 1	P4al	44.91	2983434	0.499	Atingida
	P4bl	10,33	681646	0*573	Atingida
	P4cl	2.87	185615	0.500	Atingida
	P4dl	34.89	2321187	0.578	Atingida
	P4el	7*96	526836	0.608	Atingida
	P4fl	1.96	127197	0.437	Atingida
	P4gl	4.80	316544	0*555	Atingida
	P4hl	7*22	477623	0.536	Atingida
	P4il	0.28	17179	0.411	Atingida
	P4jl	139*02	9248687	0.592	Atingida
	E41	0.22	12777	0.458	Atingida
F a s e 2	P4a2	85.53	3387998	0.614	Atingida
	P4b2	17.96	707673	0.629	Atingida
	P4c2	4.67	182917	0.559	Atingida
	P4d2	62*12	2476059	0.566	Atingida
	P4e2	12.97	516032	0*536	Atingida
	P4f2	3,67	122252	0*515	Atingida
	P4g2	8.25	321780	0.516	Atingida
	P4h2	11*79	465335	0*632	Atingida
	P4i2	19.35	1036804	0*486	0*00014
	P4j2	175*64	9670188	0.569	Atingida
	E42	3*70	216000		0.88019
Tabela 4*10: Resultados obtidos na simulação de imagens associadas ao padrão 4 com os
parâmetros da tabela 4*6
84
Imagem Padrão 1					Imagem Padrão 2			
Fase 1		Fase 2			Fase 1		Fase 2	
Imagem	Psr	Imagem	Psr		Imagem	Psr	Imagem	Psr
								
Piel	0.222	Ple2	0.478		P2fl	0.212	P2f2	0.593
Píela	0.262	Ple2a	0.359		P2fla	0.328	P2f2a	0.598
Plelb	0,235	Ple2b	0.357		P2flb	0.138	P2f2b	0.549
Píele	0.208	Ple2c	0.462		P2flc	0.224	P2f2c	0.598
Pleld	0.043	Ple2d	0.433		P2fld	0.273	P2f2d	0.437
Píele	0.183	Ple2e	0.489		P2fle	0.319	P2f2e	0.480
média =	0.192	média =	0.430		média —	0.249	média =	0.480
Tabela 4.11: Resultados obtidos na simulação de imagens associadas ao padrões 1 e 2 com parâmetros de “annealing” fixos e sementes diferentes.
Imagem Padrão 3	
Fase 1	
Imagem	Psr
P3dl	0.674
P3dla	0.281
P3dlb	-0.470
P3dlc	-0.419
P3dld	0.581
P3dle	-0.507
média ~	0.023
Imagem Padrão 4			
Fase 1		Fase 2	
Imagem	Psr	Imagem	Psr
P4el	0.608	P4e2	0.536
P4ela	0.509	P4e2a	0.532
P4elb	0.601	P4e2b	0.606
P4elc	0.382	P4e2c	0.580
P4eld	0.529	P4e2d	0.577
P4ele	0.582	P4e2e	0.620
média =	0.535	média =	0.575
Tabela 4.12: Resultados obtidos na simulação de imagens associadas ao padrões 3 e 4 com parâmetros de “annealing” fixos e sementes diferentes.
— Capítulo 4
85
As imagens correspondentes ao padrão 3 foram abordadas separadamente, uma vez que foram obtidos inclusive coeficientes de correlação com valores negativos. O fato desta imagem padrão não ser estacionária, com uma concentração de valores baixos na parte esquerda e variância mais elevada que as demais, provocou uma menor dependência entre os variogramas e os valores gerados para cada célula, independentemente do parâmetros dos algoritmos utilizados (tabelas 4.9 e 4.12). A figura 4.24 apresenta as imagens P3d] e P3dle29. A imagem padrão 3 é reproduzida para comparação.
Observa-se que o coeficiente de correlação negativo está relacionado à geração da barreira de permeabilidades (valores baixos) na parte direita, ao contrário da imagem padrão. A inclusão de informações relacionadas ao comportamento de produção restringe parcialmente o posicionamento das células com valores menores em localizações mais próximas às da realidade (padrão 3), como é visto no capítulo 5.
Com a análise dos resultados das demais imagens padrão (1, 2 e 4), foi concluido que:
(a)	existe uma tendência de obtenção de maiores coeficientes de correlação (psr) quando o algoritmo de SA se processa com esfriamento mais lento (valores maiores de o), corroborando os resultados obtidos por Pérez (1991) relacionados à apenas uma imagem padrão (figura 3.10). Esta tendência foi mais pronunciada quando somente o histograma e variogramas foram informados (fase 1). Não foi possível especificar um valor mínimo para o fator o válido para todos os casos; além de ser necessário um estudo estatístico exaustivo, a correlação espacial e a quantidade de informações existentes são parâmetros a serem considerados.
Selecionando-se os casos gerados com e ~ 0.0001, foram feitos testes de hipótese com a seguinte hipótese nula Hq:
dt/(oi,o2) = ^(oj)-psr(o2) = 0, o3&gt;o2	(4-7)
onde psr((*i) é o coeficiente de correlação entre a imagem padrão e a imagem simulada utilizando o fator ot.
A hipótese alternativa considerada foi	a2) &gt; 0. Como o número de imagens
geradas foi pequeno30, somente nos testes com a3 — 0.9 e o2 — 0.1 e 0.0 a hipótese nula foi rejeitada com nível de significancia de 5 %;
(b)	o algoritmo de SA com esfriamento lento (a &gt; 0.6) também tende a produzir imagens de melhor qualidade que o algoritmo de EE sob o ponto de vista de psr. Isto pode ser verificado mais nitidamente nas imagens da fasel, quando somente o variograma foi reproduzido. O algoritmo de evolução estocástica apresentou uma limitação séria
29Com valores de psr de 0.674 e -0.507, respectivamente.
30Trés valores usados nos teste da 1~ fase e quatro na 2-.
Capítulo 4
86

39
2 7
24
21
T5
12 sao c»
930
99
Figura 4.24: Exemplos de imagens relacionadas ao padrão 3. A imagem superior possui p5r = 0.674 e a do centro psr ~ —0.507.
Capítulo 4
87
o 600	txporim+ntait • mod®tos
G100¿
0 000 .........,..............-r--T______,_______________
00 100 200
Distaríeis (ceUíasj
300
Figura 4.25: Imagem E12 e seus variogramas. Neste caso o algoritmo de evolução es* tocástica ficou prematuramente preso em um mínimo local, não atingindo a tolerância desejada £.
quando funções objetivo mais complexas foram utilizadas: a dificuldade em suplantar mínimos locais nos problemas de modelagem estocástica apresentados foi mais crítica que na utilização do SA com esfriamento rápido (a &amp;lt;0.1). Na fase 2 com os padrões 1 e 4, o método de EE só foi capaz de gerar imagens com a função objetivo O igual a 0.132 e 0.880, respectivamente. A figura 4.25 mostra a imagem E12 e seu variograma experimental.
Com o exemplo da figura 4.25 pode-se verificar como se comporta a função objetivo O e os parâmetros % e ip quando um mínimo local não é ultrapassado, o que é ilustrado na figura 4.2631.
No exemplo da figura 4.26 verifica-se que o algoritmo de EE ultrapassou (com alguma dificuldade) o primeiro mínimo local (O ~ 0.2), mas ficou preso definitivamente no valor O — 0.132.
(c)	a inclusão de médias e variogramas regionais (na fase 2) provocou uma forte tendência no aumento de psr¿ como era esperado. Na prática, porém, este tipo de informação deve ser implementado com cuidado, para não se restringir artificialmente o domínio experimental de possibilidades, geralmente com a introdução de viés.
(d)	existem indícios de que tolerâncias muito baixas provocam um ligeiro declínio no valor de psr'. embora nada se possa concluir formalmente, verificou-se pelas tabelas 4.7 a 4.10 (fase 1) que isto pode ocorrer, além da necessidade de um esforço computacional excessivo, como ocorreu na fase 1 relacionada ao padrão 1 quando foi usada tolerância e = 10~5. Aparentemente, isto se relaciona a uma maior dificuldade da função objetivo atingir valores cada vez menores (figura 4.22). Estudos mais detalhados devem ser feitos para a obtenção de conclusões seguras. De qualquer forma, não é adequada a adoção de
31Comparar com as figuras 3.7 e 3.8, onde a tolerância e foi atingida sem dificuldade.
Capítulo 4 —
88
Comportamento da Função Objetivo
Imagem El2
Razao de Aceitação e Melhoria Imagem E12
Figura 4.26: Superior: Comportamento da função objetivo para um caso onde um mínimo local não é ultrapassado (imagem E12); Inferior: Comportamento das razões de aceitação e de melhoria para o mesmo exemplo.
— Capítulo 4 —
89
Padrão	Face Produtora	Vazão (m3/dia)	Tempo de Produção (dias)	Compressibilidade Total (kgf/cm2)”1	Viscosidade (cP)
1	esquerda	20	1.10	45 x 10~6	2.
2	direita	100	0.90	100 X 10~6	4.
3 ’	esquerda	40	0.80	20 x 10’6	1.
3	direita	100	0.75	100 x 10“6	1.
4	esquerda	40		05	:	45 x 10~6		L	
4	direita	40	0.80	45 x 10”6	1.
Tabela 4.13: Características das simulações de fluxo monofásico utilizadas para as imagens padrão e imagens modeladas.
valores muito baixos de tolerância.
4.4	Resultados Obtidos — Comportamentos de Produção
Com as seis seções geradas com sementes diferentes em cada fase para cada padrão, foi simulado o comportamento de fluxo monofásico nas faces com a hipótese de vazão constante. A tabela 4.13 apresenta um quadro resumo das características das simulações de fluxo. Os tempos de produção foram escolhidos de forma a manter as simulações no período de fluxo transiente. Foi adotada a largura de 100 m para o reservatório.
Os resultados obtidos são apresentados nas figuras 4.27 a 4.31, juntamente com o comportamento de pressões da imagem padrão correspondente.
A inclusão das informações adicionais adicionais na fase 2 provocou impactos diversos nas imagens relacionadas aos diversos padrões. Com o padrão 1, na primeira fase os comportamentos simulados de fluxo apresentaram um viés para quedas de pressão (Ap(t)) menores, indicando que as imagens PIy(i) tem permeabilidade equivalente maior que a imagem padrão na região adjacente à face esquerda. Já na fase 2 ocorreu o contrário, com um viés para valores de Ap maiores que o real. A figura 4.32 mostra as imagens Pledl (com a maior diferença em relação ao padrão na fase 1) e Ple2e (maior diferença na fase 2). A comparação com o padrão 1 mostra que este possui uma ligeira concentração de valores altos de permeabilidade nas extremidades32, o que não foi reproduzido na fase 2. Na fase 1, com a ausência de regiões de médias impostas (com destaque para a camada horizontal de alta permeabilidade), a tendência foi concentrar valores altos na parte esquerda das imagens, explicando o viés.
Para o padrão 2, como a região de média imposta foi restrita, houve pouca di-
32Esta tendência foi gerada durante a geração da imagem intermediária, em função das condições impostas.
' Capítulo 4
90
Comportamento da Pressão
Padrão 1	- raso 1
Figura 4.27: Comportamentos de pressões simulados das imagens relacionadas ao padrão
1 nas fases 1 e 2.
- Capítulo 4
91
Comportamento da Pressão
Padrao 2	- caso 1
Comportamento da Pressão
Padrao 2	- caso 2
Figura 4.28: Comportamentos de pressões simulados das imagens relacionadas ao padrao
2 nas fases 1 e 2.
92
Comportamento da Pressão - Face 1
Padrso 3	- caso 1
Figura 4.29: Comportamentos de pressões simulados das imagens relacionadas às faces 1
(esquerda) e 2 (direita) do padrão 3 na fase 1.
— Capítulo 4
93
Comportamento da Pressão - Face 1
Pad rao 4	- caso J
Face 1
24.0
22.0
20.0
18.0
6.0
4.0
2.0
0.0
Comportamento da Pressão
Padrao 4	~ caso 2
Figura 4.30: Comportamentos de pressões simulados das imagens relacionadas à face 1
(esquerda) do padrão 4 nas fases 1 e 2.
Capitulo 4
94
Comportamento da Pressão - Face 2
Padrao 4	- caso 1
dP (kgf/cm2)	dP (kgf/cm2)
Comportamento da Pressão - Face 2
Padrao 4	- caso 2
Figura 4.31: Comportamentos de pressões simulados das imagens relacionadas à face 2
(direita) do padrao 4 nas fases 1 e 2.
Capítillo 4 —
96
Figura 4.33: Imagens geradas na primeira e segunda fase com comportamentos de pressões próximos ao real, em comparação com o padrão 2.
ferença entre os comportamentos nas duas fases. O efeito periódico foi considerado na segunda fase, onde se observa que apesar da geração de duas imagens com valores de pressão muito diferentes do padrão, três imagens apresentaram comportamento bastante próximo do desejado. A figura 4.33 apresenta as imagens que tiveram comportamentos de pressões mais próximos do real nas duas fases33.
Para o padrão 3, pelas mesmos motivos abordados na seção 4.3, os comportamentos de fluxo das imagens simuladas com as condições da fase 1 foram em geral muito diferentes da imagem padrão. Devido principalmente à não estación ar iedade deste, foi observado um viés negativo para as respostas da face esquerda e positivo para a face direita.
A implementação das novas informações na fase 2 influenciou mais o comporta
Verifica-se que estas imagens estão lambem entre aquelas coxn maior coeficiente de correlação.
97
— Capítulo 4 —
mento de produção das imagens relacionadas ao padrão 4, originado de características geológicas efetivamente existentes (figuras 4.30 e 4.31); foi verificada uma nítida redução na variância dos erros dos valores de Ap(/) obtidos na simulação de fluxo nas duas faces das imagens modeladas.
5	REPRODUÇÃO DE CARACTERÍSTICAS DE RESERVATÓRIOS - INFORMAÇÕES DE PRODUÇÃO
Uma das limitações principais de modelos estocásticos que foram gerados com o compromisso de reproduzir somente características estatísticas e estruturais, é o fato dos mesmos não honrarem necessariamente o histórico de produção quando este é disponível. O procedimento usual é selecionar entre as imagens geradas aquelas que reproduzem satisfatoriamente o histórico observado. Este processo, entretanto, pode ser tedioso ou até mesmo anti-econômico, se for considerando o fato de serem necessárias até centenas de simulações geoestatísticas e de fluxo para aproveitar alguns modelos apenas. Isto inibe a utilização rotineira de técnicas tradicionais usadas na modelagem estocástica de reservatórios.
Com a introdução de técnicas de otimização combinatorial e a ideia de incluir termos relacionados ao comportamento de fluxo na função objetivo, foi aberta a possibilidade de geração de modelos para os quais os históricos simulados de produção se aproximem mais do histórico real, aumentando o percentual de aproveitamento.
Como foi mencionado no item 2.5, para evitar simulações de fluxo completas em cada passo de algoritmos como o “simulated annealing”, a idéia é utilizar uma função que tenha relação com as informações de produção, que não exija cálculos trabalhosos e seja localmente atualizável. Nesta dissertação funções que tenham estas características foram usadas com o objetivo tentar reproduzir o comportamento de pressões observado em testes de formação com vazão constante, simulados em seções verticais discretizadas em 48 x 24 células.
No item 5.1 são revistas as equações que governam o fluxo linear monofásico em meios porosos e abordado o problema do volume associado à permeabilidades obtidas em testes de formação.
O item 5.2 apresenta as aproximações utilizadas para representar a permeabilidade equivalente obtida de testes de formação com vazão constante. A aproximação proposta por Alabert (e utilizada por Deutsch), a mudança de escala baseada nos limites mínimo e máximo de permeabilidade absoluta deduzidos por Le Loc’h (1989) e Guérillot et al. (1990) são revistas, bem como a forma de se obter empiricamente o volume efetivamente investigado pelo teste de formação.
No item 5.3 são mostrados os procedimentos para a implementação das informações de produção nos casos desta dissertação. Os resultados da calibração descrita no item 5.2 são apresentados, e a inclusão de cada aproximação na função objetivo é separada em fases.
Os resultados obtidos em termos de coeficientes de correlação (per) são apresentados no item 5.4, juntamente com algumas conclusões.
98
Capítulo 5 —
99
A influencia das novas informações implementadas nos comportamentos de produção sào descritas no item 5.5, com as conclusões finais.
5.1	Testes de Formação
Nos reservatórios produtores, a propriedade que influencia mais diretamente o comportamento de produção é a permeabilidade. Sua determinação direta, entretanto, é dispendiosa, sendo necessária a retirada de testemunhos para a realização posterior de medidas petrofísicas em laboratório.
Os testes de formação, mais simples e baratos, são realizados em boa parte dos poços. Neste caso, uma condição de contorno como produção com vazão constante é imposta, e a permeabilidade equivalente de uma determinada região próxima ao poço é estimada a partir do de ser estimada a partir do comportamento de pressões observado.
Para a hipótese de fluxo linear unidimensiomal de um fluido pouco compressível de com viscosidade constante em um meio poroso homogêneo34, a equação que governa o comportamento de pressões é dada por:
d2p&amp;lt;t&gt;pCi dp	....
dx2 K dt	1 '
onde:
K é a permeabilidade absoluta;
ç é a porosidade do meio;
p é a viscosidade do fluido produzido;
Ct é a compressibilidade total do sistema rocha-fluido.
A solução da equação 5.1 para a queda de pressão na face produtora com a condição de contorno de vazão constante na face produtora, no período de fluxo transiente é dada por:
*	_ W I
Ps Kbh\
onde:
Ap/ é a queda de pressão na face produtora; h é a espessura da seção;
^Com porosidade e permeabilidade constantes.
Capítulo 5 -
100
Figura 5.1: Função de peso para diversos instantes em função da distância adimensional.
b é a largura da seção;
q é a vazão na face produtora.
Um gráfico Apw x y/t fornece uma reta de coeficiente angular 0. Isolando o valor de K obtem-se a permeabilidade equivalente da região efetivamente investigada pelo teste:
4pç2
Para utilizar o valor da permeabilidade K de teste como dado condicionante de uma região de uma seção modelada, pode-se empregar aproximações que relacionam a mesma com as permeabilidades individuais das células pertencentes ao volume investigado pelo teste. O maior problema é determinar os limites da região correspondente à permeabilidade do teste. Para fluxo radial, Oliver (1990) relacionou a inclinação da curva de queda de pressão plotada em função do logaritmo do tempo (Apw x logt) com funções de peso que informam a influência de pontos situados a um raio r do poço.
O gráfico da figura 5.1 mostra exemplo de funções de peso para três instantes de tempo adimensional tp35 36 (cada instante corresponde a um ponto do gráfico Apw x logt) em função do raio adimensional r^.
Apesar do gráfico da figura 5.1 representar pesos associados a fluxo radial, curvas semelhantes podem ser obtidas para fluxo linear.
No caso de um teste de formação com a hipótese de fluxo linear, a permeabilidade K é estimada a partir de um ajuste linear entre dois tempos de produção U e ¿2- Este
35 Defini do como íp = Kt/^pCtr^^ onde rw éo raio do poço.
36Definido como rj? = r/rw.
— Capítulo 5 —
101
Peí	-0
C	J—	ÍL	k Xmin	Xmax	X
Figura 5.2: Esquema da função peso atribuída a cada posição x na influência da mesma na permeabilidade obtida em um teste de formação.
processo equivale ao cálculo da média dos valores de d^pj/dy/t neste intervalo. Desta forma, a permeabilidade de teste corresponde à uma região com função peso igual à soma dos valores da função peso para cada instante t{ E	Esta função peso tem a forma
esquematizada na figura 5.2.
Para fins práticos, pode-se aproximar a região correspondente ao teste com os limites x-rnin e	com a hipótese simplificadora dos pontos x, E [immímsj] terem o
mesmo peso. Uma determinada posição x pode ser relacionada ao tempo pela definição clássica de raio de drenagem37:
A ~ constante
Deste modo os limites xmtn e xmaz podem ser obtidos pela equação 5.4. O problema passa a ser determinar o valor da constante A para cada caso. Alabert (1989) propôs calibrações obtidas empiricamente, como é descrito no item 5.2.1.
5.2	Aproximações da Permeabilidade Equivalente
A relação entre valores de permeabilidades individuais de células pertencentes a um determinado volume e a permeabilidade equivalente deste volume (mudança de escala), ainda é um vasto campo a ser pesquisado, existindo algumas aproximações propostas. Os métodos
37O raio de drenagem (equação 5.4) tem diversas definições, dependendo do valor de A utilizado. Para fiuxo linear, pode ser definido como a distância onde a queda de pressão equivale a 1% da queda de pressão no poço. Neste caso, se ~	tem-se xp = 4^/1$, ou seja, A~ 4 (Bird ei aL, 1960 Âpud
Johnson, 1988).
— Capítulo 5 —
102
introduzidos por Alabert (1989) e Le Locdi (1989) tem características que permitem a sua inclusão em algoritmos de otimização combinaiorial, sendo revistos a seguir.
5.2.1	Aproximação pela média potencial
Como foi visto no capítulo 2, Alabert (1989) propôs a média potencial para estimar a permeabilidade equivalente (equação 2.16, pg. 24).
Na equação 2.16, o expoente w está situado entre -1 e 1. Em particular o valor o? = 0 corresponde à média geométrica, u.’ = -1 à média harmônica eu&gt; = 1 à média aritmética. O maior problema desta aproximação é determinar o valor do expoente e o volume V associado à permeabilidade obtida de testes de formação. Alabert propôs a realização de calibrações, onde os valores de V e w são obtidos empiricamente testándose valores em todos os intervalos de ocorrência, possível. No caso particular de modelos bidimensionais horizontais (plano x-y) com fluxo radial, o volume V é representado por uma coroa de raio interno rmin e raio externo rmax, como foi o procedimento de Deutsch (Deutsch &amp;amp; Journel, 1992b; Deutsch, 1992). Nos casos desta dissertação (seções verticais), o volume V é representado pelas distâncias e xmax, associadas aos tempos e tmax do teste de formação pela equação 5.4. Em ambos os casos a constante A define o volume.
A calibração é feita com as imagens geradas com as demais condições impostas na função objetivo38. Em cada imagem o valor de permeabilidade À'j obtido da interpretação de testes de formação simulados são comparados com os valores /v (.4,¿c) calculados para diversos valores de A e u?. O par A, u? ideal é escolhido como aquele que minimiza o desvio médio absoluto normalizado e o erro médio normalizado (Alabert, 1989), definidos como:
ns
DMN(A^)
|K(A,a/),-Kr,|
Kt,
EMN{A,ui) =
Eg, A (.4.Q,-nr. An
Ens L'
Í=1
(5-5)
(5-6)
E
onde ns é o número de imagens simuladas.
Uma vez definido o par A,uj ótimo, a aproximação da equação 2.16 pode ser incluida na função objetivo, para a geração de imagens que considerem indiretamente informações de testes de formação.
38Nesta dissertação, com as seis imagens geradas com sementes diferentes na fase 2.
Capítulo 5
103
5.2.2	Aproximação de Le Loc’h
Le Loc'h (1989) mostrou que em um meio poroso heterogêneo com domínio retangular, a permeabilidade absoluta em uma direção z situa-se entre dois limites. O limite inferior (K^y) é a média aritmética das médias harmônicas das linhas paralelas à direção x; o limite superior (h'sup) é a média harmônica das médias aritméticas das seções perpendiculares à direção x. Se o domínio retangular considerado for discretizado em m x n células, os valores de	Ksup pódem ser expressos pelas equações: -
up —
(5.7)
(5.8)
Guérillot et cã. (1990) propuseram como estimador de Kx a média geométrica entre Kinj e Ksup, ou seja:
sup
(5.9)
Na tese de mestrado de Cruz (1991) utilizou a aproximação da equação 5.9 para
comparar este método de mudança de escala com os demais métodos desenvolvidos. Nesta dissertação a mesma aproximação foi utilizada como termo da função objetivo, sendo
comparada com a aproximação proposta por Alabert. Observa-se que existe o mesmo problema de determinação da constante A, sendo necessária uma calibração prévia para a obtenção da mesma, conforme discutido no item 5.2.1.
Uma desvantagem deste método em relação ao da média potencial é que o mesmo
só é válido para regiões retangulares. Por outro lado a posição relativa das células no interior do volume V é considerada, o que não ocorre na aproximação introduzida por Alabert. Sendo a permeabilidade uma grandeza tensorial, isto é uma característica de extrema importância.
5.3 Inclusão de Informações de Testes — Procedimento
Com as condições da tabela 4.13, foram simulados testes de formação com vazão constante em todas as imagens padrão para a obtenção dos valores observados das permeabilidades equivalentes K?. Os comportamentos de pressões correspondem às curvas já apresentadas nos gráficos Ap x das figuras 4.27 a 4.31.
Com os valores dos coeficientes angulares 0 de retas ajustadas, foram obtidas as permeabilidades equivalentes em cada caso, através da equação 5.3. Nos casos com maior
~ Capjt ulo 5
104
Imagem Padrão	Face	rn: tí (vadias)	(x/dias)	(kgf/cm2/x/dia) •	E't (mD)
I	esquerda	0.14	1.05	13.00	29.1
2	direita	0.10	0.89	16.32	164.8
3	esquerda	0.10	0.40	15.47	41.0
		0.40	0.81	21.52	21.0
	direita	0.10				0774		7708	203.7
4	esquerda	0.10	0.71	17.99	16.3
		0.92	1.26	12,27	31.3
	direita	0.10	0.81	7.91	69.0
Tabela 5.1: Permeabilidades de teste interpretadas das imagens padrão e intervalos de tempo considerados.
heterogeneidade, duas retas foram ajustadas em intervalos de tempo distintos. A tabela
5.1	apresenta os valores dos coeficientes angulares e permeabilidades de teste obtidos39.
A mesma simulação de fluxo foi executada para as imagens obtidas com o algoritmo de SA com sementes diferentes, com as condições impostas na fase 2. A tabela
5.2	mostra os valores mínimos e máximos do coeficiente angular 0 e da permeabilidade de teste Kr de cada conjunto de imagens simuladas associadas às imagens padrão. Os demais valores podem ser analisados qualitativamente pelos comportamentos de pressões nas figuras 4.27 a 4.31.
5.3.1	Calibração para Estimativa do Volume Equivalente e Expoente w
Uma vez obtidos os valores da permeabilidade de teste para as imagens padrão e imagens simuladas na fase 2, foi feita a calibração para a obtenção do par ótimo A, cu utilizado na aproximação de Alabert. Os valores de K(A,u?) foram calculados para lú variando de -1 a 1 com incrementos Au? = 0.1 e A variando de 0.4 a 2.0 com intervalos A A = O.l40, sendo usado um programa desenvolvido para esta finalidade (alabert .for). Foram feitos então mapas dos valores de DMN, EMN e DMN + EMN para cada imagem padrão, mostrados nas figuras 5.3 a 5.10.
39Como se observa pela equação 5.3, os valores de porosidade ($) são necessários para o cálculo de K. Isto foi feito em duas etapas: através de uma estimativa inicial e comparação posterior depois da constante A e a região investigada terem sido determinadas. Não foram constatadas diferenças significativas nos valores de entre as duas etapas.
40O valor de Amax foi escolhido considerando que em termos práticos o fiuxo transiente é válido para Kí/ópCtfi2 &amp;lt;0.25. Isolando o comprimento da seção L e utilizando a equação 5.4 com x(t) = L, obtem-se A = 2.
105
(apítuio 5 -
E.M.N. - Podroo 1
w
D M.N. + E.M.N. - Podrao 1
w
Figura 5.3: Mapas de isodesvios, isoerros e iso(desvios + erros) para as imagens simuladas
na fase 2 associadas ao padrão 1 (face esquerda).
— Capítulo 5
106
E.M.N. - Padrão 2
Figura 5.4: Mapas de isodesvios, isoerros e iso( desvios 4- erros) para as imagens simuladas
na fase 2 associadas ao padrão 2 (face esquerda).
Capítulo 5
107
Figura 5.5: Mapas de isodesvios, isoerros e iso(desvios + erros) para as imagens simuladas
na fase 1 associadas ao padrão 3 (face esquerda (1), intervalo de tempo tl).
Capítulo 5
108
E.M.N. - Pcdroo 3 - Face 1/tl
w
Figura 5.6: Mapas de isodesvios, isoerros e iso(desvios + erros) para as imagens simuladas
na fase 1 associadas ao padrão 3 (face esquerda (1), intervalo de tempo t2).
Capít ulo 5
109
D.M.N. •+ E.M.N. — Padrao 3 - Face 2
Figura 5.7: Mapas de isodesvios, isoerros e iso(desvios + erros) para as imagens simuladas
na fase 1 associadas ao padrão 3 (face direita (2)).
— Capítulo 5
110
Figura 5.8: Mapas de isodesvios, isoerros e iso(desvios + erros) para as imagens simuladas
na fase 2 associadas ao padrão 4 (face esquerda (1), intervalo de tempo tl).
Capítulo 5
111
E.M.N. - Podrao 4 - Poce 1/12
Figura 5.9: Mapas de isodesvios, isoerros e iso(desvios + erros) para as imagens simuladas
na fase 2 associadas ao padrão 4 (face esquerda (1), intervalo de tempo t2).
Capítulo 5
112
D.M.N. 4- E.M.N. - Padrao 4 - Face 2
w
Figura 5.10: Mapas de isodesvios, isoerros e iso(desvios + erros) para as imagens simula-
das na fase 2 associadas ao padrão 4 (face direita (2)).
Capítulo Ó
113
Imagem Padrão	Face	Intervalo de Tempo	(kgf/cm2/\/drã)	(kgf/cm2/x/dTa)	A Tmm (niD)	A 7'mar (mD)
1	esquerda	tl	14.00	18.01	15.9	24.0
2	direita	tl	15.56	30.89	33.2	176.0
	esquerda	tl	7.00	21.22	30.2	164.0
				mm		
3		tz	Ò.J f		 i		■	u-Z.4	
	direita	tl	5.46	39.38	10.0	322.6
4	esquerda	tl	14.35	20.00	13.7	24.2
		t2	10.18	13.81	25.2	43.8
	direita	tl	7.65	8.14	65.5	73.1
Tabela 5.2: Valores mínimos e máximos do coeficiente angular e permeabilidade de teste das imagens simuladas na fase 2. Os intervalos de tempo tl e t2 correspondem ao intervalo anterior e posterior nos casos onde duas retas foram usadas na interpretação.
Com base nos mapas das figuras 5.3 a 5.10 foram adotados pares (A,w) para cada caso, mostrados na tabela 5.3:
A validade da aproximação proposta por Alabert foi verificada plotando-se K( A, w) x K? para as imagens simuladas. As figuras 5.11 e 5.12 mostram estes gráficos, incluindo o ponto referente à imagem padrão em cada caso.
Como se pode observar, as aproximações K(A,u.’) representam bem as permeabilidades equivalentes Kj, com exceção dos padrões 1 e 2, onde a qualidade da aproximação foi apenas regular.
Os pares (A, w) foram usados na inclusão da aproximação pela média potencial na função objetivo (fase 3). Para cada valor de Aot, foram calculados os valores correspondentes de e xmax através da equação 5.4, com os valores de	e	da tabela
5.1.	Como as seções verticais foram discretizadas (48 x 24 células), foi necessário definir valores inteiros x^n e x^^ associados às células contadas a partir da face produtora pelas relações:
= INT (^ + 0.5) + 1	(5.10)
Xcm„ = INT	+ 0.5)	(5.11)
onde:
Ar é a dimensão de uma célula na direção x;
— Capítulo 5 —
114
35 0 Pidw J &gt; K	xK ffr
300 Pxfrac 2 - K apn}xirfí90» x K ttr
250 1
30CL
X.  ■
Tctoí Se poritoi 7
VelMi X rned« 21 694
retenaie 14.530
..y.hwSb 20701.......... varie no» 4292
15 0-
oorreieoeo 0 618
Tcte: d» pontos 7
■ Vfctieveí X. rr»&lt;3# 142 038 ssrtettoi® 2861.576
V.erieyeiY mpde 141,$W. vanenas 5417 893
oorreieoeo 0 674
10■ C ..j , , , p-. : ! f—j—v—i—
100	150	2Q0	25 0	30 0	35 0
Keq TFR
f....;..,,...^-^-^	,	!	|	5	,	.,	,	,	........ |...,.,.r.'
50	100	150	200	250	300
Keq TFR
«
«
*
e
• •
o
0
Figura 5.11: Gráficos de verificação da calibração do par	para as imagens si-
muladas associadas aos padrões 1, 2 e 3. Os pontos relativos às imagens padrão são destacados.
— Capítulo 5
115
3C ç Ptár»e	},U - K spf&amp;amp;xifritd# x K ffr
26 OJ
9-
Teta' d» porKjií ?
Vsíí®v«i X m*d&gt;» 188IC v*rwnd« 10614
y. rrwíí 18 413 rarTeTOa 10&amp;lt;4
torraiBoao 0.95C
100	140	180	22 0	26 0	30 0
Keç TFR
Figura 5.12: Gráficos de verificação da calibraçao do par	para as imagens simu
ladas associadas ao padrão 4. O ponto relativos à imagem padrão é destacado.
— Câpítulo 5
B6
Imagem Padrão	Face	Intervalo de Tempo	Aot,	
1	esquerda	tl	1.60	0.30
2	direita	tl	0.80	0.60
3	esquerda	tl	1.00	-0.40
		t2	1.20	-0.40
	direita	tl		T.Ü5		0.15
4	esquerda	tl	0.60	0.80
		t2	0.60	0.80
	direita	tl	0.90	0.70
Tabela 5.3: Valores ótimos dos pares (A,u;) obtidos empiricamente para a utilização da aproximação da média potencial (equação 2.19).
INT denota a parte inteira de um número.
O termo INT(z + 0.5) corresponde ao inteiro mais próximo do número real x. Como exemplo, para o padrão 1 foi obtido Aoi_ = 1.6, correspondendo a Tmin = 1.9 (•Tcrnin “ 3) O — 14.1 (¿Tcmar 14).
Para a inclusão da aproximação de Le Loc’h na função objetivo (fase 4), também deveria ser feita uma calibração para a obtenção dos valores de Aoí_. Nesta dissertação foram utilizados os mesmos valores de x^n e x^^ calculados para a aproximação da média potencial, com exceção dos casos relacionados à face direita da imagem padrão 4, onde foi verificado que real mente seria necessária uma calibração específica para o método de Le Loc’h. A tabela 5.4 mostra os valores calculados de x^n e x^^.
5.3.2	Definição das Funções Objetivo
Com os valores de x^^^ x^^ e u? obtidos de acordo com o procedimento descrito no item 5.3.1, foram incluidas as aproximações de Alabert (equação 2.16) e de Le Loc’h (equações 5.7 e 5.8) como termos adicionais na função objetivo, mantendo-se todos os termos existentes na fase 2 (capítulo 4). A inclusão destas aproximações correspondem às fases 3 e 4, respectivamente41. Posteriormente, as duas aproximações foram incluidas simultaneamente (fase 5), como tentativa de se gerar imagens com comportamento de pressões cada vez mais próximos do real42. A fase 5 foi executada após ter-se verificado que imagens simuladas onde os valores de Ka (aproximação de Alabert) praticamente
41 Foram utilizados os programas sasim5 e sasim6, respectivamente.
42Nesta fase utilizou-se o programa sasisiT.
Capítulo 5 —
117
—		 Imagem Padrão 				Face	Intervalo de Tempo	(célula)	(célula)
1	esquerda	11	3	14
2	direita	tl	40	47
3	esquerda	tl	2	5
		t2	6	10
	direita	tl	39 ' '	47
4	esquerda	tl	2	6
		t2	10	13
	direita	tl	37 (Alabert)	47 (Alabert)
			31 (Le Loc’h)	46 (Le Loc’h)
Obs.: As células são reportadas em relação à origem na face esquerda.
Tabela 5.4: Células investigadas pelos testes de formação simulados.
coincidiam com o K a da imagem padrão nao garantem que o mesmo ocorrerá para os valores de Kl*
Na última fase (6)43, o método de Le Loc’h foi implementado para fazer a mudança de escala de toda a imagem* atualizando em cada iteração do algoritmo de SA e executando uma simulação de fluxo na escala grosseira. Para isto deveria ter sido feita uma calibração para relacionar os comportamentos de fluxo com a malha original (48 x 24 células) e com a malha grosseira (8 x 3 células). Como o objetivo desta fase foi apenas verificar se com este procedimento seria gerada uma imagem melhor que nas fases anteriores (em termos de reprodução do histórico de produção), foi utilizada como condição a ser reproduzida o comportamento simulado na imagem padrão em escala grosseira.
Em todas estas fases foi usado somente o algoritmo de “annealing”, uma vez que o algoritmo de evolução estocástica apresentou comportamento limitado quando termos adicionais foram incluídos na função objetivo (capítulo 4).
5.3.3	Processamento x Pós-Processamento
Em todas as fases houve a opção de escolha entre dois procedimentos permitidos pelos programas. O primeiro foi aproveitar as imagens geradas na fase 244, que já reproduziam satisfatoriamente o variograma global, as médias e variogramas regionais especificados. Para não destruir as características já reproduzidas na imagem inicial, foi utilizado esfriamento imediato (a — 0). Os pesos A} atribuídos aos termos já reproduzidos foram baixos,
43Utilizou-se o programa sasim4.
44Na fase 1 para a imagem padrão 3.
Capítulo 5 —
118
já que não havia interesse ern reduzir os seus valores. Este procedimento é denominado pós-processamento. O segundo procedimento (processamento) foi ignorar as imagens existentes, iniciando o algoritmo com uma imagem inicial sem correlação espacial.
Nesta dissertação o pós-processamento foi adotado na fase 3 para imagens associadas ao padrão 1 e 2. No caso do padrão 3 é mostrado um exemplo da limitação deste procedimento, ao pós-processar uma imagem da fase 1 com histórico de pressões distante do real.
5.4	Resultados Obtidos — Tempos, Tolerâncias e Coeficientes de Correlação
5.4.1	Fases 3, 4 e 5
Neste item são apresentados os tempos de execução, capacidades em atingir a tolerância e especificada e os coeficientes de correlação psr para as fases 3, 4 e 5. Em cada caso é informado se a geração foi feita através de processamento normal ou pós-processamento.
Os tempos de CPU e número de trocas necessárias são informados para uma das imagens geradas em cada fase na tabela 5.545. Imagens de fases anteriores são reproduzidas para comparação. Nesta tabela a notação (p) indica que a imagem foi obtida por pós-processamento da imagem produzida na fase 2.
As imagens com as mesmas condições da P2f3(p), geradas com outras sementes, ficaram presas em mínimos locais, com o valor da função objetivo ficando ligeiramente acima da tolerância 104 (O — 0.00011).
As tabelas 5.6 a 5.9 apresentam os valores do coeficiente de correlação entre as imagens simuladas e as imagens padrão (psr) nas fases 3, 4 e 5.
Como exemplo de imagens simuladas, a figura 5.13 mostra as imagens P2f3 e P2f5b, geradas nas fases 3 e 5, respectivamente, em conjunto com a imagem padrão 2. Na figura 5.14 são mostradas as imagens P4e3 e P4e4d, em comparação com a imagem padrão 4.
Em termos de coeficiente de correlação (p£r), a melhora mais drástica ocorreu para as imagens associadas ao padrão 3 na fase 4, com a inclusão da permeabilidade aproximada pelo método de Le Loc’h; neste caso todos os valores de pST passaram a ser positivos, devido ao posicionamento da barreira com valores baixos (&amp;lt;0.5) próximo à posição correta. A figura 5.15 mostra exemplos de imagens associadas ao padrão 3 nas fases 3 e 4.
Pós-Processamento
45As demais imagens foram geradas em tempos bastante próximos.
-- CapAu/o Ó
119
Imagem	Tempo de CPU (minutos)	Número de Trocas
Plel	4.09	294997
Ple2	10.22	443435
Ple3(p)	0.37	10558
P2fl	1.37	112920
P2f2	1.95	132465
P2f3	2.67	171448
P2í3(p)	0.75	34347
P2f4	2.29	146717
P2f5	2.90	175282
P3dl	27.73	1752574
P3d3	40.69	2165966
P3d4	39.28	2058403
P3d5	52.59	2502511
P4el	7.96	526836
P4e2	12.97	516032
P4e3	14.50	525911
P4e4	21.72	812775
P4e5*	126.37	3204780
(*) Obs.: A imagem P4e5 ficou presa em um mínimo local, com O = 0.00029. As demais atingiram a tolerância £ especificada.
Tabela 5.5: Tempos e número de trocas necessárias para as imagens atingirem a tolerância especificada.
Capítulo 5 —
120
Imagem Padrão 1	
Fase 3 (p.p.j	
Imagem	Psr
Ple3(p)	0.451
Ple3a(p)	0.366
Ple3b(p)	0.363
Ple3c(p)	0.454
Ple3d(p)	0.407
Ple3e(p)	0.478
média —	0.420
Tabela 5.6: Coeficientes de correlação (psr) obtidos para as imagens associadas à imagem padrão 1 - fase 3 (com pós-processamento).
Imagem Padrão 2							
Fase 3		Fase 3 (p.p)		Fase 4		Fase 5	
Imagem	pBT	Imagem	PsT	Imagem	PtT	Imagem	Psr
P2f3	0.479	P2f3(p)	0.585	P2f4	0.638	P2f5	0.567
P2f3a	0.530	P2f3a(p)	0.609	P2f4a	0.443	P2f5a	0.600
P2f3b	0.562	P2f3b(p)	0.541	P2f4b	0.659	P2f5b	0.700
P2f3c	0.510	P2f3c(p)	0.596	P2f4c	0.596	P2f5c	0.638
P2f3d	0.575	P2f3d(p)	0.443	P2f4d	0.570	P2f5d	0.517
P2f3e	0.448	P2f3e(p)	0.471	P2f4e	0.633	P2f5e	0.577
média =	0.517		média ~	0.541		média = 0.590		média =	0.600	
Tabela 5.7: Coeficientes de correlação (psr) obtidos para as imagens associadas à imagem
padrão 2 - fases 3 (processamento normal), 3 (pós-processamento), 4 e 5.
Capítulo 5 —
121
Imagem Padrão 3					
Fase 3		Fase 4		Fase 5	
Imagem	PiST	Imagem	P ST	Imagem	PST
P3d3	-0.409		P3d4		0.638	P3d5	0.567
P3d3a	-0.430	P3d4a	0.443	P3d5a	0.600
P3d3b	-0.474	P3d4b	0.659	P3d5b	0.700
P3d3c	-0.402	P3d4c	0.596	P3d5c	0.638
P3d3d	0.312	P3d4d	0.570	P3d5d	0.517
P3d3e	0.227	P3d4e	0.633	P3d5e	0.577
média ~	-0.196		média = 0.463		média =	-0.018	
Tabela 5.8: Coeficientes de correlação (psr) obtidos para as imagens associadas à imagem padrão 3 - fases 3, 4 e 5.
Imagem Padrão 4					
Fase 3		Fase 4		Fase 5	
Imagem	PST	Imagem	PST	Imagem	PsT
P4e3	0.603	P4e4	0.574	P4e5	0.520
P4e3a	0.510	P4e4a	0.543	P4e5a	0.512
P4e3b	0.568	P4e4b	0.608	P4e5b	0.592
P4e3c	0.549	P4e4c	0.581	P4e5c	0.575
P4e3d	0.599	P4e4d	0.622	P4e5d	0.579
P4e3e	0.614	P4e4e	0.551	P4e5e	0.598
média ~ 0.574		média = 0.580		média = 0.563	
Obs.: As imagens da fase 5 não atingiram a tolerância e, ficando, presas em mínimos locais.
Tabela 5.9: Coeficientes de correlação (psr) obtidos para as imagens associadas à imagem
padrão 4 - fases 3, 4 e 5.
Capítulo 5 —
122
Figura 5.13: Imagens geradas nas fases 3 e 5, e comparação com o padrão 2.
- Capítulo 5
123
Figura 5.14: Imagens geradas nas fases 3e4,e comparação com o padrão 4.
Capítulo 5
124
Figura 5.15: Imagens geradas nas fases 3 e 4, comparando com o padrão 3. Na fase 4 foi verificada melhoria substancial nos valores do coeficiente de correlação (psr).
Uma questão importante é saber se o pós-processamento com esfriamento rápido, que exige tempos de execução significativamente menores em relação ao processamento normal46 mantem a qualidade em comparação a este último. No caso das imagens associadas ao padrão 2 na fase 3, foi verificado que a inclusão da aproximação de Alabert com processamento normal provocou um decréscimo na média de psr, o que praticamente nao ocorreu com o pós-processamento.
Para verificar o potencial e conveniência do pós-processamento, a imagem P3dlb, gerada na fase 1 com a barreira de permeabilidade posicionada na parte direita da seção e com coeficiente de correlação negativo (—0.470) foi pós-processada com a inclusão da aproximação de Le Loc’h, sendo usado o — 0. O resultado foi a geração de uma imagem (P3d4b(p)) que manteve a posição da barreira no rneesino local, e com contrastes bruscos de valores extremos, o que não ocorreu no processamento normal. Esta imagem, gerada em 0.47 minutos (23311 trocas), é mostrada na figura 5.16. O coeficiente de correlação praticamente não foi alterado (pST — —0.466), atestando a baixa qualidade sob este aspecto.
Com os resultados apresentados nas fases 3, 4 e 5, as principais conclusões considerando os critérios deste item são:
(a)	A inclusão de aproximações K para representar a permeabilidade equivalente interpretada de testes de formação tende a aumentar o coeficiente de correlação metodologia apropriada for utilizada;
se a
46Desde que o processo não fique preso em um mínimo local.
Capítulo ô —
125
Figura 5.16: Imagem associada ao padrão 3 gerada com as condições da fase 4 através de pós-processamento. Apesar de reproduzir as condições impostas, a baixa qualidade da imagem inicial foi mantida.
(b)	Pelo menos nos casos com menores anisotropias geométricas (padrões 2 e 3), a aproximação de Le Loc’h apresentou nítida vantagem em relação à aproximação de Alabert, provavelmente pelo fato desta última não considerar a posição relativa das células no interior do volume considerado, o que trouxe maiores limitações nos casos onde não existe grande continuidade das camadas;
(c)	O procedimento de pós-processamento não deve ser utilizado se a imagem inicial nao for de boa qualidade, o que tenderá a prevalecer na imagem pós-processada. A reprodução das características da função objetivo não garante a melhoria de aspectos nao considerados diretamente;
(d)	Em geral, a inclusão simultânea das duas aproximações de permeabilidade não foi vantajosa, sendo preferível utilizar a do método de Le Loc’h individualmente.
5.4.2	Fase 6
A fase 6 foi executada somente para a imagem padrão 2. Com a utilização do método de Le Loc’h foi gerada uma imagem com malha grosseira (8x3 células) a partir da imagem padrão, sendo simulado um teste com a mesma escala. 0 objetivo proposto foi honrar as condições da fase 2 e o histórico de pressões simulado na malha de 24 células, através da atualização da mudança de escala e simulação de fluxo completa em cada iteração do algoritmo de SA.
Nesta fase foi gerada inicialmente a imagem P2Í6, com fator de esfriamento a = 0.1. Devido ao insucesso em atingir a tolerância £, foram feitas tentativas com esfriamento mais lento e alteração no peso atribuido ao termo referente ao histórico de produção. Os
Capítulo 5 —■
126
Imagem	Fator O	'Tempo (minutos)	Número de Trocas	Objetivo Geral	Objetivo (Histórico)	Peso do Histórico
P2f6	0.1	1395.70	431978	0.570	0.157	0.050
P216	0.3	1913.94	503742	0.603	0.122	0.050
P2m6	0.8	5062.80	1595842	0.361	0.002	0.050
P2n6	0.8	6929.59	1601770	0.359	0.345	0.002
Observações:
(1)	Foram utilizados = 100 ciclos e Ma ~ 10 ciclos.
(2)	Em todos os casos foi atingida a taxa de aceitação mínima %min = 0.001.
Tabela 5.10: Resumo dos resultados obtidos nas simulações da fase 6.
resultados são mostrados na tabela 5.10.
Como se pode verificar, este procedimento foi totalmente mal sucedido e ineficaz. O algoritmo ficou preso em mínimos locais muito distantes de valores aceitáveis, mesmo nos casos de esfriamento lento, onde o tempo de execução chegou a 4.8 dias (imagem P2n6). A figura 5.17 mostra a imagem P2n6 e seu variograma, em comparação com o modelo (variograma da imagem padrão 2). Observa-se que a imagem e os variogramas experimentais foram pouco alterados em relação à imagem inicial. Neste caso, foi obtido psr — 0.156.
5.5	Resultados Obtidos - Comportamentos de Produção
Neste item são reportados os comportamentos de pressões dos testes simulados nas imagens geradas nas fases 3, 4 e 5, com as propriedades da tabela 4.13. As imagens geradas na fase 6 foram desprezadas, em virtude de não reproduzirem as demais condições desejadas.
Os resultados obtidos são mostrados nas figuras 5.18 a 5.26, em comparação com o comportamento da imagem padrão correspondente.
Analisando-se os comportamentos de produção das fases 3, 4 e 5 e comparando-se com os das fases 1 e 2, foi concluido que:
(a)	A inclusão de informações que tem boa correlação com o histórico de produção observado (padrão) na função objetivo induziu à geração de imagens com comportamento de pressões mais próximos do real, em média;
(b)	Nos casos de menor anisotropia, como as imagens associadas ao padrão 3, a aproximação de Le Loc’h também foi superior à de Alabert sob este aspecto. Esta última provocou a geração de imagens com comportamento viciado para a face 1 (esquerda), já que a concentração de valores baixos nas proximidades desta face não foi reproduzida na fase 3;
Capítulo 5
127
Figura 5.17: Imagem P2n6, gerada com os procedimentos da fase 6. Neste caso a função objetivo ficou prematuramente presa em um mínimo local.
Capítulo 5
128
Comportamento da Pressão
Comportamento da Pressão
Figura 5.18: Comportamentos de pressões simulados das imagens relacionadas aos padrões
1 e 2 na fase 3 (com pós*processamento).
Comportamento da Pressão
Padrao 2	— caso 3
— Cã pitu lo 5 .
129
dP (kgf/cmz)	dP (kgf/cm2)
Comportamento da Pressão
Padrao 2	- oaso 4
Figura 5.19: Comportamentos de pressões simulados das imagens relacionadas ao padrão
2 nas fases 3 e 4.
Capítulo 5 —
130
Comportamento da Pressão
Padrao 2	- caso 5
Figura 5.20: Comportamentos de pressões simulados das imagens relacionadas ao padrão 2 na fase 5.
(c)	Com a utilização de pós-processamento (padrões 1 e 2), os comportamentos de pressões se aproximaram do comportamento real em relação às imagens geradas nas fases 1 ou 2. Aquelas cujo comportamento na fase 2 ficou muito diferente do real permaneceram distantes, apesar da melhora (comparar por exemplo as fases 2 e 3 do padrão 2, nas páginas 91 e 129). Desta forma o pós-processamento só foi vantajoso nos casos onde o histórico de pressões já tinha um comportamento próximo ao do padrão na fase 2;
(d)	A exemplo do coeficiente de correlação (pír), não foi verificada nenhuma vantagem em se utilizar as duas aproximações de permeabilidade absoluta em conjunto;
(e)	O êxito da inclusão das aproximações em gerar imagens com comportamentos de pressões próximos do real foi maior nos casos em que o comportamento observado (imagem padrão) se aproximou de uma reta (ex.: padrão 3, face 2). Outro fator que influenciou foi a qualidade das calibrações (figuras 5.11 e 5.12).
Capítulo 5
131
Comportamento da Pressão - Face 1
Padrao 3	~ caso 3
16.0 -j-
Comportamento da Pressão - Face 2
Padrao 3	- caso 3
Figura 5.21: Comportamentos de pressões simulados das imagens relacionadas ao padrão
3 (faces esquerda (1) e direita(2)) na fase 3.
Capítulo 5
132
Comportamento da Pressão - Face 1
Padrao 3	- caso 4
Comportamento da Pressão — Face 2
Padrao 3	- caso 4
Figura 5.22: Comportamentos de pressões simulados das imagens relacionadas ao padrão
3 (faces esquerda (1) e direita(2)) na fase 4.
— Capítulo 5 —
133
Comportamento da Pressão
Padrao 3	- caso 5
Comportamento da Pressão ~ Face 2
Figura 5.23: Comportamentos de pressões simulados das imagens relacionadas ao padrão
3 (faces esquerda (1) e direita(2)) na fase 5.
Capítulo 5 —
134
Comportamento da Pressão - Face 1
Padrao 4	- caso 3
Comportamento da Pressão — Face 2
Padrao 4	— caso 3
dP (kgf/cm8)	dP (kgf/cm8)
0.0	0.2	0.4	0.6	0.8	1.0
tí/£(dias)1/2
Figura 5.24: Comportamentos de pressões simulados das imagens relacionadas ao padrao
4 (faces esquerda (1) e direita(2)) na fase 3.
Capítulo 5 —
135
Comportamento da Pressão - Face 1
Padrao 4	- caso 4
Figura 5.25: Comportamentos de pressões simulados das imagens relacionadas ao padrão
4 (faces esquerda (1) e direita(2)) na fase 4.
Capítulo 5
136
Comportamento da Pressão - Face 1
Padrao 4	- caso 5
dP (kgf/cm2)	dP (kgf/cm2)
Comportamento da Pressão - Face 2
Padrao 4	— caso 5
Figura 5.26: Comportamentos de pressões simulados das imagens relacionadas ao padrao
4 (faces esquerda (1) e direita(2)) na fase 5.
6	CONCLUSÕES E RECOMENDAÇÕES
6.1 Conclusões
Pelo que foi observado nesta dissertação, pode-se concluir que:
(1)	Algoritmos de otimização combinatoria! como o “simulated annealing” e evolução estocástica podem ser utilizados para gerar modelos estocásticos de reservatórios, reproduzindo características que possam ser quantificadas. Para os casos apresentados nesta dissertação com estruturas espaciais diversas, os resultados confirmaram o potencial do “annealing” apresentados em trabalhos anteriores (Pérez, 1991; Deutsch &amp;amp; Journel, 1992b; Deutsch, 1992);
(2)	O algoritmo de evolução estocástica é superior ao “simulated annealing” convencional na geração de imagens com número grande de células (da ordem de centenas de milhares) e função objetivo simples. Neste caso o SA ficou preso prematuramente em mínimos locais, o que não ocorreu com o algoritmo de EE;
(3)	O algoritmo de “simulated annealing” é superior ao algoritmo de evolução estocástica47 na geração de imagens com funções objetivo complexas (com vários termos). Neste caso a EE apresentou limitações sérias, ficando presa prematuramente em mínimos locais ou produzindo imagens de baixa qualidade com o critério de coeficiente de correlação entre as imagens simulada e real (par);
(4)	A inclusão de informações adicionais na função objetivo, além do histograma e variograma, provoca a tendência de geração de imagens mais próximas à imagem verdadeira, com os critérios de coeficiente de correlação psr e comportamento de produção. A exemplo das imagens simuladas por Deutsch (1992) para reproduzir características do arenito Berea, isto se confirmou para os exemplos desta dissertação, com intensidade dependendo das características de cada padrão;
(5)	A utilização de esfriamento lento (a &gt; 0.6) no algoritmo de “simulated anne-aling” provoca aumento substancial no tempo de execução, o que é recompensado com a geração de imagens de melhor qualidade, confirmando os resultados apresentados por Pérez (1991) para uma imagem padrão particular. Nesta dissertação foi verificado que esta tendência é mais nítida quando somente o variograma é reproduzido (fase 1);
(6)	Os resultados comparativos a respeito da variância de características de imagens geradas com SA e SSG obtidos por Deutsch (1992) não devem ser generalizados. Deutsch obteve uma dispersão maior nos valores de óleo recuperável em um processo de deslocamento imiscível para as imagens geradas com o algoritmo de SA, em relação às geradas com SSG. Entretanto, este autor utilizou apenas esfriamento rápido (a — 0.1), que tende a gerar imagens com menores correlações (psr) que com esfriamentos mais lentos;
47Âo menos com as rotinas desenvolvidas nesta dissertação.
137
Capítulo 6 —-
138
(7)	Em seções verticais (com fluxo linear), a aproximação proposta por Le Loc’h e Guérillot et al. apresentou resultados melhores para representar a permeabilidade e-quivalente de testes de formação do que a aproximação da média potencial, proposta por Alabcrt. A inclusão da mesma na função objetivo gerou imagens com melhor reprodução do histórico de pressões observado;
(8)	A utilização de tolerâncias da função objetivo (e) muito pequenas pode ser contraproducente, não melhorando a qualidade das imagens geradas e aumentando o tempo de execução dos algoritmos. Além de não ter sentido a adoção de valores de e muito baixos, pela existência dos erros amostrais, existe a suspeita de que tal procedimento pode piorar a qualidade.
(9)	O procedimento de pós-processamento só deve ser executado se as imagens iniciais já tiverem as características desejadas (como comportamento de produção) próximos da realidade. Caso contrário, nao haverá melhora significativa com a introdução de informações adicionais indiretas48 na função objetivo.
(10)	A execução de simulações de fluxo em cada iteração do algoritmo de “simulai, ed annealing” é totalmente ineficaz, mesmo se forem executadas em malha grosseira, após mudança de escala. Além de exigir tempos de CPU extremamente elevados (o que já era previsto), este último procedimento levou o algoritmo a ficar prematuramente preso em mínimos locais, nao reproduzindo as características desejadas mesmo em problemas bidimensionais.
6.2	Recomendações e Sugestões
(1)	Algoritmos híbridos, com características dos algoritmos de SA e EE podem ser desenvolvidos, visando aproveitar as melhores propriedades de cada um (maior capacidade da EE em problemas de grande dimensão e do SA com funções objetivo complexas).
(2)	A comparação entre algoritmos de OC com parâmetros variáveis e os métodos tradicionais da geoestatística (SSG, “turning bands”, etc.) no aspecto do domínio de possibilidades das imagens geradas por cada técnica merece estudo mais profundo. A técnica que melhor aproveitar a mesma quantidade de informação fornecida leva vantagem sob este aspecto, por gerar imagens com menor variância, desde que não sejam viciadas.
(3)	A comparação entre a influência das aproximações com os métodos propostos por A laber t e Le Loc’h deve ser feita também para seções horizontais (plano x - y).
(4)	A influência da velocidade de esfriamento nos comportamentos de fluxo ainda não deve também ser estudada, para se definir com maior clareza critérios para determiná-la.
(5)	Mais importante que a investigação mais detalhada e exaustiva da influência
4SComo as aproximações propostas por Alabert e Le Lorih.
Capítulo 6
139
dos diversos parámetros das técnicas de OC é a investigação da própria aplicação na caracterização de reservatórios em escala de campo. Aplicações em reservatórios reais e testes mais detalhados baseados em afloramentos, com a geração de imagens tridimensionais e o procedimento de modelagem em duas fases (simulação de fácies na primeira e variáveis contínuas como porosidade e permeabilidade na segunda) devem ser estudadas. A limitação do SA convencional para um número grande de células é preocupante para a implementação da aplicação rotineira da técnica.
(6)	A influência dos erros amostrais, pelo fato das características “modelo” a serem reproduzidas terem sido obtidas de amostras da população (de todo o reservatório), devem ser analisadas separadamente. Nesta dissertação, como nas teses de Pérez (1991) e Deutsch (1992), isto nao foi considerado. Este problema, que se estende a qualquer método de simulação estocástica de reservatórios merece estudo detalhado, já que faz parte de qualquer aplicação com reservatórios reais.
§§§
— Anexo A —
140
A Simulação Sequencial Gaussiana
Neste anexo é apresentada unia breve revisão dos procedimentos do método de simulação sequencial gaussiana, que íoi utilizado para gerar a imagem padrão 3. Este método usa em um dos passos uma krigagem, cujos conceitos básicos são descritos inicialmente. Abordagens e considerações mais detalhadas podem ser encontradas em textos básicos de geoestatística (Journel &amp;amp; Huijbregts, 1978; Journel, 1989: Isaaks &amp;amp; Srivastava, 1989).
A.l Krigagem
A krigagem é um método de estimativa do valor de uma variável em um ponto z(x) ou região qualquer, conhecendo-se alguns valores vizinhos	Sua carac-
terística principal é corresponder à estimativa que minimiza a variância do erro (variância de estimação). Para sua utilização, é feita a priori a hipótese de estacionariedade (a esperança do valor da variável estimada é constante em toda a região pesquisada) e é conhecida a relação espacial dos valores, representada pelo covariograma C(h)49.
Em sua forma mais simples (krigagem simples), a técnica é descrita pelo seguinte estimador linear puntual (Deutsch &amp;amp; Journel, 1992a):
zksW = ¿ A,(x)Z(x.) +
Í“1
1 -¿A.(x)
i‘=I
(A.l)
m
Os pesos A,- são determinados de forma a minimizar a variância do erro, o que resulta no seguinte sistema de equações:
" Xt) =&amp;lt;?(* “ Xí), V? = 1,..., n.
(A.2)
A variância de estimação minimizada, conhecida como “variância de krigagem”, é dada por:
°KS = C(0) - ¿ A,(x)C(x - x.) &gt; 0
1=1
(A.3)
onde C(0) corresponde à variância a priori da variável Z(x) em toda a região de interesse.
No caso da média m não ser conhecida, ou não existir pontos em número suficinte para estimá-la, a krigagem ordinária é utilizada. Neste caso, impõe-se a condição da
49Se o variograma estabilizar em um patamar de valor C(0), é válida a relação: C(h) - C(0) - y(h).
Anexo A —
141
soma dos pesos À, ser igual a 1, para a estimativa de z(x) não ser viciada. 0 estimador da krigagem ordinária é dado por:
^•0(x) = ¿Á,(x)Z(x.)
í-1
com os pesos A, calculados resolvendo-se o seguinte sistema de equações:
E"=i Aj(x)C(Xj - x.) + p(x) = C(x-x,). i =1,...,n
A;(X) = 1
(A.5)
onde p(x) é o parâmetro de Lagrange associado à condição n?=i -Ç(x) = 1.
Se a variável Z(x) possuir distribuição normal, pode-se demonstrar que a estimativa da krigagem (equação A.l) e a variância da krigagem (equação A.3) correspondem à média e à variância da função de distribuição acumulada de probabilidades “a posteriori”. Esta função é definida como a distribuição acumulada de probabilidade do valor da variável Z na posição x quando os pontos vizinhos z(xí),í =	são considerados.
Neste caso a notação “condicional a (n)” é utilizada (Deutsch &amp;amp; Journel, 1992a):
F(x; z | (n)) — Prob{Z(x &amp;lt;z | (n)}
(A.6)
A.2 Simulação Sequencial Gaussiana
A técnica conhecida como Simulação Sequencial Gaussiana (SSG) tem como objetivo gerar realizações de uma variável aleatória z(x) contínua e gaussiana, modelada por uma função aleatória Z(x) estacionária. Cada variável z(x) é simulada sequencialmente, de acordo com a sua função de distribuição acumulada “a posteriori”.
Como foi visto, esta função em uma determinada posição x é obtida do sistema de krigagem simples (equação A.2). O procedimento básico é descrito a seguir (Deutsch &amp;amp; Journel, 1992a):
1.	Determina-se a distribuição cumulativa de probabilidade F%(z) da variável a ser simulada;
2.	Executa-se uma transformação direta na distribuição de probabilidades, com a finalidade de se obter uma nova variável E(x) com distribuição de probabilidade normal reduzida, conforme o esquema da figura A.l;
3.	Executa-se a simulação sequencial gaussiana propriamente dita, partindo-se dos variogramas da variável K(x) e dos pontos conhecidos (condicionantes);
Anexo A —
142
(a)	Define-se uma sequência aleatória de nós (posições) a serem visitados. Em cada posição, seleciona-se um número pré-especificado de pontos vizinhos, incluindo os pontos conhecidos e aqueles previamente simulados;
(b)	Através da krigagem simples e utilizando o variograma da variável transformada E(x), determina-se a média e a variância da dcpp. Estes dois parâmetros são suficientes para a determinação de toda a dcpp, que é gaussiana por construção;
(c)	Com base na distribuição anterior, simula-se um valor j/(x), utilizando-se um gerador de números pseudo-aleatórios. A figura A.2 esquematiza o processo de simulação da realização £/(x) da variável E(x), após a geração do número aleatório a (a E (0,1));
(d)	Acrescenta-se o valor simulado j/(x) aos valores previamente simulados;
4.	Efetua-se a tran for mação inversa, obten do-se os valores correspondentes ^(x) da variável original Z(x) para cada valor da variável normalizada E(x).
Anexo A
143
Figura A.l: Representação gráfica da transformação de uma variável com distribuição cumulativa de probabilidades Fz para outra com distribuição Fy e vice-versa.
Figura A.2: Representação gráfica do processo de geração de uma realização Z{ de uma variável aleatória com distribuição de probabilidade Fz-
- Anexo B
144
B Estimativa da Temperatura Inicial no Algoritmo de “Simulated Annealing”.
Nos programas desenvolvidos nesta dissertação foi utilizada uma rotina desenvolvida por Pérez (1991) que permite estimar o valor da temperatura inicial T° que corresponde a uma determinada razão de aceitação inicial \in,. 0 método utilizado foi proposto por Aarts e Korst (1989:60) e é descrito a seguir:
(1)	Gere Min. iterações (como trocas entre células) e compute o valor da função objetivo O^n para cada uma;
(2)	Calcule os valores de mudança na função objetivo A(9'r. =&amp;lt;9[n — (9o, onde (9o é o valor inicial da função objetivo (1 se tiver sido normalizada), para r = 1,.,.,
(3)	Calcule o valor médio das mudanças positivas da função objetivo (A(9*_);
(4)	Calcule o valor da temperatura inicial T° pela equação:
AO*.
(B.l)
onde:
é o valor médio dos valores das mudanças positivas na função objetivo;
Xin, é a razão de aceitação inicial desejada;
mi é o número de perturbações iniciais que resultaram em valores de mudança A(9[n negativos;
é o número de perturbações iniciais que resultaram em valores de mudança A(9-n positivos.
Escolhendo-se nos programas o valor de suficientemente grande (Af,-n &gt; 0.5 ciclos), o valor de T° estimado pela equação B.l gera ytn experimental bastante próximo do valor desejado. Se o valor de \in for muito próximo de 1 (ex.:	= 0.999), é
conveniente adotar um valor grande de Min,.
Anexo C
145
C Atualização Local do Variograma
Na implantação da função variograma ou qualquer outra função como componente da função objetivo em algoritmos de otimização combinatorial, é fundamental que se proceda a uma atualização da mesma em cada iteração do algoritmo, sem a necessidade de recalculá-la novamente, o que aumentaria drasticamente o tempo de CPU.
...... Para ilustrar o procedimento de atualização, a seguir é mostrado como isto é feito para um ponto 7(h) do variograma (Deutsch, 1992:69).
Após uma determinada perturbação, cada célula localizada em uma posição x, envolvida provoca uma alteração no variograma, que passa de 7(h) para 7'(h)ncíU0. Desta forma, só é necessário atualizar os termos em que a célula localizada na posição x( aparece, considerando as células situadas à distância h da mesma, nos dois sentidos da direção considerada. Se com a perturbação o valor da célula passou de ^(x:) para Ufx^, a atualização para um determinado valor de 7(h) é dada por:
7(h)novo = 7(h)	-[¿(x,) - z(xí + h)]2
-[2(x,- - h) - a(x,)]2 +[z'(Xt - z(x» + h)]2 +[z(x,-h)-?(x,)]2	(C.l)
Este procedimento foi estendido para outras funções incluidas nesta dissertação, como as aproximações de permeabilidade equivalente obtidas de testes de formação.
D Arquivos de Entrada dos Programas
Os arquivos dos programas utilizados nesta dissertação tem formato semelhante ao do programa original sasim, elaborado per Deutsch e parte do GSL1B, que contem um conjunto de programas desenvolvidos na Universidade de Stanford (EUA). Detalhes a respeito de informações de entrada podem ser encontradas no manual (Deutsch &amp;amp; Journel, 1992a). Nas páginas seguintes deste anexo são apresentados exemplos de arquivos de entrada de programas de “simulated annealing” e evolução estocástica. Como o programa de SA sasim7 contém o maior número de informações de entrada, o seu arquivo de entrada é reproduzido. No caso da EE, é apresentado um exemplo do arquivo de entrada do programa sasim3. Nota-se uma grande semelhança entre os arquivos.
146
Anexo 12 —
147
Simulacao com Simulated Annealing
*****«*»*»**#************»******:***
INICIO DOS PARAMETROS:
/home/geo01/camara/S2D/pad, con 12	0	3
-2.1
0
1
. JhomeZgeoO 1 /camara/S2D/pad. Ikh
1 0
-2.1	5.0
1 0.0
1 0.0
sa.out
sa.var
sa.varr
sa.med
sa.keq
3	20000
sa.dbg
sa.res
1
0.1 0.60
1
7311
48	5.0
24	0.5
1	0.5
47.	24.
0
0.99
0.001
2
16.31
31.34
2 6
2 6
0.80
0.70
0.075
0.075
/home/geoO 1/c amar a/S2D/pad. var
0.700
2
10 0
0 10
1
0.050
14	1	24	1	1
/home/geo01/camara/S2D/pad. varr 1
0 10
1
0.100
1	48	23	24	1	1
0.4330
345600	11520	3	0.00010
10.0
1.0
1.0
1.
3.
\Taxa de
\Dados condicionantes (se houver) \colunas: x,y,z,vr \valor mínimo aceito
\0~Nao paramétrica; l=Gaussiana \0-gera inicio;l=le de arquivo \Distribuicao nao paramétrica \coiunas: variavel, peso
\valor minimo e máximo dos dados \0pcao e parametro - cauda inferior \Qpcao e parametro ~ cauda superior \Saida da simulacao \Saida do variograma global \Saida dos variogramas regionais \Saida das medias regionais \Saida da permeabilidade equivalente \Nivel de debug, Intervalo reportado \Saida para debug \Arquivo de Resumo
\Plano de Annealing? (0=automatico) \Plano Manual: t0,lambda,ka,k,e,0min \Funcao Objetivo: 1 ou 2 partes \Semente do gerador aleatorio XnXjXmnjXsiz \ny,ymn,ysiz Xnzjzmn^zsiz
\raiox,raioy,raioz
\0 = calcula Tin.; outro = nao calcula Aceít. inic.» Num. de ciclos para estimar Tin.
\Taxa de Aceitacao minima \Numero de testes de formacao \Perm. de teste - região 1 \Perm. de teste - região 2 \Regiao de influencia (Le Loc’h) 1 \Regiao de influencia (Alabert) 1 Walor do expoente w -reg.l (calibrado) \Valor do expoente w -reg.2 (calibrado) \Peso das perm. equiv. 1 (Le Loc,h) \Peso das perm. equiv. 1 (Alabert) \Variograma padrao global \Peso do variograma global \ndir
\ixl(i),iyl(i)sizl(i) \ixl(i),iyl(i),izl(i) \Total de regiões - Variogramas \Peso do Variograma da região 1 \Regiao 1:xminíxmax,ymin,ymax,zmin,zmax \Variograma padrao das regiões \ndir(regiao 1)
\ixr(nr,i),iyr(nr,i),izr(nr,i) \Total de regiões - Medias \Peso da Media na região 1 \Regiao 1: xminjxmax^yminjymax^zminjzmax \Regiao 1: Media
Figura D.l: Exemplo de arquivo de entrada para o programa sasim7.
— .Anexo D —
148

INICIO DOS PARÂMETROS:
/home/geo01/camara/S2D/pad. con
...1.2...	0	3
-2.1
0
1 /home/geo01/camara/S2D/pad. Ikh 1 O
-2.1	5.0
1 0.0
1 0.0
ee.out
ee.var
ee.med
3	20000
ee.dbg
ee.res
0.0001 0.2 100 10
0.001	
1 7311	
48	5.0
24	0.5
1	0.5
47.	24
10.0
1.0
1.0
/home/geo01/camara/S2D/pad. var
0.600
2
10 0
0 10
1
0.100
14	1	24	1	1
/home/geo01/camara/S2D/pad. varr
1
0 10
2
0.150
0.150
1	48	23	24	1	1
0.4330				
1	48	6	10	1	1
1.8750
\Dados condicionantes (se houver) \colunas: x,y,z,vr
\valor mínimo aceito
\0-Nao paramétrica; l=Gaussiana \0=gera inicio;1=1e de arquivo \Distribuicao nao paramétrica \colunas: variavel, peso
\valor minimo e máximo dos dados \0pcao e parametro - cauda inferior \0pcao e parametro - cauda superior \Saida da simulacao
\Saida do variograma global
\Saida das medias regionais
\Nivel de debug, Intervalo reportado \Saida para debug
\Arquivo de Resumo
\Plano de EE: p0,dp,R,Gama
\Tolerancia da funcao objetivo \Fimcao Objetivo: 1 ou 2 partes \Semente do gerador aleatorio \nx, mm, xsiz \nyjymn^ysiz
Xnz^zmn^zsiz
\raioxtraioy,raioz
Wariograma padrao global
\Peso do variograma global
\ndir
\ixl(i) s iyl(i) íizKi)
\ixl(i),iyl(i)#izl(i)
\Total de regiões - Variogramas \Peso do Variograma da região 1 \Regiao 1 rxmiiijxmax ,ymin,ymax,zmin jZmax \Variograma padrao das regiões \ndir(regiao 1)
\ixr(nr ,i) ,iyr(nr,i) ,izr(nr,i)
\Total de regiões - Medias \Peso da Media na região 1 \Peso da Media na região 2
\Regiao 1: xminjXmaXjyminjymaXjZminjZmax \Regiao 1: Media
\Regiao 2: xminJxmax,ymin,ymaxJzminJzmax \Regiao 2: Media
Figura D.2: Exemplo de arquivo de entrada para o programa sesim3.
Anexo £ —
149
E Correção do Efeito de Suporte
Na geração da imagem intermediária do padrão 1 (capítulo 4). íoi necessário transformar os valores das variáveis associados ao suporte dos pingues (considerado 0.025 x 0.025) para a área intermediária de 4.0 x 0.4 m. Para isto foi utilizada a correção afim, dada pela equação 4.4.
.........Para	aplicar a equação 4.4, é necessário primeiro calcular o fator de correção /. Este fator relaciona a variância de dispersão de valores correspondentes a um suporte B contido em um domínio A com a variância de dispersão de valores medidos no suporte puntual (•), ou seja:
(E.l)
a2(B,A)
-CBOl
A seguinte relação entre as variâncias de dispersão é válida (Isaaks &amp;amp; Srivastava, 1989:479):
&lt;72(-.A) =&amp;lt;72(-,B) + cr2(B,A)
Usando E.2 em E.l, obtem-se:
&lt;r2(-,5) o-2('M)
O valor de a2(*, A) corresponde à variância c priori dos valores de uma variável Z(x) medidos no suporte puntual. O valor de ít2(-,B) pode ser estimado pela média do variograma com todos os vetores contidos no domínio B, ou seja:
a2(-,B)~7(B)	(E.4)
O valor do variograma médio 7 pode ser obtido de tabelas para geometrias regulares do domínio B com os modelos variográticos mais comuns (esférico, exponencial), ou através de programas que discretizam o domínio B, procedimento que foi utilizado nesta dissertação. O suporte dos pingues foi considerado puntual, já que o alcance do variograma é cerca de 54 vezes a dimensão do plugue. Uma regularização rigorosa do suporte do plugue para o puntual forneceria praticamente os mesmos valores, sendo desnecessária para fins práticos.
Usando o modelo variográfico ajustado para o suporte dos pingues (figura 4.4), o valor calculado de fi(B) para a variável Z — log(Kh) foi 0.366. Com o mesmo procedimento para os variogramas de porosidade&amp;lt;/&gt;(%) e log(Kv), foram obtidos os valores 0.265 e 5.327, respectivamente. Utilizando a equação E.3 com a aproximação E.4, foram obtidos os valores de / para as três variáveis:	= 0.77; /(log(Kh)) = 0.56; /(log(Kv)) = 0.62.
150
— Anexo &amp;amp;
Substituindo na equação 4À, a fórmula de correção afim utilizada para cada variável foi:
a)	para porosidade $(%): q' ~ \/Õ?77(q — 15.7) + 15.7
b)	para log(J&lt;A): q’ — &gt;/0.56(ç — 1.37) -f 1.37
c)	para log(7&lt;v): q' =■ ^/Õ 62(g — 1.21) + 1.21
.......Com os valores q* foi construido o variograma para o suporte intermediário (4.0 x 0.4 m), utilizado como uma das características reproduzidas na imagem intermediária.
Anexo F —
151
F Regiões de Médias e Variogramas Reproduzidas
nas Imagens Modeladas
Nas imagens geradas com os algoritmos de SA e EE nas fases 2 em diante, foram adicionadas como características a serem reproduzidas regiões de médias e variogramas, obtidos da própria imagem padrão correspondente ou dos poços fictícios condicionantes. As tabelas F.l e F.2 apresentam as condições impostas.
Padrão	Regiões de Variogramas				Distâncias Consideradas	
	^min	%mai	ymin	l/mar	Horizontal	Vertical
1	1	12	1	24	1,2,3,4,5	1 a 8
	25	48	13	24	1,2,3,4,5,10	1 a 6
4	1	4	1	24					1,2
	23	27	1	24					1,2
	45	48	1	24		1,2
Tabela F.l: Regiões de variogramas locais considerados como condição reproduzida nas imagens simuladas.
Padrão	Limites da Região				Valor
		•£maz	ymin	l/max	
1	1	48	4	6	2.044
	1	48	15	15	0.631
	1	48	18	18	1.797
	1	16	20	24	0.829
2	1	48	20	22	0.626
4	1	48	23	24	0.433
	24	48	9	11	2.165
Tabela F.2: Regiões de médias consideradas como condição reproduzida nas imagens simuladas.
152
Referências
[1]	AARTS, E.H.L. &amp;amp; KORST, J.: Simulated Annealing and Boltzmann Machines. John Wiley Sons, New York, 1989.
[2]	AARTS, E.H.L. &amp;amp; VAN LAARHHOVEN, P.J.M.: "Statistical Coding: A General Approach to Combinatorial Optimization Problems”, Philips Journal of Research 40
.....(1985), p. 193 226.
[3]	ALABERT, F.: "Constraining Description of Randomly Heterogeneous Reservoirs to Pressure Test Data: A Monte Carlo Study”, In SPE Annual Conference and Exhibition, San Antonio, Out. 1989.
[4]	BIRD, R.B., STUART, W.E. &amp;amp; LIGHTFOOT, E.N.: Transport Phenomena (1960), John Wiley &amp;amp; Sons, New York
[5]	CAMPOZANA, F.P.: "Modelagem Probabilistica e Simulação de Reservatórios”, dissertação de mestrado, UNICAMP (Nov. 1990), 166 p.
[6]	CERNY, V.: "Thermodynamical Approach to the Traveling Salesman Problem: An Efficient Simulation Algorithm”, Journal of Optimization Theory and Applications 45 n- 1, p. 41-45.
[7]	CHENG-DANG, Z., CHU-QIAO, G., ZHEN-WU, J. &amp;amp; XI-LING, W.: "A Simulated Annealing Approach to Constrained Nonlinear Optimization of Formation Parameters in Quantitative Log Evaluation”, paper SPE apresentado no 67th Annual Technical Exhibition and Conference, Washington, 4-7 Out. 1992.
[8]	COLLINS, N.E., EGLESE, R.W. &amp;amp; GOLDEN, B.L.: "Simulated Annealing - An Annotated Bibliography”, American Journal of Mathematical and Management Sciences 8 (1988), p. 209-307.
[9]	CONNOLY, D.T.: “Combinatorial Optimization Using Simulated Annealing”, Report, London School of Economics, London, WC2A 2AE.
[10]	CRUZ, P.S.: “Análise Crítica dos Métodos de Mudança de Escala Associados à Simulação de Reservatórios”, dissertação de mestrado, UNICAMP (Nov. 1991), 141 p.
[11]	DA COSTA E SILVA, A.J.: “A New Approach to the Characterization of Reservoir Heterogeneity Based on the Geomathematical Model and Kriging Technique”, paper SPE 14275 apresentado no SPE Annual Technical Conference and Exhibition, Las Vegas, 22-25 Set. 1985.
[12]	DAMSLETH, E., TJ0LSEN, C.B., OMRE, H. &amp;amp; HALDORSEN, H.H.: "A Two-Stage Stochastic Model Applied to a North Sea Reservoir”, Journal of Petroleum Technology (Abr. 1992), p. 402-408, 486.
REFEREECI AS
153
[13]	DESBAR ATS, A. J.: “ Numerical Estimation of Effective Permeability in Sand-Shale Formations”, B'Gfcr Resources Research, v. 23. n° (Fev. 1987), p. 273-286.
[14]	DEUTSCH, C.V.: “The Application of Simulated Annealing to Stochastic Reservoir Modeling”, In SCRF Report 3 (Mai. 1991), Stanford, CA.
[15]	DEUTSCH, C.V.: “Annealing Techniques Applied to Reservoir Modeling and The Integration of Geological and Engineering (Well Test) Data”, Ph.D. thesis, Stanford University, 306 p.
[16]	DEUTSCH, C.V. &amp;amp; JOURNEL, A.G.: “The Application of Simulated Annealing to Stochastic Reservoir Modeling”, paper SPE 23565 recebido pela SPE em Jul. 1991.
[17]	DEUTSCH, C.V. &amp;amp; JOURNEL, A.G.: “GSLIB: Geostatistical Software Library and User’s Guide” (1992 (a)), Oxford University Press, New York.
[18]	DEUTSCH, C.V. &amp;amp; JOURNEL, A.G.: “Annealing Techniques Applied to the Integration of Geological and Enginnering Data”, In SCRF Report 5 (Mai. 1992 (b)), Stanford, CA.
[19]	EDMONDS, J.: “Paths, Trees, and Flowers”, Canadian Journal of Mathematics 17 (1965), p. 449-467.
[20]	EGLESE, R.W.: “Simulated Annealing: A tool for Operational Research”, European Journal of Operational Research 46 (1990), p. 271-281.
[21]	FARMER, C.: “Numerical Rocks”, In “Proceedings of the First European Conference on the Mathematics of Oil Recovery”, F.J. Fayers e P.R. King (eds.), Oxford University Press, Oxford (1990)
[22]	FOULDS, L.R.: “Combinatorial Optimization for Undergraduates” (1984), Springer-Verlag, New York.
[23]	GEM AN, S. &amp;amp; GEMAN, D.: “Stochastic Relaxation, Gibbs Distributions, and the Bayesian Restoration of Images”, IEEE Transactions on Pattern Analysis and Machine Intelligence, vol. PAMI- n- (Nov. 1984), p. 721-741.
[24]	GHORI, S.G., OUENES,A., POPE, G.A., SEPEHRNOORI, K. &amp;amp; HELLER, J.P.: “The Effect of Four Geostatistical Methods on Reservoir Description and Flow Mechanism”, paper SPE 24755 apresentado na 67i/l Annual Technical Conference and Exhibition, Washington, 4-7 Out. 1992.
[25]	GLOVER, F. &amp;amp; GREENBERG, H.J.: “New approaches for heuristic search: A bilateral linkage with artificial intelligence”, European Journal of Operational Research 39 (1989), p. 119-130.
REFERÊNCIAS
154
[26]	GOGGIN, D.J., CHANDLER, M.A., KOCUREK, G.A. £ LAKE, LAV.: “Patterns of Permeability in Eolian Deposits”, paper SPE/DOE 14893 apresentado no SPE/DOE Symposium on Enhanced Oil Recovery, Tulsa, 20-23 Abr. 1986.
[27]	GOGGIN, D.J., CHANDLER, M.A., KOCUREK, G. k LAKE, LAV.: “Permeability Transects of Eolian Sands and Their Use in Generating Random Permeability Fields”, paper SPE 19586 apresentado na SPE Annual Technical Conference and Exhibition, San Antonio, 8-11 Out. 1989.
[28]	GUERILLOT, C., RUDKIEWICZ, J.L., RAVENNE, C., RENARD, G. &amp;amp; GALLI, A.: “An Integrated Model for Computer Aided Reservoir Description: From Outcrop Study to Fluid Flow Simulations”, Revue de LTnstitut Frangais du Petrole v. 45, n9 (Jan.-Fev. 1990).
[29]	HAJEK,B.: “Cooling Schedules for Optimal Annealing" Mathematics &amp;amp; Operations Research 13 ne, 2, (Mai. 1988), p. 311-329.
[30]	HALDORSEN, H.H. &amp;amp; DAMSLETH, E.: “Stochastic Modeling”, Journal of Petroleum Technology (Abr. 1990), p. 404-412.
[31]	HIRD, K.B. k KELKAR, M.G.: “Conditional Simulation Method for Reservoir Description Using Spatial and Well Performance Constraints”, paper SPE 24750 apresentado na SPE Annual Technical Conference and Exhibition, Washington, 4-7 Out. 1992.
[32]	ISAAKS, E.H. k SRIVASTAVA, R.M.: Applied Geostatistics (1989), New York U-niversity Press, New York.
[33]	JOHNSON, P.W.: “ The Relationship Between Radius of Drainage and Cumulative Production”, SPE Formation Evaluation Journal (Mar. 1988), p.267-270.
[34]	JOHNSTON, D.H.: “Recent advances in exploitation geophysics”, Geophysics: The Leading Edge of Exploration (Set. 1989).
[35]	JOURNEL, A.G.: “Fundamentals of Geostatistics in Five Lessons. Volume 8 Short Course in Geology (1989), American Geophysical Union, Washington.
[36]	JOURNEL, A.G. k ALABERT, F.: “Non-Gaussian Data Expansion in the Earth Sciences”, Terra Nova 1 (1989), p. 123-134
[37]	JOURNEL, A.G. k HUIJBREGTS, C.J.: “Mining Geostatistics”, Academic Press, London (1978).
[38]	KIRKPATRICK, S., GELLATT JR., C.D. k VECCHI, M.P.: “Optimization by Simulated Annealing”, Science 220, p. 671-680.
REFERENCE'S
155
[39]	K1TTRIDGE, M.G., LAKE, L.W., LUCIA, F.J. &amp;amp; FOGG, G.E.: "Outcrop / Subsurface Comparisons of Heterogeneity in the San Andres Formation5', SEE Formation Evaluation Journal (Set. 1990), p. 233-240.
[40]	LAKE, L.W. &amp;amp; CARROLL, H.B. JR. (eds.): “Reservoir Characterization”, Academic Press, Inc. (1986), Orlando, FL.
[41]	LAKE, L.W., CARROLL, H.B. JR. &amp;amp; WESSON, T.C. (eds.): “Reservoir Characterization II”, Academic Press, Inc. (1991), San Diego, CA.
[42]	LE LOC5H, G.: "An Efficient Strategy for Combining the Permeabilities: Pratical Application on a Simulated Reservoir”, In Geostatistics 2 (1989), p.557-568.
[43]	LUNDY, M. &amp;amp; MEES, A.: “Convergence of An Annealing Algorithm”, Mathematical Programming 34 (1986), p. 111-124.
[44]	MATHERON, G.: “Composition des permeabilities en milieu poreux heterogene: Methode de Schwydler et regies de ponderation, Revue de LTnstitut Frangais du Petrole v, 22 (1967), p. 443-466.
[45]	METROPOLIS, N., ROSENBLUTH, A., ROSENBLUTH, M., TELLER, A. &amp;amp; TELLER, E.: “Equation of state calculations by fast computing machines”, Journal of Chemical Physics 21 (Jun. 1953), p. 1087-1092.
[46]	OLIVER, D.S.: “The Averaging Process in Permeability Estimation From Well-Test Data”, SPE Formation Evaluation, (Set. 1990), p.319-324.
[47]	OMRE,H., SOLN A, K. &amp;amp; TJELMELAND, H.: “Calcite Cementation - Description and Production Consequences”, paper SPE 20607 apresentado na SPE Annual Technical Conference and Exhibition, New Orleans, 23-26 Set. 1990.
[48]	OUENES, A.: “Simulated Annealing Method (SAM): A New Approach for Reservoir Characterization”, PRRC Report 99-fl (Ago. 1991) New Mexico Petroleum Recovery Research Center, Socorro, New Mexico.
[49]	PEREZ, G.: “Stochastic Conditional Simulation for Description of Reservoir Properties”, Ph.D. Thesis, The University of Tulsa (1991), 227 p.
[50]	RIPLEY, B.: “Stochastic Simulation”. John Wiley &amp;amp; Sons, New York (1987).
[51]	ROMEO, F. &amp;amp; SANGIOVANNI-VINCENTELLI,A.: “A Theoretical Framework for Simulated Annealing”, Algorithmica 6 (1991),p. 302-345.
[52]	ROTHMAN, D.: “Nonlinear inversion, statistical mechanics, and residual statics estimation”, Geophysics 50 (1985), p. 2784-2796.
156
[53]	RUDKIEWICZ, J.L., GUÉRILLOT, D. &amp;amp; GALLI, A.: “An Integrated Software for Stochastic Modelling of Reservoir Lithology and Property Prediction with an Example from the Yorkshire Middle Jurassic Formation”, In “North Sea Oil &amp;amp; Gat Reservoirs II”, A.T. Buller et al. (eds.), Graham &amp;amp; Trotman Ltd., London (1990), p. 399-406.
[54]	SAAB, Y.G.e RAO, V.B.: “ Combinatorial Optimization by Stochastic Evolution”, IEEE Transactions on Computer-Aided Design, v. 10, nc 4 (Abr. 1991).
[55]	SEN, M.K., DATTA GUPTA, A., STOFFA, P.L., LAKE, L.W. &amp;amp; POPE, G.A.: “Stochastic Reservoir Modeling Using Simulated Annealing and Genetic Algorithm”, paper SPE 24754 apresentado na 67th Annual Technical Conference and Exhibition, Washington, 4-7 Out. 1992.
[56]	SHAFER, J. M. &amp;amp; VARLJEN, M. D.: “Approximation of Confidence Limits on Sample Semivariograms From Single Realizations of Spatially Correlated Random Fields”, Water Resources Research v. 26, ne, (Ago. 1990), p. 1787-1802.
[57]	SMITH, L.: “Spatial Variability of Flow Parameters in a Stratified Sand”, Mathematical Geology 13 (1981).
[58]	VESTERG AARD, P.D. &amp;amp; MOSEGAARD, K.: “Inversion of Post-Stack Seismic Data Using Simulated Annealing”, Geophysical Prospecting 39 (1991), p. 613-624.
[59]	YUAN, L. &amp;amp; STROBL, R.: “Variograms and Reservoir Continuity”, paper apresentado no Third International Reservoir Characterization Technical Conference, Tulsa (1991).</field>
	</doc>
</add>