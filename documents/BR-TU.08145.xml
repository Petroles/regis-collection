<?xml version="1.0" encoding="utf-8"?>
<add>
	<doc>
		<field name="docid">BR-TU.08145</field>
		<field name="filename">12934_255200.pdf</field>
		<field name="filetype">PDF</field>
		<field name="text">DAYSON ROBERTO WALDSCHMIDT
Desenvolvimento de um Medidor de Fração de Agua Utilizando Tecnologia de Microondas
Florianópolis, fevereiro de 2008.
UNIVERSIDADE FEDERAL DE SANTA CATARINA
CURSO DE pOS-GRADUACAO
EM ENGENHARIA ELEtRICA
Desenvolvimento de um Medidor de Fração de Agua Utilizando Tecnologia de Microondas
Dissertação submetida à
Universidade Federal de Santa Catarina como parte dos requisitos para a obtenção do grau de Mestre em Engenharia Elétrica.
Dayson Roberto Waldschmidt
Florianépolis, fevereiro de 2008.
Desenvolvimento de um Medidor de
z
Fração de Agua Utilizando Tecnologia de Microondas
Dayson Roberto Waldschmidt
‘Esta Dissertação foi julgada adequada para a obtenção do título de Mestre em Engenharia Elétrica, Area de Concentraçao em Automação e Sistemas, e aprovada em sua forma final pelo Programa de Pés-Graduação em Engenharia Elétrica da Universidade Federal de Santa Catarina.’ Florianópolis, 29 de fevereiro de 2008.
Prof. Daniel Juan Pagano, Dr.
Orientador
Profa. Kátia Campos de Almeida
Coordenador do Programa de Pás-Graduação em Engenharia Eletrica
Banca Examinadora:
Prof. Daniel Juan Pagano, Dr. Presidente
Prof. Walter Pereira Carpes Junior, Dr.Eng.
Prof. Nestor Roqueiro, D.Sc.
Eng. Jose Maria Mascheroni, Msc.
Ao meu pai
A GRADECIMENTOS
Primeiramente gostaria de agradecer à minha família - Dona Cirlay, seu Manfred (in memoriam), Darlene e Delany (in memoriam) - que me ensinou o valor da educação na formacão do indivíduo, a recompensa oriunda do comprometimento e da dedicacão e, acima de tudo, a estima e admiração pelo esmero.
Agradeço também a minha companheira, namorada e amiga Mel, pelo apoio incondicional e inspiraçao em todos os momentos, alegres e difíceis. Sem o seu apoio nada disso seria possível.
Meu agradecimento nãao menos especial ao meu orientador, Daniel Pagano, pela confianca em mim depositada e pela oportunidade de realizar o presente trabalho. Agradeço também aos professores Nestor Roquero e Julio E. N. Rico pelo apoio durante a realizacçaão do trabalho.
Agradeço aos colegas Augustinho Plucênio, Ramiro Saraiva, Guilherme Mafra e Francisco Rafael pelo apoio tíecnico, amizade e suporte durante a realizacçãao do trabalho.
Por ultimo, agradeço a ANP (Agência Nacional de Petróleo e Gés Natural) pelo suporte financeiro, sem o qual este trabalho não teria sido possível, e ao PGEEL pela paciência e compreensãao.
Resumo da Dissertação apresentada à UFSC como parte dos requisitos necessários para obtençao do grau de Mestre em Engenharia Eletrica.
Desenvolvimento de um Medidor de ______	z
Fração de Agua Utilizando Tecnologia de Microondas
Dayson Roberto Waldschmidt
Fevereiro/2008.
Orientador Area de Concentração Palavras-chave	Prof. Daniel Juan Pagano, Dr. Automação e Sistemas Medidores de Fracao de Agua, Medidores Multifasicos Processamento de Microondas, Sistemas Embarcados, Propriedades Dieletricas dos Materiais, Instrumentacão, Medição Não-Intrusiva, Petróleo.
Numero de Paginas	131
Este trabalho explora o tema da utilização da tecnologia de microondas na medição da fração de agua em escoamentos multifasicos, para aplicações na industria de petróleo e gas natural.
Foi proposto e implementado um sistema de instrumentacão nao-intrusivo baseado na tecnologia de microondas, utilizando sensores de transmissãao.
Foram realizados testes estaticos para a avaliaçcãao da viabilidade de diversas tecnicas de mediçcaão, baseadas em sensores de transmissãao, e do sistema de instrumentacçãao desenvolvido para a mediçcaão da fraçcãao de agua numa mistura bifasica de agua e oleo.
Abstract of Dissertation presented to UFSC as a partial fulfillment of the requirements for the degree of Master in Electrical Engineering.
Development of a Microwave Water-Cut Meter
Dayson Roberto Waldschmidt
February/2008.
Advisor
Area of Concentration
Key words
Number of Pages
Prof. Daniel Juan Pagano, Dr.
Automation and Systems
Water Cut Meters, Multiphase Metering,
Microwaves Electronics, Embedded Systems,
Dielectric Properties of Materials,
Instrumentation, Non Intrusive Measurements, Petroleum. 131
The aim of this work is to explore the use of microwave technology for measuring the water cut content in a multiphase flow for application in oil industry.
A non-intrusive instrumentation system, based on microwave technology and using transmission sensors, was proposed and implemented.
Static tests were carried out in order to verify the viability of several measuring techniques based on microwave transmission sensors, and also the viability of the developed instrumentation system for measuring the water cut in a biphasic oil-water mixture.
Sumário
1	Introdução	1
1.1	Contextualização do Problema....................................... 1
1.2	Técnicas e Métodos de Medição...................................... 4
1.2.1	Parâmetros de Escoamento..................................... 6
1.2.2	Fraçães Volumétricas......................................... 7
1.2.3	Tipo do Escoamento........................................... 8
1.2.4	Propriedades da mistura .................................... 12
1.3	Mediçcãao utilizando microondas .................................. 13
1.4	Aplicaçães de Sensores de Microondas na IndUstria de Petróleo e Gós .	14
1.5	Objetivos ........................................................ 15
1.6	Organizaçcaão da Dissertaçcãao	................................ 16
2	Fundamentos Teóricos	18
2.1	Ondas Eletromagnéticas............................................ 18
2.2	Propagação das Ondas Eletromagnéticas............................. 20
2.3	Interação das Microondas com os Materiais......................... 21
2.4	Propriedades Dielétricas dos	Materiais ........................... 22
2.4.1	Propriedades Dieléetricas da Aé gua ........................ 23
2.5	Geracão, Transmissao e Processamento de Sinais de Microondas ....	26
2.5.1	Paraâmetros de Sistemas de Microondas ...................... 27
2.5.2	Componentes de um Sistema de Microondas..................... 29
2.6	Tipos de Medidores de Microondas.................................. 36
2.6.1	Sensores de Transmissão..................................... 36
2.6.2	Sensores de Ressonância..................................... 39
2.6.3	Sensores de Reflexão........................................ 41
2.6.4	Sensores Radiométricos...................................... 45
2.6.5	Sensores Tomogréficos....................................... 46
2.7	Conclusões......................................................... 47
3	Sistema Experimental Desenvolvido	48
3.1	Sistema	de Geracõo e Processamento	de	Microondas.................. 49
3.2	Sistema	Digital de Controle e Aquisiçõo	de Dados.................. 53
3.2.1	Características	do	Hardware................................. 54
3.2.2	Características	do	Firmware................................. 56
3.3	Sistema	Embarcado de Comunicacõo.................................. 60
3.3.1	Protocolo de Comunicaçõo.................................... 60
3.3.2	Características	do	Hardware................................. 62
3.3.3	Características	do	Firmware................................. 64
3.4	Sistema Computacional do Concentrador de Dados..................... 69
3.5	Sistema de Interface com Usuério................................... 72
3.6	Sistema de Alimentaçõo DC.......................................... 78
3.7	Sistema de Suporte aos Ensaios..................................... 80
3.8	Sistema de Medicões Auxiliares..................................... 83
3.9	Conclusões......................................................... 83
4	Resultados	Experimentais	85
4.1	Descriçõo de um Ensaio ............................................ 85
4.2	Ensaios Realizados................................................. 86
4.3	Curvas Obtidas..................................................... 88
4.3.1	Configuraçõo 1 ............................................. 88
4.3.2	Configuraçõo 2 ............................................. 92
5	Conclusões	96
5.1	Pendências de Implementação..................................... 99
5.2	Limitações Operacionais......................................... 99
5.3	Dificuldades Encontradas........................................100
5.4	Sugestães para Trabalhos	Futuros................................100
5.5	Consideracães Finais............................................101
A Especificações Técnicas dos Componentes de Microondas Utilizados 102
A.1	Antenas.........................................................102
A.2	VCO.............................................................103
A.2.1	Interruptor ............................................ 103
A.2.2	Divisor de Potência......................................104
A.2.3	Amplificador de Potêencia .............................. 104
A.2.4	Atenuador Controlado por Tensãao ....................... 104
A.2.5	Misturador ..............................................105
A.2.6	Detector.................................................105
B Diagramas Esqueméticos	107
C Mapeamento dos Registrados Modbus da Unidade de Processamento113
D Especificacõo dos Protocolos de Comunicaçao Criados	119
D.1 Protocolo de Recrutamento .......................................119
D.	2 Protocolo de Logging............................................120
E Descricõo dos Webservices do Sistema do Concentrador de Dados 123
E.	1 Funçães dos Webservices.........................................123
E.2 Estruturas de Dados do Webservices ..............................127
Lista de Figuras
1.1	Produção típica de um poço em milhares de barris por dia................. 2
1.2	Método de avaliação da produçao utilizando separador de fases............ 3
1.3	Método de avaliação da produção utilizando medidores multifasicos	. .	3
1.4	Triangulo multifasico [13]............................................... 5
1.5	Exemplos de	escoamento disperso [14]................................... 9
1.6	Exemplos de	escoamento separado [14] ................................. 10
1.7	Exemplos de	escoamento intermitente [14]	  10
1.8	Mapa de	escoamento	multifésico	para um	escoamento	vertical	[14]	...	11
1.9	Mapa de	escoamento	multifésico	para um	escoamento	horizontal	[14]	.	.	11
2.1	Espectro	eletromagnético........................................... 19
2.2	Molécula	de água................................................... 23
2.3	Variação da permissividade elétrica da égua pura com o aumento da
temperatura para diferentes frequências [7]............................. 24
2.4	Variacão da permissividade elétrica da égua salgada (10 ppt) com o
aumento da temperatura para diferentes frequências [7].................. 25
2.5	Variação da permissividade elétrica da agua salgada com o aumento da
temperatura para diferentes concentracçãoes de sais [7]	............ 25
2.6	Variação da permissividade elétrica da égua com a frequência, temperatura e concentraçcãao de sais [7] .................................... 26
2.7	Tipos de antenas - comparação dos diagramas de radiação [6]............. 30
2.8	Isoladores (a)Funcionamento e (b)exemplo de Aplicacão [6]............... 31
2.9	Aplicacão tépica de um circulador [6]................................... 32
2.10	Aplicacães de detectores para (a)medir a intensidade de uma microonda,
(b)demodular um sinal pulsado e (c)demodular um sinal analégico [6] .	32
2.11	Aplicações de Misturadores [6]...................................... 33
2.12	Misturador como um multiplicador de sinais [6]	.................... 33
2.13	Exemplo de aplicaçao de um interruptor [6]	........................ 34
2.14	Utilizaçao de um interruptor na construçõo de um deslocador de fase [6]	35
2.15	Sensor de Transmissao [9]	......................................... 37
2.16	Método de FMCW [6] ................................................. 38
2.17	Sistema para mediçõo da atenuaçõo e da fase [9]..................... 39
2.18	Gréfico da fase e magnitude num medidor de coeficiente de reflexao com
fr = 1.5GHz [20].................................................... 41
2.19	Gréfico da fase e magnitude num medidor de coeficiente de transmissõo
com fr = 1.5GHz [20]	............................................. 42
2.20	Sensor de ressonância utilizado na medicõo de nével de um tanque de
éleo de um navio [9]	............................................. 42
2.21	Princípio de funcionamento de um medidor de parâmetros de escoamento
utilizando um sensor de reflexaõo [9] .............................. 43
2.22	Princípio de funcionamento de um radar de pulso [6] ............... 44
2.23	Princípio de funcionamento de um radar de FMCW [9].................. 45
2.24	Princípio de funcionamento de um radiâmetro, onde Tp é a temperatura
do objeto, Tb é a temperatura de brilho e n é a emissividade [9].... 46
2.25	Princépio de funcionamento de tomógrafo de microondas [9]........... 47
3.1	Arquitetura do sistema de ensaios com microondas ................... 50
3.2	Diagrama de blocos do sistema de de geraçõo e processamento de microondas ........................................................... 53
3.3	Foto do sistema de geracõo e processamento de microondas montado
sobre uma placa de acrílico......................................... 53
3.4	Diagrama de Bode do filtro anti-recobrimento........................ 55
3.5	Diagrama de blocos do sistema controle e aquisiçõo de dados......... 56
3.6	Desenho da PCI da unidade de processamento do sistema............... 57
3.7	Unidade de processamento do sistema................................. 57
3.8	Fluxograma de dados no firmware do sistema de controle e aquisicõo .	59
3.9	Diagrama de blocos do sistema embarcado de comunicaçõo.............. 64
3.10	Mapeamento das camadas do padrão Ethernet em tarefas na biblioteca
TCP/IP Stack da Microchip [24]	..................................... 65
3.11	Estrutura da mensagem Modbus TCP/IP [19]................................ 67
3.12	Possível configuracao para o sistema digital............................ 70
3.13	Arquitetura computacional do sistema do concentrador de dados ....	73
3.14	Tela da interface com usuário onde e apresentada a lista de equipamentos
detectados na rede ...................................................... 76
3.15	Tela da interface com usuario onde á apresentado o menu de configuraçao
de logging do sistema.................................................... 77
3.16	Desenho da PCI da fonte de alimentaçao.................................. 80
3.17	Foto da fonte de alimentação com a tampa aberta......................... 80
3.18	Foto da fonte de alimentacão com a tampa fechada........................ 81
3.19	Foto da bancada de ensaios durante um ensaio............................ 82
3.20	Foto da bancada de ensaios durante um ensaio (detalhe do interior da
caixa de Faraday)........................................................ 83
4.1	Parâmetros de configuraçao de um ensaio bancada de testes ............... 87
4.2	Tanque de ensaio com a manta metálica ................................... 89
4.3	Gráfico da intensidade em função da fraçao de áleo, utilizando-se o
tanque de secão retangular e com a utilizaçao da manta de alumánio . .	90
4.4	Grafico do atraso de fase em funçao da fracão de áleo, utilizando-se o
tanque de seçcãao retangular e com a utilizacçaão da manta de alumánio . .	90
4.5	Gráfico do intensidade em função da fração de áleo, utilizando-se o
tanque de seçcãao retangular e com a utilizaçcaão da manta de alumánio . .	91
4.6	Gráfico do atraso de fase em funçao da fracão de áleo, utilizando-se o
tanque de seçcaão retangular e com a utilizaçcaão da manta de alumánio . .	91
4.7	Tanque de ensaio sem a manta metálica.................................... 92
4.8	Gráfico da intensidade em funçao da frequência (faixa inteira),
utilizando-se o tanque de seçcãao retangular para diversas fracçãoes de áagua 93
4.9	Gráafico da intensidade em funçcãao da fraçcãao de áagua (tipo A), utilizando-
se o tanque de secçãao retangular 2 frequêencias escolhidas ............. 94
4.10	Gráfico do intensidade em função da frequência (tipo B), utilizando-se
o tanque de seçcãao retangular para diversas fraçcoães de áagua ......... 94
B.1 Diagrama esquemético da fonte de alimentação DC....................108
B.2 Diagrama esquemético do médulo principal do sistema de controle e aquisição.........................................................109
B.3 Diagrama esquemético do médulo de condicionamento das entradas analéogicas do sistema de controle e aquisiçcãao ................ 110
B.4 Diagrama esquemético do médulo de condicionamento das saídas analéogicas do sistema de controle e aquisicçãao ................ 111
B.5 Diagrama esquemético do sistema de comunicação embarcada...........112
Lista de Abreviações e Símbolos
ANP DAS DSP FMCW MC MM MUT PTH RF RMN SMD SMT VCO VSWR WC	Agência Nacional de Petróleo Departamento de Automação e Sistemas Processador Digital de Sinais (Digital Signal Processor Frequency-Modulated Continuous Wave Medidor Convencional Medidor Multifaósico Material Under Test Placement Through Hole Radiofrequência Ressonaência Magnóetica Nuclear Surface Mount Device Surface Mount Technology Voltage Controlled Oscillator Voltage Standing Wave Ratio Water-Cut
c Eq f h IL P 1 tn Pr Prad Pt RL	Velocidade de propagaçcaão de onda no espacço livre Energia do quantum FreqUência Constante de Planck Insertion Loss Potêencia incidente Potêencia refletida Potêencia irradiada Potêencia transmitida Return Loss
v 6r ^0 / ^rs A	Velocidade de propagaçcaão da onda Permissividade elóetrica relativa Permissividade elóetrica no vaócuo Permissividade óoptica Permissividade estóatica Comprimento de onda
pr Lo a rL	Permeabilidade eletromagnóetica relativa Permeabilidade eletromagnóetica no vaócuo Condutividade do meio Coeficiente de reflexaão
Capítulo 1
Introducão
1.1	Contextualizaçao do Problema
Com o declínio das reservas de petróleo no mundo, a indústria petrolífera se vê obrigada a produzir em lugares e em reservas ate então considerados economicamente inviaveis. As condiçães operacionais de um poço e sua producão são avaliadas atraves do conhecimento das fracães de oleo, agua, gases dissolvidos e demais resíduos extraídos do poço. Além das fracães de cada componente, também é necessario o conhecimento das velocidades de escoamento de cada uma das fases e, no caso de fraçcãoes significativas de géas, a densidade, ou massa especifica, das fases. Os parêametros acima citados caracterizam o problema da mediçao multifésica na industria de petróleo e gas natural e são importantíssimos para o monitoramento da producão dos pocos e gerenciamento da explotaçcãao do reservatéorio de onde estes poçcos produzem. Aléem disso, o conhecimento detalhado de todas as fraçcãoes produzidas por cada poçco serve para o levantamento da viabilidade econoêmica do projeto. A importêancia de tal informaçcãao a respeito do escoamento fica ainda mais evidente nos projetos de recuperação de pocos. Na figura
1.1	é mostrado o ciclo de vida tépico de um poço. Juntamente com o aumento da fração de égua1, é comum um aumento da fracao de gés com o passar dos anos. Apesar de serem comumente utilizadas téecnicas de injeçcãao de aégua ou géas na explotaçcaão de um reservatoério, a maior parte da éagua e gases explotados sãao normalmente provenientes do préoprio reservatoério. As duas principais aplicaçcãoes da mediçcaão multiféasica na induéstria de petróleo e gés são [14]:
• Teste de Poços - engenheiros de reservatório necessitam avaliar constantemente o desempenho de cada poçco de um campo para poderem otimizar a produçcãao do
1em inglês Water-Cut
campo, especialmente nos campos em processo de recuperação por injeção de gás ou água;
• Medição da Produção - necessária quando uma Unica planta á utilizada para o processamento da produção de diferentes areas de licenciamento, ou então quando a produção de diferentes áreas precisa ser transportada através de um duto comum.
Figura 1.1: Produção típica de um poço em milhares de barris por dia
O método comumente empregado para a medição das fracães baseia-se na utilização de separadores de fase. Para tal é necessario que o escoamento seja desviado para uma planta de testes, onde entao as fases sao separadas e as medicães são realizadas utilizando-se Medidores Convencionais (MC), conforme ilustrado na figura 1.2. As desvantagens desse metodo são [8]:
•	e necessario um longo tempo para a estabilizaçao, ou separação, das fases;
•	necessita de uma infra-estrutura específica de testes que, por sua vez, ocupa um espacço significativo;
•	as medicçãoes nãao sãao realizadas continuamente, mas sim sobre amostras do escoamento, que nãao saão necessariamente representativas da produçcaão.
Por outro lado, medidores de vazao multifasica 2 permitem que a producão seja avaliada de forma contínua. Um medidor de vazão multifésica é um instrumento capaz
2às vezes referidos como in-line multiphase meters
Figura 1.2: Método de avaliação da produção utilizando separador de fases
de medir, sem separaçao das fases, as vazães de éleo, égua e gés, escoando em uma tubulaçao. Na figura 1.3 é ilustrado uma possível configuração quando se utiliza esse tipo de medidor. Algumas das vantagens da utilizaçao de um Medidor Multifésico (MM) são [8]:
Figura 1.3: Método de avaliaçao da produção utilizando medidores multifésicos
•	reduçao do tempo de medicão;
•	eliminaçao de linhas e separadores de testes;
•	melhor gerenciamento do reservatério de produção;
•	exploração de novos campos até então inviáveis economicamente;
•	melhor controle da vazão de gas das valvulas de gas lift;
•	otimizacão da producao de petroleo;
•	deteccão de parada de produção de um poço de petroleo.
Em contrapartida entre as desvantagens na utilização de medidores multifasicos podemos citar [14]:
•	a amostragem dos fluidos nao esta disponível e, se necessaria, pode requerer a instalacçãao de um separador de testes;
•	nãao existe nenhum padraão metrologico rastreavel para a aferiçcãao dos medidores multifasicos;3
•	pode ser necessaria a utilizaçcãao de um separador para a remoçcãao de lama e para fins de limpeza.
Portanto, medidores de vazão multifasica, alem de propiciarem uma medição mais representativa dos parâmetros de producao, implicam em uma reducão dos investimentos em recursos humanos e em instalaçães. Apesar das vantagens da utilização desses medidores, e somente recentemente, com o desenvolvimento tecnologico, que estes medidores atingiram os requisitos mínimos de incerteza padrão, resolucão e custos requeridos pela industria para aplicaçcoães na produçcaão, sendo que estes instrumentos ainda nãao atingiram os requisitos mínimos exigidos pela ANP para utilizaçao fiscal. Ainda assim, o custo deste tipo de instrumento ainda é considerado elevado para muitas aplicacães.
1.2	Técnicas e Métodos de Medicão
A mediçcaão multifíasica consiste na utilizaçcãao de equipamentos que permitem a medição da vazão de cada fase, em escoamento multifasico, sem que seja necessaria a separação dessas fases, para que suas respectivas vazoes (volumetrica ou massica) sejam determinadas. Nesse tipo de medidor, a medição das vazães das fases e obtida atraves da interpretaçcaão das mediçcoães realizadas por diferentes sensores, de acordo com a concepcçãao de medidor adotada. Estes sensores medem os valores de determinados
3tradução livre para: ’’multiphase metering is not traceable to any accepted standards”
parâmetros relativos à fração de presença das fases e suas características fluidas, ou ainda características intrínsecas do escoamento.
Para a indUstria de petróleo e gás natural, a mistura multifasica de interesse consiste basicamente de água (normalmente salina), oleo cru e gases. Esta ó a mistura encontrada nos reservatórios de petróleo. Dependendo do tipo do reservatório e de diversas condições geológicas e de produção, a composiçao da mistura pode variar entre os extremos, e apresentar como fase predominante qualquer um dos trâs componentes, podendo inclusive não apresentar algum dos constituintes. O triângulo multifásico ó um grafico que representa as possóveis composicães encontradas na explotacão de um poço de petróleo [13]. Alóm disso, o triangulo ó de fundamental importância para a compreensão da complexidade do problema da medição multifósica. Na figura 1.4 ó mostrado o triaângulo multifóasico.
GAS
Figura 1.4: Triangulo multifasico [13]
Um medidor multifásico ideal seria aquele que pudesse medir diretamente as frações volumétricas, as velocidades e as massas específicas de cada fase ou componente da mistura, compondo assim as nove incógnitas para a resolução do equacionamento das vazões massicas de cada fase. Essa forma de medição multifósica tambóm pode ser classificada como um mótodo de medicão inferencial. No entanto, tal medidor não existe, sendo que a solucão aproximada do problema da vazão multifósica ó obtida atraves de simplificaçães, aproximacães e equacães empíricas. Alem disso, e comum a
utilização de artifícios que simplificam de alguma forma o problema como, por exemplo, a utilização de misturadores estáticos [8], [14]. Os misturadores estaticos, em teoria, homogeneízam a mistura, igualando a velocidade de escoamento das fases constituintes da mistura e forçando um escoamento do tipo homogêneo.
Podemos dividir o problema da medição multifásica em quatro sub-problemas, ou categorias genáricas [3]:
•	determinacão dos parâmetros de escoamento4;
•	determinaçao das fracoes volumátricas5;
•	identificacao do tipo do escoamento6;
•	determinação das propriedades da mistura7.
1.2.1	Parâmetros de Escoamento
O principal parêametro de escoamento medido áe a velocidade, ou vazãao, do escoamento multifásico. Existem diversas tácnicas intrusivas e nao-intrusivas para medir a velocidade do escoamento. Abaixo sao descritos e listados os principais tipos de medidores utilizados na determinaçcaão da velocidade de escoamento, classificados de acordo com a táecnica de inferêencia utilizada:
•	Pressão diferencial: a velocidade do escoamento á calculada através da leitura da queda de pressãao, ou pressaão diferencial, devido a uma restriçcaão de escoamento conhecida. Os tipos mais comuns de restriçcãoes utilizadas nesse tipo de equipamento são: placas de orifício, tubos de Venturi, Flow Nozzle e tubo de Pitot. Para mais detalhes ver [21] e [22].
•	Mecânico: nesse tipo de medidor são utilizadas partes máveis e a medição da velocidade áe realizada atraváes da contagem do nuámero de volumes isolados que passaram atraváes do medidor. Os principais medidores desse tipo sãao medidores de deslocamento positivo e medidores tipo turbina. Ver [21]
•	Ultrassânico: a velocidade do escoamento á medida atravás da alteração na velocidade de propagaçcãao das ondas de ultrassom no meio. As duas principais tácnicas de inferência utilizadas sao: tempo de trênsito e efeito Doppler. Para mais detalhes ver [17] e [5].
4flow parameters
5 volumetric fraction parameters
6flow regime parameters
7	mixture properties
•	Correlaçao Cruzada: a velocidade do escoamento é calculada através da correlação entre dois sinais provenientes de 2 conjuntos de medição (transmis-sor/sensor) distantes entre si de uma distância conhecida. Os sensores utilizados para fazer a correlação podem ser de raios-X, raios-7, épticos, de impedância elétrica, de capacitância elétrica ou acusticos. Ver [5] e [17]
1.2.2	Frações Volumétricas
A determinacçãao das fraçcoães voluméetricas das fases constituintes do escoamento mul-tiféasico pode ser uma tarefa muito complexa caso as velocidades de escoamento das fases sejam diferentes. Quando as velocidades de escoamento das fases são diferentes, ocorre um fenâmeno chamado de slip, ou em português ”escorregamento”[15]. Geralmente a velocidade da fase gasosa ée maior do que a das fases léquidas. Quando ocorre algum tipo de separaçcãao das fases léquidas, o fenoâmeno pode aparecer entre essas fases, implicando em erros de medição significativos caso o medidor nao implemente um méetodo de medicçãao de velocidade de escoamento diferenciado para cada uma das fases. Por isso, ée comum a utilizaçcãao de misturadores antes que a mediçcaão multifaésica in-line seja realizada, de maneira a homogeneizar a mistura e impedir a separacão das fases.
A correta determinaçcãao das fracçãoes voluméetricas dos constituintes da mistura ée de fundamental importaância em qualquer tipo de medidor multiféasico. Existem uma infinidade de téecnicas, méetodos e sensores que saão utilizados na determinacçaão das fraçcãoes. De uma maneira geral, podemos dizer que não existe um método universal para a deter-minacçãao das fraçcãoes voluméetricas que seja eficiente para todas as posséveis condicçãoes de escoamento e misturas. Normalmente a determinaçao das fracães volumétricas é realizada atravées da correlacçãao das medidas obtidas com dois ou mais méetodos, ou sensores. Abaixo saão listados e descritos alguns dos principais méetodos de medicçãao utilizados na determinação das fracães volumétricas do escoamento:
•	Interação com sinais de microondas: devido as características dielétricas peculiares da éagua, ée muito comum a utilizaçcãao de sinais de microondas na de-terminaçcãao da fraçcaão voluméetrica desse componente. Existem diversas téecnicas de mediçcaão que fazem uso de sinais de microondas na determinacçãao da fracçãao de éagua numa mistura, como por exemplo: mediçcaão da atenuaçcaão, do atraso de fase e da frequência de ressonancia. Ver [9], [20] e [26].
•	Atenuação de sinas de ultrassom: as partículas sélidas em suspensão, assim como as bolhas de ar presentes num escoamento cuja fase predominante ée
líquida, têm a propriedade de espalhar 8 ondas de ultrassom. A perda de energia devido a dispersão das ondas ultrossonicas reflete numa atenuação relativa na intensidade do sinal de ultrassom transmitido. Esta técnica pode ser utilizada na determinação da fração de gés de uma mistura de agua, gés e íleo, por exemplo. Ver [5].
•	Ressonância Magnética Nuclear (RMN)9: esta técnica baseia-se nas propriedades magnéticas de alguns atomos. Nesse tipo de medicao, os étomos interagem com campos magnéticos estéticos, forçando o spin dos nucleos dos étomos a se alinharem com o campo aplicado. Entaão um pulso de ondas eletromagnéeticas de RF (radiofrequência), de amplo espectro, é transmitido ortogonalmente ao campo estatico. Quando a frequência do sinal RF transmitido é igual à frequência de Larmor, ocorre um fenêomeno de ressonaência, e o spin dos atomos se inverte. A energia absorvida devido a esse fenoêmeno pode ser medida e utilizada para determinar a concentracçãao de um determinado atomo e, indiretamente, a fraçcãao de uma determinada fase na mistura. Ver [5].
•	Atenuaçcõao radioativa: este metodo utiliza a atenuaçcãao, por absorçcãao ou dispersão, por parte do material sob analise 10 de raios X ou raios Gama transmitidos atraves do meio. As ondas com comprimento de onda da ordem dos raios X e Gama possuem características de partéculas, são os chamados fotons. São os fótons que na verdade sao absorvidos ou dispersados pelos átomos do MUT. Para a liberaçcãao dos féotons sãao necesséarias fontes radioativas que podem diretamente ou indiretamente emitir os raios X ou Gama. Ver [15].
•	Variacao da Impedância: existem duas possibilidades de se medir a im-pedancia complexa de um meio: através da medição da capacitancia ou da in-dutêancia do meio. Este méetodo pode ser utilizado nas misturas biféasicas, em que a permeabilidade eléetrica relativa das fases ée suficientemente diferente, o que ocorre, por exemplo, no caso da mistura de éoleo e éagua. Quando a fase de éoleo ée predominante, pode-se utilizar o méetodo da mediçcãao da capacitêancia. Caso a égua seja a fase predominante, pode-se utilizar o método da indutância. Ver [22] e [15].
1.2.3	Tipo do Escoamento
O escoamento multifaésico ée um fenêomeno complexo, difécil de modelar e de prever. A variacçaão do regime de escoamento depende de diversos fatores. Alguns fatores que
8traduçao para scatter
9 em inglês NMR
10MUT - Material Under Test
interferem no comportamento transitório do escoamento podem ser considerados como perturbações. Esses fatores podem ser, por exemplo, a abertura ou fechamento de uma vólvula, alterações na geometria ou na inclinacõo da tubulaçao. Na ausência dessas perturbacões, o regime de escoamento ó determinado pelas velocidades de escoamento, propriedades dos fluidos, diêmetro e inclinaçõo da tubulaçõo [14]. Os diversos tipos de escoamento podem ser agrupados em três tipos:
•	Escoamento disperso11: caracterizado por uma distribuiçao uniforme das fases tanto na direçõo radial quanto na direçõo axial, conforme mostrado na figura 1.5.
•	Escoamento separado12: este escoamento ó caracterizado por uma distribuiçõo contínua de fases na direçõo axial enquanto apresenta uma distribuicõo nõo-contínua na direçõo radial, conforme mostrado na figura 1.6.
•	Escoamento intermitente13: este tipo de escoamento apresenta uma distri-buiçcõao nõao-contónua de fases na direcçõao axial, implicando num comportamento local instável, conforme mostrado na figura 1.7.
Figura 1.5: Exemplos de escoamento disperso [14]
Os efeitos sobre o tipo do escoamento devido às interacões entre as fases líquidas sao menos significativos dos que os efeitos devidos às interações entre a fase líquida e gasosa. Portanto, na maioria das situacões, pode-se considerar o escoamento da fraçõo lóquida, composta de óoleo e aógua, como sendo um escoamento do tipo disperso [14]. Para uma dada tubulaçcaõo, condiçcõoes de pressaõo e fluido multifóasico, pode-se tracçar um
ndo inglês dispersed flow
12do inglês separeted flow
13do inglês intermittent flow
Figura 1.6: Exemplos de escoamento separado [14]
Figura 1.7: Exemplos de escoamento intermitente [14] mapa qualitativo dos tipos de escoamentos esperados em funçcaõo das velocidades de escoamento das fases léquidas e gasosas, conforme mostrado nas figuras 1.8 e 1.9, para tubulaçcõoes verticais e horizontais respectivamente.
Apesar da relevancia e influância do tipo do escoamento para a mediçõo multifésica, a maior parte das técnicas utilizadas na determinaçõo dos parâmetros do escoamento e das frações volumétricas requerem que o escoamento seja homogeneizado. Isso caracteriza, portanto, um escoamento disperso com relaçao às fases léquidas e léquido-gasosa. Alguns dos princépios de medicçõao citados anteriormente podem ser utilizados para se obter uma imagem tomogréafica do escoamento. A imagem obtida pode ser entaõo utilizada para a determinaçcõao de parâametros de interesse como, por exemplo, fracões volumétricas e tipos de escoamento [15]. As técnicas de imagem normalmente utilizam um conjunto de sensores, ou detectores, dispostos radialmente na tubulaçcõao
Figura 1.8: Mapa de escoamento multifásico para um escoamento vertical [14]
HJ
■ç
cr
O? cn
nj
Tj
"nj
u
—1-------------------
I I
I
j Bolha Dispersa
..............-.....?[................
I f
I f
Bolha Alongada ¡ J
0) Cl ZJ cn
cu
73
nj
u
□
CD &gt;
I
I
I
I
I
I l_
,W/"Wlllllllll^lllllll||IWIIIIl||||||||lllllilll|l«|lll'l"llll,íl,|ll|l&lt;11 1 ’	/ I
I
I
I I --------------!	 Golfada I	.
1 z
I í
A—r-y \ 1 \
'•^Estratificado
% Ondulado =
=s I	I
i I	1
I I
--------------------------------------r
Velocidade Superficial da Fase Gasosa
I í
I	J
II ............................................bs'
I
I
Anular
Misto
Estratificado Liso I
I
I
I
I
I
I
I
I
I
I L
I
I
I
I
I
I
I r
i i
i
i
i
i
L
Figura 1.9: Mapa de escoamento multifásico para um escoamento horizontal [14] de escoamento. Apesar da complexidade e da capacidade computacional exigida, as táecnicas de imagem permitem a determinacçãao experimental do tipo de escoamento. Outra tácnica utilizada na determinacão do tipo de escoamento consiste na utilizaçao de redes neuronais [16]. As redes neuronais caracterizam um tipo de mediçao chamado
de caixa-preta14. Neste tipo de abordagem a modelagem teérica do fenômeno é menos importante dos que os resultados obtidos atravées de um grupo de sensores. Uma vez coletados, os dados relativos ao escoamento podem ser utilizados no treinamento da rede neuronal, que por sua vez pode identificar padrães de escoamento através da correlacçãao de diversas mediçcãoes.
1.2.4	Propriedades da mistura
Complementarmente à medição das fraçães volumétricas, velocidades de escoamento e padrãao de escoamento, um conjunto de outros parôametros da mistura e do escoamento se faz necesséario para a soluçcãao, ou reduçcãao das incertezas das mediçcãoes, do problema da mediçcaão multifaésica. Podemos citar os seguintes parôametros como relevantes ao problema [3]:
•	densidades;
•	salinidade;
•	temperatura;
•	pressãao;
•	constante dieléetrica.
Dependendo do méetodo de mediçcãao empregado na determinaçcãao da fraçcaão de éagua da mistura, algumas compensaçães na medição podem ser necessarias. Isto ocorre quando existe uma influôncia direta de um determinado parômetro sobre a medicão em questãao como, por exemplo, a temperatura e a salinidade, que interferem nas mediçcãoes realizadas utilizando-se tecnologia de microondas [9]. Quando se deseja calcular a vazaão massica da mistura, paraômetros como as densidades, pressãao e temperatura se tornam indispensaveis. A importôancia de um determinado parôametro depende das tecnicas de mediçao adotadas e do proposito especifico do medidor concebido. De uma maneira geral, quanto maior o nuémero de parôametros do escoamento, mistura e componentes forem determinados, melhor e mais precisos tendem a ser os resultados obtidos. No entanto, a determinacçãao da correta correlacçãao entre as diversas propriedades medidas torna-se uma tarefa cada vez complexa. Métodos do tipo caixa-preta, aplicados utilizando-se algum tipo de inteligôencia computacional e que fazem uso da grande capacidade de processamento dos sistemas digitais modernos ganham cada vez mais importôancia e tornam-se cada vez mais importantes para a soluçcãao do problema da mediçao multifásica [3], [16].
14do ingles black-box
1.3	Medição utilizando microondas
A absorção de microondas é um método de inferência muito difundido e utilizado na determinaçao da fraçao, ou composição, de égua de uma mistura. Isto é possível graças às características dielétricas da égua, bem distintas dos demais componentes da mistura comumente encontrada nos pocços de petréoleo. Algumas das vantagens da utilizaçcãao deste tipo de sensor para a mediçcaão das propriedades dos materiais saão abaixo listadas [20]:
•	não necessitam de contato físico com o processo;
•	as microondas penetram em praticamente todos os materiais, com excecao dos metais, sendo portanto, os resultados representativos do volume do material sob anéalise e nãao somente da superfécie;
•	de uma maneira geral, a éagua apresenta um bom contraste em relaçcãao aos demais materiais, tornando este tipo de medidor aconselhavel para a medição da fração de éagua;
•	os sensores de microondas nãao sãao senséveis a condiçcãoes ambientais como vapores de água, sujeira e altas temperaturas;
•	para as potêencias de transmissaão normalmente utilizadas neste tipo de aplicaçcãao, as microondas (radiaçães nao-ionizantes) sao um método seguro para humanos, em contraste com os métodos que utilizam radiaçães ionizantes;
•	para as frequências de microondas, a influência da propriedade elétrica de condu-tividade DC 15 dos materiais pode ser desprezada;
•	sensores de microondas sãao réapidos, possuindo um tempo de resposta pequeno;
•	as microondas nãao afetam o material sob anéalise.
As microondas interagem com os materiais de diferentes formas. A interaçcãao pode se dar na forma de absorcçãao, emissãao, refraçcãao, dispersãao, reflexãao ou alteraçcãao da velocidade e da fase. Dependendo do arranjo de medicçãao adotado e do fenêomeno de interaçcãao no qual baseia-se o sensor utilizado, os sensores de microondas podem ser classificados em grupos. Alguns dos principais grupos sao [20]:
•	sensores de transmissão16;
15	DC conductivity
16tradução livre do inglês transmission sensors
•	sensores de ressonancia;
•	radares e sensores de reflexao;
•	radiómetros;
•	sensores tomograficos;
•	sensores especiais.
Basicamente, o que distingue um tipo de sensor do outro é a maneira como o sistema de microondas interage com os materiais e qual fenómeno de interação esta sendo avaliado. De uma maneira geral, os sensores, sistemas de transmissãao e processamento dos sinais de microondas sãao muito similares.
Os sensores de cavidade de ressonóancia sãao os mais utilizados na medicçaão da fraçcãao de agua em aplicacães na industria de oleo e gas natural [9], [20]. Os sensores de transmissão tambem sao citados [9], mas devido à grande atenuacão que os sinais de microondas sofrem devido a grandes fraçcoães de agua, sua utilizaçcãao nãao e tãao difundida. Os sensores de transmissãao sãao mais simples de serem implementados e desenvolvidos do que os sensores do tipo cavidade de ressonóancia, e por isso seraão estudados no presente trabalho, caracterizando um primeiro esforço na tentativa de domínio dessa tecnologia.
E importante ressaltar que existe um numero reduzido de fabricantes ofertando medidores multifasicos e medidores de fraçcaão de agua que utilizam tecnologia de microondas. Alem disso, talvez por motivos estrategicos, esses fabricantes disponibilizam poucos dados e informaçães a respeito dos seus produtos. Ha tambem poucos artigos e referóencias sobre o assunto.
1.4	Aplicacoes de Sensores de Microondas na IndUstria de Petróleo e Gás
Os sensores de microondas sao utilizados na industria de petroleo e gas principalmente na mediçao da fracão de agua. Tambem sao utilizados na medicão de níveis de tanques. Outra aplicaçcãao nãao diretamente relacionada e na mediçcãao de vazamentos de oleo nos oceanos. A mediçcãao de fraçcãao de agua, utilizando-se tecnologia de microondas, e utilizada em diversas aplicaçães, das quais podemos citar:
•	Medição downhole: a utilização de multiplos boreholes, ou perfuraçães, na explotacão do petróleo á uma tendência na tecnologia de gerenciamento de re-servatários. Nessa situaçao, a producão de muitas zonas de produçao convergem para um poco principal. Para a otimização da produção e recuperação desses reservatáorios áe necessáario que a produçcãao de cada zona possa ser medida e controlada de maneira independente. A utilizacão de medidores de fração de áagua capazes de medir a fracçãao de áagua de cada zona permite aos operadores e e engenheiros de reservatário monitorar continuamente as fraçães de água e áleo produzidas, permitindo a detecçcãao de uma frente de áagua numa determinada zona de produçao [20].
•	Medição da produção no mainfold principal: os medidores de fraçao de água tambám podem ser utilizados na saáda de um mainfold para permitir a avaliaçcãao da produçcaão de um conjunto de poçcos.
•	Medição da produção e de custódia: os medidores de fraçao de agua são utilizados na saáda de oáleo de separadores primáarios, de maneira a corrigir pequenos desvios da produção devido à presença de quantidades mánimas de água.
1.5	Objetivos
O presente trabalho se insere em um projeto de pesquisa, dentro do DAS/USFC (Departamento de Automação e Sistemas), cujo objetivo final á o desenvolvimento, anáalise e calibraçcaão de um protáotipo de um medidor de vazãao multifáasica de baixo custo, nãao intrusivo, capaz de medir as fraçcãoes dos componentes do escoamento multifáasico (áagua/áoleo/gaás) e suas vazãoes volumáetricas. Para tal áe necessáario o desenvolvimento e avaliaçcãao das diversas partes constituintes do sistema de mediçcãao multifáasico.
A primeira etapa do projeto consiste no desenvolvimento de um medidor de fraçcãao de áagua que utilize tecnologia de microondas. Para avaliar algumas das diversas táecnicas de inferêencia utilizando-se microondas foi construáda uma bancada para ensaios. Para que os testes fossem possáveis tambáem foi desenvolvida uma unidade micro-processada de controle e aquisiçcaão de sinais. A unidade de controle e aquisiçcãao desenvolvida para a bancada de testes áe a base da unidade de processamento do protáotipo do medidor de fraçcãao de áagua.
Os objetivos do trabalho sao abaixo listados:
•	Desenvolvimento de uma unidade de controle e aquisicçãao de dados, utilizando um processador digital de sinais (DSP), com comunicacçãao em rede atraváes do protocolo Modbus TCP/IP com um software supervisário;
•	Desenvolvimento de um software supervisério, em ambiente Windows, para a aquisiçcõao de dados e configuracçõao da unidade de aquisicçõao e controle.
•	Construcçõao de uma bancada de testes estíaticos para avaliaçcõao das diversas técnicas de inferância utilizando microondas para misturas bifésicas homogeneizadas.
•	Avaliacçõao da viabilidade das téecnicas de medicçõao baseadas na tecnologia de microondas para a utilizaçcõao na mediçcõao da fracçaõo de éagua em aplicaçcõoes da industria de petréleo e gés.
Os resultados do presente trabalho sõao importantes para o desenvolvimento de um medidor de fraçcõao de éagua industrial e, posteriormente, um medidor multiféasico. A principal simplificação assumida no trabalho é a composiçao bifasica (égua/éleo) do fluido. Na presença de gés, sao esperados erros na determinaçõo da fraçõo ou da porcentagem de éoleo na mistura, quando se utiliza somente um medidor de fraçcõao de éagua.
Tõo importante quanto os resultados obtidos nos testes é o domínio da tecnologia de instrumentaçcõao baseada em microondas. Tal tecnologia possui um custo relativamente alto. De uma maneira geral, quanto mais alta a frequância, maiores os custos dos equipamentos eletrâonicos necesséarios. Aléem disso, a maior parte dos componentes e equipamentos utilizados sao para uso na industria militar ou na industria aeroespacial, fato este que encarece e dificulta ainda mais a compra e o desenvolvimento com tal tecnologia.
1.6	Organizacao da Dissertação
No capítulo 2 é realizada uma revisõo condensada da bibliografia referente a medidores de microondas. Sõao apresentados alguns fundamentos teéoricos sobre a tecnologia de microondas de maneira a proporcionar àqueles que nao sõo da area uma introduçõo ao assunto.
No capítulo 3 é apresentado o sistema experimental, constituído da bancada de testes e mediçcõao. Cada uma das partes constituintes da soluçcõao adotada ée detalhada e justificada.
No capétulo 4 sõao apresentados os resultados experimentais obtidos com o sistema. Tambéem saõo descritos e comentados os ensaios que foram realizados para a obtençcõao dos resultados apresentados.
No capítulo 5 são apresentadas as conclusões do trabalho. A eficácia do sistema experimental de mediçao e das tácnicas de medição estudadas são comentadas. Tambám são apresentadas sugestões para trabalhos futuros, bem como uma lista de possíveis melhorias.
Capítulo 2
Fundamentos Teéricos
Neste capítulo é realizada uma revisão bibliográfica da literatura. São apresentados, de maneira condensada, alguns fundamentos teoricos sobre eletromagnetismo, interaçao das ondas eletromagnéticas com os materiais e sensores de microondas. O objetivo é introduzir o assunto àqueles que nao são da área. O conteudo do presente capítulo foi todo extraído da literatura, assim como a maior parte das figuras mostradas. A fonte de referência das figuras é mostrada na sua descriçao. Os temas são abordados de maneira introdutária e ilustrativa. Para mais detalhes devem-se consultar as referências sugeridas para o tema.
2.1	Ondas Eletromagnéticas
As chamadas Microondas, assim como a luz visível e os raios-X, são ondas eletro-magnéeticas. O que difere as microondas das demais ondas eletromagnéeticas ée o seu comprimento de onda A, ou sua frequência. O comprimento de onda A e a frequência f se correlacionam através da velocidade de propagaçao c, dada pela equação 2.1. A figura 2.1 mostra como é dividido e categorizado o espectro eletromagnético.
Af = v.	(2.1)
A radiacçaão eletromagnéetica possui uma natureza dual, comportando-se tanto como onda quanto como partécula ao mesmo tempo. O comportamento de partécula ée explicado pela fésica quantica. De acordo com a fésica quântica, a energia eletromagnética tem uma natureza discreta e nãao pode existir em quantidades arbitréarias, mas sim em multiplos da menor quantidade possével, chamada de quantum (ou féton no caso da luz visével). A energia de um quantum se relaciona com a frequência através da equacão
Figura 2.1: Espectro eletromagnético
Eq = hf,	(2.2)
onde Eq é a energia do quantum e h é a constante de Planck (h = 6,626 x 10-34Js). Assim, nas altas freqUências (parte superior do espectro) o comportamento de partícula é acentuado, por isso falamos em raios (raios Gama e raios-X). No entanto, na faixa das microondas a energia do quantum é muito pequena e, portanto, podemos desprezar o comportamento partícula e considerar as microondas como ondas somente.
2.2	Propagação das Ondas Eletromagnéticas
As ondas eletromagnéticas podem propagar-se livremente através do espaço (ar ou vácuo, por exemplo) ou através de linhas de transmissao, ou guias-de-onda. As ondas eletromagnéticas também podem propagar-se através dos materiais, estando, no entanto, sujeitas a níveis de atenuação maiores ou menores dependendo, de uma maneira geral, da permissividade, da permeabilidade e da condutividade do meio, aléem da frequência da onda eletromagnética que se propaga. A propagação das ondas eletromagnéticas é descrita através das equaçães de Maxwell [11], [9], [6], as quais não serãao aqui mostradas nem abordadas, pois fogem do escopo do presente trabalho.
O fenêmeno da propagacão eletromagnética, seja no vacuo ou através de outro meio qualquer, é regido por três propriedades do meio: pela permissividade elétrica [e], pela permeabilidade eletromagnetica [^] e pela condutividade [a]. As duas constantes se correlacionam atraves da equação 2.3, conhecida como a equação de onda eletromagnética.
d 2E
V2E -	= 0,	(2.3)
onde E e a intensidade do campo eletrico. A velocidade de propagaçcãao de uma onda num meio depende das constantes de permissividade e permeabilidade do material. Para meios sem perda a velocidade de propagação pode ser expressa pela equação
V	=	(2.4)
Os valores das constantes de permissividade (ou dieletrica) e permeabilidade no vacuo sãao
e0 = 8.854 x 10 12	[F/m]	(Farad/metros),	(2.5)
//,, = 4n x 10 7	[H/m]	(Henry/metros)
(2.6)
Para os valores acima, a velocidade de propagaçao c0 é de 2.998 x 108m/s, que e a velocidade de propagação da luz no vacuo. Por volta de 1860 Maxwell determinou que a velocidade de uma onda eletromagnetica corresponde a 193.088 milhas por segundo. Nessa epoca a melhor medida direta existente da velocidade da luz era 193.118 milhas por segundo. A partir dessa informacão, Maxwell chegou a conclusão que a luz deveria ser um fenêomeno eletromagnéetico [1].
2.3	Interação das Microondas com os Materiais
As microondas propagam-se em praticamente qualquer meio, sendo afetadas pelo meio em diversas maneiras. Os materiais naão-condutores, ou que sãao póessimos condutores, são chamados de materiais dielótricos. Nos materiais dielótricos, devido as in-teraçcoães eletromagnóeticas das ondas com as cargas elóetricas dos materiais (elóetrons, óons, molóeculas polares), ou entãao com os dipolos magnóeticos do meio, as microondas sãao atenuadas.
A atenuacão de um sinal de microondas ó normalmente medida em decibóis dB. A atenuacçãao da amplitude de um campo óe dada pela equaçcãao
Ae(dB) = 20logw(.	(2.7)
Por ser a potâencia proporcional ao quadrado da amplitude do campo, a atenuacçãao, ou ganho, na potâencia do sinal eletromagnóetico óe dada pela equaçcãao
Ap(dB) = 10logw (.	(2.8)
Conforme apontado anteriormente, a interação das ondas eletromagnóticas com o meio depende das constantes de permissividade e permeabilidade do meio. As duas constantes sãao expressas matematicamente como nuómeros complexos, conforme descrito abaixo
P“r — j^r ,	(2.9)
er = er — jer.	(2.10)
O óndice r nas equaçães acima indica que tratam-se de grandezas relativas. A referância nesse caso ó a permissividade elótrica e0 e a permeabilidade p,0 do vócuo. As grandezas se relacionam atravóes das equacçoães
6	6r 60;	(2.11)
— ftr 1^0'
(2.12)
As propriedades eletromagneticas do meio sõao, portanto, descritas atraves de quatro constantes praticamente independentes (4, ,Pr ■ /'"), as quais, por sua vez, dependem de outras propriedades físicas do meio (como por exemplo: mistura, composiçõo, densidade, temperatura, entre outras) e também da frequência de mediçõo utilizada.
Através do conhecimento da relaçõo entre er, pr e as propriedades de um dado material, pode-se inferir sobre a composicçõao, ou mistura, do material atravées da anéalise dos parâametros de propagaçcõao da onda nesse meio. Para materiais nõao magnéeticos podemos assumir //,. = 1. Nesse caso, o problema fica reduzido a análise da constante de permissividade eléetrica do material.
Aléem dos fatores de propagaçcõao do meio, este tambéem interage com as ondas ele-tromagnéeticas atravées da refraçcõao e reflexõao das ondas. Tais interaçcõoes nõao seraõo aqui descritas, pois fogem do escopo e dos objetivos do presente trabalho. A reflexõao das ondas eletromagnéticas é o princípio bésico de sistemas de radar. Mais informacões sobre esse tipo de interaçcõoes e sistemas, podem ser encontradas em [6], [11].
2.4	Propriedades Dielétricas dos Materiais
Os materiais sõo normalmente compostos de partículas eletricamente carregadas, as quais se arranjam de tal maneira que qualquer regiõao macroscéopica do material tornase eletricamente neutra. Quando submetida a um campo elétrico externo Ee, este age como uma forçca externa, alterando o equilébrio natural da regiaõo a ele submetida. As partéculas positivas e negativas movem-se em direçcoões opostas, polarizando a regiõao. Essa polarizaçao produz um campo elétrico interno (EQ inferior ao campo externo. A permissividade relativa ée uma medida dos efeitos polarizantes na forçca do campo, ou seja, quõao facilmente o meio ée polarizado.
A parte complexa de er, ou seja e^ (ver equacõo 2.10), esté relacionada à capacidade dissipativa do meio, e nos da uma medida da atenuacõo imposta pelo meio à propagaçao de uma onda eletromagnéetica atravées desse. Num meio onde héa perdas dieléetricas, a energia eletromagnética é gradualmente transformada em calor. Tal perda é devida a fricçcaõo provocada pelo deslocamento das cargas eléetricas quando o material se polariza. A polarizaçcõao ocorre constantemente, em sincronia com o campo eléetrico alternado induzido pela propagaçao da onda eletromagnética através do meio. O valor de er é sempre positivo e normalmente muito inferior a er .O menor valor para er é zero, num meio onde nõao héa perdas dieléetricas.
A parte real de er, ou seja er (ver equacao 2.10), esta relacionada a alteracões na relacçaõo entre as intensidades dos campos eléetricos e eletromagnéeticos. A relacçõao entre
as intensidades dos campos elétricos e magnéticos caracteriza a impedancia da onda. A parte real de er também está relacionada a velocidade de propagacao da onda no meio. Isso implica num atraso no tempo de propagaçao da onda, relativo a onda que se propaga no vécuo. Este fenomeno também pode ser interpretado como um atraso na fase do sinal transmitido. A equação abaixo é uma correlação aproximada, para materiais nao magnéticos e com baixas perdas dielétricas (er er) [9]
co
c =
(2.13)
2.4.1	Propriedades Dielétricas da Agua
Devido às características dielétricas da agua, é comum a utilizaçao de medidores de microondas na determinaçcaão da fraçcaão de aégua de uma mistura. As moléeculas de égua, devido a sua estrutura molecular peculiar, caracterizam um dipolo permanente, conforme mostrado na figura 2.2. Este dipolo permanente cria na molécula de égua um momento de dipolo diferente de zero. Devido a esse momento permanente das moléeculas de éagua, a éagua léquida ée considerada uma substaência polar.
Figura 2.2: Molécula de agua
A permissividade da égua e altamente dependente de fatores externos como a temperatura e a salinidade. Com o aumento da temperatura, a forca das ligacães dos étomos de hidrogênio se enfraquece. O efeito do enfraquecimento de tais ligaçães é que a parte real da permissividade elétrica se reduz. O dipolo se movimenta com mais facilidade e em mais altas frequências, reduzindo as perdas dielétricas (fator complexo da permissividade elétrica), e o arrasto no movimento de rotaçao das moléculas é reduzido,
causando menos friccão e, conseqUentemente, menos perdas dieietricas tambem. A presença de sais dissolvidos na agua altera a estrutura natural das moieculas, reduzindo o fator real da permissividade eletrica do meio [7].
Por se tratar de uma substância polar, a permissividade da agua obedece à relaçao de Debye [9]. Alem disso, caso a agua possua sais dissolvidos, e necessario se levar em consideraçao no calculo da permissividade eletrica o termo referente à condutividade da agua. A permissividade eletrica pode ser expressa pela equação
7	7
	 7	| ^rs__________® ^r_______________________^r&lt;x +	J ,
1 + JUT
(2.14)
onde e'r^ e a permissividade optica, para altas frequâncias (quando u to), ers e a permissividade estatica, para baixas frequâncias (quando u 0), t e o tempo de relaxaçcãao e esta associada com a constante de tempo da resposta da polarizaçcãao a um degrau no campo eletrico, e a corresponde a condutividade do meio.
No grafico da figura 2.3 e mostrado como a permissividade eletrica da agua pura varia com a temperatura para diferentes frequâncias. As linhas vermelhas correspondem a variacão da parte real da permissividade eletrica (¿,) com a temperatura, enquanto as linhas verdes correspondem a variaçcãao da parte imaginaria da permissividade eletrica (e'r). No grafico 2.4 sao mostradas as mesmas curvas do grafico 2.3 para a agua com uma concentraçao de sais de 10ppt.
Figura 2.3: Variaçao da permissividade eletrica da agua pura com o aumento da temperatura para diferentes frequóncias [7]
Figura 2.4: Variaçao da permissividade elótrica da ógua salgada (10 ppt) com o aumento da temperatura para diferentes frequências [7]
A influência da presença de diferentes concentracões de sais na constante dielótrica da agua ó mostrada com mais detalhes na figura 2.5, para uma frequência fixa.
Figura 2.5: Variaçao da permissividade eletrica da agua salgada com o aumento da temperatura para diferentes concentraçcoões de sais [7]
A combinacçõao dos graficos anteriores pode ser qualitativamente representada pelo
gráfico 2.6, onde as linhas tracejadas ilustram as variações da constante dielétrica da água na presença de sais e as setas representam o sentido da variaçõo da constante dielétrica com o aumento da temperatura.
Wavelength (cm)
Figura 2.6: Variação da permissividade elétrica da água com a freqüência, temperatura e concentraçao de sais [7]
2.5	Geração, Transmissão e Processamento de Sinais de Microondas
Para a geracão, transmissao, recepção e processamento de sinais de microondas são necessários diversos componentes passivos e ativos (estado sálido), específicos para este tipo de sinal, os quais são conectados através de guias-de-onda. Dentre os componentes passivos podemos citar: antenas, guias-de-onda, cabos coaxiais, terminadores, atenua-dores, divisores de potência x, filtros, isoladores, circuladores 1 2, entre outros. Alguns exemplos de componentes ativos, ou de estado-solido, são: osciladores, VCOs (Voltage Controlled Oscilators), detectores, interruptores 3, misturadores 4, amplificadores e atenuadores controlaáveis.
1do inglês power dividers
2do inglês circulators
3do inglês switches
4do inglês mixers
Pela classificaçcãao acima, sãao considerados ativos todos os componentes de estado-séolido. No entanto, outras classificaçcãoes consideram como ativos componentes que possuem resistência negativa e que são capazes de gerar um sinal de RF a partir de uma polarização DC [6].
2.5.1	Parâmetros de Sistemas de Microondas
Um sistema de microondas é composto por diversos componentes, passivos e ativos, interconectados por linhas de transmissão. A eficiência do sistema como um todo é calculada atraves do conhecimento da eficiência de cada uma das partes que o compoem. Para medir a eficiência de cada um dos componentes, incluindo as linhas de transmissão, são utilizados diversos parêmetros. Alguns dos parêmetros mais importantes sãao apresentados a seguir:
a)	Coeficiente de Reflexao
A reflexao de uma parcela da potência do sinal transmitido entre dois componentes ocorre quando não ha um casamento da impedência característica da linha de transmissao, Z0, com a impedancia de entrada do componente, ZL. O coeficiente de reflexao rL também pode ser determinado em funcao de Z0 e ZL, onde o casamento das impedências (Z0 = ZL) proporciona a maxima transferência de potência e, consequentemente, um coeficiente de reflexãao nulo, conforme a equacçãao [6]
Fl =
ZL — Z0
ZL + Z0
(2.15)
A potência refletida Pr por um dado componente pode ser calculada através do coeficiente de reflexão conforme a equação [6]
Pr = |Fl|2Pí»,
(2.16)
onde Pin é a potência incidente. A potência efetivamente transmitida Pt para o componente é dada pela diferença entre Pin e Pr.
b)	Coeficiente de Onda Estacionária (VSWR)
O coeficiente de onda estacionária VSWR (do inglês Voltage Standing Wave Ratio) está relacionado às interacoes entre o sinal incidente e o refletido. Nos casos onde
não há o casamento entre a impedancia característica da linha de transmissão com a impedancia de entrada e, portanto, uma parte da potência incidente á refletida, a interação entre a onda incidente e a refletida produz um padrão de onda estacionária ao longo da linha de transmissão. O VSWR pode ser expresso em funcão do coeficiente de reflexao rL do componente, conforme a equacao
VSWR =
1 + |Fl
1 -|Fl
(2.17)
c)	Perdas de Inserção e Perdas de Retorno
As perdas de inserção 5 (IL) e as perdas de retorno 6 (RL) de um componente são dadas pelas equações 2.18 e 2.19 respectivamente.
IL =10log(,
RL = 10 log t yA = 2°l°g |Fê,
(2.18)
(2.19)
onde Pt é a potência efetivamente transmitida ao componente e Pin é potência incidente no componente.
d)	Potência de Saída (dBm)
As medidas em decibéis [dB] sao normalmente relativas, ou expressam algum tipo de ganho. No entanto, a escala logarítmica também pode ser utilizada para expressar valores absolutos de potêencia, sendo para tal necesséario que se estabeleçca uma unidade de referência. Em sistemas de microondas sao normalmente utilizadas como referências 1mW e 1W. A unidade dBm é expressa em dB relativos a 1mW, conforme a equacão abaixo
P (dBm) = 10 log P (mW).	(2.20)
Utilizando-se a formula acima obtém-se que uma medida de 0dBm de potência é equivalente a 1mW, assim como uma medida de 30dBm equivale a 1W. A unidade dBW tem 1W como potência de referência. Assim sendo, 0dBW equivale a 1W, bem como — 10dBW equivale a 0,1W.
5do inglês Insertion Loss
6do inglês Return Loss
2.5.2	Componentes de um Sistema de Microondas
Abaixo são descritos cada um dos componentes/modulos que serão utilizados no sistema. Para mais detalhes sobre a construçao e os princípios funcionais dos componentes utilizados no sistema de microondas ver [23] e [25].
a) Antenas
As antenas sao componentes que irradiam e captam ondas eletromagnéticas. Tratam-se de dispositivos recíprocos, ou seja, uma mesma antena pode ser utilizada para transmitir ou receber os sinais de microondas. As antenas sãao responsaíveis pela transicao das ondas guiadas e confinadas as guias-de-onda para o espaço livre e viceversa. Enquanto as guias-de-onda são projetadas para apresentarem o mínimo possível de perdas por irradiacçãao, as antenas por sua vez sãao projetadas para irradiarem ao míaximo. As antenas podem ser classificadas de acordo com a sua geometria, com o ganho, com sua direcionalidade e com a largura da sua banda.
Por se tratar de um componente com a apenas uma porta, ou conexão, a impedância de entrada e o VSWR da antena podem ser descritos através do coeficiente de reflexão rL da antena, de acordo com a equaçao 2.17, mostrada anteriormente. Uma antena ideal deveria possuir VSWR = 1, ou seja, toda a potância incidente Pin é transmitida para a antena e não ha perda por reflexao. No entanto, para a maior parte das aplicacoes um VSWR &amp;lt;2 é aceitável.
A largura de banda de uma antena 7 é definida como uma faixa de frequâncias para a qual o desempenho da antena estía em conformidade com algum padrãao. Um padrao normalmente empregado é um VSWR &amp;lt;2, o qual implica numa reflexão de aproximadamente 11% da potância incidente. Assim, a largura de banda da antena (BW) corresponderia à faixa de frequâncias para o qual o VSWR da antena é menor ou igual a 2.
A diretividade de uma antena Dmax é uma medida comparativa das propriedades direcionais de uma antena qualquer em relacçãao a uma antena isotréopica, a qual possui, por definicão, Dmax = 1. Uma antena isotrópica é uma antena teórica, que nao pode ser realizada na pratica, que irradia energia igualmente em todas as direçcoães. A eficiâencia n de uma antena e dada pela equação
n = P	'"P ■	(2.21)
Prad i Ploss
7do inglês bandwidth
onde Prad ó a potância efetivamente irradiada pela antena e Ploss ó a diferenca entre a potância incidente na antena Pin e Prad.
O ganho G de uma antena ó dado pelo produto da diretividade Dmax pela eficiância n da antena. De uma maneira geral, quanto mais concentrada no espaço for a região de irradiação da antena, maior seró o seu ganho. Na figura 2.7 sao mostradas comparativamente as distribuiçcãoes espaciais da irradiaçcãao de trâes tipo de antenas.
Figura 2.7: Tipos de antenas - comparação dos diagramas de radiação [6]
b) Divisores de Potência, Acopladores e Acopladores Híbridos
Os Divisores de Potância 8, Acopladores 9 e os Acopladores Hóbridos 10 sao componentes utilizados para combinar ou dividir sinais. Um sinal incidente num desses componentes pode ter sua potâencia de incidâencia divida em 2 ou mais portas. A potância nas portas de saídas pode ser igualmente divida, o que equivale a um fator de acoplamento de 3dB, ou possuir outros valores para os fatores de acoplamento. Alóm disso, o sinal numa das portas de saóda pode ser defasado em relação às outras portas, caracterizando um acoplador do tipo hóbrido (hybrid). Enquanto os componentes do tipo Acoplador e Acoplador Hóbrido normalmente possuem 2 portas de saóda, podendo apresentar fatores de acoplamento diferentes de 3dB ou defasagem entre os sinais das portas, os componentes do tipo Divisor de Potâencia costumam apresentar mais de 2 portas, todas com sinais idâenticos. Estes tipos de componentes podem ser utilizados, por exemplo, em alimentadores de antenas, discriminadores de frequância,
8do inglês Power Spliters
9do inglês Couplers
10do inglês Hybrids
misturadores balanceados de sinais, moduladores, deslocadores de fase, detectores de fase, entre outras aplicares.
c)	Isoladores e Circuladores
Os isoladores e circuladores sao componentes não recíprocos. Isso implica que os coeficientes de transmissão não são os mesmos para diferentes direcães de propagacao. Um isolador normalmente apresenta uma baixa atenuacão na transmissão de sinais da porta 1 para a porta 2, mas no sentido inverso, ou seja, na transmissão de sinais da porta 2 para a porta 1, este apresenta uma grande atenuação, conforme mostrado na figura 2.8a. Normalmente este tipo de componente é utilizado na protecão de fontes de energia como, por exemplo, osciladores e amplificadores, impedindo que a potência refletida devido a um descasamento de impedências danifique o equipamento gerador, conforme ilustrado na figura 2.8b. Dessa forma, o componente inserido anteriormente a um isolador num sistema de geracçãao enxerga uma impedêancia perfeitamente casada, uma vez que não ha reflexão de energia. Na pratica, a inserção de um isolador num sistema de microondas sempre ocasionara uma perda de potêencia no sistema.
Figura 2.8: Isoladores (a)Funcionamento e (b)exemplo de Aplicacõo [6]
Os circuladores costumam apresentar 3 portas, conforme ilustrado na figura 2.9. Para o circulador ilustrado na figura 2.9, um sinal incidente na porta 1 é acoplado a porta 2 somente, assim como um sinal que incida na porta 2 e somente acoplado a porta 3, e um sinal incidente na porta 3 é somente acoplado à porta 1. Os circuladores sõo uteis para o roteamento e separaçao de sinais, por exemplo, em sistemas que utilizam uma unica antena para a transmissõao e recepçcõao de sinais, conforme ilustrado na figura
2.9.
Figura 2.9: Aplicação típica de um circulador [6]
d)	Detectores e Misturadores
O detector é um componente que converte a intensidade de um sinal de microondas numa tensão DC. Também pode ser utilizado para demodular sinais de microondas, reconstruindo sinais de baixa frequências. A detecção é obtida através da utilização de componentes com características não-lineares de I-V (corrente - tensão) como, por exemplo, junçoes p-n e junçães do tipo Schottky-barrier. Na figura 2.10 sao ilustrados 3 exemplos do funcionamento dos detectores.
Figura 2.10: Aplicações de detectores para (a)medir a intensidade de uma microonda, (b)demodular um sinal pulsado e (c)demodular um sinal analógico [6]
Os misturadores 11 sao componentes utilizados para a conversao de frequências. Um mesmo componente pode ser utilizado tanto como upconverter ou downconverter.
11 do inglês mixers
Os misturadores possuem 3 portas: LO (Local Oscilattor, ou freqüência de referência), RF (sinal em alta freqüência modulado) e IF (intermidiate-frequency signal . Quando utilizados para modular um sinal em alta frequência (upconverter), o sinal presente na porta RF (saída modulada) e resultado da multiplicaçao do sinal de IF com LO. Quando utilizados na demodulacao de um sinal de alta frequência, o sinal presente em IF (saída demodulada) é resultado da multiplicação do sinal de RF por LO. As duas possíveis situacães sao ilustradas na figura 2.11, na qual é dada ênfase para os resultados no domínio da frequência (subtracão e adicao). Na figura 2.12 é ilustrado o funcionamento do misturador como um multiplicador de sinais no domínio do tempo.
Figura 2.11: Aplicações de Misturadores [6]
Figura 2.12: Misturador como um multiplicador de sinais [6]
e)	Atenuadores, Interruptores e Deslocadores de Fase
Atenuadores, Interruptores 12 e Deslocadores de Fase 13 são componentes que proporcionam um controle eletrônico sobre a atenuação e a fase de sinais de microondas. Estes tipos de componentes podem ser construídos com ferrites ou dispositivos de estado-solido (como didos p-i-n ou FETs) sendo que os componentes de estado-sólido costumam ser mais rópidos, leves e baratos. Os interruptores são classificados de acordo com o numero de pólos que possuem, ou seja, o numero de portas de saída que possuem (por exemplo: SPST, SPDT, SP3T). Teoricamente, os interruptores, quando ligados, não deveriam inserir nenhuma atenuacão no sinal. Bem como quando desligados nao deveriam permitir nenhuma transferencia de potôncia. No entanto, os interruptores reais acabam inserindo alguma perda ao sinal quando ligados e permitindo que uma parcela pequena de potôncia seja transferida quando desligados. Na figura 2.14 ó mostrado um exemplo de aplicaçcãao de um interruptor.
Sourve
Bilis
(digital information)
—-*■
Output
0 10 10 0 0 10
Figura 2.13: Exemplo de aplicação de um interruptor [6]
Os interruptores também são utilizados na construção de Deslocadores de Fase. O atraso da fase óe obtido forçcando-se o sinal a percorrer um caminho de comprimento diferente do caminho normal. A figura 2.14 ilustra o funcionamento de um Deslocador de Fase.
Em componentes de estado sóolido, o chaveamento óe obtido atravóes da variacçãao da impedôancia do dispositivo. A variaçcãao da impedôancia óe obtida atravóes de diferentes estados de polarizaçcãao. Alterando-se a polarizaçcaão continuamente pode-se obter nóveis contónuos de atenuacçãao dos sinais. Este tipo de componente óe conhecido como ate-nuador controlóvel (normalmente por uma tensao analógica), ou atenuador varióvel, e entre outras aplicacçãoes sãao utilizados no controle automóatico de ganho em sistemas de recepçcãao e processamento de microondas.
12 do inglês switch
13do inglês Phase-Shiffters
/
Figura 2.14: Utilizacão de um interruptor na construçao de um deslocador de fase [6]
f)	Osciladores e Amplificadores
Os osciladores e amplificadores sãao componentes ativos, sendo constituádos de algum dispositivo de estado sáolido capaz de produzir resistêencias negativas quando devidamente polarizado. Enquanto uma resistência positiva dissipa a potência de sinais de microondas, introduzindo perdas, uma resistêencia negativa áe capaz de produzir sinais eletromagnáeticos a partir de uma polarizaçcãao DC do dispositivo de estado-sáolido.
Os osciladores sãao utilizados como fontes de microondas em transmissores e como osciladores locais (LO) em moduladores e demoduladores (upconverters e downconverters). Dependendo da forma que sao construídos, a frequência de oscilação pode ser variada continuamente, normalmente atraváes de uma tensãao, caracterizando um oscilador controlado por tensão, ou simplesmente um VCO. Alguns dos parâmetros mais importantes na caracterizacçãao dos osciladores saão: potêencia de saáda, a DC-to-RF efficiency, a relação sinal-ruído, a estabilidade e a faixa de variação da frequência.
O amplificador é um dispositivo que proporciona um ganho na potência do sinal nele incidente. Um amplificador pode ser cascateado com outros amplificadores de modo a se obter um ganho maior. Os amplificadores que sãao utilizados no uíltimo estágio de um transmissor, de maneira a proporcionar uma alta potência de saída, sao chamados de Amplificadores de Potência. Os amplificadores utilizados na recepcão de sinais normalmente possuem uma boa relaçcãao de sinal-ruído, sendo chamados de LNA (Low-Noise Amplifier). Alguns parêmetros importantes para um amplificador saão: o ganho, a relaçcãao sinal-ruído, a largura de banda e a estabilidade. Um bom amplificador naão deve apresentar oscilaçcãoes na sua banda de operaçcãao. A estabilidade do amplificador é a sua resistência a oscilação.
2.6	Tipos de Medidores de Microondas
Um meio pode afetar as microondas que nele se propagam de diversas formas. A maneira como o meio vai afetar as microondas depende das constantes de permeabilidade e permissividade desse, as quais, por sua vez, dependem de outras propriedades físicas do meio. O conhecimento da natureza da dependência de er e p,r das demais propriedades fésicas do meio nos permite inferir sobre as propriedades do meio atravées da mediçcãao destas constantes dieléetricas. A mediçcãao das constantes dieléetricas do meio, por sua vez, pode ser realizada com base no estudo da maneira como o meio afeta um sinal de microondas, cujos parêametros sejam inicialmente conhecidos. O tipo de medidor, ou téecnica de medicçaão, de microondas utilizado depende do parêametro de propagaçcãao que se deseja medir. Aléem disso, o tipo do medidor de microondas e a maneira mais adequada de se medir um dado parêametro dependem das caracterésticas do meio. Os medidores de microondas podem ser classificados em 5 categorias [9][20], as quais serão sucintamente abordadas na secães subsequentes, e em sensores especiais para aplicaçcãoes especéficas.
2.6.1	Sensores de Transmissao
Esta ée a concepcçaão mais direta e simples para um medidor de microondas. Neste tipo de medidor sãao utilizados um transmissor, um receptor e um par de antenas, normalmente do tipo corneta (horn). As duas antenas costumam ser instaladas de maneira que o material a ser medido, ou MUT, fique entre elas, conforme mostrado na figura 2.15. O medidor mostrado na figura 2.15 tambéem ée conhecido como Free-Space Transmission Sensor. Nesse arranjo, a permissividade do meio afeta tanto a amplitude como a fase da onda que se propaga atravées deste.
A principal vantagem deste tipo de medidor ée a sua simplicidade. A principal desvantagem é a sensibilidade deste tipo de medidor às reflexões no interior do sistema. As reflexões afetam diretamente a precisao na mediçao da atenuação. Se a secão transversal do MUT é superior a A/4 e a atenuação do meio é pequena, as multiplas reflexães internas vãao provocar o aparecimento de ondas estacionéarias entre as superfécies do MUT, adicionando uma variação periédica à atenuação medida [9].
Por outro lado, a mediçcãao da fase ée muito menos afetada pelas muéltiplas reflexãoes e pelas ondas estacionéarias do que a medicçãao da atenuaçcãao. A fase ée medida com a utilizaçcãao de um Misturador. Para tal, se faz necesséaria a utilizaçcãao de um sinal de referêencia, idêentico ao sinal transmitido, mas que nãao seja afetado pelo meio. A medida do atraso de fase corresponde a uma tensão DC na porta IF (ver seçao 2.5.2) do Misturador. Isto se deve ao fato de se obter, como resultado da multiplicaçcãao de
V
R
Figura 2.15: Sensor de Transmissão [9] duas ondas idênticas, porém defasadas, um sinal DC proporcional ao defasamento das ondas.
No entanto, a medicao da fase esta sujeita ao problema da ambiguidade da fase [26]. Este problema esté associado ao fato de que a medicão do êngulo da fase sé é possével para valores entre -180° e +180°. Caso a seção transversal do material a ser medido seja maior que o comprimento de onda no material, o problema da ambiguidade de fase pode aparecer. Uma maneira de se eliminar o problema da ambiguidade de fase é realizar a medicão do atraso de fase em duas frequências distintas. Para mais detalhes sobre esta téecnica de mediçcãao ver [26].
Outra maneira de realizar a medicão das constantes dielétricas do material, evitando os problemas das multiplas reflexães, das ondas estacionárias e da ambiguidade de fase, é através da utilizacão da técnica de FMCW (Frequency-Modulated Continuous Wave [20]. Esta téecnica, normalmente utilizada em sistemas de radar, mede na verdade o atraso no tempo sofrido pelo sinal ao atravessar o meio. A técnica consiste em realizar uma variacão contínua e linear da frequência de transmissão do sistema. Na prética isto equivale a realizar uma modulacão em frequência (FM) do sinal a ser transmitido. O sinal recebido ée entãao multiplicado pelo sinal original. Devido ao atraso temporal sofrido pelo sinal recebido, o resultado da multiplicacçãao dos dois sinais produz um sinal analógico, em baixa frequência, com uma frequência de batimento na porta IF do Misturador utilizado para a multiplicação dos sinais. A frequência de batimento esta diretamente relacionada ao atraso sofrido pelo sinal. O método de FMCW é ilustrado na figura 2.17. Para mais detalhes sobre este método, ver [6].
Aléem dos problemas jéa citados na utilizaçcãao desse méetodo de inferêencia, existem alguns outros inconvenientes que precisam ser levados em consideraçcaão. A mediçcãao direta tanto da atenuaçao quanto da fase é afetada diretamente pela não-linearidade e
Figura 2.16: Método de FMCW [6]
pela sensibilidade dos detectores de fase e de intensidade. A principal causa de erros e variações nesse tipo de medicao é a temperatura do meio, a qual afeta diretamente sua constante dielétrica. Isto implica na necessidade de que se utilize algum tipo de compensação de temperatura no sistema de medicao. Uma outra alternativa ao problema da sensibilidade deste tipo de método é através da medição frequente de um padrao conhecido. Atraves dos desvios na medição do padrâo, podem-se corrigir os valores da medicao de interesse. Na figura 2.17 é ilustrado a configuração de um sistema de medicçãao de atenuaçcãao e atraso de fase utilizando-se um medidor tipo sensor de transmissão. As linhas tracejadas indicam algumas alternativas, já citadas, para a compensaçcãao dos erros inerentes a essa concepcçãao de medidor.
Outro metodo comumente empregado na melhoria do desempenho deste tipo de sensor e o metodo da mediçao balanceada14 [9]. Este metodo de mediçao utiliza-se de elementos controlaveis, como atenuadores controlaveis e deslocadores de fase controlaveis,
14tradução do inglês: Balancing Method
Figura 2.17: Sistema para medicao da atenuacão e da fase [9] para manter os néveis dos sinais incidentes nos detectores dentro de uma determinada faixa, reduzindo a influência da não-linearidade e da reduzida faixa dinamica de alguns dos sensores. Trata-se, na verdade, de um método de inferência em malha-fechada, no qual a principal informacao sobre as características dielétricas do meio provém do esforço de controle necessério para se manter as mediçães do sistema numa dada referência. A utilização desse método permite que os detectores do sistema operem no ponto étimo de sua faixa dinômica, maximizando assim parâmetros metrolégicos do sistema.
2.6.2	Sensores de Ressonância
Para se medir o fenôomeno da ressonôancia de uma microonda ée necesséario primeiro criar condiçcãoes para que tal fenôomeno apareçca. Para tal, sãao normalmente utilizadas cavidades ressonantes. Uma cavidade ressonante pode ser descrita como sendo uma linha de transmissãao limitada por descontinuidades de impedôancia em ambos os lados [9]. Aléem da cavidade ressonante, o fenôomeno da ressonaôncia requer que um campo eletromagnéetico seja criado dentro da cavidade. As microondas precisam ser geradas atravées de um circuito externo e entaão, atravées de uma abertura ou antena, irradiadas no interior da cavidade. As descontinuidades de impedaôncia fazem com que a microonda que se propaga seja refletida diversas vezes. O fenôomeno de ressonôancia séo ocorre em frequôncias especificas e requer que a condiçao de ressonancia seja satisfeita. A condição de ressonancia, dada pela equacão 2.22, é satisfeita quando a relação entre o comprimento da onda e as dimensãoes da cavidade assume determinados valores.
2l +	+ fa = n • 2n
A
(2.22)
onde l é comprimento da cavidade (ou linha de transmissõo), ^1 e sao os angulos de fase dos coeficientes de reflexõo das extremidades da cavidade, e n é um inteiro.
A condiçõo de ressonência acima descrita vale para uma cavidade ressonante vazia. Caso a cavidade seja preenchida com algum material dielétrico, a frequencia de ressonência ocorrera numa frequência inferior, uma vez que o comprimento de onda depende da constante dielétrica do meio. Para os casos em que er » o comprimento de onda pode ser expresso em funçao da permissividade elétrica através da equaçõo [9]:
Ao
(2.23)
A permissividade eléetrica pode ser entãao calculada de forma aproximada em funçcãao da frequência de ressonência da cavidade vazia e da frequência de ressonancia preenchida com um dado material dieletrico. Para os casos em que «r » «r a permissividade eléetrica do meio pode ser aproximada pela equacçãao 2.24.
«r « (f)2-	(2.24)
fr
onde fr0 é a frequência de ressonência da cavidade vazia e fr é a frequência de ressonência obtida na presença de um determinado MUT.
Para a medicçãao da constante dieléetrica do meio atravées de um medidor de res-sonaência, ée necesséario primeiro induzir um campo eletromagnéetico dentro da cavidade. A variaçao da frequência das ondas irradiadas na cavidade, dentro de uma faixa determinada, permitirá a ocorrência do fenomeno de ressonância. A deteccão do fenômeno de ressonência fr pode ser realizada através da medicão da atenuaçao ou da fase, ou ambas, utilizando-se 2 técnicas [20]: através da medicao do coeficiente de reflexao na linha utilizada para transmitir o sinal de microondas para a cavidade (ver figura 2.19), ou atravées da mediçcãao do coeficiente de transmissãao, com a utilizaçcaão de um receptor independente dentro a cavidade (ver figura 2.20). Nas figuras 2.18 e 2.19 sao mostrados os comportamentos esperados de fase e amplitude para uma faixa de frequências préxima na vizinhança de fr para as técnicas de coeficiente de reflexão e de coeficiente de transmissãao, respectivamente.
Os medidores de cavidade de ressonência ja foram muito estudados por [9] e [20]. E nãao serãao aqui abordados em mais detalhes pois fogem do escopo do presente trabalho.
Figura 2.18: Gráfico da fase e magnitude num medidor de coeficiente de reflexão com fr = 1.5GHz [20]
2.6.3	Sensores de Reflexão
Os sensores de reflexão medem as características do sinal refletido por um objeto, atraves da transmissão de um sinal conhecido. Os sensores de reflexao podem ser classificados em sensores de contato ou sensores de espaço livre, quando utilizados para medir as propriedades dieláetricas dos materiais, ou ainda como sensores de radar, quando utilizados na medição da distancia e velocidade de objetos. Na industria de petráleo e gas, este tipo de sensor á utilizado na medicão de nável em tanques [27], ver figura 2.20, e em alguns casos na mediçao de parâmetros de escoamento, conforme ilustrado na figura 2.21.
Os sensores de contato utilizam linhas de transmissao ou guias-de-onda abertas numa das extremidades. E esta extremidade aberta que deve ser colocada em contato com o objeto ou meio do qual se deseja medir as propriedades dieláetricas. O coeficiente de reflexao da extremidade aberta r tem suas características de fase e amplitude afetadas pela constante dielátrica ér do meio. Os sensores de espaco livre funcionam de maneira similar, no entanto enquanto nos sensores de contato as linhas de transmissãao são colocadas em contato com o objeto, nos sensores de espaco livre são utilizadas antenas para a transmissão e recepcão do sinal refletido. Ambos os mátodos permitem a inferância sobre o coeficiente de reflexão r complexo do meio e sobre sua permissivi-dade.
Figura 2.19: Gráfico da fase e magnitude num medidor de coeficiente de transmissão com fr = 1.5GHz [20]
Figura 2.20: Sensor de ressonancia utilizado na medição de nível de um tanque de oleo de um navio [9]
Os sensores do tipo radar, ao contrario dos demais tipos de sensores ate agora discutidos, não sao utilizados na medição das propriedades dos materiais e sim na mediçao de distância, movimento, vibrações, interfaces, entre outros. De acordo com o princípio de funcionamento os radares podem ser classificados em: radar de pulso, radar de impulso, radar FMCW (Frequency Modulated Continuou Wave) e radares de efeito Doppler.
O tipo de radar mais simples e o radar de pulso. Nesse tipo de radar, a onda portadora e transmitida apenas por um pequeno intervalo de tempo com a utilizaçcãao
Figura 2.21: Princípio de funcionamento de um medidor de parâmetros de escoamento utilizando um sensor de reflexao [9]
de um interruptor (switch), conforme ilustrado na figura 2.22. Sendo a velocidade de propagaçao c conhecida, com base no tempo que a onda refletida demora para retornar ao sistema, é possível calcular a distancia do objeto, conforme a equaçao
2l c ’
(2.25)
onde l é a distancia do objeto e c é a velocidade de propagação da onda no meio.
Quanto menor o tamanho do pulso, maior a resoluçcãao do sistema. Quando se deseja maximizar a resoluçcãao do sistema e a maxima distaência do objeto a ser medido e pequena, utiliza-se o radar de impulso. Neste tipo de radar o pulso transmitido e reduzido ao maximo. E importante ressaltar que quanto menor o pulso, maior e a banda necessaria e pior e a imunidade aos ruídos.
O radar de efeito Doppler e normalmente utilizado na medicao da velocidade de um objeto. Isto se deve ao fenômeno físico conhecido como efeito Doppler. O efeito Doppler é caracterizado pela alteracão da frequôncia do sinal recebido em relação ao sinal transmitido. Tal fenomeno ocorre quando o objeto sob analise esta em movimento em relacao ao sistema de mediçao. Nesse tipo de radar um sinal de frequôncia constante é continuamente transmitido. O desvio de frequôncia (fd) do sinal refletido pode ser calculado com a utilização de um misturador (mixer) e se relaciona com a velocidade do objeto sob anaélise atravées da equaçcãao
2v
fd = — X fo,	(2.26)
c
onde vr é a velocidade relativa do objeto, c é a velocidade de propagacao da onda no meio e f0 é a frequôncia do sinal transmitido.
No radar de FMCW a frequôncia do sinal transmitido e continuamente variada,
Figura 2.22: Princópio de funcionamento de um radar de pulso [6]
com a utilizacão de um VCO, para cima e para baixo entre duas frequâncias f1 e f2, conforme mostrado na figura 2.23. A frequância do sinal recebido seró, portanto, diferente da frequância do sinal sendo transmitido. A diferença entre as frequâncias (fiF) transmitida e recebida pode ser entao calculada atravós da utilizaçao de um misturador (mixer), sendo dada pela equação
fiF = t^) ,	(2-27)
onde T ó o tempo de propagação da onda desde o momento que foi transmitida ató o momento de sua recepçao, e T ó o peróodo da onda modulada.
O radar tipo FMCW pode ser utilizado tanto na determinaçao da distância quanto da velocidade do objeto. Caso o objeto esteja em movimento, relativamente ao sistema de medição, haveró um deslocamento na frequância recebida pelo sistema. Para mais detalhes ver [6].
t
Figura 2.23: Princípio de funcionamento de um radar de FMCW [9]
2.6.4	Sensores Radiométricos
Os radiômetros, como são chamados, medem a intensidade da radiação térmica de corpo negro 15 irradiada por um objeto. Essa radiação é a mesma que objetos quentes emitem nas frequôncias da luz visível quando se tornam incandescentes. Para a faixa das microondas, a intensidade da irradiaçao é diretamente proporcional a temperatura do objeto, sendo no entanto dependente da sua constante de emissividade. A constante de emissividade do objeto esta relacionada às propriedades dielétricas e dimensionais da superfície e a sua capacidade de refletir e absorver ondas eletromagnéticas. Um corpo negro ideal possui emissividade igual a 1. Toda a sua radiaçao térmica é irradiada atraves da sua superfície, assim como esse absorve toda radiação (e consequentemente luz) nele incidente. Na pratica, os objetos possuem emissividade menor que 1 e portanto uma parte da sua radiacçãao téermica ée refletida e nãao consegue transpor a superfécie do objeto. Na figura 2.24 é ilustrado o princépio de funcionamento de um radiômetro.
O radiômetro de microondas é um sensor, suficientemente sensível, capaz de detectar a radiaçcãao téermica de corpo negro de um objeto na faixa das microondas. Os radiôometros saão considerados passivos pois eles apenas captam as radiaçcãoes téermicas emitidas por um objeto. Esse tipo de sensor ée amplamente empregado no monitoramento da superfície terrestre por satélites e avioes. Dentre algumas das aplicações de monitoramento da superfécie terrestre, podemos citar: o monitoramento de incôendios florestais, o monitoramento da camada de gelo polar e o monitoramento de vazamentos de óleo nos oceanos. Na industria sao utilizados na mediçao remota da temperatura de processos, onde devido as altas temperaturas, ou ainda outros fatores, nao é possével a utilizaçcaão de sensores de contato ou de infravermelho. Tambéem saão citadas na litera-
15do inglês black-body radiation
Figura 2.24: Princípio de funcionamento de um radiometro, onde Tp é a temperatura do objeto, Tb é a temperatura de brilho e n é a emissividade [9]
tura aplicacões desse tipo de sensor na medicina [9].
2.6.5	Sensores Tomograficos
A interacçaão das microondas com os materiais tambíem pode ser utilizada na produção de imagens do interior de um objeto ou de um meio. Essa técnica de medição é amplamente empregada na medicina, com a utilizacão de sensores de raios-X e de ressonancia magnética para a visualizacão do interior do paciente. A tomografia utilizando microondas é realizada através da utilização de um arranjo de sensores 16 que captam sinais de microondas que foram transmitidos através do objeto, ou meio, em diferentes posicães, conforme mostrado na figura 2.25. A distribuição geométrica dos sensores varia de acordo com a aplicação. Quando utilizados na mediçao de parêmetros de escoamento em tubos (aplicaçao tépica na industria de petróleo e gés) sao normalmente dispostos radialmente ao redor do tubo.
Os sensores utilizados na construçcaão de um toméografo sãao praticamente os mesmos utilizados num sensor de transmissaão de espaçco livre. Assim como num sensor de transmissãao, os sensores do toméografo medem a atenuaçcãao e o atraso de fase do sinal. No entanto, em vez de utilizar um unico sensor, na tomografia de microondas sao
16do inglês array of receivers
SENSOR ARRAY
Figura 2.25: Princípio de funcionamento de tomógrafo de microondas [9] utilizados vórios sensores. A reconstrução da imagem com base nos dados adquiridos pelos diversos sensores requer vórios caiculos e demanda um processamento computacional significativo, sendo essa uma das principais limitaçães desse tipo de sensor. Na industria de petróleo e gas, este tipo de sensor ó utilizado na determinação do tipo de um escoamento multifósico [20].
2.7	Conclusões
No presente capótulo foi apresentada uma breve introducçãao ao eletromagnetismo. As microondas foram caracterizadas como ondas eletromagnéticas. Os fenomenos decorrentes da interaçcãao das ondas eletromagnóeticas, e mais especificamente as microondas, com os materiais foram apresentados, ainda que em caróater introdutóorio. As peculiaridades dielóetricas da óagua foram descritas, caracterizando as vantagens da utilizaçcaão dos sensores de microondas para a mediçcaão da fraçcãao de aógua. Os componentes utilizados na construcçãao de um sistema elóetrico de geraçcaão e processamento de microondas foram apresentados, bem como os principais parâmetros utilizados na especificação desses componentes. Foram apresentados os tipos de sensores de microondas existentes e suas principais aplicacçãoes. Os princópios de construçcãao de tais sensores tambóem foram abordados.
No próoximo capótulo seróa apresentado o sistema experimental desenvolvido no presente trabalho. O sistema de geração e processamento de microondas utilizado na bancada experimental seró descrito em detalhes, bem como o sistema digital de controle e aquisiçcãao que permite a utilizacçaão da bancada experimental de testes.
Capítulo 3
Sistema Experimental Desenvolvido
No presente capétulo é apresentado o método desenvolvido. Trata-se de uma bancada de medição e testes construída para avaliar a viabilidade dos sensores de microondas na mediçcãao da fraçcãao de éagua. Nãao soé as téecnicas serãao avaliadas, mas tambéem toda a concepçcaão do sistema de mediçcaão. O sistema experimental foi desenvolvido para permitir a realizaçcaão de testes estaéticos com uma mistura bifaésica de éagua e éoleo. Os testes sãao estéaticos pois naão héa vazãao. Nos ensaios estaéticos sãao utilizados tanques, com dimensãoes semelhantes a uma tubulaçcãao de produçcãao, os quais sãao enchidos com uma composiçcãao que reproduz as propriedades fésicas, relevantes para o presente trabalho, encontradas num escoamento real.
Os sub-sistemas que compoãem a bancada de testes e o medidor propriamente dito foram projetados segundo requisitos de um medidor industrial. Dessa forma, apés verificada a eficécia de um determinado tipo de sensor, e determinados os parêmetros ideais para a mediçcaão da fraçcaão de aégua, toda a infra-estrutura utilizada na bancada pode ser utilizada no desenvolvimento do protéotipo de um medidor industrial de fraçcãao de éagua. Podemos citar alguns requisitos indispenséaveis para medidores industriais:
•	comunicacao em rede;
•	fonte de alimentação dedicada, robusta e confiével;
•	funcionamento automaético;
•	interface de configuraçcãao e parametrizaçcãao dedicada e especéfica;
•	mecanismos de auto-diagnéostico e sinalizacçãao de falhas;
•	acondicionamento adequado às condiçães operacionais.
A solução adotada pode ser subdividida em 8 sistemas, que juntos compõem o sistema experimental e a bancada de testes utilizada nos ensaios. Os subsistemas que compõem a soluçõo implementada sõo abaixo listados:
•	sistema de geraçõo e processamento de sinais de microondas;
•	sistema digital de controle e aquisiçõo de dados;
•	sistema de comunicaçcõao embarcada;
•	sistema de alimentacõo elétrica dos sistemas eletrônicos e de microondas;
•	sistema computacional do Concentrador de Dados;
•	sistema computacional de interface com o usuario;
•	sistema de medicçoões auxiliares;
•	sistema de suporte aos ensaios.
Na figura 3.1 é mostrada a arquitetura do sistema desenvolvido, onde se destacam os diferentes sub-sistemas. Estes subsistemas serõo descritos nas préximas secões.
3.1	Sistema de Geração e Processamento de Microondas
Para o projeto do sistema de geraçao e processamento de microondas foi selecionada a frequôncia central e banda de operacõo do medidor. Durante a revisõo bibliográfica, verificou-se que a frequôncia mais comumente utilizada nesse tipo de medidor é de 2,4GHz. No entanto, conforme apresentado no capítulo 2 (2.5), na presença de sais, a atenuaçao da água, para sinais dessa frequôncia, e muita alta. A frequôncia escolhida para o medidor foi de 10GHz. Nessa frequôncia, as perdas dielétricas da água sõo maiores do que na frequôncia de 2,4GHz. No entanto, a presenca de sais na água influencia muito pouco as perdas dielétricas do meio para sinais da frequôncia de 10GHz. A maior atenuaçõo da agua para a frequôncia escolhida pode ser vista como um ponto positivo uma vez que, em teoria, quanto maior a atenuaçcõao, maior a sensibilidade do instrumento de medicçõao de fraçcõao de éagua. Apesar disso, podemos apontar como uma desvantagem da maior atenuaçcõao do sinal a necessidade da transmissõao de um sinal de maior potôncia. Também é importante ressaltar que quanto maior a frequôncia de operaçcõao, mais caros sõao os equipamentos necesséarios. O comportamento do sistema
Sistema de Medições Auxiliares
Figura 3.1: Arquitetura do sistema de ensaios com microondas
de mediçcaão na presençca de sais ée um parêametro importante no projeto de um medidor de fraçcãao de éagua para a induéstria de petréoleo e géas, uma vez que uma parcela significativa dos poçcos de produçcãao encontram-se abaixo do leito oceêanico.
Para o problema da determinaçcaão da fraçcãao de éagua numa mistura bifaésica de éoleo e aégua, o tipo de sensor de microondas mais utilizado e adequado, segundo diversos autores [9][20][3], ée o sensor de ressonaência. No entanto, optamos pelos sensores de transmissãao como objeto de estudo do presente trabalho. A opçcãao pelos sensores de transmissãao deve-se ao fato de ser este o tipo mais simples de sensor para a aplicaçcaão em questãao. Tambéem podemos ressaltar o fato de que o sistema de geraçcãao e processamento de microondas utilizado nesse tipo de sensor ée muito similar ao sistema utilizado em sensores de ressonêancia, mudando apenas a téecnica de inferêencia de um para o outro. Uma vez validado o sistema de geraçcãao e transmissãao de microondas para sensores de transmissaão, o desenvolvimento de um sensor de ressonêancia se caracteriza como uma melhoria natural para o sistema. O sistema de geraçcãao e processamento de microondas ée formado pelos seguintes componentes :
•	Antenas tipo Corneta: optou-se por antenas desse tipo devido ao alto ganho, ou diretividade, destas. Eé provéavel que numa etapa futura de desenvolvimento estas antenas sejam substituédas por antenas de outro tipo, mais compactas. Sãao utilizadas duas antenas: uma dedicada a transmissao de sinais e outra somente para a recepcão. As antenas utilizadas tem ganhos de 10dBi e 20dBi.
•	VCO: a utilizaçcãao de um oscilador controléavel deve-se ao fato de este permitir a realização de ensaios numa faixa de frequências em torno da frequência central. Além disso, o VCO é um componente indispensével na realizacao de determinados tipos de ensaios e na construção de diversos tipos de sensores. A frequência de oscilação do VCO utilizado pode ser variada de 8GHz a 12GHz.
•	Interruptor: quando ligado, o interruptor insere uma atenuaçao mínima de 60dB no sinal transmitido. Na préatica isso equivale a desligar o sistema de transmissãao. Da maneira como foi projetado o sistema, a utilizacçãao do interruptor permite que a transmissãao de microondas soé ocorra quando uma mediçcãao for necessaéria, evitando assim a transmissaão conténua de sinais de microondas.
•	Divisor de Potência: este componente passivo permite a ”divisão”de um sinal em dois sinais idêenticos, em fase, mas com metade da potêencia do sinal original. Sãao utilizados dois divisores de potêencia no sistema. Um divisor ée utilizado na replicaçcãao da onda gerada pelo VCO, a qual serve de referêencia para o céalculo do atraso de fase devido à propagação da onda pelo meio dielétrico. O segundo divisor permite que o sinal recebido pela antena de recepçcãao tenha sua intensidade e atraso de fase medidos.
•	Amplificador de Potência: o amplificador de potância ó o ultimo elemento do sistema antes da transmissãao do sinal. A potâencia de saóda móaxima do amplificador selecionado ó de 30dBm, ou 1000 mW.
•	Atenuador Controlado por Tensão: este componente ó utilizado pois permite o ajuste contónuo do nóvel do sinal recebido. O ajuste contónuo do sinal permite que a intensidade do sinal incidente na porta RF do misturador seja mantida constante, otimizando o funcionamento do misturador e, consequentemente, a mediçcãao do atraso de fase. Esse procedimento tambóem mantóem constante a intensidade do sinal incidente no detector, impedindo que este sature. A medicçãao da intensidade do sinal recebido óe feita indiretamente atravóes do conhecimento do sinal de controle utilizado no atenuador controlaóvel. O controle da atenuaçcãao óe linear e feito por uma tensãao analóogica.
•	Misturador: o misturador ó um componente passivo utilizado no sistema para a medicçãao do atraso de fase.
•	Detector: o detector permite a mediçcaão da intensidade do sinal no sistema. Em comparaçcãao aos detectores passivos, os detectores ativos proporcionam sinais de mediçcãao de maior nóvel, devido a um circuito interno de amplificaçcãao.
As especificacçãoes tóecnicas dos componentes acima listados encontram-se no Apândice A. Na figura 3.2 ó mostrado o diagrama de blocos do sistema de geraçao e transmissãao de microondas. Os componentes de microondas sãao conectados atravóes de cabos coaxiais flexíveis, especificas para a frequância de operacão do sistema. Todas as guias de onda utilizadas possuem conectores SMA-fâmea em ambas as extremidades. A montagem dos componentes foi realizada sobre uma placa de acrólico, conforme pode ser visto figura 3.3. A placa de acrílico foi escolhida por se tratar de um material não condutor. A preocupaçcãao inicial com a montagem do sistema de microondas sobre uma superfócie nãao condutora mostrou-se desnecessóaria, uma vez que posteriormente verificamos que todas as carcaçcas dos componentes sãao aterradas. Tambóem foi constatado, posteriormente , durante a realizaçcãao dos primeiros testes com o sistema, a necessidade da utilizaçcãao de dissipadores de calor no VCO e principalmente no amplificador de potâencia do sistema. Durante a operacçãao esses componentes atingem altas temperaturas , tendo seu desempenho muito influenciado pela temperatura. O atenuador controlado por tensãao nãao funcionou corretamente e naão foi utilizado no sistema, como pode ser verificado na figura 3.3.
Figura 3.2: Diagrama de blocos do sistema de de geração e processamento de microondas
Figura 3.3: Foto do sistema de geração e processamento de microondas montado sobre uma placa de acrílico
3.2	Sistema Digital de Controle e Aquisição de Dados
A opcao pelo desenvolvimento dos sensores de microondas, em vez da utilização de equipamentos laboratoriais ou de bancada, implicou na necessidade de desenvolvimento de um sistema digital de controle específico, que atendesse aos requisitos do sistema de microondas. Conforme visto no capítulo 2, o funcionamento de tais sensores não é direto e simples, em alguns casos demandando a realização de um conjunto de procedimentos para a obtençao de uma medida (como por exemplo no caso de utilização de uma tecnica de FMCW). Nenhuma das soluçães de aquisição e controle disponíveis atendia a todos os requisitos do sistema de geraçcãao e processamento de microondas proposto. Alíem disso, os sistemas de aquisiçcaão de dados normalmente utilizados em
aplicaçcoães laboratoriais e de pesquisa naão atendem aos requisitos de uma aplicaçcãao industrial (ver lista de requisitos para sistemas industriais no inicio do capítulo).
Tendo em vista as razãoes acima expostas e o objetivo a móedio prazo de desenvolvimento de um medidor multifóasico industrial, um sistema digital de controle e aquisicçãao de dados foi desenvolvido. O desenvolvimento deste sistema teve como premissa bóasica a modularidade e o reaproveitamento de código e de hardware. Na pratica isso quer dizer que todo o sistema foi projetado não somente para atender às necessidades do atual projeto, mas para que tambóem pudesse ser aproveitado integralmente ou parcialmente em outros projetos. A primeira medida adotada para tornar o sistema embarcado modular foi a separaçcãao do moódulo de controle e aquisicçãao do móodulo de comunicaçcãao. O sistema embarcado de comunicaçcãao forma com o sistema de controle e aquisiçcãao a unidade de processamento do medidor de fraçcãao de óagua. A separacçãao do sistema de comunicaçcãao do sistema de processamento e controle tambóem implica numa melhora das caracterósticas de tempo real do sistema, uma vez que o controle e a aquisiçcãao sãao realizados por um processador dedicado e independente dos nãao-determinismos, caracterósticos da comunicaçcãao em rede, ficando essa tarefa a cargo do processador do sistema embarcado de comunicacçãao. Na atual secçãao seróa apresentado somente o sistema de controle e aquisiçcãao de dados, sendo o sistema embarcado de comunicaçcãao apresentado na seçcãao seguinte.
3.2.1	Características do Hardware
O sistema de controle e aquisicão possui um DSP de 16 bits com 40 MIPS (Milhoes de instruçcãoes por segundo), dedicado somente ao processamento dos sinais do processo. O modelo utilizado ó o dsPIC30F4013, fabricado pela Microchip. O sistema foi projetado com 4 entradas analogicas. A digitalizaçcãao dos sinais analogicos e realizada pelo conversor A/D interno do DSP, o qual possui resolucao de 12 bits e frequôncia de aquisiçao de ate 200 MHz. Os sinais analógicos do processo são primeiramente condicionados e depois filtrados (filtro analogico). A etapa de condicionamento consiste num amplificador de instrumentaçcaão modelo INA113, fabricado pela Texas Instruments. O ganho do modulo de condicionamento de sinais pode ser configurado de 1 a 500 com o auxilio de um jumper e de um potenciómetro. Apos ser condicionado, o sinal analogico óe entãao filtrado por um filtro analóogico. Foi utilizada uma aproximaçcaão tipo Butterworth ativa de quarta ordem. Alóm de filtrar as componentes de alta frequôncia do sinal analógico, o filtro tambóm funciona como filtro anti-recobrimento. A frequôncia de corte escolhida foi de 10 kHz. O digrama de Bode do filtro analogico implementado ó mostrado na figura 3.4. O sinal filtrado ó então amostrado pelo conversor A/D do DSP. O filtro anti-recobrimento foi projetado para funcionar com uma frequôncia de
aquisição de 40 kHz por entrada analógica. No entanto, a freqüência de aquisição do sistema ó configuróvel pelo usuório, sendo 40kHz por canal a freqüência móxima de aquisicao. A medida que o usuario reduz a frequência de aquisicao, a eficiência do filtro como filtro anti-recobrimento ó reduzida. Para mais informaçães sobre filtros analógicos, ver [10] e [28].
Figura 3.4: Diagrama de Bode do filtro anti-recobrimento
O sistema de controle e aquisição possuí 4 saídas analógicas. E utilizado um conversor D/A modelo TLV5618, fabricado pela Texas Instruments, no sistema. E importante ressaltar que o DSP nao possui conversor D/A integrado. O conversor escolhido possui resolucao de 12 bits. A comunicacão entre o conversor e o DSP é feita serialmente atraves do padrão SPI (Serial Peripheral Interface). O sinal analégico produzido pelos conversores D/A do sistema é filtrado através de um filtro analégico RC passivo de 1a ordem e entao condicionado através do módulo de condicionamento das saídas analéogicas. O méodulo de condicionamento das saédas analoégicas consiste de dois amplificadores por canal: um amplificador inversor e outro nãao-inversor. A escolha de qual dos dois amplificadores seré utilizado é feita através de um jumper na placa. O ganho do amplificador escolhido é configuravel através de um potenciómetro. Assim, devido à utilização dos dois tipos de amplificadores, o sinal analogico de saéda, ou controle, pode ter sua faixa configurada de 0V a 12V, ou de 0V a -12V. O sistema foi assim projetado porque alguns componentes do sistema de geracão e processamento de microondas utilizam sinais de controle negativos, enquanto outros utilizam sinais positivos. Aléem das entradas e saédas analéogicas, o sistema tambéem possui 2 entradas digitais e 2 saédas digitais, ambas isoladas do resto do sistema atravées de um ampli-
ficador de ganho unitário, que funciona como proteção. Para mais informações sobre condicionamento de sinais, amplificadores operacionais e microeletronica ver [12]. Na figura 3.5 á mostrado o diagrama de blocos do sistema de controle e aquisição de dados.
DSP
Filtro de anti-recobrimento
		
	Conversor	
	D/A	
		
Proteção
Condicionamento de sinais
Filtro de reconstrução
z BARRAMENTO
DE .COMUNICAÇÃO
Dll
DI2
► DOI
* DO2
&lt;—All '&amp;lt;—AI2
&lt;—AI3
&lt;—AI4
Condicionamento de sinais
►	AO1
►	AO2
►	AO3
►	AO4
Figura 3.5: Diagrama de blocos do sistema controle e aquisição de dados
Os componentes e modulos constituintes do sistema de controle e aquisicão de dados foram montados numa PCI (Placa de Circuito Impresso), juntamente com o sistema embarcado de comunicacão, que sera descrito na proxima seção. O layout da placa foi realizado seguindo as recomendações e procedimentos de compatibilidade eletromagnetica para placas de circuito impresso. A título de ilustração, o desenho da placa á mostrado na figura 3.6. A placa á alimentada por uma fonte de tensão simetrica de ±15 V. A placa possui um pequeno modulo de alimentação que, alem das tensães de +15V e -15V, fornece tambem +5V e +3,3V, para os componentes da placa. Foram utilizados somente componentes PTH (Placement Through Hole) no projeto devido à simplicidade de prototipação e fabricacão oferecida por esse tipo de tecnologia, se comparada com a tecnologia de SMT (Surface Mount Technology). Na figura 3.7 é mostrada uma foto da unidade de processamento do sistema, composta pelo sistema de controle e aquisicçãao de dados e pelo sistema embarcado de comunicacçãao. O diagrama esquematico do sistema de controle e aquisição encontra-se no Apendice B.
3.2.2	Características do Firmware
O firmware do DSP do sistema de aquisiçao e controle foi desenvolvido em linguagem C, utilizando o ambiente de desenvolvimento MPLab da Microchip. O compilador utilizado foi C30 da Microchip, especifico para a família de DSPs dsPIC30 da Microchip. O firmware foi estruturado na forma de tarefas colaborativas e não bloqueantes atravás da utilização de diversas máquinas de estado, uma para cada tarefa. As tarefas que o DSP processa saão abaixo listadas:
Figura 3.6: Desenho da PCI da unidade de processamento do sistema
Figura 3.7: Unidade de processamento do sistema
•	Aquisição: leitura das entradas analógicas;
•	Filtro Digital: processamento dos amostras de acordo com o filtro digital configurado;
•	Controle: calculo do sinal de controle em malha fechada, quando configurado para tal;
•	Medição da Fração de Agua: realizaçao dos comandos para operaçao do sistema de geração e processamento de microondas;
•	Atualização das Saídas: atualização dos valores das saídas analógicas e digitais, quando necesséario;
•	Alarmes: envio de mensagens de alarme quando um determinado valor, ou condiçcãao, prée-estabelecida for atingida;
•	Comunicaçao: implementa a comunicação serial com o sistema embarcado de comunicaçcãao;
•	Manipulação da Memória Não-Volátil: leitura ou escrita da meméria não-voléatil que armazena os registradores de configuraçcãao do sistema;
•	Logging: uma variacão da tarefa de comunicacão para transferência de grandes quantidades de dados, em tempo real, atravées de um barramento paralelo.
A execuçao das tarefas acima descritas é regida pela interrupção do temporizador de aquisição, sendo que todas são executadas em todos os ciclos de aquisicão. O controle de execução de cada tarefa é regido por uma méquina de estados independente. Dessa forma, apesar de todas as tarefas serem solicitadas em todos os ciclos de aquisiçcãao, na maior parte das vezes elas retornam o controle prontamente à rotina principal, pois nada têem a executar. Essa organizaçcãao otimiza o desempenho de tempo-real do sistema. No entanto, nenhuma avaliaçcaão ou estudo mais aprofundado sobre o comportamento de tempo-real do sistema foi realizado pois foge do escopo do presente trabalho. Na figura 3.8 é mostrado o fluxo de dados através das diferentes tarefas do sistema de controle e aquisicçãao.
A interface com o sistema de comunicaçcãao embarcada ée realizada serialmente, atraves de uma implementaçao simplificada do protocolo Modbus SLIP. Os dados de logging são enviados através do barramento paralelo para uma meméria FIFO externa, pertencente ao sistema embarcado de comunicaçcãao, o qual seréa descrito na préoxima seçcãao.
O sistema de controle e aquisicão foi projetado para ser flexével e permitir a sua utilizaçcaão em diversas etapas do projeto e, inclusive, em outros sistemas e aplicaçcoães. O sistema de controle e aquisiçcãao pode ser configurado para operar em diferentes modos de operaçcãao. Abaixo sãao listados os posséveis modos de operaçcãao:
•	Modo Aquisição: nesse modo o sistema realiza somente aquisicão de dados. Um usuaério ou uma aplicacçãao podem ler as entradas analéogicas ou digitais quando
Memória não-volátil (configurações)
Aplicaçao de Usuário
Aquisição de Dados
Atualizaçao das Saídas
Figura 3.8: Fluxograma de dados no firmware do sistema de controle e aquisiçõo
desejarem ou o sistema pode realizar o logging das entradas automaticamente. O sistema tambem pode ser configurado para gerar alarmes quando uma determinada condiçõo for atingida. As entradas analégicas podem ainda ser filtradas pelo filtro digital do sistema.
•	Modo Controlador Manual: nesse modo um usuario ou uma aplicaçõo pode, além de monitorar as entradas do sistema, enviar comandos para as saédas analéogicas ou digitais do sistema.
•	Modo Controlador Automático: nesse modo o sistema pode controlar um processo de forma automéatica, de acordo com uma lei de controle previamente configurada nele.
•	Modo Filtro Digital: o sistema de controle e aquisiçao pode ser configurado como um filtro digital, continuamente amostrando um sinal analógico, processando o sinal digital e reconstruindo o sinal analoégico filtrado.
•	Modo Medidor de Fração de Agua: quando configurado nesse modo, o sistema assume uma çonfiguraçõo especéfica. Todas as tarefas do sistema sõo configuradas de uma forma pré-determinada. Os parámetros de çonfiguraçõo do usuério sao específicos para a realizaçõo dessa tarefa. O sistema possui ainda dois submodos quando configurado para operar no modo medidor de fraçao de aégua. No submodo teste o sistema realiza ensaios previamente determinados para avaliacõo do sistema e das diversas técnicas de inferôncia. No submodo medidor o sistema mede continuamente a fraçõo de agua do sistema, armazenando o valor
mais recente num registrador da memória, o qual pode ser lido, por exemplo, através de um software supervisório.
3.3 Sistema Embarcado de Comunicação
Conforme descrito anteriormente, o sistema embarcado de comunicaçao foi separado do sistema de controle e aquisiçao de dados com o objetivo de tornar mais modular o sistema. Apesar disso, ambos os sistemas são montados numa mesma placa, compartilham uma mesma fonte de alimentação e juntos constituem a unidade de processamento do medidor de fracçaão de óagua. A primeira etapa do projeto do sistema embarcado de comunicacão foi a escolha do protocolo de comunicaçao a ser utilizado. A decisão de qual protocolo implementar e adotar no desenvolvimento de uma unidade de processamento compacta, especifica e de baixo custo, conforme aqui apresentada, não é uma decisãao trivial. A implementaçcãao do protocolo de comunicaçcãao tem que ser realizada em nivel de hardware, ou meio físico, e em nivel de software. Além de determinar diversos aspectos do projeto de hardware e software do sistema embarcado, o protocolo de comunicação escolhido influencia a maneira como o medidor como um todo ira funcionar, determinando como se daré a interaçao desse equipamento com outros e com os usuarios e operadores do sistema. O sistema embarcado de comunicação foi projetado para atender aos seguintes requisitos de projeto:
•	robustez;
•	escalonabilidade do sistema;
•	capacidade de monitoramento, configuração e diagnóstico remoto;
•	baixo custo;
•	interoperabilidade e compatibilidade com outros equipamentos e sistemas;
•	alta velocidade de transmissãao de dados.
3.3.1	Protocolo de Comunicação
Com o avanço tecnológico surgiram, e surgem cada vez mais, novas necessidades de integração entre os sistemas produtivos, em seus diversos níveis (redes de campo, chão-de-fóbrica, supervisórios, sistemas de gestão, etc). Dessa forma, hoje em dia um instrumento de medicçãao nãao precisa somente medir a grandeza propriamente dita, mas
tambóem disponibilizar seus dados num sistema de informaçcãao mais amplo e integrado, bem como permitir alteracçãoes de configuraçcãao e o diagnóostico do seu funcionamento remotamente. Instrumentos que não são capazes de se integrarem num sistema computacional de informaçcãao, ou supervisãao, praticamente nãao existem mais no mercado. Instrumentos que utilizam padrãoes e protocolos de comunicaçcãao proprietóarios tambóem tâem perdido mercado para instrumentos que adotam um padrãao de comunicacçãao aberto ou homologado e mantido por uma organizaçcaão ou consóorcio de empresas.
Devido a redução dos custos dos microprocessadores e ao aumento exponencial da sua capacidade de processamento, os padroães de comunicaçcãao estãao cada vez mais complexos e incorporam nos instrumentos de mediçcaão e controle que os utilizam uma variedade de funcionalidades atóe pouco tempo sóo encontradas em sistemas computacionais de grande e módio porte, como: computadores industriais, pessoais e CLPs de grande porte. Dentre os diversos padroães existentes, podemos destacar alguns dos mais utilizados, como por exemplo: Fieldbus Foundation, Profibus DP, CAN e Modbus. Cada padrãao possui suas vantagens e desvantagens sendo que, em geral, cada segmento industrial acaba adotando um padrãao.
A escolha do protocolo de comunicaçcãao a ser implementado requer uma ponderacçãao entre requisitos do sistema, esforçcos de desenvolvimento e custos. Tendo em vista essas ponderaçães, a opçao foi pela utilizacão do protocolo Modbus TCP/IP. O Modbus ó um protocolo de comunicação criado em 1979 para permitir a comunicacao entre, e com, controladores e equipamentos industriais. A maioria dos CLPs utilizados nos mais diversos segmentos industriais adotam esse padrãao ou, no mónimo, possuem móodulos de expansaão compatóveis com o padrãao Modbus. Recentemente, a Modbus-IDA, as-sociaçcãao responsaóvel pela manutençcãao da especificaçcãao do protocolo Modbus, lançcou uma nova especificaçcãao: o Modbus TCP/IP. Desde entãao, tal padrãao tem tido crescente importância no mercado devido à sua facilidade de integração com os antigos equipamentos Modbus-RTA e tambem devido à sua simplicidade.
O protocolo Modbus TCP/IP ó um protocolo do tipo mestre/escravo, em que somente o mestre pode iniciar uma transmissaão no barramento. Certamente naão se trata de um protocolo de uóltima geraçcãao, que contempla em sua especificacçãao todas as funcionalidades requeridas pelos novos ’’equipamentos inteligentes”, com sua arquitetura de controle distribuódo. No entanto, para a grande maioria das aplicacçoães encontradas nas diversas etapas da cadeia de processamento do petróoleo (explotaçcãao, transporte, refino), o Modbus TCP/IP óe um protocolo robusto e confióavel, que atende aos requisitos dos sistemas de automaçcãao, controle e supervisãao requeridos. Alóem disso, trata-se de um protocolo aberto.
Como o nome sugere, o protocolo Modbus TCP/IP óe implementado sobre uma rede Ethernet. O padrão Ethernet tem ganhado cada vez mais espaço no mercado das redes
de campo. No entanto, este padrãao nãao implementa a camada de aplicaçcãao do modelo OSI. Faz-se, portanto, necesséaria a utilizaçcãao de algum outro protocolo que permita a comunicacçãao entre os instrumentos, e dos instrumentos com os sistemas de alto nével, no caso o protocolo Modbus TCP/IP. Dentre as vantagens da utilizacão do padrão Ethernet, podemos citar:
•	tecnologia de baixo custo;
•	padrao amplamente difundido e conhecido;
•	facilidade na integracçãao com sistemas de mais alto nével;
•	padrãao aberto;
•	permite alta velocidade de transmissãao de dados;
•	possibilita longas distêancias de comunicaçcaão sem necessidade da utilizaçcãao de repetidores.
3.3.2	Características do Hardware
No médulo de comunicação foi utilizado um microcontrolador PIC18F2620, de 8bits e 8MIPS, da Microchip. Para a interface com a camada fésica do protocolo de comu-nicaçao é utilizado um controlador Ethernet modelo ENC28J60, fabricado pela Microchip. A comunicaçcãao entre o microcontrolador e o controlador Ethernet ée realizada serialmente atravées de uma interface SPI. O controlador de Ethernet, aléem de implementar a camada física, implementa também a camada MAC do protocolo Ethernet. As demais camadas definidas pelo protocolo sãao implementadas no microcontrolador. Para tal ée utilizada uma biblioteca fornecida gratuitamente pela préopria Microchip, conhecida como ”pilha TCP/IP”(do inglês TCP/IP Stack). A referida pilha TCP/IP demanda um espaçco significativo na meméoria de programa do microcontrolador que a implementa. O microcontrolador, PIC18F2620 utilizado no presente projeto, possui 64kb de memória de programa (Flash), dos quais aproximadamente 34kb foram utilizados pelo sistema em questãao.
Aléem dos componentes acima listados, o sistema embarcado de comunicaçcãao também possui uma meméria RAM FIFO (Fisrt In First Out). A meméria FIFO ée utilizada como um elemento isolador entre o sistema embarcado de comunicaçcãao e o sistema de controle e aquisicçãao. A meméoria FIFO soé ée utilizada quando o modo logging é ativado. O fluxo de dados da comunicação de logging so ocorre num sentido, sendo que somente o sistema de controle e aquisiçcaão produz esse dados. O sistema
de comunicação lê esses dados e os envia via Ethernet para aplicação do usuário. O restante da comunicaçao entre os dois sistemas á realizado serialmente, atravás de uma implementação simplificada do protocolo Modbus. Esse tápico será abordado em mais detalhes na proxima seçao. A comunicação dos dados de logging pode demandar uma banda significativa do barramento de comunicacão, dependo da frequência de aquisicão e de logging configuradas. O sistema foi projetado para funcionar com qualquer memária FIFO da família IDT72XX, fabricada pela empresa americana IDT. As memárias dessa famália possuem capacidades que variam de 2kb a 64kb. A memária FIFO nãao áe um componente obrigatáorio no sistema. Eá possável, atraváes da utilizaçcaão de um cabo flat, conectar diretamente o sistema de comunicação ao sistema de controle e aquisição. Em teoria, o desempenho em tempo-real do sistema de controle e aquisição fica prejudicado quando não se utiliza a memoria FIFO. No entanto, não foram realizados estudos para determinar quantitativamente o desempenho em tempo-real do sistema. A placa montada para a realizaçcaão do presente trabalho nãao possui memoária FIFO devido a dificuldades técnicas encontradas na montagem do componente SMD (Surface Mount Device) da memária na placa.
O sistema de comunicacçaão possui ainda um circuito de proteçcãao e isolamento eláetrico do barramento Ethernet, conforme sugerido no datasheet do controlador ENC28J60. O conector RJ45 utilizado foi o modelo NU1S516, fabricado pela Bothhand. O modelo escolhido possui integrado um transformador de pulsos para cada par trancçado de co-municaçcaão. O transformador de pulsos do conector faz parte do circuito de proteçcãao do sistema de comunicacão. Na figura 3.9 á mostrado o diagrama de blocos do sistema de comunicacão. A placa PCI, sobre a qual o sistema de comunicacao foi montado, já foi apresentada na seçcãao anterior. Os diagramas esquemáaticos do sistema de comunicaçcãao encontram-se no Apêndice B. O sistema de comunicacão possui ainda 5 leds que sinalizam seu estado de funcionamento, sendo que 3 são integrados ao conector RJ45 e outros dois leds de 5mm são externos. O significado de cada led á abaixo descrito:
•	Amarelo RJ45: RX da comunicação Ethernet.
•	Verde RJ45: TX da comunicaçao Ethernet.
•	Vermelho RJ45: indicador de funcionamento (power) do sistema.
•	Amarelo 5mm: endereço IP configurado (manualmente ou via DHCP).
•	Verde 5mm: comunicação com o sistema concentrador de dados estabelecida.
Comunicação
Serial
Memória
FIFO
J BARRAMENTO DE
■ COMUNICAÇÃO
Figura 3.9: Diagrama de blocos do sistema embarcado de comunicaçao
3.3.3	Características do Firmware
O firmware do microcontrolador do sistema de comunicação embarcada foi desenvolvido em linguagem C, utilizando o ambiente de desenvolvimento MPLab da Microchip. O compilador utilizado foi o C18 da Microchip, especifico para a famólia de microcon-troladores PIC18 da Microchip. O firmware do microcontrolador e todo estruturado em funçcãao da implementaçcãao da biblioteca TCP/IP Stack da Microchip. A referida biblioteca óe organizada em tarefas cooperativas. Cada camada de nóvel do protocolo Ethernet óe implementada numa tarefa, que por sua vez óe implementada atravóes de móquina de estado finito [24]. A estrutura de camadas do padrão Ethernet e a maneira como esta ó mapeada nas tarefas da biblioteca TCP/IP Stack ó mostrada na figura
3.10.	Para mais detalhes sobre implementacão da comunicaçao Ethernet em sistemas embarcados ver [2] e [4].
Nem todas as camadas, ou tarefas, da biblioteca foram utilizadas. Abaixo sãao listadas as tarefas utilizadas no desenvolvimento do sistema de comunicaçcãao embarcada do móodulo de processamento do medidor de fraçcãao de óagua.
• MAC: camada de controle de acesso ao meio (Media Acess Control). Corresponde à camada 2 do modelo OSI, ou seja, a camada de Enlace de Dados. Alem de exercer o controle de acesso ao meio e propiciar os mecanismos baósicos de de-teccçãao de erros de transmissaão, esta camada óe responsaóvel pelo endereçco MAC, ou endereço físico do dispositivo de comunicaçao. O endereço MAC identifica unicamente um dispositivo numa rede Ethernet e óe o mecanismo bóasico, de mais baixo nóvel, de endereçcamento dentro do padrãao Ethernet. Esta camada nãao faz parte da biblioteca TCP/IP original da Microchip. Na verdade, a implementaçcãao dessa camada depende do controlador Ethernet utilizado, funcionando na verdade como um driver para o controlador Ethernet. No presente trabalho foi utilizada a tarefa
TCP/IP Reference Model
Microchip Stack Implementation
Application
Transport
Internet
Host-to-Network
Figura 3.10: Mapeamento das camadas do padrão Ethernet em tarefas na biblioteca TCP/IP Stack da Microchip [24]
MAC, ou driver, implementada especificamente para o controlador ENC28J60, a qual é fornecida gratuitamente pelo fabricante.
•	ARP: camada de resolução de endereços (Address Resolution Protocol). Corresponde a camada 3 do modelo OSI, ou seja, a camada de Rede. A funçao desse protocolo ée a resoluçcãao de endereçcos IPs em endereçcos MAC. A resolucçãao ée ne-cessaria, por exemplo, na determinação do endereço MAC de um dispositivo do qual séo se conhece o endereçco IP.
•	IP: camada de Internet (Internet Protocol). Corresponde à camada 3 do modelo OSI. Esse protocolo, ou camada, é responsével pelo endereçamento, roteamento e controle de envio e recepcão dos datagramas IP. A versão do protocolo utilizada ée a IPv4.
•	ICMP: camada de controle de mensagens de Internet (Internet Control Message Protocol). Corresponde à camada 3 do modelo OSI. Esse protocolo é normalmente utilizado no envio mensagens de erro ou anomalias na rede. Tambéem pode ser usado para obter informaçcãoes e realizar diagnoésticos sobre a rede. O serviçco de ping, por exemplo, utiliza esse protocolo para determinar se um dado dispositivo estaé acessével.
•	TCP: camada de controle de transmissão (Transmission Control Protocol). Corresponde à camada 4 do modelo OSI, ou seja, a camada de Transporte. Esse protocolo permite a transmissãao confiéavel de dados de um dispositivo a outro, sem duplicaçcãao ou perda de dados. Implementa serviçcos de detecçcaão de erros e
retransmissão de pacotes. E um protocolo orientado a conexões, ou seja, requer que primeiro seja estabelecida uma conexão entre dois dispositivos para que só então a transferência de dados possa ser iniciada.
•	UDP: camada de datagramas de usuório (User Datagram Protocol). Corresponde à camada 4 do modelo OSI. Esse protocolo permite a transmissão de dados de maneira rópida e com o mínimo de overhead possível no padrâo TCP/IP. Trata-se de um protocolo de transmissão não-confiável, pois não implementa nenhum mecanismo de controle ou integridade.
•	DHCP: camada de configuraçao dinêmica de dispositivos (Dynamic Host Configuration Protocol. Corresponde à camada 7 do modelo OSI, ou seja, a camada de Aplicaçao. A implementacão de um cliente DHCP permite a configuração au-tomaótica de diversos parêametros necessaórios para que o cliente opere numa dada rede IP, como por exemplo: endereco IP, móscara de rede e gateway padrão.
Alóem das tarefas acima descritas, que implementam as camadas de protocolo do padrão Ethernet, a biblioteca TCP/IP Stack também necessita, para o seu funcionamento cooperativo, da configuraçao da tarefa de gerenciamento da pilha (Stack Manager, a qual por sua vez coordena o funcionamento das demais tarefas. A tarefa de gerenciamento da pilha faz parte da biblioteca padrão distribuída pela Microchip.
Conforme citado anteriormente, a implementaçcãao do padraão TCP/IP, atravóes da biblioteca fornecida pelo Microchip, corresponde somente a uma parte do protocolo de comunicação adotado no sistema. Foi necessória a implementação do protocolo Modbus TCP/IP no sistema embarcado de comunicacçaão. O protocolo Modbus TCP/IP ó basicamente um cliente dos servicos oferecidos pelo protocolo TCP. Nesse sentido, os pacotes de dados transportados pelo protocolo TCP sãao, na verdade, os datagramas de requisiçcãao e resposta do protocolo Modbus TCP/IP. O protocolo Modbus TCP/IP corresponde a camada 7 do modelo OSI, ou seja, a camada de aplicação. Assim como o processamento dos demais protocolos, o processamento do protocolo Modbus TCP/IP tambóem óe realizado atravóes de uma tarefa colaborativa no sistema de comunicaçcãao embarcada. A tarefa do protocolo Modbus TCP/IP foi implementada de maneira nãao-bloqueante.
O protocolo Modbus TCP/IP foi implementado para funcionar somente como um escravo na comunicacçãao Modbus, apenas respondendo a requisiçcãoes de um mestre. A interaçcãao entre os sistemas embarcado de comunicaçcãao e de controle e aquisiçcãao se daó de maneira transparente para os equipamentos e usuóarios externos. Para todos os efeitos, o mestre Modbus enxerga apenas um dispositivo. Os endereçcos dos registradores Modbus sãao mapeados de maneira contónua e unóvoca, conforme exigido pelo protocolo. No
entanto, internamente o mapeamento desses registradores é divido entre os sistemas de comunicação e de controle e aquisição.
Da maneira como foi implementada no sistema, a tarefa Modbus TCP/IP identifica as mensagens Modbus TCP/IP recebidas pelo sistema, valida essas mensagens e então decide se a requisicçãao deve ser repassada ao modulo de controle e aquisiçcãao ou nãao. Na maior parte dos casos a solicitação e repassada ao sistema de controle e aquisicão. A requisicão Modbus repassada ao sistema de controle e aquisição e simplificada. Somente o PDU (simple Protocol Data Unity) da requisicão e repassada ao sistema de controle e aquisição. O sistema de controle e aquisiçao então processa a requisiçao recebida e retorna a resposta ao sistema de comunicação embarcada. O sistema de comunicação reconstrói o ADU (Application Data Unit) referente à implementação TCP/IP do protocolo e em seguida envia a resposta, atraves da rede Ethernet, ao dispositivo mestre solicitante. Na figura 3.11 e ilustrada a estrutura de uma mensagem Modbus TCP/IP. Para mais detalhes sobre o protocolo Modbus TCP/IP, ver [19] e [18]. O mapeamento dos registradores Modbus no sistema e suas respectivas funcães são descritos no Apêndice C.
Figura 3.11: Estrutura da mensagem Modbus TCP/IP [19]
Tarefa de Logging
O protocolo Modbus TCP/IP nao foi desenvolvido com o propósito de permitir que um registrador seja lido numa frequência muito alta, não sendo, portanto, adequado para a funcionalidade de logging do sistema. O proprio protocolo TCP/IP insere um overhead de comunicaçcãao muito alto, tornando a comunicaçcãao ineficiente de certa forma. Para aplicaçcoães que requerem taxas de transferêencia muito altas, ou streaming de dados, o protocolo UDP/IP e mais adequado. Para atender às necessidades de logging do sistema, foi implementada um tarefa de logging no sistema de comunicaçcãao, que assim como as demais ate agora descritas, funciona de maneira colaborativa e nãao-bloqueante. O mecanismo de logging do sistema utiliza unica e exclusivamente comunicaçao de dados sobre UDP/IP. Nem o sistema de comunicação, nem o sistema de controle e aquisicçaão foram projetados para armazenar grandes quantidades de dados do processo na sua memoria interna. Dessa forma, todo o logging propriamente dito do
sistema, ou seja, o armazenamento em memoria nao-volatil dos dados de processo, e realizado via rede atraves de um serviço implementado pelo sistema do concentrador de dados (que sera descrito na proxima seção), ou ainda por um serviço externo qualquer, desde que esse serviço implemente o protocolo de logging utilizado. A tarefa de logging, implementada no sistema de comunicaçao, apenas lâ os dados inseridos na memoria FIFO (ou diretamente enviados pelo barramento paralelo) e envia esses dados para o serviço de logging remoto configurado no sistema.
Para o funcionamento da funcionalidade de logging remoto no sistema foi necessaria a criação de um protocolo mínimo de comunicacão. Toda a operação de logging do medidor é coordenada pelo sistema embarcado de comunicação, mais especificamente pela tarefa de logging. Caso o sistema esteja configurado para realizar o logging, a tarefa de logging primeiramente solicita ao serviçco remoto de logging a criaçcãao de um canal de logging, de acordo com as configuraçcoães da unidade de processamento. Apos a confirmacçãao da criaçcãao do canal, a tarefa de logging entãao autoriza o modulo de controle e aquisicão a iniciar o envio dos dados. Os dados de logging recebidos pelo sistema saão empacotados de acordo com o protocolo definido e entãao enviados, via rede, para o serviço de logging remoto. Uma solicitação para finalizar o logging pode ser enviada pelo usuario, pela aplicaçcaão remota ou pelo proprio sistema de controle e aquisiçcãao. Quando o sistema de comunicacao recebe uma solicitacão de finalizacão de logging, este primeiro interrompe o logging no sistema de aquisiçcaão e controle, quando for o caso, e entaão solicita ao serviçco de logging remoto a finalizaçcãao do canal de logging criado. O protocolo de logging, criado para permitir o funcionamento de tal mecanismo, conforme descrito, é apresentado no Apândice D.
Tarefa de Recrutamento
O sistema de comunicaçcãao pode ser configurado com um IP fixo ou entaão utilizar o protocolo de DHCP para obter um endereço IP e suas configuraçães de rede. Quando configurado para utilizar o serviço de DHCP, se faz necessaria a utilizacão de algum mecanismo de cadastramento de equipamentos. Do contrario, um mestre nunca descobriria o endereçco de um dado equipamento, assim configurado, numa rede. Para solucionar esse problema foi criado um mecanismo de ”recrutamento”de equipamentos. Para tanto foi criada uma tarefa de recrutamento no sistema de comunicaçcãao. A tarefa de recrutamento segue as mesmas premissas das demais tarefas ate agora descritas. Para tal mecanismo de recrutamento funcionar e necessario que exista um serviçco re-crutador na rede. O serviçco recrutador e implementado no sistema do concentrador de dados, o qual sera descrito na proxima secçãao.
Quando o sistema de comunicacçaão embarcada obtem um IP atraves do servidor
DHCP da rede, a tarefa de recrutamento solicita ao recrutador da rede, via um broadcast, a sua inclusãao na lista de equipamentos da rede. A lista de equipamentos da rede pode entãao ser obtida por um mestre qualquer e o endereçco IP de um dado equipamento pode ser determinado. Os equipamentos sãao identificados atravées de IDs alfa-numéericas, definidas pelo usuaério. Aléem das IDs, o usuéario, ou aplicacçãao, pode utilizar os parêametros de descriçcãao do equipamento e tipo do equipamento para identificar univocamente um determinado equipamento. O protocolo de cadastramento foi implementado sobre o protocolo UDP, uma vez que demanda a transmissãao em broadcast de uma solicitaçcãao de um recrutamento. A descriçcãao do protocolo de recrutamento desenvolvido ée apresentada no Apêendice D.
3.4	Sistema Computacional do Concentrador de Dados
A unidade de processamento do medidor de fraçcãao de éagua foi, atée agora, apresentada e tratada como sendo uma unidade uénica na rede. No entanto, o sistema digital como um todo, formado pela unidade de processamento, sistema do concentrador de dados e sistema de interface com o usuéario, foi concebido para funcionar com diversos equipamentos numa mesma rede. Num cenéario onde existem diversos equipamentos e usuaérios operando esses equipamentos, um sistema concentrador se faz necesséario. O sistema computacional do concentrador de dados ée um serviçco de suporte a operaçcãao das unidades de processamento do medidor de fraçcaão de éagua. Aléem disso, o sistema do concentrador de dados implementa uma interface de comunicaçcaão de alto nével entre o sistema de interface com usuéario com as unidades de processamento. As funcionalidades oferecidas pelo sistema do concentrador de dados sãao abaixo listadas:
•	Servico de recrutamento de equipamentos: quando os equipamentos sao configurados para utilizarem o serviçco de DHCP para a obtençcãao de seus en-dereçcos de rede, faz-se necessaéria a utilizaçcãao de um mecanismo que resolva os endereçcos dos equipamentos. O serviçco de recrutamento recebe solicitaçcãoes de recrutamento e mantéem uma lista com os equipamentos presentes na mesma sub-rede na qual ele estéa instalado.
•	Serviço de logging: o registro de logging do equipamento não fica armazenado nele devido a limitaçcãoes da sua capacidade de armazenamento. O serviçco de logging ée o responséavel pelo registro dos dados de logging dos equipamentos da mesma rede na qual ele foi instalado. Os arquivos podem ser posteriormente consultados pela aplicaçcãao de usuéario.
• Servico de Webservices para operação do sistema digital: o serviço de
Webservices implementa uma interface de alto nível, orientada a serviços, para a configuração e operação das unidades de processamento do sistema. A consulta aos arquivos de logging e a lista de equipamentos recrutados na rede tambem é realizada atraves do serviço de webservices.
O serviço do concentrador de dados precisa ser instalado na mesma sub-rede em que as unidades de processamento serao instaladas. O serviço pode ser instalado no proprio servidor da rede ou numa maquina separada. Caso o serviço seja instalado numa maquina separada, e seja necessario acessar o sistema digital de outra rede, é importante que a maquina na qual o servicço do concentrador de dados foi instalado possua definida uma rota para a comunicacão com as redes externas. Devido ao fato de as unidades de processamento implementarem o padrao Modbus TCP/IP, qualquer aplicativo supervisorio ou de configuraçao que seja compatível como esse padrao pode ser utilizado sem que haja a necessidade de utilizaçao do servico do concentrador de dados. E importante ressaltar que o serviço do concentrador de dados nao interfere na comunicação Modbus TCP/IP, permanecendo as unidades de processamento compatíveis com tal padrão. Na figura 3.12 é ilustrada uma possível configuracão para o sistema digital, com a utilizaçcãao do serviçco do concentrador de dados
{ FIREWALL )
/ / I I
I
I
\
Concentrador
de Dados
A
Equipamento #1
PC_1
PC 2
Equipamento
#2
PC_n
Equipamento #N
\
i
i
Servidor da Intranet [
i
j
/
INTRANET
Figura 3.12: Possível configuração para o sistema digital
O chamado Webservice é uma solução utilizada na integracão de sistemas e na comunicação entre aplicacães diferentes. Com esta tecnologia é possével que sistemas desenvolvidos em plataformas diferentes sejam compatíveis. Trata-se de uma tecnologia de RPC (Remote Procedure Calls), que permite o desenvolvimento de aplicaçães distribuédas atravées de méetodos e objetos remotos. As bases para a construçcãao de um Webservice são os padrães XML e SOAP. O transporte dos dados é normalmente realizado via protocolo HTTP (o padrão nao determina o protocolo de transporte). Os dados sao transferidos no formato XML e encapsulados pelo protocolo SOAP. A grande vantagem de se utilizar o HTTP (e os Webservices) como solução de comunicacão entre equipamentos e sistemas é a de que, normalmente, os firewalls corporativos e industriais nãao oferecem restriçcoães a esse tipo de comunicaçcãao sem, no entanto, perderem a seguranca. Boa parte dos sistemas supervisorios, ou SCADAs, atuais jé implementam nas suas versãoes mais recentes drivers para a comunicaçcaão com equipamentos e processos que suportam Webservices.
A comunicaçcãao remota via rede, implementada no sistema pelo serviçco de Webservices do sistema do concentrador de dados, tem se tornado cada vez mais importante em aplicaçcãoes industriais. As capacidades de supervisãao, configuraçcaão e diagnéostico remotos estãao se tornando padrãao em sistemas industriais por diversas razãoes, como por exemplo:
•	permite que especialistas possam acompanhar as variéveis do processo em qualquer lugar do mundo em que se encontrarem, e de qualquer computador;
•	permite o diagnéostico e soluçcãao de problemas em equipamentos defeituosos por parte do fabricante sem que seja necessario o envio de um técnico a planta;
•	reduz os custos operacionais da planta e o custos de manutençcãao e de instalacçãao dos equipamentos;
O sistema do concentrador de dados foi todo desenvolvido na linguagem CSharp, utilizando a ferramenta de desenvolvimento Visual Studio, da Microsoft. O concentrador de dados utiliza a plataforma .NET v2, desenvolvida pela Microsoft. A utilizaçcaão da plataforma .NET requer que o serviçco seja instalado numa maquina que ofereçca suporte a utilizacão dessa plataforma. Existem alguns projetos de implementacão dessa plataforma em ambiente Linux, como o projeto Mono. Para ser instalado num sistema operacional Microsoft Windows é necessério que este possua instalados o IIS (Internet Information Service e a plataforma .NET v2 propriamente dita. Ambos podem ser obtidos atravées da péagina da Microsoft na Internet.
Os serviçcos de recrutamento e logging do sistema do concentrador de dados utilizam exclusivamente o protocolo UDP/IP na comunicação com as unidades de processamento, conforme descrito na seçao anterior do presente capátulo. O protocolo de comunicacçaão desenvolvido para permitir o funcionamento desse servicço áe descrito no Apêendice D. No Apêendice E sãao apresentados e descritos todos os serviçcos, ou máetodos, oferecidos pela interface Webservice. Na figura 3.13 á mostrado o diagrama de blocos do sistema do concentrador de dados, onde estãao representadas todos as comunicaçcoães existentes no sistema, bem como os protocolos utilizados.
O sistema do concentrador de dados desenvolvido pode ser considerado como um driver de nova geraçcaão para as unidades de processamento, pois permite a comunicaçcãao destes com diversos aplicativos: sistemas supervisorios de ultima geraçcãao, planilhas eletrêonicas (Excel, por exemplo), ambientes visuais de desenvolvimento e ate mesmo um simples navegador de hipertexto. A interface final que permite a compatibilidade com todos os aplicativos citados e a interface Webservices. Computadores de dentro e de fora da intranet poderãao utiliza-la para acessar os recursos das unidades de processamento. Não e necessario instalar drivers Modbus TCP/IP nos computadores para permitir a utilização das unidades. Na verdade, não e necessario instalar driver algum. Somente o serviço do concentrador de dados precisa ser instalado e estar ligado e conectado à rede para prover os serviçcos necessarios.
3.5	Sistema de Interface com Usuario
O sistema digital foi concebido para que a interface com usuario funcione em rede, atraves da utilizacçãao de um navegador de Internet padraão. Nesse contexto, o sistema de interface com usuario e apenas uma pagina de hipertexto (HTTP) que permite que o usuario configure a unidade de processamento que, por sua vez, controla e coordena a operaçcaão dos sistemas que compãoem o medidor de fracçãao de agua. Alem de permitir a configuraçcãao do funcionamento do medidor de fraçcãao de agua, o sistema de interface com o usuario tambem permite a operaçcaão do sistema, o acesso aos dados de logging armazenados no concentrador de dados e tambem a leitura do estado atual do medidor, em tempo-real, incluindo todas a suas variaveis de entrada, saída e internas.
A principio nao existem restriçães de acesso e o usuario pode acessar a interface com usuario do sistema de qualquer computador, que nãao necessariamente precisa estar na mesma rede que o sistema do concentrador de dados. Para permitir o acesso do usuario aos equipamentos, o sistema realiza uma autenticacçãao simples com o uso de senhas. O administrador da rede, ou do sistema, pode adicionar novos usuarios no sistema, remover usuarios ou alterar senhas. O sistema de interface implementado para
Figura 3.13: Arquitetura computacional do sistema do concentrador de dados
funcionar atravées de um navegador ée, em teoria, compatével com todos os navegadores e independente do sistema operacional. O uénico prée-requisito ée que o navegador possua instalado o plugin .NET Compact Framework v2.0, ou superior. Apesar de, teoricamente, o sistema ser independente da plataforma, somente foram realizados testes no ambiente Microsoft Windows, e com a utilizaçõo dos navegadores Mozilla Firefox v1.5, Mozilla Firefox v2.0 e Microsoft Internet Explorer v6.
Apéos a sua autenticaçcaõo no sistema, o usuéario tem acesso a lista de equipamentos detectados na rede de equipamentos. Somente serao detectados no sistema os equipamentos do tipo do descrito no presente trabalho, ou equipamentos desenvolvidos que utilizem pelo menos o mesmo sistema de comunicacçõao embarcada aqui descrito, ou que implementem, de alguma forma, o protocolo de recrutamento descrito no Apôendice C. O usuéario pode entõao escolher na lista de equipamentos detectados o equipamento que ele deseja configurar ou operar. Apéos a escolha do equipamento, o usuéario tem acesso aos menus de configuraçcaõo e operaçcõao especéficos ao tipo do equipamento selecionado. As informaçcõoes de identificaçcõao do equipamento selecionado aparecem no canto superior esquerdo da tela. Por enquanto, o unico tipo de equipamento existente é o medidor de fraçcõao de aégua. Apesar disso, o sistema de interface com o usuéario, assim como o restante do sistema digital, foi projetado para ser escalonaével e tambéem ser re-utilizéavel integralmente ou parcialmente em outros projetos e equipamentos. Abaixo sõao listadas as opçcõoes do menu de configuraçcõao que o usuéario pode configurar:
•	Ethernet: nesta opcõo o usuario pode configurar o identificador, a descricõo e o tipo do equipamento. Essas informaçcõoes sõao exibidas na lista de equipamentos detectados e sõo uteis para a identificaçõo de um dado equipamento na rede. O usuéario pode tambéem configurar se o sistema funcionaréa com IP fixo ou obteréa as suas configurações através do servico de DHCP. Caso seja escolhida a opçõo de IP fixo, ée necesséario que o usuéario configure tambéem os parôametros de IP, a méscara de rede e o gateway da rede.
•	Modo de Aquisição: nesta opcõo o usuério pode configurar os canais de aquisiçcaõo ativos dentre os 4 disponéveis. Tambéem ée necessaéria a configuraçcõao da frequôncia de aquisiçao e da taxa de oversampling, parametros esses comuns a todas as entradas.
•	Modo Controlador: nesta opcçõao o usuéario pode habilitar ou desabilitar os controladores digitais do sistema e pode tambéem configurar os parôametros dos controladores. Na atual implementaçcaõo, os parôametros sõao as constantes da equaçcõao de diferençcas do controlador desejado e a referôencia do controlador. A referôencia do controlador pode ser posteriormente alterada em tempo real.
•	Modo Filtro Digital: permite que o usuário configure o funcionamento do filtro digital, habilitando ou desabilitando esta funcionalidade. Também é possível configurar os parámetros do filtro. Na atual implementação, os parâmetros do filtro digital são as constantes da equação de diferença do filtro desejado.
•	Modo Medidor de Fracao de Agua: nesta opção o usuério pode habilitar o medidor de fracão de égua e configurar seus parametros de funcionamento. Os parametros configurados aqui são específicos a técnica de medição utilizada e tám sofrido constantes modificaçcãoes no decorrer do trabalho, por isso nãao descritos em mais detalhes no momento.
•	Saídas Analógicas: permite ao usuério habilitar ou desabilitar individualmente as saédas analógicas do sistema. As saédas habilitadas precisam ter configuradas o seu sinal de origem. O sinal de referáencia de uma saéda analéogica pode ser a saéda de um filtro ou controlador. Tambéem pode ser configurada pelo usuéario via rede. Existe ainda uma outra opção, que seria a geraçao de uma função de pré-definida.
•	Saídas Digitais: nessa opção o usuério pode habilitar ou desabilitar individualmente as saédas digitais do sistema.
•	Logging: permite que o usuério configure quais canais de dados do medidor ele deseja que sejam armazenados. Os posséveis canais de logging sãao as entradas analéogicas, as saédas analéogicas e os sinais do controlador. Aléem disso, o usuaério pode definir a frequáncia de logging em função da taxa de aquisição. Também é possével escolher se o logging seré realizado no concentrador de dados da rede ou através de algum outro dispositivo. Caso seja utilizado outro dispositivo, é necessério configurar o endereco IP e a porta para o envio do dados de logging
•	Alarmes: nessa opcão é possével configurar o sistema de alarmes do sistema. O mecanismo de alarmes nãao foi implementado. O comportamento do sistema no caso de alarmes e a maneira como essa informaçcãao chegaréa ao usuéario ainda nãao foram definidas. Apesar disso, essa opcçãao aparece no menu de configuraçcãoes.
Quando habilitado o modo medidor de fraçao de égua, as demais opçoes de confi-guraçcãao do sistema tornam-se indisponéveis, pois sãao determinadas pelo funcionamento do modo do medidor de fração de agua. Somente quando o modo de fração de agua estaé desabilitado o usuéario pode configurar o sistema. A operacçãao do sistema fora do modo medidor de fracçãao de éagua foi de muita utilidade durante o desenvolvimento e teste dos sistemas que compãoem o medidor.
Aléem do menu de configuraçcaão, o sistema de interface tambéem possui o menu de operaçcãao. No menu de operacçãao, o usuaério pode ler os valores atuais das entradas
analógicas, entradas digitais, saídas analógicas e saídas digitais. O usuário também pode controlar as saídas analógicas e digitais, desde que estas estejam configuradas para aceitar o controle do usuório. Tambóm ó possível para o usuario iniciar um ensaio com o sistema de microondas. Os ensaios de microondas são realizados para a avaliaçao das tócnicas de medicão utilizando-se um dado conjunto de parâmetros como, por exemplo, frequância do sinal, limites do sweep de frequância, numero de amostragem em cada frequencia do sweep, entre outros. Todo os resultados experimentais que serão apresentados no presente trabalho foram obtidos atravós da realizaçao dos referidos ensaios.
A interface com o usuario foi desenvolvida utilizando-se a linguagem de codificação HTML, para a codificação bósica das póginas de hipertexto. Tambóm foi utilizada a linguagem ASP.NET para a criação dos controles de usuório nas póginas. Os scripts de servidor executados pelos comandos ASP.NET foram escritos na liguagem CSharp. O sistema de interface com usuario foi todo desenvolvido no ambiente Microsoft Visual Studio v5. Na figura 3.14 ó mostrada uma tela do sistema supervisorio, na qual aparece a lista de equipamentos detectados. Na figura 3.15 ó mostrada uma tela do sistema supervisório, na qual aparecem as configuraçães de logging do equipamento.
,_1 Untitled Page - Mozilla
3 File Edit View Go Bookmarks Tools Window Help
V http://localhost:! 310/ConcentradorWeblnterface/index. him
 sg
- i . i. a, «
Reload 5K

Sistema de Configuração e Monitoramento de Módulos de Aquisição de Dados
Equipamento Selecionado:	
ID:	N/A
Descrição:	N/A
Modelo:	N/A
IP:	N/A
NENHUM EQUIPAMENTO SELECIONADO!	
Selecionar Equipamento »i	
Listagem dos equipamentos detectados:
1	PD	TIPO	DESC	IP	
Select	AQ01	&gt;	1 Prototipo	1192.168.0.100	
				1 Selecio	na Equipamento |
¡ I	1|-O=
Figura 3.14: Tela da interface com usuário onde ó apresentada a lista de equipamentos detectados na rede
Figura 3.15: Tela da interface com usuario onde e apresentado o menu de configuração de logging do sistema
3.6	Sistema de Alimentação DC
Para atender as demandas de potência e tensães de alimentação dos sistemas, principalmente do sistema de geraçao e processamento de microondas, foram desenvolvidas fontes de alimentação DC específicas. O sistema de geração e processamento de microondas demanda uma diversidade de tensãoes DC, com as mais variadas potêencias. Os componentes que compãoem o sistema de geraçcãao e processamento de microondas necessitam, para funcionar, das tensães de ±5V, ±12V e ±15V. Além disso, devido ao seu alto custo, o sistema de geraçcãao e processamento de microondas necessita de um sistema de alimentaçcãao confiíavel, que seja capaz de proteger os sistemas a ele ligados contra surtos, sobretensãoes e demais anormalidades da rede elíetrica. O sistema de alimentacçãao tambíem precisa ser imune a interferêencias eletromagníeticas, uma vez que este estaría muito proíximo de fontes eletromagníeticas relativamente potentes, capazes de interferir no funcionamento de dispositivos elíetricos e eletrêonicos.
Outro requisito das fontes de alimentacçãao DC, empregadas em sistemas de instrumentação e medição, é que essas apresentem baixo ripple e baixo conteudo harmênico na tensão de saída. A qualidade das mediçães do sistema de geração e processamento está diretamente relacionada à qualidade das fontes de alimentaçao utilizadas. Por esse motivo, fontes chaveadas, muito comuns no mercado hoje em dia, naão sãao as mais indicadas para sistemas de instrumentacçãao e mediçcaão, uma vez que devido ao seu princípio de funcionamento, essas não costumam apresentar as características de desejadas. Por esse motivo optou-se pelo desenvolvimento de fontes de alimentaçcaão lineares. As fontes desenvolvidas possuem as seguintes características:
•	interruptor iluminado - permite que o usuario identifique mais facilmente se o sistema esta ligado ou não;
•	conectores para cabos de força do tipo o IEC - padrão utilizado nas fontes de computadores;
•	proteçao contra surtos na entrada atravís de fusível;
•	chave interna seletora de tensão (110/220);
•	transformadores isoladores toroidais de alto rendimento, blindados e selados;
•	utilizacão de diodos schottky na ponte de retificaçao;
•	diversos estíagios de filtragem e estabilizacçãao;
•	proteçcãao elíetrica contra sobretensãoes na saída;
• proteçao contra sobrecorrente e curtos na saída atraves da utilização de fusíveis de queima rápida (quick blow).
Os transformadores toroidais utilizados são da sárie 70000 da AMVECO Magnetics Inc, possuem perfil baixo e são específicos para serem montados em PCI. O modelo do transformador utilizado depende da tensao e da potência de saáda. A PCI da fonte foi desenhada de maneira a ser compatável com qualquer transformador AMVECO da sáerie 70000. O desenho da PCI tambáem levou em consideraçcãao aspectos de compatibilidade eletromagnática, de maneira a minimizar a influência e a emissao de interferências eletromagnáeticas na fonte.
As fontes foram projetadas com 2 saádas completamente independentes de tensãao, podendo inclusive serem ajustadas com tensoães de saáda distintas. A tensãao de saáda áe determinada por um regulador de tensão variável, modelo LM317. O LM317 permite que a tensaão de saáda seja configurada entre 1,25V e 37V, havendo pequenas variaçcãoes dessa faixa de acordo com o fabricante do componente. A configuraçcãao da tensãao de saáda no sistema de alimentaçcãao DC áe feita atraváes do ajuste de um conjunto de potenciêometro e resistor. Dependendo dos valores escolhidos para o conjunto, a fonte pode apresentar uma faixa de variacçãao de tensaão maior ou menor, sempre respeitando o limite superior imposto pela tensãao de nominal de saáda do transformador. O ajuste fino da tensãao de saáda áe sempre feito atraváes do potencioêmetro.
Para a utilizaçcaão de saádas simáetricas áe necessáario primeiramente igualar as tensãoes das 2 saádas da fontes e entãao curto-circuitar o terminal negativo da saáda 1 com o terminal positivo da saáda 2. Para cada um dos circuitos de estabilizaçcaão da fonte, foi utilizado um CMC (Common Mode Choke), que permite a eliminaçao ou redução do ruádo de modo comum, presente nestes. A proteçcãao de sobretensaão de cada uma das saádas áe realizada atraváes de um circuito de clipping. O disparo do circuito de clipping á realizado por um diodo zenner, com tensao de polarizaçao adequada às tensães de saúda desejadas. Quando o circuito de clipping á acionado, a tensão de saúda á instantaneamente aterrada e o fusável de proteção da sada queima. A utilização do circuito de proteçcãao contra sobretensãoes de na saáda áe opcional.
Foram montadas 4 fontes de alimentaçao, sendo três para o sistema de geração e processamento de microondas e uma para a unidade de processamento. Todas as fontes montadas foram configuradas para funcionar como fontes simáetricas. As trêes fontes montadas para o sistema de geracçãao e processamento de microondas sãao de ±5V, ±12V e ±15V. A fonte da unidade de processamento á de ±15V, para permitir que as saádas analáogicas da unidade possam ser configuradas, com uma certa margem de folga, para a faixa de ±12V. Foram projetadas e construádas caixas de metal para as fontes. A tampa da caixa de metal áe de chapa perfurada para facilitar a ventilaçcãao da
fonte, principalmente dos reguladores de tensão, que necessitam dissipar muito calor. Na saídas de tensão CC foram utilizados conectores fêmea tipo ”banana”de 4mm. Na figura 3.16 é mostrado, a título de ilustraçao, o desenho da PCI da fonte. Nas figuras 3.17 e 3.18 são mostradas fotos dos fontes prontas. O diagrama esquemético da fonte é mostrado no Apêndice B.
Figura 3.16: Desenho da PCI da fonte de alimentacão
Figura 3.17: Foto da fonte de alimentacão com a tampa aberta
3.7	Sistema de Suporte aos Ensaios
Para a avaliaçao dos sensores de microondas e das tecnicas de medicão, foi necesséria a construção de uma bancada de testes que, na ausência de uma infra-estrutura de escoamento multiféasico, permite que alguns aspectos de um escoamento multiféasico sejam reproduzidos em laboratorio. Os componentes principais da bancada de ensaio
Figura 3.18: Foto da fonte de alimentação com a tampa fechada são os tanques de acrílico. Foram utilizados dois tanques de acrílico, projetados e construídos especificamente para o projeto, com secães transversais de tamanho similar a um tubo normalmente utilizado em instalacoes de produçao de petróleo e gás. Foi utilizado um tanque com secão transversal quadrada e outro com seção circular. Ambos os tanques possuem aproximadamente 6 polegadas de diâmetro ou largura. O ensaio ó realizado num tanque por vez. Foram utilizados dois tanques com o objetivo de comparar a influância da geometria dos tanques no funcionamento do medidor. Os tanques possuem uma valvula de admissão e outra de saída. Para a realização dos ensaios, os tanques sãao enchidos com uma fraçcãao de íagua e íoleo conhecida. Apoís a realizaçcaão do ensaio a quantidade de íagua ou íoleo pode ser modificada com o auxílio das víalvulas.
Os tanques foram projetados para serem utilizados na horizontal. Nessa confi-guracão, a separação natural que ocorre entre a agua e o óleo nao afeta o comportamento do sistema. Isto ocorre porque os volumes de água e óleo que ficam entre as duas antenas utilizadas saão sempre constantes, independentemente do estaígio de separacçãao da mistura. A configuracçãao horizontal tambíem facilita a remoçcaão controlada de algum dos componentes atravás da válvula de saída, uma vez que após um curto período de tempo a mistura se separa por completo, com íoleo na parte superior e íagua na parte inferior. A opçao pela utilizaçao do acrílico para a construcao dos tanques deve-se ao fato de que este nãao interage com as microondas. Alíem disso, o acrílico, por ser um material transluícido, permite que a mistura no interior do tanque seja visualmente inspecionada. Os tanques são sustentados por suportes de madeira para evitar interacães indesejadas com as microondas.
A bancada de ensaios foi construída em metal e pintada eletrostaticamente com tinta epoxi, sendo montada sobre rodas para permitir a sua fácil movimentação. Os tanques e as antenas, que são a parte do sistema que ficam expostas às microondas, foram confinadas numa caixa de metal devidamente aterrada. O objetivo da caixa á impedir que as microondas se propaguem livremente pelo espaço e interfiram no funcionamento dos equipamentos eletronicos utilizados no medidor e tambám nao oferecam nenhum risco à saude das pessoas práximas durante a realizaçao dos ensaios. As antenas saão fixadas em posicionadores que permitem que estas possam ser afastadas ou aproximadas do tanque. Os posicionadores, por sua vez, sao fixados na tampa superior e na base da caixa de metal. A tampa da caixa foi construída com chapas perfuradas. As chapas perfuradas permitem que seja possável visualizar o interior da caixa sem, no entanto, comprometer o isolamento eletromagnático da caixa, uma vez que o diâmetro dos furos da tampa áe bem inferior ao comprimento de onda das microondas utilizadas no sistema. Na figura 3.19 á mostrada uma foto da bancada de ensaios durante a rea-lizacão de um ensaio. Na figura 3.20 á mostrada em detalhe a estrutura de ensaio no interior da caixa de metal.
Figura 3.19: Foto da bancada de ensaios durante um ensaio
Figura 3.20: Foto da bancada de ensaios durante um ensaio (detalhe do interior da caixa de Faraday)
3.8	Sistema de Medições Auxiliares
Conforme mostrado no capítulo 2, as características dielétricas da agua variam significativamente com algumas propriedade físicas da égua. As duas principais fontes de erros de mediçao para a aplicaçao dos sensores de microondas na industria de petróleo e gés são a temperatura da mistura e a salinidade da égua. Para o correto funcionamento de um sensor de microondas e necessério que as mediçoes realizadas sejam corrigidas com os valores da mediçcãao da temperatura e da salinidade mistura bifíasica.
Apesar da importância da realização das mediçães auxiliares para a confiabilidade do sistema, o sistema de mediçcãoes auxiliares nãao chegou a ser implementado no presente trabalho. Em aplicaçães industriais o efeito dessas fontes de variaçao e incerteza é relevante e nãao pode ser desprezado, tendo em vista as condiçcãoes extremas que esses sistemas podem ser submetidos. No entanto, para o estudo em condicães simuladas e controladas de laboratério, a influância de tais parâmetros não compromete a validade das mediçcãoes.
3.9	Conclusões
No presente capétulo foi apresentado e descrito o sistema experimental desenvolvido. Cada um dos sub-sistemas que compoem a bancada de testes foram descritos,
com excecçãao do sistema de mediçcãao auxiliares que nãao chegou a ser implementado durante o presente trabalho. Todos os sistemas foram desenvolvidos tendo em vista a possibilidade de aplicacçãao futura num medidor industrial. Os sistemas de instru-mentaçcãao e de controle desenvolvidos permitem a construçcãao de vaérios tipos de sensores de microondas como, por exemplo, sensores de transmissãao, sensores de ressonáancia e sensores de reflexão. A tecnologia aplicada nesses tipos de sensores ó muito parecida e com pequenas alteracçãoes na estrutura da bancada esses tipos de testes podem ser realizados.
Com o desenvolvimento da bancada de ensaios uma etapa importante do projeto foi concluédo. A partir da bancada ée possével a realizaçcãao de diversos experimentos que permitem que diversos aspectos positivos e negativos dos sensores de microondas possam ser avaliados. No proéximo capétulo serãao descritos os tipos de testes que foram realizados no sistema e as condiçcãoes nas quais se derem esses testes. Tambéem serãao apresentados os resultados obtidos com a realizaçcãao dos testes.
Capítulo 4
Resultados Experimentais
No presente capítulo serão descritos os testes e ensaios realizados com a unidade experimental. O objetivo principal dos testes íe avaliar e viabilidade da utilizacçãao de sensores de transmissãao para a mediçcaão da fraçcãao de aígua em aplicaçcãoes da induístria de petríoleo e gaís. Serãao apresentados os dados os obtidos nos diversos testes e ensaios realizados.
4.1	Descricão de um Ensaio
A bancada de ensaios foi inicialmente projetada para permitir a avaliacçãao de sensores de transmissãao somente. Apesar disso, o sistema de microondas, permite assim como, o sistema digital, que outros tipos de sensores sejam construídos e avaliados. No presente trabalho foram avaliados somente os sensores de transmissão. No entanto, foram identificados diversos fenâomenos de ressonâancia no interior da caixa de ensaios da bancada de testes.
Para a realizaçcãao dos testes foram utilizados aígua e íoleo de cozinha. As quantidades desses dois componentes foram variadas ao longo de toda a faixa de mistura. Para uma dada composiçcãao da mistura, diversos ensaios foram realizados e os dados foram coletados. Alíem da composiçcãao da mistura, o outro parâametro do sistema que pode ser alterado é a frequância do VCO.
Um teste consiste em (para uma dada composiçao da mistura bifasica no interior do tanque) medir a intensidade e o atraso de fase do sinal transmitido atravíes da mistura para um conjunto de frequâncias. Os testes podem ser realizados, por exemplo, para toda a faixa de frequâncias do VCO, de 8GHz a 12GHz. Um teste também pode ser realizado numa frequâencia somente, ou em qualquer nuímero de frequâencias desejado. A resolucçãao do sistema de geraçcaão de microondas íe de, aproximadamente, 1MHz.
A realização dos ensaios experimentais foi automatizada na placa de controle e aquisiçcaão. O usuario so necessita configurar alguns parêametros adicionais para que o sistema realize, de maneira automatica, o teste solicitado, disponibilizando em seguida os dados de logging armazenados durante a realizaçcaão do teste. Os parêametros que o usuario necessita configurar no sistema de controle sãao:
•	Taxa de aquisição do sistema (fs): a taxa de aquisicao do sistema, alem de definir a taxa de amostragem do sistema, funciona como referêencia de tempo para alguns paraêmetros do ensaio, sendo esses parêametros medidos em numero de amostras.
•	Frequência inicial (f0): a frequência na qual o sistema de microondas inicia o ensaio e a aquisiçcãao dos dados.
•	Frequência final (f1: frequência na qual o sistema encerra o ensaio.
•	Incremento da Frequência (Af): permite ao usuario configurar o valor do intervalo de acordo com o qual se dara a variaçao da frequência do VCO.
•	Número de Aquisições (Naq: define o numero de aquisições que serâo realizadas numa determinada frequêencia ou patamar. O interruptor do sistema de geraçcãao e processamento de microondas so permite a transmissãao do sinal de microondas durante o numero de aquisiçcoães definidas por esse parêametro.
•	Intervalo Entre Dois Períodos de Aquisiçao (Toff: este parâmetro define por quanto tempo o sistema ficara desligado antes de iniciar um novo ciclo de aquisicão. Este parâmetro pode ser configurado como 0.
O ensaio inicia com o sistema de geração de microondas desligado e f0 configurada. Apos Toff aquisições, o interruptor do sistema é ligado, permitindo a transmissão do sinal de microondas atraves do meio. São então realizadas NAq aquisições, apos as quais o interruptor e novamente desligado. Apos a conclusão das Naq a frequência de oscilaçao e incrementada em Af. Caso f1 nao tenha sido atingida, o sistema aguarda Toff aquisições e então liga novamente o interruptor e repete todo o ciclo. Quando f1 e atingido, o sistema encerra o ensaio, desliga o interruptor e disponibiliza os dados para o usuario. Na figura 4.1 são ilustrados os parâmetros de ensaio.
4.2	Ensaios Realizados
O ganho do sistema de geraçcaão e processamento de microondas nãao e o mesmo para toda a faixa de frequêencias. O ganho em frequêencia do sistema como um todo e
Figura 4.1: Parâmetros de configuração de um ensaio bancada de testes resultado da composição dos ganhos em frequância de cada um dos componentes que o compãem. Além disso, a posicão relativa das antenas, bem como o meio entre elas, influenciam a resposta em frequância do conjunto. As curvas de ganho da égua ja foram apresentadas no capítulo 2.
Com o objetivo de determinar a influencia da fraçao de égua na resposta do sistema, foram realizados ensaios variando-se o volume de égua dentro dos tanques. Depois que o tanque foi completado com égua, iniciou-se a reducao gradativa da quantidade de éagua e a adiçcaão da mesma quantidade de éoleo. A éagua foi adicionada no tanque em multiplos de 1L. Depois de enchido o tanque, a égua foi removida em multiplos de 0,5L. A mesma quantidade era adicionada de oleo. Para cada composicão do tanque foram sempre realizados 2 ensaios, que sao abaixo descritos:
•	Ensaio A: este ensaio consiste na medição da fase e atenuação em duas frequâencias. Foram escolhidas as duas frequâencias de méaxima intensidade do sinal. As duas frequâencias precisam ter um ménimo valor de separacçãao entre elas, sendo necesséario que ambas caracterizem méaximos regionais da curva de intensidade do sinal. O sistema foi configurado para realizar 20 aquisiçães em cada frequância, numa taxa de aquisiçao de 1000 amostras por segundo.
•	Ensaio B: este ensaio consiste na realização de uma varredura, ou sweep, de frequâencias em torno da regiãao que apresenta o pico méaximo de intensidade do sinal. A faixa de variação das frequâncias é de 100MHz, e o incremento da frequância é ménimo, ou seja, aproximadamente 1MHz. Sao realizadas 3 amostragem em cada frequencia. O sistema é desligado por dois períodos de amostragem antes de coletar os dados referentes à préxima frequencia.
No entanto, para a realização sistemática dos ensaios acima descritos, é necessário primeiro que se determine as frequências de maxima intensidade do sinal. Para tal, e necessaria a realizacao de alguns ensaios utilizando toda a faixa de frequencias e a maxima resolução, ou menor incremento possível. As frequências de maxima intensidade do sinal no sistema, determinadas para uma dada configuração de ensaios e uma dada quantidade de áagua, saão utilizadas em todas as mediçcãoes posteriores realizadas, variando-se somente a fracão de agua e áleo no interior do tanque. A fração agua (Fh) e a fracão de oleo (Fo)no interior do tanque sao expressas em funcao do volume de oleo (VO) e do volume de agua (Vh) contidos no tanque, conforme as equacoes
Fh =	Vh	(4.1)
	Vh + Vo ’	
Fo =	Vo	(4.2)
	Vh + Vo ■	
A realização das medições em duas frequências, no ensaio tipo A, tem como objetivo a avaliaçcãao do atraso de fase em duas frequêencias distintas, de maneira a eliminar, em teoria, a ambiguidade inerente à medição do atraso de fase. Os dados obtidos com a realizaçcãao dos ensaios tipo sweep nos permitem determinar a resposta em frequêencia do sistema.
Para cada configuracçaão de áagua e áoleo no tanque, o ensaios A foi repetido diversas vezes (de 4 a 8 vezes). Os dados coletados em todas as medicães, em todas as repetiçães, foram entãao estatisticamente processados e a máedia e o desvio padrãao foram calculados. Para alguns ensaios foi utilizada uma manta de metáalica envolvendo o tanque. O objetivo da manta era o de reproduzir a situação encontrada numa tubulação real, onde espera-se a ocorrência de diversas reflexoes no interior do tubo. Na figura 4.2 é mostrada uma foto do tanque de seçcaão retangular, envolvido pela manta metáalica.
4.3	Curvas Obtidas
4.3.1 Configuração 1
Os ensaios que produziram os gráaficos abaixo mostrados foram realizados utilizando-se o tubo de seçcãao transversal retangular. A manta metáalica tambáem foi utilizada na realizaçcaão dos ensaios. Primeiramente foi realizado um ensaio para determinar os dois máaximos de intensidade do sistema. As frequêencias obtidas, para as quais a intensidade do sinal é máxima e, portanto, a atenuacão é mínima, foram 9657 MHz e 9881 MHz,
Figura 4.2: Tanque de ensaio com a manta metálica sendo a segunda a frequência de máximo ganho do sistema. O ensaio tipo A foi realizado nessas duas frequências e o ensaio tipo B realizado na faixa de 9802 MHz à 9918 MHz. Nas figuras abaixo tambám á mostrada a faixa de incerteza das medições obtida atravás da tratamento estatístico dos dados coletados. Na figura 4.3 á mostrado o grafico da intensidade em funçao da fraçao de áleo para a frequência de 9657 MHz. Na figura 4.4 áe mostrado o graáfico do atraso de fase em funçcõao da fracçõao de áoleo para a frequêencia de 9657 MHz. Na figura 4.5 á mostrado o gráfico da intensidade em funcõo da fraçõo de áleo para a frequência de 9881 MHz. Na figura 4.6 á mostrado o gráfico do atraso de fase em funcao da fracõo de áleo no tanque, para a frequência de 9881 MHz.
A conversao dos valores de atraso de fase, obtidos pelo sistema digital, em unidades de engenharia nõao foi realizada pois restam duávidas sobre como fazer a conversõao. O sistema foi projetado para realizar a mediçõo das fases com náveis de altos sinais de LO e RF no misturador. No entanto, nao foram obtidos os náveis de sinais desejados no misturador. Quando utilizados sinais de nável alto, capazes de saturar as entradas do misturador, a mediçao de fase independe das intensidades dos sinais. Em [9] e apresentada uma equacõo que permite obter o atraso de fase, utilizando-se um misturador, para quando os náveis dos sinais nõao sõao suficientes para saturar as entradas do misturador. Conforme pode ser visto nos gráficos acima, nõo á possável determinar uma correlaçõo direta entre os parêametros medidos e a fraçcõao de aágua. Naõo áe possável sequer determinar uma tendêencia nas curvas de intensidade e atraso de fase. O comportamento esperado para a intensidade do sinal áe um aumento da intensidade com o aumento da fracõo de áleo (ou equivalentemente, a reducao da fracõo de agua). Observou-se
																	
																	
						/ /											
																	
																	
																	
Figura 4.3: Gráfico da intensidade em funcao da fraçao de óleo, utilizando-se o tanque de seção retangular e com a utilizacao da manta de alumínio
Atraso de Fase x Fração de Água (9657 IVHz) (incerteza)
Fração
Figura 4.4: Grafico do atraso de fase em função da fraçao de íleo, utilizando-se o tanque de seçcãao retangular e com a utilizacçãao da manta de alumínio
Figura 4.5: Gráfico do intensidade em função da fração de óleo, utilizando-se o tanque de seção retangular e com a utilizaçao da manta de alumínio
Figura 4.6: Gráfico do atraso de fase em função da fraçao de áleo, utilizando-se o tanque de seçcãao retangular e com a utilizacçãao da manta de alumánio
que o valor medido da intensidade oscila, apresentando uma leve tendência de crescimento para ambas as frequencias escolhidas para os testes. Para o atraso de fase, o comportamento esperado e o inverso da intensidade, ou seja, espera-se uma reduçao do atraso de fase com o aumento da fração de oleo. As medições obtidas, alem de oscilarem, apresentam tendências distintas para as duas frequências escolhidas. Apesar disso, o desvio padrão calculado para as diversas mediçães realizadas mostrou-se pequeno, especialmente para a medição da fase. O desempenho metrologico do sistema foi considerado satisfatorio, indicando que o comportamento observado do sistema esteja provavelmente relacionado as interaçães secundarias entre as microondas e o meio, alem das interacçãoes esperadas e desejadas.
4.3.2	Configuração 2
Os ensaios que produziram os graficos abaixo mostrados foram realizados utilizando-
se o tubo de seção transversal retangular. Nestes ensaios a manta metalica não foi
utilizada. Na figura 4.7 e mostrada uma foto da configuração utilizada nesse ensaio.
Figura 4.7: Tanque de ensaio sem a manta metalica
A metodologia de realização dos ensaios nessa configuraçao foi um pouco diferente da metodologia utilizada na realização dos ensaios com a configuração 1. Alem dos ensaios A e B anteriormente descritos, o ensaio de varredura utilizando toda a faixa de frequencias foi repetido para todas as fracões de agua. O ensaio de varredura de faixa inteira foi realizado utilizando-se a maxima resolução de frequência do sistema. Na figura 4.8 e mostrado o resultado do ensaio de varredura de ampla faixa para todas as fracçoães de agua. As frequêencias escolhidas para a realizaçcãao dos ensaios tipo A foram
9907 MHz e 9991 MHz, sendo a primeira a frequência de máximo ganho do sistema. Os resultados obtidos com a realizaçao dos ensaios tipo A, para as duas frequências descritas sao mostrados na figura 4.9. Os ensaios tipo B foram realizados na faixa de 9860 MHz a 10000 MHz. Os resultados obtidos com a realizacão dos ensaios tipo B á mostrada na figura 4.10
f [GHz]
Figura 4.8: Gráfico da intensidade em função da frequência (faixa inteira), utilizando-se o tanque de seçao retangular para diversas frações de água
O comportamento do atraso de fase para os ensaios realizados utilizando-se a configuração 2 não serão mostrados pois, conforme comentado anteriormente, a metodologia dos ensaios realizados com a configuração 2 foi um pouco diferente da adotada na configuração 1. Buscou-se, com os ensaios realizados com a configuração 2, compreender melhor os fenêmenos de reflexao e ressonência no interior do sistema. Foram observados diversos tipos de correlacçãoes entre a intensidade do sinal e a fraçcãao de áagua. Analisando com atencão e em detalhes os resultados obtidos com o ensaio de varredura de faixa inteira, observou-se frequêencias para as quais a correlaçcãao entre a intensidade do sinal e a quantidade de água á diretamente proporcional. Em outras frequências a correlaçcãao observado foi inversamente proporcional e, ainda, em outras frequêencia nãao se observou nenhuma correlaçcaão direta entra a intensidade do sinal e a fraçcaão de áagua.
Figura 4.9: Grafico da intensidade em funçao da fracao de agua (tipo A), utilizando-se o tanque de secão retangular 2 frequências escolhidas
Figura 4.10: Grafico do intensidade em funcão da frequência (tipo B), utilizando-se o tanque de seçcaão retangular para diversas fraçcãoes de agua
Aláem disso, como pode ser observado nos graáficos da intensidade em funcçãao da fraçcãao de áagua, tanto para a configuraçcãao 1 quanto para a configuracçãao 2, para uma dada faixa de fraçcãoes áe possável obter uma relacçãao direta e nãao-ambágua entre a intensidade do sinal e a fração de água. No grafico 4.10 é possível observar, para a faixa de 60% a 100% de água uma relacão clara entre a intensidade do sinal e a fração de água, apesar de a relacao obtida ser o inverso da esperada. E importante ressaltar que a maior parte dos medidores existentes no mercado sãao especificados para funcionar dentro de uma determinada faixa de fraçcãoes de áagua.
Capítulo 5
Conçlusães
O presente trabalho se caracteriza como pioneiro na área dentro do DAS. Além dos objetivos expostos no capátulo 1, podemos ressaltar como objetivo secundário a criacçãao de uma infra-estrutura mánima que permitisse a realizaçcãao do presente trabalho e servisse como base para desenvolvimentos e trabalhos futuros na área. Tendo em vista a ausêencia de uma infra-estrutura de testes laboratoriais, todo o sistema foi projetado e construádo tendo como objetivo final o desenvolvimento de um medidor industrial.
No presente trabalho foi desenvolvida uma bancada de ensaios para a avaliacçãao da viabilidade da aplicaçcaão da tecnologia de microondas e dos sensores de transmissaão para a mediçao da fração de água numa mistura estática de agua e áleo. Foram realizados diversos experimentos com o sistema, variando-se alguns parêametros do processo, mas utilizando-se a mesma configuraçcãao do sistema de instrumentaçcãao.
Os dados coletados nos ensaios foram analisados e verificou-se, para uma dada confi-guraçcãao do sistema, uma correlaçcãao entre a fraçcãao de aágua da mistura e os parêametros medidos pelo sistema de instrumentação. Com base na correlação obtida um protátipo de medidor de fraçcãao de áagua foi desenvolvido. No entanto, verificou-se, conforme apontado na literatura por [9] e [20], as limitações dos sensores de transmissão para a aplicaçcãao em questãao.
Os resultados obtidos nos ensaios em que foi utilizada a manta metáalica naão indicaram nenhuma correlacçãao entre a fraçcãao de áagua e os parêametros medidos. A hipáotese mais prováavel para a causa dos efeitos indesejados áe a existêencia de muáltiplas reflexãoes no interior do tanque devido à utilização da manta metálica. As reflexães interagem criando padroães de ondas estacionáarias que interferem de maneira significativa nas mediçcãoes de intensidade e atraso de fase do sinal de microondas. Tal fenêomeno áe descrito na literatura e apontado como principal limitaçcãao no uso de sensores de trans-missaão para mediçcaão da fracçãao de aágua em tubos. As curvas de intensidade e de atraso
de fase em função da fração de oleo, mostradas em 4.3.1, apresentaram resultados significativamente distintos para duas frequências diferentes, reforçando assim a hipotese das muitiplas reflexões, uma vez que, para diferentes comprimentos de onda, os padrães de interaçcãoes sãao diferentes.
Apesar do conhecimento prévio de tais efeitos e limitacães dos sensores de trans-missãao, a escolha de tal tipo de sensor deve-se ao fato de ser este o tipo de sensor de microondas mais simples. O desenvolvimento de outros tipos de sensores depende do desenvolvimento intermediéario dos sensores de transmissãao. A comprovaçcaão experimental de fenêomenos descritos na literatura pode ser considerada como véalido conhecimento adquirido no processo de desenvolvimento e doménio das tecnologias envolvidas. A compreensãao dos fenoêmenos de reflexãao e formaçcaão de ondas estacionéarias que ocorrem nos sensores de transmissão é a base teérica para o desenvolvimento dos sensores de ressonaência, apontados como os sensores mais adequados para serem utilizados na aplicaçcãao em questãao.
Aparentemente, as multiplas reflexães e ondas estacionarias também interferiram nos ensaios realizados sem a manta metalica, produzindo comportamentos indesejados no sistema de mediçcãao, ainda que em menor intensidade do que nos ensaios em que foi utilizada a manta metálica. Suspeitamos que a caixa metálica, construida para isolar o sistema, causa os mesmos efeitos de reflexãao observados nos ensaios com a manta metéalica.
Para reforçar a hipátese das influência das reflexães nas medicães, foi verificado que a frequêencia de méaxima intensidade do sinal varia com a utilizaçcãao da manta metalica. Utilizando-se o tubo de seção retangular, verificou-se que a frequência de méaxima intensidade do sinal, obtida atravées do ensaio de varredura de frequêencias, ée de 9881 MHz para ensaios em que se utiliza a manta metálica, e de 9907 MHz nos ensaios em que nãao se utiliza a manta. Aparentemente, em ambas as situaçcãoes estãao ocorrendo fenômenos de ressonancia nas frequências citadas. Em teoria, a frequência de ressonaência deveria variar de acordo com as dimensoães da cavidade de ressonêancia e com as propriedades dielétricas do MUT, no entanto, nao foi possível observar tal fenoêmeno. Para uma dada configuraçcãao de ensaio, a mesma frequêencia de ressonêancia foi obtida para toda a faixa de fraçcãao de áoleo, com variaçcãoes mánimas no limite da resolução do sistema. Nessas situaçoes de multiplas reflexães, a influência do meio no sinal recebido nãao pode ser facilmente determinada. Portanto, nessa situaçcãoes, a eficiêencia do sistema na mediçcãao da fracçãao de áoleo áe questionáavel.
Outro fator que supostamente influenciou os resultados criando padrãoes de inter-ferêencia e ondas estacionaárias foi a interface estáatica presente na mistura bifáasica. Assim como a luz, as microondas sofrem reflexãoes e refraçcãoes quando encontram um interface entre dois meios com propriedades dieláetricas distintas. A interface estáatica
presente nos testes estaticos realizados no sentido axial do tanques não corresponde a realidade de um escoamento multifésico. Novos testes deverâo ser conduzidos sobre uma mistura de égua/éleo devidamente homogeneizada (sem apresentar esta interface). Isto pode ser realizado adicionado-se um misturador dentro do corpo de prova na bancada de testes. Futuramente uma unidade de escoamento multifasico devera gerar o fluido de teste em condições mais préximas da realidade. Neste sentido, atualmente estao sendo conduzidos trabalhos no DAS, na direcão de construir e disponibilizar para testes esta unidade de escoamento multiféasico.
O sistema de medição mostrou-se bastante estavel e confiável, tendo em vista a re-petibilidade obtida nas mediçães realizadas para uma mesma configuração. Além disso, a incerteza das mediçoes, calculada através do desvio padrâo, foi satisfatória, especialmente a mediçcãao do atraso de fase que se mostrou bastante estéavel. No entanto, para obter esse comportamento estéavel foi necesséario estabilizar a temperatura do sistema de geracçaão e processamento de microondas utilizando refrigeracçaão forçcada. Durante a realização dos primeiros testes com o sistema, verificou-se que o VCO e o amplificador de potância do sistema de geração e processamento de microondas produziam muito calor. Nessas condiçcãoes, o sistema de medicçaão apresentou péessimas caracterésticas metrolégicas. Os dissipadores utilizados no sistema foram sub dimensionados. Para solucionar o problema, foi utilizada ventilaçcaão forçcada no sistema de microondas.
A potâencia do sinal transmitido e, consequentemente, a intensidade do sinal recebido, ficaram muito abaixo do esperado e determinado teoricamente. A potâencia abaixo do esperado reduz a sensibilidade do sistema e forcça essa a operar muito abaixo das condicoes étimas. Uma hipotese para a causa da reducao da potância do sistema é a perda de potâencia devido ao naão casamento de impedâancias entre os componentes do sistema de geraçcaão e processamento de microondas, ocasionando o aparecimento de ondas estacionéarias no sistema e, consequentemente, a perda de potâencia. Eventualmente, esse fenoâmeno possa ser, pelo menos em parte, responsaével pelo sobre-aquecimento do sistema. Uma possével soluçcãao para esse problema ée a utilizaçcãao de isoladores entre os elementos de potância do sistema (VCO e amplificador). Uma outra possibilidade para a melhora do sinal recebido ée a utilizaçcãao de um amplificador para o sinal recebido.
O mecanismo de logging de alta velocidade implementado utilizando o protocolo UDP/IP não funcionou como o esperado. Na prética, para altas frequâncias de logging a perda de pacotes na rede foi muito grande, uma vez que o protoclo UDP/IP naão possui mecanismos de controle de transporte. Devido a essa limitaçcãao, a taxa de aquisiçcãao em que os ensaios foram realizados foi de 1 kHZ.
5.1	Pendências de Implementação
Abaixo são listadas funcionalidades e componentes que fazem parte do projeto do sistema, mas que, no entanto, não foram implementadas por razoes diversas.
•	O sistema de medicães auxiliares nao chegou a ser implementado. Ele é importante para a determinacão da influência da temperatura e da salinidade nas propriedades dieletricas do meio. Numa aplicacão industrial, em condições reais de escoamento, a medição dessas grandezas são indispensaveis para a correta mediçcãao da fraçcaão de agua.
•	O atenuador controlado por tensãao apresentou defeito e nãao foi utilizado no sistema. O atenuador controlavel e uma peçca importante no sistema de geraçcãao e processamento de microondas. Este componente garante níveis constantes de intensidade no misturador do sistema de microondas, permitindo que este opere em condiçcoães íotimas.
•	A memória FIFO, que conecta o sistema de comunicação embarcada ao sistema de controle e aquisiçcãao de dados, nãao foi montada na placa. A utilizaçcãao deste componente ó fundamental em aplicacães que requerem altas frequências de log-gzng.
•	As tarefas de controle, filtro digital e alarme da unidade de aquisição não foram completamente implementadas. A tarefa de controle óe indispensaóvel caso se utilize o atenuador controlado no sistema de geracçãao e processamento de microondas. A tarefa de filtro digital pode melhorar significativamente a qualidade das mediçcãoes da unidade de aquisiçcãao.
5.2	Limitações Operacionais
Abaixo sãao listadas algumas limitacçãoes, nãao previstas, que o sistema implementado apresentou:
•	Para o correto funcionamento do sistema de mediçao ó necessório utilizar ven-tilaçcãao forcçada no sistema.
•	A frequência maxima de logging obtida e de 1 kHz, limitando a taxa de aquisição para os ensaios em 1 kHz.
5.3	Dificuldades Encontradas
O processo de aquisição dos componentes de microondas é lento e burocrático. Não existem fabricantes nacionais. Os fabricantes disponibilizam poucas informações sobre seus produtos. Os fabricantes não costumam manter estoques de seus componentes, sendo estes produzidos apos o pedido de compra, o que implica numa demora de algumas semanas para a produção dos componentes e, às vezes, compra de uma quantidade mínima. Além disso, por se tratarem de componentes normalmente utilizados em aplicaçcoães militares e aeroespaciais, o processo de compra pode exigir algum tipo declaração de utilização para fins pacíficos.
A inexistência de um laboratário equipado e preparado para a realizaçao de ensaios e avaliação das técnicas de inferência utilizando microondas pode ser considerada como uma grande dificuldade. Tais tipos de testes demandam uma variedade de equipamentos, tais como: analisadores de espectro, geradores de microondas, amplificadores de potêencia, antenas direcionais, guias de onda, entre outros. Todos os testes e mediçcãoes foram realizados utilizando unica e exclusivamente o equipamento desenvolvido no presente trabalho, não havendo nenhum outro equipamento de referências para a validação dos resultados ou calibraçcãao do equipamento desenvolvido.
5.4	Sugestões para Trabalhos Futuros
A maior parte das sugestãoes para trabalhos futuros sãao decorrentes de deficiêencias e problemas identificados no presente trabalho que, por motivos diversos, nãao foram solucionados. Abaixo sãao listadas algumas sugestãoes para trabalhos futuros:
•	implementação das pendências de implementação do presente trabalho;
•	utilização de isoladores no sistema de processamento de microondas;
•	avaliacçãao do sistema utilizando outras antenas e configuraçcãoes das antenas;
•	montagem do sistema de processamento e geraçcãao de microondas sobre uma placa metálica que facilite a dissipaçao do calor produzido pelos componentes;
•	montagem do sistema de microondas na forma de uma matriz de componentes, de maneira a simplificar e permitir a alteracçãao da configuraçcaão dos componentes de microondas, permitindo a alteracao do roteamento dos sinais através da utilização de guias de onda flexíveis;
•	utilização de mais um amplificador de potância para a transmissão do sinal e ainda mais um amplificador para a recepcao;
•	reavaliaçao do mecanismo de logging em alta velocidade;
•	projeto de uma cavidade de ressonâancia e avaliacçaão dos sensores de ressonaância utilizando o sistema de instrumentacçaão atual;
5.5	Considerações Finais
De uma maneira geral, o medidor desenvolvido apresentou resultados muito próximos dos esperados. Os sistemas de instrumentacão e medição funcionaram de maneira satisfatória. O tempo dedicado à realizacão dos ensaios propriamente ditos foi pequeno. O esforço necessario para colocar o sistema em operaçao consumiu muito tempo.
A grande realizaçcaão do presente trabalho foi a criaçcãao de uma infra-estrutura para trabalhos futuros. A experiâencia e o conhecimento adquirido no desenvolvimento do sensor de transmissãao sãao de fundamental importâancia para trabalhos futuros, apesar de, aparentemente, esse tipo de sensor nãao produzir os resultados desejados para a aplicaçcãao em questãao.
Existem diversas aplicacães para sensores de microondas. Trata-se de uma linha de pesquisa ampla e variada. A instrumentaçcãao utilizando-se tecnologia de microondas, apesar de não ser uma tecnologia nova, ainda á assunto pouco estudo. Existem poucas publicaçães na área e alguns poucos fabricantes oferecendo produtos que empregam essa tecnologia no mercado.
Apêndice A
Especificações Técnicas dos Componentes de Microondas Utilizados
Neste apêndice são apresentadas as especificações técnicas, bem como o modelo e o fabricante, dos componentes utilizados no sistema de geraçao e processamento de microondas. Para maiores detalhes sobre os deve-se consultar os datasheets fornecidos pelos fabricantes, os quais podem ser obtidos atraves no website das empresas.
A.1 Antenas
Foram utilizadas duas antenas tipo horn, fabricadas pela empresa Q-par Angus (http://www.q-par.com). Abaixo sao descritas as principais características de cada um dos modelos utilizados.
•	QSH16S10S
— Ganho =10 dBi
— Conector = tipo SMA
— Banda = 8,2 GHz a 12,4 GHz
•	QSH16S20S
— Ganho = 20 dBi
— Conector = tipo SMA
— Banda = 8,2 GHz a 12,4 GHz
A.2 VCO
Foi utilizado no sistema um VCO modelo O2ACP12001, fabricado pela Teledyne Cougar (http://www.cougarcorp.com). Abaixo são listadas as principais características desse componente:
•	Banda = 8 GHz a 12 GHz
•	Tensão de controle = 0V a -12V
•	Potência de saída =17 dBm
•	Variação da potência de saída = 5,5 dB
•	Tensão de alimentação = +15VDC
•	Corrente de alimentação (max) = 220 mA
•	Conectores = tipo SMA
A.2.1 Interruptor
Foi utilizado no sistema um interruptor (switch) de um polo, modelo SW1AD-16, fabricado pela Pulsar Microwave Corporation (http://www.pulsarmicrowave.com). Abaixo sãao listadas as principais características desse componente:
•	Banda = 0,3 GHz a 13 GHz
•	Tipo = absortiva
•	Perda de inserção (max) = 3,5 dB
•	VSWR = 1,70
•	Tempo de çhaveamento = 100 ns
•	Tensão de controle = +5V
•	Tensao de alimentaçao = ±5VDC
•	Corrente de alimentação (tipico) = 30 mA (+5V) e 30mA (-5V)
•	Conectores = tipo SMA
A.2.2 Divisor de Potência
Foi utilizado um divisor de potência (power divider) passivo, de 2 vias, modelo PS2-16-450/8S, fabricado pela Pulsar Microwave Corporation (http://www.pulsarmicrowave.com). Abaixo sao listadas as principais características desse componente:
•	Banda = 8 GHz a 12,4 GHz
•	Perda de inserção (max) = 0,4 dB
•	VSWR (max) = 1,35
•	Conectores = tipo SMA
A.2.3 Amplificador de Potêencia
Foi utilizado um amplificador de potência (power amplifier) modelo A2CP11049, fabricado pela Teledyne Cougar (http://www.cougarcorp.com). Abaixo sãao listadas as principais características desse componente:
•	Banda = 6 GHz a 11 GHz
•	Potência de saída (max)= 30dBm
•	Ganho de pequeno sinal (min) = 18.5 dB
•	VSWR (max) = 1,7
•	Tensão de alimentação = +12VDC
•	Corrente de alimentação (max) = 590 mA
•	Conectores = tipo SMA
A.2.4 Atenuador Controlado por Tensão
Foi utilizado no sistema um atenuador controlado por tensão (voltage controlled attenuator), com controle linear, modelo AAT-28-479A/5S, fabricado pela Pulsar Microwave Corporation (http://www.pulsarmicrowave.com). Abaixo são listadas as principais características desse componente:
•	Banda = 6 GHz a 16 GHz
•	Faixa de atenuaçao = 32dB
•	Ganho = 8dB/Volt
•	Perda de inserção (max) = 4 dB
•	VSWR (max) = 2
•	Tensao de controle = 0V a 4V
•	Tensao de alimentacao = ±15VDC
•	Corrente de alimentacão (tipico) = 100 mA (+15V) e 50mA (-15V)
•	Conectores = tipo SMA
A.2.5 Misturador
Foi utilizado no sistema um misturador (mixer), passivo, modelo MMP12241, fabricado pela Teledyne Cougar (http://www.cougarcorp.com). Abaixo sao listadas as principais características desse componente:
• Banda na porta LO = 2 GHz a 12 GH
•	Banda na porta RF = 2 GHz a 12 GHz
•	Banda na porta IF = DC a 2 GHz
•	Perda de conversão (max) = 5 dB
•	Potência de LO (nominal) = +7.0 dBm
•	Conectores = tipo SMA
A.2.6 Detector
Foi utilizado no sistema um detector (detector), ativo, modelo DACP18001, fabricado pela Teledyne Cougar (http://www.cougarcorp.com). Abaixo sao listadas as principais características desse componente:
• Banda = 0,1 GHz a 18 GHz
•	Níveis de potência de entrada = -30 dBm a +5 dBm
•	VSWR (max) = 1,5
•	Tensão de alimentação = ±5VDC
•	Conectores = tipo SMA
Apendice B
Diagramas Esquematicos
A seguir sãao apresentados os diagramas esquemíaticos do sistema de alimentaçcãao DC, do sistema de controle e aquisiçcaão, e do sistema de comunicaçcãao embarcada. O sistema de controle e aquisiçcãao foi dividido em 2 míodulos: míodulo principal de processamento e míodulo de condicionamento de sinais. O míodulo de condicionamento de sinais por sua vez íe dividido em 2 sub-míodulos: moídulo de condicionamento das entradas analogicas e mídulo de condicionamento da saídas analígicas. Os componentes passivos dos míodulo de condicionamento condicionamento de sinais nãao possuem valores indicados. Os valores dependem dos ganhos que se deseja no sistema e do projeto do filtro anti-recobrimento e, portanto, nãao serãao detalhados nos diagramas esquemíaticos.
Figura B.1: Diagrama esquemático da fonte de alimentacão DC
Figura B.5: Diagrama esquemático do sistema de comunicando embarcada
Apêndice C
Mapeamento dos Registrados
Modbus da Unidade de Processamento
Na tabela C.1 é apresentado o mapa de registradores Modbus da unidade de processamento do sistema. Através do conhecimento do mapa de registradores é possível integrar a unidade de processamento a qualquer sistema compatível com o protocolo Modbus TCP/IP. O padrão Modbus utiliza registradores de 16 bits, ou 2 bytes. A funçao de cada registrador é descrita na sequência.
•	MODBUS.CONKREG: configura o modo de operaçcãao da unidade de processamento. Abaixo sao listados os possíveis valores para esse registrador:
—	0x0000 = Modo Aquisicão.
—	0x0001 = Modo Filtro Digital.
—	0x0002 = Modo Controlador.
—	0x0003 = Modo WCMeter.
•	MODBU'S TYPE REG: tipo ou modelo do equipamento. 1
•	MODBUS ID REG: define um ID alfanuméerico para o equipamento para facilitar a sua identificaçcãao numa rede com véarios equipamentos.
•	MODBU'S DESC REG: define uma descrição para um dado equipamento com o objetivo de facilitar sua identificacao e funçao numa rede com vários equipamentos.
1 por enquanto só existe um tipo
Registrador	Endereço	Tamanho (Words)
MODBUS_CONF_REG	0x0001	1
MODBUS_TYPE_REG	0x0002	1
MODBUSJD_REG	0x0003	4
MODBUS_DESC_REG	0x0007	16
MODBUSJP_REG	0x0017	2
MODBUS_MASK_REG	0x0019	2
MODBUS_GATEWAY_REG	0x001B	2
LOG_CONF_REG	0x001D	1
LOG_FREQ_REG	0x001E	1
LOG_REMOTEJP	0x001F	2
LOG_REMOTE_PORT	0x0021	1
AQ_FREQ_REG	0x0030	1
AQ_CHANNELS_REG	0x0031	1
AQ_OVERSAMPLING_REG	0x0032	1
ANALOG_OUT1_CONF_REG	0x0033	1
ANALOG_OUT2_CONF_REG	0x0034	1
ANALOG_OUT3_CONF_REG	0x0035	1
ANALOG_OUT4_CONF_REG	0x0036	1
ANALOG_OUT1_VALUE_REG	0x0037	1
ANALOG_OUT2_VALUE_REG	0x0038	1
ANALOG_OUT3_VALUE_REG	0x0039	1
ANALOG_OUT4_VALUE_REG	0x003A	1
LOG_AQ_CHANNELS_REG	0x003B	1
LOG_ANALOG_OUT_CHANNELS_REG	0x003C	1
DIGITAL_OUT1_CONF_REG	0x003D	1
DIGITAL_OUT2_CONF_REG	0x003E	1
DIGITAL_OUT1_VALUE_REG	0x003F	1
DIGITAL_OUT2_VALUE_REG	0x0040	1
REGWCMODE	0x0043	1
REG_WC_FREQ_MIN	0x0044	1
REG_WC_FREQ_MAX	0x0045	1
REG_WC_STEP_NAQ	0x0046	1
REG_WC_INTER_STEP	0x0048	1
REG_WC_AQFREQ	0x0049	1
REG_WC_AQ_OVERSAMPLING	0x004A	1
REG-WC-START	0x004B	1
Tabela C.1: Mapa dos registrador Modbus da unidade de processamento
•	MODBUS IP REG: IP do equipamento. Indispensavel quando se utiliza IP fixo.
•	MODBUS MASK RBG: mascara de rede do equipamento. Indispensavel quando se utiliza IP fixo.
•	MODBUS.GATEWAY._REG: endereco do gateway da rede Ethernet. Indis-pensavel quando se utiliza IP fixo.
•	LOG CONF REG: configura se o logging sera realizado pelo serviço do concentrador de dados, ou atraves de um serviçco externo. Abaixo sãao listados os posslveis valores para esse registrador:
—	0x0000 - logging desabilitado.
—	0x0001 - logging habilitado atraves do servico do concentrador de dados.
—	0x0002 - logging habilitado atraves de um serviço externo.
—	0x0003 - logging habilitado simultaneamente atraves do serviço do concentrador de dados e de um serviçco externo.
•	LOG FREQ REG: a frequência de logging e dada pela razao entre a frequência de aquisiçcãao e o valor deste registrador.
•	LOG REMOTE IP: configura o IP do equipamento de logging remoto. Quando se utiliza o serviçco de logging do concentrador de dados naão e necessario configurar esse parêametro.
•	LOG REMOT'E PORT’: configura a porta do equipamento de logging remoto. Quando se utiliza o serviçco de logging do concentrador de dados nãao e necessario configurar esse parêametro.
•	AQ FREQ REG: configura a frequência de aquisição de dados do sistema. Todos os canais de aquisicçãao ativos utilizam a mesma frequêencia de aquisiçcãao.
•	AQ CHANNELS REG: configura os canais analógicos habilitados. Cada bit corresponde a um canal. Quando setado, o bit habilita a aquisiçcaão do canal correspondente. Como o presente sistema so possui 4 entradas analogicas, somente os bits de 0 a 3 sãao utilizados, correspondendo cada um a uma das entradas digitais.
•	AQ OVERSAMPLING REG: configura o parêametro de oversampling dos canais de aquisição. Quando configurado com um valor diferente de 1, o sistema multiplica a frequêencia real de aquisiçcãao pelo valor n configurado no registrador, calculando entãao a media entre as n amostras, de maneira que, para o usuario,
a frequência de aquisição se mantenha constante. No entanto, como o sistema na verdade aumenta a frequência e calcula a média utilizando o mesmo fator, as medidas se tornam mais representativas. O valor 0x0000 nao é vélido para esse parêametro.
•	ANALOG OUT1 CONE REG: configura a saéda analégica 1 da unidade de processamento. Abaixo sao listados os posséveis valores para esse registrador:
—	0x0000 = saéda desabilitada.
—	0x0001 = saéda constante, configurével pelo usuério.
—	0x0002 = saéda tipo funçao predefinida.
—	0x0003 = saéda do filtro digital 1.
—	0x0004 = saéda do filtro digital 2.
—	0x0005 = saéda do controlador 1.
—	0x0006 = saéda do controlador 2.
—	0x0007 = saéda de controle do modo medidor de fração de égua.
•	ANALOG OUT2 CONE REG: configura a saéda analégica 2 da unidade de processamento. Utiliza a mesma configuraçao da saéda analógica 1.
•	ANALOG OUT3 CONE REG: configura a saéda analégica 3 da unidade de processamento. Utiliza a mesma configuracçãao da saéda analoégica 1.
•	ANALOG OU'Tl CONE REG: configura a saéda analégica 4 da unidade de processamento. Utiliza a mesma configuraçcãao da saéda analoégica 1.
•	ANALOG OUT1 VALUE REG: permite a leitura do valor atual da saéda analégica 1, ou a escrita desta, caso a saéda esteja configurada no modo ”confi-gurével pelo usuério”(0x0001).
•	ANALOG OUT2 VALUE REG: permite a leitura do valor atual da saéda analoégica 2, ou a escrita desta, caso a saéda esteja configurada no modo ”confi-gurével pelo usuério”(0x0001).
•	ANALOG OUT3 VALUE REG: permite a leitura do valor atual da saéda analéogica 3, ou a escrita desta, caso a saéda esteja configurada no modo ”confi-gurével pelo usuario”(0x0001).
•	ANALOG_OUT4 VALUE REG: permite a leitura do valor atual da saéda analéogica 4, ou a escrita desta, caso a saéda esteja configurada no modo ”confi-gurével pelo usuério”(0x0001).
•	LOG AQCHANNELSREG: habilita ou desabilita o logging das entradas analógicas do sistema. Cada bit corresponde a um canal. Como a unidade de processamento possuí apenas 4 canais de aquisição, somente o bits de 0 a 3 são utilizados. Quando setado, o bit habilita o logging do canal correspondente.
•	LOGANALOGOUTCHANNELSREG: habilita ou desabilita o logging das saídas analógicas do sistema. Cada bit corresponde a um canal. Como a unidade de processamento possuí apenas 4 saídas analógicas, somente o bits de 0 a 3 sao utilizados. Quando setado, o bit habilita o logging do canal correspondente.
•	DIGITAL OUT1 CONF REG: configura a saída digital 1 da unidade de aquisiçcãao. Abaixo sãao listados os possíveis valores para esse registrador:
—	0x0000 = saída digital desabilitada. Quando desabilitada a saída assume vai para o estado lígico baixo (zero).
—	0x0001 = saída digital configuravel pelo usuario.
—	0x0002 = saída de controle do modo medidor de fraçao de ígua
•	DIGITAL OUT2 CONF REG: configura a saída digital 1 da unidade de aquisicão. Utiliza a mesma configuração da saída digital 1.
•	DIGITAL OUT1 VALUE REG: permite a leitura do valor atual da saída digital 1, ou a escrita desta, caso a saída esteja configurada no modo ’’configurível pelo usuírio”(0x0001).
•	DIGITAL OUT2 VALUE REG: permite a leitura do valor atual da saída digital 2, ou a escrita desta, caso a saída esteja configurada no modo ’configuríavel pelo usuíario’(0x0001).
•	REG WC MODE: configura o funcionamento do modo ’medidor de fraçcãao de ígua”da unidade de processamento (MODBUS_CONF_REG = 0x0003).Abaixo sãao listados os possíveis valores para esse registrador:
—	0x0001 = modo ensaio. Nesse modo o sistema realiza ensaios prí-determinados com o sistema de microondas.
—	0x0002 = modo medidor. Nesse modo o sistema mede continuamente a fraçcãao de íagua do sistema.
•	REG WC FREQ MIN: configura a frequencia do sinal de microondas na qual o sistema deve iniciar no modo de ensaio do medidor de fracçaão de aígua. O valor mínimo í 7000 (MHz) e o míximo 12500 (MHz).
•	REGWCFREQMAX: configura a frequência maxima do sinal de microondas no modo de ensaio do medidor de fração de agua. O valor mínimo e 7000 (MHz) e o máximo 12500 (MHz).
•	REG WC STEP NAQ: configura o nuámero de mediçcãoes que devem ser realizadas em cada estágio. Aceita valores de 1 à 65535.
•	REG WC INTER ST'EP: configura o incremento da frequêencia do sinal de microondas entre os estáagios de um ensaio do modo medidor de fraçcãao de áagua.
•	REG WC AQF'REQ: configura a frequência de aquisição durante um ensaio no modo medidor de fração de agua. Quando configurado no modo medidor de fraçao de água o valor definido em AQ_FREQ_REG á ignorado pelo sistema.
•	REG WC AQ OVERSAMPLING: configura a frequência de aquisto durante um ensaio no modo medidor de fração de agua. Quando configurado no modo medidor de fração de agua o valor definido em AQ_FREQ_REG é ignorado pelo sistema.
•	REG WC START: configura o parâmetro de oversampling dos canais de aquisiçcãao durante um ensaio no modo medidor de fraçcaão de agua. Quando configurado no modo medidor de fraçcaão de agua o valor definido em AQ_OVERSAMPLING_REG é ignorado pelo sistema.
Apêndice D
Especificação dos Protocolos de Comunicação Criados
Para complementar o protocolo Modbus TCP/IP e permitir que a unidade de aquisição possuásse as funcionalidades necessarias foi necessario o desenvolvimento de alguns protocolos de comunicacçãao. Os protocolos desenvolvidos funcionam sobre UDP/IP e sao utilizados na comunicaçao entre a unidade de aquisição e o concentrador de dados. Serãao apresentados dois protocolos: o protocolo de recrutamento de equipamentos e o protocolo de solicitacçãao e configuracçaão de logging. Os protocolos sãao mánimos e simples
D.1 Protocolo de Recrutamento
O protocolo de recrutamento permite que um mestre detecte o ingresso de um novo equipamento na rede e que o equipamento detecte o mestre. Aláem de ser necessáario para permitir a resoluçcãao dos IPs dos equipamentos, o processo de recrutamento áe indispensaável para a utilizaçcãao do serviçco de logging do concentrador de dados. Somente equipamentos devidamente recrutados podem solicitar o serviçco de logging ao concentrador.
O mecanismo de recrutamento funciona atravás do broadcast, às portas 4000 da rede, de solicitacães de recrutamento (RECRUTERREQUEST) de equipamentos novos equipamentos ou nãao recrutados ainda. O serviçco de recrutamento do concentrador de dados, quando recebe uma solicitaçcaão de recrutamento, retorna ao equipamento solicitante uma confirmaçao de recrutamento (RECRUTER_ACK), informando o seu enderecço IP. Um equipamento nãao recrutado vai continuar enviando solicitaçcoães de
recrutamento periodicamente atá receber uma confirmacão de um serviço de recrutamento.
O concentrador de dados mantám a sua lista de equipamentos recrutados testando continuamente a conexão com os equipamentos atravás do serviço de ping do padrão Ethernet. Quando um equipamento deixa de responder as comandos de ping do recru-tador, este equipamento á removido da lista de equipamentos do recrutador. De forma similar, se o recrutador deixar de responder a alguma requisicao de um equipamento, este assume o estado de nãao recrutado e passa a enviar solicitacãoes novamente.
Toda vez que o servico de recrutamento á iniciado, re-inciado ou tem o seu endereco IP alterado, o recrutador envia na rede, atravás de um broadcast, uma notificação de RECRUTERCHANGE, informando seu novo IP. Os equipamentos que recebem essa notificacçãao devem passar ao estado de nãao-recrutados, reiniciando o processo de recrutamento atravás do envio periádico de solicitações de RECRUTERREQUEST. Abaixo são descritas as mensagens de solicitação (RECRUTERREQUEST), confirmação (RE-CRUTERACK) e notificacão (RECRUTERCHANGE).
Comando ID do equipamento Descrição do equipamento Tipo do equipamento	1 Byte 8 Bytes 24 Bytes 1 Byte	0xCC 8 caracteres ASCII 24 caracteres ASCII 0x01
Tabela D.1: Mensagem de solicitacão de recrutamento (RECRUTERREQUEST)
Comando IP do concentrador de dados	1 Byte 4 Bytes	0xCE b1.b2.b3.b4
Tabela D.2: Mensagem de confirmação de recrutamento (RECRUTERACK)
Comando IP do concentrador de dados	1 Byte 4 Bytes	0xCA b1.b2.b3.b4
Tabela D.3: Mensagem de notificação de mudança do concentrador de dados (RECRUTERCHANGE)
D.2 Protocolo de Logging
O protocolo de logging permite a utilizacão do serviço de logging do concentrador de dados. Qualquer equipamento que esteja na lista de equipamentos cadastrados pode solicitar ao concentrador de dados um canal de logging. Para cada equipamento que solicitar um canal de logging é criado uma tarefa específica para receber, tratar e armazenar os dados enviados pelo equipamento. A tarefa de logging de um determinado equipamento vai continuar ativa atée que o equipamento solicite o encerramento
do serviçco, ou entãao, saia da rede e, consequentemente, da lista de equipamentos recrutados. De maneira a otimizar a utilização da memoria no concentrador de dados, a tarefa de logging de um dado equipamento sá é criada quando o equipamento envia um requisiçao (LOGGER_REQUEST) ao concentrador de dados.
O mecanismo do serviço de logging inicia com o envio, via UDP/IP, de uma requisição de logging a porta 4001 do concentrador de dados. Juntamente com a re-quisicçaão o equipamento deve informar ao serviçco de logging o nuémero de canais de logging que serão utilizados, a frequência de logging (em funcão da frequência de aquisição), a frequência de aquisição e o tamanho do pacote de dados que será utilizado. O tamanho do pacote ée definido pelo equipamento de maneira a otimizar sua memoria e seus buffers internos. Um pacote pode conter os dados de logging de diversos canais, durante um dado peréodo de tempo.
Quando o serviçco de logging recebe uma requisiçcãao de um equipamento, este entaão cria uma tarefa especéfica para a recepçcãao e tratamento do fluxo de dados de logging gerado pelo equipamento. O serviçco de logging retorna uma confirmaçcaão de criaçcãao de canal de logging (LOGGERACK) ao equipamento solicitante. Quando cria a tarefa de logging para um dado equipamento, o serviçco de logging designa uma porta de comunicacao para ser usada unica e exclusivamente para a comunicaçao de logging com o equipamento. Junto com a confirmaçcãao de criaçcaão de canal de logging o servicço de logging retorna ao equipamento a porta designada para a comunicaçcaão de logging desse equipamento. Apéos o recebimento da confirmacçãao da criaçcãao de canal de logging o equipamento pode iniciar o envio de dados de logging para a porta designada do concentrador de dados.
Os dados de logging são enviados na forma de um streaming de dados ao concetra-dor. Somente o equipamento envia dados ao concentrador. Nao existem mecanismos de controle de erros ou de transmissaão segura. Junto com cada pacote de logging o equipamento envia um byte de sequência de pacote ao concentrador. O byte de sequência é incrementado a cada novo envio. O numero de sequência funciona como um mecanismo de estampa de tempo simples. Com base nas configuraçcãoes de frequêencia de logging e de frequêencia de aquisicçaão, enviados com a requisicçaão de logging, o concentrador calcula a estampa de tempo referente a um dado byte de sequêencia e estampa no arquivo de logging o instante de recebimento de cada dado. Cada tarefa de logging criada ée associada a um unico arquivo de logging. O arquivo de logging fica armazenado no concentrador de dados e pode ser posteriormente recuperado.
Uma tarefa de logging pode ser encerrada pelo equipamento solicitante atravées do envio de uma solicitacão de finalização de canal de logging (LOGGER_STOP) ao servico de logging na porta 4001 do concentrador de dados. Quando o concentrador recebe uma requisiçcãao de finalizaçcaão ele encerra a tarefa de logging criada para o equipamento e
libera o arquivo de logging gerado para o sistema do concetrador. O arquivo de logging tambéem ée liberado para o sistema se o equipamento sai da lista de equipamentos recrutados ou solicita um canal de logging jéa possuindo um canal de logging ativo. Abaixo são descritas as mensagens de solicitação (LOGGERREQUEST), confirmação (LOGGERACK) e notificacão (LOGGERSTOP).
Comando	1 Byte	0xDC
Canais de logging	2 Bytes	cada bit representa um canal
Frequência de logging	2 Bytes	0 a 65535
Frequência de aquisiçao	2 Bytes	0 a 65535
Tamanho do pacote de logging	1 Byte	
Tabela D.4: Mensagem de solicitaçao de criação de canal de logging (LOGGERREQUEST)
Comando Porta de comunicação dedicada	1	Byte 2	Bytes	0xDE 0 a 65535
Tabela D.5:
Mensagem de confirmacão de criacao de canal de logging (LOGGERACK)
Comando	1 Byte	0xD9
Tabela D.6: Mensagem de notificaçao de finalizacão de canal de logging (LOGGEREND)
Apêndice E
Descrição dos Webservices do Sistema do Concentrador de Dados
Neste apêndice são apresentados os Webservices disponibilizados pelo sistema do concentrador de dados. Esses Webservices podem ser utilizados por qualquer aplicacão de usuario que venha a ser desenvolvida. Tambem podem ser utilizados por qualquer sistema supervisorio que tenha suporte, ou driver, para Webservices. As funções que serao apresentadas permitem a utilizaçao de todas as funcionalidades da unidade de processamento. Tambem permitem que o usuario interaja com o sistema num nível de abstração maior do que a utilizaçao do protocolo Modbus TCP/IP permite. Enquanto que, utilizando-se o protocolo Modbus, a configuraçao do sistema é realizada atraves do escrita e leitura de registradores, os Webservices criam uma camada de abs-traçcãao que torna detalhes do protocolo e da implementaçcãao transparentes ao usuario. As funçcãoes e estruturas de dados utilizadas pelo Webservices sãao obtidas automaticamente pelo cliente atraves da linguagem WSDL (Web Services Description Language) e do protocolo UDDI (Universal Description, Discovery and Integration), definidos na especificaçcãao da tecnologia de Webservices. As funçcãoes disponibilizadas pelos Webservices sao descritas abaixo. Na sequência sao apresentadas as estruturas de dados utilizadas. Os protótipos1 das funçoes e das estruturas são apresentados na sintaxe da linguagem CSharp.
E.1 Funcães dos Webservices
Mo inglês: prototypes
•	HWList ListHardwares() - retorna uma lista com os dados dos equipamentos detectados na rede pelo concentrador de dados.
•	bool WriteRegister(IP, REG ADD, REG.VALUE) - implementação da função Modbus de escrita de um Unico registrador. O parametro IP corresponde ao endereço da unidade na rede. O parametro REGADD e o endereço do registrador Modbus que se deseja escrever. A funçcãao retorna verdadeiro se o comando foi bem sucedido, ou falso caso contrario.
•	bool WriteCoil(IP, COIL ADD, COIL.STATE) - implementacão da funcão Modbus de escrita de uma saída digital. O parâmetro IP corresponde ao endereço da unidade na rede. O parâmetro COILADD é a saída digital que se deseja escrever. A funçcãao retorna verdadeiro se o comando foi bem sucedido, ou falso caso contrário.
•	bool WriteMultipleRegisters(IP,	REG..STARTADD, DATA,
N REG) - implementação da função Modbus de escrita de multiplos registradores. O parâametro IP corresponde ao endereçco da unidade na rede. O parâmetro REGSTART é o endereço do primeiro registrador Modbus que se deseja escrever. O parâmetro N_REG corresponde ao numero de registradores, a partir de REGSTART_ADD, que se deseja escrever. Os valores que se deseja escrever devem ser passados, na ordem correspondente, atraves do parâametro DATA. A funçcaão retorna verdadeiro se o comando foi bem sucedido, ou falso caso contrario.
•	bool ReadMultipleRegisters(IP, REG START ADD, N REG, ref DATA) - implementaçcãao da funcçãao Modbus de leitura de multiplos registradores. O parâametro IP corresponde ao endereçco da unidade na rede. O parâmetro REGSTART é o endereço do primeiro registrador Modbus que se deseja ler. O parâmetro N_REG corresponde ao numero de registradores, a partir de REGSTART_ADD, que se deseja ler. Os resultados do comando de leitura serãao armazenados em DATA. A funçcaão retorna verdadeiro se o comando foi bem sucedido, ou falso caso contrario.
•	bool ReadInputRegisters(IP, REGI START ADD,	N..REG,	ref
DATA) - implementaçcãao da funçcãao Modbus de leitura de multiplas entradas analogicas. O parâametro IP corresponde ao endereçco da unidade na rede. O parâmetro REGSTART a primeira entrada analógica que se deseja ler. O parâmetro N_REG corresponde ao numero de entradas analogicas, a partir de REGSTART_ADD, que se deseja ler. Os resultados do comando de leitura serãao armazenados em DATA. A funçcaão retorna verdadeiro se o comando foi bem sucedido, ou falso caso contrario.
•	bool ConfigureAquisitionRegisters(IP, AQRegs) - permite a configuração dos parêametros de aquisicçãao de dados da unidade de processamento. A estrutura AQRegs que contóm a configuraçao desejada deve ser passada como parâmetro. O parêametro IP corresponde ao endereçco da unidade na rede. A funçcãao retorna verdadeiro se o comando foi bem sucedido, ou falso caso contróario.
•	bool ConfigureAnalogOutputRegisters(IP, AnalogOutRegs) - permite a configuracçãao dos parêametros das saódas analoógicas da unidade de processamento. A estrutura AnalogOutRegs que contóem a configuraçcãao desejada deve ser passada como paraêmetro. O parêametro IP corresponde ao endereçco da unidade na rede. A funcçaão retorna verdadeiro se o comando foi bem sucedido, ou falso caso contraório.
•	bool ConfigureDigitalOutputRegisters(IP, DigitalOutRegs) - permite a configuraçcãao dos parêametros das saódas analóogicas da unidade de processamento. A estrutura DigitalOutRegs que contóm a configuração desejada deve ser passada como paraêmetro. O parêametro IP corresponde ao endereçco da unidade na rede. A funcçãao retorna verdadeiro se o comando foi bem sucedido, ou falso caso contraório.
•	bool ConfigureEthernetModule(IP, EthernetModuleRegs) - permite a configuraçcãao dos parêametros de rede da unidade de processamento. A estrutura EthernetModuleRegs que contóm a configuracão desejada deve ser passada como parêametro. O parêametro IP corresponde ao endereçco da unidade na rede. A funcçãao retorna verdadeiro se o comando foi bem sucedido, ou falso caso contraório.
•	bool ConfigureLoggingRegisters(IP, LOGRegs) - permite a configuracão dos parâmetros de logging da unidade de processamento. A estrutura LOGRegs que contóm a configuraçao desejada deve ser passada como parâmetro. O parêametro IP corresponde ao endereçco da unidade na rede. A funçcãao retorna verdadeiro se o comando foi bem sucedido, ou falso caso contróario.
•	bool ConfigureLoggingChannels(IP, LOGChannelsRegs) - permite a configuraçcãao dos canais de logging da unidade de processamento. A estrutura LOGChannelsRegs que contóm a configuração desejada deve ser passada como parêametro. O parêametro IP corresponde ao endereçco da unidade na rede. A funcçãao retorna verdadeiro se o comando foi bem sucedido, ou falso caso contraório.
•	bool ConfigureWCRegisters(IP, WCRegs) - permite a configuração dos parêametros de funcionamento do modo medidor de fraçcãao de óagua da unidade de processamento. A estrutura WCRegs que contóm a configuração desejada deve ser passada como paraêmetro. O parêametro IP corresponde ao endereçco da unidade na rede. A funçcãao retorna verdadeiro se o comando foi bem sucedido, ou falso caso contraório.
•	bool SetAnalogOutputs(IP, AnalogOutRegs) - permite a definiçao dos valores das saádas analáogicas da unidade de processamento. A estrutura Analo-gOutRegs que contáem os valores desejados deve ser passada como paraêmetro. O parêametro IP corresponde ao endereçco da unidade na rede. A funçcaão retorna verdadeiro se o comando foi bem sucedido, ou falso caso contráario.
•	EthernetModuleRegs ReadEthernetModuleConfiguration(IP) - permite a leitura dos parêametros de configuracçãao de rede da unidade de processamento. O paraêmetro IP corresponde ao endereçco da unidade na rede. A funçcãao retorna a estrutura EthernetModuleRegs com os parêametros lidos da unidade de processamento.
•	AQRegs ReadAquisitionConfigurationRegisters(IP) - permite a leitura dos parêametros de configuracçãao de aquisiçcãao da unidade de processamento. O parêametro IP corresponde ao endereçco da unidade na rede. A funçcãao retorna a estrutura AQRegs com os parêametros lidos da unidade de processamento.
•	AnalogOutRegs ReadAnalogOutConfigurationRegisters(IP) - permite a leitura dos parêametros de configuraçcãao das saádas analáogicas da unidade de processamento. O parêametro IP corresponde ao endereçco da unidade na rede. A funçcãao retorna a estrutura AnalogOutRegs com os parêametros lidos da unidade de processamento.
•	DigitalOutRegs ReadDigitalOutConfigurationRegisters(IP) - permite a leitura dos parêametros de configuraçcaão das saádas digitais da unidade de processamento. O parêametro IP corresponde ao endereçco da unidade na rede. A funçcãao retorna a estrutura DigitalOutRegs com os parêametros lidos da unidade de processamento.
•	LOGChannelsRegs ReadLoggingChannelsRegisters(IP) - permite a leitura dos parêametros da configuraçcãao de canais de logging habilitados da unidade de processamento. O parêametro IP corresponde ao endereçco da unidade na rede. A função retorna a estrutura LOGChannelsRegs que contám a configuraçao de canais de logging habilitados da unidade de processamento.
•	LOGRegs ReadLoggingConfigurationRegisters(IP) - permite a leitura dos parêametros de configuraçcãao de logging da unidade de processamento. O paraêmetro IP corresponde ao endereçco da unidade na rede. A funçcaão retorna a estrutura LOGRegs com os paraêmetros lidos da unidade de processamento.
•	WCRegs ReadWCConfigurationRegisters(IP) - permite a leitura dos parêametros de funcionamento do modo medidor de fracçãao de áagua da unidade de processamento. O parêametro IP corresponde ao endereçco da unidade na rede.
A função retorna a estrutura WCRegs com os parâmetros lidos da unidade de processamento.
E.2 Estruturas de Dados do Webservices
Abaixo são listadas todas as estruturas de dados utilizadas no serviço de Webservices do concentrador de dados.
HWTNode[32] HWList
struct HWTNode
String IP;
String ID;
String DESC; byte TYPE;
struct EthernetModuleRegs
bool DHCP;
int TYPE;
String ID;
String DESC;
String IP;
String MASK;
String GATEWAY;
struct AQRegs
ushort AQ_FREQ;
ushort AQ_CHANNELS;
ushort AQ_OVERSAMPLIG;
struct AnalogOutRegs
ushort ANALOG_OUT_1CONF;
ushort ANALOG_OUT_1VALUE;
ushort ANALOG_OUT_2CONF;
ushort ANALOG_OUT_2VALUE;
ushort ANALOG_OUT_3CONF;
ushort ANALOG_OUT_3VALUE;
ushort ANALOG_OUT_4CONF;
ushort ANALOG_OUT_4VALUE;
struct WCRegs
ushort WC_MODE;
ushort WC_FREQ_MIN;
ushort WC_FREQ_MAX;
ushort WC_STEP_NAQ;
ushort WC_STEP_SIZE;
ushort WC_INTER_STEP;
ushort WC_AQ_FREQ;
ushort WC_AQ_OVERSAMPLING;
struct DigitalOutRegs
ushort DIGITAL_OUT_1CONF;
ushort DIGITAL_OUT_2CONF;
ushort DIGITAL_OUT_1VALUE;
ushort DIGITAL_OUT_2VALUE;
struct LOGChannelsRegs
ushort LOG_AQ_CHANNELS;
ushort LOG_ANALOG_OUT_CHANNELS;
struct LOGRegs
ushort LOG_CONF;
ushort LOG_FREQ;
String REMOTE_IP;
ushort REMOTE_PORT;
Referências Bibliográficas
[1]	David Achson. From Calculus to Chaos - An Introduction to Dynamics. Oxford Un iversity Press, 1997.
[2]	Jan Axelson. Embedded Ethernet and Internet Complete - Desingning and Programming Small Devices for Networking. Lakeview Research LLC, 2003.
[3]	Ibrahim M.M. Babelli. In search of an ideal multiphase flow meter for the oil industry. The Arabian Journal for Science and Engineering, 27(2B), october 2002.
[4]	Jeremy Bentham. TCP/IP Lean - Web Servers for Embedded Systems. CMP Books, 2002.
[5]	Johan Carlson. Ultrasonic Characterization of Materials and Multiphase Flows. PhD thesis, Lulea University of Technology, 2002.
[6]	Kai Chang. RF and Microwave Wireless Systems. John Wiley and Sons, INC., 2000.
[7]	Martin Chaplin. Water structure and science. obtido no site da London South Bank University, 2007.
[8]	Jose A. P. da Silva Filho e Fransisco J. de Silva Neto Claudio B.C. Silva, Miguel J. Borges Filho. Criterio para a seleção de medidores multifasicos na petrobras. Boletim tecnico, Petrobras, jan/dez 1999.
[9]	Pertti Vainikainen Ebbe G. Nyfors. Industrial Microwave Sensors. Artech House, INC., 1989.
[10]	Sidnei Noceti Filho. Filtros Seletores de Sinais. Editora da UFSC, 2003.
[11]	Nathan Ida. Microwave NDT. Kluwer Academic Publisher, 1992.
[12]	Texas Instruments. Op Amps for Everyone. Texas Instruments.
[13]	Andy W. Jamieson. Multiphase metering - the challenge of implementation. 16th Noth Sea Flow Measurement Workshop, 1998.
[14]	Eivind Dykesteen John Amdal, Harald Danielsen. Handbook of multiphase metering. Technical report, The Norwegian Society for Oil and Gas Measurement.
[15]	Martyn John Key. Gas Microstructure X-Ray Detectors and Tomographic Multiphase Flow Measurement. PhD thesis, University of Surrey, 1999.
[16]	Mamoru Ishii Lefteri H. Tsoukalas and Ye Mi. A neurofuzzy methodology for impedance-based multiphase flow identification. Engng. Applic. Artif. Intell., 10(6):545,555, 1997.
[17]	W. Merzkirch M. Schneider, F. Peters. Influence of velocity profile and turbulence on cross-correlation-based flow metering.
[18]	Modbus-IDA.	Modbus application protocol specification v1.1b.
http://www.modbus.org.
[19]	Modbus-IDA. Modbus messaging on tcp/ip implementation guide v1.0b. http://www.modbus.org.
[20]	Ebbe Gustaf Nyfors. Cylindrical Microwave Resonator Sensors For Measuring Materials Under Flow. PhD thesis, Helsinki University of Technology, 2000.
[21]	Inc Omega Engineering. Transactions in Mesuarement and Control - Volume IV - Flow and Level Measurement, volume IV of Transactions in Mesuarement and Control. Omega Engineering, Inc.
[22]	Emilio E. Paladino and Clovis R. Maliska. Multi-phase flow modelling in differential pressure flow meters. Proceedings of the ENCIT 2002, 2002.
[23]	David M. Pozar. Microwave Engineering. John Wiley adn Sons, INC., 1998.
[24]	Nilesh Rajbharti. The microchip tcp/ip stack. Technical report, Microchip Technology Inc.
[25]	Ulrich L. Rohde and David P. Newkirk.
[26]	Andrzej W. Kraszewski Samir Trabelsi and Stuart O. Nelson. Phase-shift ambiguity in microwave dielectric properties measurements. IEEE Transactions On Instrumentation And Measurement, 49(1), February 2000.
[27]	Alexander S. Sovlukov and Victor I. Tereshin. Measurement of liquefied petroleum gas quantity in a tank by radio-frequency techniques. IEEE Transactions On Instrumentation and Measurement, 53(4), August 2004.
[28]	Steve Winder. Analog and Digital Filter Design. Newnes, second edition edition, 2002.</field>
	</doc>
</add>