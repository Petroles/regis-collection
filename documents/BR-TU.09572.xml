<?xml version="1.0" encoding="utf-8"?>
<add>
	<doc>
		<field name="docid">BR-TU.09572</field>
		<field name="filename">14552_Pinheiro_NathalieCarvalho_M.pdf</field>
		<field name="filetype">PDF</field>
		<field name="text">Universidade Estadual de Campinas
Faculdade de Engenharia ElEtrica e de ComputaçAo
Nathalie Carvalho Pinheiro
Controle Impulsionai para Limitação da Variação de Nível com Minimização das Atuaçães
UNICAMP
Nathalie Carvalho Pinheiro
Controle Impulsionai para Limitação da Variação de Nivel com Minimização das Atuações
Dissertaçao de mestrado apresentada a Faculdade de Engenharia Elétrica e de Computaçao como parte dos requisitos exigidos para a obtenção do tétulo de Mestre em Engenharia Elétrica.
Area de concentracao: Automação.
Orientador: João Bosco Ribeiro do Val
FICHA CATALOGRÁFICA ELABORADA PELA
BIBLIOTECA DA ÁREA DE ENGENHARIA E ARQUITETURA - BAE - UNICAMP
Pinheiro, Nathalie Carvalho
P655c	Controle impulsionai para limitação da variação de
nível com minimização das atuações / Nathalie Carvalho Pinheiro. --Campinas, SP: [s.n.], 2009.
Orientador: João Bosco Ribeiro do Val.
Dissertação de Mestrado - Universidade Estadual de Campinas, Faculdade de Engenharia Elétrica e de Computação.
1. Teoria de controle estocástico. 2. Equações diferenciais parciais estocásticos - Soluções numéricas. 3. Escoamento multifasico. I. do Val, João Bosco Ribeiro. II. Universidade Estadual de Campinas. Faculdade de Engenharia Elétrica e de Computação. III. Título.
Título em Inglês: Impulse control with liquid level limits and minimization of actuations
Palavras-chave em Inglês: Stochastic control theory, Differential equations, partial -Numerical solutions, Multiphase flow
Área de concentração: Controle e Automação
Titulação: Mestre em Engenharia Elétrica
Banca examinadora: Daniel Oliveira Cajueiro, Rafael Santos Mendes
Data da defesa: 30/07/2009
Programa de Pós Graduação: Engenharia Elétrica
COMISSÃO JULGADORA - TESE DE MESTRADO
Candidata: Nathalie Carvalho Pinheiro
Data da Defesa: 30 de julho de 2009
Título da Tese: "Controle Impulsionai para Limitação da Variação de Nível com Minimização das Atuações"
Prof. Dr. João Bosco Ribeiro do Vai (Presidente^
Prof. Dr. Daniel Oliveira Cajueiro:
Prof. Dr. Rafael Santos Mendes:
Para minha família, Neuman e Nathan.
Nilton,
Agradecimentos
Agradeço,
ao Prof. João Bosco pelos dois anos de excelente orientaçao acadêmica e valorosos conselhos;
aos professores Rafael Mendes, José Ricardo Mendes e Adriane Serapião e ao Paulo Gasse pela oportunidade de participar do projeto do VASPS e pelo étimo grupo de trabalho;
à UnB e a Unicamp, as duas grandes universidades que marcaram minha vida;
aos amigos do DT, Renato, Ricardo, Walter, Taís, Eduardo, Ceara, Giuliano, Julio, Tiago, Jurandyr, Alessandro, Victor e Heber, pela companhia e por todo o conhecimento adquirido nas horas do cafée;
aos outros amigos da FEEC, Anzai, Grace, Alim, Leonardo, Felipe, Michell, Leonardo Lustosa e Valéria, pela força durante essa caminhada e, em especial, à Michele, pela imensa ajuda quando meu computador me deixou na mãao;
aos amigos de Brasélia que tambéem vieram para céa, Maice, Renata, Andrée, Flaévio, Fontes, Chico, Ednei e Maguila;
aos brasilienses que ficaram torcendo por nés à distancia;
aos meus pais e meu irmão, por todo o amor, apoio e confiança;
ao Claudio, pelo amor e pela étima companhia, mesmo que nem sempre pudesse estar ao meu lado.
Esse trabalho contou com o apoio da Fundação de Amparo a Pesquisa do Estado de São Paulo, FAPESP.
Resumo
Os elevados custos de produção na extração de petróleo marítimo são reduzidos com um sistema inovador que a Petrobras estó desenvolvendo, denominado VASPS (do inglês, Vertical Annular Separation and Pumping System), capaz de separar gós e líquido ainda no assoalho oceanico. Esta dissertação trata do ajuste do nível de líquido no reservatório do VASPS, via controle impulsional estocóstico, que se distancia bastante de um regulador convencional. A vazão de entrada flutua e o controle consiste em alterar a velocidade da bomba de saída do tanque, mantendo o nível numa faixa de operacão, na qual ele varia livremente sem prejuízo. Todavia, ó necessório de um lado observar o risco de operar proximo aos extremos de nível e de outro minimizar o nuómero de intervençcoães na velocidade da bomba para prolongar sua vida útil. Optou-se por modelar o sistema por meio de um processo de difusão e formular por controle impulsional. Para a sua solução, o controle impulsional óe convertido em uma sequêencia de problemas de parada óotima iterados, resolvidos utilizando-se a Discretizacão do Valor Médio, MVS (do inglês, Mean Value Scheme). Esta dissertaçcãao introduz o uso do controle impulsional nesta aplicaçcaão alóem da tóecnica citada para resolver problemas de parada oótima.
Palavras-chave: Processos de difusão, controle impulsional, controle estocóstico, solucçãao numóerica de equaçcãoes diferenciais parciais, móetodo de discretizaçcãao do valor móedio, separador multifaósico.
Abstract
The high costs in offshore oil production are reduced with the use of an innovative system which has been developed by Petrobras, the Brazilian oil company. Called VASPS (Vertical Annular Separation and Pumping System), it consists of an undersea gas/liquid separator. This work presents a strategy for the liquid level adjustment in the VASPS tank, which is subject to uncertain liquid inflow. This is far from a strict control regulator problem, since the liquid level may drifts freely inside an operation range. Although, in one hand, it is necessary to account for a risky operation near the limits, on the other hand, acting freely and continuously in the controlled pump may drastically shorten the lifetime of the equipment. To prevent premature worn with halt in the oil production, the control input variations should be meager. We propose a stochastic impulse control for varying the outflow pump speed. This formulation is transformed in a sequence of iterated optimal stopping problems, which results in a sequence of variational inequalities. We employ the numerical method called Mean Value Scheme (MVS) to solve this type of problem. This monograph introduces impulse control to the resevoir level adjustment of VASPS, together with the application of the MVS to its solution.
Key-words: Diffusion process, impulse control, stochastic control, numerical solution of partial differential equations, mean value scheme, multiphase separation.
Lista de Figuras
1.1	Esquema de sistema de produção de petróleo com VASPS.......................... 2
1.2	Representação esquemótica da estrutura do VASPS............................... 3
1.3	Espaço de estados no modelo do VASPS.......................................... 6
1.4	Espaço de estados no modelo do VASPS.......................................... 7
3.1	Região coberta por bolas regulares para utilização do MVS.............................
28
4.1 Dimensães do VASPS.....................................................
36
4.2
4.3
4.4
4.5
Curvas de nível do risco de continuaçao.......................................
(a)Regioes e destinos e (b) Comparaçao entre Vz e M[Vi-1], com ^max = 20,
^min	10, rmax	1; csoma	0,01 e Cmult	1,5.
Regioes e destinos para ^ax = 20, ^min = 10, rmax = 1, 0»ma = 0,01 e: (a) cmult — 1 e (b) cmult — 2.........................................................
Regiães e destinos para: (a) a = 0,4, ^ax = 20, ^min = 10, rmax = 1, 0»ma = 0,01 e cmult 1,5; (b) ^max 2; ^min 1; (c) rmax 2 e (d) a 0,2...........................
37
39
40
41
5.1	Diagrama de blocos principal do programa em Simulink.......................... 44
5.2	Sub-blocos da simulaçao em Simulink........................................... 44
5.3	Simulação com controlador conservador da Figura 4.4(a)........................ 45
5.4	Simulaçao com controlador moderado da Figura 4.3(a)........................... 46
5.5	Simulação com	controlador liberal da Figura 4.4(b).......................... 47
5.6	Utilização da estimativa da vazão de entrada para alterar o	mapeamento........ 48
5.7	Queda de poco	com controlador conservador da Figura 4.4(a).................. 49
5.8	Queda de poço	com controlador moderado da Figura 4.3(a)..................... 50
5.9	Queda de poço	com controlador liberal da Figura 4.4(b)...................... 50
5.10	Envelhecimento de pocos com controlador conservador da Figura 4.4(a)......... 51
5.11	Envelhecimento de poços com controlador moderado da Figura 4.3(a)............ 51
5.12	Envelhecimento de poços com controlador liberal da Figura 4.4(b)............. 52
5.13	Representação esquemática do modelo para controle de nível de líquido........ 53
5.14	Algoritmo de uma iteraçao do filtro de Kalman, vide [1]...................... 54
5.15	Geração de medidas de nível de líquido.................................... 54
5.16	Estimativa da vazão de entrada usando filtro de Kalman.................... 55
Lista de Símbolos
qt	Vazão de entrada no reservatório do VASPS.
qS	Vazao de saída do reservatório do VASPS.
X?	Espaço de estados (conjunto fechado).
X Espaço de estados, excluindo sua fronteira (conjunto aberto). dX Fronteira do espaco de estados.
ht	Nível de líquido no VASPS (primeira componente do vetor de estados).
5t	Balanço de vazão no VASPS (segunda componente do vetor de estados).
Custo terminal (custo de atingir a fronteira).
c	Custo de intervencão.
r	Custo de continuacão.
Ar	Area da seçao transversal do VASPS.
x	Estado inicial.
a	Fator de desconto no problema com custo descontado.
Ti	Tempo de parada da ocorrência do i-ósima intervencao.
1{.}	Função indicadora: vale 1 quando {. } ó verdadeira e 0 caso contrario.
T Tempo final (representa instante que a fronteira ó alcançada).
Ex[.] Valor esperado da expressão, com o processo iniciando-se em x, isto ó, E [.|Xo = x].
J Funçao de custo do controle impulsional sem limite de intervençães.
Xt	Vetor de estados.
G Conjunto de valores de impulso admissóveis.
r Funcão que descreve próximo estado após intervençao.
V Conjunto de sequências de controle admissóveis para controle impulsional sem limite de intervençcãoes.
v Sequência de controle admissóvel para controle impulsional sem limite de intervençcãoes.
t*	Tempo de explosao:= limR_ .x inf{t &gt; 0; |X(t)| &gt; R}.
Vn	Conjunto de sequências de controle admissóveis para controle impulsional
com n intervenções.
Jn	Funcao de custo do controle impulsional de até n intervencoes.
Vn	Custo do n-ósimo problema de parada ótima iterado.
q.c. Quase certamente (definição no Apêndice A).
A Gerador de um processo de difusão.
C0(U)
Ck (U)
Co (U)
Qx
T
Vn
T
T
No
N
Mo
M
ro
Q
In
al, a% e af
To
Tf
Classe de funções limitadas e contínuas em U.
Classe de funções com derivadas até k-ésima ordem contínuas em U.
Classe de funções com derivadas até k-ésima ordem contínuas e com suporte compacto em U.
Lei de probabilidade de Xt iniciando-se em x.
Conjunto de todos os tempos de parada menores que o tempo final T. Sequência de controle admissível obtida truncando-se v após n intervencoes. Tempo final utilizando-se a sequência de controle v.
Tempo final utilizando-se a sequência de controle truncada vn.
Numero de linhas de nos na rede quadrada do MVS, incluindo a fronteira.
Numero de linhas de nos na rede quadrada do MVS, excluindo a fronteira. Numero de colunas de nos na rede quadrada do MVS, incluindo a fronteira. Nuémero de colunas de néos na rede quadrada do MVS, excluindo a fronteira. Distancia entre nos na rede quadrada do MVS.
Bolas do método MVS.
Cobertura parcial do espaço de estados no MVS (uniao das bolas).
Funcao de Bessel modificada de n-ésima ordem.
Elementos da matriz de covariâncias aaT.
Fator de escalonamento no tempo.
Constante de tempo do filtro passa-baixas no filtro de Kalman implementado.
o / •
Sumario
1	Introdução	1
1.1	O projeto VASPS............................................................ 1
1.2	Objetivo desta dissertação................................................. 4
1.3	A proposta de soluçao ..................................................... 5
1.4	Apresentaçao da dissertaçao................................................ 7
2	Controle Impulsionai e sua Aplicação no VASPS	9
2.1	Modelagem do sistema....................................................... 9
2.2	Custo do controle impulsional............................................. 10
2.3	Problemas de parada otima iterados........................................ 12
2.4	Descrição por desigualdades variacionais.................................. 14
2.5	Demonstracoes dos Teoremas 2.1 e 2.3 e do Lema 2.1........................ 17
2.5.1	Demonstração do Teorema 2.1........................................ 18
2.5.2	Demonstração do Lema 2.1 ......................................... 21
2.5.3	Demonstração do Teorema	2.3....................................... 24
3	Discretizaçao do Valor Médio	26
3.1	Classificação de equaçães diferenciais parciais .......................... 26
3.2	Descrição do método....................................................... 27
3.3	Obtenção da equação de Helmholtz.......................................... 30
3.4	Aplicação do MVS ao VASPS................................................. 31
4	Resultados Numéricos	34
4.1	Escalonamento no tempo.................................................... 34
4.2	Descrição dos exemplos simulados.......................................... 36
4.3	Regiães obtidas........................................................... 38
4.3.1	Variação do custo de intervenção - três cenérios................... 40
4.3.2	Variacão de outras funcães......................................... 40
5	O simulador do VASPS	43
5.1	Simulação do sistema................................................... 43
5.2	Resultados............................................................. 45
5.2.1	Simulaçães dos três cenários: condiçães normais de vazão......... 45
5.2.2	Simulaçães dos três cenários: vazães de entrada especiais........ 49
5.3	Estimação da vazão de entrada ......................................... 51
6	Conclusões	56
Bibliografia	59
A	Conceitos Basicos	no	Estudo de Processos de Difusao	63
B	Matrizes expandidas	do MVS	66
Introdução
A motivação deste trabalho vem de desafios que surgiram no desenvolvimento de um sistema inovador da indUstria do petróleo, denominado Sistema Separador e Bombeador Anular Vertical, VASPS (do inglês, Vertical Annular Separation and Pumping System), capaz de aumentar bastante o ganho de produção na extracão de petróleo do leito marinho. Este sistema estó sendo desenvolvido pela Petrobras e faz parte de um convênio de cooperaçao com o Departamento de Engenharia do Petróleo da FEM/Unicamp. Um dos objetivos do convênio ó o desenvolvimento de um novo controlador para a bomba centrífuga que atenda a novos requisitos e ó nesse contexto que esta dissertacão estó inserida. Neste capótulo ó apresentada uma visao geral do projeto e os objetivos do ponto de vista do módulo de controle, além de um resumo do conteudo dos proóximos capótulos.
1.1	O projeto VASPS
O objetivo do VASPS ó realizar no leito marinho a separação multifasica da produção de poçcos de petróoleo marótimos e fazer o bombeio do lóquido em uma tubulacçãao separada do góas. Atualmente a separacçaão de góas, oóleo e óagua óe feita nas plataformas, poróem isso acarreta um custo muito elevado. Um dos motivos ó o fato de fluidos multifósicos estarem sujeitos a padrães de escoamento bastante irregulares, que sãao agravados pela subida do leito marinho atóe o nóvel do mar. Particularmente, os sifães e a estrutura vertical do riser (linha de subida para a plataforma) induzem o escoamento com golfadas severas, em que hóa a formaçcaão de grandes bolhas de gas, vide [2]. Acrescente-se a isso o fato que os sistemas separadores convencionais sãao compostos por tanques grandes e pesados, o que torna as plataformas muito caras, vide
[3]. A utilização do VASPS permitiró a redução do numero de plataformas, com cada VASPS recebendo a produçcãao de vóarios poçcos de perfuraçcaão e fazendo a separaçcaão e o bombeio para plataformas próximas, conforme o esquema da Figura 1.1.
A separaçcaão de lóquido e gaós óe feita no leito marinho utilizando o conceito de separaçcãao ciclêonica, caracterizado por um peso menor e um custo reduzido, quando comparado aos sepa-
Figura 1.1: Esquema de sistema de produção de petróleo com VASPS.
radores convencionais. O sistema, mostrado na Figura 1.2, ó uma estrutura cilóndrica constituóda por uma bomba e um vaso separador, onde a mistura de líquido e gós entra e sofre o processo de separacao atravós de três estógios, [3] [4]:
•	na câmara de expansão a maioria do gas se separa e sobe pela linha que o leva à plataforma;
•	na helice quase todo o gós restante sofre separação centrífuga e penetra na tubulação central por meio de pequenos orifícios na parede interna;
•	no reservatório uma pequena quantidade de gós ainda se separa por gravidade e emana na tubulacão central. O lóquido ó bombeado para a plataforma por meio de uma bomba centrífuga submersa (BCS) localizada neste estógio. O gós, por sua vez, não precisa ser bombeado, pois se desloca para cima através da diferença de pressão que existe entre o separador e o vaso coletor na plataforma.
O nóvel de lóquido no reservatório deve ser mantido dentro de uma faixa de excursão permitida e ó controlado por meio da variação na frequência da bomba. Deste modo, a bomba modifica o fluxo de saída para equilibrar grandes variaçães do fluxo de entrada, poróm evitando atuacoes desnecessarias. Essa preocupaçao ó importante para prolongar a vida útil da bomba, uma vez que para a troca da bomba ó uma operação muito cara. Alóm da compra de uma bomba nova, o preço do aluguel das sondas capazes de efetuar este trabalho ó muito alto e a produçao dos poços ligados ao VASPS fica parada enquanto a manutencão não ó realizada.
Os dois principais fatores que causam uma alteraçao no fluxo de entrada sao a ocorrência de golfadas severas e a queda de poços, isto ó, a parada na operaçao de um ou mais poços. De
Saída de líquido
acordo com dados experimentais da Petrobras, os efeitos das golfadas no VASPS não devem, em princípio, ser muito preocupantes, uma vez que o impacto na alteracao do nível de líquido é menor que a faixa de excursão aceitável. De fato, uma vazão de entrada no reservatório muito turbulenta é difícil de ocorrer devido ao posicionamento no leito marinho do VASPS e à atenuação que ocorre na passagem pela hélice. Além disso, o reservatário faz o papel de um acumulador, o que também atenua os impactos de variaçães de vazão de entrada.
A queda de um poçco, no entanto, íe um processo mais complicado, pois naão íe transitoírio e pode ter um impacto na operação de proporçães bem maiores que a golfada. Em um campo de prospecçao de petróleo, a mistura que entra no VASPS é proveniente do manifold, que é responsável pela junção da mistura de varios poços de perfuracão. Desta forma, a queda de um poço nao provoca a parada completa no abastecimento do VASPS, porem causa uma grande variacão no fluxo de entrada. Essa variação depende da importância percentual do poco que deixou de produzir e esté associada à quantidade de pocos ligadas ao manifold, que pode variar de um campo para o outro.
A Petrobras jé construiu um VASPS em caréter experimental no campo de Marimbé e
pretende fazer outros de maior porte. O convênio tecno-científico entre a Petrobras e a Unicamp para atuação no desenvolvimento do VASPS encontra-se em sua segunda fase, na qual esta dissertação está inserida. Na primeira, um controlador para a bomba do VASPS foi desenvolvido usando um PID controlado por logica fuzzy [5]. Agora está sendo projetado um novo controlador, capaz de representar com maior realismo as condiçcãoes de operaçcãao do sistema. A seçcaão a seguir descreve com mais detalhes quais condicoes devem ser atendidas pelo mádulo de controle.
1.2	Objetivo desta dissertação
O problema estudado refere-se à estratágia de controle usada para alterar a frequência da bomba centrífuga, relacionada com o fluxo de saída de líquido do VASPS, de modo a manter o nível de líquido no reservatário dentro de uma faixa de operacão. Se o nível de líquido ultrapassar um limite maáximo, a eficiêencia do processo de separaçcãao diminui, uma vez que a íarea uítil da híelice íe reduzida. Por outro lado, se o nível tornar-se menor que um limite mínimo, o funcionamento da bomba fica comprometido e ela pode sofrer danos graves, pois sua toleraência à entrada de gás á pequena. Dentro dos limites superior e inferior de excursão, o líquido pode variar livremente sem nenhum prejuízo, poríem deve-se atentar para o risco de operar príoximo aos extremos de nível permitidos.
Alíem disso, hía a preocupacçaão com o aumento da vida uítil da bomba. Isso íe particularmente importante porque qualquer intervençcãao para reparos ou manutencçãao tem custos muito elevados por causa da localização submarina do VASPS. Ha, também, a perda pela parada dos poços conectados ao sistema. E frequente, inclusive, que essa parada dure dias se a necessidade de intervenção for inesperada, pois á preciso que haja uma sonda de intervenção específica disponível. O impacto destes altos custos deve ser levado em conta pelo controlador, que deve buscar o prolongamento da vida uítil da bomba. Isto íe alcançcado quando o acionamento evita mudançcas frequentes na rotaçcãao da bomba. O controle deve, portanto, ter uma política cautelosa, de modo a minimizar as alteraçcãoes da frequêencia do motor e consequentemente reduzir o seu desgaste.
Conforme já mencionado, a vazão de entrada pode variar por efeito de golfadas ou de queda de poçcos. Ela estía sujeita tambíem a um decaimento lento ao longo do tempo, relacionado ao envelhecimento dos poçcos, que pode ser tratado com um reajuste dos paraêmetros do modelo baseado no comportamento mádio da vazão em um período recente. A vazão de saída á controlada pela bomba centrífuga. Existem sensores para medir o nível de líquido no reservatário, poríem nãao haí mediçcãao de vazaão.
o tratamento do VASPS quando não ocorre queda de poco, visto que não há variaçães muito grandes na vazão de entrada mas sim flutuaçães contínuas. As quedas de poços podem ser contornadas com a criacão de vários modelos de difusão ajustados para diferentes vazães nominais e usando as informacoes da vazão para alternar entre um modelo e outro, conforme será comentado na Seçao 5.2.
Uma aplicacao semelhante em que o objetivo nao á a regulacão, á o controle de nável mediado de láquido (em inglês, Averaging Level Control), vide [9]. Ele aparece em muitas aplicacães industriais para controle de nável de láquido em reservatoários com funçcãao de armazenamento (buffer) para evitar propagação de disturbios. Em problemas desse tipo, o controlador deve manter o nável de láquido dentro de uma faixa de excursãao, como no caso da nossa aplicacçãao, porém a outra preocupaçao á com a suavidade do fluxo de saáda e não com a quantidade e intensidade das intervençães. Ainda nesta linha, outras referências relevantes são [10] e [11]. Diferentes abordagens para o controle de nável mediado são discutidas em [12].
Uma outra proposta parecida com o controle de nável mediado áe o controle de faixa (em inglês, Band control) proposto tambám para aplicaçao na industria de petroleo, em que se tem disponável apenas a medida de nável e deseja-se mantêe-lo dentro de uma faixa de excursaão, com suavização da saáda, vide [13]. Especificamente para o VASPS tambám foi utilizado um controlador PID com lágica fuzzy, [5].
A seguir, apresenta-se um primeiro esboçco sobre a soluçcaão adotada, que seráa formalizada nos Capátulos 2 e 3.
1.3	A proposta de solução
Duas variaveis caracterizam o estado no VASPS, o nível de líquido ht no reservatório e o balanço entre vazao de entrada	(qf)	e vazao de saída	(qf),	representado por	St	=	qf	—	qf.	O
espaço de estados, denominado X?, ó representado na Figura 1.3.
Para o VASPS, a equacçaão do balancço de massa estabelece que o balançco de vazãao de líquido no reservatíorio induz um acríescimo ou diminuicçãao do volume de líquido armazenado se o balancço for, respectivamente, positivo ou negativo. Como a órea Ar da seçao transversal ó constante, isto implica em uma variação no nível do reservatório, que pode ser expressa por
dht	1
= Ar ' +
(1.1)
h /\
hmax
	X
hmin
-I---
'min
^max
Õ
Figura 1.3: Espaço de estados no modelo do VASPS.
J(x) = inf Ex vev
•	um custo de intervenção c, que indica o desgaste causado pela alteração da frequência da bomba, pago a cada intervencão;
•	um custo de continuação r, que representa o risco de continuar sem nenhuma atuacão, continuamente pago como uma funçcãao do estado atual.
O Capítulo 2 apresenta com mais detalhes essa técnica, mas adianta-se que, se algumas hipóteses forem satisfeitas, [14], o custo étimo é definido como
T
e~atr(Xt)dt +	e-aTic(XT-, AX^)1{t^&lt;t} + e-aTX X)1{t&lt;~}] , (1.2)
i=1
em que Ex[.] representa a esperanca matemética sobre o processo markoviano de difusão t Xt, com Xt = (ãt,ht), x indicando o estado inicial X0, a um fator de desconto, Ti as variaveis que representam os instantes de ocorrência das intervençães, T o instante em que a fronteira é alcancada e 1{.} uma funcao indicadora que so vale 1 quando {• } é verdadeira, ou em outras palavras quando x G {•}, eé nula em caso contrario.
O risco de continuacçaão r esta associado ao risco de manter a mesma frequêencia no bombea-mento ao longo do caminho t Xt do processo. Assim, assume valores elevados quando o nével esta préximo do maximo e o balanço de vazão é positivo ou o nível esté préximo do mínimo e o balanço de vazao é negativo. Os resultados obtidos nesta dissertação foram baseados em uma função de risco quadrética com essas características, conforme seré apresentado no Capétulo 4. A Figura 1.4 apresenta o espaco de estados com sinais “-” nas regioes menos arriscadas e sinais “+” onde é mais perigoso continuar sem atuar.
O custo terminal ^, definido nas fronteiras, segue légica semelhante, com valores elevados nos mesmos extremos em que o risco atinge seu valor méaximo e valores menores nos extremos opostos.
h /\
	+	+ +
		+
—	—	
—	—	
+		
+ + +		—
5
Figura 1.4: Espaço de estados no modelo do VASPS.
Quanto maior o tamanho e o nUmero de variaçães de frequência da bomba, maior o seu desgaste e, consequentemente, menor sua vida util. Como o custo de intervençao c é pago sempre que o controlador decide atuar, um grande numero de variacães na frequência implica no aumento do custo étimo J. Para refletir o fato do desgaste ser proporcional à amplitude da variaçcãao da frequêencia, o custo de intervençcãao deve crescer com o aumento do tamanho das intervenções. Uma funçao proporcional ao médulo da variacão de frequência parece ser adequada.
O problema de controle impulsional resulta em uma solucão espacial, em que se mapeia em quais estados o controlador deve atuar e qual deve ser o tamanho da atuacçãao, sem dependêencia direta do tempo, já que os processos e custos são todos homogêneos no tempo. E necessario, portanto, conhecer o estado em que o sistema estaé operando para decidir a açcãao de controle. Para a modelagem proposta, isso significa ter informação do nível do líquido e do balanço de vazão, isto é, das vazães de entrada e de saída. A vazão de saída é determinada pelo controlador, logo ée conhecida. Eé possével medir o nével de léquido no reservatéorio, no entanto os valores medidos possuem uma imprecisao que deve ser levada em conta. Não ha medição de vazão, porém o balancço de vazaão pode ser estimado com base na variacçaão do nével de léquido, utilizando um processo de estimacão dos estados h e 5 via filtragem.
1.4	Apresentação da dissertação
O Capétulo 2 descreve o modelo estocástico baseado em processo de difusão usado para modelar o sistema e a teoria empregada para solucionar o problema de controle de nével com as restricães comentadas anteriormente. Utilizou-se a técnica de controle impulsional para definir os instantes em que se deve intervir no sistema, aléem de determinar qual deve ser a intensidade de cada intervencçãao. O capétulo aborda tambéem a transformaçcaão do problema de controle para uma representaçcaão por desigualdades variacionais, cujos passos intermediéarios consistem em convertêe-lo em uma sequêencia de problemas de parada éotima iterados. A equivalêencia entre as sequências de problemas de parada otima e o controle impulsional com quantidade maxima de intervencães n é desenvolvida, bem como a equivalência entre os problemas de parada étima e
as desigualdades variacionais a eles associadas. Finalmente, analisa-se o comportamento limite, obtendo uma associaçcaão entre a sequêencia de problemas de parada éotima e o problema original de controle impulsional com nuémero ilimitado de intervençcãoes.
Para resolver o problema, utiliza-se um méetodo numéerico que discretiza as desigualdades variacionais e obtéem sua formulaçcãao como problema de programacçãao linear, para o qual existe diversos algoritmos de solucçãao conhecidos. O Capétulo 3 apresenta esse méetodo numéerico, denominado Discretizacão do Valor Médio, MVS (do inglês, Mean Value Scheme). O método consiste na discretizacçãao do espacço de estados e na utilizacçãao de bolas centradas em cada noé para aproximar as integrais que aparecem na solucçaão analética, por meio dos valores nos néos vizinhos, que se encontram sobre a circunferêencia. Como essa téecnica foi criada para resolver sistemas descritos por uma equaçcãao de Helmholtz e a desigualdade variacional ée uma inequaçcãao eléptica, algumas transformaçcoães saão usadas para obter uma desigualdade na forma de Helmholtz. Essas transformaçcãoes tambéem estãao descritas nesse capétulo. Para facilitar a aplicaçcaão em outros casos, toda a teoria foi desenvolvida baseada em equaçcãoes gerais e a descriçcãao para o caso particular do VASPS ée apresentada em uma secçãao separada.
Em seguida, o Capétulo 4 apresenta os resultados obtidos na simulaçcãao do VASPS. Trata-se da obtençcãao de uma regiãao de continuidade no espaçco de estados e de uma curva de estados éotimos para onde a operaçcãao do sistema deve migrar em caso de intervencçãao. Enquanto o sistema opera dentro da regiaão de continuidade, naão deve ser feita nenhuma modificacçaão na rotaçcãao da bomba centréfuga. Ao sair dessa regiãao, o atuador deve alterar a frequêencia da rotaçcaão da bomba de modo a enviar o estado para o ponto indicado como éotimo a partir do estado em que ele se encontrava. Para a utilizaçcãao de dados reais, foi necesséario fazer um escalonamento no tempo, tambéem descrito nesse capétulo.
Como forma de validar os resultados obtidos e permitir uma anéalise do nuémero de inter-vençcãoes, foi criado um simulador do sistema, que cria uma sequêencia de dados de vazãao e simula a dinêmica da planta e do controlador. No simulador também deve-se utilizar um filtro, que retorna dados estimados do nével de léquido e da vazaão de entrada a partir das medidas diretas do nível. Uma proposta de abordagem para a filtragem e o simulador estão descritos no Capítulo
5.
Por fim, um resumo dos resultados obtidos e as perspectivas de trabalhos futuros sãao apresentados no Capétulo 6.
O Apêendice A apresenta alguns conceitos de processos estocéasticos em geral e em especial aqueles relacionados a processos de difusãao. Para estudar os conceitos de forma mais aprofundada, sugere-se os livros [15] e [16] de introdução a processos estocásticos e [17] para as propriedades do movimento browniano e de processos de difusão. No Apêndice B são mostradas as matrizes expandidas citadas no Capétulo 3, necessarias para incluir os pontos de fronteira na formulacçãao do problema de programacçaão linear obtido com a aplicacçãao do MVS.
Controle Impulsionai e sua Aplicação no VASPS
O controle impulsional visa a minimizaçõo do valor esperado de um funcional de custo do processo que pesa o risco de continuar sem atuar e o custo de intervir. O objetivo é achar os instantes de atuaçcõao e os tamanhos de cada intervençcõao que tornam esse custo ménimo. Para aplicar essa técnica ao VASPS, primeiro foi necessério obter um modelo estocéstico em tempo contínuo para o problema, como seré visto na seçao 2.1. As secões 2.2 a 2.4 formulam o problema de controle impulsional, sua conversõao em problemas de parada oétima iterados e sua descricõo com desigualdades variacionais. A equivalência entre as sequências de parada étima e o controle impulsional com quantidade méxima de intervenções n e a convergência desse para o caso sem limitacõo de intervenções sõo enunciadas na Seçõo 2.3 e a equivalência entre as desigualdades variacionais e o controle impulsional na Secõo 2.4. As demonstracões desses resultados encontram-se na Seçõo 2.5.
2.1	Modelagem do sistema
Como descrito na Seçcaõo 1.3, o modelo do VASPS utiliza duas variéaveis de estado, o nével de líquido no reservatório, ht, e o balanco entre vazao de entrada e vazao de saída, isto é, 5t = qf — qf. Assim, definiu-se um espaço de estados X? formado por um conjunto aberto X e sua fronteira dX, no qual o processo t Xt toma seus valores, com Xt = (ôt,ht). O espaço de estados é, entõo, dado por X? = [¿min, ãmax] x [hmin, hmax], conforme representado na Figura 1.3.
A incerteza na vazao de entrada de líquido é modelada como uma flutuaçõo em torno de um valor nominal, cuja variacõo é induzida por um movimento browniano. Este processo formalmente representa a integral de um processo de ruído branco contínuo, [8]. O Apêndice A apresenta uma breve definicçõao do processo denominado movimento browniano, ou processo de Wiener, e conceitos relevantes ao estudo deste processo e, de forma mais geral, de processos de difusaõo. Eé recomendéavel que o leitor deste capétulo que naõo esteja familiarizado com o assunto consulte esse apêendice.
Um processo de difusão ó descrito por uma forma diferencial estocastica de Itô dada por
dXt = b(Xt)dt + a(Xt)dBt,
(2.1)
em que b : Rk	Rk e a : Rk	Rkxm são funçoes dadas que satisfazem a condição de
existência e unicidade de equaçães diferenciais estocásticas (Teorema 5.2.1, [8]). A equacão (1.1), que descreve a evoluçcãao dos estados do sistema, pode ser formalizada por uma forma diferencial como (2.1), a saber
dht
dôt )
dt +
aii
a21
a12	dB1 \
022	dB2 ) ’
(2.2)
em que B}, Bt2 sao movimentos brownianos padroes unidimensionais descritos em um espaço de probabilidades filtrado (Q,F,{Ft}t^0,P) e Oj sao os coeficientes de desvio-padrão relacionados a esses processos brownianos. Verifica-se facilmente que essa formulaçcãao satisfaz as condicçoães do Teorema 5.2.1 de [8], pois os coeficientes aj sao constantes e os elementos do vetor b(Xt) possuem variaçcãoes lineares em relaçcãao ao estado Xt.
No modelo do VASPS, saão usados movimentos brownianos descorrelacionados, isto óe, os coeficientes de desvio-padrão cruzados (a12 e a21) sao nulos. O uso de ruídos correlacionados ó desnecessório, uma vez que o nóvel ht ja ó indiretamente afetado pelas flutuacoes no balanco de vazao, pois dht depende de ôt. Alóm disso, essa suposicao simplifica a transformação de estados do Capótulo 3, conforme será comentado posteriormente. O coeficiente a22 está relacionado com a incerteza na vazão de entrada e a11 refere-se a uma incerteza no nóvel, que relaxa ligeiramente a relaçcãao de balançco de massa. Essa escolha pode ser justificada devido a imprecisãoes decorrentes tanto das flutuacçãoes na vazaão quanto das medidas de nóvel.
2.2	Custo do controle impulsional
A equaçcãao (2.1) modela a evoluçcãao do sistema entre intervençcoães. No instante de uma intervençao, o processo Ft-adaptado t	Xt ó contónuo à direita mas não a esquerda, isto ó,
lim Xt = XTi = lim Xt = XT -.
O problema de controle impulsional consiste em determinar os tempos de parada Ft-mensura-veis t1 &amp;lt;t2 &amp;lt;..., nos quais as intervenções ocorrem, e o tamanho de cada uma delas. Os tamanhos são dados por AXT1 ,AXT2,..., em que cada AXTi = XTi-X - ó suposto FTi-mensurável e AXTi G G, G um conjunto dado de valores de impulso admissóveis. O efeito de um impulso AXTi ó que o estado salta imediatamente de um estado XT- para o novo estado XTi = r(XT- ,AXTi), r : Rk x G ■ Rk. O conjunto V de todas as sequências de controle admissóveis ó denotado por
J(x) = inf Ex
vev
A sequência de controle ótima v* é determinada pela minimizacao na classe V da função custo. Conforme apresentado em (1.2), o custo ótimo J, obtido pela minimizaçao do valor esperado do funcional de custo do processo t Xt, é definido por
T
e~atr(Xt)dt ^2 e~aTic(Xrr AXtí)1^&lt;t} + e-aT^(XT)1{t&lt;~}] ,	(2.4)
i=1
em que X0 = x, a é um fator de desconto, t¿,i = 1,2,... são os tempos de parada nos quais as intervenções ocorrem e T é o instante em que a fronteira é alcancada, isto é, T = inf{t &gt; 0 : Xt G dX} [14]. No custo J, aparecem o custo terminal : dX R, se o estado atingir a fronteira, o custo de intervencão c : X x G ■ R, pago em cada intervençao e dependente do estado imediatamente antes da intervençao, bem como do tamanho da mudança e o risco de continuaçao r : .'V ' R, que e continuamente pago como uma funcão do estado atual.
Deve-se garantir que os estados nao ficarão arbitrariamente grandes em um tempo finito. Isso significa que o tempo de explosao do vetor de estados Xt deve ser infinito quase certamente. O tempo de explosão e definido como o primeiro instante em que a norma do vetor de estados ultrapassa um valor R arbitrariamente grande, isto é,
T* = T» = lim inf{t &gt; 0; |X(t)| &gt; R}.	(2.5)
Rx'x.
Para que o problema seja bem formulado, supõe-se ainda que c e r são funções contínuas
e
$
t = x q.c.;
(2.6)
lim Tj = T q.c.;
jx^
E x
|e-atr(Xt )|dt
&amp;lt;x, Vx G Rk, v G V;
n
Ex[!2\e-aTic(XT-,AXn)1{t,&lt;t}|] &amp;lt;x, Vx G Rk,v G V;
i=1
(2.7)
(2.8)
(2.9)
Ex \e-aTrf&gt;(XT)
&amp;lt;x, Vx G Rk, v G V.
(2.10)
satisfaz Tj &amp;lt;Tj+i,j = 0,1,... q.c. para todo Xt G X; caso contrario a sequência {tj} poderia se acumular em tempo finito inferior a T e violaria (2.7).
O desenvolvimento matemótico de controle impulsional estó detalhado em [6] e mais recentemente em [7]. Essa formulação ó muito aplicada em controle de estoques [18], [19], [20], em problemas de taxa de cêmbio [21], [22], [23], e na otimização de portfolios com custos de transacão [24], [25]. Em [26] ha um levantamento das aplicacães em matematica financeira (problema de gerenciamento de dinheiro (cash), controle otimo de uma taxa de cêmbio e otimizaçao de portfolio com custos de transaçao). Outra aplicacão de controle impulsional encontrada na literatura é na area de manejo de florestas, vide [27].
Ao resolver o problema de controle impulsional em aplicaçães, dificilmente e possível obter solucães analóticas. Um metodo de solução direta é explorado em [28] para problemas de difusão unidimensionais; uma solucão numérica para o problema ó estudada em [29], e uma aproximacão estocaóstica com sintonia de coeficientes por meio de tóecnicas de simulaçcãao exaustiva em [30]. Nesta dissertacao a abordagem utilizada ó a de descrever o problema como uma sequência de desigualdades variacionais e resolvê-las atravós do mótodo MVS, [31].
2.3	Problemas de parada ótima iterados
O problema de controle impulsional com um nuómero ilimitado de intervençcãoes naão pode ser convertido diretamente em problemas de parada óotima, uma vez que a escolha do instante e da amplitude de uma intervencçaão influencia as próoximas escolhas. Por outro lado, o problema de controle impulsional com ató n intervençães pode ser convertido, sob certas condicães, na solução iterativa de n problemas de parada ótima. Alóm disso, quando n x, a funçao custo do problema restrito a atóe n intervençcoães pode convergir para a funçcãao custo do problema de controle impulsional com quantidade ilimitada de intervençcoães, contanto que certas condiçcãoes tóecnicas sejam satisfeitas.
Concentrando-se no problema limitado a n intervençães, o conjunto Vn de todas as sequências de controle admissóveis óe denotado por
Vn = {v := (ti,T2,...,Tk; AXT1 ,AXT2,...,AXTfc), k &amp;lt;n}.	(2.11)
A sequência de controle otima v* com ató n intervençães ó determinada pela minimizacão na classe Vn da função custo Jn
Jn(x) = inf Ex
vevn
n
e-at r(Xt)dt +
i=1
e-aT‘ c(XT- ,AXr, )1(r,&lt;T &gt; + e-“T^(Xr )1&lt;T&lt;»}
(2.12)
em que x, a, {t^} e T sao definidos como anteriormente.
Os n problemas de parada óotima iterados que convergem para a mesma solucçãao do controle impulsional são descritos a seguir. Considere a função de custo terminal estendida, dada por ^(X),	se X G dX,
de classe C2(X), se X G X;	( . )
&lt;^(X) = í
e defina o operador M : C2(X)	C2(X) tal que para (f&gt; G C2(X) e qualquer x G X, M é
escrito como
M[?](x) = inf {c(x,y - x) + 0(y)\ .	(2.14)
Os problemas sucessivos de parada étima a serem resolvidos são formulados como
e
V0(x) = Ex
e atr(Xt)dt + e aT&lt;(Xt)1.{T&lt;x
V i(x) = inf Ex
T
e~atr(Xt)dt + e~aT M[V i-1](XT -)
(2.15)
(2.16)


com i = 1,... ,n.
Conforme mencionado, o custo final Vn obtido pelos n problemas de parada étima iterados é o mesmo do controle impulsional limitado a n intervenções, com uma restricão sobre as funcoes r, e M[Vi-1], como enunciado no Teorema 2.1 a seguir. Antes de enunciar o teorema, porém, uma definiçcãao ée necesséaria.
Uma funcão h : Rk	R de crescimento polinomial satisfaz a propriedade de que existem
constantes C e m (dependentes de h) tais que
\h(x)\ &amp;lt;C(1 + |x|m),	Vx G Rk.
Teorema 2.1 Se r, e MV 1] sao de crescimento polinomial para i = 1,2,..,n, entao
n
As funçoes r e $ são escolhidas de forma a satisfazer a condiçao de crescimento polinomial. Como M[Vi-1] envolve o custo ótimo resultado da minimização, em geral não é possível afirmar que tenha crescimento polinomial. Na resolução do problema, deve-se dar atençao a essa hipétese para garantir que a solução dos problemas de parada otima convirja à soluçao do controle impulsional.
Esse teorema baseia-se no Teorema 7.2 de [7]. Sua demonstração encontra-se na Seçao 2.5 e é semelhante a de [7], porém com custo descontado e visando o problema de minimização do custo em vez de maximizaçcãao de um lucro. Alem disso, o problema aqui abordado naão envolve difusãao com saltos, simplificando os resultados. O mesmo vale para a demonstracçãao do lema a seguir, baseado no Lema 7.1 de [7], que sera tambem apresentado na Seção 2.5. Esse lema estabelece que (2.12) converge para a funçcaão custo (2.4) do problema de controle impulsional com quantidade ilimitada de intervençcãoes:
Lema 2.1 Se 0	0, então
lim Jn(x) = J(x), Vx G X.	(2.17)
n—:&lt;.
A secão a seguir converte os problemas de parada otima iterados em uma sequência de desigualdades variacionais, o que permitira a aplicacão do metodo numerico proposto no Capétulo 3 para soluçao do problema.
2.4	Descricao por desigualdades variacionais
O operador parcial diferencial de segunda ordem A de um processo de difusão de Itê Xt definido em R” e homogêneo no tempo ó definido por
Af (x) = lim EX[f (X‘)]- f (x), x E R”.
i.°	x	’
(2.18)
t
O operador A ó chamado gerador do processo Xt e o conjunto de funcoes f : R” R para as quais o limite existe para todo x E R” ó denotado por DA e consiste no domónio do gerador. Para um processo de difusao dado pela equaçao (2.1) e f E Cj|(R”), tem-se que f E DA e
Af&amp;lt;x) = £ Mx)f +1 £ - . « '
i	ij	J
(2.19)
Teorema 2.2 [8] Seja f E Cq(R”) e t um tempo de parada tal que Ex[t] &amp;lt;x. Entao
E x[f (Xt )] = f (x) + Ex
í Af (Xs)ds .
°
(2.20)
Essa expressao é conhecida como formula de Dynkin. E interessante ressaltar que se t e escolhido como o instante da primeira saóda de um conjunto limitado, então Ex[t] &amp;lt;x e (2.20) pode ser aplicada para qualquer funcão f E Cq.
Uma generalizacão da formula de Dynkin pode ser usada para abranger funcães que tenham uma dependência direta do tempo. A integral que aparece em (2.20) passa a operar sobre um diferencial d(.) da funcao. Assim, para o caso particular em que f (t,Xt) = e-atV(Xt), com V E Cq(X), obtem-se
E X[e-aT V (Xt )] = e-a'°V (x) + Ex
V (x) + Ex
V (x) + Ex
í d(e-asV(Xs))ds .
° {£&amp;lt;e e-as
°
-asV(Xs)) + e-asAV(Xs)ds .
(-aV(Xs) + AV(Xs))ds .
(2.21)
Dessa forma, aplicando (2.21) para um tempo de parada t que coincida com uma intervencão e considerando que o processo e apenas contónuo à direita,
V (x) = Ex
[ e-as(aV(Xs) - AV(Xâ))ds + e-aTV(Xt-) . °
(2.22)
Da equação do problema de parada ótima iterado (2.16), percebe-se que V*(x) &amp;lt;M[Vi-1 ](x) para todo x E X, pois quando XT- = x tem-se a igualdade Vz(Xt-) = M[Vi-1](XT-) e para qualquer t otimo diferente do instante inicial, a desigualdade estrita deve ser satisfeita para que
o mínimo nao ocorra exatamente no estado inicial x. Substituindo M[V* 1](XT-) em (2.16), obtéem-se
&amp;lt;Ex
V i(x) = inf Ex
T
e-atr(Xt )dt + e-aT V Z(XT -)
e-atr(Xt)dt + e-aT V i(XT -)
Empregando (2.22) com V = Vz em (2.24), obtém-se
Ex
e-as
0
(AVi(Xs) - aVi(Xs) + r(Xs)) ds &gt; 0
(2.23)
(2.24)
(2.25)
Como Vz, AVz e r são funçães conténuas e a desigualdade deve valer para qualquer tempo de parada t, é possível reescrever (2.25) dividindo-se por t e calculando o limite da expressao quando t 0+ [32]. Isso resulta em
AV*(Xo) - aVi(Xo) + r(Xo) &gt; 0.
(2.26)
Obtém-se, então, o seguinte resultado:
Lema 2.2 Se Vz(x) G C2(X) e solução do problema de parada ótima em (2.16), entao ela satisfaz
Vi(x) &amp;lt;M[Vi-1](x),
ou
AVi(x) — aVi(x) + r(x) &gt; 0,
(2.27a)
(2.27b)
sendo (2.27a) ou (2.27b) satisfeita com igualdade para todo x G X e com Vz(x) = f(x), para todo x G dX. Isso é valido para i = 1,... ,n e Vo(x) e dado por (2.15).
Observacao 1 Note que (2.27) determina regiões de comportamentos distintos. Defina D = {x G X; V*(x) &amp;lt;M[Vi-1 ]} e note que Dc U D = X. Enquanto o processo encontra-se no interior de D, ele evolui livremente e nao ocorrem intervenções, por isso D e chamada regiao de continuação. Em Dc intervenções devem ocorrer e, em geral, o processo e transferido de volta à regiao de continuidade D.
A deduçcãao acima mostra que o problema de parada oétima da i-éesima iteraçcaão pode ser convertido nas desigualdades variacionais dadas por (2.27), mas não garantem que qualquer solucão desse sistema seja solucão do problema de parada étima. O teorema a seguir, baseado no Teorema 10.4.1 de [8], estabelece as condições para que isso seja verdade.
Teorema 2.3 a) Suponha que seja possível encontrar uma função T : X?	R que satisfaça
as seguintes condições:
1.	tf G C1(X) n C(/V);
2.	tf G M[Vi-1] em X, M[Vi-1] G C2(X), e lim tf(Xt) = G(Xt)1.{t&lt;x q.c.
t^T-
Alem disso, seja D = {x G X; tf(x) &amp;lt;M[Vi-1 ](x)}. Supõe-se que
3.	Xt nao permanece na fronteira dD q.c., ou seja,
E x
(Xt)dt = 0,
Vx G X;
4.	d D e uma superfície de Lipschitz, isto e, para X G Rk, dD e localmente o grafo de uma função h : Rk-1	R tal que existe K &amp;lt;to com
|h(x) - h(y)\ G Klx - y\,	Vx,y;
5.	tf G C2 (X\dD) e as derivadas de segunda ordem de tf sao localmente limitadas proximo a dD;
6.	Atf — atf + r 0 em Dc.
Então,
tf(x) G Vfix), Vx G X,
em que Vz(x) e o custo do i-esimo problema de parada ótima, apresentado em (2.16).
b) Suponha, ainda, que
7. Atf — atf + r = 0 em D;
8.	td := inf{t &gt; 0; Xt / D} &amp;lt;to q.c. em Qx, isto e, na lei de probabilidade de Xt iniciando-se em x, para todo x G X;
9.	a familia {tf(XT-); t G td ,t G T}, em que T e o conjunto de todos os tempos de parada menores que o tempo final T, e uniformemente integrável com respeito a Qx, para todo x E X.
Entao obtem-se
T
tf(x) = Vfix') = inf Ex
T eT
e-atr(Xt)dt + e-aT M[Vz-1](Xt -)
(2.28)
Vx G X,
e td e um tempo de parada ótimo para esse problema.
Como visto no Teorema 2.1, o n-ósimo problema de parada otima tem custo Vn igual ao custo do controle impulsional limitado a n intervençães Jn e este converge para o custo do controle impulsional sem limite de intervençães, J, conforme o Lema 2.1. Jó o Teorema 2.3 mostra que a solução das desigualdades variacionais ó equivalente à soluçao do problema de
parada ótima. Além disso, baseado no Teorema 6.2 de [7], a função T converge para a função custo de controle impulsionai J se modificarmos a condicao 2 para
2’. T &amp;lt;M[T] em X e lim T(Xt) = MXT) 1	q.c.
t^T -
e acrescentarmos as condiçcãoes
10.
|T(Xt ■ ■ |AT(X't)|dt
&amp;lt;x para todo t G T,x G X.
11.	AX G Argmin{c(x,.) + T(T(x,.))} G G existe para todo x G X e á uma selecão mensurável de Borel. Alem disso, T0 = 0 e define-se v = (T1,T2,...; AXi,AX2,...) indutivamente por Tí+1 = inf{t &gt; Tp X^ G D} A T e AXi+1 = X^ — X, em que Xé o resultado da
i+1	Ti+1
aplicacao da sequência ví = (T1,...,Tí; AX 1,...,AXí) em X.
12.	v G V e a família {T(X-^v)); t G T} é uniformemente integrável.
Com as condições 1-6 e 10 (e 2’ no lugar de 2), demonstra-se que
T(x) &amp;lt;J(x), Vx G X,
e as demais condicçãoes saão necessarias para demonstrar a igualdade.
As hipóteses do Lema 2.2 e do Teorema 2.3, juntamente com 2’ e 10-12, garantem a cor-respondêencia entre a soluçcaão do problema de controle impulsional e a soluçcaão iterada das desigualdades variacionais. Algumas delas são de difícil verificaçao, como a hipotese de suavidade dos custos otimos obtidos via otimização (Lema 2.2 e hipáteses 1,2 e 5 do Teorema 2.3). Outra questão difícil de verificar a priori são as condiçães 4 e 8 do Teorema 2.3, sobre a regiao D, tambíem resultado da otimizaçcaão. Deve-se observar se as solucçãoes das desigualdades variacionais satisfazem essas hipoíteses e assim resolvem o problema original de controle impulsional.
Para resolver as desigualdades variacionais (2.27), á necessário usar uma discretizaçao no espaçco de estados e obter a soluçcãao de um problema associado aproximado. Com esse intuito, essa dissertaçao propãe a utilização do mítodo Discretização do Valor Mídio (MVS - Mean Value Scheme), que será descrito no capítulo a seguir.
2.5	Demonstraçães dos Teoremas 2.1 e 2.3 e do Lema 2.1
Esses resultados foram baseados em teoremas e lemas apresentados em [7] e [8], no entanto aqui utiliza-se um fator de desconto e a otimizaçcãao envolve a minimizacçãao de um custo em vez da maximizaçcãao de um lucro. Alíem disso, aqui a modelagem nãao envolve difusãao com saltos, diferentemente do que se usa em [7]. Dessa forma, as demonstraçcãoes para os resultados dessa dissertaçcaão sãao consideravelmente diferentes das mostradas nessas referêencias e sãao apresentadas nesta seçcãao.
2.5.1	Demonstração do Teorema 2.1
Conforme o Teorema 2.1, enunciado na seção 2.3, o custo final Vn obtido pelos n problemas de parada ótima iterados é o mesmo do controle impulsionai limitado a n intervenções, desde que r, e M[Vi-1] sejam de crescimento polinomial para i = 1,2,..,n. A demonstraçõo a seguir baseia-se na prova do Teorema 7.2 de [7].
Demonstração:
Para fazer essa demonstraçõo, é necessória a utilizaçao de um princípio da programação dinâmica, ou princípio de Bellman, (Lema 7.3 e Corolório 7.4, [7]).
Lema 2.3 Suponha que G e uma função de crescimento polinomial e T e o conjunto de todos os tempos de parada menores que o tempo final T. Defina
e
[T e-asf (Xs)ds + e-aTG(Xt)1{t&lt;^}’ .
0
(a) Entao para todos os tempos de parada finitos fi tem-se
Í-T A/3
I	e-asf(Xs)ds + e-aTG(Xt)1{t+ e-aifiX)1{t&gt;m .
0
&gt; 0, define-se
D(e) = {x G X; fi(x) &amp;lt;G(x) — e}
fi(x) = inf Ex
T eT
(2.29)
fi(x)
inf Ex
T eT
(2.30)
(b) Para
e
Entao, se fi
T(e) = inf{t &gt; 0; X(t) G D(e)}.
um tempo de parada finito tal que fi C t(e) para algum e &gt; 0, tem-se e-as
0
fi(x) = Ex
f(Xs)ds + e-a3fiX) .
(2.31)
e
Um resultado importante deste lema que seré usado na demonstracão do Teorema 2.1 é enunciado a seguir:
Corolário 2.1 (a) Para cada tempo de parada t eT dado, o processo
U(t) := í
0
tAT
e-asf (Xs )ds + e-a(tAT )fi(XÍAT)
t fi 0
e um submartingal (vide Apéndice A). Em particular, se t1,t2 sao tempos de parada finitos e t1 C t2 C T, então
Ex[e-aT1 fi(XT1)] C Ex
e-asf (Xs )ds + e-aT2 fi(XT2)
(b) Para e &gt; 0, t(e) definido como no Lema 2.3(b) e fi1, fi2 tempos de parada finitos tal que fi1 C fi2 C TEntao
E x[e-a/31 fi(X^1)] = Ex
Inicialmente, note da equaçao do problema de parada ótima iterado (2.16) que
Vn-i(x) C M[Vn-i-1](x),	se n — i &gt; 1
(2.32)
e isso vale para todo x G X, bastando tomar o valor t = 0 em (2.16).
Escolhe-se uma sequência de controle admissível vn = (Ti,T2,...,Tn; AXT1 ,AXT2,...,AXTn), com Tn &amp;lt;T e Tn+i = T. Se Xt representa o estado no tempo t de um processo submetido a esse controle, o Corolario 2.1(a) aplicado no custo do (n — i)-ésimo problema de parada otima resulta em
Ex[e-aTiVn-i(X’i)] C Ex
'’i+1
e-atf(Xt)dt + e-aTi+1 Vn-i(XT-+J .
(2.33)
Da definicao do operador M, (2.14), segue que
M[Vn-i-1](X1) C c(X’- 1, AX’i+1) + Vn-i-1 (X’i+1), para t+ &amp;lt;T.
i+1	i+1
(2.34)
Combinando (2.33)—(2.34),
Ex[e-aTiVn-i(XTi)] C Ex
Ti+1
e-af (Xt)dt +	+ c(Xt-+1 , AX’i+1 '	•

+ e-”Ti+1 V	1(X’¡+i ))

(2.35)
para i = 0,1,...,n — 1, com t0 = 0. Somando (2.35) de i = 0 a i = n — 1, obtóm-se
n-1
^Ex[e-aTiVn-i(XTi) — e-aTi+1 Vn-i-1(XTi+í)] C Ex
i=O
t í'Tn
/	e-atf (Xt)dt
L7o
n
+ £ e~“T‘c(Xt- , AXt.)1(t,&lt;t}
i=1
(2.36)
e, portanto,
Ex[e-aOVn(Xo) — e-aTnVo(XTn)] C Ex
Alóem disso, tem-se que
Tn
/ e~atf(Xt)dt
Jo
n
+	e-aTi&lt;
i=1
c(XT- &gt; AX’i)1{’i&lt;T}	.
(2.37)
E x[Vn(Xo)] = Vn(x)
(2.38)
e, usando a propriedade forte de Markov, a lei das esperanças iteradas (vide Apêndice A) e pelo fato que Tn &amp;lt;T,
Ex^e-”’n VO(XTn)] = Ex EX
= Ex
T e-”(t+Tn)f (Xt)dt + e-a(T+Tn^(XTI .
o
T	-|
1 ”f (Xt)dt + e~aT ^(Xt )1.{T&lt;x
Tn
Substituindo (2.39) e (2.38) em (2.37),
V"(x) C Ex
/ e-atf (Xt)dt +	e-aTic(X.-, AX.i)1u&lt;t} + e-aT0(Xt\	-
i=i	i
= J (vn)(x),
(2.40)
em que J(vn)(x) representa o valor esperado do funcional de custo no cálculo do custo ótimo Jn(x) do controle impulsional limitado a n intervenções, (2.12) para uma sequência vn G Vn qualquer. Como a sequência vn G Vn escolhida foi arbitraria, conclui-se que
V"(x) C inf{J&lt;’"&gt;(x);v„ G V"} = J,,(x).
(2.41)
Para obter a desigualdade oposta, escolhe-se e &gt; 0 e define-se uma sequência crescente de tempos de parada 0 = ê0 &amp;lt;ê &amp;lt;... &amp;lt;ên como se segue.
Para i = 1,2,...,n, define-se
D^ = {x G X; V*(x) &amp;lt;M[Vi-1](x) - e}
e
êi = inf{t&gt; 0; X,í0) /D^}, em que X(0) = Xt é o processo sem intervençoes. Entao escolha XX1 = XXC, com XX1 e-otimo para Vn-1, no sentido de que
M[Vn-1 ](x) &gt; c(x,XX1) + Vn-1(r(x,XXí1)) - e.	(2.42)
Iterativamente, define-se
fi+i = inf{t &gt; fi; Xt(i) / D"'-i},
em que Xt(i) é o processo obtido aplicando a sequência de controle f = (f1,...,fi; XX1,...,XX') e XXi = AX'. , com XXt e-otimo para Vra-i-1, no sentido de que
1 i
M[Vra"i-1](x) &gt; c(x, XXÍ+1) + Vra-i-1(r(x,XXÍ+1)) - e.	(2.43)
Agora procede-se de forma analoga aos passos (2.33)-(2.40), para a sequência de controle ê	(ê1;...;ên; XX 1;...;XXn).
Pelo Corolario 2.1(b), tem-se
E x[e-a,i V"-i(Xfi)] = Ex
' f.i+1	1
/	e-atf (Xt)dt + e-a,i+1 V"-\X--J .
J Ti
(2.44)
Como para ocorrer uma intervencao no instante fi+1 é necessario que X,- / d"'-i, deduz-se
Ti + 1
que
V"-i(X,- ) &gt; M[V"-i-1](X,- ) - e.
x Ti+1'	L	JX Xx
(2.45)
Usando (2.43) para o processo X obtido aplicando-se a sequência v, tem-se
M[Vn-i-1](X) &gt; c(Xt- , AXi+1) + Vn-i-1(XTi+1) — e, para tw &amp;lt;T. i+1	i+1
(2.46)
Combinando (2.44)-(2.46),
Ex[e-aTiVn-i(XTi)] &gt; Ex
fTi+1	,_____
/	e-a‘f(Xt)dt + e-aTi+1c(Xv , AX,+i)1,t.+1&lt;t)
J Ti
Somando (2.47) de i = 0 a i = n — 1, resulta em
+ e-aTi+1 V n-i-1(X^i+í))
— 2e,
(2.47)
CTn	n
/	e-atf (Xt)dt +	e-aTic(Xt-, ÃXí)1{tí&lt;t} + e-aTn
Jo	i=i	i
U'íA;.) - 2ne,
(2.48)
Substituindo (2.39) em (2.48),
..'T	n
/ e-at f (Xt)dt +	e-aTic(Xt-, ÃX¿I^t} + e-“T
Jo	i=i	i
= J (vn)(x) — 2ne,
(2.49)
Como e foi arbitrariamente escolhido, deduz-se que
Vn(x) &gt; inf{J(vn)(x); vn G Vn} = Jn(x).
(2.50)
Combinando (2.50) com (2.41), obtém-se a demonstraçõo do Teorema 2.1.
2.5.2 Demonstração do Lema 2.1
O Lema 2.1, apresentado na seção 2.3, enuncia que o custo ótimo do problema de controle impulsionai limitado a n intervenções Jn(x), definido em (2.12), tende para o custo ótimo com numero ilimitado de intervencoes J(x), definido em (2.4), quando n x. A demonstracao a seguir esta baseada na prova do Lema 7.1 de [7].
Demonstração:
Note que Vn Ç Vn+1 ç V para todo n, isto ó, todas as sequências de controle possíveis em Vn pertencem a Vn+1, alóm de outras sequências, o que pode resultar em um custo otimo Jn+1
menor do que Jn.
Dessa forma, Jn(x) &gt; Jn+1(x) &gt; J(x). A desigualdade oposta pode ser obtida
como seróa visto a seguir.
Denotando o valor esperado em (2.4) por J(v)(x), o valor esperado em (2.12) por J(vn)(x), o tempo final utilizando-se a sequência de controle v por T(v) e supondo J(x) &gt; —x, para cada
Vn(x) &gt; Ex
Vn(x) &gt; Ex
&lt;Kxt) 1 /. x — 2ne
e &gt; 0 existe uma sequência de controle v E V tal que
J (v)(x) = Ex
T(v)	x
/	e-atr(Xt)dt ^2 e-aTic(Xt- ,AXtí)1{Ti&lt;t&lt;«&gt;}
4o	i=i	1
+ e aT ^&gt;(XT(v) )1.{T(v)&amp;lt;x
&amp;lt;J(x) + e.
• ?
(2.51)
Para n = 1,2,..., define-se a sequência obtida truncando-se v após n intervencões como vn = (T1,T2,...,Tn,T; AXT1 ,AXT2,...,AXTn). O estado obtido para ambas as sequências ó o mesmo para todo t &amp;lt;Tn, isto ó,
xE = XE Vt « Tn.
(2.52)
Como, de (2.7), Tj	T quase certamente quando j to, as hipóteses (2.8) e (2.9) esta-
belecem que existe n tal que
E x
,T(v)	/,T(vn)
\e-atr(XÍv))|dt +	\e-atr(X(tVn))\di] &amp;lt;e,
(2.53)
Ex
_i=n+1
x
e-aT c(X^.XXT, )1{tí&lt;t w}|
' i
&amp;lt;e.
(2.54)
em que T(vn) ó o tempo final utilizando-se a sequência de controle truncada vn.
Alóm disso, Tn &amp;lt;T(vn ) e, por (2.7), Tn	T(v) quase certamente quando n to, logo
lim T(vn) = T(v)	q.c.
n^x
• 1{t	x	1{t	x	q.c.
É possível, então, escrever as igualdades:
liminf 1{t	x = limsup 1{t ■&amp;lt;x = 1{t	x q.c.
n^x	n^x
(2.55)
Utilizando (2.52), tem-se
lim sup J(vn) (x) = lim sup Ex
n^x	n^x
n
+ E e-aTi ‘¡(X^'AXt, )1(Ti&lt;T Tn,} + e-aT “n) MX^, )1{T(.n)&lt;x)
i=1
-at r(x(vn))dt
Tn
= lim sup Jv (x) + Ex n^x
x
- E^2 e-aTi
i=n+1
+ Ex |"e-“T(vn)
,T(vn)	/.T(v)
e-atr(X(Vn))dt -	e-atr(X2'))dt
n	Tn
c(X^.XXri )1{tí&lt;t M) ' i
0(xj;n;, )i(T ..„&gt;&lt;») - e-aT ^(xTí, )i{Tl.1&lt;x}
e
Das propriedades do módulo, tem-se que y f2dt c
y fidt -
y fi dt +
y f2dt c y |fi|dt+y ^dt
E[fs] c |E[f3]| c E[|fs|].
Utilizando essas propriedades e as expressões (2.53) e (2.54), obtém-se
-T(vn)	„T(v)
|e-"MXt("n))|dt +	|e-"ír(Xí(")) |dt
-"tr(Xt(Vn))|dt +
Tn
limsup J("n)(x) c limsup J"(x) + Ex
n^x	n^x
x
+ E'[ E |-e-""aX-Uv,)1(I,&lt;TW}|
i=n+1
e-"T (vn)
+ Ex
c J" (x) + 2e + lim sup Ex e
n^x
Tn
^(%TVnn))1{T(vn)	. - e-"T(v)X t". I .
^(XT("1) )1{T	x
-"T (vn)
- e-"T “ 0(xT";!, , )1{T(.&gt;&lt;x)
Pelo Lema de Fatou (vide Apêndice A) e utilizando (2.55), limsup J("n)(x) c J" (x) + 2e
n^x
(2.56)
■	0(%T"n;,)1{t(»&gt;&lt;«&gt; -	"0(xT"’&gt;)1{t&lt;-&gt;&lt;x})'
((e-"T"n&gt;0(XT"¿,) - e-"T‘”¿(X«))1(T&lt;«.&gt;&lt;x)) 0(XT(v) 1{T(Vn)&lt;x}	1 {T(v,&lt;x}))
+ Ex lim sup Í e
- n^x x
&amp;lt;Jv (x) + 2e + Ex [lim sup ( (e
+ lim sup fe_arW
n^x x
Por hipótese, T(vn)	T(v) e a função é contínua. Logo, pelo teorema da convergência
dominada de Lebesgue (vide Apêndice A),
Ex lim sup e
- n^x x
- "T (vn)	("n’	- "T(v)	(v) )
^(XT ("n) )	e	^(XT (v)	^{T (vn)&lt;x} y
0
e limsup J("n)(x) c J"(x) + 2e
n^x
Assim, usando (2.51) e (2.57),
(2.57)
limsup Jn(x) &amp;lt;limsup J(vn)(x) &amp;lt;J(x) + 3e.	(2.58)
n^x	n^x
Como e &gt; 0 pode ser escolhido arbitrariamente pequeno, a demonstração está completa para J(x) finito. Se J(x) = x, para cada M &gt; x existe v G V tal que J(v)(x) &amp;lt;M. Para e = 1, a expressão (2.56) resulta em limsupn^x J(vn)(x) &amp;lt;M + 2. Visto que M é arbitrario, isso
mostra que
limsup Jn(x) c limsup J("n)(x) = -to. n^x	n^x
2.5.3	Demonstração do Teorema 2.3
Conforme o Teorema 2.3, enunciado na seção 2.4, a solução das desigualdades variacionais (2.27) corresponde a solução de um problema do parada ótima na iteração i, apresentado em (2.16). A demonstração a seguir baseia-se na prova do Teorema 10.4.1 de [8].
Demonstração:
Usando os itens 1, 4 e 5 do teorema, ó possóvel encontrar uma sequência de funçoes Tj G C2(X) C C(Ã), j = 1,2,..., tal que (vide Apêndice D de [8]):
(i)	Tj	T uniformemente em subconjuntos compactos de X? quando j x.
(ii)	ATj — aTj	AT — aT uniformemente em subconjuntos compactos de X\dD quando
j x.
(iii)	{ATj — aTj}j=1 ó localmente limitada em X.
Seja {XR}Rg=1 uma sequência de conjuntos abertos limitados XR tal que X = Ujf=1XR. Faça Tn = min(N, inf{t &gt; 0; Xt / U){=1XR}). Seja t &amp;lt;T um tempo de parada e x G X, então, pela fórmula de Dynkin,
E x[e-«(T *tn )Tj (xT aTn )] = Tj (x) + Ex
T ATn
e-as(—aTj (Xs) + ATj (Xs))ds
(2.60)
Usando (i)-(iii), o item 3 do teorema e o Teorema da Convergência Limitada (vide Apêndice A),
T(x) = lim Ex
j—x
I
0
r tATn
/	e-as(aT(Xs) — AT(Xs))ds + e-a(TATN)T(Xtatn) .
0
-tATn
e-as(aTj(Xs) — ATj(Xs))ds + e-a(TaTn)Tj(XtaTn) .
(2.61)
(2.62)
= Ex
Dos itens 2, 3 e 6 do teorema,
T(x) &amp;lt;Ex
•t ATn	-
e-asr(Xt)ds + e-a(TATN)M[Vi-1 ](Xtatn) .
(2.63)
Pelo Lema de Fatou e (2.8) e considerando a familia {.MU' x](XT); t tempo de parada, t &amp;lt;T} uniformemente integrável com respeito a Qx para todo x G Rk, tem-se
T(x) &amp;lt;lim inf Ex
.Y -X
/T e
0
•T ATn
e-asr(Xt)ds + e-a(T aTn )M[Ví-1](Xt atn )
I
-asr(Xs)ds + e-aTM[Vi-1](XT) .
(2.64)
&amp;lt;Ex
Como T &amp;lt;T ó arbitrario, conclui-se que
o que prova a parte a) do teorema.
Se x / D, entõo T(x) = M[Vi-1](x) &gt; Vl(x) por (2.27a), entao de (2.65) tem-se
T(x) = Vz(x) e T* = T*(x,ix) := 0 ó otimo para x / D.	(2.66)
Para completar a prova, agora supoe-se que x G D. Define-se uma sequência crescente de conjuntos abertos {Dk}k=1 tal que Dk C D, Dk é compacto e D = Uk=1Dk. Faça Tk = inf{t &gt; 0;Xt / Dk}, k = 1,2,.... Pela formula de Dynkin e pelo item 7 do teorema e das condicoes (i)-(iii), tem-se que, para x G Dk,
T(x) = lim Tj (x)
= lim Ex
PTfc ATn
I	e-“*(«*j(X,) - ATj(X.))ds +	&gt;Tj(Xt.at,)
0
= Ex
= Ex
PTfe ATn
I	e-as(aT(X,) - AT(X,))ds + e-a(TkaTn}T(XTkATN)
0
fTk ATn	-
I	e-asr(X,)ds + e-a(TkaTn^(X.^) ,
0
pelo Teorema da Convergêencia Limitada.
Pela integrabilidade numérica e pelos itens 2 e 8 do teorema, obtém-se
T(x) = lim Ex
Xk—x
e-asr(X,)ds + e-a(TkATN	atn )
= Ex
= Ex
e-asr(Xs)ds + e-aTD T(XTd )
TTD e-asr(Xs)ds + e-aTD M[Vi-1](XTD) 0
De (2.16), por otimalidade,
Conclui-se, portanto, que
T(x) &gt; Vi(x)
T(x) = Vz(x)Vx G X
e o tempo de parada óotimo óe dado por
0, se x / X TD, se x G X
(2.67)
(2.68)
(2.69)
(2.70)
(2.71)
*
T
Capítulo
Discretizacão do Valor Médio
Conforme já mencionado, essa dissertação propãe a utilizaçao da Discretização do Valor Medio para resolver as desigualdades variacionais (2.27) apresentadas na seçao 2.4. Este metodo, conhecido pela sigla MVS (do inglês, Mean Value Scheme), sera descrito com mais detalhes na
seçcaão 3.2. Ele e usado para obter numericamente a soluçcaão de problemas de valor de contorno
do tipo Dirichlet envolvendo a equação de Helmholtz. A seção 3.1 apresenta uma classificação de equaçães diferenciais parciais de segunda ordem e o problema de Dirichlet. Na seçao 3.3 são apresentadas transformares que permitem que a desigualdade (2.27b) seja escrita na forma padrão para usar o MVS e algumas particularidades da aplicação do metodo ao VASPS sao comentadas na seçao 3.4.
3.1	Classificação de equações diferenciais parciais
Seja X? uma regiao fechada em Rn, composta pela região aberta X e sua fronteira dX. Defina uma funcao u : X?	R e considere a equacão diferencial parcial linear dada por
(3.1)
em que aij, bi, c e d sao constantes. Admite-se que a matriz dos coeficientes aij e simetrica.
A equação (3.1) e dita elíptica se todos os autovalores da matriz dos coeficientes a^ forem
nãao nulos e tiverem o mesmo sinal. Se os autovalores forem diferentes de zero e apenas um tiver o sinal diferente, entao a equação e do tipo hiperbólica normal, ou simplesmente hiperbólica.
Se eles forem nãao nulos e tiver pelo menos dois de cada sinal, entãao a equaçcãao e chamada
ultra-hiperbólica. Por fim, se pelo menos um dos autovalores for nulo, então a equação e paraboólica, [33].
Para o caso de duas variaveis, a equaçcaão diferencial e escrita como
(3.2)
e a classificaçcãao resulta que:
•	se b2 — ac &amp;lt;0, a equação e elíptica e uma transformacão de variaveis pode leva-la à forma canonica ugg + unn + h(ug,un,u) = 0;
•	se b2 — ac &gt; 0, a equacao ó hiperbólica e a forma canônica ó u^ — unn + h(ug,un,u) = 0;
•	se b2 — ac = 0, a equação ó parabólica e uma transformacão de varióveis pode levó-la a forma canônica ugg + h(ug ,un,u) = 0,
em que h(ug ,un,u) representa uma funcão que envolva apenas termos de u e de suas derivadas de primeira ordem, sem nenhuma derivada de segunda ordem.
O metodo da Discretização do Valor Medio busca a solução para problemas de contorno descritos por um tipo especial de equaçao elíptica, conhecida como equação de Helmholtz, que tem a forma ugg + unn — A2u = g, em que A2 ó uma constante positiva.
Para usar o MVS, a condiçao de contorno deve ser do tipo Dirichlet, isto é, a solução u da equacçãao diferencial parcial analisada tem que assumir na fronteira o valor de uma funçcãao dada. Alem disso, o metodo supãe que u G C5(X) n C0(A), em que C0(A) denota a classe de funcoes limitadas e contínuas em A? e Ck (X) e a classe de funcoes contínuas e com derivadas de ordem k contínuas. Deste modo, o MVS resolve problemas da forma, [34]:
ÍAu(x) — A2u(x) = f (x),	x G X,
u(x) = $(x),	x G dX,
em que Au = ugg + unn representa o Laplaciano de u (soma das derivadas parciais de segunda ordem).
Assume-se, ainda, que a condicao basica de existôncia de uma unica solução ó satisfeita, isto ó, dX ó uma região suave e G Cx (X?) [35].
3.2	Descrição do método
O mótodo MVS consiste em cobrir a região em que o problema esta definido por bolas e aproximar localmente as integrais que aparecem na forma analítica. Para isso, utiliza-se uma extensaão do teorema do valor móedio de funcçãoes harmôonicas aplicado em equaçcoães de Helmholtz, por isso o nome dado ao móetodo. O espaçco de estados óe discretizado e coberto por bolas que se sobrepãoem. Cada ponto do espaçco de estados óe centro de uma bola e os pontos vizinhos pertencem à circunferôncia desta bola [36]. A integral em cada bola ó aproximada pela ponderação dos valores da funcão nos nos da sua circunferôncia. Neste trabalho, utilizou-se a rede quadrada por sua simplicidade de implementação, [34], porem uma precisão maior pode ser obtida com a rede triangular, [31].
Na rede quadrada, o espaçco de estados e convertido para a forma discreta de modo a obter uma rede de N0 = N + 2 por M0 = M + 2 pontos, com distôncia r0 entre os nos. O espaço de estados discreto e entãao dado por
Um nó nesta rede é denotado por xi;j- = (ôj ,hi) e podemos associar uma função discreta f : Sr R a qualquer funcão real f : X? R tal que f = f (xi,j). Para uma rede quadrada como em (3.4), cada nó xi;j- é o centro de uma bola aberta Br de raio r0 e a sobreposição das bolas é tal que cada circunferência contém quatro nos vizinhos. O numero de pontos internos é NM e para verificar se um ponto xi;j- pertence ao interior é suficiente observar se a distancia para a fronteira dX é igual ou superior ao raio r0. Uma representacao da cobertura do domínio é mostrada na Fig. 3.1.
Figura 3.1: Região coberta por bolas regulares para utilização do MVS.
Cada bola aberta com raio r0 centrada no no interno xk é representada por Bk = Br (xk), k = . As bolas são definidas de modo que Bi Gd?, Vi =	e, para todos os éndices i
e j em que i = j, vale
Bi C Bj = u &gt; xi G dBj e xj G dBi.
Define-se, assim, uma cobertura parcial Q para d?, tal que Q = UiBi. O problema original e aproximado pela solucão do problema de valor de contorno no doménio Q. Para obter o resultado no doménio Q, tem-se como problema de partida a soluçao em uma unica bola, que faz uso da seguinte proposicçãao:
Proposição 3.1 [34] Dada uma bola Br centrada no ponto x G X e uma função $ tal que na circunferência dB tem-se 0 $(ro,0) G Lp2n para algum 1 &amp;lt;p &amp;lt;em que Lpn e a classe de funções 2n—periódicas com norma
1/p
O problema de valor na fronteira dado por
Au(x) — A2u(x) = f (x),	x G Br,
u(x) = í(x),	x G âBr,
tem soluçao
u(sfi) =
a0 I0(As)
2 I0(Ar0)
n=1
(ancos(nO) + bnsen(nff)), In(Ar 0)
0 C s &amp;lt;r0,
em que {an},n = 0,1,... e {bn},n = 1,2,... sao os coeficientes de Fourier da funçao $ e In e a função de Bessel modificada de n-ésima ordem.
Como na formulação do MVS deseja-se calcular u no ponto central x = (ôj,hi) que pertence à rede Sr, é necessario considerar apenas o caso s = 0. Como In(0) = 0, Vn = 0 e I0(0) = 1,
segue que
Ui,j =
1
2nI0(Ar0)
í(ro,0)d0,
0
(3.6)
em que I0, a funçao modificada de Bessel de ordem zero, pode ser representada pela série
~	(x)2k
Iü(x) = k	22k (k!)2'
(3.7)
O valor de $ so é conhecido em quatro pontos da circunferência dBr, entao utiliza-se o valor nesses pontos para fazer uma aproximação numerica pelo metodo dos trapezios para a integral em (3.6) [36].
De posse desse resultado, demonstra-se que a soluçao do problema (3.3) definido no domínio aproximado Q pode ser aproximada com precisao O(r0) por [36]
f[1 - Wl} ,
1
4I0(Ar0)
Ui+1,j + Ui-1,j + Ui,j+1 + Ui,j-1 +
(3.8)
Ao usar essa aproximação para todos os nos internos da malha, obtemos um sistema de equacçãoes que pode ser escrito em forma matricial como
AU = b,
em que a matriz A e determinada pelas conexões internas e o vetor b pelas conexões com a fronteira e pela parte nõo-homogênea da equaçao de Helmholtz. Obtem-se, entõo,
	1 C) 0 1 1		0	... -I	...	0 0	
A=				(3.9)
	0 ...	-I	CM-1	-I	
	0 ...	0	-I	Cm	
e
b=
^2 [1 - I0(Ar0)] + U1,0 + U0,1
A24f21
[1 - I„(Ar„)] + U2fi
4fNM,NM
A2
[1 - hj(Ar0)] + UN,M+1 + un+1,m
em que I representa a identidade de dimensao N x N e
	4Io(Aro)	—1 — 1	4Io(Aro)	0	...	0 —1	...	0	
Cj =			, j = 1,2,...,M.
	0 ...	— 1 4Io(Aro)	—1	
	0 ...	0	—1	4Io(Aro)	
3.3 Obtenção da equação de Helmholtz
Uma equação elíptica da forma (3.2) pode ser escrita na forma canônica e convertida para uma equação de Helmholtz por meio de algumas transformações [33]. Inicialmente, supoe-se que a = 1, o que pode ser obtido por uma simples normalizacão, e completa-se quadrados de modo a evitar derivadas parciais cruzadas, resultando em
( d , d \2	2 d2	, d d
+ b u + Y 2 u + d u + e u + gu = f. \dx	dy )	dy2	dx dy
(3.11)
em que y2 = (ac — b2) é sempre positivo para equaçães elípticas. Essa equaçao pode ser reescrita com a definição de novas variéveis,
y — bx
Y
(3.12)
pois, como
d_ dl
dy
a equaçcãao transformada resulta em
1 — b— dx + dy' d d
0 • dX + YãXj'
d 2u
d 2u dy2
du du
+dY+pdXi+gu=f'
du
(3.13)
n =
+
l = X
com p = (e — bd)/Y. Quando d, e e g são constantes, os termos diferenciais de primeira ordem podem ser eliminados por meio da transformaçcaão
w(nl) = e'&gt;^'u(y.ll). p(n,l) = dl+pn.	(3.14)
Com a utilizaçao da regra da cadeia em (3.14), podemos reescrever (3.13) em função de w como uma equaçcãao de Helmholtz dada por
Mtó — A2w(n,í) = ee,nY (y,Q,
(3.15)
em que
A2 = — g +
d2 + p2
4
3.4 Aplicação do MVS ao VASPS
A desigualdade (2.27b) não esta na forma de macoes descritas na seção 3.3 permite a conversão
Inicialmente, obtem-se a expressão do gerador caçao da expressão por
(2.19) no modelo
do sistema
Helmholtz, porém a aplicação das transfor-para esse tipo de inequação.
infinitesimal para o VASPS, conforme apli-dado por (2.2). O gerador obtido e dado
1 2 d2V	2 d2V
+ 2 a2 W + a 8ht85t ’
sao os elementos (1,1), (2,2) e (1,2) da matriz de covariancias aaT, que é
av (x)=A õt dht
+ i dü + 2 a 1&amp;lt;9ht2
(3.16)
2 2 2 em que a 2, a£ e ag
uma matriz simetrica.
Substituindo (3.16) em (2.27b), obtem-se uma desigualdade elíptica. Utilizando o fato que a 2 &gt; 0, definem-se os coeficientes para a desigualdade
b=	ac2 a 2 ,	y2
d=	25	e
	a 2Ar ’	
	2a	
g =	2,	f
	a 2	
a2
a2
0,
2 ( )
---2 r(xL
ai
Obtém-se, então,
d2
d
d
(-dh
V + d V + e V + gV &gt;&amp;lt;952 V + dâh" + e&lt;9V +
f.
(3.17)
++y 2
E importante ressaltar que (3.17) é eléptica somente se
y
2
zl a2
&gt; 0,
o que é o caso no modelo do VASPS, pois essa expressão está associada ao determinante da matriz de covariancias do movimento Browniano. Como o coeficiente de correlação entre duas
variaéveis, definido por	a2 p 1 2 •= , a a22
satisfaz sempre |p 1 2| C 1, percebe-se que o determinante de uma matriz de covariâncias é não negativo. Particularmente, para o VASPS usa-se movimentos brownianos nãao correlacionados, isto é, a2 = 0 e, portanto, o determinante é positivo.
Define-se Z um espaço transformado tal que (3.12) realiza um mapeamento que transforma cada par (5,h) G X? em um par (rç,£) G Z. Utilizando a transformação (3.14), a inequacão (3.17) pode ser convertida no formato de uma desigualdade de Helmholtz em Z?, dado por
Aw — A2w &gt; e^f,	(n,^) G Z.
(3.18)
Para usar a transformação (3.14), é necessaria a hipétese de que d, e e g sejam constantes, o que não é verdade em geral, e particularmente no caso do VASPS, em que o modelo usado resulta em um parâmetro d dependente de 5. Esta suposição, no entanto, e razoavel quando se considera uma unica bola no MVS. Neste metodo, os valores dessas funcães sao aproximados em cada bola pelo valor que assumem no respectivo centro.
Em um espaço transformado com rede quadrada como o da Fig. 3.1, as desigualdades resultantes da aproximaçao em cada ponto Zij da grade transformada podem ser expressas na forma matricial, resultando na desigualdade linear AW &amp;lt;b, com A e b definidas como em (3.9), (3.10). Nesta expressão, W é um vetor cujos elementos sao os valores aproximados no ponto Zj para o resultado w da transformaçao (3.14) aplicada na versao discreta de V em Z.
No caso do VASPS, e possível transformar o sistema de desigualdades variacionais (2.27), discretizado como descrito, em um problema de programaçao linear. No sistema (2.27), pelo menos uma das expressões deve ser satisfeita com igualdade. Isso significa que se deseja obter o maior vetor Vk sujeito as restricães (2.27a) e (2.27b). O sistema é, então, convertido na seguinte sequêencia de problemas de programaçcãao linear
max	e~3(zij }Wk (zj)
i,j
sujeito a AWk &amp;lt;b,	em Z,	(3.19)
Wk(Zij) &amp;lt;e3(ZijM[ z' &gt;), Zj G Z,
k = 0,... ,n, i = 0,...,N,N + 1 e j = 0,...,M,M + 1, à exceçao dos pares (i,j) dados por (0,0), (0,M +1), (N + 1,0) e (N + 1,M + 1). Note que W0 é a funçao V0 de (2.15) representada no espaco transformado Z Nesse problema de programacão linear, uma das restricoes deve ser satisfeita tambem na fronteira. O vetor de incognitas deve, portanto, incluir os nos de fronteira, à exceção dos quatro nos dos cantos, que não pertencem à região coberta pelas bolas. Tornou-se necessario expandir a matriz A e modificar o vetor b para criar a nova desigualdade matricial AW &amp;lt;ò, em que W contem tambem os elementos de fronteira. As matrizes expandidas sao mostradas no Apêndice B.
Quando d, e e g são constantes, o erro obtido usando a Discretização do Valor Medio com rede quadrada e de ordem O(r0). Apesar de essa ser a mesma ordem do erro obtido com o metodo tradicional de diferencças finitas discretizado pela Discretizaçcaão no Valor Central, quando eles sãao comparados observa-se uma melhora da precisãao no MVS. Alem disso, o MVS pode ser usado com uma rede triangular [31] para reduzir a ordem do erro para O(r0). O efeito causado por parêametros variaveis ainda nãao foi quantificado, mas desde que o passo de discretizaçcãao r0 seja suficientemente pequeno, isso nãao causa um grande incremento no erro. Como todas as funçães são contínuas, a hipotese de que os parêmetros são constantes em uma bola torna-se mais irrelevante a medida que o raio r0 é reduzido.
Com a utilização da formulacão (3.19) foi possével resolver o problema de controle do VASPS e obter as regiães de intervencão e os estados de destino para diferentes funcães de risco e de custo. O capétulo a seguir detalha os resultados obtidos.
Capítulo
Resultados Numéricos
Este capétulo apresenta os resultados de controle impulsionai obtidos com diferentes funcões de custo e de risco. Define-se, desta forma, o mapeamento da regiõo de intervençao e dos tamanhos otimos de intervencõo na frequência da bomba para cada combinacõo de funções. Esses resultados sõo apresentados na Secõo 4.3. Antes, porém, apresenta-se na Seçõo 4.1 o escalonamento no tempo, usado para regularizar a rede de discretizaçcõao, e os dados para as simulações, descritos na Seçõo 4.2.
4.1	Escalonamento no tempo
Em uma simulaçao numérica utilizando o MVS, o espaço de estados tem que ser discretizado em uma rede quadrada. Assim, se uma das variáveis de estado possuir uma faixa de valores muito maior que as outras, o nuémero de néos nessa dimensõao seraé muito maior que nas demais. Isso ocorre no VASPS, em que as faixas de variaçõo do nével e do balanço de vazõo representam grandezas bem diferentes.
Para ter uma boa precisõo nas variaveis de menor faixa, o numero de nás na outra variável pode se tornar muito grande, o que causa problemas computacionais. A forma encontrada para solucionar essa dificuldade foi fazer um escalonamento no tempo, o que afeta a variéavel balançco de vazao, 5, porém nao influencia nos valores do nével, h. Como a variência do movimento browniano é equivalente ao tempo decorrido desde o instante inicial, os processos utilizados para modelar o ruédo tambéem sõao afetados. A seguir, uma descriçcõao mais detalhada do escalonamento utilizado ée apresentada.
Conforme mencionado, no modelo do VASPS sõao usados movimentos brownianos descorrelacionados, isto é, os coeficientes de desvio-padrõo cruzados (a12 e a21) sao nulos. Além do uso de ruídos correlacionados ser desnecessario, a transformaçõo de estados do Capétulo 3, que leva do espaço de estados X? ao espaço transformado Z?, mapeia uma regiõo retangular em outra também retangular quando esses coeficientes sõo nulos, o que aumenta a conveniência da escolha desse método numérico. A utilizaçao de coeficientes a11 e a22 nao nulos é necessaria para
que a equação (2.27b) seja elíptica e o MVS possa ser aplicado. Assim, as formas diferenciais estocásticas que modelam o processo, apresentadas em (2.2), podem ser reescritas como
dht
dõt
—õtdt + andB ¿ir
^22 dBt2
(4.1)
Se for utilizada uma nova escala de tempo p, tal que
P =	,
T0
o sistema é reescrito como
dhp
dõp
-1 ópdp + an^T0dBp
dAr
a 22\ZTÕdBp
(4.2)
em que a relacão entre as unidade de õt e õp é dada por
õt
3
-
-T0s-
O custo do controle impulsional, originalmente dado por (2.4), passa a ser expresso por
[T e~aToPr(Xp)Todp + V e-aToTic(XT- ,AX^ )1{T&lt;&lt;r} + e-aToT0(XTI .
•/o	i=i	’
(4.3) pois o fator de desconto a também é afetado, tornando-se aT0, além de dt = Todp, de modo que
J(x) = inf Ex vev
a nova função de risco vale T0r(Xp).
Com esse escalonamento e considerando as covariâncias cruzadas nulas, a nova desigualdade diferencial que descreve o sistema, correspondente a (3.17), é
d2Vp + d2Vp +	2õp BVp_ 2a	2
dhp a2 dõp Toa2 Ar dhp a2 p al
(4.4)
Para que o numero de linhas e colunas na rede quadrada seja o mesmo, o espaco transformado definido no Capítulo 3, cujas variáveis de estado sao n e deve ter faixas de valores de mesmo tamanho para as duas componentes, isto é, deve satisfazer
a£p — Adp,
em que
A&lt;p
A^p
Çmax (p)
^min (p)
^max (p)	hmin (p) ■
De (3.12), com b — 0, na escala de tempo original, isso equivale a
Ahp
Aõp
Y
—	Aõp.
a22
(4.5)
(4.6)
3
L s J
t
o õp
z
1 t

Usando o fato que õp = Toõt, é possível escolher To de modo a igualar o numero de nás nas duas dimensões do espaço transformado Ã, como segue
Aht — — ToAõt
a22
Com a aplicacão desse fator de escala no tempo, tornou-se possível fazer o cólculo do controlador com equilíbrio na discretizaçao em cada dimensão. Dessa forma, um requisito mínimo de precisaão pode ser atendido sem que seja necessóario deixar uma das dimensoães com um nuómero muito grande de noós, reduzindo o esforçco computacional. A seguir sãao descritos os dados utilizados para fazer as simulacçãoes e posteriormente os resultados obtidos saão apresentados.
4.2	Descriçao dos exemplos simulados
A Petrobras tem previsao inicial de construção de dois VASPS, para os quais foram realizados estudos de dimensionamento e das caracterósticas de operaçcaão. As dimensãoes resultantes desses estudos sao mostradas na Figura 4.1 e foram utilizadas para o calculo do controlador e nas simulaçcãoes presentes nessa dissertacçãao.
Figura 4.1: Dimensoes do VASPS.
Como mostrado na Figura 4.1(a), os 5m inferiores sao ocupados pelo reservatório de areia e de líquido. O nível do líquido não pode ficar abaixo desse limite, pois a 4m do fundo encontra-se o tubo de sucção de líquido, no qual deve somente entrar líquido para não danificar a bomba. O controle do nível de líquido deve mantê-lo no interior da faixa entre 5m e 9m, acima da qual a eficiência de separação começa a ser prejudicada pela diminuição do comprimento útil da hílice. Alím disso, como o líquido no reservatório ocupa todo o duto externo do VASPS (revestimento de pressurizaçao), a dimensão considerada na simulaçao para a area da seção transversal do reservatoírio foi de um círculo de 35 polegadas de diaêmetro, subtraindo-se as paredes do tubo
da hélice. Essas medidas correspondem ao VASPS da Figura 4.1, cujo diâmetro externo é de 40 polegadas, mas exclui-se a espessura das paredes, correspondente a 5 polegadas.
Com relaçao as características de operação, as simulaçães preveem uma variaçao de vazão de entrada de 335m3/d em ciclos de 2,2 minutos. Esse valor de variação foi considerado como um desvio-padrão da distribuiçao do movimento browniano que modela o ruído no balanco de vazão, a22. O desvio-padrão da perturbaçao no nível, an, foi arbitrariamente escolhido como sendo 0,1. Posteriormente, caso haja informaçao sobre a precisão do sensor de nível, esta pode ser usada para aprimorar o valor desse coeficiente.
Para uma variével aleatéria de distribuição gaussiana, há 99,7% de probabilidade do valor assumido encontrar-se na faixa de ±3a. Por esse motivo, os balanços méximo e mínimo de vazaão foram determinados com base nas vazãoes de entrada, considerando-se essa faixa com uma margem de segurança de 20%, isto é, 5max = —5min = 1,2 x 3 x a22.
Conforme mencionado na Secão 1.3, o risco r(Xt) de continuar com a mesma frequância no motor da bomba assume valores elevados quando o nével estéa préoximo do méaximo e o balancço de vazãao ée positivo ou o nével estaé proéximo do ménimo e o balançco de vazãao ée negativo. Para modelar esse efeito, escolheu-se uma funçao quadrética em h e 5 de modo a assumir valores mais altos nesses extremos. Como estar muito préoximo de um dos limites de nével ée ainda um pouco arriscado, mesmo se a tendâencia de variaçcaão do nével for no sentido de se afastar, evitou-se a utilizaçcãao de uma funçcãao que o nével ménimo estivesse nos extremos do nével h, hmax e hmin. Para isso, a funcçaão quadraética foi adequadamente escolhida e rotacionada, conforme representado pelas curvas de nével, mostradas na Figura 4.2.
Figura 4.2: Curvas de nível do risco de continuacao.
A expressãao geral usada para criar funcçoães quadraéticas rotacionadas ée dada por
ri(5,h) = [h — ho
5 — 5o] • R •
1/a2
0
0
1/b2
h — ho
5 — 5o	,
em que (bo,ho) é o ponto de valor ménimo do paraboloide, a e b sao coeficientes que indicam o tamanho dos eixos das elipses no corte transversal e R é uma matriz de rotação bidimensional. Para que o valor méximo da funçao pudesse ser facilmente escolhido, realizou-se uma normaliza-çcaão seguida de uma multiplicaçcãao por um fator que determinasse esse maéximo, isto ée, a funçcãao r utilizada é representada por
r(õ,h) = rmax
ri(ô,h)
max r1(õ,h)
(4.9)
O custo terminal ^&gt;(Xt) foi escolhido de forma a variar linearmente em cada fronteira do espacço de estados, seguindo a mesma tendêencia adotada para o risco de continuaçcãao de assumir valores elevados quando o nével esté préximo de hmax e ôt &gt; 0 ou o nível aproxima-se de hmin e St &amp;lt;0. Nesses dois extremos, a funcao atinge seu valor maximo, ^max e nos extremos opostos atinge o valor ménimo, ^min.
O custo de intervençao c(XT- ,AXT) foi estabelecido como sendo a soma de uma parcela constante e uma parcela dependente de |AâT |, que corresponde a variacao do estado causada pela intervençcãao, uma vez que a intervencçãao soé altera instantaneamente o balançco de vazaão mas não o nével. Esse custo é, então, descrito por
c(Xt- AXt) = c
soma
+ cmult | Aõ|n;
em que |Aâ|ra representa o médulo normalizado pelo valor méximo que ele pode assumir, isto é,
|A&lt;
|Aõ|
max I Aõ I ’
(4.10)
com õ1 e õ2 origem e destino, respectivamente.
Por fim, supos-se um fator de desconto a de 0,4 e a discretizacao utilizada foi de 51 x 51 nós. Nos resultados mostrados a seguir, varia-se alguns desses parâmetros para mostrar o efeito de cada um deles na soluçcaõo do controle.
4.3	Regiões obtidas
Conforme mencionado, a tócnica de controle impulsional resulta no mapeamento de uma regiõao de continuidade, ou regiõao de nõao-intervencçõao, no espaçco de estados, dentro da qual a melhor política ó deixar o sistema evoluir livremente sem nenhuma alteraçõo. A regiõo complementar dessa ó chamada de regiõo de intervencõo e a amplitude da alteracao ideal para cada estado desta regiao tambóm ó obtida como resultado do controle impulsional. Quando o estado passa para a regiaõo de intervencçaõo, uma atuacçõao deve levar o sistema para um estado de destino ótimo, obtido modificando-se o balanço de vazao õ de acordo com a amplitude da alteraçõo ideal determinada. Como o estado varia continuamente e logo que ele sai da regiõo de continuidade ocorre uma atuaçcaõo, ao sair o estado nõao deve afastar-se muito da fronteira entre essas regiõoes.
Deste modo, na figuras a seguir utilizou-se apenas 2 linhas de estados de destino, correspondentes às intervenções otimas obtidas nos estados imediatamente após as fronteiras esquerda e direita da regiõo de continuidade.
As figuras que se seguem mostram a regiõo de continuidade em amarelo e a de intervençõo em azul para diferentes parâmetros do controlador. Os estados de destino quando o processo escapa da regiõao de continuidade pela direita sõao mostrados em verde e os estados quando escapa pela esquerda sõao mostrados em vinho.
A regiõo que seró tomada como base para comparaçao corresponde ao resultado com parâmetros do controlador dados por ^max = 20, ^m¡n = 10, rmax = 1, CsOma = 0,01 e cmu¡t = 1,5. A Figura 4.3 mostra as regioes do espaço de estados X? obtidas após a estabilizacõo das regiões e as correspondentes funçoes Vz e M[Vi-1].
9
8.5
7D
7
(D
6.5
o &gt;
z 6
5.5
-600	-400	-200	0	200	400	600
Balanço de vazão ô (m3/d)
12
10
8
6
4
2
0
9
V’ (mesh) e MV’ 1 (surf)
1000
-1000
h (m)
(b)
MV
ô (m3/d)
entre Vz e
(a) Região moderada.
Figura 4.3: (a)Regiões e destinos e (b) Comparaçõo ^min — 10, rmax — 1 csoma — 0,01 e Cmult — 1,5
M[Vz 1], com ^max = 20,
Na Figura 4.3(b), as funcoes Vz e M[Vi-1] sao quase coincidentes, mas observa-se uma regiõo esbranquicada no canto correspondente a nível de líquido baixo e balanco de vazao alto, que corresponde à regiõo de continuidade, em que Vz ó menor que M[Vi-1]. Note que nessa figura ó possível observar que as funcoes obtidas parecem satisfazer a hipótese do Lema 2.2 por formar uma curva suave, além das condicoes 1, 2 e 5 do Teorema 2.3. As condicoes 4 e 8 sobre a regiao D tambóm parecem ser satisfeitas.
mapas de controle.
4.3.1	Variação do custo de intervenção - três cenórios
Inicialmente, variou-se a função de custo de intervençao c, de modo a criar três cenérios: um moderado, com os dados jaé apresentados, um conservador, em que a preocupacçãao com o risco de atingir a fronteira ée maior que o custo de intervençcãao, e um liberal, que evita intervir com frequência. A região moderada foi mostrada na Figura 4.3(a) e a Figura 4.4 apresenta as regiãoes conservadora e liberal.
9
8.5
7D
7
(D
6.5
&lt;u
&gt;
6
5.5
5
-600	-400	-200	0	200	400	600
Balanço de vazão 8 (m3/d)
(a) Conservador.
Balanço de vazão 8 (m3/d)
(b) Liberal.
Figura 4.4: Regiães e destinos para ^max = 20, ^m¡n = 10, rmax = 1, c^ = 0,01 e: (a) cmuk = 1 e (b) cmult	2.
Como é possível observar, ao aumentar o custo de intervençao, o controlador torna-se mais liberal, pois o peso de cada intervençcãao aumenta quando comparado com o risco de atingir a fronteira. Se, em vez de se variar o fator multiplicativo do médulo, a constante aditiva csoma fosse modificada, isso também seria observado. Além disso, a medida que a constante aditiva aumenta, as linhas de destino das intervenções à direita e a esquerda se aproximam. No caso extremo, quando cmult = 0, a linha de destino é unica. Por outro lado, quando csoma = 0, as linhas de destino correspondem as fronteiras da regiao de continuidade.
4.3.2	Variaçao de outras funçoes
9
8.5
T3
7
&lt;u
6.5
&lt;u
&gt;
z 6
5.5
-600	-400	-200	0	200	400	600
Balanço de vazão 8 (m3/d)
E, ZZ o ■Ç
z;
ÇT
&lt;u ■o õ
&gt;
9
8.5
8
7.5
7
6.5
6
5.5
5
-600	-400	-200	0	200	400	600
Balanço de vazão 5 (m3/d)
9
8.5
T3
7
&lt;U
6.5
&lt;U
&gt;
6
(a) Original.
5.5
-600	-400	-200	0	200	400	600
Balanço de vazão 8 (m3/d)
9
8.5
7
&lt;U
6.5
&lt;U
&gt;
6
(b) Õ/10.
5.5
-600	-400	-200	0	200	400	600
Balanço de vazão 8 (m3/d)
(c) 2r(Xt).
(d) a/2.
Figura 4.5: Regiões e destinos para: (a) a = 0,4, ^max = 20, ^min = 10, rmax = 1, csoma = 0,01 e cmult — 1,5; (b) ^max — 2j ^min — 1; (c) rmax — 2 e (d) a — 0,2
forma curva prõxima aos extremos de nível e torne-se praticamente uma faixa diagonal, como mostrado na Figura 4.5(b).
O aumento do risco de continuacao r torna o controlador mais conservador, uma vez que as intervencoes ficam “mais baratas” quando comparadas com o risco de caminhar em direcao a uma fronteira. A diminuiçao do fator de desconto também tem esse efeito de aumentar o conservadorismo, pois significa que os tempos mais distantes no futuro passam a ter um peso maior que com a = 0,4. Desse modo, o custo terminal de se atingir a fronteira passa a ter um peso maior no custo total do controle impulsional e a regiao de continuidade fica menor.
resto da fronteira o custo de intervençao c ó pago e o processo ó transferido para o nó do canto menos arriscado correspondente. Devido à dinamica do sistema, o custo nas fronteiras em h fica fixo para todas as iteracães, enquanto seu valor na fronteira em 5 se altera a medida que varia o mínimo do custo para cada nóvel h.
Os resultados obtidos indicam qual o comportamento ideal do controlador. Para verificar se este comportamento estóa adequado ao funcionamento do sistema e qual a configuraçcaão das funçães mais ajustada às necessidades operacionais, ó necessario fazer simulaçães de validaçao das regiães obtidas. Foi então criado um simulador em Simulink com a geração de um sinal de vazãao de entrada que imita as condiçcãoes de operacçaão do VASPS e incorpora o modelo da planta. Uma descrição mais detalhada desse simulador e os resultados obtidos sao mostrados no capótulo a seguir.
Capítulo
O simulador do VASPS
Para validar o resultado obtido para o controlador foram realizadas simulações do sistema em operaçao, com a geraçõo de sinais de entrada semelhantes às vazões que se espera encontrar. A Seçõo 5.1 apresenta a descriçõo do simulador criado e, em seguida, os resultados desses testes sõo apresentados na Seçao 5.2. Por fim, a Seçõo 5.3 apresenta os estudos que foram realizados para obtencõo de uma estimativa da vazao de entrada por meio de filtragem, necessária para a utilizacõo do controlador projetado.
5.1	Simulação do sistema
A característica prevista para a vazõo de entrada de um VASPS em construcao pela Petrobras á de um escoamento com golfadas que causam variacoes de 335m3/d em ciclos de 2,2 minutos e cujo valor mádio á de 3108,6m3/d. Para simular essa vazõo, somou-se uma onda quadrada de mádia nula com variacõo e frequência iguais as referidas, um valor constante equivalente ao valor mádio e um movimento browniano aproximado, de desvio-padrõo 0,0001, capaz de causar flutuacões aleatárias na vazõo.
O sinal de vazõo resultante dessa combinaçao á uma entrada para o tanque que determina o nável, bem como a frequêencia da bomba, que áe resultado da láogica de controle empregada. No simulador, construído em Simulink, essa lógica, que retorna a vazõo de saáda desejada, á calculada por meio de um cádigo em Matlab, responsavel pela chamada periódica do diagrama de blocos do Simulink mostrado na Figura 5.1. O cádigo em Matlab, juntamente com o bloco conversor de vazao em frequencia, mostrado na Figura 5.2(b), corresponde ao mádulo do controlador. O conversor contáem a curva inversa da bomba, que transforma a vazõao de saáda requerida na correspondente frequêencia de rotaçcaõo da bomba, e um saturador, responsaável por manter as alteracões na faixa de operacao da bomba, considerada entre 40Hz e 65Hz, conforme informacões preliminares.
A planta, mostrada na Figura 5.2(a) contám um sub-bloco que modela o comportamento da bomba, apresentado na Figura 5.2(c), e o calculo do nável no VASPS a partir das vazões de saáda
Figura 5.1: Diagrama de blocos principal do programa em Simulink.
da bomba e de entrada. Na modelagem da bomba, uma função relaciona a frequência de rotação do motor com a vazao bombeada. Aqui, foi utilizada uma aproximacão linear, considerando que a vazao média corresponde a uma operação em 60Hz, que é a frequência de operação nominal da bomba.
Bemba	da
seçed transvErsal
(a) Planta.
(b) Conversor.	(c) Bomba.
Figura 5.2: Sub-blocos da simulação em Simulink.
Nessas simulaçães, a vazao de entrada gerada é usada pela légica definida pelo mapa de controle para alterar ou não a vazão de saída a partir do balanço otimo determinado. As ocorrêencias de intervençcãoes naão sãao limitadas, apenas suas amplitudes devem obedecer a faixa de operaçcãao da bomba. No sistema real, no entanto, naão existe mediçcaão da vazãao de entrada, apenas do nível de líquido no reservatério. Deve-se, assim, estimar a vazao a partir das medidas de nível por meio de um processo de filtragem. A Seçao 5.3 aborda o filtro de Kalman implementado com este intuito, poréem o seu acoplamento ao simulador nãao foi desenvolvido. A seçcãao a seguir compara os resultados das simulaçães realizadas com as regiães dos três cenários da Seçao 4.3.1.
5.2	Resultados
Foram realizadas simulaçães considerando a vazão de entrada descrita na seção anterior e algumas com casos especiais, como um pulso invertido para representar a queda de um poço e o decaimento da vazão média. Nos resultados a seguir, considerou-se que a vazão de entrada e o nível são medidos sem nenhum ruído. A Seção 5.2.1 mostra as simulacães com as condicães descritas na seção anterior e a Seção 5.2.2 refere-se às condiçães especiais.
5.2.1	Simulações dos três cenários: condições normais de vazao
A Figura 5.3 mostra a vazão de entrada, o nível no reservatério e a frequência da bomba para uma simulacao com o controlador conservador construído na Seção 4.3.1. Além disso, mostra também a trajetéria do sistema no espaco de estados.
T5
CO
C
Ô
3400
3200
3000
2800
0	5	10	15	20	25
91—
g 8-

5
i
10
—1
15
20
25
Z 6-
5 -0
(a) Simulacao completa.
Tempo (h)
(b) Primeiras horas.
o ■Ç
ÇT
&lt;D ■u "Õ
&gt;
9
8.5
8
7.5
7
6.5
6
5.5
5 -600
-400	-200	0	200	400	600
Balanço de vazão 8 (m3/d)
(c) Excursão em /V.
E
Figura 5.3: Simulacao com controlador conservador da Figura 4.4(a).
Durante a simulação, que corresponde a pouco mais que um dia (105s), ocorreram 64 intervenções do controlador, com alteraçõo média de 2,9337Hz, e o nível ficou contido na faixa de 6 a 8m, demonstrando uma grande preocupaçõo com o risco de se aproximar dos extremos permitidos para o nível. A Figura 5.3(b) mostra o trecho das duas horas iniciais da simulaçõo. Nessa figura, é possível observar o formato da vazõo de entrada. Percebe-se, ainda, que o nível tem pequenas flutuações correspondentes às variacões da componente de onda quadrada da entrada. Na Figura 5.3(c) é possível ver que o estado tende a ficar apenas na parte central da regiõo de continuidade, evitando aproximar-se das fronteiras permitidas para o nível.
Uma simulaçõo semelhante para o controlador moderado í mostrada na Figura 5.4.
3500
CO
3000
0
2500
0
5
20
25
10	15
Tempo (h)
(a) Simulação completa.
(b) Primeiras horas.
E
O "0
0"
(D "0 "Õ
&gt;
5 -600
-400	-200	0	200	400
Balanço de vazão 6 (m3/d)
(c) Excursao em /V.
Figura 5.4: Simulacao com controlador moderado da Figura 4.3(a).
O total de intervençcoães do controlador ocorridas durante essa simulaçcãao diminuiu para 54, com alteracães mídias de 2,9252Hz, praticamente o mesmo valor mídio que no cenario anterior. O nível atingiu valores um pouco alím da faixa de 6 a 8m, demonstrando uma preocupação um pouco menor com o risco de se aproximar dos extremos. Na Figura 5.4(c) í possível ver que o estado tambíem se mantíem apenas na parte central da regiãao de continuidade, evitando uma aproximaçcãao das fronteiras de nível, poríem o fato da regiãao de continuidade ser mais larga permite uma excursãao maior ao estado.
O controlador liberal tambím foi simulado e os resultados sao mostrados na Figura 5.5.
3600 i-
3400 -
3200
3000
2800
0
T
T
T
T
T
5
i
10
i
15
i—
20
i—
25
(a) Simulação completa.
o ■ç
ÇT
&lt;D ■u "Õ
&gt;
77 60---------------------'	I-----r" -
X
50 -	-
LL
40 I--1----1-----1----1---1-----1----1---1----1----
0	0.2	0.4	0.6	0.8	1	1.2	1.4	1.6	1.8	2
Tempo (h)
(b) Primeiras horas.
9
8.5
8
7.5
7
6.5
6
5.5
5 -600
(c) Excursao em /V.
E
Figura 5.5: Simulação com controlador liberal da Figura 4.4(b).
média das alterações subiu para 3,1065Hz. Percebe-se, ainda, que o controlador evita inter-vençcõoes muito grandes, o que algumas vezes gera duas intervençcõoes muito proóximas, como pode ser observado inclusive nas duas primeiras horas, na Figura 5.5(b). A amplitude das alteracões ficou ligeiramente maior que a dos outros controladores. O nóvel aproximou-se dos extremos, mas nõao ocorreu nenhuma violaçcaõo para a vazaõo de entrada simulada. Na Figura 5.5(c) óe pos-sóvel ver que o estado tambóem se mantóem apenas na parte central da regiõao de continuidade, contudo esta óe bem larga, o que torna o controlador audacioso, permitindo uma grande variacçõao do estado sem que nenhuma intervençcaõo ocorra.
Um ponto interessante a observar ó que algumas vezes a frequância atingiu o valor de 65Hz, o que corresponde ao valor limite e mostra que pode ter ocorrido saturacõo. Isso se deve ao fato de a vazõo módia estar próxima à vazõo móxima de saída da bomba, isto ó, a vazõo correspondente a 65Hz, que vale 3367,7m3/d. Dessa forma, a vazõo de entrada prevista para o VASPS representa condições bem rigorosas dado o seu dimensionamento, pois o controlador fica impossibilitado de criar um desbalanceamento mais negativo na vazõo caso seja necessario. A polótica adotada deve entõo ser suficientemente cautelosa para que isso nao ocorra.
Os trâs controladores mostraram-se eficientes nas simulações. Caso a entrada nao se distancie muito da que foi simulada, o controlador liberal óe mais interessante, uma vez que reduz o nuómero de intervenções. Como nem sempre a entrada se mantóm na forma aqui prevista, uma alternativa interessante óe utilizar os trâes mapas e deixar que o operador decida qual deles estóa mais adequado para a presente condiçcõao de atuacçõao.
O módulo de controle pode, ainda, guardar os mapas relacionados a diferentes pontos de atuacçõao e identificar qual deles deve ser usado, de modo que, ao ocorrer uma alteraçcaõo grande, ele consiga se adaptar sozinho as novas condiçoes. Isso ó particularmente útil para mudancas bruscas mas duradouras, como a queda de um pocço, que provoca uma grande alteraçcaõo na vazõao nominal de entrada. Utilizando um filtro nas medidas de nóvel, estima-se a vazõao de entrada e por meio da observaçcõao dessas estimativas detecta-se o fenoâmeno de queda de poçco. Isso permite o chaveamento para outro mapeamento que tenha sido criado para um valor nominal de vazõo mais próximo do novo cenório após a queda. A Figura 5.6 mostra um diagrama dessa tomada de decisõao.
Figura 5.6: Utilizacao da estimativa da vazõo de entrada para alterar o mapeamento.
Caso as condições do sistema se alterem significativamente, novos mapeamentos podem ser gerados e as informações atualizadas no controlador, de modo a se adequar ao novo ponto de operacao. E o caso, por exemplo, do decaimento que ocorre a longo prazo em decorrência do envelhecimento dos poços.
5.2.2	Simulações dos três cenários: vazões de entrada especiais
Duas simulações foram feitas para testar o comportamento do controlador em situacões extremas. A primeira é a utilizaçao de um pulso negativo na vazao média, para representar a queda de um poço e seu retorno à operaçao. As Figuras 5.7 e 5.8 mostram o comportamento dos controladores conservador e moderado, respectivamente, diante da queda de um poçco que representava 30% da vazõo média.
1500
3500
3000
2500
2000
5
10
15
20
25
8
40
5
10
15
20
25
60
50
5
15
20
25
0
0
0
Tempo (h)
Figura 5.7: Queda de poço com controlador conservador da Figura 4.4(a).
A Figura 5.9 representa o comportamento do controlador liberal com a queda de um poço de vazao média igual a das figuras anteriores.
Nos três cenarios, os controladores foram capazes de lidar com essa situaçao sem violação dos limites de nével, embora tenha sido necessario dar saltos muito grandes na frequência da bomba. Numa queda de poçco real, no entanto, a diminuicçãao da vazaão naão ocorre instantaneamente, na forma de um degrau. O controlador pode, portanto, dividir a atuacão em atuacães menores, de acordo com a alteracao da vazao de entrada. Se houver mais informaçães sobre a duracao desse processo, a queda de pocço pode ser simulada como uma rampa em vez de um degrau e uma simulacão mais precisa pode ser obtida. Essas simulacoes, no entanto, sao importantes para mostrar que os controladores, embora construédos com o intuito de prolongar a vida uétil da bomba, têm capacidade de dar grandes saltos em frequência caso haja necessidade.
A outra situacçãao simulada foi o decaimento da vazaão méedia por envelhecimento dos pocços, cuja ocorrêencia leva meses ou mesmo anos, mas nessas simulaçcãoes esse processo foi acelerado para
60
0
20
25
50-
40 L 0
20
25
Tempo (h)
Figura 5.8: Queda de poco com controlador moderado da Figura 4.3(a).
Figura 5.9: Queda de poço com controlador liberal da Figura 4.4(b).
ocorrer ao longo de um dia. A Figura 5.10 mostra o comportamento do controlador conservador com decaimento da vazao média e a Figura 5.11 o comportamento do moderado. O controlador liberal ée mostrado na Figura 5.12.

8
õ
^6
0
5
10	15	20	25
Figura 5.10: Envelhecimento de poços com controlador conservador da Figura 4.4(a).
0
60
5
20
—I-
25
—I-
50-
40 L 0
J I
10	15
Tempo (h)
h—L
L
20
I
25
5
Figura 5.11: Envelhecimento de pocos com controlador moderado da Figura 4.3(a).
controlador conservador torna-se mais interessante, embora este atue mais, prejudicando a vida útil da bomba. Percebe- se, portanto, a importância de se utilizar diferentes mapas de controle e de se ter um mecanismo de escolha do mapa mais adequado.
5.3	Estimação da vazão de entrada
Conforme mencionado na Seçao 5.1, para que o controlador indique uma vazao de saída para a bomba, ele precisa do balanço de vazao otimo calculado pelo controle impulsional e de uma estimativa da vazão de entrada. Para fazer essa estimaçao, experimentou-se um Filtro de Kalman, por ser uma técnica de fécil implementaçao.
4000
T3
2000
Figura 5.12: Envelhecimento de poços com controlador liberal da Figura 4.4(b).
O Filtro de Kalman é um estimador de estados para sistemas lineares dinamicos em tempo discreto afetados por ruédo branco, isto é, um ruédo cujo valor em um instante de tempo é descorrelacionado do seu valor em tempos anteriores. O primeiro passo para sua implementacçaão é, portanto, converter o modelo contínuo do sistema para tempo discreto. Como a flutuação da vazãao de entrada nãao ée um ruédo branco, possuindo inclusive uma componente perioédica (onda quadrada), ela foi modelada como sendo o resultado da aplicacao de um filtro passa-baixas em um ruído branco. Uma vez que a utilização do filtro passa-baixas representa o acréscimo de mais um integrador ao sistema, tornou-se necesséario a criacçaão de uma terceira componente do estado, além do nével h e do balanço de vazão 5. A nova componente w representa a variacao da vazaão de entrada em torno de um valor nominal.
Um filtro passa-baixas com funcão de transferência
H (s) =
Tfs +1
aplicado em uma entrada e, resulta na saída w que satisfaz a equacao diferencial
-1	1
lã = — w +-----e,
Tf	Tf
cuja solucçãao ée dada por
w(t) = e	to&gt;/Tf w(t0) +	e ds
J to	Tf
= e~(t~to)/Tf w(t0) + (1 - e~(t~to)/Tf )e
(5.1)
(5.2)
Assim, as equações de estado para o sistema discreto podem ser obtidas considerando o passo
de discretizacão At = t — to e valem
h(k + 1)	=	h(k) + —5(k)	(5.3a)
õ(k + 1)	=	Qn + w(k) — Qb(k),	(5.3b)
w(k + 1)	=	e~Át/Tf w(k) + (1 — e~Át/Tf)	e(k),	(5.3c)
em que e(k) é um ruído branco e gaussiano de média nula usado para modelar a aleatoriedade das variações da entrada, Qn é a vazão média de entrada, Qb é a vazao de saída, a variével de controle, e Tf é uma constante de tempo escolhida.
O diagrama de blocos da Figura 5.13 mostra a modelagem do sistema em tempo discreto usada pelo filtro de Kalman.
Figura 5.13: Representação esquemética do modelo para controle de nível de líquido.
Representando o sistema (5.3) na forma matricial, com vetor de estados dado por x = [h 5 w]T, a equaçao da dinâmica da planta é
x(k + 1) = F (k)x(k) + G(k)u(k) + r(k)e(k), k = 0,1,...,	(5.4)
em que e(k) é denominado ruído do processo e tem covariancia E[e(k)e(k)z] = rQ(k)rz e F e G sãao obtidos a partir das equaçcoães (5.3).
A equação da medida de nível é representada por
y(k) = H (k)x(k) + v(k), k = 1,2,...,	(5.5)
com v uma sequância de média zero, gaussiana e branca correspondente ao ruído de medicao, cuja covariância é E[v(k)v(k)z] = R(k) e H(k) = [10 0].
A média condicionada a uma sequência Zk :=	C k} de observações disponíveis no
instante de tempo k ée representada por
x(j|k) := E[x(j)|Zk].
Conforme explicado em [1], o algoritmo para implementação do filtro de Kalman é representado na Figura 5.14.
O teste realizado com filtro de Kalman utilizou um sinal de vazãao de entrada criado externamente (obtido pelo gerador de vazaão do simulador). Com isso, o primeiro somador e os blocos
Evolução Entrada conhecida do sistema	(controle ou
(estado verdadeiro)	sensor)
Estimação do estado
Calculo da covariancia do estado
Figura 5.14: Algoritmo de uma iteraçao do filtro de Kalman, vide [1].
que o alimentam na Figura 5.13 foram substituídos por um Unico bloco, correspondente aos dados usados como entrada. Esse novo diagrama, usado para a geracão das medidas de nível, está mostrado na Figura 5.15.
Qin(k)
y(k)
v(k)
+
^^S(k + 1)	At/A	h(k)
M *	z2 — z	"O
Qb(k)
Figura 5.15: Geraçao de medidas de nível de líquido.
Para o teste realizado, ajustou-se as variâncias dos ruídos de processo e de medição. A primeira foi escolhida como Q = 106 e a segunda, R = 0,1. Além disso, a constante de tempo do filtro passa-baixas foi ajustada para Tf = 100. Dadas as medidas de nível, o filtro de Kalman estima o nível real e a vazão de entrada. Para isso, necessita do valor da vazão de saída. A
vazao de saída foi suposta inferior ao valor nominal da vazao de entrada em 100m3/d durante os primeiros 200s, igual ao valor nominal de 200s a 400s e superior em 100m3/d após 400s. O resultado obtido é mostrado na Figura 5.16.
(a) 500s.	(b) Ampliação: 35s.
Figura 5.16: Estimativa da vazõo de entrada usando filtro de Kalman.
Observa-se que a vazõo de entrada estimada nõo acompanha bem o valor real nos instantes de transicões de frequência da bomba, em t = 200s e t = 400s, mas logo em seguida as estimativas voltam a aproximar-se bastante do valor real. Este filtro parece adequado para a utilizacçaõo em uma primeira etapa do projeto, pois acompanha bem os valores reais enquanto a vazõo de saída esta constante. Caso depois se mostre necessário obter estimativas mais precisas nas transições da vazaõo de saída, outros míetodos mais sofisticados de filtragem podem ser utilizados, como o filtro de partículas, em que cria-se diversos filtros paralelamente (partículas) e a evolucao deles íe analisada e afetada por um processo de extincçõao das partículas que se distanciam do comportamento real do sistema. O resultado da filtragem com esta tíecnica íe uma ponderacçaõo dos filtros que melhor representam o sistema.
Capítulo
Conclusões
Esta dissertaçõo teve por objetivo propor um controlador para o nóvel do reservatório no VASPS, sistema inovador de separaçao multifósica no leito marinho, que apresenta caracterós-ticas bem particulares do ponto de vista de controle. O nóvel tem que ser mantido dentro de uma faixa de operaçcaõo, na qual pode variar livremente, levando em conta que intervençcoões frequentes e de grande intensidade diminuem a vida uótil da bomba. Como o sistema encontra-se submerso no oceano, fazer manutencçõao ou reparos implica em um custo muito alto. Alóem disso, muitas vezes óe um processo demorado, por necessitar de sondas especiais que nem sempre estõao a disposiçõo, resultando na perda da produçõo de vórios dias dos poços ligados ao sistema. Por esse motivo, a preocupaçcaõo em prolongar a vida uótil da bomba adquire grande importaância.
A soluçcõao adotada foi utilizar controle impulsional aplicado em um modelo do reservatóorio baseado em processos de difusõao. O modelo criado baseou-se no balançco de massa do sistema para relacionar nóvel de lóquido e diferençca entre vazõao de entrada e de saóda. Alóem disso, as incertezas presentes, isto ó, a flutuaçõo da vazõo de entrada e a imprecisõo na medida do nóvel, foram modeladas como movimentos brownianos.
O controle impulsional consiste em determinar os instantes de atuaçcõao e a amplitude de cada intervençcõao que minimizam o valor esperado de um funcional de custo do processo. A funcçõao custo representa o compromisso entre o risco de continuar sem atuar e o custo de cada intervençcõao, bem como o custo de se atingir a fronteira do espaçco de estados, tido como estados terminais.
Para obter a soluçcõao do controle impulsional, utiliza-se uma sequâencia associada de problemas de parada oótima iterados. Estes, por sua vez, tâem correspondâencia com desigualdades variacionais. O Capótulo 2 prova a equivalâencia entre a sequâencia de paradas óotimas e o controle impulsional restrito a um numero arbitrario n de intervenções e a convergância deste para o caso com quantidade ilimitada de intervençcoões. Alóem disso, detalha-se tambóem a correspondâencia dos problemas de parada óotima com desigualdades variacionais e a equivalâencia entre a formu-laçcaõo com essas desigualdades e o problema de controle impulsional original. Essa dissertaçcaõo propoõe a soluçcõao desse problema pela aplicaçcõao do móetodo numóerico Discretizaçcõao do Valor
Módio, que permite a conversão das desigualdades variacionais discretizadas em um problema de programacçãao linear, cujas tóecnicas de soluçcaão saão amplamente conhecidas.
O resultado obtido com o controle impulsional óe a definicçãao de uma regiãao de continuidade para os estados, dentro da qual deve-se deixar o sistema evoluir livremente de acordo com sua dinâmica própria. A região complementar dessa ó chamada de região de intervençao, na qual o controle atua transferindo o estado para outro ponto, em geral contido na regiaão de continuidade. O controle impulsional tambóem indica qual o valor dessa variaçcãao de posiçcãao para cada estado desta regiãao cujo destino minimiza o custo.
Foram gerados mapas de controle para diferentes funçcãoes de custo e em seguida o sistema foi simulado de forma a validar e comparar o controle executado por cada uma dessas regiãoes. As simulaçães foram baseadas na geracao de vazães de entrada com as características que se espera encontrar no sistema real. Os resultados obtidos mostram que essa ó uma técnica de controle bastante interessante e que se encaixa bem no problema estudado.
Perspectivas de trabalhos futuros
Embora as simulaçães indiquem um bom desempenho, alguns pontos ainda precisam ser implementados ou melhorados. O principal deles ó a implementacao do filtro que estima o nóvel real e a vazaão de entrada por meio das medicçãoes de nóvel. Essa estimativa da vazaão óe essencial para o funcionamento do controlador, pois o controle impulsional indica apenas o balancço ideal de vazãao e para calcular a vazãao de saóda que deve ser fornecida pela bomba, óe necessóario ter uma estimativa da vazão de entrada. Uma sugestão de filtro de Kalman foi apresentada na Seçcaão 5.3, mas seu acoplamento com o simulador ainda nãao foi realizado. As simulacçãoes que foram realizadas consideravam que se tinha a informaçcãao exata da vazaão de entrada, o que nãao corresponde ao sistema real.
Alóem disso, uma melhoria a ser implementada óe permitir que o controlador façca o chavea-mento entre diferentes mapas das regioes, conforme descrito na Secão 5.2. Isso permite o ajuste do controlador as características de operaçao do sistema, que variam ao longo do tempo.
Pretende-se, ainda, fazer as alteracçãoes no programa criado para geracçãao das regiãoes de modo que a faixa de variaçcãao do balançco de vazaão nãao precise ser simóetrica. Isso permitiróa que a excursaão móaxima da vazaão de saóda, determinada pelas frequâencias maóxima e mónima da bomba, seja considerada.
utilizar outras formas de funçoes de risco e de custo mais ajustadas ao VASPS. Abordagens interessantes para esse assunto podem ser encontradas em [37], em que uma modelagem de risco é proposta para determinar o momento que deve-se verter a agua de barragens para evitar enchentes e em [38], que descreve diversas modelagens de teoria de riscos.
Publicações
-&gt;
O trabalho originou um artigo para o Conference on Decision and Control - CDC 2009, jé aceito[39]. Aléem disso, os resultados estãao sendo organizados para submissãao a um perioédico da aérea de controle.
Referencias Bibliográficas
[1]	Y. Bar-Shalom, X. R. Li, and T. Kirubarajam, Estimation with Applications to Tracking and Navigation. John Wiley, 2004.
[2]	A. E. Dukler and Y. Taitel, “Flow pattern transitions in gas-liquid systems: Measurement and modeling,” Multiphase Science and Technology, vol. 2, pp. 1-94, 1986.
[3]	E. S. Rosa, F. A. França, and G. S. Ribeiro, “The cyclone gas-liquid separator: operation and mechanistic modeling,” Journal of Petroleum Science and Engineering, vol. 32, no. 2-4, pp. 87- 101, 2001.
[4]	O. R. do Vale, J. E. Garcia, and M. Villa, “VASPS installation and operation at campos basin,” in Proc. OTC’02, Rio de Janeiro, Brazil, May 2002.
[5]	A. V. de Melo, A. B. S. Serapiao, and J. R. P. Mendes, “Método da histerese por auto-ajuste para minimização de esforço de controle no separador submarino VASPS,” SBA Controle &amp;amp; Automação, vol. 20, no. 1, 2009.
[6]	A. Bensoussan and J.-L. Lions, Impulse Control and Quasi-Variational Inequalities. Paris: Gauthier-Villars, 1984.
[7]	B. 0ksendal and A. Sulem, Applied Stochastic Control of Jump Diffusions, 2nd ed., ser. Universitext. Springer, 2007.
[8]	B. 0ksendal, Stochastic Differential Equations: An Introduction with Applications, 6th ed., ser. Universitext. Springer, 2007.
[9]	D. Sbarbaro and R. Ortega, “Averaging level control: An approach based on mass balance,” Journal Of Process Control, vol. 17, no. 7, pp. 621-629, 2007.
[10]	T.-F. Cheung and W. L. Luyben, “Nonlinear and nonconventional liquid level controllers,” Industrial &amp;amp; Engineering Chemistry - Fundamentals, vol. 19, no. 1, pp. 93-98, 1980.
[11]	A. Faanes and S. Skogestad, “Buffer tank design for acceptable control performance,” Industrial &amp;amp; Engineering Chemistry Research, vol. 42, no. 10, pp. 2198-2208, 2003.
[12]	E. Horton, M. Foley, and K. Kwok, “Performance assessment of level controllers,” International Journal Of Adaptive Control And Signal Processing, vol. 17, no. 7-9, pp. 663-684, 2003.
[13]	G. C. Nunes, A. A. R. Coelho, R. R. Sumar, and R. I. G. Mejia, “A practical strategy for controlling flow oscillations in surge tanks,” Latin American Applied Research, vol. 37, no. 3, pp. 195-200, 2007.
[14]	B. 0ksendal and A. Sulem, “Optimal stochastic impulse control with delayed reaction,” Appl. Math. Optim., vol. 58, pp. 243-255, 2008.
[15]	E. Cinlar, Introduction to Stochastic Processes. Englewood Cliffs: Prentice-Hall, 1975.
[16]	D. P. Bertsekas and J. N. Tsitsiklis, Introduction to Probability. Belmon: Athena Scientific, 2002.
[17]	S. E. Shreve, Stochastic Calculus for Finance II: Continuous-Time Models, 1st ed., ser. Springer Finance. Berlin: Springer, 2004.
[18]	J. Harrison, T. Sellke, and A. Taylor, “Impulse control of Brownian-motion,” Mathematics of Operations Research, vol. 8, no. 3, pp. 454-466, 1983.
[19]	S. Barlev, M. Parlar, and D. Perry, “Impulse control of a Brownian inventory system with supplier uncertainty,” Stochastic Analysis and Applications, vol. 11, no. 1, pp. 11-27, 1993.
[20]	E. Arruda and J. D. Val, “Stability and optimality of a multi-product production and storage system under demand uncertainty,” European Journal of Operational Research, vol. 188, no. 2, pp. 406-427, 2008.
[21]	M. Jeanblanc-Picque, “Impulse control method and exchange rate,” Mathematical Finance, vol. 3, pp. 161-177, 1993.
[22]	G. Mundaca and B. 0ksendal, “Optimal stochastic intervention control with application to the exchange rate,” Journal of Mathematical Economics, vol. 29, no. 2, pp. 225 - 243,
1998.
[23]	A. Cadenillas and F. Zapatero, “Classical and impulse stochastic control of the exchange rate using interest rates and reserves,” Mathematical Finance, vol. 10, no. 2, pp. 141-156, 2000.
[24]	J. Eastham and K. Hastings, “Optimal impulse control of portfolios,” Mathematics of Operations Research, vol. 13, no. 4, pp. 588-605, 1988.
[25]	A. J. Morton and S. R. Pliska, “Optimal portfolio management with fixed transaction costs,” Mathematical Finance, vol. 5, pp. 337-356, 1995.
[26]	R. Korn, “Some applications of impulse control in mathematical finance,” Mathematical Methods of Operations Research, vol. 50, no. 3, pp. 493-518, 1999.
[27]	L. H. R. Alvarez, “Stochastic forest stand value and optimal timber harvesting,” SIAM Journal on Control and Optimization, vol. 42, no. 6, pp. 1972-1993, 2004.
[28]	M. Egami, “A direct solution method for stochastic impulse control problems of onedimensional diffusions,” SIAM Journal on Control and Optimization, vol. 47, no. 3, pp. 1191-1218, 2008.
[29]	Z. Chen and P. A. Forsyth, “A numerical scheme for the impulse control formulation for pricing variable annuities with a guaranteed minimum withdrawal benefit (GMWB),” Nu-merische Mathematik, vol. 109, no. 4, pp. 535-569, 2008.
[30]	J. N. Tsitsiklis and B. V. Roy, “Optimal stopping of Markov processes: Hilbert space theory, approximation algorithms, and an application to pricing high-dimensional financial derivatives,” IEEE Transactions on Automatic Control, vol. 44, no. 10, pp. 1840-1851,
1999.
[31]	M. G. Andrade and J. B. R. do Val, “A numerical scheme based on mean value solutions for the Helmholtz equation on triangular grids,” Mathematics of Computation, vol. 66, no. 218, pp. 477-493, April 1997.
[32]	W. H. Fleming and R. W. Rishel, Deterministic and Stochastic Optimal Control, ser. Apli-cations of Mathematics. New York: Springer-Verlag, 1982.
[33]	P. R. Garabedian, Partial Differential Equations. John Wiley &amp;amp; Sons, 1964.
[34]	J. B. R. do Val and M. G. Andrade, “On mean value solutions for the Helmholtz equation on square grids,” Applied Numerical Mathematics, vol. 41, no. 4, pp. 459-479, 2002.
[35]	D. Gilbarg and N. S. Trudinger, Elliptic partial differential equations of second order, 2nd ed., ser. (Grundlehren der mathematischen Wissenschaften; v. 224). Berlin: Springer, 1983.
[36]	M. G. de Andrade Filho, “Uma abordagem numérica para problemas de valor de contorno de Dirichlet envolvendo a equaçao de Helmholtz,” Faculdade de Engenharia Elétrica e de Computação, UNICAMP,” Tese de Doutorado, Janeiro 1995.
[37]	M. G. Andrade, M. D. Fragoso, and A. A. Carneiro, “A stochastic approach to the flood control problem,” Applied Mathematical Modelling, vol. 25, no. 6, pp. 499-511, May 2001.
[38]	J. Grandell, Aspects of Risk Theory, ser. Springer Series in Statistics. Springer-Verlag, 1991.
[39]	N. C. Pinheiro, J. B. R. do Val, and R. S. Mendes, “Stochastic intervention strategy applied to a level control with a trade-off between risky operation and actuator variations,” in CDC 2009, December 2009, aceito.
Conceitos Básicos no Estudo de Processos de Difusão
Espaço mensurável: Se o espaço amostrai de um processo é representado por Q, diz-se que F representa uma a-élgebra em Q quando F é uma famélia de subconjuntos de Q com as seguintes propriedades:
•	0GF;
•	F F	FC G F, em que FC = Q\F é o complemento de F em Q;
•	Ai,Á2,... G F A :=	G F.
A menor a-algebra formada por todos os subconjuntos abertos de um espaço topologico Q é chamada a-élgebra de Borel e seus elementos sõo conjuntos de Borel. Uma funçõo X : Q Rn é dita F-mensurável se o seu doménio que gera um conjunto de Borel U pertence a a-álgebra F, para todo conjunto boreliano U, isto é,
X-1(U) := {w G Q; X(w) G U} G F, para todo conjunto de Borel U C Rn.	(A.1)
Medida de probabilidade e conceitos “quase çertamente” e “em quase todo lugar”:
Define-se uma medida de probabilidade P em um espaço mensurável (Q, F) como uma funcõo P : F [0,1] tal que P(0) = 0, P(Q) = 1 e, se A1,A2,... G F e {Ai}j=1 é disjunto (Ai C Aj = 0 se i = j), entao
P (U“1 Ai) = £ P(Ai).	(A.2)
i=1
Usualmente, existem eventos A C Q tal que P(A) = 1. Se uma afirmaçõo vale para todo w G A, diz-se que ela é verdade quase certamente (q.c.) ou que a afirmaçao vale com probabilidade 1. Se a medida utilizada nõao for uma probabilidade, diz-se que ela vale em quase todo lugar, ou para quase todo w G Q, quando é valida para todo w fora de um conjunto de medida nula.
Filtração e {Ft}-adaptado: Uma filtracõo em (Q,F) ó uma famólia {F}í&gt;o de a-ólgebras Ft C F tal que 0 s &amp;lt;t	FS CZ F¿. Um processo estocastico ó dito adaptado a uma
filtraçõo {Ft} se ó Ft-mensuróvel para todo t e um espaço de probabilidades filtrado ó representado por (Q,F,{Ft}t^0,P).
Movimento browniano: Um movimento browniano unidimensional Bt ó um processo estocas-tico contónuo com incrementos independentes estacionónos de distribuiçõo gaussiana, cujo valor esperado de cada incremento óe o estado inicial e a variaância óe o tempo decorrido durante o intervalo. Escrito de outra forma [17], uma funçõo contónua B(t) ó um movimento browniano se para todo 0 = t0 &amp;lt;t1 &amp;lt;... &amp;lt;tm, os incrementos
B(t1) - B(to), B(t2) - B(t1),..., B(tm) - B(tm_1)
sõao independentes e possuem distribuicçõao gaussiana com
E[B(ti+1) - B(ti)] = B(0) e E[(B(ti+1) - B(ti))2] = ti+1 - ti.
Tempo de parada: O tempo de parada de um processo estocóstico Xt e uma variavel aleatoria T de modo que para qualquer t 0, ó possóvel determinar se o evento {t &amp;lt;t} ocorreu baseado no histórico {Xu; u &amp;lt;t} do processo estocóstico.
Propriedade forte de Markov: A propriedade forte de Markov afirma que a probabilidade de um processo markoviano Xt encontrar-se em um estado j em um instante de tempo posterior a um tempo de parada T independe da trajetória do processo anterior a T, isto óe,
P{Xt+s = j|X„; u &amp;lt;T} = PS(XT,j).	(A.3)
Alóem disso, em termos de valor esperado, essa independâencia significa que para qualquer m natural, 0 &amp;lt;s1 &amp;lt;... &amp;lt;sm e uma funçõo positiva f definida em Fm, vale
E[f (Xt+s,,.JÍt+s.)|X,„ u « T] = E[f (Xs,,...,Xs„)|Xo = Xt].	(A.4)
Lei das esperanças iteradas O valor esperado de qualquer esperança condicional de um processo X óe igual ao valor esperado de X, isto óe,
E [E [X |U1,...,yra]] = E [X].	(A.5)
Martingal, supermartingal e submartingal: Um processo estocastico {Xt}t^0 em um es-paco (Q,F,P) ó chamado martingal com respeito a uma filtracao {Ft}t^0 (e com respeito a P) se
(i)	Xt ó F-mensuróvel para todo t;
(ii)	E[|Xt|] &amp;lt;x para todo t;
(iii) E [Xs|Ft] = Xt para todo s t.
Se (i) e (ii) sao validos e E[Xs|Ft] &gt; Xt para todo s &gt; t, entao Xt é um submartingal. Por outro lado, se (iii) e substituído por E[Xs|Ft] &amp;lt;Xt para todo s &gt; t, entao Xt e um supermartingal.
Lema de Fatou: Se {fn} é uma sequência de funções mensuráveis nao-negativas, entao
De modo anaiogo,
lim inf fnd^ &amp;lt;lim inf fnd^
n	n
limsup fndy limsup	fndy	(A.7)
n	n
Como E [f ] = f fdPf, em que Pf e a medida de probabilidade de f, vale tambem
(A.6)
E [lim sup fn] &gt; lim sup E [fn].
nn
(A.8)
Convergência dominada de Lebesgue: Seja {fn} uma sequência de funcoes mensuráveis e g uma funcõo integrável. Se |fn| &amp;lt;g em quase todo lugar e fn	f em quase todo lugar,
entõo f e fn sõo integráveis e J fndg,	j fdp,.
Teorema da Convergencia Limitada: Seja ^(Q) &amp;lt;to e as funçoes fn sõo uniformemente limitadas, entõo fn	f em quase todo lugar implica que f fndg,	f fdp,.
Apêndice
B
Matrizes expandidas do MVS
Conforme mencionado na Seçao 3.4, no problema de programaçao linear descrito, uma das restrições deve ser satisfeita também na fronteira. O vetor de incégnitas W deve, portanto, incluir os nés de fronteira, a excecao dos quatro nos dos cantos, que nao pertencem à regiao coberta pelas bolas. Assim, W é um vetor cujos elementos sao os valores aproximados no ponto Zj para o resultado w da transformacao (3.14) aplicada na versao discreta de V em Z. Para isso, foi necessário expandir a matriz A e modificar o vetor b, de modo a criar a nova desigualdade matricial AW &amp;lt;b, com b dependendo apenas do termo nao-homogâneo para os nos internos e assumindo o valor da condiçcao de fronteira para os níos externos e
	A	Cup	Cbottom	—In 0]t	[0 — In]t ’	
	0	IM	0	0	0	
A =	0	0	IM	0	0	,	(B.1)
	0	0	0	IN	0	
	0	0	0	0	IN	
em que Cup, Cbottom representam matrizes de dimensao NM x M cujos elementos valem —1 nos pontos em que ha uma ligaçao do elemento de W correspondente àquela linha com as fronteiras superior e inferior, respectivamente; IM e IN sao as matrizes identidade de tamanho M x M e N x N, respectivamente; e 0 representa uma matriz de zeros com a dimensao adequada. O codigo em Matlab a seguir apresenta como construir a matriz A a partir da matriz A, do numero de linhas de níos internos, N, e do nuímero de colunas de níos internos, M.
Per = 2*N+2*M;
A2 = [A zeros(N*M,Per); zeros(Per,N*M+Per)]; for k=1:M
A2((k-1)*N+1,N*M+k)=-1;
A2(k*N,N*M+M+k)=-1;
end
A2(1:N,N*M+2*M+1:N*M+2*M+N) = -eye(N);
A2(N*M-N+1:N*M,N*M+Per-N+1:N*M+Per) = -eye(N);
A2(N*M+1:N*M+M,N*M+1:N*M+M) = eye(M);
A2(N*M+M+1:N*M+2*M,N*M+M+1:N*M+2*M) = eye(M);
A2(N*M+2*M+1:N*M+2*M+N,N*M+2*M+1:N*M+2*M+N) = eye(N);
A2(N*M+2*M+N+1:N*M+Per,N*M+2*M+N+1:N*M+Per) = eye(N);
Como exemplo, tome o caso em que M = N = 2. Tem-se, então, uma região com 4 nos em cada dimensão, incluindo a fronteira. A matriz A, que não inclui os elementos de fronteira, tem dimensao MN x MN, isto e, 4 x 4 e vale
	4Io(Ar)	-1	-1	0
A =	-1 -1	4Io(Ar) 0	0 4Io(Ar)	-1 -1
	0	-1	-1	4Io(Ar)
(B.2)
O vetor b tem dimensão NM + 2(N + M) = 12 e vale
4fn[1 - Io(Ar)]/A2 4/21 [1 - Io(Ar)]/A2 4/12[1 - Io(Ar)]/A2
4/22[1 - Io(Ar)]/A2
M[W '
M[W k-1](zo2)
M[W k-1](z3i)
M[W k-1](z32)
M[W k-1](zio)
M[W k-1](z2o)
M[W k-1](zi3)
M[W k-1](z23)
(B.3)
em que / e a função da parte não-homogênea da desigualdade de Helmholtz e é definida somente no interior e Zj, i = 0, . . . ,N,N + 1 e j = 0, . . . ,M,M + 1, representa um ponto em Z.
A matriz A, de dimensbo (NM + 2(N + M)) x (NM + 2(N + M)) = 12 x 12, vale
4Io(Ar)	-1	-1	0	-1	0	0	0	-1	0	0	0
-1	4Io(Ar)	0	-1	0	0	-1	0	0	-1	0	0
-1	0	4Io(Ar)	-1	0	-1	0	0	0	0	-1	0
0	-1	-1	4Io(Ar)	0	0	0	-1	0	0	0	0
0	0	0	0	1	0	0	0	0	0	0	0
0	0	0	0	0	1	0	0	0	0	0	0
0	0	0	0	0	0	1	0	0	0	0	0
0	0	0	0	0	0	0	1	0	0	0	0
0	0	0	0	0	0	0	0	1	0	0	0
0	0	0	0	0	0	0	0	0	1	0	0
0	0	0	0	0	0	0	0	0	0	1	0
0	0	0	0	0	0	0	0	0	0	0	1</field>
	</doc>
</add>