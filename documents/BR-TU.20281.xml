<?xml version="1.0" encoding="utf-8"?>
<add>
	<doc>
		<field name="docid">BR-TU.20281</field>
		<field name="filename">3752_338915.pdf</field>
		<field name="filetype">PDF</field>
		<field name="text">
Victor Antonio Paludetto Magri

Pré-Condicionador Multiescala
Algébrico Aplicado à Simulação de

Reservatórios de Petróleo

Brasil
2015, Setembro





Victor Antonio Paludetto Magri

Pré-Condicionador Multiescala Algébrico
Aplicado à Simulação de Reservatórios de

Petróleo

Dissertação submetida ao Pro-
grama de Pós-Graduação em En-
genharia Mecânica da Universi-
dade Federal de Santa Catarina
para a obtenção do Grau de Mes-
tre em Engenharia Mecânica.

Universidade Federal de Santa Catarina - UFSC
Departamento de Engenharia Mecânica

Programa de Pós-Graduação

Orientador: Clovis R. Maliska
Coorientador: Mário C. Zambaldi

Brasil
2015, Setembro



Victor Antonio Paludetto Magri
Pré-Condicionador Multiescala Algébrico Aplicado à Simulação de Reserva-

tórios de Petróleo/ Victor Antonio Paludetto Magri. – Brasil, 2015, Setembro-
224 p. : il. (algumas color.) ; 30 cm.

Orientador: Clovis R. Maliska
Coorientador: Mário C. Zambaldi

Dissertação (Mestrado) – Universidade Federal de Santa Catarina - UFSC
Departamento de Engenharia Mecânica
Programa de Pós-Graduação, 2015, Setembro.
1. Simulação de Reservatórios. 2. Métodos Multiescala. 3. MsFVM. 4. Pré-

condicionadores. I. Clóvis R. Maliska. II. Universidade Federal de Santa Catarina.
III. Programa de Pós-Graduação em Engenharia Mecânica. IV. Mestrado.



Victor Antonio Paludetto Magri

Pré-Condicionador Multiescala Algébrico
Aplicado à Simulação de Reservatórios de

Petróleo

Esta Dissertação foi julgada adequada para obtenção do Título
de Mestre em Engenharia Mecânica e aprovada em sua forma
final pelo Programa de Pós-Graduação em Engenharia Mecânica.

Brasil, 14 de Setembro de 2015.

Prof. Armando Albertazzi, Dr.
Coordenador do Curso

Clovis R. Maliska, PhD. - Orientador
Universidade Federal de Santa Catarina

Mário C. Zambaldi, Dr. - Coorientador
Universidade Federal de Santa Catarina

Banca Examinadora:

Prof. Daniel Norberto Kozakevich, Dr.
Universidade Federal de Santa Catarina



Prof. Juliano de Bem Francisco, PhD.
Universidade Federal de Santa Catarina

Prof. Sérgio Peters, Dr. Eng.
Universidade Federal de Santa Catarina



AGRADECIMENTOS

Agradeço em primeiro lugar a Deus pela graça que viabi-
lizou a realização desse trabalho; aos meus pais Marcos e Márcia,
os quais se esforçaram para que eu pudesse conduzir meus estudos
longe de minha cidade natal; aos meus companheiros do grupo de
pesquisa SINMEC, cada qual com seu papel especial no desenvol-
vimento desse trabalho. Agradeço em especial aos companheiros
de sala Edão e Giovani e também ao Gustavo pelas discussões
sobre métodos de solução de sistemas lineares e pela grande ajuda
concedida em relação à organização do tempo dedicado às ativi-
dades de pesquisa. Nesse âmbito, outra pessoal fundamental foi a
Tatiane, que esteve sempre atenta para me lembrar das datas de
entregas de trabalhos e demais prazos estipulados pelo programa
de pós-graduação além de conceder várias dicas fundamentais
para a apresentação oral do trabalho. Incluo nessa última observa-
ção os amigos Mariele, Vitão e Taísa, cujas dicas foram essenciais
para que eu conseguisse enquadrar os aspectos mais relevantes do
trabalho dentro do tempo estipulado para sua apresentação.

Agradeço muito aos meus orientadores Clovis Maliska e
Mário Zambaldi. Ao primeiro, pela oportunidade de trabalhar
ao longo dos últimos 6 anos no laboratório SINMEC e por se
preocupar em manter sempre nosso ambiente de pesquisa antenado
com as tendências em simulação numérica do escoamento em
reservatórios de petróleo; ao segundo, agradeço pelas aulas de
álgebra linear que despertaram a paixão pela pesquisa em análise
numérica e também pelas várias conversas e conselhos obtidos.

Estendo minha gratidão também aos amigos que não
participaram diretamente na realização do trabalho mas que
proporcionaram bons momentos de convívio, essenciais para o
descanso da mente e seu preparo para o dia seguinte. Aos amigos
e também professores Marcos e Léo pelas boas conversas e tam-
bém em especial aos irmãos de morada: Henrique Martin, Edão,
Serginho, Renanzão, além dos vários hóspedes que passaram pelo
apartamento A202 do Vivenda das Verbenas ao longo desses dois
anos e meio de existência. Ótimas recordações ficam desse período.

Por último agradeço à Universidade Federal de Santa Ca-



tarina e ao Programa de Pós-Graduação em Engenharia Mecânica
pela excelência do curso oferecido. Ao Programa de Recursos
Humanos da ANP pela estrutura disponibilizada e pelo apoio
financeiro bem como ao Conselho Nacional de Pesquisa e Desen-
volvimento Científico CNPq.



“Senhor, tudo para a tua glória e por Amor.”
(Caminho - 788)





RESUMO

Um dos grandes desafios presentes na simulação numérica de
reservatórios de petróleo diz respeito à resolução dos sistemas line-
ares obtidos pela discretização de equações elípticas. Essa tarefa
torna-se ainda mais complexa quando campos de permeabilidade
altamente heterogêneos são considerados. Diversas estratégias
de solução diretas e iterativas foram desenvolvidas ao longo dos
últimos anos e empregadas nesse contexto, restringindo-se às
últimas, nota-se que os métodos iterativos construídos a partir
de pré-condicionadores do tipo multigrid são os mais utilizados
devido a sua robustez e eficiência. Nesse trabalho avaliam-se as
propriedades matemáticas e o desempenho computacional de uma
subclasse de pré-condicionadores desse último tipo conhecida
como “multiescala”. As alternativas estudadas são implementadas
computacionalmente e empregadas em conjunto com diversos
métodos iterativos para a resolução precisa e também aproxi-
mada de problemas elípticos desafiadores. Dentre os problemas
testados, verifica-se que a melhor estratégia de configuração para
o pré-condicionador multiescala é constituída por um operador
de restrição do tipo galerkin, suavizador baseado em fatoração
incompleta e razões de engrossamento ao redor de 10 ao longo
de cada direção do reservatório. Diversas outras estratégias de
solução direta e iterativa disponíveis no pacote científico PETSc
são testadas para a resolução dos problemas em questão, da
onde conclui-se que o pré-condicionador BoomerAMG associado
ao método do gradiente conjugado e também o método direto
Cholesky-UMFPACK são as mais eficientes em ambos quesitos
matemático e computacional, inclusive em relação ao método
multiescala de referência quando se deseja encontrar soluções com
elevadas precisões.

Palavras-chave: simulação de reservatórios. Pré-condicionadores
multiescala. Método dos volumes finitos multiescala.





ABSTRACT

One of the major challenges faced by reservoir simulation is about
the solution of the linear systems obtained by the discretization
of elliptic equations. This task turns out to be even more com-
plex when highly heterogeneous permeability fields are present.
Different strategies of direct and iterative methods have been
developed in the last years and employed in this context. Consid-
ering the last ones, it’s possible to note that iterative methods
built by multigrid preconditioners are the most employed because
of their robustness and efficiency. In this work, the mathematical
properties and the computational performance of multigrid-like
preconditioners called “multiscale preconditioners” are evaluated.
The studied alternatives are implemented computationally and
employed in conjunction of iterative methods for the precise and
approximate solution of challenging elliptic problems. Given the
tested problems, it was possible to verify that the best configura-
tion properties for a multiscale preconditioner are composed by
a galerkin restriction operator, smoothers based on incomplete
factorization and coarsening ratios around of ten for each direc-
tion of the grid. Several others solutions strategies available in
the scientific package PETSc were evaluated using the same set
of problems as before and it was possible to conclude that the
BoomerAMG preconditioner associated with the conjugate gradi-
ent method as well as the direct method Cholesky-UMFPACK
are the most efficient ones in both mathematical and computa-
tional evaluation points and are even better than the multiscale
preconditioner when the intention is to get a precise solution.

Keywords: reservoir simulation. Multiscale preconditioners. Mul-
tiscale finite volume method.





LISTA DE ILUSTRAÇÕES

Figura 1 – Stencil de sete pontos. . . . . . . . . . . . . . . 56
Figura 2 – Ilustração da matriz de coeficientes. . . . . . . 56
Figura 3 – Fluxograma para resolução do escoamento bi-

fásico. . . . . . . . . . . . . . . . . . . . . . . . 66
Figura 4 – Ilustração da ideia central do upscaling. . . . . 71
Figura 5 – Decomposição LDU da matriz A. . . . . . . . . 83
Figura 6 – Problema teste: logaritmo do campo de perme-

abilidade absoluta - log10(K[mD]). . . . . . . . 99
Figura 7 – Problema teste: malhas envolvidas no MsFVM. 100
Figura 8 – Problema teste: funções base duais. . . . . . . 103
Figura 9 – Problema teste: campo de pressão referente à

malha grosseira. . . . . . . . . . . . . . . . . . 105
Figura 10 – Problema teste: solução para o campo de pressão.105
Figura 11 – Problema teste: linhas de corrente (MsFVM). . 107
Figura 12 – Problema teste: comparação entre linhas de

corrente. . . . . . . . . . . . . . . . . . . . . . . 108
Figura 13 – Problema teste: funções de correção. . . . . . . 110
Figura 14 – Problema teste: particionamento wirebasket. . . 114
Figura 15 – Problema teste: estrutura da matriz de coefi-

cientes original, à esquerda, e reordenada, à
direita. . . . . . . . . . . . . . . . . . . . . . . 116

Figura 16 – Problema teste: estrutura da matriz de coe-
ficientes reordenada, à esquerda, e da matriz
que gera o pré-condicionador multiescala com
funções de correção, à direita. . . . . . . . . . . 117

Figura 17 – Problema teste: estrutura da matriz Aii. . . . . 118
Figura 18 – Problema teste: estrutura da matriz Mee. . . . 118
Figura 19 – Problema teste: estrutura da matriz M?vv. . . . 119
Figura 20 – Problema teste: interpretação para as colunas

da matriz P. . . . . . . . . . . . . . . . . . . . 122
Figura 21 – Problema teste: formato do operador de corre-

ção C. . . . . . . . . . . . . . . . . . . . . . . . 123
Figura 22 – Problema teste: operador de restrição RFV . . . 124
Figura 23 – Problema teste: estrutura da matriz A?. . . . . 131
Figura 24 – Caso 1: campo de permeabilidade. . . . . . . . 137



Figura 25 – Caso 1: solução MsFVM-16x16. . . . . . . . . . 138
Figura 26 – Caso 1: solução MsFVM-32x32. . . . . . . . . . 139
Figura 27 – Caso 1: solução MsFVM-64x64. . . . . . . . . . 139
Figura 28 – Caso 1: linhas de corrente para a solução MsFVM-

64x64. . . . . . . . . . . . . . . . . . . . . . . . 141
Figura 29 – Caso 1: solução MsFEM-16x16. . . . . . . . . . 141
Figura 30 – Caso 1: solução MsFEM-32x32. . . . . . . . . . 142
Figura 31 – Caso 1: solução MsFEM-64x64. . . . . . . . . . 142
Figura 32 – Caso 1: campo de pressão. . . . . . . . . . . . . 144
Figura 33 – Caso 1: tempo dos solvers diretos. . . . . . . . 145
Figura 34 – Caso 1: etapas dos solvers diretos. . . . . . . . 145
Figura 35 – Caso 1: uso de memória pelos solvers diretos. . 146
Figura 36 – Caso 1: convergência dos métodos iterativos de

referência. . . . . . . . . . . . . . . . . . . . . . 147
Figura 37 – Caso 1: convergência dos métodos iterativos de

referência. . . . . . . . . . . . . . . . . . . . . . 148
Figura 38 – Caso 1: autovalores aproximados do operador

pré-condicionado com BoomerAMG. . . . . . . 149
Figura 39 – Caso 1: autovalores aproximados do operador

pré-condicionado com GAMG. . . . . . . . . . 150
Figura 40 – Caso 1: autovalores aproximados do operador

pré-condicionado com ILU(0). . . . . . . . . . . 150
Figura 41 – Caso 1: autovalores aproximados do operador

pré-condicionado com ParaSails. . . . . . . . . 150
Figura 42 – Caso 1: tempos dos métodos iterativos de refe-

rência. . . . . . . . . . . . . . . . . . . . . . . . 151
Figura 43 – Caso 1: memória dos métodos iterativos de

referência. . . . . . . . . . . . . . . . . . . . . . 152
Figura 44 – Caso 1: norma do resíduo pré-condicionado -

MSilu. . . . . . . . . . . . . . . . . . . . . . . . 153
Figura 45 – Caso 1: norma do resíduo real - MSilu. . . . . . 154
Figura 46 – Caso 1: tempos das estratégias MSilu. . . . . . 154
Figura 47 – Caso 1: norma do resíduo pré-condicionado -

MSsor. . . . . . . . . . . . . . . . . . . . . . . . 155
Figura 48 – Caso 1: norma do resíduo real - MSsor. . . . . 156
Figura 49 – Caso 1: tempos das estratégias - MSsor. . . . . 156



Figura 50 – Caso 1: norma do resíduo pré-condicionado -
MShs. . . . . . . . . . . . . . . . . . . . . . . . 157

Figura 51 – Caso 1: norma do resíduo real - MShs. . . . . . 158
Figura 52 – Caso 1: tempos das estratégias - MShs. . . . . 158
Figura 53 – Caso 1: norma do resíduo pré-condicionado. . . 159
Figura 54 – Caso 1: norma do resíduo real. . . . . . . . . . 159
Figura 55 – Caso 1: tempos das estratégias multiescala. . . 160
Figura 56 – Caso 1: uso de memória de diferentes estraté-

gias de solução. . . . . . . . . . . . . . . . . . . 160
Figura 57 – Caso 1: norma do resíduo pré-condicionado da

estratégia MsFEilu1sym variando-se o tama-
nho do problema global. . . . . . . . . . . . . . 161

Figura 58 – Caso 1: norma do resíduo real da estratégia Ms-
FEilu1sym variando-se o tamanho do problema
global. . . . . . . . . . . . . . . . . . . . . . . . 162

Figura 59 – Caso 1: tempos obtidos variando-se o tamanho
do problema global. . . . . . . . . . . . . . . . 163

Figura 60 – Caso 1: espectro do operador pré-condicionado
por MsFEilu1sym-64x64. . . . . . . . . . . . . 163

Figura 61 – Caso 1: picos de memória obtidos variando-se
o tamanho do problema global. . . . . . . . . . 164

Figura 62 – Caso 2: campo de permeabilidade. . . . . . . . 165
Figura 63 – Caso 2: campo de pressão. . . . . . . . . . . . . 166
Figura 64 – Caso 2: linhas de corrente de referência. . . . . 166
Figura 65 – Caso 2: campo de pressão MsFVM-100x100. . . 167
Figura 66 – Caso 2: campo de pressão MsFEM-100x100. . . 168
Figura 67 – Caso 2: campo de pressão MsFVM-160x160. . . 169
Figura 68 – Caso 2: campo de pressão MsFEM-160x160. . . 169
Figura 69 – Caso 2: resíduo real obtido pelo método MsFEilu1sym-

CG. . . . . . . . . . . . . . . . . . . . . . . . . 170
Figura 70 – Caso 2: resíduo real pelo método MsFEssor2sym-

CG. . . . . . . . . . . . . . . . . . . . . . . . . 171
Figura 71 – Caso 2: tempo computacional pela estratégia

MsFEilu1sym-CG. . . . . . . . . . . . . . . . . 172
Figura 72 – Caso 2: resíduo real para as estratégias de re-

ferência. . . . . . . . . . . . . . . . . . . . . . . 172



Figura 73 – Caso 2: espectro aproximado do operador ori-
ginal pré-condicionado com BoomerAMG. . . . 173

Figura 74 – Caso 2: espectro aproximado do operador ori-
ginal pré-condicionado com MsFEilu1sym-40x40.173

Figura 75 – Caso 2: Tempos computacionais das estratégias
de referência. . . . . . . . . . . . . . . . . . . . 174

Figura 76 – Caso 2: pico de memória da estratégia MsFEilu1sym-
CG. . . . . . . . . . . . . . . . . . . . . . . . . 175

Figura 77 – Caso 3: curvas de permeabilidade relativa. . . . 175
Figura 78 – Caso 3: campo de permeabilidade absoluta. . . 176
Figura 79 – Caso 3: tempo de solução de acordo com di-

ferentes tamanhos para o problema na malha
grossa. . . . . . . . . . . . . . . . . . . . . . . . 179

Figura 80 – Caso 3: número de iterações da estratégia MsFEilu1sym3x9-
CG em função do passo de tempo. . . . . . . . 180

Figura 81 – Caso 3: tempo de execução da estratégia MsFEilu1sym3x9-
CG em função do passo de tempo. . . . . . . . 180

Figura 82 – Caso 3: tempo computacional total associado
à execução das estratégias de referência. . . . . 181

Figura 83 – Caso 3: tempo de execução da estratégia MsFEilu1sym3x9-
CG em função do passo de tempo. . . . . . . . 182

Figura 84 – Caso 3: campos de pressão. . . . . . . . . . . . 183
Figura 85 – Caso 3: campos de saturação da fase óleo. . . . 184
Figura 86 – Caso 4: campo de permeabilidade absoluta na

direção “x”. . . . . . . . . . . . . . . . . . . . . 185
Figura 87 – Caso 4: tempos computacionais de acordo com

a estratégia de solução. . . . . . . . . . . . . . 187
Figura 88 – Caso 4: campo de pressão no instante final. . . 188
Figura 89 – Caso 4: campo de saturação de água no instante

final. . . . . . . . . . . . . . . . . . . . . . . . . 188
Figura 90 – Caso 4: campo de saturação de óleo no instante

final. . . . . . . . . . . . . . . . . . . . . . . . . 189
Figura 91 – Caso 4: campo de saturação de gás no instante

final. . . . . . . . . . . . . . . . . . . . . . . . . 189
Figura 92 – Caso 4: produções totais acumuladas de gás,

óleo e água, respectivamente. . . . . . . . . . . 190



LISTA DE TABELAS

Tabela 1 – Métodos de solução diretos. . . . . . . . . . . . 134
Tabela 2 – Pré-condicionadores padrão. . . . . . . . . . . 134
Tabela 3 – Pré-condicionadores do tipo multiescala. . . . . 136
Tabela 4 – Caso 3: propriedades dos poços. . . . . . . . . 176
Tabela 5 – Caso 3: passos de tempo. . . . . . . . . . . . . 177





LISTA DE ALGORITMOS

1 Aplicação da fatoração LU. . . . . . . . . . . . . . . 75
2 GMRes pré-condicionado à esquerda. . . . . . . . . 78
3 CG pré-condicionado à esquerda. . . . . . . . . . . . 79
4 Aplicação de M?1SSOR sobre um vetor. . . . . . . . . 84
5 Aplicação da fatoração ILU. . . . . . . . . . . . . . 85
6 Pré-condicionador CPR . . . . . . . . . . . . . . . . 87
7 Multigrid de dois níveis. . . . . . . . . . . . . . . . . 90





LISTA DE ABREVIATURAS E SIGLAS

AIM Adaptive Implicit Method.

ABF Alternate Block Factorization.

AMG Algebraic Multigrid.

AMS Algebraic Multiscale Solver.

AMD Approximate Minimal Degree.

ASPIN Additive Schwartz Preconditioned Inexact New-
ton.

BiCGStab Biconjugate Gradient Stabilized.

BLAS Basic Linear Algebra Subprograms.

CG Conjugate Gradient.

CGS Conjugate Gradient Squared.

CPU Central Processing Unit.

CPR Constrained Pressure Residual.

DD Domain Decomposition.

DRS Dynamic Row Sum.

FDM Finite Difference Method.

FEM Finite Element Method.

FIM Fully Implicit Method.

FVM Finite Volume Method.

GMRes Generalized Minimal Residual.

GPU Graphics Processing Unit.

HYPRE High Performance Preconditioners.



ILU Incomplete Lower Upper Factorization.

ILUT Incomplete Lower Upper Threshold Factoriza-
tion.

ILUTP Incomplete Lower Upper Threshold Factoriza-
tion with Pivoting.

IMPES Implicit Pressure Explicit Saturation.

LGR Local Grid Refinement.

MMsFEM Mixed Multiscale Finite Element Method.

MMsFVM Mixed Multiscale Finite Volume Method.

MsFEM Multiscale Finite Element Method.

MsFVM Multiscale Finite Volume Method.

MPI Message Parsing Interface.

MRST Matlab Reservoir Simulation Toolkit

ND Nested Dissection.

NNC Non-Neighbour Connection.

ORTHOMIN Orthogonal Minimum Residual.

PETSc Portable Extensible Toolkit for Scientific Com-
puting.

RAM Random Access Memory.

RCM Reverse Cuthill-McKee.

TPFA Two Point Flux Approximation.

SFI Sequential Fully Implicit.

SPD Symmetric Positive Definite.

SSOR Symmetric Successive Overrelaxation.

WDRS Weighted Dynamic Row Sum.



LISTA DE SÍMBOLOS

SÍMBOLOS GREGOS MAIÚSCULOS

? Domínio [?]

?C Domínio referente à malha primal [?]

?D Domínio referente à malha dual [?]

SÍMBOLOS GREGOS MINÚSCULOS

?? Mobilidade referente à fase ? [1/(Pa s)]

? Porosidade [?]

?
j
i função base j referente ao volume de controle i

[?]

?? Densidade da fase ?
[
kg/m3

]
µ? Viscosidade da fase ? [Pa s]

? Fator de relaxação [?]

? Tolerância absoluta para a fatoração incom-
pleta LU [?]

SÍMBOLOS ROMANOS MAIÚSCULOS

A Área
[
m2
]

A Matriz de coeficientes [?]

B? Fator volume de formação da fase ?
[
m3/stdm3

]
Bob Fator volume de formação da fase óleo na pres-

são de ponto de bolha
[
m3/stdm3

]
C Operador de correção [?]



CA Complexidade do operador algébrico [?]

CG Complexidade geométrica [?]

G Matriz de iteração [?]

K Tensor permeabilidade absoluta
[
m2
]

Km Espaço de Krylov de dimensão m [?]

L Matriz triangular inferior [?]

M?1 Inversa da matriz de pré-condicionamento. [?]

Mwn Número de zonas perfuradas do poço n [?]

Nw Número de poços [?]

P Operador de prolongação [?]

P? Operador de projeção na direção ? [?]

Q Matriz de permutação wirebasket [?]

R Operador de restrição [?]

Rl Resíduo referente à iteração l do método de
Newton [?]

Rso Razão de solubilidade do componente gás na
fase óleo

[
stdm3/stdm3

]
S Matriz de suavização [?]

S? Saturação da fase ? [?]

T? Tensor transmissibilidade da fase ? [m d]

T??d Transmissibilidade da fase ? na direção d
[
stdm3/(Pa d)

]
U Matriz triangular superior [?]

V Volume
[
m3
]



SÍMBOLOS ROMANOS MINÚSCULOS

b lado direito do sistema linear [?]

c? Compressibilidade da fase ?
[
Pa?1

]
d Direção (1,2 ou 3) [?]

f? Função fluxo fracionário da fase ? [?]

kr? Permeabilidade relativa da fase ? [?]

p Pressão [Pa]

pcow Pressão capilar água/óleo [Pa]

pcgo Pressão capilar gás/óleo [Pa]

q? Fonte/sumidouro de massa da fase ?
[
kg/(m3 s)

]
q?? Fonte/sumidouro de massa da fase ? [1/s]

r resíduo referente à solução aproximada do sis-
tema linear [?]

rw Raio do poço [m]

re Raio equivalente do poço [m]

x solução aproximada do sistema linear [?]

x? solução exata do sistema linear [?]

z Profundidade [m]

SUBSCRITOS

b Ponto de bolha [?]

bh Fundo de poço [?]

c Nível grosso de malha [?]



o Componente/fase óleo [?]

f Nível fino de malha [?]

g Componente/fase gás [?]

l Nível de iteração [?]

n Instante de tempo [?]

w Componente/fase água [?]

s Condições padrão de temperatura e pressão [?]



SUMÁRIO

1 INTRODUÇÃO . . . . . . . . . . . . . . . . 31
1.1 Motivação . . . . . . . . . . . . . . . . . . . . . 34
1.2 Objetivo Geral . . . . . . . . . . . . . . . . . . 36
1.3 Objetivos Específicos . . . . . . . . . . . . . . . 36
1.4 Organização do Trabalho . . . . . . . . . . . . 37

2 MODELAGEM MATEMÁTICA E NUMÉRICA 39
2.1 Escoamento Trifásico . . . . . . . . . . . . . . 40
2.1.1 Discretização das Equações . . . . . . . . . . . 44
2.1.2 Determinação do Ponto de Bolha . . . . . . . 58
2.2 Escoamento Bifásico . . . . . . . . . . . . . . . 60
2.2.1 Discretização das Equações . . . . . . . . . . . 61
2.3 Escoamento Monofásico . . . . . . . . . . . . . 65

3 SOLUÇÃO DO MODELO MATEMÁTICO . 69
3.1 Upscaling . . . . . . . . . . . . . . . . . . . . . 70
3.2 Solvers Lineares . . . . . . . . . . . . . . . . . . 72
3.2.1 Fatoração LU completa . . . . . . . . . . . . . 74
3.2.2 Método de Richardson . . . . . . . . . . . . . . 75
3.2.3 Método do Resíduo Generalizado Mínimo . . 76
3.2.4 Método do Gradiente Conjugado . . . . . . . . 79
3.3 Pré-Condicionadores . . . . . . . . . . . . . . . 80
3.3.1 Método da Sobre-Relaxação Sucessiva . . . . 82
3.3.2 Fatoração LU Incompleta . . . . . . . . . . . . 84
3.3.3 Constrained Pressure Residual . . . . . . . . . 86
3.3.4 Multigrid Algébrico . . . . . . . . . . . . . . . . 88
3.3.5 Decomposição de Domínio . . . . . . . . . . . 92

4 MÉTODO DOS VOLUMES FINITOS MUL-
TIESCALA - MSFVM . . . . . . . . . . . . . 97

4.1 Funções Base Duais . . . . . . . . . . . . . . . 101
4.2 Problema na Malha Grossa . . . . . . . . . . . 103
4.3 Reconstrução do Campo de Velocidade . . . . 106
4.4 Funções de Correção . . . . . . . . . . . . . . . 108



4.5 Desenvolvimentos Recentes . . . . . . . . . . . 109

5 PRÉ-CONDICIONADOR MULTIESCALA AL-
GÉBRICO . . . . . . . . . . . . . . . . . . . 113

5.1 Operadores de Transferência . . . . . . . . . . 120
5.2 Problema na Malha Grossa . . . . . . . . . . . 125
5.3 Definição do Pré-Condicionador . . . . . . . . 126
5.4 Reconstrução do Campo de Velocidades . . . 129

6 RESULTADOS . . . . . . . . . . . . . . . . . 133
6.1 Caso 1: monofásico 2D . . . . . . . . . . . . . 135
6.1.1 Solução aproximada . . . . . . . . . . . . . . . 137
6.1.2 Métodos diretos . . . . . . . . . . . . . . . . . 143
6.1.3 Métodos iterativos . . . . . . . . . . . . . . . . 146
6.2 Caso 2: escoamento canalizado . . . . . . . . . 164
6.2.1 Solução aproximada . . . . . . . . . . . . . . . 167
6.2.2 Solução precisa . . . . . . . . . . . . . . . . . . 168
6.3 Caso 3: bifásico incompressível 2D . . . . . . . 175
6.3.1 Solução aproximada . . . . . . . . . . . . . . . 177
6.3.2 Solução precisa . . . . . . . . . . . . . . . . . . 178
6.4 Caso 4: teste comparativo SPE 9 . . . . . . . 182

7 CONCLUSÕES . . . . . . . . . . . . . . . . 191
7.1 Sugestões para trabalhos futuros . . . . . . . . 192

Referências . . . . . . . . . . . . . . . . . . . 195

APÊNDICES 219

APÊNDICE A – PARÂMETROS DO MODELO
BLACK-OIL . . . . . . . . 221

A.1 Fase Água . . . . . . . . . . . . . . . . . . . . . 221
A.2 Fase Óleo . . . . . . . . . . . . . . . . . . . . . 221
A.2.1 Estado subsaturado . . . . . . . . . . . . . . . 221
A.2.2 Estado saturado . . . . . . . . . . . . . . . . . 222



A.3 Fase Gás . . . . . . . . . . . . . . . . . . . . . . 222

APÊNDICE B – PRÉ-CONDICIONADOR MUL-
TIESCALA ALGÉBRICO 3D 223





31

1 INTRODUÇÃO

Reservatórios de petróleo são constituídos por formações
rochosas repletas de espaços vazios interconectados entre si atra-
vés dos quais fluidos derivados principalmente de hidrocarbonetos
escoam mediante um diferencial de pressão. A exploração desses
reservatórios envolve diversas etapas entre as quais a de produ-
ção representa uma das fundamentais. Nessa fase, os fluidos são
retirados dos reservatórios através de poços que conectam estes
últimos até a superfície1. Devido a limitações físicas, não é possí-
vel recuperar todo o fluido contido no reservatório, no entanto, é
possível maximizar tal quantidade desde que estratégias eficientes
de explotação sejam implementadas. Uma ferramenta fundamen-
tal para a avaliação dessas técnicas é a simulação do escoamento
em reservatórios. A partir dela, é possível predizer o volume dos
fluidos recuperado em cada um dos poços, bem como sua taxa
de produção, entre outros parâmetros ao longo do tempo. Estes
dados, por sua vez, podem ser utilizados no cálculo do fator de
recuperação, parâmetro fundamental para a análise da eficiência
associada à estratégia de produção adotada.

Nesse contexto, o reservatório costuma ser modelado fi-
sicamente como um meio poroso através do qual fluidos escoam
a baixas velocidades (hipótese de Stokes). Isso permite que tal
variável seja escrita em função da pressão através da lei de Darcy
(KAVIANY, 1995). Esta e outras equações baseadas em princípios
básicos da mecânica dos fluidos como a conservação da massa
e da energia constituem o modelo matemático que representa o
escoamento em reservatórios.

Do ponto de vista matemático, tais equações são classifi-
cadas como diferenciais parciais e podem acoplar mais de uma
incógnita referente ao escoamento como pressão, velocidade e
saturação. Existem situações básicas em que é possível de se
encontrar a solução analítica dessas equações, porém, na maio-
ria dos casos, isso não é possível devido à geometria complexa

1 Na nomenclatura de engenharia de reservatórios, diz-se que o fluido foi
recuperado ou produzido do reservatório.



32 Capítulo 1. Introdução

dos reservatórios bem como aos processos físicos complexos que
sucedem durante o escoamento. Portanto, é comum resolver tais
equações numericamente, isto é, de forma aproximada segundo
algum método numérico como volumes finitos ou elementos finitos.
Por sua vez, a aplicação do método numérico gera um ou mais
sistemas de equações discretizadas possivelmente não-lineares que
são de grande porte e esparsos2.

Na simulação de reservatórios, assim como na maioria
das aplicações envolvendo simulação numérica, a resolução desses
sistemas algébricos representa a maior parte do tempo associado
à execução do código computacional. Em especial, a etapa de
resolução de equações elípticas3, como a empregada para o cálculo
da variável pressão, é a que se mais destaca nessa última parcela.
De fato, uma área muito ativa na simulação de reservatórios, bem
como em outras áreas de engenharia que apresentam problemas
de caráter elíptico, busca propor métodos mais eficientes para
a sua resolução em termos do uso de recursos computacionais
e também de precisão na solução, já que esta pode ser obtida
apenas aproximadamente além de exatamente.

No âmbito de estratégias de solução eficientes, um consi-
derável avanço foi obtido com o advento dos métodos multigrid.
Basicamente, estes são pré-condicionadores utilizados em conjunto
com métodos iterativos responsáveis por empregar cálculos em
vários níveis de malhas com o intuito de eliminar erros de solução
associados a diferentes frequências e acelerar a taxa de convergên-
cia dos métodos iterativos (HACKBUSCH, 1985). Podem-se citar
também os métodos baseados em decomposição de domínio, cuja
ideia fundamental é dividir um problema original em diversos
subproblemas locais de menor tamanho que podem ser resolvidos
paralelamente e cuja solução é empregada para o cálculo da solu-
ção do problema original (SANDVIN, 2012). Ambas estratégias
mencionadas apresentam diversos parâmetros de configuração que
dão origem a diferentes pré-condicionadores para serem utilizados
2 O número de elementos não nulos da matriz é relativamente baixo.
3 Do ponto de vista físico, quando uma variável de caráter elíptico sofre

uma pertubação em determinada posição do domínio, esta propaga-se em
todas as direções de modo possivelmente irregular.



33

em conjunto com solvers iterativos.
Uma outra maneira de se melhorar a eficiência computaci-

onal consiste em reduzir a precisão da solução calculada, porém de
modo que esta possa ainda ser considerada confiável. Dessa forma,
uma quantidade menor de recursos computacionais necessita ser
alocada durante o processo de resolução dos sistemas algébricos
lineares ou possivelmente não-lineares. Essa é justamente a abor-
dagem das técnicas de upscaling, que buscam a construção de um
problema de menor tamanho em relação ao original4(CHRISTIE,
1996). Esse processo é realizado numa etapa anterior à simulação
do escoamento propriamente dita, nele assume-se um comporta-
mento prévio para o escoamento com o intuito de se calcular, para
a malha grosseira, as propriedades físicas da rocha bem como
alguns parâmetros relativos à interação entre rocha e fluido como
pressão capilar e permeabilidade relativa. Devido a tal hipótese
sobre o escoamento, a solução do problema obtido a partir do
upscaling apresenta certo grau de imprecisão em relação àquela
que seria obtida caso o problema original fosse resolvido com alta
precisão.

Reservatórios altamente heterogêneos como os de forma-
ção carbonática, cujo campo de permeabilidade apresenta elevada
variação ao longo do espaço, levam a uma dificuldade adicional
na resolução da equação da pressão. Isso se dá porque tais re-
servatórios exigem o uso de técnicas ainda mais complexas de
upscaling para a obtenção de soluções confiáveis ou ainda solvers
mais robustos, já que o número de condicionamento da matriz ob-
tida no processo de discretização da equação da pressão é elevado
nesses casos, o que prejudica a performance de solvers iterativos.
Além dessa dificuldade, a solução do escoamento nesses casos
pode demandar malhas computacionais com altíssimo número
de incógnitas a ponto de inviabilizá-la devido a limitações de
recursos computacionais.

Uma possível solução para a simulação eficiente do ponto
4 O problema original é normalmente referido como refinado e descrito

de acordo com um modelo geológico, enquanto o problema de menor
tamanho é referido como grosseiro e descrito de acordo com um modelo
de reservatório.



34 Capítulo 1. Introdução

de vista computacional e, ao mesmo tempo, que conduz a uma
solução com grau de precisão adequado consiste no uso de métodos
multiescala. Estes podem ser vistos como tipos especiais de pré-
condicionadores multigrid que tentam capturar a variação do
campo de permeabilidade em nível refinado e utilizá-la no cálculo
de um campo de pressão nessa mesma escala a partir de um
campo de pressão calculado em malha grosseira. Por outro lado,
os métodos multiescala também apresentam uma semelhança forte
com as técnicas de upscaling, uma vez que propõem a resolução
aproximada do problema original a partir da resolução de um
sistema linear em nível grosseiro. No entanto, eles contam com a
vantagem de promover uma captura do campo de permeabilidade
mais fidedigna à física do problema, especialmente nos casos de
simulação transiente, bem como permitir o cálculo de um campo
de pressão e velocidade em nível refinado ao invés de grosseiro
somente, como é o caso no upscaling (KIPPE; AARNES; LIE,
2008).

1.1 MOTIVAÇÃO

Dentre os métodos multiescala, é de especial interesse
o método dos volumes finitos multiescala - Multiscale Finite
Volume Method (MsFVM) - o qual foi desenvolvido recentemente
por Jenny, Lee e Tchelepi (2003). Apesar do nome sugerir que se
trata de uma nova alternativa para a discretização de equações
diferenciais, assim como o método dos volumes finitos ou elementos
finitos, este consiste numa estratégia para a solução aproximada
das equações discretizadas com o método dos volumes finitos,
especialmente da equação da pressão.

O MsFVM pode ser visto como um desenvolvimento na
linha das técnicas de upscaling, uma vez que busca uma solução
aproximada para o problema discretizado através da resolução de
um problema grosseiro. As vantagens observadas nesse método
sobre técnicas usuais de upscaling são basicamente duas:

a) o campo de pressão calculado a partir desse método
conduz a um campo de velocidades conservativo na
malha original do problema, isto é, tal campo obedece



1.1. Motivação 35

à lei da conservação da massa nesse mesmo nível de ma-
lha. Esta característica é fundamental para a resolução
apropriada das equações de transporte como aquelas
destinadas ao cálculo do campo de saturações em es-
coamentos multifásicos. Além disso, o sistema linear
referente ao nível grosseiro é atualizado em proble-
mas transientes, tornando o método bastante robusto
especialmente em problemas altamente heterogêneos;

b) assim como métodos de decomposição de domínio,
o MsFVM divide o problema original em subproble-
mas locais que são independentes entre si e podem ser
resolvidos paralelamente. Isso torna seu algoritmo alta-
mente susceptível ao processamento paralelo. Mesmo
que seja empregado processamento sequencial, o custo
computacional envolvido na resolução desses subpro-
blemas é menor que aquele referente ao problema
original.

Nos últimos anos, produziram-se vários trabalhos com
o intuito de estender a aplicação do MsFVM a problemas de
simulação de reservatórios que apresentam fenômenos físicos di-
versificados. Nesse sentido, nota-se que a aplicação desse método
em simuladores comerciais bem como seu uso para o tratamento
de reservatórios reais tornam-se cada vez mais em pauta (MANEA;
SEWALL; TCHELEPI, 2015). Um dos aperfeiçoamentos mais
significativos deu-se com a concepção da formulação algébrica
do método, assim como sua extensão para a esfera de métodos
iterativos voltados à solução do problema de acordo com o ní-
vel de precisão que se queira. Nesse último contexto, o MsFVM
dá origem aos pré-condicionadores multiescala algébricos, que
possuem diversos parâmetros de configuração e são empregados
para a resolução de sistemas lineares elípticos através de métodos
iterativos.



36 Capítulo 1. Introdução

1.2 OBJETIVO GERAL

Dadas as vantagens e a relevância observada pelo MsFVM
bem como pela sua formulação algébrica como um pré-condicionador
voltado à resolução de problemas elípticos, o presente trabalho
apresenta como objetivo principal a implementação computacio-
nal de ambas estratégias para a resolução da equação da pressão
em simulação de reservatórios altamente heterogêneos.

1.3 OBJETIVOS ESPECÍFICOS

Dado o foco de estudo, os seguintes objetivos particulares
são determinados:

a) Avaliar o desempenho computacional do código de-
senvolvido para a resolução de escoamentos monofási-
cos, bifásico e também trifásicos em malhas estrutu-
radas. Considera-se aqui tanto a formulação original
do MsFVM para a obtenção de soluções aproximadas
assim como o seu uso como um pré-condicionador ali-
ado à métodos iterativos para a obtenção de soluções
precisas.

b) Considerando-se o uso dos métodos multiescala como
pré-condicionadores de solvers iterativos empregados
na resolução precisa de problemas lineares elípticos,
avalia-se também seu desempenho matemático, isto
é, em termos da taxa de convergência observada pelo
método iterativo resultante.

c) Aferir o melhor uso que pode ser feito dos métodos
multiescala: como um pré-condicionador associado a
métodos iterativos ou como uma técnica de upsca-
ling para a obtenção de uma solução aproximada do
problema.

d) Encontrar a melhor combinação possível de parâmetros
para a definição de pré-condicionadores multiescala
eficientes.



1.4. Organização do Trabalho 37

e) Prover uma plataforma unificada para testar diferentes
estratégias de pré-condicionamento e avaliar a melhor
opção em termos de taxa de convergência, exatidão dos
resultados, tempo computacional e uso de memória.

1.4 ORGANIZAÇÃO DO TRABALHO

O primeiro capítulo desse trabalho buscou contextualizá-
lo na área de simulação de reservatórios e apresentar seu objetivo.
No segundo capítulo, as equações responsáveis pela modelagem do
escoamento em reservatórios serão apresentadas, bem como seu
formato discretizado de acordo com o método dos volumes finitos
tradicional5. No terceiro capítulo serão discutidos os métodos
comumente empregados para a solução das equações discretizadas.
No quarto capítulo apresenta-se a formulação original do método
dos volumes finitos multiescala, que é baseada em argumentos de
caráter físico. No quinto capítulo, discute-se a formulação algé-
brica desse método bem como os pré-condicionadores que podem
ser construídos a partir de sua ideia básica. No sexto capítulo,
tais estratégias de solução serão testadas em problemas sintéticos,
assim como em um problema padrão bastante desafiador, o qual é
comumente empregado no benchmarking de novas técnicas de solu-
ção. Por fim, no último capítulo serão apresentadas as conclusões
do presente trabalho e sugestões para pesquisas futuras.

5 A malha empregada é estruturada e o cálculo dos fluxos nas fronteiras
dos volumes de controle é feito de acordo com um esquema de dois pontos
(TPFA).





39

2 MODELAGEM MATEMÁTICA E NUMÉRICA

A modelagem matemática do escoamento em reservatórios
de petróleo é realizada por um conjunto de equações diferenci-
ais parciais baseadas nas leis de conservação de massa, espécie,
quantidade de movimento e energia além de relações de fecha-
mento, necessárias para que o número de incógnitas do modelo
se iguale ao número de equações. De modo geral, tais equações
descrevem as relações existentes entre variáveis do escoamento
como pressão, temperatura, saturação e composição das fases em
função das propriedades físicas da rocha-reservatório, dos fluidos
e das propriedades físicas relativas à interação entre a rocha e os
fluidos.

Duas grandes classes de modelos podem ser empregadas
de acordo com o tipo de escoamento presente no reservatório:
composicional e black-oil. Em ambos os modelos, o escoamento
pode apresentar até três fases sendo elas: aquosa, oleosa e gasosa.
A diferença básica entre essas duas escolhas consiste no número
de informações que se deseja obter do escoamento, sendo que os
modelos composicionais são mais minuciosos.

Nos modelos composicionais (ACS; DOLESCHALL; FAR-
KAS, 1986; TRANGENSTEIN; BELL, 1989; COATS; THOMAS;
PIERSON, 1998; QIN; EWING; CHEN, 2000), as fases oleosa
e gasosa contém diversos hidrocarbonetos de diferentes massas
moleculares. É de interesse a descrição detalhada do escoamento
desses componentes, isto é, como eles se propagam ao longo do re-
servatório bem como o cálculo de sua fração volumétrica presente
nessas fases, realizado através de modelos baseados em equilí-
brio termodinâmico. Os modelos composicionais são largamente
empregados quando a produção de óleo envolve métodos de recu-
peração avançada (LAKE, 2010), um exemplo é a injeção de gás
carbônico em determinadas áreas do reservatório com o intuito
de armazenar o gás e também deslocar o óleo em direção a poços
produtores.

Quando o grau de volatilidade do óleo é baixo, o compor-
tamento das fases torna-se menos complexo e o uso do modelo
composicional completo deixa de ser necessário para a modelagem



40 Capítulo 2. Modelagem Matemática e Numérica

precisa do escoamento. Nesse caso, o sistema pode ser representado
em termos do componente água mais dois pseudo-componentes
com característica de hidrocarbonetos, designados por óleo e gás,
o que dá origem ao modelo black-oil (AZIZ; SETTARI, 1979).

Na sua forma mais geral, esse modelo permite que todos os
componentes estejam presentes em qualquer uma das fases aquosa,
oleosa ou gasosa. No entanto, aplicações usuais geralmente não
requerem um grau de mobilidade tão elevado para os componentes,
portanto os simuladores de reservatórios costumam empregar duas
variantes simplificadas do modelo black-oil: padrão e volátil.

No black-oil padrão, permite-se que somente o componente
gás mude de fase e tal mudança pode ser apenas entre as fases
oleica e gasosa. Naturalmente, as fases aquosa, oleica e gasosa
são formadas pelos componentes água, óleo e gás. Já no modelo
black-oil volátil, o componente óleo pode estar presente na fase
gasosa, além de estar naturalmente presente na fase oleica.

Nesse trabalho, emprega-se o modelo black-oil padrão
para a simulação do escoamento em reservatórios de petróleo. No
presente capítulo, serão apresentadas as equações que compõem
tal modelo bem como simplificações que podem ser obtidas no
caso de escoamentos bifásico e monofásico. Informações mais deta-
lhadas a respeito da modelagem do escoamento em reservatórios
e sua resolução podem ser encontradas nos trabalhos de (AZIZ;
SETTARI, 1979; PEACEMAN, 1983; CHEN, 2007).

2.1 ESCOAMENTO TRIFÁSICO

No modelo black-oil padrão, as equações que governam o
escoamento em reservatórios são obtidas, basicamente, a partir do
princípio da conservação da quantidade de massa aplicada a cada
um dos componentes verificados no escoamento. É importante
observar que a massa é conservada na fase aquosa, porém o mesmo
não pode ser afirmado para as fases oleosa e gasosa, uma vez
que o componente gás pode transitar entre elas (CHEN, 2007).
Considerando que a temperatura do reservatório é constante, o



2.1. Escoamento Trifásico 41

conjunto de equações que formam o modelo é dado a seguir:

?

?t
(??wSw) = ?· (?w~uw) + qw, (2.1a)

?

?t
(??ooSo) = ?· (?oo~uo) + qo, (2.1b)

?

?t
(? (?goSo + ?gSg)) = ?· (?go~uo + ?g~ug) + qg, (2.1c)

pcow (Sw) = po ?pw, (2.1d)

pcgo (Sg) = pg ?po, (2.1e)

Sw + So + Sg = 1. (2.1f)

Ao todo, tem-se seis equações para o cálculo da pressão e
saturação referentes às fases água, óleo e gás, isto é: Pw; Po; Pg;
Sw; So; Sg. Nas equações (2.1a) a (2.1c), a variável ?? representa a
massa específica do componente ? pertencente à fase ?, enquanto
??? refere-se à massa específica do componente ? pertencente à
fase ?. Já a variável ? denota a porosidade da rocha, a qual pode
variar ao longo da simulação de acordo com a relação

? = ?o (1 + cR (p?po)) , (2.2)

em que ?o é a porosidade medida na pressão de referência po
e cR é o fator de compressibilidade da rocha. Na presença de
efeitos capilares, as fases podem apresentar diferentes valores
para pressão no equilíbrio termodinâmico, tal efeito é modelado
pelas pressões capilares água/óleo e gás/óleo, de acordo com as
funções (2.1d) e (2.1e), as quais são informadas através de tabelas
em função das saturações. Por fim, a equação (2.1f) realiza o
fechamento do problema ao impor uma restrição para o cálculo
das saturações.

O primeiro termo do lado direito das equações (2.1a) a
(2.1c) modela o transporte de massa no reservatório por advecção,
isso envolve a velocidade da fase que é transportada: ~u?. Em
escoamentos ao longo de meios porosos, esse termo é usualmente



42 Capítulo 2. Modelagem Matemática e Numérica

escrito como

~u? =
k?
µ?

(?p? ???g?z) , ? = w,o,g. (2.3)

Esta é chamada por lei de Darcy (DAKE, 1978), a qual pode
ser obtida simplificando-se a lei da conservação da quantidade de
movimento para o caso de escoamentos a baixas velocidades em
meios porosos (hipótese de Stokes) (WHITAKER, 1986).

O modelo black-oil padrão pode ser também escrito em
termos de conservação volumétrica, nesse caso as equações (2.1a)
a (2.1c) são substituídas por:

?

?t

(
?Sw
Bw

)
= ?· (K?w [?pw ??w?z]) +

qws
Bw

, (2.4a)

?

?t

(
?So
Bo

)
= ?· (K?o [?po ??o?z]) +

qos
Bw

, (2.4b)

?

?t

[
?

(
Sg
Bg

+
RsoSo
Bo

)]
=
qgs
Bg

+
Rsoqos
Bo

+ ?· (K?g [?pg ??g?z] + RsoK?o [?po ??o?z]) ,
(2.4c)

em que o tensor K é a permeabilidade absoluta da rocha-reservatório
e a variável B? é denominada fator volume de formação da fase
?, sendo dada por:

Bw =
?ws
?w

, ?ws = ?w (1 atm, 20 ?C) , (2.5a)

Bg =
?gs
?g
, ?gs = ?g (1 atm, 20 ?C) , (2.5b)

Bo =
Rso?gs + ?os

?o
, ?os = ?o (1 atm, 20 ?C) . (2.5c)

Na equação (2.5c), Rso representa a razão de solubilidade
do componente gás na fase óleo. Esta variável é função da pressão.
Tal variável é definida como o volume do gás, medido nas con-
dições padrão de temperatura e pressão (P = 1 atm,T = 20 ?C),



2.1. Escoamento Trifásico 43

dissolvido em uma unidade volumétrica de óleo nas condições de
temperatura e pressão do reservatório.

Rso =
Vgs
Vos

. (2.6)

Presente no lado direito das equações (2.4a) a (2.4c), o
termo ?? é chamado de mobilidade da fase ?. Este é responsável
por medir a facilidade com que a fase ? escoa no reservatório,
sendo definido a seguir:

?? =
kr?
µ?B?

, (2.7)

em que kr? é a permeabilidade relativa à fase ? e µ? sua vis-
cosidade dinâmica. Expressões típicas para as permeabilidade
relativas kr? como função da saturação podem ser encontradas
em Chen (2007). No presente trabalho, utiliza-se o modelo de
Stone II, descrito no apêndice A.

Por último, as taxas volumétricas nas condições padrão
de cada fase são relacionadas com as taxas nas condições de
reservatório da seguinte forma:

qws =
Bwqw
?ws

, (2.8a)

qos =
Boqo
?os

, (2.8b)

qgs =
Bgqg
?gs

?
BgRsoqo
?os

. (2.8c)

Através desses termos, é possível modelar a ação de po-
ços injetores e produtores em reservatórios conforme a seguintes
equação:

q?s =
Nw?
n=1

Mwn?
m=1

WInm
kr?
µ?

[
pnbh ?p? ??? (z

n
bh ?z)

]
? (~x?~xnm) ,

? = w,o,g,
(2.9)



44 Capítulo 2. Modelagem Matemática e Numérica

em que, o índice de poço é dado por

WInm =
2?k??h

ln (re/rw)

?????
n

m

; (2.10)

? (~x) é a função delta de Dirac; Nw é o número total de poços;
Mwn é o número total de volumes de controle que o n-ésimo
poço atravessa; ?hnm e ~xnm são o comprimento e a posição central
do segmento do poço que atravessa o volume de controle m; a
quantidade k?m é a permeabilidade absoluta média do volume m;
rnw é o raio do n-ésimo poço; rne,m é o raio de drenagem e pnbh é a
pressão de fundo de poço.

De acordo com o modelo de Peaceman (1983), a perme-
abilidade média k?m é dada por

?
k11k22, em que 1 e 2 são as

direções perpendiculares ao poço. Além disso, o raio de drenagem
rne,m é dado por:

rne,m =
0.14

?(
k22
k11

)
h21 +

(
k11
k22

)
h22

0.5
[(

k22
k11

)1/4
+
(
k11
k22

)1/4] , (2.11)
onde considera-se que as completações do poço interceptam o
centro do volume de controle do reservatório.

Por fim, o fechamento do modelo é realizado através da
especificação das condições de contorno e inicial. As primeiras di-
zem respeito ao valor da pressão e das saturações nas fronteiras do
reservatório, enquanto a segunda diz respeito à distribuição dessas
variáveis no instante inicial da simulação. Em geral, adotou-se
nesse trabalho que as fronteiras do reservatório são impermeáveis,
isto é, a componente normal das derivadas da pressão e saturações
são nulas. Além disso, adotou-se que a distribuição inicial dos
campos de pressão e saturação é especificada como parâmetro de
entrada na simulação.

2.1.1 Discretização das Equações

Conforme mostrado anteriormente, a modelagem mate-
mática do escoamento em reservatórios envolve a resolução de



2.1. Escoamento Trifásico 45

equações baseadas em princípios de conservação. Tais equações
são do tipo diferencial, isto é, envolvem derivadas das próprias
incógnitas que se deseja encontrar. Em geral, elas não podem ser
resolvidas analiticamente, portanto recorre-se a métodos numéri-
cos para a obtenção da sua solução aproximada.

Diversos métodos numéricos podem ser empregados na
simulação de reservatórios, o mais antigo e primeiro a ser utili-
zado na construção de simuladores foi o método das diferenças
finitas - Finite Difference Method (FDM) (AZIZ; SETTARI, 1979;
PEACEMAN, 1977). Este propõe aproximações para as derivadas
de primeira e segunda ordem das incógnitas presentes no modelo
em função de seus valores em determinados pontos ao longo da
malha. Sua grande vantagem está na versatilidade em apresentar
aproximações com diferentes graus de precisão, o que é realizado
de acordo com o número de pontos utilizados no cálculo das de-
rivadas. No entanto, o método carece de um apelo físico, pois a
solução que é proposta por ele não atende, em geral, aos princípios
de conservação, característica altamente desejável para a solução
de problemas de caráter hiperbólico como é o caso das equações
envolvendo saturação. Além disso, sua aplicação se restringe a
malhas estruturadas e de geometrias simples.

Largamente aplicado em problemas estruturais como na
geomecânica, os métodos baseados em elementos finitos - Finite
Element Method (FEM) - também podem ser empregados na
simulação do escoamento em reservatórios (CHEN; HUAN; MA,
2006). Na sua formulação mais comum, baseada em Galerkin, as
equações diferenciais são reescritas na forma fraca e sua solução é
aproximada segundo um conjunto de funções bases contínuas no
espaço. Em relação ao FDM, o FEM apresenta maior versatilidade
a respeito dos tipos de malhas e geometria do reservatório que
são suportados, o que estimula seu uso em casos de reservatórios
complexos. No entanto, assim como o FDM, o método não observa
os princípios de conservação. Outras formulações do FEM como
a mista - Mixed Finite Element Method (MixedFEM) (ARNOLD,
1990) - ou a baseada em Galerkin descontínuo - Discontinuous
Galerkin (ARNOLD et al., 2002) - atendem ao princípio da con-
servação local, no entanto isso é alcançado às custas de maior



46 Capítulo 2. Modelagem Matemática e Numérica

número e complexidade de equações referentes ao modelo discreto.
Métodos baseados em volumes finitos - Finite Volume

Method (FVM) - receberam bastante atenção e hoje são utili-
zados pela maioria dos simuladores comerciais de reservatórios.
Essa classe de métodos tem como característica fundamental a
observância dos princípios de conservação em nível discreto, os
quais são atendido através do cálculo apropriado de fluxos de
massa, quantidade de movimento e energia através das interfaces
dos volumes de controle que compõem a malha computacional.
Além disso, tais métodos permitem a resolução do escoamento
em reservatórios com geometrias complexas. Em sua formulação
tradicional, o método dos volumes finitos é restrito a malhas de to-
pologia estruturada ou semi-estruturada1, nesse sentido é comum
o emprego de malhas do tipo corner-point (POINTING, 1989).
Recentemente, o FVM foi estendido para malhas não-estruturadas
através da sua formulação baseada em elementos (FORSYTH,
1990; MALISKA, 2004) - Element Based Finite Volume Method
(EbFVM) - o que conferiu ainda maior versatilidade à essa classe
de métodos para o tratamento de reservatórios que exibam aspec-
tos físicos mais avançados como aqueles apresentando falhas ou
fraturas.

Pelo fato de ser o método mais difundido em simulação
de reservatórios e também atender ao princípio da conservação
de massa em nível local, emprega-se nesse trabalho o método
dos volumes finitos tradicional no processo de discretização das
equações diferenciais. Para tanto, será utilizada a implementação
numérica contida no pacote MRST - Matlab Reservoir Simulation
Toolkit - cuja validação computacional pode ser verificada nos
trabalhos escritos por Lie et al. (2012) e Krogstad et al. (2015).

Considerando-se que o tensor permeabilidade é diago-
nal, isto é K = diag (K11,K22,K33), as equações (2.4a) a (2.4c)

1 Quando há ligações com não-vizinhos - Non-Neighbour Connections
(NNC); refinamento local da malha - Local Grid Refinement (LGR) -
e células de volume nulo (pinch-outs).



2.1. Escoamento Trifásico 47

podem ser escritas da seguinte forma:

?

?t

(
?Sw
Bw

)
=

?

?x1

[
K11?w

(
?pw
?x1
??w

?z

?x1

)]
+

?

?x2

[
K22?w

(
?pw
?x2
??w

?z

?x2

)]
+

?

?x3

[
K33?w

(
?pw
?x3
??w

?z

?x3

)]
+ q?ws,

(2.12)

?

?t

(
?So
Bo

)
=

?

?x1

[
K11?o

(
?po
?x1
??o

?z

?x1

)]
+

?

?x2

[
K22?o

(
?po
?x2
??o

?z

?x2

)]
+

?

?x3

[
K33?g

(
?po
?x3
??o

?z

?x3

)]
+ q?os,

(2.13)

?

?t

[
?

(
Sg
Bg

+
RsoSo
Bo

)]
=

?

?x1

[
K11?g

(
?pg
?x1
??g

?z

?x1

)]
+

?

?x2

[
K22?g

(
?pg
?x2
??g

?z

?x2

)]
+

?

?x3

[
K33?g

(
?pg
?x3
??g

?z

?x3

)]
+

?

?x1

[
K11Rso?o

(
?po
?x1
??o

?z

?x1

)]
+

?

?x2

[
K22Rso?o

(
?po
?x2
??o

?z

?x2

)]
+

?

?x3

[
K33Rso?o

(
?pg
?x3
??o

?z

?x3

)]
+ q?gs.

(2.14)

As variáveis presentes nas equações anteriores são funções
do tempo e espaço, portanto é necessário que esquemas de dis-
cretização nessas dimensões sejam empregados. Com relação à
discretização no tempo, diversas formulações numéricas estão dis-
poníveis, entre as mais empregadas estão a formulação totalmente



48 Capítulo 2. Modelagem Matemática e Numérica

implícita (FIM), implícita na pressão e explícita na saturação
(IMPES) e adaptativa implícita (AIM).

Na formulação totalmente implícita - Fully Implicit Method
(FIM) (DOUGLAS; PEACEMAN; JR., 1959) - as propriedades
da rocha e dos fluidos são avaliadas no tempo atual e o sistema de
equações discretizadas são resolvidas simultaneamente. As variá-
veis obtidas diretamente através da solução dessas equações são
denominadas como primárias. Esta é uma formulação bastante
robusta e sua estabilidade depende fundamentalmente do controle
das não-linearidades presentes no sistema, no entanto, ela requer o
uso de pré-condicionadores projetados de acordo com o problema
resolvido para que a solução das equações possa ser encontrada
de modo eficiente em termos computacionais.

A formulação implícita na pressão e explícita na satu-
ração - IMplicit Pressure Explicit Saturation (IMPES) (AZIZ;
SETTARI, 1979) - é baseada no desacoplamento entre as variá-
veis pressão e saturação. A variável pressão é resolvida através da
solução de um sistema linear, assumindo-se que as propriedades
dos fluidos dependentes da saturação são avaliadas de acordo com
a saturação relativa ao passo de tempo anterior, enquanto que as
propriedades que são função da pressão são avaliadas de acordo
com o valor referente à última iteração do método de Newton.
Em seguida, a variável saturação é atualizada explicitamente, isto
é, através da simples multiplicação de uma matriz por um vetor.
Esse procedimento é repetido a cada passo de tempo e também
a cada iteração do método de Newton conforme um critério de
convergência.

Por último, a formulação adaptativa implícita -Adaptative
Implicit Method (AIM) (THOMAS; THURNAU, 1983) - é uma
mistura das duas últimas. A motivação fundamental dessa abor-
dagem consiste no fato de que as variáveis referentes a diferentes
volumes de controle da malha estão sujeitas a variações distintas
ao longo do tempo. Caso tais variações sejam menores que uma
dada tolerância, que é função da variável primária em considera-
ção, o cálculo de saturações ou composições pode ser realizado
explicitamente. As vantagens dessa formulação consistem na re-
dução do tamanho do sistema algébrico a ser resolvido em relação



2.1. Escoamento Trifásico 49

à formulação totalmente implícita e também no aumento de es-
tabilidade em relação à formulação IMPES (FUNG; COLLINS;
NGHIEM, 1989; WATTS; SHAW, 2005; BO; WHEELER, 2009).

É importante observar que em qualquer uma das formu-
lações discutidas, é necessário que se resolva uma equação de
caráter elíptico. Isso é válido até mesmo no caso da formula-
ção totalmente implícita, porque nesse caso é comum o emprego
de pré-condicionadores que desacoplam os diferentes fenômenos
físicos modelados pelo sistema linear obtido no processo de dis-
cretização. Os problemas tratados no capítulo de resultados são
resolvidos a partir das formulações implícita e IMPES. Nessa
seção, apresenta-se somente a discretização espacial e temporal
das equações discretizadas pela primeira formulação. O segundo
caso pode ser obtido a partir do primeiro, porém, se o leitor deseja
obter mais informações a respeito desse caso, este é referido para
o trabalho de Chen (2007).

Se há presença de gás livre no reservatório, isto é Sg 6= 0,
diz-se que o reservatório encontra-se em estado saturado, caso con-
trário, todo gás encontra-se dissolvido na fase óleo e o reservatório
encontra-se em estado subsaturado. As variáveis primárias que
serão resolvidas através das equações (2.12) a (2.14) são distintas
de acordo com o estado do reservatório. Variáveis secundárias são
obtidas sem a necessidade de resolução de sistemas algébricos e
diretamente a partir das variáveis primárias.

No caso de estado saturado, as variáveis primárias são
(p = po,Sw,So), enquanto as variáveis secundárias são obtidas da
seguinte maneira:

Sg = 1 ?Sw ?So, (2.15a)
pw = po ?pcow (Sw) , (2.15b)
pg = po + pcgo (Sg) . (2.15c)

A título de simplificar a expressão discreta, define-se a
transmissibilidade da seguinte maneira:

T??d =
AdKdd??

hd
, d = 1,2,3; ? = w,o,g. (2.16)



50 Capítulo 2. Modelagem Matemática e Numérica

Considerando aproximação de segunda ordem no espaço e primeira
ordem no tempo, a discretização das equações (2.12) a (2.14) é
dada por:

?VP
?t

[(
?Sw
Bw

)n+1
?
(
?Sw
Bw

)n]
P

=

T?n+1w1,e

(
pn+1E ?p

n+1
P

)
? T?n+1w1,w

(
pn+1P ?p

n+1
W

)
+T?n+1w2,n

(
pn+1N ?p

n+1
P

)
? T?n+1w2,s

(
pn+1P ?p

n+1
S

)
+T?n+1w3,t

(
pn+1T ?p

n+1
P

)
? T?n+1w3,b

(
pn+1P ?p

n+1
B

)
?T?n+1w1,e

(
pn+1cow,E ?p

n+1
cow,P

)
+ T?n+1w1,w

(
pn+1cow,P ?p

n+1
cow,W

)
?T?n+1w2,n

(
pn+1cow,N ?p

n+1
cow,P

)
+ T?n+1w2,s

(
pn+1cow,P ?p

n+1
cow,S

)
?T?n+1w3,t

(
pn+1cow,T ?p

n+1
cow,P

)
+ T?n+1w3,b

(
pn+1cow,P ?p

n+1
cow,B

)
?
(
T?w1?w

)n+1
e

(zE ?zP ) +
(
T?w1?w

)n+1
w

(zP ?zW )

?
(
T?w2?w

)n+1
n

(zN ?zP ) +
(
T?w2?w

)n+1
s

(zP ?zS)

?
(
T?w3?w

)n+1
t

(zT ?zP ) +
(
T?w3?w

)n+1
b

(zP ?zB) + q?n+1w,P ?VP ;
(2.17)

?VP
?t

[(
?So
Bo

)n+1
?
(
?So
Bo

)n]
P

=

T?n+1o1,e

(
pn+1E ?p

n+1
P

)
? T?n+1o1,w

(
pn+1P ?p

n+1
W

)
+T?n+1o2,n

(
pn+1N ?p

n+1
P

)
? T?n+1o2,s

(
pn+1P ?p

n+1
S

)
+T?n+1o3,t

(
pn+1T ?p

n+1
P

)
? T?n+1o3,b

(
pn+1P ?p

n+1
B

)
?
(
T?o1?o

)n+1
e

(zE ?zP ) +
(
T?o1?o

)n+1
w

(zP ?zW )

?
(
T?o2?o

)n+1
n

(zN ?zP ) +
(
T?o2?o

)n+1
s

(zP ?zS)

?
(
T?o3?o

)n+1
t

(zT ?zP ) +
(
T?o3?o

)n+1
b

(zP ?zB) + q?n+1o,P ?VP ;
(2.18)



2.1. Escoamento Trifásico 51

?VP
?t

?
?(?Sg

Bg
+
?RsoSo
Bo

)n+1
?
(
?Sg
Bg

+
?RsoSo
Bo

)n??
P

=

T?n+1g1,e

(
pn+1E ?p

n+1
P

)
? T?n+1g1,w

(
pn+1P ?p

n+1
W

)
+T?n+1g2,n

(
pn+1N ?p

n+1
P

)
? T?n+1g2,s

(
pn+1P ?p

n+1
S

)
+T?n+1g3,t

(
pn+1T ?p

n+1
P

)
? T?n+1g3,b

(
pn+1P ?p

n+1
B

)
+T?n+1g1,e

(
pn+1cgo,E ?p

n+1
cgo,P

)
? T?n+1g1,w

(
pn+1cgo,P ?p

n+1
cgo,W

)
+T?n+1g2,n

(
pn+1cgo,N ?p

n+1
cgo,P

)
? T?n+1g2,s

(
pn+1cgo,P ?p

n+1
cgo,S

)
+T?n+1g3,t

(
pn+1cgo,T ?p

n+1
cgo,P

)
? T?n+1g3,b

(
pn+1cgo,P ?p

n+1
cgo,B

)
+
(
RsoT?o1

)n+1
e

(
pn+1E ?p

n+1
P

)
?
(
RsoT?g1

)n+1
w

(
pn+1P ?p

n+1
W

)
+
(
RsoT?o2

)n+1
n

(
pn+1N ?p

n+1
P

)
?
(
RsoT?g2

)n+1
s

(
pn+1P ?p

n+1
S

)
+
(
RsoT?o3

)n+1
t

(
pn+1T ?p

n+1
P

)
?
(
RsoT?g3

)n+1
b

(
pn+1P ?p

n+1
B

)
?
(
T?g1?g + RsoT?o1?o

)n+1
e

(zE ?zP )

+
(
T?g1?g + RsoT?o1?o

)n+1
w

(zP ?zW )

?
(
T?g2?g + RsoT?o2?o

)n+1
n

(zN ?zP )

+
(
T?g2?g + RsoT?o2?o

)n+1
s

(zP ?zS)

?
(
T?g3?g + RsoT?o3?o

)n+1
t

(zT ?zP )

+
(
T?g3?g + RsoT?o3?o

)n+1
b

(zP ?zB)

+q?n+1g,P ?VP .
(2.19)

No cálculo das transmissibilidades nas faces dos volumes
de controle, é necessário o uso de algum esquema de interpolação,
uma vez que os valores das incógnitas do sistema representam
valores médios ao longo desses volumes. Cada termo que compõe
a transmissibilidade é calculada de maneira distinta: a perme-



52 Capítulo 2. Modelagem Matemática e Numérica

abilidade absoluta da rocha e as propriedades dos fluidos são
calculadas a partir das média harmônica e aritmética, respectiva-
mente, entre os valores relativos aos volumes que compartilham a
mesma face. Enquanto isso, a permeabilidade relativa é calculada
a partir do esquema upwind.

As equações (2.17) a (2.19) são não-lineares, pois seus
coeficientes dependem das próprias incógnitas que se deseja encon-
trar. Tais equações são comumente resolvidas através de um pro-
cesso de linearização, conforme proposto pelo método de Newton-
Raphson2. Em cada iteração do método, as variáveis primárias
referentes ao passo de tempo n + 1 do volume de controle P são
escritas como

pl+1P = p
l
P + ?p

l+1
P ; (2.20a)

Sl+1w,P = S
l
w,P + ?S

l+1
w,P ; (2.20b)

Sl+1o,P = S
l
o,P + ?S

l+1
o,P , (2.20c)

em que o índice n + 1 foi omitido propositalmente, a título de
economia de notação. Os resíduos das equações (2.17) a (2.19)

2 Recentemente, o multigrid não-linear - Full Approximation Scheme (FAS)
- (HENSON, 2003) e o método de Newton inexato precondicionado com o
método Schwarz aditivo (ASPIN) (SUN; KEYES; LIU, 2013) têm recebido
bastante atenção como alternativas para o método de Newton tradicional.



2.1. Escoamento Trifásico 53

são escritos como:

Rlw,P =
?VP
?t

[(
?Sw
Bw

)l
?
(
?Sw
Bw

)n]
P

?T? lw1,e
(
plE ?p

l
P

)
+ T? lw1,w

(
plP ?p

l
W

)
?T? lw2,n

(
plN ?p

l
P

)
+ T? lw2,s

(
plP ?p

l
S

)
?T? lw3,t

(
plT ?p

l
P

)
+ T? lw3,b

(
plP ?p

l
B

)
+T?n+1w1,e

(
pn+1cow,E ?p

n+1
cow,P

)
? T?n+1w1,w

(
pn+1cow,P ?p

n+1
cow,W

)
+T?n+1w2,n

(
pn+1cow,N ?p

n+1
cow,P

)
? T?n+1w2,s

(
pn+1cow,P ?p

n+1
cow,S

)
+T?n+1w3,t

(
pn+1cow,T ?p

n+1
cow,P

)
? T?n+1w3,b

(
pn+1cow,P ?p

n+1
cow,B

)
+
(
T?w1?w

)n+1
e

(zE ?zP ) ?
(
T?w1?w

)n+1
w

(zP ?zW )

+
(
T?w2?w

)n+1
n

(zN ?zP ) ?
(
T?w2?w

)n+1
s

(zP ?zS)

+
(
T?w3?w

)n+1
t

(zT ?zP ) ?
(
T?w3?w

)n+1
b

(zP ?zB)

?q?n+1w,P ?VP ;
(2.21)

Rlo,P =
?VP
?t

[(
?So
Bo

)l
?
(
?So
Bo

)n]
P

?T? lo1,e
(
pn+1E ?p

n+1
P

)
+ T?n+1o1,w

(
plP ?p

n+1
W

)
?T? lo2,n

(
pn+1N ?p

n+1
P

)
+ T?n+1o2,s

(
plP ?p

n+1
S

)
?T? lo3,t

(
pn+1T ?p

n+1
P

)
+ T?n+1o3,b

(
plP ?p

n+1
B

)
+
(
T?o1?o

)l
e

(zE ?zP ) ?
(
T?o1?o

)l
w

(zP ?zW )

+
(
T?o2?o

)l
n

(zN ?zP ) ?
(
T?o2?o

)l
s

(zP ?zS)

+
(
T?o3?o

)l
t
(zT ?zP ) ?

(
T?o3?o

)l
b
(zP ?zB) ? q?n+1o,P ?VP ;

(2.22)



54 Capítulo 2. Modelagem Matemática e Numérica

Rlg,P =
?VP
?t

?
?(?Sg

Bg
+
?RsoSo
Bo

)l
?
(
?Sg
Bg

+
?RsoSo
Bo

)n??
P

?
(
T?g1 + RsoT?o1

)l
e

(
plE ?p

l
P

)
+
(
T?g1 + RsoT?o1

)l
w

(
plP ?p

l
W

)
?
(
T?g1 + RsoT?o1

)l
n

(
plN ?p

l
P

)
+
(
T?g1 + RsoT?o1

)l
s

(
plP ?p

l
S

)
?
(
T?g1 + RsoT?o1

)l
t

(
plT ?p

l
P

)
+
(
T?g1 + RsoT?o1

)l
b

(
plP ?p

l
B

)
?T? lg1,e

(
pn+1cgo,E ?p

l
cgo,P

)
+ T? lg1,w

(
plcgo,P ?p

l
cgo,W

)
?T? lg2,n

(
pn+1cgo,N ?p

l
cgo,P

)
+ T? lg2,s

(
plcgo,P ?p

l
cgo,S

)
?T? lg3,t

(
pn+1cgo,T ?p

l
cgo,P

)
+ T? lg3,b

(
plcgo,P ?p

l
cgo,B

)
+
(
T?g1?g + RsoT?o1?o

)l
e

(zE ?zP )

?
(
T?g1?g + RsoT?o1?o

)l
w

(zP ?zW )

+
(
T?g2?g + RsoT?o2?o

)l
n

(zN ?zP )

?
(
T?g2?g + RsoT?o2?o

)l
s

(zP ?zS)

+
(
T?g3?g + RsoT?o3?o

)l
t
(zT ?zP )

?
(
T?g3?g + RsoT?o3?o

)l
b
(zP ?zB)

?q?lg,P ?VP ,
(2.23)

os quais são agrupados no vetor de resíduos referente ao volume
de controle P como:

~RlP =

?
??R

l
w,P

Rlo,P
Rlg,P

?
?? . (2.24)

Agrupando-se as variáveis pP ,Sw,P e So,P no vetor

~xP =

?
?? pPSw,P
So,P

?
?? , (2.25)



2.1. Escoamento Trifásico 55

segue que a aplicação de uma iteração do método de Newton-
Raphson no sistema de equações (2.17) a (2.19) gera um sistema
linear em termos da variável ?~xl+1 cuja equação referente ao
volume de controle P é dada por:

?~RlP =
? ~RlP
?~xW

?~xl+1W +
? ~RlP
?~xS

?~xl+1S

+
? ~RlP
?~xB

?~xl+1B +
? ~RlP
?~xP

?~xl+1P

+
? ~RlE
?~xE

?~xl+1E +
? ~RlP
?~xN

?~xl+1N +
? ~RlP
?~xT

?~xl+1T ,

(2.26)

em que

? ~RP
?~xP

=

?
??????????

?Rw
?p

?Rw
?So

?Rw
?Sw

?Ro
?p

?Ro
?So

?Ro
?Sw

?Rg
?p

?Rg
?So

?Rg
?Sw

?
??????????
P

. (2.27)

No caso 3D, a matriz de coeficientes gerada por (2.26) tem
stencil de sete pontos conforme mostrado na figura3 1, enquanto
que no caso 2D, o stencil é de cinco pontos.

Escrevendo-se a equação (2.26) para todos os volumes de
controle, obtém-se a matriz jacobiana J, ilustrada na figura 2. É
importante observar que essa matriz é composta por blocos de
tamanho 3 × 3, referentes às variáveis pressão e saturações das
fases água e óleo.

Resolvendo-se o sistema linear induzido pela matriz jaco-
biana

J ?~xl+1 = ?~Rl, (2.28)

obtém-se o vetor de correções ?~xl+1, o qual é utilizado para
atualizar o valor das variáveis primárias em relação à última
3 As figuras elaboradas pelo próprio autor não receberão legenda daqui em

diante.



56 Capítulo 2. Modelagem Matemática e Numérica

Figura 1 – Stencil de sete pontos.

P
W

E

N

S

T

B

Fonte: elaborada pelo autor.

Figura 2 – Ilustração da matriz de coeficientes.

x x x
x xP xx x x

x x x
x xWxx x x

x x x
x x x
x x x

x x x
x x x
x x x

x x x
x xNxx x x

x x x
x x x
x x x

x x x
x x x
x x x ESB T



2.1. Escoamento Trifásico 57

iteração do método de Newton da seguinte maneira:

~xl+1 = ~xl + ?~xl+1, (2.29)

até que algum critério de convergência seja satisfeito. Os termos
fonte são atualizados de acordo com:

ql+1?s =
Nw?
n=1

Mwn?
m=1

WInmk
l+1
r?

µ?

[
p
n,l+1
bh ?p

l+1
? ??

l+1
? (z

n
bh ?z)

]
? (~x?~xnm) .

(2.30)
Quando a pressão de fundo de poço pbh é desconhecida, a equação
(2.30) é acoplada às equações (2.21) a (2.23) para o cálculo das
incógnitas (?p,?Sw,?So,?pbh). Quando a pressão de fundo de poço
é conhecida, as variáveis primárias se restringem às do escoamento
no reservatório.

No estado subsaturado, sabe-se que Sg = 0, porém a
quantidade do componente gás dissolvido na fase óleo não é
conhecida a priori. Assim, as variáveis primárias do modelo são
modificadas para (p,Sw,pb), em que pb é a pressão de saturação da
fase óleo em relação ao componente gás. Nesse caso, as equações
de conservação discretizadas referentes às fases água e óleo são
as mesmas que (2.21) e (2.22), no entanto, a equação referente à



58 Capítulo 2. Modelagem Matemática e Numérica

fase gás é substituída por:

Rlg,P =
?VP
?t

[(
?RsoSo
Bo

)l
?
(
?RsoSo
Bo

)n]
P

?
(
RsoT?o1

)l
e

(
plE ?p

l
P

)
+
(
RsoT?o1

)l
w

(
plP ?p

l
W

)
?
(
RsoT?o1

)l
n

(
plN ?p

l
P

)
+
(
RsoT?o1

)l
s

(
plP ?p

l
S

)
?
(
RsoT?o1

)l
t

(
plT ?p

l
P

)
+
(
RsoT?o1

)l
b

(
plP ?p

l
B

)
+
(
RsoT?o1?o

)l
e

(zE ?zP ) ?
(
RsoT?o1?o

)l
w

(zP ?zW )

+
(
RsoT?o2?o

)l
n

(zN ?zP ) ?
(
RsoT?o2?o

)l
s

(zP ?zS)

+
(
RsoT?o3?o

)l
t
(zT ?zP ) ?

(
RsoT?o3?o

)l
b
(zP ?zB)

?
(
q?osRso
Bo

)l
?VP .

(2.31)

Como uma das variáveis primárias é modificada, a matriz
jacobiana é substituída por:

? ~R

?~x
=

?
??????????

?Rw
?p

?Rw
?Sw

?Rw
?pb

?Ro
?p

?Ro
?Sw

?Ro
?pb

?Rg
?p

?Rg
?Sw

?Rg
?pb

?
??????????
, (2.32)

a qual é empregada para a construção de um sistema linear
conforme descrito no caso de escoamento em estado saturado.

2.1.2 Determinação do Ponto de Bolha

Dado um volume de controle, o estado em que a fase
óleo se encontra pode alterar de saturado para subsaturado ou
vice-versa durante uma simulação. Se a transição entre esses dois
estados for reconhecida corretamente, a taxa de convergência do



2.1. Escoamento Trifásico 59

método de Newton-Raphson pode ser aumentada. Esse problema
é denominado como ponto de bolha.

A transição do estado saturado para subsaturado ocorre
quando a seguinte condição é atendida:

p
n+1,l+1
b + ?pb &gt; p

n+1,l+1, (2.33)

enquanto que, a transição inversa ocorre quando

Sn+1,l+1g &amp;lt;0. (2.34)

Além disso, as condições de restrição para o estado satu-
rado são dadas por:

Sn+1,lw + S
n+1,l
o + S

n+1,l
g = 1, (2.35)

pn+1,l = pn+1,lb . (2.36)

Enquanto que, para o estado subsaturado:

Sn+1,lw + S
n+1,l
o = 1, (2.37)

pn+1,l &gt; p
n+1,l
b , (2.38)

Com o intuito de tratar o problema do ponto de bolha
apropriadamente, é necessário checar as condições de mudança
de estado (2.33) e (2.34). Quando a pressão no reservatório di-
minui para um valor menor que a pressão do ponto de bolha, o
componente gás escapa da fase óleo e forma uma fase própria.
Nesse caso há transferência do estado subsaturado para saturado.
Para tanto, é necessário que a saturação da fase óleo diminua.
Quando o reservatório encontra-se no estado saturado, as variáveis
respeitam as restrições (2.35) e (2.36).

Quando a pressão em um determinado local do reserva-
tório aumenta de modo que todo gás se dissolve na fase óleo,
tem-se que Sn+1,l+1g &amp;lt;0, acarretando em transferência para o
estado subsaturado. Com o intuito de garantir que a pressão da
fase óleo po seja maior que a pressão do ponto de bolha pb no
novo estado, ?pb é configurado com um valor pequeno. Assim
que ocorre a transferência de estado, assegura-se que as variáveis
sejam atualizadas de modo a obedecer as condições de restrição
(2.37) e (2.38).



60 Capítulo 2. Modelagem Matemática e Numérica

2.2 ESCOAMENTO BIFÁSICO

Considerando-se escoamento bifásico imiscível do tipo
água/óleo, a saturação da fase gás e a pressão capilar gás/óleo
são nulas, portanto, as equações governantes do modelo black-oil
podem ser simplificadas da seguinte maneira:

?

?t

(
?Sw
Bw

)
= ?· (K?w [?pw ??w?z]) +

q?ws
Bw

, (2.39a)

?

?t

(
?So
Bo

)
= ?· (K?o [?po ??o?z]) +

q?os
Bo

, (2.39b)

Sw + So = 1, (2.39c)

pcow (Sw) = po ?pw. (2.39d)

Fazendo-se ainda as seguintes hipóteses:
a) pressão capilar água/óleo desprezível;
b) rocha e fluidos são incompressíveis, isto é, ? ? cte e

B? = 1,
as equações (2.39a) a (2.39d) podem ser reescritas da seguinte
forma:

?
?Sw
?t

= ?· (K?w [?p??wg?z]) + q?w, (2.40a)

?
?So
?t

= ?· (K?o [?p??og?z]) + q?o, (2.40b)

Sw + So = 1. (2.40c)

Definindo-se a mobilidade total como:

?t (Sw) = ?w + ?o =
krw
µw

+
kro
µo
, (2.41)

segue que a soma das equações (2.40a) e (2.40b) dá origem à
seguinte expressão:

?· (K?t?p) = ?· (K (?w?w + ?o?o) g?z) ? (q?w + q?o) , (2.42)



2.2. Escoamento Bifásico 61

a qual é conhecida como a “equação da pressão”, uma vez que
é empregada para o cálculo dessa mesma variável. Ela caráter
elíptico e sua resolução envolve a maior parte do tempo compu-
tacional da simulação (KILLOUGH; WANG, 2013). Usando-se
ainda o conceito de mobilidade total, a velocidade total pode ser
expressa como:

~ut = ~uw + ~uo

= K [?t?P ? (?w?w + ?o?o) g?z] ,
(2.43)

de modo que a relação entre as velocidades das fases água e óleo
com a velocidade total é dada por:

~uw = fw~ut + K?ofw (?w ??o) g?z, (2.44)

~uo = fo~ut + K?wfo (?o ??w) g?z, (2.45)

em que f? é a função fluxo fracionário da fase ?, dada por:

f? =
??
?t
, ? = [w,o]. (2.46)

Substituindo-se as expressões (2.41) e (2.44) em (2.40a),
segue que esta última pode ser reescrita da seguinte maneira:

?
?Sw
?t

+ ?· (fw~ut) ??· (K?ofw (?o ??w) g?z) = q?w, (2.47)

a qual é conhecida como equação de Buckley-Leverett ou simples-
mente como equação da saturação. Esta possui caráter hiperbólico
e pode ser resolvida implicitamente ou explicitamente ao longo
do tempo, de acordo com a formulação numérica empregada.

Em síntese, o modelo de escoamento bifásico imiscível é
composto pelas equações (2.40c), (2.42), (2.43) e (2.47), as quais
estão acopladas através da saturação da fase água e formam um
sistema não-linear.

2.2.1 Discretização das Equações

A discretização das equações (2.42) e (2.47) é realizada
da mesma maneira que no caso de escoamento trifásico, isto é,



62 Capítulo 2. Modelagem Matemática e Numérica

através do método dos volumes finitos tradicional empregando-se
o esquema de dois pontos (TPFA). Para a aproximação no tempo
das equações já discretizadas, emprega-se a formulação totalmente
implícita sequencial - Sequential Fully Implicit (SFI) (SPILLETE;
HILLESTAD; STONE, 1973; JENNY; LEE; TCHELEPI, 2006)
em que as equações são resolvidas de modo implícito e sequencial.

A equação da pressão no formato discretizado é dada por:

(
q?n+1w,P + q?

n+1
o,P

)
?VP =T?n+1t1,e

(
pn+1E ?p

n+1
P

)
? T?n+1t1,w

(
pn+1P ?p

n+1
W

)
+T?n+1t2,n

(
pn+1N ?p

n+1
P

)
? T?n+1t2,s

(
pn+1P ?p

n+1
S

)
+T?n+1t3,t

(
pn+1T ?p

n+1
P

)
? T?n+1t3,b

(
pn+1P ?p

n+1
B

)
?
(
T?w1?w + T?o1?o

)n+1
e

(zE ?zP )

+
(
T?w1?w + T?o1?o

)n+1
w

(zP ?zW )

?
(
T?w2?w + T?o2?o

)n+1
n

(zN ?zP )

+
(
T?w2?w + T?o2?o

)n+1
s

(zP ?zS)

?
(
T?w3?w + T?o3?o

)n+1
t

(zT ?zP )

+
(
T?w3?w + T?o3?o

)n+1
b

(zP ?zB) ,
(2.48)

em que T??d é a transmissibilidade na direção d referente à fase
?, já apresentada na equação (2.16). A permeabilidade absoluta
nas interfaces dos volumes de controle são avaliadas de acordo
com a média harmônica dos valores referentes aos volumes que
compartilham a mesma face, enquanto que a permeabilidade
relativa nas fronteiras é calculada a partir de um esquema de
interpolação upwind de primeira ordem.



2.2. Escoamento Bifásico 63

A forma discreta da equação da saturação é dada por:

??VP
?t

(
Sn+1w,P ?S

n
w,P

)
= ?

(
fn+1w ~u

n+1
t A

)
e

+
(
fn+1w ~u

n+1
t A

)
w

?
(
fn+1w ~u

n+1
t A

)
n

+
(
fn+1w ~u

n+1
t A

)
s

?
(
fn+1w ~u

n+1
t A

)
t
+
(
fn+1w ~u

n+1
t A

)
b

?
[
T?o1fw (?o ??w)

]n+1
e

(zE ?zP )

+
[
T?o1fw (?o ??w)

]n+1
w

(zP ?zW )

?
[
T?o2fw (?o ??w)

]n+1
n

(zN ?zP )

+
[
T?o2fw (?o ??w)

]n+1
s

(zP ?zS)

?
[
T?o3fw (?o ??w)

]n+1
t

(zT ?zP )

+
[
T?o3fw (?o ??w)

]n+1
b

(zP ?zB)

+q?n+1w,P ?VP ,
(2.49)

em que Ai é a área da interface i. Tal equação é não-linear, uma
vez que o fluxo fracionário da fase água é função da saturação,
portanto emprega-se o método de Newton-Raphson para sua
resolução.

É possível observar que as equações (2.48) e (2.49) estão
acopladas devido à permeabilidade relativa, que é função da satu-
ração, e também à velocidade total do escoamento, que é função
do campo de pressão. Por conta desse acoplamento, estabelece-se
um procedimento iterativo para a resolução sequencial dessas
equações até que um critério de convergência baseado na variação
da saturação seja satisfeito. Denotando por l+ 1 a iteração recente
e l, a antiga e suprimindo o índice n + 1, as equações (2.48) e



64 Capítulo 2. Modelagem Matemática e Numérica

(2.49) podem ser reescritas como:

(
q?lw,P + q?

l
o,P

)
?VP =T? lt1,e

(
pl+1E ?p

l+1
P

)
? T? lt1,w

(
pl+1P ?p

l+1
W

)
+T? lt2,n

(
pl+1N ?p

l+1
P

)
? T? lt2,s

(
pl+1P ?p

l+1
S

)
+T? lt3,t

(
pl+1T ?p

l+1
P

)
? T? lt3,b

(
pl+1P ?p

l+1
B

)
?
(
T?w1?w + T?o1?o

)l
e

(zE ?zP )

+
(
T?w1?w + T?o1?o

)l
w

(zP ?zW )

?
(
T?w2?w + T?o2?o

)l
n

(zN ?zP )

+
(
T?w2?w + T?o2?o

)l
s

(zP ?zS)

?
(
T?w3?w + T?o3?o

)l
t
(zT ?zP )

+
(
T?w3?w + T?o3?o

)l
b
(zP ?zB) ;

(2.50)



2.3. Escoamento Monofásico 65

??VP
?t

(
Sl+1w ?S

n
w

)
= ?

(
fn+1w ~u

l+1
t A

)
e

+
(
fn+1w ~u

l+1
t A

)
w

?
(
fn+1w ~u

l+1
t A

)
n

+
(
fn+1w ~u

l+1
t A

)
s

?
(
fn+1w ~u

l+1
t A

)
t
+
(
fn+1w ~u

l+1
t A

)
b

?
[
T?o1fw (?o ??w)

]l
e

(zE ?zP )

+
[
T?o1fw (?o ??w)

]l
w

(zP ?zW )

?
[
T?o2fw (?o ??w)

]l
n

(zN ?zP )

+
[
T?o2fw (?o ??w)

]l
s

(zP ?zS)

?
[
T?o3fw (?o ??w)

]l
t
(zT ?zP )

+
[
T?o3fw (?o ??w)

]l
b
(zP ?zB)

+q?lw,P ?VP ,
(2.51)

as quais são resolvidas de acordo com a Figura 3.
É importante observar que o algoritmo apresentado en-

volve a resolução de sistemas lineares, isso é válido também para
a equação da saturação, uma vez que ela é resolvida através do
método de Newton. Os métodos empregados para a resolução de
problemas lineares é discutida no capítulo 3.

2.3 ESCOAMENTO MONOFÁSICO

No caso de escoamento de uma única fase ?, o sistema de
equações (2.1a) a (2.1f) referentes ao modelo black-oil trifásico
reduz-se a uma única equação, de caráter elíptico, que é utilizada
para o cálculo da pressão conforme:

?

?t

(
?

B

)
= ?·

(
K

µ
(?p??g?z)

)
+
qs
B
. (2.52)

Enquanto que o campo de velocidades pode ser calculado explici-
tamente pela lei de Darcy, equação (2.3).



66 Capítulo 2. Modelagem Matemática e Numérica

Figura 3 – Fluxograma para resolução do escoamento bifásico.

Sl = Sn

Resolva (2.50) para pl+1

Calcule ~ul+1 através de (2.43)

Resolva (2.51) para Sl+1

???Sl+1 ?Sl???
?
&amp;lt;?

Sn+1 = Sl+1
pn+1 = pl+1

l = l + 1
SimNão

Considerando ainda que o fluido encontra-se no estado
líquido (água ou óleo), pode-se assumir que o escoamento é in-
compressível. Além disso, desprezando-se a compressibilidade
da rocha, que pode fazer a porosidade variar, a equação (2.52)
reduz-se à equação diferencial ordinária de segunda ordem:

?·
(

K
µ

(?p??g?z)
)

+ qs = 0, (2.53)

cujas condições de contorno podem ser de pressão ou fluxo pres-
crito.

A discretização da equação (2.53) é realizada através do
método dos volumes finitos, empregando-se o esquema de dois



2.3. Escoamento Monofásico 67

pontos para o cálculo dos fluxos nas interfaces, conduzindo a

qs?VP =T?1,e (pE ?pP ) ? T?1,w (pP ?pW )

+T?1,n (pN ?pP ) ? T?1,s (pP ?pS)

+T?1,t (pT ?pP ) ? T?1,b (pP ?pB)

(2.54)

em que a transmissibilidade na direção d é dada pela equação
(2.16).

Quando escrita para cada um dos volumes de controle da
malha, a equação (2.54) forma um sistema linear de caráter elíp-
tico cuja variável é a pressão. Os métodos comumente empregados
para a resolução desse sistema linear são descritos no capítulo 3.





69

3 SOLUÇÃO DO MODELO MATEMÁTICO

A discretização das equações diferenciais que modelam o
escoamento em reservatórios pode conduzir a sistemas de equações
não-lineares ou lineares, de acordo com o caráter das equações go-
vernantes do escoamento. Conforme descrito no capítulo anterior,
os modelos de escoamento que envolvem sistemas de equações
não-lineares são resolvidos através de vários sistemas lineares em
sequência, cujas respostas convergem para a solução do problema
não-linear. Além disso, os modelos de escoamento lineares são
resolvidos, naturalmente, pela solução de sistemas de equações
também lineares. Desse modo, nota-se que os esforços numéricos
presentes na simulação do escoamento em reservatórios resumem-
se à solução de sistemas do tipo

Ax = b, (3.1)

em que A ?&amp;lt;n×n é conhecida como a matriz de coeficientes,
responsável por descrever a ação do operador diferencial em for-
mato discreto; x ?&lt;n, o vetor solução, que abrange as incógnitas
do modelo discretizado e b ?&amp;lt;n, um vetor cujos valores são
conhecidos responsável por modelar fenômenos externos como a
entrada ou saída de massa no reservatório, bem como a ação das
condições de contorno.

Modelos geológicos de reservatórios podem apresentar
mais de 1.0 × 108 incógnitas, o que dá origem a sistemas lineares
de grande porte (CHRISTIE, 1996). Além disso, devido ao fato
de representarem fenômenos físicos complexos, tais sistemas são,
em geral, mal condicionados do ponto de vista da álgebra linear.
Isso é verificado especialmente no caso em que o campo de per-
meabilidade absoluta da rocha é altamente heterogêneo, isto é,
com grande variabilidade ao longo do espaço.

A resolução eficiente dos sistemas lineares representa um
grande desafio em termos de recursos computacionais, sendo que
até 90% do tempo de simulação pode ser consumido na resolução
de sistemas lineares esparsos (DOGRU et al., 2011; KILLOUGH;
WANG, 2013). Considerando-se a necessidade de rapidez em se
tomar decisões a cerca de estratégias de explotação do reservatório



70 Capítulo 3. Solução do Modelo Matemático

e a complexidade do modelo de escoamento, essa tarefa tende a
ser proibitiva nos computadores disponíveis atualmente devido a
limitações de memória RAM e também de poder de processamento.
Duas estratégias são comumente empregadas no tratamento desse
desafio: redução do tamanho do modelo discretizado e uso de
solvers e pré-condicionadores eficientes. Esse capítulo apresenta
de modo resumido o estado da arte de cada uma dessas técnicas
com enfoque nas suas respectivas vantagens e desvantagens, bem
como em qual posição o presente trabalho se situa.

3.1 UPSCALING

A primeira estratégia, conhecida como upscaling, consiste
em reduzir o número de informações presentes nos modelos para
as propriedades da rocha-reservatório e sua interação com os
fluidos que escoam através dela de modo que suas características
fundamentais sejam preservadas. Em métodos eficazes, isto faz
com que a solução obtida para o escoamento em reservatórios
segundo tais campos seja muito próxima àquela que seria obtida
caso o problema original fosse resolvido.

Do ponto de vista algébrico, a aplicação de técnicas de
upscaling faz com que o número de incógnitas do modelo discreti-
zado de escoamento também reduza. Isto quer dizer que, ao invés
de se resolver o problema original 3.1, resolve-se um sistema do
tipo

Acxc = bc, (3.2)

com c referindo-se ao modelo novo de escoamento e sendo que
a dimensão da matriz de coeficientes Ac é bem menor que a
dimensão de Af. Uma consequência direta disso é a redução do
esforço computacional necessário para se resolver o escoamento
em reservatórios.

A figura 4 ilustra o campo de permeabilidade absoluta
obtido com a aplicação do upscaling em um modelo heterogêneo,
bem como a redução do número de volumes de controle envolvidos
no modelo grosseiro.



3.1. Upscaling 71

Figura 4 – Ilustração da ideia central do upscaling.

É importante observar que as técnicas de upscaling in-
serem uma aproximação no modelo do escoamento, já que in-
formações locais são ponderadas, em geral, de maneira inexata
no processo de obtenção do modelo grosseiro. Desse modo, os
campos de pressão, saturação ou temperatura calculados com o
novo modelo, apesar de bastante próximos, não são equivalentes
àqueles que seriam obtidos caso o problema original 3.1 fosse
resolvido.

Existem diversas técnicas de upscaling, sendo que elas
são usualmente classificadas em termos dos parâmetros que se-
rão calculados em nível grosseiro. Porosidade e permeabilidade
absoluta das rochas são denotados como parâmetros monofásicos,
pois são recalculados em qualquer técnica de upscaling, já a per-
meabilidade relativa e as curvas de pressão capilar são denotados
como parâmetros multifásicos por serem dependentes das satu-
rações relativas às fases que escoam no reservatório. Em geral,
estes últimos parâmetros precisam ser recalculados em escoamen-
tos multifásicos, porém, quando esquemas de redução moderada
no número de incógnitas são empregados, é suficiente recalcular
apenas a porosidade e a permeabilidade absoluta (SANDVIN,
2012).

O desenvolvimento de novas técnicas de upscaling cada



72 Capítulo 3. Solução do Modelo Matemático

vez mais fiéis ao problema original é uma área ativa de pesquisa
(FARMER, 2002; DURLOFSKY, 2003; CHEN; DENG; YE, 2005;
CHEN, 2006). Essa é uma tarefa complexa, em especial para pro-
blemas de escoamento multifásico, os quais são comuns em casos
reais de aplicação e podem envolver permeabilidades relativas e
pressões capilares variáveis ao longo da simulação, cujo efeito em
escala global é de difícil representação.

Dadas as vantagens e desvantagens do upscaling, nota-se
que existem situações em que estas técnicas não representam
uma solução viável para a economia de recursos computacionais
investidos na simulação. Nesses casos, torna-se imprescindível
o uso de métodos eficientes para a solução do problema inicial.
Essa é justamente a abordagem do presente trabalho e também o
assunto da seção seguinte.

3.2 SOLVERS LINEARES

Na segunda abordagem empregada para a resolução do
escoamento em reservatórios, busca-se o desenvolvimento de algo-
ritmos eficientes do ponto de vista algébrico, isto é, que envolvam
o menor número de operações aritméticas possível e também do
ponto de vista computacional, ou seja, que utilizem a máxima ca-
pacidade de computação disponível1(WILLIAMS; WATERMAN;
PATTERSON, 2009) e que também sejam escaláveis tanto no sen-
tido forte como fraco2. Essa última característica é essencial para
a resolução dos sistemas lineares através de máquinas paralelas
(BALAY et al., 2015).

1 Essa característica é bastante dependente da arquitetura apresentada
pela unidade de processamento em questão, CPUs são as mais utilizadas,
enquanto que GPUs têm recebido interesse crescente. Em geral, a perfor-
mance de pico em cada arquitetura é raramente alcançada por limitações
devidas à transferência de dados entre memória RAM e processador.

2 A escalabilidade forte de um algoritmo é função do esforço numérico
empregado na resolução de um problema a medida que seu tamanho
aumenta, enquanto que a escalabilidade fraca mede a variação desse
esforço numérico a medida que a resolução do problema é distribuída para
diferentes unidades de processamento.



3.2. Solvers Lineares 73

Os algoritmos empregados na resolução de sistemas linea-
res são comumente referidos como solvers e divididos em métodos
diretos e iterativos. Na primeira classe, os sistemas lineares são
resolvidos exatamente segundo a precisão da máquina empregada.
Já na segunda, estima-se uma solução x0 para o sistema linear e
forma-se uma sequência de vetores xk, segundo alguma heurística,
que convergem para a solução exata do problema. Tal sequência
é truncada de acordo com algum critério baseado na proximidade
entre os vetores que a compõem ou então baseado na norma dos
resíduos calculados segundo tais vetores.

Os métodos diretos são reconhecidos por sua robustez e
agilidade na resolução de problemas lineares até um determinado
tamanho. Suas complexidades com relação ao uso de memória e
poder de processamento são funções, basicamente, do tamanho
N do sistema linear e da dimensão do problema a qual se refere.
Existem técnicas, por exemplo, que resolvem problemas 2D de
acordo com O(N3/2) operações de ponto flutuante e O(N log N)
de uso de memória (BANGERTH, 2013).

Já métodos iterativos são conhecidos por seu baixo custo
computacional em termos de poder de processamento e uso de
memória RAM, desde que pré-condicionadores apropriados sejam
empregados na resolução dos sistemas lineares, assunto que será
discutido na seção 3.3. Em determinadas ocasiões, é possível
observar que a complexidade de tais métodos pode ser até de
ordem linear O(N), o qual representa o melhor cenário possível.
Apesar de bastante promissores, em especial na solução paralela de
sistema lineares, dados os computadores atualmente disponíveis,
solvers iterativos são competitivos em relação aos diretos somente
em problemas com ao menos 105 incógnitas (BANGERTH, 2013).

Apresentam-se nessa seção os métodos comumente em-
pregados para a solução de problemas lineares provenientes da
simulação de escoamentos em reservatórios, suas vantagens e des-
vantagens particulares serão abordadas com o intuito de delinear
o estado da arte na escolha de métodos para a resolução dos
problemas referidos. Uma descrição mais detalhada matematica-
mente desses métodos pode ser verificada nos trabalhos de Saad
(2003) e Kelley (1995).



74 Capítulo 3. Solução do Modelo Matemático

3.2.1 Fatoração LU completa

A fatoração LU completa é um dos métodos mais conheci-
dos para a resolução direta de sistemas lineares, sua ideia básica
consiste em encontrar duas matrizes L, triangular inferior, e U,
triangular superior, de modo que A = LU. Em seguida, resolve-se
o problema

LUx = b, (3.3)

o qual é matematicamente equivalente ao sistema linear (3.1),
porém de manipulação simplificada.

O método em questão pode ser implementado compu-
tacionalmente de diversas maneiras de acordo com a estratégia
empregada para o cálculo dos fatores L e U (SAAD, 2003). Tipi-
camente, tais procedimentos consistem de quatro passos:

1. Reordena-se o grafo referente à matriz de coeficientes com
o intuito de se reduzir a geração de novos elementos não-
nulos durante o cálculo dos fatores L e U. Para tanto,
estratégias comumente empregadas são Nested Dissection
(ND) (GEORGE, 1976); Reverse Cuthill-McKee (RCM)
(LIU; SHERMAN, 1976) e Approximate Mininal Degree
(AMD) (AMESTOY; DAVIS; DUFF, 1996).

2. Realiza-se uma fatoração simbólica da matriz, isto é, sem
que os valores numéricos das entradas sejam considerados.
Aqui é importante o uso de algoritmos que levem em conta
a esparsidade da matriz. O intuito dessa etapa é calcular
como será o preenchimento dos fatores triangulares, ou
seja, quantos elementos não-nulos serão adicionados e suas
respectivas posições.

3. Realiza-se a fatoração numérica da matriz, a qual leva em
conta os valores de seus coeficientes. Dessa forma, os fatores
triangulares são completamente definidos.

4. Por último, utilizam-se os fatores L e U para a resolução
do sistema linear (3.3) conforme apresentado no Algoritmo
1.



3.2. Solvers Lineares 75

Algoritmo 1: Aplicação da fatoração LU.
Data: Ax = b, A = LU.
Result: x = U?1L?1b.

1 Resolva Ly = b por substituição direta.
2 Resolva Ux = y por substituição reversa.

É importante notar que a resolução dos sistemas triangu-
lares por substituição direta e reversa é uma tarefa barata com-
putacionalmente, enquanto que a etapa de obtenção dos fatores
triangulares, conhecida como setup ou configuração do algoritmo,
apresenta a maior demanda de recursos computacionais envolvi-
dos em seu emprego. Isso é válido especialmente para o uso de
memória RAM, a medida que o número de elementos não-nulos
da matriz de coeficientes é maior.

A fatoração LU é conhecida por ser um método de so-
lução robusto, pois não impõe restrições quanto ao número de
condicionamento da matriz de coeficientes e sua simetria. Além
disso, a solução proposta é exata, a menos dos erros de arredonda-
mento da máquina que surgem devido a sua precisão limitada na
representação de números. Esta é uma técnica bastante atraente
quando se deseja resolver múltiplos sistemas lineares com a mesma
matriz de coeficientes A. No entanto, seu uso pode ser proibitivo
em computadores que apresentam limitações de memória RAM
ou pode ser não-aconselhável quando se deseja resolver o sistema
linear de modo aproximado somente. Nesse último caso, é comum
o uso de métodos iterativos.

3.2.2 Método de Richardson

Dentre os solvers iterativos, um dos mais básicos e primei-
ros a serem utilizados é o método de Richardson (RICHARDSON,
1911). Nele, uma série de soluções xk são obtidas com k variando
entre zero e o número máximo de iterações segundo a equação:

xk+1 = xk + ?M?1
(
b? Axk

)
, (3.4)



76 Capítulo 3. Solução do Modelo Matemático

em que ? é um escalar não-negativo usualmente igual à uni-
dade e M?1, uma matriz denominada de "pré-condicionador".
Ambos elementos têm como finalidade aumentar a taxa de con-
vergência do método iterativo, papel que desempenhado espe-
cialmente pela matriz de pré-condicionamento. A definição de
pré-condicionadores eficientes é uma tarefa complexa e altamente
dependente do tipo de problema que se esteja resolvendo, isto é
discutido com mais detalhes na seção 3.3, em que também se apre-
senta os pré-condicionadores comumente utilizados na simulação
de reservatórios.

A equação 3.4 também pode ser escrita em termos de
iteração em torno do ponto fixo xk da seguinte maneira:

xk+1 =
(
I ??M?1A

)
xk + ?M?1b, (3.5)

em que G = I ??M?1A é denominada como matriz de iteração.
Pode-se provar que a convergência desse método é garantida
quando o raio espectral3 dessa matriz, denotado por ? (G), é
menor que a unidade (SAAD, 2003). Quando tal condição não
é atendida, torna-se necessário o emprego de solvers iterativos
mais robustos conforme exposto nas seções seguintes.

3.2.3 Método do Resíduo Generalizado Mínimo

O método do resíduo mínimo generalizado - Generalized
Minimal Residual (GMRes) - é um solver iterativo baseado em
espaços de Krylov desenvolvido inicialmente por Saad e Schultz
(1986). Esse método é voltado para a solução de problemas não-
simétricos, sendo normalmente empregado na sua versão pré-
condicionada, e apresenta larga aplicação em diversas áreas da
engenharia.

Sejam M?1, matriz de pré-condicionamento; x0, uma esti-
mativa inicial e r0, o resíduo inicial dado por r0 = M?1 (b? Ax0).
O algoritmo GMRes procura uma solução xm para o problema

3 Supremo do conjunto formado pelo valor absoluto dos autovalores que
constituem o espectro de uma matriz.



3.2. Solvers Lineares 77

(3.1) no subespaço x0 + Km de dimensão m&amp;lt;&amp;lt;n, em que

Km = span
{
r0, M?1Ar0, ...,

(
M?1A

)m?1
r0

}
. (3.6)

Para tanto, empregam-se m restrições de acordo com a condição
de Petrov-Galerkin, dada por

b? Aum ? Lm, (3.7)

em que Lm é o subespaço de restrições, o qual varia de acordo com
o método iterativo escolhido. Para o GMRes, escolhe-se Lm =
AKm, fazendo com que a norma do resíduo pré-condicionado

r =
??????M?1 (b? Ax)??????

2
(3.8)

seja minimizada para os candidatos x pertencentes ao subespaço
Km.

O pseudocódigo da versão pré-condicionada à esquerda
desse método é dado pelo algoritmo 2. Os passos 1 a 12 tem
como finalidade encontrar uma base ortonormal de vetores para
o subespaço de Krylov Km, enquanto que nos passos posteriores
encontra-se a melhor combinação linear desses vetores de modo a
minimizar o valor do resíduo pré-condicionado 3.8.

É importante citar que existem outras implementações do
algoritmo GMRes que propõem pequenas mudanças na maneira
como a matriz de Hessenberg Hm é construída e também no
modo como o problema de minimização especificado no passo 13
é resolvido. Exemplos comuns são o Flexible Generalized Minimal
Residual (FMGRes) e o Direct Quasi Generalized Minimal Re-
sidual (DQGMRes) (SAAD, 2003). Além disso, podem também
existir variantes do GMRes que são matematicamente equivalentes
entre si, porém que apresentam diferentes custos computacionais,
como é o caso do Pipeline Generalized Minimal Residual (PGM-
Res), versão do GMRes tradicional especializada na resolução
em paralelo de problemas de larga escala (BALAY et al., 2015).
Nota-se que a solução iterativa de um problema pode envolver
parâmetros que vão muito além da simples escolha do método
iterativo base.



78 Capítulo 3. Solução do Modelo Matemático

Algoritmo 2: GMRes pré-condicionado à esquerda.
Data: r0 = M?1 (b? Ax0) , ? = ||r0||2 , v1 = r0/?.
Result:

arg min
x?Km

??????M?1 (b? Ax)??????
2
.

1 for j = 1 to m do
2 Calcule w = M?1Avj
3 for i = 1 to j do
4 Calcule hi,j = (w,vi)
5 Atualize w = w ?hi,jvi
6 end
7 Calcule hj+1,j = ||w||2
8 if hj+1,j &amp;lt;htol then
9 m = j, vá para 13.

10 end
11 Calcule vj+1 = w/hj+1,j
12 end
13 Defina V = [v1, ...,vm].
14 Defina Hm = hi,j com 1 ? i ? (j + 1) ; 1 ? j ? m.
15 Resolva ym = argminy ||?e1 ?Hmy||2.
16 Calcule xm = x0 + Vmym.
17 Calcule r = M?1 (b? Axm).
18 if ||r||2 /

????M?1b????2 ? tol then
19 Atualize x0 = xm e volte para o passo 1.
20 else
21 Fim
22 end



3.2. Solvers Lineares 79

3.2.4 Método do Gradiente Conjugado

O método do gradiente conjugado - Conjugate Gradient
(CG) - é um solver iterativo baseado em espaços de Krylov, assim
como o GMRes, em que o subespaço de restrições escolhido é
o próprio Km. Esse método foi desenvolvido inicialmente por
Hestenes e Stiefel (1952) como uma alternativa à fatoração LU
completa para a resolução direta de sistemas lineares simétricos.
Hoje em dia, no entanto, é comumente empregado como um
método iterativo para a resolução aproximada desses problemas
de acordo com a precisão que se queira.

O objetivo do método do gradiente conjugado consiste
em minimizar a norma energia do erro entre a solução calculada
e aquela que seria obtida caso o problema fosse resolvido direta-
mente. Definindo-se como x? a solução exata do sistema linear
3.1, tal condição pode ser expressa da seguinte maneira:

arg min
x?Km

||x?x?||A . (3.9)

O passo-a-passo da versão pré-condicionada à esquerda desse
método é dado pelo algoritmo 3.

Algoritmo 3: CG pré-condicionado à esquerda.
Data: r0 = (b? Ax0) , z0 = M?1r0, p0 = z0.
Result:

arg min
x?Km

||x?x?||A .

1 for j = 0 to m? 1 do
2 ?j = (rj,zj)/(Apj,pj).
3 xj+1 = xj + ?jpj.
4 rj+1 = rj ??jApj.
5 zj+1 = M?1rj+1.
6 ?j = (rj+1,zj+1)/(rj,zj).
7 pj+1 = zj+1 + ?jpj.
8 end

Assim como o GMRes, o método do gradiente conjugado
baseia-se em operações algébricas envolvendo somente vetores



80 Capítulo 3. Solução do Modelo Matemático

bem como em produtos entre matrizes esparsas e vetores, as
quais não envolvem tanto esforço computacional quanto operações
envolvendo somente matrizes, presentes em métodos de solução
direta como 3.2.1. Por outro lado, o CG envolve quantia menor de
operações que o GMRes para a resolução do problema linear, o que
é permitido graças ao aproveitamento da simetria do problema,
além de requerer menor espaço para armazenamento dos vetores
que compõem seu algoritmo. Tais características tornam o CG
um método iterativo bastante atraente.

A fim de que o método descrito apresente uma taxa de
convergência elevada, é necessário o uso de um pré-condicionador
eficiente de acordo com o problema, observação válida inclu-
sive para qualquer outro método iterativo. Na próxima seção,
as técnicas de pré-condicionamento usualmente empregadas são
discutidas.

3.3 PRÉ-CONDICIONADORES

De modo simplificado, técnicas de pré-condicionamento
são responsáveis por modificarem o sistema linear inicial com o
intuito de facilitar seu processo de resolução através de métodos
iterativos (BENZI, 2002; GAMBOLATI; FERRONATO; JANNA,
2011). Nesse processo, diminui-se o raio espectral da matriz de
iteração referente à aplicação desse método, o que acarreta no
aumento de sua taxa de convergência para a obtenção da solução.
De fato, a busca por métodos iterativos eficientes resume-se à
definição de pré-condicionadores apropriados.

O novo problema obtido com a aplicação dessas técnicas
é referido como “pré-condicionado”, enquanto que o operador res-
ponsável por tal modificação é referido como “pré-condicionador”,
sendo normalmente representado pela matriz M?1.

Existem, basicamente, três maneiras de se aplicar um
pré-condicionador ao sistema linear original (3.1). A primeira e
mais comum, conhecida como “pré-condicionamento à esquerda”
é dada por

M?1Ax = M?1b; (3.10)



3.3. Pré-Condicionadores 81

a segunda é conhecida como “pré-condicionamento à direita”,
sendo dada por:

AM?1Mx = b; (3.11)

por fim, a última é referida como “pré-condicionamento misto”, a
qual combina as duas últimas estratégias para obter:

M?11 AM
?1
2 y = M

?1
1 b, x = M

?1
2 y. (3.12)

Pode-se mostrar que as matrizes M?1A, AM?1 e M?11 AM
?1
2 são

similares e portanto possuem os mesmos autovalores. No caso em
que A e M?1 são matrizes simétricas e positivo definidas (SPD),
solvers voltados para problemas simétricos como o gradiente con-
jugado apresentam a mesma taxa de convergência em qualquer
uma dessas estratégias. No entanto, quando alguma dessas matri-
zes é não-simétrica, torna-se necessário o uso de solvers específicos
como o GMRes ou o método do gradiente biconjugado estabili-
zado - BiConjugate Gradient Stabilized. (BiCGStab) - apresentam
taxas de convergência diferentes de acordo com a estratégia de
pré-condicionamento empregada (BENZI, 2002). Nesse trabalho,
adota-se o pré-condicionamento à esquerda (3.10).

As técnicas de pré-condicionamento podem também ser
classificadas em explícitas ou implícitas de acordo com a maneira
com que a multiplicação entre as matrizes A e M?1 é avaliada.
Conforme o nome sugere, na primeira estratégia, a matriz for-
mada pelo produto das outras duas é calculada explicitamente.
Já na segunda, o que é calculado é a ação do produto dessas
matrizes sobre um vetor arbitrário, uma vez que a aplicação de
pré-condicionadores em métodos iterativos resume-se a esse tipo
de operação matemática, ou seja

M?11 Ax = M
?1
1 y = z. (3.13)

Esta última estratégia é a mais comum, uma vez que propor-
ciona maior economia de recursos computacionais, e os pré-
condicionadores discutidos nesse capítulo se enquadram nesse
caso.

Duas características são fundamentais para a construção
de um pré-condicionador eficiente, elas são



82 Capítulo 3. Solução do Modelo Matemático

1. O produto M?1v deve ser próximo a A?1v com v um vetor
arbitrário. Diz-se nesse caso que a ação da matriz de pré-
condicionamento é próxima à ação da matriz inversa do
sistema original.

2. A construção e aplicação do pré-condicionador deve ser
barata em termos de recursos computacionais.

A primeira característica assegura que o solver iterativo
convergirá em poucas iterações (eficiência algébrica), enquanto que
a segunda condição proporciona que o custo computacional por
iteração seja baixo (eficiência computacional). É importante ob-
servar que essas condições competem entre si e portanto busca-se
obter um balanço entre elas. De fato, encontrar um bom pré-
condicionador para a resolução de um determinado sistema linear
é visto como uma combinação entre arte e ciência (SAAD, 2003).
Isso ocorre também porque seu uso eficiente é altamente depen-
dente do problema em questão: existem pré-condicionadores cujo
desempenho é atraente para determinadas classes de problemas
enquanto que para outras, pode se mostrar insatisfatório.

Nessa seção, apresentam-se as técnicas de pré-condicio-
namento comumente utilizadas na simulação de reservatórios,
suas vantagens e desvantagens, bem como o tipo de problema
linear que cada técnica é especializada em resolver. Destaca-se
aqui um dos objetivos fundamentais desse trabalho: a análise de
um pré-condicionador concebido para problemas elípticos.

3.3.1 Método da Sobre-Relaxação Sucessiva

O método da sobre-relaxação sucessiva - Successive Over-
Relaxation (SOR) - foi um dos primeiros pré-condicionadores a
ser empregado na resolução dos sistemas lineares presentes em si-
mulação de reservatórios. No início, esse método era normalmente
utilizado em conjunto com o solver Richardson 3.2.2, sendo muitas
vezes denominado diretamente como o solver do problema. Com
o desenvolvimento de solvers baseados em espaços de Krylov, fica
claro que tais métodos podem ser denominados apropriadamente
como pré-condicionadores ao invés de solvers.



3.3. Pré-Condicionadores 83

O SOR tem como motivação fundamental o desmembra-
mento da matriz de coeficientes em três partes: triangular inferior,
L; diagonal, D e triangular superior U, conforme mostrado na
figura 5.

Figura 5 – Decomposição LDU da matriz A.

D
L

U
A =

Inserindo-se um escalar ?, denominado de fator de rela-
xação, tal desmembramento pode ser escrito algebricamente da
seguinte maneira:

A =
(D + ?L)

?
+

(?U + (? ? 1) D)
?

. (3.14)

Desse modo, o pré-condicionador de sobre-relaxação sucessiva
pode ser escrito como:

M?1SOR = ? (D + ?L)
?1
, (3.15)

sendo que sua ação sobre um vetor arbitrário r pode ser calculada
a partir de substituição direta.

Hoje em dia, o algoritmo SOR deixou de ser empregado
diretamente para a solução do sistema linear 3.1. Ao invés disso,
este método é bastante utilizado no âmbito de pré-condicionadores
multigrid algébricos, desempenhando o papel de suavizador para
a redução das componentes de frequências elevadas do erro as-
sociado à solução proposta pelo solver iterativo. Isso é descrito
detalhadamente na seção 3.3.4.

No caso de problemas simétricos, uma variante do método
SOR denominada SSOR - Symmetric Successive Over Relaxation
é comumente empregada a fim de preservar a simetria do problema
inicial e permitir o uso de solvers simétricos como o gradiente



84 Capítulo 3. Solução do Modelo Matemático

conjugado. Esse pré-condicionador pode ser escrito algebricamente
da seguinte maneira:

M?1SSOR = ? (2 ??) (D + ?U)
?1 D (D + ?L)?1 , (3.16)

sendo que sua ação sobre um vetor arbitrário é dada de acordo
com o algoritmo 4.

Algoritmo 4: Aplicação de M?1SSOR sobre um vetor.
Data: L, U, r, ?.
Result: z = M?1SSOR r.

1 Resolva (D + ?L) x1 = ? (2 ??) r por substituição
direta.

2 Calcule x2 = Dx1.
3 Resolva (D + ?U) z = x2 por substituição reversa.

3.3.2 Fatoração LU Incompleta

Fatoração LU incompleta - Incomplete LU Factorization
(ILU) - consiste em uma classe de pré-condicionadores baseados na
fatoração aproximada da matriz original A, isto é, desprezando-se
os elementos não-nulos adicionais que formariam os fatores trian-
gulares L e U exatos caso a fatoração LU 3.2.1 fosse empregada.
Desse modo, a matriz de pré-condicionamento M?1ILU é dada por:

M?1ILU = U?
?1L??1. (3.17)

Estes pré-condicionadores foram um dos primeiros apli-
cados na simulação de reservatórios para a resolução de ambas
equações elípticas e hiperbólicas presentes no modelo do escoa-
mento (BEHIE; VINSOME, 1982; BEHIE; COLLINS; JR., 1984).
Hoje em dia, são comumente utilizados para a resolução das equa-
ções hiperbólicas do modelo apenas. Seu algoritmo é apresentado

No pré-condicionador ILU mais simples, denominado de
ILU(0), os fatores L? e U? são calculados de modo que a soma do



3.3. Pré-Condicionadores 85

Algoritmo 5: Aplicação da fatoração ILU.
Data: A ? L?U?.
Result: z = M?1ILUr = U?

?1L??1r.
1 Resolva L?y = r por substituição direta.
2 Resolva U?z = y por substituição reversa.

número de elementos não nulos de cada fator seja igual àquele
referente à matriz original A. Diz-se nesse caso que o grau de
preenchimento do algoritmo é nulo. A demanda computacional
associada à construção desse pré-condicionador é baixa, sendo
que tal estratégia se mostra eficiente em muitos problemas sim-
plificados. No entanto, em casos complexos, torna-se necessário o
uso de estratégias mais robustas.

Nesse sentido, um pré-condicionador baseado em fatoração
LU incompleta mais robusto que o anterior é o ILUTP(?,?)
(SAAD, 1994a; SAAD, 1994b). Esse obtém fatores triangulares L?
e U? aproximados ao desprezar entradas da matriz A cujo valor
desobedece a um determinado critério definido pela tolerância
absoluta ?. Além disso, dada uma linha da matriz A, somente as ?
maiores entradas são retidas na formação dos fatores triangulares.
O objetivo da primeira aproximação consiste em reduzir o custo
computacional referente ao cálculo do pré-condicionador, enquanto
a segunda consiste em controlar o uso de memória (SAAD, 2003).
Por último, uma diferença notável desse algoritmo em relação
ao anterior consiste na adição de um passo para o pivotamento
das linhas da matriz A. Esta operação tem como finalidade a
estabilização do algoritmo, dando origem a fatores triangulares
cuja inversa tem norma controlada, o que melhora a convergência
do solver iterativo.

As estratégias discutidas anteriormente são aplicáveis
tanto para problemas não-simétricos como simétricos. Sabe-se que
a fatoração exata destes últimos conduz a matrizes L e U que são
transpostas uma em relação a outra. Esse fato pode ser levado
em consideração para o desenvolvimento de outras estratégias de
fatoração incompleta que reduzem o espaço de memória RAM



86 Capítulo 3. Solução do Modelo Matemático

utilizado pelo algoritmo. Um exemplo largamente empregado é a
fatoração Cholesky incompleta (KERSHAW, 1978).

Desenvolvimentos recentes em fatoração incompleta têm
sido no sentido de aumentar a eficiência no cálculo dos fatores
triangulares a partir de algoritmos multifrontais (SAAD, 1996;
OSEI-KUFFUOUR; SAAD, 2015) e também de reordenamento
da matriz de coeficientes original conforme descrito na seção
3.2.1, os quais também alteram a própria qualidade dos fatores
triangulares aproximados e a convergência do método iterativo.

3.3.3 Constrained Pressure Residual

O pré-condicionador CPR foi desenvolvido inicialmente
por Wallis (1983) e Wallis, Kendall e Little (1985) para a solução
de sistemas lineares provenientes da discretização acoplada de pro-
blemas multifásicos. A ideia fundamental desse pré-condicionador
é desacoplar o problema inicial segundo os diferentes fenômenos
físicos que este modela, desse modo, os subproblemas obtidos
podem ser resolvidos de acordo com pré-condicionadores apropri-
ados.

Na simulação de reservatórios isotérmicos, o sistema origi-
nal pode ser dividido em dois subsistemas. O primeiro é definido
em função da incógnita pressão. Do ponto de vista da álgebra
linear, este é classificado como semipositivo definido e apresenta
caráter aproximadamente elíptico sendo comumente resolvido
através de pré-condicionadores do tipo multigrid. Já o segundo o
sistema linear refere-se à incógnita saturação, é não-simétrico e
apresenta caráter hiperbólico sendo comumente resolvido através
de pré-condicionadores baseados em fatoração LU incompleta. A
algoritmo 6 descreve a ação do pré-condicionador CPR tradicio-
nal (CAO et al., 2005), representado por M?1CPR sobre um vetor
arbitrário r.

A etapa inicial dos pré-condicionadores CPR consiste na
obtenção de um sistema linear envolvendo somente a variável
pressão. Este é formado a partir da multiplicação de uma determi-
nada matriz pelo sistema linear original, que envolve as variáveis
primárias. A escolha dessa matriz de desacoplamento representa



3.3. Pré-Condicionadores 87

Algoritmo 6: Pré-condicionador CPR
Data:

A =
[

App Aps
Asp Ass

]
; r = b? Ax.

Result: z = M?1CPRr.
1 Defina:

P =
[

Ipp
0sp

]
; R = PT ? App = RAP.

2 Restrinja o resíduo global para a parcela referente à
pressão: rp = Rr.

3 Resolva o problema elíptico: (RAP) xp = rp.
4 Prolongue xp para obter a solução global: u = Pxp.
5 Corrija o resíduo global: v = r ? Au.
6 Aplique o pré-condicionador ILU no sistema global
para obter: w = ILU(A)v.

7 Combine os resíduos obtidos no primeiro e segundo
estágios: z = u + w.

uma área ativa de pesquisa, de modo que diversas escolhas já
foram desenvolvidas, as mais conhecidas são: Alternate Block
Factorization (ABF) (LACROIX et al., 2003; MASSON et al.,
2004), quasi-IMPES (SCHEICHL; MASSON; WENDEBOURG,
2003), reflexões de Householder (SCHEICHL; MASSON; WEN-
DEBOURG, 2003), Dynamic Row Sum (DRS) (GRIES et al.,
2014) e Weighted Dynamic Row Sum (WDRS) (BROWN; COL-
LINS; CHEN, 2015). O sistema obtido para a pressão é resolvido
aproximadamente através de pré-condicionadores AMG, em que
costuma-se aplicar apenas uma iteração do método. Por sua vez,
tal solução é utilizada para atualizar o resíduo referente à pressão
e, em seguida, o resíduo do sistema completo. Por fim, aplica-se
um pré-condicionador baseado em fatoração incompleta, como
descrito na seção 3.3.2, no vetor resíduo atual conduzindo a uma
nova solução para os campos das variáveis pressão e saturação.



88 Capítulo 3. Solução do Modelo Matemático

Do ponto de vista algébrico, a aplicação do pré-condicionador
CPR pode ser escrita na seguinte forma compacta:

M?1CPR = P (RAP)
?1 R+

ILU(A)
[
I ? AP (RAP)?1 R

]
.

(3.18)

3.3.4 Multigrid Algébrico

Métodos multigrid foram desenvolvidos inicialmente na
década de 70 para a resolução eficiente de equações diferenciais
parciais escalares com caráter elíptico (STUBEN, 2001). Sua ideia
fundamental consiste na resolução aproximada da equação 3.1
através da aplicação de um método iterativo simples nesse sistema
em conjunto com uma correção proveniente da resolução exata de
um problema com menor número de incógnitas e relacionado com
o original. Esta ideia pode ser estendida recursivamente, dando
origem a diversos níveis de malha, daí o nome do método. A título
de simplificação, a abordagem descrita nessa seção considera
métodos multigrid de dois níveis, porém também apresenta-se,
devido a sua vasta aplicação, o operador algébrico referente ao
pré-condicionador multigrid algébrico de vários níveis.

Na nomenclatura do multigrid, o método iterativo empre-
gado em todos os níveis de malha, exceto o grosseiro, é denominado
como “suavizador”, sendo responsável por eliminar as componen-
tes de alta frequência do erro4 tornando-as suaves em relação à
malha adotada. O suavizador é denotado por S, sendo que sua
ação pode ser expressa por:

xk+1 = Sxk + (I ? S) A?1b, S = I ? M?1A. (3.19)

Escolhas comuns podem ser representadas por M?1 = M?1SOR,
conforme definido pela equação (3.15), ou M?1 = M?1SSOR, con-
forme (3.16). Já a correção obtida a partir do sistema grosseiro é
calculada através de um solver direto, de modo que esta é respon-
sável por eliminar as componentes suaves ou de baixa frequência
4 Aquelas cujo comprimento de onda é da ordem do espaçamento observado

entre as incógnitas da malha em questão, segundo análise de Fourier.



3.3. Pré-Condicionadores 89

do erro em malha refinada que passam a ser classificadas como
de alta frequência na malha grosseira.

O “nível refinado” refere-se ao conjunto de incógnitas que
compõem o sistema linear original (ou a malha computacional
original, no caso de métodos multigrid geométricos) de tamanho
N1, enquanto que o “nível grosseiro” refere-se àquelas selecionadas
para compor um sistema de menor de tamanho N0&amp;lt;&amp;lt;N1 que
aproxima, de alguma maneira, o primeiro. O operador que realiza
a transferência de informações do nível grosseiro para o nível
refinado é denominado como P, de formato retangular e ordem
N1×N0. Já a transferência de informações no sentido oposto é feita
segundo o operador R, de ordem N0 ×N1. Usualmente considera-
se que R = PT, conhecida como formulação de Galerkin, a qual
preserva a simetria do problema inicial, caso exista. Definidos tais
operadores, pode-se construir o sistema linear em nível grosseiro
Ac da seguinte maneira:

Ac = RAP. (3.20)

É importante observar que esse processo faz com que o número
de elementos não-nulos por linha da matriz Ac seja maior que
aquele referente à matriz A. Nesse sentido, medidas do uso de
memória associado aos métodos multigrid podem ser estabelecidas
de acordo com as complexidades referentes à malha CG e ao
operador CA, dadas por:

CG =
?
l

(
Nl
Nn?1

)
, CA =

?
l

(
ml
mn?1

)
, (3.21)

em que Nl e ml denotam o número de variáveis e de elementos
não-nulos referentes ao nível l, respectivamente, com n? 1 sendo
o nível mais refinado, no caso em que há mais de dois níveis.

De modo semelhante à fatoração LU incompleta, o uso de
um pré-condicionador multigrid é marcado por duas fases: configu-
ração ou setup e aplicação do pré-condicionador. A primeira fase
é constituída essencialmente por duas outras: a de engrossamento,
do inglês coarsening, e a de interpolação, do inglês interpolation.
Na etapa de engrossamento, determinam-se recursivamente as va-
riáveis que serão mantidas a cada nível de malha empregada pelo



90 Capítulo 3. Solução do Modelo Matemático

método, enquanto que na etapa de interpolação, determinam-se
os operadores de restrição R e prolongação P.

Existem diversas maneiras de se definir as etapas de en-
grossamento e interpolação. No multigrid geométrico, o engrossa-
mento é determinado de acordo com a malha empregada no pro-
cesso de discretização, enquanto que a interpolação é construída
de modo constante por partes. Já na implementação BoomerAMG
do multigrid algébrico, o engrossamento pode ser realizado princi-
palmente de acordo com os algoritmos RS, RS3, CLJP e Falgout;
enquanto que para a interpolação, podem ser empregados os algo-
ritmos clássico, direto, padrão ou multi-passe (HENSON; YANG,
2002).

Considerando S(1,?), um suavizador com ? iterações e
M?11 , sua representação no formato de pré-condicionador con-
forme (3.19); S0, um solver direto para o cálculo da ação de
(Ac)?1 sobre um vetor arbitrário e x0, uma estimativa inicial para
a solução do problema 3.1, a aplicação de um pré-condicionador
multigrid de dois níveis em um vetor arbitrário pode ser descrita
algebricamente conforme o algoritmo 7.

Algoritmo 7: Multigrid de dois níveis.
Data: A, b, x0, r0 = b? Ax0, P, R, S0.
Result: z = M?1AMGr0.

1 x1/3 = x0 + M?11 (b? Ax0)
2 x2/3 = x1/3 + P S0 R

(
b? Ax1/3

)
3 x1 = x2/3 + M?11

(
b? Ax2/3

)
4 z = x1 ?x0

É importante observar que tal algoritmo pode ser esten-
dido para múltiplos níveis quando aplicado recursivamente no
lugar de S0. Além disso, sua etapa de aplicação costuma deman-
dar menor quantidade de recursos computacionais que a etapa de
configuração do método.

Como realizado para os outros pré-condicionadores, a ma-
triz que representa a ação do multigrid sobre um vetor arbitrário



3.3. Pré-Condicionadores 91

pode ser representada da seguinte maneira:

M?1AMG =
[
I ?

(
I ? M?11 A

)(
I ? P S0 R A

)(
I ? M?11 A

)]
A?1,

(3.22)
ou também, de modo expandido, como:

M?1AMG =M
?1
1 +

PS0R
(
I ? AM?11

)
+

M?11
(
I ? APS0R

)(
I ? AM?11

)
.

(3.23)

No caso genérico em que o método multigrid apresenta n
níveis com M?1l , pré-suavizador e N

?1
l , pós-suavizador relativos

ao nível l, ambos no formato de pré-condicionador. Considerando
também que Rl e Pl são os operadores de restrição e prolongação
referentes ao nível l, sendo que Rn?1 = Pn?1 = I, a ação de um
ciclo V do multigrid pode ser expressa algebricamente da seguinte
maneira:

M?1AMG =
[
I ?

n?1?
l=1

(
I ?

(
PM?1R

)
(n?l)

A
)
×

(
I ?

(
P0S0R0

)
A
)
×

n?1?
l=1

(
I ?

(
PN?1R

)
l
A
)]

A?1

(3.24)

Nos métodos multigrid, estratégias adequadas de cons-
trução dos operadores de interpolação bem como de seleção das
variáveis que irão compor o sistema grosseiro são cruciais para a
obtenção de taxas de convergência elevadas e pouco dependentes
do número de incógnitas. Via de regra, quanto maior é o esforço
computacional para a construção de interpoladores eficientes,
maior é a taxa de convergência numérica do pré-condicionador5,
5 Os autovalores da matriz de iteração SAM G =

(
I ? M?1AM GA

)
estão

agrupados em torno de zero.



92 Capítulo 3. Solução do Modelo Matemático

no entanto a redução do número de iterações necessárias para a
convergência pode ser insuficiente para pagar tal esforço adicio-
nal. Por outro lado, quanto mais simples forem os algoritmos de
interpolação e engrossamento, maiores são as restrições quanto
à qualidade dos suavizadores empregados, isto é, eles precisam
ser ainda mais eficientes na redução das componentes de diversas
frequencias do erro. Segue que a definição de algoritmos AMG
eficientes recai em encontrar um balanço ótimo entre estraté-
gias de interpolação e engrossamento em relação a estratégias
de suavização (TROTTENBERG; OOSTERLEE; SCHÜLLER,
2001).

No âmbito da simulação do escoamento em reservatórios,
métodos multigrid foram empregados inicialmente por Behie e
Forsyth (1983) para a resolução da equação da conservação da
massa, a qual apresenta caráter aproximadamente elíptico6. Desde
então, essa classe de métodos vem sendo largamente aplicada,
especialmente sua variante algébrica, e também aperfeiçoada para
o tratamento de problemas apresentando novas técnicas de discre-
tização numérica referentes a malhas cada vez mais complexas,
além de fenômenos físicos desafiadores(STUBEN, 2007; KLIE et
al., 2007; CLEES; GANZER, 2010; KILLOUGH; WANG, 2013;
GRIES et al., 2014; GRIES; PLUM, 2015; BROWN; COLLINS;
CHEN, 2015; BARKER et al., 2015). Descrições mais detalhadas
da teoria por trás dos métodos multigrid podem ser encontradas
nos trabalhos de Hackbusch (1985) e Trottenberg, Oosterlee e
Schüller (2001), enquanto que boas revisões sobre avanços refe-
rentes aos métodos multigrid algébricos podem ser verificadas em
Stuben (2001), Henson e Yang (2002) e Yang (2006).

3.3.5 Decomposição de Domínio

Métodos de decomposição de domínio, do inglês Domain
Decomposition (DD), foram introduzidos inicialmente em 1870
por Schwarz para a resolução de problemas elípticos em domínios
6 A presença de poços bem como falhas ou fraturas no reservatório pode

degradar o caráter elíptico do operador de Poisson, por isso diz-se “apro-
ximadamente elíptico”.



3.3. Pré-Condicionadores 93

construídos pela sobreposição de formas geométricas bem esta-
belecidas como retângulos e círculos. Desde então, esses métodos
receberam vários aperfeiçoamentos e suas ideias foram propagadas
para diversas áreas de conhecimento envolvendo a resolução de
equações diferenciais parciais.

Do ponto de vista da álgebra linear computacional, tais
métodos podem ser vistos como pré-condicionadores destinados à
resolução de problemas lineares elípticos através de uma estratégia
baseada em “divisão e conquista”. Isto é, dado um sistema linear
referente ao tipo (3.1), este é decomposto em diversos sistemas de
menor tamanho e desacoplados entre si; tais sistemas são resol-
vidos por meio de algum solver e suas soluções são combinadas
de alguma maneira para a construção da resposta do problema
inicial. É interessante observar que a resolução desses subproble-
mas apresenta elevado grau de paralelização, uma vez que eles
são desacoplados entre si.

Os pré-condicionadores baseados em decomposição de
domínios envolvem a especificação de um conjunto de parâmetros,
que são resumidos a seguir:

a) método de particionamento da malha, o qual é res-
ponsável por determinar a maneira como o problema
inicial é dividido em subproblemas menores. Aqui
inclui-se a possibilidade da construção de subdomínios
sobrepostos. Essa é uma tarefa simples em malhas
estruturadas, mas pode ser complexa no caso de ma-
lhas não-estruturadas e demandar o uso de algoritmos
complexos de particionamento da malha. Estratégias
bem estabelecidas para tanto estão implementadas
nas bibliotecas METIS (KARYPIS; KUMAR, 1998) e
PT-Scotch (CHEVALIER; PELLEGRINI, 2008). Um
bom algoritmo de particionamento conduz à subpro-
blemas de tamanhos semelhantes, diz-se nesse caso
que o balanço de carga é bom;

b) estratégia de solução dos subproblemas, que podem
ser resolvidos diretamente nos pré-condicionadores DD
exatos ou iterativamente nos inexatos de acordo com al-



94 Capítulo 3. Solução do Modelo Matemático

gum solver iterativo associado a um pré-condicionador,
conforme apresentados nas seções 3.2 e 3.3, respecti-
vamente;

c) maneira como as soluções dos subproblemas são com-
binadas, aqui existem duas estratégias. Na primeira
categoria denominada de aditiva, os subproblemas são
resolvidos separadamente de modo que a soluções de
subproblemas acoplados entre si (caso de subdomí-
nios vizinhos na malha) não interferem entre si. Já
na segunda categoria, denominada de multiplicativa,
tal acoplamento é levado em consideração de modo
semelhante ao realizado no método de Gauss-Seidel.
Observa-se que a primeira alternativa conduz a pré-
condicionadores menos eficientes do ponto de vista
algébrico, porém que podem ser facilmente implemen-
tados em máquinas paralelas.

Consideremos que a malha computacional referente ao
sistema linear (3.1) seja dividida em NC subdomínios possivel-
mente sobrepostos entre si. Seja Ri o operador composto de 0
e 1 que restringe tal sistema linear ao subsistema i ? [1 NC],
referente ao subdomínio de mesmo índice. Tal subsistema pode
ser representado por:

RiAx = Rib

? RiARTi Rix = Rib

? Aixi = bi. (3.25)

A resolução independente dos subsistemas gerados com “i” vari-
ando de 1 a NC dá origem ao pré-condicionador Schwarz aditivo
de um nível, definido a seguir:

M?1AS1 =
NC?
i=1

(
RTi A

?1
i Ri

)
. (3.26)

A taxa de convergência desse pré-condicionador é bas-
tante dependente do grau de sobreposição especificado entre os



3.3. Pré-Condicionadores 95

subdomínios. Quanto maior esse grau, mais rápido se dá a trans-
ferência de informações de um subdomínio para seus vizinhos e
maior será a taxa de convergência do método iterativo empregado
para a resolução do problema original. Por outro lado, graus de
sobreposição elevados podem conduzir a subsistemas de dimensões
elevadas, cuja resolução requer um tempo adicional maior que
aquele poupado por conta do aumento da taxa de convergência.
Portanto, segue que existe um grau de sobreposição ótimo na
definição desse pré-condicionador.

Uma outra estratégia comumente empregada para aumen-
tar a taxa de convergência dos pré-condicionadores DD consiste
em adicionar a resolução de um problema global em sua formu-
lação. Tal problema é responsável por acoplar os subproblemas
num mesmo sistema linear, o qual é definido num espaço grosseiro
de dimensão Ng muito menor que a do problema inicial Nf e que
costuma ser igual ao número de subdomínios tratados. Seja R0 o
operador de dimensão Ng ×Nf, responsável por realizar a trans-
ferência entre os níveis refinada e grosseiro, o pré-condicionador
Schwarz aditivo de dois níveis, pode ser definido da seguinte
maneira:

M?1AS2 =
NC?
i=0

(
RTi A

?1
i Ri

)
. (3.27)

A solução do problema grosseiro pode ainda ser combinada
de modo multiplicativo com as soluções dos subproblemas locais.
Isso dá origem ao pré-condicionador Schwarz híbrido de dois
níveis, exposto a seguir:

M?1HS2 =

?
?NC?
i=0

(
RTi A

?1
i Ri

)???
?
?NC?
i=1

(
RTi A

?1
i Ri

)?? A (RT0 A?10 R0) .
(3.28)

A qualidade do espaço grosseiro ?0 é determinada pela
sua estratégia de construção e também pelas características do
problema em questão, como a distribuição do campo de permeabi-
lidade em problemas de simulação de reservatórios. Boas técnicas
são fundamentais para a construção de pré-condicionadores esca-
láveis. Esta tarefa é, de fato, uma área ativa de pesquisa. Nesse



96 Capítulo 3. Solução do Modelo Matemático

âmbito, é importante citar os recentes trabalhos de Dolean et
al. (2012) e Dolean et al. (2014), que desenvolveram um método
para a construção de espaços grosseiros bastante robustos, sendo
gerados por um número pequeno e bem selecionado de auto-
vetores provenientes de problemas de autovalores generalizados
definidos nos subdomínio locais. Conforme será apresentado em
capítulo posterior, o método multiescala pode ser visto como uma
metodologia para a construção de um espaço grosseiro específico.

Pré-condicionadores DD apresentam bastante semelhança
com pré-condicionadores multigrid pois ambos são classificados
como métodos de correção em subespaço (XU, 2001). Por um lado,
métodos multigrid são técnicas multiníveis conhecidas por empre-
gar graus de refino moderado e métodos de relaxação simples. Por
outro, métodos de decomposição de domínio são normalmente
restritos a dois níveis e conhecidos por empregar graus de refino
elevados, além de métodos de relaxação mais robustos para a
resolução dos sistemas lineares em nível refinado.

Por fim, descrições mais detalhadas dos pré-condicionadores
baseados em decomposição de domínio podem ser encontradas nos
trabalhos (SMITH; BJøRSTAD; GROPP, 1996; TOSELLI; WI-
DLUND, 2005; MATHEW, 2008; DOLEAN; JOLIVET; NATAF,
2015).



97

4 MÉTODO DOS VOLUMES FINITOS MULTIESCALA -
MSFVM

Métodos multiescala são técnicas computacionais desen-
volvidas para a resolução eficiente e aproximada de equações
elípticas na forma (2.53) envolvendo tensores de permeabilidade
heterogêneos. Tais equações podem ser encontradas em diver-
sas aplicações na engenharia, desde a simulação de reservatórios
carbonáticos até a transferência de calor em materiais compósitos.

Nesses métodos verifica-se algo parecido com o upscaling,
pois propõem uma solução aproximada para o escoamento em
reservatórios a partir de um modelo em nível grosseiro, isto é, com
menor número de incógnitas em relação ao original. A construção
desse modelo é realizada de acordo com a solução de problemas
locais definidos em subdomínios da malha original. Isso é realizado
dentro de uma etapa de configuração do método, anterior à etapa
de solução, em que o problema na malha grossa é resolvido.

No caso de escoamento multifásico, o problema grosseiro
pode ainda ser dinâmico, isto é, atualizado ao longo da simulação
a medida que variações locais no campo de mobilidade dos fluidos
são observadas. Isso confere uma grande vantagem aos métodos
multiescala em relação às técnicas de upscaling, uma vez que o
modelo grosseiro pode se adequar às peculiaridades do escoamento
ao longo da simulação, conduzindo a soluções que representam
melhor o modelo geológico tratado. Além disso, as soluções obti-
das por esses métodos podem ser projetadas na malha original
do problema, o que não é permitido por técnicas de upscaling
tradicionais.

Diversos métodos multiescala foram propostos nos últimos
20 anos, todos eles baseados em uma abordagem envolvendo
dois níveis de malhas, no entanto, apresentando diferenças na
metodologia empregada para a construção do problema em nível
grosso. Entre os mais conhecidos é possível citar:

a) método dos elementos finitos multiescala (MsFEM),
do inglês Multiscale Finite Element Method, o qual
é baseado no método dos elementos finitos e foi o
primeiro método multiescala desenvolvido de acordo



98 Capítulo 4. Método dos Volumes Finitos Multiescala - MsFVM

com os trabalhos de Hou e Wu (1997) e Hou, Wu e
Cai (1999). Uma descrição detalhada desse método
contendo os últimos avanços pode ser verificada no
trabalho de Efendiev e Hou (2009);

b) método dos elementos finitos multiescala misto (MMs-
FEM), Mixed Multiscale Finite Element Method, que
expandiu as ideias dos métodos multiescala presen-
tes no MsFEM para ambas resoluções do escoamento
(pressão) e do transporte (saturação) (CHEN; HOU,
2003; AARNES; KIPPE; LIE, 2005; ALPAK; PAL;
LIE, 2012; PAL et al., 2014) no contexto dos métodos
de elementos finitos mistos (ARNOLD, 1990; ARBO-
GAST; WHEELER; YOTOV, 1997);

c) método dos volumes finitos multiescala (MsFVM) -
Multiscale Finite Volume Method - (JENNY; LEE;
TCHELEPI, 2003), que adéqua as ideias dos métodos
multiescala ao contexto do método dos volumes finitos;

d) método dos elementos finitos multiescala generalizado
(GMsFEM) - Generalized Multiscale Finite Element
Method, o qual deriva do MsFEM e propõe uma me-
todologia baseada em decomposição espectral para a
construção de operadores em nível grosseiro de me-
lhor qualidade (BUSH; GINTING; PRESHO, 2013;
CHUNG; EFENDIEV; LI, 2014; PRESHO; GALVIS,
2015).

Na simulação de reservatórios, os métodos multiescala que
mais se destacam entre os citados são o MsFVM e o MMsFEM.
Isso se dá pelo fato de conduzirem a soluções conservativas para
o campo de pressão em malha refinada, isto é, que geram campos
de velocidade satisfazendo o princípio de conservação da massa
na malha original do problema. Conforme discutido no capítulo 2,
isto é essencial para a resolução apropriada de equações hiperbóli-
cas como a referente à saturação. No MMsFEM, tal característica
é atendida às custas de maior empenho computacional em relação
ao MsFVM, já que ambas variáveis pressão e velocidade são resol-
vidas implicitamente, isto é, a partir de um sistema de equações



99

algébricas. Por conta disso e também pelo fato do MsFVM traba-
lhar com malhas estruturadas, largamente aplicadas na simulação
de reservatórios, tal estratégia é estudada no presente trabalho.

Nesse capítulo, descreve-se a formulação matemática do
método dos volumes finitos multiescala. A título de exemplifica-
ção, considera-se um problema bidimensional, pois isso facilita a
visualização dos conceitos básicos do método em relação ao caso
3D, o qual pode ser obtido por extensão das ideias aqui descritas.
A apresentação descrita será de grande ajuda para a compreensão
do pré-condicionador multiescala algébrico, discutido no capítulo
seguinte, segundo um ponto de vista físico, uma vez que ambas
estratégias compartilham das mesmas estruturas básicas.

O problema tratado consiste no escoamento monofásico,
incompressível e sujeito a efeitos gravitacionais através de um
meio poroso de dimensões 150 m × 150 m com fronteiras imper-
meáveis, cujo campo de permeabilidade é isotrópico e altamente
heterogêneo sendo dado pela figura 6.

Figura 6 – Problema teste: logaritmo do campo de permeabilidade
absoluta - log10(K[mD]).

x [m]
0 50 100 150

y 
[m

]

0

50

100

150

0.5

1

1.5

2

2.5

3

log
10

 (K [mD])

Considera-se que água escoa nesse reservatório nas con-



100 Capítulo 4. Método dos Volumes Finitos Multiescala - MsFVM

dições padrão de pressão e temperatura. Por fim, há um poço
injetor com pressão prescrita de 300 MPa e um poço produtor com
pressão prescrita de 10 MPa no reservatório conforme ilustrado
na figura 7 de acordo com os índices I e P, respectivamente.

Apesar de já apresentada na seção 2.3, reescreve-se a seguir
a equação que modela o escoamento incompressível monofásico:

?· (??p) = ?· (??g?z) ?qs, (4.1)

em que o lado esquerdo descreve a variação do campo de pressão
enquanto o lado direito refere-se a efeitos gravitacionais e de
entrada ou saída de massa através dos poços.

Ao invés de utilizar a malha refinada ?? diretamente para a
solução do escoamento, o MsFVM emprega duas malhas grosseiras
relacionadas entre si. Estas são ilustradas na figura 7 e definidas
em seguida.

Figura 7 – Problema teste: malhas envolvidas no MsFVM.

?
D

?
C~

~

?
~

I

P

a) ?? refere-se a uma discretização em nível refinado para
o domínio ? totalizando Nf volumes de controle. Nesse
exemplo, tal malha é composta por 15 × 15 volumes
de controle cujo interior é colorido em branco;



4.1. Funções Base Duais 101

b) ??C é chamada de malha primal, sendo uma discreti-
zação em nível grosseiro para o domínio ? formada
por NC volumes de controle, que por sua vez são
construídos a partir de um conjunto de subvolumes
pertencentes à malha refinada ??. Na figura 7, a malha
grosseira primal é definida por 3 × 3 volumes tota-
lizando NC = 9 sendo que um exemplo de volume
pertencente a essa malha é ilustrado em verde. Esta
malha é empregada para o cálculo, na malha refinada,
de um campo de velocidade conservativo;

c) ??D é denominada de malha dual, sendo uma discreti-
zação em nível grosseiro para o domínio ? deslocada
em relação à malha primal, de modo que os volumes
de controle em malha refinada que constituem o centro
dos volumes de controle primais formam os vértices
dos volumes duais. O número desses últimos é igual
a ND, sendo que, no problema considerado, eles são
delimitados de acordo com as linhas pontilhadas e
ND = 16. Os volumes de controle da malha refinada
associadas com o sexto volume dual são coloridos em
amarelo na figura 7. Esta malha é empregada para o
cálculo de uma solução aproximada para o campo de
pressão.

4.1 FUNÇÕES BASE DUAIS

Na formulação original do MsFVM (JENNY; LEE; TCHE-
LEPI, 2003), definem-se problemas locais e independentes na ma-
lha dual conforme apresentado pela equação 4.2, isto é, em cada
um dos subdomínios de ? definidos por ??Dj , para j = 1, 2, · · · ,ND.

??????
?????
?·

(
???ji

)
= 0, em ??Dj ;

?t ·
(
???ji

)
= 0, em ???Dj ;

?
j
i (xk) = ?ki, xk ? ?.

(4.2)



102 Capítulo 4. Método dos Volumes Finitos Multiescala - MsFVM

As incógnitas ?ji, denominadas como funções base duais,
são responsáveis por captar variações locais do campo de permea-
bilidade. Com a discretização da equação diferencial presente no
problema (4.2), as funções base ?ji são calculadas ao longo dos
volumes internos associados ao subdomínio “j” da malha dual.
O conjunto ? é formado pelas coordenadas relativas aos vértices
dos volumes de controle duais denotados por “x” na figura 7, ou
seja, as mesmas referentes ao centro dos volumes de controle da
malha primal.

A condição de contorno empregada nesse problema é
denominada como “reduzida”. Proposta inicialmente por Hou e
Wu (1997) e também utilizada pelo método dos elementos finitos
multiescala, esta é obtida a partir da solução homogênea da
equação diferencial (4.1), ou seja, desconsiderando-se os termos
presentes em seu lado direito. Além disso, considera-se que não
há escoamento na direção “~n”, que é normal à fronteira ???Dj ,
restando somente os termos na direção tangencial, denotada por
“t”, sendo que o operador ?t pode ser expresso da seguinte forma:

?t = (I ? P~n)? =
(
I ?~n~nT

)
?. (4.3)

Através da última relação apresentada na equação (4.2),
especifica-se que ?ji assume valor nulo nos vértices do volume
dual exceto em um deles, cujo valor é igual à unidade. O processo
é repetido até que todos os vértices sejam varridos, por isso o
subíndice “i”. Desse modo, calculam-se quatro funções base para
cada volume dual no caso 2D ou oito, no caso 3D. É importante
notar que o suporte das funções base referentes ao volume dual
“j” é restrito à região desse mesmo volume. As funções base duais
referentes ao volume de controle dual indicado na figura 7 são
dadas pela figura 8.

A condição de contorno reduzida estabelece uma maneira
de se calcular a distribuição de ?ji em ???

D
j . Esta é justamente

a aproximação adicionada pelo MsFVM durante a solução do
problema (4.1) em escala refinada. É importante notar que, se tal
condição de contorno pudesse ser escolhida como a própria solução
do problema em escala refinada, o esquema proposto conduziria à



4.2. Problema na Malha Grossa 103

Figura 8 – Problema teste: funções base duais.

Função base dual ?
4

Função base dual ?
3

Função base dual ?
1

Função base dual ?
2

0

0.1

0.2

0.3

0.4

0.5

0.6

0.7

0.8

0.9

1

mesma solução encontrada pela aplicação do método dos volumes
finitos nesse nível e não haveria aproximação do MsFVM em
relação à solução do problema original em malha refinada.

Construídas as funções base duais, uma solução aproxi-
mada para o campo de pressão em escala refinada pode ser escrita
pela superposição dessas funções com um campo de pressão pCi
conforme a equação:

p ? p
?

=
ND?
j=1

?
?NC?
i=1

?
j
ip
C
i

?
? . (4.4)

4.2 PROBLEMA NA MALHA GROSSA

O campo de pressão em escala grosseira pCi presente na
equação 4.4 é calculado a partir da resolução do escoamento na
malha primal ??C. Substituindo-se (4.4) na equação (4.1), obtém-
se

?·

?
??? ND?

j=1

?
?NC?
i=1

?
j
ip
C
i

?
?
?
? = ?· (?g??z) ?qs. (4.5)



104 Capítulo 4. Método dos Volumes Finitos Multiescala - MsFVM

Integrando-se a equação (4.5) no volume de controle “i”
da malha grosseira primal ??C:

?
??C

i

?·

?
??? ND?

j=1

?
?NC?
i=1

?
j
kp
C
k

?
?
?
?d? = ?

??C
i

[?· (?g??z) ?qs] d?,

(4.6)

?
?i?
k=i

?
???
?

???C
i

?
?? ND?

j=1
??jkp

C
k

?
?~n d?

?
??? =

?
??C

i

rd?, (4.7)

em que o conjunto ?i agrupa os volumes de controle da ma-
lha primal que influenciam na equação referente ao volume ?Ci ,
enquanto o termo r representa o lado direito da equação (4.1).
Prosseguindo a dedução:

?i?
k=i

?
???
ND?
j=1

?
???C

i
???D

j

(
???jk

)
~n d?

?
???pCk =

?
??C

i

rd? (4.8)

?
?i?
k=i

Tikp
C
k = q?i (4.9)

? TpC = q?. (4.10)

A equação (4.10) define o sistema linear para o campo de
pressão na malha grossa, o qual é ilustrado na figura 9 para o
problema teste. É importante observar que tal solução conduz a
um campo de velocidade conservativo nesse nível de malha, já
que foi obtida através da aplicação do método dos volumes finitos.

Após a obtenção do campo de pressão na malha grossa, o
campo de pressão na malha refinada ?? pode ser calculado a partir
da equação (4.4), mediante o uso das funções base duais. A figura
10 ilustra à direita esse campo para o problema teste, bem como o
campo de pressão de referência, à esquerda, calculado através de
um método de solução direto. Uma vez que as funções base duais



4.2. Problema na Malha Grossa 105

Figura 9 – Problema teste: campo de pressão referente à malha
grosseira.

x [m]
0 50 100 150

y 
[m

]

0

50

100

150

12

14

16

18

20

22

24

P [MPa]

apenas aproximam as variações do campo de permeabilidade em
nível refinado (local) ao invés de as reproduzirem fielmente, tem-se
que o campo de pressão obtido em nível refinado pelo MsFVM
não é equivalente ao de referência, apesar de bastante próximo.

Figura 10 – Problema teste: solução para o campo de pressão.

15

10

Solução de referência

5

015

10

x

5

30

15

10

20

5

0

25

15

10

5

Solução MsFVM

015

10

x

5

5

15

20

25

30

10

0

12

14

16

18

20

22

24

P [MPa]



106 Capítulo 4. Método dos Volumes Finitos Multiescala - MsFVM

Vários autores descrevem que a vantagem do uso de mé-
todos multiescala consiste na qualidade da solução obtida, que
apesar de inexata é considerada boa, dadas as incertezas de enge-
nharia presentes no campo de permeabilidade que a determina.
Além disso, defende-se que o tempo computacional associado a tal
estratégia tende a ser baixo em comparação com outras estratégias
comumente empregadas (MOYNER; LIE, 2014a).

4.3 RECONSTRUÇÃO DO CAMPO DE VELOCIDADE

O campo de pressão em escala refinada calculado pela
equação (4.4) é contínuo nas regiões ocupadas pelas interfaces
dos volumes de controle duais, porém o gradiente desse campo
é descontínuo nessas regiões (JENNY; LEE; TCHELEPI, 2006;
MOYNER, 2012). Desse modo, se for empregado para o cálculo de
um campo de velocidades em malha refinada conforme a equação
(??), esse não garantirá a conservação da massa localmente. A fim
de que isso seja alcançado, o MsFVM propõe uma metodologia
para a reconstrução do campo de velocidade segundo um campo
de pressão atualizado.

As fronteiras dos volumes de controle da malha primal
são contidas pelos volumes de controle duais. Por construção do
MsFVM, sabe-se que o campo de velocidade calculado nessas
regiões é contínuo. Tais fatos motivam a especificação das condi-
ções de contorno para problemas locais definidos nos volumes de
controle da malha primal ??Ci , em que i = 1, 2, · · · ,NC, conforme?????

????
?·

(
??p

??
)

= f
?
i, em ??

C
i .(

??p
??
)
·~ni =

(
??p

?
)
·~ni, em ???Ci .

p
??

(xk) = p
?
(xk) , xk ? ?,

(4.11)

em que p
?
representa o campo de pressão local obtido a partir da

equação (4.4) conforme descrito na seção passada; p
??
, o campo

de pressão corrigido que conduz à solução conservativa para a
velocidade; ~ni, o vetor normal à fronteira ???Ci e, por fim, f

?
i pode

ser visto como um termo fonte associado à entrada/saída de massa



4.3. Reconstrução do Campo de Velocidade 107

no volume de controle ??Ci , responsável também pela modelagem
de efeitos gravitacionais, dado por

f
?
i = ?

?
???C

i

??p
?
d?

??
?C

i

d?
. (4.12)

Após a reconstrução do campo de pressão, o campo de
velocidade pode ser calculado explicitamente pela equação (2.3).
As linhas de corrente obtidas a partir dos campos de velocidades
original (calculado a partir de p

?
) e reconstruído (calculado a

partir de p
??
) para o problema teste são ilustradas na figura 11.

Figura 11 – Problema teste: linhas de corrente (MsFVM).

x [m]
0 50 100 150

y 
[m

]

0

50

100

150
Sem reconstrução

x [m]
0 50 100 150

y 
[m

]

0

50

100

150
Com reconstrução

0.5

1

1.5

2

2.5

3

log
10

 (K [mD])

Dessa figura conclui-se que o campo de velocidade cal-
culado pelo MsFVM sem haver o processo de reconstrução é
inconsistente do ponto de vista físico, enquanto que o novo campo
aproxima-se mais da solução real. De fato, calculando-se o campo
de velocidade a partir da solução exata do escoamento, esta última
observação é confirmada. Uma comparação entre os campos de
velocidade de referência e obtido pelo MsFVM empregando-se a
estratégia de reconstrução pode ser verificada na figura 12.

É importante lembrar que os problemas locais definidos
pela equação (4.11) para os diferentes volumes ??Ci são independen-



108 Capítulo 4. Método dos Volumes Finitos Multiescala - MsFVM

Figura 12 – Problema teste: comparação entre linhas de corrente.

x [m]
0 50 100 150

y 
[m

]

0

50

100

150
Referência

x [m]
0 50 100 150

y 
[m

]

0

50

100

150
MsFVM com reconstrução

0.5

1

1.5

2

2.5

3

log
10

 (K [mD])

tes entre si, portanto sua solução pode ser facilmente paralelizada.
A mesma observação é válida para o problema que define as fun-
ções base duais (4.2). Esse é justamente um dos pontos positivos
mais relevantes do MsFVM: o alto grau de paralelização de seu
algoritmo.

4.4 FUNÇÕES DE CORREÇÃO

Um aperfeiçoamento no MsFVM foi proposto pelas for-
mulações apresentadas por Lunati e Jenny (2008), Lunati e Lee
(2009), em que além das funções base duais, definem-se também
funções de correção responsáveis por captar os efeitos causados
pelos termos independentes da equação (4.1) sobre o campo de
pressão em nível refinado.

Assim como no caso das funções base duais, as funções
de correção são encontradas através da resolução de problemas
independentes definidos nos volumes de controle da malha dual.
Tomando-se um volume dual ???Dj genérico, a função de correção
??j associada a esse volume é encontrada resolvendo-se o seguinte



4.5. Desenvolvimentos Recentes 109

problema:?????
????
?·

(
????j

)
= ?· (?g??z) + q, em ??Dj .

?t ·
(
????j

)
= ?t · (?g??z) , em ???Dj .

??j (xk) = 0, xk ? ?,

(4.13)

Nota-se que este é bastante similar ao problema dado por (4.2),
as diferenças fundamentais entre eles consistem nas condições
de contorno para os vértices dos volumes ???Dj , as quais são
nulas no presente caso e ao fato de (4.13) considerar fenômenos
físicos modelados pelo lado direito da equação (4.1). Além disso é
importante notar que, dado um volume dual arbitrário, calcula-se
uma única função de correção associada a ele independentemente
do problema ser bidimensional ou tridimensional.

Quando as funções de correção são consideradas, a ex-
pressão para o cálculo do campo de pressão em escala refinada a
partir do campo em escala grossa é modificada para a seguinte
equação

p ? p
?

=
ND?
j=1

?
?NC?
i=1

?
j
ip
C
i + ?

?
j

?
? . (4.14)

No problema teste, os poços estão localizados nos pró-
prios centróides dos volumes de controle da malha primal, isso
permite que seu efeito sobre o escoamento possa ser devidamente
considerado pelo lado direito do sistema linear em nível grosso
(4.10), logo a parcela das funções de correção referente à ação dos
poços é nula. No entanto, efeitos gravitacionais estão presentes no
sentido oposto do eixo “y”, logo as funções de correção devem ser
diferentes de zero. Com efeito, a correção no campo de pressão
gerada por tais funções é ilustrada na figura 13.

4.5 DESENVOLVIMENTOS RECENTES

O método dos volumes finitos multiescala foi inicialmente
proposto para a resolução de problemas elípticos homogêneos
(JENNY; LEE; TCHELEPI, 2003), que correspondem ao caso



110 Capítulo 4. Método dos Volumes Finitos Multiescala - MsFVM

Figura 13 – Problema teste: funções de correção.

x [m]
0 50 100 150

y 
[m

]

0

50

100

150

-0.2

-0.1

0

0.1

0.2

0.3

P [MPa]

de escoamento monofásico e incompressível. Posteriormente, este
foi estendido para a resolução de problemas hiperbólicos como
a equação do transporte (saturação) (LEE; ZHOU; TCHELEPI,
2009; KUNZE, 2014). Desde sua criação, tal método recebeu cons-
tantes aprimoramentos de modo a adaptá-lo para a resolução de
problemas cada vez mais realísticos em simulação de reservatórios.
Nesse sentido, os avanços mais significantes são sintetizados a
seguir

• Escoamentos compressíveis monofásicos e multifásicos (JENNY;
LEE; TCHELEPI, 2005; JENNY; LEE; TCHELEPI, 2006;
LUNATI; JENNY, 2006b; LUNATI; JENNY, 2006a; ZHOU,
2006; ZHOU; TCHELEPI, 2008; HAJIBEYGI; JENNY,
2009).

• Reservatórios anisotrópicos (LUNATI; JENNY, 2007; HESSE;
MALLISON; TCHELEPI, 2008; HAJIBEYGI; WANG; TCHE-
LEPI, 2014; MOYNER; LIE, 2014b).

• Modelagem de poços com trajetória complexa através das
funções de correção (WOLFSTEINER; LEE; TCHELEPI,



4.5. Desenvolvimentos Recentes 111

2006; JENNY; LUNATI, 2009).

• Escoamento em reservatórios com falhas geológicas (HAJI-
BEYGI; DEB; JENNY, 2011).

• Escoamento em reservatórios fraturados (HAJIBEYGI; KAR-
VOUNIS; JENNY, 2011; SANDVE; KEILEGAVLEN; NORD-
BOTTEN, 2014).

• Escoamento multifásico black-oil (LEE; WOLFSTEINER;
TCHELEPI, 2008).

• Escoamento multifásico composicional (HAJIBEYGI; TCHE-
LEPI, 2014; CUSINI et al., 2014).

• Malhas estratigráficas e não-estruturadas (MOYNER, 2014;
MOYNER; LIE, 2014a; MOYNER; LIE, 2015).

Uma frente de pesquisa bastante ativa propõe mudanças
na formulação dos métodos multiescala que conduzam a soluções
de melhor qualidade, isto é, mais próximas àquelas calculadas exa-
tamente na malha refinada, e de baixo custo computacional. Nesse
sentido, um caminho bastante explorado consiste na definição de
novas condições de contorno que sejam mais próximas à solução
exata para os problemas que definem as funções base duais (4.2),
este é justamente o objeto de estudo dos trabalhos escritos por
Nordbotten e Bjorstad (2008); Moyner e Lie (2014a) e Keilegavlen
e Nordbotten (2014). Outra tática consiste na aplicação iterativa
do MsFVM de modo que as condições de contorno dos problemas
duais sejam atualizadas com as soluções antigas do campo de
pressão. Isso foi proposto inicialmente por Hajibeygi et al. (2008)
através do método dos volumes finitos multiescala iterativo - ite-
rative Multiscale Finite Volume Method (iMsFVM) - desde então,
diversos aperfeiçoamentos foram desenvolvidos para esse método
(BONFIGLI; JENNY, 2010; ZHOU, 2010; LUNATI; TYAGI; LEE,
2011; HAJIBEYGI; JENNY, 2011), dando origem à interpretação
do MsFVM como um pré-condicionador voltado para a solução
de problemas elípticos. Essa abordagem é detalhada no capítulo
seguinte.





113

5 PRÉ-CONDICIONADOR MULTIESCALA ALGÉBRICO

Ambos métodos dos volumes finitos multiescala original
(MsFVM) e iterativo (iMsFVM) podem ser formulados algebri-
camente, ou seja, por meio de operações envolvendo matrizes e
vetores (ZHOU, 2006; ZHOU; TCHELEPI, 2008). Isso é atraente
por diversos motivos, entre os quais destacam-se a melhor compre-
ensão da qualidade da solução obtida por esses métodos bem como
das propriedades de convergência de sua formulação iterativa e
a viabilização de sua extensão natural a malhas corner-point e
não-estruturadas, apesar de ainda atrelada a aspectos geométricos.
Em especial no caso do iMsFVM, sua formulação matricial dá
origem ao pré-condicionador multiescala algébrico, classificado
como uma variante do multigrid de dois níveis cujo operador de
prolongação é construído através da resolução direta de subpro-
blemas independentes definidos em malha refinada (ZHOU, 2010;
ZHOU; TCHELEPI, 2012; WANG, 2012; WANG; HAJIBEYGI;
TCHELEPI, 2014). Tal pré-condicionador é voltado para a re-
solução de problemas elípticos e apresenta como parâmetros de
configuração os itens citados a seguir.

a) o tipo do operador de restrição empregado para a
construção do problema em nível global.

b) a razão de engrossamento utilizada para a determina-
ção do tamanho do problema na malha grossa.

c) o tipo de estratégia, denominada como suavizador,
para a resolução aproximada do sistema linear original.

Apresenta-se nesse capítulo os conceitos envolvidos na
definição do pré-condicionador multiescala algébrico bem como
seu formato matricial. Com o intuito de ilustrar claramente tais
conceitos, considera-se o mesmo problema teste bidimensional
empregado no capítulo 4. As mudanças associadas à extensão para
o caso 3D consistem basicamente na redefinição dos operadores
de interpolação (prolongação e restrição) utilizados pelo método
conforme exposto no apêndice B.

Considerando-se a malha refinada ?? ilustrada na figura 7,
a discretização do problema elíptico (4.1) através do método dos



114 Capítulo 5. Pré-condicionador Multiescala Algébrico

volumes finitos tradicional1 conduz a um sistema linear do tipo
(3.1), o qual é reescrito a seguir como:

Ap = q, (5.1)

em que a variável desconhecida pressão é definida num conjunto
finito de pontos If = {xj}j?[1,nf ], enquanto a matriz A é esparsa
com estrutura pentadiagonal.

A divisão do domínio ? conforme volumes primais, ??Ci , e
duais, ??Dj , induz um particionamento da malha refinada denomi-
nado como wirebasket e ilustrado na figura 14. Nesse ordenamento,
os volumes da malha refinada ?? podem ser divididos em três ca-
tegorias2, conforme:

Figura 14 – Problema teste: particionamento wirebasket.

x [m]
0 50 100 150

y 
[m

]

0

50

100

150

a) interior (branco), formando um conjunto de “Ni” vo-
lumes denotado por Ii = {xj}j?[1,Ni];

1 Com aproximação de dois pontos para o fluxo (TPFA).
2 No caso de escoamento tridimensional, adiciona-se uma nova categoria:

os volumes de face, que constituem as superfícies dos volumes de controle
da malha dual.



115

b) aresta (verde claro), formando um conjunto de “Ne”
volumes denotado por Ie = {xj}j?[1,Ne];

c) vértice (azul escuro), formando um conjunto de “Nv”
volumes denotado por Iv = {xj}j?[1,Nv ].

A união desses agrupamentos formam o conjunto dos volumes
pertencentes à malha refinada ??:

If = Ii ? Ie ? Iv, (5.2)

sendo que Nf = Ni + Ne + Nv.
Definindo-se como Q? a matriz de permutação que realiza a

transferência entre os ordenamentos lexicográfico (natural) e wire-
basket, a variável pressão pode ser escrita nesse novo ordenamento
como

p? = Q?p =

?
??
p?i

p?e

p?v

?
?? , (5.3)

e a matriz A como

A? = Q?AQ?T =

?
???

A?ii A?ie 0iv
A?ei A?ee A?ev
0vi A?ve A?vv

?
??? , (5.4)

em que a submatriz genérica A?ab tem dimensão Na×Nb e denota
a contribuição dos volumes de controle da categoria “b” sobre a
equação de conservação da massa referente aos volumes da cate-
goria “a”. Como o esquema de interpolação adotado no processo
de discretização da equação diferencial é de dois pontos, segue
que os volumes interiores não influenciam os volumes de vértice
e vice-versa, portanto A?vi = A?Tiv = 0vi. A figura 15 ilustra a
estrutura das matrizes original A (à esquerda) e reordenada A?
(à direita).

Uma vez que as matrizes de permutação são ortogonais,
tem-se que Q?T = Q??1 e Q?T Q? = I. Logo, o sistema linear (5.1)
pode ser reescrito na forma reordenada como:

Q?AQ?T Q?p = Q?q

? A?p? = q?. (5.5)



116 Capítulo 5. Pré-condicionador Multiescala Algébrico

Figura 15 – Problema teste: estrutura da matriz de coeficientes
original, à esquerda, e reordenada, à direita.

nz = 1065
0 50 100 150 200

0

50

100

150

200

nz = 1065
0 144 216

0

144

216

O sistema linear resolvido pelo MsFVM usando-se as
funções de correção, apresentadas na seção 4.4, consiste numa
aproximação desse último e pode ser escrito como

Mmswcp?
?

= q?
?
, (5.6)

em que Mmswc representa o operador multiescala considerando-se
as funções de correção, o qual é dado por

Mmswc =

?
???

A?ii A?ie 0iv
0ei Mee A?ev
0vi 0ve Mvv

?
??? . (5.7)

Já o lado direito q?
?
da equação (5.6) é denominado como vetor

independente modificado, sendo dado por:

q?
?

=

?
???
q?i

q?
?
e

q?
?
v

?
??? . (5.8)

A matriz Mmswc é obtida a partir de A? ao desconsiderar-
se a contribuição dos volumes de interior “i” sobre a equação



117

da conservação da massa referente aos volumes de aresta “e”,
bem como a contribuição desses últimos à equação relativa aos
volumes de vértice “v”, ou seja, A?ei = 0ei e A?ve = 0ve. Na figura
16 verifica-se uma comparação entre as estruturas das matrizes A?
(à esquerda) e Mmswc (à direita) exibidas pelo problema teste.

Figura 16 – Problema teste: estrutura da matriz de coeficientes
reordenada, à esquerda, e da matriz que gera o pré-
condicionador multiescala com funções de correção,
à direita.

nz = 1065
0 144 216

0

144

216

nz = 925
0 144 216

0

144

216

Nota-se que o número de elementos não nulos é reduzido
para o segundo operador (de 1065 para 925, nesse caso). Além
disso, a quebra das conexões provenientes dos volumes de inte-
rior em sentido aos de aresta, A?ei, bem como desses últimos em
sentido aos volumes de vértice, A?ve, faz com que os problemas
locais definidos em volumes duais distintos tornem-se desacopla-
dos entre si. Isso pode ser visualizado claramente nas figuras
17 e 18 que mostram as estruturas das submatrizes A?ii e Mee,
respectivamente.

Tal desacoplamento entre os problemas locais permite
que sua resolução possa ser realizada de acordo com estratégias
paralelas ou então que haja menor grau de preenchimento quando
algum método de solução direto, como fatoração LU 3.2.1, é
empregado.



118 Capítulo 5. Pré-condicionador Multiescala Algébrico

Figura 17 – Problema teste: estrutura da matriz Aii.

Figura 18 – Problema teste: estrutura da matriz Mee.



119

Como consequência da consideração A?ei = 0ei, a matriz
A?ee precisa ser atualizada de modo que contribuições provenientes
de volumes interiores sejam descartadas. Isso é realizado com a
definição do operador de “problema reduzido”:

Mee = A?ee + diag
(?

i

A?Tie

)
, (5.9)

em que o operador diag () transforma um vetor em uma matriz
diagonal.

A submatriz Mvv, de dimensão Nv ×Nv, refere-se ao pro-
blema definido na malha primal ou grossa, já descrito na seção 4.2.
Tal matriz também é referida como operador grosseiro ou global
e pode ser construída algebricamente, o que será apresentado na
seção 5.2. Como sua dimensão é muito menor que a dimensão
de Mmswc, é difícil de se visualizar claramente a estrutura dessa
matriz na figura 16, portanto, ela é apresentada isoladamente na
figura 19.

Figura 19 – Problema teste: estrutura da matriz M?vv.

nz = 49

0 3 6 9
0

3

6

9



120 Capítulo 5. Pré-condicionador Multiescala Algébrico

Aqui fica claro que o stencil do operador grosseiro no
caso 2D é de 9 pontos, portanto, o cálculo da incógnita referente
a um determinado volume de controle envolve as informações
de seus vizinhos nas direções vertical, horizontal e também di-
agonal. Isso é semelhante ao observado para uma discretização
através do método dos volumes finitos cujo cálculo dos fluxos
através das fronteiras é realizado segundo um esquema baseado
em múltiplos pontos - Multipoint Flux Approximation (MPFA)
(AAVATSMARK, 2002; AMBRUS, 2009).

Por último, o vetor q?
?
é obtido de q? mediante as seguintes

considerações:
a) a componente q?

?
i é igual à q?i;

b) a componente q?
?
e é calculada a partir de q?e ao desprezar-

se a componente normal de sua parcela gravitacional.
Isso é induzido pela hipótese de localização empregada
na definição das condições de contorno dos problemas
duais (4.2);

c) a componente q?
?
v é definida como o vetor independente

do problema em nível grosseiro, apresentado na seção
4.2. A definição algébrica dessa componente é realizada
na seção a seguir.

5.1 OPERADORES DE TRANSFERÊNCIA

A matriz Mmswc tem formato blocado e triangular supe-
rior, isso permite que o sistema linear (5.6) possa ser resolvido
através de um processo de substituição reversa em blocos, condu-
zindo à seguinte solução:

p?
?
v = M

?1
vv q?

?
v; (5.10a)

p?
?
e = ?Mee

(
A?evp?

?
v ? q?

?
e

)
; (5.10b)

p?
?
i = ?A?

?1
ii

(
A?iep?

?
e ? q?

?
i

)
= A??1ii

[
A?ieM?1ee

(
A?evp?

?
v ? q?

?
e

)
? q?

?
i

]
,

(5.10c)



5.1. Operadores de Transferência 121

a qual pode ser expressa em formato matricial conforme:

?
???
p?
?
i

p?
?
e

p?
?
v

?
??? =

?
???

A??1ii A?ieM
?1
ee A?ev

?M?1ee A?ev
Ivv

?
??? p??v+

?
???

A??1ii ?A?
?1
ii A?ieM

?1
ee 0iv

0ei M?1ee 0ev
0vi 0ve 0vv

?
???
?
???
q?i

q?
?
e

q?
?
v

?
??? .

(5.11)

Esta resposta motiva a definição de operadores lineares cuja
combinação produz o pré-condicionador multiescala algébrico
com funções de correção M?1mswc. O primeiro deles é o operador
de prolongação, dado por:

P =

?
???

A??1ii A?ieM
?1
ee A?ev

?M?1ee A?ev
Ivv

?
??? . (5.12)

Este é retangular de ordem igual a Nf ×Nv e tem como objetivo a
transferência de informações do nível grosso para o nível refinado.
É interessante notar que as colunas dessa matriz possuem uma
interpretação especial: a de índice “i” é formada pelo somatório
das funções base duais que assumem valor unitário no centro do
volume de mesmo índice referente à malha primal, ou seja:

Pei =
?
j

?
j
i. (5.13)

O formato do operador de prolongação para o problema
teste é apresentado à esquerda da figura 20. À sua direita ilustram-
se os volumes da malha refinada que são abrangidos pelo processo
de prolongação quando a informação considerada é proveniente
dos volumes primais 1 (laranja), 3 (azul), 7 (vermelho) e 9 (verde).



122 Capítulo 5. Pré-condicionador Multiescala Algébrico

Figura 20 – Problema teste: interpretação para as colunas da
matriz P.

A matriz quadrada de ordem Nf×Nf presente no segundo
termo da equação (5.11) leva à definição do operador de correção

C =

?
???

A??1ii ?A?
?1
ii A?ieM

?1
ee 0iv

0ei M?1ee 0ev
0vi 0ve 0vv

?
??? , (5.14)

o qual desempenha o papel das funções de correção apresentadas
na seção 4.4. De fato, o termo Cq?

?
é igual ao somatório das funções

de correção referentes a cada um dos volumes de controle que
formam a malha dual ??D, isto é:

Cq?
?

=
ND?
j=1

??j. (5.15)

Ao contrário do operador de prolongação, o operador
de correção não é formado explicitamente, pois isso envolveria o
cálculo explícito de matrizes inversas, o que é muito caro computa-
cionalmente e deve ser evitado. No pré-condicionador multiescala,



5.1. Operadores de Transferência 123

a matriz C é empregada somente em operações matemáticas do
tipo produto matriz/vetor, portanto, é suficiente o cálculo de sua
ação sobre um vetor arbitrário, conforme:

Cq?
?

=

?
???

A??1ii
(
q?i ? A?ieM?1ee q?

?
e

)
M?1ee q?

?
e

0vv

?
??? . (5.16)

A título de exemplificação, o formato do operador C para
o problema teste é mostrado na figura 21, em que é possível
observar as incógnitas afetadas pela aplicação desse operador.
Somente as submatrizes que se referem aos volumes de vértice
são nulas, portanto, as incógnitas referentes a tais volumes são as
únicas que não são afetadas pelo operador em questão.

Figura 21 – Problema teste: formato do operador de correção C.

nz = 3440

0 144 216
0

144

216

Por fim, define-se o operador de restrição R, cujo objetivo
consiste na transferência de informações do nível refinado para
o grosseiro. Ou seja, este apresenta o papel inverso do operador
de prolongação P. O operador R é representado por uma matriz
retangular de ordem Nv ×Nf, a qual pode ser construída a partir



124 Capítulo 5. Pré-condicionador Multiescala Algébrico

de duas estratégias distintas: a primeira é baseada em volumes
finitos sendo que a matriz obtida é chamada de RFV , enquanto
a segunda é baseada em elementos finitos, conduzindo à matriz
RFE.

A primeira escolha traduz algebricamente o processo de
restrição presente no método dos volumes finitos multiescala
(MsFVM). Nesse caso, os volumes de controle da malha refinada
que formam o mesmo volume de controle da malha primal con-
tribuem de modo equivalente para a transferência de informação
entre as duas malhas. Sua definição algébrica é dada pela equação
(5.17), enquanto que seu formato para o problema teste é ilustrado
na figura 22

(RFV )ij =
{

1 se o volume j está contido em ?i;
0 caso contrário.

(5.17)

Figura 22 – Problema teste: operador de restrição RFV .

Enquanto o operador RFV está para o método dos vo-
lumes finitos multiescala, o operador RFE está para o método
dos elementos finitos multiescala (MsFEM). Nesse caso, diz-se
que o operador de restrição é do tipo Galerkin sendo dado pelo
transposto do operador de prolongação, ou seja:

RFE = PT . (5.18)

No operador RFE, pondera-se a contribuição de diferen-
tes volumes de controle durante o processo de transferência de
informação entre as malhas refinada e grosseira. Essa escolha
conduz a pré-condicionadores multiescala eficientes em termos de



5.2. Problema na Malha Grossa 125

convergência numérica, no entanto, a propriedade de conserva-
ção da massa em ambos níveis grosseiro e refinado deixa de ser
atendida.

Quando o operador RFE é utilizado para a construção
do problema em nível grosso, uma estratégia comumente empre-
gada para preservar a propriedade conservativa do campo de
pressão em escala grosseira consiste em aplicar uma iteração do
pré-condicionador multiescala algébrico baseado em volumes fi-
nitos na etapa de pós-processamento da solução. Desse modo, é
possível também aplicar a estratégia de reconstrução do campo
de velocidade a fim de obter um campo conservativo em escala
refinada.

5.2 PROBLEMA NA MALHA GROSSA

Definidos os operadores de prolongação e correção, segue
que a solução proposta pelo pré-condicionador multiescala com
funções de correção M?1mswc (5.11) pode ser reescrita da seguinte
maneira:

p? = Pp?
?
v + Cq?

?
. (5.19)

Substituindo-se a equação (5.19) para p? no sistema linear
original reordenado (5.5), obtém-se o seguinte sistema para a
variável p?

?
v:

A?Pp?
?
v =

(
I ? A?C

)
q?. (5.20)

Como esse é um sistema retangular, multiplica-se ambos os lados
pelo operador de restrição R, gerando o seguinte problema de
dimensão Nv ×Nv em nível grosseiro:

Mvvp?
?
v = q?

?
v, (5.21)

sendo que
Mvv = RA?P (5.22)

denota a matriz de coeficientes e

q?
?
v = R

(
I ? A?C

)
q? (5.23)

denota o vetor independente referente ao problema grosseiro.



126 Capítulo 5. Pré-condicionador Multiescala Algébrico

5.3 DEFINIÇÃO DO PRÉ-CONDICIONADOR

Combinando-se as equações (5.19), (5.21), (5.22) e (5.23),
o pré-condicionador multiescala algébrico com funções de correção
M?1mswc pode ser representado na seguinte forma compacta:

M?1mswc = P
(
RA?P

)?1
R (I ? AC) + C, (5.24)

o qual após algumas manipulações algébricas pode ser reescrito
como:

M?1mswc = M
?1
ms + C ? M

?1
msA?C, (5.25)

em que M?1ms é denominado simplesmente como pré-condicionador
multiescala, sendo dado por:

M?1ms = P
(
RA?P

)?1
R. (5.26)

Quando o operador de restrição baseado em volumes
finitos, RFV , é empregado para a construção pré-condicionador
multiescala, obtém-se o pré-condicionador multiescala baseado
em volumes finitos:

M?1msfv = P
(
RFV A?P

)?1
RFV . (5.27)

Por outro lado, quando o operador de restrição do tipo galer-
kin, RFE, é utilizado, obtém-se o pré-condicionador multiescala
baseado em elementos finitos:

M?1msfe = P
(
PT A?P

)?1
PT . (5.28)

Ambos operadores M?1ms e M?1mswc não são formados expli-
citamente, pois, da mesma forma como explicado para o operador
C, é de interesse somente o cálculo de sua ação sobre um vetor
arbitrário. Esse processo envolve claramente o cálculo da inversa
da matriz Mvv, o que é realizado diretamente através de fato-
ração LU 3.2.1, já que o tamanho desse sistema linear costuma
ser pequeno. Além disso, a aplicação do operador de correção
C, presente no pré-condicionador M?1mswc, envolve a resolução de



5.3. Definição do Pré-Condicionador 127

sistemas lineares definidos pelas matrizes A?ii e M?ee, o que tam-
bém é feito de modo direto. O código computacional desenvolvido
no presente trabalho permite a resolução desses sistemas através
de algum método iterativo, no entanto, foi verificado que para
os problemas testados, a estratégia de solução direta mostrou-se
mais eficiente.

Quando o pré-condicionador M?1mswc é utilizado em con-
junto com o método iterativo de Richardson, o processo iterativo

p?k+1 = p?k + M?1mswc
(
q? ? A?p?

)
(5.29)

pode ser dividido em dois estágio e visto da seguinte maneira:

p?k+1/2 = p?k + C
(
q? ? A?p?k

)
; (5.30a)

p?k+1 = p?k+1/2 + M?1ms
(
q? ? A?p?k+1/2

)
, (5.30b)

em que o primeiro estágio é denominado como local e encarrega-se
de atualizar a solução através das funções de correção, enquanto
o segundo é denominado como global e tem como objetivo a
atualização da solução por meio do operador multiescala. Nessa
divisão fica claro que o pré-condicionador multiescala algébrico
com funções de correção pode ser visto como uma combinação
do tipo multiplicativa dos pré-condicionadores de correção C
e multiescala M?1ms. Adiciona-se ainda que o primeiro estágio
trabalha no nível refinado da malha e reduz as componentes do
erro de alta frequência enquanto o segundo trabalha no nível
grosseiro e reduz as componentes de baixa frequência.

Em problemas complexos, como aqueles que apresentam
campos de permeabilidade anisotrópicos ou fortemente canaliza-
dos, Hajibeygi, Karvounis e Jenny (2011), Wang (2012) e Wang,
Hajibeygi e Tchelepi (2014) descreveram em seus trabalhos que
torna-se necessário a adição de um novo estágio local, também
denominado como suavizador, ao pré-condicionador multiescala a
fim de que este seja convergente. O trabalho pioneiro de Hajibeygi,
Karvounis e Jenny (2011) avaliou estratégias de relaxação em
linha (LR), enquanto que Wang (2012) empregou fatoração LU



128 Capítulo 5. Pré-condicionador Multiescala Algébrico

incompleta em blocos (BILU)3, além da fatoração ILU tradicional
em trabalho posterior, dando origem ao pré-condicionador AMS
(WANG; HAJIBEYGI; TCHELEPI, 2014). O presente trabalho
considera as duas últimas alternativas além de empregar tam-
bém suavizadores simples baseados em sobre-relaxação sucessiva
(SOR), bem como suavizadores mais robustos como aqueles base-
ados em Schwarz aditivo com resolução exata dos subproblemas
locais.

Seja M?1l a matriz de pré-condicionamento referente à
estratégia de suavização considerada, conhecida também como a
matriz de pré-condicionamento referente ao estágio local ou então
simplesmente como pré-condicionador local. De modo geral, o pré-
condicionador multiescala construído a partir dessa alternativa
pode ser escrito da seguinte maneira:

p?k+1/2 = p?k + M?1l
(
q? ? A?p?k

)
;

p?k+1 = p?k+1/2 + M?1ms
(
q? ? A?p?k+1/2

)
, (5.31a)

em que o primeiro estágio é de suavização, enquanto o segundo
refere-se à correção em nível global. Este último é identificado de
modo genérico pelo operador M?1ms, o qual deve ser substituído
por M?1msfv ou M

?1
msfe, de acordo com a estratégia empregada

para o operador de restrição.
Quando dois ou mais suavizadores são utilizados, aumenta-

se proporcionalmente o número de estágios locais sendo que estes
são combinados de modo multiplicativo, ou seja, a solução obtida
no primeiro estágio é utilizada para o cálculo da solução referente
ao segundo. A título de exemplo, considerando os suavizadores
baseados em fatoração incompleta e funções de correção, obtém-se

3 Tal estratégia é equivalente ao uso do pré-condicionador Schwarz adi-
tivo (AS) sem nenhuma sobreposição entre os problemas locais, os quais
são resolvidos por uma única iteração do pré-condicionador baseado em
fatoração LU incompleta.



5.4. Reconstrução do Campo de Velocidades 129

o seguinte pré-condicionador:

p?k+1/3 = p?k + ILU(A?)
(
q? ? A?p?k

)
;

p?k+1/2 = p?k+1/3 + C
(
q? ? A?p?k+1/3

)
;

p?k+1 = p?k+1/2 + M?1ms
(
q? ? A?p?k+1/2

)
, (5.32a)

que também pode ser representado compactamente da seguinte
maneira:

M?1mshs =
[
I ?

(
I ? ILU(A?)A?

)(
I ? CA?

)(
I ? M?1msA?

)]
A??1.
(5.33)

Nota-se que os diferentes parâmetros discutidos até agora para
a definição do pré-condicionador multiescala não conduzem à
estratégias simétricas, já que os estágios do pré-condicionador são
executados num único sentido. No entanto, durante a resolução
de problemas simétricos, como os considerados nesse trabalho, é
desejável o uso de pré-condicionadores que apresentem também
tal característica. Isso viabiliza o uso de solvers iterativos voltados
para tal classe de problemas como o método do gradiente con-
jugado, o qual apresenta a vantagem de requerer menor quantia
de espaço para o armazenamento dos vetores e matrizes envolvi-
dos em seu algoritmo em relação a outros métodos comumente
utilizados para problemas não-simétricos como o GMRes.

Com o intuito de tornar simétrico o pré-condicionador
multiescala, faz-se com que seus estágios locais sejam executados
antes e após a aplicação de seu estágio global. Essa ideia é justa-
mente a empregada pelos pré-condicionadores multigrid com ciclo
V. Uma segunda consideração necessária para que a característica
de simetria seja observada consiste no fato de empregarem-se su-
avizadores simétricos em conjunto com o operador global M?1msfe,
já que o M?1msfv não atende a característica desejada.

5.4 RECONSTRUÇÃO DO CAMPO DE VELOCIDADES

A reconstrução do campo de velocidades apresentada para
o método dos volumes finitos multiescala na seção 4.3 também



130 Capítulo 5. Pré-condicionador Multiescala Algébrico

está presente no pré-condicionador multiescala algébrico. A jus-
tificativa para esse processo é a mesma de antes: o campo de
velocidades calculado a partir do campo de pressão resolvido por
tal pré-condicionador é descontínuo nas fronteiras dos volumes de
controle duais, portanto deseja-se encontrar uma correção para o
campo de pressão que conduza a um campo de velocidade contí-
nuo e que, por conseguinte, represente uma solução conservativa
para o balanço de massa no nível refinado de malha.

Como as fronteiras dos volumes de controle primais estão
contidas no interior dos volumes de controle da malha dual, segue
que o campo de velocidade já é contínuo através nessas regiões. Tal
informação pode ser empregada para a especificação de condições
de contorno de fluxo prescrito (Neumman) em problemas locais
definidos nos volumes de controle da malha primal. O único pré-
requisito para tanto é que o campo de pressão obtido em malha
grosseira seja conservativo, o que pode ser alcançado desde que
o pré-condicionador multiescala empregue o operador RFV no
último passo do processo iterativo.

Para a reconstrução do campo de velocidades, define-se
um novo operador de permutação Q? que substitui o ordenamento
lexicográfico observado na malha refinada por um ordenamento
do mesmo tipo, porém, definido localmente de acordo com os
volumes de controle da malha primal. Desse modo, o sistema
linear (5.1) pode ser reescrito da seguinte forma:

A?p? = q?, (5.34)

em que A? = Q?AQ?T denota a matriz de coeficientes reordenada,
a qual pode ser verificada na figura 23 para o problema teste.

Tal matriz pode ser decomposta da seguinte forma:

A? = L + D + U, (5.35)

em que D é uma matriz diagonal composta por “NC” blocos4
contendo as transmissibilidades relativas aos volumes da malha
4 Estes apresentam estrutura pentadiagonal no caso de problemas bidimen-

sionais ou heptadiagonal no caso de problemas tridimensionais.



5.4. Reconstrução do Campo de Velocidades 131

Figura 23 – Problema teste: estrutura da matriz A?.

refinada que os compõem, enquanto que L e U são matrizes
triangulares inferior e superior, respectivamente, que incluem as
conexões entre volumes da malha refinada pertencentes a volumes
primais distintos.

Desse modo, os problemas locais definidos nos volumes
de controle da malha primal podem ser expressos da seguinte
maneira:

D
?
p? = q? ?

(
A? ? D

?
)

Q?Q?Tp
?
, (5.36)

em que o segundo termo do lado direito representa o fluxo através
das fronteiras dos volumes de controle da malha primal. Nesse
termo, p

?
é a pressão obtida pela aplicação do método iterativo

associado ao pré-condicionador multiescala. Como tal variável é
expressa no ordenamento wirebasket, ela precisa ser multiplicada
pelas matrizes de permutação Q? e Q?T a fim de que seja repre-
sentada no novo ordenamento. Por fim, a matriz D

?
consiste em

uma correção da matriz D necessária por conta da especificação
desses fluxos, a qual é dada por:

D
?

= D + diag
[?

i

(Lij + Uij)
]
. (5.37)



132 Capítulo 5. Pré-condicionador Multiescala Algébrico

Após o cálculo do novo campo de pressão p?, o campo de
velocidades reconstruído pode ser encontrado pela aplicação da
equação de Darcy (2.3).



133

6 RESULTADOS

Nesse capítulo, apresentam-se aspectos matemáticos e
computacionais referentes a diferentes estratégias para a solução
de problemas elípticos presentes na simulação de reservatórios.
Enfoque maior é dado às estratégias de pré-condicionamento
para métodos iterativos visando a obtenção de soluções precisas
e também aproximadas dos problemas tratados. Considera-se,
em especial, como os parâmetros de configuração relativos ao
pré-condicionador multiescala influenciam na qualidade dessa
estratégia. Desse modo busca-se a melhor combinação possível
em termos de eficiência e robustez do pré-condicionador.

Consideram-se quatro problemas teste comumente em-
pregados para a avaliação de novas estratégias de solução. Os
campos de permeabilidade da rocha-reservatório empregados por
tais casos são altamente heterogêneos, ou seja, apresentam vari-
ações de cinco ou mais ordens de grandeza ao longo do espaço.
Tal característica conduz a sistemas lineares com elevados graus
de mal condicionamento, o que consiste em um grande desafio
para a resolução eficiente desses sistemas através de métodos
iterativos bem como para a resolução exata através de métodos
diretos, devido à resolução limitada apresentada pela máquina na
representação dos números.

Do ponto de vista matemático, serão mostradas a variação
dos resíduos precondicionado e real ao longo das iterações, bem
como o espectro aproximado do operador pré-condicionado M?1A
quando o método de solução adotado for iterativo. Já do ponto de
vista computacional, serão apresentados informações detalhadas a
respeito do tempo e da quantidade de memória RAM necessárias
para a resolução de sistemas lineares. Em conjunto, tais resultados
permitem avaliar a qualidade da estratégia de solução.

Os métodos de solução diretos abordados nesse trabalho
são apresentados na tabela 1.

Considerando-se os métodos iterativos, estes são formados
1 Pacote descrito por Davis (2004).
2 Pacote descrito por Li e Demmel (2003).
3 Pacote descrito por Agullo et al. (2015).



134 Capítulo 6. Resultados

Tabela 1 – Métodos de solução diretos.

Solver Pacote

LU UMFPACK 1

LU SUPERLU 2

LU MUMPS 3

Cholesky UMFPACK
Cholesky MUMPS

Tabela 2 – Pré-condicionadores padrão.

Pré-condicionador Pacote

BoomerAMG (Multigrid) HYPRE 4

GAMG (Multigrid ) PETSc
ILU PETSc
ParaSails HYPRE
SSOR PETSc
SOR PETSc

pela combinação de um solver iterativo com um pré-condicionador.
Consideram-se duas opções para o solver: método do gradiente
conjugado 3.2.4, empregado quando o operador pré-condicionado é
simétrico, ou método dos resíduos mínimos generalizados 3.2.3, vol-
tado para o caso não-simétrico. Com relação aos pré-condicionado-
res, as escolhas utilizadas a título de comparação são mostradas
na tabela 2.

Os pré-condicionadores da classe multiescala avaliados
nesse trabalho são compostos por dois estágios, global ou local,
que podem ser combinados de modo multiplicativo não-simétrico
ou simétrico. Sejam M?1g a parcela do pré-condicionador referente
ao estágio global e M?1l a parcela referente ao estágio local.
4 Pacote descrito por Falgout e Yang (2002).



6.1. Caso 1: monofásico 2D 135

Quando combinadas de modo multiplicativo não-simétrico, o
seguinte pré-condicionador é obtido

M?1NS = M
?1
l + M

?1
g ? M

?1
g AM

?1
l . (6.1)

Por outro lado, quando os estágios local e global são combinados
de modo multiplicativo simétrico, o seguinte pré-condicionador é
obtido

M?1S = M
?1
l +

[
M?1l

(
I ? AM?1g

)
+ M?1g

](
I ? AM?1l

)
.

(6.2)
As escolhas avaliadas para a configuração do pré-condicio-

nador multiescala algébrico são listadas na tabela 3.

6.1 CASO 1: MONOFÁSICO 2D

O primeiro problema teste consiste no escoamento monofá-
sico de água através de um reservatório com geometria quadrada
de dimensões 4096 m × 4096 m e discretizado por uma malha
cartesiana de dimensões 512 × 512, totalizando 262144 incógni-
tas. O reservatório é impermeável e contém dois poços de raio
rw = 0.1 m dispostos de acordo com o padrão clássico: um quarto
de five-spot. O primeiro deles é injetor, opera na condição de
pressão prescrita igual a 300 bar e está localizado na posição
(x,y) = (268 ,268 )[m]; enquanto que o segundo é produtor, opera
na condição de pressão prescrita igual a 10 bar e está localizado
na posição (x,y) = (3828, 3828)[m].

O campo de permeabilidade da rocha-reservatório é bas-
tante heterogêneo variando em seis ordens de grandeza entre
1.0 × 10?1 mD até 1.0 × 105 mD. Assim como os demais campos
de permeabilidade utilizados nesse trabalho, este foi obtido a
partir de um software de geostatística fornecido pela universidade
de Maryland (KOZINTSEV; KEDEM, 1999) de acordo com uma
5 Os problemas definidos nos subdomínios são resolvidos aproximadamente

com uma única iteração de ILU(0)-Richardson.
6 Os problemas definidos nos subdomínios são resolvidos exatamente pelo

solver Cholesky-UMFPACK.



136 Capítulo 6. Resultados

Tabela 3 – Pré-condicionadores do tipo multiescala.

Nome Estágio global Estágio local Comb.

MsFVwc M?1msfv (5.27) C (5.14) NS

MsFVsor1 M?1msfv (5.27) M
?1
sor (3.15) (1 it.) NS

MsFVsor2 M?1msfv (5.27) M
?1
sor (3.15) (2 it.) NS

MsFVilu0 M?1msfv (5.27) M
?1
ilu0 NS

MsFVilu1 M?1msfv (5.27) M
?1
ilu1 NS

MsFV3 M?1msfv (5.27) C + M
?1
sor ? CAM?1sor NS

MsFV3sym M?1msfv (5.27) C + M
?1
sor ? CAM?1sor S

MsFVHS M?1msfv (5.27) M
?1
AS1

5 (3.26) NS

MsFVHSe M?1msfv (5.27) M
?1
AS1

6 (3.26) NS

MsFEwc M?1msfe (5.28) C (5.14) NS

MsFEsor1 M?1msfe (5.28) M
?1
sor (3.15) (1 it.) NS

MsFEssor1sym M?1msfe (5.28) M
?1
ssor (3.16) (1 it.) S

MsFEsor2 M?1msfe (5.28) M
?1
sor (3.15) (2 it.) NS

MsFEssor2sym M?1msfe (5.28) M
?1
ssor (3.16) (2 it.) S

MsFEilu0 M?1msfe (5.28) M
?1
ilu0 NS

MsFEilu1 M?1msfe (5.28) M
?1
ilu1 NS

MsFE3 M?1msfe (5.28) C + M
?1
sor ? CAM?1sor NS

MsFE3sym M?1msfe (5.28) C + M
?1
sor ? CAM?1sor S

MsFEHS M?1msfe (5.28) M
?1
AS1 (3.26) NS

MsFEHSe M?1msfe (5.28) M
?1
AS1 (3.26) NS

MsFEHSesym M?1msfe (5.28) M
?1
AS1 (3.26) S

MsFEHS3e M?1msfe (5.28) C + M
?1
AS1 ? CAM

?1
AS1 NS



6.1. Caso 1: monofásico 2D 137

função de covariância esférica. O resultado obtido é ilustrado na
figura 24.

Figura 24 – Caso 1: campo de permeabilidade.

6.1.1 Solução aproximada

Avalia-se primeiramente o uso do pré-condicionador mul-
tiescala conforme o papel de técnica de upscaling. Isto é, a so-
lução do problema original é obtida aproximadamente através
da resolução do sistema linear induzido pela simples aplicação
do pré-condicionador multiescala. Nesse âmbito, consideram-se
as estratégias para a configuração do problema global do pré-
condicionador.

a) MsFVM;

b) MsFEM;
Em cada uma das alternativas apresentadas é necessário

a especificação do tamanho do problema grosseiro, sendo que, no
caso teste em questão, empregam-se os tamanhos 16×16, 32×32
e 64 × 64. Estes são referentes às razões de engrossamento iguais



138 Capítulo 6. Resultados

a 32 × 32, 16 × 16 e 8 × 8. Chamando-se de “x” a solução exata
para o campo de pressão e “xms”, a solução aproximada através
do método multiescala, define-se o error relativo entre essas duas
soluções como o vetor “e” de componentes:

ei = 100 ×
(xi ?xmsi )

xi
. (6.3)

Considerando-se inicialmente a estratégia MsFVM, conhe-
cida na literatura como o método dos volumes finitos multiescala,
apresentam-se nas figuras 25 até 27 os gráficos do erro, à esquerda,
e da solução aproximada, à direita, ao longo do reservatório de
acordo com as escolhas citadas para o tamanho do problema
global.

Figura 25 – Caso 1: solução MsFVM-16x16.

Em todos os três casos apresentados, nota-se que a solução
proposta pelo MsFVM apresenta certa semelhança em relação
a solução de referência uma vez que o gráfico do erro relativo é
próximo à zero, exceto nas regiões do poço produtor e em outras
pequenas ao longo do domínio. Observa-se também que a qua-
lidade da solução aproximada aumenta conforme o tamanho do
problema global cresce. No entanto, a solução aproximada exibe
oscilações que não representam corretamente a física do problema.



6.1. Caso 1: monofásico 2D 139

Figura 26 – Caso 1: solução MsFVM-32x32.

Figura 27 – Caso 1: solução MsFVM-64x64.



140 Capítulo 6. Resultados

Tais anomalias são pontos de máximo e mínimo locais7 no campo
de pressão desrespeitando o critério de monotonicidade, que deve-
ria ser verificado já que o problema em questão é modelado por
uma equação de caráter elíptico. Isso acontece porque, do ponto
de vista matemático, a matriz que define o problema global é in-
definida. Trabalhos desenvolvidos recentemente buscaram corrigir
tal matriz de modo a torná-la positivo definida e fazer com que
o critério de monotonicidade seja atendido, pode-se citar como
exemplo disso o método dos volumes multiescala monotônico
(WANG; HAJIBEYGI; TCHELEPI, 2014).

Uma característica importante do MsFVM consiste na
obtenção de campos de velocidade conservativos, isto é, que satis-
fazem a equação da conservação da massa. As linhas de corrente
calculadas através do algoritmo de Pollock (POLLOCK, 1988)
de acordo com o campo de velocidade aproximado pela alterna-
tiva MsFVM-64x64 são ilustradas em roxo na figura 28. Nota-se
que o resultado obtido faz sentido fisicamente, pois as linhas
ligam os poços injetor e produtor através dos caminhos de alta
permeabilidade, representados em amarelo na figura.

Considera-se agora a estratégia do tipo galerkin denomi-
nada MsFEM. Do mesmo modo que anteriormente, analisa-se
como o tamanho do problema global afeta a qualidade da solução
obtida. Para tanto, as figuras 29 a 31 ilustram o erro entre as
soluções exata e aproximada bem como a própria solução aproxi-
mada obtida pelo MsFEM variando-se o tamanho do problema
global de acordo com as mesmas alternativas anteriores.

Assim como no caso anterior, a qualidade da solução
aproximada pelo MsFEM aumenta a medida que o tamanho do
problema em nível grosseiro cresce. As soluções em questão tem
qualidade superior às obtidas pelo MsFVM uma vez que não
há pontos de máximo ou mínimo locais espalhados ao longo do
domínio em regiões não previstas. Segue que o MsFEM conduz
a respostas que obedecem ao critério de monotonicidade, o que
representa uma vantagem em relação ao MsFVM, no entanto,

7 As únicas posições do domínio onde isso é previsto de ocorrer são aquelas
ocupadas pelos poços.



6.1. Caso 1: monofásico 2D 141

Figura 28 – Caso 1: linhas de corrente para a solução MsFVM-
64x64.

Figura 29 – Caso 1: solução MsFEM-16x16.



142 Capítulo 6. Resultados

Figura 30 – Caso 1: solução MsFEM-32x32.

Figura 31 – Caso 1: solução MsFEM-64x64.



6.1. Caso 1: monofásico 2D 143

o campo de velocidade obtido não é conservativo, o que difi-
culta a resolução de equações hiperbólicas no caso de escoamento
multifásico.

Como o problema tratado não apresenta efeitos gravitacio-
nais e os poços estão localizados em volumes de controle do tipo de
vértice, segue que os resultados obtidos pelos pré-condicionadores
MsFVMwc e MsFEMwc são exatamente iguais aos obtidos pelas
escolhas MsFVM e MsFEM. Ou seja, as funções de correção não
desempenham função alguma nesse caso, portanto, seus resultados
são omitidos.

Quando soluções para o campo de pressão com maior
grau de precisão são exigidas, é necessário modificar o método de
resolução do sistema linear original. Para tanto pode-se recorrer
a métodos de solução diretos ou iterativos. Nesse último caso, es-
pecialmente, diversas escolhas de parâmetros para a configuração
do pré-condicionador multiescala podem ser formadas de modo
que o operador resultante auxilie no processo de convergência
dos métodos iterativos. Esta abordagem é considerada nas duas
seções a seguir.

6.1.2 Métodos diretos

Considera-se nessa seção o uso dos métodos diretos lista-
dos na tabela 1 na resolução do problema em questão. A opção
mais eficiente será escolhida como o método direto de referên-
cia a ser comparado com as estratégias iterativas. É importante
lembrar que as soluções obtidas pelos métodos diretos são todas
semelhantes sendo que a diferença observada entre elas é da ordem
da precisão da máquina. A figura 32 ilustra o campo de pressão
obtido com a resolução exata do problema. Nota-se que o campo
de pressão varia de modo não-uniforme ao longo do domínio, o
que era esperado já que o campo de permeabilidade da rocha é
heterogêneo

A figura 33 mostra o tempo de computação necessário para
a execução de cada um dos métodos diretos listados na tabela 1. A
porção de cada barra em azul escuro refere-se ao tempo de leitura
do sistema linear; em azul claro tem-se o tempo de configuração



144 Capítulo 6. Resultados

Figura 32 – Caso 1: campo de pressão.

do método direto (obtenção dos fatores L e U) e em verde tem-se
o tempo de resolução dos sistemas lineares conforme descrito
pelo algoritmo 1. A figura 34 mostra essas mesmas informações
normalizadas em relação ao tempo de execução total. Observa-
se que a fatoração Cholesky realizada pelo pacote UMFPACK
apresenta o menor tempo de computação, portanto esta é tomada
como a estratégia de referência para a solução do problema em
questão. Nota-se também que a maior parcela de tempo para a
execução desses métodos refere-se à parcela de configuração, o
que já era esperado uma vez que a etapa de resolução envolve
apenas sistemas triangulares e portanto toma pouco tempo.

A figura 35 mostra o pico de memória RAM utilizado
durante a execução de cada um dos métodos diretos listados
na tabela 1. Esta informação foi obtida através da ferramenta
massif contida no programa de instrumentação de códigos compu-
tacionais chamado Valgrind (NETHERCOTE; SEWARD, 2007).
Observa-se novamente que a fatoração Cholesky realizada pelo
pacote UMFPACK apresenta o menor uso de memória, prati-
camente empatado com a mesma fatoração implementada pelo
pacote MUMPS. Isso confirma o uso de Cholesky-UMFPACK



6.1. Caso 1: monofásico 2D 145

Figura 33 – Caso 1: tempo dos solvers diretos.

C
ho

l-U
M

F
P
A
C
K

LU
-U

M
F
P
A
C
K

LU
-M

U
M

P
S

C
ho

l-M
U
M

P
S

S
up

er
LU

T
e

m
p

o
 [

s
]

0

0.5

1

1.5

2

2.5

Leitura

Configuração

Resolução

Figura 34 – Caso 1: etapas dos solvers diretos.

C
ho

l-U
M

F
P
A
C
K

LU
-U

M
F
P
A
C
K

LU
-M

U
M

P
S

C
ho

l-M
U
M

P
S

S
up

er
LU

P
o

rc
e

n
ta

g
e

m
 [

%
]

0

10

20

30

40

50

60

70

80

90

100

Leitura

Configuração

Resolução



146 Capítulo 6. Resultados

como o método de referência.

Figura 35 – Caso 1: uso de memória pelos solvers diretos.

C
ho

l-U
M

F
P
A
C
K

LU
-U

M
F
P
A
C
K

LU
-M

U
M

P
S

C
ho

l-M
U
M

P
S

S
up

er
LU

P
ic

o
 d

e
 M

e
m

ó
ri
a

 [
M

B
]

0

100

200

300

400

500

600

700

800

900

6.1.3 Métodos iterativos

Considera-se agora o desempenho dos métodos de solução
iterativos. Estes são compostos pela escolha de um solver itera-
tivo e um pré-condicionador. O critério de convergência adotado
consiste em dois parâmetros: o primeiro é o número máximo de
iterações que não deve exceder 100; o segundo critério consiste
na relação entre as normas do resíduo pré-condicionado avaliada
nas iterações k e inicial, tal parâmetro deve ser igual a 1E ? 9, fa-
zendo com que a solução convergida seja suficientemente próxima
à solução obtido pelos métodos diretos.

Três opções são consideradas para os solvers iterativos:

1. Método de Richardson 3.2.2.

2. Método dos gradientes conjugados 3.2.4;

3. Método do resíduo mínimo generalizado 3.2.3.



6.1. Caso 1: monofásico 2D 147

Já as alternativas possíveis de pré-condicionadores são bem mais
vastas, conforme listadas nas tabelas 2 e 3. Considerando-se ini-
cialmente as estratégias de referência, que são descritas na pri-
meira tabela, os gráficos da variação do resíduo pré-condicionado
rk = b?M?1Axk e do resíduo real rk = b?Axk são apresentados
nas figuras 36 e 37.

Figura 36 – Caso 1: convergência dos métodos iterativos de refe-
rência.

Iteração

0 10 20 30 40 50 60 70 80 90 100

N
o

rm
a

 d
o

 R
e

s
íd

u
o

 P
re

c
o

n
d

ic
io

n
a

d
o

10
0

10
2

10
4

10
6

10
8

10
10

BoomerAMG-CG

BoomerAMG-Richardson

GAMG-CG

GAMG-Richardson

ILU-GMRes

ParaSails-GMRes

Nota-se que o método iterativo de melhor desempenho
matemático é o BoomerAMG-CG pois converge em apenas 11
iterações. É interessante observar também que se o mesmo pré-
condicionador (BoomerAMG) é utilizado em conjunto com o
solver Richardson8, a taxa de convergência do método iterativo
resultante é praticamente a metade daquela referente à estratégia
BoomerAMG-CG. O pré-condicionador multigrid baseado em
aglomeração suavizada GAMG conduz a métodos iterativos menos

8 No jargão de métodos numéricos, diz-se nesse caso que o pré-condicionador
multigrid BoomerAMG está sendo utilizado como o solver iterativo do
problema.



148 Capítulo 6. Resultados

Figura 37 – Caso 1: convergência dos métodos iterativos de refe-
rência.

Iteração

0 10 20 30 40 50 60 70 80 90 100

N
o

rm
a

 d
o

 R
e

s
íd

u
o

 R
e

a
l

10
-12

10
-10

10
-8

10
-6

10
-4

10
-2

10
0

10
2

BoomerAMG-CG

BoomerAMG-Richardson

GAMG-CG

GAMG-Richardson

ILU-GMRes

ParaSails-GMRes

eficientes que os anteriores. Nos métodos construídos por esses
pré-condicionadores é ainda mais evidente a diferença entre o
desempenho dos solvers Richardson e CG, sendo que, no primeiro
caso, o método resultante é praticamente estagnado após 50
iterações. Por último, observa-se que os pré-condicionadores ILU
e ParaSails conduzem à métodos iterativos bastante ineficientes
que estagnam após poucas iterações, isso já era previsível pois
apesar de serem robustos, tais pré-condicionadores não são muito
aconselháveis para a resolução de problemas elípticos.

Considerando ainda as figuras 36 e 37, é interessante ob-
servar os valores usuais das normas dos resíduos pré-condicionado
e real: apesar de elevados para o primeiro caso, são pequenos
para o segundo. Outro detalhe importante desses gráficos diz
respeito à taxa de convergência induzida por cada um deles. A
convergência real é mostrada na figura 37, porém tal informação
não é naturalmente calculada pelos métodos iterativos. Ao invés
disso, o resíduo pré-condicionado, mostrado na figura 36, é cal-
culado naturalmente por tais métodos com o intuito de avaliar



6.1. Caso 1: monofásico 2D 149

a convergência. Isso pode gerar falhas de interpretação sobre a
convergência do método em questão, um exemplo claro disso é
visualizado quando considera-se o método GAMG-Richardson: o
resíduo referente a esse método aparenta ser maior que aquele
referente ao ILU-GMRes de acordo com a figura 36, no entanto,
seu resíduo real é duas ordens de grandeza menor que esse último.

Uma informação que ajuda a entender bem a qualidade do
ponto de vista matemático de um pré-condicionador é o espectro
do operador pré-condicionado M?1A. Quanto mais aglutinados e
próximos da unidade os autovalores dessa matriz, maior é a taxa de
convergência do método iterativo. O cálculo dos autovalores exatos
dessa matriz é de alta demanda computacional, no entanto, pode-
se calcular uma aproximação de boa qualidade para os autovalores,
incluindo-se aqueles localizados no extremo do espectro, a partir
do método de Lanczos. As figuras 38 a 41 ilustram os autovalores
aproximados para o problema em questão quando se consideram
os pré-condicionadores BoomerAMG, GAMG, ILU e ParaSails,
respectivamente.

Figura 38 – Caso 1: autovalores aproximados do operador pré-
condicionado com BoomerAMG.

Real

0.4 0.5 0.6 0.7 0.8 0.9 1

Im
a

g

-1

-0.5

0

0.5

1

Nota-se dessas figuras que o operador pré-condicionado
apresenta autovalores reais e agrupados em torno da unidade,
exceto no caso do pré-condicionador ParaSails, que dá origem
a autovalores imaginários. Verifica-se que a melhor estratégia
entre as mostradas é dada pelo pré-condicionador BoomerAMG,
uma vez que seus autovalores são os mais próximos da unidade,
fazendo com que a a taxa de convergência do método iterativo



150 Capítulo 6. Resultados

Figura 39 – Caso 1: autovalores aproximados do operador pré-
condicionado com GAMG.

Real

0 0.2 0.4 0.6 0.8 1

Im
a

g

-1

-0.5

0

0.5

1

Figura 40 – Caso 1: autovalores aproximados do operador pré-
condicionado com ILU(0).

Real

0 0.5 1 1.5 2

Im
a

g

-1

-0.5

0

0.5

1

Figura 41 – Caso 1: autovalores aproximados do operador pré-
condicionado com ParaSails.

Real

0 0.2 0.4 0.6 0.8 1 1.2 1.4

Im
a

g

-0.15

-0.1

-0.05

0

0.05

0.1

0.15



6.1. Caso 1: monofásico 2D 151

seja a mais elevada. Resta verificar se esta estratégia é também
eficiente do ponto de vista computacional. Para tanto, o tempo e
a memória RAM associados à execução dos métodos iterativos
de referência são calculados e apresentados nas figuras 42 e 43,
a título de comparação com as estratégias de solução diretas,
apresentam-se nessas mesmas figuras as informações referentes
ao solver Cholesky-UMFPACK.

Figura 42 – Caso 1: tempos dos métodos iterativos de referência.

C
ho

l-U
M

F
P
A
C
K

B
oo

m
er

A
M

G
-C

G

B
oo

m
er

A
M

G
-R

ic
ha

rd
so

n

G
A
M

G
-C

G

G
A
M

G
-R

ic
ha

rd
so

n

IL
U
-G

M
R
es

P
ar

aS
ai
ls
-G

M
R
es

T
e
m

p
o
 [
s
]

0

1

2

3

4

5

6

7

Leitura

Configuração

Resolução

Limpeza

Entre os métodos iterativos, duas alternativas apresentam
desempenhos semelhantes em termos do tempo computacional
e uso de memória, elas são BoomerAMG-CG e ILU(0)-GMRES.
Apesar disso, a primeira escolha é preferível em relação à se-
gunda, uma vez que conduz a um método iterativo convergente,
enquanto que nessa última observa-se uma estagnação no processo
de solução. Desse modo, o BoomerAMG-CG é tomado como o
método iterativo de referência para a comparação com os pré-
condicionadores multiescala. Comparando-se o desempenho das
estratégias de referência Cholesky-UMFPACK e BoomearAMG-
CG nota-se que, apesar da primeira estratégia utilizar maior
quantidade de memória que a segunda, seu tempo computacio-



152 Capítulo 6. Resultados

Figura 43 – Caso 1: memória dos métodos iterativos de referência.

C
ho

l-U
M

F
P
A
C
K

B
oo

m
er

A
M

G
-C

G

B
oo

m
er

A
M

G
-R

ic
ha

rd
so

n

G
A
M

G
-C

G

G
A
M

G
-R

ic
ha

rd
so

n

IL
U
-G

M
R
es

P
ar

aS
ai
ls
-G

M
R
es

P
ic

o
 d

e
 M

e
m

ó
ri
a
 [
M

B
]

0

50

100

150

200

250

300

350

400

450

nal é praticamente igual a metade, da onde se conclui que tal
estratégia é a melhor disponível das apresentadas até o momento.

Consideram-se agora os métodos iterativos construídos a
partir do solver GMRes e dos pré-condicionadores do tipo multi-
escala, que são listados na tabela 3. Com o intuito de facilitar a
apresentação de seus resultados, tais pré-condicionadores são divi-
didos em quatro grupos conforme o tipo do suavizador empregado
no estágio local:

a) ILU;

b) SOR;

c) AS;

d) Funções de correção.
A razão de engrossamento escolhida inicialmente para

a apresentação dos resultados é de 8 × 8, a qual resulta num
problema grosseiro de tamanho 64 × 64, que por sua vez é re-
solvido diretamente através do método Cholesky-UMFPACK.
Posteriormente, a influência da razão de engrossamento sobre o
desempenho desses pré-condicionadores será avaliada.

As figuras 44 e 45 ilustram os valores dos resíduos pré-



6.1. Caso 1: monofásico 2D 153

condicionado e real, respectivamente, quando os pré-condicionadores
multiescala com suavizador local do tipo ILU são empregados.
Verifica-se em cada estratégia multiescala cujo operador global é
do tipo MsFV que sua taxa de convergência é menor em relação
à estratégia semelhante do tipo MsFE, desse modo segue que
o operador global MsFE é de melhor qualidade que o operador
MsFV. A estratégia de maior taxa de convergência entre aquelas
do tipo multiescala é a MsFEilu1sym, porém esta ainda não é
superior à estratégia iterativa de referência BoomerAMG-CG.

Figura 44 – Caso 1: norma do resíduo pré-condicionado - MSilu.

Iteração

0 10 20 30 40 50 60 70 80 90 100

N
o
rm

a
 d

o
 R

e
s
íd

u
o
 P

re
c
o
n
d
ic

io
n
a
d
o

10
0

10
2

10
4

10
6

10
8

10
10

BoomerAMG-CG

MsFVilu0

MsFEilu0

MsFEilu0sym

MsFVilu1

MsFEilu1

MsFEilu1sym

A figura 46 mostra o tempo associado à execução das
estratégias em questão. Nota-se que o tempo de configuração
de todas elas é bastante semelhante, sendo ligeiramente maior
para os casos em que o operador global MsFV é construído. Os
três melhores tempos são encontrados para as estratégias Ms-
FEilu1sym, MsFEilu0sym e MsFEilu1, que justamente são as que
possuem as três melhores taxas de convergência, respectivamente,
o que faz com que o tempo de resolução dessas estratégias seja
menor em relação aos demais. Devido ao fato de apresentar a
melhor taxa de convergência e o menor tempo computacional, a
estratégia MsFEilu1sym é escolhida como a de referência entre os
pré-condicionadores multiescala baseados na fatoração ILU.



154 Capítulo 6. Resultados

Figura 45 – Caso 1: norma do resíduo real - MSilu.

Iteração

0 10 20 30 40 50 60 70 80 90 100

N
o
rm

a
 d

o
 R

e
s
íd

u
o
 R

e
a
l

10
-10

10
-8

10
-6

10
-4

10
-2

10
0

10
2

BoomerAMG-CG

MsFVilu0

MsFEilu0

MsFEilu0sym

MsFVilu1

MsFEilu1

MsFEilu1sym

Figura 46 – Caso 1: tempos das estratégias MSilu.

C
ho

l-U
M

F
P
A
C
K

B
oo

m
er

A
M

G
-C

G

M
sF

V
ilu

0

M
sF

E
ilu

0

M
sF

E
ilu

0s
ym

M
sF

V
ilu

1

M
sF

E
ilu

1

M
sF

E
ilu

1s
ym

T
e
m

p
o
 [
s
]

0

0.5

1

1.5

2

2.5

3

3.5

4

4.5

5

Leitura

Configuração

Resolução

Limpeza



6.1. Caso 1: monofásico 2D 155

Consideram-se agora os pré-condicionadores multiescala
com suavizador local do tipo SOR. Os gráficos das normas dos
resíduos pré-condicionado e real são dados pelas figuras 47 e 48.
Como anteriormente, o operador global do tipo MsFE conduz
a métodos de maior taxa de convergência, a melhor estratégia
nesse sentido é a MsFEssor3sym, pois converge para a tolerância
requisitada em 31 iterações.

Figura 47 – Caso 1: norma do resíduo pré-condicionado - MSsor.

Iteração

0 10 20 30 40 50 60 70 80 90 100

N
o
rm

a
 d

o
 R

e
s
íd

u
o
 P

re
c
o
n
d
ic

io
n
a
d
o

10
0

10
2

10
4

10
6

10
8

10
10

10
12

BoomerAMG-CG

MsFVsor1

MsFEsor1

MsFEssor1sym

MsFVsor2

MsFEsor2

MsFEssor2sym

MsFEssor3sym

A figura 49 mostra o tempo necessário para a execução de
cada uma das estratégias. Nota-se que apesar de MsFEssor3sym
apresentar maior taxa de convergência, esta não é a estratégia
de menor tempo computacional. Ao invés dela, a alternativa
representada por MsFEssor2sym mostra-se ligeiramente mais
rápida, portanto, esta é tomada como a estratégia de referência
entre os pré-condicionadores multiescala baseados na fatoração
SOR.

Com relação aos pré-condicionadores multiescala com
suavização do tipo schwarz aditivo, as normas dos resíduos pré-
condicionado e real são dadas pelas figuras 50 e 51, enquanto
que o tempo computacional de cada estratégia é dado pela fi-
gura 52. Observa-se que a melhor estratégia multiescala é a Ms-
FEHSe, de modo que essa é tomada como referência para os



156 Capítulo 6. Resultados

Figura 48 – Caso 1: norma do resíduo real - MSsor.

Iteração

0 10 20 30 40 50 60 70 80 90 100

N
o
rm

a
 d

o
 R

e
s
íd

u
o
 R

e
a
l

10
-10

10
-8

10
-6

10
-4

10
-2

10
0

10
2

BoomerAMG-CG

MsFVsor1

MsFEsor1

MsFEssor1sym

MsFVsor2

MsFEsor2

MsFEssor2sym

MsFEssor3sym

Figura 49 – Caso 1: tempos das estratégias - MSsor.

C
ho

l-U
M

F
P
A
C
K

B
oo

m
er

A
M

G
-C

G

M
sF

V
so

r1

M
sF

E
so

r1

M
sF

E
ss

or
1s

ym

M
sF

V
so

r2

M
sF

E
so

r2

M
sF

E
ss

or
2s

ym

M
sF

E
ss

or
3s

ym

T
e
m

p
o
 [
s
]

0

0.5

1

1.5

2

2.5

3

3.5

4

4.5

5

Leitura

Configuração

Resolução

Limpeza



6.1. Caso 1: monofásico 2D 157

pré-condicionadores multiescala dessa classe. No entanto, assim
como as anteriores, a taxa de convergência ainda é pior que aquela
observada na estratégia iterativa de referência BoomerAMG-CG,
enquanto que o tempo computacional é também bem mais ele-
vado. É interessante observar que a parcela do tempo gasto com
a configuração do pré-condicionador é praticamente o dobro em
relação aos casos anteriores.

Figura 50 – Caso 1: norma do resíduo pré-condicionado - MShs.

Iteração

0 10 20 30 40 50 60 70 80 90 100

N
o
rm

a
 d

o
 R

e
s
íd

u
o
 P

re
c
o
n
d
ic

io
n
a
d
o

10
0

10
2

10
4

10
6

10
8

10
10

10
12

BoomerAMG-CG

MsFVHS

MsFEHS

MsFVHSe

MsFEHSe

MsFEHS3e

Por último, compara-se o desempenho dos pré-condicionadores
multiescala de acordo com o suavizador empregado, para tanto, as
estratégias de referência para cada tipo de suavizador são levadas
em consideração bem como os métodos MsFVwc e MsFEwc, que
são construídos com o suavizador baseado nas funções de corre-
ção. As normas dos resíduos pré-condicionado e real obtidas são
mostradas nas figuras 53 e 54. É interessante observar que apesar
de as estratégias baseadas em funções de correção parecerem ser
convergentes quando se olha o resíduo pré-condicionado, elas de
fato não o são, conforme apresentado pelo gráfico da variação do
resíduo real.

As figuras 55 e 56 ilustram o tempo computacional e o
máximo uso de memória RAM associados à execução das estra-
tégias em questão. Das figuras 53 a 54, segue que a estratégia



158 Capítulo 6. Resultados

Figura 51 – Caso 1: norma do resíduo real - MShs.

Iteração

0 10 20 30 40 50 60 70 80 90 100

N
o
rm

a
 d

o
 R

e
s
íd

u
o
 R

e
a
l

10
-10

10
-8

10
-6

10
-4

10
-2

10
0

10
2

BoomerAMG-CG

MsFVHS

MsFEHS

MsFVHSe

MsFEHSe

MsFEHS3e

Figura 52 – Caso 1: tempos das estratégias - MShs.

C
ho

l-U
M

F
P
A
C
K

B
oo

m
er

A
M

G
-C

G

M
sF

V
H
S

M
sF

E
H
S

M
sF

V
H
S
e

M
sF

E
H
S
e

M
sF

E
H
S
3e

T
e
m

p
o
 [
s
]

0

2

4

6

8

10

12

14

16

18

20

Leitura

Configuração

Resolução

Limpeza



6.1. Caso 1: monofásico 2D 159

Figura 53 – Caso 1: norma do resíduo pré-condicionado.

Iteração

0 10 20 30 40 50 60 70 80 90 100

N
o
rm

a
 d

o
 R

e
s
íd

u
o
 P

re
c
o
n
d
ic

io
n
a
d
o

10
0

10
2

10
4

10
6

10
8

10
10

10
12

10
14

BoomerAMG-CG

MsFVwc

MsFEwc

MsFEilu1sym

MsFEssor2sym

Figura 54 – Caso 1: norma do resíduo real.

Iteração

0 10 20 30 40 50 60 70 80 90 100

N
o
rm

a
 d

o
 R

e
s
íd

u
o
 R

e
a
l

10
-10

10
-8

10
-6

10
-4

10
-2

10
0

10
2

BoomerAMG-CG

MsFVwc

MsFEwc

MsFEilu1sym

MsFEssor2sym



160 Capítulo 6. Resultados

MsFEilu1sym é a mais eficiente dos pontos de vista matemático
e computacional entre os métodos multiescala.

Figura 55 – Caso 1: tempos das estratégias multiescala.

C
ho

l-U
M

F
P
A
C
K

B
oo

m
er

A
M

G
-C

G

M
sF

V
w
c

M
sF

E
w
c

M
sF

E
ilu

1s
ym

M
sF

E
ss

or
2s

ym

T
e
m

p
o
 [
s
]

0

1

2

3

4

5

6

Leitura

Configuração

Resolução

Limpeza

Figura 56 – Caso 1: uso de memória de diferentes estratégias de
solução.

C
ho

l-U
M

F
P
A
C
K

B
oo

m
er

A
M

G
-C

G

M
sF

V
w
c

M
sF

E
w
c

M
sF

E
ilu

1s
ym

M
sF

E
ss

or
2s

ym

P
ic

o
 d

e
 M

e
m

ó
ri
a
 [
M

B
]

0

200

400

600

800

1000

1200

Os resultados mostrados até agora a respeito do uso dos



6.1. Caso 1: monofásico 2D 161

métodos multiescala como pré-condicionadores para a obtenção de
soluções precisas de sistemas lineares elípticos considerou que o ta-
manho do problema em nível grosseiro (estágio global) é de 64×64
volumes de controle, que resulta num sistema linear de dimensão
4096 × 4096. Estuda-se agora como a variação desse parâmetro
influencia nas propriedades do pré-condicionador. Considerou-se
para tanto os seguintes tamanhos: 4 × 4; 8 × 8; 16 × 16; 32 × 32;
64 × 64 e 128 × 128. As figuras 57 e 58 mostram os resíduos
pré-condicionado e real, respectivamente. Nota-se que a taxa de
convergência do solver iterativo é diretamente proporcional ao
tamanho do problema grosseiro, além disso, o ganho de perfor-
mance que se observa entre as opções 64 × 64 e 32 × 32 é bem
maior que o observado variando-se entre 128 × 128 e 64 × 64.

Figura 57 – Caso 1: norma do resíduo pré-condicionado da estraté-
gia MsFEilu1sym variando-se o tamanho do problema
global.

Iteração

0 10 20 30 40 50 60 70 80 90 100

N
o
rm

a
 d

o
 R

e
s
íd

u
o
 P

re
c
o
n
d
ic

io
n
a
d
o

10
0

10
2

10
4

10
6

10
8

10
10

MsFEilu1sym-4x4

MsFEilu1sym-8x8

MsFEilu1sym-16x16

MsFEilu1sym-32x32

MsFEilu1sym-64x64

MsFEilu1sym-128x128

O tempo computacional verificado para a estratégia Ms-
FEilu1sym é dado pela figura 59. Segue que a alternativa mais
eficiente do ponto de vista computacional consiste naquela cujo
problema global é de tamanho 64 × 64, referente à razão de en-
grossamento igual a 8×8. Adiciona-se que o tamanho máximo dos
sistemas lineares locais resolvidos para a construção do operador



162 Capítulo 6. Resultados

Figura 58 – Caso 1: norma do resíduo real da estratégia Ms-
FEilu1sym variando-se o tamanho do problema glo-
bal.

Iteração

0 10 20 30 40 50 60 70 80 90 100

N
o
rm

a
 d

o
 R

e
s
íd

u
o
 R

e
a
l

10
-10

10
-8

10
-6

10
-4

10
-2

10
0

MsFEilu1sym-4x4

MsFEilu1sym-8x8

MsFEilu1sym-16x16

MsFEilu1sym-32x32

MsFEilu1sym-64x64

MsFEilu1sym-128x128

de prolongação é 64×64, permitindo facilmente o uso de métodos
diretos nesses cálculos.

O espectro aproximado do operador pré-condicionado
através da estratégia MsFEilu1sym-64x64 é dado pela figura
60. Observa-se que os autovalores são todos reais e localizados
no intervalo [0, 1], exceto um par de autovalores cuja parcela
imaginária é diferente de zero, apesar de pequena. Isso não era
esperado já que tanto a matriz A como o pré-condicionador
empregado são simétricos, no entanto, pode ser causado pela
precisão finita na representação dos números pela máquina.

O uso máximo de memória é dado pela figura 61, em que
nota-se que esta quantidade aumenta de modo exagerado a medida
que a razão de engrossamento decresce. Isso se deve ao fato de que
a implementação computacional do operador de prolongação não
considera a reutilização de espaços na memória RAM já alocados
durante a execução do programa. Conclui-se que o código com-
putacional construído no presente trabalho pode ser refatorado
a fim de utilizar a memória RAM de modo mais eficiente, isso
acarretaria também numa diminuição do tempo computacional



6.1. Caso 1: monofásico 2D 163

Figura 59 – Caso 1: tempos obtidos variando-se o tamanho do
problema global.

4x
4

8x
8

16
x1

6

32
x3

2

64
x6

4

12
8x

12
8

T
e
m

p
o
 [
s
]

0

1

2

3

4

5

6

Leitura

Configuração

Resolução

Figura 60 – Caso 1: espectro do operador pré-condicionado por
MsFEilu1sym-64x64.

Real

0.1 0.2 0.3 0.4 0.5 0.6 0.7 0.8 0.9 1

Im
a
g

×10
-3

-5

0

5



164 Capítulo 6. Resultados

necessário a sua execução tornando o pré-condicionador em ques-
tão mais competitivo em relação ao pré-condicionador multigrid
de referência (BoomerAMG).

Figura 61 – Caso 1: picos de memória obtidos variando-se o ta-
manho do problema global.

M
sF

E
ilu

1s
ym

-4
x4

M
sF

E
ilu

1s
ym

-8
x8

M
sF

E
ilu

1s
ym

-1
6x

16

M
sF

E
ilu

1s
ym

-3
2x

32

M
sF

E
ilu

1s
ym

-6
4x

64

M
sF

E
ilu

1s
ym

-1
28

x1
28

P
ic

o
 d

e
 M

e
m

ó
ri
a
 [
M

B
]

0

500

1000

1500

2000

2500

6.2 CASO 2: ESCOAMENTO CANALIZADO

O segundo problema teste consiste no escoamento monofá-
sico de óleo com densidade de 800 kg/m3 e viscosidade 10 cP atra-
vés de um reservatório bidimensional de tamanho 10 240 m×128 m
ao longo do plano “xy” e sujeito a efeitos gravitacionais na direção
“y”. As condições de contorno do problema são de pressão prescrita
nas fronteiras laterais e inferior e de fluxo nulo na superior. As
primeiras representam a ação de poços verticais ao longo do eixo
“y” de modo que a pressão na fronteira à esquerda é de 25 MPa,
enquanto à direita é de 2 MPa. Já a fronteira inferior do reserva-
tório está em contato com outra formação rochosa submetida à
pressão uniforme de 5 MPa. A malha empregada no processo de
discretização do domínio é de 1280 × 1280 volumes de controle,
totalizando 1638400 incógnitas.



6.2. Caso 2: escoamento canalizado 165

O campo de permeabilidade da rocha-reservatório é al-
tamente heterogêneo e apresenta valores variando em cinco or-
dens de grandeza entre 1.0 × 10?2 mD até 1.0 × 103 mD. Este foi
construído da mesma forma como no problema anterior, sendo
ilustrado na figura 62.

Figura 62 – Caso 2: campo de permeabilidade.

O campo de pressão de referência obtido através da aplica-
ção do método direto Cholesky-UMFPACK é mostrado na figura
63, enquanto as linhas de corrente são ilustradas na figura 64.
Observa-se na primeira que o campo de pressão varia de modo não
uniforme, uma vez que o campo de permeabilidade é heterogêneo,
ao longo do domínio entre os valores de pressão mínimo e máximo
pertencentes às faces laterais. Na segunda figura, mostra-se os
caminhos preferenciais de escoamento através do reservatório. É
interessante observar como a força gravitacional atua fortemente
no escoamento, fazendo com que atravesse também regiões de
baixa permeabilidade.



166 Capítulo 6. Resultados

Figura 63 – Caso 2: campo de pressão.

Figura 64 – Caso 2: linhas de corrente de referência.



6.2. Caso 2: escoamento canalizado 167

6.2.1 Solução aproximada

As figuras 65 e 66 mostram os campos de pressão obtidos
empregando-se apenas uma iteração dos pré-condicionadores mul-
tiescala baseados em volumes finitos e elementos finitos (MsFVM
e MsFEM), respectivamente, para a solução aproximada do pro-
blema. A razão de engrossamento utilizada é de 12.8 × 12.8, ge-
rando um problema global de tamanho 100×100. Considerando-se
primeiramente a solução obtida pelo MsFVM, nota-se a presença
ainda maior em relação ao caso 1 de pontos de máximo e mínimo
locais de pressão ao longo do reservatório, não atendendo portanto
ao critério de monotonicidade. Já a solução obtida pelo MsFEM
apresenta maior semelhança em relação à solução de referência e
respeita esse último critério, no entanto, não conduz a campos de
velocidade conservativos assim como o MsFVM.

Figura 65 – Caso 2: campo de pressão MsFVM-100x100.

Considerando-se agora uma razão de engrossamento igual
a 8 × 8, obtém-se um problema global de tamanho 160 × 160.
Nesse caso, os campos de pressão aproximados pelas estratégias
MsFVM e MsFEM são dados pelas figuras 67 e 68, respectiva-
mente. Em ambas estratégias, especialmente quando se considera o
MsFVM-160x160, nota-se uma melhora considerável na qualidade
da solução aproximada, uma vez que o gráfico do erro relativo



168 Capítulo 6. Resultados

Figura 66 – Caso 2: campo de pressão MsFEM-100x100.

ao longo do domínio apresenta menores valores em comparação
com os observados nas figuras 65 e 66 referentes aos métodos
MsFVM-100x100 e MsFEM-100x100. Tal observação corrobora
o fato apresentado no caso 1 de que razões de engrossamento
inferiores a 10 conduzem a aproximações satisfatórias para o
campo de pressão. É importante observar também que a estra-
tégia MsFVM-160x160 apresenta problemas de monotonicidade,
assim como anteriormente, porém conduz a campos de velocidade
conservativos.

6.2.2 Solução precisa

Considera-se agora a resolução precisa do campo de pres-
são empregando-se os pré-condicionadores BoomerAMG, Ms-
FEilu1sym e MsFEssor2sym. Estes últimos foram escolhidos
entre os listados na tabela 3 pelo fato de apresentarem os me-
lhores desempenhos, conforme discutido no caso 1. Como os
pré-condicionadores em questão são todos simétricos, bem como
o próprio problema resolvido, utiliza-se o método dos gradientes
conjugados como solver iterativo. O critério de convergência ado-
tado é o mesmo que anteriormente, isto é, a razão entre as normas
dos resíduos pré-condicionados atual e inicial deve ser menor que



6.2. Caso 2: escoamento canalizado 169

Figura 67 – Caso 2: campo de pressão MsFVM-160x160.

Figura 68 – Caso 2: campo de pressão MsFEM-160x160.



170 Capítulo 6. Resultados

1.0 × 10?9, além disso, considera-se que o número máximo de
iterações é igual a 150.

Analisa-se inicialmente o desempenho dos pré-condicionadores
multiescala. Para tanto, apresentam-se nas figuras 69 e 70 os gráfi-
cos das normas dos resíduos reais obtidos pelos métodos iterativos
MsFEilu1sym-CG e MsFEssor2sym-CG de acordo com diferentes
tamanhos para o problema global. Da primeira figura, conclui-se
que o número de iterações necessárias para a convergência é maior
que no problema anterior sendo que esta varia pouco quando
a razão de engrossamento empregada é em torno de 10 × 10.
Da segunda figura, nota-se que o método MsFEssor2sym-CG
não é convergente sendo que ele o resíduo real se estagna em
diferentes valores de acordo com o tamanho do problema global
considerado. Assim como concluído anteriormente, segue que o pré-
condicionador MsFEilu1sym é mais eficiente que MsFEssor2sym.

Figura 69 – Caso 2: resíduo real obtido pelo método
MsFEilu1sym-CG.

Iteração

0 50 100 150

N
o
rm

a
 d

o
 R

e
s
íd

u
o
 R

e
a
l

10
-14

10
-12

10
-10

10
-8

10
-6

10
-4

10
-2

MsFEilu1sym-CG-40x40

MsFEilu1sym-CG-80x80

MsFEilu1sym-CG-100x100

MsFEilu1sym-CG-120x120

MsFEilu1sym-CG-140x140

MsFEilu1sym-CG-160x160

MsFEilu1sym-CG-200x200

MsFEilu1sym-CG-240x240

Os tempos computacionais referentes aos métodos numé-
ricos formados pelos pré-condicionadores do tipo MsFEilu1sym
variando-se o tamanho do problema global são dados pela figura
71. Segue que o tempo computacional é mínimo na alternativa



6.2. Caso 2: escoamento canalizado 171

Figura 70 – Caso 2: resíduo real pelo método MsFEssor2sym-CG.

Iteração

0 50 100 150

N
o
rm

a
 d

o
 R

e
s
íd

u
o
 R

e
a
l

10
-7

10
-6

10
-5

10
-4

10
-3

10
-2

10
-1

MsFEssor2sym-CG-40x40

MsFEssor2sym-CG-80x80

MsFEssor2sym-CG-100x100

MsFEssor2sym-CG-120x120

MsFEssor2sym-CG-140x140

MsFEssor2sym-CG-160x160

MsFEssor2sym-CG-200x200

MsFEssor2sym-CG-240x240

MsFEilu1sym-40x40, de modo que esta é tomada como a escolha
de referência de pré-condicionador multiescala. Nota-se que para
problemas globais de menor tamanho, a taxa de convergência é
muito pequena, o que causa um aumento considerável no tempo
relativo à etapa de resolução do método iterativo. Já para pro-
blemas globais de tamanhos maiores que 40 × 40, o ganho que se
tem com o aumento da taxa de convergência é insuficiente para
se contrapor com a maior quantia de tempo necessária para a
configuração do pré-condicionador.

Comparam-se agora os desempenhos do solver direto de
referência (Cholesky-UMFPACK) e dos solvers iterativos basea-
dos no método dos gradientes conjugados pré-condicionado com as
estratégias multiescala de referência (MsFEilu1sym-40x40) e mul-
tigrid de referência (BoomerAMG). A figura 72 ilustra o gráfico
dos resíduos reais obtidos pelos métodos iterativos em conside-
ração. Nota-se que o pré-condicionador BoomerAMG apresenta
desempenho ótimo, convergindo no mesmo número de iterações
em relação ao problema anterior, apesar do presente caso ser
mais complexo e ainda possuir cerca de seis vezes mais incógnitas.
Segue que o BoomerAMG apresenta melhor escalabilidade que as
estratégias multiescala estudadas, além de melhor desempenho



172 Capítulo 6. Resultados

Figura 71 – Caso 2: tempo computacional pela estratégia
MsFEilu1sym-CG.

5x
5

10
x1

0

20
x2

0

40
x4

0

80
x8

0

10
0x

10
0

12
0x

12
0

14
0x

14
0

16
0x

16
0

20
0x

20
0

24
0x

24
0

T
e
m

p
o
 [
s
]

0

10

20

30

40

50

60

70

80

90

Leitura

Configuração

Resolução

em termos de taxa de convergência.

Figura 72 – Caso 2: resíduo real para as estratégias de referência.

Iteração

0 50 100 150

N
o
rm

a
 d

o
 R

e
s
íd

u
o
 R

e
a
l

10
-14

10
-12

10
-10

10
-8

10
-6

10
-4

10
-2

10
0

10
2

BoomerAMG-CG

MsFEilu1sym-CG

As figuras 73 e 74 mostram o espectro aproximado da
matriz original A pré-condicionada com as estratégias Boome-
rAMG e MsFEilu1sym-40x40, respectivamente. É nítido que os



6.2. Caso 2: escoamento canalizado 173

autovalores da primeira alternativa estão mais próximos da uni-
dade que aqueles referentes à segunda, conduzindo portanto a
métodos iterativos de maior taxa de convergência.

Figura 73 – Caso 2: espectro aproximado do operador original
pré-condicionado com BoomerAMG.

Real

0.5 0.6 0.7 0.8 0.9 1

Im
a
g

-1

-0.5

0

0.5

1

Figura 74 – Caso 2: espectro aproximado do operador original
pré-condicionado com MsFEilu1sym-40x40.

Real

0 0.2 0.4 0.6 0.8 1

Im
a
g

-1

-0.5

0

0.5

1

Na figura 75 mostram-se os tempos necessários para a
execução dos mesmos métodos iterativos e direto discutidos acima.
O tempo necessário para a execução da etapa de resolução do pré-
condicionador MsFEilu1sym-40x40 é cerca de três vezes maior que
aquele referente ao BoomerAMG-CG, enquanto que a etapa de
configuração do pré-condicionador multiescala é aproximadamente
cinco vezes maior. Segue que apesar do custo por iteração do
método BoomerAMG-CG ser maior, este converge muito mais
rapidamente e, portanto, tal escolha é muito mais eficiente que a
primeira. Apesar do pré-condicionador BoomerAMG ser muito



174 Capítulo 6. Resultados

eficiente, tem-se que, assim como no caso 1, a estratégia Cholesky-
UMFPACK é a mais rápida das avaliadas.

Figura 75 – Caso 2: Tempos computacionais das estratégias de
referência.

Chol-UMFPACK BoomerAMG-CG MsFEilu1sym-CG

T
e
m

p
o
 [
s
]

0

5

10

15

20

25

Leitura

Configuração

Resolução

Na figura 76 mostra-se o uso máximo de memória RAM
pelas estratégias de referência. Nesse caso, nota-se que o método
iterativo construído com o pré-condicionador multiescala não apre-
senta um uso muito elevado de memória, como mostrado para
o caso 1. No entanto, tal quantidade deveria ser ainda menor
que aquela observada para o método direto Cholesky-UMFPACK,
uma vez que o grafo referente à matriz multiescala apresenta
menor número de conexões que o da matriz original e, portanto,
conduziria a um menor grau de preenchimento durante sua reso-
lução por algum método direto. Este último fato não é atendido
devido à maneira com que a construção do operador de prolon-
gação foi implementada computacionalmente, isto é, alocando-se
novos espaços na memória RAM que poderiam ser reutilizados.
Segue que o código computacional desenvolvido pode ainda ser
refatorado a fim de que utilize menos memória e, por conseguinte,
execute mais rapidamente, uma vez que o reaproveitamento de es-
paços pré-alocados na memória diminui o tempo de acesso dessas
informações.



6.3. Caso 3: bifásico incompressível 2D 175

Figura 76 – Caso 2: pico de memória da estratégia MsFEilu1sym-
CG.

Chol-UMFPACK BoomerAMG-CG MsFEilu1sym-CG

P
ic

o
 d

e
 M

e
m

ó
ri
a
 [
M

B
]

0

200

400

600

800

1000

1200

1400

1600

1800

6.3 CASO 3: BIFÁSICO INCOMPRESSÍVEL 2D

Esse caso é baseado no escoamento bifásico e incompres-
sível de água com densidade e viscosidade iguais a 1000 kg/m3 e
1 cP, além de óleo com densidade e viscosidade iguais a 800 kg/m3
e 10 cP, respectivamente. As curvas de permeabilidade relativa
desses fluidos são dadas pela figura 77.

Figura 77 – Caso 3: curvas de permeabilidade relativa.

Saturação [-]

0 0.2 0.4 0.6 0.8 1

P
e
rm

e
a
b

il
id

a
d

e
 r

e
la

ti
v
a

 [
-]

0

0.1

0.2

0.3

0.4

0.5

0.6

0.7

0.8

0.9

1

k
rw

k
ro



176 Capítulo 6. Resultados

O reservatório tem dimensões 365m × 670m e a malha
empregada na sua discretização tem tamanho 60×220, totalizando
13200 incógnitas. O campo de permeabilidade absoluta é isotrópico
e representado pela figura 78.

Figura 78 – Caso 3: campo de permeabilidade absoluta.

Há quatro poços produtores e um poço injetor dispostos
no padrão five-spot, sendo que suas propriedades são dadas pela
tabela 4.

Tabela 4 – Caso 3: propriedades dos poços.

Poço Raio [m] Volume Posição [m] BHP9 [MPa]

P1 0.125 1 (3.048, 1.524) 5
P2 0.125 60 (362.712, 1.524) 5
P3 0.125 13141 (3.048, 669.036) 5
P4 0.125 13200 (362.712, 669.036) 5
I1 0.125 6570 (179.832, 333.756) 80

9 Pressão de fundo de poço.



6.3. Caso 3: bifásico incompressível 2D 177

O tempo de simulação é igual a 30 000 dias, enquanto o
passo de tempo é variável, conforme apresentado na tabela 5.
Empregarem-se ambas estratégias IMPES e SFI para a solução ao
longo do tempo, descritas na seção 2.2. Verificou-se que a última
estratégia é mais estável que a primeira e, portanto, permite o
uso de maiores passos de tempo. Portanto, esta foi tomada como
a alternativa de referência para a solução do presente problema.

Tabela 5 – Caso 3: passos de tempo.

Duração [d] Vezes Período [d]

50 20 0 ? 1000
100 20 1001 ? 3000
150 100 3001 ? 18000
200 60 18001 ? 30000

6.3.1 Solução aproximada

Empregando-se o MsFVM como técnica de upscaling para
a obtenção de campos de pressão aproximados, isto é, aplicando-se
uma única iteração do estágio global do pré-condicionador multi-
escala para a resolução do problema linear da pressão, verificou-se
que as soluções referentes aos primeiros passos de tempo são satis-
fatórias, porém logo a qualidade do campo de pressão é degradada
causando problemas no cálculo do campo de saturação.

Passos de tempo menores que os listados na tabela 5 bem
como razões de engrossamento menores que 10 foram empregados,
o que deveria resolver melhorar a qualidade do campo de pressão
e tornar o cálculo do campo de pressão convergente. No entanto,
notou-se que o problema citado não é extinto, mas apenas atrasado
para passos de tempo posteriores. Desse modo, conclui-se que,
ao menos para o problema testado, o uso do pré-condicionador
multiescala como técnica de upscaling não é recomendado.



178 Capítulo 6. Resultados

6.3.2 Solução precisa

Considera-se agora o uso do pré-condicionador multies-
cala de referência, MsFEilu1sym, em conjunto com o método do
gradiente conjugado para a obtenção de soluções precisas para o
campo de pressão ao longo dos instantes de tempo considerados
na simulação. Primeiramente, avaliam-se diversas alternativas
para a razão de engrossamento empregada pelo pré-condicionador
multiescala com o intuito de verificar a estratégia mais eficiente
do ponto de vista computacional.

A figura 79 ilustra as parcelas de tempo associadas à
solução das equações para a pressão, em que se emprega a estra-
tégia MsFEilu1sym-CG, e também aquelas associadas à solução
das equações para as saturações das fases água e óleo, que são
não-lineares e resolvidas através do método de Newton exato.
Observa-se uma diferença de aproximadamente 15 s entre as es-
tratégias baseadas na maior e menor razões de engrossamento
consideradas (malhas grossas com tamanhos 3 × 9 e 15 × 56,
respectivamente). Logo, a estratégia cujo problema global é de
tamanho 3 × 9 é tomada como a estratégia multiescala de refe-
rência para a comparação com as estratégias BoomerAMG-CG e
Cholesky-UMFPACK.

O número de iterações e os tempos de execução da es-
tratégia MsFEilu1sym3x9-CG em função do passo de tempo são
dados pelas figuras 80. Na primeira figura observa-se que todos os
problemas elípticos foram resolvidos dentro do número máximo
de iterações permitido, além disso nota-se que a quantia de itera-
ções necessárias à convergência é maior no início da simulação,
mas logo após os primeiros 40 passos de tempo, tal parâmetro
estabiliza-se em torno de 35 iterações. Esse último comporta-
mento se deve ao fato de que a solução referente ao passo de
tempo anterior é utilizada como estimativa inicial para o cálculo
da solução atual. Já na segunda figura é possível observar que
a maioria dos sistemas lineares são resolvidos em menos de 0.1 s
sendo que as etapas de leitura e limpeza de dados se dão em uma
parcela insignificante do tempo total enquanto a etapa de configu-
ração do pré-condicionador é a que toma a maior parcela. Por fim,



6.3. Caso 3: bifásico incompressível 2D 179

Figura 79 – Caso 3: tempo de solução de acordo com diferentes
tamanhos para o problema na malha grossa.

3x9 4x12 5x18 6x22 8x28 12x44 15x56

T
e

m
p

o
 [

s
]

0

10

20

30

40

50

60

70

80

Pressão

Saturação

adiciona-se que o tempo de configuração do pré-condicionador
multiescala poderia ser reduzido caso o operador de prolongação
fosse reconstruído somente nas regiões em que há mudança signi-
ficativa no campo de saturação a medida que o passo de tempo
avança.

Compara-se agora o desempenho computacional da estra-
tégia multiescala de referência, MsFEilu1sym3x9-CG, em relação
aos métodos direto e iterativo de referência, Cholesky-UMFPACK
e BoomerAMG-CG, respectivamente. A figura 82 mostra o so-
matório, ao longo dos passos de tempo da simulação, do tempo
computacional associado à execução das estratégias citadas. Nota-
se que a estratégia mais eficiente para a resolução da variável
pressão é dada pelo método direto, sendo que esta leva apenas 6s
para a resolução de todos os sistemas lineares elípticos obtidos
no decorrer da simulação. É interessante observar também que
a aplicação do pré-condicionador multiescala algébrico leva um
tempo menor que o método iterativo de referência BoomerAMG-
CG, porém o tempo gasto durante sua configuração é bastante
superior, fazendo com que seu tempo total de execução também



180 Capítulo 6. Resultados

Figura 80 – Caso 3: número de iterações da estratégia
MsFEilu1sym3x9-CG em função do passo de tempo.

Passo de tempo

0 50 100 150 200

N
ú

m
e

ro
 d

e
 i
te

ra
ç
õ

e
s

0

10

20

30

40

50

60

Figura 81 – Caso 3: tempo de execução da estratégia
MsFEilu1sym3x9-CG em função do passo de
tempo.

Passo de tempo

0 20 40 60 80 100 120 140 160 180 200

T
e

m
p

o
 [

s
]

0

0.02

0.04

0.06

0.08

0.1

0.12
Leitura

Configuração

Resolução

Limpeza



6.3. Caso 3: bifásico incompressível 2D 181

o seja.

Figura 82 – Caso 3: tempo computacional total associado à exe-
cução das estratégias de referência.

Cholesky-UMFPACK BoomerAMG-CG MsFEilu1sym3x9-CG

T
e

m
p

o
 [

s
]

0

2

4

6

8

10

12

14

16

18
Leitura

Configuração

Resolução

Limpeza

A figura 83 mostra o tempo computacional total necessá-
rio para a resolução das variáveis primárias pressão e saturação
quando se empregam as estratégias de referência no cálculo da
pressão. Verifica-se que a parcela de tempo associada ao cálculo da
saturação é semelhante em todos os casos, o que era esperado já
que essa tarefa é realizada a partir de campos de pressão obtidos
com níveis de precisão elevados. Além disso, nota-se que tal par-
cela de tempo representa ao redor de 80%, 70% e 60%, do tempo
total de simulação associado às estratégias Cholesky-UMFPACK,
BoomerAMG-CG e MsFEilu1sym-CG, respectivamente.

Por fim, apresentam-se na figura 84 os campos de pressão
obtidos diretamente pelas estratégias Cholesky-UMFPACK, à es-
querda, e iterativamente através da estratégia MsFEilu1sym-CG,
à direita, nos instantes de tempo iguais a 9900, 20000 e 30000
dias, respectivamente. Além disso, os campos de saturação da
fase óleo segundos os mesmos parâmetros citados são expostos
na figura 85. Naturalmente, verifica-se nas figuras apresentadas
que as soluções propostas por ambas estratégias coincidem entre



182 Capítulo 6. Resultados

Figura 83 – Caso 3: tempo de execução da estratégia
MsFEilu1sym3x9-CG em função do passo de
tempo.

Cholesky-UMFPACK BoomerAMG-CG MsFEilu1sym3x9-CG

T
e

m
p

o
 [

s
]

0

5

10

15

20

25

30

35

40

45

Pressão

Saturação

si. É interessante notar na figura 85 a maneira com que as he-
terogeneidades presentes no campo de permeabilidade da rocha
influenciam no escoamento: as frentes de saturação apresentam
alta irregularidade ao longo do domínio.

6.4 CASO 4: TESTE COMPARATIVO SPE 9

Esse caso faz parte do conjunto de testes comparativos
da Sociedade dos Engenheiros de Petróleo Internacional (SPE) e
tem o intuito de avaliar a qualidade da solução obtida por simu-
ladores comerciais de reservatórios bem como o desempenho das
estratégias de solução de sistemas algébricos que são empregadas
por tais códigos computacionais.

O problema trata-se de um reservatório com inclinação
igual a 10? em relação ao plano “xy” e com dimensões 2194m×
2286m×109m. A malha utilizada na discretização desse domínio
é do tipo corner-point possuindo 24×25×15 volumes de controle.
O campo de permeabilidade da rocha-reservatório é bastante



6.4. Caso 4: teste comparativo SPE 9 183

Figura 84 – Caso 3: campos de pressão.



184 Capítulo 6. Resultados

Figura 85 – Caso 3: campos de saturação da fase óleo.



6.4. Caso 4: teste comparativo SPE 9 185

heterogêneo e também isotrópico nas direções “x” e “y”, porém,
quatro ordens de grandeza menor na direção “z”. Há 26 poços
verticais sendo 25 produtores e um injetor. O poço injetor opera
na condição de pressão prescrita igual a 27.58 MPa, enquanto os
produtores operam em condições variáveis ao longo da simulação
entre fluxo prescrito e pressão prescrita. Os instantes de tempo
em que há troca dessas condições são descritos detalhadamente
no trabalho Killough (1995). O tempo final de simulação é igual
a 900 dias divididos ao longo de 36 passos de tempo.

O campo de permeabilidade na direção “x” bem como
a disposição dos poços ao longo do reservatório são mostrados
na figura 86, em que nota-se que o campo de permeabilidade
apresenta variações ao longo de cinco ordens de grandeza.

Figura 86 – Caso 4: campo de permeabilidade absoluta na direção
“x”.

O reservatório apresenta escoamento trifásico das fases
água, óleo e gás, de modo que o fluido que compõe a fase gás pode



186 Capítulo 6. Resultados

se dissolver na fase óleo, logo, o escoamento é representado pelo
modelo black-oil padrão. Como as equações desse modelo são não-
lineares, escolhe-se o método de Newton exato para resolvê-las.
Em cada iteração desse método, é necessária a resolução de um
problema linear determinado pela matriz jacobiana e o vetor de re-
síduos. Essa tarefa é realizada empregando-se o pré-condicionador
CPR, apresentado na seção 3.3.3, em conjunto com o método
iterativo GMRes. Tal pré-condicionador divide as parcelas da
matriz jacobiana referentes às variáveis pressão e saturações, con-
duzindo à definição de subproblemas independentes para tais
variáveis. Desse modo, é possível empregar uma estratégia de
solução voltada para problemas elípticos para a solução do campo
de pressão. Nesse momento, empregam-se as estratégias de refe-
rência utilizadas nos casos anteriores além do pré-condicionador
multiescala com razão de engrossamento igual a 6 × 5 × 5 (malha
grossa 4 × 5 × 3), operador de restrição do tipo galerkin e sua-
vizador baseado em fatoração incompleta sem nenhum grau de
preenchimento, sendo denominado como MsFEilu0-4x5x3.

O somatório do número de iterações não-lineares ao longo
dos passos de tempo necessárias para a convergência do problema
é igual a 230. Observa-se que isso é válido para todas as estraté-
gias em consideração, uma vez que o problema linear elíptico é
resolvido com elevada precisão em cada uma dessas estratégias. O
mesmo pode se dizer a respeito do número de iterações observadas
para o pré-condicionador CPR, que é igual a 2226, uma vez que tal
pré-condicionador é identificado como o nível iterativo logo acima
da resolução dos problemas elípticos. Isto significa que ao todo
são resolvidos 2226 sistemas lineares elípticos para a resolução do
problema não-linear em questão ao longo do tempo.

Como a estratégia Chol-UMFPACK é direta e resolve
o problema linear numa única iteração, segue que o número de
iterações totais para essa estratégia é igual a 2226. O número
total de iterações necessárias para a convergência da estratégia
BoomerAMG-CG foi igual a 12642, conduzindo a uma média de 6
iterações para a resolução de cada problema linear. Por último, a
estratégia multiescala MsFEilu0-CG necessitou de 61225 iterações
para a convergência, conduzindo a uma média de 27 iterações



6.4. Caso 4: teste comparativo SPE 9 187

por cada problema linear. Este é um número bem maior que o
apresentado pela estratégia multigrid de referência, no entanto, o
custo das iterações do pré-condicionador BoomerAMG é maior. De
fato, nota-se para o presente problema que a estratégia MsFEilu0-
CG acaba sendo mais eficiente que a anterior e tão eficiente quanto
a estratégia direta. Esse fato é ilustrado pela figura 87, que destaca
a parcela do tempo computacional utilizada para a solução dos
problemas lineares elípticos durante a execução da simulação.

Figura 87 – Caso 4: tempos computacionais de acordo com a
estratégia de solução.

Chol-UMFPACK BoomearAMG-CG MsFEilu0

T
e

m
p

o
 [

s
]

0

50

100

150

200

250

Pressão

Outros

Por fim, a título de ilustração, as soluções no instante
de tempo final para os campos de pressão e saturação das fases
água, óleo e gás são apresentadas nas figuras 88 a 91, enquanto
que os volumes totais nas condições padrão de água, óleo e gás
recuperados do reservatório são dados pela figura 92.



188 Capítulo 6. Resultados

Figura 88 – Caso 4: campo de pressão no instante final.

Figura 89 – Caso 4: campo de saturação de água no instante final.



6.4. Caso 4: teste comparativo SPE 9 189

Figura 90 – Caso 4: campo de saturação de óleo no instante final.

Figura 91 – Caso 4: campo de saturação de gás no instante final.



190 Capítulo 6. Resultados

Figura 92 – Caso 4: produções totais acumuladas de gás, óleo e
água, respectivamente.

tempo [d]

0 100 200 300 400 500 600 700 800 900

V
o
lu

m
e
 d

e
 á

g
u
a
 p

ro
d
u
z
id

o
 [
m

3
]

×10
6

0

1

2

3

4

5

6

7

8

9

tempo [d]

0 100 200 300 400 500 600 700 800 900

V
o
lu

m
e
 d

e
 ó

le
o
 p

ro
d
u
z
id

o
 [
m

3
]

×10
7

0

0.5

1

1.5

2

2.5

3

3.5

tempo [d]

0 100 200 300 400 500 600 700 800 900

V
o
lu

m
e
 d

e
 g

á
s
 p

ro
d
u
z
id

o
 [
M

m
3
]

×10
7

0

0.5

1

1.5

2

2.5

3



191

7 CONCLUSÕES

As conclusões do presente trabalho são listadas a seguir:
a) a aplicação de uma única iteração do estágio global

do pré-condicionador multiescala construído a partir
do operador de restrição baseado em volumes finitos
associada à reconstrução do campo de velocidades é
algebricamente equivalente ao emprego do métodos dos
volumes finitos multiescala MsFVM. Essa estratégia
conduz a campos de velocidade conservativos e campos
aproximados de pressão em malha refinada, os quais
exibem, no entanto, problemas de monotonicidade que
podem ser amenizados mediante o emprego de razões
de engrossamento menores. A qualidade da solução
para o campo de pressão é satisfatória em problemas
de escoamento monofásico, porém é de baixa qualidade
em escoamentos multifásicos, já que degradam a taxa
de convergência do problema não-linear que precisa
ser resolvido nesses casos.

b) a taxa de convergência bem como o desempenho com-
putacional observado para o pré-condicionador multi-
escala quando utilizado para a obtenção de soluções
precisas variam significativamente de acordo com o
suavizador, a estratégia de construção do operador de
restrição e a razão de engrossamento adotados. Para
os problemas testados, observou-se que as alternativas
mais eficientes para esses três parâmetros são repre-
sentadas respectivamente por suavizadores baseados
em fatoração incompleta, pelo operador de restrição
igual ao transposto do operador de prolongação e por
razões de engrossamento ao redor de 10;

c) a etapa de configuração dos pré-condicionadores mul-
tiescala é a que demanda a maior parte dos recursos
computacionais, portanto, o trecho de código respon-
sável por implementar essa operação é o que deve ser
otimizado a fim de que se reduza o esforço computaci-



192 Capítulo 7. Conclusões

onal necessário para a execução do pré-condicionador;
d) o suavizador baseado em funções de correção não

é eficaz pois degrada o espectro do operador pré-
condicionado e pode conduzir a métodos iterativos
não convergentes;

e) em problemas bidimensionais, o método direto de refe-
rência Cholesky-UMFPACK mostrou-se como o mais
eficiente dentre as estratégias avaliadas em termos
do tempo computacional necessário para a resolução
do problema. O ponto negativo dessa estratégia se
dá pelo uso mais acentuado de memória RAM. Já
em problemas tridimensionais de grande porte con-
tendo ao menos 1.0 × 105 incógnitas, o método ite-
rativo BoomerAMG-CG mostrou-se como o mais efi-
ciente. Em todos os problemas testados, os métodos
direto e iterativo de referência apresentaram melhor
desempenho que a estratégia multiescala de referência.

7.1 SUGESTÕES PARA TRABALHOS FUTUROS

As seguintes sugestões são indicadas para trabalhos futu-
ros:

a) implementar o algoritmo do precondicionador multi-
escala algébrico em paralelo empregando-se o padrão
MPI, uma vez que as estruturas de matrizes e vetores
disponíveis na biblioteca PETSc, utilizada na presente
implementação desse pré-condicionador, apresentam
suporte a esse padrão de comunicação para estruturas
de dados armazenadas em máquinas distintas.

b) otimizar a determinação do operador de prolongação
em problemas que variam no tempo através de sua
reconstrução apenas em determinadas áreas de in-
teresse. Desse modo, os operadores construídos em
passos de tempo anteriores ao atual podem ser corri-
gidos de modo a diminuir o tempo de configuração do
pré-condicionador multiescala ao longo dos passos de



7.1. Sugestões para trabalhos futuros 193

tempo e, portanto, o tempo de execução do método
iterativo é reduzido;

c) estender o algoritmo de particionamento do grafo
referente à malha refinada do reservatório para ma-
lhas não-estruturadas e avaliar o desempenho do pré-
condicionador multiescala para a resolução de proble-
mas elípticos nessa classe de problemas.





195

REFERÊNCIAS

AARNES, J. E.; KIPPE, V.; LIE, K.-A. Mixed multiscale
finite elements and streamline methods for reservoir
simulation of large geomodels. Advances in Water
Resources, v. 28, p. 257–271, 2005. Disponível em:
&lt;http://dx.doi.org/10.1016/j.advwatres.2004.10.007&gt;. Citado
na página 98.

AAVATSMARK, I. An introduction to multipoint flux
approximations for quadrilateral grids. Computational
Geosciences, v. 6, n. 3-4, p. 405–432, 2002. Disponível em:
&lt;http://doi.org/10.1023/A:1021291114475&gt;. Citado na página
120.

ACS, G.; DOLESCHALL, S.; FARKAS, E. General
purpose compositional model. SPE Journal, v. 25, p.
543–553, 1986. SPE-10515-PA. Disponível em:&amp;lt;http:
//dx.doi.org/10.2118/10515-PA&gt;. Citado na página 39.

AGULLO, E. et al. MUltifrontal Massively Parallel Solver. [S.l.],
2015. Disponível em:&amp;lt;http://mumps.enseeiht.fr/doc/userguide_
5.0.0.pdf&gt;. Citado na página 133.

ALPAK, F. O.; PAL, M.; LIE, K. A. A multiscale adaptive
local-global method for modeling flow in stratigraphically
complex reservoirs. SPE Journal, v. 17, n. 4, p. 1056–
1070, December 2012. SPE-140403-PA. Disponível em:
&lt;http://dx.doi.org/10.2118/140403-PA&gt;. Citado na página 98.

AMBRUS, J. Volumes Finitos Utilizando Aproximações
de Múltiplos Pontos Aplicados à Simulação Numérica
de Reservatórios de Petróleo. Dissertação (Mestrado) —
Universidade Federal de Santa Catarina, 2009. Disponível em:
&lt;http://www.sinmec.ufsc.br/site/arquivos/u-ulfnaezdrl_2009_
jaime_ambrus_dissertacao.pdf&gt;. Citado na página 120.

AMESTOY, P. R.; DAVIS, T. A.; DUFF, I. S. An approximate
minimum degree ordering algorithm. SIAM Journal on Matrix

http://dx.doi.org/10.1016/j.advwatres.2004.10.007
http://doi.org/10.1023/A:1021291114475
http://dx.doi.org/10.2118/10515-PA
http://dx.doi.org/10.2118/10515-PA
http://mumps.enseeiht.fr/doc/userguide_5.0.0.pdf
http://mumps.enseeiht.fr/doc/userguide_5.0.0.pdf
http://dx.doi.org/10.2118/140403-PA
http://www.sinmec.ufsc.br/site/arquivos/u-ulfnaezdrl_2009_jaime_ambrus_dissertacao.pdf
http://www.sinmec.ufsc.br/site/arquivos/u-ulfnaezdrl_2009_jaime_ambrus_dissertacao.pdf


196 Referências

Analysis &amp;amp; Applications, v. 14, p. 886–905, 1996. Disponível
em:&amp;lt;http://doi.org/10.1137/S0895479894278952&gt;. Citado na
página 74.

ARBOGAST, T.; WHEELER, M. F.; YOTOV, I. Mixed
finite elements for elliptic problems with tensor coefficients as
cell-centered finite differences. SIAM Journal on Numerical
Analysis, v. 34, n. 2, p. 828–852, 1997. Disponível em:
&lt;http://doi.org/10.1137/S0036142994262585&gt;. Citado na
página 98.

ARNOLD, D. N. Mixed finite element methods for elliptic
problems. Computational Methods Applied to Mechanical
Engineering, v. 82, p. 281–300, 1990. Disponível em:
&lt;http://doi.org/10.1016/0045-7825(90)90168-L&gt;. Citado 2
vezes nas páginas 45 e 98.

ARNOLD, D. N. et al. Unified analysis of discontinuous
galerkin methods for elliptic problems. SIAM Journal on
Numerical Analysis, v. 39, p. 1749–1779, 2002. Disponível em:
&lt;http://doi.org/10.1137/S0036142901384162&gt;. Citado na
página 45.

AZIZ, K.; SETTARI, A. Petroleum Reservoir Simulation.
Applied Science Publishers, 1979. Disponível em:&amp;lt;https:
//books.google.com.br/books/about/Petroleum_reservoir_
simulation.html?id=GJ5TAAAAMAAJ&amp;amp;hl=en&gt;. Citado 3
vezes nas páginas 40, 45 e 48.

BALAY, S. et al. PETSc Users Manual. [S.l.], 2015. Disponível
em:&amp;lt;http://www.mcs.anl.gov/petsc&gt;. Citado 2 vezes nas
páginas 72 e 77.

BANGERTH, W. MATH 676: Finite Element Methods
in Scientific Computing. 2013. Disponível em:&amp;lt;http:
//www.math.tamu.edu/~bangerth/videos.html&gt;. Citado na
página 73.

BARKER, A. T. et al. Accurate coarse-scale AMG-based
finite volume reservoir simulations in highly heterogeneous

http://doi.org/10.1137/S0895479894278952
http://doi.org/10.1137/S0036142994262585
http://doi.org/10.1016/0045-7825(90)90168-L
http://doi.org/10.1137/S0036142901384162
https://books.google.com.br/books/about/Petroleum_reservoir_simulation.html?id=GJ5TAAAAMAAJ&amp;amp;hl=en
https://books.google.com.br/books/about/Petroleum_reservoir_simulation.html?id=GJ5TAAAAMAAJ&amp;amp;hl=en
https://books.google.com.br/books/about/Petroleum_reservoir_simulation.html?id=GJ5TAAAAMAAJ&amp;amp;hl=en
http://www.mcs.anl.gov/petsc
http://www.math.tamu.edu/~bangerth/videos.html
http://www.math.tamu.edu/~bangerth/videos.html


Referências 197

media. In: SPE 173277-MS. Society of Petroleum Engineers,
2015. p. –. ISSN 978-1-61399-352-1. Disponível em:
&lt;http://dx.doi.org/10.2118/173277-MS&gt;. Citado na página 92.

BEHIE, A.; COLLINS, D.; JR., P. F. Incomplete
factorization methods for three-dimensional non-symmetric
problems. Computer Methods in Applied Mechanics and
Engineering, v. 42, p. 287–299, 1984. Disponível em:
&lt;http://doi.org/10.1016/0045-7825(84)90010-0&gt;. Citado na
página 84.

BEHIE, A.; VINSOME, P. K. W. Block iterative methods
for fully implicit reservoir simulation. SPE Journal,
v. 22, p. 658–668, 1982. SPE-9303-PA. Disponível em:
&lt;http://dx.doi.org/10.2118/9303-PA&gt;. Citado na página 84.

BEHIE, G. A.; FORSYTH, P. A. Multigrid solution of
the pressure equation in reservoir simulation. SPE Journal,
v. 23, n. 04, p. 623–632, August 1983. Disponível em:
&lt;http://dx.doi.org/10.2118/10492-PA&gt;. Citado na página 92.

BENZI, M. Preconditioning techniques for large linear systems:
A survey. Journal of Computational Physics, v. 182, p. 418–477,
2002. Disponível em:&amp;lt;http://doi.org/10.1006/jcph.2002.7176&gt;.
Citado 2 vezes nas páginas 80 e 81.

BO, L.; WHEELER, M. F. Iterative coupling reservoir
simulation on high performance computers. Petroleum
Science and Technology, v. 6, p. 43–50, 2009. Disponível em:
&lt;http://doi/org/10.1007/s12182-009-0008-x&gt;. Citado na
página 49.

BONFIGLI, G.; JENNY, P. Recent developments in the
multiscale finite volume procedure. In: . Springer
International Publishing, 2010. cap. III, p. 124–131. Disponível
em:&amp;lt;http://doi.org/10.1007/978-3-642-12535-5_13&gt;. Citado
na página 111.

BROWN, G. L.; COLLINS, D. A.; CHEN, Z. Efficient
preconditioning for algebraic multigrid and red-black ordering

http://dx.doi.org/10.2118/173277-MS
http://doi.org/10.1016/0045-7825(84)90010-0
http://dx.doi.org/10.2118/9303-PA
http://dx.doi.org/10.2118/10492-PA
http://doi.org/10.1006/jcph.2002.7176
http://doi/org/10.1007/s12182-009-0008-x
http://doi.org/10.1007/978-3-642-12535-5_13


198 Referências

in adaptive-implicit black-oil simulations. In: SPE-173231-MS.
Society of Petroleum Engineers, 2015. p. –. ISSN 978-1-61399-
352-1. Disponível em:&amp;lt;http://dx.doi.org/10.2118/173231-MS&gt;.
Citado 2 vezes nas páginas 87 e 92.

BUSH, L.; GINTING, V.; PRESHO, M. Application of a
conservative, generalized multiscale finite element method
to flow models. ArXiv e-prints. 2013. Disponível em:
&lt;http://doi.org/10.1016/j.cam.2013.10.006&gt;. Citado na página
98.

CAO, H. et al. Parallel scalable unstructured CPR-type linear
solver for reservoir simulation. In: SPE-96809-MS. Society
of Petroleum Engineers, 2005. p. –. ISSN 978-1-55563-150-5.
Disponível em:&amp;lt;http://dx.doi.org/10.2118/96809-MS&gt;. Citado
na página 86.

CHEN, Z. Recent advances of upscaling methods for the
simulation of flow transport through heterogeneous porous media.
Journal of Computational Mathematics, v. 24, p. 393–400, 2006.
Disponível em:&amp;lt;http://lsec.cc.ac.cn/~zmchen/papers/jcm.pdf&gt;.
Citado na página 72.

CHEN, Z. Reservoir Simulation: Mathematical Techniques
in Oil Recovery. SIAM, 2007. Disponível em:&amp;lt;http:
//bookstore.siam.org/cb77/&gt;. Citado 3 vezes nas páginas 40, 43
e 49.

CHEN, Z.; DENG, W.; YE, H. Upscaling of a class
of nonlinear parabolic equations for the flow transport
in heterogeneous porous media. Communications in
Mathematical Sciences, v. 3, p. 493–515, 2005. Disponível em:
&lt;http://projecteuclid.org/euclid.cms/1144429328&gt;. Citado na
página 72.

CHEN, Z.; HOU, T. Y. A mixed multiscale finite element
method for elliptic problems with oscillating coefficients.
Mathematics of Computation, American Mathematical Society,
v. 72, n. 242, p. 541–576, April 2003. ISSN 00255718. Disponível

http://dx.doi.org/10.2118/173231-MS
http://doi.org/10.1016/j.cam.2013.10.006
http://dx.doi.org/10.2118/96809-MS
http://lsec.cc.ac.cn/~zmchen/papers/jcm.pdf
http://bookstore.siam.org/cb77/
http://bookstore.siam.org/cb77/
http://projecteuclid.org/euclid.cms/1144429328


Referências 199

em:&amp;lt;http://www.jstor.org/stable/4099920&gt;. Citado na página
98.

CHEN, Z.; HUAN, G.; MA, Y. Computational Methods for
Multiphase Flows in Porous Media. SIAM, 2006. Disponível
em:&amp;lt;http://dx.doi.org/10.1137/1.9780898718942&gt;. Citado na
página 45.

CHEVALIER, C.; PELLEGRINI, F. PT-Scotch: A tool
for efficient parallel graph ordering. Parallel Computing,
v. 34, n. 6-8, p. 318–331, July 2008. Disponível em:
&lt;http://doi.org/10.1016/j.parco.2007.12.001&gt;. Citado na
página 93.

CHRISTIE, M. A. Upscaling for reservoir simulation. Journal
of Petroleum Technology, v. 48, n. 11, p. 1004–1010, 1996.
Disponível em:&amp;lt;http://dx.doi.org/10.2118/37324-JPT&gt;.
Citado 2 vezes nas páginas 33 e 69.

CHUNG, E. T.; EFENDIEV, Y.; LI, G. An adaptive
gmsfem for hhigh-constrast flow problems. Journal of
Computational Physics, v. 273, p. 54–76, May 2014. Disponível
em:&amp;lt;http://doi.org/10.1016/j.jcp.2014.05.007&gt;. Citado na
página 98.

CLEES, T.; GANZER, L. An efficient algebraic multigrid solver
strategy for adaptive implicit methods in oil-reservoir simulation.
SPE Journal, Society of Petroleum Engineers, v. 15, p. 670–681,
2010. Disponível em:&amp;lt;http://dx.doi.org/10.2118/105789-PA&gt;.
Citado na página 92.

COATS, K. H.; THOMAS, L. K.; PIERSON, R. G. Compositional
and black oil reservoir simulation. SPE Reservoir Evaluation &amp;amp;
Engineering, v. 1, p. 372–379, 1998. SPE-50990-PA. Disponível
em:&amp;lt;http://dx.doi.org/10.2118/50990-PA&gt;. Citado na página
39.

CUSINI, M. et al. A constrained pressure residual multiscale
(CPR-MS) compositional solver. In: ECMOR XIV-14th European

http://www.jstor.org/stable/4099920
http://dx.doi.org/10.1137/1.9780898718942
http://doi.org/10.1016/j.parco.2007.12.001
http://dx.doi.org/10.2118/37324-JPT
http://doi.org/10.1016/j.jcp.2014.05.007
http://dx.doi.org/10.2118/105789-PA
http://dx.doi.org/10.2118/50990-PA


200 Referências

conference on the mathematics of oil recovery. [s.n.], 2014.
Disponível em:&amp;lt;http://doi.org/10.3997/2214-4609.20141778&gt;.
Citado na página 111.

DAKE, L. P. Fundamentals of Reservoir Engineering. Elsevier
Scientific Publishing Company, 1978. 443 p. Disponível em:&amp;lt;http:
//store.elsevier.com/Fundamentals-of-Reservoir-Engineering/
L_P_-Dake/isbn-9780080568980/&gt;. Citado na página 42.

DAVIS, T. A. Algorithm 832: Umfpack v4.3—an unsymmetric-
pattern multifrontal method. ACM Transactions on Mathematical
Software (TOMS), v. 30, n. 2, p. 196–199, June 2004. Disponível
em:&amp;lt;http://dx.doi.org/10.1145/992200.992206&gt;. Citado na
página 133.

DOGRU, A. H. et al. New frontiers in large scale reservoir
simulation. In: SPE Reservoir Simulation Symposium, 21-23
February, The Woodlands, Texas, USA. [s.n.], 2011. SPE-142297-
MS. Disponível em:&amp;lt;http://dx.doi.org/10.2118/142297-MS&gt;.
Citado na página 69.

DOLEAN, V.; JOLIVET, P.; NATAF, F. An introduction
to domain decomposition methods: Algorithms, theory and
parallel implementation. ArXiv e-prints. 2015. Disponível em:
&lt;https://hal.archives-ouvertes.fr/cel-01100932&gt;. Citado na
página 96.

DOLEAN, V. et al. Two-level domain decomposition methods
for highly heterogeneous darcy equations. connections with
multiscale methods. Oil Gas Sci. Technol. – Rev. IFP Energies
nouvelles, v. 69, n. 4, p. 731–752, July 2014. Disponível em:
&lt;http://dx.doi.org/10.2516/ogst/2013206&gt;. Citado na página
96.

DOLEAN, V. et al. Analysis of a two-level schwarz method with
coarse spaces based on local dirichlet-to-neumann maps. Computer
Methods in Applied Mathematics, v. 12, n. 4, p. 391–414, 2012.
Disponível em:&amp;lt;https://hal.archives-ouvertes.fr/hal-00586246&gt;.
Citado na página 96.

http://doi.org/10.3997/2214-4609.20141778
http://store.elsevier.com/Fundamentals-of-Reservoir-Engineering/L_P_-Dake/isbn-9780080568980/
http://store.elsevier.com/Fundamentals-of-Reservoir-Engineering/L_P_-Dake/isbn-9780080568980/
http://store.elsevier.com/Fundamentals-of-Reservoir-Engineering/L_P_-Dake/isbn-9780080568980/
http://dx.doi.org/10.1145/992200.992206
http://dx.doi.org/10.2118/142297-MS
https://hal.archives-ouvertes.fr/cel-01100932
http://dx.doi.org/10.2516/ogst/2013206
https://hal.archives-ouvertes.fr/hal-00586246


Referências 201

DOUGLAS, J.; PEACEMAN, D. W.; JR., H. H. R. A
method for calculating multi-dimensional immiscible
displacement. In: American Institute of Mining, Metallurgical,
and Petroleum Engineers, Inc. Society of Petroleum
Engineers, 1959. SPE-1327-G. Disponível em:&amp;lt;https:
//www.onepetro.org/general/SPE-1327-G&gt;. Citado na página
48.

DURLOFSKY, L. J. Upscaling of geocellular models for reservoir
flow simulation: A review of recent progress. In: 7 th International
Forum on Reservoir Simulation. [s.n.], 2003. Disponível em:
&lt;http://citeseerx.ist.psu.edu/viewdoc/download?doi=10.1.1.
122.5524&amp;amp;rep=rep1&amp;amp;type=pdf&gt;. Citado na página 72.

EFENDIEV, Y.; HOU, T. Y. Multiscale Finite Element Methods
- Theory and Applications. Springer, 2009. Disponível em:
&lt;http://www.springer.com/br/book/9780387094953&gt;. Citado
na página 98.

FALGOUT, R. D.; YANG, U. M. HYPRE: a library of high
performance preconditioners. In: Preconditioners - Lecture Notes
in Computer Science. [s.n.], 2002. p. 632–641. Disponível em:
&lt;http://citeseerx.ist.psu.edu/viewdoc/summary?doi=10.1.1.8.
1202&gt;. Citado na página 134.

FARMER, C. L. Upscaling: a review. International Journal for
Numerical Methods in Fluids, v. 40, p. 63–78, 2002. Disponível
em:&amp;lt;http://doi.org/10.1002/fld.267&gt;. Citado na página 72.

FORSYTH, P. A. A control-volume, finite-element
method for local mesh refinement in thermal reservoir
simulation. SPE Reservoir Evaluation &amp;amp; Engineering,
v. 5, p. 561–566, 1990. SPE-18415-PA. Disponível em:
&lt;http://dx.doi.org/10.2118/18415-PA&gt;. Citado na página 46.

FUNG, L. S.-K.; COLLINS, D. A.; NGHIEM, L. X. An
adaptive-implicit switching criterion based on numerical
stability analysis. SPE Reservoir Evaluation &amp;amp; Engineering,

https://www.onepetro.org/general/SPE-1327-G
https://www.onepetro.org/general/SPE-1327-G
http://citeseerx.ist.psu.edu/viewdoc/download?doi=10.1.1.122.5524&amp;amp;rep=rep1&amp;amp;type=pdf
http://citeseerx.ist.psu.edu/viewdoc/download?doi=10.1.1.122.5524&amp;amp;rep=rep1&amp;amp;type=pdf
http://www.springer.com/br/book/9780387094953
http://citeseerx.ist.psu.edu/viewdoc/summary?doi=10.1.1.8.1202
http://citeseerx.ist.psu.edu/viewdoc/summary?doi=10.1.1.8.1202
http://doi.org/10.1002/fld.267
http://dx.doi.org/10.2118/18415-PA


202 Referências

v. 4, p. 45–51, 1989. SPE-16003-PA. Disponível em:
&lt;http://dx.doi.org/10.2118/16003-PA&gt;. Citado na página 49.

GAMBOLATI, G.; FERRONATO, M.; JANNA, C.
Preconditioning for sparse linear systems at the dawn of the 21st
century: History, current developments, and future perspectives.
International Journal for Numerical and Analytical Methods
in Geomechanics, v. 35, p. 980–996, 2011. Article ID 127647.
Disponível em:&amp;lt;http://dx.doi.org/10.5402/2012/127647&gt;.
Citado na página 80.

GEORGE, A. Nested dissection of a regular finite element mesh.
SIAM Journal on Numerical Analysis, v. 10, p. 345–363, 1976.
Disponível em:&amp;lt;http://www.math.ucsb.edu/~hdc/teaching/
Math206D/Nested_Dissection.pdf&gt;. Citado na página 74.

GRIES, S.; PLUM, H.-J. Status of system-AMG for reservoir
simulation applications. In: SPE Reservoir Simulation
Symposium, 23-25 February, Houston, Texas, USA. Society of
Petroleum Engineers, 2015. ISSN 978-1-61399-352-1. SPE-173241-
MS. Disponível em:&amp;lt;http://dx.doi.org/10.2118/173241-MS&gt;.
Citado na página 92.

GRIES, S. et al. Preconditioning for efficiently applying
algebraic multigrid in fully implicit reservoir simulations. SPE
Journal, Society of Petroleum Engineers, v. 19, p. 726–736,
2014. Disponível em:&amp;lt;http://dx.doi.org/10.2118/163608-MS&gt;.
Citado 2 vezes nas páginas 87 e 92.

HACKBUSCH, W. Multi-Grid Methods and Applications.
Springer, 1985. Springer Series in Computational Mathematics.
Disponível em:&amp;lt;http://link.springer.com/book/10.1007/
978-3-662-02427-0&gt;. Citado 2 vezes nas páginas 32 e 92.

HAJIBEYGI, H. et al. Iterative multiscale finite-volume method.
J. Comput. Phys., Academic Press Professional, Inc., San Diego,
CA, USA, v. 227, n. 19, p. 8604–8621, out. 2008. ISSN 0021-9991.
Disponível em:&amp;lt;http://dx.doi.org/10.1016/j.jcp.2008.06.013&gt;.
Citado na página 111.

http://dx.doi.org/10.2118/16003-PA
http://dx.doi.org/10.5402/2012/127647
http://www.math.ucsb.edu/~hdc/teaching/Math206D/Nested_Dissection.pdf
http://www.math.ucsb.edu/~hdc/teaching/Math206D/Nested_Dissection.pdf
http://dx.doi.org/10.2118/173241-MS
http://dx.doi.org/10.2118/163608-MS
http://link.springer.com/book/10.1007/978-3-662-02427-0
http://link.springer.com/book/10.1007/978-3-662-02427-0
http://dx.doi.org/10.1016/j.jcp.2008.06.013


Referências 203

HAJIBEYGI, H.; DEB, R.; JENNY, P. Multiscale finite volume
method for non-conformal coarse grids arising from faulted
porous media. In: SPE Reservoir Simulation Symposium, 21-23
February, The Woodlands, Texas, USA. [s.n.], 2011. Disponível
em:&amp;lt;http://dx.doi.org/10.2118/142205-MS&gt;. Citado na página
111.

HAJIBEYGI, H.; JENNY, P. Multiscale finite-volume method for
parabolic problems arising from compressible multiphase flow in
porous media. Journal of Computational Physics, v. 228, n. 14, p.
5129 – 5147, 2009. ISSN 0021-9991. Disponível em:&amp;lt;http://www.
sciencedirect.com/science/article/pii/S0021999109001946&gt;.
Citado na página 110.

HAJIBEYGI, H.; JENNY, P. Adaptive iterative multiscale
finite volume method. Journal of Computational Physics, v. 230,
n. 3, p. 628 – 643, 2011. ISSN 0021-9991. Disponível em:
&lt;http://doi.org/10.1016/j.jcp.2010.10.009&gt;. Citado na página
111.

HAJIBEYGI, H.; KARVOUNIS, D.; JENNY, P. A hierarchical
fracture model for the iterative multiscale finite volume method.
Journal of Computational Physics, v. 230, n. 24, p. 8729–8743,
2011. Disponível em:&amp;lt;http://doi.org/10.1016/j.jcp.2011.08.021&gt;.
Citado 2 vezes nas páginas 111 e 127.

HAJIBEYGI, H.; TCHELEPI, H. Compositional multiscale
finite-volume formulation. SPE Journal, v. 19, n. 02, p. 316–326,
2014. Disponível em:&amp;lt;http://dx.doi.org/10.2118/163664-PA&gt;.
Citado na página 111.

HAJIBEYGI, H.; WANG, Y.; TCHELEPI, H. A. Monotone
multiscale finite volume method for flow in heterogeneous
porous media. In: ECMOR XIV - 14th European Conference
on the Mathematics of Oil Recovery. [s.n.], 2014. Disponível
em:&amp;lt;http://doi.org/10.3997/2214-4609.20141777&gt;. Citado na
página 110.

http://dx.doi.org/10.2118/142205-MS
http://www.sciencedirect.com/science/article/pii/S0021999109001946
http://www.sciencedirect.com/science/article/pii/S0021999109001946
http://doi.org/10.1016/j.jcp.2010.10.009
http://doi.org/10.1016/j.jcp.2011.08.021
http://dx.doi.org/10.2118/163664-PA
http://doi.org/10.3997/2214-4609.20141777


204 Referências

HENSON, V. E. Multigrid methods for nonlinear problems: An
overview. In: Proceedings of the SPI. [s.n.], 2003. Disponível em:
&lt;https://computation.llnl.gov/casc/people/henson/postscript/
UCRL_JC_150259.pdf&gt;. Citado na página 52.

HENSON, V. E.; YANG, U. M. BoomerAMG: A parallel
algebraic multigrid solver and preconditioner. Applied
Numerical Mathematics, v. 41, p. 155–177, 2002. Disponível em:
&lt;http://doi.org/10.1016/S0168-9274(01)00115-5&gt;. Citado 2
vezes nas páginas 90 e 92.

HESSE, M. A.; MALLISON, B. T.; TCHELEPI, H. A. Compact
multiscale finite volume method for heterogeneous anisotropic
elliptic equations. Multiscale Modeling &amp;amp; Simulation, v. 7, n. 2, p.
934–962, 2008. Disponível em:&amp;lt;http://epubs.siam.org/doi/abs/
10.1137/070705015?journalCode=mmsubt&gt;. Citado na página
110.

HESTENES, M. R.; STIEFEL, E. Methods of conjugate
gradients for solving linear systems. Journal of Research of the
National Bureau of Standards, v. 49, p. 409–436, 1952. Disponível
em:&amp;lt;http://nvlpubs.nist.gov/nistpubs/jres/049/jresv49n6p409_
A1b.pdf&gt;. Citado na página 79.

HOU, T. Y.; WU, X.-H. A multiscale finite element method
for elliptic problems in composite materials and porous media.
Journal of Computational Physics, v. 134, n. 134, p. 169–189,
1997. Disponível em:&amp;lt;http://doi.org/10.1006/jcph.1997.5682&gt;.
Citado 2 vezes nas páginas 98 e 102.

HOU, T. Y.; WU, X.-H.; CAI, Z. Convergence of a
multiscale finite element method for elliptic problems
with rapidly oscillating coefficients. Mathematics of
Computation, v. 68, n. 227, p. 913–943, 1999. Disponível
em:&amp;lt;http://www.ams.org/journals/mcom/1999-68-227/
S0025-5718-99-01077-7/S0025-5718-99-01077-7.pdf&gt;. Citado na
página 98.

https://computation.llnl.gov/casc/people/henson/postscript/UCRL_JC_150259.pdf
https://computation.llnl.gov/casc/people/henson/postscript/UCRL_JC_150259.pdf
http://doi.org/10.1016/S0168-9274(01)00115-5
http://epubs.siam.org/doi/abs/10.1137/070705015?journalCode=mmsubt
http://epubs.siam.org/doi/abs/10.1137/070705015?journalCode=mmsubt
http://nvlpubs.nist.gov/nistpubs/jres/049/jresv49n6p409_A1b.pdf
http://nvlpubs.nist.gov/nistpubs/jres/049/jresv49n6p409_A1b.pdf
http://doi.org/10.1006/jcph.1997.5682
http://www.ams.org/journals/mcom/1999-68-227/S0025-5718-99-01077-7/S0025-5718-99-01077-7.pdf
http://www.ams.org/journals/mcom/1999-68-227/S0025-5718-99-01077-7/S0025-5718-99-01077-7.pdf


Referências 205

JENNY, P.; LEE, S.; TCHELEPI, H. Adaptive multiscale
finite-volume method for multiphase flow and transport
in porous media. Multiscale Modeling &amp;amp; Simulation,
v. 3, n. 1, p. 50–64, 2005. Disponível em:&amp;lt;http:
//epubs.siam.org/doi/abs/10.1137/030600795&gt;. Citado na
página 110.

JENNY, P.; LEE, S.; TCHELEPI, H. Adaptive fully implicit
multi-scale finite-volume method for multi-phase flow
and transport in heterogeneous porous media. Journal of
Computational Physics, v. 217, n. 2, p. 627 – 641, 2006. ISSN 0021-
9991. Disponível em:&amp;lt;http://doi.org/10.1016/j.jcp.2006.01.028&gt;.
Citado 3 vezes nas páginas 62, 106 e 110.

JENNY, P.; LEE, S. H.; TCHELEPI, H. A. Multiscale
finite-volume method for elliptic problems in subsurface
flow simulation. J. Comput. Phys., Academic Press
Professional, Inc., San Diego, CA, USA, v. 187, n. 1,
p. 47–67, Maio 2003. ISSN 0021-9991. Disponível em:
&lt;http://dx.doi.org/10.1016/S0021-9991(03)00075-5&gt;. Citado 4
vezes nas páginas 34, 98, 101 e 109.

JENNY, P.; LUNATI, I. Modeling complex wells with the
multi-scale finite-volume method. Journal of Computational
Physics, v. 228, n. 3, p. 687–702, 2009. Disponível em:
&lt;http://doi.org/10.1016/j.jcp.2008.09.026&gt;. Citado na página
111.

KARYPIS, G.; KUMAR, V. A fast and highly quality multilevel
scheme for partitioning irregular graphs. SIAM Journal on
Scientific Computing, v. 20, n. 1, p. 359–392, August 1998.
Disponível em:&amp;lt;http://doi.org/10.1137/S1064827595287997&gt;.
Citado na página 93.

KAVIANY, M. Principles of Heat Transfer in Porous
Media. Springer-Verlag, 1995. ISBN 9780387945507.
Disponível em:&amp;lt;http://link.springer.com/book/10.1007%
2F978-1-4612-4254-3&gt;. Citado na página 31.

http://epubs.siam.org/doi/abs/10.1137/030600795
http://epubs.siam.org/doi/abs/10.1137/030600795
http://doi.org/10.1016/j.jcp.2006.01.028
http://dx.doi.org/10.1016/S0021-9991(03)00075-5
http://doi.org/10.1016/j.jcp.2008.09.026
http://doi.org/10.1137/S1064827595287997
http://link.springer.com/book/10.1007%2F978-1-4612-4254-3
http://link.springer.com/book/10.1007%2F978-1-4612-4254-3


206 Referências

KEILEGAVLEN, E.; NORDBOTTEN, J. Inexact linear
solvers for control volume discretizations in porous media.
Computational Geosciences, Springer International Publishing,
v. 19, p. 1–18, 2014. ISSN 1420-0597. Disponível em:
&lt;http://dx.doi.org/10.1007/s10596-014-9453-8&gt;. Citado na
página 111.

KELLEY, C. T. Iterative Methods for Linear and
Nonlinear Equations. SIAM, 1995. Disponível em:
&lt;https://www.siam.org/books/textbooks/fr16_book.pdf&gt;.
Citado na página 73.

KERSHAW, D. S. The incomplete cholesky - conjugate gradient
method for the iterative solution of systems of linear equations.
Journal of Computational Physics, v. 26, p. 43–65, 1978.
Disponível em:&amp;lt;http://doi.org/10.1016/0021-9991(78)90098-0&gt;.
Citado na página 86.

KILLOUGH, J. Ninth spe comparative solution project: A
reexamination of black-oil simulation. In: SPE Reservoir
Simulation Symposium, 12-15 February, San Antonio,
Texas. [s.n.], 1995. SPE-29110-MS. Disponível em:
&lt;http://dx.doi.org/10.2118/29110-MS&gt;. Citado na página 185.

KILLOUGH, J.; WANG, Y. Solver preconditioning using the
combinatorial multilevel method. In: SPE Reservoir Simulation
Symposium, 18-20 February, The Woodlands, Texas, USA. [s.n.],
2013. Disponível em:&amp;lt;http://dx.doi.org/10.2118/163589-MS&gt;.
Citado 3 vezes nas páginas 61, 69 e 92.

KIPPE, V.; AARNES, J.; LIE, K.-A. A comparison of
multiscale methods for elliptic problems in porous media
flow. Computational Geosciences, Springer Netherlands,
v. 12, n. 3, p. 377–398, 2008. ISSN 1420-0597. Disponível em:
&lt;http://dx.doi.org/10.1007/s10596-007-9074-6&gt;. Citado na
página 34.

KLIE, H. et al. Deflation AMG solvers for highly ill-conditioned
reservoir simulation problems. In: SPE Reservoir Simulation

http://dx.doi.org/10.1007/s10596-014-9453-8
https://www.siam.org/books/textbooks/fr16_book.pdf
http://doi.org/10.1016/0021-9991(78)90098-0
http://dx.doi.org/10.2118/29110-MS
http://dx.doi.org/10.2118/163589-MS
http://dx.doi.org/10.1007/s10596-007-9074-6


Referências 207

Symposium, 26-28 February, Houston, Texas, U.S.A. [s.n.],
2007. Disponível em:&amp;lt;http://dx.doi.org/10.2118/105820-MS&gt;.
Citado na página 92.

KOZINTSEV, B.; KEDEM, B. Clipped Gaussian Random Fields.
1999. Disponível em:&amp;lt;http://math4411.math.umd.edu/cgi-bin/
bak/generate.cgi/generate.cgi?4&gt;. Citado na página 135.

KROGSTAD, S. et al. MRST-AD - an open-source framework
for rapid prototyping and evaluation of reservoir simulation
problems. In: SPE Reservoir Simulation Symposium, 23-25
February, Houston, Texas, USA. [s.n.], 2015. SPE-173317-MS.
Disponível em:&amp;lt;http://dx.doi.org/10.2118/173317-MS&gt;.
Citado na página 46.

KUNZE, R. Multiscale Descriptions of Density-Driven
Flow Instabilities in Porous Media. Tese (Doutorado) —
Université de Lausanne, 2014. Disponível em:&amp;lt;http:
//www.maflot.com/Site/INFO_files/thesis.pdf&gt;. Citado na
página 110.

LACROIX, S. et al. Iterative solution for modeling multiphase
flow in porous media fully implicitly. SIAM Journal on
Scientific Computing, v. 25, p. 905–926, 2003. Disponível em:
&lt;http://doi.org/10.1137/S106482750240443X&gt;. Citado na
página 87.

LAKE, L. W. Enhanced Oil Recovery. Society of Petroleum
Engineers, 2010. Disponível em:&amp;lt;http://store.spe.org/
Enhanced-Oil-Recovery--P436.aspx&gt;. Citado na página 39.

LEE, S.; WOLFSTEINER, C.; TCHELEPI, H. Multiscale
finite-volume formulation for multiphase flow in porous media:
Black oil formulation of compressible, three-phase flow with
gravity. Computational Geosciences, Springer Netherlands,
v. 12, n. 3, p. 351–366, 2008. ISSN 1420-0597. Disponível em:
&lt;http://dx.doi.org/10.1007/s10596-007-9069-3&gt;. Citado na
página 111.

http://dx.doi.org/10.2118/105820-MS
http://math4411.math.umd.edu/cgi-bin/bak/generate.cgi/generate.cgi?4
http://math4411.math.umd.edu/cgi-bin/bak/generate.cgi/generate.cgi?4
http://dx.doi.org/10.2118/173317-MS
http://www.maflot.com/Site/INFO_files/thesis.pdf
http://www.maflot.com/Site/INFO_files/thesis.pdf
http://doi.org/10.1137/S106482750240443X
http://store.spe.org/Enhanced-Oil-Recovery--P436.aspx
http://store.spe.org/Enhanced-Oil-Recovery--P436.aspx
http://dx.doi.org/10.1007/s10596-007-9069-3


208 Referências

LEE, S. H.; ZHOU, H.; TCHELEPI, H. A. Adaptive multiscale
finite volume method for nonlinear multiphase transport in
heterogeneous formations. Journal of Computational Physics,
v. 228, n. 4, p. 9036–9058, December 2009. Disponível em:
&lt;http://doi.org/10.1016/j.jcp.2009.09.009&gt;. Citado na página
110.

LI, X. S.; DEMMEL, J. W. SuperLU_DIST - a scalable
distributed memory sparse direct solver for unsymmetric
linear systems. ACM Transactions on Mathematical
Software, v. 29, n. 2, p. 110–140, June 2003. Disponível em:
&lt;http://doi.org/10.1145/779359.779361&gt;. Citado na página
133.

LIE, K. A. et al. Open source MATLAB implementation of
consistent discretisations on complex grids. Computational
Geosciences, v. 16, p. 297–322, 2012. Disponível em:
&lt;http://doi.org/10.1007/s10596-011-9244-4&gt;. Citado na página
46.

LIU, W.-H.; SHERMAN, A. H. Comparative analysis
of the cuthill-mckee and the reverse cuthill-mckee
ordering algorithms for sparse matrices. SIAM Journal on
Numerical Analysis, v. 13, p. 198–213, 1976. Disponível em:
&lt;http://www.jstor.org/stable/2156087&gt;. Citado na página 74.

LUNATI, I.; JENNY, P. The multiscale finite-volume
method - a flexible tool to model physically complex
flow in porous media. In: 10th European Conference on
the Mathematics of Oil Recovery — Amsterdam, The
Netherlands, 4 – 7 September 2006. [s.n.], 2006. Disponível em:
&lt;http://www.researchgate.net/publication/37451134&gt;. Citado
na página 110.

LUNATI, I.; JENNY, P. Multiscale finite-volume method
for compressible multiphase flow in porous media.
Journal of Computational Physics, v. 216, n. 2, p. 616
– 636, 2006. ISSN 0021-9991. Disponível em:&amp;lt;http:
//dx.doi.org/10.1016/j.jcp.2006.01.001&gt;. Citado na página 110.

http://doi.org/10.1016/j.jcp.2009.09.009
http://doi.org/10.1145/779359.779361
http://doi.org/10.1007/s10596-011-9244-4
http://www.jstor.org/stable/2156087
http://www.researchgate.net/publication/37451134
http://dx.doi.org/10.1016/j.jcp.2006.01.001
http://dx.doi.org/10.1016/j.jcp.2006.01.001


Referências 209

LUNATI, I.; JENNY, P. Treating highly anisotropic subsurface
flow with the multiscale finite volume method. Multiscale
Modeling &amp;amp; Simulation, v. 6, p. 308–318, 2007. Disponível em:
&lt;http://doi.org/10.1137/050638928&gt;. Citado na página 110.

LUNATI, I.; JENNY, P. Multiscale finite-volume method
for density-driven flow in porous media. Computational
Geosciences, Springer, v. 12, n. 3, p. 337–350, 2008. Disponível
em:&amp;lt;http://dx.doi.org/10.1007/s10596-007-9071-9&gt;. Citado
na página 108.

LUNATI, I.; LEE, S. H. An operator formulation of the
multiscale finite-volume method with correction function.
Multiscale Modeling &amp;amp; Simulation, v. 8, n. 1, p. 96–109, 2009.
Disponível em:&amp;lt;http://dblp.uni-trier.de/db/journals/mmas/
mmas8.html#LunatiL09&gt;. Citado na página 108.

LUNATI, I.; TYAGI, M.; LEE, S. H. An iterative multiscale
finite volume algorithm converging to the exact solution. Journal
of Computational Physics, v. 230, n. 5, p. 1849 – 1864, 2011.
ISSN 0021-9991. Disponível em:&amp;lt;http://www.sciencedirect.com/
science/article/pii/S0021999110006510&gt;. Citado na página 111.

MALISKA, C. R. Transferência de Calor e Mecânica dos
Fluidos Computacional. LTC, 2004. Disponível em:&amp;lt;http:
//www.researchgate.net/publication/233843056_Transferncia_
de_Calor_e_Mecnica_dos_Fluidos_Computacional&gt;. Citado
na página 46.

MANEA, A. M.; SEWALL, J.; TCHELEPI, H. A. Parallel
multiscale linear solver for highly detailed reservoir
models. In: SPE Reservoir Simulation Symposium, 23-25
February, Houston, Texas, USA. [s.n.], 2015. Disponível em:
&lt;http://dx.doi.org/10.2118/173259-MS&gt;. Citado na página 35.

MASSON, R. et al. Parallel preconditioning for sedimentary
basin simulations. Lecture Notes in Computer Science, v. 2907,
p. 93–102, 2004. Disponível em:&amp;lt;http://doi.org/10.1007/
978-3-540-24588-9_9&gt;. Citado na página 87.

http://doi.org/10.1137/050638928
http://dx.doi.org/10.1007/s10596-007-9071-9
http://dblp.uni-trier.de/db/journals/mmas/mmas8.html#LunatiL09
http://dblp.uni-trier.de/db/journals/mmas/mmas8.html#LunatiL09
http://www.sciencedirect.com/science/article/pii/S0021999110006510
http://www.sciencedirect.com/science/article/pii/S0021999110006510
http://www.researchgate.net/publication/233843056_Transferncia_de_Calor_e_Mecnica_dos_Fluidos_Computacional
http://www.researchgate.net/publication/233843056_Transferncia_de_Calor_e_Mecnica_dos_Fluidos_Computacional
http://www.researchgate.net/publication/233843056_Transferncia_de_Calor_e_Mecnica_dos_Fluidos_Computacional
http://dx.doi.org/10.2118/173259-MS
http://doi.org/10.1007/978-3-540-24588-9_9
http://doi.org/10.1007/978-3-540-24588-9_9


210 Referências

MATHEW, T. P. Domain Decomposition Methods for
the Numerical Solution of Partial Differential Equations.
Springer-Verlag Berlin Heidelberg, 2008. Disponível em:
&lt;http://doi.org/10.1007/978-3-540-77209-5&gt;. Citado na página
96.

MOYNER, O. Multiscale Finite Volume Methods - Extension to
Unstructured Grids with Applications in Reservoir Simulation.
Dissertação (Master of Science in Physics and Mathematics) —
NTNU - Norwegian University of Science and Technology, 2012.
Disponível em:&amp;lt;http://hdl.handle.net/11250/259015&gt;. Citado
na página 106.

MOYNER, O. Construction of multiscale preconditioners on
stratigraphic grids. In: ECMOR XIV - 14th European Conference
on the Mathematics of Oil Recovery. [s.n.], 2014. Disponível
em:&amp;lt;http://doi.org/10.3997/2214-4609.20141775&gt;. Citado na
página 111.

MOYNER, O.; LIE, K. A. The multiscale finite-volume method
on stratigraphic grids. SPE Journal, v. 19, p. 816–831, 2014.
Disponível em:&amp;lt;http://dx.doi.org/10.2118/163649-PA&gt;.
Citado 2 vezes nas páginas 106 e 111.

MOYNER, O.; LIE, K. A. A multiscale two-point
flux-approximation method. Journal of Computational
Physics, v. 275, p. 273–293, 2014. Disponível em:
&lt;http://doi.org/10.1016/j.jcp.2014.07.003&gt;. Citado na
página 110.

MOYNER, O.; LIE, K. A. A multiscale method based on
restriction-smoothed basis functions suitable for general grids in
high contrast media. In: SPE Reservoir Simulation Symposium,
23-25 February, Houston, Texas, USA. [s.n.], 2015. Disponível
em:&amp;lt;http://dx.doi.org/10.2118/173265-MS&gt;. Citado na página
111.

DESIGN 28th ACM SIGPLAN Conference on P. L.;
IMPLEMENTATION (Ed.). Valgrind: a framework for

http://doi.org/10.1007/978-3-540-77209-5
http://hdl.handle.net/11250/259015
http://doi.org/10.3997/2214-4609.20141775
http://dx.doi.org/10.2118/163649-PA
http://doi.org/10.1016/j.jcp.2014.07.003
http://dx.doi.org/10.2118/173265-MS


Referências 211

heavyweight dynamic binary instrumentation, v. 42, n. 6. [s.n.],
2007. Disponível em:&amp;lt;http://dx.doi.org/10.1145/1273442.
1250746&gt;. Citado na página 144.

NORDBOTTEN, J.; BJORSTAD, P. On the relationship between
the multiscale finite-volume method and domain decomposition
preconditioners. Computational Geosciences, Springer
Netherlands, v. 12, n. 3, p. 367–376, 2008. ISSN 1420-0597.
Disponível em:&amp;lt;http://dx.doi.org/10.1007/s10596-007-9066-6&gt;.
Citado na página 111.

OSEI-KUFFUOUR, D.; SAAD, Y. Matrix reordering using
multilevel graph coarsening for ilu preconditioning. SIAM
Journal on Scientific Computing, v. 37, p. A319–A419, 2015.
Disponível em:&amp;lt;http://doi.org/10.1137/130936610&gt;. Citado
na página 86.

PAL, M. et al. Validation of the multiscale mixed finite element
method. International Journal for Numerical Methods in
Fluids, v. 77, n. 4, p. 206–223, November 2014. ISSN 1097-0363.
Disponível em:&amp;lt;http://dx.doi.org/10.1002/fld.3978&gt;. Citado
na página 98.

PEACEMAN, D. W. Fundamentals of Numerical Reservoir
Simulation. Elsevier Scientific Publishing Company, 1977.
Disponível em:&amp;lt;http://dl.acm.org/citation.cfm?id=531922&gt;.
Citado na página 45.

PEACEMAN, D. W. Interpretation of well-block pressures
in numerical reservoir simulation with nonsquare grid blocks
and anisotropic permeability. SPE Journal, v. 23, n. 03,
p. 531–543, June 1983. SPE-10528-PA. Disponível em:
&lt;http://dx.doi.org/10.2118/10528-PA&gt;. Citado 2 vezes nas
páginas 40 e 44.

POINTING, D. K. Corner point grid in reservoir
simulation. In: ECMOR I - 1st European Conference on the
Mathematics of Oil Recovery. [s.n.], 1989. Disponível em:

http://dx.doi.org/10.1145/1273442.1250746
http://dx.doi.org/10.1145/1273442.1250746
http://dx.doi.org/10.1007/s10596-007-9066-6
http://doi.org/10.1137/130936610
http://dx.doi.org/10.1002/fld.3978
http://dl.acm.org/citation.cfm?id=531922
http://dx.doi.org/10.2118/10528-PA


212 Referências

&lt;http://doi.org/10.3997/2214-4609.201411305&gt;. Citado na
página 46.

POLLOCK, D. W. Semianalytical computation of
path lines for finite-difference models. Groundwater,
v. 26, n. 6, p. 743–750, November 1988. Disponível em:
&lt;http://dx.doi;org/10.1111/j.1745-6584.1988.tb00425.x&gt;.
Citado na página 140.

PRESHO, M.; GALVIS, J. A mass conservative generalized
multiscale finite element method applied to two-phase flow in
heterogeneous porous media. Preprint submitted to Journal of
Computational and Applied Mathematics. 2015. Disponível em:
&lt;http://arxiv.org/abs/1504.02033&gt;. Citado na página 98.

QIN, G.; EWING, R. E.; CHEN, Z. Analysis of a compositional
model for fluid flow in porous media. SIAM Journal on
Applied Mathematics, v. 60, p. 747–777, 2000. Disponível em:
&lt;http://doi.org/10.1137/S0036139998333427&gt;. Citado na
página 39.

RICHARDSON, L. F. The approximate arithmetical solution
by finite differences of physical problems involving differential
equations, with an application to the stresses in a masonry
dam. Philosophical Transactions of the Royal Society of
London. Series A, Containing Papers of a Mathematical or
Physical Character, v. 210, p. 307–357, 1911. Disponível em:
&lt;http://www.jstor.org/stable/90994&gt;. Citado na página 75.

SAAD, Y. ILUT: A dual threshold incomplete LU factorization.
Numerical Linear Algebra with Applications, v. 1, p. 387–402,
1994. Disponível em:&amp;lt;http://doi.org/10.1002/nla.1680010405&gt;.
Citado na página 85.

SAAD, Y. Preconditioned Krylov Subspace Methods for
CFD Application. [S.l.], 1994. Disponível em:&amp;lt;http:
//www-users.cs.umn.edu/~saad/PDF/umsi-94-171.pdf&gt;.
Citado na página 85.

http://doi.org/10.3997/2214-4609.201411305
http://dx.doi;org/10.1111/j.1745-6584.1988.tb00425.x
http://arxiv.org/abs/1504.02033
http://doi.org/10.1137/S0036139998333427
http://www.jstor.org/stable/90994
http://doi.org/10.1002/nla.1680010405
http://www-users.cs.umn.edu/~saad/PDF/umsi-94-171.pdf
http://www-users.cs.umn.edu/~saad/PDF/umsi-94-171.pdf


Referências 213

SAAD, Y. ILUM: A multi-elimination ILU preconditioner
for general sparse matrices. SIAM Journal on Scientific
Computing, v. 14, p. 830–847, 1996. Disponível em:
&lt;http://doi.org/10.1137/0917054&gt;. Citado na página 86.

SAAD, Y. Iterative Methods for Sparse Linear Systems. Society for
Industrial and Applied Mathematics, 2003. ISBN 9780898715347.
Disponível em:&amp;lt;http://dx.doi.org/10.1137/1.9780898718003&gt;.
Citado 6 vezes nas páginas 73, 74, 76, 77, 82 e 85.

SAAD, Y.; SCHULTZ, M. H. GMRes: Generalized minimal
residual algorithm for solving non-symmetric linear systems.
Scientific and Statistical Computing, v. 7, n. 3, p. 856–869, Julho
1986. Disponível em:&amp;lt;http://www.stat.uchicago.edu/~lekheng/
courses/324/saad-schultz.pdf&gt;. Citado na página 76.

SANDVE, T. H.; KEILEGAVLEN, E.; NORDBOTTEN,
J. M. Physics-based preconditioners for flow in fractured
porous media. Water Resources Research, v. 50, n. 2,
p. 1357–1373, 2014. ISSN 1944-7973. Disponível em:
&lt;http://dx.doi.org/10.1002/2012WR013034&gt;. Citado na página
111.

SANDVIN, A. Robust Multiscale Control-volume Methods for
Reservoir Simulation. Tese (Doutorado) — University of Bergen,
2012. Disponível em:&amp;lt;https://bora.uib.no/handle/1956/7416&gt;.
Citado 2 vezes nas páginas 32 e 71.

SCHEICHL, R.; MASSON, R.; WENDEBOURG, J. Decoupling
and block preconditioning for sedimentary basin simulations.
Computational Geosciences, v. 7, p. 295–318, 2003. Disponível
em:&amp;lt;http://doi.org/10.1023/B:COMG.0000005244.61636.4e&gt;.
Citado na página 87.

SMITH, B. F.; BJøRSTAD, P. E.; GROPP, W. D. Domain
decomposition: parallel multilevel methods for elliptic partial
differential equations. Cambridge University Press, 1996.
Disponível em:&amp;lt;http://dl.acm.org/citation.cfm?id=238150&gt;.
Citado na página 96.

http://doi.org/10.1137/0917054
http://dx.doi.org/10.1137/1.9780898718003
http://www.stat.uchicago.edu/~lekheng/courses/324/saad-schultz.pdf
http://www.stat.uchicago.edu/~lekheng/courses/324/saad-schultz.pdf
http://dx.doi.org/10.1002/2012WR013034
https://bora.uib.no/handle/1956/7416
http://doi.org/10.1023/B:COMG.0000005244.61636.4e
http://dl.acm.org/citation.cfm?id=238150


214 Referências

SPILLETE, A. G.; HILLESTAD, J. G.; STONE, H. L. A
high-stability sequential solution approach to reservoir simulation.
In: Fall Meeting of the Society of Petroleum Engineers of AIME,
30 September-3 October, Las Vegas, Nevada. [s.n.], 1973. SPE-
4542-MS. Disponível em:&amp;lt;http://dx.doi.org/10.2118/4542-MS&gt;.
Citado na página 62.

STUBEN, K. A review of algebraic multigrid. Journal of
Computational and Applied Mathematics, v. 128, p. 281–309,
2001. Disponível em:&amp;lt;http://doi.org/10.1016/S0377-0427(00)
00516-1&gt;. Citado 2 vezes nas páginas 88 e 92.

STUBEN, K. Solving reservoir simulation equations. In: Ninth
International Forum on Reservoir Simulation, Abu Dhabi, United
Arab Emirates. 9th International Forum on Reservoir Simulation,
2007. Disponível em:&amp;lt;https://www.scai.fraunhofer.de/fileadmin/
download/publikationen/Paper_AD_040907.pdf&gt;. Citado na
página 92.

SUN, S.; KEYES, D. E.; LIU, L. Fully implicit two-
phase reservoir simulation with the additive schwarz
preconditioned inexact newton method. In: SPE Reservoir
Characterization and Simulation Conference and Exhibition,
16-18 September, Abu Dhabi, UAE. [s.n.], 2013. Disponível em:
&lt;http://dx.doi.org/10.2118/166062-MS&gt;. Citado na página 52.

THOMAS, G. W.; THURNAU, D. H. Reservoir simulation
using an adaptive implicit method. SPE Journal, v. 23,
p. 759–763, 1983. SPE-10120-PA. Disponível em:&amp;lt;http:
//dx.doi.org/10.2118/10120-PA&gt;. Citado na página 48.

TOSELLI, A.; WIDLUND, O. Domain Decomposition Methods -
Algorithms and Theory. Springer Berlin Heidelberg, 2005. v. 34.
Disponível em:&amp;lt;http://doi.org/10.1007/b137868&gt;. Citado na
página 96.

TRANGENSTEIN, J. A.; BELL, J. B. Mathematical structure of
compositional reservoir simulation. SIAM Journal on Scientific

http://dx.doi.org/10.2118/4542-MS
http://doi.org/10.1016/S0377-0427(00)00516-1
http://doi.org/10.1016/S0377-0427(00)00516-1
https://www.scai.fraunhofer.de/fileadmin/download/publikationen/Paper_AD_040907.pdf
https://www.scai.fraunhofer.de/fileadmin/download/publikationen/Paper_AD_040907.pdf
http://dx.doi.org/10.2118/166062-MS
http://dx.doi.org/10.2118/10120-PA
http://dx.doi.org/10.2118/10120-PA
http://doi.org/10.1007/b137868


Referências 215

and Statistical Computing, v. 10, p. 815–845, 1989. Disponível
em:&amp;lt;http://doi.org/10.1137/0910049&gt;. Citado na página 39.

TROTTENBERG, U.; OOSTERLEE, C.; SCHÜLLER,
A. Multigrid. Academic Press, 2001. ISBN 9780127010700.
Disponível em:&amp;lt;https://books.google.com.br/books?id=
-og1wD-Nx\_wC&gt;. Citado na página 92.

WALLIS, J. R. Incomplete gaussian elimination as a
preconditioning for generalized conjugate gradient acceleration.
In: SPE Reservoir Simulation Symposium, 15-18 November,
San Francisco, California. [s.n.], 1983. Disponível em:
&lt;http://dx.doi.org/10.2118/12265-MS&gt;. Citado na página 86.

WALLIS, J. R.; KENDALL, R. P.; LITTLE, T. E.
Constrained residual acceleration of conjugate residual
methods. In: SPE Reservoir Simulation Symposium, 10-
13 February, Dallas, Texas. [s.n.], 1985. Disponível em:
&lt;http://dx.doi.org/10.2118/13536-MS&gt;. Citado na página 86.

WANG, Y. Algebraic Multiscale Linear Solver for Heterogeneous
Elliptic Problems. Dissertação (Mestrado) — Resources
Engineering Stanford University, 2012. Disponível em:
&lt;https://pangea.stanford.edu/ERE/pdf/pereports/MS/Wang_
Yixuan2012.pdf&gt;. Citado 2 vezes nas páginas 113 e 127.

WANG, Y.; HAJIBEYGI, H.; TCHELEPI, H. A. Algebraic
multiscale solver for flow in heterogeneous porous
media. Journal of Computational Physics, v. 259, n. 0,
p. 284 – 303, 2014. ISSN 0021-9991. Disponível em:
&lt;http://dx.doi.org/10.1016/j.jcp.2013.11.024&gt;. Citado 4 vezes
nas páginas 113, 127, 128 e 140.

WATTS, J. W.; SHAW, J. S. A new method for solving
the implicit reservoir simulation matrix equation. In:
SPE Reservoir Simulation Symposium, 31 January-2
Feburary, The Woodlands, Texas. [s.n.], 2005. Disponível em:
&lt;http://dx.doi.org/10.2118/93068-MS&gt;. Citado na página 49.

http://doi.org/10.1137/0910049
https://books.google.com.br/books?id=-og1wD-Nx\_wC
https://books.google.com.br/books?id=-og1wD-Nx\_wC
http://dx.doi.org/10.2118/12265-MS
http://dx.doi.org/10.2118/13536-MS
https://pangea.stanford.edu/ERE/pdf/pereports/MS/Wang_Yixuan2012.pdf
https://pangea.stanford.edu/ERE/pdf/pereports/MS/Wang_Yixuan2012.pdf
http://dx.doi.org/10.1016/j.jcp.2013.11.024
http://dx.doi.org/10.2118/93068-MS


216 Referências

WHITAKER, S. Flow in porous media i: A theoretical derivation
of darcy’s law. Transport in Porous Media, Kluwer Academic
Publishers, v. 1, n. 1, p. 3–25, 1986. ISSN 0169-3913. Disponível
em:&amp;lt;http://dx.doi.org/10.1007/BF01036523&gt;. Citado na
página 42.

WILLIAMS, S.; WATERMAN, A.; PATTERSON, D. Roofline:
An insighful visual performance model for multicore architectures.
Communications of the ACM, v. 52, p. 65–76, 2009. Disponível
em:&amp;lt;http://doi.org/10.1145/1498765.1498785&gt;. Citado na
página 72.

WOLFSTEINER, C.; LEE, S.; TCHELEPI, H. Well
modeling in the multiscale finite volume method for
subsurface flow simulation. Multiscale Modeling &amp;amp;
Simulation, v. 5, n. 3, p. 900–917, 2006. Disponível em:
&lt;http://epubs.siam.org/doi/abs/10.1137/050640771&gt;. Citado
na página 111.

XU, J. The method of subspace corrections. Journal of
Computational and Applied Mathematics, v. 128, p. 335–362,
2001. Disponível em:&amp;lt;http://doi.org/10.1016/S0377-0427(00)
00518-5&gt;. Citado na página 96.

YANG, U. M. Parallel algebraic multigrid methods high
performance preconditioners. In: . Springer Berlin
Heidelberg, 2006. cap. 2, p. 209–236. Disponível em:
&lt;http://doi.org/10.1007/3-540-31619-1_6&gt;. Citado na página
92.

ZHOU, H. Operator Based Multiscale Method for Compressible
Flow. Dissertação (Mestrado) — Stanford University, 2006.
Disponível em:&amp;lt;https://pangea.stanford.edu/ERE/pdf/
pereports/MS/Zhou06.pd&gt;. Citado 2 vezes nas páginas 110
e 113.

ZHOU, H. Algebraic Multiscale Finite-Volume Methods for
Reservoir Simulation. Tese (Doutorado) — Stanford University,
2010. Disponível em:&amp;lt;https://pangea.stanford.edu/ERE/pdf/

http://dx.doi.org/10.1007/BF01036523
http://doi.org/10.1145/1498765.1498785
http://epubs.siam.org/doi/abs/10.1137/050640771
http://doi.org/10.1016/S0377-0427(00)00518-5
http://doi.org/10.1016/S0377-0427(00)00518-5
http://doi.org/10.1007/3-540-31619-1_6
https://pangea.stanford.edu/ERE/pdf/pereports/MS/Zhou06.pd
https://pangea.stanford.edu/ERE/pdf/pereports/MS/Zhou06.pd
https://pangea.stanford.edu/ERE/pdf/pereports/PhD/Zhou-Hui10.pdf
https://pangea.stanford.edu/ERE/pdf/pereports/PhD/Zhou-Hui10.pdf


Referências 217

pereports/PhD/Zhou-Hui10.pdf&gt;. Citado 2 vezes nas páginas
111 e 113.

ZHOU, H.; TCHELEPI, H. Operator based multiscale method
for compressible flow. SPE Journal, v. 13, n. 2, p. 267–273,
2008. Disponível em:&amp;lt;http://dx.doi.org/10.2118/106254-PA&gt;.
Citado 2 vezes nas páginas 110 e 113.

ZHOU, H.; TCHELEPI, H. A. Two-stage algebraic multiscale
linear solver for highly heterogeneous reservoir models. SPE
Journal, Society of Petroleum Engineers, v. 17, n. 02, p. 523–539,
2012. Disponível em:&amp;lt;http://dx.doi.org/10.2118/141473-PA&gt;.
Citado na página 113.

https://pangea.stanford.edu/ERE/pdf/pereports/PhD/Zhou-Hui10.pdf
https://pangea.stanford.edu/ERE/pdf/pereports/PhD/Zhou-Hui10.pdf
http://dx.doi.org/10.2118/106254-PA
http://dx.doi.org/10.2118/141473-PA




Apêndices





221

APÊNDICE A – PARÂMETROS DO MODELO
BLACK-OIL

Nesse capítulo, apresentam-se as relações para as proprie-
dades dos fluidos do modelo black-oil.

A.1 FASE ÁGUA

O fator volume de formação da fase água Bw é dado por

Bw = Biw
(
1 + cw

(
p?pi

))
, (A.1)

em que Biw é o fator volume de formação da água avaliado na
pressão de referência pi e cw é a razão de compressibilidade da
fase água.

A viscosidade da fase água µw é dada por

µw = µiw
(
1 + dw

(
p?pi

))
, (A.2)

em que µiw é a viscosidade da água avaliada na pressão de refe-
rência e dw é a viscosibilidade, parâmetro que mede a influência
da pressão sobre a viscosidade.

A.2 FASE ÓLEO

As propriedades da fase óleo são definidas por duas ma-
neiras, de acordo com o estado em consideração

A.2.1 Estado subsaturado

O fator volume de formação do óleo no estado subsaturado
é dado por

Bo = Bo (pb) (1 ? co (p?pb)) , (A.3)

em que Bo (pb) é o fator volume de formação do óleo avaliado na
pressão de bolha pb e co, a razão de compressibilidade da fase
óleo.



222 APÊNDICE A. Parâmetros do Modelo black-oil

A viscosidade é dada por

µo = µob (pb) (1 + cµ (p?pb)) , (A.4)

em que µob é a viscosidade da fase óleo avaliada na pressão de
bolha pb e cµ, a viscosibilidade do óleo.

A.2.2 Estado saturado

No estado saturado, o fator volume de formação da fase
óleo Bo é calculado através de uma tabela que lista seus valores
como função da pressão. O mesmo é válido para a viscosidade µo.

A.3 FASE GÁS

A densidade da fase gás é dada por

?g =
?gs
Bg

, (A.5)

em que
?gs = Yg?ar, Bg =

ZT

p

ps
Ts
, (A.6)

com Yg a densidade adimensional do gás; ?ar, a densidade do ar;
T e Ts, as temperaturas do gás nas condições atual e de referência;
p e ps, sua pressão nas condições atual e de referência e Z, o fator
de compressibilidade.

A viscosidade da fase gás µg é função da pressão, tal
função é definida por valores discretos informados através de uma
tabela.



223

APÊNDICE B – PRÉ-CONDICIONADOR MULTIESCALA
ALGÉBRICO 3D

No caso de problemas tridimensionais, o particionamento
wirebasket da malha refinada apresenta uma nova classe de en-
tidades: os volumes de superfície. Atualizando o operador de
permutação Q de acordo com essa nova classificação, segue que
a matriz do sistema linear (5.1) pode ser reescrita no formato
reordenado da seguinte maneira:

A? = QAQ?T =

?
?????

A?ii A?is 0ie 0iv
A?si A?ss A?se 0sv
0ei A?es Aee A?ev
0vi 0vs A?ve A?vv

?
????? . (B.1)

Para a obtenção do pré-condicionador multiescala algé-
brico com funções de correção M?1mswc, as seguintes conexões
presentes na matriz A? são desconsideradas:

1. conexões que partem dos volumes de interior em sentido
aos volumes de superfície,

(
A?si

)
;

2. conexões que partem dos volumes de superfície em sentido
aos volumes de aresta,

(
A?es

)
;

3. conexões que partem dos volumes de aresta em sentido aos
volumes de vértice,

(
A?ve

)
,

o que conduz ao seguinte operador:

Mmswc =

?
?????

A?ii A?is 0ie 0iv
0si Mss A?se 0sv
0ei 0es Mee A?ev
0vi 0vs 0ve Mvv

?
????? , (B.2)



224 APÊNDICE B. Pré-Condicionador Multiescala Algébrico 3D

em que as matrizes Mss e Mee são dadas por:

Mss = A?ss + diag
(?

i

A?Tis

)
(B.3)

Mee = A?ee + diag
(?

s

A?Tse

)
(B.4)

e a matriz referente ao problema grosseiro Mvv é calculada da
mesma forma como (5.23).

A adição dos volumes de superfície também provoca a re-
definição dos operadores de prolongação e de correção. O primeiro
passa a ser dado por:

P =

?
?????

A??1ii A?ieM
?1
ee A?esM?1ss A?sn

?M?1ee A?esM?1ss A?sn
M?1ss A?sn

Ivv

?
????? , (B.5)

enquanto o segundo é dado por:

C =

?
?????

A??1ii ?A?
?1
ii A?isM

?1
ss A?

?1
ii A?isM

?1
ss A?seM?1ee 0iv

0si M?1ss ?M?1ss A?seM?1ee 0sv
0ei 0es M?1ee 0ev
0vi 0vs 0ve 0vv

?
????? .
(B.6)

O operador de restrição é definido como antes, o qual pode
ser escrito segundo as estratégias baseadas em volumes finitos
(RFV ) ou elementos finitos (RFE).


	Folha de rosto
	Folha de aprovação
	Agradecimentos
	Epígrafe
	Resumo
	Abstract
	Lista de ilustrações
	Lista de tabelas
	Lista de algoritmos
	Lista de abreviaturas e siglas
	Lista de símbolos
	Sumário
	Introdução
	Motivação
	Objetivo Geral
	Objetivos Específicos
	Organização do Trabalho

	Modelagem Matemática e Numérica
	Escoamento Trifásico
	Discretização das Equações
	Determinação do Ponto de Bolha

	Escoamento Bifásico
	Discretização das Equações

	Escoamento Monofásico

	Solução do Modelo Matemático
	Upscaling
	Solvers Lineares
	Fatoração LU completa
	Método de Richardson
	Método do Resíduo Generalizado Mínimo
	Método do Gradiente Conjugado

	Pré-Condicionadores
	Método da Sobre-Relaxação Sucessiva
	Fatoração LU Incompleta
	Constrained Pressure Residual
	Multigrid Algébrico
	Decomposição de Domínio


	Método dos Volumes Finitos Multiescala - MsFVM
	Funções Base Duais
	Problema na Malha Grossa
	Reconstrução do Campo de Velocidade
	Funções de Correção
	Desenvolvimentos Recentes

	Pré-condicionador Multiescala Algébrico
	Operadores de Transferência
	Problema na Malha Grossa
	Definição do Pré-Condicionador
	Reconstrução do Campo de Velocidades

	Resultados
	Caso 1: monofásico 2D
	Solução aproximada
	Métodos diretos
	Métodos iterativos

	Caso 2: escoamento canalizado
	Solução aproximada
	Solução precisa

	Caso 3: bifásico incompressível 2D
	Solução aproximada
	Solução precisa

	Caso 4: teste comparativo SPE 9

	Conclusões
	Sugestões para trabalhos futuros

	Referências
	Apêndices
	Parâmetros do Modelo black-oil
	Fase Água
	Fase Óleo
	Estado subsaturado
	Estado saturado

	Fase Gás

	Pré-Condicionador Multiescala Algébrico 3D


</field>
	</doc>
</add>