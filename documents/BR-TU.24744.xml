<?xml version="1.0" encoding="utf-8"?>
<add>
	<doc>
		<field name="docid">BR-TU.24744</field>
		<field name="filename">9218_EdsonMinatelD.pdf</field>
		<field name="filetype">PDF</field>
		<field name="text">
Modelo computacional baseado em técnicas Wavelets 
para relacionar imagens digitais obtidas em diferentes 

escalas e resoluções 

Edson Roberto Minatel 

Tese apresentada ao Instituto 
de Física de São Carlos, da 
Universidade de São Paulo, 
para obtenção do título de 
Doutor em Ciências, sub-área: 
Física Computacional. 

Orientador: Prof. Dr. Paulo Estevão Cruvinel &amp;amp; 

São Carlos - 2003 



UNIVERSIDADE DE SÃO PAULO 
INSTITUTO DE F~SICA DE SÃO CARLOS 

F~SICA COMPUTACIONAL 

MODELO COMPUTACIONAL BASEADO EM 
TÉCNICAS WAVELETS PARA RELACIONAR 

IMAGENS DIGITAIS OBTIDAS EM DIFERENTES 
ESCALAS E RESOLUÇÕES 

Edson Roberto Minatel' 

Tese apresentada ao Instituto de Física de 
São Carlos, da Universidade de São Paulo, 
como parte dos requisitos para a obtenção 
do título de Doutor em Ciências, sub-área: 
Física Computacional. 

Orientador: 
Prof. Dr. Paulo Estevão Cruvinel 

São Carlos 
2003 

' Este trabalho contou com o apoio financeiro da Fapesp e CNPq. 



Minatel, Edson Roberto 

"Modelo computacional baseado em técnicas Wavelets para relaciona] 
imagens digitais em diferentes escalas e resoluções." 
Edson Roberto Minatel - São Carlos, 2003 

Tese (Doutorado) - Área de Física Computacional da Universidade de São 
Paulo, 2003 - Páginas: 152 

Orientador: Prof. Dr. Paulo Estevão Cruvinel 

1. Processamento Digital de Imagens; Wavelets; Meios porosos; 
Tomografia Computadorizada; Sub-Pixel; Vetorização; 

I. Titulo 



UNIVERSIDADE 
DE SÁO PAULO Av. Trabalhador São-carlense, 400 

Instituto de Física de Sáo Carlos Caixa Postal 369 
13560-970 - São Carlos - SP - Brasil 

MEMBROS DA COMISSAO JULGADORA DA TESE DE DOUTORADO DE EDSON 

ROBERTO MINATEL APRESENTADA AO INSTITUTO DE F~SICA DE SÃO CARLOS, 

UNIVERSIDADE DE SÃO PAULO, EM 03-10-2003. 

COMISSÃO JULGADORA: 

&amp;amp; 

Prof. Dr. Paulo Estev2o Cruvinel (Orientador e Presidente) - EMBRAPA 

Prof. Dr. Nelson Delfino ~ ' Á v i i a  Mascarenhas - UFSCar 

Prof. Dr. Roberto Marcondes César Júnior - IMEIUSP 

~,~ ~ - 

Prof. Dr. Valentin Obac Roda - EESCIUSP 

to - EESCIUSP 

USP - Educação para o Brasil 



Dedicatória 

Sempre acreditei que a base 
consolidada no passado e as expectativas 
futuras são o combustível de toda minha 
motivação pessoal e profissional. Assim, 
dedico este trabalho a memória de minha avó 
Rosa e a minha filha Débora. 



É apresentado o desenvolvimento de um modelo computacional que visa 

relacionar imagens digitais obtidas em diferentes escalas e resoluções com 

aplicação de Wavelets. Seu desenvolvimento encontra-se no contexto 

multidisciplinar e situa-se na intersecção das linhas de pesquisa de áreas da 

Física, da Matemática e da Computação. Desta forma, optou-se na 

implementação por uma abordagem computacional dos estudos, com 

aplicaçao em imagens digitais provenientes da reconstrução de dados de 

tomografia computadorizada de Raios-X. Resultados indicam que a 

implementação do modelo computacional desenvolvido tem sua 

funcionalidade comprovada, uma vez que os atributos vetoriais dos objetos 

considerados para análise (poros) foram mantidos estáveis em diferentes 

resoluções estudadas. O modelo foi implementado em linguagem de 

programação C++ com uso de orientação a objetos e organizado em 

classes. Adicionalmente, sua aplicação é viabilizada para diversas 

plataformas computacionais no que tange a sistemas operacionais e 

processadores. Do ponto de vista científico, o sistema resultante, além de 

ser uma ferramenta importante no estudo de meios porosos através de 

imagens de tomografia computadorizada por Raios-X, contribui com 

métodos inovadores que fazem uso de Wavelets e são aplicados na 

suavização de bordas por técnica sub-pixel, na otimização de desempenho e 

no processamento de dados para interpolação. 



Abstract 

This work consists of the development of a computational model aimed at 

relating digital images obtained on different scales and resolutions to the 

application of Wavelets. The development of this model lies within a 

multidisciplinary context, at the intersection of the research lines of areas of 

Physics, Mathematics and Computation. The choice of these studies 

therefore fel1 on a computational approach, with the application of digital 

images originating from the reconstruction of computerized tomographic X- 

ray data. The results of the implementation of the computational model 

developed here confirm the model's functionality, since the vectorial 

attributes of the objects utilized for our analysis (pores) remained stable 

under different resolutions. The model was implemented in the C++ 

programming language using object orientation, and the model's methods 

were organized into classes based on their application on different 

computational platforms, from the standpoint of operational systems and 

processors. In the scientific point of view, the resulting system is an 

important tool in the porous means researches using computerized 

tomography by X-rays and it has exclusive methods. These methods use 

Wavelets and they have application in edge smoothing processes by sub- 

pixel technique, in optimizing processing time and in data processing for 

interpolation. 



Agradecimento especial 

Agradeço a minha esposa Sueli pela compreensão, pela 

tolerância, pelo apoio incondicional, pelos sacrifícios, por compartilhar os 

seus sonhos, por motivar os meus sonhos, por sempre ajudar na busca de 

concretizar nossos sonhos, pela cumplicidade, por abrir mão inúmeras vezes 

de seus anseios pessoais, enfim, pelo amor. 



vii 

Agradecimentos 

Este trabalho não teria sido concluído se não houvesse a contribuição de 

muitas pessoas e instituições. Agradeço de forma especial: 

Ao Prof.Dr. Paulo E. Cruvinel pela orientação séria, pela amizade, 

pela motivação constante e pelo exemplo de vida. Agradeço também 

a sua esposa Miriam, e aos seus filhos Paula e André que cederam 

muitas das suas horas sempre que preciso; 

Aos meus pais, Pedro e Silvia, pelo apoio incondicional em todas as 

fases de minha educação; 

Ao Instituto de Física de S. Carlos pela oportunidade e em especial a 

Wladerez pela competência e simpatia; 

A Embrapa Instrumentação Agropecuária e a todos seus integrantes, 

pelo apoio e agradável convívio; 

Ao Prof.Dr. Marcos Luiz Mucheroni pela motivação inicial e constante 

incentivo a pesquisa e ao Prof.Dr. Rangaraj M. Rangayyan pelo apoio 

científico; 

A empresa Ablevision pelo apoio e motivação a pesquisa; 

e Aos amigos que contribuíram direta ou indiretamente para esse 

desenvolvimento. 

A Fapesp pelo apoio científico e financeiro através do processo 

99/01 O1 5-2. 



Prefácio 
O uso de imagens digitais provenientes de tomografia computadorizada em 

aplicações na agricultura foi discutido inicialmente em 1981 por físicos e 

engenheiros eletrônicos da Fundação Educacional de Barretos (FEB), da 

Universidade de Campinas (Unicamp) e da Universidade de São Paulo 

(USP). Essa discussão realizada com o Dr. Sérgio Mascarenhas, físico do 

Instituto de Física da USP de São Carlos (IFSC), originou um projeto 

multidisciplinar para o desenvolvimento de um novo método e um novo 

equipamento. Como resultado desse projeto, que contou com a parceria 

entre a USP e Unicamp com as universidades italianas de Trieste e de 

Roma, duas teses de doutorado foram elaboradas produzindo pioneiras 

contribuições. Essas contribuições introduziram, em 1983, o uso da 

tomografia médica de Raios-X em estudos dos sistemas água-solo-planta- 

atmosfera. Em 1985 um tomógrafo de Raios-X e raios y automatizado e de 

baixo custo foi projetado e desenvolvido inteiramente no Brasil pela mesma 

equipe de pesquisadores objetivando aplicações multidisciplinares e 

especialmente aplicações na agricultura [CRUVINEL-19871. Em 1994, a 

Embrapa Instrumentação Agropecuária apresentou estudos com tomografia 

de dupla energia, um tomógrafo portátil e resultados de tomografias com 

Raios-X e ressonância magnética foram obtidos confirmando simulações da 

teoria da passagem de um líquido por um meio poroso. 

Problemas de grande importância tanto para a agricultura quanto para 

a engenharia geotécnica foram estudados como é o caso do comportamento 

de solos expansivos e colapsantes sob diferentes condições de 

compactação e de umidade. Esses problemas foram estudados em 1995 em 

trabalho conjunto entre a Embrapa Instrumentação Agropecuária e as 

universidades federais do Mato Grosso e de Pelotas e das escolas Técnica 

Federal de Mato Grosso e de Engenharia de São Carlos (USP). Desde sua 

criação, o tomógrafo da Embrapa Instrumentação Agropecuária foi 

aprimorado no que diz respeito tanto ao hardware quanto aos algoritmos de 

reconstrução e visualização das imagens. Como resultados deste histórico 



de pesquisas originou-se uma expressiva gama de imagens digitais obtidas 

em diversas escalas e diferentes resoluções provenientes dos equipamentos 

de tomografia desenvolvidos. [MINATEL-1997,19981 [POSADAS-1 9941 

[CAÇÃO-1 9941 [BUENO-19951 [CRESTANA-19901. 

Neste contexto, a motivação deste trabalho de doutorado se deu pela 

constatação da demanda de métodos ou ferramentas computacionais que 

relacionassem imagens obtidas em escalas e resoluções diferentes a partir 

sistemas de imageamento. Por outro lado, este trabalho de doutorado é 

organizado em 4 capítulos que, com o intuito de otimizar sua leitura e 

compreensão, são brevemente descritos a seguir: 

No Capítulo 1 são descritos os principais aspectos físicos envolvidos 

no contexto da formação de imagens por Raios-X e são apresentados 

fundamentos sobre meios porosos e tomografia computadorizada. 

No Capítulo 2 são abordados os fundamentos matemáticos utilizados 

no desenvolvimento do trabalho. Nele são também apresentados os 

conceitos e fundamentos do Processamento Digital de Imagens. 

No Capítulo 3 é apresentado o modelo desenvolvido com uso de 

fluxogramas e de pseudocódigos de forma modular e com progressivo nível 

de detalhamento. Em alguns processos apresentados faz-se uso de imagens 

que ilustram os resultados esperados. 

No Capítulo 4 são apresentados os resultados da aplicação do 

modelo implementado em linguagem de programação C++. Imagens 

provenientes da tomografia computadorizada por Raios-X em diferentes 

resoluções serviram de entrada para o modelo e uma discussáo dos 

resultados numéricos foi realizada embasando as conclusões gerais. 



Sumário 

Página de rosto .......... ........ . . ... ....................... ........ . . ... . .... . ... . ...................... . . .... i 

Ficha catalográfica ..... ........................ ............... . . ... . . . .. . . . .. . ... . . ... ..... .. .. ........ . . . .. .ii 
. . . 

Dedicatória.. . .... . .... . . .. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . , 1 1 1  

Resumo.. . .. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . iv 

Abstract.. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . , . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . ... v 
Agradecimento especial .................................................................................. vi 

Agredecimentos.. . . . . . . . . . . . . . . . . . . .. . . . .. . . . . . . . . . . . . . . . . . . . . . . . . .. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . ......... vii 
. . . 

Prefácio.. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . , . . . . . . . . . . . . . . . . . . v111 

Sumário.. ... . . . . . . . . . . . . .. ... .. . ... .. . .. . . . . . .. . . .. . . . .. . . . .. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .x 
Lista de figuras ............................................................................................... xii 

Lista de tabelas .............................................................................................. xx 

1. Meios porosos e a Tomografia de Raios-X. ...................................... 1 

1.1. Meios porosos ................................................................................... 2 

1 .I . I  . Classificação de poros .................. . . .. ...... . . . . . . ...... . . . ... . . . ...... . . . . . . . . . ... .. .. . . . 7 

1 .I .2. Métodos de medida de porosidade ....................................................... 9 

1 . I  .3. Porosidade em solos . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . I I 
1.2. Tomografia Computadorizada . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 1 3 

1.2.1. Seleção da energia.. . .......... ....... . . ................. . . . . .... .. . ..... . . ...... . . . . .. . . .. . . . . . 15 
1.2.2. Detector de Raios-X ..... . ....... . ........ .. . . . . . .. . . . ......... . . .... .. ...... . . . . ............... 16 

1.2.3. Eficiência . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 17 
1.2.4. Resolução em energia ........................................................................ 17 

1.2.5. Resolução de tempo .......................................................................... 17 

1.2.6. A formação de imagens a partir de projeções e os principais 

problemas relativos a reconstrução ... ... . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 17 

1.2.7. Algoritmos para reconstrução bi e tridimensional ................................ 23 

1.2.8. Retroprojeção filtrada . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . , . 26 

2. Fundamentos matemáticos e o processamento de imagens digitais34 

2.1. Definições adotadas ........................................................................ 35 

2.1 . I  . Definição de Escala ..... . . . ...... . ....... . . . . . . .. .. . . . . . . . .... . . . . .... . . . .... . . .. ............... 35 



2.1.2. Definição de Resolução ....................................................................... 35 

2.2. Processamento de Imagens Digitais ............................................... 35 

2.2.1. Resolução Espacial de Amostragem ................................................... 38 

2.2.1.1. Resolução Espacial de Amostragem como seqüências 

bidimensionais ............................................................................................... 38 

2.2.1.2. No contexto do Processamento Digital de Imagens ........................ 43 

2.2.2. Limiarização (Threshold) ..................................................................... 44 

2.2.3. Regiões de interesse ........................................................................... 45 

2.2.4. Cópia de imagens ................................................................................ 45 

2.2.5. Rotulação ............................................................................................ 45 

2.2.6. Convolução no domínio espacial ..................................................... 45 

2.2.7. Detecção de bordas ............................................................................ 46 

2.2.8. Transformações escalares .................................................................. 46 

2.2.9. Imagem Vetorial x Imagem Raster ...................................................... 46 

2.2.10. Classificação de imagens digitais em função de escala e resolução 47 

2.3. Wavelets ......................................................................................... 48 

2.3.1. Análise de Multiresolução, Decomposição e Composição .................. 57 

2.3.2. Algoritmo de interpolação por B-Wavelets ........................................ 61 

3 . Desenvolvimento do modelo ........................................................... 64 

3.1. Fase de extração de atributos ......................................................... 66 

...................................................................... 3.2. Fase de classificação 67 

3.3. Processamentos envolvidos ............................................................ 67 

...................................................................................... 3.3.1. Segmentação 68 

........................................... 3.3.2. Adequar escala e resolução aos padrões 69 

3.3.2.1. Zoom Out (redução) ........................................................................ 74 

3.3.2.2. Zoom In (aproximação) .................................................................. 75 

3.3.2.3. Suavização por Sub-Pixel usando B-Wavelets ............................... 77 

3.3.2.4. Usando Wavelets na vetorização .................................................... 89 

3.3.3. Extração de atributos e classificação .................................................. 93 

4 . Resultados e Conclusões ................................................................ 95 

4.1. Aplicação em imagem de Tomografia por Raios-X ......................... 96 

4.1.1. Avaliação dos resultados obtidos com o ensaio do phantom 

................................................................................................ heterogêneo 1 16 



4.1.2. Imagens de amostras de meios porosos (solos) ............................... 117 

4.1.3. Avaliação de desempenho usando otimização por Wavelets ............ 138 

4.1.3.1. Para o processo sem otimização por Wavelets: ........................... 138 

4.1.3.2. Para o processo com otimização por Wavelets: ........................... 139 

........................................................................................ 4.1.4. Conclusões 142 

4.1.5. Proposta de desenvolvimentos futuros .............................................. 144 

Referencias Bibliográficas ........................................................................... 145 

Lista de Figuras 

Figura 1.1 : Estimação do (Representative Elementary Volume) pelo 

incremento do volume da amostra de solo até que a porosidade seja 

independente da posição onde está centrado ............................................... 5 

Figura I . 2. Texturas da superfície e do subsolo de solos do centro da Europa 

em termos de porosidade no início do século 20 .......................................... 6 

Figura 1.3: Dependência da porosidade do conteúdo de água q em solos 

encharcados . Quatro domínios são definidos em [HAINES-19231 e 

modificados em [YULE-19801 .......................................................................... 7 

Figura 1.4: Diagrama de blocos de tomógrafo desenvolvido por [CRUVINEL- 

19871 . 16 

Figura 1.5. Exemplo de tomografia por transmissão ..................................... 19 

Figura 1.6. Esquema de um tomógrafo por Raios-X ..................................... 20 

Figura 1.7 : Duas projeções paralelas de um objeto matematicamente 

expresso por f(x,y) ......................................................................................... 20 

Figura 1.8. Projeção paralela de f(x, y) para a transformada de Radon ......... 21 

Figura 1.9 : Novos eixos de coordenadas (t,s, z) gerados pela rotação de 

........................................................... (x,y, z) sobre o eixo z por um ângulo q 22 

Figura 1 . 10 : Correspondência entre espaço real e espaço recíproco como 

.............................................. base para o Teorema das secções de Fourier 24 

.......... Figura 2.1 : Representação gráfica de uma seqüência bidimensional 39 



xiii 

Figura 2.2 : (a) imagem com 240 colunas por 180 linhas; (b) 120x90; (c) 

60x45; (d) 40x30 ............................................................................................ 44 

Figura 2.3: Ilustração do processo bidimensional padrão de Transformação 

ou Decomposição Wavelets. A imagem original tem suas linhas processadas 

até o nível máximo definido e as colunas são processadas posteriormente 

até o mesmo nível. ........................................................................................ 55 

Figura 2.4 : Processo bidimensional Não-Padrão de Transformação ou 

Decomposição Wavelets. A imagem original tem suas linhas e colunas 

processadas em seqüência. .......................................................................... 56 

Figura 2.5 : Decomposição por wavelet; ....................................................... 60 

Figura 2.6: Composição por wavelet; ............................................................ 61 

Figura 2.7 : Exemplo de interpolação e aproximação por 6-Wavelets. ......... 61 

Figura 3.1 : Visão geral do sistema implementado. ....................................... 65 

Figura 3.2 : Fase de extração de atributos. Atributos inerentes as imagens 

são extraídos e armazenados em um banco de dados normalizados. .......... 66 

Figura 3.3 : Fluxograma da Fase de classificação onde se observa o uso da 

base de dados gerada na Fase 1 para classificação da imagem entrada ..... 67 

Figura 3.4 : Imagem gerada por tomografia onde os coeficientes de 

atenuação são representados em escalas de tons de cinza. Pixel valor O = 

coeficiente de atenuação de valor 0.000 e os pixels de valor 255 

representam 1 .O50 ....................................................................................... 69 

Figura 3.5: Fluxograma do algoritmo de adequação da imagem entrada para 

.................. a mesma escala e resolução da imagem definida como padrão. 70 

Figura 3.6 : A marcação externa representa o tamanho da imagem padrão 

de entrada. A imagem com mesma escala e resolução de 320x240 foi 

adequada a este tamanho. ............................................................................ 71 

Figura 3.7 : A imagem com mesma escala e resolução de 640x480 foi 

.............. adequada ao tamanho padrão. Houve perda de parte da imagem. 71 

Figura 3.8 : A imagem de entrada teve suas dimensões aumentadas 

proporcionalmente de forma a ter a mesma escala da imagem padrão. 

............................................................. Houve descarte de parte da imagem 72 

Figura 3.9 : A imagem de entrada teve suas dimensões reduzidas 

....... proporcionalmente de forma a ter a mesma escala da imagem padrão. 73 



xiv 

Figura 3.10 : A imagem de entrada teve suas dimensões aumentadas (zoom 

in) de forma a ter a mesma escala da imagem padrão ................................. 73 

Figura 3.1 1 : A imagem de entrada teve suas dimensões reduzidas (zoom 

out) objetivando adequá-la a mesma escala da imagem padrão .................. 74 

Figura 3.12 : Fluxo de dados para o processamento de redução (zoom out) 

............................................................................................. de uma imagem 74 

Figura 3.13 : Processo de Zoom In com suavização por sub-pixel usando B- 

Wavelets ........................................................................................................ 76 

Figura 3.14 : Imagem (a) submetida a aproximações ("zoom in") mantendo- 

se suas características iniciais . A imagem (a) possui 256~256pixels; (b) 

5 12x5 12; (c) 768x768; (d) 1 024x1 024 ........................................................... 77 

Figura 3.15 : Fluxograma da série de processamentos necessários para a 

aplicação da técnica sub-Pixel por B-Wavelets ............................................. 78 

Figura 3.16 : (a) imagem binarizada contendo todos os poros . (b) imagem de 

um único poro ................................................................................................ 78 

Figura 3.1 7 : Processamento para segmentar uma imagem de N poros em N 

............................................................................... sub-imagens de um poro 79 

........... Figura 3.18 : Processo de vetorização dos pontos para interpolaçao 81 

............... Figura 3.19. Processo de interpolação dos poros por B-Wavelets 83 

......................................... Figura 3.20 : Remontagem da imagem dos poros 85 

Figura 3.21 : (a) imagem de poro com aproximação onde se pode observar 

o efeito de serrilhamento . (b) imagem das bordas da imagem (a) . (c) imagem 

das bordas sobreposta a imagem interpolada . (d) imagem resultante com 

.......................................................... suavização do efeito de serrilhamento 86 

................... Figura 3.22 : Processo de vetorização das imagens dos poros 87 

Figura 3.23 : Fluxo de dados do processo para achar círculos inscritos 

...................................................................... usando-se correlação por FFT 87 

Figura 3.24 : Processo de correlação no domínio da freqüência de duas 

........................................................................................................ imagens; 88 

...................................... Figura 3.25. Pseudocódigo da FFT unidimensional 89 

........................................ Figura 3.26. Pseudocódigo da FFT bidimensional 89 

.................... Figura 3.27 : Processo de vetorização otimizado por Wavelets 90 

Figura 3.28: pseudocódigo para a implementação da Transformada 



Wavelets de uma imagem bidimensional. ..................................................... 91 

Figura 3.29: pseudocódigo para a implementação da Transformada 

Wavelets unidimensional baseada na função básica wavelet Haar. ............. 91 

Figura 3.30: pseudocódigo para a implementação da Transformada 

Wavelets Inversa de uma imagem bidimensional .......................................... 92 

Figura 3.31: pseudocódigo para a implementação da Transformada 

Wavelets Inversa unidimensional baseada na função básica wavelet Haar.. 92 

Figura 4.1: Diagrama esquemático da distribuição de Ca, P, AI, e Plexiglass 

na composição do phantom estudado. .......................................................... 96 

Figura 4.2 : Phantom heterogêneo reconstruído por retroprojeção filtrada. 

(Imagem em 256 níveis de cinza) .................................................................. 97 

Figura 4.3 : Imagem original do phantom heterogêneo na resolução 81x81 

pixels (CORP025.IMG). ................................................................................ 99 

Figura 4.4: Imagem do phantom heterogêneo rearranjada para de 81x81 

para a resolução padrão de 400x400 pixels. ............................................... 100 

Figura 4.5: Imagem do phantom heterogêneo (CORP025.IMG) submetida a 

filtro tipo "threshold" com valor 11 0 segmentando alguns poros. ................ 100 

Figura 4.6: Imagem do phantom heterogêneo (CORP025.IMG) segmentada 

após processamento por filtro laplaciano, tendo suas bordas destacadas.. 101 

Figura 4.7: Imagem do phantom heterogêneo (CORP025.IMG) após os 

processamentos de vetorização das conexões 90 graus, pré-processamento 

por Wavelets Haar e interpolação por B-Wavelets. ..................................... 101 

Figura 4.8: Imagem do phantom (CORP025.1MG) representado apenas 

pelo resultado da interpolação B-Wavelets. . . .. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 102 
Figura 4.9: Imagem do phantom heterogêneo (CORPO25.IMG) suavizada e 

reconstituída. . ..... . . . . ... ..... ..... . . ......... ......... . . . . . . .. . . . .. ...... . ..... . . ..... . . ....... .. . . ... .... 102 
Figura 4.10: Imagem do phantom heterogêneo (CORP025.IMG) com o 

resultado da vetorização em destaque. ................ . .. . . .... . . . ... . . . ... . . . . ....... ... . . . . 103 

Figura 4.1 1 : Imagem original do phantom heterogêneo na resolução 49x49 

pixels (CORP037.IMG). ... .................... . ................ . . .. ..... ..... . . ..... . .. ...... . . . . . . . . 103 

Figura 4.12: Imagem do phantom heterogêneo (CORP037.IMG) rearranjada 

de 49x49 pixels para a resolução padrão de 400x400. ............................... 104 

Figura 4.13: Imagem do phantom heterogêneo (CORP037.IMG) submetida 



a filtro tipo "threshold" com valor 110. ......................................................... 104 

Figura 4.14: Imagem do phantom heterogêneo (CORP037.IMG) após 

processamento por filtro laplaciano com suas bordas destacadas .............. 105 

Figura 4.15: Imagem do phantom (CORP037.IMG) após os processamentos 

de vetorização das conexões 90 graus, pré-processamento usando Wavelets 

Haar e interpolação por B-Wavelets. ........................................................... 105 

Figura 4.1 6: Imagem do phantom heterogêneo (CORP037.IMG) 

representado apenas pelo resultado da interpolação. ................................. 106 

Figura 4.17: Imagem do phantom (CORP037.IMG) suavizada e 

reconstituída. ............................................................................................... 106 

Figura 4.18: Imagem do phantom (CORP037.IMG) com o resultado da 

vetorização. ................................................................................................. 107 

Figura 4.19 : Imagem original do phantom heterogêneo na resolução 25x25 

pixels (CORP075.IMG). .............................................................................. 107 

Figura 4.20: Imagem do phantom heterogêneo (25x25) rearranjada para a 

resolução padrão de 400x400 pixels. .......................................................... 108 

Figura 4.21: Imagem do phantom heterogêneo (25x25) submetida a filtro 

tipo "threshold" com valor 1 10 segmentando alguns poros. ........................ 108 

Figura 4.22: Imagem do phantom heterogêneo (25x25) segmentada após 

processamento por filtro laplaciano e tendo suas bordas destacadas. ....... 109 

Figura 4.23: Imagem do phantom heterogêneo (25x25) após os 

processamentos de vetorização das conexões 90 graus, pré-processamento 

.............................. usando Wavelets Haar e interpolação por B-Wavelets. 109 

Figura 4.24: Imagem do phantom heterogêneo (25x25) representado apenas 

................................................ pelo resultado da interpolação B-Wavelets. 11 0 

Figura 4.25: Imagem do phantom heterogêneo (25x25) suavizada e 

............................................................................................... reconstituída. I I O 

Figura 4.26: Imagem do phantom heterogêneo suavizada com o resultado da 

vetorização em destaque. ........................................................................... I I I 

Figura 4.27 : Imagem original do phantom heterogêneo na resolução 13x13 

pixels (CORPO1 5.IMG). .............................................................................. I I I 

Figura 4.28: Imagem do phantom heterogêneo (1 3x1 3) rearranjada para a 

.......................................................... resolução padrão de 400x400 pixels. 1 12 



xvii 

Figura 4.29: Imagem do phantom heterogêneo (13x13) submetida a filtro 

tipo "threshold" com valor 1 10 segmentando alguns poros. ........................ 1 12 

Figura 4.30: Imagem do phantom heterogêneo (1 3x1 3) segmentada após 

processamento por filtro laplaciano e tendo suas bordas destacadas. ....... 1 1 3 

Figura 4.31: Imagem do phantom heterogêneo (13x13) após os 

processamentos de vetorização das conexões 90 graus, pré-processamento 

usando Wavelets Haar e interpolação por B-Wavelets. .............................. 11 3 

Figura 4.32: Imagem do phantom heterogêneo (1 3x1 3) representado apenas 

pelo resultado da interpolação B-Wavelets. ................................................ 1 14 

Figura 4.33: Imagem do phantom heterogêneo (1 3x1 3) reconstituída. ....... 114 

Figura 4.34: Imagem do phantom heterogêneo (13x13) suavizada com o 

resultado da vetorização em destaque. ....................................................... 1 15 

Figura 4.35 : Imagem de amostra de solo reconstruída por retroprojeção 

filtrada. (Imagem em 256 níveis de cinza). .................................................. 1 17 

Figura 4.36 : Imagem original de amostra de solo na resolução 22x22 pixels 

............................................................................................... (SOLO.IMG). 11 9 

Figura 4.37: Imagem da amostra de solo rearranjada de 22x22 para a 

resolução padrão de 400x400 pixels. ........................................................ 11 9 

Figura 4.38: Imagem de amostra de solo (SOLO.IMG) submetida a filtro tipo 

............................... "threshold" com valor 11 0 segmentando alguns poros. 120 

Figura 4.39: Imagem de amostra de solo (SOLO.IMG) segmentada após 

......... processamento por filtro laplaciano, tendo suas bordas destacadas. 120 

Figura 4.40: Imagem do amostra de solo (SOLO.IMG) após os 

processamentos de vetorização das conexões 90 graus, pré-processamento 

..................................... por Wavelets Haar e interpolação por B-Wavelets. 121 

Figura 4.41: Imagem de amostra de solo (SOLO.IMG) representada apenas 

................................................ pelo resultado da interpolação B-Wavelets. 121 

Figura 4.42: Imagem de amostra de solo (SOLO.IMG) suavizada e 

................................. reconstituída, tendo apenas o maior poro destacado. 122 

Figura 4.43: Imagem de poro em amostra de solo (SOLO.IMG) com o 

resultado da vetorização em destaque. ....................................................... 122 

Figura 4.44 : Gráfico de distribuição das quantidades pelos tamanhos de 

............. raios dos círculos inscritos, em pixels, resultantes da vetorização. 123 



xviii 

Figura 4.45 : Imagem original de amostra de solo na resolução 22x22 pixels 

(U3. IMG). . . . ......... . . . . . . . . . . . . . ........ . . ..... ........ . . .............. ... . . ..... . . . .... . . . . . . .............. 124 

Figura 4.46: Imagem da amostra de solo (U3.1MG) rearranjada de 22x22 

para a resolução padrão de 400x400 pixels. ............................................... 124 

Figura 4.47: Imagem de amostra de solo (U3.1MG) submetida a filtro tipo 

"threshold" com valor 11 0 segmentando alguns poros. ............................... I 2 4  

Figura 4.48: Imagem de amostra de solo (U3.1MG) segmentada após 

processamento por filtro laplaciano, tendo suas bordas destacadas. .. ... . . . . 125 

Figura 4.49: Imagem do amostra de solo (U3.1MG) após os processamentos 

de vetorização das conexões 90 graus, pré-processamento por Wavelets 

Haar e interpolação por B-Wavelets. ........................................................... 125 

Figura 4.50: Imagem de amostra de solo (U3.1MG) representada apenas 

pelo resultado da interpolação B-Wavelets. ........... .. . . .... . . . . .... . . . ........ . . . .. . ... . 126 

Figura 4.51: Imagem de amostra de solo (U3.1MG) suavizada e 

reconstituída. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . , . . . . 126 
Figura 4.52: Imagem de poro em amostra de solo (U3.1MG) com o resultado 

da vetorização em destaque. . ....... . ....... . . .............. . . . ....... . ..... . . . ...... .. . . . . . . . . . . . 127 

Figura 4.53: Distribuição dos centros e raios resultantes da vetorização dos 

poro segmentado da amostra de solo (U3.IMG). ........................................ 128 

Figura 4.54 : Imagem original de amostra de solo na resolução 22x22 pixels 

(U6. IMG). ....... . . ......................................... . . .. . . . . . . . . ....... . . . .... . ....,. . . . ........... .. . . 128 

Figura 4.55: Imagem da amostra de solo (U6.IMG) rearranjada de 22x22 

para a resolução padrão de 400x400 pixels. ............................................... 128 

Figura 4.56: Imagem de amostra de solo (U6.IMG) submetida a filtro tipo 

"threshold" com valor 11 0 segmentando alguns poros. ............................... 129 

Figura 4.57: Imagem de amostra de solo (U6.IMG) segmentada após 

processamento por filtro laplaciano, tendo suas bordas destacadas. ......... 129 

Figura 4.58: Imagem do amostra de solo (U6.IMG) após os processamentos 

de vetorização das conexões 90 graus, pré-processamento por Wavelets 

Haar e interpolação por B-Wavelets. ......... .. . . . . . . . .. ....... . . ...... . ...... . . .. ............. 130 
Figura 4.59: Imagem de amostra de solo (U6.IMG) representada apenas 

pelo resultado da interpolação B-Wavelets. .. .. .......... . . ...... . . ..... . . . ........ . . . . . . . . 130 

Figura 4.60: Imagem de amostra de solo (U6.IMG) suavizada e 



reconstituída, tendo apenas o maior poro destacado. ................................. 131 

Figura 4.61: Imagem de poro em amostra de solo (U6.IMG) com o resultado 

da vetorização em destaque. ...................................................................... 131 

Figura 4.62: Distribuição dos centros e raios resultantes da vetorização dos 

poro segmentado da amostra de solo (U6.IMG). ........................................ 132 

Figura 4.63 : Imagem original de amostra de solo na resolução 22x22 pixels 

(U9.lMG). ..................................................................................................... 132 

Figura 4.64: Imagem da amostra de solo rearranjada de 22x22 para a 

resolução padrão de 400x400 pixels (U9.IMG). .......................................... 133 

Figura 4.65: Imagem de amostra de solo (U9.IMG) submetida a filtro tipo 

"threshold" com valor 11 0 segmentando alguns poros. ............................... 133 

Figura 4.66: Imagem de amostra de solo (U9.IMG) segmentada após 

processamento por filtro laplaciano, tendo suas bordas destacadas. ......... 1 34 

Figura 4.67: Imagem do amostra de solo (U9.IMG) após os processamentos 

de vetorização das conexões 90 graus, pré-processamento por Wavelets 

Haar e interpolação por B-Wavelets. ........................................................... 134 

Figura 4.68: Imagem de amostra de solo (U9.IMG) representada apenas 

pelo resultado da interpolação B-Wavelets. ................................................ 135 

Figura 4.69: Imagem de amostra de solo (U9.IMG) suavizada e 

reconstituída, tendo apenas o maior poro destacado. ................................. 135 

Figura 4.70: Imagem de poro em amostra de solo (U9.IMG) com o resultado 

...................................................................... da vetorização em destaque. 136 

Figura 4.71: Distribuição dos centros e raios resultantes da vetorização dos 

........................................ poro segmentado da amostra de solo (U9.IMG). 137 

Figura 4.72: Gráfico com os histogramas sobrepostos das distribuições dos 

raios das amostras de solo. Seqüência1 indica os resultados de SOLO.IMG; 

Seqüência 2 de U3.IMG; Seqüência 3 de U9.IMG e Seqüência 4 de U6.IMG.137 



Lista de Tabelas 

Tabela 1 . I :  Variação da porosidade e da densidade de amostras de solos 

minerais. .......................................................................................................... 6 

Tabela 2.1 : Processo de decomposição por Wavelets em várias resoluções53 

Tabela 4.1: Distribuição dos centros e raios resultantes da vetorização dos 

poros segmentados do phantom heterogêneo. ........................................... 103 

Tabela 4.2 : Distribuição dos centros e raios resultantes da vetorização dos 

poros segmentados do phantom heterogêneo 49x49. ................................ 107 

Tabela 4.3 : Distribuição dos centros e raios resultantes da vetorização dos 

poros segmentados do phantom heterogêneo 25x25. ................................ 11 1 

Tabela 4.4 : Distribuição dos centros e raios resultantes da vetorização dos 

poros segmentados do phantom heterogêneo 13x1 3. ................................ 1 15 

Tabela 4.5 : Valores das colunas (Cx), linhas (Lx) e raios (Rx) em função das 

colunas, linhas e raios da imagem de maior resolução ( C I ,  L1 e R I ) .  A 

função E é dada por E(a,b) = (b-a)/a. .......................................................... 1 16 

Tabela 4.6 : Distribuição dos centros e raios resultantes da vetorização dos 

................................... poro segmentado da amostra de solo (SOLO.IMG). 123 

Tabela 4.7 : Distribuição dos centros e raios resultantes da vetorização dos 

........................................ poro segmentado da amostra de solo (U3.IMG). 127 

Tabela 4.8 : Distribuição dos centros e raios resultantes da vetorização dos 

........................................ poro segmentado da amostra de solo (U6.IMG). 132 

Tabela 4.9 : Distribuição dos centros e raios resultantes da vetorização dos 

........................................ poro segmentado da amostra de solo (U9.IMG). 136 



1. Meios porosos e a Tomografia de 

Neste capítulo são descritos os principais aspectos físicos envolvidos no 

contexto da formação de imagens por Raios-X e são apresentados 

fundamentos sobre meios porosos e tomografia computadorizada. 



IFSC-USP MINATEL, E R MODELO COMPUTACIONAL BASEADO E M  T ~ C N I C A S  WAVELETS PARA RELACIONAR IMAGENS DIGITAIS OBTIDAS E M  DIFERENTES ESCALAS E RESOLUÇÕES 
2 

1 .I. Meios porosos 

Um "poro" pode ser objetivamente definido como sendo a parte do solo que 

não é preenchida pela parte sólida. A forma, o tamanho e a origem dos 

poros determinam a classificação de sistemas de solos porosos. Nesse 

contexto, pode-se afirmar que todos os processos de transporte e 

armazenamento de líquidos ou gases ocorrem em meios porosos. 

A porosidade do solo é determinada pelo volume relativo dos poros e 

equacionada da seguinte forma: 

Equação 1.1 

onde V,é o volume dos poros e V, o volume total da amostra de solo. 

Quando a Equação 1 .I é multiplicada por 100, obtém-se o valor de P como 

porcentagem. A relação entre o volume dos poros V, e a parte sólida do 

volume de solo V ,  é dada por 

Equação 1.2 

com relações mútuas entre P e e sendo 

Equação 1.3 

A relação apresentada em Equação 1.3 é mais apropriada que a da 

porosidade se o termo de referência V, não for constante como por 

exemplo no barro quando ele sofre inchação ou encolhimento. 

O tamanho de deve ser definido de forma apropriada e pode ser 



obtido pelo seguinte tratamento teórico. Observando-se a Figura 1.1 

assume-se que, quando VT é suficientemente pequeno (V,.&amp;lt;V,, ) e centrado 

em um poro, P = 1. Quando Kr é centrado na fase sólida e suficientemente 

pequeno (V,. .: V,), P = O. Quando V,. tem seu valor aumentado, observa-se a 

situação na qual Kl. = (V, + 6V,) ou V,.= (V, + 6Vp) e a porosidade não é 1 

nem 0. Centrando VT na fase sólida, o valor de P é aproximadamente um 

pouco acima de zero. Com um incremento gradual em Kr obtém-se primeiro 

um gradativo decremento de P (centrado em um poro) ou um incremento 

gradual de P (centrado na fase sólida) até que ambos valores coincidam. 

Antes que essa coincidência ocorra, uma oscilação de P pode existir. Nesse 

estágio de incremento de V,. quando a porosidade é independente da 

centralização inicial de V,, nos temos determinado o REV (Representative 

Elementary Volume) [BEAR-1968, 1969, 19721. 

Esse volume final de K é chamado por Corey [COREY- 

1963,1977,1985] como Volume Mínimo de um Elemento de Referência. Se 

K1. = REV, transladando o centro de V, não se altera o valor de P .  O 

conceito de REV é um importante método de determinação prática da 

porosidade bem como a aplicação da teoria de fluxo potencial para a 

descrição do fluxo de água em solos. Solos sem desenvolvimento estrutural 

tem um REV em torno de 100 cm3 ou menos. Devido ao REV de solos 

agregados depender do tamanho e forma de seus (peds), seu valor pode ser 

uma ou mais ordens de magnitude maiores. 

A porosidade do solo manifesta um grande escopo de valores 

variando entre 0.3 a mais de 0.9. No entanto, na maioria dos solos minerais, 

P se encontra entre 0,4 e 0,6. Alguns solos orgânicos tem seus valores de 

P ultrapassando 0,9. A porosidade depende da composição, textura e 

estrutura do solo. A estrutura do solo é influenciada por conter matéria 

orgânica , a quantidade de agentes de cimentamento inorgânico, o gênese 

do solo e seu horizonte e mais recentemente, pelas atividades humanas. 



Teoricamente, o mais denso agrupamento de partículas esféricas de 

mesmo tamanho, P = 0,26. Embora esse valor seja algumas vezes tido 

como a mínima porosidade teórica de areia, até mesmo solos arenosos são 

misturas de partículas de vários tamanhos e formas. Hartge reviu misturas 

secundárias e terciárias de partículas com diversas formas e tamanhos 

[HARTGE-I 9781. 

No caso de areias não são aplicáveis modelos geométricos dos 

arranjos de partículas para o estudo de porosidade. 

Com um incremento do conteúdo de barro a porosidade do solo decai, 

devido principalmente a grande probabilidade de agregação do solo. Para 

solos não intensivamente cultivados, os valores médios de porosidade no 

Horizonte-A e subsolo são mostrados versus textura na Figura 1.2. A 

porosidade do Horizonte-A encontra seu valor máximo em solos argilosos 

devido a condições ótimas de agregação. 

No barro, a tendência para o "empastamento" leva a um desprezível 

decremento de P .  Os dados para o gráfico foram pesquisados por Janota 

em 1924 e foram analisados por Kutílek em 1978 [KUT~LEK-1 962 a 19941 . 

O uso de maquinário pesado, aplicação de fertilizantes em grande 

quantidade e a redução de material orgânico nos solos - características 
específicas da agricultura intensiva dos tempos modernos - reduziram a 

agregação e aumentaram a compactação do solo. Dessa forma, a 

porosidade da maioria dos solos cultiváveis não depende da textura do solo. 

A variação dos valores de porosidade encontrada nas quatro maiores 

categorias de texturas de solos minerais, de acordo com Schachtschabel é 

dada na Tabela 1.1. Exceto para solos barrosos, a textura não influencia 

significativamente a porosidade. Em solos barrosos originados por lavas 

vulcânicas os quais são classificados como Andosols, a porosidade tem 

valores extremos entre 0,7 e 0,8. [SCHACHTSCHABEL-19841 



IFSC-USP . MINATEL. E R . MODELO COMPUTACIONAL BASEADO E M  T~CNICAS WAVELETS PARA RELACIONAR IMAGENS DIGITAIS OBTIDAS E M  DIFERENTES ESCALAS E RESOLUÇbES 
5 

CENTRO DE vT PORO S ~ L I D O  

u 

&gt;o VOLUME DA AMOSTRA V T  
REV 

CENTRADO NO PORO 

/-IC+, 
- = -  / / I 

,/ CENTRADO NO S ~ L I D O  I 
0 I 

r iyui a I .  I . csiir i iarjau uu KE v (nepreseriraove r~ernensaw vorume) pelo 

incremento do volume da amostra de solo V, até que a porosidade seja 

independente da posição onde Er está centrado. 



IFSC-USP - MINATEL E R - MODELO COMPUTACIONAL BASEADO E M  T ~ C N I C A S  WAVELETS PARA RELACIONAR IMAGENS DIGITAIS OBTIDAS E M  DIFERENTES ESCALAS E RESOLUÇÓES 
6 

Figura 1.2: Texturas da superfície e do subsolo de solos do centro da Europa 

em termos de porosidade P no início do século 20. 

Tabela 1 . I :  Variação da porosidade e da densidade de amostras de solos 

minerais. 

Tipo do solo 

Arenoso 

Sedimentos0 

Barroso 

Argiloso 

Em alguns solos barrosos e argilosos, P depende do conteúdo de 

água na terra 8 já que o solo "incha" quando molhado e "encolhe" quando 

seco. Em cada solo P aumenta com 8 como mostrado na Figura 1.3. Esta 

relação é linear para valores altos de 8. Para valores baixos de 8, P muda 

de forma não-linear com 8. 

No perfil do solo, a porosidade máxima normalmente ocorre no topo 

do horizonte A,. A distribuição da porosidade na profundidade do solo 

depende do desenvolvimento do perfil desse solo. Por exemplo, no horizonte 

Bt de solo aluvial material acumulado causa um decremento na porosidade. 

Ou, a redução de óxido de ferro e a destruição da estrutura em horizontes 

hidromórficos G conduzem a uma diminuição abrupta da porosidade. 

Porosidade P (%) 

56 - 36 

56 - 39 

55 - 30 

70 - 35 

Densidade p,. ( g . c m 3  ) 

1.16 - 1.70 

1.26 - 1.61 

1.20 - 1.85 

0.88 - 1.72 



ZERO 
I 

RESIDUAL 
I 

NORMAL ESTRUTURAL 
I 

I 
I 
I 
I 
I 
I 
I 
I I I 

@ = o  I o d Q . 1  I f l = 1  I @ = o  
d e  

I 
de 

I 
d e  

I 
d e  

VOLUME DE AGUA V, 
RAZAO AGUA SOLO 19 
CONTEUDO DE KGUA NO SOLO 9 

Figura 1.3: Dependência da porosidade P do conteúdo de água 8 em solos 

encharcados. Quatro domínios são definidos em [HAINES-19231 e 

modificados em [YULE-19801. 

A porosidade em solos orgânicos é maior que em solos minerais e 

alcança valores máximos em baixo pântano altamente decomposto. Com o 

aumento de substâncias minerais a porosidade decai em solos orgânicos. 

1 .I .I. Classificação de poros 

De acordo com [COREY-19771, a classificação de poros em solos poderia 

seguir as leis da hidrostática e hidrodinâmica e adotariam três categorias: 

Poros sub microscó~icos - são tão pequenos que formam clusters com 
moléculas de água para formar partículas fluidas ou caminhos contínuos de 

fluxo de água. As leis da mecânica dos fluidos não são aplicáveis pois a 

convecção não existe nesses poros. Poros inclusos nessa categoria são 

frequentemente ignorados. 



Poros capilares - quando a forma da interface entre o ar e a água é 
determinada pela configuração dos poros ou pelas forças sobre a interface. 

A interface ar-água resultante é chamada de meniscos capilares. O fluxo de 

água nesses poros é considerado com sendo laminar e dominante em solos. 

Macroporos (Poros não-capilares) - poros de tamanho que não permite a 

formação dos meniscos capilares. A forma da interface entre ar e água é 

considerada planar, e portanto, forças capilares são nulas. O fluxo de água 

dentro de cada poro pode ser na forma de um filme movendo-se sobre todas 

as irregularidades do muro induzido pela rugosidade e forma, ou em alguns 

casos, fluxos turbulentos quando os poros contêm consideravelmente mais 

água. A forma dos macroporos é geralmente imaginada como tubular ou 

planar. A forma tubular é originada pela ação da fauna do solo (como 

minhocas) ou causadas depois da ação de raízes das plantas. Poros 

planares tem a forma de rachaduras e fissuras devidas principalmente as 

mudanças de volume da terra quando ela seca [BEVEN-19821. 

Embora o volume relativo dos macroporos ser muito pequeno, ele 

pode ter grande impacto relativo ao fluxo de água e seus constituintes 

dissolvidos em um perfil de solo. 

Na literatura de ciência e física de solos os poros capilares na 

segunda categoria são frequentemente subdivididos de acordo com critérios 

da hidrostática bem como por aspectos práticos da agricultura. Poros 

contendo água abaixo do ponto de "murchamento" permanente de plantas 

são designados com poros finos. Os poros com água entre o ponto de 

murchamento e capacidade do campo são poros médios. São chamados de 

poros grandes os poros que estão acima da capacidade do campo. 

Outras subdivisões de poros em solos são normalmente baseadas em 

particulares pressões hidráulicas e raios de poros equivalentes. O tamanho 

dos poros podem ser definidos por dois aspectos: i) O máximo raio de uma 

esfera inscrita no poro. A definição é aplicável somente a poros onde os três 



IFSC.USP - MINATEL. E R . MODELO COMPUTACIONAL BASEADO E M  TECNICAS WAVELETS PARA RELACIONAR IMAGENS DIGITAIS OBTIDAS EM DIFERENTES ESCALAS E RESOLUÇÓES 
9 

principais eixos são de tamanhos aproximados. Ou, a poros tendo forma 

tubular e os raios dos círculos inscritos são dados com raios dos poros. Para 

ambos, a visualizaçáo dos poros é requerida. ii) A igualdade do 

comportamento de um parâmetro hidráulico em um modelo de capilares 

segue a definição de raios equivalentes em solos reais. 

Em ciência de solos, dois termos são usados para descrever a 

porosidade do solo - porosidade primária e porosidade secundária. A 

porosidade primária denota o volume relativo dos poros devido a forma e 

tamanho de partículas primárias. A porosidade secundária denota a ação de 

outros fatores como a forma tubular de poros depois da passagem de raízes 

de plantas, ou fissuras resultantes da secagem do solo que incham e 

encolhem. Dessa forma, [KATCHINSKI-19651 define a porosidade agregada 

P, e a porosidade inter-agregrada P, em termos da porosidade média de 

agregados individuais como 

Equação 1.4 

PB = P - P, 

Equação 1.5 

respectivamente. Os termos poros intrapedal e poros interpedal são algumas 

vezes utilizados para P ,  e P, , respectivamente. 

1.1.2. Métodos de medida de porosidade 

Métodos de medida de porosidade são baseados na determinação de V, e 

E,. como definido anteriormente. O método da densidade vem da seguinte 

expressão: 



Equação 1.6 

onde p, [ =  m, . . c m " ) ]  é a densidade média das partículas sólidas do 

solo, p, [ =  m, . cm-')I a densidade da amostra de solo, m, a massa da 

fase sólida do solo (usualmente tida como o peso do solo seco a 105OC para 

solos minerais), V, o volume da parte sólida medida e Ií,. o volume do 

núcleo de amostragem ou o volume da água deslocada quando o agregado 

é coberto com parafina e submergido em água. Em solos pedregosos, Kr é 

medido pelo volume do preenchimento graduado de areia no buraco de cada 

amostra de solo obtida para secagem ou umedecimento. Valores de p ,  para 

solos minerais variam de 2.6 a 2.7 g . ~ r n - ~ ,  a densidade do quartzo que é 

normalmente um dos principais constituintes da maioria dos solos. Na 

maioria dos solos orgânicos como nos pântanos, valores de p, abrangem 

uma grande variação entre 0.2 para cerca de 1 .O g . ~ m - ~ .  Para esses solos 

orgânicos, o valor de p, geralmente decresce a medida que o nível de 

decomposiçáo da matéria orgânica aumenta. 

Métodos ópticos são usados quando os poros do solo são visíveis. 

Esta visualização é alcançada pelo preenchimento dos poros com um 

material inicialmente fluido que se torna subsequentemente sólido. A matriz- 

solo resultante é então fixada em regiões de partículas de solos e um 

material contrastante demarca regiões do espaço dos poros. Finas regiões 

da matriz fixada de solo subsequentemente produzidas revelam que a área 

dos poros A,, medida com técnicas de microfotografia, é relacionada com a 

área total examinada A,. A porosidade é estimada por se assumir a 

igualdade dos arranjos bi e tridimensionais que leva a 

- 
v 4-2 

A,. V, 

Equação 1.7 



Para medir A,,, é usado o método das secantes ou o método Monte 

Carlo. O princípio do método é aplicado para a descrição do sistema de 

macroporos. Os macroporos impregnados são contados através da análise 

de imagens [RINGROSE-19841. 

Nos métodos volumétricos, procedimentos para medida do volume do 

líquido de preenchimento dos poros apresentam-se como os mais simples 

para se obter um valor de V,. Este conceito simples apresenta dificuldades 

práticas como quando há a presença de bolhas de ar, alterações do solo 

quando ele passa por processo de secagem, mudanças de volume da matriz 

de solo causadas pela secagem ou molhamento. Se um líquido não solúvel 

em água é usado. como mercúrio, o arranjo resultante não permite que 

sejam usadas determinadas pressões. Outra alternativa para o método 

volumétrico é a medida da pressão do gás com o solo seco antes e depois 

do contato com o conhecido volume desse gás. A lei de Boyle-Mariotte é 

usada para calcular V,. As mudanças de volume que acompanham a 

completa secagem do solo são atributos que tornam esse método 

desvantajoso. 

Métodos indiretos são baseados na medida de propriedades físicas 

particulares do solo dependendo sobretudo da densidade ou porosidade da 

amostra. Eles são vantajosos pela rapidez em se estimar a mudança de P 

no espaço e no tempo. Por exemplo, a resistência mecânica do solo medida 

por penetrômetros fornece informações sobre a variação de P se o 

conteúdo de água no solo for constante. Os valores de referência de P 

poderiam ser conhecidos em um determinado ponto ou tempo. A atenuação 

da radiação Gamma e métodos de espalhamento fornecem dados muito 

mais precisos. 

1 .I .3. Porosidade em solos 

Nos solos, os poros variam em forma e em tamanho e manifestam uma 

típica treliça interconectada para cada tipo de solo, solo horizonte, atividade 

biológica e atividade humana. Os tamanhos reais dos poros, sua 



continuidade e suas formas são visualizados microscopicamente em finas 

secçóes de solos [KUBIENA-1970, WILDING-19841. A Tomografia 

Computadorizada (CT) [CRESTANA-1986, STEUDE-1994, CRUVINEL- 

1987,19901, a Ressonância Magnética Nuclear (NMR) [LIU-19941 e Estéreo 

Radiografias por Raios-X [TOKUNAGA-19881 permitem uma nova 

abordagem na análise de redes tridimensionais de poros. 

A CT e NMR produzem imagens de fatias com finita espessura de 

uma amostra de solo. Se há um suficiente número de sucessivas fatias na 

direção do eixo perpendicular, uma imagem tridimensional pode ser obtida. 

Dessa forma, como ambas essas técnicas são não-invasivas e não 

prejudicam a integridade do solo, podem ser aplicadas repetidas vezes para 

obtenção de medidas em um mesmo pedaço em análise. 

A CT utiliza fontes de alta energia de Raios-X com o raio sendo 

detectado após passar através do plano do corpo do solo. Este método é 

descrito neste trabalho com detalhes abaixo. A resoluçao de um 

equipamento médico típico de CT que utiliza baixa energia de Raios-X é na 

ordem de décimos de milímetros. O elemento de volume (voxel) dos CT 

médicos estão em torno de 0.5mm3. Devido a fase sólida dos solos 

atenuarem os Raios-X de forma mais intensa que o corpo humano, para 

análise de solo são recomendadas energias maiores para gerar menores 

voxels. CT industriais têm voxels na ordem de 0.01 mm3. Um típico CT 

synchrotron com resolução de ,um3 pode ser usado para se estudar 

finíssimas camadas e meniscos em solos [SPANNE-19941. 

Espectroscópios-NMR e técnicas de imageamento utilizam potentes 

magnetos para reorientar os núcleos dos átomos desemparelhados com 

prótons e nêutrons. Os átomos desprendem energia após removido o campo 

magnético. Na prática, os núcleos emitem um pulso magnético que permitem 

medir o sinal de radio freqüência característico daquele átomo. O sinal é 

relacionado com o Hidrogênio presente na água contida na amostra de solo 

em análise. Devido a grande sensibilidade da NMR a muitos núcleos de 



momento angular não zero do spin, um indesejável ruído acompanha a 

detecção do Hidrogênio. Partículas ferro-magnéticas são causas de outras 

anomalias inerentes ao processo. NMR é usada principalmente para a 

detecção de poros preferenciais, suas continuidades e para medidas da 

velocidade dos fluxos através dos poros. A resolução do NMR é de décimos 

de mm. 

A forma e a distribuição dos poros nos solos podem também ser 

quantificadas pela aplicação da Teoria dos Fractais e por métodos 

quantitativos de Estereometria. 

1.2. Tomografia Computadorizada 

Os princípios físicos que norteiam a tomografia de transmissão estabelecem 

que quando um feixe de Raio-X monoenergético de energia E ,  e 

intensidade N o  atravessa uma corpo-amostra, o feixe de saída (recebido 

pelo detector) é dado por: 

N = N,e-' 

Equação 1.8 

para amostras não homogêneas, o feixe de saída é dado aproximadamente 

por: 

- J , P ( s ) ~  
N = N,e 

Equação 1.9 

Na Equação 1.9, S representa a coordenada espacial e ,u é o 

coeficiente de atenuação da amostra, no ponto considerado, atravessada 

pela radiação. 

O advento dos computadores incentivou o desenvolvimento de 

algoritmos de reconstrução [GAARDER-19721 criando a Tomografia 

Computadorizada (CT-Computerized Tomography). 

Comparações entre técnicas de reconstrução de imagens 



tomográficas por computador foram feitas [DEHNERT-19731 procurando a 

melhor solução para uma determinada aplicação. Como exemplo de técnica 

de reconstrução de imagens tomográficas pode-se citar a reconstrução com 

uso de Fast Fourier Transform (FFT)[COOLEY-19651 [SHEPP-19741. 

Os estudos destas técnicas levaram ao desenvolvimento de 

algoritmos computacionais sofisticados que reconstroem uma imagem a 

partir de projeções tomográficas e também filtram os dados de forma a 

amenizar artefatos e ruídos provenientes de diversas fontes como do 

equipamento de aquisição dos dados (tomógrafo) [KALENDER-1988, 

GLICK-1989, BOULFELFEL-19941. 

Atualmente, reconstruir uma imagem a partir de projeções, de forma a 

inspecionar o interior de um objetolcorpo de forma não destrutiva, tem sido 

uma prática muito difundida na área da visualização científica. 

No estudo de solos a tomografia computadorizada se tornou um novo 

método de investigação de sua composição físico-química. Estes estudos 

foram introduzidos por Petrovic [PETROVIC-19821, Hainsworth e Aylmores 

[HAINSWORTH-1983][AYLMORE-19931 e por Crestana [CRESTANA-19861. 

Um tomógrafo de primeira geração com o tubo de Raios-X ou fonte de 

Raios-y e o respectivo detector fixo. A amostra em estudo é transladada e 

girada de forma conveniente para a obtenção das projeções atenuadas de 

um feixe de radiação em diversas posições. 

Além da fonte e do detector de Raios-X ou y, existem como 

componentes desse sistema um conjunto de colimadores cilíndricos de 

vários diâmetros, um sistema eletrônico para detecção e contagem da 

radiação (cadeia nuclear), uma mesa para o posicionamento e 

movimentação das amostras e um microcomputador destinado ao controle, 

aquisição e processamento dos dados provenientes do sistema. A cadeia 

nuclear consiste em um detector de cristal cintilador (Nal(TI)), 



fotomultiplicadora, fonte de alimentação da fotomultiplicadora de alta tensão, 

amplificador, analisador multicanal e temporizador/contador. Dois motores 

de passo compõem a mesa mecânica e são responsáveis pelo 

posicionamento relativo da amostra em estudo. 

Esses motores de passo são utilizados, portanto, para a rotação e 

translação da mesa sobre a qual está a amostra e são controlados por um 

microcomputador através de uma interface dedicada. A inicialização e a 

definição das coordenadas de posição da mesa tomográfica são 

determinadas por dispositivo optoeletrônico acoplado ao sistema. 

O feixe colimado de radiação, ou seja, o feixe com abertura de 

iluminação radioativa de diâmetro controlado pelo dispositivo colimador, 

incide e atravessa a amostra posicionada sobre a mesa. Esse feixe é 

atenuado, novamente colirnado e detectado pela cadeia nuclear. Os 

colimadores determinam a resolução desejada para o processo de 

tornografia. O conjunto de colimadores do minitomógrafo permite que 

resoluções espaciais de 1 a 6 mm2 por pixel. A Figura 1.4 ilustra 

esquematicamente os componentes do minitomógrafo. 

1.2.1. Seleção da energia 

É conveniente o uso de baixa energia de photons para se trabalhar na região 

fotoelétrica e para se ter um melhor contraste na aplicação com solos porque 

o coeficiente de atenuação é extremamente sensível a variações pequenas 

do número atômico. No entanto, algumas vezes isso é impossível dada a 

correlação entre uma boa imagem e o produto p. De fato, da Equação 1.8, 

onde o produto é muito alto, o termo e-/" é extremamente pequeno e o 

desvio padrão é muito alto. Portanto a imagem obtida é de baixa qualidade. 

Por outro lado, se p é muito pequeno, então N E No isto proporciona um 

contraste baixo. 



COLIMADOR COLIMADOR 

FONTE - - - . a: 
AMPLIFICADOR 'f 

PASSO TEMPORIZADOR 
MICRO 

COMPUTADOR 

INIERFACE 

Figura 1.4: Diagrama de blocos de tomógrafo desenvolvido por [CRUVINEL- 

19871. 

Do ponto de vista teórico, a melhor condição de resolução é obtida 

quando ,UX = 2. Por outro lado sob o ponto de vista com experimentos 

práticos, a melhor condição é obtida quando ,UX = 116. 

Por exemplo, no caso da água ou de uma amostra biológica de formato 

cilíndrico de 5 cm de diâmetro tem-se p variando na faixa de 715 a 615 o que 

corresponde a coeficientes de atenuação variando na faixa de 0.2 a 1.2 cm-' 

que correspondem a energias de 17 KeV a 60 KeV. Esta faixa de energias é 

correspondente a região fotoelétrica. A escolha da energia é, portanto, livre. 

Mas, depende da amostra no que tange espessura e composição. 

1.2.2. Detector de Raios-X 

O detector de Raios-X é um instrumento que colhe informações sobre a 

radiação que incide sobre ele. Ele pode ser caracterizado pelo tipo de 

radiação que é capaz de detectar e por diversos parâmetros como a 

resolução de energia, eficiência e resolução de tempo. 

IFSC-IISP S E R V I Ç O  D E  E ! B L I O T E C A  ~ P J F O R M A ~ A O  



op a e3!lau6ew e!3uguossa~ ep 'L-so!e~ sop 'x-o!eU leuop!peJl op 'oldwaxa 

~ o d  'ou03 saluoj sesJaA!p ap sa$ua!ua~o~d Jas wapod s a ~ 5 a r o ~ d  s v  

.oe5eu!unl! ap o!eJ op oe5e6edo~d 

ap oyu!we3 op saluadau! so~lawgied sun6le ap e!paw ewn apep!leaJ 

eu a opeuazeuiJe opep epe3 .sopep so JeuazewJe a sao5a~!p s e ! ~ y ~  
wa olaho wn Jeu!wn(! ap oe5e e e ! j e ~ 6 o u o l  as-eu!wouap 'opuez!lalu!S 

o g 5 n ~ ~ s u o 3 a l  e son!gelaJ seuialqord s!ed!3u!rd 
so a s a ~ 5 a M ~ d  ap .i!yed e suaoeui! ap oe5eui.10~ ~ ' g ' z ' ~  

.oe5e!pe~ ap atuoj ewn ap la~yya3e 

waBeluo3 ap exel ew!xew e eu!wJalap odwal ap og5nlosa~ v 'sala aJlua 
e!3u$aya$u! eley anb was uolo4 ollno ap epeJlua e a ' ~ o p a l a p  op o d ~ o 3  ou 

e y a  uolo4 wn anb oluawow o aJlua o d w a ~  ap olehiaju! o a 'e!4e~6owol e ~ e d  

aluawle!3adsa ' ~ o p a l a p  wn ap aluel.iodw! aluauiewaJva o ~ l a w p e d  w n  

.sep!lqo sua6ew! sep 

apep!lenb e opepauo3 aluawleluawepunj elsa JoleA a ~ s 3  'eJn$le e!aw e (3v) 
o3!d u n  ap eJn6Jel e ou03 ossa~dxa aluawlewdou a a e!6~aua wa oe5nlosa~ 

ap opewey3 a o ~ l a u i g ~ e d  als3 'sew!xoJd se!6~aua ap suo$oj J!n6~!lslp 

ap apeppede3 ens a iopalap wn ap s o ~ l a w e ~ e d  sa~ueyodw! s!ew sop w n  

e ! 6 ~ a u a  uia og5n(osaa - p - z - ~  

,Jopalap op e~nssadsa 

e P X  a aluap!3u! e!6~aua eu ~ o p a l a p  op le!Jalew op oe5enuale ap alua!3yao3 

o a 41 apuo .,,.a - I e leuo!3~odo~d opuas Jopalap op e~nssadsa elad epel!w!l 

a S E ! ~ J ~ U ~  selle wa e!3u9!3!4a v .Jopa$ap a aluo4 e a w a  (]e) s!e!Jaleu 
sop a Jopalap op elaue! ep epwlua eu oe5~osqe elad epeJ!w!l a ( ~ a x  ç anb 
sa~ouaw) se16~aua sex!eq wa e!3uy3!ja v .e!3u9!3ya ens e aluawe3asu!Jlu! 

au!gap O N I N  oezel e 'sopepatap oes a Jopajap atsap sowole so wo3 

wa6e~aiu! salap N a ' ~ o p a l a p  ou wequa 0g e!6~aua ap suoloj O N  opueno 



ultra-som. Com os Raios-X, por exemplo, um corpo é iluminado pelos raios 

que se propagam em linhas retas. Com base na intensidade emitida pela 

fonte de Raios-X e na intensidade captada por um detector na outra 

extremidade da reta de propagação, pode-se determinar o peso da 

atenuação devido ao objeto que se faz presente entre a fonte e o detector. 

Este peso da atenuação é um dado crucial para o processo de reconstrução, 

o qual possibilita deter um mapa de coeficientes de atenuação linear da 

secção transversal do objeto. 

Esse mapa de coeficientes é representado através de pixels (ou de 

voxels) cujos valores são dados pelos chamados números CT 

(Computerized Tomography - Tomografia Computadorizada). Esses 

números são normalizados em função do coeficiente de atenuação da água 

p H O .  Em outras palavras define-se os números CT por: 

Equação 1.10 

onde ,U é o coeficiente de atenuação nos pixels da imagem do corpo 

analisado. 

Com esse número é possível a obtenção de um mapa de coeficientes 

de atenuação, o que permite uma análise mais detalhada do corpo em 

estudo. Em Medicina convencionou-se que, para o número CT igual a O 

(zero), a área estudada pelo processo de tomografia é formada por água. Se 

positivo, o corpo possui elementos com coeficiente de atenuação mais altos 

que o da água. Se negativo, mais baixos. 

No auxilio ao diagnóstico médico, assim como no estudo de solos, 

destaca-se a tomografia computadorizada. Na CT, os dados da tomografia 

são armazenados e processados em computadores que, através de 

algoritmos apropriados para a reconstrução [GORDON-1974, LEWITT- 

19831, fornecem a imagem da secção transversal do objeto. 



Esses algoritmos, do ponto de vista matemático e computacional, 

determinam como reconstituir um objeto f(x,y) a partir dos dados 

armazenados de suas projeções em diversas direções, conforme ilustra a 

Figura 1.5. [CROWTHER-19701 [CORMAK-19731 [HOUNSFIELD-19731 

[BUDINGER-19741 [CHO-19741 [CHO-19751 

Como exemplo de modalidades de obtenção de imagens médicas 

através de emissão radioativa pode-se citar a Positron Emission 

Tomography (PET), a Single Photon Emission Tomography (SPECT) e a X- 

Ray Computerized Tomography. Essas modalidades utilizam princípios 

físicos para a extração da informações in vivo que são substancialmente 

diferentes do ponto de vista operacional. Todas as três modalidades, no 

entanto, são baseadas em métodos por integrações lineares o que 

possibilita que através de uma operação inversa, se obtenha a reconstrução 

das imagens. 

Figura 1.5: Exemplo de tomografia por transmissão. 

Para a discussão sobre reconstrução são necessárias as definições 

de alguns termos e a compreensão de alguns conceitos gerais sobre 

tomografia. O objetivo do processo de reconstrução de imagens 

tomográficas é, a partir de um objeto tridimensional f(x,y,z) , a obtenção de 

uma fatia representada por f(x,y,O) de forma não destrutiva ou não invasiva, 

ou seja, a partir da reconstrução de suas projeções. Os dados necessários 



para a reconstrução de f(x,y,O) são na realidade um conjunto de integrais ao 

longo dos raios que atravessam o objeto. A Figura 1.6 apresenta 

esquematicamente os raios pelos segmentos de reta. 

Figura 1.6: Esquema de um tomógrafo por Raios-X. 

Representado pela linha AB na Figura 1.6, encontra-se o raio que 

parte de uma fonte A e é detectado em B. A função de integração do objeto 

ao longo do raio é uma integral de linha. Cada integral de linha dos raios 

paralelos a ÃB forma uma projeção paralela. Na Figura 1.6 a fonte e o 

detector juntos são movidos seguindo as linhas L e L', respectivamente, para 

montar uma projeção paralela. As linhas L e L' formam um ângulo tl como o 

eixo x. 

Figura 1.7 : Duas projeções paralelas de um objeto matematicamente 

expresso por f(x,y). 



Usa-se assim a notação P,(t) para representar a projeção naquele 

ângulo. A posição do detector sobre a linha L é representada pela variável t. 

Na Figura 1.7 são mostradas algumas projeções paralelas formadas em 

diferentes ângulos. Com a repetição das projeções em 0 para 0 &amp;lt;8 &amp;lt;TL 

obtém-se a transformada de Radon do objeto. A transformada inversa de 

Radon fornece a imagem reconstruída do objeto [RADON-1917, KAK-19861. 

Se uma fonte de Raios-X é usada, a integral na linha é 

equivalente a integral de linha que possibilita obter o coeficiente de 

atenuação do objeto. Portanto o algoritmo de reconstrução que usa 

projeções obtidas por Raios-X reconstrói a função de atenuaçao do objeto. 

No caso de ultra-som, a imagem representa tecidos que rebatem as ondas 

de ultra-som. O tempo de um pulso de ultra-som da fonte até o detector é 

armazenado na integral de linha. O tempo de propagação através do tecido 

esta diretamente relacionado com a integral de linha do índice de refração 

do objeto. Quando um algoritmo de reconstrução é aplicado nas projeções 

por ultra-som, o resultado é uma imagem baseada no índice de refração dos 

tecidos do objeto. Na Figura 1.8 tem-se esquematizado o procedimento para 

a detenção da transformada de Radon [KAK-19861. 

I : 'e 

Figura 1.8: Projeção paralela de f(x,y) para a transformada de Radon. 



O raio A B  na Figura 1.8 no plano z=O pode ser expresso matematicamente 

Por 

r ,  = x c o s B + y s e n B  

Equação 1.11 

onde r ,  é a distância perpendicular da origem até a linha. Com o uso desta 

equação do raio, a integral do raio é dada por: 

Y."n 

P,(t,) = jf (x,y,O)dxdy = jf ( ~ , ~ , 0 ) 6 ( ~ c o s f ? +  y s e n 8 -  t,)dxdy 
roroA8 -Y.-X. 

Equação 1 . I 2  

Girando-se o eixo das coordenadas x sobre o eixo z por um ângulo 0, 

o eixo t é formado e a projeção pode ser escrita por 

Equação I .I 3 

onde r = x c o s O + y s e n B  e s =  -xsenB+ ycos8 

Com P,, ( r )  sendo uma função de t representando a projeção paralela 

com ângulo 8 , .  Para 8 contínuo, a função P,(t) é a transformada de Radon 

de f(x,y,O). As projeçdes dadas foram obtidas paralelamente a rotação no 

eixo x e nomeadas por t. A Figura 1.9 ilustra os novos eixos de coordenadas. 

Figura 1.9 : Novos eixos de coordenadas (t,s,z) gerados pela rotação de 

(x,y,z) sobre o eixo z por um ângulo 0. 



No caso tridimensional um raio pode ser descrito pela intersecção de 

dois planos, ou seja, uma vez que r, =xcosB+ ysenB, nas coordenadas 

(t,s8,r) tem-se 

r, = - ( - x s e n ~ + ~ c o s ~ ) s e n ~ + z c o s y  

Equação 1 . I 4  

Este novo sistema de coordenadas é obtido por duas rotações dos 

eixos (x,y,z). A primeira rotação a mesma do caso bidimensional, com o 

ângulo 8 com o eixo z ,  resultando no eixo (t,s,z) mostrado na Figura 1.9. A 

segunda rotação é do ângulo y com o novo eixo t., resultando em (t,s',r). 

Estas equações podem ser representadas com uso da notação matricial, na 

forma: 

O cose senB O 

O - seny cosy 

Equação I .I 5 

Uma projeção paralela tridimensional pode ser representada por 

A projeção resultante é agora bidimensional e é obtida pela integração 

das linhas paralelas no eixo s'. Assim a integral de linha pode ser 

matematicamente expressa na forma apresentada. 

1.2.7. Algoritmos para reconstrução bi e tridimensional 

O Teorema de Fourier para a secção tomográfica é a base das técnicas de 

reconstrução para a maioria dos algoritmos de reconstrução [TELLO-19861. 

A Transformada de Fourier de uma projeção paralela de uma imagem g(x,y) 

tomada de um ângulo 0 é equivalente para a fatia de uma transformada 



bidimensional de g(x,y), G ( w , , w , ) ,  subtendendo-se um ângulo O com o eixo. 

Em outras palavras, a Transformada de Fourier de P,(t) fornecem os 

valores de G ( w , , w , )  sobre a linha BB mostrada na Figura 1.10. 

Transformada de Founer 

Domínio da Frequência ~ o m i n i o  ~ s p a c i a l  

Figura 1 . I 0  : Correspondência entre espaço real e espaço recíproco como 

base para o Teorema das secções de Fourier. 

Neste teorema a Transformada de Fourier unidimensional da função 

g(x,y) é matematicamente relacionada com sua Transformada de Fourier 

bidimensional. 

O teorema diz que se diferentes projeções são armazenadas em 

diferentes posições ao redor do objeto, o objeto da Transformada de Fourier 

pode ser gerado. Se todas as projeções forem obtidas o objeto pode ser 

reconstruído diretamente pela inversão de Fourier. Na realidade a 

reconstrução não é feita desta maneira e sim algoritmos de retroprojeções 

filtradas são usados para a reconstrução por causa de suas grandes 

precisões e facilidade de implementação. O Teorema de Fourier para a 

secção tomográfica pode ser provado de forma que dado ~ ( w , , w , )  como 

sendo a Transformada de Fourier da imagem g(x,y), podendo ser 



implementada por 

Equação 1.17 

e sua inversa por: 

m  m 

S ( X ? Y )  = 5 J G ( w , , w 2 ) e  ~ 2 n ( w , x + % ~ ) ~ ~ ~ ~ ~ ~  
m - m  

Equação I . I 8  

Em seguida, considera-se os valore de G ( w , , w , )  sobre a linha 

w 2  = O no plano (o, , o 2 ) .  Da Equação 1.17, G ( ~ , , o )  é expresso como: 

Equação 1 . I 9  

A Equação 1 .I 8 é resultante de P,(t) = J g ( ~ , y ) d y  , com B = O e t=x. L I 
Pode-se observar que S , ( w )  é a transformada de Fourier da projeção 

P , ( t ) .  O resultado G ( ~ , , o )  = S , ( w , )  implica que a transformada de Fourier da 

projeção calculada perpendicular ao eixo y, &amp;amp; ( O , ) ,  é igual a transformada 

de Fourier do objeto sobre o eixo o , .  O resultado pode ser expandido para 

obter um resultado similar para O diferente de zero. Para tanto, gira-se os 

eixos de coordenadas(x,y) por um ângulo O para formar o eixo t e S. [r] ; [ C"' """ " [[I 
-sen 0 cos 

Equação 1.20 



Assim, a partir da Equação 1.18 em termos de t e s, onde g(t,s) 

representa a função do objeto no sistema de coordenadas alterado, 

chegando-se a: 

Equação 1.21 

Transcrevendo para as coordenadas (x,y) 
m m 

So(w) = J jg(x,y)dse -j(lwcosO+&gt;iwsenO)d xdy = G ( w c o s 8 ,  w s e n 8 )  

Equação 1.22 

Com o uso conveniente de coordenadas polares , ( w , 8 )  pode-se obter 

G ( w , 8 )  de forma que: 

G(w,@) = S o ( w )  

Equação 1.23 

A Transformada de Fourier da projeção Po(t) corresponde no domínio 

da freqüência os valores de G ( w , , w , )  sobre a linha BB (eixo u ) .  

1.2.8. Retroprojeção filtrada 

O algoritmo para reconstrução por retroprojeção filtrada é um dos algoritmos 

mais utilizado em aplicações que usam fontes não difrativas. Alguns fatores 

contribuíram para a ampla divulgação deste algoritmo: sua precisão, sua 

rapidez e sua facilidade de implementação. [BUENO-1996][CAÇAO-19941 

O algoritmo descrito a seguir é na realidade uma derivação do 

teorema das secções de Fourier. Este algoritmo tem uma implementação 

diferente do que o teorema básico sugere. Para iniciar a derivação se faz 

necessário o uso de coordenadas polares ( @ , O )  no plano ( w , , w , )  com 

mostrado na Equação 1.24 : 



Equação 1.24 

Usando-se G(w,B+ 180') = G(-w,Q) e t = xcos8+ ysen8 na Equação 

1.24 pode-se escrever g(x,y) com a ajuda do teorema de secções de Fourier 

e a expressão para t e m  termos de x e y ,  ou seja:. 

Equação 1.25 

Para construir (Equação 1.25) em sua forma filtrada retroprojetada é 

necessário separar a equação em duas operações diferentes. A primeira é a 

filtragem dos dados de projeção para cada ângulo 8, como se segue: 

Equação 1.26 

Depois as "projeções filtradas" são retroprojetadas para se obter a 

função objeto 

Equação 1.27 

A filtragem descrita em (Equação 1.26) seria fisicamente impossivel 

se não fosse pelo fato que as projeções serem praticamente limitadas em 

banda para a máxima frequência de W radianos/segundo. Dada a 

propriedade do teorema de Nyquist, o valor de W será utilizado como 

frequência deforma que w ,  como 

2 W &amp;lt;w ,  = 2 z l r  

Equação 1.28 



Se os dados de projeção descritos na Equação 1.29 são amostrados 

com um intervalo de amostragem z, os dados amostrados não sofreriam por 

erros de aliasing. Por fazer a limitação por banda, a Equação 1.29 pode ser 

expressa como o uso de funções de transferências de filtros, H ( @ ) ,  como se 

segue: 

H ( w )  = 
wl, I w I &amp;lt;w  
0, outros 

Equação 1.29 

A substituição de H ( w )  na Equação 1.29 fornece 

Equação 1.30 

O impulso resposta do filtro, h(t), é obtido pela transformada inversa 

de Fourier H ( w )  como descrito a seguir com o uso da Equação 1.28: 

Equação 1.31 

Versão amostrada do impulso resposta, o qual se conhece por 

filtragem digital de dados amostrados de projeções, é dado por: 

1 / 4 r 2 ,  n  = O  

h ( n r )  = n  = par 
2 2 2  - 1 l n  z r  , n  = impar 

Equação 1.32 

Por uso do teorema da convolução, a Equação 1.30 pode ser escrita 

como: 

Equação I .33 



IFSC-USP - MINATEL, E R - MODELO COMPUTACIONAL BASEADO E M  TCCNICAS WAVELETS PARA RELACIONAR IMAGENS DIGITAIS OBTIDAS E M  DIFERENTES ESCALAS E RESOLUÇOES n n 

que é implementado na forma discreta por 
- 

Q e ( n r )  = r h(nr - k r )  Pe(kr) 
k = - m  

Equação 1.34 

Na atual implementação cada projeção é finita, dando uma versão truncada 

da Equação 1.34 como sendo 

Equação 1.35 

onde P,(kr) = O para k&lt;O e k&gt;N-I. Esta filtragem dos dados de projeção 

pode ser conseguida pela convolução discreta no domínio espacial ou como 

uma multiplicação no domínio da frequência. Nesta discussão usar-se-á o 

método no domínio da frequência, o qual é mais rápido que a convolução no 

domínio espacial devido ao uso de algoritmos para FFT. O próximo 

problema encontrado é na natureza periódica do filtro implementado no 

domínio da frequência. Pode-se observar que a convolução no espaço na 

Equação 1.34 é aperiódico. A implementação no domínio da frequência 

sofreria interferências devido a intersecçóes entre períodos. Para eliminar 

este problema associado ao uso de algoritmo FFT para computar a 

convolução, as sequências de dados P,(nr) e h ( n r )  são completados com 

zeros (ZP) antes de serem transformados pela transformada de Fourier. Se 

um elemento de projeção n é completado com zeros para torná-lo com 2N-1 

elementos, ele pode ser mostrado sem interferências por interperíodos. 

Normalmente o preenchimento com zeros é necessário para deixar 

sequências de dados por potência de 2 se algoritmos de FFT por potência 

de 2 são usados. 

A implementação no domínio da freqüência, sob forma de equação, 

pode ser expressa como: 

Qe (H r )  = r x IFFT(FFT[P, ( n  r)comzP] x F F q h ( n  r ) c o m ~ ~ ] }  

Equação 1.36 



onde FFT e IFFT são as Transformadas Rápidas de Fourier e sua inversa, 

respectivamente, e ZP é o preenchimento por zero,.o que adicionalmente a 

multiplicidade de 2 também suaviza o efeito aliasing 

O passo seguinte no algoritmo de reconstrução é a retroprojeção das 

projeções filtradas que tem sua aproximação discretizada por: 

Equação 1.37 

onde K ângulos 8, são os valores discretos de O para cada P,(t) conhecido. 

Cada ponto (x,y) no processo de retroprojeção e que estejam sobre 

plano de reconstrução na linha t possui o valor Q, (t). A adição de cada 

valor de Q, (t) no ponto (x,y) com i variando de 1 até K constitui o valor do 

ponto em uma escala de n/K. O valor de Q,, (t)é uma constante sobre a 

linha LM e cada ponto no plano de reconstrução que tem o valor de Q, (t) é 

a ele adicionado. Em outras palavras, a imagem da reconstrução é gerada 

pela soma de todos os valores t de Q, (t) , para cada valor 8, , projetados e 

multiplicados por n/K. Quando o valor de t calculado não corresponde a 

algum dos valores de t na função discretizada Q,, (t) , há a necessidade de 

interpolação. Uma interpolação linear é suficiente em muitos casos. 

A obtenção de imagens tomográficas com qualidade está diretamente 

relacionada com o bom conhecimento das características dos equipamentos 

de aquisição, ou seja, do tomógrafo e de seus princípios de funcionamento. 

Antes de iniciado o processo de aquisição das projeções, fatores de 

ajuste são determinados para uma melhor obtenção dos dados. Esses 

fatores variam de equipamento para equipamento e do tipo de corpo 

estudado e suas características físicas. Por exemplo, em uma seleção de 

fatores de ajuste que possibilite a obtenção do máximo de detalhes 



IFSC-USP - MINATEL, E R - MODELO COMPUTACIONAL BASEADO EM TECNICAS WAVELETS PARA RELACIONAR IMAGENS DIGITAIS OBTIDAS EM DIFERENTES ESCALAS E RESOLUÇÓES 3 1 

possíveis geralmente reduz a visibilidade de diferenças sutis em tecidos 

"moles". 

A qualidade da imagem na aquisição depende também o perfeito 

balanço entre fatores como a exposição do paciente, o aquecimento do tubo 

de Raios-X e do tempo de aquisição. 

Em comparação com outras técnicas como a da radiografia por Raios- 

X a tomografia computadorizada geralmente possui maior contraste e maior 

sensibilidade. Entretanto, produz mais ruídos e artefatos. Na tomografia 

computadorizada cada atributo anatômico do corpo em estudos é mostrado 

diretamente e não é superposto sobre outros objetos. Isso permite que seja 

melhorado o contraste de áreas de interesse sem a interferência de 

estruturas com alto coeficiente de atenuação. 

Escalas equalizadas podem ser implementadas de forma a trabalhar o 

contraste, permitindo a melhor visualização de tecidos/corpos mais 

homogêneos, ou seja, com menor variação de contraste. [PRATT-19911 

Outro fator presente no processo de aquisição tomográfica é a 

presença de fatores de borramento. Esses fatores pode ser originados de 

diversas formas como: 

largura do raio de amostragem; 

intervalo dos raios de amostragem; 

o tamanho dos pixels e dos voxels; 

filtros de suavização usados na reconstrução. 

A largura do raio de amostragem é um dos mais significantes fatores 

que originam o borramento em uma imagem tomográfica e que limita a boa 

visualização de detalhes na mesma. A largura do raio é tecnicamente 

conhecida como abertura de amostragem - sampling aperfure. Todos os 

detalhes menores que a largura do raio são borrados no seu processo de 

medida. A abertura do detector é um dos dois fatores que influenciam na 



IFSC-USP - MINATEL, E R - MODELO COMPUTACIONAL BASEADO E M  T ~ C N I C A S  WAVELETS PARA RELACIONAR IMAGENS DIGITAIS OBTIDAS E M  DIFERENTES ESCALAS E RESOLUCÕES o m 

largura do raio. Um detector de pequena abertura produz um raio estreito 

com conseqüente baixo nível de borramento e melhores detalhes. Essa 

abertura do detector é ajustada com o uso de colimadores. 

Outro fator que influencia na largura do raio é a fonte de Raios-X. Dois 

fatores associados com a fonte influenciam a largura do raio: (I) o tamanho 

do feixe e (2) o movimento durante o intervalo de cada medida. Uma relação 

ótima para uma adequada aquisição de imagens é quando a abertura do 

detector é igual a abertura do feixe. 

O intervalo de amostragem, ou seja, a distância entre raios 

adjacentes, influencia na obtenção de detalhes. Se muito distantes, os 

detalhes entre um raio e outro são perdidos e ocorre efeito de aliasing na 

imagem reconstruída. 

O tamanho dos pixels e voxels influencia na resolução da imagem 

resultante da reconstrução. Quanto maior for o número de pixels (voxels), no 

entanto, pode ocorrer também o aparecimento de ruídos. O uso de filtros de 

suavização na tentativa de redução de ruídos pode gerar também efeitos de 

borramento com substancial redução na visibilidade de detalhes. Esses 

ruídos são gerados de diversas fontes. 

Pode-se resumir, ou classificar, os ruídos de um sistema de 

tomografia em quatro partes: 

Ruído quântico - Esse ruído se dá pela natureza estatística 
de emissão e de recepção de fótons; 

Ruído do detector - ruídos causados pela flutuação da 
temperatura e de interferências externas; 

Ruídos Pós-detector - também causados pelos motivos do 

ruído do detector; 

Ruídos de reconstrução - diretamente relacionados com o 

método de reconstrução envolvido. 



IFSC USP - MINATEL, E R - MODELO COMPUTACIONAL BASEADO EM T ~ C N I C A S  WAVELETS PARA RELACIONAR IMAGENS DIGITAIS OBTIDAS EM DIFERENTES ESCALAS E RESOLUÇOES 
33 

Na tomografia computadorizada existe também o problema da 

ocorrência de artefatos presentes na imagem da reconstrução. Como 

exemplo pode-se citar os seguintes artefatos e sua prováveis fontes: 

Riscos, traços, listras - causados pela movimentação do 
corpo, por objetos com grandes coeficientes de atenuação, pelo aliasing; 

Efeito "taça" - feixe desrregulado; 

Anéis - detector desbalanceado; 

Falta de centralização - movimentos do corpo durante a 

aquisição; 

Efeito de volume parcial - movimentos do corpo durante a 

aquisição. 

Os problemas inerentes a aquisição são, em sua maioria, tratados 

com o uso maciço da combinação de técnicas do processamento de 

imagens e sinais como: 

Filtragem - redução de ruídos; 

Restauração - recuperação de dados deslocados elou 

distorcidos; 

Equalização de histogramas - melhoramento do contraste; 

Interpolação - estimação de dados a partir dos dados 

existentes; 

Técnicas de anti-aliasing - usados para minimizar efeito 
"escada". 



IFSC-USP - MINATEL. E R MODELO COMPUTACIONALBASEADO EM T$CNICAS WAVELETS PARA RELACIONAR IMAGENS DIGITAIS OBTIDAS EM DIFERENTES ESCALAS E RESOLUC6ES n A 

2. Fundamentos matemáticos e o 

processamento de imagens digitais 

Neste capítulo são abordados os fundamentos matemáticos utilizados no 

desenvolvimento do trabalho. Nele são também apresentados os conceitos e 

fundamentos do Processamento Digital de Imagens. 



2.1. Conceitos adotados 

Antes da apresentação do modelo computacional proposto, considerou-se 

importante apresentar os conceitos básicos adotados de escala, resolução e 

Wavelets. 

2.1 .I. Conceito de Escala 

Escala é a relação de dimensões entre a imagem e objeto representado 

nessa imagem. Em imagens digitais pode-se dizer que é o tamanho do pixel 

exibido. 

2.1.2. Conceito de Resolução 

Resolução é o grau de detalhamento na representação de um objeto em 

uma imagem discretizada, ou seja, é o número de pixels usados para 

representar um objeto na imagem. 

2.2. Processamento de Imagens Digitais 

O processamento digital de imagens está embasado no estudo e uso de 

ferramentas matemáticas que aplicadas em seqüências lógicas permitem 

que imagens tenham suas características originais trabalhadas de forma 

geral. O escopo de técnicas de processamento digital de imagens é 

extremamente rico do ponto de bibliográfico e de aplicações. [BURGER- 

1989][GONZALEZ-1987][PRATT-19911 Desta forma, a seguir são 

mostradas, de forma objetiva, apenas as técnicas usadas no contexto deste 

trabalho. 

Uma imagem digital pode ser descrita como uma função 

bidimensional f ( x , ~ ) ,  onde x e y representam as coordenadas espaciais 

horizontais e verticais respectivamente e o valor de f para algum ponto 

(x,Y) é um valor de uma escala de níveis de intensidade luminosa. 



Matematicamente uma imagem pode ser representada por uma matriz 

de duas dimensões onde cada elemento da matriz contém o valor de uma 

escala que representa o nível de intensidade naquele ponto. 

Cada elemento desta matriz-imagem é comumente denominado como 

pixel, mas pode ser chamado também como image element, picture element 

ou pel. O Processamento de imagens pode ser segmentado em alguns 

passos fundamentais, ou seja: 

1 - Aquisição da imagem; 

2 - Processamento; 

3 - Representação; 
4 - Armazenamento; 

Na etapa de aquisição das imagens, é feita a captura e a 

discretização das imagens. A forma de captura pode variar 

significantemente, por exemplo, pode-se usar uma câmera de vídeo que 

transmite um sinal analógico de uma determinada cena que é discretizado 

por um conversor analógico/digital. Outro método muito difundido é o uso de 

Scanners que consistem em matrizes foto-sensíveis que percorrem uma 

superfície reproduzindo-a digitalmente. Como se percebe a aquisição se 

resume em, com o uso de algum tipo de sensor, representar diferenças de 

intensidades que compõem uma imagem. Estes sensores podem ser 

sensíveis a luz visível, sensíveis a Raios-X, raios gama, infravermelho, ultra- 

som, campos magnéticos, calor, entre outros. 

Neste trabalho o processo de aquisição dos dados obtidos por 

tomografia de Raios-X. 

Na etapa de processamento é feito o controle de como as imagens 

serão armazenadas elou exibidas, além da aplicação e das combinações de 

técnicas do Processamento Digital de Imagens. Nessa etapa são aplicadas 

transformações sobre os dados capturados na etapa anterior que trabalham 

e até mesmo formam as imagens. Um exemplo de transformação é o de 



IFSC-USP - MINATEL. E R - MODELO COMPUTACIONAL BASEADO EM TCCNICAS WAVELETS PARA RELACIONAR IMAGENS DIGITAIS OBTIDAS EM DIFERENTES ESCALAS E REÇOLUÇÕES 2 7 

reconstrução de imagens bi e tridimensionais os quais são discutidos nesse 

trabalho. Outro exemplo de processamento é na suavização ("smoothing") 

das imagens digitais. Esse processo consiste na redução do efeito de 

"serrilhamento" inerente as imagens representadas na forma discreta. 

Constitui-se ainda como um desafio no desenvolvimento de técnicas no 

Processamento de Imagens a adequação de técnicas que viabilizem 

suavização de bordas. Na literatura da área os principais trabalhos foram 

apresentados enfocando técnicas, como por exemplo, suavização 

polinomial, suavização por convolução com filtros uniformes, suavização por 

Fourier, suavização por Transformadas Wavelets Haar, suavização 

gaussiana, suavização por médias, por filtro "Kuwahara" conforme reportado 

no trabalho dos autores [STOCKHAM-1972, SERRA-A 982, GIARDINA-1988, 

HEIJMANS-1994, YOUNG-20031. 

A representação da imagem é feita através de algum dispositivo de 

saída como através de monitores de vídeo, impressoras, plotfers, fotos, 

entre outros. O armazenamento das imagens é a etapa onde os dados das 

imagens são transformados em arquivos que podem ser guardados em 

algum dispositivo de entrada e saída. Essa etapa é importante não apenas 

por possibilitar com que estas imagens possam estar sempre disponíveis 

mas também por facilitar etapas de processamento com recursos de 

gerenciamento de memória do computador utilizando princípios de memória 

virtual. 

Do ponto de vista matemático, uma função bidimensional f (x,y) 

pode representar uma imagem, lembrando que x e y são as coordenadas da 

imagem, teoricamente pode conter os valores dados pelo intervalo: 

0 &amp;lt;f (x,y) &amp;lt;

Equação 2.1 

Como f (x,y) é uma representação de uma energia, ela deve conter 

um valor maior que zero e finito. 



Uma imagem normalmente captada pelo olho humano possui dois 

componentes: a intensidade luminosa i(x,y) e o componente de reflectância 

r(x, y) do objeto de cena. Com isso f ( x , ~ )  pode ser descrita como: 

Equação 2.2 

O componente de intensidade deve estar em um intervalo de forma a 

ser maior que zero e menor que finito, e o componente de reflectância dever 

estar entre o intervalo (0,l). Quanto menor r(x,y) diz-se que há maior 

absorção de luz e quanto maior, maior reflectância. Na prática estes valores 

nunca são alcançados na forma analógica. 

2.2.1. Resolução Espacial de Amostragem 

De forma a se definir Resolução Espacial de Amostragem, são apresentados 

os fundamentos matemáticos de sequências bidimensionais [OPPENHEIM- 

19751 seguidos de abordagem do ponto de vista do Processamento Digital 

de Imagens [PRATT-1991, GONZALEZ-19871. 

2.2.1 . I .  Resolução Espacial de Amostragem como 

sequências bidimensionais 

Uma sequência bidimensional é uma função de duas variáveis inteiras e 

pode assumir a forma representada pela Figura 2.1. Como no caso 

unidimensional, a sequência bidimensional define sequências de 

amostragens impulso unitárias, de passos unitários, de exponenciais, e de 

senoidais. Uma sequência bidimensional de amostragem 6(m,n) pode ser 

definida como: 



IFSC-USP - MINATEL. E R - MODELO COMPUTACIONAL BASEADO E M  TCCNICAS WAVELETS PARA RELACIONAR IMAGENS DIGITAIS OBTIDAS E M  DIFERENTES ESCALAS E RESOLUÇÓES 
39 

Figura 2.1: Representação gráfica de uma sequência bidimensional. 

A sequência bidimensional de passos unitários u ( m , n )  é unitária no 

primeiro quadrante do plano (m,n) e zero nos outros, ou seja: 1, m&gt;O,n&gt;O 
u(m,n) = 

outro 

Uma sequência bidimensional exponencial é da forma a m b n  e uma 

sequência bidimensional senoidal é da forma: 

~ c o s ( w , m  + ( ) c o s ( o , m  + e )  

Uma sequência separável é a que pode ser expressa como um 

produto de seqüências unidimensionais, isto é, x ( m , n )  é separável se ela 

pode ser expressa na forma: 

x ( m , n )  = x, ( 4 x 2  ( H )  

As seqüências de amostragem, de passo unitário, exponenciais e 

senoidais são todas separáveis. Um exemplo de uma sequência que não é 

separável é dado a seguir: 

x ( m ,  n )  = cos (w,mn) 

Como no caso unidimensional, uma sequência bidimensional 

arbitrária pode ser expressa como uma combinação linear de amostras 

unitárias deslocadas como: 



Com base nesta equação, um sistema linear bidimensional pode ser 

descrito em termos de sua resposta as amostras unitárias deslocadas. 

Especificamente com y ( m ,  n )  = T [ x ( m ,  n ) ]  , onde T [ ] é a transformação para 
um sistema linear, 

m m 

y ( m , ~ ) =  i[ f 'f x ( k , r @ ( m  - k , n  - r )  = L x ( k , r ) i [ 6 ( m  - k , n  - r ) ]  
k=-mr=-m k=-mr=-m 

com ( m ,  H )  denotando um sistema que responde a 6 ( m  - k ,  n  - r ) ,  ou 

seja, 

Equação 2.3 

A linearidade imposta ao sistema h,,, ( m ,  n )  dependerá de quatro 

variáveis, k,r,m e n . No entanto, ela e útil para impor condições adicionais 

de invariância a deslocamentos. A classe de sistemas bidimensionais 

invariantes a deslocamentos é caracterizada pela propriedade que se 

y ( m , n )  é a resposta de x ( m , n ) ,  então y ( m  - k , n  - r )  e a resposta para 

x(m - k ,  n  - r ) .  Neste contexto, se h ( m ,  n )  é resposta para 6 ( m ,  n )  , então 

h(m - k ,  n  - r )  é a resposta de ~ ( m  - k ,  n  - r ) .  No caso, Equação 2.3 torna- 

se: 

Equação 2.4 

A Equação 2.4 é a convolução de um sistema bidimensional linear 

não variante a deslocamento. Pela substituição das variáveis na Equação 

2.4, obtém-se a expressão alternativa: 

Equação 2.5 

Portanto, como no caso unidimensional, a operação de convolução de 



IFSC-USP - MINATEL. E R - MODELO COMPUTACIONAL BASEADO EM TECNICAS WAVELETS PARA RELACIONAR IMAGENS DIGITAIS OBTIDAS E M  DIFERENTES ESCALAS E RESOLUCÕES A A 

duas seqüências é comutativo, ou melhor, a ordem que a convolução ocorre 

não é importante. Isso implica, dentre outras coisas, que a resposta de uma 

amostra unitária de uma combinação em cascata de sistemas lineares 

invariantes a deslocamentos independe da ordem que são calculadas. 

Um sistema linear bidimensional invariante a deslocamentos é 

considerado estável se e somente se: 

Equação 2.6 

Um sistema é dito como sendo causal se quando duas entradas 

X, (m, n) e x, (m, n) são iguais para (m &amp;lt;m,, n &amp;lt;n,) então as saídas 

correspondentes y ,  (m, n) e y ,  (m, n) são iguais para (m &amp;lt;m,, n &amp;lt;n, ) Para 

um sistema linear invariante a deslocamentos, a causalidade implica que a 

resposta unitária de amostragem é zero para (m &amp;lt;0,n &amp;lt;O). Por outro lado, 

se a reposta unitária de amostragem for zero para (m &amp;lt;O, n &amp;lt;O), então o 

sistema é causal. Uma importante subclasse de um sistema bidimensional 

invariante a deslocamentos ocorre quando as suas entradas e saídas 

satisfazem uma equação da forma: 

Equação 2.7 

onde, por linearidade, impõe-se que se x(m,n) = O para todo m e n então 

y(m,n)= O também para todo m e n. A Equação 2.7 pode representar um 

sistema causal ou não causal. Se se assumir que seja um sistema causal, a 

equação E pode ser expressa como uma relação de recursão, ou seja: 

Equação 2.8 

Por exemplo, se x(m, n) = O para (m &amp;lt;O, n &amp;lt;O), então, como 



IFSC-USP - MINATEL, E R - MODELO COMPUTACIONAL BASEADO E M  T ~ C N I C A S  WAVELETS PARA RELACIONAR IMAGENS DIGITAIS OBTIDAS E M  DIFERENTES ESCALAS E RESOLUÇbES 
42 

resultado da causalidade, y ( m ,  n )  = 0  para ( m  &amp;lt;O, n  &amp;lt;O ) .  Isto gera um 

conjunto de condições iniciais para uso da Equação 2.8. 

Para sistemas bidimensionais invariantes a deslocamentos, a 

resposta de um exponencial complexo da forma e  '"'"e J"" é um exponencial 

complexo das mesmas freqüências complexas. Especificamente, com 
l o l m  1 0 2 n  x ( m , n ) = e  e  

então da convolução, 

onde 

Equação 2.9 

A H ( e l " ' ,  e ' " ' )  é uma freqüência de resposta de um sistema 

bidimensional. Ela é uma função continua de w,ew2e é uma função 

periódica de cada uma das variáveis no período 2 7 ~  . Pode-se mostrar que 

se h ( m , n )  é separável, então H ( e l " ' , e ' " ' )  também é separável e pode ser 

expressa pela forma: 

H ( e ' " ' , e l " ' ) =  ~ , ( e ' " ' ) ~ ~ ( e ' " ~ )  

A sequência h ( m , n )  pode ser gerada da reposta de freqüência da 

relação: 

Equação 2.10 

Mais genericamente, pode-se definir a transformada de Fourier 

bidimensional de uma sequência x ( m ,  n )  como 

Equação 2.1 1 



IFSC-USP - MINATEL. E R - MODELO COMPUTACIONAL BASEADO E M  TCCNICAS WAVELETS PARA RELACIONAR IMAGENS DIGITAIS OBTIDAS E M  DIFERENTES ESCALAS E RESOLUÇÕES 
43 

com sua inversa dada por 

Equação 2.12 

Pela aplicação da transformada da Equação 2.1 1 na convolução, 

segue que a transformada de Fourier da entrada e da saída de um sistema 

bidimensional invariante ao deslocamento é relacionado por: 

Equação 2.13 

2.2.1.2. No contexto do Processamento Digital de Imagens 

Pode-se definir Resolução Espacial como sendo o número de sub-divisões 

(elementos) verticais e horizontais que uma imagem digital possui. 

Matematicamente, pode-se representar como sendo o número de linhas ou 

de colunas de uma matriz-imagem. A Resolução Espacial esta diretamente 

relacionada com a qualidade da representação de uma imagem. Quanto 

maior a Resolução Espacial melhor a representação de detalhes de uma 

cena. Em outras palavras, dada a função bidimensional F ( x , y )  

representando a luminância, intensidade fotométrica ou outro parâmetro 

relevante de uma imagem física, a imagem amostrada é dada por: 

f (x,y)= F ( ~ , Y ) G ( ~ , Y )  

Equação 2.14 

onde é 6(x,y) é a função de amostragem espacial impulso unitária. 

A condição que deve ser respeitada para amostrar adequadamente 

uma imagem é dada pela extensão da amostragem unidimensional. Essa 

condição segue o teorema de Nyquist que estabelece que a frequência de 

amostragem deva ser, no mínimo, igual a duas vezes o componente de 

maior frequência encontrado no sinal. 



IFSC-USP . MINATEL. E R . MODELO COMPUTACIONAL BASEADO EM TECNICAS WAVELETS PARA RELACIONAR IMAGENS DIGITAIS OBTIDAS EM DIFERENTES ESCALAS E RESOLUÇÕES A A 

A escolha adequada dessa frequência de amostragem possibilita que 

efeitos como o aliasing sejam minimizados. Esse aliasing causa o efeito de 

serrilhamento em curvas contidas em uma imagem. Quanto maior a 

frequência de amostragem, menor será o efeito de aliasing. 

Na Figura 2.2 representa-se como a variação da Resolução Espacial 

influencia na representação de uma imagem. 

Figura 2.2 : (a) imagem com 240 colunas por 180 linhas; (b) 120x90; (c) 

60x45; (d) 40x30. 

2.2.2. Limiarização (Threshold) 

Muito usada em segmentação de imagens, a limiarização - threshold - 
consiste em alterar o valor dos pixels em função de um valor limiar. A técnica 

consiste na aplicação da seguinte equação: 



f ( j 7  k )  = { 1 para f ( j ,  k )  &gt;= Limiar 
O para f ( j , k ) &amp;lt;L i m i a r  

Equação 2.1 5 

2.2.3. Regiões de interesse 

Os chamados ROls (Regions Of Interest) são, na prática, sub-imagens de 

uma imagem original. O uso de ROls é aplicável em otimizações 

computacionais tanto do ponto de vista da alocação de memória quanto do 

uso do processador. 

2.2.4. Cópia de imagens 

Uma imagem é copiada para outra imagem quando para cada pixel da 

imagem cópia é atribuído o valor do pixel correspondente da imagem 

original. Ou seja: 

f  '"'" ( j ,  k )  = f  ( j ,  k )  

Equação 2.16 

2.2.5. Rotulação 

A rotulação é semelhante ao processo de limiarização (threshold) no entanto 

cada conjunto de pixel de um determinado valor é atribuído um valor único 

(rótulo). Esse processamento é usado quando se deseja agrupar valores de 

pixels em um índice. 

Equação 2.17 

2.2.6. Convolução no domínio espacial 

O processo de convolução consiste na aplicação da seguinte equação sobre 

as imagens digitais a serem convoluídas. Dadas as imagens f ( ~ , ~ )  e 

g ( ~ ,  y ) ,  a convolução é dada por: 



Equação 2.18 

2.2.7. Detecção de bordas 

A detecção de bordas realça desníveis bruscos de intensidade dos pixels. O 

processamento é dado pela convolução da imagem com, por exemplo, um 

filtro Laplaciano. 

o - 1  o 

Equação 2.19 

Ou: 

Equação 2.20 

2.2.8. Transformações escalares 

O processo de transformação de escala de uma imagem consiste em 

redimensionar - alterar número de linhas e colunas - aumentando ou 

diminuindo a grade de amostragem. 

2.2.9. Imagem Vetorial x Imagem Raster 

Uma imagem é sempre representada como definido na Equação 2.14. No 

entanto a forma como ela é armazenada em memória ou trabalhada 

computacionalmente pode variar. Duas dessas variações são definidas 

como "imagens do tipo raster" e "imagens do tipo vetorial". A imagem raster 

é representada na forma de pixels, onde cada pixel recebe um valor e está 



alocado em um espaço cartesiano definido. 

A imagem vetorial, por sua vez, é armazenada na forma de conjuntos 

de parâmetros matemáticos os objetos representados nesta imagem. Por 

exemplo, um círculo vetorial é representado pelo seu centro cartesiano e seu 

raio. Um retângulo pode ser representado de forma vetorial pelas 

coordenadas do seu canto superior esquerdo e coordenadas do canto 

inferior direito. Ou ainda, este mesmo retângulo pode ser representado pelo 

seu centro cartesiano e os valores de largura e altura. 

Uma vantagem da imagem vetorial é que os objetos nela representados 

podem ser trabalhados matematicamente sem considerar a discretização. 

Desta forma os cálculos são muito mais precisos. Outra vantagem é a 

sensível redução do espaço armazenado em memória. No entanto a 

qualidade de representar imagens fica limitada as ferramentas disponíveis 

para remontar a imagem vetorial pois para exibi-la nos dispositivos digitais 

convencionais, os objetos que ela representa devem ser previamente 

remontados em uma imagem raster. 

2.2.10. Classificação de imagens digitais em função de escala 

e resolução 

Duas imagens digitais podem ser classificadas, segundo critério adotado 

para este trabalho, em função da escala e da resolução de amostragem 

utilizada. 

Dessa forma podem assumir os seguintes casos: 

Caso 1 - Escalas iguais e resoluções iguais 

Caso 2 - Escalas diferentes e resoluções iguais 

Caso 3 - Escalas iguais e resoluções diferentes 
Caso 4 - Escalas diferentes e resoluções diferentes 



IFSC-USP - MINATEL. E R - MODELO COMPUTACIONAL BASEADO EM TCCNICAS WAVELETS PARA RELACIONAR IMAGENS DIGITAIS OBTIDAS EM DIFERENTES ESCALAS E RESOLUÇÕES 
48 

O caso ideal para uma correlação mais precisa e com custo 

computacional menor é, evidentemente, o Caso 1 pois não há necessidade 

de processamentos de adequação. 

2.3. Wavelets 

Uma imagem pode ser representada como um sinal bidimensional. Assim, o 

processamento de imagens é na realidade uma extensão natural do 

processamento de sinais. Ferramentas matemáticas e computacionais foram 

desenvolvidas e servem como base para a análise dos componentes 

frequenciais de imagens. 

Fourier em 1822 descreveu uma função matemática conhecida como 

Séries de Fourier. A partir destas séries desenvolveram-se as 

Transformadas de Fourier e suas Transformadas Inversas dadas por 

integrais na forma analógica. Com o advento do processamento digital estas 

transformadas foram escritas na forma discretizada. Procurando uma melhor 

eficiência computacional desenvolveu-se, a partir daí, a Transformada 

Rápida de Fourier sob a forma de algoritmos. O algoritmo para 

Transformada Rápida de Fourier (Fast Fourier Transform - FFT) é um 

método para se calcular a Transformada de Fourier de uma série de N 

pontos de dados complexos em aproximadamente ( N log, N ) operações. 

Quando este algoritmo foi descrito por Cooley e Tukey [COOLEY-19651 em 

1965, ele foi considerado como novo pelos pesquisadores que acreditavam 

que a análise de Fourier até então calculada com N, operações poderia ser 

reduzida por um fator usando a simetria de funções trigonométricas. 

Programas de computador, na época, necessitavam centenas de 

horas para calcular um método com N ,  operações. No entanto, em 

resposta ao artigo de Cooley e de Tukey, Rudnick [RUDNICK-19661, da 

Scripps Institution of Oceanography, La Jolla, California, descreveu um 

programa de computador que também necessitava de (Nlog, N )  e foi 



IFSC-USP - MINATEL, E R - MODELO COMPUTACIONAL BASEADO E M  TCCNICAS WAVELETS PARA RELACIONAR IMAGENS DIGITAIS OBTIDAS EM DIFERENTES ESCALAS E RESOLUÇOES A fi 

baseada em um método publicado por Danielson e Lanczos [DANIELSON- 

19421. É interessante que o artigo de Danielson-Lanczos descreveu um 

método em problemas de espalhamento de Raios-X que é uma área na qual, 

por muitos anos desde 1942, ignorou a transformadas de Fourier. 

Danielson e Lanczos se referenciam a Runge [RUNGE-1903 , RUNGE-19051 

como fonte inspiradora de seu método. Estes artigos e notas de aula de 

Runge e Konig [RUNGE-19241 descrevem um procedimento em termos de 

series de seno e cosseno. A grande ênfase, no entanto, foi na economia 

computacional, a qual seria fornecida pela simetria das funções senos e 

cossenos. Em uma seção relativamente curta de Runge e Konig [RUNGE- 

19241 foi mostrado como poderia ser usada a propriedade de periodicidade 

de funções seno-cosseno para se obter uma análise de Fourier de 2N- 

pontos de duas sucessivas análises de N-pontos. Em outras palavras, se as 

séries a serem transformadas são de tamanho N e N é uma potência de 2, 

as séries podem ser divididas em log, N sub-séries e este algoritmo pode 

ser aplicado para calcular a Transformada de Fourier finita em log, N 

operações de duplas sucessivas. O número de cálculos resultantes no 

algoritmo de duplas sucessivas é proporcional a N l o g ,  N por N * .  O USO 

das simetrias somente reduzem o fator proporcionalmente enquanto o 

algoritmo de duplas sucessivas substituir N ,  por N l o g ,  N .  Esta distinção 

não foi importante para os valores de N usados na época de Runge e Konig. 

No entanto com o advento dos computadores fazendo uso de grandes 

valores para N, o método N log, N pode ser melhor explorado. 

O algoritmo para Transformada Rápida de Fourier de Cooley e Tukey 

[COOLEY-19651 é mais geral possibilitando que valores de N não 

necessariamente sejam em potência de 2. Então, se dois fatores de N são 

usados, e N = r x s , os dados são colocados em uma matriz retangular com 

r-colunas e s-linhas e uma Transformada bidimensional é feita com uma 

operação de deslocamento de fase entre as transformações em duas 

dimensões. O resultado é o cálculo em N(r+s) operações ao invés de N ~ .  



Para a situação de N ser potência de 2, o método de Cooley e Tukey é 

essencialmente o algoritmo de duplas sucessivas mencionado anteriormente 

e necessita justamente de N log, N operações. Aplicações desse algoritmo 

foram publicadas em [COOLEY-1967a, COOLEY-1 967b, COOLEY-1969a, 

COOLEY-1969bl. 

Outro algoritmo conhecido para FFT foi desenvolvido pelo Prof. L.H. 

Thomas da IBM Watson Scientific Computing Laboratory [THOMAS-19631, 

Nova lorque em meados da década de 60. O algoritmo de Thomas difere 

dos demais por: 1) os fatores de N devem ser mutuamente primos; 2) o 

cálculo é para análise de Fourier multidimensional sem a ocorrência de 

deslocamentos de fase ou "twidle factors"; e 3) a correspondência entre os 

índices unidimensionais e os multidimensionais diferem dos outros 

algoritmos. O algoritmo de Thomas é conhecido como "Prime Factor 

algorithm". 

Por outro lado, vários pesquisadores [YONGSHENG-1993, SOUZA- 

1993, MARAR-1 996, BERTOLUZZA-20001 como matemáticos e engenheiros 

tém mostrado grande interesse no que é chamado de "Análise Wavelets". 

Estudos sobre as potencialidades desta ferramenta matemática aplicadas ao 

processamento de imagens e a computação gráfica [STOLLNITZ-1995a, 

STOLLNITZ-1995bl estão sendo realizados assim como sua possível 

aplicação na reconstrução de dados tomográficos [SAHINER-1993a, 

SAHINER-1993b, MINATEL-19971. Assim como na Análise de Fourier 

podem-se distinguir dois importantes tópicos matemáticos em Análise 

Wavelets: A Integral Transformada Wavelet e as Séries Wavelets. 

A Integral Transformada Wavelets, ou simplesmente Transformada 

Wavelets, é definida como o produto interno de dilatações de uma simples 

função v ,  chamada de "Wavelet mãe". E as séries Wavelets são análogas 

as series de Fourier porém sobre a função mãe v .  

Uma função y E L ~ ( R )  é chamada uma "Wavelet" ortogonal, se a 



IFSC-USP MINATEL E R - MODELO COMPUTACIONAL BASEADO EM TECNICAS WAVELETS PARA RELACIONAR IMAGENS DIGITAIS OBTIDAS EM DIFERENTES ESCALAS E RESOLUÇÕES C. 4 

família como definido em ( x )  = 2 l t 2  ~ ( 2 ' x  - k )  para j ,  k E Z  ,é 

uma base ortonormal de (!R), isto é 

Equação 2.21 

e toda v E L ~ ( % )  pode ser escrita como 

Equação 2.22 

onde a convergência das séries em L*(%) é dada por 

Equação 2.23 

As séries representadas na Equação 2.22 são análogas as Séries de 

Fourier e são chamadas Séries wavelets. Também como em Fourier os 

Coeficientes Wavelets são definidos por 

Equação 2.24 

Define-se a Integral de Transformação como 

-m 

Equação 2.25 

onde os coeficientes Wavelets são dados por: 



Equação 2.26 

A Transformada Wavelet Bidimensional é uma ferramenta matemática 

que pode ser representada pela convolução de uma função quadrado 

integrável f(x,y) com "dilatações" de uma função básica wavelet W(x,y)ern 

escalas diferentes [CHUI-1992a, SOUZA-1 9931 conforme ilustra a equação: 

Equação 2.27 

onde 

Equação 2.28 

A Transformada Wavelet possui propriedades de localidade que 

habilitam a implementação de métodos em regiões de interesse. Basta para 

isso respeitar-se a escala adotada. 

Como exemplo de função básica wavelets pode ser citada a seguinte 

variação bidimensional da função Haar iy,(x,y) que é dada por: 

I 1 para O I x , y &amp;lt;1 / 2  iy,(x,y)= - 1  para 1 / 2 1 x , y &amp;lt;l  o outros 
Equação 2.29 

Os algoritmos apresentados nos próximos itens para a transformada 

Wavelet bidimensional são derivados de decomposições unidimensionais. 

Para uma melhor compreensão do processo bidimensional de decomposição 



IFSC-USP - MINATEL, E R - MODELO COMPUTACIONAL BASEADO E M  TtCNICAS WAVELETS PARA RELACIONAR IMAGENS DIGITAIS OBTIDAS EM DIFERENTES ESCALAS E R E s o L U Ç ~ E Ç  
53 

faz-se uso da descrição da decomposição unidimensional com os seguintes 

exemplos numéricos. 

Dado o vetor formada por cinco pixels com os seguintes valores: 

Consegue-se uma imagem com menor resolução através da 

aplicação de uma média tomada par a par sobre a imagem anterior. Tem-se 

assim a seguinte imagem: 

Observa-se uma excessiva perda de informações nesta operação de 

média. Essas informações perdidas são fundamentais para uma posterior 

recuperação da imagem original. Para essa recuperação faz-se necessário o 

armazenamento dos coeficientes de detalhes originários do processo de 

média. 

Os coeficientes de detalhes podem ser obtidos armazenando-se os 

valores das diferenças entre o valor médio e os valores dos pixels envolvidos 

nesse cálculo. Toma-se o primeiro par do exemplo dado acima, os valores 7 

e 5. O valor da média é 6. Percebe-se que 6 + 1 = 7 e 6 - 1 = 5. Portanto o 

coeficiente de detalhe necessário para a recuperação dos dados originais 

(primeiro par) tem o valor 1. 

Para o segundo para, analogamente, pode-se chegar ao coeficiente 

de detalhe (-3) pois 5 + (-3) = 2 e 5 - (-3) = 8. Com esse processo obtém-se 

a seguinte tabela: 

Tabela 2.1: Processo de decomposição por Wavelets em várias resoluções 

Coeficientes de 
detalhes 

1 - 3 2 0  
0,5 2 
0,25 

Resolução 

8 
4 
2 
1 

Médias 

7 5 2 8 9 5 3 3  
6 5 7 3  

5,5 5 
5,25 



IFSC USP - MINATEL E R - MODELO COMPUTACIONAL BASEADO E M  TECNICAS WAVELETS PARA RELACIONAR IMAGENS DIGITAIS OBTIDAS E M  DIFERENTES ESCALAS E RESOLUÇÕES 
54 

A Transformada Wavelet - Decomposição Wavelet - da imagem 7 5 2 

8 9 5 3 3 baseada na wavelet Haar é dada pela sequência de números reais: 

Essa sequência é composta pelo último elemento do processo de 

médias (5,25) e pela sequência dos coeficientes de detalhes (0,25; 0,5; 2; 1; 

-3; 2 e O). 

Esse processo, também chamado de filter bank pode ser generalizado 

para outros tipos de wavelets [STOLLNITZ-1995a, STOLLNITZ-1995bl. 

Neste trabalho adotou-se a Wavelet Haar devido ao baixo custo 

computacional envolvido no processamento de seus algoritmos de 

composição e decomposição. Esse baixo custo computacional é devido a 

pouca complexidade da implementação da Wavelet Haar em relação a 

outras wavelets [SAHINER-1 993a, SAHINER-1993bl. 

Assim como a Transformada de Fourier, a Transformada Wavelet 

pode ser estendida para duas dimensões a partir de transformadas 

unidimensionais. A Transformada ou Decomposição Padrão é dada pelo 

processamento unidimensional completo primeiramente das linhas da 

imagem seguido pelo processamento completo das colunas da imagem 

resultante [CHUI-1992a , CHUI-1992b, SAHINER-1993a, SAHINER-1993bl. 

A Figura 2.3 ilustra esse processo de decomposição. Nesta figura as 

imagens estão identadas de forma que os passos de decomposição das 

linhas ocorrem seguindo a ordem vertical e a decomposição das colunas na 

ordem horizontal. 

Por outro lado, chama-se de Transformada ou Decomposição Não- 

Padrão [SAHINER-1 993a, SAHINER-1993bl a decomposição bidimensional 

dada pelo processamento de decomposições de uma dimensão entre linhas 

e colunas alternadamente. A Figura 2.4 ilustra esse processo. A identação 

segue a da Figura 2.3 



-. . . - .  .- 

IFSC-USP - MINATEL. E R - MODELO COMPUTACIONAL BASEADO E M  TtCNICAS WAVELETS PARA RELACIONAR IMAGENS DIGITAIS OBTIDAS E M  DIFERENTES ESCALAS E RESOLUÇOES E; E; 

Transformada Wavelets das linhas 

Transformada Wavelets das colunas 

Coeficientes de detalhes 

Figura 2.3: Ilustração do processo bidimensional padrão de Transformação 

ou Decomposição Wavelets. A imagem original tem suas linhas processadas 

até o nível máximo definido e as colunas são processadas posteriormente 

até o mesmo nível. 



IFSC-USP - MINATEL E R MODELO COMPUTACIONAL BASEADO EM T ~ C N I C A S  WAVELETS PARA RELACIONAR IMAGENS DIGITAIS OBTIDAS EM DIFERENTES ESCALAS E RESOLUÇÕES 2;~: 

Transformada Wavelets das linhas 

Transformada Wavelets das colunas 

Coeficientes de detalhes 

Figura 2.4 : Processo bidimensional Não-Padrão de Transformação ou 

Decomposição Wavelets. A imagem original tem suas linhas e colunas 

processadas em seqüência. 



IFSC-USP - MINATEL E R . MODELO COMPUTACIONAL BASEADO EM TECNICAS WAVELETS PARA RELACIONAR IMAGENS DIGITAIS OBTIDAS EM DIFERENTES ESCALAS E RESOLUÇOES 57 

2.3.1. Análise de Multiresolução, Decom posição e 

Composição 

Na análise de multiresolução, do ponto de vista matemático, uma wavelet 

gera uma decomposição por soma diretas do L2((31). Para cada j E Z  

considera-se os sub-espaços de L 2 ( % )  : 

Equação 2.30 

Esses sub-espaços têm as seguintes propriedades: 

( 1 0 )  ... c v-, c V, c V; c...; 
( 2 0 )  U v, = L 2 ( % ) ,  

J E Z  

( 3 0 )  n v, = {o); 
J E Z  

( 4 0 )  V,+, = V ,  + W , , j  E Z ;  

( 5 0 )  f(x).V, ~ ( ~ x ) E V ~ + I &gt; ~ E Z .  

Equação 2.31 

Entretanto, nos espaços complementares tem-se W, n = { O } ,  j  t I .  

Resumidamente pode-se dizer que, se o sub-espaço de referência V. 

é gerado por uma única função ( E L*(w) para j=O em ( , , k ( x )  = 211'4(21x - k )  

então todos os sub-espaços V ,  são também gerados pelo mesmo ( para 

qualquer j. 

Considera-se assim que uma seqüência {V,} é gerada por uma 

função de escala ( e a seqüência de sub-espaços (w,} é gerada por uma 
wavelet v .  Neste caso, pela propriedade ( 2 0 )  cada função f em L'(%) pode 
ser aproximada por uma f N  € V N  para N sendo qualquer número inteiro. 



IFSC-USP - MINATEL, E R - MODELO COMPUTACIONAL BASEADO E M  TECNICAS WAVELETS PARA RELACIONAR IMAGENS DIGITAIS OBTIDAS E M  DIFERENTES ESCALAS E RESOLUÇbES 58 

Como V, = V,-, + W,_, , f N  possui uma única decomposição: 

f N  = f N - I  + gN-l 1 

Equação 2.32 

onde f N - ,  E V ~ - ~  e g N - ,  E WN-, . Esse processo pode ser repetido de forma a 

se obter para N elementos: 

Equação 2.33 

onde f ,  E V J  e gJ E WJ para algum j, e M é escolhido de forma que f N - ,  seja 
suficientemente suavizado. A decomposição única na Equação 2.33 é 

chamada de "Decomposição Wavelet". f N - ,  contém os "valores de média" e 

g os "coeficientes de detalhes". 

A decomposição pode obedecer a um critério de parada como quando 

f atinge um valor mínimo pré-determinado. Esse processo pode ser descrito 

na forma de algoritmos. Para isso, considere-se novamente uma função de 

escala 4 € V o  e uma wavelet iy E &amp;amp;  que estejam em V, desde que V, seja 

gerado por $, , ( x )  = 2"'4(2x - k ) , k  E Z  . Assim existem duas sequências { p k ]  

e ( q k ]  pertencentes Y 2 .  Lembra-se que Y 2  denota o espaço de todas as 

sequências bi-infinitas quadrado somáveis. Desta forma obtém-se a "relação 

entre suas escalas" dada pela função escala mostrada na Equação 2.34 e a 

função wavelet na Equação 2.35. 

Equação 2.34 

Equação 2.35 



para todo número real x 

Por outro lado, desde que 4(2x) e 4(2x - 1) são pertencentes a 

= V, + 4, existem quatro seqüências { a 2  b 2  ( a l 2 , ]  e { b }  com 
k E Z  de maneira a se obter: 

Equação 2.36 

Equação 2.37 

para x E % .  Essa duas equações podem ser unidas em uma única 

representação como Equação 2.38 que é conhecida na literatura como 

"relação de decomposição de 4 e I,Y ". 

Equação 2.38 

Tem-se assim duas seqüências únicas ( { p k } , { q k ] )  e ( { a , } ,  { b k } )  . Elas 

são únicas pelo fato da soma direta V, = V, + 4. Essas sequências são 

usadas nos algoritmos de decomposição e composiçáo sendo j p k }  e { q , }  
chamadas de "seqüências de composição (ou reconstrução)" e ( a , ]  e (b,] 

de "seqüências de decomposição". 

De maneira a descrever esses algoritmos lembra-se que para f, EV, 

e g, E WJ tem-se as séries únicas: 



IFSC-USP - MINATEL. E R - MODELO COMPUTACIONAL BASEADO E M  TECNICAS WAVELETS PARA RELACIONAR IMAGENS DIGITAIS OBTIDAS E M  DIFERENTES ESCALAS E RESOLUÇÕES 
60 

I k com C' = { c * )  E e 2  
Equação 2.39 

k 

com D J = ( &amp;amp; ) E ! ~  

Equação 2.40 

onde intencionalmente foram eliminados os coeficientes 2.It2 para se 

escrever ( ( 2 ' ~  - k )  e v(2'x - k )  ao invés de 6 ,  e y,, para eliminar a 

desnecessária multiplicação por f i .  

Os algoritmos de decomposição e composição mostrados na Equação 

2.41 e na Equação 2.42 a seguir, representam f ,  e g, pelas seqüências 

C1e D J .  

Equação 2.41 

Equação 2.42 

A Figura 2.5 e a Figura 2.6 ilustram o processo de Decomposição e 

Composição por Wavelets respectivamente. 

Figura 2.5 : Decomposição por wavelet; 



IFSC-USP - MINATEL. E R - MODELO COMPUTACIONAL BASEADO E M  TPCNICAS WAVELETS PARA RELACIONAR IMAGENS DIGITAIS OBTIDAS E M  DIFERENTES ESCALAS E RESOLUÇÕES 
6 1 

Figura 2.6: Composição por wavelet; 

2.3.2. Algoritmo de interpolação por B-Wavelets 

A interpolação por B-wavelets determina os valores intermediários entre 

uma seqüência de pontos conhecida. Diferentemente da aproximação, a 

interpolação não apenas desloca a curva gerada sob a influência dos pontos 

conhecidos, como também faz com que essa curva passe por esses pontos. 

A Figura 2.7 ilustra essa diferença: 

0 pontos conhecidos 

. - .  . pontos aproximados por B-wavelets 

- pontos interpolados por B-wavelets 

Figura 2.7 : Exemplo de interpolação e aproximação por B-Wavelets. 

Para descrever a interpolação faz-se necessária uma discussão sobre 

o método de aproximação, seus problemas e suas soluções computacionais. 

Seja f u m a  função de aproximação Spline de ordem m e com passo 

p = 2 - j ' ~  dada por: 

Equação 2.43 

onde N é o número de pontos conhecidos. 

De forma a otimizar o processo de cálculo, implementa-se a função 



~(x), também chamada de função de "blending", da seguinte maneira: 

Equação 2.44 

A implementação direta desta somatória fornece os valores 

intermediários da aproximação. No entanto, para os pontos inicial e final 

para m=4 , por exemplo, tem-se os valores: 

Equação 2.45 

Equação 2.46 

Para solucionar esse problema, nesta implementação, adotou-se o 

uso dos chamados "pontos fantasmas". Essa técnica consiste em considerar 

um ou mais valores antes do ponto inicial e depois do final. 

Foram adicionados dois pontos fantasmas no início e dois no final da 

seqüência conhecida. Esses valores foram ajustados de forma dinâmica 

para que a curva a ser gerada pela função B-wavelet passasse pelos pontos 

inicial e final. 



IFSC-USP - MINATEL, E R - MODELO COMPUTACIONAL BASEADO EMTCCNICAS WAVELETS PARA RELACIONAR IMAGENS DIGITAIS OBTIDAS E M  DIFERENTES ESCALAS E RESOLUÇbES 
63 

Esses pontos tém seus valores obedecendo a regra : a-, = 2a0 - a ,  e 

a-, = 2a-, - a o  para os pontos iniciais e a,,, = 2a, -a,-, e a,,, = 2a,+, -a, 

para os pontos finais. 

A função mostrada na Equação 2.43 fica da seguinte forma: 

Equação 2.47 

Para a implementação da interpolação, ao invés da simples 

aproximação, usa-se uma função muito próxima da função de aproximação. 

Essa função é dada por: 

Equação 2.48 

A idéia básica é usar a seqüência de pontos A, no lugar de a,. Essa 

sequência é dada pela multiplicação das matrizes: A = M b ' a ,  onde A é o 

vetor (sequência) a ser encontrado, v é o conjunto de pontos conhecidos 

com os pontos fantasmas e M é uma matriz N+3 x N+3 dada por: 

Equação 2.49 



IFSC-USP - MINATEL. E R - MODELO COMPUTACIONAL BASEADO E M  TCCNICAS WAVELETS PARA RELACIONAR IMAGENS DIGITAIS OBTIDAS E M  DIFERENTES ESCALAS E RESOLUÇOES 
64 

3. Desenvolvimento do modelo. 

Neste capítulo é apresentado o modelo desenvolvido com uso de 

fluxogramas e pseudocódigos de forma modular com progressivo nível de 

detalhamento. Em alguns processos apresentados faz-se uso de imagens 

que ilustram os resultados esperados. 



O modelo computacional implementado correlaciona as imagens de 

diferentes escalas e resoluções através do estudo de atributos matemáticos. 

Nesse contexto definiu-se que a operação em alto nível do sistema 

em duas fases: 

Fase 1 : Extração de atributos 

Fase 2: Classificação 

O fluxograma mostrado pela Figura 3.1 ilustra uma visão geral do 

sistema implementado onde se observa que a fase de extração de atributos 

gera um banco de dados que será posteriormente consultado pela fase de 

classificação. 

C inicio J 

Imagens de um meio 
poroso 

f 
C fim 

.( t C 

Figura 3.1: Visão geral do sistema implementado. 

Uma descrição de cada uma dessas fases e seus processamentos 

são expostos a seguir. 

Classificação Extração de atributos Banco de Dados 
+ 



3.1. Fase de extração de atributos 

Nesta fase, imagens de meios porosos conhecidos têm suas imagens 

obtidas por meio de imageamento não invasivo por tomografia por Raios-X e 

y e submetidas a analise do sistema. Nessa inserção de dados, são 

informados parâmetros relevantes como a escala adotada e a resolução de 

amostragem utilizada de forma a se obter a série de atributos como, por 

exemplo, a densidade (número de poros por unidade de medida), a mediana 

(distribuição dos raios dos círculos inscritos) e o desvio padrão os quais 

serão usados na classificação desses meios. Os dados para classificação 

são então armazenados em banco de dados. Os processamentos ilustrados 

na Figura 3.2 e que compõem esta fase são individualmente explicados após 

apresentação da fase de classificação pois ambos possuem pontos em 

comum. 

Imagens de um meio 

Imagem binária dos poros 

Adequar escala e resoluçiío 

Imagem binária dos poros 
na escala e resolução padrão 

Imagem dos poros vetorizada. 

Calcular atributos 

Figura 3.2 : Fase de extração de atributos. Atributos inerentes as imagens 

são extraídos e armazenados em um banco de dados normalizados. 



3.2. Fase de classificação 

Nesta fase uma imagem de meio poroso a ser caracterizado é fornecida ao 

sistema. O sistema, por sua vez, efetua os processamentos necessários, 

consultando a base de dados normalizados gerada pela Fase 1 e, 

comparando os dados com faixas pré-estabelecidas de tolerância, classifica 

o meio poroso em uma das classes aprendidas ou informa quando ele não 

se enquadra em nenhuma. A Figura 3.3 mostra os processamentos 

envolvidos na Fase 2. 

Imagens de um meio 
poroso a ser caracterizado 

Segmentação a 
Imagem binana dos poros 

Adequar escala e resoluçao 

Imagem binana dos poros 
na escala e resolução padrio 

Vetorização D 
Imagem dos poros vetorizada 1 

Calcular atributos c 

Banco de Dados 

Parámetros de imagens previamente 
Processadas 

Figura 3.3 : Fluxograma da Fase de classificação onde se observa o uso da 

base de dados gerada na Fase 1 para classificação da imagem entrada. 

3.3. Processamentos envolvidos 

Como se pode observar na Figura 3.2 e depois na Figura 3.3 as fase de 

extração de atributos e a de reconhecimento possuem em comum os 

módulos "Segmentação", "Adequar escala e reso1ução", "Vetorização" e 

"Calcular atributos". A seguir esses módulos são explicados individualmente. 



3.3.1. Segmentação 

Neste módulo são processadas as imagens de forma a adequá-las ao 

formato de entrada para algoritmo que se segue, destacando o que deve ser 

considerado como poro do que não é poro. 

Na literatura existem várias técnicas de segmentação de imagens 

[GONZALEZ-1987, PRATT-19911. Por outro lado, a escolha da técnica a ser 

usada deve considerar a maneira como o objeto a ser segmentado 

(destacado) é representado na imagem. Assim, considerando-se que nas 

imagens deste estudo, cada pixel representa uma atenuação dos Raios-X ou 

y, a escala de cinza foi usada para representar de forma linear cada 

coeficiente de atenuação. 

Na Figura 3.4 é mostrada uma imagem proveniente de tomografia 

onde o pixel de valor O representa o coeficiente de atenuação 0.000cm-' e o 

pixel de valor 255 representa 1.050cm-' . Os pixels de valores intermediários 
representam de forma linear os coeficientes de atenuação no escopo. 

Um poro não preenchido pode ser analogamente comparado a um 

espaço vazio onde um feixe de Raios-X não sofre atenuações ou, quando 

preenchido, assume o valor da atenuação causada pelo material de seu 

preenchimento. Portanto o poro é representado em uma imagem, como a 

mostrada na Figura 3.4, como sendo conjuntos de pixels de valores 

definidos. Na prática, considerando os parâmetros da formação de imagens 

de tomografia com seus ruídos e outros problemas, consideram-se os 

valores dentro de uma faixa de tolerância. 

A segmentação neste caso é, portanto, dada pela aplicação de um 

filtro do tipo limiar ("fhreshold") que fornece uma imagem binária onde os 

poros são representados pelo pixel 1 e os demais pixels são O. 



IFSC-USP - MINATEL E R - MODELO COMPUTACIONAL BASEADO E M  T&lt;CNICAS WAVELETS PARA RELACIONAR IMAGENS DIGITAIS OBTIDAS E M  DIFERENTES ESCALAS E RESOLUÇdES 
69 

255 máx. 

128 

O min. 

Figura 3.4 : Imagem gerada por tomografia onde os coeficientes de 

atenuação são representados em escalas de tons de cinza. Pixel valor O = 

coeficiente de atenuação de valor 0.000cm-' e os pixels de valor 255 

representam 1 .O50 cm-' . 

O processamento do filtro "fhreshold' é relativamente simples do 

ponto de vista computacional como ilustrado no pseudocódigo a seguir: 

Img = imagem a ser filtrada pelo threshold. 
NC = Número de colunas da imagem; 
NL = Número de linhas da imagem; 
Limiar = valor entre O e 255 para limiarização; 
Img2 = imagem de saída com NC colunas e NL linhas; 
for C = 1 to NC do: 
for L = 1 to NL do: 
begin : 

i£ Img [C, L] &amp;lt;Limiar 
then Img2 [C,L] = 0; 
else Img2 [C,Ll = 255; 

end . 

3.3.2. Adequar escala e resolução aos padrões 

O modelo desenvolvido usa padrões de escala e de resolução definido 

empiricamente aos quais as imagens de entrada devem ser previamente 

adequadas. Para essa adequação foi desenvolvido algoritmo que, em suma, 

objetiva deixar as imagens com a mesma relação pixellunidade de medida 

adotada como padrão. Desta forma obtém-se uma normalização dos dados 

(atributos) a serem posteriormente armazenados. O fluxograma mostrado na 

Figura 3.5 ilustra o algoritmo. 



IFSC-USP - MINATEL, E R - MODELO COMPUTACIONAL BASEADO EM TCCNICAS WAVELETS PARA RELACIONAR IMAGENS OIGITAIS OBTIDAS EM DIFERENTES ESCALAS E RESOLUCÓES -. n 

inicio 3 
Imgln = imagem de entrada l - 7  

i 
Padrao 

Rpln = Resolução/Medida de Imgln; Rp = Resol./Medida; 

Zoom out em Imgln (RplnIRp vezes) 

Zoom in em Imgln (RplnlRp vezes) s 
cL, 

Figura 3.5 : Fluxograma do algoritmo de adequação da imagem entrada para 

a mesma escala e resolução da imagem definida como padrão. 

Para ilustrar o funcionamento deste algoritmo optou-se por utilizar a 

imagem Baby-Ed que permite uma melhor visualização das transformações 

a serem realizadas em relação as imagens de meios porosos, pois contém 

conhecidos pontos de referência. Os módulos para Zoom In e Zoom Out 

contidos neste processamento são descritos em detalhes após a 

apresentação dos possíveis casos de imagens entrada. 

Os seguintes casos podem ocorrer em função das imagens entradas: 

Caso 1 - Escalas iguais e resoluções iguais 

Caso 2 - Escalas diferentes e resoluções iguais 

Caso 3 - Escalas iguais e resoluções diferentes 
Caso 4 - Escalas diferentes e resoluções diferentes 

Cada caso é apresentado a seguir: 

Caso 1 - Escalas iguais e resoluções iguais 
Nesse caso a imagem já se encontra adequada para o formato de entrada 



do sistema. Opcionalmente, preenche-se com zeros ou corta-se a imagem 

para adequá-la a um tamanho (número de linhas e colunas) padrão. 

Exemplo 1: Uma imagem entrada tem a mesma escala e resolução da 

imagem padrão. No entanto, essa imagem tem 320 colunas por 240 linhas e 

os números de colunas e linhas padrões são ambos 512. A imagem 

resultante terá 512 colunas x 512 linhas com o preenchimento de 192 

colunas e 272 linhas com zeros. 

10 mm = 51 2 pixels 

Figura 3.6 : A marcação externa representa o tamanho da imagem padrão 

de entrada. A imagem com mesma escala e resolução de 320x240 foi 

adequada a este tamanho. 

Exemplo 2: A imagem entrada tem 640 colunas e 480 linhas na mesma 

escala e mesma resolução. A imagem resultante eliminará 128 colunas e 

preencherá com zeros 32 linhas de forma a ter 512 colunas por 512 linhas. 

10 mm = 5 12 pixels 

Figura 3.7 : A imagem com mesma escala e resolução de 640x480 foi 

adequada ao tamanho padrão. Houve perda de parte da imagem. 



Caso 2 - Escalas diferentes e resoluções iguais 

A imagem entrada tem o mesmo número de pixels, no entanto tem escalas 

diferentes. A imagem resultante deve "estender" ou "encolher" a imagem 

entrada de forma a adequar as escalas, ou seja, deve considerar a relação 

padrão de pixelslunidade de medida. 

Exemplo 1: Uma imagem entrada tem 512 x 512 pixels que correspondem a 

20 mm (1: 0,0390) e a relação padrão é 1:0,0195. A imagem de entrada foi 

"esticada" e apenas uma sub-imagem desta é analisada (copiada para a 

imagem resultante). Ilustrado na Figura 3.8. 

- - 
10 rnrn = 512 pixels 20 rnrn = 512 pixels 

- 10 mm = 512 pixels 

20 rnm = 1024 pixels 

Figura 3.8 : A imagem de entrada teve suas dimensões aumentadas 

proporcionalmente de forma a ter a mesma escala da imagem padrão. 

Houve descarte de parte da imagem. 

Exemplo 2: Uma imagem entrada tem 512 colunas por 512 linhas, porém 

essas 512 colunas correspondem a 5 mm (1: 0,0097, 1 pixel = 0,0097 mm). 

A relação padrão é 1:0,0195. Nesse caso, deve-se adequar a imagem 

entrada reduzindo-a para a escala adotada multiplicando o número de linhas 

e colunas individualmente por um fator, no caso 0,5, e preenchendo com 

zeros para adequar a resolução espacial padrão. 



IFSC-USP - MINATEL. E R - MODELO COMPUTACIONAL BASEADO E M  TECNICAS WAVELETS PARA RELACIONAR IMAGENS DIGITAIS OBTIDAS E M  DIFERENTES ESCALAS E RESOLUÇÕES 
7 3 

-- 
1 0 m m  =512pixels 5 mm = 5 12 pixels 

T r 

10 mm = 5 12 pixels 

Figura 3.9 : A imagem de entrada teve suas dimensões reduzidas 

proporcionalmente de forma a ter a mesma escala da imagem padrão. 

Caso 3 - Escalas iguais e resoluções diferentes 

A imagem entrada tem a mesma escala, porém resoluções diferentes. Nesse 

caso, adequando-se a relação pixellunidade de media (pixellmm) tem-se a 

adequação. A Figura 3.10 ilustra esse caso. 

4 b -  4 b 

10 m m  = 512 pixels 10 mm = 256 pixels 10 mrn = 512 pixels 

Figura 3.10 : A imagem de entrada teve suas dimensões aumentadas (zoom 

in) de forma a ter a mesma escala da imagem padrão. 

Caso 4 - Escalas diferentes e resoluções diferentes 
Da mesma forma que os demais casos, para adequar imagens com 

diferentes escalas e diferentes resoluções, basta adequar suas relações 

pixelslmm. Pode-se encontrar exemplo ilustrado na Figura 3.1 1. 



IFSC-USP - MINATEL, E R - MODELO COMPUTACIONAL BASEADO EM TECNICAS WAVELETS PARA RELACIONAR IMAGENS DIGITAIS OBTIDAS EM DIFERENTES ESCALAS E RESOLUÇÕES 74 

4 b 

10 mm = 5 12 pixels 5 mm = 1024 pixels 10 mm = 512 pixels 

Figura 3.11 : A imagem de entrada teve suas dimensões reduzidas (zoom 

out) objetivando adequá-la a mesma escala da imagem padrão. 

Nos casos acima descritos observou-se a aplicação de 

processamentos nas imagens de aproximação (Zoom In) e redução (Zoom 

Out). Apesar de diferentes técnicas serem aplicáveis nestes processos, os 

procedimentos adotados são expostos a seguir: 

3.3.2.1. Zoom Out (redução) 

Neste processamento (ilustrado pela Figura 3.12) a imagem entrada sofre 

um transformação de escala em suas dimensões. 

inicio 

Rp = Resol.lMedida Padráo; 
ImgBin = imagem de entrada binária Rpln = Res.lMed. De ImgBin; 

NC = número de colunas de ImgBin; 
NL = número de linhas de ImgBin; 
NC2 = NC (RplnlRp); 
NL2 = NL * (RplnlRp); 

ransformação de escala em ImgBi m 
c-&gt; 

Figura 3.12 : Fluxo de dados para o processamento de redução (zoom out) 

de uma imagem. 



IFSC-USP - MINATEL. E R - MODELO COMPUTACIONAL BASEADO E M  TCCNICAS WAVELETS PARA RELACIONAR IMAGENS DIGITAIS OBTIDAS E M  DIFERENTES ESCALAS E RESOLUÇÕES 
75 

Uma imagem com NC colunas e NL linhas é rearranjada para novas 

dimensões NC2 colunas e NL2 linhas. Evidentemente há perdas nos 

detalhes da imagem. No entando suas novas dimensões são adequadas por 

atenderem a relação padrão entre a resolução e a medida da imagem. 

Transformação de escala 

A transformação de escala na imagem é processada pelo algoritmo abaixo 

descrito, onde se observa que a imagem original (Img) é copiada para a 

nova imagem (lmg2) com novas dimensões. Como as colunas e linhas são 

transformadas simultaneamente pelo mesmo fator, a imagem resultante é 

proporcional a imagem original. 

Img = imagem a ser transformada. 
NC = Número de colunas da imagem; 
NL = Número de linhas da imagem; 
Fator = fator multiplicador; 
NC2 = NC * Fator; 
NL2 = NL * Fator; 
Img2 = Nova imagem com NC2 colunas e NL2 linhas; 

for C2 = 1 to NC2 do: 
for L2 = 1 to NL2 do: 
begin : 

C = C2/Fator; 
L = L2/Fator; 
Img2[C2,L2] = Img[C,L]; 

end . 

3.3.2.2. Zoom ln (aproximação) 

Neste processamento (ilustrado pela Figura 3.13) a imagem entrada, como 

no processo de Zoom Out, sofre um transformação de escala em suas 

dimensões. Uma imagem com NC colunas e NL linhas é rearranjada para 

novas dimensões NC2 colunas e NL2 linhas. 



Neste caso, a imagem resultante apresenta um problema inerente as 

amostras discretizadas: a perda de detalhes em baixas resoluções. Esse 

problema é caracterizado por um efeito de "serrilhamento" nas bordas e 

pode causar distorções nos resultados da análise. Por isso, adicionalmente é 

aplicado um processamento de suavização por sub-pixel. 

NC = número de colunas de ImgBin; 
NL = número de linhas de ImgBin; 
NC2 = NC ' (RplnlRp), 
NL2 = NL * (RplnlRp); 

ransformaçáo de escala em ImgBi 

Suavizaçáo por Sub-pixel 

Figura 3.13 : Processo de Zoom In com suavização por sub-pixel usando B- 

Wavelets. 

A imagem mostrada na Figura 3.14 representa um meio poroso onde 

os poros foram destacados (segmentados) com filtro do tipo threshold. Os 

poros são representados pela cor preta e o branco é a cor usada para 

ilustrar o que não é poro. 

Nessa figura pode-se observar o efeito de serrilhamento ocasionado 

pelo aumento da escala que é prejudicial ao processo de correlação porque 

distorce a representação dos poros. A imagem (a) desta figura (Figura 3.14) 



IFSC USP MINATEL, E R - MODELO COMPUTACIONAL BASEADO E M  TCCNICAS WAVELETS PARA RELACIONAR IMAGENS DIGITAIS OBTIDAS EM DIFERENTES ESCALAS E RESOLUÇÓES 
77 

originalmente possui 256x256 pixels. Depois de submetida a transformação 

de escala, ela passou a ter em (d) 1024x1 024 pixels tendo preservado suas 

características originais. 

Figura 3.14 : Imagem (a) submetida a aproximações ("zoom in") mantendo- 

se suas características iniciais. A imagem (a) possui 256~256pixels; (b) 

51 2x51 2; (c) 768x768; (d) 1024x1 024. 

O uso de Wavelets nesse caso mostra-se aplicável. Desta forma, foi 

implementado, usando método de interpolação por B-Wavelets um algoritmo 

para estimar sub-pixels objetivando a minimização do efeito de 

"serrilhamento". 

3.3.2.3. Suavização por Sub-Pixel usando B-Wavelets 

A técnica desenvolvida consiste em se efetuar uma seqüência de 

processamentos na imagem aproximada e binarizada. O fluxograma 

mostrado na Figura 3.15 resume essa série de processamentos os quais 

serão descritos mais abaixo. 



IFSC-USP - MINATEL, E R - MODELO COMPUTACIONAL BASEADO E M  TECNICAS WAVELETS PARA RELACIONAR IMAGENS DIGITAIS OBTIDAS E M  DIFERENTES ESCALAS E RESOLUÇbES 

78 

inicio - 
I ImgBin = imagem de entrada binária I 
I I 

Processamento 1: 
Segmentar a imagem em N sub- 
Imagens dos N poros encontrados. 

I 

não 1 
b 

sim 

Processamento 2: 
Obter imagem das bordas da próx. 

Processamento 5: 
Remontar imagem suavizada; 

I I Imagem de poro. I 1  
I 

Vetorizar pontos centrais das retas 
Encontradas. 

I I Processamento 4: Interpelar por B-Wavelets; I I 

Figura 3.15 : Fluxograma da série de processamentos necessários para a 

aplicação da técnica sub-Pixel por B-Wavelets. 

Entrada : 

Imagem binária resultante do processamento anterior 

Processamento 1 : 

Segmentar a imagem resultante da aproximação dos N poros em N sub- 

imagens contendo conseqüentemente apenas um poro cada. 

(a) (b) 

Figura 3.16 : (a) imagem binarizada contendo todos os poros. (b) imagem de 

um único poro. 



IFSC-USP - MINATEL, E R - MODELO COMPUTACIONAL BASEADO EM T ~ C N I C A S  WAVELETS PARA RELACIONAR IMAGENS DIGITAIS OBTIDAS EM DIFERENTES ESCALAS E RESOLUÇÕES 
79 

inicio =T=) 
Img = imagem de entrada L 

Rotular imagem n 
Todos poros processados? 

Criar sub-imagem I 
Copiar pixels do rótulo corrente a 

Sub-Imagens contendo poros n 
Figura 3.17 : Processamento para segmentar uma imagem de N poros em N 

sub-imagens de um poro. 

No exemplo ilustrado pela Figura 3.16 podem ser observados todos 

os poros na imagem (a) e uma sub-imagem de apenas um poro na imagem 

(b). O processamento segue o fluxograma mostrado na Figura 3.17. 

O método para essa segmentação dos poros em sub-imagens 

individuais é baseado na técnica de rotular cada conjunto adjacente de 

pixels com uma determinada cor e depois copiar apenas os elementos dessa 

cor para uma imagem diferente. O pseudocódigo a seguir ilustra esse 

método: 
- - -  

Img = imagem binarizada do meio poroso, onde O é preto e 
representa os poros e 1 é branco e representa o que não é 
poro. 
NC = Número de colunas da imagem; 
NL = Número de linhas da imagem; 

Passo 1: 
Rótulo = 1; 
for C = 1 to NC do: 
for L = 1 to NL do: 
begin : 



IFSC-USP - MINATEL. E R - MODELO COMPUTACIONAL BASEADO E M  T ~ C N I C A S  WAVELETS PARA RELACIONAR IMAGENS DIGITAIS OBTIDAS EM DIFERENTES ESCALAS E RESOLUÇ6ES 
80 

P = pixel na posição [C,L]; 
i f P = O  

t h e n :  pintar todos os pixels adjacentes de valor 
Rótulo; Incrementar valor de Rótulo; 

end ; 

Passo 2 :  
f o r  X = 1 t o  Rótulo do: 
ImgPoro[X] = Imagem de um poro rotulado com valor X. Essa 
imagem tem tamanho NCxNL e é preenchida com 1s; 
f o r  C = 1 t o  NC do: 
f o r  L = 1 t o  NL do: 
b e g i n  : 

P = pixel na posição [C,L] da Img; 
if P = X t h e n :  ImgPoro[Xl = P; 

end . 

Processamento 2 : 

Sobre cada sub-imagem, aplicar um filtro de detecção de bordas, como o 

filtro laplaciano. Para isso basta se efetuar uma convolução de uma máscara 

3x3 com a imagem em processamento. O pseudo-código a seguir ilustra 

esta convolução. 

Img = imagem a ser processada; 
Img2 = imagem resultante (bordas); 
NC = Número de colunas da imagem; 
NL = Número de linhas da imagem; 

H= 1 - 1 4 - 1 1, matriz 2D da máscara Laplaciano; 
1 0  - 1  o ]  

NCK = 3; (número de colunas do filtro) 
NLK = 3; (número de linhas do filtro) 
f o r  C = 1 t o  (NC-NCK) do: 
f o r  L = 1 t o  (NL-NLK) do: 
b e g i n  1: 

Soma = 0; 
f o r  CK = 1 t o  NCK do: 
f o r  LK = 1 t o  NLK do: 
b e g i n  2 :  

Soma = Soma + Img [C, L] *H [CK, LK] ; 
end 2; 
Img2 [C, L] = ~oma*l/ (NCK*NLK) ; 

end 1; 



Processamento 3 : 

A imagem das bordas é analisada e um banco de dados é gerado contendo 

os pontos centrais de cada segmento de reta encontrado na imagem. Esse 

banco de dados servirá de entrada de dados vetoriais para a interpolação 

dos dados. 

img = imagem de entrada 

, +"I cy 
I X = coluna do ponto inicial; I A 

Y = linha do ponto inicial; 
Sentido = INICIO; 

X = Pixel(Sentido).X; 
não I Y = Pixel(Sentido).Y; 

I 

Sentido = CIMA; 

Pixel (DIREITA) ? 
Sentido = DIREITA; 

Sentido-Anterior = Sentido; 
Sentido = BAIXO; 

Sentido-Anterior = Sentido. 
Sentido = ESQUERDA; 

Sentido = Sentido-Anterior ? e 
Armazena (X.Y), - 

Dados para Interpolaçáo 

Figura 3.18 : Processo de vetorização dos pontos para interpolação. 

O banco de dados para interpolação gerado pelo processamento mostrado 

na Figura 3.18 , na realidade, contém os pontos de junção das retas 

(conexões em 90 graus). Para a interpolação se deve ainda processar esses 

dados para se obter os pontos médios entre cada ponto ordenado do vetor. 

Por exemplo, se o vetor armazenado tiver as seguintes coordenadas: 



IFSC USP - MINATEL E R - MODELO COMPUTACIONAL BASEADO EM T ~ C N I C A S  WAVELETS PARA RELACIONAR IMAGENS DIGITAIS OBTIDAS EM DIFERENTES ESCALAS E R E S O L U Ç ~ E S  
8 2 

Os dados para interpolação serão: 

Os valores não inteiros serão aproximados após a interpolação. 

A Transformada Wavelet Haar é aplicável neste caso. O 

processamento consiste na obtenção dos coeficientes de médias dos pontos 

entrados em uma transformada de ordem 1. O que na prática retorna o 

ponto médio e pode ser computacionalmente otimizado na forma 

implementada e mostrada no pseudo-código abaixo: 

N = número de pontos a serem processados; 

PIn[N] = array com os pixels das conexões 90 graus; 

POut[N] = array com os pixels dos centros; 

f o r  P = 1 to (N-1) do: 
b e g i n  

E1 = PIn[P] .X; / /  Colunas do ponto 
E2 = PIn[P+l] .X; / /  Linhas do ponto 

i f  (El=E2) 
POut [P] . Y=0.5* (PIn [P] . Y+ PIn [P+l] . Y) ; / /  coef. Média TW 

Haar ; 

else 
POut [P] . X=0.5* (PIn [P] .X+ PIn [P+1] . X) ; / /  coef. Média TW 

Haar ; 
end . 



FSC-USP - MINATEL, E R - MODELO COMPUTACIONAL BASEADO EM T ~ C N I C A S  WAVELETS PARA RELACIONAR IMAGENS DIGITAIS OBTIDAS EM DIFERENTES ESCALAS E R E S O L U C ~ E S  n n 

Processamento 4 : 

Com base nos dados armazenados no arquivo gerado pelo processamento 

anterior, aplica-se algoritmo de interpolação por B-Wavelets entre os pontos 

médios de cada reta encontrada conforme ilustrado na Figura 3.19. O 

pseudocódigo abaixo ilustra a seqüência de comandos do algoritmo para 

processamento da interpolaçáo por B-Wavelets. 

I Dados para Interpolação 

I Obter matriz 2D dos dados para interpolaçáo. 

Todos pontos processados? s 
Interpolar usando E-Wavelets +-ll 

sim 

Gerar imagem com dados 

Figura 3.19: Processo de interpolação dos poros por B-Wavelets. 

Interpolação por 5- Wavelets 

NE = número de pontos; 
NEF = NE + 4 = num. pontos mais "pontos fantasmas"; 
NI = num. pontos a serem interpolados; 
NP = NE*NI; / /  número total de pontos; 
m = ordem da B-wavelet; 

W M K ( ~ ,  k) = ~ , ( k ) ;  
B(k) = ~(z); 

/ /  ENTRADA DE PONTOS REAIS (COLUNAS) 
for zl = 2 to NE-2 do 
AR[zl] = pontos para interpolação (colunas); 

{CÁLCULO DOS PONTOS "FANTASMAS"} 
AR[2] : =  2*AR[3] -AR[4] ; 
AR[1] : =  2*AR[2] -AR[3] ; 
AR[NE+l] : =  2*AR[NE] -AR[NE-11 ; 
AR[NE+2] : =  2*AR[NE+l]-AR[NE]; 



IFSC-USP - MINATEL E R - MODELO COMPUTACIONAL BASEADO E M  T ~ C N I C A S  WAVELETS PARA RELACIONAR IMAGENS DIGITAIS OBTIDAS E M  DIFERENTES ESCALAS E RESOLUÇOES 
84 

{DETERMINA VALORES DA MATRIZ M) 
f o r  x : =  1 t o  NE do 
b e g i n  

M[x,l] : =  0; 
M[x,NEt2] : =  0; 

end ; 

f o r  y : =  2 t o  NEt1 do 
f o r  x : =  1 t o  NE+2 do 
b e g i n  
M [x, y ]  : = WMK (m, (x-yt2) ) ; 

end; 

{EFETUA INVERSÃO DA MATRIZ M} 

Inverte - Matriz (MA, INV, NE+2) ; {INV = M - ' }  

{MULTIPLICA O VETOR AR PELA MATRIZ INV} 
Multiplica - Matriz(INV, AR, AP , NEt2); {AP = AR*INV} 

22 = o; 
f o r  K : =  NI*3 t o  NI* (NE-2) do {IGNORA DADOS "FANTASMAS"] 
b e g i n  

{EFETUA INTERPOLAÇÃO UNIDIMENSIONAL} 
22 : =  22 t 1; 
Valor - Interpolado : =  0; 
f o r  I : = 1 t o  NE do 
Valor - Interpolado : =  Valor - Interpolado + 

AR [I] *B (NEkK/NP-I) ; 
PInt[z2] : =  Valor - Interpolado; 

end ; 
end ; 

{ENTRADA DE PONTOS REAIS (LINHAS)} 

f o r  zl = 2 t o  NE-2 do AR[zl] = pontos para interpelação 
(linhas) ; 



IFSC-USP MINATEL E R MODELO COMPUTACIONAL BASEADO EM TECNICAS WAVELETS PARA RELACIONAR IMAGENS DIGITAIS OBTIDAS EM DIFERENTES ESCALAS E RESOLUÇ6ES 
85 

Processamento 5 : 

Preenche-se e copia-se esta imagem para uma outra imagem, conforme a 

Figura 3.20, contendo todos os poros, que servirá de entrada para a análise. 

inicio (=F' 

Sub-Imagens suavizadas 

+ 
Copiar sub-imagem em ImgOut 

Figura 3.20 : Remontagem da imagem dos poros. 

A Figura 3.21 ilustra resumidamente os resultados do processo de 

interpolação. A imagem (a) da Figura 3.21 é do poro extraído e mostrado na 

Figura 3.16(b) após ser processado pelo método de aproximação (Zoom In) 

descrito anteriormente. 



IFSC-USP - MINATEL. E R - MODELO COMPUTACIONAL BASEADO EM T ~ C N I C A S  WAVELETS PARA RELACIONAR IMAGENS DIGITAIS OBTIDAS EM DIFERENTES ESCALAS E RESOLUÇÓES 
8 6 

Figura 3.21 : (a) imagem de poro com aproximação onde se pode observar 

o efeito de serrilhamento. (b) imagem das bordas da imagem (a). (c) imagem 

das bordas sobreposta a imagem interpolada. (d) imagem resultante com 

suavização do efeito de serrilhamento. 

Veto riza çã o 

A vetorização definida para esta etapa consiste em se reconhecer e se 

marcar os círculos inscritos nos poros contidos nas imagens analisadas, 

armazenando os valores referentes as coordenadas cartesianas e os 

respectivos raios em um vetor de dados. Esse processo é realizado 

correlacionando-se a imagem de entrada com padrões circulares. Os pontos 

de maior correlação são então armazenados em disco conforme ilustrado no 

fluxograma da Figura 3.22. 

O método de reconhecimento de círculos inscritos é baseado em 

técnica por correlação no domínio da frequência desenvolvido em 

[CRUVINEL, 19991 e resumido pela Figura 3.23. 

O padrão a ser reconhecido no algoritmo é um círculo de raio valor 

Raio. O processo de correlação da imagem se dá no domínio da frequência 

com uso de Transformadas Rápidas de Fourier (FFT) e é ilustrado na Figura 

3.24. 



inicio v 
C 

Img = imagem de entrada 

4 
d 

Achar círculos inscritos. 

I - 
f 

sim 

não 

f Dados vetoriais dos 
Círculos inscritos 

Armazenar Centro e Raio 

Figura 3.22 : Processo de vetorização das imagens dos poros. 

inicio J 
I I 

figAX = imagem a ser processada 

figHH = imagem do padrão a ser reconhecido 

t 
Correlação entre figHH e figAX 

Busca maior valor de correlação 

Auto-correlaçáo 
Obter RaioReal da Tablel 

Dados vetoriais dos 
Circulos inscritos 

Figura 3.23 : Fluxo de dados do processo para achar círculos inscritos 

usando-se correlação por FFT. 



A Figura 3.25 e Figura 3.26 ilustram respectivamente os pseudocódigos 

usados nos processamentos das Transformadas Rápidas de Fourier 

Unidimensional (FFT 1 D) e Bidimensional (FFT 2D). 

inicio - 
ImgA = imagem A; ImgB = imagem 6 ;  

f 
imgA-FFT = FFT(lmgA) imgB-FFT = FFT( ImgB) 

J 

Figura 3.24 : Processo de correlação no domínio da freqüência de duas 

imagens; 

PSEUDOCÓDIGO DA FFT UNIDIMENSIONAL (FFT 1D) 
Entrada : vetor x,(k). Este vetor é complexo, com suas 
partes real e imaginária, e indexado por k= 0,1,2,. . . ,N-1. Se 
os dados são reais, a parte imaginária deve ser nula. O valor 
de N é uma potência de 2. 
FFTlD (x (k) ) : 
1. Declaração e inicilização de variáveis; 
N2 = N / 2  

for 1 = O to alfa do 
for i = O to N2 do 

m = INT (K/2"alfa) ; / /  valor inteiro de K/2^alfa 
p = bit-reverso de m; 

2. calcular Treal e Timag com WP*x(k+~2); 
x (k+N2) . Real = x (k) . Real - TReal; 
x(ktN2) .Imag = x(k) .Imag - TImag; 
x (k) .Real = x (k) .Real + TReal; 
x (k) . Imag = x (k) . Imag + TImag; 
k=ktl; 

end for; 
k =k+N2; 



IFSC-USP - MINATEL, E R - MODELO COMPUTACIONAL BASEADO E M  T ~ C N I C A S  WAVELETS PARA RELACIONAR IMAGENS DIGITAIS OBTIDAS EM DIFERENTES ESCALAS E RESOLUÇÕES 
8 9 

[ i £  k &gt;= N t h e n  
k = 0; 
alfa = alfa - 1; 
N2 = INT (N2/2) 

end i f ;  
end f o r  

3. Rearranjar vetor por bit-reverso; 
end FFTlD; 

Figura 3.25: Pseudocódigo da FFT unidimensional. 

PSEUDOCÓDIGO DA FFT BIDIMENSIONAL (FFT 2D) 
Entrada : Matriz x(kk,ll). Esta matriz é complexa, com suas 
partes real e imaginária, e indexada por kk= 0,1,2,. . .,N-1 e 
1 O 1 2  , . . . , - 1 .  Se os dados são reais, a parte imaginária 
deve ser nula. O valor de N é uma potência de 2. 
FFT2D (x (kk, 11) ) : 
1. Declaração e inicialização de variáveis; 
f o r  i = O t o  N-1 do 
f o r  j = O t o  N-1 do X(j) = x(i,j); 
FFTlD(X(j));//Calculo da FFT unid. das linhas 
f o r  j = O t o  N-1 do x(i, j)=X(j); 
end f o r  

f o r  i = O t o  N-1 do 
f o r  j = O t o  N-1 do X(j) = x(j,i); 
FFTlD(X(j));//Calculo da FFT unid. das linhas 
f o r  j = O t o  N-1 do x(i, j)=X(j); 
end f o r  

Figura 3.26: Pseudocódigo da FFT bidimensional. 

3.3.2.4. Usando Wavelets na vetorização 

Como visto, o processo de vetorização é baseado em correlações. Mesmo 

usando FFT, o custo computacional é alto. Neste contexto, o uso de 

Wavelets mostra-se adequado na otimização do processamento, 

aproveitando as características multiescalares das distribuições dos poros 

nas imagens em estudo. O processo otimizado é mostrado na Figura 3.27 e 

consiste em se processar a correlação em imagens de tamanhos pequenos. 

O reconhecimento dos círculos inscritos é realizado em faixas de raios 

determinados (até 16 pixels) sobre a mesma imagem transformada por 



Wavelets. O processamento se estende até um valor tolerado e previamente 

definido atribuído a variável Rtol. 

Irng = imagem de entrada, 
RI = Resol. Esp Irng: 
RT = Resol. Tolerada 

I I Achar circulos in:critos para raios I 1 I I Armazenar Centro e Raio t 

ntes de média 

Coord. e raios corrigidos 

Figura 3.27 : Processo de vetorização otimizado por Wavelets. 

Transformada 2D Wavelet Haar 

A transformada bidimensional usando Wavelet Haar tem seus processos de 

Decomposição e Composição mostrados respectivamente na Figura 3.28 e a 

Figura 3.30. Pode-se observar que esses processos bidimensionais são 

compostos pela combinação dos processos unidimensionais da Figura 3.29 

e da Figura 3.31. 



procedure ImageDecomposition 
parameters : 
Image : Imagem quadrada a ser transformada; 
Size : número de linhas/colunas; 
Steps : número de decomposições; 
begin 
h : =  Size; 
Cont : =  0; 
while (h &gt; 1) and (Cont &amp;lt;Steps) do 

ROWS TRANSFORM 
DecompositionlD; 
COLUMNS TRANSFORM 
DecompositionlD; 

h = h div 2; 
Cont = Cont + 1; 

end; 

end procedure . 

- -- - -- 

Figura 3.28: pseudocódigo para a implementação da Transformada 

Wavelets de uma imagem bidimensional. 

procedure DecompositionlD 
parameters : 
Array : vetor a ser transformado; 
Size : número de linhas; 

begin 
ArrayAux : =  ArraylD; 
for IND = 1 to Size div 2 do 
ArrayAux [IND] = (Array [2*IND-11 +Array [2*IND] ) 12; 
ArrayAux [h/2+IND] = 

(Array [2*IND-11 -Array [2*IND] ) /2; 
end; 
Array : =  ArrayAux; 
end procedure . 

Figura 3.29: pseudocódigo para a implementação da Transformada 

Wavelets unidimensional baseada na função básica wavelet Haar. 



IFSC-USP - MINATEL. E R - MODELO COMPUTACIONAL BASEADO E M  TCCNICAS WAVELETS PARA RELACIONAR IMAGENS DIGITAIS OBTIDAS EM DIFERENTES ESCALAS E RESOLUÇÓES 

9 2 

procedure ImageComposition 
parameters: 
Image : Imagem quadrada a ser transformada; 
Size : número de linhas/colunas; 
Steps : número de decomposições; 
begin 
h = Size div 2"Passos-1; 
while (h&amp;lt;= Size) do 

ROWS TRANSFORM 
CompositionlD; 
COLUMNS TRANSFORM 
CompositionlD; 
h = h * 2 ;  

end; 
end procedure . 

Figura 3.30: pseudocódigo para a implementação da Transformada 

Wavelets Inversa de uma imagem bidimensional. 

procedure CompositionlD 
parameters: 
Array : vetor a ser transformado; 
Size : número de linhas; 
begin 
ArrayAux := Array; 
h = Size div 2; 
for IND = 1 to h do 
ArrayAux [2*IND-l] =Array [IND] +Array [h+IND] ; 
ArrayAux [2*IND] =Array [IND] -Array [h+IND] ; 
end ; 
Array := ArrayAux; 
end procedure . 

Figura 3.31: pseudocódigo para a implementação da Transformada 

Wavelets Inversa unidimensional baseada na função básica wavelet Haar. 

Corrigir dados em função da escala 

Para se corrigir os dados em função da escala, basta multiplicar-se o raio 

encontrado por 2 a cada decomposição bidimensional por Transformada 

Wavelets aplicada a imagem em estudo. 



3.3.3. Extração de atributos e classificação 

O processo de classificação é uma etapa muito importante para a aplicação 

do modelo em experimentos reais. No entanto, dada a sua complexidade, 

concluiu-se que o módulo de classificação deverá ser estudado com mais 

afinco por pesquisadores da Computação juntamente com os da Agronomia 

(Ciências do Solo) em trabalhos futuros. 

Os parâmetros armazenados no banco de dados devem ser 

escolhidos tendo em vista que eles serão usados para classificar o meio 

poroso em estudo. Para isso devem representar atributos que permitam a 

classificação. 

Como exemplo de atributos que podem ser usados na classificação 

de meios porosos, lista-se: 

Densidade (DE) - número de poros por milímetro quadrado; 

Mediana (ME) - valor do raio mediano dos raios inscritos nos 

poros reconhecidos; 

Desvio padrão (SD) - dos raios inscritos dos poros reconhecidos; 

Associado a cada campo existe um outro campo que determina a 

tolerância usada para se assumir um dado como sendo da classe ID. 

Desta forma, o banco de dados teria os seguintes campos: 

I D 

(int) 
I I I I I I I 

I I I I I I I I 
(*dados fictícios para ilustração da composição dos campos do banco de dados.) 

DESC 

(Text) 

001* 

002* 1 Argila* 

A classificação pode ser realizada, na sua forma mais simples, 

comparando-se os atributos obtidos da imagem do meio porosos em testes 

com os atributos armazenados no bando de dados. Uma interface mostraria 

DE 

(float) 

Areia* 

100' 

DETol 

(float) 

20,5* 

1 O 1 15,5* 1 1 O 1 O 

ME 

(float) 

1 O 

5* 

METol 

(float) 

12,3* 

SD 

(float) 

1 O 

SDTol 

(float) 

15,5* 1 O 



IFSC-USP - MINATEL. E R - MODELO COMPUTACIONAL BASEADO EM TgCNICAS WAVELETS PARA RELACIONAR IMAGENS DIGITAIS OBTIDAS EM DIFERENTES ESCALAS E RESOLUCÓES r\ A 

na forma de, por exemplo, porcentagens o quanto aquele meio poroso se 

correlaciona com os previamente estudados. 

N = número de classes armazenadas no banco de dados; 
DELida = Densidade obtida da imagem em estudos 
for id = 1 t o  N do: 
begin : 
DEBD[id] = Densidade da classe i do banco de dados; 
Correlação [id] = DELida/DEBD [i] ; 

end . 

O algoritmo pode comparar os campos, como exemplificado no 

pseudocódigo acima, para o caso da densidade. Quando mais próximo do 

valor da Correlação[idl se aproximar do valor 1 (um) maior será a 

probabilidade do meio poroso em estudos ser classificado com sendo da 

classe representada por id. 



4. Resultados e Conclusões 

Neste capítulo são apresentados resultados do processamento do modelo 

computacional desenvolvido e as conclusões. 



IFSC-USP - MINATEL. E R - MODELO COMPUTACIONAL BASEADO EM TECNICAÇ WAVELETS PARA RELACIONAR IMAGENS DIGITAIS OBTIDAS E M  DIFERENTES ESCALAS E RESOLUÇÕES 
96 

4.1. Aplicação em imagem de Tomografia por Raios-X 

De forma a comprovar a aplicabilidade do modelo computacional em 

imagens reais de tomografia computadorizada por Raios-X, fez-se uso de 

um phantom heterogêneo. 

Adicionalmente é apresentada uma seqüência de imagens resultantes 

do processamento de dados reconstruídos de uma amostra de solo, a qual 

se caracteriza como sendo um meio poroso. 

Quanto ao phantom heterogêneo, o mesmo possui 6 cm de diâmetro 

e contem 5 diferentes coeficientes de atenuação linear em uma mesma 

energia considerada. A Figura 4.1 ilustra a distribuição para Ca, P, AI e água 

no cilindro de Plexiglass. 

........... 

Plexiglass 
4 k u = 0.140cm-' 

Figura 4.1: Diagrama esquemático da distribuição de Ca, P, AI, H,O e 

Plexiglass na composição do phantom estudado. 



Para a obtenção da imagem tomográfica os seguintes parâmetros 

foram utilizados: 

Translação total : 6 cm; 
Passo linear : 0 , l  cm; 
Rotação total : 180"; 
Passo de rotação : 3"; 
Número médio de fótons em feixe livre : 10.000; 
Tempo por passo linear: 1 Os; 
Energia : 60 keV; 

A reconstrução foi obtida pelo método de retroprojeção filtrada. A 

Figura 4.2 ilustra uma imagem do phantom reconstruída em 256 níveis de 

cinza de representação. 

Figura 4.2 : Phantom heterogêneo reconstruido por retroprojeção filtrada. 

(Imagem em 256 níveis de cinza). 

O modelo foi aplicado e as imagens de cada etapa são mostradas a 

seguir respectivamente para imagens obtidas nas resoluções 81x81, 49x49, 

25x25 e 13x13 pixels. A paleta de tons de cinza representam o mesmo 

escopo de coeficientes de atenuação liner (em cm-I) para todo o conjunto 

de imagens do phantom heterogêneo ensaio. 

A resolução definida como padrão foi de 400 colunas por 400 linhas 

(400x400 pixels), e a escala se mantém constante em todos as 



reconstruções, pois são do mesmo objeto (phantom). 

A seguir são apresentados os estudos de casos que ilustram os 

resultados dos processamentos sobre as imagens digitais ensaiadas. Assim, 

essas seqüências seguem as seguintes etapas: 

1. Imagens originais - Figura 4.3, Figura 4.11, Figura 4.19 e 
Figura 4.27 mostram as imagens originais reconstruídas 

respectivamente nas resoluções 81x81, 49x49, 25x25 e 13x1 3. 

Seus tamanhos representam proporcionalmente suas reais 

dimensões. 

2. Imagens com escalas e resoluções adequadas - na Figura 

4.4, Figura 4.12, Figura 4.20 e Figura 4.28 são mostradas as 

imagens rearranjadas para a escala e resolução padrão, no 

caso, de 400x400 pixels. 

3. Imagens após processo de segmentação - nesta etapa de 

análise foi aplicado filtro "thresholcf' com valor 1 10 nas imagens 

mostradas pela Figura 4.5, Figura 4.13, Figura 4.21 e Figura 

4.29. Alguns poros são segmentados, sendo destacados das 

imagens. Após este processamento, conforme resultados 

pode-se notar um excessivo e progressivo efeito de 

serrilhamento. 

4. Imagens após detecção de bordas - Nesta etapa do 
processamento de convolução no domínio espacial com filtro 

tipo Laplaciano sobre as imagens segmentadas foram geradas 

as imagens das bordas conforme ilustradas pelas Figura 4.6, 

Figura 4.14, Figura 4.22 e Figura 4.30. 

5 .  Imagens resultantes da suavização do efeito de 

serrilhamento (técnica Sub-Pixel) - Figura 4.7, Figura 4.15, 



IFSC-USP - MINATEL. E R - MODELO COMPUTACIONAL BASEADO E M  T ~ C N I C A S  WAVELETS PARA RELACIONAR IMAGENS DIGITAIS OBTIDAS E M  DIFERENTES ESCALAS E RESOLUÇÕES 
99 

Figura 4.23 e Figura 4.31 ilustram resultados do processo de 

suavização. Foram processadas as funções de vetorização das 

conexões 90 graus, seguidas do pré-processamento por 

Wavelets Haar e da interpolação bidimensional por B-Wavelets. 

6. Imagens reconstituídas - Figura 4.8, Figura 4.16, Figura 4.24 

e Figura 4.32 ilustram somente o resultado da interpolação por 

B-Wavelets. São processados preenchimentos de forma a 

reconstituir as imagens que são respectivamente apresentadas 

em Figura 4.9, Figura 4.17, Figura 4.25 e Figura 4.33. 

7. Imagens vetorizadas em função de círculos inscritos - 
nesta etapa, o processamento de vetorização localiza círculos 

inscritos e não sobrepostos sobre a imagem de entrada. 

Figura 4.10, Figura 4.18, Figura 4.26 e Figura 4.34 ilustram os 

círculos inscritos reconhecidos e marcados em destaque. 

8. Imagens na forma de dados vetoriais - como resultados dos 
processamentos são geradas as tabelas rotuladas, conforme 

ilustram Tabela 4.1, Tabela 4.2, Tabela 4.3 e Tabela 4.4, as 

quais mostram os dados das coordenadas cartesianas dos 

círculos reconhecidos e seus respectivos raios na unidade 

pixel. 

Figura 4.3 : Imagem original do phantom heterogêneo na resolução 81x81 

pixels (CORP025.IMG). 



IFSC-USP - MINATEL, E R - MODELO COMPUTACIONAL BASEADO E M  TCCNICAS WAVELETS PARA RELACIONARIMAGENSDIGITAISOBTIDAS EM MFERENTES ESCALAS E R E S O L U Ç ~ E S  A n n 

Figura 4.4: Imagem do phantom heterogêneo rearranjada para de 81x81 

para a resolução padrão de 400x400 pixels. 

Figura 4.5: Imagem do phantom heterogêneo (CORP025.IMG) submetida a 

filtro tipo "threshold" com valor 11 0 segmentando alguns poros. 



IFSC-USP - MINATEL. E R . MODELO COMPUTACIONAL BASEADO E M  T ~ C N I C A S  WAVELETS PARA RELACIONAR IMAGENS DIGITAIS OBTIDAS E M  DIFERENTES ESCALAS E RESOLUÇÕES 
1 o1 

Figura 4.6: Imagem do phantom heterogêneo (CORP025.IMG) segmentada 

após processamento por filtro laplaciano, tendo suas bordas destacadas. 

Figura 4.7: Imagem do phantom heterogêneo (CORP025.IMG) após os 

processamentos de vetorização das conexões 90 graus, pré-processamento 

por Wavelets Haar e interpolação por B-Wavelets. 



IFSC-USP - MINATEL. E R . MODELO COMPUTACIONAL BASEADO E M  TCCNICAS WAVELETS PARA RE!ACIONAR IMAGENS DIGITAIS OBTIDAS E M  DIFERENTES ESCALAS E RESOLUÇÓES 4 n 0 

Figura 4.8: Imagem do phantom (CORP025.IMG) representado apenas 

pelo resultado da interpolação B-Wavelets. 

Figura 4.9: Imagem do phantom heterogêneo (CORP025.1MG) suavizada e 

reconstituída. 



IFSC-USP - MINATEL. E R - MODELO COMPUTACIONAL BASEADO E M  TCCNICAS WAVELETS PARA RELACIONAR IMAGENS DIGITAIS OBTIDAS E M  DIFERENTES ESCALAS E RESOLUÇÓES 4 ,Q 

Figura 4.10: Imagem do phantom heterogêneo (CORP025.1MG) com o 

resultado da vetorização em destaque. 

Tabela 4.1: Distribuição dos centros e raios resultantes da vetorização dos 

poros segmentados do phantom heterogêneo. 

I d 

O0 1 

002 

003 

Figura 4.1 1 : Imagem original do phantom heterogêneo na resolução 49x49 

pixels (CORP037.IMG). 

Coluna 

115 

199 

199 

Linha 

199 

282 

114 

Raio 

62 

5 3 

53 



IFSC-USP - MINATEL, E R - MODELO COMPUTACIONAL BASEADO E M  T ~ C N I C A S  WAVELETS PARA RELACIONAR IMAGENS DIGITAIS OBTIDAS E M  DIFERENTES ESCALAS E RESOLUÇÕES 
1 04 

Figura 4.12: Imagem do phantom heterogêneo (CORP037.IMG) rearranjada 

de 49x49 pixels para a resolução padrão de 400x400. 

Figura 4.1 3: Imagem do phantom heterogêneo (CORP037.IMG) submetida 

a filtro tipo "threshold' com valor 11 0. 



IFSC USP - MINATEL E R MODELO COMPUTACIONAL BASEADO EM TECNICAS WAVELETS PARA RELACIONAR IMAGENS DIGITAIS OBTIDAS EM DIFERENTES ESCALAS E RESOLUÇÕES 
105 

Figura 4.14: Imagem do phantom heterogêneo (CORP037.IMG) após 

processamento por filtro laplaciano com suas bordas destacadas. 

Figura 4.15: Imagem do phantom (CORP037.IMG) após os processamentos 

de vetorização das conexões 90 graus, pré-processamento usando Wavelets 

Haar e interpolação por B-Wavelets. 



Figura 4.16: Imagem do phantom heterogêneo (CORP037.IMG) 

representado apenas pelo resultado da interpolação. 

Figura 4.17: Imagem do phantom (CORP037.IMG) suavizada e 

reconstituída. 



Figura 4.18: Imagem do phantom (CORP037.IMG) com o resultado da 

vetorização. 

Tabela 4.2 : Distribuição dos centros e raios resultantes da vetorização dos 

poros segmentados do phantom heterogêneo 49x49. 

Id 

001 

Figura 4.19 : Imagem original do phantom heterogêneo na resolução 25x25 

pixels (CORP075. IMG). 

Coluna 

115 

Linha 

199 

Raio 

60 



IFSC-USP - MINATEL. E R - MODELO COMPUTACIONAL BASEADO E M  TCCNICAS WAVELETS PARA RELACIONAR IMAGENS DIGITAIS OBTIDAS E M  DIFERENTES ESCALAS E RESOLUÇbES 
108 

Figura 4.20: Imagem do phantom heterogêneo (25x25) rearranjada para a 

resolução padrão de 400x400 pixels. 

Figura 4.21: Imagem do phantom heterogêneo (25x25) submetida a filtro 

tipo "threshold" com valor 110 segmentando alguns poros. 



IFSC-USP - MINATEL. E R - MODELO COMPUTACIONAL BASEADO EM TECNICAS WAVELETS PARA RELACIONAR IMAGENS DIGITAIS OBTIDAS EM DIFERENTES ESCALAS E RESOLUÇÕES 
109 

Figura 4.22: Imagem do phantom heterogêneo (25x25) segmentada após 

processamento por filtro laplaciano e tendo suas bordas destacadas. 

Figura 4.23: Imagem do phantom heterogêneo (25x25) após os 

processamentos de vetorização das conexões 90 graus, pré-processamento 

usando Wavelets Haar e interpolação por B-Wavelets. 



IFSC-USP - MINATEL E R MODELO COMPUTACIONAL BASEADO EM TCCNICAS WAVELETS PARA RELACIONAR IMAGENS DIGITAIS OBTIDAS EM DIFERENTES ESCALAS E RESOLUÇbES A 4 n 

Figura 4.24: Imagem do phantom heterogêneo (25x25) representado apenas 

pelo resultado da interpolação B-Wavelets. 

Figura 4.25: Imagem do phantom heterogêneo (25x25) suavizada e 

reconstituída. 



Figura 4.26: Imagem do phantom heterogêneo suavizada com o resultado da 

vetorização em destaque. 

Tabela 4.3 : Distribuição dos centros e raios resultantes da vetorização dos 

poros segmentados do phantom heterogêneo 25x25. 

Id 

O01 

002 

003 

Figura 4.27 : Imagem original do phantom heterogêneo na resolução 13x13 

pixels (CORPO1 5.IMG). 

Coluna 

119 

198 

199 

Linha 

198 

277 

114 

Raio 

58 

5 3 

50 



IFSC-USP - MINATEL, E R - MODELO COMPUTACIONAL BASEADO EM TCCNICAS WAVELETS PARA RELACIONAR IMAGENS DIGITAIS OBTIDAS EM DIFERENTES ESCALAS E RESOLUÇÕES 
112 

Figura 4.28: Imagem do phantom heterogêneo (1 3x1 3) rearranjada para a 

resolução padrão de 400x400 pixels. 

Figura 4.29: Imagem do phantom heterogêneo (1 3x1 3) submetida a filtro 

tipo "threshold" com valor 11 0 segmentando alguns poros. 



Figura 4.30: Imagem do phantom heterogêneo (1 3x1 3) segmentada após 

processamento por filtro laplaciano e tendo suas bordas destacadas. 

Figura 4.31: Imagem do phantom heterogêneo (13x13) após os 

processamentos de vetorização das conexões 90 graus, pré-processamento 

usando Wavelets Haar e interpolação por B-Wavelets. 



IFSC-USP - MINATEL E R - MODELO COMPUTACIONAL BASEADO EM TtCNICAS WAVELETS PARA RELACIONAR IMAGENS DIGITAIS OBTIDAS EM DIFERENTES ESCALAS E RESOLUÇÕES 
114 

Figura 4.32: Imagem do phantom heterogêneo (1 3x1 3) representado apenas 

pelo resultado da interpelação B-Wavelets. 

Figura 4.33: Imagem do phantom heterogêneo (1 3x13) reconstituída. 



IFSC-USP - MINATEL. E R - MODELO COMPUTACIONAL BASEADO EM TECNICAS WAVELETS PARA RELACIONAR IMAGENS DIGITAIS OBTIDAS EM DIFERENTES ESCALAS E RESOLUÇOES 
115 

Figura 4.34: Imagem do phantom heterogêneo (13x13) suavizada com o 

resultado da vetorização em destaque. 

Tabela 4.4 : Distribuição dos centros e raios resultantes da vetorização dos 

poros segmentados do phantom heterogêneo 13x1 3. 

I d 

001 

002 

003 

Linha 

199 

280 

115 

Coluna 

132 

198 

200 

Raio 

55 

46 

47 



IFSC-USP - MINATEL. E R - MODELO COMPUTACIONAL BASEADO E M  TECNICAS WAVELETS PARA RELACIONAR IMAGENS DIGITAIS OBTIDAS E M  DIFERENTES ESCALAS E RESOLUÇÕES 
116 

4.1.1. Avaliação dos resultados obtidos com o ensaio do 

phantom heterogêneo 

Observando-se os valores obtidos com o ensaio do phantom heterogêneo, 

tem-se que o número de círculos inscritos se manteve estável no valor 3, ou 

seja, o objeto pode ser representado na forma vetorial por 3 círculos. 

A Tabela 4.5 mostra que a distribuição espacial dos centros dos 

círculos inscritos, assim como os seus respectivos raios mantiveram-se 

dentro de uma tolerância de 15%, com média aritmética dos erros em 1.2%. 

Tabela 4.5 : Valores das colunas (Cx), linhas (Lx) e raios (Rx) em função das 

colunas, linhas e raios da imagem de maior resolução ( C I ,  L1 e R I ) .  A 

função E é dada por E(a,b) = (b-a)/a. 



IFSC.USP - MINATEL E R - MODELO COMPUTACIONAL BASEADO EMTCCNICAS WAVELETS PARA RELACIONAR IMAGENS DIGITAIS OBTIDAS EM DIFERENTES ESCALAS E RESOLUÇÕES 
117 

4.1.2. Imagens de amostras de meios porosos (solos) 

Um conjunto de quatro amostras não deformadas de latosolo vermelho 

distrófico coletadas em perfil de solo em diferentes profundidades (5cm, 

25cm, 30cm e 37cm) na forma de um cubo (15x15x15cm), tiveram suas 

imagens tomográficas adquiridas a partir dos seguintes parâmetros: 

Translação total : 8 cm; 
Passo linear : 0,2 cm; 
Rotação total : 180"; 
Passo de rotação : 4.5"; 
Número médio de fótons em feixe livre : 10.000; 
Tempo por passo linear: 1 Os; 
Energia : 60 keV; 

Os ensaios foram realizados em um tomógrafo computadorizado 

dedicado a Ciência do Solo, localizado na Embrapa Instrumentação 
24 1 Agropecuária, S. Carlos, SP, em energia de 6OkeV com fonte de Am 

(Amerício). 

A Figura 4.35 ilustra a distribuição dos níveis de cinza em função dos 

coeficientes de atenuação. 

Figura 4.35 : Imagem de amostra de solo reconstruída por retroprojeção 

filtrada. (Imagem em 256 níveis de cinza). 



IFSC-USP - MINATEL, E R - MODELO COMPUTACIONAL BASEADO EM T~CNICAS WAVELETS PARA RELACIONAR IMAGENS DIGITAIS OBTIDAS EM DIFERENTES ESCALAS E RESOLUÇÓES 
118 

Mantendo-se a mesma ordem adotada para os estudos com o 

phantom heterogêneo, as imagens de amostras de solo resultantes dos 

processamentos são apresentadas na seqüência apresentada abaixo: 

1. Imagens originais - Nas figuras de legenda Figura 4.36, Figura 4.45, 
Figura 4.54 e Figura 4.63 são mostradas as imagens originais 

reconstruídas e todas na resolução 22x22. 

2. Imagens com escalas e resoluções adequadas - Figura 4.37, 

Figura 4.46, Figura 4.55 e Figura 4.64 ilustram as imagens 

rearranjadas para a escala e resolução padrão de 400x400 pixels. 

3. Imagens após processo de segmentação - aplicado-se filtro 
"thresholi' com valor 110 nas imagens mostradas por Figura 4.38, 

Figura 4.47, Figura 4.56 e Figura 4.65. Poros são destacados nas 

imagens. 

4. Imagens após detecção de bordas - o processamento de filtro tipo 
Laplaciano sobre as imagens gerou as imagens das bordas ilustradas 

por: Figura 4.39, Figura 4.48, Figura 4.57 e Figura 4.66. 

5. Imagens resultantes da suavização do efeito de serrilhamento 

(técnica Sub-Pixel) - Figura 4.40, Figura 4.49, Figura 4.58 e Figura 
4.67 ilustram imagens resultantes do processo de suavização. Foram 

processadas as funções de vetorização das conexões 90 graus, 

seguidas do pré-processamento por Wavelets Haar e da interpolação 

bidimensional por B-Wavelets. 

6. Imagens reconstituídas - Figura 4.41, Figura 4.50, Figura 4.59 e 

Figura 4.68 contém somente o resultado da interpolação por B- 

Wavelets. São processados preenchimentos de forma a reconstituir 

as imagens que são respectivamente representadas pela Figura 4.42, 

Figura 4.51, Figura 4.60 e Figura 4.69. 



7. Imagens vetorizadas em função de círculos inscritos - o 
processamento de vetorização é realizado e os resultados mostrados 

em Figura 4.43, Figura 4.52, Figura 4.61 e Figura 4.70 onde se tem os 

círculos inscritos destacados. 

8. Imagens na forma de dados vetoriais - As tabelas rotuladas de 

Tabela 4.6, Tabela 4.7, Tabela 4.8 e Tabela 4.9 contém 

respectivamente os dados das coordenadas cartesianas dos círculos 

reconhecidos e seus raios em pixels. 

Figura 4.36 : Imagem original de amostra de solo na resolução 22x22 pixels 

(SOLO.IMG). 

Figura 4.37: Imagem da amostra de solo rearranjada 

resolução padrão de 400x400 pixels. 

para 



IFSC-USP - MINATEL, E R - MODELO COMPUTACIONAL BASEADO E M  TECNICAS WAVELETS PARA RELACIONAR IMAGENS DIGITAIS OBTIDAS E M  DIFERENTES ESCALAS E RESOLUÇÓES 
120 

Figura 4.38: Imagem de amostra de solo (SOLO.IMG) submetida a filtro tipo 

"threshold" com valor 110 segmentando alguns poros. 

Figura 4.39: Imagem de amostra de solo (SOLO.IMG) segmentada após 

processamento por filtro laplaciano, tendo suas bordas destacadas. 



Figura 4.40: Imagem do amostra de solo (SOLO.IMG) após os 

processamentos de vetorização das conexões 90 graus, pré-processamento 

por Wavelets Haar e interpolação por B-Wavelets. 

Figura 4.41: Imagem de amostra de solo (SOLO.IMG) representada apenas 

pelo resultado da interpolação 6-Wavelets. 



Figura 4.42: Imagem de amostra de solo (SOLO.IMG) suavizada e 

reconstituída, tendo apenas o maior poro destacado. 

Figura 4.43: Imagem de poro em amostra de solo (SOLO.IMG) com o 

resultado da vetorização em destaque. 



Tabela 4.6 : Distribuição dos centros e raios resultantes da vetorização dos 

poro segmentado da amostra de solo (SOLO.IMG). 

Id 

O01 

002 

003 

004 

005 

006 

007 

008 

009 

O1 O 

O1 1 

012 

O1 3 

014 

O1 5 

O1 6 

017 

O1 8 

019 

A Figura 4.44 ilustra o histograma da distribuição de poros por 

tamanho de raio identificado na primeira amostra de solo analisada. 

Distribuitlo dos ralos I 

Coluna 

333 

285 

286 

360 

177 

304 

350 

251 

356 

242 

354 

283 

284 

320 

331 

192 

31 5 

209 

246 

Figura 4.44 : Gráfico de distribuição das quantidades pelos tamanhos de 

raios dos círculos inscritos, em pixels, resultantes da vetorização. 

Linha 

1 o1 

174 

6 1 

22 1 

160 

309 

162 

232 

271 

273 

33 

122 

375 

3 1 

338 

290 

364 

117 

37 1 

Raio 

34 

32 

25 

2 5 

24 

24 

22 

22 

2 1 

18 

16 

15 

15 

14 

14 

13 

10 

9 

8 



Figura 4.45 : Imagem original de amostra de solo na resolução 22x22 pixels 

(U3.1MG). 

Figura 4.46: Imagem da amostra de solo (U3.1MG) rearranjada de 22x22 

para a resolução padrão de 400x400 pixels. 

Figura 4.47: Imagem de amostra de solo (U3.1MG) submetida a filtro tipo 

"threshold" com valor 11 0 segmentando alguns poros. 



IFSC-USP - MINATEL. E R - MODELO COMPUTACIONAL BASEADO EM TCCNICAS WAVELETS PARA RELACIONAR IMAGENS DIGITAIS OBTIDAS EM DIFERENTES ESCALAS E RESOLUÇÓES 
125 

Figura 4.48: Imagem de amostra de solo (U3.1MG) segmentada após 

processamento por filtro laplaciano, tendo suas bordas destacadas. 

Figura 4.49: Imagem do amostra de solo (U3.1MG) após os processamentos 

de vetorização das conexões 90 graus, pré-processamento por Wavelets 

Haar e interpolação por B-Wavelets. 



Figura 4.50: Imagem de amostra de solo (U3.1MG) representada apenas 

pelo resultado da interpolação B-Wavelets. 

Figura 4.51: Imagem de amostra de solo (U3.1MG) suavizada e 

reconstituída. 



Figura 4.52: Imagem de poro em amostra de solo (U3.1MG) com o resultado 

da vetorização em destaque. 

Tabela 4.7 : Distribuição dos centros e raios resultantes da vetorização dos 

poro segmentado da amostra de solo (U3.1MG). 

Id 

001 

002 

003 

004 

005 

006 

007 

008 

009 

O1 O 

O1 1 

012 

013 

014 

Raio 

31 

28 

24 

20 

20 

19 

19 

19 

18 

16 

11 

10 

9 

9 

Coluna 

239 

316 

275 

308 

140 

53 

7 1 

59 

131 

177 

351 

118 

31 6 

153 

Linha 

54 

163 

293 

5 7 

65 

71 

196 

362 

353 

171 

354 

26 

245 

263 



A Figura 4.53 ilustra o histograma da distribuição de poros por 

tamanho de raio identificado na segunda amostra de solo analisada. 

I Distribuiçao dos raios I 

Figura 4.53: Distribuição dos centros e raios resultantes da vetorização dos 

poro segmentado da amostra de solo (U3.1MG). 

Figura 4.54 : Imagem original de amostra de solo na resolução 22x22 pixels 

(U6.IMG). 

Figura 4.55: Imagem da amostra de solo (U6.IMG) rearranjada de 22x22 

para a resolução padrão de 400x400 pixels. 



Figura 4.56: Imagem de amostra de solo (U6.IMG) submetida a filtro tipo 

"threshold" com valor 11 0 segmentando alguns poros. 

Figura 4.57: Imagem de amostra de solo (U6.IMG) segmentada após 

processamento por filtro laplaciano, tendo suas bordas destacadas. 



IFSC-USP - MINATEL E R - MODELO COMPUTACIONAL BASEADO EM TPCNICAS WAVELETS PARA RELACIONAR IMAGENS DIGITAIS OBTIDAS EM DIFERENTES ESCALAS E RESOLUÇOES 

130 

Figura 4.59: Imagem de amostra de solo (U6.IMG) representada apenas 

pelo resultado da interpolação B-Wavelets. 

C 
7-= 

Figura 4.58: Imagem do amostra de solo (U6.IMG) após os processamentos 

de vetorização das conexões 90 graus, pre-processamento por Wavelets 

Haar e interpolação por B-Wavelets. 



Figura 4.60: Imagem de amostra de solo (U6.IMG) suavizada e 

reconstituída, tendo apenas o maior poro destacado. 

Figura 4.61: Imagem de poro em amostra de solo (U6.IMG) com o resultado 

da vetorização em destaque. 



IFSC-USP - MINATEL. E R - MODELO COMPUTACIONAL BASEADO E M  TECNICAS WAVELETS PARA RELACIONAR IMAGENS DIGITAIS OBTIDAS E M  DIFERENTES ESCALAS E RESOLUÇÕES 
132 

Tabela 4.8 : Distribuição dos centros e raios resultantes da vetorização dos 

poro segmentado da amostra de solo (U6.IMG). 

Id 

00 1 

002 

003 

004 

005 

006 

007 

008 

A Figura 4.62 ilustra o histograma da distribuição de poros por 

tamanho de raio identificado na terceira amostra de solo analisada. 

Coluna 

246 

126 

1 O0 

71 

92 

75 

11 

45 

Distribuição dos raios 

Figura 4.62: Distribuição dos centros e raios resultantes da vetorizaçáo dos 

Linha 

227 

82 

339 

260 

132 

191 

11 

45 

poro segmentado da amostra de solo (U6.IMG). 

Raio 

139 

44 

42 

37 

16 

12 

12 

1 O 

Figura 4.63 : Imagem original de amostra de solo na resolução 22x22 pixels 

(U9.IMG). 



IFSC-USP - MINATEL, E R - MODELO COMPUTACIONAL BASEADO E M  TECNICAS WAVELETS PARA REIACIONAR IMAGENS DIGITAIS OBTIDAS E M  DIFERENTES ESCALAS E RESOLUÇÓES 
133 

Figura 4.64: Imagem da amostra de solo rearranjada de 22x22 para a 

resolução padrão de 400x400 pixels (U9.IMG). 

Figura 4.65: Imagem de amostra de solo (U9.IMG) submetida a filtro tipo 

"threshold" com valor 110 segmentando alguns poros. 



IFSC-USP - MINATEL, E R - MODELO COMPUTACIONAL BASEADO E M  TCCNICAS WAVELETS PARA RELACIONAR IMAGENSDIGITAIS OBTIDAS E M  DIFERENTES ESCALAS E RESOLUÇOES 
1 34 

Figura 4.66: Imagem de amostra de solo (U9.IMG) segmentada após 

processamento por filtro laplaciano, tendo suas bordas destacadas. 

Figura 4.67: Imagem do amostra de solo (U9.IMG) após os processamentos 

de vetorização das conexões 90 graus, pré-processamento por Wavelets 

Haar e interpolação por B-Wavelets. 

5 E H ' J i . Ç c  P:Li i : i i Z I . . ( ~ j ~ l ' E : ~ ! - r  
I 2.; ;.. .:'I ; 1 2 fi, i;; ,h. ;&gt; 



IFSC-USP - MINATEL, E R - MODELO COMPUTACIONAL BASEADO E M  TgCNICAS WAVELETS PARA REiACIONAR IMAGENS DIGITAIS OBTIDAS E M  DIFERENTES ESCALAS E RESOLUÇÓES 
135 

Figura 4.68: Imagem de amostra de solo (U9.IMG) representada apenas 

pelo resultado da interpolação B-Wavelets. 

Figura 4.69: Imagem de amostra de solo (U9.IMG) suavizada e 

reconstituída, tendo apenas o maior poro destacado. 



Figura 4.70: Imagem de poro em amostra de solo (U9.IMG) com o resultado 

da vetorização em destaque. 

Tabela 4.9 : Distribuição dos centros e raios resultantes da vetorização dos 

poro segmentado da amostra de solo (U9.IMG). 

Id 

O01 

002 

003 

004 

005 

006 

007 

008 

009 

010 

01 1 

Coluna 

243 

149 

82 

87 

347 

51 

267 

332 

162 

37 

306 

Linha 

104 

31 3 

180 

68 

303 

339 

198 

357 

36 

259 

269 

Raio 

74 

70 

65 

44 

30 

28 

23 

22 

2 1 

19 

9 



IFSC-USP - MINATEL, E R - MODELO COMPUTACIONAL BASEADO E M  TECNICAS WAVELETS PARA RELACIONAR IMAGENS DIGITAIS OBTIDAS E M  DIFERENTES ESCALAS E RESOLUÇÕES 137 

A Figura 4.71 ilustra o histograma da distribuição de poros por 

tamanho de raio identificado na quarta amostra de solo analisada. 

Distribui~ão dos raios 

Figura 4.71: Distribuição dos centros e raios resultantes da vetorização dos 

poro segmentado da amostra de solo (U9.IMG). 

A Figura 4.72 mostra gráfico com superposições dos histogramas das 

imagens SOLO.IMG, U3.1MG, U6.IMG e U9.IMG. Pode-se observar a 

variação da distribuição do tamanho e quantidade dos poros nas amostras 

de solo ensaiadas. 

Distribuição de raios 

r n  4 '&gt;A 
u um" L U  

Raios (pixels) 

-e Sequêncial + Seqüência2 
-A- Seaüência3 -e- Seqüência4 

Figura 4.72: Gráfico com os histogramas sobrepostos das distribuições dos 

raios das amostras de solo. Sequêncial indica os resultados de SOLO.IMG; 

Sequência 2 de U3.1MG; Sequência 3 de U9.IMG e Sequência 4 de U6.IMG. 



IFSC-USP - MINATEL, E R - MODELO COMPUTACIONAL BASEADO E M  TCCNICAS WAVELETS PARA RELACIONAR IMAGENS DIGITAIS OBTIDAS E M  DIFERENTES ESCALAS E RESOLUÇÓES 
138 

4.1.3.Avaliação de desempenho usando otimização por 

Wavelets 

Para cálculo do ganho em tempo de processamento no processo de 

vetorização usando-se Wavelets, os seguintes custos computacionais são 

assumidos em numero de iterações: 

Custo computacional: 

Assume-se ainda, objetivando-se uma comparação, que sejam 

identificadas raios de tamanho 1 ao 128 pixels (M=128). O tamanho da 

imagem em processamento é de 1024x1 024 pixels (N=1024). 

FFT (Transformada Rápida de Fourier) 

IFFT (Inversa da FFT) 

Varredura em todos os pixels 

Transformada Wavelets 

Processo "Achar círculos inscritos" 

4.1.3.1. Para o processo sem otimização por Wavelets: 

N log, N 

N log, N 

N~ 

N, 

3* N log, N +2* N 2  

O número de iterações (N/) no caso otimizado é dado por M vezes o 

Processo "Achar círculos inscritos", desta forma: 

FFT (Transformada Rápida de Fourier) 10.240 / 
I 

( Processo "Achar círculos inscritosn(ACl) I 2.127.872 1 

IFFT (Inversa da FFT) 
I 

10.240 

Varredura em todos os pixels 1.048.576 



4.1.3.2. Para o processo com otimização por Wavelets: 

Para cobrir o mesmo escopo de 128 tamanhos de raios o algoritmo 

otimizado processa os seguintes cálculos: 

Processamenfo 1 

Na primeira etapa o número de linhas e colunas da imagem se 

mantém inalterado. Para cobrir o escopo inicial de 16 diferentes raios é 

necessária a aplicação de 16 vezes o processo de "Achar círculos inscritos" 

(ACI) o que totaliza pouco mais de 34 milhões de iterações conforme 

mostrado pela tabela abaixo. 

N = 1024 (número de colunas e linhas) 

M = 16 (número de raios reconhecidos) 

Processamenfo 2: 

FFT (Transformada Rápida de Fourier) 

IFFT (Inversa da FFT) 

Varredura em todos os pixels 

Processo "Achar círculos inscritosW(ACI) 

NI = M*ACI 

O algoritmo de otimização, após processados os 16 primeiros raios, 

efetua uma transformada Wavelets Haar na imagem original, o que equivale, 

para uma imagem de 1024x1024pixels aproximadamente 1 milhão de 

iterações. Sobre os coeficientes de detalhes da imagem transformada, que 

agora possui 512 colunas por 512 linhas é processado o 8 vezes o ACI, o 

que equivale a varrer os raios de valores 16 a 32 pixels. A tabela abaixo 

contabiliza o custo computacional deste processamento, o que equivale a 

5,3 milhões de operações. 

10.240 

10.240 

1 .048.576 

2.127.872 

34.045.952 



IFSC-USP - MINATEL. E R - MODELO COMPUTACIONAL BASEADO E M  TSCNICAS WAVELETS PARA RELACIONAR IMAGENS DIGITAIS OBTIDAS EM DIFERENTES ESCALAS E RESOLUÇÕES 
140 

N = 512 (número de colunas e linhas) 

M = 8 (número de raios reconhecidos) 

Processamento 3: 

Transformada Wavelets (TW) 

FFT (Transformada Rápida de Fourier) 

IFFT (Inversa da FFT) 

Varredura em todos os pixels 

Processo "Achar círculos inscritos"(AC1) 

NI = M*ACI+TW 

Para o reconhecimento dos raios equivalentes ao escopo do raio 32 

ao 64, são necessários, segundo a aplicação do algoritmo de otimização, 

oito vezes o processamento ACI sobre imagem de 256x256 pixels mais uma 

transformada Wavelets (TW) sobre a imagem de 512x512. Isso totaliza (vide 

tabela abaixo) pouco mais de 1 milhão de iterações. 

1.048.576 

4.608 

4.608 

262.144 

538.1 12 

5.353.472 

N = 256 (número de colunas e linhas) 

M = 8 (número de raios reconhecidos) 

Processamento 4: 

Transformada Wavelets (TW) 

FFT (Transformada Rápida de Fourier) 

IFFT (Inversa da FFT) 

Varredura em todos os pixels 

Processo "Achar círculos inscritosl'(ACI) 

NI = M*ACI+TW 

Finalizando o reconhecimento dos raios de 64 a 128, são necessários 

mais 8 vezes o ACI e uma TW, considerando que agora a imagem possui 

uma resolução de 128x128 pixels, resultantes dos processamento da 

262.144 

2.048 

2.048 

65.536 

137.216 

1.359.872 



IFSC.USP - MINATEL. E R - MODELO COMPUTACIONAL BASEADO EM TECNICAS WAVELETS PARA RELACIONAR IMAGENS DIGITAIS OBTIDAS E M  DIFERENTES ESCALAS E RESOLUÇbES 
141 

Transformada Wavelet anterior. A tabela abaixo mostra os respectivos 

valores. 

N = 128 (número de colunas e linhas) 

M = 8 (número de raios reconhecidos) 

Após o Processamento 4 o escopo de 128 raios foi totalizado 

(1 6+2*8+4*8+8*8). Desta forma somando-se os resultados e comparando-os 

tem-se: 

Transformada Wavelets (TW) 

FFT (Transformada Rápida de Fourier) 

IFFT (Inversa da FFT) 

Varredura em todos os pixels 

Processo "Achar círculos inscritos"(AC1) 

NI = M*ACI+TW 

65.536 

896 

896 

16.384 

35.456 

349.1 84 

Recalculando-se o custo computacional do algoritmo sem otimização 

para o mesmo número de raios efetivamente reconhecidos pelo algoritmo 

otimizado, ou seja, 40 raios (16 + 8 + 8 + 8), o resultado da comparação 

passa a ter os valores descritos na tabela a seguir. 

Algoritmo 

Não otimizado (A) 

Otimizado (B) 

Ganho computacional [IOO-(B/A*100)] 

Número de iterações 

272.367.61 6 

41.108.480 

84,09% 

Algoritmo 

Não otimizado (A) 

Otimizado (6) 

Ganho computacional [ I  00-(B/A*100)] 

Número de iterações 

85.1 14.880 

41 .I 08.480 

51,70% 



4.1.4. Conclusões 

Em face aos resultados obtidos, as seguintes conclusões parciais podem ser 

enumeradas: 

1. Quanto a organização da implementação do modelo - implementou- 

se o modelo computacional em linguagem de programação C++ 

orientada a objetos o que permitiu que todas as etapas do 

processamento e suas funções fossem organizadas em métodos 

contidos em classes. Dessa forma obteve-se um conjunto utilizável de 

ferramentas em múltiplas plataformas computacionais; 

2 .  Quanto a suavização por sub-pixel - a suavização do efeito de 
serrilhamento realizada pelo método de interpolação usando-se B- 

Wavelets mostrou-se adequada aos propósitos do modelo, pois pré- 

processa a imagem de entrada de forma a permitir uma vetorização 

representativa em função dos círculos inscritos; 

3. Quanto a vetorização por círculos inscritos - dadas as características 

morfológicas dos poros, e pelo fato de ser baseada em uma técnica 

de cálculo de porosidade, a vetorização por círculos inscritos mostrou- 

se adequada; 

4. Quanto ao pré-processamento dos dados para interpolação usando 

Transformada Wavelets Haar (TW) - o resultado da vetorização das 
conexões 90 graus fornecem as coordenadas cartesianas das 

intersecções entre duas retas perpendiculares e são tratados de 

forma a adequá-los pela TW Haar permitindo o passo posterior de 

interpolação; 

5. Quanto aos ensaios com phantom heterogêneo reconstruído em 

diferentes resoluções - as imagens processadas geraram, a partir da 

aplicação do modelo, resultados que foram apresentados na Tabela 

4.5. A análise destes resultados permite concluir que a estrutura dos 



poros foram mantidas, podendo-se representá-los a partir de 3 

círculos. Os valores mostram ainda que os raios encontrados assim 

como as coordenadas cartesianas dos seus centros mantiveram-se 

com um erro médio de 1,2%. Esse erro é baixo considerando-se que 

a variação das resoluções foi da ordem de 6 vezes; 

6. Quanto aos ensaios com meios porosos (solos) - o modelo 

computacional uma vez aplicado em imagens de tomografia 

computadorizada de amostras de solos, conforme resultados 

apresentados nas figuras Figura 4.36, Figura 4.45, Figura 4.54 e 

Figura 4.63 ilustram a potencialidade do método para análise de 

amostras reais de meios porosos. Pode-se observar a possibilidade 

de se calcular os raios inscritos e se visualizar a distribuição dos raios 

e centros de cada círculo encontrado, o que permite a obtenção de 

parâmetros de interesse para a área de Física de Solos; 

7. Quanto ao ganho computacional - foi calculado, com base em 

número de iterações, o custo computacional da aplicação do modelo 

sem otimização e com o processo otimizado. Para uma imagem de 

1024x1024pixels o ganho computacional máximo foi da ordem de 

84%. Esse ganho é diretamente proporcional ao tamanho da imagem 

de entrada; 

8. Quanto ao uso de Wavelets - o uso de Wavelets Haar no pré- 

processamento dos dados para interpolação e no algoritmo de 

otimização de desempenho no processamento de vetorização por 

círculos inscritos e da B-Wavelets na interpolação dos dados para 

suavização mostrou-se adequada e se caracterizou como uma das 

contribuições originais da pesquisa desenvolvida. 

Finalmente, como conclusão geral, tem-se que o desenvolvimento desta 

pesquisa viabilizou a geração de um modelo computacional para relacionar 

imagens digitais em diferentes escalas e resoluções, se apresentando como 



um método de auxílio a tomada de decisões em processos que envolvam o 

estudo de meios porosos. 

4.1.5. Proposta de desenvolvimentos futuros 

O Estudo da resolução ótima para representar classes de meios 

porosos. 

o Estudar os melhores métodos de classificação para serem usados 

com o banco de dados gerado pelo sistema. 

o Descrição de contornos com diversas técnicas a exemplo de 

interpolação polinomial. 



Referências Bibliográficas 

[AYLMORE-19931 AYLMORE, L.A.G. "Use of computer-assisted tomography in studying 
water movement around plant roots." Advances in Agronomy, San Diego, v.49, p.1-52, 
1993. 

[BEAR-19681 Bear. J., D. Zasiavsky and L. Irmay. 1968. Physical Principies of Water 
Percolation and Seepage. UNESCO-Paris. 

[BEAR-19691 Bear, J. 1969. Hydrodynamic dispersion. In: R.J.M. De Wiest (Ed.): Flow 
through porous media, Academie Press, New York and London. 

[BEAR-19721 Bear, J. 1972. Dynamics of Fluids in Porous Media. Elsevier Science., New 
York. Bear, J. and Y. Bachmat 1967 A generalized theory of hydrodynamic dispersion in 
porous media. Proc. Intl. Assoc. Sci. Hydrol. Symp. Haifa, publ. No.72. 

[BERTOLUZZA-20001 Bertoluzza, S; Canuto, C; Urban, "On the adaptive computation of 
integrais of waveltes", Applied Numerical Mathematics, 34, pp. 13-38, 2000. 

[BEVEN-19821 Beven, K. and P. Germann. 1982. Macropores and water flow in soils. Water 
Resour. Res. 18:1311-1325. 

[BOULFELFEL-19941 - BOULFELFEL, D.; RANGAYYAN, R.M.; HAHN, L.J.; KUDUVALLI, 
G.R., "Two-Dimensional Restoration of Single Photon Emission Computed Tomography 
Images Using the Kalman Filter", IEEE Transactions on Medical Imaging, v.13, n.1, p.102- 
108, 1994. 

[BUDINGER-19741 - BUDINGER, T.F.; GULLBERG, G.T., "Three Dimensional 
Reconstruction in Nuclear Emission Imaging", IEEE Transactions on Nuclear Science, 
v.NS-21, n.3, p.2-20, June 1974. 

[BUENO-19951 - BUENO, J.M., "Reconstrução e Visualização Tridimensional de Imagens 
Tomográficas Baseada no uso de Transformada Rápida de Fourier", São Carlos, USP, 
Tese de Mestrado, 130 páginas, 1995. 

[BURGER-19891 - BURGER,P., GILLIES,D., "lnteractive Computer Graphics - Functional, 
Procedural and Device-Level Methods", Addison-Wesley Publishing Company, 1989. 

[CAÇÃO-19941 - CAÇÃO,G.R., "Desenvolvimento de um algoritmo para a reconstrução 
tridimensional para imagens de um minitomógrafo baseado no método de reconstrução 
algébrica modificado e interpelação", São Carlos, SP, UFSCar, Depto. Computação, Tese 
de Mestrado, 122 páginas, 1994. 

[CHO-19741 - CHO, Z.H., "General Views on 3D Image Reconstruction and Computerized 
Transverse Axial Tomography", IEEE Transactions on Nuclear Science, v.NS-21, p.44-71, 
Jun. 1974. 

[CHO-19751 - CHO, Z.H.; CHAN, J.K., "A comparative study of 3-D Image Reconstruction 
Algorithm with Reference to Number of Projections and Noise Filtering", IEEE Transactions 
on Nuclear Science, v.NS-22, p.344-363, Feb. 1975. 

[CHUI-1992al - CHUI, C.K., "An introduction to Wavelets", Academic Press- 1992 



[CHUI-1992bl - CHUI, C.K., "Wavelets : A Tutoria1 in Theory and Applications", Academic 
Press- 1992. 

[COOLEY-19651 - COOLEY, J.W.; TUKEY, J.W. "An algorithm for Machine Calculation of 
Complex Fourier Series", Math. of Computational, v. 19, p. 297-301, 1965. 

[COOLEY-1967al - COOLEY, J.W.; LEWIS, P.A.W.; WELCH, P.D. "Application of the Fast 
Fourier Transform to computation of Fourier Integrals, Fourier Series, and Convolution 
Integrals", IEEE Transactions on Audio and Electroacoustics, v.AV-15, n.2, p.79-84, Jun., 
1967. 

[COOLEY-1967bl - COOLEY, J.W.; LEWIS, P.A.W.; WELCH, P.D. "Historical Notes on the 
Fast Fourier Transform", IEEE Transactions on Audio and Electroacoustics, v.AV-15, n.12, 
p.76-79, Jun., 1967. 

[COOLEY-1969al - COOLEY, J.W.; GARDIN, R.L.; RADER, C.M.; BOGERT, B.P.; 
STOCKHAM JR.,T.G. "The 1968 Arden House Workshop on Fast Fourier Transform 
Processing", IEEE Transactions on Audio and Electroacoustics, v.17, n.2, p.66-76, Jun., 
1969. 

[COOLEY-1969bl - COOLEY, J.W.; LEWIS, P.A.W.; WELCH, P.D. "The Fast Fourier 
Transform and Aplications", IEEE Transactions on Education, v.12, p.27-34, 1969. 

[COREY-19631 Corey, J.C., D.R. Nielsen and J.W. Biggar. 1963. Miscibie displacement in 
saturated and unsaturated sandstone. Soil Sei. Soe. Am. Proc. 27:258-262. 

[COREY-19771 Corey, A.T. 1977. Mechanics of Heterogenous Fluids in Porous Media. Water 
Resour. Publ., Fort Collins, Colorado. 

[COREY-19851 Corey, A.T. and A. Klute. 1985. Appiication of the potential concept to soil 
water equilibrium and transport. Soil Sei. Soe. Am. J. 49:3-11. 

[CORMACK-19731 - CORMACK, A.M., "Reconstruction of Densities from their Projections, 
with Applications in Radiological Physics", Phys. Med. Biol., v.18, n.2, p.195-207, 1973. 

[CRESTANA-19851 CRESTANA, S.; MASCARENHAS, S. POZZI-MUCELLI, R. S. "Static 
and dynamical three dimensional studies of water in soil using computed tomography 
scanning". Soil Science, Baltimore, v.140, n.5, p.326-32, 1985. 

[CRESTANA-1986al CRESTANA, S. "A Tomografia Computadorizada com um novo método 
para estudos da física da água no solo", São Carlos, USP, Tese de Doutorado, 140 
páginas, 1986. 

[CRESTANA-1986bl CRESTANA, S.; CESAREO, R:; MASCARENHAS, S. "Using a 
computed miniscanner in soil science." Soil Science, Baltimore, v.142, n.1, p.56-61, 1986. 

[CRESTANA-19881 CRESTANA, S.; MASCARENHAS, S.; CESAREO, R.; CRUVINEL, P.E. 
"Soil research opportunities using X-ray and gamma-ray computed tomography 
techniques". In: RUIDOSO INTERNATIONAL CONFERENCE, Ruidoso, Novo México, May 
1988. Proceedings ... Ruidoso: s.n. 1988. p.121-128. 

[CRESTANA-1990al CRESTANA, S.; KAUTEN, R.; NIELSEN, D.R. "Microtomografia de 
ressonância magnética nuclear para investigações não-destrutivas em engenharia de 
alimentos e agricultura". In: ENCONTRO NACIONAL SOBRE ESCOAMENTO EM MEIOS 
POROSOS-ENEMP, 18, Nova Friburgo-RJ, out. 1990. Nova Friburgo: Colégio Anchieta, 
1990. v.2, p.689-698. 

[CRESTANA-1990bl CRESTANA, S.; NIELSEN, D.R. "Investigações não-destrutivas de 
sistemas porosos multifásicos atrav6s de microtomografia de raios-&gt;(, gama e ressonância 



magnética nuclear (RMN)". In: ENCONTRO NACIONAL SOBRE ESCOAMENTO EM 
MEIOS POROSOS-ENEMP, 18, Nova Friburgo-RJ, out. 1990. Nova Friburgo: Colégio 
Anchieta, 1990. v.2, p.699-710. 

[CRESTANA-19921 CRESTANA, S.; CRUVINEL, P.E.; VAZ, C.M.P.; CESAREO, R.; 
MASCARENHAS, S.; REICHARDT, K. "Calibração e uso de um tomógrafo 
computadorizado em ciência do solo." Revista Brasileira de Ciência do Solo, Campinas, 
v.16, n.2, p.161-167, maiolago. 1992. 

[CRESTANA-19961 CRESTANA, S.; CRUVINEL, P.E. "Tomografia: do hospital a lavoura." 
Ciência Hoje, Rio de Janeiro, v.21, n.121, p.20-24, 1996. 

[CROWTHER-19701 - CROWTHER, R.A.; DeROSIER, D.J; KLUG, A,, "The Reconstruction 
of a Three-Dimensional structure from projections ant its applications to electron 
microscopy", Proc. Roy. Soc. Lond. A317, p.319-340, 1970. 

[CRUVINEL-19871 - CRUVINEL, P.E., "X and y-rays computerized minitomoraphy scanner 
for multidiciplinary use", Ph.D. thesis, University of Campinas, Brazil, 1987. 

[CRUVINEL-1990al CRUVINEL, P.E., CESAREO, R., CRESTANA, S.; MASCARENHAS, S., 
"X and Gamma-rays computerized minitomograph scanner for soil science", IEEE 
Transactions on Instrumentation and Measurement, V.39, N.5, p.745-750, October, 1990. 

[CRUVINEL-1996al CRUVINEL, P.E.; CRESTANA, S. Opportunities and use of digital signal 
processors in tomography scanners dedicated to agriculture. In: WORKSHOP 
BRASILEIRO DE ARQUITETURAS ALTERNATIVAS USANDO DSPs, São Carlos-SP, 
ago. 1996. Anais São Carlos: UFSCar, 1996. p.93-97 

[CRUVINEL-1996bl CRUVINEL, P.E.; CRESTANA, S. The use of a TMS320C40 in X and y 
rays computerized minitomography scanner (MTC) dedicated to agriculture. In: ANNUAL 
TMS320 EDUCATORS CONFERENCE, 6, Houston, Texas, USA, Aug. 1996. 
Proceedings, Houston: Texas Instruments, 1996. não paginado. 

[CRUVINEL-19991 CRUVINEL, P.E.; VIEIRA, S.R., CRESTANA, S.; MINATEL, E.R.; 
MUCHERONI, M.L.; TORRE, A.N.; "lmage processing in automated measurements of 
raindrop size and distribution", Elsevier, Computer and Electronics in Agriculture, 23 (1999) 
205-217. 

[DANIELSON-19421 - DANIELSON, G.C.;LANCZOS,C. "Some improvements in practical 
Fourier analysis and their application to X-ray scattering from liquids", J. Franklin Inst., 
v.233, p.365-380 and 435-452, April, 1942. 

[DEHNERT-19731 - DEHNERT, J.; BOYD, D., "A Comparison Study of Some Computer 
Reconstruction techniques", Jul. 1973. 

[DELESSE-18481 Delesse, A. 1848. Procédé mécanique pour déterminer Ia composition des 
roches. Ann. Mines 13:379-388. 

[FREDRICH, J.T., MENDÉZDEZ, 6. &amp;amp; WONG, T.F.; "lmaging the pore structure of 
geomaterials", Science, 268, 276-279 - 1995 

[GAARDER-19721 - GAARDER, N.T.; HERMAN, G.T., "Algorithms for Reproducing Objects 
From Their X-Rays", Computer Graphics and Image Processing, p.97-106, 1972. 

[GIARDINA-19881 GIARDINA,R.C. and DOUGHERTY,E.R; "Morphological Methods in Image 
and Signal Processing", Englewood Cliffs, New Jersey: Prentice-Hall. 321 - 1988. 



[GLICK-19891 - GLICK, S.J.; KING, M.A.; PENNEY, B.C., "Characterization of Modulation 
Transfer Function of Discrete Filtered Backprojection", IEEE Transactions on Medical 
Imaging, v.8, n.2, p.203-213, Jun. 1989. 

[GONZALEZ-19871 - "Digital Image Processing", Addison-Wesley Publishing Company, 1987 

[GORDON-19741 - GORDON, R., "A Tutoria1 on ART (Algebraic Reconstruction 
Techniques)", IEEE Transactions on Nuclear Science, v.NS-21, p.78-93, 1974. 

[GORDON-19751 - GORDON, R., "Three-Dimensional Reconstruction from Projections: A 
Review of Algorithms", p.111-151, 

[HAINES-19231 Haines, W.B. 1923. The volume changes associated with variations of water 
content in soil. J. Agric. Sei. 13:293-310. 

[HAINSWORTH-19831 - HAINSWORTH, J.M.; AYLMORE, L.A.G., "The use of the 
computed-assisted tomography to determine spatial distribution of soil water content", Aust. 
Journal Soil Res. n.21, p.1435-1443, 1983. 

[HEIJMANS-19941 HEIJMANS,H.J.A.M., "Morphological Image Operators", Advances in 
Electronics and and Electron Phisics. Academic Press, Boston - 1994. 

IHOUNSFIELD-19731 HOUNSFIELD, G.N., "Computerized Transverse Axial Scannina 
- (Tomography): ~ a i t  I. Description of systemV, ~ r i h s h  Journal of Radiology, n.46, p.lO1&amp;amp; 

1022, 1973. 

[JANOTA-19241 Janota, R. 1924. Advances in Soil Reclamation (in Czech). Proceedings, 
Nfinistry of Agriculture, No. 34, Prague. 

[JENSSEN-19881 JENSSEN, P.D., &amp;amp; HEYERDAHL, P.H.; "Soil column descriptions from X- 
ray computed tomography density images", Soil Science, 146, pp.106-107 - 1988 

[KAK-19861 KAK,A.C.; ROBERTS, B.A., "Reconstruction from Projections: Applications in 
Computerized Tomography", Handbook of Pattern Recognition, Academic Press, Chap. 27, 
p.649-693, 1986. 

[KALENDER-19881 KALENDER, W.A.; KLOTZ, E.; KOSTARIDOU, L. "An Algorithm for 
Noise Supression in Dual Energy CT Material Density Images", IEEE Transactions on 
Medical Imaging, v.7, n.3, p.218-224, Sep. 1988. 

[KATCHINSKI-19651 Katchinski, N.A. 1965. Soil physies (in Russian). Vysshaya Shkoia 
(College Publishers), Moscow. 

[KUBIENA-19701 Kubiena, W.L. 1970. Micromorphological Features of Soil Geography. 
Rutgers Univ. Press, Brunswick, New Jersey. 

[KUT~LEK-1962Al Kutílek, M. 1962a. Hygroscopic soil water (in Czech). Vodohosp. Cas. 
1 0 : l l - 2 9  and 156-1 73. 

[ K U T ~ L E K - 1 9 6 2 ~ 1  Kutíiek, M. 1962b. A new method for determination of the soil specific 
surface (in Czech). RostlinnB v@roba (Piant Production) 33:767-772. 

[KUT~LEK-19631 Kutilek, M. 1963. The influente of soil colloids on the value of the contact 
angle and on the capiliary rise of water in soils. Proc. 5 Congr. ICID, Tokyo, p. 1785-1790. 

[ K U T ~ L E K - I ~ ~ ~ ]  Kutílek, M. 1964. The filtration of water in soils in the region of the laminar 
flow. Trans. Sth Congress of Soil Sci., ISSS, Bucarest, U:45-51. 



[KUT~LEK-19691 Kutílek, M. 1969. Influente of clay minerais upon the statics and dynamies 
of soil water (in Czech). Research Report, Techrúcal Univ., Prague. 

[KUT~LEK-1 9721 Kutílek, M. 1972. Non-Darcian flow of water in soils-larninar region. In: 
Fundamentais of Transport Phenomena in Porous Media. Elsevier, Amsterdam, p. 327- 
340. 

[KUT~LEK-19731 Kutílek, M. 1973. The influente of elay minerais and exchangeabie cations 
on soil moisture potential. In: A. Hadas, D. Swartzendruber, P.E. Rijtema, M. Fuchs and B. 

[KUT~LEK-19941 KUTILEK, M.; NIELSEN, D.R.; "Soil Hydrology", Die Deutsche Bibliothek, 
1994. 

[LEWITT-19831 LEWITT, R.M., "Reconstruction Algorithms: Transform Methods", 
Proceedings of the IEEE, v.71, n.3, Mar. 1983. 

[LIMA-20021 LIMA, P.C.; "Wavelets: Teoria, Algoritmos e Aplicações", Apostila de curso, 
Depart. Matemática - ICEX - UFMG - Fev. 2002 

[LIU-19941 Liu, J.-Wen Y., Sam T.S. Wong and L.J. Waldron. 1994. The application of NMR 
imaging to studying the effect of plant roots on preferential water flow in soil. In: ASA 
Tomography Workshop 1992, in press. 

[MARAR-19961 MARAR, J.F., "Wavelets Polinomiais: Uma Família de Funções Splines para 
Aplicações em Processamento de Imagens", Anais do SIBGRAP1'96, p.305-312, 1996. 

[MILLER-19561 MILLER, E.E.; MILLER, R.D., "Physical theory for capillary flow phenomena", 
J. Appl. Phys. 27:324-332, 1956. 

[MINATEL-19971 MINATEL, E.R.; CRUVINEL, P.E.; "Digital Image Filtering with Adaptive 
Technique and Wavelet Transforms applied in Scientific Visualization by means of Virtual 
Reality", Workshop sobre Realidade Virtual, Universidade Federal de São Carlos, Outubro, 
1997. 

[MINATEL-1997bl MINATEL, E.R.; "Desenvolvimento de Algoritmo para Reconstrução e 
Visualização Tridimensional de Imagens Tomográficas com uso de Técnicas Frequenciais 
e Wavelets", São Carlos, UFSCar, Tese de Mestrado, 148 páginas - 1997. 

[MINATEL-1998al MINATEL, E.R.; CRUVINEL, P.E.; "Three-dimensional reconstruction and 
Visualization of Tomographic Images System using Frequential Techniques and Wavelets", 
SIBGRAP1'98 proceedings1lEEE Computer Society, p. 38-45, IMPA, Rio de Janeiro, 
October, 1998. 

[MINATEL-1998bl MINATEL, E.R.; CRUVINEL, P.E.; "Reconstrução e Visualização de 
Dados de Tomografia Aplicada ao Estudo de Solos usando B-Wavelets", II SIAGRO - 
Simpósio Nacional de Instrumentação Agropecuária, EMBRAPA- Instrumentação 
Agropecuária, São Carlos, Dezembro, 1998. 

[OPPENHEIN-19741 OPPENHEIN, B.E., "More Accurete Algorithms for Iterative 3- 
Dimensional Reconstruction", IEEE Transactions on Nuclear Science, v.NS-21, p.72-77, 
Jun. 1974. 

[OPPENHEIM-19751 OPPENHEIM, A.V.; SCHAFER, R.W.; "Digital Signal Processing", 
Prentice Hall, 1975. 

[PETROVIC-19821 PETROVIC, A.M.; SIEBERT, J.E.; RIEKE, P.E., "Soil bulk analysis in 
three-dimensions by computed tomographic scanning", Soil Sci. Soc. Am. J. , n.46, p.445- 
450, 1982. 



[POSADAS-19901 POSADAS, D.A. "Estudo da cinetica de fusão e de congelamento da 
água em um meio poroso não-saturado: experimentação e simulação". São Carlos: USP- 
IFQSC, 1990. Dissertação Mestrado. 

[POSADAS-19941 POSADAS, D.A., TANNUS, A., LOTUFO, R.A., PANEPUCCI, H.C. &amp;amp; 
CRESTANA, S.; "3D wetting from instabilities in layered soils investigated by NMR and X- 
rays tomography", Transactions of 15th International Congress of Soil Science, Vo. 2b, 
Acapulco, pp 195-196 - 1994. 

[POSADAS-19961 POSADAS, D.A.; TANNUS, A.; PANEPUCCI, H.; CRESTANA, S. 
"Magnetic resonance imaging as a non-invasive technique for investigating 3-D preferential 
flow occurring within stratified soil samples." Computers and Electronics in Agriculture, 
Amsterdam, v. 14, 17.4, p.255-267, 1996. 

[PRATT-19911 PRATT, W.K., "Digital Image Processing", JohnWiley &amp;amp; Sons, Inc., 2nd 
edition, 1991. 

[RADON-19171 RADON, J., "On the determination of functions from their integrals along 
Certain Manifolds", Ber.Saechs. Akad. Wiss. Leipzig Math. Phys., v.60, p.262-277, 1917. 

[RINGROSE-19841 Ringrose-Voase, A. and P. Bullock. 1984. The measurement of soli 
structural parameters by image anaiysis. In: J. Bouma and P.A.C. Raats (Eds.): 
Proceedings of the ISSS Symposium on Water and Solute Movement in Heavy Clay Soil. 
ILPI Publication 37, Wageningen, p. 350-3,54. 

[ROSIWAL-18981 Rosiwal, A. 1898. Uber geometrische Cesteinsanalysen. Verha.ndi. Geol. 
Reichsamt, Wien, p. 143-175. 

[RUDNICK-19661 RUDNICK, P. "Note on the calculation of Fourier series", Mathematics of 
Computation, Providence, v.20, p.429-430, June 1966. 

[RUNGE-19031 RUNGE, C., Zeit. fur Math. und Physics, v.48, p.443, 1903. 

[RUNGE-19051 RUNGE, C., Zeit. fur Math. und Physics, v.53, p. 11 7, 1905. 

[RUNGE-19241 RUNGE,C; KONIG,H., "Die Grundlehren der Mathematischen 
Wissenschaften" Vorlesungen iiber Numerisches Rechnen, v.1 I ,  Belin: Junlius Springer, 
1 924. 

[SAHINER-1993al SAHINER, B. and YAGLE, A.E., "On the use of Wavelets in inverting the 
Radon Transform", IEEE , p.1129-1131, 1993. 

[SAHINER-1993bl SAHINER, B. and YAGLE, A.E., "lmage Reconstruction from Projections 
under Wavelets Constraints", IEEE Transactions in Signal Processing, v.41, n.41, p.3579- 
3584, Dec. 1993. 

[SCHACHTSCHABEL-19841 Schachtschabel, P., H.P. Blume, K.H. Hartge, U. Schwertmann, 
C. Brummer and M. Renger. 1984. Lehrbuch der Bodenkunde, 11. Auflage. Enke, 
Stuttgart. 

[SCHEIDEGGER-19541 Scheidegger, A.E. 1954. Statistical hydrodynamics in porous media. 
J. Appi. Phys. 25:994. 

[SERRA-A9821 SERRA,J.; "lmage Analysis and Mathematical Morphology", Academic Press, 
London - 1982. 

[SHEPP-19741 - SHEPP, L.A.; LOGAN, B.F., "The Fourier Reconstruction of a Head 
Section", IEEE Transactions on Nuclear Science, v.NS-21, p.21-43, Jun. 1974. 



[SOUZA-19931 SOUZA, G.S de, "An Introduction to Wavelets", Presented at MAA Biloxi, MS, 
March 5-6, 1993. 

[SPANNE-19941 Spanne, P., K.W. jones, L.D. Prunty and S.H. Anderson. 1994. Potential 
applications of synchrotron computed microtomography to soil science. In: S.H. Anderson 
and J.W. Hopmans (eds.): Tomography of Soil-Water- Root Processes. SSSA Special 
Publ. No. 36, ASA and SSSA, Madison, Wisconsin, p. 43-57. 

[SPANNE-19941 SPANNE, P., THOVERT, J.F., JACQUIN, C.J., LINDQUIST, W.B., JONES, 
K.W. &amp;amp; ADLER, P.M.; "Synchrotron computed microtomography of porous media" 
Topology and transport, Physical Review Letters, 73, 2001-2004 - 1994. 

[STEUDE-19941 Steude, J., F. Hopkins and J. Anders. 1994 Industrial X-ray computed 
tomography applied to soil research. In: S.H. Anderson anel J.W. Hopmans (eds.): 
Tomography of Soil-Water-Root Processes. SSSA Special Publ. No. 36, ASA and SSSA, 
Madison, Wisconsin, p. 43-57. 

[STOCKHAM-19721 STOCKHAM, T.G., "lmage Processing inthe Context of a Visual Model", 
Proc. IEEE, 60: p828-842 - 1972 

[STOLLNITZ-1995al STOLLNITZ, E.J., DeROSE, T.D., SALESIN, D.H., "Wavelets for 
Computer Graphics : A Primer, Part 1" - IEEE Computer Graphics and Applications, p.76- 
84, May. 1995. 

[STOLLNITZ-1995bl STOLLNITZ, E.J., DeROSE, T.D., SALESIN, D.H., "Wavelets for 
Computer Graphics : A Primer, Part 2" - IEEE Computer Graphics and Applications, p.73- 
85. Ju1.1995. 

[TELLO-19861 - TELLO, R.; MANN, R.W.; ROWELL, D; "Scheme for Three Dimensional of 
Surfaces from CT and MRI Images of the Human Body", IEEE, p.216-219, 1986. 

[THOMAS-19631 THOMAS, L.H. "Using a computer to solve problems in physics", 
Application of Digital Computers. Boston, Mass.: Ginn, 1963. 

[TILLOTSON-19841 TILLOTSON, P.M.; NIELSEN, D.R.; "Scale factor in soil science", Soil 
Sci. Soc. Am. J. 48:953-959, 1984. 

[TOKUNAGA-19881 Tokunaga, K.I. 1988. X-ray stereoradiographs using new contrast media 
on soil macropores. Soil Sei. 146:199-206. 

[UNSER-20001 Unser, M; Blu, T; "Fractional Splines and Wavelets", SIAM Review, Vol. 42, 
N. 1, pp 43-67, 2000. 

[VOGEL-19911 VOGEL, T.; C~SLEROVA, M.; HOPMANS, J.W.; "Porous media with linearly 
variable hydraulic properties", Water Resour. Res. 27:2735-2741, 1991. 

[WARRICK-19771 WARRICK, A.W., MULLEN, G.J., NIELSEN, D.R.; "Scaling field properties 
using a similar media concept", Water Resour. Res. 13:355-362, 1977. 

[WICKERHAUSER-19941 WICKERHAUSER, M.L.; "Adapted Wavelet Analysis from Theory 
to Software", IEEE Press - EUA - 1994. 

[WILDING-19841 WILDING, L.P. AND C.T. HALLMARK. 1984. Development of structural 
and microfabric properties in shrinking and swelling clays. In: J. Bouma and P.A.C. Raats: 
Water anel Solute Movement in Heavy Clay Soils. ISSS Symp. Proceedings of the ISSS 
Symposium on Water and Solute Movement in Heavy Clay Soils. International Institute for 
Land Reciamation anel Improvement (ILRI) Publication 37, Wageningen, p. 1- is. 



[YONGSHENG-19931 - YONGSHENG, H.. "Applications of Wavelets in Harrnonic Analysis 
and Signal Analysis", Presented at MAA Biloxi, MS, March 5-6, 1993. 

[YOUNG-2003) - YOUNG, I.T.;GERBRANDS, J.J.; VAN VLIET, L.J.; "lmage Processing 
Fundamentais", http://www.ph.tn.tudelft.nllCourses/FIP/noframeslp.html, Pattern 
Recognition Group, Dept of Imaging Science and Technology, Faculty of Applied Sciences, 
The Netherlands, 2003. 

[YULE-19801 Yule, D.F. and J.T. Ritchie. 1980. Soil shrinkage relationships of Texas 
vertisols: Srnail cores. Soil Sci. Soc. Am. J. 44:1285-1291. 


</field>
	</doc>
</add>