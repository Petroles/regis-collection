<?xml version="1.0" encoding="utf-8"?>
<add>
	<doc>
		<field name="docid">BR-TU.20543</field>
		<field name="filename">4120_Pinto_AntonioCarlosCapeleiro_M.pdf</field>
		<field name="filetype">PDF</field>
		<field name="text">UNIVERSIDADE ESTADUAL DE CAMPINAS FACULDADE DE ENGENHARIA MECÂNICA DEPARTAMENTO DE ENGENHARIA DE PETRÓLEO
Dissertação Apresentada à Faculdade de Engenharia Mecânica Como Requisito Parcial à Obtenção do Título de Mestre em Engenharia de Petróleo
ESQUEMAS DE ALTA RESOLUÇÃO PARA CONTROLE DA DISPERSÃO NUMÉRICA EM SIMULAÇÃO DE RESERVATÓRIOS
ésãe	‘ÇwaQ da..
r. fí £&gt;r	O^.utiU&gt;cxe Wwm
Autor : Antonio Carlos Capeleiro Pinto tv Orientador : Antonio Cláudio de França Corrêa i

novembro de 1991
UNIVERSIDADE ESTADUAL DE CAMPINAS FACULDADE DE ENGENHARIA MECÂNICA DEPARTAMENTO DE ENGENHARIA DE PETRÓLEO
A dissertação “Esquemas de Alta Resolução para Controle da Dispersão Numérica em Simulação de Reservatórios”, elaborada por Antonio Carlos Capeleiro Pinto e aprovada por todos os membros da Banca Examinadora foi aceíta pela Sub-Comissão de Pós-Graduação em Engenharia de Petróleo como requisito parcial à obtenção do Título de Mestre em Engenharia de Petróleo.
Campinas, 12 de novembro de 1991.
Banca Examinadora
Antonio Cláudio de França Cotrêa, Ph.D.
Maria Cristina de Castro Cunha, Ph.D.
Paulo Jorge Serpa Paes Leme, Ph.D.
A minha esposa Márcia
e
a meus pais
ui
AGRADECIMENTOS
Ao Prof. Dr, Antonio Cláudio de França Corrêa pela sugestão do tema, orientação, dedicação e incentivo à realização do trabalho.
A Prof. Dra. María Cristina de Castro Cunha um agradecimento especial pela dedicação e interesse no esclarecimento de nossas tantas dúvidas, tendo proporcionado um auxílio inestimável à fundamentação matemática do trabalho.
Ao Prof. Dr, Fernando Rodríguez de La Garza, pelas sugestões e frutíferas discussões.
Ao Analista de Sistemas Carlos Eduardo Pereira, pela colaboração e sugestões.
Ao Engenheiro Walter Petrone Lemos, pela valiosa colaboração.
Aos colegas do curso de mestrado, pela amizade e companheirismo.
Aos professores e funcionários do Departamento de Engenharia de Petróleo da ÜNICAMP, pela dedicação.
À PETROBRÁS, pela oportunidade e suporte à realização desse trabalho.
À ÜNICAMP, pelo suporte tecnológico.
Sumário
0 esquema tradicional de simulação de reservatórios por diferenças finitas utiliza o método de ponderação a montante para aproximar os componentes do termo de fluxo convectivo nas interfaces entre os blocos. Esse procedimento estabiliza a solução numérica, mas introduz graves erros de dispersão numérica, dificultando a correta interpretação dos resultados simulados.
Os esquemas exponenciais são alternativas razoáveis quando o termo difusivo domina. No entanto, conforme demonstramos neste trabalho, tendem para o método de ponderação a montante quando o fluxo é muito convectivo.
Os métodos de diferenças finitas de ordem mais alta, como o esquema de Leonard. reduzem a dispersão numérica, mas podem produzir soluções fisicamente incorretas quando a equação de conservação assume a forma hiperbólica. Demonstramos, através da solução de algumas equações não-lineares clássicas, que isto ocorre porque a condição de entropia não é obedecida. A condição de entropia é um critério matemático que permite selecionar a solução correta entre as soluções fracas do problema.
Os esquemas de Diminuição das Variações Totais (TVD) possuem a notável propriedade de produzirem soluções de alta resolução que obedecem ao princípio da entropia e, consequentemente, são fisicamente corretas.
Apresentamos uma comparação do desempenho de diversos métodos de diferenças finitas para resolver alguns problemas de engenharia de reservatórios, como: equação da convecção-difusão em 1D, equação de Buckley-Leverett e fluxo de tra-çador em 2D. Os esquemas TVD foram também implementados em um modelo “black-oil” bifásico, e os resultados são discutidos para várias formulações, como IMPES, semi-implícito e totalmente implícito. Incluímos no modelo a opção de injeção de traçadores na fase água, considerando o tensor dispersão completo e adsorção com a rocha.
São feitas comparações com as soluções obtidas com o método de ponderação a montante e malha refinada e, sempre que possível, com soluções analíticas. 0 efeito de orientação de malha é estudado. São incluídos diversos exemplos práticos.
Abstract
Standard finite-diference reservoir simulation normally uses single-point upstream weighting to approximate the components of the convective flow term at the interfaces between blocks. This procedure stabilizes the numerical solution, but introduces high levels of numerical dispersion, difficult!ng the correct interpretation of the simulated results.
Exponential schemes are reasonable when diffusion dominates, but, as we show in this work, reduce to single-point uspstream when the flow is too convective.
Higher-order finite-difference methods, like Leonard’s scheme, are, in general, able to reduce the numerical dispersion, but may produce non-physical solutions when the conservation equation assumes a hyperbolic form. We demonstrate, through the numerical solution of some classical non-linear equations, that this occurs because the entropy condition is violated. The entropy condition is a mathematical criteria to select the correct solution among weak solutions of the problem.
Total Variation Diminishing (TVD) methods have the remarkable property of producing high resolution solutions which obey the entropy condition, and, consequently, are physically consistent.
A comparison of the performance of the various methods is presented for some reservoir engineering problems: ID convection-diffusion equation, Buckley-Leverett equation and 2D single-phase tracer flow, TVD schemes were also implemented on a two-phase black-oil model, and results are discussed for various formulations, such as IMPES, semi-implicit and fully-implicit. We also included options of tracer injection in the water phase, considering full dispersion tensor and adsorption with the rock.
Comparisons are made with refined grid single-point upstream solutions and, whenever possible, with analytical solutions. Grid orientation effect is investigated. Practical examples are also included.
Conteúdo
1	INTRODUÇÃO	1
2	REVISÃO BIBLIOGRÁFICA	3
3	DISPERSÃO NUMÉRICA E ORIENTAÇÃO DE MALHA - MOTIVA-
ÇÃO	6
3.1	Dispersão Numérica.......................................    6
3.2	Orientação de Malha............ ..........................   7
3.3	Discretização do Termo Temporal ........................... 11
4	MÉTODOS NUMÉRICOS PARA	DISCRETIZAÇÃO DO TER-
MO CONVECTIVO EM EQUAÇÕES	DE	CONSERVAÇÃO	13
4.1	O Método de Ponderação a Montante.........................  13
4.2	O Método de Chaudhari....................................   15
4.3	O Método de Allen-Figueiredo............................    16
4.4	O Método de Patankar.....................................   17
4.5	0 Método de Dois Pontos a Montante ........................ 18
4.6	0 Método de Saad-Leonard ...............................    20
4.7	O Método de Gupta-Leonard ..............................    24
4.8	O Método de Leonard Modificado . .....................    .	25
4.9	A Correção de Segunda Ordem no Tempo......................  26
4.10	Esquemas TVD (“Total Variation Diminishing”).............. 26
4.11	O Método TVD de Rubin e Blunt . .......................    30
4.12	O Método TVD de Terceira Ordem . ......................... 31
5	LEIS DE CONSERVAÇÃO - PRINCÍPIOS MATEMÁTICOS 32
5.1	Soluções Fracas.....................................      ■	32
5.2	O Princípio de Rankine-Hugoniot.........................    33
5.3	O Princípio da Entropia....... ..........................   34
5.4	Problemas de Riemann - Tipos de Choques ..................  36
5.5	Esquemas Conservativos............-........................ 37
5.6	Esquemas Monótonos .....................................    38
5.7	Equação de Burgers......................................... 39
5.8	Equação proposta por Harten et alii . ..................    41
6	ANÁLISE DA EQUAÇÃO DA CONVECÇÃO - DIFUSÃO LINEAR,
EM 1D	50
6.1	Dedução da Equação e Solução Semi-Analítica...............	. 50
6.2	Solução Numérica......................................      52
6.3	Discussão dos Resultados . ............................     53
7	ANÁLISE DA EQUAÇÃO DE BUCKLEY - LEVERETT	63
7.1	Dedução da Equação...................................       63
7.2	Solução Semi-Analítica - Caso Convectivo .................. 67
7.3	Solução Numérica ........................................   68
7.4	Propriedades Utilizadas .................................   70
7.5	Discussão dos Resultados . ..............................   70
8	ANÁLISE DO DESLOCAMENTO DE UM TRAÇADOR EM
FLUXO MONOFÁSICO INCOMPRESSÍVEL, EM 2D	81
8.1	Determinação do Campo de Pressões ........................  81
8.1.1	O Modelo de Poço .................................... 82
8.1.2	Dados de Entrada para os Testes...................... 83
8.1.3	Validação do Campo de Pressões. . ..................  83
8.2	Determinação das Concentrações do Traçador ...............  84
8.2.1	Solução Numérica ...................................  85
8.3	Solução Semi-Analítica.................................     89
8.4	Discussão dos Resultados..................................  91
8.5	Orientação de Malha........................................ 95
8.6	Injeção do Traçador Através de uma Face em 2D ............. 98
9	IMPLANTAÇÃO DOS MÉTODOS DE ALTA RESOLUÇÃO
EM UM MODELO “BLACK - OIL”	100
9.1	O Método TVD de Rubin e Blunt..............................101
9.2	Método TVD de Rubín e Blunt nas Permeabilidades Relativas . .....102
9.3	Método TVD de Terceira. Ordem com Região TVD de Sweby nas Permeabilidades Relativas . .................................104
9.4	Esquema IMPES....................................................104
9.5	Esquema Totalmente Implícito.....................................105
9.5.1	Métodos TVD no Esquema Totalmente Implícito...............105
9.6	Discussão dos Resultados - Caso	1	- Horizontal	(Planta).107
9.7	Discussão dos Resultados - Caso	2	- Seção Vertical...............114
9.8	Solução Semi-Analítica ........................................  117
9.9	Comparações com as Soluções Semi-Analíticas.	Orientação de Malha. , . , 122
10	TRAÇADORES NA FASE ÁGUA NO MODELO “BLACK - OIL” 130
10.1	Formulação Matemática........................................130
10.2	Adsorção .....................................................  131
10.3	Solução Numérica........................................... .. 132
10.3.1	Cálculo das Propriedades .............................    132
10.3.2	Esquema Explícito...................................... . 133
10.3.3	Esquema Implícito.......................................  135
10.4	Simulações de Casos com Injeção de Traçadores ............... 137
11	CONCLUSÕES	148
12	RECOMENDAÇÕES	151
13	APÊNDICES	156
A SOLUÇÃO DA EQUAÇÃO DE CONSERVAÇÃO POR SEPARA-
ÇÃO DE VARIÁVEIS	156
B ANÁLISE DE ESTABILIDADE, EQUAÇÃO DA CONVECÇÃO -DIFUSÃO LINEAR, 1D, MÉTODO 1 PONTO A MONTANTE, EX-
PLÍCITO	158
C O MÉTODO DE ALLEN-FIGUEIREDO	161
D O MÉTODO DE PATANKAR	165
E ANÁLISE DE ESTABILIDADE, EQUAÇÃO DA CONVECÇÃO -DIFUSÃO LINEAR, ID, MÉTODO DE ALLEN-FIGUEIREDO, EXPLÍCITO	167
F	O MÉTODO DE SAAD-LEONARD	170
F.l Aproximação para o termo convectivo................170
F.2 Método de Saad-Leonard Escrito em Função dos Métodos de Dois Pontos a Montante e Central . . . . .......................171
F.3 O Método de Saad-Leonard para Malhas	Não Uniformes.173
F.4 O Método de Gupta-Leonard .........................174
G O MÉTODO DE LEONARD MODIFICADO	177
H ESQUEMAS DE SEGUNDA ORDEM	NO TEMPO	178
I ANÁLISE DE ESTABILIDADE, EQUAÇÃO DA CONVECÇÃO -DIFUSÃO LINEAR, ID, MÉTODO DE SAAD-LEONARD, EXPLÍCITO	180
J CRITERIOS PARA UM ESQUEMA DE DISCRETIZAÇÂO SER TVD	183
K APLICAÇÃO DOS CRITÉRIOS TVD PARA UMA EQUAÇÃO DE CONSERVAÇÃO. LIMITADORES DE FLUXO.	185
K.l Aplicação do Criterio TVD para Malhas Uniformes ............. 185
K.2 Criterio TVD para Malhas Nao Uniformes.............187
K.3 Região TVD de Sweby - Malhas Uniformes.............189
K.4 Região TVD de Sweby - Malhas Não Uniformes ........190
K.5 O Limitador de Van-Leer............................192
K.6 Limitador de Terceira Ordem..................... 195
L SOLUÇÃO SEMI - ANALÍTICA DA EQUAÇÃO DA CONVECÇÃO -DIFUSÃO LINEAR, ID	199
M MÉTODO DE ALLEN-FJGUEIREDO PARA SOLUÇÃO DA E-
QUAÇÃO DE BUCKLEY- LEVERETT	201
N MÉTODO DE PATANKAR PARA SOLUÇÃO DA EQUAÇÃO DE
BUCKLEY - LEVERETT	203
Lista de Tabelas
54 Posições das descontinuidades. Método de Saad-Leonard.....................	. . . 48
84	Dados	de reservatório. ..................................................   83
94	Dados	de reservatório,	2D, horizontal......................................107
9.2	Resultados	para o	esquema	semi-implícíto. ................................109
9.3	Resultados	para o	esquema	totalmente implícito............................109
9.4	Resultados	para o	esquema	implícito com correções	TVD	explícitas........111
9.5	Resultados	para o	esquema	implícito com limitadores	TVD explícitos. . , . 111
9.6	Resultados	para o	esquema	IMPES.........................................  114
9.7	Dados	de reservatório,	Caso 2 - seção vertical.............................117
9.8	Dados	de reservatório.	Comparação com a solução	semi-analítica..122
10.1	Dados	de reservatório,	Caso 3...................................... 141
1.1	Limites de estabilidade. Método de Saad-Leonard explícito. . ..............  182
Lista de Figuras
3.1	Comparação entre malhas - geometria “five-spot”..................  .	. .	8
4.1	Limites de estabilidade, esquema explícito...........................   24
5.1	Solução na descontinuídade...........................................   33
5.2	Onda de choque. ....................................................    37
5.3	Equação de	Burgers * Solução Numérica...............................  40
5.4	Equação de	Burgers - Solução Numérica...............................  40
5.5	Equação de	Harten -	Método	1 ponto a montante. ...................... 43
5.6	Equação de	Harten *	Método	1 ponto a montante. .......................43
5.7	Equação de	Harten -	Método	2 pontos a montante........................44
5.8	Equação de	Harten -	Método	2 pontos a montante. ..................... 44
5.9	Equação de	Harten - Método Saad-Leonard. ............................ 45
5.10	Equação de	Harten - Método Saad-Leonard. ...........................  45
5.11	Equação de	Harten - Método Leonard modificado.......................  46
5.12	Equação de Harten - Método Leonard modificado. .  .................  .	46
5.13	Equação de Harten - Método TVD terceira ordem / Sweby..............  .	47
5.14	Equação de Harten - Método TVD terceira ordem / Sweby............	47
6.1	Convecção-Difusão,	1D, solução	semi-analítica......................... 54
6.2	Convecção-Difusão,	1D, análise	de estabilidade. ...................... 54
6.3	Convecção-Difusão,	1D, análise	de estabilidade......................   55
6.4	Convecção-Difusão,	1D, análise	de estabilidade. .....................  55
6.5	Convecção-Difusão, 1D, análise de estabilidade......................  .	56
6.6	Convecção-Difusão, 1D, análise de estabilidade..........................56
6.7	Convecção-Difusão, 1D,	comparação entre formulações....................58
6.8	Convecção-Difusão, 1D,	comparação entre formulações..................  58
6.9	Convecção-Difusão, 1D,	comparação entre formulações....................59
6.10	Convecção-Difusão, 1D,	comparação entre métodos......................  59
6.11	Convecção-Difusão, 1D,	comparação entre métodos......................  60
6.12	Convecção-Difusão, 1D,	comparação entre métodos. ......................60
6.13	Convecção-Difusão, 1D,	comparação entre métodos......................  62
6.14
7.1
7.2
7.3
7.4
7.5
7.6
7.7
7.8
7.9
7.10
7.11
7.12
7.13
7.14
7.15
7.16
8.1
8.2
8.3
8.4
8.5
8.6
8.7
8.8
8.9
8.10
8.11
8.12
8.13
Convecção-Difusão, ID, comparação entre métodos..........................  62
Curva de fluxo fracionário. ............................................   71
Curva J de Leverett.................................................       71
Curva g(Sw). ............................................................  71
Buckley-Leverett, convectivo, método de Saad-Leonard...................... 72
Buckley-Leverett, convectivo, método de Saad-Leonard...................... 72
Buckley-Leverett, convectivo, comparação entre métodos...................  74
Buckley-Leverett, convectivo, comparação entre métodos...................  74
Buckley-Leverett, convectivo, comparação entre métodos. . ...............  75
Buckley-Leverett, convectivo, comparação entre métodos.................... 75
Buckley-Leverett, NRL ~ 10, comparação entre métodos...................... 77
Buckley-Leverett, TVrl = 10, comparação entre métodos, ................  .	77
Buckley-Leverett,	~ 10, comparação entre métodos.....................  78
Buckley-Leverett,	— 10, comparação entre métodos...................... 78
Curva de fluxo fracionário modificada......................................79
Buckley-Leverett com curva de fluxo fracionário modificada.............  80
Buckley-Leverett com curva de fluxo fracionário modificada...............80
Posição do poço na borda da malha. ....................................  83
Fluxo monofásico permanente, 2D. Campo de pressões (kPa).................90
Concentração norm, no efluente, solução semi-analítica.................. 90
Concentrações norm,	no efluente, método	1 ponto a montante............92
Concentrações norm,	no efluente, método	TVD	de Rubin e Blunt........ 92
Concentrações norm,	no efluente, método	TVD	de terc. ordem /	Liu. 93
Concentrações norm,	no efluente, método	TVD	de terc. ordem /	Sweby.. . 93
Concentrações norm, na diagonal, método de Saad-Leonard................94
Concentrações norm, na diagonal, método TVD de terc. ordem / Sweby. . 94
Distribuição das conc. normalizadas, 15x15, 1 ponto a montante........ . 96
Distribuição das conc. normalizadas, 15x15, TVD de terc. ordem / Sweby. 96
Distribuição das conc. normalizadas, 50x50, 1 ponto a montante........ 96
Concentrações norm, no efluente, método 1 ponto a montante.............97
8.14	Concentrações norm. no efluente, método TVD de terc. ordem / Sweby. . . 97
8.15	Distribuição das concentrações, método 1 ponto a montante........................  99
8.16	Distribuição das concentrações, método TVD de terc. ordem / Sweby. ... 99
9.1	Caso	óleo-água,	2D,	horizontal.	Permeabilidades relativas. .....................108
9.2	Caso	óleo-água,	2D,	horizontal.	Fatores volume de formação......................108
9.3	Caso	óleo-água,	2D,	horizontal.	Semi-imp lícito. ...............................110
9.4	Caso	óleo-água,	2D,	horizontal.	Totalmente implícito..........................  110
9.5	Caso	óleo-água,	2D,	horizontal.	TVD de Rubin e Bluni nas perm, relativas. 112
9.6	Caso	óleo-água,	2D, horizontal.	TVD de terc.	ordem / Sweby..............112
9.7	Caso	óleo-água,	2D, horizontal.	Malha	10x10,	1 ponto a montante........113
9.8	Caso	óleo-água,	2D, horizontal.	Malha	10x10,	TVD de terc. ordem	/	Sweby. 113
9.9	Caso	óleo-água,	2D, horizontal.	Malha	30x30,	1 ponto a montante.	.....	113
9.10	Caso	óleo-água,	2D, seção.	Permeabilidades relativas............................115
9.11	Caso	óleo-água,	2D, seção.	Pressão capilar. ....................................115
9.12	Caso	óleo-água,	2D, seção.	Comparação entre métodos...........................  116
9.13	Caso	óleo-água,	2D,	seção.	Malha 10x10,	1 ponto a montante.	.......	116
9.14	Caso	óleo-água,	2D,	seção.	Malha 10x10,	TVD de terc. ordem	/	Sweby.	.	.	116
9.15	Caso óleo-água, 2D, seção, heterog.. Comparação entre métodos. ...... 118
9.16	Caso	óleo-água,	2D,	seção,	heterog., 8x8,	1 ponto a montante...............118
9.17	Caso	óleo-água,	2D,	seção,	heterog., 8x8,	TVD de terc. ordem	/	Sweby.	.	.	118
9.18	Caso	óleo-água,	2D.	Orientação de malha, M=l. ................................  123
9.19	Caso	óleo-água,	2D.	Orientação de malha, M=1....................................123
9.20	Caso	óleo-água,	2D,	21x21, 1 ponto a montante, M=l. . ..........................124
9.21	Caso	óleo-água,	2D,	21x21, TVD de terc. ordem, M=1..............................124
9.22	Caso	óleo-água,	2D.	Orientação de malha, M~2..................................  126
9.23	Caso	óleo-água,	2D.	Orientação de malha, M~2. ..................................126
9.24	Caso	óleo-água, 2D.	Orientação de malha, M—4. ..................................127
9.25	Caso	óleo-água, 2D.	Orientação de malha, M=4..............................1.27
9.26	Caso	óleo-água, 2D.	Malha diagonal, 15x15, 1 ponto	a montante,	M=40.	.	128
9.27	Caso	óleo-água, 2D.	Malha paralela, 21x21, 1 ponto	a montante,	M=40. . .	128
9.28	Caso óleo-água, 2D, Malha diagonal, 15x15, TVD de tere, ordem, M=40. . 129
9.29	Caso óleo-agua, 2D. Malha paralela, 21x21, TVD de tere, ordem, M=40. . 129
10.1	Traçador em	2D,	Caso 1,..........................................  138
10.2	Traçador em	2D,	Caso 1.......................................      138
10.3	Traçador em	2D,	Caso 1.........................................    139
10.4	Traçador em	2D,	Caso 1.......................................      139
10.5	Traçador em	2D,	Caso 1...........................................  140
10.6	Traçador em	2D,	Caso 2.........................................    140
10.7	Traçador em	2D,	Caso 3A. . ........................................143
10.8	Traçador em	2D,	Caso 3A..........................................  143
10.9	Traçador em 2D, Caso 3B. . . ........................................ . 144
lO.lOTraçador em 2D,	Caso 3B...........................................  144
lO.HTraçador em 2D,	Caso 3C. .......................................    145
10.12Traçador em 2D, Caso 3............................................... . 145
10.13Traçador em 2D,	Caso 4. ...... .................................    147
10.14Traçador em 2D,	Caso 5. ........ ...................................147
K.l Região TVD de Sweby...............................................    198
K.2 Região TVD de Liu. ............................  -....................198
Nomenclatura
Letras Romanas:
a	Constante do termo	de adsorção	do	traçador
b	Constante do termo	de adsorção	do	traçador
/	Fluxo total por unidade de área
/w	Fluxo fracionário de	água
fo	Fluxo fracionário de	óleo
k	Permeabilidade
kr	Permeabilidade relativa
B	Fator volume de formação
q*	Vazão mássica
q	Vazão volumétrica
p	Pressão
&lt;$V	Saturação de água
So	Saturação de óleo
r	Razão entre os fluxos	nas	interf. dos blocos
Pe	Número	de Peclet
Nrl	Número	de Rapoport	e Leas
Neo	Número	de Courant
Kf!S.	Tensor dispersão física
K^Kyy	Componentes do tensor dispersão
Componentes do tensor dispersão
Knum.	Tensor dispersão numérica
Ci	Concentração volumétrica do componente /
xi	Concentração mássica do componente /
t	Tempo
u	Velocidade de Darcy
v	Velocidade intersticial
x	Distância
L	Distância
m3/d/m2
fim2
m3/Sm3 kg/d m3/d kPa
m2/d m2/d m2/d
kg/m3 kg/kg dias m/d m/d m
m
Letras gregas:
Porosidade
8	Angulo, usado na análise de estabilidade
cq Dispersividade longitudinal Dispersividade transversal
tp Limitador TV D
7 Amplitude dos termos da série de Fourier p Viscosidade
p Massa específica
A At/Az, com At e Aj* adimensionais
Ào Mobilidade do óleo = kkra/pa
Àw Mobilidade da água —
m
m
mPa.s
kg/m3
pm2 / mPa.s pm2/mPa.s
Subscritos:
indica o bloco de simulação -l indica o componente w água o óleo
r indica grandeza relativa
Sobrescritos:
íz	indica a iteração Newtoniana
n	Índica o passo de tempo
n + 1 indica o passo de tempo
f	indica derivada
1PM método de um ponto a montante 2PM método de dois pontos a montante -C	método	de aproximação central
SL	método	de Saad-Leonard
GL	método	de Gupta-Leonard
LM	método	de Leonard modificado
RB método TVD de Rubin e Blunt
1	INTRODUÇÃO
Neste trabalho apresentamos uma investigação dos métodos numéricos de diferenças finitas para resolver problemas de escoamento de fluidos em meios porosos.
0 estudo foi motivado porque o método tradicional mente usado na engenharia de reservatórios, de ponderação a montante, conduz a soluções com uma grande dispersão artificial, conhecida como dispersão numérica, que inviabiliza a correta simulação da dispersão física, principalmente em escoamentos convectivos.
Na engenharia mecânica, na área de transferência de calor, são bastante utilizados os métodos exponenciais de Patankar [33] e Allen [3], [4]. Na área de engenharia de reservatórios esses esquemas têm sido empregados para estudar o deslocamento de traçadores [42]. Com relação ao método de Allen, estaremos considerando uma abordagem semelhante à proposta por Figueiredo [15], e por isso empregaremos a denominação Allen-Figueiredo. Mostramos que tais métodos fornecem resultados razoáveis quando o termo de fluxo difusivo é significativo, porém se reduzem ao método de ponderação a montante quando o escoamento é muito convectivo, produzindo nesses casos grande dispersão numérica. Apresentamos também uma nova forma de escrever a equação de conservação linear em 1D discretizada pelos esquemas exponenciais.
Alguns métodos de diferenças finitas de ordem mais alta foram propostos na literatura para reduzir a dispersão numérica e o efeito de orientação de malha [49], [26], [41], [17]. Tais métodos são efetivos em controlar a dispersão numérica. No entanto, podem produzir soluções fisicamente incorretas quando o termo de fluxo convectivo predomina e a equação de conservação assume um caráter hiperbólico. Embora não tenha sido notado pelos pesquisadores da área, tal fenômeno ocorre porque esses métodos nem sempre obedecem ao princípio matemático da entropia. A obediência ao princípio da entropia, aliado à convergência, é suficiente para garantir que a solução obtida é a única solução correta do problema.
Os métodos de Redução das Variações Totais (TVD - “Total Variation Diminishing’’) foram introduzidos pelo matemático Harten [20] em 1983, e começaram a ser empregados na engenharia de reservatórios em 1.990. Esses métodos apresentam a grande vantagem de permitirem o uso de aproximações de ordem mais alta para o termo de fluxo convectivo, produzindo sempre soluções coerentes, pois obedecem ao princípio da entropia. Analisamos esquemas TVD de segunda ordem [20], [46], [50], [40] e de terceira ordem [18], [27].
A condição de entropia é investigada através da solução numérica de algumas equações não-líneares clássicas, como as equações propostas por Burgers [7] e Harten et alii [19], utilizando-se os diversos métodos de diferenças finitas.
São estudados alguns problemas de engenharia de reservatórios, a saber:
» equação da convecção - difusão linear, em 1D.
•	equação de Buckley-Leverett, 1D.
•	deslocamento de um traçador monofásico em 2D.
A estabilidade dos métodos no esquema explícito é analisada com detalhes utilizando-se a equação da convecção-difusão em 1D.
Os métodos TVD foram implementados em um simulador de reservatórios óleo-água bidimensional. Analisamos o desempenho obtido pelos métodos, utilizando as formulações IMPES, semi-ímplícita e totalmente implícita. No esquema totalmente implícito avaliamos diversas formas de implantação quanto à precisão e número médio de iterações por passo de tempo. Utilizamos formulação geral, prevendo o uso de malhas não-uniformes.
Introduzímos no simulador óleo-água a opção de injeção de traçadores conservativos na fase água, considerando o tensor dispersão completo e adsorção do tracador na rocha. As soluções podem ser obtidas com esquemas explícito ou totalmente implícito.
Sempre que possível utilizamos como referência soluções semi-analíticas. No caso óleo-água em 2D desenvolvemos um programa de computador para gerar a solução serni-analítica com base nas idéias de LeBlanc e Caudle [24]. Os resultados são também comparados com as soluções numéricas obtidas com o método de ponderação a montante com malha refinada.
Além da dispersão numérica, o efeito de orientação de malha é também analisado.
Incluimos estudos de diversos casos práticos de deslocamento óleo-água, em reservatórios homogêneos e heterogêneos. São também simulados e interpretados vários casos de injeção de traçadores,
Para desenvolvimento e teste dos diversos programas de computador utilizamos os seguintes equipamentos :
•	Micro-computador PROCEDA 5370-CAD, PC/XT com 8 MHz e placa MOTO-ROLA OSOSO, com 20 MHz e 4 Mbytes de memória RAM.
• Computador IBM 3090 modelo 150 VF - XA, da UNICAMP.
2	REVISÃO BIBLIOGRAFICA
0 transporte de um fluido no meio poroso geralmente compreende duas parcelas: transporte convectivo e transporte difusivo. 0 transporte convectivo ocorre devido aos gradientes de pressão, enquanto a difusão está associada à mistura provocada pelos gradientes de concentração (difusão molecular) e pela agitação do meio poroso (dispersão hidrodinâmica).
O maior problema encontrado na simulação numérica do fluxo no meio poroso tem origem na discretização do termo de fluxo convectivo. O método de ponderação a montante sempre produz soluções fisicamente corretas, porém introduz altos níveis de dispersão numérica, o que tende a dar um caráter muito dissipativo ao fluxo.
A seguir discutimos, de forma breve, os métodos de diferenças finitas propostos na literatura para tentar controlar a dispersão numérica. Alguns desses métodos são apresentados com mais detalhes no capítulo 4.
Em 1971 Chaudhari [10] propôs um método que consistia em adicionar, na equação diferencial, termos com sinais contrários àqueles introduzidos artificialmente pelo método de 1 ponto a montante. Embora tenha sido bastante utilizado em simuladores de métodos miscíveis de recuperação do petróleo [16], [36], hoje em dia é pouco utilizado por estar limitado a malhas uniformes [41] e por apresentar, em alguns casos, soluções oscilatórias [41].
Em 1972, Todd et alii [49] propuseram o método de 2 pontos a montante para aproximar melhor as propriedades calculadas nas interfaces dos blocos de simulação. O método é de segunda ordem no espaço, e reduz os efeitos de dispersão numérica e orientação de malha. No entanto, quando a equação de conservação é linear, é necessário introduzir restrições para controlar as oscilações, no esquema explícito. Nos casos não-lineares não é garantido que as soluções fisicamente corretas sejam sempre obtidas.
Os métodos exponenciais de Patankar [33] e Allen-Figueiredo [3], [4], [15] são bastante utilizados na área de transmissão de calor, e se baseiam nas mesmas ideias: a equação diferencial é admitida localmente linear e resolvida analiticamente considerando-se termo transitório nulo (Patankar) ou constante (Allen-Figueiredo). A solução fica em termos de constantes que são determinadas aplicando-se a pontos adjacentes da malha. Em 1990, Santos [42] apresentou um estudo de deslocamento de tracador monofásico em 2D utilizando o método de Patankar para discretizar o termo de fluxo convectivo. Os resultados teóricos foram bem próximos dos obtidos em laboratório, provavelmente porque os níveis de dispersão física eram significativos. O maior problema com esses métodos é que, conforme demonstramos no capítulo 4, se reduzem ao método de 1 ponto a montante quando o escoamento é muito convectivo, apresentando nesse caso os mesmos problemas de dispersão numérica elevada.
Em 1979 o matemático Leonard [26] propôs a aplicação de um método de terceira ordem para discretização do termo convectívo. Tal método é uma aproximação exata para um polinómio de terceiro grau e, portanto, compatível com o esquema de diferenças centrais utilizado tradicional mente para discretizar o termo de transporte difusivo. Segundo Leonard [26], a díscretização de terceira ordem para o termo convectivo é ótima em termos de precisão, estabilidade e simplicidade. A aplicação do método só é simples com o esquema explícito. No esquema implícito o método conduz a um aumento do número de diagonais e da banda da matriz Jacobíana, o que acarreta grande incremento no esforço computacional e na área de memória necessários à solução do problema.
Em 1990, Saad et alii [41] e Gupta [17] propuseram métodos baseados nas idéias de Leonard. Os métodos foram aplicados para estudar o fluxo de traçador em 1D e 2D e para a equação de Buckley-Leverett, utilizando sempre esquemas explícitos. Foram apresentadas também algumas sugestões de ordem prática para eliminar as oscilações e aumentar a estabilidade dos métodos no esquema explícito. Esses métodos corrigem adequadamente o problema de dispersão numérica. Entretanto, os autores observaram que soluções fisicamente incorretas podem ser obtidas quando o fluxo é muito convectivo e a equação assume um caráter hiperbólico.
Embora os pesquisadores acima nao tenham percebido, esses problemas ocorrem porque os métodos propostos nem sempre obedecem ao princípio matemático da entropia. Tal princípio foi enunciado por Oleinik [30] em 1957 e tem sido utilizado em vários trabalhos da área de matemática aplicada sobre métodos numéricos para solução de equações de conservação [31], [32], [46], [44]. 0 princípio consiste em uma condição adicional que deve ser satisfeita pela solução correta do problema, garantindo assim a unicidade da solução para problemas que não sao bem postos. A aplicação desse e de outros princípios, demonstrados nos referidos trabalhos, permite compreender e analisar corretamente as soluções obtidas com os diversos métodos de diferenças finitas propostos na literatura.
Também em 1990, Chang [9] apresentou sua tese de doutoramento, onde utilizou o esquema de Leonard em um simulador com posicionai de reservatórios que considerava os termos de dispersão hidrodinâmica. Foi utilizada a formulação IMPES. Os resultados foram bons, quando os termos de dispersão física eram significativos.
Em 1983, Harten et alii [20] introduziram o conceito de métodos TVD (“Total Variatíon Díminishíng”)- Tais métodos consistem, basicamente, em acoplar um termo de fluxo anti-difusivo, com um limitador de fluxo, ao tradicional esquema de 1 ponto a montante. Harten [20] e Sweby [46] demonstram os critérios algébricos que devem ser obedecidos pelo limitador para que o esquema final conduza a redução das variações totais ao longo do tempo. Para deduzir esses critérios é conveniente definir um parâmetro, chamado de razão de fluxo, como a relação entre os fluxos nas fronteiras de cada bloco de simulação, em cada direção. A aplicação dos critérios determina uma região no plano definido pelo limitador de fluxo versus razão de fluxo; a região mais utilizada é a região
TVD de Sweby [46]. Diversos limitadores de fluxo são propostos na literatura, entre eles o de Van Leer [50] e o de terceira ordem [18][27], Esses limitadores devem estar sempre confinados ao interior de uma região TVD. Embora não exista até hoje uma demonstração formal, as evidências numéricas indicam que os métodos TVD obedecem ao princípio da entropia e, portanto, se convergentes, produzem soluções fisicamente corretas.
Em 1990, Rubin e Blunt [40] introduziram os esquemas TVD na engenharia de reservatórios. Foi utilizado o limitador de Van Leer [50] para definir um esquema TVD de aproximarão de segunda ordem para os termos de fluxo nas equações de conservação em um modelo de simulação numérica de reservatórios. Os resultados foram animadores em termos de controle da dispersão numérica. Os casos analisados, no entanto, eram particulares, por admitirem curvas de permeabilidade relativas como linhas retas e razão de mobilidades unitária. Os autores consideraram as formulações IMPES e totalmente implícita.
Gupta et alii [18], também em 1990, definiram um limitador que conduz, em regiões suaves, a um esquema de terceira ordem para o fluxo convectivo. Nas regiões onde o limitador fica restrito pela região TVD, o esquema passa a ser de segunda ordem no espaço, jianchun Liu [27] utilizou o mesmo limitador e propôs uma ampliação na região TVD, Os dois autores aplicaram o esquema para o problema de Buckley-Leverett em 1D e para a equação da convecção - difusão em 1D e 2D, sempre com esquemas explícitos.
Nas fronteiras do reservatório os métodos de ordem mais alta, inclusive os métodos TVD, não podem ser empregados, pois exigiriam pontos fora do domínio. Os diversos autores citados sugerem utilizar, em tais casos, o método de ponderação a montante.
3	DISPERSÃO NUMÉRICA E ORIENTAÇÃO DE MALHA - MOTIVAÇÃO
Nesse capítulo apresentamos uma discussão da dispersão numérica introduzida pelo método de 1 ponto a montante, através da análise da equação da convecção - difusão linear, em 1D, na sua forma adxmensional:
dcD	i m , dcD
dxn	Pe dxj) dtD	‘
A dedução dessa equação é apresentada no capítulo 6. 0 parâmetro Pe é conhecido como número de Peclet, e representa uma relação entre as forças convectivas (viscosas) e difusivas. Quanto maior o número de Peclet, mais convectivo é o fluxo.
3.1	Dispersão Numérica
Por enquanto vamos nos ater à discretização do termo convectivo. Omitiremos, doravante, os índices de adimensionalização de (3.1) por simplificação.
Considerando a abordagem tradicional de diferenças finitas, e utilizando expansão em série de Taylor, obtemos, para fluxo no sentido i — 1 —&gt; i -4 i + 1:
_ C,-+i - C,-i dx ) .	2 Ax
(Ax)2 Í3PC\
6 U3Í’
Xi-i &amp;lt;7 &amp;lt;®í+i •
(3-2)
A aproximação acima é a discretização central do termo convectivo, de segunda ordem no espaço. Infelizmente, quando se resolve numericamente a equação (3.1) usando essa aproximação, a solução apresenta oscilações espúrias ou é fisicamente incorreta [6],
A aproximação por um ponto a montante é também obtida pela expansão em série de Taylor:
dz J .	Ax	2 \ dx2 Ji 6	\ dx3 /
&lt;7&amp;lt;	-
(3-3)
Assim,
G -
Ax
'•S-'
Az íd2C\
dx).	2 ^âz2/. ’
Portanto, quando substituímos (~). por £-z£-l , estamos de fato resolvendo outra equação, a saber:
dC 1 d2C ãxd2C t 9C dx Pe dx2 ~ 2 dz2 + ~dt
Nessa equaçao a dispersão total é:
&amp;amp;TOTAL = -p^ + KjVUM. }
onde :
Knum. “ Az/2 .
(3-5)
(3.6)
(3.7)
Ou seja, a discretização por um ponto a montante introduz, nesse caso, uma dispersão artificial igual a Az/2. Quando a equação de conservação é hiperbólica, isto é, não há dispersão física, a dispersão artificial estabiliza o método de diferenças finitas, mas o erro numérico introduzido é grande. No apêndide A discutimos, com base nas idéias de Farlow [14], porque o termo difusivo estabiliza a solução da equação da conservação,
Em processos de recuperação secundária do petróleo, onde uma frente estreita pode se formar na interface dos fluidos deslocado e deslocante, o método de 1 ponto a montante atenua a forma da frente, causando irrupção mais rápida do fluido deslocante. Em processos onde a dispersão física é alta (Peclet baixo), a dispersão numérica não influi tanto na solução.
Naturalmente, a dispersão numérica depende do tamanho das células. Por esse motivo o refinamento local acompanhando a frente de avanço é um método viável para controlar a dispersão numérica.
3.2	Orientação de Malha
Outro fenômeno que resulta da aplicação do método de 1 ponto a montante é a dependência da orientação de malha. Se essa discretização for usada nas três direções dos eixos cartesianos, o termo adicional introduzido na equação da convecção-difusão adimensional é:
ãxd2C àyd2C &amp;amp;zd2C
2	2 dy* 2 Ôz2 ’
e esse termo depende da orientação da malha.
(3-8)
Normalmente trabalhamos com dois tipos de malhas: paralela e diagonal. A figura 3.1 mostra as duas malhas para o padrão “five-spot”.
AAA
o
-----
¿-------
□¡AGONAL
Figura 3.1: Comparação entre malhas - geometría “five-spot".
Sabe-se que a malha paralela produz irrupção mais rápida do fluído injetado, e a malha diagonal resulta em maior eficiência de varrido.
0 esquema de discretização por 9 pontos em duas dimensões produz uma melhor distribuição do fluxo, mas não elimina a orienteção de malha, uma vez que o erro introduzido pela ponderação a montante ainda existe e não é rotacionalmente invariante.
Em processos onde a dispersão física está presente, esta é suficiente para estabilizar o processo numérico. A mod elagem é feita através de um tensor dispersão que é rotacionalmente invariante, não causando efeitos de orientação de malha. Conforme veremos nos itens seguintes, nesses casos podemos utilizar métodos de ordem mais alta na discretização do termo convectivo com a garantia de que soluções fisicamente coerentes serão obtidas.
Podemos entender melhor o efeito de orientação de malha analisando a equação da convecção-difusão em sua forma dimensional, para duas dimensões:
_	- ffc) = 0 ,
(3.9)
onde Kpis. é o tensor dispersão e u a velocidade de Darcy.
Não considerando o termo difusivo, discretizamos a equação (3.9), no esquema explícito, como:
/&gt;n+l pr. ,.n	/-&gt;n	„n	z-rn
Aü ~L'íj f Mí+l/2jC'f+V2j “
t—-	+--------------------------
Aaq
.M Un	n	fí-n.
, ^ó+i/s^íj+i/a uq-V2uíj~V2
+_ ~
= 0.
(3.10)
No esquema de ponderação
com
ponto a montante, temos:
CS
, se «Í+1/2J &gt; 0
, se txi+1/2j &amp;lt;0
(3.11)

1
Para C%+lf2 a definição é similar.
Considerando u constante (V.u = 0 , regime permanente) e constante, es-
crevemos:
. .toW , ,Ayd2(^
2 ftr3 +!“vl 2 fy* ’
(3.13)
+	.	(3.12)
Por analogia com a equação da convecção-difusão em 1D, concluímos que a ponderação a montante introduz o seguinte termo de dispersão numérica:
- V.(^WM..VC) =-
Podemos notar que a única forma de minimizar a dispersão numérica introduzida pela ponderação a montante é refinar a malha.
Outra idéia seria determinar um espaçamento de malha tal que a dispersão numérica obtida fosse igual à dispersão física do sistema. Russel e Wheeler [48] analisam essa idéia:
Supondo Ax = Ay = h podemos escrever, a partir de (3.13):
K NUM.
h / |ux|
2 \ 0
O tensor de dispersão física já multiplicado por $ (termo ^Kf is. em (3.9) é apresentado por Lake [22], [23]:

(3.16)
(3.17)
e
(3.18)
onde aí?a/ são as dispersividades longitudinal e transversal do meio.
Nas equações acima desprezamos a difusão molecular, consideramos apenas a dispersão hidrodinâmica do meio.
Assim, podemos escrever :
í €os20	casQsenÔ \	( ser^O	—cosÔsenQ	\	...
= |ff| ( coshenO	«»’« J	+ W (	-cos^nO coM	)	’	&lt;3'19)
onde o ângulo 0 é formado entre a velocidade u e o eixo cartesiano x.
Para uma certa malha (h conhecido), podemos tentar obter oq e cq para calcular a dispersão física que corresponde à dispersão numérica. Para o caso geral isso não é possível, pois igualando (3.19) a (3.14) temos 3 equações e 2 incógnitas.
Esses valores podem ser obtidos para alguns casos particulares [48]:
i) Se 0 = 0,7r,27r, ... (malha paralela):
(3.20)
como uy = 0, segue que at = 0 .
(3.21)
Os mesmos resultados são obtidos se 8 =
3r
2 v - -
ii) Se 0 =	, • ■ * (malha diagonal) :
h
2y/2
~0,354A .
(3,22)
Portanto, dependendo da orientação da malha, a dispersão numérica acarreta coeficientes de dispersão física diferentes. Isto é, para o mesmo â, os valores de af, o; associados à dispersão numérica, dependem da orientação da malha.
No caso de malha diagonal para um padrão “fi ve-spot” (figura 3,1), a dispersão numérica transversal, cq ~ 0,354h, é significativa e tende a dificultar o fluxo do poço ínjetor para o produtor. Já no caso de malha paralela, não existe dispersão numérica transversal (a£ = 0), apenas dispersão longitudinal, maior que a dispersão longitudinal para a malha diagonal. Isso explica porque a irrupção do fluido deslocante é inais rápida no cano de malha paralela.
Podemos concluir que a dispersão numérica explica em parte a discrepancia entre os resultados de simulações numéricas usando malhas com orientação distintas. A redução da dispersão numérica tende a aproximar os resultados obtidos. A outra parcela responsável pela diferença dos resultados é a tendência do fluxo se dar preferencialmente ao longo das linhas da malha; essa parcela não é afetada quando reduzimos a dispersão numérica.
No caso da equação da convecção - difusão linear em ID, conforme veremos no capítulo 6, o número de Peclet é definido como;
Pe = L/ai	(3.23)
onde L é a distancia entre o poço injetor e o produtor.
Se não há dispersão física, já demonstramos que, no caso de malha paralela, a dispersão numérica acarreta ¿q -- h/2. Assim,
9 r Pe~~~~2N ,	(3,24)
h
onde N é o número de células da malha em ID.
Isso significa que, por exemplo, se Pe — 1000, de vemos utilizar N—500 nos e resolver numericamente a equação de conservação na forma hiperbólica. A dispersão numérica introduzida pelo método de ponderação a montante para discretização do termo convectivo será equivalente à dispersão física que desejamos simular.
3.3	Discretização do Termo Temporal
Todas as conclusões acima só são válidas se as simulações são feitas corn At muito pequeno de forma a tomar desprezível a dispersão numérica introduzida pela discretização do termo temporal, pois:
p(7\	Atd^C
\dt	Aí	2 Õt2 ’
quando substituímos por	em (3.5) estamos de fato resolvendo:
(3,25)
dC dC 1 d2C &amp;amp;xd2C M&amp;amp;C
dt + dx Pe dx2 2 dx2 + 2 di2 ~ ° 5	^3’26^
ou seja, a discretização de primeira ordem do termo temporal introduz uma dispersão numérica com sinal contrário à dispersão física.
Se o escoamento é puramente convectivo, a equação (3,5) fica:
dC ÔC
dx dt
0
?
e, com algum algebrismo, chegamos a:
d2C 92C
(3.27)
(3.28)
Substituindo-se em (3,26), e considerando fluxo convectivo, resulta que:
dC	dC Ax /At	\ d2C
dt + dx	2 \Ax	J dx2
ou seja, a dispersão numérica se anula quando = 1.
(3.29)
Para a formulação explícita, isso significa que a dispersão numérica é nula quando utilizamos o método de ponderação a montante com o maior At estável (At/Ax ~ 1). Maiores detalhes podem ser encontrados em Peaceman [34].
A discussão acima demonstra a importância da dispersão numérica na simulação de reservatórios. No próximo capítulo discurimos alguns métodos apresentados na literatura para minimizar este problema.
4	MÉTODOS NUMÉRICOS PARA DISCRE-TIZAÇÃO DO TERMO CONVECTIVO EM EQUAÇÕES DE CONSERVAÇÃO
No capítulo anterior vimos que o tradicional método de diferenças finitas de ponderaç&amp;amp;o a montante (ou 1 ponto a montante) para o termo convectivo da equação de conservação introduz uma grande dispersão numérica artificial. Neste capítulo discutimos os métodos alternativos propostos na literatura para controle da dispersão numérica. As análises serão feitas tomando-se por base a equação da convecção-difusão linear em 1D, que é deduzida no capítulo 6:
acD	dcD	im.
dl d	ôxd	Pe dxp
Os índices de adimensionalização serão omitidos a partir de agora por simplificação.
Em nossa análise não nos preocuparemos com a discussão entre esquemas implícitos ou explícitos. Quase sempre estaremos tratando com esquemas explícitos; a estabilidade será medida pelo número de Courant, que no caso da equação (4.1) é definido por:
At

Aa:
(4.2)
Doravante, se nada for dito em contrário, estaremos trabalhando, por simplificação, com fluxo no sentido i — 1 —&gt; i —► í + 1.
4.1	O Método de Ponderação a Montante
É o método tradicionalmente empregado nos modelos de engenharia de reservatórios. Pelo desenvolvimento em série de Taylor, obtemos:
ac\	(&amp;amp;c\
dx /.— A.r	2 \ dx2) i
(4-3)
O método é, portanto, de primeira ordem no espaço.
Partindo-se da forma geral de discretizaçao do termo convectivo:
_ ^i-H/2 ~~ C-l/2
ÔX ),	Ax
(4.4)
podemos escrever:
Para fluxo no sentido i ~ 1 —+ i —+ i + 1,
— t/,' ,	C/|_i/2 ~ O¿„i .
Para fluxo no sentido contrário,
(4.5)
Chi/2 ~ Ci+1 , Cí-1/2 = Ci .

pOr	em (4,1), já vimos que estamos intro-
duzindo uma dispersão numérica dada por:
Knum. —
Ax
V
(4.7)
Essa dispersão numérica artificial é o grande problema do método de ponderação a montante.
A equação (4.1) discretizada pelo esquema explícito, método de ponderação a montante para o termo convectivo e diferenças centrais para o termo difusivo, fica :
(4.8)
A análise de estabilidade para (4.8) é apresentada no Apêndice B, tendo sido obtido o seguinte resultado :
A = JV„&amp;lt;	2 1 , , ,	(4.9)
PecSl. "T
onde At e Ax são grandezas adimensionais e PecEL. é o número de Peclet celular (PecEL. = PeAx).
Quando o fluxo é totalmente convectivo (Pe —■&gt; oo), temos:
^&lt;1 -
O método de ponderação a montante sempre produz soluções fisicamente coerentes porque, conforme veremos no capítulo 5, obedece ao princípio matemático da entropia [19], [20]. Quando a malha é bem refinada, a solução numérica converge para a solução correta.
4.2	O Método de Chaudhari
No artigo original [10], o método é apresentado tomando-se como exemplo uma equação de conservação não-linear. Por simplificação discutiremos o método aplicado à equação (4.1), com um coeficiente de dispersão Kpis. no lugar de 1/Pe.
Já vimos que:
(g).

(4.11)
(4.12)
Quando substituimos por	e por ■■■■)■■	■■■■*■■ em (4.1)? estamos de
fato resol ven do:
dC dC	r. d2C	bx/	M\d2C	n
dt + dx	KF,s'dx2 2 V	&amp;amp;x) dx2	°	’
(4.13)
Isto é, estamos resolvendo:
¡tn FiC	¡PC
■&amp;lt;4-14’
onde:
Kmu. = ~ (1 -	■	(4.15)
Para eliminar a dispersão artificial, Chaudhari [10] sugeriu somar o termo à equação original. Desta forma, pela análise acima, quando resolvermos numéricamente a equação:
dC dx
d2C
~ (Kfis. — Knum.) = 0

pelo método de ponderação a montante, o termo	anulará a dispersão numérica
artificial e estaremos com a solução correta.
Os problemas inerentes ao método são:
• Por considerar uma aproximação de segunda ordem no termo convectivo, a solução numérica apresenta oscilações, fato já observado nos testes realizados por Saad et alii [41].
• Está limitado a malhas uniformes [41].
Em virtude das limitações acima, não nos aprofundaremos na. análise do método.
4.3	O Método de Allen-Figueiredo
Uma discussão geral do método de Allen [3],[4] é apresentada por Figueiredo [15], Nesse item aplicamos o método para obter uma nova forma para a discretizaçâo da equação (4.1), discutimos a estabilidade, e demonstramos que o método se reduz a ponderação a montante no caso de fluxo convectivo.
Os principais passos que devem ser seguidos para obter a forma díscretizada da equação (4.1) pelo método de Allen-Figueiredo são:
•	Assumir o termo transiente de (4.1) como localmente constante e uniforme (^ = Kq — constante ).
•	Resolver analiticamente a equação. A solução fica em função de três constantes, Ai, Aj e o próprio Kq.
•	Para obter as constantes, aplicar a solução a três pontos nodaís consecutivos: i — 1, í, : + 1.
No apêndice C, após um longo desenvolvimento matemático, chegamos à expressão final do método de Allen-Figueiredo para a equação (4.1), com malha uniforme, no esquema explícito:
x - cr, cr - c^ _ (	\
Aí	As VePea* -1/ \ Ai2 )
Comparando-se com a discretizaçâo por 1 ponto a montante:
-Cf
Az:
+
ái
1 fC^~2Cf + Cf_, Pe \ As2
= 0
í
concluímos que a diferença entre os dois métodos está apenas na discretizaçâo do termo difusivo.
Com base em (4.18) podemos chegar a uma importante conclusão:
“Quando o escoamento é muito convectivo (Peclet alto), o método de Allen -Figueiredo se reduz ao método de ponderação a montante.”
Naturalmente, essa é uma grande limitação do método.
A vantagem do método de Allen-Figueiredo é que, por se reduzir ao método de ponderação a montante quando a equação de conservação é hiperbólica, o princípio da entropia é obedecido e, consequentemente, as soluções numéricas obtidas são sempre fisicamente coerentes.
0 critério de estabilidade para o método de Allen-Figueiredo explícito é deduzido no Apêndice E. Obtemos :
gPecE-L _ J
çPeCEL q. 2
A — Nco 5Í
(4.19)
onde Aí e Az são adimensionais e PeCEL é o número de Peclet celular (— PeAz).
Quando o número de Peclet é muito alto, a equação (4.19) fornece Nca &amp;lt;1, resultado idêntico ao obtido com o método 1 ponto a montante.
No apêndice E também demonstramos que o limite de estabilidade para o método de Allen-Figueiredo é sempre maior que o limite para o método de ponderação a montante.
4.4	O Método de Patankar
0 método de Patankar [33] é muito semelhante ao método de Allen-Figueiredo. A dedução completa do método, aplicado à equação (4.1), é apresentada no apêndice D. A seguir descrevemos as principais idéias do método:
•	A equação da convecção-difusão linear é resolvida analiticamente considerando-se regime permanente (^ = 0). A solução fica em termos de duas constantes, A3 e A;.
•	Para determinação das constantes aplicamos a solução analítica a dois pontos adjacentes da malha. Desta forma, obtemos a expressão para a concentração em um ponto qualquer da malha.
•	O fluxo total J é obtido por : J ~ C -
•	Os fluxos nas interfaces, Jt+i/2 e	podem então ser calculados. Consequen-
temente, podemos avaliar o termo de fluxo total da equação de conservação: dJ __	fs
dx	Ajf
A expressão final obtida no apêndice D é a mesma do método de Allen-Figueiredo, isto é, no esquema explícito:
(4.20)
Portanto, valem os mesmos comentários que fizemos no item anterior.
Santos [42] aplicou o método de Patankar para resolver numericamente o pro* blema de fluxo monofásico de traçador em duas dimensões.
4.5	O Método de Dois Pontos a Montante
Foi introduzido na engenharia de reservatórios por Todd, O’Deli e Hirasaki em 1972 [49]. O método foi aplicado para obter uma melhor aproximação das permeabilidades relativas nas interfaces dos blocos, em um simulador “black-oil”.
Em um modelo “black-oil” o termo de fluxo de um componente (óleo, água ou gás) é modelado por:
d (Tdp\
dx \ dx)i ’
sem considerar os efeitos gravitacionais e de capilaridade.
A discretização desse termo é normalmente feita como:
(4.21)
_L Ax
Pi+i " Pi
A.X
- Pi-A Ar /
Portanto, é necessário avaliar as transmissibilidades nas interfaces entre os blocos. Dentre os parâmetros que compõem a transmissibilidade, apenas a permeabilidade relativa é capaz de mudar rapidamente de um bloco para o outro, dificultando a solução numérica [49]. Com base nessa idéia, os autores aplicaram a aproximação por dois pontos a montante apenas nas permeabilidades relativas nas interfaces entre os blocos.
A seguir apresentamos a análise do método aplicado à equação da convecção-difusão linear (4.1). Consideraremos fluxo no sentido i — 1 —* i —* i + 1, e malha uniforme. Desenvolvendo em série de Taylor, obtemos as aproximações:
Ci-ãx
onde:
vem:
C^2 = C,-2Az
Az2 íd7C\ &gt;3 /a3C\
/4 2 \A2/, 8 6 Ux3). + 0(ÁX }*
Combinando-se as equações,
Ou seja:
(4.24)
4CU - G„2 = 3Cí - 2A:r
/aq = C^ + 3C.-iC^
\dx)i	2Ai	3	'
Evidentemente, o esquema é de segunda ordem no espaço.
Podemos também escrever:
(4.25)
fi-H/2 ~ Cj-l/2
Ax
Cí+i/a
Cí—1/2
(4.26)
(4.27)
Se a malha é não-uniforme,
Ct-„i 4-
Definindo-se:
Ci +
Az,
Ax¡ -f- Aj—i
(UM
A^-i
Aj:¿_y -f- Aí_2
Az;
* Az,- + Az,-_i ’
~ Ci_2)
(4.28)

1

CiJfi/2 ~ Q + ai (Cí ” C',-1) ,
Ci^/2 = U+MU-U) -
(4.29)
(4.30)
Evidentemente, Ci+i/2,	nao podem assumir valores negativos. Todd et
alii [49] propõem limitar:
C»+l/2 &gt; 0 ,
Cí+l/2 &amp;lt;max {Cí,Ci+1} .
A implantação dessas correções só é simples no esquema explícito de discretização.
Os autores também discutem as limitações que devem ser impostas ao tamanho de cada passo de tempo quando se utiliza o esquema explícito, para controlar a estabilidade, “overshoots” e erros de truncamento.
No capítulo 5 demonstramos que as soluções obtidas com o método de dois pontos a montante nem sempre obedecem ao princípio da entropia e, por esse motivo, podem ser fisicamente incorretas.
4.6	O Método de Saad-Leonard
Em 1979, Leonard [26] apresentou uma interessante revisão dos métodos de diferenças finitas para solução de equações de conservação e propôs um novo método para discretização do termo convectivo. O método é uma aproximação de terceira ordem no espaço e, segundo Leonard, é compatível com o método de diferenças centrais tradicionalmente usado para díscretizar o termo difusivo.
Tomando-se por base a equação (4.1), o método de diferenças centrais para o termo difusivo é escrito como:

(4.31)
Segundo Leonard, o método acima é incorretamente chamado de método de segunda ordem; o jargão surge de uma confusão entre o erro de discretização na expansão em série de Taylor e o erro de truncamento global na solução. A precisão de segunda ordem se refere à precisão do operador, e não à precisão do algoritmo que usa esse operador para resolver numéricamente uma equação diferencial. A ordem de um algoritmo numérico é definida como o maior grau de um polinomio para o qual o algoritmo é exato. Com base na equação (4.31), podemos ver que o esquema acima gera um algoritmo de terceira ordem para o termo difusivo.
Com base nessas idéias, Leonard propôs um esquema que também produz um algoritmo de terceira ordem para a discretização do termo convectivo. A dedução das
expressões a seguir é apresentada no apêndice F. Em seu artigo, Leonard mostra apenas os resultados finais.
Para fluxo no sentido i — 1 -+ i ~+ i + 1, obtemos:
2C^ + 3C&gt; "
dx)i	6Az?	12	* +
Assim,
í^i+i/2 —
&amp;amp;Í-1/2	=
(4.33)
(4.34)
Para fluxo no sentido contrário,
Ci 4-1/2	—
í?t-l/2	—
(4.35)
(4.36)
0 método de Leonard foi introduzido na área de engenharia de reservatórios por Taggart et alii [47], em 1987. Os autores apenas comentaram sobre a utilização do método em problemas 1D. Análises mais cuidadosas foram apresentadas em 1990, por Saad et alii [41] e por Gupta [17]. Nesse item vamos discutir com alguns detalhes as idéias de Saad et alii [41]; o método de Gupta consiste apenas em introduzir um termo para melhorar a estabilidade, e é discutido no próximo item.
A partir da publicação dos trabalhos de Saad et alii [41] e Gupta [17], alguns pesquisadores da Universidade do Texas em Austin começaram a aplicar o método para estudar o fluxo de traçadores [2], [5] e também para modelagem composicional de reservatórios considerando efeitos de difusão [8], [9]. Nesses estudos, o método de Leonard foi utilizado sempre com o esquema explícito de discretização.
Para solução de um problema em 1D pelo esquema implícito, o método tradicional de I ponto a montante conduz a uma matriz Jacobiana com 3 diagonais, enquanto o método de Saad-Leonard leva a uma matriz Jacobiana com 5 diagonais, considerando-se que, em alguns blocos, o fluxo pode ser convergente. Para um problema em 2D a matriz Jacobiana passa a ter 9 diagonais, com largura de banda 2NX (numeração da malha na direção X), em lugar da tradicional matriz pentadiagonal com largura de banda NX. Portanto, para resolver o problema com o esquema implícito , será necessário um grande aumento da área de memória e também do tempo de processamento. Evidentemente,
essa é uma forte desvantagem em rd ação ao método tradicional. No esquema explícito a aplicação do método de Saad-Leonard praticamente não gera sobrecarga computacional.
Uma característica comum aos métodos de ordem mais alta é que não podem ser empregados nas bordas da malha, por exigirem pontos fora do domínio. Nessas situações os autores sugerem mudar para o método de ponderação a montante. Aperfeiçoamos essa idéia verificando o sentido do fluxo em cada bloco próximo às bordas, e permitindo o uso do método de ordem mais alta sempre que não houverem pontos fora da malha.
Para evitar erros de balanço de materiais é importante garantir que a mesma expressão para uma propriedade na interface seja utilizada nas equações dos blocos adjacentes. Por exemplo, se C,+i/2 é calculada pela equação (4.33), essa relação deve ser empregada nas equações dos blocos i e i + 1.
Outra conclusão interessante, que demonstramos no apêndice F, é que o método de terceira ordem de Saad-Leonard pode ser escrito como uma: combinação linear entre os métodos de diferença central e dois pontos a montante. Para fluxo no sentido i — 1 i i -4- 1 e malha uniforme, temos:
_L
^í+l/í ~~	+
Az Ci+1 - Cj
2 Ag
Ag Cj - Cj^
2 Az
(4.37)
(4.38)
(4.39)
í

Ou, equivalentemente,
3	3
Saad et alii [41] também sugerem expressões para o caso da malha não-uniforme.
Definindo-se:
Aaq Az¿ + À®i_i 1 í	3	Azf
	Azí + Azj+i
os seguintes resultados foram obtidos:	
(4.41)
= C + y (C - G-i) +(Oh--O) ,	(4-42)
C%), =	+	+	.	(4.43)
No apêndice F comentamos que essas expressões são aproximações, e por esse motivo, quando o método é aplicado para malhas não-uniformes, a precisão passa a ser de segunda ordem no espaço. Mesmo nesses casos, Saad et alii [41] verificaram que os resultados obtidos com o método são bem melhores que os obtidos com o método tradicional.
Gupta [17] fornece equações mais precisas para o caso de malhas não-uniformes, mas também observa que, para esses casos, o método passa a ser de segunda ordem no espaço.
A estabilidade do método de Saad-Leonard é analisada no apêndice I, Com base nas expressões deduzidas para os métodos de 1 ponto a montante, Allen-Figueiredo e Saad-Leonard para a equação (4.1) no esquema explícito, construímos a figura 4.1.
Para facilitar a apresentação, definimos:
A/
Acs = A — (número de Courant) ,
Pçcbl. = PeAx — — (número de Peciet celular) ,
onde N é o número de nós da malha.
(4.44)
(4.45)
A dedução matemática desses critérios de estabilidade não foi encontrada nos artigos que pesquisamos.
Podemos observar que, para fluxo convectivo (Peciet alto), o limite de estabilidade do método de Saad-Leonard é muito restrito. Uma vez que os autores utilizam o método sempre com esquemas explícitos, algumas correções foram propostas para eliminar as oscilações.
Saad et alií [41] sugerem:
C“+I/2 &amp;lt;max {qr,C^} ,	(4.46)
C,"_1/2 &amp;lt;max	.	(4.47)
Gupta [17] sugere que	deve obedecer:
min {Cr.qLj&amp;lt;	&amp;lt;max	(4.48)
No capítulo 5 mostramos que o método de Saad-Leonard nem sempre obedece ao princípio da entropia, e, consequentemente, soluções incoerentes podem ser obtidas.
Figura 4.1: Limites de estabilidade, esquema explícito.
4.7	O Método de Gupta-Leonard
O método de Gupta [17] consiste em introduzir um termo corretivo, que melhora a estabilidade, no esquema de Leonard, Como já vimos, a utilização do método de terceira ordem com a formulação implícita é problemática devido ao aumento do número de diagonais e da largura de banda da matriz Jacobiana. Por isso, justifica-se a preocupação de Gupta em aumentar a estabilidade do método no esquema explícito.
No apêndice F discutimos a dedução do método, que não é apresentada por Gupta. Demonstramos que a introdução dos termos corretivos corresponde a avaliar o termo convectivo em um passo de tempo intermediário (n-f-l/2), ao invés do tempo (n). As expressões para as concentrações nas interfaces, para fluxo no sentido i — 1 —* i —♦ i +1, são:
CÍ/2 = C^2 + ^(Cm+C,-2Cw) ,	(4.49)
~ ^í-i/a +	(C&lt;-2 + Ci-i ~ 26',) ,	(4.50)
onde Nco é o número de Courant.
Conforme demonstramos no apêndice F, a obtenção das expressões acima exige supor que a equação de conservação é hiperbólica, isto é, que o termo difusivo é nulo. Os testes realizados mostraram, no entanto, que bons resultados são obtidos mesmo quando o termo difusivo está presente.
O aumento da estabilidade do método de terceira ordem quando adicionamos o termo corretivo é mostrada, de forma muito clara, na figura 4 do artigo de Gupta [17]. Sem o termo corretivo, o método de terceira ordem fica cada vez mais instável à medida que o número de Peclei aumenta. A correção permite que sejam usados passos de tempo maiores no esquema explícito, para essa faixa de fluxo muito convectivo.
4.8	O Método de Leonard Modificado
Uma proposta natural de um método de terceira ordem para o termo convectivo é aproximá-lo considerando todos os termos a montante do fluxo. Denominamos esse método de Leonard modificado. A dedução das equações é apresentada no apêndice G. Considerando fluxo no sentido i — 1 —&gt; í —* i + 1, obtemos:
= 1 (2Cí-, - 70-, + 11C.) ,	(4.51)
CS/I = |(2Cí.3-7Cí-j + HCi.)) .	(4.52)
Podemos concluir que a aplicação do método é simples no esquema explícito. No esquema implícito é problemática devido ao aumento do número de diagonais e da largura de banda da matriz Jacobiana.
No capítulo 5 mostramos que esse método nem sempre obedece ao princípio da entropia, e, consequentemente, as soluções obtidas podem ser fisicamente incorretas.
4.9	A Correção de Segunda Ordem no Tempo
Ainda com a preocupação de melhorar a estabilidade dos métodos de terceira ordem no esquema explícito, Jianchun Liu [27] propôs adotar um esquema semelhante ao de Lax-Wendroff [47] para obter uma discretização de segunda ordem para o termo temporal da equação de conservação.
A dedução da expressão para . é apresentada no Apêndice H. 0 resultado obtido foi:
C"+1 - C? Ai íd2C\ _ O?*' - Q At (C?+í - 2Q + C?_x \dt)i Ai 2 V&amp;amp;r2J “ Ai 2 \	A^2
Em seu trabalho, Liu [27] mostra, através de exemplos práticos, que o emprego da discretização de segunda ordem no termo temporal melhora muito a estabilidade do método de terceira ordem, na faixa de altos números de Peclet.
Da equação (4.53) vemos que a correção introduz um termo de dispersão artificial, com Pe ™ 2/Aí, que tende a estabilizar a solução numérica e aumentar o limite de estabilidade do esquema explícito. Se o valor de At não for grande, a dispersão numérica adicional não altera muito a forma da frente de avanço.
Embora não tenha sido discutido por Liu [27], demonstramos, no apêndice H, que a dedução da expressão acima exige supor que a equação de conservação tem a forma hiperbólica e, portanto, não é rigorosamente válido quando o termo difusivo está presente.
4.10	Esquemas TVD (“Total Variation Diminishing”)
Nos itens anteriores comentamos que os esquemas de ordem mais alta para discretização do termo convectivo podem conduzir a soluções fisicamente incorretas quando a equação de conservação assume a forma hiperbólica (fluxo muíto convectivo). Tal ocorre porque a equação de conservação nessa forma, com as condições de contorno normalmente utilizadas, não caracteriza um problema matematicamente bem-posto. E necessária uma condição adicional que permita selecionar a solução correta entre as soluções fracas do problema. Conforme discutiremos no capítulo 5, essa condição é conhecida na matemática como condição de entropia, e foi introduzida por Oleínik [30] em 1957.
No capítulo 5 mostramos que os métodos de ordem mais alta nem sempre obedecem a condição de entropia. O método de ponderação a montante, ao contrário, sempre obedece. Com base nessas idéias, em 1983, Harten [20] propôs acoplar um termo de
correção anti-difiisivo ao tradicional esquema de ponderação a montante. 0 método será discutido tomando-se como exemplo a equação de Buckley-Leverett, na forma hiperbólica:
dS» dfw
dt dx
(4.54)
A discretizaçao do termo convectivo é escrita como:
^1/2 - ^-1/2
dx	àx
O esquema de Harten [20] , considerando fluxo no sentido í — 1 —* i -+ i -f 1, define uma aproximação de segunda ordem :
4- (p.
|(âsi + Así+í)
-Ft + ^Ã(FI+1~F() ,
2
onde o parâmetro é conhecido como limitador de fluxo.
O conceito de variação total, introduzido por Harten [20] corresponde a:
TV" = E K. - SZ. | = E K. | ,	(4.57)
i	i
onde n indica o nível de tempo e i o número do bloco de simulação.
Um esquema numérico para solução da equação da conservação é dito TVD (“Total Variation Diminishing1’) se:
TVn+i &amp;lt;TVn	(4&lt;58)
Segundo Sweby [46], um esquema TVD tem a notável propriedade de produzir soluções que obedecem ao princípio da entropia, e que, portanto, são as soluções corretas do problema. Não existe uma demonstração matemática formal dessa afirmativa, apenas evidências de resultados numéricos.
Rubin e Blunt [40] afirmam que esquemas TVD possuem duas propriedades que, nos casos práticos de simulação de reservatórios, são suficientes para produzir soluções corretas e convergentes:
•	Um esquema TVD não permite o aparecimento de oscilações não - físicas. Por exemplo, um perfil monotõnico de saturações permanece monotônico. Ou seja, o esquema TVD preserva a monotonicidade.
•	Um esquema TVD é limitado, o que implica em estabilidade.
No capítulo 5 discutimos melhor estas propriedades.
Partindo-se da equação (4.56) e substituindo-se na forma discretizada de (4.54), pode-se provar que os limitadores devem obedecer a alguns critérios algébricos para que o esquema final seja TVD. 0 primeiro a demonstrar matematicamente esses critérios foi Harten (20). No apêndice J discutimos os detalhes da demonstração.
Para estabelecer os critérios TVD, é conveniente definir os parâmetros rf-, que fornecem a relação entre os fluxos nas interfaces dos blocos de simulação. Para a equação de Buckley-Leverett, e fluxo no sentido i — 1 -+ i -* i + 1, r,- é definido como:
= % fctkd .	(4.59)
Aaq_i + AxiJ	yFi+i — FtJ
Os limitadores de fluxo são expressos em função dos parâmetros r. Os critérios TVD definem regiões no plano ç?(r) versus r, no interior das quais os limitadores ç? devem estar contidos, para garantir redução das variações totais. Conforme mostramos no apêndice K, as regiões de Sweby [46] e de Liu são exemplos de regiões TVD.
A seguir descrevemos os limitadores que utilizaremos nesse trabalho.
a)	Limitador de Sweby [46]
A região TVD de Sweby [46] resulta basicamente da aplicação dos critérios algébricos deduzidos no apêndice J sobre os limitadores çç. A demonstração é apresentada no apêndice K, nos itens K.3 e K.4, para malhas uniformes e não-uniformes. O diagrama ^(r) versus r é mostrado na figura K.l.
O limitador de Sweby é definido como o limite superior dessa região, ou seja, para malha uniforme:
0	&lt;	V(r) &amp;lt;2 ,	
0	&lt;	'Ctí&lt;2 , r	
r	&lt;	&lt;p(r) — 1 ,para 0 &amp;lt;r &amp;lt;1 ,	
1	&lt;	9?(r) &amp;lt;r ,para r &gt; 1 .	(4.60)
Essa é a região TVD		correta, e os limitadores TVD devem estar contidos no	
interior da mesma.
b)	Limitador de Van Leer [50]
É definido por:
r + ]r[
i + H
(4.61)
Na figura K.l podemos observar que o limitador de Van-Leer [50] está contido no interior da região TVD de Sweby. Quando o fluxo é convergente ou divergente em um bloco de simulação (r &amp;lt;0), temos que if&gt; = 0 e, de acordo com (4.56), o esquema se reduz automaticamente ao esquema de ponderação a montante.
No apêndice K apresentamos uma interpretação original para o limitador de Van-Leer: comparando (4.56) com o desenvolvimento em série de Taylor para
VTT.	._.
^+1/2 = 4—■&gt;	(4.62)
demonstramos que o limitador de Van-Leer corresponde a calcular F- como a média harmónica das derivadas do fluxo em i + 1/2 e i — 1/2. Como a média harmônica sempre tende para o menor valor, quando a frente de avanço é abrupta teremos F- ~ 0, e a aproximação será feita por F¿, reduzindo-se ao esquema de ponderação a montante. Dessa forma são evitadas as oscilações comuns aos métodos de ordem mais alta junto à frente de avanço.
Também no apêndice K, demonstramos que o limitador de Van-Leer tem a mesma forma quando a malha não é uniforme. Tais considerações não são feitas pelos autores que utilizam o limitador de Van-Leer [50], [46], [40].
c)	Limitador de Terceira Ordem [18], [27]
O limitador de terceira ordem foi originalmente proposto por Gupta et alii [18], e utilizado por Liu [27].
De acordo com (4.56), para fluxo no sentido i ~ 1 —&gt; i —&gt; i + 1, temos:
Ft+1/2 = Fi +	(Fi+1 - F-) .	(4.63)
Utilizando-se para	a expressão correspondente ao método de terceira
ordem, de Saad-Leonard,
(4.64)
FiH/2 = F + j (R - R-i) +	(R« - F.) ,
e igualando-se as duas expressões é possível obter (vide apêndice K):
„	(F^ F^y 2
V' tC+i - FJ 3 '
Pela definição de rç, temos:
(4.65)
Da mesma forma, é possível demonstrar que, para diferenças centrais,
(4.67)
e, para dois pontos a montante,
Portanto, o limitador de terceira ordem pode ser escrito como:
V =	+ |d’PM) ■	(4.69)
No apêndice K demonstramos que a mesma equação (4,65) pode ser obtida considerando-se fluxo em sentido contrário.
Ainda no apêndice K mostramos como Jiancliun Liu [27] obteve uma ampliação na região TVD de Sweby. Liu [27] não comenta, mas precisou admitir algumas simplificações, com as quais não concordamos, para definir a nova região TVD. A região ampliada de Liu é mostrada na figura K.2, no mesmo apêndice.
Analisando as figuras K.l e K.2 do apêndice K, notamos que, em certos trechos, o limitador de terceira ordem, que corresponde ao método de Saad-Leonard, sai fora da região TVD de Sweby. Isso mestra que o método de Saad-Leonard não é TVD. Para obrigar que o limitador de terceira ordem produza um esquema TVD é preciso restringí-lo aos limites da região de Sweby. Dessa forma, o método é de terceira ordem em regiões suaves; quando o limitador fica restrito pelas bordas da região de Sweby é fácil provar que o esquema passa a ser de segunda ordem.
Em nossos testes práticos (capítulos 6, 7, 8, 9, 10), mostramos que a região TVD de Liu não é muito adequada, confirmando nossa discussão teórica do apêndice K. A região TVD de Sweby conduziu a resultados sempre melhores.
4.11	O Método TVD de Rubin e Blunt
Rubin e Blunt [40] introduziram os esquemas TVD na simulação de reservatórios em 1990. Foi utilizado o limitador de Van Leer [50], definindo um esquema de segunda ordem no espaço. Conforme detalharemos no capítulo 9, o método foi empregado para discretizar o termo de fluxo total em um modelo de simulação de reservatórios.
Tomando-se como exemplo a equação de Buckley-Leverett, o método de Rubin e Blunt para discretização do termo convectivo pode ser escrito como:
&amp;lt;_ ^1/2 - ^¡2
dx	&amp;amp;Xí
Para fluxo no sentido i ~ 1 -47—+ ¿4-1, temos:
■fiUi/2 = -fí +	(^‘+1 - Pi) &gt;
onde tp{ é o limitador de Van-Leer:
(471)
&lt;P.‘ =
?i + |rj
1 + hl
4&gt;12 O Método TVD de Terceira Ordem
Utilizamos as mesmas definições do item anterior, com o limitador de terceira
ordem [18], [27];	(2 + r,) .	(4.73)
Para a região TVD trabalhamos com duas alternativas:
*	Região TVD de Sweby (figura K.l, apêndice K)
•	Região TVD de Liu (figura K,2, apêndice K)
5	LEIS DE CONSERVAÇÃO - PRINCÍPIOS MATEMÁTICOS
Nesse capítulo discutimos os principais fundamentos matemáticos sobre leis de conservação hiperbólicas, bem como as condições que devem ser obedecidas pelas soluções numéricas. Posteriormente, utilizamos esses princípios para analisar os métodos numéricos de diferenças finitas apresentados no capítulo anterior.
Essa análise matemática não foi feita pelos diversos autores que propuseram métodos de difrenças finitas de ordem mais alta para aplicação na engenharia de reservatórios.
5.1	Soluções Fracas
Seja um problema de valor inicial definido pela lei de conservação:
du df(u) _
&amp;amp;+~âT‘“°
com a condição inicial:
u(o:,0) = «0(2:) .
(5.1)
(5.2)
Chamando a(u) = f'(u) , podemos escrever (5.1) como:
du dt
(5-3)
Equações diferenciais desse tipo apresentam descontinuidades na solução, mesmo que u0(x) seja uma função bem comportada [44]. Para permitir que soluções descontínuas sejam obtidas, (5.1) deve ser escrita na forma fraca.
Seja ^(aqí) uma função escalar suave de suporte compacto [a,b] , ou seja, que tende a zero para x fora desse intervalo.
Multiplicando-se (5.1) por	e Íntegrando-se para —00&amp;lt;K&lt;ooeí&gt;0,
segue:
dx
dt dx = 0
lntegrando-se (5.4) por partes, resulta:
dx
dtdx + / $(xt&amp;amp;)uf)(x}dx = 0 . Ja
(5-5)
A equação (5.5) é a forma fraca de (5.1).
Uma função u(x,t) que satisfaz (5.5) para qualquer função ^(z,t) suave de suporte compacto é chamada solução fraca da lei de conservação (5.1).
0 problema é que a equação (5.1) pode admitir várias soluções fracas. Outras condições devem ser impostas para que a solução fisicamente correta seja obtida.
5.2 O Princípio de Rankine-Hugoniot
Nesse item analisamos a solução na descontinuidade, y(t). Chamaremos de L um ponto à esquerda da descontinuidade e R um ponto à direita. A figura 5.1 mostra a solução na descontinuidade em um diagrama i — x.
1.00
0.8Ô
0.60
i
*0.40
0.20
0.00
CUffVA CARACTERÍSTICA AO LONGO DA DESCCWTiNJIDADE
y(0
0.00
A 0-
8
-o
O.íÓ
Tvrr-rTT"i i i i ■ &amp;lt;&gt; v 1’nTT 0.40	0.80
dSTANCSA (x)
i-rrn'
0.80
1.00
/ R
z


Figura 5.1: Solução na descontinuidade.
Seja :
(5.6)
Derivándose e usándose a regra de Leibnitz resulta:
dZ _ r* du dt Ja dt
dx — uR
dy dt '
(5.7)
Mas, usando-se (5.1) ,
3u __ df dt dx
Logo,
í = /(«) - f(uL) + uL~~ ~ f(b) + f(un) - uR~ .	(5.8)
Por outro lado, representa a acumulação no intervalo de tempo Aí . Assim,
f = /w - m ■
Substituindo se (5.9) em (5.8), segue:
(5-9)
dy = /(u/,) - f(uR) dt	m — uR
Essa relação fornece a velocidade de propagação da descontinuidade e é conhecida como condição de Rankine-Hugoniot [44].
A classe de soluções fracas que obedecem (5.10) é ainda muito grande de forma que em geral não há unicidade. E necessário impor mais uma condição, conhecida como princípio da entropia, para garantir a unicidade.
5.3	O Princípio da Entropia
Já vimos que é necessário um critério adicional para a escolha da solução fisicamente correta de (5.1). Tal critério, conhecido como condição de entropia, foi introduzido por Oleiník [30] em 1957. Existem 3 enunciados distintos para esse princípio, conforme discutimos a seguir:
•	Enunciado 1
A solução correta de (5.1) é aquela obtida resol vendo-se:
du df d2u
com um valor de e suficientemente pequeno. Ou seja, se introduz na equação um termo difusivo, ou de viscosidade elástica artificial.
Tal enunciado não é muito prático, pois nunca sabemos qual o menor valor de e capaz de estabilizar a solução numérica.
*	Enunciado 2
Seja U(u) uma função convexa	&gt; 0) chamada função de entropia. Seja G(u)
uma função tal que	chamada função fluxo de entropía. Multiplicando
(5.11) por usando a convexidade de U e tomando o limite quando e -+ 0, podemos mostrar que a solução correta de (5.1) deve satisfazer:
dü_
dt
A igualdade em (5.12) vale para soluções suaves u(x,t), e a desigualdade vale nas descont inuidades.
No caso de f(u) convexa, Osher et alii [31] afirmam que basta verificar (5.12) para uma única função de entropia. Para f(u) não-convexa, (5.12) deve ser verificada para todas as funções U(u) = [u — c|, onde c ê uma constante.
Embora explorado por alguns matemáticos, o enunciado 2 não é utilizado na prática.
• Enunciado 3
Sejam ur e uR os estados à esquerda e à direita da descontinuidade. Para todo u no intervalo (u^ur), a solução correta deve obedecer:
f(A~A"d. &gt; s &gt; f{u&gt; ~ f("K&gt; ,	(5.13)
u-uL	U-~UR
onde S é a velocidade de propagação da descontinuidade.
Esse enunciado é o original de Oleinik [30], e o mais prático de ser aplicado. A solução fraca que obedece (5.13) é a única solução fisicamente correta de (5.1).
Com base na definição da velocidade,
a(u) = /(u) ,	(5.14)
temos:

ii„, ZMzAM
Portanto:
(5.15)
(5.16)

g(«l) &gt; 8 &gt; ü(ur) .
(5.17)
O teorema que liga o princípio da entropia à solução única de (5.1) foi formalmente introduzido por Le Roux [38] em 1977:
“Se um esquema numérico é convergente e satizfaz ao princípio da entropia, então converge para a solução fisicamente correta.”
5.4	Problemas de Riemann - Tipos de Choques
A equação de conservação hiperbólica (5.1) , com condições iniciais dadas pela função degrau:
u(x,o) = u„M = [ uulr\ Í&gt;o 1	&lt;5'18)
define um problema de Riemann.
Uma propriedade de um problema de Riemann é a auto-similaridade, isto é, a solução pode ser escrita como u(&amp;amp;, t) — fi(z/t), onde h é uma função contínua por partes.
Seja S a velocidade de propagação dada por (5.10). Se uL e ur são estados que obedecem ao princípio da entropia ( a(«x) &gt; S &gt; a(un) ), a solução de (5.1) com as condições (5.18) tem a forma de uma onda de choque se propagando com velocidade S, isto é:
t) == u0(a; ~ St) = |	&gt; s	(5.19)
A figura 5.2 mostra a solução num diagrama i — x.
Vemcs que, nesse caso, a descontinuidade corresponde a uma onda de choque que se propaga com velocidade S.
Figura 5.2: Onda de choque.
Se e ur nao obedecem ao princípio da entropia, ou seja, a(u¿) &amp;lt;a(un), a solução é:
ÍuL , x/t &amp;lt;a(uh)
h(x/t) , a(ujr,) &amp;lt;x/t &amp;lt;a(ujft) ,	(5.20)
WH , X/Í &gt; ô(Wfí)
onde h é tal que ft(a(.z)) = z .
O trecho a(u¿) &amp;lt;x/t&amp;lt;	é chamado leque de rarefação.
5.5	Esquemas Conservativos
Um esquema de diferenças finitas para solução de (5.1) é chamado conservativo quando pode ser escrito na forma:
= «I - A (í?+1/! - í?_1/2) ,	(5.21)
onde J%1/2 = F (u£„r, ... ,	é uma função de fluxo numérico consistente, isto é ,
F'(u,u,u, ... ,u) - 7(u) .
(5,22)
O parâmetro A é definido como:
A = At/A® .	(5.23)
Pode ser demonstrado que, se um esquema escrito na forma conservativa converge quando A® 0, com A fixo, então converge para uma solução fraca de (5,1),
5,6	Esquemas Monótonos
Um esquema de diferenças finitas escrito na forma:
&lt;+I = H (u^r , u?_,+1 , .. ■ , «?+,) ,	(5.24)
é monótono se H é uma função monótona crescente de cada um de seus 2r +1 argumentos, isto é,
Qjj
ff. = ____ &gt; o , para - r &amp;lt;j &amp;lt;r ,	(5.25)
Se a função H é consistente e pode ser escrita na forma conservativa, diz-se que o esquema de diferenças finitas está na forma conservativa.
Dois importantes resultados podem ser demonstrados [44]:
•	Seja um esquema de diferenças finitas monótono escrito na forma conservativa. Se a solução é convergente quando At e A® tendem a zero com A ~ &amp;amp;1/&amp;amp;.X fixo, então u(®,t) é uma solução fraca e o princípio da entropia (5.13) é obedecido em todas as descontinuidades.
•	Um esquema de diferenças finitas monótono escrito na forma conservativa tem precisão de primeara ordem.
Podemos provar que o esquema de ponderação com 1 ponto a montante é monótono:
Considerando fluxo no sentido sentido í — 1 i —+ i + 1, temos:
du?
ÔH
(5.26)
(5.27)
(5.28)
A condição (5.27) é o próprio limite de estabilidade do método. A condição
(5.28)	é sempre obedecida, pois a velocidade é positiva.
Logo, o método de ponderação a montante é monótono e, quando convergente, obedece ao princípio da entropia.
Quanto aos esquemas TVD, Sod [44] demonstra que preservam a monoto-nicidade, mas não há prova formal de que obedecem ao princípio da entropia, apenas constatações práticas.
Nos itens seguintes resolvemos algumas equações clássicas da matemática u-saudo os métodos apresentados no capítulo 4.
5.7	Equação de Burgers
A equação de Burgers [7], bastante usada na matemática, é uma equação de conservação hiperbólica:
(5.29)
com:
/(«) = +
(5.30)
e a condição inicial:
(5.31)
Temos então que a(u) = /'(u) = tí. Logo, a(u^) = —1 e «(íçr) = 1.
A velocidade na descontinuidade é :
fM - f(uR) __ 1/2 - 1/2
Wr — ul	1 + 1
Ur-ul
Como o(ul) &amp;lt;S &amp;lt;o(«h), a solução da equação compreende uma onda de
rarefação:
—1 , x &amp;lt;—t
u(x,t) ~ x/i s
1 , t &amp;lt;x
(5.32)
Pode ser mostrado [31] que (5.31) é também uma solução fraca da equação.
1.20
1.00
0.80
0.60
0.40
SOLUCAO (U)	SOLUCAO (U)
0.20
0.00
—0.20
-0.40
-0.60
-0.80
-1.00
-1.20
-•	Or,
Dn

EQUACAO DE BURGERS SOLUCAO NUMERICA N = 31 NOS, DELTAT = TEMPO = 0.2
ANALÍTICA
A MONTANTE
ooooo DODDD
SOLUCAO
1	PONTO
2	PONTOS A MONTANTE SAAD-LEONARD LEONARD MODIFICADO
-1.00
1.20
1.00
0,80
0.60
0.40
0.20
0.00
-0.20 -
0,40 7
-0.60
-0.80
oD
o°
i 1 i 1 i I 7 T 1"~7 l-'-l  I 1 j i ! -7—r~r~i—!-”i -t  7 r -7 i—r~r~r~ -0.5D	0.00	0.50	1.00
DISTANCIA ADIMENSIONAL
0.00
Figura 5.3: Equação de Burgers - Solução Numérica.
EQUACAO DE BURGERS
SOLUCAO NUMERICA
N — 31 NOS, DELTAT = 0.001 TEMPO = 0.2
-	é
- ■J .00 "&amp;lt;&gt;000000000000000000-
-1.20
-1.00
g-oeoooooooooo-ooooCH &gt;
---- SOLUCAO ANAUTICA
---- SAAD-LEONARD
----TVD RUBIN E BLUNT oooooTVD TERC. ORDEM / SWEBY
■7—I-1-[-(—7—1-1-J—1-r-T~~7.1-1-!—7-1-1 "1 "1-1-1—I-!	7.’.&gt;' '1	!	’ I « 1	1	'	1	T""1 i
-0.50	0.00	0.50	1.00
DISTANCIA ADIMENSIONAL
Para resolver a equação de Burgers com os métodos descritos no Capítulo 4, utilizamos os seguintes parâmetros:
•	número de nós: 31
•	Delta T : 0,001
Os resultados são apresentados nas figuras 5.3 e 5,4. Observamos que:
•	Todos os métodos convergem para a solução fisicamente correta.
•	O método um ponto a montante é o que apresenta maior dispersão numérica.
•	Os métodos de dois pontos a montante e Leonard modificado oscilam nas proximidades das descontinuidades.
•	Os métodos TVD apresentam excelente solução.
5.8	Equação proposta por Harten et alii
Nesse ítem resolvemos numéricamente a equação proposta por Harten et alii [19], com os métodos discutidos no capítulo 4. Essa equação é também discutida por Gary Sod, à página 301 de seu livro [44].
A equação de conservação é idéntica a (5.29), com:
/(«) — u — 3\/3u2(u — l)2 ,
(5.33)
e condição inicial:
u(x,0) = u0(a:) ~ -
l,x&amp;lt;0,5
0,x &gt;0,5
(5.34)
Temos:
•	a(u) = /(«) = 1 - 6v^u(u - l)(2u - 1) ,
•	a(u¿) = «(1) = 1 , e
•	a(uR) = a(0) ~ 1 .
A velocidade de propagação da descontinuidade é:
	c _	~ ÍM ! UL — Ufi
Como cr(u¿) = de choque:	- S — «(ur), a solução correta de (5.29) compreende uma onda
ufa:,i) ”	— Si) = ■
1,1 &amp;lt;0,5 4- i Q,x &gt; 0,5 + t
A equação (5.29) com as condições (5.33) e (5.34) foi resolvida com os métodos numéricos descritos no Capitulo 4.
Os resultados, para t = 0,1 e t = 0,2 , encontram-se nas figuras 5.5 a 5.14. Consideramos IV = 50 nós e Aí = 0,001.
Observamos que os métodos de um ponto a montante e TVD de terceira ordem com região TVD de Sweby convergem para a solução fisicamente correta do problema. Essa é mais uma evidência que os esquemas TVD obedecem ao princípio da entropia.
A qualidade da solução obtida com o TVD foi melhor que a obtida com o método um ponto a montante, ou seja, a dispersão numérica foi menor. Embora não tenhamos incluído os gráficos, a solução obtida com o método TVD de Rubin e Blunt (limitador de Van Leer) foi praticamente idêntica à obtida com o TVD de terceira ordem.
Os demais métodos convergiram para soluções fracas que são fisicamente incorretas. Vamos analisar, por exemplo, a solução obtida com o método de Saad-Leonard (figuras 5,9 e 5.10). Análises semelhantes podem ser feitas para as soluções obtidas com os demais métodos.
a)	Método die Saad-Leonard : análise da condição de Rankine— Hugoniot.
Analisando as figuras 5.9 e 5.10 observamos quatro patamares:
« uL = 1,000
•	iq — 1,338
•	u2 = 0,577
•	uji = 0,000
F(ul)= 1,000
F(ui) =0,275
F(u2) = 0,267
F(uR) =0,000
De acordo com Rankine-Hugoniot, as velocidades das descontinuidades devem
ser:
SOLUCAO (U)	SOLUCAO (U)
2.00
1,75
1,50
1,25
1,00
0,75
0.50
0.25
-0.00
-0.25
-0.50
0.00	0,20	0,40	0,60	O.SO	1.00
DISTANCIA AD1MENSI0NAL
EQUACAO DE HARTEN - SOLUCAO NUMERICA
TEMPO - 0.1, N - 50 NOS, DELTAT - 0.001 METODO 1 PONTO A MONTANTE
SOLUCAO ANALITICA
1 PONTO A MONTANTE
■r.y..r..rT..y-&gt;1-T-„ lili vrTT~T i m i i^~r~r7~i~r"T~r^r~r~T'~r~r‘r~r~T~r~r~f~r‘if 'T T T t
Figura 5,5: Equação de Harten - Método 1 ponto a montante.
2,00
-0.50
0,00
1.00
0.50
1.75
1.50
1,25
0.75
0.25
-0,25
EQUACAO DE HARTEN - SOLUCAO NUMERICA TEMPO = 0.2, N = 50 NOS, DELTAT » D.OO1 METODO 1 PONTO A MONTANTE	
l X f 	 SOLUCAO ANALÍTICA	l i X X
	 1	PONTO A MONTANTE	
O.SO
1.00
y t i i j j | y i 0.20
y,r,^.T-r-y-r-r-r y I I I y I I I !
0,40	0,60
DISTANCIA ADIMENSIONAL
SOLUCAO (U)	SOLUCAO (U)
2.00
1.75
1.50
1.25
1.00
0.75
0.50
0.25
-0.00
-0.25
-0.50
0.00	0.20	0.40	0.60	0.80	1.00
DISTANCIA ADIMENSIONAL
EOUACAO DE HARTEN - SOLUCAO NUMÉRICA
TEMPO = 0.1, N - 50 NOS, DELTAT *= 0.001 MÉTODO 2 PONTOS A MONTANTE
SOLUCAO ANALÍTICA
2 PONTOS A MONTANTE
i~r~r~ri~iri~i—r vt r y-T-vvvt-t r r i i ; y ; y y i r-r r ■ r., t i 3-	? p t
Figura 5,7: Equação de Harten - Método 2 pontos a montante.
2.00
1.75
1.50
1.25
1.00
0.75
0.50
0.25
0.00
-0.25
EQÜACAO DE HARTEN - SOLUCAO NUMÉRICA TEMPO = 0.2, N = 50 NOS, DELTAT = 0,001 MÉTODO 2 PONTOS A MONTANTE
-	SOLUCAO ANALÍTICA
-	2 PONTOS A MONTANTE
*
4
í
l
I
I I t
*
4
L
1
i
1 J
4
----------
f
-0.50
0.00
rt i i ! i i i i j-T-TT-yTT-fTTTT-rT-i r t i ,	..(...p..,........t..,.
0.20	0.40	0.60	0.80
DISTANCIA ADIMENSIONAL
1.00
SOLUCAO (U)	SOLUCAO (U)
2.00
1.75
1.50
1.25
1.00
0.75
0.50
0.25
-0.00
-0,25
-0.50
0.00	0.20	0.40	0.60	O.EO	1.00
DISTANCIA ADIMENSIONAL
2.00
1.75
1.50
1.25
1.00
0.75
0.50 -
0.25 ~
-0.00
-0.25 -
EQUACAO DE HARTEN - SOLUCAO NUMERICA
TEMPO = 0.1. N - 50 NOS. DELTAT - 0.001 METODO DE SAAD-LEONARD
t
t f /
1
l
♦
I
I
I
t
4
I
I,
I
I
1
—	SOLUCAO ANALITICA
—	SAAD-LEONARD
Figura 5.9: Equação de Harten - Método Saad-Leonard.
EQUACAO DE HARTEN - SOLUCAO NUMERICA
TEMPO = 0.2, N = 50 NOS, DELTAT = 0.001 METODO DE SAAD-LEONARD
/
A
Í
J.
I
I
I
1
SOLUCAO ANALITICA SAAD - LEONARD
I
I
I
1
I
I
—0.50 dm-n i i &amp;lt;i | T-(-r-r-r-i'11"r r¡ i i-mTfrrnn-r ! t i i i ( r ; i i i-t-t-t-t-
0.00	0.20	0.40	0.60	0.80	1.00
DISTANCIA ADIMENSIONAL
0.20
0.80
2,00
1.75
1.50
1.25
4G
EQUACAO DE HARTEN - SOLUCAO NUMERICA
TEMPO - 0.1, N - 50 NOS, DELTA! - 0.001 METODO DE LEONARD MODIFICADO
SOLUCAO (U)	SOLUCAO (U)
1,00
0.75
0.50
0.25
-0.00
-0.25
-0.50
0.00
2.00
1.75
1.50
1.25
1.00
0.75
0.50
0.25
-0.00
—	SOLUCAO ANALITICA
-	LEONARD MODIFICADO
t
I
4
I t
I t
I
Í
I
t
I
I
4-
$
I
/
A ,
f k *	1 — ”
,	t	r„p.r..r.r.r-r^-r,r-r-pr...y...r„rT	.T..y.	j
0.20	0.40	0.60	0.00	1.00
DISTANCIA ADIMENSIONAL
Figura 5.11: Equação de Harten - Método Leonard modificado.
EQUACAO DE HARTEN - SOLUCAO NUMERICA
TEMPO = 0.2, N = 50 NOS, DELTAT = 0.001 METODO DE LEONARD MODIFICADO
SOLUCAO ANALITICA LEONARD MODIFICADO
Ü
I
I
Í
I
1
I
1
I I I
-4-
4
&gt;
-0.50
0.00
tt ■;■■■ i	T"T-r ■■ I - TT-|-r ! i i I i 1 r 1" ■ i-tttttt i i ■ , ■rri i i | i n t ■■ i—t - ■ r" 'i
0.20	0.40	0.60	0.80
DISTANCIA AD I MEN St ON AL
-fi
1.00
SOLUCAO (U)	SOLUCAO (U)
2.00
175
1.50
1.25
1.00
075
0.50
0.25
-0.00
-0.25
-0.50
0.00	0.20	0.40	0.60	0.80	i 00
DISTANCIA ADIMENSIONAL
EQUACAO DE HARTEN - SOLUCAO NUMÉRICA
TEMPO - 0.1. N - 50 NOS. DELTAT « 0.001 MÉTODO TVD DE TERCEIRA ORDEM, REGIÃO DE SWEBY
----- SOLUCAO ANALÍTICA
■.... TVD TERC. ORO. / SWEBY
r vr rri i * i itttt) 'hm pT-r-ri-TM.r...r„?...T.^ )U1 r|..n i i i t i j rrrrt
Figura 5.131 Equação de Harten - Método TVD terceira ordem / Sweby.
2.00
175
1.50
1.25
1.00
0.75
0.50
0.25
-0.00
-0.25
EQUACAO DE HARTEN - SOLUCAO NUMÉRICA
TEMPO = 0.2, N = 50 NOS, DELTAT = 0.001 MÉTODO TVD DE TERCEIRA ORDEM, REGIÃO DE SWEBY
—	SOLUCAO ANALÍTICA
-	TVD TERC. ORD. / SWEBY
t
*
l
1
1
1
1

0.50--; 1 t 1 | f 1 r ITTrrTTTTrT ’1 r	; 1 ; I I I 1
0.00	0.20	0.40	0.60	0.80
DISTANCIA ADIMENSIONAL
1.00
Figura 5-14: Equação de Harten - Método TVD terceira ordem / Sweby.
Ç =	= 1,000 -0,275
1	uL~Ui 1,000 “ 1,338 ”	1	’
o = fM~fM ~ 0,275 “ 0,267 ~
2	«i - u2	1,338 — 0,577
S	= 0,267 - 0,000 ~
3	u2-uR	0,577 - 0,000	’	'
Com as posições nos tempos 0,1 e 0,2, podemos calcular as velocidades obtidas com o método numérico. Os resultados são apresentados na tabela 5.8.
	x em T = 0,1	x em T — 0,2	v = A x / A t
Primeiro choque	0,293	0,090	-2,03
Segundo choque	0,500	0,500	0,00
Terceiro choque	0,565	0,610	0,45
Tabela 5.1: Posições das descontinuidades. Método de Saad-Leonard.
Podemos concluir então que a condição de Rankine-Hugoniot é obedecida nas três descontinuidades. Resta analisar a entropia.
b)	Método de Saad-Leonard : análise da Condição de Entropia.
Na primeira descontinuidade:
SL-/(uL) = /(l,000)-l,00 ,
SB = /(uJ = /(l,338)~-6,88 .
Logo, como Si — —2,15, temos : Sh &gt;	&gt; SRi e o princípio da entropia é
obedecido na primeira descontinuidade.
Na segunda descontinuidade:
SL - f'M - /(1,338) ~ -6,88 ,
= /'(«,) = /'(0,577)~ 1,39 .
Logo, como S2 = 0,01, temos : Sl &amp;lt;S2 &amp;lt;SR, e o princípio da entropia não é obedecido na segunda descontinuidade.
Na terceira descontinuidade;
Ól = /(u2)=/(0,577)~1,39 ,
Sr = /(uhW'(0,(&gt;00)~1,00 .
Logo, como S3 ~ 0,46, temos : Sl &gt; ¿&gt;3 &amp;lt;e o princípio da entropia não é obedecido na terceira descontinuidade.
Portanto, como o princípio da entropia não é obedecido na segunda e terceira descontinuidades, concluímos que a solução fraca obtida com o método de Saad-Leonard não é a solução fisicamente correta do problema.
Os métodos de dois pontos a montante e Leonard modificado (que utiliza três pontos a montante) apresentaram soluções muito parecidas entre si, que também não obedecem ao princípio da entropia.
6	ANALISE DA EQUAÇAO DA CONVECÇÃO -DIFUSÃO LINEAR, EM 1D
Neste capítulo analisamos o emprego dos diversos métodos descritos no capítulo 4 para solução numérica da equação da convecção-difusão linear em 1D.
6.1	Dedução da Equação e Solução Semi-Analítica
A equação da conservação por componente é, para fluxo em 1D, na direção x, é fornecida por Lake [23]:
+ (6.» onde&amp;lt;/&gt; é a porosidade, ux a velocidade de Darcy, Kx o coeficiente de dispersão e C/ a concentração volumétrica do componente / (massa do componente i por unidade de volume da fase). A equação acima considera constante a densidade da fase.
Para fluxo permanente (iç constante), porosidade constante e coeficiente de dispersão constante, a equação (6.1) sem o índice do componente l fica:
(6-2)
As seguintes variáveis adimensionais podem ser definidas:
x&amp;amp; —x/L ,
(6.3)
r* udt
tD~ kjL ’
e	C-Cj C-ü c
Cd^Cj~Ci Cj-o Cj ’
onde Cj é a concentração inicial e Cj a concentração de injeção.
Substituindo-se, vem:
(6-4)
(6-5)
ou:
dCD ÔCD K^cFCd dl d dxQ uxL dx^
O número de Peclet é definido como:
(6.6)
Pe =
uxL
(6.7)
e traduz uma relação entre as forças viscosas (fluxo convectivo) e difusivas .
Normalmente o termo Kx é modelado considerando-se apenas a dispersão hidrodinámica no meio poroso, de forma que:
(6.8)
onde o é a dispersivida.de do meio .
Substituindo-se em (6.7):
(6.9)
Substituindo-se (6.8) e (6.9) em (6.6):
dCD dCD 1 d2CD dt$ dx&amp;amp; Pe dP#
que é a equação da convecção-difusão na sua forma adimensional. As condições iniciais e de contorno escolhidas foram:
Cd(xd,0) = 0
Cd(Md) ~ 0
C'dÍO^d) = 1
»	&gt; 0
&gt;	S 0
, ÍD &gt;0
(6.11)
Ao longo deste capítulo não utilizaremos os índices de adimensionalização em
(6.10)	por simplicidade.
A solução semi-analítica dessa equação foi obtida utilizando-se transformada de Laplace e invertendo-se numericamente para o campo real com auxílio do algoritmo de Crump [12] aperfeiçoado por Corrêa et alii [11]. Conforme se pode observar na figura 6.1, o algoritmo de inversão de Stehfest [45] não consegue representar adequadamente a forma da frente.
A dedução completa da solução" semi-analítíca é apresentada no apêndice L.
6.2	Solução Numérica
Para resolver numericamente a equação (6.10) com as condições de contorno
(6.11)	escrevemos um programa de computador em linguagem FORTRAN, que admite os esquemas explícito, implícito e Crank-Nicolson.
A discretização de (6.10) com o esquema explícito fornece:
At
Uí-l/2
At
1
PcAt2
(C"„ - 2CJ- + CJL,) = 0 .
(6.12)
+
Para obter C?+ij2 e	utilizamos os diversos métodos apresentados no
capítulo 4. Conforme vimos, quando empregamos o método de AHen-Figueiredo ou Patankar a discretização de (6.10) assume forma particular, diferente de (6.12), pois os termos convectivo e difusivo são tratados em conjunto.
Para o esquema explícito estão disponíveis os métodos:
•	1 ponto a montante,
•	Saad-Leonard,
•	Gupta-Leonard,
•	Alien-Figueiredo (idêntico a Patankar),
•	TVD de Rubin e Blunt,
•	TVD de terceira ordem, região TVD de Liu,
•	TVD de terceira ordem, região TVD de Liu, 2~ ordem no tempo, e
•	TVD de terceira ordem, região TVD de Sweby.
Utilizando o esquema implícito, obtemos:
1
PcAt2
(6.13)
No esquema de Crank-Nicolson [34], temos
/ir¡+l	Zin+1	+ 1	z^n	zin
At 2 As	2 As +
- 2P^ (C« - 2C"+1 + C« ) - 2P^ (C»&gt; - 2C” + C-) = 0 '	(6'14&gt;
Para os métodos de Allen-Figueiredo ou Patankar valem os mesmos comentários que fizemos acima.
Os métodos de Gupta-Leonard e TVD com correção no tempo, que aumentam a estabilidade, não têm muito sentido de serem aplicados nos casos implícito e Crank-Nicolson.
Evidentemente, os métodos implícito e Crank-Nicolson exigem, em cada passo de tempo, a solução de um sistema de equações lineares cuja matriz é tridiagonal para os métodos 1 ponto a montante, Allen-Figueiredo e Patankar e pentadiagona! para os métodos de Saad-Leonard e TVD.
Para os esquemas implícito e Crank-Nicolson estão disponíveis os métodos:
•	1 ponto a montante,
•	Saad-Leonard,
•	Gupta-Leonard, e
•	Allen-Figueiredo (ou Patankar).
6.3	Discussão dos Resultados
A seguir apresentamos, em forma gráfica, os resultados numéricos obtidos para a equação da convecção - difusão em 1D, sob diversas situações.
Nas figuras 6.2 a 6.6 analisamos os limites de estabilidade no esquema explícito para os vários métodos. Utilizamos Pe — 1000 e N = 100 , ou seja, número de Peclet celular igual a 10. Verificamos que:
• Para o método 1 ponto a montante o limite de estabilidade é At &amp;lt;0,0083, calculado com a equação (4.9). Esse valor é consistente com os resultados observados na figura 6.2 : para At = 0,0079 o método ainda é estável, enquanto para At = 0,0087 já ocorrem oscilações. Podemos verificar também a propriedade de cancelamento dos erros de truncamento: a menor dispersão numérica ocorre quando utilizamos o maior At estável.
5T
CONCENTRACAO	CONCENTRACAO
Figura 6.1: Convecção-Difusão, ID, solução semi-analítica.
C0NVECCA0-D1FUSA0 EM W, RECLE! = 1000, T = 0.2 METODO 1 PONTO A MONTANTE EXPLICITO, N=100 NOS
MAXIMO DELTAT ESTAVEL = 0.0083

l 1 1 I 1 l 1 l 1 11 1
----- CRUMP
.... DELTA! -
----- DELTA! = ooooo DELTA! ~
0.0010
0.0079
0.0087
TTTm I 1 ] l 1 ! ! 1 1 f 1 1} 1 1 1 11T7TT
1.20
1.00
0.80
0.60
0.40
0.20
0.00
-0.20
0.00	0.10	0.20	0.30	0.40	0.00	0.60
DISTANCIA ADIMENSIONAL
CONCENTRACAO	CONCENTRACAO
Figura 6.3: Convecção-Difusão, ID, análise de estabilidade.
1.20
1.00
0.80
0.60
0.40
0.20
0.00
CONVECCAO-DIFUSÃO EM ID, PECLET = 1000, T = 0.2
METODO SAAD-LgONARD EXPLICITO, N=100 NOS
■4 tGGOGGOOOeOQO
MAXIMO DELTAT
CRUMP
DELTAT - 0.0010
DELTAT = 0.0015
DELTAT « 0.0025
ESTÁVEL = 0.0020
-0.20
rt&amp;lt;	li ri"i"i t i t i i	i ! i i vp i	i i l'T'1 1 ! [ TW	i i i i i i t i ! i i	i "V very &gt; t	i , &gt; í i rrj
0 00	0.10	0.20	0.30	0.40	0.50	0.60
DISTANCIA ADIMENSIONAL
CONCENTRACAO	CONCENTRACAO
Figura 6.5: Convecção Difusão, ID, análise de estabilidade.
1.20
1.00
0.80
0.60
0.40
0.20
0.00
“0.20
CONVECCAO-DIFUSAO EM ID, PECLET = 1000, T = 0.2 METODO TVD DE RUBIN E BLUNT EXPLICITO, N=100	"
o 1GOOOOOOÍXXMJ OO&amp;amp;QO-
----- CRUMP
-.. DELTA!
----- DELTA! ooopo DELTA!
NOS
0.0010
0.0050
0.0070
0.00
T » t t i i iTn-lTHTl'l'l i j &gt; i T »1 ■'« irnrrTT t &gt; t i | i i-rnTrn |Ti i i i^ rr 0.10	0.20	0.30	0.40	0.50 C.
DISTANCIA ADIMENSIONAL
0.60
•	Para o método de Allen-Figueiredo, o maior At estável é 0,00999, calculado pela equação (4.19) Notamos que esse valor é coerente com os resultados apresentados na figura 6.3. Observamos também que o erro de truncamento causado pelo Ai multo grande distorce um pouco a forma da frente de avanço.
•	Para I/Pccel. = 0,la figura 4.1 indica que o maior At estável para o método de Saad - Leonard é 0,0020, valor compatível com os resultados mostrados na figura 6.4.
•	A figura 6.5 mostra que as correções introduzidas por Gupta no método de Leonard realmente melhoram muito a estabilidade.
•	Com o método TVD de Rubín e Blunt a estabilidade é verificada, conforme vimos no Apêndice J, até um número de Courant (Ai/Az) igual a 0,5, ou seja, At &amp;lt;0,005. Esse valor é coerente com os resultados mostrados na figura 6.6. Da mesma forma que no método de Alien, o uso de Ai muito grande implica em erros de truncamento que distorcem levemente a forma da frente.
Ñas figuras 6.7 a 6.9 comparamos os resultados obtidos com os esquemas explícito, implícito e Crank-Nicolson, para os métodos 1 ponto a montante, Alien-Figueiredo e Saad-Leonard, utilizando Pe — 1000, N = 50 e At — 0,005, ou seja, número de Courant igual a 0,25.
Observamos que:
•	Com esses dados os métodos 1 ponto a montante e Allen-Figueiredo são estáveis no esquema explícito, e o método de Saad-Leonard é instável.
•	Em todos os casos a menor dispersão numérica foi obtida com o esquema explícito e a maior com o esquema implícito.
•	Para o método de Saad-Leonard o esquema de Crank-Nicolson apresentou os melhores resultados: corrigiu a estabilidade e a dispersão numérica foí menor que a obtida com o método totalmente implícito.
Ñas figuras 6.10 a 6.12 apresentamos os resultados obtidos com o esquema explícito, com Pe — 10000, N = 100 e At — 0,0015, ou seja, número de Courant igual a 0,15.
Concluimos que:
•	Nessas condições o método de Saad - Leonard é instável, apresentando grandes “overshoots”.
CONCENTRACAO	CONCENTRACAO
DISTANCIA ADIMENSIONAL
Figura 6.7: Convecção-Difu sao, ID, comparação entre formulações.
1.20
CONVECCAO-DIFUSÃO EM 10, PECLET = 1000, T = 0.2
METODO DE ALLEN-FIGUEIREDO, DELTA! = 0.005, H = 50 NOS
1.00 -o o
0.80 -
0.60 -
0.40 -
0.20
0.00 -
-0.20
0.00
---- CRUMP
ooooo EXPLICITO
.... IMPLICITO ....CRANK-NICOLSON

; ri i ! r rril i&gt;ri i Tt ff "ft mi i ..H’l 1 ; i i i i i i i i I'I rr:—-
0.10	0.20	0.30	0.40	0.50	0.60
DISTANCIA ADIMENSIONAL
concentracao	CONCENTRACAO
Figura 6.9: Convecção Difusão, ID, comparação entre formulações.
1,40
1.20
1.00
0.80
0,60
0.40
0.20
0,00
-0.20
-
CONVECCAO—DiFUSAO EM 10, .PECLET = 10000, T = 0.5 DELTAT - 0.0015, N = 100?N0S (NUM. COURANT = 0,15)

aaagatary
*
%
____ CRUMP
.... 1 PONTO A MONTANTE
----SAAD— LEONARD
ooooo TVD TERC. ORDEM / UU
U
T-rmi r &gt; i frrTi i t &gt; irpm i rh"TT"; i rnTrn t ¡ &amp;lt;t i r t i &amp;lt;■&amp;lt;
O.Ò0	0.20	0.40	0,60	0.80	1.00
DISTANCIA ADIMENSÍONAL
1.40
1.20
1.00
CONVECCAO-DIFUSAO EM ID. PECIE1 - WOOD. I = 0.5
DELTA! = 0.0015. N = WO NOS (NUM. COURANT = 0 15)

CONCENTRACAO	CONCENTPACAO
0.80
0.60
0.40
0.20
0.00
-0.20
0.00
ó
II
i
---- CRUMP	k
.... 1 PONTO A MONTANTE
---TVD TERC. OR DEM / LIU
oooooTVD TERC. ORDEM / LIU, CORR. TEMPO
11111 r-l-T-y-T7-TT~T-T-T. r4~y, .,-r-r-|"T-r"T"ry&gt; &gt;■■•&gt; J	f .,.
0.20	0.40	0.60	0.80	1.00
DISTANCIA ADIMENSIONAL
Figura 6.11: Convecção-Difusão, ID, comparação entre métodos.
Dl STAN CiA ADIMENSIONAL
♦	O método TVD de terceira ordem com região TVD ampliada de Liu apresenta os* cilação para concentrações baixas, junto à frente de avanço. Tal fato vem comprovar nossa conclusão de que as simplificações admitidas por Liu para definir a região TVD ampliada não são válidas (apêndice K).
♦	A utilização do esquema de segunda ordem no termo temporal, com o TVD de terceira ordem e região TVD de Liu corrige a oscilação, mas introduz pequena dispersão numérica, conforme demonstramos no capítulo 4 e apêndice H.
•	Os métodos TVD de Rubin e Blunt e TVD de terceira ordem com região TVD de Sweby apresentaram excelentes resultados.
•	Conforme já havíamos concluído, nessa situação de fluxo muito convectivo o método de Alien-Figueiredo se confunde com o método 1 ponto a montante.
Nas figuras 6,13 e 6.14 analisamos um escoamento rnais difusivo, com esquema explícito, Pe = 100, N ~ 50 (Pe celular igual a 2,0) e At = 0,0030 ou seja, com número de Courant igual a 0,15.
Notamos que;
•	Nessas condições o método de Saad - Leonard é estável e apresenta solução idêntica à obtida com os esquemas TVD. Esse resultado vem confirmar a conclusão obtida no apêndice A, de que o termo difusivo estabiliza a solução da equação.
♦	Um ótimo resultado foi obtido com o método de AIIen-Figueiredo, bem melhor que o conseguido com o método 1 ponto a montante.
CONCENTRACAO	CONCENTRACAO
DISTANCIA ADIMENSIONAL
Figura 6.13: Convecção-Difusão, ID, comparação entre métodos.
1.20
CONVECCAO—DIFUSÃO DELTAT = 0.0030, N
EM 10, PECLET = 100, T = 0.2 = 50 NOS (NUM, COURANT = 0.15)
0.80
0.60
0.40 -
0.20 ~
0.00 -
-0.20
---- CRUMP
.... SAAD-LEONARD
~ - TVD - RUBIN E BLUNT oooooTVO - TERC. ORDEM / SWEBT
■e—e-e-e—
T~r-rTT-rTTT*prTT"rTT’rTT"[-rTT”rTTT'T"r'T~rT‘i-i-T~rT-rTy-rT‘T“r‘i“T‘TTT“f-T“TTTT‘T“r‘T“T~
OÓO	0.10	0.20	0.30	0,40	0.50	0.60
DISTANCIA ADIMENSIONAL
7	ANÁLISE DA EQUAÇÃO DE BUCKLEY -LEVERETT
Neste capítulo analisamos o comportamento das soluções numéricas para a equação de Buckley-Leverett, que rege o fluxo incompressível água-óleo em uma dimensão, utilizando os diversos métodos numéricos apresentados no capítulo 4.
7.1	Dedução da Equação
Partimos das equações de conservação para os componentes água e óleo, em
1D, considerando a porosidade constante:
(7.1)
~ “(pe«o) =	“ ^)) +	’	í7'2)
onde e q* são vazões mássicas injetadas por unidade de volume de rocha (termos fonte), uo, uw as velocidades de Darcy, 5O,SW as saturações e po, pw as massas específicas,
Como o fluxo é considerado íncompressível, pw e po são constantes. Dividimos (7.1) por pw e (7.2) por pa para obter:
duw dx

+ Çw
Somando-se as equações para os dois componentes, resulta:
duT
(7.5)
5
onde w? ~ uo + uw e qr =■ q&lt;&gt; + Çw é a vazão total injetada ou produzida por unidade de volume de rocha. Como não consideramos termos fonte, çt = 0 e u? =constante.
A lei de Darcy, sem considerar efeitos gravitacionais, fornece:
__ kkrü dp&amp;amp; faBo dx kkrw dpw
(7.6)
(7.7)
Mas, pelo conceito de pressão capilar,
Pw — po	'
(7-8)
Assim:
1 o “T"
¿7X	as
(7-9)
Substituindo-se (7.9) em (7.6), vem:
—ií.
(7.10)
Como u-j- — uo + «w, segue:
(7.11)
Definindo-se o fluxo fracionário de água:
f	^IU
a equação (7.11) pode ser escrita como:
\ dPc
UT —	'b a ’
fw àx
= fvi^T d- ^ofw Q^ '
Substituindo-se (7.14) em (7.3) , com qw = 0, vem:
d '
dx '
ÀOAW êPc
/”“T + A, + A„ dx
,dsw
= ,hãr
(7.12)
(7.13)
(7.14)
(7.15)
Mas;
dPc	„ p7ç }dS^
dx dSw â.r	dx ’
e, como u-f é constante, a equação (7.15) fica:
(7.17)
Pode-se notar que, como P' —	&amp;lt;0, o termo:
^f/s. =	(7.18)
Aq "T Aw
tem o caráter de uma dispersão física na equação (7.17). Ou seja, na equação de Buckley-Leverett a capilaridade é responsável pela introdução de um termo difusivo.
A equação (7.17) pode ser adimensionalizada definindo-se:
XD ~ x/L ,
(7.19)
u-pdt
íx) = /o	'
Substituindo-se na equação (7.17), resulta:
(7,20)
dfw _ J_____d_ ( 9SW\	dS^
dxj) utL dxp \ F1S' dx# /	&amp;amp;Í£&gt;
onde a parcela Kfis./ÍPtL) é escrita como:
(7.21)
Pfis. ___	1 AOAW dPc
'Uí^dj	Uj’I' dS^
definindo-se Ao = kXro,Xw = kXTW, segue:
Km  ________1___kX rw
utL	U'pP 1 4" 4rai' dSw
Aro
(7.22)
Admitimos as seguintes relações para as permeabilidades relativas:
(7.24)
Podemos também usar o conceito da função J de Leverett, adimensional:
J(SW) -
PÁS^ acosO
(7.25)
para obter:
dpc 1$	„ dj
dSw ~ \ kacosedSu
(7.26)
Substituindo-se essas relações em (7.22) , vem:
(7.27)
Definindo-se:
dJ
dSw ’
(7.28)
e o número de Rapoport e Leas [23] :
k k°w&lt;/&gt;(7€Os8
(7.29)
segue:
Kfis. _ g(Sw)
utL Nftc
(7.30)
Substituindo-se em (7.21) , resulta finalmente:
dsw dfw 1 d ( AdSw\
dtD dxD N^dxn \9(üwjdzG)
que é a equação de Buckley-Leverett na sua forma adimensional.
(7.31)
O número de Rapoport e Leas é o equivalente ao número de Peclet, e fornece uma razão entre as forças viscosas (convectivas) e capilares (difusivas). Quanto maior JVrm mais convectivo é o fluxo.
ç „ s
=
í

7.2	Solução Semi-Analítica - Caso Convectivo
No caso convectivo a equação de Buckley-Leverett é escrita como:
9SW
dtD
■' &amp;amp;Sw
= 0 ,
(7.32)
Para urna frente de Sw constante, temos:
(dSuA
dtD +
ÍBSA
\dxDjíl}
(7.33)
dxp ~ 0
Assim,
dxp _ ~(dSw/dtD)zD dtp dSw / cixjhjtp

(7.34)

e, portanto,
xd - fw(Sw).tG
Essa relação produz uma solução fisicamente incoerente na frente de avanço. Para que a solução seja a correta é necessário utilizar a teoria do choque [23] , [43]. A velocidade correta do choque, S**, é determinada através da aplicação do balanço de materiais (conservação da massa), ou, equivalentemente, pela aplicação do princípio de Rankine-Hugoniot [44], A saturação de água no choque é obtida igualando-se essa velocidade com aquela calculada usando-se (7.34). A equação (7.35) é utilizada para obter as posições das saturações de água maiores que Não é difícil verificar que a aplicação do princípio da entropia também conduz à saturação correta no choque:
•	Se o choque fosse fixado para &amp;lt;S*, teríamos soluções com três valores distintos de na mesma posição, na frente de avanço, o que é incoerente.
•	Se o choque fosse fixado para &gt; 5*, a condição de entropia na descontinuidade seria violada.
Dessa forma obtemos a solução semi-analítica para a equação de Buckley-Leverett. Essa solução, que serve como referência, é mostrada nos gráficos com os resultados para os casos convectivos.
As condições de contorno utilizadas foram:
/w(0, t&amp;amp;) = 1 í
(7.36)
condição equivalente a 5w(0,tp) = 1 — Sor ,
e
SwÍKíd) ~
(7.37)
(7.38)

7.3	Solução Numérica
A discretizaçao de (7.31) no esquema explícito fornece:
p* „ rft
1 1
Nxl
+
0 cálculo de F" , F" , é feito de acordo com os diversos métodos discu-wi+i/27	^t-1/2
tidos no capítulo 4.
O cálculo de G'"+í/2,í?JL1y2 a rigor deve utilizar a média harmônica, conforme mostram Patankar [33] e Santos [42], No entanto, como a função g(Sw) compreende somente termos de fluxo, uma idéia natural é avaliar esses termos a montante. No programa de computador que desenvolvemos para obter as soluções numéricas, admitimos escolher, para Gj+i/2 : média aritmética, média harmônica e aproximação a montante. Os melhores resultados foram obtidos com a aproximação a montante.
Para o esquema explícito estão disponíveis os métodos:
•	1 ponto a montante,
•	Saad-Leonard,
•	Gupta-Leonard,
•	Leonard modificado,
•	Patankar,
•	Allen-Figueiredo,
« TVD de Rubin e Blunt,
•	TVD de terceira ordem com região TVD de Liu,
•	TVD de terc. ordem com região TVD de Liu e correção de 2a- ordem no tempo, e
♦	TVD de terceira ordem com região TVD de Sweby.
A dedução dos métodos de A lien-Figueiredo e Patankar para a equação de Buckley-Leverett é apresentada nos apêndices M e N.
Como alternativa ao esquema explícito, implantamos também, em nosso programa de computador, o esquema de Crank-Nicolson com os métodos 1 ponto a montante e Saad-Leonard.
A discretização de (7.31) pelo esquema de Crank-Nicolson fornece:
çn+1 Çn
___...............V')'.
A/jo
íz-m-H
2AfoA:4 i- i+1/
1 írn
0 sistema de equações não lineares resultante é resolvido iterativamente pelo método de Newton-Raphson. A apresentação dos detalhes relativos à obtenção das funções-resíduo e matriz Jacobiana fogem ao escopo do trabalho e podem ser encontrados no programa fonte, disponível como anexo à tese na biblioteca do Departamento de Engenharia do Petróleo da UNICAMP,
Para os esquemas implícito e Crank-Nicolson estão disponíveis os métodos:
•	1 ponto a montante,
•	AIlen-Figueiredo,
•	Patankar,
•	Saad-Leonard, e
•	Gupta-Leonard.
A matriz Jacobiana é tridiagonal para o método 1 ponto a montante e penta-diagonal para o método de Saad-Leonard.
Nesse ponto cabe uma observação quanto à aplicação dos métodos TVD quando trabalhamos com a equação completa, incluindo o termo difusivo.
Para obter as restrições sobre o limitador utilizamos a lei física completa; portanto, a rigor, devemos corrigir todo o termo de fluxo, isto é:
(7.41)
Na entanto, a discretização do termo difusivo sem a correção já é um algoritmo de terceira ordem, como mostra Leonard [26]. A correção desse termo com o limitador TVD não deve alterar muito a precisão dos resultados numéricos.
Realmente, comparamos os resultados incluindo o TVD nos termos convectivo e difusivo com aqueles obtidos aplicando o TVD apenas no termo convectivo e, conforme esperávamos, os resultados foram muito próximos, em toda a faixa de variação do número de Rapoport e Leas, Isso mostra que a inclusão do TVD no termo difusivo, na prática, não é necessária.
7.4	Propriedades Utilizadas
Para testar os métodos numéricos de solução escolhemos os seguintes dados:
9 n0 — nu, = 2
•	= k°rw = 1
*	6,1
•	~ fi0 = 0, 5 mPa.s
•	Bw ~ Bo ~ 1 m3/Sm3
A curva fw(Sw) obtida a partir desses dados é apresentada na figura 7.1. A curva J(SW} ê apresentada na figura 7.2 e a curva g(Sw} na figura 7.3.
7.5	Discussão dos Resultados
Começamos analisando a obediência aos princípios de Rankine-Hugoniot e da entropia, com base nos resultados apresentados nas figuras 7.4 e 7.5, obtidos com o método de Saad-Leonard. Os casos correspondem a escoamento convectivo, N = 100 e At = 0,00050 (número de Courant 0,05) e com esquema explícito.
Figura 7.1: Curva de fluxo fracionário.
Figura 7.2: Curva J de Leverett.
1.20
EOUACAO DE BUCKlEr-LEVEREII ID, EXPLICITO
ANALISE DA CONDICAO DE ENTROPIA
CASO CONVECTIVO. DT - 0.00050, N » 100, TEMPO = 02 NUMERO DE COURANT
SATURACAO DE AGUA	SATURACAO DE AGUA
o.ao
0.60
SOL. ANALHICA
SAAD-LEONARD, N = 100
0.40 -
0.20 -
0.00
0.00

l
1
I
4 I
If
r
Y1.T&lt;.y11|...-T-.T-T.Y''r''T'''F f | f ! T-y -'f" i i ( j ■ y T j | { ft" I " |—rr I &gt; T f ■* r T 0.20	0.40	0.60	0.80
DISTANCIA ADIMENSIONAL
1.00
Figura 7.4: Buckley-Leverett, convectivo, método de Saad-Leonard.
1.20
1.00 -
EOUACAO DE BUCKLEY-LEVERETT 1D. EXPLICI70 ANALISE DA CONDICAO DE ENTROPIA
CASO CONVECTIVO, DT = 0.00050. N « WO. TEMPO = 0.5 NUMERO DE COURANT = 0.05
SOL. ANALITICA
SAAD-LEONARD, N = 100
0.80 1
0.60 -
0.40 -
0.20
0.00
0.00
i
4
t
t
E
*
t
I
i
4
l
t
r
f
i t l i
i
i j.
l
T..y.,r.r,T..T.T,.,&gt;.......I ..)...r.T.,...rT-r.T.T.yr.T-rT-rT , ( (	| , rm-TTTfn’n i t rrr
0.20	0.40	0.60	0.80
DISTANCIA ADIMENSIONAL
1.00
a)	Condição de Rankine-Hugoniot:
Os estados em torno da descontinuidade são:
.	= 0,82 -* F(ul) - /w(0,82) - 0,988
•	uR = 0,10 -4 F(Ur) = ^(0, 10) - 0,0
Assim, a velocidade da descontinuidade deve ser:
S = (0,988 - 0,0)/(0,82 - 0,10) = 1,372
Os resultados numéricos mostram que as posições da frente são:
» EmT = 0,2, x~ 0,270
•	EmT = 0,5,	0,682
Com isso a velocidade da frente é:
S = (0,682 - 0,270)/ (0,5 - 0,2) = 1,373
Portanto, a solução numérica obedece ao principio de Rankine-Hugoniot. Como o principio de Rankine-Hugoniot advem do princípio de conservação da rnassa, concluimos que o método de Saad-Leonard preserva o balanço de materiais, para o caso analisado.
b)	Condição de Entropia:
Velocidade da água à esquerda do choque: Sl = /¿(«l) = /¿(0,82) ~ 0, 335 Velocidade da água à direita do choque: SR = f^,(uR) = /¿(O,10) — 0,00 Assim i SR &amp;lt;S &gt; Sr, e o princípio da entropia não é obedecido.
As figuras 7.6 a 7.9 apresentam os resultados obtidos para o caso convectivo, com N — 40, At — 0,00125 (número de Courant 0,05), no tempo T ~ 0,2.
Verificamos que:
♦	O método 1 ponto a montante apresenta grande dispersão numérica, nos esquemas explícito e Crank-Nicolson.
•	O método de Saad-Leonard apresenta solução fisicamente incorreta, conforme mostram os resultados obtidos com os esquemas explícito e Crank-Nícolson. Na figura 7.6 observamos que, utilizando-se o esquema explícito com Ai reduzido, os resultados se aproximam daqueles obtidos com o esquema de Crank-Nicolson. Fica claro então que a solução fisicamente incorreta não é um problema de instabilidade.
1.20
1.00
EQUACAO DE BUCK LEY-LEVE RETT ID
COM PARACAO ENTRE METODOS
CASO CONVECTIVO. Dl = 0.00125. N = 40. TEMPO NUMERO DE COURANT = 0.05
0.2
SATURACAO DE AGUA	SATURACAO DE AGUA
---- SOL ANAUTIGA
.... 1 PONTO MONT. EXPLtCHO
OOOOO 1 PONTO MONT. CRANK-NiCOLSOH -----SMD-LEONARD EXPUCITO
□□mo SAAD-LEONARD CRANK-NICOLSON ***** SAAD-LEONARD EXPL.. DI-0.00025
0.80
0.30	0.40
DISTANCIA ADIMENSIONAL
0.60
O 40
0.20
Figura 7.6: Buckley-Leverett, convectivo, comparação entre métodos.
1.20
0.40
0.20
EQUACAO DE BUCK LEY-LEVERETT ID - EXPLICITO COMPARACAO ENTRE METODOS CASO CONVECTIVO, DT = 0.00125, N = 40, TEMPO = 0.2 NUMERO DE COURANT = 0.05		
			 SOL. ANAUTICA
			 1	POHTQ A MONTAtHE
			SAAD-LEONARD
&amp;amp;*"*''*&amp;amp; “**tn —		OOOOO GUPTA—LEONARD
O” C 'C		□□odd LEONARD MODIFICADO
		
		
		
?*c		
i	i	
i		4 I 4
i		4 I
i		1
		0 *,
i		
F		D 4
K		
		" U Q
1.00
0.80
0.60
1.20
1.00 -
EOUACAO DE BUCKLEY-LEVE RETI W - EXPLICITO
COMPARACAO ENTRE METODOS
CASO CONVECTIVO, DT = 0,00125, N = 40, TEMPO *= 0.2
NUMERO DE COURANT = 0.05
SATURACAO DE AGUA	SATURACAO DE AGUA
0.60
0.80 “
0.40 -
0.20
----- SOL. ANALITICA ----- SAAD-LEONARD
----TVD 1ERC. ORDEM / LIU
ODOOOTVD RUBIN E BlUNr oqoddTVD TERC. ORDEM / SWEBr
0.00 —r-r-r-ri-T-t i i ¡ i i &gt; i i &gt; i rryvi i ¡ i-rmpT’m^n r p-rmTTl &gt; | i i i r ; i t i i
0.00	0.10	0.20	0.30	0.40	0.50	0.60
DISTANCIA ADIMENSlONAL
Figura 7.8: Buckley-Leverett, convectivo, comparação entre métodos.
1.00 ~
EQUACAO DE BUCK LEY-LEVERETT 10 - EXPLICITO COMPARACAO ENTRE METODOS
CASO CONVECTIVO, DT = 0.00125, N = 40, TEMPO = 0.2 NUMERO DE COURANT = 0.05
0.80 -
----- SOL. ANALITICA
..... 1 PONTO A MONT., N»280
------1 PONTO A MONT., N= 40 OOQOO PATANKAR. N~40
0.60 -
t
0.20 -
0.00	i i I i i ’ i i i’ &amp;lt;rTmTrrn'i’i rtTTTTrTnTrnTnr i
0.00	O.W	D.20	0.30	0.40	0.50	0.60
•	O método de Gupta-Leonard produziu resultados praticamente idênticos aos de Saad-Leonard , demonstrando, mais urna vez, que a solução nao-física não está ligada a instabilidade.
•	0 método de Leonard modificado reproduz bem o trecho de onda espalhante, mas dispersa a frente de avanço e apresenta algumas oscilações.
•	Entre os esquemas TVD, resultados muito bons foram obtidos com os métodos de Rubín e Blunt e TVD de terceira ordem com região de Sweby.
•	Os resultados obtidos com o método de Patankar, conforme já esperávamos, confundiram-se com aqueles obtidos com o método de ponderação a montante.
As figuras 7.10 a 7.13 mostram os resultados obtidos para o caso com número de Rapoport e Leas igual a 10, com JV ~ 40, At — 0,00125 no tempo T — 0,2. A referência foi a solução obtida com o método 1 ponto a montante, com N — 230 nós.
Observamos que:
•	O método 1 ponto a montante, com Ar — 40 apresenta grande dispersão numérica.
•	O método de Saad-Leonard ainda apresenta solução um pouco incorreta, nos esquemas explícito e Crank-Nicolson. Notamos, no entanto, que à medida que Nju diminui e o fluxo se torna mais difusivo, a tendência de solução não-física diminui. Esse comportamento vem confirmar que o termo difusivo estabiliza a solução da equação, conforme demonstramos no apêndice A.
» O método de Leonard modificado ainda atrasa a posição da frente e apresenta oscilações junto à frente de avanço.
•	Os métodos TVD, principalmente os de Rubín e Blunt e de terceira ordem com região TVD de Sweby apresentam bons resultados.
•	O método de Patankar apresenta resultado apenas um pouco melhor que o método 1 ponto a montante.
Analisamos também a solução da equação de Buckley-Leverett hiperbólica com uma curva de fluxo fracionário com dnas inflexões, conforme mostra a figura 7.14.
As soluções numéricas são mostradas nas figuras 7.15 e 7.16.
1.20
EOUACAO DE BUCKLEY-LEVERETT 1D
COMPARACAO ENTRE METODOS - NUM. RAPOPORT E LEAS
DT = 0.00125, N = 40. TEMPO ~ 0.2 NUMERO DE COURANT = 0.05
---- 1 POTTO
....1 PONTO
&lt;50000 1 PONTO _
----smd-leonard expmcuo
POOPO SMD-LEONARD CRANK-NICOLSON
• SAAD-LEONARD EXPL., DT-.0,00025
10
1.00
0.80
0.60
0.40
k
0.20
0
T
4
t
MONT., N-280, fXPUC. MONT. EXPLJCHO MONT. CRANK ~NJCO ISDN
SATURA CAO DE AGUA	SATURACAO DE AGUA
0.00
0.00
D *
n-TTii iiij iTrrri"!'^ i ; t rrn'Ti'T'* $ i i t i i t i ri f ri i r-rr-rv» j
0.10	0.20	0.30	0.40	0.50
DISTANCIA ADIMENSIONAL
0.60
Figura 7.10: Buckley-Leverett, Nrl = 10, comparação entre métodos.
1.20
EOUACAO DE BUCK LEY-LEVERETT COMPARACAO ENTRE METODOS -DT « 0.00125. N « 40. TEMPO NUMERO DE COURANT = 0.05
ID - EXPLICITO
NUM. RAPOPORT E LEAS = 10 = 0.2
0.80 -J
0.60 -
0.40 -
0.20 -
I «
■k
A k
1
---- 1 PONTO A MONT AWE. N-280 ---- t PONTO A MONTANTE
----SAAD-LEONARD
OOCOC GUPTA—LEONARD oocroo LEONARD MODIFiCADO
■ fe -*6—ft—O • • P B
0.00
0.Ó0
o
i ! i i i jTTTTTTTTrn i Tnn i ! i i i Tj-TT-nfT i 'i-rr )	i t m r» i i i &gt; &amp;lt;t rrrr*
O.1O	0.20	0.30	0.40	0.50	0.60
1.20
-	EQUACAO DE BUCK LEY-LEVERETT ID - EXPUCHO
-	COMPARACAO ENTRE METODOS - NUM. RAPOPORT E LEAS - 10
-	DT - 0.00125, N « 40, TEMPO • 0,2
-	NUMERO DE COURANT = 0.05
SATURACAO DE AGUA	SATU RAC A O DE AGUA
1.00
0.BO
-----TVD OOOQO Tvp BDaoa TVD
0.40
0.20
! PONTO A MONT ANTE. N-280 SAW)-LEONARD
TERO. ORDEM / LIU RUBIN E BLUNT 1ERC. OR DEM / SWE0E
.o o
0.00
0.Ó0
irii i riTrf t'l &gt; ! ! i |TT|I i I I rTn^nTTTTTrriTTTTrTTi ij i i i i &gt; . i . .
0.10	0.20	0.30	0.40	0.50	0.60
DISTANCIA ADIMENSIONAL
Figura 7.12: Buckley-Leverett, N/u&gt; — 10, comparação entre métodos.
1.20
EQUACAO DE BUCK LEY- LEVERET! ID - EXPUCITO
COMPARACAO ENTRE METODOS - NUM. RAPOPORT E LEAS = 10 DT « 0.00125, N = 40, TEMPO « 0.2
NUMERO DE COURANT = 0.05
1.00 -
0.60 -
0.40 -
0.20 -
4
*
I,
I
*
o\
\
-------¿C^e—fiK
0.80 H
0.00
0.00
----- 1 PONTO A MONTANTE. N=280
■....1 PONTO A MONTANTE, N«40
OOOOO PATANKAR. N=40
7 1 I ! T &gt; I TT| lilt TTT If) T T'TT1"I'T'T'T"7'TT'T~T~T~'r-rT'T"rTTTT'T"T~TT"r7"V'TTT"t"r&amp;lt;'t &gt; 0.10	0.20	0.30	0.40	0.50
DISTANCIA ADIMENSIONAL
0.60
Figura 7.14: Curva de fluxo fracionário modificada.
Podemos concluir que:
•	0 método 1 ponto a montante apresenta dispersão numérica excessiva.
•	Os métodos de Saad-Leonard e Leonard modificado apresentam soluções fisicamente incorretas, que não obedecem ao princípio da entropia.
•	Os métodos TVD apresentaram excelentes resultados, acompanhando as frentes de avanço praticamente sem dispersão numérica. As evidências numéricas mostram, mais uma vez, que os métodos TVD obedecem ao princípio da entropia.
Em todos os casos analisados os erros de balanço de materiais foram des prezíveis.
1.20
COMPARADAS DE SOLUCOES
CURVA DE FLUXO FRACIONÁRIO MODIFICADA
TEMP0=U.2, DT«=0.00!25, COURANT=0.05
---- 1 PONTO A MONT., N=280
..... 1 PONTO A MOW!., N-40 OOOOOSMD-LEONARD. N-40 □□□□□ LEONARD MODIF., N-40
• o
-
. c
1,00 -O&amp;lt;&gt; ip ~
0.80 -
DISTANCIA ADIMENSIONAL
SATURACAO DE AGUA (fracoo)	SATURACAO DE AGUA (frocao)
Figura 7.15: Buckley-Leverett com curva de fluxo fracionário modificada.
8	ANÁLISE DO DESLOCAMENTO DE UM TRAÇADOR EM FLUXO MONOFÁSICO INCOMPRESSÍVEL, EM 2D
Nesse capítulo resolvemos o problema de injeção de um traçador monofásico, em regime permanente, para geometria 1/4 de “five-spot”. Inicialmente determinamos o campo de pressões e, a seguir, a distribuição de concentrações. Analisamos também o problema de injeção de traçador através de uma face do reservatório, em 2D.
8.1	Determinação do Campo de Pressões
A equação de conservação para a água, no caso monofásico, considerando-se compressibilidade pequena e constante é:
&lt;htcT dP M .	z0 n
Vp=“ã-p ■	(81)
onde cy é a compressibilidade total e q* é a vazão volumétrica por unidade de volume de rocha (termo fonte).
Condição inicial:
p(z,jí,0) -po .
(8.2)
Condições de contorno :

(8.3)
Para o sistema x-y de coordenadas, (8.1) fica:
d2p d2p t^pc^dp p . ã? + ã7 ~ ~~k~di ~ t*
Discretizando-se com o esquema implícito :
Pf-t-ij ^Pij d- Pt-ij \ + i íd~ Ptj-i Ax2	)	+	At/2
n4-l
(8.4)
^7 (pT~pK\ k \ At )
(8-5)
Multiplican do-se toda a equação por -AzAyã, vem:
7Èfe+lí ~ 2« + K~lj)”+’+ ~zf&amp;lt;^+&gt; ~	=
= ^^(p.71-pô)-9.j ■
onde qij é a vazão volumétrica (termo fonte).
Considerando-se malha uniforme, com Ar — Ay, resulta:
(8.6)
^íei j	+ Pt-H + Pü+i + Pü-0"+1 =
onde, para o sistema inglês de unidades, Cte-i = 1/887,2 , Cte^ = 5,615.
Para o poço injetor consideramos vazão q constante e para o poço produtor, pressão de fundo constante.
Escrevendo (8.7) para todas as células da malha obtemos um sistema de equações lineares, com matriz pentadiagonal, cujas incógnitas são as pressões nos nós.
8.1.1	O Modelo de Poço
O modelo de poço sugerido por Peaceman [35] é:
ip = CtMrh	g)
fiB in ro/rw
onde Cte é uma constante que depende do sistema de unidades. No sistema inglês, por exemplo, Cte = 0,00708.
Como estamos modelando 1/4 de “five-spot”, a vazão empregada para converter a pressão na célula do poço para a pressão de fundo deve ser 4ç (4 vezes a vazão simulada),
O raio equivalente ro deve ser calculado com cautela; para a situação mostrada na figura 8.1, que corresponde ao “five-spot”, podemos, com algum trabalho, demonstrar qne ro ~ 0,7209Ar.
DELTA X
Figura 8.1: Posição do poço na borda da malha.
8.1.2	Dados de Entrada para os Testes
Os dados utilizados nos testes foram os mesmos reportados por Agca [2], e são apresentados na tabela 8.1.2.
Pressão inicial	1378,8 kPa (200 psi)
Distância entre poços iguais	100,58 m (330 ft)
At para malha diagonal 15x15	0,2 dias
Vazão injetada em 1/4 do 5-spot	10,62 Sm3/d	STB/d)
Pwf min.	689,4 kPa (lOOpsí)
Permeabilidade	0,1974 pm2 (200 mD)
Espessura	1,524 m (5 ft)
Porosidade	0,25
Viscosidade da água	ImPa.s (1 cp)
Compressibilidade total (desprezível)	0,145x1o’20 (kPa)"1 (10~20 psi"1)
	0,122m (0,40 ft)
Tabela 8.1: Dados de reservatório.
8.1.3	Validação do Campo de Pressões.
Muskat [29] fornece a solução analítica para a diferença entre as pressões de injeção e produção no “five-spot” monofásico. No sistema inglês de unidades, temos:
(8,9) onde d é a distância entre o poço injetor e o poço produtor, e Q é a vazão total do “five-spot”.
Com os dados acima, obtemos:
Ap = (282,4)
(1).(2€7,2)
(200).(5)
In
/233,3\
\ 0,4 )
0,619
~ 433,84psi ~ 2990,90W&gt;a .
A solução numérica das equações (8.7) é feita até que as variações de pressão sejam muito pequenas e o regime permanente se estabeleça.
Para uma malha de simulação 30x30 os resultados obtidos foram:
» ÍU/ produção: 689,4 kPa (100 psi)
•	injeção; 3675,7 &amp;amp;Pa(533,17 p«)
•	AP: 2986,3 kPa (433,17 pai)
ou seja, um erro de —0,15% em relação à solução analítica de Muskat.
O aspecto das linhas isobáricas para malha diagonal 15x15 é mostrado na figura 8.2.
8.2	Determinação das Concentrações do Traçador
O campo de pressões para o regime permanente foi obtido conforme descrevemos no item 8.1. O passo seguinte é resolver a equação que fornece as concentrações de traçador.
A equação de conservação para o componente traçador (componente 1) em escoamento monofásico incompressível pode ser escrita como [22], [23]:
♦ q é a vazão volumétrica ,
•	Ci é a concentração volumétrica do traçador (componente 1),
•	ux, tXj, são as velocidades nas direções x e y,
•	K é o volume de rocha,
-*+
•	Ki é o tensor dispersão e
•	$ é &amp;amp; porosidade.
Os componentes do tensor dispersão:

J
(8.11)
são fornecidos por Lake [22] [23] :
K
(a^a.)	_ \/“í + “&gt;
—7===uT -p £Ví-—
+ $
{ai - of) 2
--~====~=u ctt~----------
y $
(8.12)
(8.13)
í
K ~

(O7 - Qp
&lt;^1 +

onde cti,at são as dispersividades longitudinal e transersal do traçador, e possuem dimensão de comprimento.
Assim,
V,(KvVC)- \ K^dx +^ây J + dy \K^dx +K^dy j ■	í8'15)
8.2.1	Solução Numérica
A equação (8.10) será resolvida numericamente pelo esquema explícito. Não nos preocupamos, nesse ponto, em implantar o esquema implícito porque nosso objetivo é estudar a dispersão numérica introduzida pela discretização do termo convectivo.
A condição inicial do problema é:
C(i,j,O) = Q .
(8.16)
As condições de contorno são:
dxk^~	w)v=L
(8.17)
Como condições auxiliares temos:
•	No poço injetor: Vazão q, e concentração de injeção Finj .
•	No poço produtor: Vazão ç, concentração C(N, JV), considerando-se o poço produtor na célula (V, A) (malha diagonal).
Quanto à díscretizaçao do termo difusivo, temos:
â	[A—«XC'« - C.) -	- M •	(8-18)
O cálculo de j-	« análogo.
Temos ainda que:
onde;
(" CVfrl/2j-l/2 \^/.+V2j”	Ay
Seguindo sugestão de Gupta et alii [16], utilizamos:
Cí+l/2j+l/2 ”	+ Gj+l + Cí+lj+l) &gt;
1
Cí+l/2j-l/2 = ^(Cíj + C'í+lj d- Cxj- l + Cí+lí-l) •
(8.19)
(8.20)
(8.21)
(8.22)
Í-1/2J.

e
Da mesma forma, escrevemos:
e
™ I —	— C;-l/2j-l/2
Ay
(8.23)
Ci-i/tj+i/z — ^(Gj + G-ij + C'ij+i + Ci-v-H) j
(8.24)
Cí-l/2¿-I/2 —	+ Gj-I + Cf-lj-l) .
(8.25)
Analogamente:
ü-i/2.
ÃJ.
IZ	^+1/2j+1/2 - G-l/2j+l/2 _ „
A#
G+l/2j-l/2 —	1/Bj—1/2
As
. (8.26)
Para os componentes do tensor dispersão nas interfaces devemos utilizar, se* gundo Santos [42], a médía harmônica. Com malha uniforme, temos:
2 JFífjj 1\.
Í+W = K,, +	’
e
2A(jX,-„v
K + K- ! ■
Assim, a equação (8.10) discretizada com o esquema explícito fica:
[c.r - c.“] +	-&amp;lt;_,wc;lw] +

-n
+&gt;	- C5)+
(C," ™ C?_v)] +	[^JrCjíi+1/2&gt;(C7”+l/2j+l/2 “ C'"+l/2Í-l/2)+
^■^í-vs/^-i/aj+i/a _ Ci-i/sj-i/a)] +	” ^»¿)+
(Cy ~ Cy„j)] +	[^^í&gt;+1/2(C&gt;l/2j+l/2 ~ ^7™1/-2j + 1/2) +
(^7+1/22-1/2 ~~ ^7—1/2J—1/2)] } — 0
(8.27)
(8.28)
(8.29)

As seguintes condições sao observadas:
•	No caso de 1/4 de “five-spot" com malha diagonal, somamos ao lado esquerdo da equação para a célula (N, N) o termo de sumidouro, qC^, definido implicitamente,
•	Também no caso de malha diagonal, somamos o termo fonte ao lado esquerdo da equação para a célula (1,1). é a concentração do traçador injetado,
•	As velocidades nas interfaces são calculadas pela lei de Darcy, a partir do campo de pressões, obtido conforme descrevemos no item 8.1.
•	Os métodos descritos no capítulo 4 são utilizados para aproximar as concentrações
nas interfaces: Ci+i/sj,	G'j 4-1/2, Qy-1/2 -
Com relação à aplicação dos métodos TVD para o caso bidimensional, são impostas as seguintes restrições:
(TV) ,  
onde (TV)x e (TV) são as variações totais nas direções x e y. Não é difícil demonstrar que a aplicação desses critérios conduz às mesmas relações deduzidas no apêndice J, para cada uma das direções.
As equações (8.29) são então empregadas para obter a distribuição das con* centraçÕes do traçador em cada passo de tempo.
Foram analisados os seguintes métodos:
« 1 ponto a montante,
•	Saad-Leonard,
•	TVD de Rubin e Blunt (limitador de Van Leer),
•	TVD de terceira ordem com região TVD de Liu,
•	TVD de terceira ordem com região TVD de Liu e correção de segunda ordem no tempo, e
•	TVD de terceira ordem com região TVD de Sweby.
As soluções obtidas com esses métodos foram comparadas com a solução semi-analítica para o problema, que discutiremos a seguir.
8.3	Solução Semi-Analítica
A solução semi-analíticapara o problema de fluxo monofásico incompressível de traçador em 2D, geometria 1/4 de “five-spot”, foi desenvolvida por Abbaszadeh-Deghani et alii [1], A idéia do método é dividir o “five-spot” em canais de fluxo e calcular o escoamento do traçador em cada canal, considerando-se nula a dispersividade transversal,
Tal método encontra-se implantado em um programa de computador adaptado por Lemos [25], que gentilmente nos foi cedido para os testes.
Para o traçador, consideramos as mesmas propriedades utilizadas por Agca [2], isto é:
•	at - 0 ,
•	cq —0,201m (0,66/t),e
•	“slug” de traçador : 2% do volume poroso.
O referido programa de computador fornece como saída a concentração do traçador no efluente versus o volume de água injetado.
Utilizando a mesma sistemática proposta por Agca [2], definimos um fator para normalizar a concentração:
Fat. Norm. = (conc. injeção).(tamanho do “slug” em fração de VP).(i/Pe) .	(8.30)
Conforme já vimos, o número de Peclet é calculado por:
L _ 330/7 az 0,66/2
— 500
(8.31)
Assim, com os dados utilizados:
Fator de Normalização —(1,0).(0,02).*^500	0,44721 .	(8.32)
Para esse conjunto de dados, a solução semi-analítica de Abbaszadeh-Deghani et alii para a concentração normalizada do traçador no efluente é apresentada na figura 8.3.
CONCENTRACAO NORMALIZADA DE TRACADOR
CAEO MOWOF *&amp;amp;&lt;(,&gt; FIRMALE HI £b MUHA W5, CAM^O £&gt;£	&gt; S $&gt;: 5
Figura 8.2: Fluxo monofásico permanente, 2D. Campo de pressões (kPa).
0.20
0.15 -
0.10 -
0.05
0.00
O.ÕO
SOLUCAO DE ABBASZADEH E BRIGHAM PARA FIVE-SPOT PULSO DE 0.02 VP. ALFAL « 0.66 ft
CONCENTRACAO NORMALIZADA NO EFLUENTE versus VOLUME INJETADO DE AQUA
0.90
TTTT'TTTTTTrTTTYTTTTTTTTTTT 7 7 IHl HTTrn'Tri	rTT'TTTTTTTTTT'r
0.30	0.60	0.90	1.20	1.50
VOLUMES POROSOS INJETADOS
8,4	Discussão dos Resultados
A comparação entre os diversos métodos numéricos para solução do problema é apresentada sob a forma de gráficos de concentração normalizada de traçador.
Para fluxo em 2D o número de Courant foi definido como:
Nco^Q&amp;amp;t/VP^ ,	(8,33)
onde VP^cca é o volume poroso de cada bloco de simulação e Q é a vazão total do padrão “five-spot”. Utilizamos, em todos os casos, números de Courant aproximadamente iguais a 0,5.
A figura 8.4 mostra a concentração normalizada do traçador no efluente obtida utilizando-se o método de ponderação a montante no termo convectivo. Podemos notar que a irrupção do traçador ocorre antes do tempo correto, e a concentração de pico é menor que o valor correto. Tal ocorre devido à dispersão numérica. Uma solução razoável só foi obtida quando refinamos a malha para 150x150 nós. Mesmo assim a concentração de pico ainda ficou cerca de 15% abaixo do valor correto.
As figuras 8.5 a 8.7 apresentam as concentrações normalizadas no efluente obtidas com os métodos TVD.
Observamos que:
•	Para malha 15x15, soluções muito boas são obtidas com o método TVD de terceira ordem com a região TVD de Sweby ou com a região estendida de Liu.
•	Com malha 30x30, o método TVD de terceira ordem com região de Sweby já reproduz a solução exata, melhor que os resultados obtidos com o TVD de Rubín e Blunt e que o TVD de terceira ordem com região estendida de Liu.
•	As soluções obtidas com os métodos TVD e malha 60x60 reproduzem exatamente a. solução semi - analítica, mostrando que os métodos TVD são convergentes.
« A precisão obtida com o método de 1 ponto a montante e malha 150x150 é igual à de qualquer dos métodos TVD com malha 15x15.
Nas figuras 8.8 e 8.9 mostramos as concentrações normalizadas ao longo da diagonal que une o poço injetor ao poço produtor, para um volume injetado de água igual a 0,4VF. A solução de referência é aquela obtida com o método 1 ponto a montante e malha 150x150. Com base nos resultados obtidos para para a concentração no efluente, sabemos que a solução refinada com 1 ponto a montante apresenta concentração de pico cerca de 15% inferior à concentração correta.
O.2O
CONCENTRACAO NORMALIZADA DE TRACADOR	CONCENTRACAO NORMALIZADA DE TRACADOR
0.10
0.05
0.15 -
0.15 -
FLUXO DE TRACADOR MONOFÁSICO EM 2D COMPARACAO COM A SOLUCAO SEMI-ANALÍTICA MÉTODO 1 PONTO A MONTANTE, MALHA DIAGONAL ESQUEME EXPLICITO, NUMERO DE COURANT = 0.5
---- SOL. SEMI-ANALÍTICA
***** MALHA 15X15
---- MALHA 30X30
- — MALHA 60X60 ----- MAI MA 1	ííA
0.00 -ftl1 l"t"T"l"T
0.00
.4: Concentrações norm, no efluente, método 1 ponto a montante.
FLUXO DE TRACADOR MONOFASICO EM 2D COMPARACAO COM A SOLUCAO SEMI-ANALITICA METODO TVD DE RUBIN E BLUNT. MALHA DIAGONAL ESQUEMA EXPLICITO, NUMERO DE COURANT = 0.5
----- SOL. SEMI—ANALITICA
-----	-j PONTO A	MONT., MALHA 150X150
*	• ***	TVD,	MALHA	15X15
	TVD,	MALHA	30X30 „------------------—	TWI~i	UAI MA	RHYRA
0.10
0.05
0.10
0.05
O.OC
VOLUMES POROSOS INJETADOS
CONCENTRACAO NORMALIZADA DE TRACADOR	CONCENTRACAO NORMALIZADA DE TRACADOR
0.15 -
0.15 -
0.10 -
0.10 -
0.05 -
0.05 -
FLUXO DE TRACADOR MONOFÁSICO EM 2D COMPARACAO COM A SOLUCAO SEMI-ANALITICA
MÉTODO TVD DE TERC. ORDEM. REGIÃO TVD DE LIU
EXPLÍCITO. MALHA DIAGONAL, NUMERO DE COURANT = 0.5
----- SOL. SEMI-ANALITICA
.....	1 PONTO A	MONT., MALHA 150X150
*****	TVD,	MALHA	15X15
-----TVD,	MALHA	30X30
-	—	TVD,	MALHA
111111 ,,!,i"i"i"i"i("!*rrrrrTi t rtíríiTrmrrri 11111 rrirri i ti r; imp nni rrnrryrr
0.30
0.60	0.90	1.20
VOLUMES POROSOS INJETADOS
1.50
Concentrações norm. no efluente, método TVD de terc. ordem / Liu.
FLUXO DE TRACADOR MONOFÁSICO EM 2D COMPARACAO COM A SOLUCAO SEMI-ANALITICA
MÉTODO TVD DE TERC. ORDEM, REGIÃO TVD DE SWEBY EXPLICITO, MALHA DIAGONAL, NUMERO DE COURANT = 0.5
-----	SOL.	SEMI-ANALITICA
■. 1 PONTO A	MONT.,	MALHA 150X150
*****	TVD,	MALHA	15X15
-----TVD,	MALHA	30X30
-	—	TVD,	MALHA	6™^
0,00 -HTTTT-n 11 Tm-l-prrrrTTT1TTT ...
0.00	0.30	0.60	0.90	1.20	1.50
VOLUMES POROSOS INJETADOS
0.60
CONCENTRACAO NORMALIZADA DE TRACADOR	CONCENTRACAO NORMAL!ZADA DE TRACADOR
0-50
0.40
C.3O
0.20
0.10
0.00
0.00
FLUXO DE TRACADGR MONOFASiCO EM 2D - PULSO DE 0 02 VP C0NCEN1RAC0ES AO LONGO DA UNHA INJETOR-PRODUTOR MALHA DIAGONAL, NUMERO DE COURANT-0,5, Vinj = 0 4 VP
---- 1 PONTO A MONT.. MALHA 150X150
... 1 PONTO A MONT., MALHA 15X15
- - SAAD-LEONARD, MALHA
■T-r-r-t—r-r-r~r'T~pT*f~f-4,,-m~T-r	,	, . .	. r~i i	rrTT-yfyr
0	0.20	"0.40	0.60	0.80	1.00
FRACAO DA DISTANCIA INJETOR-PRODUTOR
Figura 8.8: Concentrações norm, na diagonal, método de Saad-Leonard.
0.60
0.50
0.40
0.30
0.20
0.10
0.00
0.00
FLUXO DE TRACADOR MONOFÁSICO EM 2D - PULSO DE 0.02 VP CONCENTRACOES AO LONGO OA LINHA INJETOR-PRODUTOR MALHA DIAGONAL, NUMERO DE COURANT-0.5, Vinj = 0.4 VP
----- 1 PONTO	A	MONT,	MALHA	150X150
— 1 PONTO	A	MONT.,	MALHA	15X15
■	---TVD	....
■	... TVD
.....TVD
TERC. ORD./SWEBY, MALHA
TERC, ORD./SWEBY, MALHA
TERC. ORD./SWEBY, MALHA
15X15
30X30
60X60

i ■&gt;*!■ r r iwr f t T5*i*y r-rvr rrrTTTT-rrp-i
0.20	0.40	0.60	0.80
FRACAO DA DISTANCIA IN JETOR-PRODUTOR
1.00
Analisando os resultados, notamos que:
•	O método de Saad-Leonard apresentou oscilações, mesmo nesse caso em que a dispersão física nao é nula — 0,66/t).
•	0 método TVD de terceira ordem com região de Sweby produziu ótimos resultados: com malha 30x30 a solução é praticamente exata, muito próxima da obtida com o mesmo método e malha 60x60.
As figuras 8.10 a 8.12 mostram as curvas de iso-concentração normalizada de traçador para um volume injetado de 0,4VP. Observamos que a distribuição obtida com o método 1 ponto a montante e malha 15x15 tem um caráter bem disperso. Por outro lado, a distribuição obtida com o método TVD de terceira ordem e região TVD de Sweby é bem mais achatada, semelhante ao resultado obtido com o método 1 ponto a montante e malha 50x50.
8.5	Orientação de Malha
Para investigar se a redução da dispersão numérica conseguida com os métodos de ordem mais alta acarreta diminuição do efeito de orientação de malha, adaptamos o programa de computador para trabalhar também com malha paralela.
Nos testes de orientação de malha, consideramos injeção contínua de traçador no(s) poço(s) injetor(es), ao invés de apenas um “slug\ Os demais dados foram os mesmos descritos nos itens anteriores. As concentrações não foram normalizadas.
As comparações foram feitas com malha diagonal 15x15 e malha paralela 21x21, para que as células de simulação ficassem aproximadamente com o mesmo tamanho.
As figuras 8.13 e 8.14 apresentam os resultados obtidos. O método de 1 ponto a montante produz soluções com tempo de irrupção bastante antecipado e também grande efeito de orientação de malha. Convem notar que, com malha paralela, a irrupção do traçador ocorre antes, confirmando os resultados teóricos demonstrados no capítulo 3. O método TVD de terceira ordem com região de Sweby, ao contrário, praticamente não apresenta efeito de orientação de malha.
Figura 8.10: Distribuição das conc. normalizadas, 15x15, 1 ponto a montante.
COfK. NDRtt. DE TfUCADOR, 15X15, W TERC. ÜRD./SWEBY
Figura 8.11: Distribuição das conc. normalizadas. 15x15, TVD de terc. ordem / Sweby.
Figura 8.12: Distribuição das conc. normalizadas, 50x50, 1 ponto a montante.
CONCENTRACAO DE TRAÇADOR	CONCENTRACAO DE TRACADOR
VOLUMES POROSOS INJETADOS
Figura 8.13: Concentrações norm. no efluente, método 1 ponto a montante.
8.6	Injeção do Traçador Através de uma Face em 2D
Adaptamos o programa descrito nos itens anteriores para considerar a injeção de traçador através de uma face do reservatório e produção através de outra face.
Para condição inicial consideramos o meio poroso saturado com água exceto um pulso retangular de traçador com concentração unitária junto à face injetora. A partir daí iniciamos a injeção contínua de traçador, com concentração unitária.
As figuras 8.15 e 8.16 mostram os mapas de concentração (não normalizadas) para um volume injetado igual a 0,4VF, e malha 40x40. Os dados de reservatório usados foram os mesmos dos itens anteriores. Para o traçador consideramos cq ~	= 0, ou seja,
sem dispersão física. Constatamos que a dispersão numérica introduzida pelo método de ponderação a montante é significativa na direção do fluxo. Na direção transversal a dispersão numérica é nula, conforme demonstramos no capítulo 3, para malhas paralelas. Os resultados obtidos com o método TVD de terceira ordem e limitador de Sweby foram bem melhores.
1 PONTD A MONTANTE, 40X40. Vinj = 0.4 VP
Figura 8.15: Distribuição das concentrações, método 1 ponto a montante.
TVD TERC. ORD./SWEBY, 40X40, Vtnj - 0.4 VP
Figura 8.16: Distribuição das concentrações, método TVD de terc. ordem / Sweby.
9	IMPLANTAÇÃO DOS MÉTODOS DE ALTA RESOLUÇÃO EM UM MODELO “BLACK - OIL”
Os simuladores “black-oil” tradicionais utilizam o método de ponderação a montante para aproximar as transmi ssibilidades nas interfaces entre os blocos de simulação. Conforme vimos nos capítulos anteriores, tal procedimento acarreta grandes problemas de dispersão numérica.
Dentre os métodos estudados, os que apresentaram melhores resultados quanto à redução da dispersão numérica, mantendo soluções fisicamente corretas foram : TVD de Rubin e Blunt (limitador de Van Leer) e TVD de terceira ordem com região TVD de Sweby.
Nesse capítulo discutimos a implantação desses esquemas TVD em um simulador bifásico óleo-água, bidimensional, originalmente concebido para um poço injetor e um poço produtor. 0 simulador foi desenvolvido por P.S. Cruz, como parte de sua tese de mestrado na UNICAMP [13], e se baseia na metodologia proposta por Rodríguez [37]. As equações de conservação da massa são escritas para os componentes óleo e água, e discretízadas pelo método de diferenças finitas. 0 método de Newton-Raphson é utilizado para linearizar e resolver iterativamente as equações. O sistema de equações lineares resultante, em cada iteração Newtoniana, tem a forma pentadiagonal blocada, com blocos 2x2, e é resolvido por um método de eliminação Gaussiana com algoritmo D4,
Quando as equações de conservação por componente em um modelo de simulação numérica são discretizadas, é necessário avaliar as transmissibilidades nas interfaces entre os blocos. Dentre os parâmetros que compõem a transmissibilidade, apenas a permeabilidade relativa pode mudar rapidamente de um bloco para o outro. Conforme discutimos no capítulo 2, Todd et alii empregaram um método de segunda ordem para aproximar as permeabilidades relativas nas interfaces.
Com base nesses antecedentes, a idéia de aplicar os métodos TVD para aproximar as permeabilidades relativas nas interfaces segue naturalmente. Em termos formais, a determinação da região TVD exigiria, nesse caso, uma simplificação da lei física, admitindo o termo convectivo composto apenas da derivada espacial da permeabilidade relativa. Ou seja, estaríamos desprezando a influência das demais derivadas sobre o caráter convectivo do fluxo. Conforme constatamos em testes práticos, essa é uma excelente hipótese,
Rubin e Blunt [40] propuseram a formulação matematicamente correta para aplicação do TVD a simuladores “black-oil”, isto é, consideram a lei física completa para deduzir os limitadores TVD. Essa proposta é avaliada e comparada com a aplicação do TVD apenas nas permeabilidades relativas.
Ao implantarmos os métodos no simulador de reservatórios consideramos formulação geral para malhas não-uniformes; no entanto, por simplificação, as discussões a seguir são feitas para malhas uniformes.
9.1	O Método TVD de Rubin e Blunt
Apresentamos a análise para a equação de conservação do componente óleo. Para o componente água as equações são análogas. O termo de fluxo, sem considerar efeitos gravitacionais, é dado por onde:
f0^Ta&amp;amp;Sw}
dp
dx
(9-1)
7
e a aproximação por diferenças finitas fornece:
dx	Ax
(9-2)
Considerando fluxo no sentido i — 1 —+ i -+ i + 1, Rubin e Blunt propõem:
		7	(9-3)
onde:	f -Típ-S	~Pó \ &amp;lt;Ax J	(9.4)
As definições acima são coerentes no sentido de que, quando ç? = 0, o método se reduz a 1 ponto a montante.
Rubin e Blunt utilizaram o limitador definido por Van Leer:
Vk,= 1 + M ’ onde, para o fluxo no sentido i — 1 —&gt; i —* í + 1, temos:
(9.5)
(9.6)
A mesma abordagem ê aplicada para calcular Ou seja, o TVD é aplicado nas duas direções ortogonais.
As seguintes observações são pertinentes;
•	As expressões para malhas não-uniformes são discutidas no capítulo 4 e no apêndice K.
•	Nas bordas da malha ou nos pontos onde há convergência ou divergência do fluxo (r &amp;lt;0), alteramos o método para 1 ponto a montante.
A implantação do método TVD de Rubín e Blunt no modelo “black-oil” exige:
•	Uma rotina para cálculo das razões de fluxo rOij, rWtj e dos limitadores ç?0[j, yWií nas direções X e V, conforme detalhamos acima e no capítulo 4.
•	Alteração das funções de resíduo.
•	A questão da inclusão das derivadas do termo corretivo no Jacobiano, para o esquema totalmente implícito, é mais complicada:
Se o fluxo ocorre nos sentidos i — 1 —»■ i —» i + 1 e j — I —* j —&gt; j' + 1, por exemplo, temos:
na direção X depende de propriedades das células (í + 2, j), (i +1, j),(í, j) e (i- 1J).
-	na direção X depende das propriedades das células (í+l, j), (i, j), (i—1, j)
A mesma análise pode ser feita para o fluxo na direção Y. Assim, a matriz Jacobiana passa a ter 9 diagonais, com largura de banda 27VX, se a numeração é feita na direção X, e XX é o número de células nessa direção.
Portanto, vemos que é problemática, em termos de área de memória e tempo de processamento, a inclusão das derivadas do termo corretivo na matriz Jacobiana. No item (9.5) estudamos soluções alternativas.
No artigo em que apresentam o método TVD [40], Rubín e Blunt trabalham com casos particulares, onde as curvas de permeabilidade relativa são linhas retas e a razão de mobilidades é unitária.
9.2	Método TVD de Rubín e Blunt nas Permeabilidades Relativas
Uma idéia natural é modificar a proposta de Rubin e Blunt, aplicando o TVD apenas no cálculo das permeabilidades relativas nas interfaces.
A equação de conservação do componente óleo, consíderando-se fluxo somente na direção X, e desprezando-se os efeitos gravitacionais é:
d í kkro dp\ _ d_ / dx \fioBo dx) rdi \ Bo /
Desprezando-se as variações de e Bo:
k
PoB0
dx dx ™dx*
Bo di
y
O termo temporal envolve derivada de So. Assim, o caráter convectivo do escoamento é dado por Isso justifica a simplificação de considerar kro como o fluxo Jo na equação de conservação.
Assim, para fluxo na direção X, sentido i —1 —»• i i +1 e malha uniforme, temos:
onde:
L	~~k
Kto.+ 1/2j ~ KrOi} T V’oíj 2
~ krOi) Ax ’
(9.9)
(9.10)
(9.11)
?°it + pJ
i+M ’
t — i-
— ro‘7	i-ij
*“0 “ L	„ X.

Para fluxo em outros sentidos, e/ou malha não-uniforme, empregamos expressões semelhantes às discutidas no capítulo 4 e no apêndice K. Para fluxo na direção Y as equações são análogas.
A implantação do método no modelo “black-oíl” exige:
» Uma rotina para cálculo das razões de fluxo rOij, rWi, e dos limitadores ¡pOíJ. e nas direções X e Y, conforme apresentamos acima e no capítulo 4.
• Alterar o cálculo das permeabilidades relativas nas interfaces e as derivadas destas em relação à saturação. A inclusão dessas derivadas corrigidas na matriz Jacobiana é problemática, pois altera a estrutura da matriz. No item (9.5) discutimos essa questão.
9.3	Método TVD de Terceira Ordem com Região TVD de Sweby nas Permeabilidades Relativas
As idéias são praticamente as mesmas discutidas no item anterior.
O que muda é a definição do limitador, que , para o componente óleo, malha uniforme e direção X, é dado por:
^ou ”	&gt;	(9.12)
onde, para fluxo no sentido i — l —» i ~-+ i + 1, rOj&gt; é calculado pela, equação (9.11).
As expressões para fluxos em outros sentidos e malha não-uniforme foram discutidas no capítulo 4 e no apêndice K.
Para implantar o método no modelo “black-oiP, precisamos:
•	Uma rotina para cálculo das razões de fluxo rOtí e rWí) e dos limitadores ipOij e nas direções Xe Y. Restringir os limitadores calculados ao interior da região TVD de Sweby, conforme discutimos no capítulo 4.
•	Alterar o cálculo das permeabilidades relativas nas interfaces e suas derivadas em relação à saturação. A questão da inclusão dessas derivadas na matriz Jacobiana é discutida no item 9.5.
9.4	Esquema IMPES
No esquema IMPES as transmissibilidades, e consequentemente as permeabilidades relativas, são avaliadas no passo de tempo anterior (tempo n) [6], [37]. A aplicação dos métodos TVD para aproximar as permeabilidades relativas nas interfaces fornece, por exemplo, para fluxo do componente óleo na direção X, sentido ¿ — 1 —» i i 4* 1 e malha uniforme:
a Ln _ fcn
’A-h/í;
Xx
Para o TVD de Rubin e Blunt, aplicado ao fluxo total, temos:
onde:

Os limitadores são calculados utilizando-se os fluxos no tempo (n).
Na formulação IMPES descrita por Rodriguez [37] e utilizada por Cruz [13] no simulador óleo-água, não se itera sobre o termo de acumulação para reduzir o erro de balanço, ou seja, é realizada apenas uma iteração do método de Newton-Raphson.
Portanto, no esquema IMPES, a aplicação dos métodos TVD é perfeita, uma vez que são nulas as derivadas dos termos corretivos em relação à saturação e, consequentemente, a matriz Jacobiana nao se altera.
9.5	Esquema Totalmente Implícito
O esquema totalmente implícito utiliza o método de Newton-Raphson para linearizar e resolver as equações de conservação discretizadas, escritas para todos os nós da malha [6],[37]. No caso da simulação óleo-água, as variáveis independentes são: pressão na fase óleo e saturação na fase água.
Em cada iteração Newtoniana calculamos, para cada nó, as funções de resíduo para os componentes óleo e água. Calculamos também a matriz Jacobiana, que compreende as derivadas das funções de resíduo em relação as variáveis independentes. As iterações prosseguem até que as variações das incógnitas e os valores ds funções de resíduo estejam abaixo de tolerâncias pré-estabelecidas.
Já vímos que, para os métodos TVD, é problemática a inclusão das derivadas dos limitadores na matriz Jacobiana. Nesse ítem discutimos algumas formas alternativas de implantação, em que a forma pentadiagonal blocada da matriz Jacobiana é preservada. A análise é feita para os esquemas de Rubín e Blunt e de terceira ordem, ambos aplicados às permeabilidades relativas. As considerações para o método TVD de Rubín e Blunt aplicado ao fluxo total são análogas.
O esquema semi-ímplícito, descrito por Rodríguez [37] e utilizado por Cruz [13], corresponde à primeira iteração Newtoniana do esquema totalmente implícito. A exemplo do esquema IMPES, não se itera sobre o termo de acumulação.
9.5.1	Métodos TVD no Esquema Totalmente Implícito
Nesse item apresentamos três formas de implantar os métodos TVD no esquema totalmente implícito sem alterar a estrutura da matriz Jacobiana.
a)	Correções não incluídas na matriz Jacobiana
E uma forma simples de implantar o método TVD no esquema totalmente implícito. As correções do método TVD, a nível de iteração Newtoniana, são feitas somente nas funções de resíduo; a matriz Jacobiana não é modificada.
Com esse procedimento esperamos que o método demore mais a convergir, pois a matriz Jacobiana não é calculada de forma exata.
Nos casos práticos que simulamos, constatamos que a aplicação dos métodos TVD para calcular as permeabilidades relativas nas interfaces dos blocos pode conduzir a valores ligeiramente negativos para o componente água junto à frente de avanço. Quando isso ocorre, fazemos o chaveamento para o método de ponderação a montante. Tal correção pode fazer com que, em algumas células, haja oscilação entre os métodos TVD e 1 ponto a montante ao longo das iterações Newtoníanas em um passo de tempo. Para evitar esse comportamento, admitimos que, se em uma célula, o cálculo da permeabilidade relativa na interface (para o componente óleo ou água) foi chaveado para 1 ponto a montante, a permeabilidade relativa na interface para essa célula não volta mais a ser calculada com o TVD, no passo de tempo considerado.
b)	Termos corretivos explícitos
Os termos de correção, relativos à aplicação do TVD, são avaliados no passo de tempo anterior. Assim, por exemplo, para o componente óleo e fluxo no sentido i — 1 -•-* z —► i + 1, a permeabilidade relativa na interface é calculada como:
F -F +	~ f—(9 16)
onde 1/ indica o número da iteração Newtoniana e (n) o passo de tempo anterior.
Nesse caso não existem termos adicionais de derivadas em relação à saturação na matriz Jacobiana.
Esse procedimento é, evidentemente, uma aproximação, tanto melhor quanto menor for o passo de tempo.
c)	Limitador TVD explícito
Apenas o limitador é avaliado no passo de tempo anterior. Assim, para as mesmas condições do item anterior, temos;
k”
ro&gt;+l/2j
-^+^•2 A )
Nesse caso as derivadas do termo corretivo em relação às saturações de água podem ser incluídas na matriz Jacobiana sem alterar a forma pentadiagonal.
A análise do desempenho dessas formas alternativas para o esquema totalmente implícito é apresentada no próximo item.
9,6	Discussão dos Resultados - Caso 1 - Horizontal (Planta)
O primeiro caso estudado com o modelo “black-oil” corresponde à injeção de água em um reservatório bidimensional homogêneo, horizontal, com geometria 1/4 de “five-spot".
As curvas de permeabilidades relativas são apresentadas na figura 9.1. Consideramos nula a pressão capilar óleo-água. As curvas de Bo e Bw encontram-se na figura 9.2. As viscosidades do óleo e da água foram consideradas constantes e iguais a 0,5 mPa.s (0,5 cp). Os demais dados são apresentados na tabela 9.1.
Pressão inicial	20682 kPa (3000 psi)
Saturação inicial de água	0,22
Espessura	10 m (32,8 ft)
Comprimento	1000 m (3280 ft)
Largura	1000 m (3280 ft)
Porosidade	0,20
Permeabilidade	0,1974 pm2 (2QQmD)
Vazão de óleo inicial	238,47 SrrP/d (1500 STB/d)
Pressão mínima de fundo	344,7 kPa (50 psi)
Vazão de injeção inicial	238,47 SW/d (1500 STB/d)
Pressão máxima de injeção	55152 kPa (8000 psi)
Densidade do óleo (água=l,0)	0,8
Variação máxima de saturação no passo de tempo	0,02
Variação máxima de pressão no passo de tempo	137,9 kPa (20 pai)
At máximo	10 dias
At mínimo	0,01 dias
Tolerância na pressão	0,6894 kPa (0,1 psi)
Tolerância na saturação	0,0001
BSW máximo	80%
Tabela 9.1: Dados de reservatório, 2D, horizontal.
Os casos foram rodados com malhas 10x10. A solução de referência foi obtida com o método 1 ponto a montante e malha 30x30. Não foi possível utilizar malha mais refinada devido à limitação de nossos recursos computacionais.
Em todos os casos os erros de balanço de materiais foram desprezíveis.
FATOR VOLUME DE FORMACAO	PERMEABILIDADES RELATIVAS
Figura 9,1: Caso óleo-água, 2D, horizontal. Permeabilidades relativas.
Figura 9.2: Caso óleo-água, 2D, horizontal. Fatores volume de formação.
Os resultados obtidos com o esquema semi-implícito sao apresentados na figura 9.3.
Pode-se observar que:
* O método TVD de terceira ordem com região TVD de Sweby teve o melhor comportamento. A resolução da resposta obtida com malha 10x10 foi superior ao do método 1 ponto a montante com malha 30x30, que precisaría ser mais refinado para produzir solução mais precisa.
» O método TVD de Rubin e Blunt aplicado somente às permeabilidades relativas apresentou melhores resultados do que quando aplicado ao termo de fluxo total, conforme a proposta original dos autores.
A tabela 9.2 fornece um resumo dos resultados.
MALHA	METODO	BSW 1% (DIAS)	BSW = 80% (DIAS)	“TIMESTEPS”	ITERAÇÕES
30x30	1PM	2226	3778	436	436
10x10	1PM	1936	4185	441	441
10x10	TVD-RB	2136	3855	407	407
10x10	TVD-RB (M	2196	3830	407	407
10x10	TVD 3a ORD	2256	3747	397	397
Tabela 9.2: Resultados para o esquema semi-implícito.
Vemos que o método de ponderação a montante, com malha 10x10, antecipa o tempo de irrupção da água em aproximadamente 1 ano, devido exclusivamente à dispersão numérica. Erro maior é cometido no tempo decorrido até que o abandono (BSW = 80%).
Os resultados, em termos de saturações e pressões, obtidos com o método totalmente implícito completo (item 9.5a) são apresentados na tabela 9.3 e na figura 9.4. Podemos observar que são muito pequenas as diferenças em relação aos valores obtidos com o método semi-implícito.
MALHA	MÉTODO	BSW 1% (DIAS)	BSW = 80% (DIAS)	“TIMESTEPS”	ITERAÇÕES
10x10	1PM	1936	4166	438	1163
10x10	TVD-RB	2146	3858	493	2714
10x10	TVD-RB (M	2187	3844	405	1318
10x10	TVD 3a ORD	2237	3745	396	1383
CORTE OE AGUA (fracac)	CORTE DE AGUA (fracao)
Figura 9.3: Caso óleo-água, 2D, horizontal. Semi-implícito.
COMPARACAO ENTRE METODOS TVD, 2D
ESQUEMA TOTALMENTE IMPLICITO - N ITERACOES CORTE DE AGUA versus VOLOME INJETADO
VOLUME POROSO DESLOCAVEL INJETADO (fracaoj
Notamos que, entre os métodos TVD, o método de Rubín e Blunt para o fluxo total realizou muito mais iterações que os outros dois métodos TVD e, apesar disso, não apresentou resultados tão bons. Por esse motivo resolvemos não investir para melhorar o método ou pesquisar a causa do elevado número de iterações.
Os resultados correspondentes aos esquemas totalmente implícitos modificados (itens 9,5b e 9,5c) são apresentados nas figuras 9.5 e 9.6 e nas tabelas 9.4 e 9.5.
Quanto a estas formulações alternativas para os métodos TVD no esquema implícito, verificamos que:
•	A qualidade dos resultados foi praticamente a mesma obtida com o esquema totalmente implícito completo (item 9.5a)
•	0 número de iterações realizadas foi menor do que o que o número de iterações realizadas pelo esquema completo (item 9.5a); em termos da média do número de iterações por passo de tempo o resultado foi muito próximo do obtido com o método 1 ponto a montante.
Como o problema analisado tem dados próximos de um caso real, os bons resultados apresentados pelos métodos TVD com os esquemas alternativos são significativos.
MALHA	MÉTODO	BSW = 1% (DIAS)	BSIV = 80% (DIAS)	“TIMESTEPS”	ITERAÇÕES
10x10	TVD-RB (k)	2197	3826	403	1117
10x10	TVD 3a ORD	2247	3742	399	1116
Tabela 9.4: Resultados para o esquema implícito com correções TVD explícitas.
MALHA	MÉTODO	BSW = 1% (DIAS)	BSW = 80% (DIAS)	“TIME- STEPS”	ITERAÇÕES
10x10	TVD-RB (k)	2187	3844	405	1124
10x10	TVD 3- ORD	2237	3744	396	1110
Tabela 9,5: Resultados para o esquema implícito com limitadores TVD explícitos.
As distribuições de saturação de água obtidas com o esquema semi-implícito, para um volume injetado igual a 20% do volume poroso deslocável, são apresentadas nas figuras 9.7 a 9.9.
Notamos a tendência do método 1 ponto a montante em dispersar a frente de avanço. O método TVD de terceira ordem, ao contrário, apresenta resultados muito parecidos com aqueles obtidos com o método tradicional e malha refinada.
Para o esquema IMPES as conclusões são bem semelhantes às do esquema semi-implícito. Os resultados encontram-se na tabela 9.6.
CORTE DE AGUA (frocoo)	g	CORTE OE AGUA (fr&lt;jct&gt;o)
9.5: Caso óleo-água, 2D, horizontal. TVD de Kubin e Blunt nas perm, relativas.
Figura 9.7: Caso óleo-água, 2D, horizontal. Malha 10x10, I ponto a montante.
SAI. K AGUA. PLANTA, 10X10, TEftC. ORDEM. Wnj-O.ÍVP
Figura 9.8: Caso óleo-água, 2D, horizontal. Malha 10x10, TVD de terc. ordem / Sweby.
Figura 9.9: Caso óleo-água, 2D, horizontal. Malha 30x30, 1 ponto a montante.
MALHA	MÉTODO	BSW - 1% (DIAS)	BSW 80% (DIAS)	“TIME- STEPS”	ITERAÇÕES
30x30	1PM	2295	3723	682	682
10x10	1PM	1980	4148	439	439
10x10	TVD-RB	2199	3802	404	404
10x10	TVD-RB (M	2259	3778	401	401
10x10	TVD 3- ORD	2319	3683	392	392
Tabela 9.6: Resultados para o esquema IMPES.
9.7	Discussão dos Resultados - Caso 2 - Seção Vertical
Nesse item apresentamos os resultados obtidos para um corte, ou seção vertical, em um reservatório com injeção de água no canto inferior direito (base) e produção de óleo no canto superior esquerdo (topo).
Os valores de Bo e Bw foram considerados constantes, íguais a 1,0 m3/m3. Âs viscosidades do óleo e da água são também constantes, iguais a 0,5 mPa.s. Para compressibilidade da rocha utilizamos 1,45.10"7 kPcT1 (10-6 psi-1).
As curvas de kro e krw e pressão capilar são apresentadas nas figuras 9.10 e 9.11. Os demais dados encontram-se na tabela 9.7.
Os casos foram testados com o esquema semi-implícito.
Os resultados para o corte de água no poço produtor versus volume injetado encontram-se na figura 9.12. As distribuições de saturações para um volume injetado igual a 0,4VP sao mostradas nas figuras 9.13 e 9.14.
Observamos que os resultados obtidos com o método TVD de terceira ordem com malha 10x10 foram bem melhores que os obtidos com o método de ponderação a montante e malha 20x20. Os resultados se aproximaram daqueles obtidos com o método tradicional e malha 40x40.
Para malha 10x10 o perfil de saturações correspondente ao método de ponderação a montante é bem disperso, mostrando que a irrupção da água ocorrerá bem antes do tempo correto. 0 método TVD, ao contrário, produz um perfil bem mais achatado.
Um outro teste foi feito, considerando-se um reservatório heterogêneo em termos de distribuição de porosidades e permeabilidades. Embora heterogêneo, as médias das propriedades foram mantidas constantes, iguais aos valores citados no item anterior. Os dados completos, incluindo as técnicas de geração das populações de porosidade e permeabilidades são apresentados por Cruz [13] . Os demais dados de reservatório são os mesmos do caso anterior.
PERMEABILIDADES RELATIVAS - CASO SECAO TRANSVERSAL
m 0.40
0.00
0.00
Tr-t-T-T-T’-T,•■&gt;■") t t I I I &gt; I 1 i | I 1 ;	j	¡ , , , ,	, , , ,,
3	0.20	0.40	0.60	0.80
SATURACAO DE AGUA (frocoo)
1.00
Figura 9.10: Caso óleo-água, 2D, seção. Permeabilidades relativas.
1.00
o.so
CORTE DE AGUA (frccoo)
0.60
0,40
0.20
0.00
SECAO VERTICAL - RESERVATÓRIO HOMOGENEO ESQUEMA SEMI-IMPLÍCITO
CORTE DE AGUA versus VOLUME INJETADO
♦
---- 1 PM.	40X«, CASO BASE ---- 1 PM. MALHA 20X20
- - 1 PM, MALHA IQXfD
• Í...TVD TERC. ORO-, MALHA 10X10
/
_ - " '' S
i i 11 11 &amp;lt;&gt; i j i i") "it r?n | i t1 r r i 111
0.20	0.40	0.60	0.60	1.Ô0	1,20
VOLUME POROSO INJETADO (frocoo)
TT~
1.40
Figura 9.12: Caso óleo-água, 2D, seção. Comparação entre métodos.
SAI. DE AGUA, SECAO, HOMOG,, 1 PONTO A M0NT„ 10X10, Vinj=0.4VP
Figura 9.13: Caso óleoágua, 2D, seção. Malha 10x10, 1 ponto a montante.
Figura 9.14: Caso óleo-água, 2D, seção. Malha 10x10, TVD de tere, ordem / Sweby.
Pressão inicial	20682 kPa (3000 psij
Saturação inicial de água	0,0
Espessura	20 m (65,2 ft)
Comprimento	400 m (1312,4/í)
Largura	100 m (328,1 ft)
Porosidade	0,215
Permeabilidade horizontal	0,212 pm2 (2Ut9mD)
Permeabilidade vertical	0,143 pm2 (145,4 mD)
Vazão de óleo inicial	476,9 Sm3 ¡d (3000 STBjd)
Pressão mínima de fundo	10341 kPa (1500 psi)
Vazão de injeção inicial	476,9 Sm3/d (3000 STB/d)
Pressão máxima de injeção	137880 kPa (20000 psi)
Densidade do óleo (água=l,0)	0,8
Variação máxima de saturação no passo de tempo	0,02
Variação máxima de pressão no passo de tempo	137,9 kPa (20 psi)
At máximo	2 dias
Aí mínimo	0,0001 dias
BSW máximo	99%
Tabela 9.7: Dados de reservatório, Caso 2 - seção vertical.
As figuras 9.15 a 9.17 mostram os resultados obtidos para o caso heterogñeo. Podemos verificar que o método TVD de terceira ordem com malha 8x8 apresentou um comportamento muito semelhante ao método de ponderação a montante e malha 20x20. O método tradicional, com a mesma malha 8x8 produziu resultados completamente distorcidos devido à dispersão numérica.
Observamos também que as heterogeneidades do reservatório alteraram o perfil de saturações em relação ao caso homogêneo. As melhores características do topo da zona equilibraram a tendência de digitação da água na base, causada pela gravidade, e produziram um deslocamento mais uniforme, com aspecto de banco.
9.8	Solução Semi-Analítica
Devido ao grande tempo de processamento e à grande quantidade de memória necessária para obter as soluções com malhas refinadas, desenvolvemos um programa de computador que produz soluções semi-analíticas para o deslocamento óleo-água incom-pressível em duas dimensões e qualquer geometria de fluxo.
As soluções semi-analíticas propostas na literatura para o caso bidimensional utilizam o método dos canais de fluxo. Os canais são gerados com base na teoria do
roo
SECAD VERTICAL ~ RESERVATORiO HETEROGENEO ESQUEMA SE MI-IMPLICITO
CORTE DE AGUA versus VOLUME INJETADO
0.80
CORTE DE AGUA (frcrcao)
0.60
0.40
0.20 -
0.00 -
0.20
1 PM, MALHA 40X40. CASO BASE t PM, MALHA 20X20
1 PM, MALHA BXfl
TvD TERC. ORO.. MALHA 8X8
rr
1.40
i i ! i'V’iTi C| «t-rr?'
0.40	0.60	0.80	1.Ò0 V.¿Ó
VOLUME POROSO INJETADO (fracoo)
Figura 9.15: Caso óleo-água, 2D, seção, heterog.. Comparação entre métodos.
SAI. DE AGUA, SECAD, HETEROG., 1 PONTO A MONT., 8X8, Vinj « 0.4VP
Figura 9.16: Caso óleo-agua, 2D, seção, heterog., 8x8, 1 ponto a montante.
SAT. DE AGUA, SECAO, HETEROG., TVD TERC. ORDEM, BXS, Vinj =* O.4VP
Figura 9.17: Caso óleo-água, 21), seção, heterog., 8x8, TVD de tere, ordem / Sweby.
deslocamento em regime permanente, sendo que o confinamento a uma certa geometria de fluxo é conseguido através dá superposição no espaço. Cada canal é considerado como um duto linear, e o fluxo em seu interior é calculado pela teoria de Buckley-Leverett. Ao final, as produções dos canais são totalizadas em cada passo de tempo.
Inicialmente desenvolvemos um programa com base nas idéias de Higgins e Lei gh ton [21]. Apesar da complexidade do método, os resultados obtidos não foram bons. Resultados bem melhores foram conseguidos aplicando-se o método proposto por LeBlanc e Caudle [24], A seguir descrevemos o procedimento utilizado:
1~ passo: Gerar os canais de fluxo admitindo razão de mobilidades unitária.
Utilizamos a metodologia proposta por Régis K. Romeu [39], No caso, trabalhamos com geometria 1/4 de “five-spot”.
Uma vez escolhido o número de canais, localizamos os pontos de partida dos canais igualmente espaçados em um círculo (ou 1/4 de círculo, no caso de 1/4 de “five-spot”) ao redor do poço injetor.
Para gerar o campo de pressões confinado ao interior do padrão utilizamos uma rede de dl poços e aplicamos a superposição no espaço. A pressão adimensional em um ponto (x£),Ud) devido à ação dos N poços é calculada por:
onde Pq^ é uma referência e q, são as vazões dos poços da malha (ex: = 1 para poços injetores e = ~~1 para poços produtores).
A velocidade da frente deslocante é inicialmente- calculada supondo deslocamento pistão. Romeu [39] demonstra que:
* — JL V ___________________________________
r	- xd3Y + (yn ~ S/D,)2]
y 2?r q, [(xn ™ xD.)2 + (yD - yp.)2]
(9.19)
(9.20)
Partindo-se de pontos igualmente distribuídos em um círculo ao redor do poço injetor, as posições seguintes dentro de cada canal são calculadas por:
^£)(ÍD + Atp) = xp(íp) +	,
(9.21)
e
yD(tD + &amp;amp;ÍD) = yo(ÍD) + v*&amp;amp;ÍD ,	(9.22)
onde Ato é um valor suficientemente pequeno para garantir a hipótese de ?£, v’ constantes no passo de tempo.
O cálculo é repetido ao longo do canal até que o poço produtor seja atingido, e a seguir é repetido para os demais canais.
2a passo: Correção para razão de mobilidades não-unitária.
LeBlanc e Caudle [24] admitem a hipótese de que as posições dos canais permanecem as mesmas quando as mobilidades dos fluidos deslocado e deslocante não são iguais. Caso essa consideração não seja feita, métodos mais complexos devem ser aplicados para determinar as posições dos canais [28].
Vamos considerar a pressão de fluxo constante nos poços injetor e produtor. Portanto, como AP é mantido fixo e as mobilidades da água e do óleo não são mais iguais, as velocidades são diferentes das velocidades do caso monofásico.
Os autores admitem que o deslocamento do óleo pela água dentro de cada canal define L regiões de saturações de água entre o poço injetor e o poço produtor. Ao longo do tempo, são monitoradas as posições dessas L saturações no canal.
As correções das velocidades devido à razão de mobilidades não unitária são feitas de acordo com as expressões:
(9.23)
(9.24)
onde é a mobilidade do fluido no caso monofásico. Lembramos que o caso monofásico é utilizado para obter o campo de pressões e o formato dos canais. At é a mobilidade total do fluido no ponto correspondente à saturação
3S	passo; Aplicação da teoria de Buckley-Leverett no interior de cada canal.
A curva de fluxo fracionário considerada já deve estar corrigida com a imposição do choque.
As velocidades obtidas no item anterior consideram deslocamento tipo pistão. Para aplicar a teoria de Buckley-Leverett (pistão vazado), multiplicamos essas velocidades pela derivada do fluxo fracionário na saturação de água correspondente. Assim, as velocidades do ponto do canal que corresponde a uma saturação de água são dadas por:
(9.25)
(9.26)
4a passo: Cálculo das contribuições de cada canal para as vazões de água e óleo no poço produtor.
Com as equações apresentadas nos passos anteriores temos condições de calcular a distribuição de saturações em cada canal ao longo do tempo:
•	0 ponto inicial compreende L saturações de água entre 5^ e (1 —
•	Fixamos At pequeno e calculamos, em cada passo de tempo, as posições das L saturações de água no canal. 0 cálculo prossegue até que a saturação de água mais alta alcance o poço produtor.
•	Dessa forma conhecemos, em cada tempo, a saturação no poço produtor, e consequentemente o corte de água no canal.
•	No caso monofásico as vazões nos canais são iguais a 0,25/N. A correção da vazão total no canal devido à razão de mobilidades não unitária é feita utilizando-se a mesma expressão de correção das velocidades, ou seja:
♦ Calculada a vazão total no canal no passo de tempo, a contribuição do canal para a vazão de água no poço produtor é dada por:

5- passo: Totalização.
A totalização é feita fixando-se os tempos e interpolando-se com os resultados obtidos para os canais. Obtemos, em cada tempo, o volume injetado, a vazão total, a vazão de água e o corte de água no poço produtor.
9.9	Comparações com as Soluções Se mi-Analíticas. Orientação de Malha.
Neste item apresentamos a comparação entre os resultados numéricos e as soluções semi-analíticas para diversas razões de mobilidade. Não encontramos, nos artigos pesquisados na literatura, comparações desse tipo.
A geometria do reservatório é 1/4 de “five-spot”. Os valores de Bo e Bw foram considerados constantes e iguais a 1,0 m3/Sm3. As curvas de permeabilidade relativa são linhas retas, idênticas às utilizadas no item 9.7. A pressão capilar óleo-água foi considerada nula. Os demais dados de reservatório, para malha diagonal, são apresentados na tabela 9.8.
Pressão inicial
Saturação inicial de água Espessura
Comprimento Largura
Porosidade Permeabilidade
Vazão de óleo inicial Pressão mínima de fundo Vazão de injeção inicial Pressão máxima de injeção Ai máximo
Ai mínimo
20682 kPa (3000 psi)
0,0
5,0m (16,4 ft)
706,9m (2319,3 ft)
706,9m (2319,3 ft)
0,05
0,1974 prn2 (200 mD) 794,95m3/d (5000 STB/d) 193Q3t2kPa (2800 psi) 794,95m3/d (5000 STB/d) 22060,SkPa (3200 psi) 10 dias
10”* dias
Tabela 9.8: Dados de reservatório. Comparação com a solução semí-analítica.
A compressibilidade da rocha foi considerada desprezível.
Para malha paralela as dimensões do reservatório passam a ser lOOOm x lOOOm x 5m. O número de nós em cada direção deve passar a ser V2 vezes o número de nós correspondentes à malha diagonal, de forma que os blocos de simulação tenham o mesmo tamanho. Utilizamos malha diagonal 15x15 e malha paralela 21x21.
Os casos foram simulados com o esquema semi-imph'cito. Consideramos os métodos de 1 ponto a montante e TVD de terceira ordem com região de Sweby. As soluções semi-analíticas foram geradas utilizando-se 91 canais de fluxo.
No primeiro caso consideramos po ~	™ 1 mPa.s, ou seja, razão de mobili-
dades unitária. Os resultados são apresentados nas figuras 9.18 a 9.21.
Observamos que:
CORTE DE AGUA (fracoo)	CORTE DE AGUA (frccoo)
Figura 9.18: Caso ókoágua, 2D. Orientação de malha, M~l.
0.80
0.60
0.40
0.20 -
0.00
nVE-SPOT OLEO-AGUA - TVD TERC. ORO. / SWEBY KR COMO LINHAS RETAS - M = 1
ANALÍSE DO EFEITO DE ORIENTACAO DE MALHA
/
/ / / /
f
SOL. DE CAUDLE e Le BLANC MALHA 15X15, DIAGONAL, TVD MALHA 21X21, PARALELA. IVD
i ; &gt; i i ri'FrTrTrrrTT» i | ó t i; i i « i; 1U &gt;'&amp;lt;i * T1 1 ’ &amp;lt;! ’ rTT,r'rr"t"r|"ii'i ''
0.50	0.55	0.60	0.65	0.70	0.75	0.80	0.85	0.90	0.95	1.00	1.05	1.10
VOL. POROSO DESLOC. INJETADO (fracao)
1.05
&amp;amp;»T. Oí ACUA, V&lt;nj»0.2VP,	PARALELA, 21* 21. l PORTO A MOHTAWTI
Figura 9.20: Caso óleo-água, 2D, 21x21, 1 ponto a montante, M=l.
SAL DE AGtiA, «nJ-D.2VP, MALHA PARALELA. 21X21, TO TCRC. ORD.
•	As soluções obtidas com o rnétodo de ponderação a montante são completamente distorcidas devido à dispersão numérica, 0 efeito de orientação de malha é também muito pronunciado.
•	0 método TVD de terceira ordem, ao contrário, apresentou soluções bastante razoáveis, com pequeno efeito de orientação de malha,
•	A distribuição de saturações obtida com o método de ponderacao a montante é bem mais dispersa que a correspondente ao TVD, para a mesma malha.
No segundo caso consideramos /q, = 1 mPa.s e — 0,5 mPa.s, isto é, razão de mobilidades igual a 2,0. As figuras 9.22 e 9.23 mostram os resultados,
Podemos verificar que:
•	As soluções obtidas com o método 1 ponto a montante apresentam tempo de irrupção bem menor que o correto, principalmente para a malha paralela. 0 efeito de orientação de malha é também marcante nesse caso,
•	A qualidade das soluções obtidas com o TVD é bem melhor e nao há efeito de orientação de malha.
Analisamos também um caso com = 1 mPa.s e ¡iw — 0,25 mPa.3, isto é, M=4. Os resultados sao apresentados nas figuras 9.24 e 9.25. As conclusões são as mesmas do caso anterior.
Para complementar a análise do efeito de orientação de malha simulamos um caso com po = 1,0 mPa.s e /iu, — 0,025 mPa.s, ou seja, M ---40. As figuras 9.26 a 9.29 apresentam as distribuições das saturações de água para um volume injetado 0,15 VP, obtidas com os dois tipos de malha. Para os casos correspondentes a malhas paralelas notamos algumas oscilações nas curvas de isosaturaçao, causadas pelo programa de computador que realiza as interpolações para construir as curvas.
Quanto à orientação de malha, podemos notar que:
•	As soluções obtidas com o método de ponderação a montante apresentam considerável efeito de orientação de malha, Com a malha paralela há uma forte canalização no centro, que provoca irrupção antecipada da água, A malha diagonal, ao contrário, tende a dispersar lateralmente o fluxo. Tais diferenças se acentuam quando são utilizadas malhas mais grosseiras, isto é, com e Ay maiores.
•	Com o método TVD de terceira ordem com região de Sweby, o efeito de orientação de malha praticamente não existe. As respostas obtidas com os dois tipos de malha são muito semelhantes.
CORTE DE AGUA (fracao)	CORTE DE AGUA (fracao)
VQL. POROSO DESLOC. INJETADO (frocao)
Figura 9.22: Caso óleo-água, 2D. Orientação de malha, M—2.
0.90
0.80
0.70
0.60
0.50
0,40 -
0.30
0.20
0.10
FWE-SPOT OLEO-AGUA - TVD TERC. KR COMO LINHAS RETAS - M - 2 ANALISE DO EFEITO DE ORIENTACAO DE
ORD. / SWEBY
MALHA
DE CAUW.E • Le BLANC
----- SOL........................
......MALHA 15X15. DIAGONAL. TVD OOOOO MALHA 21X21. PARALELA. TVD
0.00 4»' HlITiT-frí	ii|iil r; mTTTTTi; r! 11 j i rTTTTiTTTiTTTrryrrfTrrr
0.00 0.10 0.20 0.30 0.40 0.50 0.60 0.76 0.80 0.90 1.00 1.10 1.20 1.30 1.40 1.50 VOL. POROSO DESLOC. INJETADO (fracoo)
CORTE DE AGUA (fracoo)	CORTE DE AGUA (rracao)
Figura 9.24: Caso óleo-água, 2D. Orientação de malha, M=4.
Figura 9.26: Caso óleo-água, 2D. Malha diagonal, 15x15, 1 ponto a montante, M=40.
M-4O. 21X21 PARALELA, 1 PONTO A MONTANTE, Vmj - 0.15 VP
Figura 9.27: Caso óleo-água, 2D. Malha paralela, 21x21, 1 ponto a montante, M=40.
Figura 9.28: Caso óleo-água, 2D. Malha diagonal, 15x15, TVD de terc. ordem, M--40.
10	TRAÇADORES NA FASE ÁGUA NO MODELO “BLACK - OIL”
Nesse capítulo apresentamos a formulação matemática para a implantação da opção de traçadores na fase água no modelo de simulação descrito no capítulo 9. Para solução numérica das equações consideramos os métodos de ponderação a montante e TVD de terceira ordem com região TVD de Sweby, nos esquemas explícito e implícito. Utilizamos o tensor dispersão completo e consideramos a adsorçao reversível do traçador na rocha. São apresentados alguns exemplos práticos, onde investigamos o efeito de alguns parâmetros do reservatório e dos traçadores.
10.1	Formulação Matemática
A equação de conservação para o componente água é [23]:
d	-	_	- -
onde xw ê a concentração mássica do componente água na fase água e Kw é o tensor dispersão. Como não estamos considerando a difusão molecular, Kw só depende da fase.
Como :
Pw ~ Pii&gt;st/Bw ’
(10.2)
a equação (10.1) fica:
d (4&gt;SW	\
dt ( K
+ V.
B-u)
K Vx ** w* v w
(10.3)
Analogamente, escrevemos a equação para o traçador l na fase água:
(10.4)
A equação (10.4) vale para os N-j- traçadores presentes na fase água. Somando as Nt equações (10.4) com a equação (10.3), obtemos a equação de conservação da fase água:
di v bw y+ v-	’	(i0'5í
que é a equação do componente água no modelo de simulação ólco-água.
Dessa forma conseguimos desacoplar as equações de concentração dos traçado-res das equações do modelo de simulação . Em cada passo de tempo obtemos do simulador as distribuições de pressão na fase óleo e saturação de água. A seguir, no mesmo passo de tempo, resolvemos as equações (10.4) para cada um dos traçadores considerados, obtendo assim as distribuições das concentrações.
Obtidas as concentrações mássicas, podemos facilmente obter as concentrações volumétricas (massa de traçador por volume da fase água). Para a célula (í,j), e traçador l, por exemplo:
C'ítüjj	5	(10.6)
onde pWi} ê a massa específica da água na célula (¿,j) no passo de tempo considerado.
Doravante, salvo observação em contrário, estaremos trabalhando com concentrações mássicas.
10.2	Adsorção
A adsorção do traçador na rocha é um termo de consumo de traçador e aparece, portanto, no termo de acumulação. Lake [23] propõe, para o termo de acumulação do componente l:
W) —	d" (1	&gt;	(10.7)
onde ps é a massa específica da rocha e ir, éaconcentração do traçador na rocha.
Definindo-se :
Cis^
Massa de traçador adsorvida
Volume poroso
(10.8)
5
segue que:
massa de traçador adsorvida ~&amp;lt;bCis ~ (1 — ^PtXis ,
(10.9)
ou seja,
A relação de equilíbrio entre CA e Ciw é obtida em laboratório e tem, em geral, a forma da isoterma de Langmuir [23] :
Cu ~
1 4" bCsiw I 4- bpvjXity
A expressão acima mostra que a adsorção é um processo reversível, que retarda o fluxo de traçador.
Considerando a adsorção, (10.4) fica:
1 dt
+ V.
%lw -f
~B~U™
Jiíí,.vXlnr —
(10.12)
10.3	Solução Numérica
Aqui discutimos a solução numérica da equação (10.12). As deduções são feitas considerando malha uniforme por simplificação, No programa de computador os cálculos envolvendo os métodos TVD foram implantados prevendo malha não-uniforme,
10.3.1	Cálculo das Propriedades
Nesse item descrevemos o cálculo das propriedades necessárias à solução das equações de conservação para os traçadores na fase água.
Cálculo das velocidades da fase água
Após termos resolvido para a pressão na fase óleo e saturação de água no passo de tempo, calculamos as velocidades da fase água. As expressões a seguir consideram fluxo no sentido i — 1 —&gt; i —&gt; ¿4-1; por simplicidade não incluímos nas equações os efeitos gravitacionais.
* Método 1 Ponto a Montante
- pc'ü - ps+i+pc&lt;^ &gt;	í10-13)
onde Pc é a pressão capilar óleo-água e cie é o fator de conversão de unidades. A permeabilidade ki+i/2j é a média harmônica entre k^ e ki+lj . krWt^ij2} é avaliada a montante, assim como pw.
• Método TV D de Rubin e Blunt
Definindo, conforme vimos no capítulo 9:
Z"+1 = T".&gt;	P^ + ^+I) ,	(10.14)
temos :
n+1
• Métodos TVD aplicados às permeabilidades relativas
Nesse caso as correções já foram aplicadas às permeabilidades relativas nas interfaces. Para calcular as velocidades da fase água, basta então empregar a equação (10.13).
Cálculo dos componentes do tensor dispersão
Temos:
onde os valores K^y, KyVi Kyy são obtidos utilizando-se as equações (8.12) e (8.14) com um termo adicional, multiplicando os denomidadores.
Para simplificar as equações, definimos :
(10.17)
As definições para Gm , Gyx sao similares.
10.3.2	Esquema Explícito
Em relação às equações deduzidas no capítulo 8, a maior diferença é a não-Hnearidade introduzida pela adsorção. Definimos:
Para simplificar as equações no esquema explícito, admitimos a aproximação :
/&gt;w«) = h(xU + (xj+&gt; - xUh'(xU .	(10.19)
Assim, discretizando-se (10.4) com o esquema explícito, chega-se a uma equação muito parecida com (8.29). Eliminando-se os índices /w, por simplicidade, a equação de conservação do componente l fica:
At
í^\n
-K„ {¿í K+A1"-™ - *â) -	-&amp;lt;-«)] +
+ AxÃy [^‘+v^/;rí+a/2j-H/2 ~ X?+l/2j-V2)+ ~ A-l/2j—1/2)] d"
1
n

+
^AzAy P®*ü+i/2^+V2j+i/2	:r^-i/2J+1/2)+
“ ^-1/^/2)]}	(iO.20)
onde «a, uv são as velocidades da fase água. As definições de	aq-i/aj+i/a,
^&gt;+i/2j~i/2 e	são as mesmas do capítulo 8. Os parâmetros Gxyy Gyxy Gxx. Gyy
nas interfaces entre os blocos são avaliados como médias harmônicas.
As condições de contorno do problema são as mesmas descritas no capítulo 8.
Os métodos TVD são aplicados para aproximar as concentrações nas interfaces.
Para fluxo na direção x, e sentido i — 1 i —&gt; i + 1, por exemplo, temos:
Os limitadores	y são calculados conforme descrevemos no capítulo 4.
Utilizando-se (10.20) com as condições iniciais e de contorno já vistas, podemos resolver para as concentrações de traçador x’)4'1 em cada passo de tempo, de forma explícita.
10.3.3 Esquema Implícito
É utilizado o método de Newton-Raphson. A função de resíduo em cada iteração Newtoniana v é definida por:
r*
Vr -pt'	— ‘J
~ At
n+l
Ay
x, '“'r w / VJ	\ w y
í +1	„ ( Uti-w
7«„W»Y+'..
¿	-&amp;lt;•) - GX,.M -	+
i rG"í-

4 f 3	+ xí+U+i xij-i ^i+ij-i) +
+ Zí-lj+1	xij-l	Xi~lj-1) "fi
r 4 \x»+lj + xi+lj+l xi~lj ■H-lj+V z~m+l
4. TP .	™ (y1'	„	.
) +
+ãjí	- «&amp;amp;) - gZAW - «&amp;amp;-.)];
(10.22)
Nessa equação já substituímos as definições de:
^í+I/2j+l/2 ? ^+1/21-1/2 ’ ^¿-1/21+V2 e
Da mesma forma que no esquema explícito, os métodos TVD são aplicados para aproximar as concentrações nas interfaces entre os blocos. Para fluxo na direção x, e sentido i — 1 —&gt; i ~~+ i + 1, por exemplo, temos:
r" — r" 4- m1'	(Xi+Í^ ~ \	/IO 9‘í’i
xi+i/2j - xij + VXi} £ l	J '	(10.23)
Aplicando o método de Newton-Raphson, as concentrações na iteração seguinte são obtidas resolvendo-se:
Pr[X“+1 - X'l = -FresIX") ,	(10.24)
onde [Jj é a matriz Jacobiana do sistema. Essa matriz é formada pelas derivadas das funções de resíduo em relação às concentrações , e tem a dimensão (NX.NY) por (NX.NY).
Analisando-se a equação (10.22) pode-se concluir que a equação de cada nó da malha compreende as seguintes incógnitas: aqj, x&lt;jqi,	a\+iñ Zj+ijqi, aqqij-i,
e X('„ij_i .
Portanto, se utilizarmos o método de ponderação a montante para aproximar as concentrações nas interfaces entre os blocos de simulação, a matriz Jacobiana terá 9 diagonais e largura de banda NX + 1, para numeração da malha na direção X. A discussão sobre a consideração das derivadas das correções do método TVD na matriz Jacobiana é similar á apresentada no capítulo 9.
Nesse caso optamos por não considerar, na matriz Jacobiana, as derivadas dos limitadores em relação às concentrações. Já vimos que a inclusão dessas derivadas aumenta a largura de banda da matriz para 2.NX, no caso de numeração da malha na direção X. Assim, quando empregamos os métodos TVD, o Jacobiano é calculado de forma aproximada. Se as variações dos limitadores&amp;lt;/&gt; no passo de tempo não são grandes, a convergência do método não é afetada. Esse esquema é idêntico ao discutido no item 9.5a; poderíamos ter também considerado as formas alternativas dos itens 9.5b e 9.5c.
As expressões para os componentes da matriz Jacobiana podem ser obtidas derivando-se a função de resíduo (10.22) em relação a cada uma das incógnitas. Para não sobrecarregar o texto, não apresentaremos estas expressões, que podem ser encontradas no programa de computador disponível como anexo à tese, na biblioteca do Departamento de Engenharia de Petróleo da UNICAMP.
10.4	Simulações de Casos com Injeção de Traçadores
Nesse item apresentamos uma série de exemplos e comparações envolvendo simulações numéricas de injeção de traçadores.
CASO 1 - Comparação entre esquemas explícito e implícito
Simulamos a injeção de traçador em um reservatório 100% saturado de água com geometria 1/4 de “five-spoU. Utilizamos malha diagonal.
Os dados de reservatório são aqueles apresentados no capítulo 8. Os resultados são apresentados nas figuras 10.1 a 10.5. As concentrações no efluente foram normalizadas utilizando-se o mesmo fator descrito no capítulo 8. Em todas as figuras incluímos a solução analítica de Abbaszadeh-Deghani e Brigham [lj.
Observamos que:
•	Para o mesmo At, o esquema explícito produz um erro de truncamento menor que o do esquema implícito. Tal fato pode ser constatado nas figuras 10,1 e 10.2, que correspondem à malha 10x10 e Ai — 2 dias. Uma possível explicação é que, no esquema explícito, os erros de truncamento no espaço e no tempo podem se compensar, como mostramos no capítulo 3.
•	As figuras 10.3 e 10.4 mostram os resultados obtidos com a malha 15x15 e Aí = 0,5 dias, A melhor resposta foi obtida com o método TVD de terceira ordem e região TVD de Sweby.
•	Na situação do item anterior, para o método TVD de terceira ordem, o número médio de iterações Newtonianas por passo de tempo foi aproximadamente 3, apesar da matriz Jacobiana estar incorreta por não considerar as derivadas do limitador TVD em relação às concentrações.
•	A figura 10.5 mostra o efeito do erro de truncamento no tempo para o esquema implícito e método TVD de terceira ordem. Notamos que o erro de truncamento diminui quando reduzimos At.
CASO 2 - Efeito da adsorção
Para analisar o efeito da adsorção reversível, consideramos os mesmos dados de reservatório do caso anterior. As concentrações normalizadas de traçador no efluente versus volume injetado são apresentadas na figura 10.6. Na definição da adsorção através da isoterma de Langmuir utilizamos a = 0,2 e h — 0,0. Vemos que o efeito da adsorção é atrasar a chegada do traçador no poço produtor e também reduzir a concentração de pico.
CONC. NORMALIZADA DE TRACADOR	CONC. NORMALIZADA DE TRACADOR
Figura 10.1: Traçador em 2D, Caso 1.
0.20
0.15
0.10
0.05
0.00
O.ÒO
COMPARACAO DE SOLUCOES ~ TRACADOR EM 2D SIMULACAO COM MODELO OLEO-AGUA, COM SW = 1 MALHA 10 X 10, DT = 2 DIAS
MÉTODO TVD DE TERC. ORDEM /
---- SOL. ANALÍTICA ----explicito ----IMPLÍCITO
SWEBY
TTrrrrTTT-rrxTTTTTTTTTTfrr!
0.30	0.60	0.90
VOLUME POROSO INJETADO (fracao)
Figura 10.2: Traçador em 2D, Caso 1.
COMPARACAO DE SOLUCOES - TRACADOR EM 2D - EXPLICITO SIMULACAO COM MODELO OLEO-AGUA COM SW
MALHA 15 X 15. DT «= 0.5 DIAS
CONC. NORMALIZADA DE TRACADOR	CONC, NORMALIZADA DE TRACADOR
O.2O
-
0.15
---- SOL. ANALITICA
---- 1 PONTO A MONTANTE ----TVD RUBIN/BLUNT
TVD TERC. ORO. / SWEBY
SWEBY
0.60	0.90
VOLUME POROSO INJETADO (fracoo)
VOLUME POROSO INJETADO (frocao)
Figura 10.3: Traçador em 2D, Caso 1.
COMPARACAO DE SOLUCOES - TRACADOR EM 2D - IMPLICITO SIMULACAO COM MODELO OLEO-AGUA, COM SW « 1
MALHA 15 X 15, DT = 0.5 DIAS
-	SOL. ANALITICA
-	1 PONTO A MONTANTE TVD RUBIN/BLUNT TVO TERC. ORD. /
Figura 10.4: Traçador em 2D, Caso 1.
VOLUME POROSO INJETADO (fracoo)
CONC. NORMALIZADA DE TRAÇADOR	_	C0NC- NORMALIZADA DE TRACAOOR
0.20
0.15 -
COMPARACAO DE SOLUCOES - TRAÇADOR EM 20 - IMPLICITO SIMULACAO COM MODELO OLEO-AGUA. COM SW TRUNCAMENTO NO TEMPO, MALHA 10X10 METODO TVD DE TERC. ORDEM / SWEBY
SOL. ANALITICA
DT -	2 DÍAS
0.2 DIAS
Figura 10.5: Traçador em 2D, Caso 1.
TRAÇADOR EM 20 - EFEITO DA ADSORCAO
SIMULACAO COM MODELO OLEO-AGUA. COM SW = 1
MALHA 15 X 15, DT « 0.5 DIAS
METODO TVD DE TERC. ORDEM / SWEBY
---- SOL. ANALITICA SEM ADSORCAO
.... SEM ADSORCAO
----COM ADSORCAO (20* )
0.10
0.05 -
mrmi m &gt;i 1111 H irrmrYfínníí iiiin'itTrniTnn 11 t n i| n mn-rrrrrri
0.30	0.60	0.90	1.20	1.50
VOLUME POROSO INJETADO (frocao)
CASO 3 - Injeção de traçador em reservatório estratificado
Consideramos uma seção transversal em um reservatório estratificado com três camadas, A camada da base (3) tem permeabilidade 0,9869pm2(1000mD), enquanto as outras duas têm permeabilidade 0,5921^m2(600mD). A injeção de água é feita nas três camadas, em um extremo da seção, enquanto a produção ocorre no extremo oposto, também nas três camadas.
Os dados de reservatório utilizados são apresentados na tabela 10.1.
Pressão inicial
Saturação inicial de água
Espessura Comprimento
Largura
Porosidade
Vazão de óleo inicial Pressão mínima de fundo Vazão de injeção inicial Pressão máxima de injeção
20682 kPa (3000 psi)
0,30
6,10 m (20 ft)
50 m (164,05 /t)
0,25
159,00 Sm3/d(1000 STB/d)
6894 kPa (1000 pai)
159,00 SrrP/d (1000 STB/d)
41364 kPa (6000 psi)
Tabela 10.1: Dados de reservatório. Caso 3.
No modelo de simulação óleo-água utilizamos o esquema semi-implícito, método TVD de terceira ordem e At máximo 0,5 dias. A equação do traçador foi resolvida em cada passo de tempo com o esquema explícito e método TVD de terceira ordem. A injeção do traçador nas três camadas foi iniciada em T —10 dias. Utilizamos um banco de traçador de tamanho igual a 2% do volume poroso. Durante a injeção do traçador reduzimos o At para 0,05 dias, para conseguir resolução na aferição do volume injetado.
As curvas de permeabilidades relativas utilizadas foram linhas retas com saturações residuais nulas e valor máximo unitário. Bo e Bw foram considerados constantes e iguais a 1 rrP/Sm3. A viscosidade da água foi fixada em 0,5 mPa.s e a do óleo em 1,0 mPa.s,
Para o traçador consideramos a¡ ~ 0,152 m (0.50 Jt). A concentração de injeção foi fixada em 1,0, um valor de referência. Não consideramos adsorção. As concentrações no efluente não foram normalizadas.
Simulamos três situações, a saber :
a)	kz = 0 pm2, a¡ — 0,152 m,e ott — 0,0 m,
b)	kz = 0,0493 pm2 (50 mD), ~ 0,152 m, e at — 0,0 m.
c)	kz ~ 0,0493 pm2 (50 mO), a¡ — 0,152 m, e at — 0,0305 m.
Os resultados obtidos para a concentração de traçador e vazão de água no efluente são apresentados nas figuras 10.7 a 10.12.
Verificamos que:
«Na situação (a) (figuras 10.7 e 10.8), como não há comunicação vertical nem dispersividade transversal, as vazões de água e concentrações de traçador são iguais nas camadas 1 e 2, que têm as mesmas propriedades. A concentração global no efluente é a média das concentrações nas camadas ponderadas com as respectivas vazões de água. O perfil da concentração global mostra 2 picos; o primeiro pico corresponde à chegada do traçador na camada 3, e o segundo à chegada nas camadas 1 e 2.
•	As figuras 10.9 e 10.10 mostram os resultados para a situação (b) . Podemos ver que a vazão de água na camada 3 (base) é bem maior que no caso anterior, pois a comunicação vertical entre as camadas permite a segregação dos fluidos. Como a dispersividade transversal é nula, as concentrações de traçador são praticamente iguais nas camadas 1 e 2. Quando analisamos a concentração no efluente observamos que o primeiro pico é mais alto que no caso anterior e o segundo pico é mais baixo. Isso ocorre porque a vazão de água na camada 3 é mais alta e pesa mais na ponderação das concentrações de traçador nas camadas.
•	A figura 10.11 apresenta os resultados para a situação (c) . O comportamento das vazões de água é o mesmo da situação (b) . A dispersividade transversal, agora não nula, faz com que a camada central absorva traçador das camadas 1 e 3. A consequência é que, na curva de concentração global, o segundo pico, que ocorria pela chegada simultânea do traçador nas camadas 1 e 2, deixa de existir.
•	A figura 10.12 compara o comportamento da concentração global no efluente para as três situações. Com base na análise acima, podemos concluir que, conhecida uma resposta de campo, alguns parâmetros de reservatório e do traçador podem ser ajustados para que se consiga reproduzir o comportamento através da simulação.
CASO 4 - Direção preferencial de permeabilidades
Nesse caso consideramos geometria “five-spot” com malha paralela, isto é, 2 poços injetores (II e 12) e dois produtores (PI e P2) nas bordas da malha (vide figura (3.1)). Os dados de reservatório utilizados nesse caso são praticamente os mesmos dos testes do capítulo 8. Para o traçador consideramos ai = 0,201 m (0,66 fi) e cq — 0,003 m (0,01 /t). Comparamos o caso de reservatório homogêneo, com kx ~ kv — 0,197 pm2 (200 mD), com outro caso em que kT — 0,197 pm2 (200 mD) e ky — 0,0987 (im2 (100 mD). Injetamos 2 traçadores diferentes, um no poço II e outro no poço 12, e monitoramos a saída em um dos poços produtores, por exemplo, Pl. Para cada
0.25
se £ z? c¡
| 0.20
TESTE COM TRAÇADOR - SECAS VERTICAL - 3 CAMADAS CONCENTRACAO DE TRAÇADOR NO POCO PRODUTOR ' KZ - O mD, ALFAL PULSO DE 0.02 VP
« 0.5 «. ALFA! 0 ft DISTRIBUIDO ÑAS 3 CAMADAS
1000 mD (CAMADA 31
600 mD (CAMADA 2
600 mD (CAMADA 1] CAMADA 3 (BASE) CAMADA 2
CAMADA 1 (TOPO) MEDIA PONO. COM OW
0.40
i i &amp;lt;i*r	i i ¡ r i i i r ¡ íVffirfTTrTTrpTrrrrrrrrrTTTTrTTT
0.60	0.80	1.00	1.20	1.40	1.60
VOLUME POROSO INJETADO (frocoo)
Figura 10.7: Traçador em 2D, Caso 3A.
100.00
TESTE COM TRAÇADOR - SECAO VERTICAL - 3 CAMADAS VAZA0 DE AGUA NO POCO PRODUTOR
KZ ■= O mD
80.00 ¿
CAMADA CAMADA CAMADA
3 (BASE)
2
1 (TOPO)
f
60.00

UJ o
o
§


40,00


20.00
0.00
0.40
T^-rTTnrTTTTTTTTTT-rTTTT^rvTT-TTTTTTTTmrTTTT-rn-innrrTTTTTTT^rTrTTrrT"
0.60	0.80	1.00	1.20	1.40	1.60
VOLUME POROSO INJETADO (fracoo)
Figura 10.8: Traçador em 2D, Caso 3A.
TESTE COM TRAÇADOR - SECAD VERTICAL - 3 CAMADAS CONCENTRACAO DE TRAÇADOR NO POCO PRODUTOR
K7 = 50 mD, ALFAL = 0.5 1t, ALFA! = O ft
PULSO DE 0.02 VP DISTRIBUIDO ÑAS 3 CAMADAS
j rn-n-i! ! i
VOLUME POROSO INJETADO (Oocnn)
KX - 1000 mD (CAMADA 3)
KX -	600	mD (CAMADA 2)
KX =	600	mD (CAMADA 1)
.... CAMADA 3 (HAOF)
--- CAMADA 2
•••*■• CAMADA 1 (TOPO) ---- MEDIA PONO. COM OW

Figura 10.9: Traçador em 2D, Caso 3B.
100.00 T-
80.00
TESTE COM TRAÇADOR - SECAD VERTICAL - 3 CAMADAS VAZAO DE AGUA KZ = 50 mD
.... CAMADA
- -- CAMADA
..... CAMADA
NO POCO PRODUTOR
(BASE)
(TOPO)
60.00
£5
&lt;
UJ a
o
&lt;
40.00
20.00
£
t
3
2
1

.yT.),„r,)..„|,.tyry1, i ri i i t i i ( i i i 11 11 i i ¡ 1 1 &gt; 1 &gt; rt'TT’ri &gt; i i i i i » i i ! iTm"
0.60	0.80	1.0D	1.20	1.40	1.60
PULSO DE 0.02 VP
3
2
1
TESTE COM TRAÇADOR ~ SECAO VERTICAL ~ 3 CAMADAS CONCENTRACAO DE TRACADOR NO POCO PRODUTOR
KZ = 50 mD. ALFAL * 0.5 ft. ALFAT = 0.1 ft
PULSO DE 0.02 VP DISTRIBUÍDO NAS 3 CAMADAS
ft ft ft
* 0.5 ft,
- 0.5 ft, = 0.5 ft.
DISTRIBUIDO ÑAS ALFAL ALFAL ALFAL
revi i i i t i i i i H n-rni ; i &gt; | &gt; i r &gt; i i i ! » | i iTTT-rrr-r -rmrr t ' i
0.60	0-80	1.00	1,20	1.40	1.60
VOLUME POROSO INJETADO (frocoo)
3 CAMADAS
ALFAT « 0.0
ALFAT = 0.0
ALFAT = 0.1
CONO. PE TRACADOR NO POCO PRODUTOR	CONC. DE TRACADOR NO POCO PRODUTOR
KX - 1000 mD (CAMADA
KX «	600	mD	(CAMADA
KX *	600	mD	(CAMADA
---- CAMADA 3 (BASE) ---- CAMADA 2
• • • •. CAMADA 1 (TOPO) ----- MEDIA PONO. COM OW
VOLUME POROSO INJETADO (frocoo)
Figura 10.11: Traçador em 2D, Caso 3C.
TESTE COM TRACADOR - SECAD VERTICAL - 3 CAMADAS CONCENTRACAO DE TRACADOR NO POCO PRODUTOR PULSO DE 0.02 VP ’ ”	 ““
—— KZ •= O mD, "** XZ = 50 mD,
KZ = 50 mD.
Figura 10.12: Traçador em 2D, Caso 3.
traçador consideramos urn pulso de 2% do volume poroso e concentração unitaria. A direção x , de permeabilidade mais alta, é definida pela linha que une os poços II e Pl.
Observando a figura 10.13, vemos que o traçador injetado em II chegou antes no poço Pie com maior concentração de pico, conforme esperávamos. Um teste de campo em um reservatório desse tipo, permite identificar a direção preferencial de permeabilidades.
CASO 5 - “Fíve-Spot” invertido
Nesse caso consideramos quatro poços injetores nas bordas do reservatório, e um poço produtor no centro. As demais propriedades sao as mesmas dos testes realizados no capítulo 8. Em cada poço injetor, i njetamos um pulso de traçador igual a 2% do volume poroso, com concentração unitária. Os quadrantes do reservatório têm permeabilidades distintas: 50 mD na região do poço II, 100 mD na região do poço 12, 150 mD na região do poço 13 e 200 mD na região do poço 14. Na figura 10.14 podemos observar que os tempos de chegada dos traçadores no poço produtor, bem como as concentrações de pico, estão de acordo com a distribuição de permeabilidades.
U7
ALFAL - 0.66 ft, ALFAT - 0.01 ft
VOLUME POROSO INJETADO (fracao)
CONC. DE TRACADOR NO POCO PRODUTOR	CONC. DE TRACADOR NO POCO PRODUTOR
TESTE COM TRACADOR - F!V£-SPOT - MALHA PARALELA CONCENTRACAO DE TRACADOR NO POCO P1
TRACADORES INJETADOS NOS POCOS 11 E 12 PULSO DE
----- CASO oaoon CASO 44444 CASO
0.02
COM COM COM
VP PARA CADA TRACADOR
KX-200mD, KY-2D0mD, TRACADOR II OU 12 KX-200mD, KY~100mD. TRACADOR 11
KX = 200mD. KY=T0OmD, TRACADOR I2
Figura 10.13: Traçador em 2D, Caso 4.
POCO POCO POCO POCO
11
12
13
14
NO
NO
NO
NO
= 0.66 ft, ALFAT « 0.01 ft
0 o
*	ó t&gt;
*	4„°
*	4 J?
1.20 1.60
VOLUME POROSO INJETADO (fracao)
TESTE COM TRACADOR - FIVE-SPOT INVERTIDO CONCENTRACAO DE TRACADOR NO POCO P1 TRACADORES INJETADOS NOS POCOS 11,12, 13 E 14 PULSO DE 0.02 VP PARA CADA TRACADOR ooooo TRACADOR DDODD TRACADOR 40044 TRACADOR
»** TRACADOR
INJETADO INJETADO INJETADO INJETADO
ALFAL
Figura 10.14: Traçador em 2D, Caso 5.
11	CONCLUSÕES
Dentre as principais conclusões obtidas ao longo desse trabalho, algumas merecem destaque, a saber:
•	As soluções numéricas obtidas aplicando-se o método de ponderação a montante para discretizar o termo convectivo em equações de conservação obedecem ao princípio da entropia e, portanto, são fisicamente corretas. Em contrapartida, apresentam grandes erros de dispersão numérica, que praticamente inviabilizam a correta interpretação dos resultados para os diversos problemas de engenharia de reservatórios. Para que a dispersão numérica seja controlada, devem ser empregadas malhas muito refinadas, o que exige alocação de grandes áreas de memória e enormes tempos de processamento nos computadores atuais.
•	Grande parte do efeito de orientação de malha pode ser atribuída à dispersão numérica, que não é rotacionalmente invariante.
•	Os métodos exponenciais de Patankar e Alien-Figueiredo [33],[15] produzem resultados razoáveis quando o termo de transporte difusivo é dominante na equação de conservação. No entanto, quando o fluxo é muito convectivo esses métodos se reduzem ao método de ponderação a montante, apresentando dispersão numérica elevada.
•	Os métodos de diferenças finitas de ordem mais alta, como o método de Leonard [26),[41],[17], Leonard modificado e outros, reduzem a dispersão numérica e fornecem soluções consistentes quando os níveis de dispersão física são suficientemente grandes para estabilizar a solução numérica. Entretanto, quando o fluxo é muito convectivo e a equação de conservação assume forma hiperbólica, soluções fracas fisicamente incorretas podem ser produzidas. Embora os autores acima referenciados tenham observado esse fato, a explicação matemática correta, associada à não obediência ao princípio da entropia, não foi apresentada.
•	Os esquemas de Redução das Variações Totais (TVD) possuem a notável propriedade de produzir soluções numéricas de alta resolução que obedecem ao princípio da entropia, e que , portanto, são fisicamente corretas. Foram analisados os métodos TVD propostos por Rubin e Blunt [40], [50] e TVD de terceira ordem [18], [27]. Demonstramos que a região TVD ampliada proposta por Liu [27] não deve ser empregada. Deduzimos as expressões dos métodos TVD para qualquer situação de fluxo e para malhas não-uniformes.
•	A análise dos métodos numéricos quanto à obediência aos princípios matemáticos de Rankine-Hugoniot e entropia foi feita através da solução numérica de equações não
lineares clássicas, como as propostas por Burgers [7], Harten et alii [19] e Buckley-Leverett. Ao que nos consta, é a primeira vez que essa análise é feita na área de engenharia de reservatórios,
♦	Os diversos métodos de diferenças finitas estudados foram empregados para resolver as equações da convecção-difusão e Buckley-Leverett em 1D. Foram utilizadas formulações explícita, implícita e Crank-Nicolson. Para o caso linear, deduzimos as expressões dos limites de estabilidade utilizando o método de Von-Neumann, e estas foram verificadas com exemplos numéricos. As soluções numéricas foram comparadas com soluções semi-analíticas. Os melhores resultados foram obtidos com os métodos TVD de Rubin e Blunt [40] e de terceira ordem com limitador de Sweby.
*	Analisamos a solução numérica do deslocamento de um traçador em fluxo bidimensional monofásico e geometria ’’five-spot”. Os resultados foram comparados com a solução semi-analítica de Abbaszadeh-Deghani e Brigham [1]. As melhores respostas foram conseguidas com o método TVD de terceira ordem com região TVD de Sweby. Para o exemplo analisado, os resultados obtidos com o TVD de terceira ordem com uma malha 15x15 foram equivalentes àqueles conseguidos com o método de ponderação a montante e malha 150x150 nós. Nesse mesmo exemplo mostramos que a redução da dispersão numérica, conseguida com o método de ordem mais alta, reduz muito o efeito de orientação de malha.
•	Os métodos TVD de Rubin e Blunt [40] para o fluxo total, conforme a proposta original dos autores, bem como uma modificação, onde aplicamos somente às permeabilidades relativas, e o método TVD de terceira ordem com região de Sweby foram implantados no simulador de reservatórios bifásico (óleo-água) e bidimensional desenvolvido por Cruz [13]. Foram utilizadas as formulações IMPES, semi-implícita e totalmente implícita.. No caso totalmente implícito os métodos TVD foram testados com 3 opções: correções só nas funções de resíduo, correções avaliadas no passo de tempo anterior e limitador TVD avaliado no passo de tempo anterior. Com esse procedimento evitamos alterar a forma penta-di agonal blocada da matriz Jacobiana. Caso as derivadas do limitador TVD fossem também incluídas na matriz, essa passaria a ter 9 diagonais e largura de banda 2NX, para numeração na direção X. Na primeira opção implantada no esquema, implícito houve, conforme esperávamos, um aumento do número médio de iterações por passo de tempo em relação ao método de ponderação a montante. Nas outras duas opções esse número permaneceu praticamente o mesmo do método de ponderação a montante. Os melhores resultados, em termos de número de iterações por passo de tempo e precisão da resposta, foram obtidos com o TVD de terceira ordem e região de Sweby.
•	Para o caso óleo-água 2D, as soluções de referência foram determinadas de duas formas distintas: solução com o método tradicional e malha refinada e solução semi-analítica com base nas idéias de Le Blanc e Caudle. Nesse último caso desen
volvemos um programa de computador que permite gerar a solução para o deslocamento óleo-água incompressível em qualquer geometria. As soluções obtidas com os métodos TVD foram comparadas com essas soluções de referência. Na literatura, só encontramos comparações com as soluções obtidas com malha refinada.
•	Realizamos testes para casos bi-dímensionais horizontais e em seção vertical, com reservatórios homogêneos e heterogêneos. Em todos os casos os métodos TVD apresentaram bons resultados, produzindo soluções com boa resolução com malhas razoavelmente grosseiras. O efeito de orientação de malha foi também muito reduzido com a aplicação dos métodos TVD.
•	Introduzimos a opção de vários traçadores na fase água no modelo de simulação óleo-água. Consideramos os citados métodos TVD em esquemas explícito e implícito, tensor dispersão completo e adsorçao do traçador na rocha. O controle da dispersão numérica, conseguido com os métodos TVD, permite que o simulador numérico seja utilizado para interpretar testes de injeção de traçadores. Trata-se de uma evolução em relação ao procedimento tradicional de interpretação, que utiliza modelos de linhas de fluxo; esses modelos, além de considerarem diversas simplificações, não permitem simular a dispersão transversal dos traçadores.
•	Utilizamos o modelo para simular vários casos de injeção de traçadores em reservatórios de petróleo lavados pela água injetada. Mostramos a influencia de alguns parâmetros do reservatório e dos traçadores sobre o aspecto das curvas de concentração no efuente.
12	RECOMENDAÇÕES
Com base nos diversos tópicos discutidos ao longo desse trabalho, recomendamos ;
•	Utilizar as subrotinas aqui desenvolvidas para implantar os esquemas TVD em um simulador comercial de reservatórios, trifásico e tridimensional. Considerar esquemas IMPES, semi-implícito e totalmente implícito.
•	Analisar e propor formas alternativas de implantar os métodos TVD no esquema totalmente implícito, preservando a forma da matriz Jacobiana. Comparar os resultados em termos de precisão e número de iterações necessárias para convergencia em cada passo de tempo.
•	Utilizar as subrotinas aqui desenvolvidas para implantar a opção de traçadores em um simulador comercial de reservatórios. Considerar, aiém dos fenómenos físicos aqui estudados, a partição do traçador entre as fases e também o decaimento radioativo.
•	Implantar os termos de dispersão hidrodinâmica e difusão molecular era um simulador composicional de reservatórios. Para aproximar as permeabilidades e as concentrações nas interfaces dos blocos, usar os métodos TVD. Iniciar com esquema tipo IMPES e evoluir para esquema totalmente implícito. Utilizar o modelo para investigar o fenômeno da difusão do gás na zona de óleo, e o efeito desse mecanismo sobre a recuperação do óleo.
•	Estudar métodos alternativos de solução numérica, tal como o método das características com TVD,
« Utilizar a metodologia de validação e as comparações apresentadas nesse trabalho para avaliar outros métodos numéricos eventualmente propostos para solução de equações de conservação.
Referências
[1]	Abbaszadeh, D.M. and Brigham, W.E. , “Analysis of Well-to-Well Tracer Flow to Determine Reservoir Layering”, JPT, (october 1984), 1753-1762.
[2]	Agca, C., Pope, G,A. and Sepehrnoori, K., “Modelling and Analysis of Tracer Flow in Oil Reservoirs”, Journal of Petroleum Science and Engineering, Vol. 4 (1990), 3-19.
[3]	Allen, D.N. de G. and Southwell, R.V., “Relaxation Methods Applied to Determine the Motion, in Two Dimensions, of a Viscous Fluid past a Fixed Cylinder”, The Quarterly Journal of Mechanics and Applied Mathematics, Vol. VIII, (1955).
[4]	Allen, D.N. de G., “A Suggested Approach to Finite- Difference Representation of Differential Equations with an Application to Determine Temperature Distributions near a Sliding Contact”, The Quarterly Journal of Mechanics and Applied Mathematics, Vol. XV, (1962).
[5]	Allison, S.B., Pope, G.A. and Sepehrnoori, K., “Analysis of Field Tracers for Reservoir Description”, Journal of Petroleum Science and Engineering, (february 1991), 173-186.
[6]	Aziz, K. and Settari, A., “Petroleum Reservoir Simulation”, Applied Science Publishers, England, (1979).
[7]	Burgers, J.M., “A Mathematical Model Illustrating the Theory of Turbulence”, Adv. Appl. Meeh., Vol. 1, (1948), 171-179.
[8]	Chang, Y.B., Pope, G.A. and Sepehrnoori, K., “A Higher-Order Finite-Difference Compositional Simulator”, Journal of Petroleum Science and Engineering, 5 (1990), 35-50.
[9]	Chang, Y.B., “Development and Application of an Equation of State Compositional Simulator”, PhD Thesis, University of Texas at Austin, U.S.A, (august 1990)
[10]	Chaudhari, N.M., “An Improved Numerical Technique for Solving Multidimensional Miscible Displacement Equations”, SPE Journal, (september 1971), 277-284.
[11]	Corrêa, A.C.F., Pande, K.K., Ramey, H.J. and Brigham, W.E., “Computation and Interpretation of Miscible Displacement Performance in Heterogeneous Porous Media”, SPE Reservoir Engineering, (february 1990), 69-78.
[12]	Crump, K.S., “Numerical Inversion of Laplace Transforms Using a Fourier Series Approximation”, Journal of ACM, (January, 1976), Vol. 23, No. 1, 89-96.
[13]	Cruz, P.S.., Análise Crítica dos Métodos de Mudança de Escala Aplicados à Simulação de Reservatórios, Tese de Mestrado, UNICAMP, Sao Paulo, Brasil, (novembro, 1991).
[14]	Farlow, S.J., “Partial*Differential Equations for Scientists and Engineers”, Ed. lEdey, (1982).
[15]	Figueiredo, J.R., “Finite*Difference Scheme for Transport in Radial Flow”, Relatório Interno, UNICAMP, São Paulo, Brasil, (1990).
[16]	Gupta, A.D., Pope, G.A., Sepehrnoori, K. and Thrasher, R.L., “A Symmetric, Positive Definite Formulation of a Three-Dimensional Micellar/Polymer Simulator”, SPE Reservoir Engineering, (november 1986).
[17]	Gupta, A.D., “Accurate Resolution of Physical Dispersion in The Multidimensional Numerical Modelling of Miscible and Chemical Displacement”, SPE Reservoir Engineering, (november 1990), 581-588.
[18]	Gupta, D. and King, M.J., “High Resolution Monotonic Schemes for Reservoir Fluid Flow Simulation”, Submitted to In Situ, (1990).
[19]	Harten, A., Hyman, J.M. and Lax, P.D., “On Finite- Difference Approximations and Entropy Conditions for Schocks”, Communications on Pure and Applied Mathematics, Vd. XXIX, (1976), 297-322.
[20]	Harten, A., Lax, P.D. and Van Leer, B., “On Upstream Differencing and Godunov-type Schemes for Hyperbolic Conservation laws”, SIAM Review, vol. 25, n. 1, (January 1983).
[21]	Higgins, R.V. and Leighton, A.J., “A Computer Method to Calculate Two-Phase Flow in any Irregularly Bounded Porous Medium”, JPT, (June 1962), 679-683.
[22]	Lake, L.W., Pope, G.A., Carey, F. and Sepehrnoori, K., “Isothermal, Multiphase, Multicomponent Fluid Flow in Permeable Media - Parts I and II”, In Situ, Vol. 8, n. 1, (1984), 1-97.
[23]	Lake, L.W., “Enhanced Oil Recovery”, Prenctice-Hall Inc., New Jersey, U.S.A. (1989).
[24]	LeBlanc, J.L. and Caudle, B.H., “A Streamline Model for Secondary Recovery”, SPE Journal, (march 1971), 7-12.
[25]	Lemos, W.P., Projeto e Interpretação quantitativa de testes com traçadores, Relatório Interno, CENPES, PETROBRÁS, (abril 1990).
[26]	Leonard, B.P., “A Survey of Finite Differences of Opinion on Numerical Muddling of the Incomprehensible Defective Confusion Equation”, in “Finite Element Methods for Convection Dominated Flows’7, ASME, New York City, (1979), 1-17.
[27]	Liu, J., “Analysis oí Reservoir Simulation Techniques for Enhanced Oil Recovery, Part II - Improved Difference Scheme for Reservoir Simulation1’, Internal Seminar, University of Texas at Austin, (1991).
[28]	Masukawa, J. and Horne, R.N., “Application of the Boundary Integral Method to Immiscible Displacement Problems”, SPE Reservoir Engineering, (august 1988), 1069-1077.
[29]	Muskat, M., “The Flow of Homogeneous Fluids Through Porous Media”, International Human Resources Development Corporation, Boston, (1982), 585-587.
[30]	Oleinik, 0. A., “Discontinuous solutions of non-linear differential equations”, Amer, Math. Soo. Transí. Series, Vol. 2, n. 26, (1957), 95-171.
[31]	Osher, S.O. and Sweby, P.K., “Recent Developments in the Numerical Solution of Nonlinear Conservation Laws”, The State of the Art in Numerical Analysis, Claredon Press, Oxford, (1987), 681-701.
[32]	Osher, S.O. and Chakravarthy, S., “High Resolution Schemes and the Entropy Condition”, SIAM Journal of Numerical Analysis, Vol. 21, n. 5, (october 1984), 955-984,
[33]	Patankar, S.V, , “Numerical Heat Transfer and Fluid Flow”, Hemisphere Publishing Co., U.S.A., (1980).
[34]	Peaceman, D.W., “Fundamentals of Numerical Reservoir Simulation”, Elsevier Scientific Publishing Co., U.S.A., (1977).
[35]	Peaceman, D.W., “Interpretation of Well-Block Pressures in Numerical Reservoir Simulation”,SPE Journal, (june 1978), 183-194.
[36]	Pope, G.A., Hong, C.H., Sepehrnoori, K. and Lake, L.W., “Two Dimensional Numerical Simulation of Chemical Flooding”, SPE paper n. 9939, (1981).
[37]	Rodríguez, F., “A General Approach of Reservoir Simulation Methods”, Notas de aula. Curso de Simulação de Reservatórios, UNICAMP, (1990).
[38]	Le Roux, A.Y., “ A numerical conception of entropy for quasi-linear equations”, Math. Comput., Vol. 31, (1977), 848-872.
[39]	Romeu, R.K., Um Método Direto para Cálculo dos Fatores de Forma em Malhas de Fluxo, Boletim Técnico da Petrobras, Vol. 28, n. 1, (janeiro/março 1985), 17-26.
[40]	Rubin, B. and Blunt, M.J., “Higher-Order Implicit Flux Limiting Schemes for Black-Oil Simulation”, SPE paper n. S132S, (february 1991),
[41]	Saad, N., Pope, G.A. and Sepehrnoori, K., “Application of Higher-Order Methods in Compositional Simulation”, SPE Reservoir Engineering (november 1990), 623-630.
[42]	San tos, R.L.A., Estudo de Injeção de Trabadores em Meios Porosos Através do Método de Diferenças Finitas com Discretização Exponencial, Tese de Mestrado, UNICAMP, São Paulo, Brasil, (novembro, 1990).
[43]	Sethi an, J. A., Chorin, A. J. and Concns, P., “Numerical Solution of the Buckley-Leverett equations”, SPE paper n, 12254, (november 1983).
[44]	Sod, G.A., “Numerical Methods in Fluid Dynamics: Initial and Initial-Boundary-Value Problems”, Cambridge University Press, Cambridge (1985).
[45]	Stehfest, H., “Numerical Inversion of Laplace Transforms”, Communication of ACM, (january, 1970), 47-49.
[46]	Sweby, P.K., “High Resolution Schemes Using Flux Limiters for Hyperbolic Conservation Laws”, SIAM Journal of Numerical Analysis, Vol. 21, n. 5, (october 1984).
[47]	Taggart, I.J. and Pinczewski, W.V., “The Use of Higher-Order Differencing Techniques in Reservoir Simulation”, SPE Reservoir Engineering, (august 1987), 360-372.
[48]	“The Mathematics of Reservoir Simulation”, Edited by Ewing, R.E. - SIAM - Philadelphia, U.S.A. (1983).
[49]	Todd, M.R., O’Dell, P.M. and Hírasaki, G.J., “Methods for Increased Accuracy in Numerical Reservoir Simulators”, SPE Journal, (december 1972),515-530.
[50]	Van Leer, B., “Towards the Ultimate Conservative Difference Scheme, II - Monotonicity and Conservation Combined in a Second Order Scheme”, Journal of Comp. Physics, 14, (1974), 361-370.
[51]	Van-Qui, N, and Labrid, J., “A Numerical Study of Chemical Flooding - Comparison with Experiments”, SPE Journal, (june 1983), 461-474.
13 APÊNDICES
A SOLUÇÃO DA EQUAÇÃO DE CONSERVAÇÃO POR SEPARAÇÃO DE VARIÁVEIS
Seja o problema:
du
dt^a dx* ’
(A.l)
com condições de contorno homogêneas e :
u(a;, 0) =	.
Usando separação de variáveis, escrevemos:
u(z,í)=X(z)T(í) .
Resolvendo-se a equação, obtem-se:
(A.3)
u(z,¿) ~ ^ane~ínra)\en(mr;r) , n=l
onde:
(A.4)
—
2 í	•
JO
(A.5)
Seja então a equação da convecção-difusão:
da _ 2d2u du dt Q dx2 y dx
(A.6)
Utilizamos a transformação :
para obter :
du&gt; 2 dT = OÍ d^ '
Como u&gt;(x, t) é dado por (A,4), temos:
OG
u(x, t) ==	.	(A.9)
n=0
Note que o2 é o coeficiente do termo difusivo. Observamos então, que o termo gUe aparece no somatório, tende a amortecer a amplitude dos termos da série. 0 amortecimento é tanto maior quanto maiores a frequência (maior n) e o coeficiente a,
Quando a equação de conservação assume forma hiperbólica, não há amortecimento dos harmônicos da série.
B ANÁLISE DE ESTABILIDADE, EQUAÇÃO DA CONVECÇÃO - DIFUSÃO LINEAR, 1D, MÉTODO 1 PONTO A MONTANTE, EXPLÍCITO
A equação da convecção - difusão linear, 1D, na sua forma adimensional é:
dxD Pe dxl dln	'	'
Doravante omitiremos os índices de adimensionalização por simplificação. A discretização do termo convectivo por um ponto a montante e do termo difusivo com aproximação central, resulta, para o esquema explícito, em:
&lt;7 -&amp;lt;7-, _ J_ /CTn-zcr + tT-a , c,”+1-&lt;7 _.	m ,,
Ax Pe \	Ax2	) Al	[	1
Peaceman [34] mostra que o erro entre a solução correta da equação diferencial e a solução numérica pode ser escrito através de uma expansão em série de Fourier:
• (B-3)
A análise de estabilidade é feita substituindo-se um termo da série (B.3) em (B.2). 0 esquema será estável se o fator de amplificação [7”+11 / (7” j for menor que 1. Esse critério é conhecido como critério de Von Neumann [34].
Aplicando-se tal método, segue que:
_ 27»e^ + +
1
Ax
jpíAx
JL 6v«+l_Á&gt;íA® _ jpi&amp;amp;3!
(B.4)
Dividindo-se por 7"e^lAa; , resulta:
Como:
eJipAz: ~ cos	jsen	cosQ 4- jsenO
temos que:
(cMe - 1) - ~ +
ou:
(co3l&gt; ~15	+£)+¿ - hisen0 = 1
At 7;	’
ou:
n (	2	1 \ Aj , At . ñ 7»+1
2sen3- I -7-7-7 + 7— ) At + 1 — -r—jáent? = ——
2 \PeAz2 Az/	Az	7”
Tomando-se o módulo e impondo a condição de estabilidade, segue que;
ip
/yíl
lp 4-4aen4|^
n ,	2# Í 2	1 \ A ,
= 1-4“',ã(JÍÃ?+ÃÍ)At+
-Ci + X-) A/2 + ^~2Ser&gt;1^ - 1 ’ PeAz2 Az/	Az2
(B.5)
(B.6)
(B.7)
(B.8)
(B.9)

1 7p+1 At 7;
1
(B.10)
ou então:
4“”25 (p¿J5 + ¿) Ai 2 4s“‘í (p¿7 +	A&lt;2 + ^sm2e ■ (B!1)
Como senÔ — 2sen~cos| , vem:
Dividindo-se por 4&amp;amp;tsen2^ , segue que:
Ai
x *	0
j Ai + Ateos2-01&amp;lt;
)]
2
~ + Ai Pe
2
Pe +
&amp;lt;J^ + Aí
(B.13)
(B.14)
(B.15)
(B,16)
&lt;
í
?
1
Para que a restrição sobre Ai seja mais forte, o termo entre colchetes deve assumir um valor máximo. Logo, cos20 deve assumir um valor mínimo, ou seja: cos20 = 0.
Assim, temos que:
S(è+Al) ■
(B.17)
ou, finalmente:
At&amp;lt;
Ax2
(pí
(B.18)
Convem notar que, nas equações acima. Aí e At são grandezas adimensionais. No caso particular do fluxo convectivo, resulta a conhecida relação &amp;lt;1 . Para fluxo muito difusivo (Pe muito baixo), a restrição sobre At é bastante severa.
C O MÉTODO DE ALLEN-FIGUEIREDO
O método de Allen-Figueiredo [15] para discretização será apresentado utilizando- se como exemplo a equação da convecção - difusão linear, em 1D.
A equação da convecção - difusão linear, 1D, adimensional, é escrita como:
ÔC dC 1 d2C dt + dx Pe dx2
ou:
dt ~~ Fe dx2 dx"^'
r
onde os indices foram omitidos por simplificação.
(Cd)
(C.2)
Admitindo-se o termo transiente como localmente constante e uniforme, vem:
Pedx2 dx ° '	(L"3'
A equação característica homogênea associada é:
A_r2 ;■ = 0-r - 0.. ou r = /''(■: .
Assim, a solução da homogênea é : Cj-Jx) = Ai + A2ePe;r .
A solução particular é : Cp(x) ~ B^x .
Substituindo-se em (C.3), segue Bi ~ —Ko .
A solução completa de (C.3) é, portanto:
C(x) = Ai ~ Kgx 4- A2ep£X .	(CA)
Precisamos agora obter as constantes Kq, Ai e A2 .
Aplicando-se a equação aos pontos nodais adjacentes:
í C,'-i = Ai — KqXí-i + A2eFe;c”"3
¿ Ci = Ai - KoZi + A2ep-‘
t Cí4-i = Aj —	+ Aae^^1*3
e definindo-se:
resulta:
C,'-i = Ai —	+ A^n,-!
Ct = A¡ — KqXí + A^n^
Cí+i ~ Ai —	+ Ajn1+i
Resolvendo-se o sistema acima, vem:

(Cj - Ci_i)(ni - ni+l) - (Cj - Ct-n)(n,- - n&gt;_i) (-Xi +	- ni+i) - (—37, + Zi+i^Tli - Tlf-J
Definimos também:
pi = (~xí + z,_i)(jií - n,+J) - (-zt- + rrí+1)(ní - n^i) ,
»i+i ~ rij
Pi
Assim, Ko — A (Cí_i — Cf) — A+(C, ~	, ou:
Ko = A~Ci^ - (A+ + A-JCí A A+Chi , que corresponde à discretizaçao dos termos de ñuxo.
No caso de malha regular,
xt — (i — l)Az ,
Pi = -Az (ePeSí - ePe*¿+3) - Az (ePe^ ™ e^"1) =
= -AzeFe(1^1)Ar (1 - ZeAl) - Aze^í’”1^1 (1 - e"FeA*) , donde resulta:
çPei&amp;amp;x ___ gFe(t-~l)A«:
eFe(»-l)Ax	— gfeAz^ _ Az(l —
j _ gPeZka
Az(2 - epe¿ÍX - e-í’^j ~ 	1	 Az (1 +______________“
1
Az(l — e-Peàl)
(C.6)
(C.7)
(C.8)
(C.9)
(C.W)
(CAI)
Analogamente, obtemos:
Lembrando que:
Ao = A Ct„i ~ (j4+ 4- A )Ci 4“ A+C,-+i ,	(C.14)
podemos tentar escrever Ko de forma semelhante ao tradicional esquema de discretizaçâo (ponderação a montante no termo convectivo):
Ao = d(U“2C + U) + W-C-i) = = aCí+i 4- (e — b)C-t-i *4* (~2g 4" è)Ci ,
(CJ.5)
Igualando-se (C.14) e (C.15), segue que:
a — A+ ,
a — b ----- A~ —» è = A4* — A~ ,
e a terceira equação deve ser verificada:
(C.16)
(C.17)
Assim, substituindo-se (C.16) e (C.17) em (C.15), vem:
Ao = A* (CU - 2Ci + CU) + (A* - A~) (Cí - CU) .
(C.18)
Mas:
1
1
A Az(epe&lt;ix - 1) Ax(l - e~p^x) Az ’
(C.19)
e portanto:
Desta forma, a equação da convecção - difusão:
9C ÔC 1 ¿PC
dt + dx ~~ Pe dx* “ ° ’
quando discretizada pelo método tradicional de ponderação a montante, fica:
I ZQ+1-2C? + C,’‘_,
Pe \ A.t2
(C.21)
e quando discretizada pelo método de Allen-Figueiredo, fica:
cr+1 - c? cr - c?_i _ /	\ (c^-zcr+c?^
At	Ax \e.Fe¿kE —1/ \ Ax2
Assim, comparando-se (C.21) com (C.22) uma importante conclusão pode ser obtida:
“Se o fluxo é muito convectivo (Peclet alto), o método de Allen-Figueiredo tende para o método tradicional de ponderação a montante.”
Naturalmente, essa é uma grande limitação do método.
D O MÉTODO DE PATANKAR
Será apresentado tomando se como exemplo a equação da convecção - difusão linear, em 1D:
dC_ I	dC
dx Pe dz2	dl
onde os índices foram omitidos por simplificação.
A solução para o regime permanente é:
(D.l)
C(z) = Aj + Á2ep^ .
(D.2)
As condições de contorno a seguir são utilizadas na determinação dos coeficientes:
x = 0, C — Cq —&gt; Aj + A2 — Co ,	(D.3)
x = I, C - CL - Ar + A2ZeL = CL .	(DA)
Substituindo-se em (D.2), vem:
A	~
1 ep^ - 1
, A2 ~
Cl-Cq
ePeL — 1
De (D.2) e (D.3), temos que:
C-CQ = A2(eFe*-l) ,
C-CL - /12	- Co - A2	1)
Assim,
C~~CQ ep™ - 1
CL - CQ ~ ep&gt;L - 1
Chamando-se de J o fluxo total, tal que:
(D.6)
J = C-
Pe ôx
7
(D.7)
o termo de fluxo total pode ser obtido pela discretização central:
dJ „ ^¿+1/2 ~~ dx	Az
A partir de (D.6), segue cjue:
C d£ dx
(párr) •
(D.8)
(D.9)
Substituindo-se em (D.7), vem:
J =
Cq +
Cq-Cl ePeL _ J
/	_ i \
Co+tCi-cy
Assim,
di+l/2
z-r , Q ^0'4-1
C ■ Ci~* " Ci 0,-1 epe&amp;amp;x - 1 ’
Logo:
dj	Ji-ti/2 ~~ Ji~l¡2 	 Q — C\	i-i f?»+i SC,- + Ci-i	
dx	Ax	Az	Az(e^-l) ’	
dJ	Ci - C,..}	Ax	/ o-j-i — 2Ci + Cí_! \	/n 7íA
dx	Az	(ep^ - 1)	\	Az2	) '	JL* * X V J
Comparando-se (D.10) e (C.22), pode-se concluir que:
“Quando se utiliza malha uniforme para resolver numericamente a equação da difusão - convecção linear, o método de Patankar é idêntico ao método de Allen-Figueiredo/
E ANÁLISE DE ESTABILIDADE, EQUAÇÃO DA CONVECÇÃO - DIFUSÃO LINEAR, 1D, MÉTODO DE ALLEN-FIGUEIREDO, EXPLÍCITO
A análise da estabilidade é semelhante à apresentada no apêndice B. Já vimos que a equação da convecção - difusão linear, 1D, discretízada pelo método de Allen-Figueiredo, no esquema explícito, fica:
¿7^-2^+^ 2 (çn Ct\)~2(Cr+í CQ '
Ax (ePeàjt _
(E.l)
ou:
ou:
Aplicando-se o método de Von Neumann, segue que:
gjplúl
Az ^ePe^x — 1)
_ 2 4- e-’pÁX) -	(1 - e~ipAz) =
1
A í p,a, , A (2cospAz - 2) - ” (1 - cosp&amp;amp;x + jsenp&amp;amp;x) ~
3.x	— 1)	¿iz
1
Fazendo-se A = ~ , 0 ~ pAz e a = epeAar , vem:
2A
-vn+1	fí ( ?A	\
— = -2aen2- í ....... 4- A) - jXsenO + 1
7?	2 \a -1	/
A condição de estabilidade exige que

&amp;lt;1 Assim,
(E.2)
(E.3)
(E.4)
(E.5)
ou:
ou ainda:
1 — 2Xsen2-
0 /a 4
ztih" £1 ’
1 - 4Asen2^	+ 4A2sen4~ f 'j 4- X2sen20 &amp;lt;1 ,
2 \o - 1/	2 Xa - 1/	"
(E.6)
(E.7)
..	2^ (&amp;amp; d~ A j\2	4$/Ct4~lX2	2&amp;lt;yô nG
-4Asen 2 tr)+4A sm 2 tr)+ 4A 3en ros 2s ° •
DÍvidÍndo-se por 4Asen2| , resulta:
&gt;
&gt;
&lt;
A 14aen2~
, ou:
1 4- sen2-
(E.9)
(E.10)
(E.ll)
O limite mais restrito para At ocorre quando o denominador é máximo. Como a „ eFeAr &gt; temos que:
í a 4 1X - r.
tr) -1 &gt;0 ■
Logo, o denominador é máximo quando sen2| = 1 .
Assim, resulta que:
A&amp;lt;
o: — 1
Ct 4 1
(E.12)
(E.13)
7
ou seja:
(E.14)
Quando o fluxo é muito convectivo, (Pe —» oo) , obtemos a já conhecida relação At &amp;lt;Aít. Tal resultado é coerente, pois sabemos que o método de Allen-Figueiredo tende para o método 1 ponto a montante quando Pe —+ oo .
Podemos demonstrar que o limite de estabilidade para o método de Allen-Figueiredo é maior que para o método de ponderação a montante. Ou seja, queremos mostrar que:
Supondo-se válida a desigualdade acima:
- 1	&amp;amp;x
^*+1 A^sh + l) ’
e simplificando-se, resulta que:
ePeÁT ~ 1 &gt; Peãx .
Ora, aproximando-se por série de Taylor,
Logo,
eFeãx „ j _ Pe&amp;amp;x _p	PeAx .
Ou seja, a desigualdade (E.14) é válida, e o limite de estabilidade do método de Allen*Figueiredo é maior que o limite de estabilidade do método de ponderação a montante. Tal resultado pode também ser observado na figura 4,1.
F O METODO DE SAAD-LEONARD
A descrição do método será feita utilizando-se a equação da convecção - difusão linear em ID, com os índices de adimensionalizaçao omitidos:
dC dC 1 d2C
di. dx Pe dx2
(F.l)
F.l Aproximação para o termo convectivo
Trataremos da discretização do termo convectivo. 0 método sugerido por Leonard [26] e adaptado por Saad et alii [41] consiste na aproximação de terceira ordem para .
Para obter essa expressão, utilizamos as expansões em série de Tayior, admitindo fluxo no sentido ¿ — 1 —&gt; i —»• i + 1 :
(F.2)
(F.3)
~ Ci- 2AxC'i + 2Az2C'f - ~Ax3Cf + f Ax4C/v .
(F.4)
Tomando-se (F.2) — (F.3) , segue que:

(F.5)
Considerando-se (F.2) x 4 — (F.4), vem:
4C1+1 - G„2 - 3C; + GAxC] + 2&amp;amp;x3C”' -
(F.6)
Combinando-se (F.5) com (F.6) , resulta:
6Ax
12
(F.7)
Escrevendo-se:
_ ¿Q‘4-1/2 — Cj-l/2
&gt; ~~	A ~
Ax
(F.8)
segue que:
(F.9)
(F.W)
Quando o fluxo se dá no sentido contrário, resulta:
2Ci^ - 3Ci + 6Cí+t - C+2
6As
(F.ll)
Nesse caso,
r&gt;(.SL)	_ Ir,	i	t
°í+l/2	—	”gU&gt;+2 -t gt,+i + ~C,	,
__	1 z-f	,	/i { 1
^i-1/2	~	gC-í+i +	+ J1'-1	‘
(F.12)
(F.13)
Conforme veremos a seguir, o método de Saad-Leonard pode ser expresso como combinação dos métodos de 2 pontos a montante e central.
F/2 Método de Saad-Leonard Escrito em Função dos Métodos de Dois Pontos a Montante e Central
a) O método de dois pontos a montante [49]
Admitindo-se fluxo no sentido í — 1 —»■ í —» i + 1, segue:
a., = ci-A.c;+^c”-^c;” + ^c''' + ... , C,„2 ~ Ci~ 2ãxC- + 2Ax2C" - I A^C"’ + | A:r4C/v + ,..
3	3
(F.14)
(F.15)
Tomando-se (F.14) x 4 — (F.15) , vem:
4(7^ - Ci_2 ~ 3Ci - 2ãxC'i + I Ax3C'" - ~Az4C7v .
Assim,

3Cj —	-f- Cj„2
2&amp;amp;x
Escrevendo-se C- =	, segue que:
r(2PM)

r(W) ~
'“’i+l/2	~
(F.16)
(F.17)
(F.18)
b)	Método Central de Aproximação
Do desenvolvimento em série de Taylor segue que:
Cí+i
Ci-r
Combinando-se as equações acima,
Assim,
(F.19)
(F.20)
(F.21)
Combinando-se (F.16) com (F.19) , vem:
cc i to
r'íc) _l	- Ci+1 ~g,~1 lA?rw i
C‘ + 3Cí _ 3Ax 9^+
3c -	+ i 2 »_ i &amp;amp;x3c,v
9	*	12	*

ou seja,
2Ci+1 + 3Cí - 60^ + C¡_2
1 p'(2FAÍ)
3 ’
Assim,
(2PAf)
(F.23)
Segue naturalmente que:
r(SL)	_ 2 (c)	l-fSFM)
^&lt;+1/2 ~ g^i+l/a + '“'*4-1/2	’
~ 2HC) L i^PM) Ui-l/2 -	^^-1/2 + gUí-l/2
(F.24)
(F.25)
F.3 O Método de Saad-Leonard para Malhas Não Uniformes
De acordo com Saad et alii [41], uma grande limitação de alguns métodos de diferenças finitas, como o método de Chaudhari [10], é a exigência de malhas uniformes.
As seguintes equações são apresentadas por Saad para malhas não uniformes:
Para fluxo no sentido i — 1—* í —h + 1 ,
CfffA = C + yíCi-G-il + ^fC^-G) ,	(F.26)
C%}2 “ c_, +	-C_2)+ ^.(C,-C^) ;	(F.27)
e, para fluxo no sentido t + 1 —H —*¿—1 ,
(F.28)
(F.29)
onde:
a,
/3i
Am,
Ax,- + Ax{_i ’
&amp;amp;Xi
Axj + Axí+i
(F.30)
(F.31)
Estas mesmas relações para malhas não-uniformes foram utilizadas por Chang [9] em sua tese de doutorado. Embora não tenham demonstrado, Saad et alii [41] comentam que as equações acima são aproximações e reduzem a precisão do método para segunda ordem no espaço. A seguir demonstraremos essa consideração.
Para fluxo no sentido í — 1 —&gt; i —+ i + 1 e malha uniforme, temos:
C‘+'v’2 = - jC.-! + |cf + |ci+, ,
ou:
0*$, = c. + | (C,- - C._,) + 1 (Ci+, - C,-) ,
ou ainda;
(F.32)
Quando a malha é uniforme, sabemos que (F.32) conduz a um método de terceira ordem no espaço. Quando usamos (F.32) para malhas não uniformes, teremos, evidentemente, uma aproximação de segunda ordem.
Discretizando-se as derivadas, resulta que:
r(SL) - r &amp;amp;Xi
1	(Cj-Ci-A 2 / ci+y - cA
= Ci + ^(Cf-Ci-1) + ^(C’1+&gt;-C'() ,
que é a equação proposta por Saad et alii.
(F.33)
A mesma expressão poderia ser obtida considerando-se válida para malhas não-uniformes a relação:
Uf+l/2 — 3U&gt;+l/2	'
Concluímos então que a aplicação das equações (F.26) e (F.29) para malhas não-uniformes reduz a precisão do método para segunda ordem no espaço. Mesmo assim, os resultados obtidos por Saad et alii [41] aplicando o método para malhas não-uniformes, foram bem melhores que os obtidos com métodos de ordem mais baixa.
Expressões mais precisas para o caso de malhas não-uniformes são bem mais complicadas, e são apresentadas por Gupta [17].
F.4 O Método de Gupta-Leonard
O método de Saad-Leonard para discretização do fluxo convectivo pode considerar até 5 pontos quando o fluxo é unidimensional. Quando o fluxo é bi-dimensional
pode exigir até 9 pontos.
Portanto a aplicação desse método em um esquema implícito pode adicionar até 2 diagonais na matriz jacobiaiia, quando o fluxo é unidimensional, e até 4 diagonais quando o fluxo é bidimensional.
Por esse motivo, Saad et alii [41] e Gupta [17] descrevem aplicações do método apenas para esquemas explícitos. Um problema decorrente desse esquema é a condido-nalidade da estabilidade.
O método de Gupta [17] consiste em introduzir uma correção no método de Saad-Leonard de forma a torná-lo mais estável. Em seu artigo, Gupta não apresenta a dedução do método.
A equação da convecção - difusão sem o termo difusivo, em sua forma dimensional, é escrita como:
= 0 .
(F.34)
Chamando-se de v a velocidade intersticial,
fc dt
(F.35)
Já vimos que, para fluxo no sentido i — 1 —&gt; i i + 1 , resulta:
~ 3C'i+l/2	,
si(2PM) ___
'-'i+1/2	~ i}1''*	2V’~1 "
Introduzindo-se o seguinte termo corretivo em	:
A (Ci-\ — Ci\ v&amp;amp;t _ (dC\ vAí
AC¿í „ —
e comparando-se com a equação (F.35), segue que;
(F.36)
ACq Cf+1/2 ~ Cr -
Portanto, ao adicionarmos ACq a	estamos, na prática, avaliando
no tempo (n +1/2), e não em (n).
Da mesma forma, para C^y2, definimos a correção AC,q como:
AC,a=	Cí4-M«Aí
\ A.t 7 2
(F.37)
mos, na prática, avaliando C^/2 num tempo intermediário (n + 1/2), e não em (n).
Para auxiliar a análise da estabilidade, definimos o número de Courant
(F.38)
De imediato concluímos que o número de Courant é uma medida do grau de
estabilidade do esquema explícito. Quanto menor o número de Courant, mais estável o esquema.
Substituindo-se (F.38) em (F.36) e (F.37) e aplicando-se as correções, segue
que:
(F.39)
(F.40)
Substituindo-se na equação (F.24), resulta que:
+ ^(C« + CM-2C.) .
(F.42)
De (F.41) e (F.42) segue que;
6As
(F.43)
A avaliação do termo convectivo usando (F.43) é, evidentemente, uma apro-
ximação; quando o fluxo é convectivo, corresponde a uma avaliação no tempo (n + 1/2). Quando o termo difusivo é não nulo, a equação de conservação não é hiperbólica e a dedução acima não é válida; portanto, nesses casos, (F.43) não deveria, a rigor, ser empregada.
A correção para o tempo (n+1/2), introduzida por Gupta [17] deve se refletir como aumento da estabilidade do esquema explícito.
G O MÉTODO DE LEONARD MODIFICADO
Conhecendo-se o método de Leonard [26], [41], [17], uma idéía natural é modífi-cá-lo5 considerando-se todos os pontos envolvidos na discretização do termo convectivo a montante do fluxo.
Considerando-se fluxo no sentido i — 1 —* i i +1 e útil izan do-se expansão em série de Taylor, segue:
c.., = c, - Áxc; + ^-c" - ~c'“ +	,
= C&amp;lt;- 2ÁxC; + 4^-C" - |Aac“ + ~^C¡V , c,._3 = c¡ - 3Atc’ + a^c" - jAx’c"' + ¿jAeca.
(G.l)
(G.2)
(G.3)
Fazendo-se (G.l) x 4 — (G.2), vem:
4CU - G-2 - 3Cí - 2^x0- + t\z3C"‘ - ~Ax4C!v .	(G.4)
6	24
Tomando-se (G.l) x 9 — (G.3), segue que:
- G„3 - SC,- - 6AxC- +	.	(G.5)
O	út i
Combinando-se (G.4) com (G.5) para eliminar C{ , vem:

—2C.--3 4" 9Cí_2 — IStji—i + 11C,
6Arr
Escrevendo-se C- —	} resulta que:
Gí+1/2
O
i(2Ci_3-7Ci_2 + HC;_1) .
O
(G-7)
(G.8)
Neste trabalho estaremos tratando o método acima como método de Leonard modificado.
H ESQUEMAS DE SEGUNDA ORDEM NO TEMPO
Conforme já vimos, vários esquemas de ordem mais alta têm sido propostos para a discretizaçao do termo convectivo. Taggart et alii [47] comentam o método de Leith ou Lax - Wendroff, que considera uma discretização de segunda ordem no termo de acumulação.
Podemos partir da equação da convecção - difusão em sua forma dimensional, considerando nulo o termo difusivo (F.35):
dC dC dt + V dx
(H.l)
0 .
Sabemos que:
(H.2)
Utilizando-se (H.l) , segue que:
02C d2C fíC
âí2 - “^dxdt ~ V dx2
(H.3)
Substituindo-se em (H.2), obtem-se:
dc cr+1 - Cf dt ~ Aí
ÇL
Ai
Aí 2&amp;amp;C
2 V dx2
-	(C?+&gt; - 2C" + C?.,) .
Substituindo-se (H.4) em (H.l) , resulta que:
+ ...
Assim,
^r2
Q+1 - cr - Nca (cr ~ C^) +	(c?+1 - 2Cr + C?_1) ,	(H.5)
Notamos que a discretização de segunda ordem no tempo introduz um termo difusivo que não estava presente na equação original. Assim, a solução obtida com esse método deve apresentar uma tendência mais dissipativa.
Em termos estritos, o esquema acima não pode ser empregado quando existe dispersão física, uma vez que foi deduzido admitindo-se a forma hiperbólica da equação de conservação.
I ANÁLISE DE ESTABILIDADE, EQUAÇÃO DA CONVECÇÃO - DIFUSÃO LINEAR, 1D, MÉTODO DE SAAD-LEONARD, EXPLÍCITO
Inicialmente analisaremos a equação da convecção-difusão em sua forma hiperbólica, ou seja, sem o termo difusivo. A díscretização com o método de Saad-Leonard fornece, para o esquema explícito:
Ai
(I.l)
Pelo método de Von Neumann,
Desenvolvendo-se, segue que:
&gt;yTl+l	I r
7p	6 1
onde A ~ Aí/Ax (número de Courant).
A parte real é dada por :
lp
(1.2)
(1.3)
À	2A
1 — — [3 — 4cos# + cos2i?] = 1 —~ [cas# — l]2 .
Â parte imaginária é dada por :
A	2A
— - [8sen0 — sen2$] “ ——senff [4 — casÚ] .
Tomando-se o módulo do número complexo e aplicando-se a condição de estabilidade, segue que:
~ 1 +
2
~	- lf +
” [coa# — l]2 + —~sen20 [4 — co3&amp;amp;]2 &amp;lt;1 . 6	36
Desenvolvendo-se, resulta que:
6 [cas# - l]2
(1.4)
[(cos&amp;amp; — l)4 + sen2£(4 — costf)2]
O valor mínimo do lado direito de (1.4) é zero, obtido quando 0 ~ 0. Portanto, se Pe —&gt; oo, o limite de estabilidade é À &amp;lt;0, ou seja, o método de Saad-Leonard explícito não é estável quando o fluxo é totalmete convectivo.
Considerando-se a equação completa e aplicando o método de Von Neumann, segue que:
¿K-6^'+3+^1 +
(1.5)
Definindo-se o número de Peclet celular,
P&amp;amp;CEL. = pe&amp;amp;x ,
e substituindo-se na equação (1.5), resulta que:
(1.6)
A parte real é dada por :
9 \	91
1---— (cos&amp;amp; — l)2 + —.... (co$0	— 1) =
6	P^CEL.
1
6
PecEL..
A parte imaginária é expressa por :
2À
—sen§ [4 — cas#] .
Tomando-se o módulo, vem:
„,T¡+1 íp	2 = 1 — 4A (cosO — 1)	(cosO — 1)	1
xytl Jp		6	PzCEL._
n2
1
+
+
Desenvolvendo-se, resulta que:
-1) - ^1
(«*« ~ 1)’ [í“"fzU _ _J_]2 +	[4 _ cosíf
(1-8)
Com a expressão acima, obtemos os limites de estabilidade do método de Saad-Leonard para o esquema explícito, apresentados na tabela 1.1.
l/P^CEL.	PeCEL.	^MAX.
0,00	oo	0,000
0,10	10,00	0,200
0,20	5,00	0,400
0,30	3,33	0,600
0,35	2,86	0,698
0,40	2,50	0,681
0,50	2,00	0,600
0,60	1,67	0,536
0,70	1,43	0,484
0,80	1,25	0,441
0,90	1,11	0,405
1,00	1,00	0,375
Tabela 1.1: Limites de estabilidade. Método de Saad-Leonard explícito.
J CRITÉRIOS PARA UM ESQUEMA DE DISCRETIZAÇÃO SER TVD
Aqui reproduzimos a demonstração apresentada por Harten [20] e Rubin e
Blunt [40]. Consideremos a equação de Buckley-Leverett, na forma adimensional:
dS df di + dx
0 .
(J.l)
Podemos admitir um esquema parciaimente implícito de discretização para calcular o perfil de saturações:
- S? -C^AS^ + D?AS” - CT-VA5JLV + D?+1AS7+1 ,	(J.2)
onde: A5(-_i — Si — 5i_i e AS, = S,+i — Si .
Os coeficientes Ci e Di dependem do esquema de discretização utilizado.
A variação total é definida como:
TV” = £|AS”| .	(J.3)
t
Reescrevendo-se (J.2) para o nó i + 1, vem:
“ ^+1 = ~C?AS? + P?+1A5f+1 ~ C?+1AS?+1 + D^ASff .	(J.4)
Fazendo-se (J.4) — (J.2) , vem:
AS?*1 ~ AS? ~ - C?+1AS?*l + C?*?AS?*? +
~ C”ASf-LC^AS^-F
„ D”+1 AS'"+1 +	+
- D?AS? + P?+1 A5^ .	(J.5)
Rearranj ando-se, resulta:
(i + c”+1 + An+1)	= (i-c?-n?)A5r +
+ C?*1 A5?+’ +	AST_j +
+ D^AS^, .	(J.6)
Supondo-se Q &gt; 0 , D” &gt; 0 , C?+} &gt; 0 , D*+1 &gt; 0 e 1 &gt; Cf + D? &gt; 0 , os coeficientes de (J.6) são todos positivos e a desigualdade triangular pode ser aplicada.
(l+C(n+1+D"4-1)|ASr+1| &amp;lt;(1 - Cf- D?) JA57| + C(n-Y |a^_?| 4
+ ^1|A^1| +&amp;lt;i1|A5r+Y| +
+	.	(J.7)
Somando-se ambos os lados de (J.7) para todas as células da malha e lembrando que:
ECdAS^EC^lAS^I ,
»	*
j	t
resulta que:
E|a5?+,|&amp;lt;eiasti .	(J-s)
t	í
ou seja: 7Vn+1 &amp;lt;TVa .
Demonstramos então que um esquema de discretizaçao definido por (J.2) é TVD se:
CÇ &gt; 0 , Df &gt;Q , C’t+1 &gt; 0, D?*1 &gt;0 el&gt;Cr + Dr&gt;0 .	(J.9)
K APLICAÇÃO DOS CRITÉRIOS TVD PARA UMA EQUAÇÃO DE CONSERVAÇÃO. LIMITADORES DE FLUXO.
Nesse apêndice deduzimos, com base nas equações apresentadas no apêndice anterior, as restrições que devem ser impostas sobre os limitadores de fluxo para que o esquema final seja TVD. Consideramos malhas uniformes e não-uniformes. Apresentamos uma análise crítica de alguns limitadores de fluxo propostos na literatura.
K.l Aplicação do Critério TVD para Malhas Uniformes
Vamos partir da equação de Buckley-Leverett adimensional:
98 , df
= 0 .
(K.l)
Podemos escrever, em termos de diferenças finitas;
(K.2)
Definindo-se:
	A = At/Ax ,	(K.3)
vem:		
(s?« - S?) = -A (1 - «) (J?+1,2 - Fí,l2) - A« (eSÇ -	■	(K.4)
Mas, pela aproximação proposta por Harten et alii [20], considerando-se fluxo no sentido ¿—I i —* i + 1, segue que:
n+./2 = í;+Ç(Fi+.-n) •	(K.5)
Substituindo-se em (K.4) chega-se a:
A (1 ~ 0) (/f - F*_i) - M - F^) +
v ~ ^”) + A^h (! “	- F*-0
^_v)
(K.6)
Definindo-se a razão entre os fluxos nas interfaces:
j?n _ Pn n __ *i	1
* ~ Z?n _ p.n 1 •* t+1	*1
e a velocidade efetiva ou gradiente de fluxo:
(K.7)
F”1 m
= £í----£k±
' S? - S”„!
a equação (K.6) fica:
(K.8)
e
(1 -0) (1-^v) +(1 -*) — -AvTAStt1 e(1-íV’)+«^Mj
Comparando-se com a equação (J.2), vem:
D”'1 = B? = 0, c^i - Avrki-
2r-lj +
+ 0-^-
(K.9)
1
Aplicando-se os critérios TVD deduzidos no apêndice J, resulta que:

+ 0^
&gt;0 ,
(K.10)
1 &gt; Av?

&gt;0 .
(K.ll)

Esquemas Explícitos (0 = 0)
Ficamos somente com a condição (K.ll) :
Sweby[46] e Rubm e Blunt [40] propõem adotar An” = 1/2^ ou, seja, número de Courant igual a 1/2.
Assim, (K.12) é obedecida quando fixamos:
2
2
&gt;
&gt;
(K.13)
(K.14)
Esquemas implícitos (0 ~ 1)
Ficamos apenas com a condição (K.10) :
Utilizando-se as mesmas restrições (K.13) e (K.14) sobre ç?, a equação (K.15) é obedecida para qualquer número de Courant.
K,2 Critério TVD para Malhas Não Uniformes
Quando a malha não é uniforme, definímos:
&amp;amp;
Az&gt;
Az, +	’
Az; 4* A&amp;amp;í+i
(K.16)
(K.17)
Com base no mesmo procedimento do item anterior, escrevemos, para fluxo no sentido i — 1 —► i —» Í + 1 :
Fí+1/2 = F, +	= F + WÃ (Fi+, - F) ,	(K.18)
2
^í-1/2 ■= Ft^ +	(Fj - Fi-i) .	(K.19)
Da definição de r¿ , temos:
n =
Fj - Ff,i \ a,
F,+1 ~Fi) /3i
Portanto,
Assim:
e também:
Fw/2 = F, + wft .j = F +
ri
ri
(F, - Fh) ,
(K.22)
-éf+i/2 ~ -éi-i/2 — (ñ ~ Pí-i) 1 +
”------^í-
Ff
iÂ-1
(K.23)
Considerando-se o esquema explícito, a equação de conservação fica:
gn-H „ gn
- Ao" (S," - 5“,) [1 -	+ ^ail
r,
(K.24)
Para o esquema acima ser TVD devemos ter:
0 &amp;lt;Au”	+ í^~Lj &amp;lt;1 •	(K.25)
Nos próximos itens abordamos os diversos limitadores propostos na literatura. Não encontramos, nos artigos pesquisados, demontrações e análises cuidadosas como as que apresentamos a seguir.
Por fins de simplicidade, estaremos trabalhando com o esquema explícito de discretização.
K.3 Região TVD de Sweby - Malhas Uniformes
Demonstramos que, para o esquema explícito de di serei izaçâo, com malha uniforme, os limitadores&amp;lt;p devem obedecer às desigualdades:
(K.26)
Já vimos que, quando escolhemos:
0 &amp;lt;p(r) &amp;lt;2 e 0&amp;lt;	&amp;lt;2 ,
r
as desigualdades acima são obedecidas.
Para r &gt; 0 uma escolha óbvia, proposta por Sweby [46] é:
ç»(r) ~ min (2 T 2r) ,
(K.28)
Quando r &amp;lt;0 (fluxo convergente ou divergente), Sweby [46] assume ç? ~ 0, retornando ao esquema de 1 ponto a montante.
Sweby também demonstra que qualquer esquema de discretizaçao de segunda ordem passando pelos pontos (i — 2, i — l,í,í 4-1) deve ser uma média ponderada entre os esquemas de discretizaçâo central e dois pontos a montante, isto é:
¥&gt;(r) = (1 - 0)	+ 0^2P^(r) ,	(K.29)
onde 0 &amp;lt;0 &amp;lt;1.
Partindo-se das equações para	pelos esquemas central e dois pontos a
montante, é fácil provar que:
^ÍQ(r) = 1 ,
(K.30)
(K.31)
Assim,
ou seja,
i
C _ . y(r) ~ 1
r - 1
Como 0 &amp;lt;0 &amp;lt;1, temos:
r &amp;lt;&lt;p(r) &amp;lt;1 , para 0 &amp;lt;r &amp;lt;1 ,
1	£ ¥’(r) C r i para r &gt; 1 .

(K.34)
Portanto, as condições:
■
\
:■
i
&lt;	&amp;lt;2 ,	(K.36)
&lt;	&amp;lt;2 r	(K.37)
&lt;	tp(r)&amp;lt;1, seO&lt;r&lt;l,e	(K.38)
&lt;	9?(r) S D se r &gt; 1 ,	(K.39)
definem a região TVD de Sweby, apresentada na figura KJ.. O limitador de Sweby corresponde ao limite superior dessa região.
K.4 Região TVD de Sweby - Malhas Não Uniformes
Analisaremos as diversas situações de fiuxo.
a)	&gt; 0 e ~ 0
Nesse caso o desenvolvimento é exatamente o mesmo apresentado no item K.2.
Chegamos a:
0 &amp;lt;Avf	&amp;lt;1 .	(K.40)
Com Au" — 1/2, aplicamos o critério de Sweby para obter:
0 &amp;lt;&lt;Pi-i &amp;lt;1/0í-i	~ «li» (^-1 , W~i) ,	(K.41)
0 &amp;lt;— &amp;lt;—- —*■ (¡Pt ™ min f&lt;p* , “'j .	(K.42)
O;	V /

Observações :
♦	, ¥&gt;i são limitadores calculados por algum critério, por exemplo: limitador de Van Leer , limitador de terceira ordem, etc.
♦	No caso analisado, como os fluxos nas interfaces têm o mesmo sentido, r,- &gt; 0.
♦	Se ípi &amp;lt;0 fazemos — 0 .
b)
u*í+i/2 &amp;lt;0 e	&amp;lt;0
Pí+1/2
Fi-l/2
(K.44)
Da definição,
D-i
ÁXi +
Cí-l
(K.45)
Portanto:
r,~i / Oí
(K.46)
Substituindo-se em (K.44) , segue que:
(K.47)
Logo,
a+1/2 - n-,/2 = (Fw - F¡) 1 - V.0..+1 +	'
(K.48)
Aplicando-se o critério de Sweby , resulta que:
0 &amp;lt;&lt;pi&amp;lt;	----»~ min (&lt;p* , l/oi+t) ,
(K.49)
n	i
0 &amp;lt;------&lt;1-4	■=. mm
n-i
Obs.: nesse caso também temos r,„j &gt; 0

C) U^!2 &amp;lt;0 e 0
Repetimos os procedimentos dos itens anteriores e, após um longo desenvolvimento, obtemos:
Vi ~ min (&lt;p;}l/a,+i) , Vi-i ~ min
(K.52)
&lt;i) UEÍ+1/S &gt; 0 e UZi-l/3 &amp;lt;0
Nesse caso, um longo desenvolvimento conduz a:
Vi ~ min , 1/A) ,	(K.53)
&lt;P»-i = min	.	(K.54)
Com as restrições deduzidas nos itens acima definimos a região TVD de Sweby para malhas não-uniformes.
K.5 O Limitador de Van-Leer
O limitador de Van-Leer [50], utilizado por Rubin e Blunt [40] no esquema TVD é definido por:
■ (K-55)
Pela figura K.l podemos observar que o limitador de Van Leer está contido no interior da região de Sweby.
Rubin e Blunt [40] mostram, com base em resultados numéricos, que o uso do limitador de Van Leer produz um esquema TVD de segunda ordem no espaço.
A seguir apresentamos uma interpretação interessante e original do limitador de Van Leer [50].
Se r &gt; 0, temos:
Para o fluxo no sentido i — 1 i i + 1 :
r' ^+i-^ ’
Substituindo-se, vem:
ZjF-F^)
(Fí+l - ^)4- (F¿ - fU) '
Lembramos que, nesse caso, o esquema TVD é escrito como:
Fí+i/2 ~ Fi 4- ¡p,-
~T
Substituindo-se (K.57) em (K.58), vem:
Fi+yi = F&gt; +
Ax
T
2(Fi+l-Fi) (F.-F^)
A4(pi+1 ~ ro “-fU))
(K.59)
Comparando-se (K.59) com a expansão de Fi+y2 em série de Taylor, uma importante conclusão é obtida:
“0 uso do limitador de Van Leer corresponde a utilizar a média harmônica das derivadas de f em i -T 1/2 e i — 1/2 para calcular a derivada de f no nó í.”
Tal conclusão tem um significado físico. No problema de Buckley-Leverett sem pressão capilar, por exemplo, a frente de avanço é abrupta; como a média harmônica tende para o menor valor, na posição da frente a derivada em i é nula, e a aproximação para X‘+i/2 é feita por 1 ponto a montante, evitando assim as oscilações comuns aos métodos de ordens mais alta.
É fácil também demonstrar que o limitador de Van Leer não se altera quando a malha não é uniforme. Vamos utilizar na demonstração o conceito de que o limitador de Van Leer corresponde ao uso de média harmônica para cálculo da derivada no nó i:
Derivada em i — 1/2:
Derivada em i + 1/2:
Média harmônica:
2 __ 2 (Ax,- d~ Ai¿_j) 2	4"
fí ~ ...+
Usando-se as definições:
___	AíE»	Q ___	^X{
Atí + Azí-j ’	1 Axt- + Arri+i
resulta que:
ou:
2	Axí 1	1 Ax,’ 1	1
f; ~ 2 mF-F^ + T^'1+1-f, ’
Â = &amp;amp;x&lt;	1 \P¡Fi+i-Ft ‘
F; 2&amp;amp; (Fi+Í - Fi) [cq Fi - F^ + jJ ’
e, da definição de :
Aaq + ór¡+i Ff Fi^-i  &amp;amp;í Fi Fi_i
Aaq 4- A^t„i F^i — F¿	Pi -^d+i — F¿
segue que:
Â = ÈÍ1______1_____[1,11
f; 2ft (Fi+l - F¡) k + J ■
Assim,
p' ____ »Q (ffi-frl Fjj Tj
*■ “ Pi Az, 1 + n ■
0 esquema TVD para malha nao-uniforme é escrito como:
(K.62)
(K.63)
(K.64)
(K.65)
(K.66)
(K.67)
(K.68)
ou seja:
Pifii
¿^xí/2
Igualando-se (K.69) a (K.67), vem;
2r,
1 + r,
Ou, de forma mais gera! para incluir o trecho com r &amp;lt;0,
Concluímos então que o limitador de Van Leer não se altera quando a malha é não uniforme.
O mesmo resultado é obtido quando o fluxo se dá no sentido contrário (?’ + 1 para ?').
K.6 Limitador de Terceira Ordem
hspace2cm
Nesse item deduziremos a expressão do limitador para o esquema de terceira ordem de discretízação do termo convectivo. Essas idéias foram introduzidas por Gupta e King [18] e por Jianchun Liu [27]. A análise será feita para a malha não uniforme.
Inicialmente consideramos fluxo no sentido i — 1 i ¿4-1.
Com base nas expressões propostas por Saad et adii [41] (vide apêndice F), temos:
a+1/3 = a + (a - a-») +	(a« - a),	(K.72)
a-1/2 = A-i + (Fi-t - n_2) +	(F, - F(_.) .	(K.73)
Da expressão para o método TVÍ),
Fi+1/2 = F, + &amp;amp;&amp;amp; (Fí+1 - F) .	(K.74)
Igualando-se (K.72) e (K.74),
s (F - F-J +	(F(+1 - n) = WA (F,.+1 -F) .
Assim,
Da definição de r¿, (K.20), segue que:
Vi = ~ (2 + r,)
Já havíamos observado que;
pfSL) ___ 2 p(C) 1 p(2í’M)
^i+1/2 “	t ^ri+l/2	•
Como:
(O)	. (2PAf)
= 1 e Vi =n ,
podemos escrever, da mesma forma, que:
^í} = f + |d2™&gt; ■
(K.79)
Se o fluxo se dá no sentido contrário, i + 1 i —»■ i — 1 escrevemos:

-Ci+i/2 = -C+r + Vi
Fi - Fi+Í ~ (¿\%i + Ax¡’+i)
^Fi+1+vtai+1 (Fi-F^}
(K.80)
2
Mas, nesse caso, sabemos que o esquema de terceira ordem (Saad-Leonard) conduz a:
e+1/2 = e+i + (Fi - a+1) + “ (e« - fí+2) .
(K.81)
Igualando-se (K.80) e (K.81), segue que:
(K.82)
Mas, como u®,+1/2 &amp;lt;9, temos:
ri =
Fj+i " Cí42 Fi - Ft+Í
Aaq + Axí+1
Aaq+1 + Axi+2
— Fí+2 Fí - Fi+1
(K.83)
Substituindo-se (K.83) em (K.82), resulta:
Para que o esquema seja TVD, o limitador de terceira ordem deve também ficar contido no interior da região TVD de Sweby (figura K.l).
Jianchun Liu ¡27] propôs uma ampliação na região TVD de Sweby;
Para o método explícito, com malha uniforme, a equação (K.12) mostra as restrições sobre o limitador ¡¿&gt;i para que o esquema de discretízação seja TVD:
0 &amp;lt;Av,n (1 —	q-	J &amp;lt;I . ~	‘ \	2	2r?) ~	(K.85)
Para um número de Courant igual a 1/2, ficamos com:	
1 &amp;lt;+ &amp;lt;1 . - 2 2r„ -	(K.86)
Liu [27] admitiu	— ipi para escrever:	
	(K.87)
Para r &amp;lt;1, a relação acima fica:	
2r	2r 	&amp;lt;üj&amp;lt;	 t 1 — r	1 — r	(K.88)
Para r &gt; 1, temos:	
2r * 	 &amp;lt;o&amp;lt;	. 1 - r ~	™	1-r	(K.89)
A região TVD de Liu , com o limitador de terceira ordem, é apresentada na
figura K.2.
Para conservar o limitador de terceira ordem no interior da região TVD, Liu propôs:
ç?(r) — [sínalfr + 2)] min
2r
1-r ’3
(K.90)
A região TVD de Liu é realmente maior que a região TVD de Sweby, e se estende também na faixa de r &amp;lt;0. A crítica está na simplificação admitida para definir esta região (&amp;lt;pi~i “ pi )■ Dm nossos exemplos práticos demonstramos que essa simplificação não é adequada.
Figura K.l: Região TVD de Sweby.
LIMITADOR DE FLUXO
Figura K.2: Região TVD de Liu.
L SOLUÇÃO SEMI-ANALÍTICA DA EQUAÇÃO DA CONVECÇÃO - DIFUSÃO LINEAR, 1D
Sabemos que a equação da convecção - difusão linear, 1D, pode ser escrita, na sua forma adimensional, como:
dC	9C	1 d2C
dt	dx	Pe dx2
Não estamos usando os índices de adimensionalização por simplificação.
As seguintes condições de contorno serão utilizadas:
Condição inicial:

Condição de contorno interna:
Condição de contorno externa:
Os casos práticos serão analisados para tempos curtos, antes que a frente atinja a fronteira externa. Dessa forma, a condição de contorno externa praticamente não influi no resultado.
Aplicando-se a transformada de Laplace a (L.l), vem:

i d2c
Pe dx2
Como C(xy 0) = 0 , ficamos com:
(L.6)
que é uma equação linear homogênea.
A equação característica associada é:
1 d2C
Pe dx2
1 2
—rz - r ~ 3 = 0 .
Fe
(L.7)
Resolvendo*se, resulta que:
Pe + y/Pé2 4* 4Pes
r&gt; = ------~2	&gt;0’
Pe — y/Pê^F iPes
r2 = ---------------&lt;0.
Assim,
C(x,s) = Aier^ +A2e^ .	(L.8)
Pela condição de contorno interna, C (0, s) = ~.
Assim,
C (0, $) — Aj + A2 =-----------&gt; A2 —-----Ai .
3	s
Pela condição de contorno externa :
C(M) = 0
~+ Aicri A A2eT2 — 0 —&gt; Aien 4*	— Aj^ eP ~ 0
Ai (en - e^) =
1 ™ e(n-r3)
(LJ0)
Substituindo-se em L.9,
1 ( e^~r^ \
3 \1 - efn-nOy
(L.ll)
Assim, obtemos a solução analítica no campo de Laplace. Tentamos fazer a inversão numérica por Stehfest, mas o resultado não foi bom nos casos convectivos (Peclet alto). A inversão pelo método de Crump [12] aperfeiçoado por Corrêa et alii [11] conduziu a resultados bem mais precisos.
M MÉTODO DE ALLEN-FIGUEIREDO PARA SOLUÇÃO DA EQUAÇÃO DE BUCKLEY -LEVERETT
A utilização do método de Allen-Figueiredo [15] para resolver um problema nao-1 inear é complicada. Podemos tomar como exemplo a equação de Buckley-Leverett completa, escrita sem os índices de adimerisionalização:
Para se tentar linearizar os termos de fluxo, a seguinte transformação foi definida:
(M.2)
ou seja,
d# .d$w
Ui = 3(S^
(M.3)
Substituindo-se em (M.l), segue que:
d/m 1 d# 1	1
dSw g(Sw) dx Nm dx2 + $(SW) dt
(M.4)
ou, chamando:
(M.5)
d# g(Sw) d2%
dx NriJÍ dx2 + di
Definindo-se o numero de Peclet local como:
a equação (M.6) fica:
(M.9)
(M.10)
(M.ll)
Admitindo-se fw. e Pe^ como localmente constantes, o método de Allen-Figueiredo pode ser aplicado conforme a descrição do Capítulo 4.
Ao final, chegamos a uma expressão idêntica à obtida no apêndice C para o operador em diferenças finitas:
P.Q = A ’Fj-i —■ Çd + A+^	,
onde:
4- _ ni+l ~ ni x+ = ni" n‘"1
Pi ’	Pi
Tii — e	,
e
Pi ~ (zí-Híii - Zíní+1) - (aií+jn,-.! - zí-jUí-h) + (xíti^ - zí-i^) .	(M.12)
Substituindo-se em (M.8) e usando-se o esquema explícito, resulta que:
= ^ _ /¿(At [A’^ - (A" + A+)$7 + A+S7+1] .	(M.13)
Aplicando-se as equações acima para um caso convectivo (Pe, alto), chegamos, após um longo algebrismo e algumas aproximações a:
que é o próprio método de 1 ponto a montante.
A aplicação do método exige várias interpolações devido à transformação proposta. Os resultados obtidos, de forma geral, não foram bons, e não insistimos com o método.
N
MÉTODO DE PATANKAR PARA SOLUÇÃO DA EQUAÇÃO DE BUCKLEY - LEVERETT
A aplicação desse método para uma equação não-linear é sugerida por Patankar
|33j.
Seguindo as idéias já discutidas no apêndice D, temos, para regime permanente:
(N.l)
ou:
_d_ dx
d sjS^dS* dx l Nrl dx
Definindo-se:
p- ia.
■â. o
(N.2)
segue que:
r =
Nu
FL
r ’
(N.3)
(N.4)
(N.5)
Como a equação original está na forma adimensional, x e L são grandezas adimensionais.
Admitindo-se F e f localmente constantes, e as seguintes condições de contorno:
X -- 0 &gt; SW --- Syfy ,
x ” í/ " Su, —	?
a equação (N.5) é resolvida analiticamente, obtendo-se:
1
onde:
Substituindo-se, a equação (N.6) pode ser escrita como:
“PT“_”r
(N.7)
O fluxo total, dado por:
(N.8)
pode ser obtido utilizando-se (N.7), resultando:
dSw dx
Para o fluxo na interface,
ou seja:
d»4-i/2 —
5
onde:
=
(N.10)
(N.ll)
(N.12)
j ~ fsw ~ r
+
T
_ 1
1
n	NrL (fw\	A „
Í^i+l/Z ~ I Q J	■
&amp;amp;+1/2
Os melhores resultados foram obtidos avaliando (Jw/Sw) a montante nas e-quações acima.
Portanto, para o esquema explícito, escrevemos:
(N.14)
Observação : A aproximação acima é consistente, pois, quando o fluxo é con-
vectivo: J,+1/2=í^
\ow/ i+1y2	V-«’/,■
ou seja, recaímos no método de ponderação a montante.
ANEXOS
As listagens dos programas de computador desenvolvidos ao longo da tese estão disponíveis como anexo à tese na biblioteca do Departamento de Engenharia do Petróleo da UNICAMP. A seguir apresentamos uma breve descrição dos principais programas.
•	BURG01 : Solução numérica da equação de Burgers.
•	HART01 : Solução numérica da equação de Harten et alíi.
•	1DLIN2: Solução semi-analítica e numérica da equação da convecção-difusão linear em 1D.
•	BL09 : Solução semi-analítica e numérica da equação de Buckley-Leverett.
•	2DPRES2 : Gera o campo de pressões para fluxo monofásico permanente em 2D.
•	2DCONC7 : Calcula as concentrações do traçador em fluxo monofásico permanente em 2D.
•	FSPNEW : Solução semi-analítica para o fluxo óleo-água incompressível em 2D, em qualquer geometria, com base na teoria de Higgins e Leighton.
•	BLAN03 : Solução semi-analítica para o fluxo óleo-água incompressível em 2D, em qualquer geometria, com base na teoria de LeBlanc e Caudle.
•	INJET8A : Simulador “black-oil” bifásico, bidimensional, com as várias opções de métodos TVD implantadas nos esquemas IMPES, semi-implícito e totalmente implícito. Estão também implantadas as opções de traçadores na fase água, com TVD, nos esquemas explícito e implícito.</field>
	</doc>
</add>