<?xml version="1.0" encoding="utf-8"?>
<add>
	<doc>
		<field name="docid">BR-TU.06969</field>
		<field name="filename">11585_001094387.pdf</field>
		<field name="filetype">PDF</field>
		<field name="text">UNIVERSIDADE FEDERAL DO RIO GRANDE DO SUL INSTITUTO DE PESQUISAS HIDRÁULICAS PROGRAMA DE PÓS-GRADUAÇÃO EM RECURSOS HÍDRICOS E SANEAMENTO AMBIENTAL
Augusto Hugo Farias da Cunha
Simulação de escoamentos estratificados: esquemas numéricos de alta resolução em modelo acoplado de transporte e hidrodinâmico não-hidrostático
Porto Alegre
Augusto Hugo Farias da Cunha
Simulação de escoamentos estratificados: esquemas numéricos de alta resolução em modelo acoplado de transporte e hidrodinâmico não-hidrostático
Dissertação submetida ao Programa de Pós-Graduação em Recursos Hídricos e Saneamento Ambiental da UFRGS, como quesito parcial para obtenção do título de Mestre em Recursos Hídricos.
Orientador: David da Motta Marques Coorientador: Carlos Ruberto Fragoso Jr.
Porto Alegre
CIP - Catalogação na Publicação
Cunha, Augusto Hugo Farias
Simulação de escoamentos estratificados: esquemas numéricos de alta resolução em modelo acoplado de transporte e hidrodinâmico não-hidrostático / Augusto Hugo Farias Cunha. -- 2019.
86 f.
Orientador: David Manuel L da Motta-Marques.
Coorientador: Carlos Ruberto Fragoso Jr.
Dissertação (Mestrado) -- Universidade Federal do Rio Grande do Sul, Instituto de Pesquisas Hidráulicas, Programa de Pós-Graduação em Recursos Hídricos e Saneamento Ambiental, Porto Alegre, BR-RS, 2019.
1. Difusão Numérica. 2. Limitadores de Fluxo. 3. Pressão Não-Hidrostática. 4. Método Euleriano-Lagrangiano. 5. Interpolação. I. Motta-Marques, David Manuel L da, orient. II. Fragoso Jr, Carlos Ruberto, coorient. III. Título.
Elaborada pelo Sistema de Geração Automática de Ficha Catalográfica da UFRGS com os dados fornecidos pelo(a) autor(a).
Augusto Hugo Farias da Cunha
Simulação de escoamentos estratificados: esquemas numéricos de alta resolução em modelo acoplado de transporte e hidrodinâmico não-hidrostático
Dissertação submetida ao Programa de Pós-Graduação em Recursos Hídricos e Saneamento Ambiental da UFRGS, como quesito parcial para obtenção do título de Mestre em Recursos Hídricos.
Trabalho aprovado. Porto Alegre, 07 de fevereiro de 2019:
David da Motta Marques
Orientador
Carlos Ruberto Fragoso Jr.
Co-orientador
Fernando Mainardi Fan
Examinador (IPH-UFRGS)
Rodrigo Cauduro Dias de Paiva
Examinador (IPH-UFRGS)
Marie-Paule Bonnet
Ezaminadora (IRD)
Porto Alegre
2019
O trabalho dentro de um grupo de pesquisa é de fato um motivador e um acelerador de crescimento pessoal e acadêmico. Neste tipo de convívio é quando se começa a perceber a importância de cada trabalho, não apenas o seu, mas também os dos colegas, dos colaboradores que vieram antes de você e os que ainda virão. A construção acadêmica dentro de um grupo é um processo de longo prazo, que possibilita novos ingressantes alcançarem sempre um degrau a mais. Fico feliz em ter participado deste processo, me sinto parte do grupo, e sinto que o trabalho desenvolvido pertence não só a mim, mas também ao grupo de pesquisa, o que vai além de seus colaboradores atuais. Ditos isto, o primeiro agradecimento é ao Grupo de Pesquisa em Ecotecnologia da UFRGS. Obrigado pelo apoio e investimento.
Em todo trabalho em grupo, há pessoas que marcam o desenvolvimento de sua pesquisa, sem elas o trabalho desenvolvido não seria o mesmo. Agradeço o empenho e o exemplar trabalho de co-orientação e tutoria que o professor Carlos Ruberto Fragoso Jr. exerceu em nosso convívio de co-orientador e orientando. Assim como agradeço ao empenho do professor David da Motta Marques, excelente orientador que me forneceu todo suporte necessário. Sua preocupação com o desenvolvimento do trabalho, e de fornecer as condições apropriadas para tal, foram marcantes em nosso convívio. Agradeço também aos colaboradores Matheus Henrrique Tavares e J. Rafael Cavalcanti. Matheus foi meu contemporâneo da pós-graduação, sua amizade e parceria foram fundamentais em meu desenvolvimento acadêmico, que foi além do presente trabalho. Rafael, para mim, é um dos exemplos que tenho de pesquisador. Apesar do pouco convívio, pude rever e aprender com trabalhos no código do IPH-ECO que foi desenvolvido por ele anteriormente. Agradeço a ajuda e a colaboração para a construção de nossos produtos.
Como todo processo de construção, o primeiro esboço da obra precisa ser lapidado para chegar em seu estágio final. Neste sentido, agradeço aos colaboradores que participarão da revisão do trabalho desenvolvidos, a professora Marie-Paule Bonnet e aos professores Rodrigo C. Dias de Paiva e Fernando Mainardi Fan. O processo de revisão é essencial, e agradeço a experiência, ideias e indicações de todos para construção do produto final.
Ainda no âmbito acadêmico, agradeço a Coordenação de Aperfeiçoamento de Pessoal de Nível Superior (CAPES: http://www.capes.gov.br) e ao Conselho Nacional de
Desenvolvimento Cientifico e Tecnológico (CNPq: http://www.cnpq.br) e a bolsa concedida a mim (número de concessão: 149819/2017-0).
Por fim, e não menos importante, agradeço à minha família, que acredita em minha capacidade e que sempre me dá todo o suporte para que eu continue realizando os meus sonhos. Agradeço ao meu pai, Augusto Cunha, e minha mãe, Célia Farias. Sem eles, ter ido à Porto Alegre iniciar este mestrado e passar pelas dificuldades de cursar 6 meses sem auxílio financeiro, não seria possível.
Em especial, agradeço imensamente a minha esposa Jéssica Gonçalves. Sua compreensão e companheirismo em seguir neste desafio comigo à dois anos atrás foi incrível. Passamos o desafio à distância, mas juntos. No meio desta jornada, casamos e seguimos a encarar ainda mais desafios juntos. Obrigado por todo suporte, revisão de texto, e por toda paciência. Foram fundamentais no desenvolvimento deste trabalho.
Resumo
A dissertação buscou contribuir para o para o entendimento do efeito da difusão numérica nas soluções hidrodinâmica e de transporte de modelos numéricos acoplados (hidrodinâmico e transporte), assim como a relação mútua entre ambas as soluções buscando um método eficiente e conservativo para simulação de escoamentos estratificados. A implementação dos métodos computacionais foram feitas no modelo IPH-ECO, uma ferramenta computacional capaz de simular processos físicos, químicos e biológicos em três dimensões. O trabalho foi dividido em duas partes principais que visam apresentar a melhoria dos métodos numéricos utilizados pelo modelo, assim como a verificação e validação dos métodos implementados (Capítulos 4 5).
A simulação de escoamentos estratificados requer a implementação de métodos numéricos mais robustos, como: como a aproximação não-hidrostática e métodos de alta-resolução (interpolação quadrática e limitadores de fluxo) capazes de reduzir a difusão numérica de maneira conservativa, buscando soluções com melhor representação física de processos, de forma a alcançar resultados satisfatórios com menor custo computacional.
Para solução hidrodinâmica, implementamos a pressão não-hidrostática, onde propomos o uso de uma novação condição de contorno na superfície livre (capítulo 4), e ainda um interpolador quadrático implementado no método Euleriano-Lagrangiano, utilizado na estimativa da velocidade ao fim da linha de corrente (capítulo 5). Para a solução do Transporte de Soluto, esquemas de Limitadores de Fluxo foram implementados (capítulo 5). Utilizamos benchmarks consolidados na literatura puramente advectivos visando identificar o efeito da difusão numérica nas solução do transporte e hidrodinâmica comparando métodos de baixa resolução (interpolação bilinear e esquema Upwmd) com métodos de alta resolução.
O algorítimo foi capaz de simular adequadamente a celeridade e a dispersão de frequência de ondas estacionárias em condição de águas profundas, utilizando uma resolução vertical 2 vezes menor que a condição clássica, consequentemente diminuindo o custo computacional médio de um passo de tempo da simulação em ca. 1.7 vezes, alcançando resultados similares (CBA At = 262 s e FSFS A t = 1 22 s). Este resultado permite que modelos hidrodinâmicos semelhantes melhorem sua solução numérica com um menor custo de implementação, aplicando um tratamento simples,melhorando a performance das simulações não-hidrostáticas.
Os métodos de alta resolução foram capazes de diminuir substancialmente a difusão numérica na solução hidrodinâmica (ca. 10 vezes menor) e de transporte (Erro Relativo e RMSE ca. 3 vezes menor). Os resultados mostraram que a difusão numérica gerada por métodos de baixa resolução na solução hidrodinâmica pode ter grande impacto na solução do transporte, por tanto, para simular com maior precisão situações reais (dinâmica de escoamentos estratificados em reservatórios profundos) o uso combinado de métodos de alta resolução se mostra uma alternativa promissora, com baixo custo de implementação e alta eficiência.
Os métodos implementados neste trabalho permitem que modelos mais difusivos, como o IPH-ECO (Fragoso Jr et al., 2009), passem a considerar a difusão real ao invés da difusão numérica em suas modelagens, e portanto utilizar o coeficiente de difusão como um parâmetro de calibração do modelo.
Palavras-chaves: Difusão Numérica. Pressão Não-Hidrostática. Limitadores de Fluxo. Método Euleriano-Lagrangiano. Interpolação.
Abstract
The dissertation sought to contribute to the understanding of the effect of numerical diffusion in the hydrodynamic and transport solutions of coupled numerical models (hydrodynamic and transport), as well, the mutual relationship between both solutions seeking an efficient and conservative method for simulation of stratified flows. The computational methods was implemented in the IPH-ECO model, computational tool capable of simulating physical, chemical and biological processes in three dimensions. The work was divided in two main parts that aim to the improvement of the numerical methods used by the model, as well as the verification and validation of the implemented methods (Chapters4 5). The simulation of stratified flows requires the implementation of more robust numerical methods, such as: non-hydrostatic approach and high-resolution methods (quadratic interpolation and flux-limiter) capable of conservatively reducing numerical diffusion, searching for solutions that better represented physical processes, in order to achieve satisfactory results with lower computational cost.
For the hydrodynamic solution, we implemented the non-hydrostatic pressure, where we propose the use of a novel boundary condition to the free surface (chapter 4), and a quadratic interpolator implemented in the Eulerian-Lagrangian method, used in the estimation of the velocity at the end of the stream-line (chapter 5). For the Solute Transport solution, flux-limiter schemes have been implemented (chapter 5). We use consolidated benchmarks in purely advective problems to identify the effect of numerical diffusion on the transport and hydrodynamics solutions by comparing low-resolution methods (bilinear interpolation and Upwind scheme) with high-resolution methods.
The algorithm (FSFS) was able to properly simulate the celerity and the dispersion of the frequency of stationary waves in deep water conditions, using a vertical resolution 2 times smaller than the classical condition (CBA), consequently decreasing the average computational cost of a time step of the simulation in ca. 1.7 times, achieving similar results (CBA At = 2.62 s and FSFS At = 1.22 s). This result allows similar hydrodynamic models to improve their numerical solution with a lower cost of implementation, applying a simple treatment, improving the performance of the non-hydrostatic simulations.
The high-resolution methods were able to substantially decrease the numerical diffusion in the hydrodynamic solution (ca. 10 times lower) and transport (Relative Error and RMSE ca. 3 times lower). The results showed that the numerical diffusion generated by low-resolution methods in the hydrodynamic solution may have a substantial impact on
the transport solution, therefore, to simulate more accurately real situations (dynamics of stratified flows in deep reservoirs) the combined use of high resolution is a promising alternative, with low implementation cost and high efficiency.
The methods implemented in this work allow more diffusive models, such as IPH-ECO (Fragoso Jr et al., 2009), to consider real physics diffusion instead of the numerical diffusion in their modeling, and therefore to use the diffusion coefficient as a model calibration parameter .
Key-words: Numerical Diffusion. Flux Limiters. Eulerian-Lagrangian Method. Interpolation
Figura 3.1 - Relação entre modelos numéricos, representação de processos e atributos implementados . Fontes: (Fragoso Jr et al., 2009; Casulli e Lang, 2004; Rosman et al., 2015; Fringer et al., 2006; Wadzuk e Hodges, 2004; Zhang e Baptista, 2008; Jankowski, 1999; Chen et al., 2011)................................ 26
Figura 3.2 - Variação da superfície livre em x = y = 0,25 m comparando o erro de fase entre solução analítica (círculo vermelho), solução hidrostática com 30 camadas (linha sólida figura superior) e solução não-hidrostática (linha sólida figura inferior). Fonte: Liu et al. (2017)............................. 28
Figura 3.3 - Relação entre escala de processos e solução do termo de pressão indicada. Fonte: Marshall et al. (1997)........................................................ 28
Figura 3.4 - Esquema bidimensional de aplicação do ELM apresentando o ponto de partida no tempo ”n +1” (ponto vermelho), linha de corrente feita ao longo dos sub-intervalos de tempo (linha tracejada vermelha), ponto de parada no tempo n e pontos de interpolação utilizados para estimar a velocidade velocidade da partícula no tempo ”n” (pontos amarelos). . .	32
Figura 3.5 - Região TVD de segunda ordem (sombreado em cinza) onde alguns esquemas de limitadores de fluxo são definidos. Axima é limitado pelo esquema superbee (vermelho), abaixo pelo esquema Minmod (azul). Os esquemas Muscl e Van Leer estão plotados em azul tracejado e marro, respectivamente. A abicisça "r"é a taxa dos gradientes consecutivos de concentração. Fonte: adaptado pelo autor, Sweby, 1984 ............................... 35
Figura 3.6 - Perfil de densidade após dois períodos de oscilação para diferentes esquemas de limitadores de fluxo. A solução exata corresponde a solução inicial. Fonte: Fringer et al., 2005 ................................................ 37
Figura 3.7 - Caso de advecção em campo de fluxo rotativos: Perfis de concentrações estimado com diferentes algorítimos de rf em x = 20 m após a) 1 ciclo (Fonte: Kong et al., 2013) e b) 1 ciclo ou 5 ciclos (Fonte: Ye et al., 2018). 38
Figura 4.1 - Model representation of the grid. (Source: Casulli e Lang, 2004) ....	43
Figura 4.2 - The initial free-surface profile for a linear 3D standing wave oscillation in a closed basin. source: Yuan e Wu (2004) ......................................... 49
Figura 4.3 - Free surface elevation at x = y = 0.25 m for 30 seconds of simulation comparing analytic solution (solid black line) with simulated solution for 20 to 5 layers scenario with FSFS condition (left side) and for CBA condition (right side). At the bottom, we compare methods thought the 20 layer scenario and 8 layers scenario.......................................... 50
Figura 4.4 - Free surface elevation accumulated residuals series for FSFS approach (left) and for CBA approach (right), at x=y=0.25 m for 30 seconds of simulation, comparing different layers scenarios................................. 50
Figura 4.5 - Free surface vertical velocity (w) at x=y=0.25 m for 30 seconds of
simulation comparing analytic solution (solid black line) with simulated solution for 20 to 5 layers scenario with FSFS condition (left side) and for CBA condition (right side). At the bottom, we compare methods thought the 20 layer scenario and 8 layers scenario................. 52
Figura 4.6 - Scheme of experimental bottom geometry and location of wave level gauges. Source: Beji e Battjes (1993)........................................... 53
Figura 4.7 - Comparisons between experimental (circles) and computed data with
20-layers (solid black), 16-layers (dashed gray), 10-layers (solid red) and
5-layers (dashed blue), at 6 different level gauges........................ 54
Figura 5.1 - Model representation of the grid. (Source: Casulli e Lang, 2004) ....	63
Figura 5.2 - Example of the velocity points used in the bilinear interpolation for the a) vertical faces (left), example for the particle stopped in up position, and b) horizontal faces (right), with the particle stopped in the fourth-quadrant position....................................................... 68
Figura 5.3 - Example of model node point velocities for the quadratic interpolation. This illustration shows 27 points inside a computation cell, using information from nodes (in black), edge centers (in white) and face barycenters (in gray). The subscripts (l,m) denote the position of the vertical line (black lines) to be interpolated in the first step. n denotes the bottom, middle or top of a computation cell. The orange lines represent the second interpolation step, and the blue line represents the
final interpolation step to estimate velocity of the particle at time tn. .	70
Figura 5.4 - The initial free-surface profile for a linear 3D standing wave oscillation
in a closed basin. source: ?................................................ 72
Figura 5.6 - Comparisons of the mass conservation of computational domain over the simulation (top) and the cumulative mass conservation (bottom) over the simulation time for the tested methods: No Advection (red dashed line), Bilinear (blue doted line) and Quadratic (black solid line) 74
Figura 5.7 - Scheme of experimental bottom geometry and location of wave-level gauges. Source: Modified from Beji e Battjes (1993)........................... 75
Figura 5.8 - Comparisons between experimental (circles) and computed data with a Bilinear interpolator (dashed line) and Quadratic interpolator (solid line), at 6 different level gauges............................................ 76
Figura 5.9 - Comparisons of densitys profiles between the exact no-diffusive solution, and the No Advection (left), Bilinear (middle) and Quadratic (right) interpolators for several flux-limiter schemes, after two wave periods. .	78
Figura 5.10-Comparisons between density profiles of the exact solution, and the No-Advection (top), Bilinear (middle) and Quadratic (bottom) interpolations for all flux-limiter schemes, after two wave periods, at x = 0.0 m (left) and x = 0.4 m (right)................................................ 79
Tabela 4.1 - Metrics between the analytical and simulated results from the FSFS
method for each scenario for the first 10 seconds of simulation........ 51
Tabela 4.2 - Statistics metrics between the analytical and simulated results from the
CBA method for each scenario for the first 10 seconds of simulation . .	51
Tabela 4.3 - Computational cost, Phases Error and number of wave periods between different methods and scenarios. The model was implemented with Fortran and simulated in a machine using an Intel R Xenon R CPU-
E5-1620 3.7 GHz computer with 32 GB of RAM memory...................... 51
Tabela 4.4 - Nemenyi posthoc test comparing the FSFS residue series of the simulation with 20 to 5 vertical layers to indentify significative statiscal difference between results.......................................................... 52
Tabela 4.5 - Statistics metrics between simulated and experimental results for the
six stations for each used layer scenario with FSFS method ............ 55
Tabela 5.1 - Metrics between the analytical and simulated results each method for
30 seconds of simulation .............................................. 73
Tabela 5.2 - Metrics between simulated and experimental results for the six stations
for bilinear and quadratic results..................................... 77
Tabela 5.3 - Metrics between the analytical and simulated results each method for
30 seconds of simulation............................................... 79
Tabela 5.4 - Root Means Square errors (kg/m3) for the different flux limiter schemes
after two wave periods, for the No advection scenario, bilinear and
quadratic interpolators................................................ 79
CAPES	Coordenação de Aperfeiçoamento de Pessoal de Nível Superior
CBA	Classic Boundary Approach
ELM	método Euleriano-Lagrangiano
FSFS	Fictional Sublayer at the Free-Surface
IPH	Instituto de Pesquisas Hidráulicas
KGE	Kling-Gupta Efficiency
NSE	Nash-Sutcliffe Efficiency
PNH	Pressão não-hidrostática
RANS	Média de Reynolds Navier-Stokes
RMSE	Root mean square error
RWPT	Random Walk Particle Tracking
SPH	Smoothed Particle Hydrodynamics
TVD	Diminuição da Variação Total (Total Variation Diminishing)
UFRGS	Universidade Federal do Rio Grande do Sul
Variável	Unidade	Descrição
C	-	Concentração de um escalar
Ci,k	-	C para o i-ésimo elemento em uma camada k
Di,k	m3/s	coeficiente de fluxo de difusão para o i-ésimo elemento em uma camada k
Dj,k	m3/s	coeficiente de fluxo de difusão para j-ésima face em uma camada k
H	m	altura total da coluna de água
Hi	m	H para o i-ésimo elemento
H	m	H para j-ésima face
kh	m2/s	coeficiente horizontal da difusividade de eddy
kh kj,k	m2/s	kh for j-th side and k-th layer
kV	m2/s	coeficiente vertical da difusividade de eddy
kv i,k+ 1	m2/s	kv do i-ésimo elemento na interface superior ou inferior
		da camada k
L	m	comprimento da base
M	-	índice para a camada na superfície livre
Np	-	número de elementos
Ns	-	número de faces
Pi	2 m	ára do i-ésimo elemento
Qi,k	m3/s	fluxo advectivo para o i-ésimo elemento em uma camada k
Q j,k	m3/s	fluxo advectivo para j-ésima face em uma camada k
Si	-	número de faces de um elemento i
S+k	-	faces j de saída de fluxo de um elemento i em uma camada k
Si,k	-	Faces j de fluxo de entrada de um elemento i em uma camada k
c	m/s	celeridade da onda
di,k	m3/s	coeficiente de fluxo para um i-ésimo elemento em uma camada k
dj,k	m3/s	coeficiente de fluxo para uma j-ésima face em uma camada k
jk	m/s	Vj,k interpolado no passo de tempo tn
Va	m/s	velocidade do vendo na direção y
Variável	Unidade	Descrição
w	m/s	velocidade na direção z
wi,k+2	m/s	w para um i-ésimo elemento na interface superior ou inferior de uma camada k
wi,k+ 2	m/s	wik+ 2 após o passo da pressão hidrostática
Wi,k+ 2	m/s	wik+ 2 interpolado para o passo de tempo tn
x,y,z	m	coordenadas cartesianas
Zk+ 2	m	coordenada z da interface superior de uma camada k
Azk	m	espessura de uma camada k na direção z
Azi,k	m	Az para um i-ésimo elemento em uma camada k
Azj,k	m	Az espessura para uma j-ésima face em uma camada k
	-	dunções de Limitador de Fluxo
tf	-	Fator de limitador de fluxo
õ	m	distância entre centro de elementos adjacentes
õj	m)	õ para uma j-ésima face
n	m	elevação da superfície livre
n	m	n para um i-ésimo elemento
ni	m	n após o passo da pressão hidrostática
en	-	tolerância do método interativo de solução do n
Yb	m/s	fator de fricção de fundo
Yt	m/s	fator de frincção do topo
\	m	comprimento de uma face j
v h	m2/s	viscosidade horizontal de eddy
v v	m2/s	viscosidade vertical de eddy
v v vi,k	m2/s	vv para um i-ésimo elemento em uma camada k
v v jk± 2	m2/s	vv para uma j-ésima face na interface superior ou inferior de uma camada k
p	kg/m3	densidade da água water density
pi,k	kg/m3	p para um i-ésimo elemento em uma camada k
pa	kg/m3	densidade do ar
po	-	densidade de referência da água
e	-	fator de implicitação da solução substep (subcycle) index
n + e	-	índice de sub-passo de tempo
Ah	1/m2	discretização do laplaciano horizontal
F	-	Operado de diferença finita explícito
1	INTRODUÇÃO .............................................16
1.1	Questões Científicas....................................18
2	OBJETIVOS...............................................19
2.1	Objetivo Geral .........................................19
2.2	Objetivos Específicos...................................19
2.3	Organização do trabalho ................................19
3	REVISÃO BIBLIOGRÁFICA...................................21
3.1	Modelo IPH-ECO .........................................21
3.2	Pressão (Não)hidrostática ..............................23
3.3	Método Euleriano-Lagrangiano............................28
3.4	Transporte de Soluto....................................31
4	IMPROVEMENT OF NONHYDROSTATIC HYDRODYNAMIC SO-
LUTION USING A NOVEL FREE-SURFACE BOUNDARY CONDITION .................................................. 36
5	COMBINED USE OF HIGH RESOLUTION	NUMERICAL SCHE-
MES TO REDUCE NUMERICAL DIFFUSION IN COUPLED HYDRODYNAMIC AND SOLUTE TRANSPORT MODELS ................ 53
Conclusão........................................................76
6	CONCLUSÃO ..............................................77
Referências......................................................79
Introdução
Modelos acoplados hidrodinâmico e transporte de soluto são ferramentas bem estabelecidas para simulação de escoamentos de superfície livre em grandes ecossistemas aquáticos, como lagos, estuários, reservatórios e zonas costeiras (e.g. Valipour et al., 2015; de Brito Jr et al., 2018; Vilas et al., 2017; Soulignac et al., 2017; Munar et al., 2018).
A representação da dinâmica da estratificação térmica em ecossistemas aquáticos regula muitos processos físicos, químicos e biológicos, tais como, distribuição de espécies, taxas de reações químicas e metabólicas, ciclagem de nutrientes e concentração de gases dissolvidos (Horne e Goldman, 1994). Esta estratificação depende da hidrodinâmica do corpo hídrico e das forçantes em seu sistema como, forçantes climatológicas (e.g. velocidade e direção, temperatura do ar e radiação solar) e forçantes da bacia hidrográfica de contribuição (e.g. vazões e temperatura dos afluentes e carga de matéria orgânica, etc.). Para modelagem numérica, a representação acurada desta dinâmica demanda soluções mais complexas que sejam capazes de representar acuradamente processos físicos chave como, distribuição do campo de velocidades (vertical e horizontal), ondas internas promovidas por gradientes de concentração, e a difusão real.
Neste contexto, duas principais questões em modelagem numérica se destacam: (i) Utilização de soluções mais completas da equação de Navier-Stokes; e (ii) difusão numérica. A primeira se refere à representação dos processos que geram escoamento. Na simulação hidrodinâmica, quando a razão das escalas de movimento vertical para horizontal não é pequena (e.g., fluxos mudando abruptamente a topografia de fundo, movimentos orbitais em movimentos de ondas curtas ou circulações verticais intensas), um modelo tri-dimensional com aproximação não-hidrostática pode ser necessário para simular escoamentos de superfície livre com precisão e baixo custo computacional (Casulli e Stelling, 1998; Casulli e Lang, 2004; Chen, 2003; Monteiro e Schettini, 2015; Liu et al., 2017). A segunda, refere-se à difusão artificial associada à solução numérica empregada nos termos de advecção e difusão das equações RANS (Reynolds Averaged Navier Stokes) e de transporte de soluto (Chapra et al., 2010).
Tal questão numérica é agravada quando soluções de mais baixa ordem são aplicadas para solução numérica de equações diferenciais parciais (e.g. Cheng et al., 1984; Laval et al., 2003a; Fringer et al., 2005; Zijlema e Stelling, 2005), levando a modelos numéricos,
Capítulo 1. Introdução
17
por exemplo, considerar nulo o coeficiente de difusão, pois assumem que a difusão numérica representa a difusão real. Para aumentar a ordem da solução, uma alternativa numérica conservativa, com baixo custo de implementação e computacional, é a utilização de métodos de alta resolução na solução hidrodinâmica e de transporte, como: uso de interpolações não lineares no método Euleriano-Lagrangiano (ELM) e Limitadores de Fluxo aplicados à solução transporte de soluto (Cheng et al., 1984; Staniforth e Côté, 1991; Tamamidis e Assanis, 1993; Hodges et al., 2000; Fringer et al., 2005; Cox e Runkel, 2008; Kong et al., 2013; Ye et al., 2018; Zhang et al., 2018). Esta solução numérica menos difusiva permite que o modelo numérique utilize o coeficiente de difusão como parâmetro de calibração, e assim utilizando a equação RANS completa.
Para modelos de Transporte de Soluto, normalmente é assumido que a solução numérica hidrodinâmica é livre de difusão numérica e que nenhum erro seja levado à solução de Transporte de Soluto. Assim, a avaliação formal por modelos não acoplados do efeito da difusão numérica hidrodinâmica na solução de Transporte de Soluto pode não ser apropriadamente abordada (Cheng et al., 1984; Ruan e McLaughlin, 1999; Cox e Runkel, 2008). Por outro lado, trabalhos que utilizam modelos acoplados propõem melhorias no módulo hidrodinâmico ou de transporte para investigar a difusão numérica em uma das soluções, separadamente, sem considerar que o uso ou não de métodos de alta resolução em uma solução pode afetar a outra (Wadzuk e Hodges, 2004; Fringer et al., 2005; Casulli e Zanolli, 2005; Kong et al., 2013; Ye et al., 2018; Zhang et al., 2018; Chandran et al., 2019). Posto isto, mais esforços ainda são necessários para entender como a difusão numérica, produzida por esquemas de baixa resolução em solução hidrodinâmica, pode ser transferida para o Transporte de Solutos, e como o uso combinado de esquemas de alta resolução podem reduzir o efeito da difusão numérica na solução do Transporte de Soluto.
Para uma análise coerente dos resultados, os experimentos numéricos precisam ser aplicados utilizando um modelo hidrodinâmico não-hidrostático eficiente, pois trata-se de situações as quais a premissa da pressão hidrostática não representa adequadamente os processos físicos chave destas análises (Chen, 2003; Stelling e Zijlema, 2003; Zijlema e Stelling, 2005; Monteiro e Schettini, 2015; Liu et al., 2017). Para isto, identificamos ser necessário um modelo não-hidrostático que trate adequadamente a condição de contorno da superfície livre (Stelling e Zijlema, 2003; Yuan e Wu, 2004; Zijlema e Stelling, 2005; Lv, 2014; Lu et al., 2015; Liu et al., 2017; Escalante et al., 2018b), onde propomos um novo tratamento para condição de contorno, que dentre as existentes se enquadra com uma média eficiência e com baixo custo de implementação.
Para tanto, o trabalho teve como principal objetivo contribuir para o entendimento do efeito da difusão numérica nas soluções hidrodinâmica e de transporte, assim como a relação mútua entre ambas as difusões nas soluções numéricas. Desta forma, visando contornar o efeito de soluções numéricas simplificadas, buscou-se, verificar e validar
soluçoes numéricas mais completas com métodos de alta resolução no modelo acoplado hidrodinâmico-transporte IPH-ECO.
1.1	Questões Científicas
Com base no contexto apresentado, algumas questões cientificas se destacam, as quais respondemos nas seções posteriores do presente trabalho:
1.	A implementação de um tratamento exclusivamente para condição de contorno da superfície livre da pressão não-hidrostática pode melhorar de maneira significativa a eficiência de modelos não-hidrostáticos?
2.	Qual impacto a difusão numérica gerada por esquemas de baixa resolução, aplicados à solução hidrodinâmica, pode gerar na solução do transporte de soluto aplicada com métodos de alta resolução em escoamentos estratificados?
3.	Qual impacto a difusão numérica gerada por esquemas de baixa resolução aplicados à solução do transporte pode gerar na solução hidrodinâmica de escoamentos estratificados?
4.	A redução da difusão numérica pelo uso combinado de métodos de alta resolução é eficiente para propriamente simular escoamentos estratificados?
Objetivos
2.1	Objetivo Geral
Contribuir para o para o entendimento do efeito da difusão numérica nas soluções hidrodinâmica e de transporte de soluto, assim como a relação mútua entre ambas as soluções.
Para tal foi necessário o aprimoramento da ferramenta computacional utilizada neste trabalho (IPH-ECO) para utilizar soluções mais completas e menos difusas.
2.2	Objetivos Específicos
1.	implementar no modelo IPH-ECO soluções numéricas mais completas (pressão não-hidrostática), avaliando sua eficiência em representar escoamentos em águas profundas, escoamentos não lineares e redução do custo computacional de simulações hidrodinâmicas não-hidrostáticas.
2.	Implementar métodos de alta resolução (limitadores de fluxo e interpolação quadrática) para estabelecer uma relação de difusão numérica entre o uso combinado ou não de métodos de alta resolução nas solução hidrodinâmica e de transporte de soluto
2.3	Organização do trabalho
A dissertação foi dividido em 6 capítulos, sendo os dois primeiros introdução e revisão bibliográfica, que embasam os principais temas abordados nos capítulos subsequentes. Com intenção de responder as questões científicas levantadas, dois estudos foram desenvolvidos, apresentados na forma de artigo, constituindo os capítulos 4 e 5 do trabalho final.
Capítulo 4
Improvement of nonhydrostatic hydrodynamic solution using a novel free-surface boundary condition
Capítulo 5
Combined use of high resolution numerical schemes to reduce numerical diffusion in coupled hydrodynamic and solute transport models
A pesquisa desenvolvida nesta dissertação teve início no Capítulo 4, onde a aproximação não-hidrostática com um tratamento da condição de contorno da superfície livre foi implementada no modelo IPH-ECO. O método foi verificado e validado através de experimentos numéricos. O algorítimo se mostrou capaz de simular adequadamente a celeridade e a dispersão de frequência de ondas estacionárias em um reservatório profundo de forma acurada utilizando menos camadas verticais que um modelo não-hidrostático clássico, sem tratamento na condição de contorno, consequentemente diminuindo o custo computacional de simulações não-hidrostáticas com um baixo custo de implementação.
O capítulo 5 apresenta experimentos numéricos visando identificar o efeito da difusão numérica nas solução do transporte e hidrodinâmica. Implementamos métodos de interpolação de alta resolução (interpolação quadrática) e baixa resolução (interpolação bilinear) para estimar as velocidades ao final da linha de corrente (ELM passo-ii), além da implementação de limitadores de fluxo para reduzir a difusão numérica na solução do transporte de soluto. Anteriormente era utilizado no Modelo IPH-ECO uma interpolação linear simples neste passo do ELM. As implementações foram verificadas e validadas em experimentos numéricos puramente advectivos, onde identificamos que a difusão numérica gerada na solução hidrodinâmica pode ter grande efeito na solução do Transporte de Soluto.
A pressão não-hidrostática foi implementada como proposto por Casulli e Lang (2004), adicionando um novo tratamento para condição sua contorno na superfície livre. Os métodos de alta resolução implementados na solução hidrodinâmica e de transporte foram, respectivamente, a interpolação quadrática e esquemas de limitadores de fluxo. A interpolação quadrática (baseada em Hodges et al., 2000) é aplicada no Método Euleriano-Lagrangiano (ELM) para estimar as velocidades no ponto ao fim da linha de corrente. Os limitadores de fluxo (Fringer et al., 2005; Waterson e Deconinck, 2007; Kong et al., 2013) são aplicados à equação do transporte de soluto, funcionando como um termo de correção para situações em que a difusão numérica pode ser elevada. A seguir, será apresentado uma introdução sobre (i) o modelo utilizado e a contribuição deste trabalho em seu desenvolvimento; e (ii) cada um dos principais temas desenvolvidos neste trabalho, a saber, pressão não hidrostática, Método Euleriano-Lagrangiano e Limitadores de Fluxo.
Revisão Bibliográfica
3.1	Modelo IPH-ECO
O modelo IPH-ECO Fragoso Jr et al. (2009) é uma ferramenta computacional dinâmica capaz de simular ecossistemas aquáticos continentais (como rios, lagos, reservatórios e estuários), representando processos físicos, químicos e biológicos. O modelo encontra-se em desenvolvimento contínuo pelo Grupo de Pesquisa em Ecotecologia, do Instituto de Pesquisas Hidráulicas (IPH) da Universidade Federal do Rio Grande do Sul (UFRGS), consiste em dois módulos principais: o módulo hidrodinâmico e o módulo de qualidade da água. A parte Hidrodinâmica resolve as Equações de Reynolds Navier-Stokes em três dimensões usando uma técnica de diferenças finitas semi-implícitas em malhas triangulares não-estruturadas ou retangulares estruturadas, enquanto a parte da Qualidade da Água é capaz de simular os principais processos relevantes para o balanço de nutrientes, diagênese de sedimentos e estrutura de ambientes aquáticos. A ligação entre os dois módulos é realizada pela solução numérica de uma equação de transporte tridimensional responsável por termos advectivos, difusivos e reativos usando um esquema de volume finitos em malhas (não) estruturadas. A integração de tempo da Equação de Transporte é realizada usando um algoritmo Local Time-Stepping conservador e estável (Cavalcanti et al., 2016), permitindo simulações hidridinâmica e de qualidade de água rápidas e precisas.
A primeira versão do modelo, denominada IPH-TRIM2D, foi construída por Walter Collischonn e apresentada no Congresso Brasileiro de Limnologia (Collischonn e Marques, 2003). O formato inicial considerou uma visão 2D (X-Y) do domínio usando uma grade estruturada e aplicada principalmente para simular a hidrodinâmica de lagos rasos. Posteriormente foi aprimorada por C. Ruberto Fragoso Jr. (Fragoso Jr, 2005) por meio da adição de um algoritmo linear de wet- e dry-ing (Cheng et al., 1993; da Paz et al., 2003) e avanço na solução numérica de campo de velocidade e nível de água na inclusão do método 0 (Casulli e Cattani, 1994), alterando a solução de transporte escalar, adicionando um novo esquema numérico conservativo para advecção Gross et al. (1998) e definindo um módulo simplificado para fitoplâncton biomassa (Fragoso Jr et al., 2008). No entanto, houve a necessidade de se compreender processos internos mais complexos e variáveis de qualidade da água, então realizado por realizado por C. Ruberto Fragoso Jr., ao associar o modelo IPH-TRIM2D a um modelo ecológico complexo, denominado PC-Lake (Fragoso Jr et al.,
Capítulo 3. Revisão Bibliográfica
22
2009; Janse, 2005). De modo resultante o modelo foi renomeado para IPHTRIM3D-PCLake (Fragoso Jr et al., 2009), e mais recentemente como modelo IPH-ECO (Cavalcanti et al., 2016; de Brito Jr et al., 2018). A ultima foi capaz de descrever fluxos tridimensionais e estratificação térmica em lagos rasos (Fragoso Jr et al., 2011).
Recentemente, a solução hidrodinâmica do modelo IPH-ECO foi aprimorada para utilizar domínios não estruturados em duas e três dimensões por Fabio F. Pereira (Pereira, 2010; Pereira et al., 2013) e J. Rafael Cavalcanti (Cavalcanti, 2017). Esta nova versão, denominada UnIPH-ECO, resolve as equações diferenciais parciais usando uma malha ortogonal triangular não estruturada. Além disso, o código do modelo foi aprimorado usando um novo algoritmo de secagem e inundação não-linear e uma nova solução de passo de Tempo Local para transporte escalar (Cavalcanti et al., 2015). É importante ressaltar que, o principal código do IPH-ECO está sendo melhorado e de forma constante atualizado pelos estudantes e pesquisadores que atuam em diferentes projetos associados ao Grupo de Pesquisa em Ecotecnologia da UFRGS. Para mais informações, foi desenvolvida a plataforma digital do programa, podendo ser acessada através do endereço http://ipheco.yooh.com.br.
O presente trabalho colabora com o desenvolvimento do modelo nos módulos hidrodinâmico e qualidade de água, melhorando sua capacidade de modelar escoamentos em águas profundas e estratificados em três dimensões, através da implementação de soluções mais completas das equações RANS e métodos de alta resolução. De modo específico, as implementações foram:
•	pressão não-hidrostática com uma nova abordagem para o tratamento da condição de contorno da superfície livre (Casulli e Lang, 2004);
•	Interpolação das velocidades ortogonais às faces, calculadas na solução hidrodinâmica, em componentes de velocidades x e y nas faces, vértices e arestas de uma célula computacional.
•	interpolação bilinear aplicada ao passo-ii do ELM (Casulli e Cheng, 1992);
•	interpolação quadrática aplicada ao passo-ii do ELM (Hodges et al., 2000);
•	esquemas de limitadores de fluxo baseados nos gradientes consecutivos (rf) (Fringer et al., 2005; Waterson e Deconinck, 2007);
•	implementação do cálculo do rf baseado no proposto por Kong et al. (2013);
O modelo foi formalmente verificado e validado através de benchmarks para as soluções hidrodinâmica e de transporte. Os testes foram aplicados em malhas estruturadas e posteriormente serão feitas análises para verificação e validação do código em malhas não-estruturadas.
Capítulo 3. Revisão Bibliográfica
23
Com esta modificações o modelo possui o potencial de representação de processos similar à outros modelos consagrados como o ELCOM (Wadzuk e Hodges, 2004), SUNTANS (Fringer et al., 2006) e o FVCOM (Chen et al., 2011). O esquema abaixo relaciona o potencial de representação de processos do IPH-ECO à de outros modelos, ainda mostrado a representação atual (Fragoso Jr et al., 2009) e a atual.
Circulação global
Escoamentos 1 Estratificados ,
T
4-4
4-4
I	I	I
Ondas de 1 Escoamentos em Escoamentos em 1 Gravidade , águas profundas água rasas j
i	i&amp;lt;	I
1	'&amp;lt;	I
i	i~	i
1	4	!
i	i	r
1	1	1
I	I	I
&lt;/)
2
LU Q
O
2
Pressão hidrostática
Advecção de baixa resolução
Transporte de baixa resolução Pressão não-hidrostática
Advecção de Alta-Resolução
Transporte de Alta-Resolução
IPH-ECO: Fragoso Jr. (2009) SELFE: Zhang and Baptista (2008) SisBaHiA: Rosman (2015) TELEMAC3D: Jankowski (1991) UnTrim: Casulli and Lang (2004) ELCOM: Wadzuk and Hodges (2004) SUNTANS: Fringer et al (2006) IPH-ECO: Trabalho Atual FVCOM: Chen et al., (2011)
4
4
4
4
i
*
I
* Advecção de Alta-Resolução: Método Euleriano-Lagragiano com interpolação quadrática, métodos de ordem similar ou superior *Transporte de Alta-Resolução: Método com funções de limitadores de fluxo, métodos de segunda ordem ou superior
Figura 3.1 - Relação entre modelos numéricos, representação de processos e atributos implementados . Fontes: (Fragoso Jr et al., 2009; Casulli e Lang, 2004; Rosman et al., 2015; Fringer et al., 2006; Wadzuk e Hodges, 2004; Zhang e Baptista, 2008; Jankowski, 1999; Chen et al., 2011)
A avaliação foi feita relacionando os métodos numéricos implementados nos modelos numéricos quanto a pressão, esquema de advecção e esquema de transporte de soluto, especificamente, qual a robustez da implementação dos termos de pressão, advecção e transporte de soluto. Com a implementação dos novos métodos omodelo IPH-ECO passa da representação de processos em águas rasas para águas profundas com boa capacidade de representar ondas gravitacionais e escoamentos estratificados.
3.2	Pressão (Não)hidrostática
A seguir será apresentado as equações governantes de modelos hidrodinâmicos hidrostáticos e não-hidrostáticos, discutindo sobre a vantagem em utilizar modelos não-hidrostáticos, e em como melhorar sua eficiência.
A equação governante que descreve escoamentos de superfície livre pode ser derivada da equação RANS (Reynolds Avarage Navier-Stokes). Estas equações expressam o princípio físico da conservação do volume, massa e do momento (Casulli e Lang, 2004). As equações do momentum para um fluído incompressível com a pressão decomposta na soma das
Capítulo 3. Revisão Bibliográfica
24
partes hidrostática (pressão barotrópica e baroclínica) e não-hidrostática tem a seguinte forma:
du	du	du	du
u + v +w - fv = dt	dx	dy	dz
dpa	dy	d
dx	dx	dx
dq dx
(3.1)
+v h
d 2u
dx2 +
d 2u dy2
d_ + d~z
V
du
~dz
dv	dv	dv	dv
u +v +w +fu = dt	dx	dy	dz
dpa dy	d
dy dy dy
dq dy
(3.2)
dw	dw	dw	dw
u + v + w = dt	dx	dy	dz
d2v	d2v
dx2 + dy2
• d Cí
dq h íd2w	d2w\
dz + dx2 + dy2
d_ + dz
(" • í')
(3.3)
+v h
Sendo u(x,y,z,t,), v(x,y,z,t) e w(x,y,z,t) são os componentes de velocidade nas direções horizontal (x e y) e vertical (z), onde vh e vv são os coeficientes de viscosidade turbulenta horizontal e vertical, respectivamente; t é o tempo; pa(x,y, z,t) é a pressão atmosférica; n é a elevação de superfície livre de uma referência de nível de água. O
segundo e o terceiro termos do lado direito das equações (3.1) e (3.2) representam as contribuições barotrópica e baroclínica da pressão; q(x,y,z,t) refere-se ao componente de pressão não-hidrostática; f é o parâmetro de Coriolis; e g é a aceleração gravitacional.
Modelos hidrodinâmicos usualmente adotam simplificações às equações RANS buscando obter resultados satisfatórios com um baixo custo computacional como, a utilização de modelos bidimensionais e aproximação hidrostática do termo de pressão. Quando a abordagem hidrostática é considerada, a equação (3.3) é negligenciada e q é definido igual a zero nas equações (3.1) e (3.2). Neste caso, assume-se que a aceleração vertical não tem um efeito significativo no campo de velocidade em comparação com a aceleração horizontal, que é a suposição geralmente aplicada para a simulação de águas rasas. Entretanto, há muitos casos onde esta suposição não representa adequadamente alguns processos físicos (escalas dos movimentos horizontais pelo menos 20 vezes menores do que a profundidade ou declividade superior a 1/20, Rosman et al., 2015), a figura 3.2 apresenta, por exemplo, o erro de fase gerado pela aproximação hidrostática em simulação de ondas estacionárias em situação de águas profundas. A escala e o tipo do processo físico a ser simulado é determinante para adoção ou não de modelos mais simplificados
Figura 3.2 - Variação da superfície livre em x = y = 0,25 m comparando o erro de fase entre solução analítica (círculo vermelho), solução hidrostática com 30 camadas (linha sólida figura superior) e solução não-hidrostática (linha sólida figura inferior). Fonte: Liu et al. (2017)
Pressão	Escala de distância
Figura 3.3 - Relação entre escala de processos e solução do termo de pressão indicada. Fonte: Marshall et al. (1997)
Capítulo 3. Revisão Bibliográfica
26
(Marshall et al., 1997). A figura 3.3 apresenta a relação entre escala de processos e tipo de aproximação (hidrostática ou não-hidrostática) que melhor se adéqua a sua representação.
Existe um trade-off entre o custo de implementação e o custo computacional quando abordagens hidrostáticas e não-hidrostáticas são comparadas. A abordagem não-hidrostática, em geral, requer métodos numéricos interativos mais complexos (Stelling e Zijlema, 2003; Casulli e Lang, 2004; Lu et al., 2015), o que aumenta o custo computacional comparado à abordagem hidrostática usando uma mesma grade computacional. Entretanto, a abordagem não-hidrostática melhora a representação física do fenômeno requerendo um número menor de camadas verticais para alcançar resultados fisicamente satisfatórios em comparação com a abordagem hidrostática. Assim, para se obter resultados semelhantes à simulação não-hidrostática, a abordagem hidrostática necessita de alta resolução vertical, implicando em um maior custo computacional em relação à abordagem não-hidrostática (Liu et al., 2017).
Apesar do aprimoramento na solução, simulações com pressão não-hidrostática podem ainda requerer, na ótica do custo computacional, uma alta resolução vertical para modelar fluxos em larga escala com geometrias complexas. Desta forma, a diminuição do custo computacional de modelos hidrodinâmicos não-hidrostáticos tem sido foco de muitos trabalhos. A maioria deles se dedica a melhorar a habilidade do modelo em resolver a equação de poisson para pressão, focando no tratamento da condição de contorno da pressão não-hidrostática na superfície livre e no uso de uma discretização do momento vertical menos dependente do perfil vertical das velocidades (e.g. Stelling e Zijlema, 2003; Yuan e Wu, 2004; Zijlema e Stelling, 2005; Lv, 2014; Escalante et al., 2018b).
Além disto, modelos híbridos, hidrostáticos e não-hidrostáticos, também têm sido implementados para reduzir o custo computacional. Eles identificam regiões onde a simplificação pode ser aplicada, ao invés de aplicar a abordagem não-hidrostática para todo o domínio computacional (e.g. Wadzuk e Hodges, 2004; Bohacek et al., 2018; Zhang et al., 2018). Outros esforços concentram-se em adaptar a solução numérica à implementação computacional em paralelo, que aloca os cálculos das estruturas de repetição (e.g. método dos gradientes conjugados para solução da pressão não-hidrostática) em diferentes processadores (e.g. Zhang et al., 2018; Escalante et al., 2018a). No entanto, a melhoria dos modelos hidrodinâmicos não-hidrostáticos também pode ser alcançada com baixo custo de implementação. Neste artigo focamos em uma nova condição de contorno de superfície livre para pressão não-hidrostática, sem quaisquer alterações das equações do momento.
No tocante à condição de contorno da pressão não-hidrostática na superfície livre, um dos focos deste trabalho (ver capítulo 4), dois tipos diferentes de condição de contorno são aplicados: primeira, uma condição de Dirichlet homogênea, a qual pressão hidrostática é assumida para superfície livre e definida como zero (e.g. Kanarska e Maderich, 2003;
Capítulo 3. Revisão Bibliográfica
27
Stelling e Zijlema, 2003; Wang et al., 2009; Zhang et al., 2018); a segunda é uma condição de Neumann, geralmente utilizada uma relação hidrostática para aproximar a pressão da superfície livre à zero (e.g. Casulli, 1999; Namin et al., 2001; Monteiro e Schettini, 2015; Bohacek et al., 2018). Bergh e Berntsen (2010) discute bem as diferenças entre ambas as condições em esquemas numéricos que definem a pressão não-hidrostática na interface entre células computacionais (edge based), mostrando que ambas condições geram bons resultados. Entretanto modelos que utilizam a condição de Neumann representam ligeiramente melhor escoamento não lineares.
Modelos numéricos, comumente, resolvem a equação de Poisson para pressão alocando a componente no centro da célula computacional (e.g. Jankowski, 1999; Yuan e Wu, 2004; Casulli e Lang, 2004; Liu et al., 2017; Bohacek et al., 2018), o que pode gerar uma definição incorreta da condição de contorno da pressão não-hidrostática se um tratamento adequado não for feito. Uma vez que a condição de contorno é definida no centro da camada superior, ao invés de precisamente na superfície livre, a condição de contorno utilizada torna-se mais imprecisa à medida que a distância entre o centro da camada superior e a superfície livre aumenta, consequentemente, uma alta resolução vertical (1-20 camadas) é necessária para obter resultados satisfatórios (Stelling e Zijlema, 2003; Yuan e Wu, 2004; Zijlema e Stelling, 2005; Cui et al., 2012; Lv, 2014; Liu et al., 2017).
Utilizando uma adequada resolução vertical, Yuan e Wu (2004) e Zijlema e Stelling (2005) mostraram que modelos não-hidrostáticos que definem a pressão no centro da célula computacional podem ter um erro de fase acumulado significativo após vários períodos, devido a erros na estimativa da celeridade da onda. Em função disso, um tratamento para a condição de contorno ou a utilização de um modelo edge based de pressão se faz necessária.
Poucas opções estão disponíveis para definir adequadamente a condição de contorno na superfície livre: i) implementação de discretização da pressão não-hidrostática definida na interface entre células computacionais (edge based) (e.g. Stelling e Zijlema, 2003; Lu et al., 2015); ii) utilização de um método de integração que estima a pressão não-hidrostática na superfície livre a partir da integração da pressão no centro da camada superior à superfície livre (e.g. Yuan e Wu, 2004; Lu et al., 2015; Lv, 2014; Liu et al., 2017); e iii) aplicação de um perfil linear por partes da pressão não hidrostática baseado no valor esperado para o fundo e topo que posteriormente seja ajustado o valor nas camadas (e.g. Escalante et al., 2018b).
Para que sejam melhoradas as soluções dos modelos com pressão definida no centro da célula computacional, as opções disponíveis podem exigir custo de implementação substancial, visto que os tratamentos da condição de contorno são desenvolvidos com base nas diferentes discretizações numéricas utilizadas pelos autores. Portanto, a adaptação de
Capítulo 3. Revisão Bibliográfica
28
modelos pode requerer ao menos alteração da discretização do momento vertical, além da implementação do devido tratamento da condição de contorno. Assim, a fim de reduzir o custo computacional de simulações hidrodinâmicas não-hidrostáticas com um método de baixo custo de implementação, foi proposto aqui uma condição de contorno na superfície livre que é baseada em uma subcamada fictícia, onde a condição de contorno existente (Dirichlet ou Neumann) pode ser aplicada, sem maiores alterações no código. Este item será melhor discutido no capítulo (4).
Contudo, qualquer que seja a abordagem (hidrostática ou não-hidrostática), os erros de difusão numérica permanecem críticos, e muitos trabalhos foram feitos para reduzi-la, adotando diversas abordagens. Técnicas de resolução mais alta (e.g. interpoladores quadráticos, cúbicos e splines e limitadores de fluxo) provaram ser uma alternativa promissora para minimizar esses erros numéricos (Cheng et al., 1984; Ruan e McLaughlin, 1999; Waterson e Deconinck, 2007; Kong et al., 2013; Ye et al., 2018). Embora trabalhos anteriores mostrem que esquemas de alta resolução podem não manter algumas características importantes de solução numérica (e.g. oscilações espúrias de ondas internas) (e.g. Wang e Lacroix, 1997), eles podem representar melhor comportamentos não-lineares do campo de velocidades de esquemas de baixa resolução (UpWind de primeira ordem, interpolador bilinear). Apesar da possibilidade dos esquemas lineares serem mais estáveis, monotônicos e facilmente implementados, há também a possibilidade de gerar resultados insatisfatórios devido à maior difusão numérica.
A seguir é apresentado uma breve revisão das vantagens de aplicação de algumas dessas técnicas de alta resolução nas soluções hidrodinâmica e de transporte.
3.3	Método Euleriano-Lagrangiano
Um modo de reduzir a difusão numérica é a implementação de esquemas de alta resolução na solução hidrodinâmica e de transporte. O método Euleriano-Lagrangiano (ELM) é um dos mais populares e precisos, usado para resolver numericamente os termos de advecção tanto na equação RANS quanto nas equações de transporte de solutos (Cheng et al., 1984; Ruan e McLaughlin, 1999; Cox e Runkel, 2008; Casulli e Cheng, 1992; Jankowski, 1999; Hodges et al., 2000; Wadzuk e Hodges, 2004; Walters, 2005; Fringer et al., 2005; Monteiro e Schettini, 2015). O objetivo do ELM é combinar a simplicidade da grade computacional Euleriana fixa com uma abordagem Lagrangiana estável e precisa. O método utiliza de técnicas de interpolação aplicados em duas principais etapas para estimar os termos advectivos (Staniforth e Côté, 1991). A Figura 3.4 apresenta um esquema de aplicação do método:
O local de partida da partícula (ponto vermelho) encontra-se no baricentro de uma dada face ”j” na camada ”k” no tempo ”n + 1”. (i) Ao longo dos subintervalos de tempo
Capítulo 3. Revisão Bibliográfica
29
						
_Q	c		)	c		! ) / 	¿	r	'n+1	!
	n &amp;lt;—0—-					
		■			•	
		a				
Figura 3.4 - Esquema bidimensional de aplicação do ELM apresentando o ponto de partida no tempo ”n + 1” (ponto vermelho), linha de corrente feita ao longo dos subintervalos de tempo (linha tracejada vermelha), ponto de parada no tempo n e pontos de interpolação utilizados para estimar a velocidade velocidade da partícula no tempo ”n” (pontos amarelos).
a linha de corrente é determinada através da aplicação de um método de rastreamento de partículas, que consiste em obter a localização ao fim do subintervalo de uma partícula fluida no passo Lagrangiano interpolando a posição final em função da velocidade do local de partida e do tempo (e.g Passos Multiplos de Euler, Runge-Kutta de quinta ordem). No entanto, a posição final de cada subintervalo não é um ponto de grade, logo, (ii) uma interpolação do campo advectivo utilizando nós da grade com velocidade conhecida (pontos amarelos) é necessária para estimar as componentes de velocidade no ponto ao fim da linha de corrente. O resultado dos erros de interpolação, em ambas as etapas, podem introduzir: (a) uma difusão numérica substancial, quando usados esquemas de interpolação de baixa resolução; ou (b) oscilação espúria de ondas internas, quando são usados esquemas de interpolação de alta resolução (Cheng et al., 1984; Oliveira e Baptista, 1998; Wang e Lacroix, 1997; Ruan e McLaughlin, 1999).
Uma das aplicações do ELM é o tratamento numérico das equações RANS, que decorre da discretização dos termos convectivos e viscosos da equação convecção-difusão em três dimensões (equações 3.1-3.3). A equação advecção-difusão sem o termo de Coriolis e termos de pressão, pode ser descrita como:
dc dt
dc	dc	dc	dc
+ U + V + w = dt	dx	dy	dz
d2c	d2c
dx2 + dy2
d dc
+ dZ ,vãZ
(3.4)
onde C é uma variável genérica (e.g. componentes da velocidade u, v, w) (Casulli e Cheng, 1992). Para obter uma solução simples e aprimorar a estabilidade e acurácia de um esquema explícito de diferença finita, considere a equação 3.4 em sua forma Lagrangiana:
dc	í d2c	â2c\	d í dc\
dt	dx2 + dy2 + dz dz
Onde a derivada substancial d indica a taxa de variaçao no tempo, a qual é
calculado ao longo de uma linha de corrente definida por:
dx	dy
d = u ~dt = v
dz
= w dt
(3.6)
Uma discretizaçao explícita da equaçao (3.5) pode ser dada por:
n+1
\.Cj,k
vk+1/2
cn+1  cn+1
Cj,k+1 Cj,k ^zj,k+1/2
vk-1/2
Cjn+1__cjn + 1
Cj,k	g,k-1
^zj,k-1/2
At
Azj,k
+ fiAhC*k
(3.7)
j )
Para discretizaçao Lagragiana ser aplicada em uma grade Euleriana, uma linha de corrente retroativa é necessária para estimar a velocidade no tempo "n"(abordagem Lagrangiana) necessária para alcançar a posiçao final "j, k"no tempo "n + 1 "(Abordagem Euleriana).
A técnica de interpolaçao aplicada à segunda etapa do ELM tem um grande impacto na difusao numérica total produzida, especialmente quando os esquemas de interpolaçao de baixa resoluçao sao utilizados, uma vez que obtençao das velocidades é amplamente afetada pelo processo repetitivo de interpolaçao a cada subintervalo de tempo (Staniforth e Côté, 1991). Cheng et al. (1984) demonstrou que a utilizaçao de esquemas nao-lineares de alta resoluçao pode eliminar a difusao numérica gerada pelo método. Desta forma, apesar de métodos de alta resoluçao ter a possibilidade de nao manter algumas características importantes de soluçao numérica (e.g. oscilações espúrias de ondas internas), esquemas nao-lineares de alta resoluçao aplicados ao ELM sao preferíveis à esquemas lineares para simulaçao (Cheng et al., 1984; Casulli e Cheng, 1992; Wang e Lacroix, 1997; Ruan e McLaughlin, 1999).
Propomos neste trabalho uma interpolaçao quadrática baseada no coeficiente de Lagrange que utiliza 27 pontos, entre velocidade calculadas e estimadas, em um único elemento computacional (ver capítulo 5 para detalhes). A implementaçao foi baseada na interpolaçao quadrática de alta resoluçao e nao oscilatória (wiggles) proposta por Hodges et al. (2000), que utiliza 27 pontos da grade computacional, precisando de ao menos 4 elementos para utilizar a interpolaçao. Apesar da técnica ainda nao ter sido formalmente analisada (Hodges et al., 2006), sem registro posterior da análise formal desta. Outros estudos modelaram com sucesso simulações hidrodinâmicas e de transporte de solutos, indicando que a soluçao é satisfatória, demonstrando que é promissor em simular ondas gravitacionais internas e melhorar a habilidade do modelo em resolver escoamento estratificados de superfície livre (e.g. Hodges et al., 2000; Laval et al., 2003b, 2005; Hodges et al., 2006; Valipour et al., 2015; Vilas et al., 2017; Soulignac et al., 2017).
Capítulo 3. Revisão Bibliográfica
31
3.4	Transporte de Soluto
A equação do Transporte é obtida através da discretização da equação da conservação de volume, expressa pela condição de incompressibilidade e a equação de continuidade, dada por:
du dv dw dx + dy + dz
(3.8)
A integração da equação (3.8) na profundidade, utilizando a regra de integração de Leibniz, em cada uma das direções (x,y,z) e ainda usando a condição cinemática na superfície livre, resulta na equação de superfície livre:
dy d dt + dx
rn	d r n
udz +	vdz = 0
-h	dy -h
(3.9)
A conservação de massa de uma variável escalar conservadora pode ser expressa
pela seguinte equação:
dC d (uC) d(vC) d (wC) dt + dx + dy + dz
(3.10)
d(KhdC d_(Khdo d Kvdo dx (K dx) + dydy ) + dz K dz
Onde C é a concentração de uma substância conservativa a ser transportada (e.g. salinidade); Kh e Kv são os coeficientes de difusividade turbulenta horizontal e vertical, respectivamente.
A solução de Transporte de Soluto pode ser resolvida por esquemas numéricos diferentes do ELM, tais como esquema Total Variation Diminishing (TVD) de alta ordem, Random Walk Particle Tracking RWPT e Smoothed Particle Hydrodynamics (SPH), bem discutidos em Boso et al. (2013). Um esquema simples para discretizar a equação de conservação de massa, com baixo custo de implementação, é o UpWind de primeira ordem, no qual os limitadores de fluxo podem ser aplicados para reduzir a conhecida difusão numérica desta discretização (Casulli e Zanolli, 2005; Zhang et al., 2018).
A discretização dos termos que representam o transporte convectivo é um aspecto desafiador na simulação numérica de fluídos. No contexto das discretizações consideradas aqui, a introdução de esquemas lineares Upwind de segunda ordem ou superior (k-scheme) a partir da década de 60 marcou um grande passo à frente, permitindo soluções mais precisas de fluxos predominantemente convectivos em números mais altos de Reynolds (Waterson e Deconinck, 2007). Tais esquemas lineares, embora mais estáveis do que esquemas de pura diferença centrada, ainda permanecem vulneráveis a oscilações espaciais sem sentido físico (wiggles) sob algumas circunstâncias. A solução para este problema tem sido o uso de discretizações não lineares, sendo uma forma eficiente de construir um esquema de transporte convectivo Upwind não-linear de segunda ordem o uso dos limitadores de fluxo (Sweby, 1984; Roe, 1986; Waterson e Deconinck, 2007).
Capítulo 3. Revisão Bibliográfica
32
o
0
1
2
4
Figura 3.5 - Região TVD de segunda ordem (sombreado em cinza) onde alguns esquemas
de limitadores de fluxo são definidos. Axima é limitado pelo esquema superbee (vermelho), abaixo pelo esquema Minmod (azul). Os esquemas Muscl e Van Leer estão plotados em azul tracejado e marro, respectivamente. A abicisça "r"é a taxa dos gradientes consecutivos de concentração. Fonte: adaptado pelo autor, Sweby, 1984
O esquema do limitador de fluxo provou ser uma das abordagens mais eficazes para a construção de esquemas não lineares de alta resolução (Waterson e Deconinck, 2007). São funções simples que definem o esquema de convecção com base em uma relação de gradientes locais no campo da solução, com um limite de comportamento, a fim de manter a monotonicidade, geralmente limitado por uma condição TVD para esquemas de segunda ordem (Sweby, 1984; Waterson e Deconinck, 2007) (Figura 3.5). Os Limitadores de Fluxo tem sido amplamente utilizado para obter soluções menos difusas e estáveis, mesmo em situações críticas, como em gradientes de concentração acentuada em regiões com pequeno número de courant (Wadzuk e Hodges, 2004; Fringer et al., 2005; Casulli e Zanolli, 2005; Kong et al., 2013; Zhang et al., 2018; Nangia et al., 2019). Uma boa revisão sobre construção de limitadores de fluxo pode ser encontrada nos trabalhos de Tamamidis e Assanis (1993); Fringer et al. (2005); Waterson e Deconinck (2007).
Muitas são as opções de funções de limitadores de fluxo que se ajustam aos limites TVD. Os trabalhos de Waterson e Deconinck (2007); Fringer et al. (2005) mostram algumas opções as quais 13 foram implementadas, a saber:
1. UpWind
$(7) = 0
(3.11)
2. Lax-Wendroff
3 .
4.
5	.
6	.
7.
8 .
9 .
10.
11.
12.
13.
MinMod
MUSCL
Superbee
SMART
SHARP
Van Leer
Ultimate Quickest
$(rf) = max[j; min(rf, 1)]
$(rf) = max[^”k; min(2rf; 0, 5 + 0, 5rf; 2)]
$(rf) = max[^J,k; min(1; 2rf); min(2, rf)]
f 3r f
$(rf) = max $j,k; min í 2rf ;	+
$(rf &gt;=min H
$(rf) = max ^jk; min
Super-C
Hyper-C
OSPRE
SPL-1/3
$(rf) =
/ 0,5
(rf

1)
(rf - 1)
(rf + 1rf1) (1 + rf)
(&gt; rf) + &gt; - rf )(1 -
$(rf) = min (jf	, 0 &amp;lt;rf &amp;lt;1
$(rf) = min (rf, 1 -2|CJ ,rf &gt; 1
$(rf) = j
2rf	2
&gt; = mi+ C	C|)'r&gt; &gt; 0
*(f) = j
( rf+1
Y2! "
$(rf) = max ó?k; 3rf .	2	,
V f	f \2rj + 2rf + 2j
1	2rf 2 rf
rf) = max j min í	3 + -f ; 3 + f;2)
(3.13)
(3.14)
(3.15)
(3.16)
(3.17)
(3.18)
(3.19)
(3.20)
(3.21)
(3.22)
(3.23)
Capítulo 3. Revisão Bibliográfica
34
Onde í e $ são funções que determinam o fator de correção da equação do Transporte de Soluto (ver capítulo 5 para mais detalhes) e C é o número de Courant. A importância de sua implementação se resume na praticidade de sua implementação e no potencial de redução da difusão numérica de forma estável, mesmo em cenários com bruscos gradientes de concentração. Fringer et al. (2005) avalia a eficiência de uma série de limitadores de fluxo através de um benchmark regido por uma onda gravitacional com coeficiente de difusão nulo, apresentando seus potenciais de redução de difusão numérica (figura 3.6), dentre os quais o Superbee, Ultimate-Quickest, MUSCL, BPEP1 e BPEP2 apresentaram os melhores resultados.
Figura 3.6 - Perfil de densidade após dois períodos de oscilação para diferentes esquemas de limitadores de fluxo. A solução exata corresponde a solução inicial. Fonte: Fringer et al., 2005
Os limitadores de fluxo são, em sua maioria, unicamente influenciados pelos gradientes consecutivos de concentração (rf) sendo sua estimativa determinante para eficiência na redução da difusão numérica de maneira estável. Diversas maneiras de estimar o rf foram propostas (Darwish e Moukalled, 2003; Casulli e Zanolli, 2005; Li e Huang, 2008; Kong et al., 2013; Zhang et al., 2015; Ye et al., 2018). O rf proposto por Ye et al. (2018), Zhang et al. (2015) e Kong et al. (2013) mostratam os melhores resultados dentre todos os métodos existentes, sendo menos difusivo e oscilatório que seus antecessores (ver figura 3.7).
Pela estabilidade e eficiência e reduzir a difusão numérica e facilidade em adaptação da solução ao tipo de malha em 3 dimensões (estruturada ou não-estruturada), o rf proposto por Kong et al. (2013), se mostra uma alternativa promissora, pois se baseia apenas nas contrações e distâncias entre a célula computacional em análise e células vizinhas. Para as faces verticais (fluxo horizontal) o gradiente consecutivo é dado por:
n
j,k
nn
Ci,k	Cr(i,jo),k
n	n
Cr(i,j),k	Ci,k
(3.24)
onde jo representa a face oposta à face j e C a concentração em seus respectivos elementos de malha. Para as faces horizontais (fluxo vertical) o rf é dado por:
nn
Ci,k	Ci,k+1
n
nn
Ci,k-1	Ci,k
i,k-1
nn
Ci,k Ci,k-1
n
Ci,k+1
(3.25)
(3.26)
n
j,k+1
.. 7 -
( vk
----Exact
-0- Present .one cycle
-A- Present.five cycle
-0-Kong ct al. (2013 (.one cycle -A- Kong « al. (2013 j,five cycle -0-Casulli and Zanolli. |2005|,onc cycle [ -A-Casulli and ¿anolli, (2005(Jivecycle

r
r
r

Figura 3.7 - Caso de advecção em campo de fluxo rotativos: Perfis de concentrações estimado com diferentes algorítimos de rf em x = 20 m após a) 1 ciclo (Fonte: Kong et al., 2013) e b) 1 ciclo ou 5 ciclos (Fonte: Ye et al., 2018).
Improvement of nonhydrostatic hydrodynamic solution using a novel free-surface boundary condition
IMPROVEMENT OF NONHYDROSTATIC HYDRODYNAMIC
SOLUTION USING ANOVEL FREE-SURFACE BOUNDARY CONDITION
Augusto Hugo Farias da Cunha Carlos Ruberto Fragoso Jr.
David da Motta Marques
Artigo a ser submetido.
Improvement of nonhydrostatic hydrodynamic solution using a novel free-surface boundary condition
Augusto Hugo Farias da Cunha • Carlos Ruberto
Fragoso Junior • David da Motta-Marques
1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
Abstract Hydrodynamic models based on RANS equation are well established tools to simulate threedimensional free surface flows in large aquatic ecosystems, such as lakes, estuaries, reservoirs and coastal zones. When the ratio of vertical to horizontal motion scales is not small, a non-hydrostatic approximation is needed in order to accurately model three-dimensional free surface flows with low computational cost. Growing efforts have been made to improve the efficiency of non-hydrostatic hydrodynamic models. One such attempt improves the model ability in solving the elliptic equation to nonhydrostatic pressure, which properly address the free-surface boundary condition and uses a vertical momentum discretization less dependent on the velocity vertical profile. However, the improvements may demand a considerable implementation cost due to substantial changes, at least, in the vertical momentum discretization and in the treatment needed to properly address the nonhydrostatic pressure at the free-surface boundary condition. Thus, in order to improve the nonhydrostatic hydrodynamic solution with low cost of implementation, we proposed a novel free-surface boundary condition based on a fictional sublayer at the free-surface (FSFS). We applied the FSFS at a finite difference discretization with a fractional step framework based on Casulli and Lang (2004), which uses a Neumann type of boundary condition which applies a hydrostatic relation in the top layer. To evaluate the model performance, we compared the Classic Boundary Condition Approach (CBA) and the FSFS aproach using two numerical experiments: (a) a standing wave in a three-dimensional closed basin, and (b) a wave propagation over a submerged bar, to test the model’s capability in solving wave celerity and simulate non-linear wave propagations under different vertical resolutions scenarios (20 to 5 layers). Our findings showed that the FSFS approach had phase error 2 to 5 time lower than CBA, and with little additional computational cost (ca. 7%). The FSFS approach better represented wave celerity and frequency dispersion with fewer layers (10 layers) with low mean computational cost (c.a. 1.54 s), while the CBA best results (computational cost of c.a. 2.62 s) had similar performance to the 8-layer (computational cost of c.a. 1.51 s) simulation with FSFS approach.
Keywords Pressure • Implementations Cost • Computational Cost
1	Introduction
Hydrodynamic models based on Reynolds Averaged Navier-Stokes (RANS) equation are well established tools to simulate three-dimensional free surface flows in large aquatic ecosystems, such as lakes, estuaries, reservoirs and coastal zones (Valipour et al., 2015; de Brito Jr et al., 2018; Vilas et al., 2017; Soulignac et al., 2017; Munar et al., 2018). These models usually are based on hydrostatic assumption of the pressure distribution, which is satisfactorily applied to large shallow water ecosystems with relatively low computational cost algorithm (Zhang et al., 2018). However, when the ratio of vertical to horizontal motion scales is not small, a non-hydrostatic approximation is needed in order to model accurately three-dimensional free surface flows with low computational cost (Marshall et al., 1997; Casulli and Stelling, 1998; Chen, 2003; Wadzuk and Hodges, 2004; Liu et al., 2017).
Hydraulic Research Institute;
Federal Univerisity of Rio Grande do Sul, Porto Alegre, Rio Grande do Sul,Brazil
Tel.: +55 51-3308-6670
E-mail: hugo.cunha@ufrgs.br
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
Although a nonhydrostatic approach improves the physical representation of pressure, acceleration and velocities fields, more complex numeric methods and high vertical resolution may still be needed to model large-scale flows with complex geometries. To improve efficiency and reduce the computational cost of nonhydrostatic hydrodynamic models, a few alternatives were explored. Most of them are dedicated to improving the model's ability to solve the elliptic equation to nonhydrostatic pressure, which properly addresses the free-surface boundary condition and uses a vertical momentum discretization less dependent of the velocity vertical profile (Stelling and Zijlema, 2003; Yuan and Wu, 2004; Zijlema and Stelling, 2005; Lv, 2014; Liu et al., 2017; Escalante et al., 2018a). Hybrid hydrostatic and nonhydrostatic models have also been used to reduce computational cost. These models may identify regions where the simplification can be applied, instead of applied the nonhydrostatic approach to the entire computational domain (Wadzuk and Hodges, 2004; Bohacek et al., 2018; Zhang et al., 2018). To adapt source code to work as a parallel computational algorithm is also feasible solution applied, which allocated the loop calculations on the distributed threads (Zhang et al., 2018; Escalante et al., 2018b). However, improvement of nonhydrostatic hydrodynamic models can be also reached with a low implementation cost method, on this paper we focus in novel free-surface boundary condition to properly addresses the free-surface nonhydrostatic pressure, in order to reaching satisfactory results without changing the momentum equations.
Two different types of boundary conditions may be applied for nonhydrostatic pressure at the free-surface: (a) a homogenous Dirichlet condition, which pressure is set equal zero at the free-surface (e.g. Kanarska and Maderich, 2003; Stelling and Zijlema, 2003; Wang et al., 2009; Zhang et al., 2018) and (b) a Neumann condition, usually a hydrostatic relation to approximate pressure's value equal to zero at the free-surface (e.g. Casulli, 1999; Namin et al., 2001; Monteiro and Schettini, 2015; Bohacek et al., 2018), Both types of free-surface boundary condition were well discussed in Bergh and Berntsen (2009). However, many numerical models solve the Poisson's equation for pressure at the center of the computational cell (e.g. Jankowski, 1999; Yuan and Wu, 2004; Casulli and Lang, 2004; Liu et al., 2017; Bohacek et al., 2018), which may incorrectly address the nonhydrostatic boundary condition to the top layer instead at the free-surface, if a suitable treatment is not performed. This assumption becomes more inaccurate as the distance between the center of the top layer and the free surface increases, hence a high vertical resolution (1-20 layers) is needed in order to achieve accurate results for different case studies (Stelling and Zijlema, 2003; Yuan and Wu, 2004; Zijlema and Stelling, 2005; Cui et al., 2012; Lv, 2014; Liu et al., 2017).
In addition to using a suitable vertical discretization, Yuan and Wu (2004) and Zijlema and Stelling (2005) showed that cell-center nonhydrostatic models may have a significant accumulated phase error after several wave periods due to the wrong computation of wave celerity. Many efforts were carried out in order to properly overcome this issue, of which we can highlight: (a) an implementation of edge-based nonhydrostatic pressure (e.g. Stelling and Zijlema, 2003; Lu et al., 2015), (b) the use of an integration method to estimate the pressure at the free-surface based on pressure in the center of the top layer (e.g. Yuan and Wu, 2004; Lv, 2014; Liu et al., 2017, and and (c) the use of a piecewise linear profile of the non-hydrostatic pressure to estimate the pressure at the free-surface (e.g. Escalante et al., 2018a. For the existing cell-centered models, the previous algorithms may demand a substantial implementation cost due to substantial changes, at least, in the vertical momentum discretization and in the treatment needed to properly address the nonhydrostatic pressure at the free-surface boundary condition. Thus, in order to improve the nonhydrostatic hydrodynamic solution with low cost of implementation, we proposed a novel free-surface boundary condition based on a fictional sublayer at the free-surface (FSFS)
We applied the FSFS and the CBA approachs at a finite difference discretization with a fractional step framework based on Casulli and Lang (2004), which uses a Neumann type of boundary condition which apply a hydrostatic relation in the top layer. To evaluate the model performance, we used two widely applied numerical models benchmarks (Dingemans, 1994; Jankowski, 1999; Casulli and Lang, 2004; Yuan and Wu, 2004; Fringer et al., 2005; Liu et al., 2017; Yin et al., 2017), which were selected to test our algorithm in two different purposes: (a) a standing wave in a three-dimensional closed basin to test the model's capability in solving wave celerity under different vertical resolutions; and (b) a wave propagation over a submerged bar to validate the proposed boundary condition at the free-surface and evaluated the effect of vertical resolution under a non-linear wave propagation.
89
90
91
92
93
2 Mathematical considerations
2.1 Governant equations
The RANS equations are used to describe three-dimensional free-surface flows. These equations express the physical principle of volume, mass, and momentum conservation. The momentum equations for an incompressible fluid have the following form:
du du du du	dpa dn
dt + udX + vdy + wdZ -fv = -dx - 9ax
d
- 9dX
dZ
P
dq h i d2u d2u\ d i v du\ dx + V dx2 + dy2) + dz\ dz )
(1)
dv dv dv dv	dpa dv
dt+ udX+ vdy+ wdZ- fu = - xy - 9dy
9 dy
P - P0
P0
dZ- I + vh
d2v d2v\
dx2 + dy2)
d + dZ
dw
dw
dt
dw
+ ' + dx dy
dw w~dZ
dq h( d2w d2w. d dz + V ( dx2 + dy2	' dz
(2)
(3)
94
95
96
97
98
99
100
101
102
103
104
105
where u(x,y,z,t), v(x,y,z,t), and w(x,y,z,t) are the velocity components in the horizontal (x and y) and vertical (z) directions, respectively; where vh e vv are the horizontal and vertical turbulent eddy viscosity coefficients, respectively; t is the time; pa(x,y,z,t) is the atmospheric pressure; n is the free surface elevation from a water level reference. The second and the third terms on the right- hand side of equations (1) and (2) represent the barotropic and the baroclinic contributions to the hydrostatic pressure; q(x,y,z,t) denotes the nonhydrostatic pressure component; f is the Coriolis parameter; and 9 is the gravitational acceleration.
When a simple hydrostatic approach is considered, equation (3) is neglected and q is assumed to be equal to zero in equations (1) and (2). In this case, it is assumed that vertical acceleration do not have a significant effect in the velocity field in comparison with horizontal acceleration.
The volume conservation is expressed by the incompressibility condition and the continuity equation, given by:
du dv dw	0
dx ' dy ' dz
106
(4)
Integrating equation (4) over depth leads to the following equation:
n
h
n
h
Zn
h
du dv dw
dz =
Zn
h
du , ~z~dz + dx
dv , ~z~dz + dy
xrdz = 0
dz
(5)
dx ' dy ' dz
107
108
109
where “h” is the bathymetry measured from theoretical undisturbed water surface (zero referential). Using the Leibniz integration rule, in each direction, in equation (5) and using a kinematic condition at the free-surface leads to the following free-surface equation:
n
h
n
h
110
111
112
113
114
115
dn d dt ' dx
j	d
udz + — dy
vdz = 0
(6)
Finally, the mass conservation of a conservative scalar variable may be expressed by the following equation:
dC d(uC) d(vC) d(wC) dt ' dx ' dy ' dz
= d(Khdc) + d(KhdC). d Koc\ dx( dx ) + dy (K dy )+ dz 1 dz)
(7)
where C is the concentration of a conservative substance being transported (e.g., salinity); Kh and Kv are the horizontal and vertical turbulent eddy diffusivity coefficients, respectively.
For both the velocity field and scalar transport solutions, the boundary conditions are implemented under the assumption of “free-slip” boundaries. The Dirichlet and Neumann conditions were assigned
117
118
119
to represent the normal and tangential velocities in the solid boundaries, respectively. For the scalar solution, a no-flux boundary condition is assumed in solid boundaries.
The tangential stress boundary conditions for the momentum equations (Equations 1 and 2) at the free-surface are specified by the prescribed wind stresses, which can be approximated as:
vdu	(	) vdv	(	)
v dz = Yt(ua - u),v — = Yt(va - v);
(8)
120
121
where ua and va are the horizontal wind velocity components coefficient. The bottom friction is specified by:
and yT is a nonnegative wind stress
vdu	vdv	,
v	= YB u,v	= YB v; at z = -.
dz	dz
(9)
122
where yb is a nonnegative bottom friction coefficient.
123
124
125
2.2 Grid and Variables Locations
The computational grid can be described as a generic unstructured orthogonal grid, having Np elements, each having an arbitrary number of sides Si &gt; 3,i = 1, 2,..., Np (Figure 1).
at z = n
126
127
128
129
130
131
132
* 7
Let Ns be the total number of sides in the grid. The length of each side is Xj, j = 1, 2, ..., Np. The vertical faces of the i — th element are identified by an index j(i,i), l = 1, 2, ..., Si, so that 1 &amp;lt;j(i,l) &amp;lt;Ns. Similarly, the two polygons which share the j — th vertical face of the grid are identified by the indices i(j,i) and i(j,2), so that 1 &amp;lt;i(j,i) &amp;lt;Np and 1 &amp;lt;i(j,2) &amp;lt;Np. The nonzero distance between centers of two adjacent polygons which share the j — th side is denoted with 3j. Along the vertical direction a simple finite difference discretization, not necessarily uniform, is adopted. By denoting with Azk+1 a given top computational cell level surface, the vertical discretization step is defined by
133
134
135
136
137
138
139
140
141
Azk = Azk+z — Azk_1 k = l,2, ...,NS	(10)
The three-dimensional spatial discretization consists of elements whose horizontal faces are the polygons of a given orthogonal grid, represented by the layers at k + 1 (upper face) or k — 2 (bottom face), whose height, for each layer, is Azk. The water surface elevation (n), is located at the barycenter of the upper horizontal face for each i — th element. The velocity component normal to each horizontal face is assumed to be constant over the face of each computational cell, which is defined at the point of intersection between the face and the segment joining the centers of the two prisms which share the face; the non-hydrostatic pressure component q™k and the concentrations C" k are located at the center of the i — th computational cell, half way between Azk+1 and Azk1. Finally, the water depth hj is specified and assumed constant on each vertical face of an element.
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
157
158
159
160
161
162
163
2.3	Numerical Approximation
We used a semi-implicit method (0-Method Casulli, 1990) of finite volume, with an Eulerian Lagrangian Method (Casulli and Cheng, 1992) to solve the convective and viscous terms of the RANS equations, which applies a quadratic interpolation (see Hodges et al., 2000) to estimate the velocity field at the end of backtracking process (multi-step backward Euler with 10 sub-time steps). A fractional-step framework (Casulli and Lang, 2004) is used to solve pressure component by splitting in hydrostatic and nonhydrostatic parts. A complete description of numerical solution may be found in Casulli and Lang (2004). Below, we outlined the algorithm procedure:
1.	Definition of initial parameters, initial conditions and boundary condition
2.	Solution of convective terms using the Eulerian-Lagrangian Method
3.	Determination of the provisional free-surface elevation (fj) through the preconditioned conjugate gradient iterations until the residual norm is smaller than a given tolerance eq.
4.	Numeric solution of provisional velocity field (j and w)
5.	Solution of nonhydrostatic pressure (q) through the preconditioned conjugate gradient iterations until the residual norm is smaller than a given tolerance eq.
6.	Numeric correction of velocity field and free surface elevation
Here we described separately the conventional nonhydrostatic pressure discretization with the given boundary condition, and how the FSFS boundary condition is applied in the conventional solution in order to improve the nonhydrostatic hydrodynamic solution.
2.3.1 Nonhydrostatic pressure discretization
A correction of provisional velocity field (un+1 ,wj+1) are computed after including the nonhydrostatic pressure terms, specifically:
n+1 _ fn + 1 j, k	Uj, k
0— (qn+1	_ jn+1 A
j \qi(j,,k qi(j,i),kJ
(11)
n+1 j k
_ wn+1
0____—_____(jn+1 _ qn+1 )
0	, [-qi,k+1	qi,k+1)
—Zi,k +1
(12)
u
w
164
165
166
167
where the vertical space increment —z is defined as the distance between two consecutive level surfaces, except near the bottom and near the free surface where —z is the distance between a level surface and the bottom or free-surface, respectively. q denotes the nonhydrostatic pressure term, which in combination with the provisional free-surface elevation (rf), gives the pressure:
168
169
170
pn+1 _ fifn+1- zk)+(13)
where zk is the z-coordinate of the k — th horizontal level surface and g is the gravity acceleration. In each computational cell bellow the free-surface, the finite volume discretized incompressibility condition is taken to be:
St
LL Si,L jiL)—Zj(i,L),kUj(i,L),k ' Pi
L=1
W++ i
-w
n+1
i,k-
1
2
_0
(14)
k _ m,m + 1,.. . ,M
171
172
173
where Pi is the area of the i — th polygon and Si is the number of sides for the i — th element. At the free-surface, the finite difference approximation of equation (6) considering w" m'' 1 _ 0 and using the incompressibility condition (14) is:
st
Pinn+1 _ Pinn — 0—t^
i=1
\Si,i^j(i,L)—Zj(i,i),M Uj(t,i),M]
+ 0—tPiw
n+1
i,M -
1
2
Si
— (1 — 0)
i=1
M
si,lji,l)	—Zj(i,i),kUj(i,i),k
k=m
174
175
176
177
178
179
180
181
182
183
184
185
186
187
188
189
where 6 is the implicitness factor, Si,i is sign function associated with the orientation of the normal velocity defined on the l side of an element i. Assuming that the pressure at the FSFS is hydrostatic, the pressure correction term (qn+d) is obtained by the following hydrostatic relation:
pnM = g bin+1 -	= g cn+1 - zC + v
hence, equation 13 becomes:
(16)
Si
p-	= gPi n - ñn+1] - gOAt v
L=1
^Si,L^j(i,L)Azj(i,L),M uj(t,L),M + gOAtPi
n + 1
i,M -
Si
- g (1 - O) At^
L=1
M
Si,L^j(i,L)^2 AZn(i,L),kU'j'(i,L),k
k=m
(17)
w
1
2
A system of equations to solve nonhydrostatic pressure is now derived by substituting the expressions for the new velocities from (11-12) into (14) and (17), respectively. The following finite difference equations are obtained
gO2 At2
Si
'^2si,LXj(i,l)Azn(i,i),k
_l=1
qn+1	_ qn+1
qi[j(i,l),1],k	qi[j(i,l) ,2],k
$j (i,l) ,k
+ Pi
qn+1 _ qn + 1 qi,k	qi,k+1
Azn i
i,k+ 2
Azn
i,k
qn+1 _ qn+1 qi,k-1	qi,k
1
2
= gOAtPi (Wn+l i
- Wn+1 i)
Si
-	■ A	k jikk•
l=1
(18)
and
gO2 At2
Si
y^si,L^j(i,l)Azj(i,l),M
_l = 1
qn + 1	_ qqn+1
qi[j(i,l),1],M	qi[j(i,l),2],M
ji,l),M
- Pi
qn+1 _ qn + 1 qi,M-1 qi,M
Azn
i,
M-
+ P-a71*1 —
+ Piqi,M ~
k — m,m + 1,... ,M - 1.
1
2
Si
gOAtPiWnM-1 - gOA^8i,L Xj(i,l) (Azfsfs	- ^+1)-
l=1
(19)
Si	M
g(1 - o)At^2[si,Lxj(i,l) 52Az?(i,l),kk — M
l=1	k=m
Once computed the nonhydrostatic pressure terms, the velocities field are corrected by equation (11), while vertical velocity can be estimated, equivalently, by equation (12) or by the incompressibility condition (14) by setting wn+1+1 = 0:
w
n + 1 i,k +1
—w
n+1
i,k-
1
Pi
Si
52 Si,LXj(i,L)Azj(i,L),k Uj(i,L),k•
L=1
k — m,m + 1,.. . ,M - 1
(20)
1
2
This equation guarantees that the resulting velocity field is exactly discrete divergence free (Casulli and Lang, 2004), thus we use this equation to compute the vertical velocity components.
The final free surface elevation is obtained by the hydrostatic relation (16) as follows
TA ■1
nn+1 — ñ™+1 + Oi,M + 1 n	!i	g
Finally, the nonhydrostatic pressure component can be obtained by:
qn+1 — 7A ' ' _ On + 1 • qi,k ~ qi,k	qi,M + 1’
k — m,m + 1 , . . . ,M,M + 1
(22)
making the non-hydrostatic pressure at free-surface equal to zero (i.e. for k = M + 1).
190
191
192
193
194
195
196
197
198
2.3.2 Free-surface boundary condition treatment
To apply the Fictional Sublayer at the Free-Surface (FSFS) into the existing computational domain is only required one additional numerical vertical layer in the top of computational domain, which does not account to the computational domain. As the height of the FSFS is assumed to be equal to zero, the hydrostatic relation can be always guaranteed at the free-surface, independent of the number of vertical layers. To use this method only is required a simple adaption in the numerical equations (18-19), considering the type of the layer:
i)	For bottom and middle layers (i.e. k — m to M — 1), the equation (18) is applied using its original form:
gO2 At2 *
■ Si
,si .	1
j=i
— AzfSFS
~n + 1	_ ~n+1
qi[j(i,l),1],M	qi[j(i,l),2],M
ji,l),M
Pi
qn + 1 _ qn + 1 qi,M	qi,M + 1
Azn
AZi,M +1
Azn
i,
qn+1 — qn+1 qi,M-1 qi,M
M-
1
2
- g°Atpe.p m i—sn+ei)
(23)
,l),M
Si
g°AtF Si,Lji,l) (AZj(i,l),M — AzFSFs) ji^.M; k - M l=1
199
200
ii)	For the top layer (k — M), equation 18 is adapted to take into account the influence of FSFS height (AzFSFS ) in Azn,M +1 and Azni,l),k:
201
202
203
204
Zi,M +1 — 2 [(.Azi,M — AzFSFS) + AzFSFs] — 2 (Azi,M)	(24)
Azi,M- 2 — 2 \iAzn,M — AzFSFS) + Azi,M-1]	(25)
iii)	For the FSFS layer (k — M + 1), equation 19 is adapted to take into account the FSFS height and the velocity field in the layer M. Preliminary simulations showed that making Azfsfs — 0 a stable solution is achieved for any vertical discretization:
gO2 At2
Si
^^SiLjil (Azfsfs)
_l=1
;rn+1	_ ~n+1
qi[j(i,l),1],M + 1	qi[j(i,l),2],M + 1
$j(i,l),M
qn + 1 _ qn + 1
p qi,M	qi,M + 1
i Azn
i,(M + 1)-1
i p-qn+1	—
+ Piqi,M + 1 ~
Si
.'A'P 2 — g6AtY^i,Lj.i,l)(AzFSFS	)
l=1
Si	M
— g(1 — O)At^f [si,Lji,l)F Azjn(i,l),kujn(i,l),k;	k — M + 1
l=1	k=m
(26)
205
where
n
Azi,(M + 1)-1
2 [(Azi,M — AzFSFS) + AzFSFs] — 2 (Azi,M)
(27)
206
207
208
209
210
3	Numerical Experiments
The proposed numerical approach was applied in two consolidated benchmarks usually use to verification and validation of numerical models Dingemans (1994); Jankowski (1999); Casulli and Lang (2004); Yuan and Wu (2004); Liu et al. (2017); Yin et al. (2017). Each numerical experiment has a
different purpose, as follows:
212
213
214
215
216
217
218
219
220
221
222
223
224
225
226
227
228
229
230
231
232
233
234
235
236
237
238
239
a Standing waves in a three-dimensional closed basin. This test case was widely applied in licterature, verifies the model capability of simulating 3D linear waves comparing the analytic solution with the numerical solution in regard of phase and amplitude representation (Yuan and Wu, 2004; Zijlema and Stelling, 2005; Monteiro and Schettini, 2015; Liu et al., 2017). We evaluated the model capability in calculate the wave celerity and frequency wave dispersion with the Classic Boundary Approach (hereafter named CBA) and with the proposed FSFS boundary condition under 6 different vertical resolutions comparing the free surface elevation cumulative phase error, the mean computational cost of one time-step, the number of wave periods and the relation with the free surface vertical velocity after 30 seconds of simulation in comparison with the analytical solution. We also compared the free surface elevation results with a few metrics (RMSE, BIAS, Volume Error, KGE, NSE) and statistically tested the residual series (difference between analytical and simulated results) with nonparametric Kruskal-Wallis test follow by a post-hoc Nemenyi to identify significative difference in relation to the analytically results. The mean time of one time-step simulations was computed using an Intel® Xenon(R CPU-E5-1620 3.7 GHz computer with 32 GB of RAM memory in a Fortran based numerical model.
b The wave propagation over a submerged bar was an experimental model idealized by Beji and Battjes (1993), and was frequently used to validate numerical models (e.g. Beji and Battjes, 1994; Dingemans, 1994; Stelling and Zijlema, 2003; Yuan and Wu, 2004; Cui et al., 2012; Yin et al., 2017. The experiment was used to evaluate the accuracy to represent a non-linear wave pattern due to physical changes at the bottom, by comparing free surface elevation between the FSFS approach with a different vertical resolution between simulated and experimental results. The performance of the model was evaluated with a few metrics (RMSE, BIAS, Volume Error, KGE, NSE) and also by statistically tested the residues series with nonparametric Kruskal-Wallis test follow by a post-hoc Nemenyi test.
3.1	3D standing waves in a closed basin
The flow induced by an initial wave amplitude set to 0.1 m in a closed cubic basin with 10 m of edge was analyzed (figure 2). The spatial domain was discretized using a regular grid of 0.5 m resolution, resulting in 8.000 computational cells. The time step and the total simulation time was 0.01 s and 30 s, respectively. The analytic solution of free-surface water elevation is given by:
240
241
242
243
Fig. 2: The initial free-surface profile for a linear 3D standing wave oscillation in a closed basin. source: Yuan and Wu (2004)
n = A cos (kXx) cos (kyy) cos 2^—	(28)
where t is the time (the initial condition in the free surface may be obtained by doing t = 0), T is the wave period equal to 3.1os, with the wave number kx = ky = n/L with the total wave numberk = -y/kX + ky = 0.44-^. The analytic solution for each velocity component is described as follows:
Agkx cosh [kx (h + z)] cosh (kxh)
sin (kxx) cos (kyy) sin (wt)
(29)
u
w
244
245
Agky cosh [ky (h + 2)]
w cosh (kyh)
cos (kxx) sin (kyy) sin (wt)
Agkx sinh [kx(h + 2)]
w	cosh(kxh)
cos (kxx) cos (kyy) sin (wt)
246
247
248
249
250
251
252
253
254
255
256
257
where w is giving by:
w = ygK tanh (Kh)
(30)
(31)
(32)
The case study was applied under different vertical resolution scenarios (i.e. 20, 16, 13, 10, 8 and 5 vertical layers), with both CBA and the proposed FSFS condition (called methods). We evaluated the cumulative phase error of a 3D standing wave by comparing the model outcomes (i.e. free-surface elevation and free-surface vertical velocity component) at x = y = 0.25 m with the analytical solution. The performance between boundary condition approaches was evaluated by comparing the free surface elevation residuals, and the performance between scenarios (considering different number of vertical layers) was also evaluated by statistically tested the residues with nonparametric Kruskal-Wallis test follow by a Nemenyi test, since the residues series do not follow a normal distribution (shapiro-wilk) and have unequal variance (Bartlett test). The test aiming to identify a critical vertical resolution for the FSFS method where the results are significative different from the best scenario for this benchmark (20 vertical layers).
-----CBA-20L ---------CBA-liL - - CBA.-13L-----------CBA-10L --------Analytic
Fig. 3: Free surface elevation at x = y = 0. 25 m for 30 seconds of simulation comparing analytic solution (solid black line) with simulated solution for 20 to 5 layers scenario with FSFS condition (left side) and for CBA condition (right side). At the bottom, we compare methods thought the 20 layer scenario and 8 layers scenario.
U =
w
258
259
260
261
262
263
264
265
266
The results showed an increase of phase error (&amp;amp;£) with a reduction of the number of layers for both method for instance, the phase error for FSFS20-L increased from 0.3 s, with 20 layers, to 0.4, 0.6, 1, 1.5 and 2.1 seconds for 16, 13, 10, 8 and 5 layers, respectively (table 3). The results obtained considering the simulation with CBA approach shows higher phase error, which the 20-layer CBA simulation had similar results with the 8-layers FSFS simulation (figure 3). The increased phase error from the low vertical resolution results (less than ten) difficulties the direct comparison between methods due the increases of wave periods, which may appear the FSFS-5L results better than the FSFS-10L. The cumulative residual free surface elevation (figure 4) clarify the matter. In general, the error increases over time step and it becomes higher with the reduction of number of layers, however, when phase error is critical, the number of wave periods (N°T) increases, which reduced the cumulative free surface elevation error,
Fig. 4: Free surface elevation accumulated residuals series for FSFS approach (left) and for CBA approach (right), at x=y=0.25 m for 30 seconds of simulation, comparing different layers scenarios
Table 1: Metrics between the analytical and simulated results from the FSFS method for each scenario for the first 10 seconds of simulation
Metrics	FSFS-20L	FSFS-16L	FSFS-13L	FSFS-10L	FSFS-8L	FSFS-5L
RMSE (mm)	7.40	11.52	18.29	30.53	45.30	89.20
BIAS (mm)	0.32	0.32	-0.77	-2.11	-3.54	-7.61
Error (%)	9.25	14.28	22.55	37.79	56.60	114.13
KGE	0.93	0.93	0.82	0.52	0.18	-0.88
NSE	0.99	0.97	0.93	0.81	0.57	-0.66
Table 2: Statistics metrics between the analytical and simulated results from the CBA method for each scenario for the first 10 seconds of simulation
Metrics	CBA-20L	CBA-16L	CBA-13L	CBA-10L	CBA-8L	CBA-5L
RMSE (mm)	47.06	57.68	68.75	83.48	95.63	107.80
BIAS (mm)	-4.35	-5.65	-6.88	-7.96	-7.57	-1.06
Error (%)	58.94	72.70	87.10	106.42	123.39	145.02
KGE	0.004	-0.30	-0.61	-0.91	-0.93	-0.20
NSE	0.54	0.31	0.017	-0.45	-0.90	-1.42
Table 3: Computational cost, Phases Error and number of wave periods between different methods and scenarios. The model was implemented with Fortran and simulated in a machine using an Intel R Xenon R CPU-E5-1620 3.7 GHz computer with 32 GB of RAM memory
N L	At(s)	FSFS No T		At(s)	CBA	
					No T	
20-Layers	2.8	10	0.3	2.62	10	1.6
16-Layers	2.21	10	0.4	2.14	10	2
13-Tayers	1.68	10	0.6	1.67	10	2.4
10-Layers	1.54	10	1	1.45	11	3.1
8-Layers	1.51	10	1.5	1.34	11	3.8
5-Layers	1.22	11	2.1	1.08	12	4.6
268
269
270
271
272
273
274
275
276
277
therefore, the calculated metrics (table 1 and 2) was only comparable between 0 and 10 s of simulations (figure 4). This effect can be better verified by the CBA accumulated residual series when the graphic changes the slope, which occurs sooner as the number of layers reduced (figure 4).
All statics metrics indicated a decreases of performance with a reduction of the number of layers. The metrics show that CBA-20L simulation had similar results as the FSFS-8L, as well CBA-10L to FSFS-5L. The CBA method also had a decreases of performance with a reduction of vertical resolution (tables 1 and 2). When CBA method is used, the phase error was 2 to 5 times higher, and with little difference in computational cost (ca. 7% smaller) (table 3) in comparison with FSFS method. We found a phase error similar with previous works using 20 — layers with CBA method (Yuan and Wu, 2004; Zijlema and Stelling, 2005).
278
279
280
281
The statistical test for FSFS approach showed significant differences between low (below 10 layers) and high (above 13 layers) vertical resolution, considering the free surface elevation residuals, which means, the simulation with 20 to 10 layers has similar (see table 4) and acceptable results (tables 1 and
2).
Table 4: Nemenyi posthoc test comparing the FSFS residue series of the simulation with 20 to 5 vertical
layers to indentify significative statiscal difference between results
No-L	FSFS-20L	FSFS-16L	FSFS-13L	FSFS-10L	FSFS-8L
FSFS-16L	0.97833	-	-	-	-
FSFS-13L	0.24554	0.69401	-	-	-
FSFS-10L	&amp;lt;0.05	&amp;lt;0. 05	0.05269	-	-
FSFS-8L	&amp;lt;0.05	&amp;lt;0. 05	&amp;lt;0. 05	&amp;lt;0. 05 -	
FSFS-5L	&amp;lt;0. 05	&amp;lt;0. 05	&amp;lt;0. 05	0.70396	0.5515
Fig. 5: Free surface vertical velocity (w) at x=y=0.25 m for 30 seconds of simulation comparing analytic solution (solid black line) with simulated solution for 20 to 5 layers scenario with FSFS condition (left side) and for CBA condition (right side). At the bottom, we compare methods thought the 20 layer scenario and 8 layers scenario.
0
282
283
284
285
286
287
288
289
290
291
292
Our findings indicated that accuracy of vertical velocity component is affected by the vertical resolution applied, influencing directly the representation of wave phase (figure 5). For FSFS method, we have noted that the magnitude of vertical velocity components increases if one uses a vertical discretization up to 10 layers and the magnitude of vertical velocity components decreases for a vertical discretization above 10 layers (Figure 5). For CBA approach the magnitude of vertical velocity components decreases above 16, leading to a less flexible critical vertical resolution. Moreover, we also observed that the variation in horizontal resolution did not affect by wave phase representation, which seems to be more directly related with the wave damping (not analyzed in this paper).
3.2	Wave propagation over a submerged bar
A scheme of the experiment of the wave propagation over a submerged bar with an uneven bottom may be seen in (Fig. 6) (Beji and Battjes, 1993). At the upward slope of the bar, the shoaling wave
293
294
295
296
297
298
299
300
301
302
303
304
305
306
307
308
309
310
311
312
313
314
315
316
317
318
319
320
321
322
323
324
325
326
327
328
329
330
becomes non-linear due to the generation of bound higher harmonic. At the downward slope, the depth increases rather fast and these harmonics become free, resulting in an irregular pattern of waves (Dingemans, 1994). The numerical reproduction of this pattern has shown to be very demanding in terms of the accuracy of the computed dispersion frequency (Stelling and Zijlema, 2003).
Fig. 6: Scheme of experimental bottom geometry and location of wave level gauges. Source: Beji and Battjes (1993)
The computational domain has a total length of 30 m, with an initial undisturbed water level of 0.4 m, was discretized using a regular grid of 0.025 m resolution. The time step and the total simulation time was 0.005 s and 39 s, respectively. At the left boundary a sinusoidal wave condition, with period T = 2 s and amplitude A = 0.01 m, was imposed to represent the wave generator of the original experiment. At the right outflow boundary, the experimental absorbed beach was computationally represented by a 5m — sponge layer with a combination of a sponge layer technique (Park et al., 1999) and a Sommerfeld-type radiation boundary condition, applied to minimize wave reflection, given by:

(.zm-A	ui
if Xi &gt; Xio
if Xi &amp;lt;0
(33)
where ei is the sponge layer coefficient, xi0 is the initial point, li the total length. This term must be added in the right side of equation (1) and (2).
We evaluated the capability of the model in correctly simulating the dispersion properties of the flow comparing simulated and measured free-surface elevation between 33 and 39 s of simulation under different vertical discretization scenarios using the proposed FSFS approach, since the first numerical experiment showed that the CBA method only may reach similar results to FSFS approach using a higher number of layers (figure 3). The FSFS approach was tested for 20, 16, 10, and 5 vertical layers comparing the free surface elevation at the six stations with the measurements of free-surface elevation. The performance of each scenario was evaluated by a few metrics (RMSE, BIAS, Error, KGE, NSE) and also statistically tested using a nonparametric Kruskal-Wallis test in the residues series follow by a Nemenyi test, since the residues series do not follows a normal distribution (shapiro-wilk) and have the same variance (Bartlett test).
The results (figure 7) indicated that the non-linearity after the upward slope (a), at the beginning and the middle of downward slope (b-c) were well represented by vertical resolutions from 20 to 10 layers, by comparing the experimental results patterns of Higher Amplitude Waves (HW) (e.g. 36.5s station b) and Low Amplitude Waves (LW) (e.g. 36s station a). For the stations (d), (e) and (f), after the deshoaling process, the simulations using 10, 16 and 20 layers were less accurate in representing the non-linearity pattern. Specifically, the LW in station (d) (e.g. 35 to 36s) and the HW in stations (e) and (f) (36s at station f). The 5-layers scenario showed the lower performance in comparison with the other scenarios, with an oscillatory behavior for the HW In stations (a) and (b), substantial phase errors (station c) and low capacity to represent LW and HW amplitudes (stations e and f).
The FSFS results (table 5) was capable in satisfactorily representing the phase, amplitude and wave patter for all stations using a higher vertical resolution (20 to 10 layers with FSFS method) (NSE from 0.94 to 0.5). Although, the results had high RMSE and Bias (between 13.7 and -9.9) relative to the mean maximum and minimum amplitudes for the six stations (4.1 and -6.3 mm) and had high Volume Error (between 26% and 116%), always underestimating the free-surface level, and with low performance in KGE parameter due the increased Volume Error. As we can see in figure 7, the high Volume Error
Fig. 7: Comparisons between experimental (circles) and computed data with 20-layers (solid black), 16-layers (dashed gray), 10-layers (solid red) and 5-layers (dashed blue), at 6 different level gauges.
Table 5: Statistics metrics between simulated and experimental results for the six stations for each used layer scenario with FSFS method
M	Station a: x = 13.5 m				20L	Station d: x = 17.3 m		5L
	20L	16L	10L	5L		16L	10L	
RMSE (mm)	2.67	2.31	3.40	5.23	4.12	4.08	5.57	8.05
BIAS (mm)	-0.67	-0.70	-1.26	-2.70	-0.60	-0.44	-1.34	-3.14
Error (%)	26.47	25.37	34.07	53.94	59.29	57.97	79.03	116.84
KGE	-0.95	-1.06	-2.69	-6.92	-4.57	-3.06	-11.30	-27.85
NSE	0.92	0.94	0.87	0.69	0.76	0.76	0.56	0.08
		Station b: x	= 14.5 m			Station e:	x = 19.0 m	
RMSE (mm)	3.68	4.21	4.18	6.74	4.30	4.23	5.69	7.22
BIAS (mm)	-0.80	-0.73	-1.23	-2.58	-0.65	-0.50	-1.39	-3.28
Error (%)	37.73	43.83	44.30	76.27	48.15	47.35	62.91	75.29
KGE	-0.83	-0.68	-1.80	-4.88	-54.45	-41.24	-117.00	-277.78
NSE	0.82	0.77	0.77	0.41	0.72	0.72	0.50	0.20
		Station c: x	= 15.7 m			Station f:	x = 21.0 m	
RMSE (mm)	3.91	3.64	5.45	7.64	4.57	4.59	5.61	7.09
BIAS (mm)	-0.63	-0.48	-1.37	-3.32	-0.65	-0.48	-1.38	-3.25
Error (%)	44.46	40.98	62.63	88.06	56.63	56.12	67.62	76.43
KGE	-1.13	-0.63	-3.58	-10.09	-9.80	-7.09	-22.02	-53.11
NSE	0.79	0.82	0.60	0.21	0.69	0.68	0.53	0.24
331
332
333
334
335
336
337
338
339
is expected. Moreover, the Kruskal-Wallis and Nemenyi statistical tests did not indicate a significant difference between the residues series, except in the station A for 5 layers scenario.
4	Discussion
The statement that: algorithms which define nonhydrostatic pressure at the center of free-surface computational cell needs 10 to 20 vertical layers to resolve wave frequency dispersion to an acceptable accuracy, were wildly reported to justified the use or the proposal of new approaches to the free-surface boundary conditions for non-hydrostatic pressure and momentum equation discretization (Stelling and Zijlema, 2003; Yuan and Wu, 2004; Zijlema and Stelling, 2005; Cui et al., 2012; Lv, 2014; Liu et al., 2017). In general, this vertical resolution limitation is addressed to a classic finite difference discretization
340
341
342
343
344
345
346
347
348
349
350
351
352
353
354
355
356
357
358
359
360
361
362
363
364
365
366
367
368
369
370
371
372
373
374
375
376
377
378
379
380
381
382
383
384
385
386
387
388
389
390
391
392
393
394
395
with cell center nonhydrostatic pressure without boundary treatment at the free-surface computational cell (e.g. Casulli and Lang, 2004).
The improvement of nonhydrostatic hydrodynamic solution is due to the capability to set the values of dynamic pressure close to zero at the free-surface instead to the top layer, for any vertical resolutions using a FSFS condition. In a classic boundary approach, as expected the calculated nonhydrostatic pressure in the top layer increased with the reduction of the number of layers, differently when the proposed FSFS condition is used, which lead to a physically consistent numerical solution.
The results showed that the wave phase representation of short waves in deep water conditions (H &gt; 0.5m) are related with the contour condition for the nonhydrostatic pressure at the free-surface, but also is influenced by vertical momentum discretization applied. Our findings showed that the proposed boundary condition for nonhydrostatic pressure at the free surface was capable to improve substantially the model capability in solving wave celerity and wave frequency dispersion in relation to the classic boundary condition approach with substantial diminishing in computation time to reach similar results (ca. 173%) and little additional computational cost (ca. 7%) to the same benchmark setup, though with a much higher performance (table 1 and 2).
Besides the boundary condition treatment, the phase representation is also related with the used of a vertical momentum discretization less dependent of the velocity vertical profile. The number of layers may affect the vertical velocity estimative, thus affecting the nonhydrostatic pressure estimation and hence, the free-surface elevation and velocities fields.
We also identify that there is a vertical resolution threshold where the vertical velocity component is highly affected in deep water conditions. When number of the layer is lower than a vertical resolution threshold the wave phase error substantially increases over simulation time and it becomes higher with a reduction of the number of layers. The vertical resolution threshold is less restrictive using FSFS approach (10 layers) in comparison with CBA approach (20 layers). In shallow water conditions, the vertical resolution seems to have a nonsignificant impact on wave frequency dispersion, which the FSFS approach had satisfactory phase representation to 5 layers or more, and also had satisfactory representations of nonlinear behavior, similar to previous work (Casulli and Lang, 2004; Walters, 2005; Cui et al., 2012; Monteiro and Schettini, 2015). In summary, CBA approach may obtain similar results to the FSFS approach if used a feasible vertical resolution, for instance, the 20-layers CBA simulation has similar results to the 8-layers FSFS simulation, although with a substantial gain in computational cost.
When compared with previous works solution (Stelling and Zijlema, 2003; Zijlema and Stelling, 2005; Yuan and Wu, 2004; Lv, 2014; Liu et al., 2017; Escalante et al., 2018a), the proposed approach applied at the free-surface has (i) low cost of implementation and (ii) medium performance. The FSFS approach only required a simple local boundary treatment, and it does not change the vertical moment numeric discretization, as the existing methods. Despite the numerical improvement and simple computational implementation, we observed a limitation imposed by the vertical resolution (number of layers) on the model accuracy, which makes medium performance model. As the vertical discretization influences directly the accuracy of horizontal and vertical velocities (see equations 18, 20, 23, 26) the proposed solution did not have good performance using a reduced number of layers (Less than 10).
All previous methods had satisfactory results with only 2 (Stelling and Zijlema, 2003; Yuan and Wu, 2004; Zijlema and Stelling, 2005; Escalante et al., 2018a) or 4 (Lv, 2014; Liu et al., 2017) layers for the same benchmark, and with similar computational cost for the same benchmark setup (10-layers simulation), 1.54 s (Intel Xenon 3.7 GHz), 1.83 s (Pentium 4 2.0 GHz Yuan and Wu, 2004) and 2.02 s (i7 2.93 GHz) (Liu et al., 2017) (works that registered the mean CPU time), although with CPU time less the 0.4 s for the best scenarios (2 or 4 layers).
Moreover, the results analysis clarify some questions related with the vertical resolution issue for this kind of cell-centered nonhydrostatic model. When a contour treatment is used for non-hydrostatic pressure the vertical resolution threshold can be more flexible, allowing to use approximately 2 times less layer to resolve wave dispersion to an acceptable accuracy in a deep water situation. Despite this paper indicated a threshold of 10 layer with the FSFS approach, more analysis is needed to establish a local relation between number of layers and flow characteristics to properly solve the wave frequency dispersion.
5	Conclusions
The treatment of non-hydrostatic pressure boundary condition at the top layer is mandatory to the numerical model reach satisfactory results compared to other models in licterature (e.g. Chen,
396
397
398
399
400
401
402
403
404
405
406
407
408
409
410
411
412
413
414
415
416
417
418
419
420
421
422
423
424
425
426
427
428
429
430
431
432
433
434
435
436
437
438
439
440
441
442
443
444
445
446
447
448
2003; Zijlema and Stelling, 2005; Cui et al., 2012; Liu et al., 2017). The proposed FSFS approach is a low implementation cost method to improve performance of non-hydrostatic models which can reach satisfactory results with 2 times less layers than CBA approach, hence reducing the mean computational cost of one time-step simulation in ca. 1.7 times, reaching similar results (CBA At = 2.62 s and FSFS At = 1.22 s).
Beside the improvements, the new boundary condition treatment is still limited by the used vertical momentum discretization, leading to low performance with low vertical resolution in a deep water situation (less than 10 vertical layers). In shallow water conditions, the vertical resolution seems to have a nonsignificant impact on wave frequency dispersion. Based on the difference between deep and shallow water condition, more efforts are steel needed to establish a local relation between number of layers and flow characteristics to insure that the model properly solve the wave frequency dispersion with minimum vertical resolution.
6	Acknowledgments
We are grateful to the Coordenação de Aperfeiçoamento de Pessoal de Nivel Superior (CAPES: http://www.capes.gov.br) and to the Conselho Nacional de Desenvolvimento Cientifico e Tecnologico (CNPq: http://www.cnpq.br) of Brazil for the MSc. scholarships awarded to Augusto Hugo Farias da Cunha (grant number: 149819/2017-0). Last but not least we are grateful to the Global Lake Ecological Observatory Network (GLEON: www.gleon.org) for providing a venue and resources for lake science discussions.
References
Beji S, Battjes J (1993) Experimental investigation of wave propagation over a bar. Coastal Engineering 19(1-2):151-162
Beji S, Battjes J (1994) Numerical simulation of nonlinear wave propagation over a bar. Coastal Engineering 23(1-2):1-16
Bohacek J, Kharicha A, Ludwig A, Wu M, Karimi-Sibaki E, Paar A, Brandner M, Elizondo L, Trickl T (2018) A (non-) hydrostatic free-surface numerical model for two-layer flows. Applied Mathematics and Computation 319:301-317
de Brito Jr AN, Fragoso Jr CR, Larson M (2018) Tidal exchange in a choked coastal lagoon: A study of mundau lagoon in northeastern brazil. Regional Studies in Marine Science 17:133-142
Casulli V (1990) Semi-implicit finite difference methods for the two-dimensional shallow water equations. Journal of Computational Physics 86(1):56-74
Casulli V (1999) A semi-implicit finite difference method for non-hydrostatic, free-surface flows. International Journal for Numerical Methods in Fluids 30(4):425-440
Casulli V, Cheng RT (1992) Semi-implicit finite difference methods for three-dimensional shallow water flow. International Journal for numerical methods in fluids 15(6):629-648
Casulli V, Lang G (2004) Mathematical model untrim, validation document 1.0. the federal waterways engineering and research institute (baw), hamburg, germany
Casulli V, Stelling GS (1998) Numerical simulation of 3d quasi-hydrostatic, free-surface flows. Journal of Hydraulic Engineering 124(7):678-686
Chen X (2003) A fully hydrodynamic model for three-dimensional, free-surface flows. International Journal for Numerical Methods in Fluids 42(9):929-952
Cui H, Pietrzak J, Stelling G (2012) Improved efficiency of a non-hydrostatic, unstructured grid, finite volume model. Ocean Modelling 54:55-67
Dingemans M (1994) Comparison of computations with boussinesq-like models and laboratory measurements. memo in framework of MAST project (G8-M), Delft Hydraulics memo H1684 12
Escalante C, Fernandez-Nieto E, de Luna TM, Castro M (2018a) An efficient two-layer non-hydrostatic approach for dispersive water waves. Journal of Scientific Computing pp 1-48
Escalante C, de Luna TM, Castro M (2018b) Non-hydrostatic pressure shallow flows: Gpu implementation using finite volume and finite difference scheme. Applied Mathematics and Computation 338:631-659 Fringer O, Armfield S, Street R (2005) Reducing numerical diffusion in interfacial gravity wave simulations.
International Journal for Numerical Methods in Fluids 49(3):301-329
Hodges BR, Imberger J, Saggio A, Winters KB (2000) Modeling basin-scale internal waves in a stratified lake. Limnology and oceanography 45(7):1603-1620
449
450
451
452
453
454
455
456
457
458
459
460
461
462
463
464
465
466
467
468
469
470
471
472
473
474
475
476
477
478
479
480
481
482
483
484
485
486
487
488
489
490
491
492
493
494
495
496
Jankowski JA (1999) A non-hydrostatic model for free surface flows. PhD thesis, Inst. für Stromungsmechanik und Elektronisches Rechnen im Bauwesen
Kanarska Y, Maderich V (2003) A non-hydrostatic numerical model for calculating free-surface stratified flows. Ocean Dynamics 53(3):176-185
Liu X, Ma Dg, Zhang Qh (2017) A higher-efficient non-hydrostatic finite volume model for strong three-dimensional free surface flows and sediment transport. China Ocean Engineering 31(6):736-746
Lu X, Dong B, Mao B, Zhang X (2015) A two-dimensional depth-integrated non-hydrostatic numerical model for nearshore wave propagation. Ocean Modelling 96:187-202
Lv B (2014) A higher-efficient three-dimensional numerical model for small amplitude free surface flows. China Ocean Engineering 28(5):617-628
Marshall J, Hill C, Perelman L, Adcroft A (1997) Hydrostatic, quasi-hydrostatic, and nonhydrostatic ocean modeling. Journal of Geophysical Research: Oceans 102(C3):5733-5752
Monteiro LR, Schettini EBC (2015) Comparação entre a aproximacao hidrostática e a não-hidrostatica na simulacao numárica de escoamentos com superfácie livre. Revista Brasileira de Recursos Hádricos 20:1051-1062
Munar AM, Cavalcanti JR, Bravo JM, Fan FM, da Motta-Marques D, Fragoso Jr CR (2018) Coupling large-scale hydrological and hydrodynamic modeling: Toward a better comprehension of watershedshallow lake processes. Journal of hydrology 564:424-441
Namin M, Lin B, Falconer R (2001) An implicit numerical algorithm for solving non-hydrostatic free-surface flow problems. International Journal for Numerical Methods in Fluids 35(3):341-356
Park JC, Kim MH, Miyata H (1999) Fully non-linear free-surface simulations by a 3d viscous numerical wave tank. International Journal for Numerical Methods in Fluids 29(6):685-703
Soulignac F, Vincon-Leite B, Lemaire BJ, Martins JRS, Bonhomme C, Dubois P, Mezemate Y, Tchigu-irinskaia I, Schertzer D, Tassin B (2017) Performance assessment of a 3d hydrodynamic model using high temporal resolution measurements in a shallow urban lake. Environmental Modeling &amp;amp; Assessment 22(4):309-322
Stelling G, Zijlema M (2003) An accurate and efficient finite-difference algorithm for non-hydrostatic free-surface flow with application to wave propagation. International Journal for Numerical Methods in Fluids 43(1):1-23
Valipour R, Bouffard D, Boegman L, Rao YR (2015) Near-inertial waves in lake erie. Limnology and Oceanography 60(5):1522-1535
Vilas MP, Marti CL, Adams MP, Oldham CE, Hipsey MR (2017) Invasive macrophytes control the spatial and temporal patterns of temperature and dissolved oxygen in a shallow lake: A proposed feedback mechanism of macrophyte loss. Frontiers in plant science 8:2097
Wadzuk BM, Hodges BR (2004) Hydrostatic and non-hydrostatic internal wave models. Tech. rep., Center for Research in Water Resources, University of Texas at Austin
Walters RA (2005) A semi-implicit finite element model for non-hydrostatic (dispersive) surface waves. International Journal for Numerical Methods in Fluids 49(7):721-737
Wang K, Jin S, Liu G (2009) Numerical modelling of free-surface flows with bottom and surface-layer pressure treatment. Journal of Hydrodynamics 21(3):352-359
Yin J, Sun Jw, Wang Xg, Yu Yh, Sun Zc (2017) A hybrid finite-volume and finite difference scheme for depth-integrated non-hydrostatic model. China Ocean Engineering 31(3):261-271
Yuan H, Wu CH (2004) An implicit three-dimensional fully non-hydrostatic model for free-surface flows. International Journal for Numerical Methods in Fluids 46(7):709-733
Zhang J, Liang D, Liu H (2018) A hybrid hydrostatic and non-hydrostatic numerical model for shallow flow simulations. Estuarine, Coastal and Shelf Science 205:21-29
Zijlema M, Stelling GS (2005) Further experiences with computing non-hydrostatic free-surface flows involving water waves. International journal for numerical methods in fluids 48(2):169-197
Combined use of high resolution numerical schemes to reduce numerical diffusion in coupled hydrodynamic and solute transport models
COMBINED USE OF HIGH RESOLUTION NUMERICAL SCHEMES
TO REDUCE NUMERICAL DIFFUSION IN COUPLED
HYDRODYNAMIC AND SOLUTE TRANSPORT MODELS
Augusto Hugo Farias da Cunha Carlos Ruberto Fragoso Jr. Matheus Henrique Tavares J. Rafael Cavalcanti Marie-Paule Bonnet David da Motta Marques
Artigo submetido no periódico “Environmental Fluid Mechanics", fator de impacto Qualis CAPES: Engenharias I - A2.
Combined use of high resolution numerical schemes to reduce numerical diffusion in coupled hydrodynamic and solute transport models
A. Hugo F. Cunha • Carlos R. Fragoso Jr.2 • Matheus
H. Tavares* 1 • J. Rafael Cavalcanti1 • Marie-Paule Bonnet3 • David Motta-Marques1
1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
Abstract When the ratio of vertical to horizontal motion scales is not small, a non-hydrostatic approach may be necessary in order to accurately simulate three-dimensional free-surface flows in large aquatic ecosystems such as lakes, estuaries, reservoirs and coastal zones. Although the non-hydrostatic approach improves the physical representation of pressure, acceleration and velocity fields, it is not free of numerical diffusion. This numerical issue stems from the numerical solution employed in the advection and diffusion terms of the Reynolds averaged Navier-Stokes (RANS) and solute-transport equations. The combined use of high-resolution schemes in coupled hydrodynamic and solute-transport models is a promising alternative to minimize these numerical issues and determine the relationship between numerical diffusion in the two solutions. We evaluated the numerical diffusion in three numerical experiments, for different purposes. The first two experiments evaluated the potential for reducing numerical diffusion in a hydrodynamic solution, by applying a Quadratic interpolator over a Bilinear, applied in the ELM step-ii interpolation, and the capability of representing the propagation of complex waves. The third experiment evaluated the effect on numerical diffusion of using flux-limiter schemes over a first-order Upwind, combined with the interpolation methods applied in a coupled hydrodynamic and solute-transport model. The high-resolution methods were able to substantially reduce the numerical diffusion in a solute-transport problem. This exercise showed that the numerical diffusion of a hydrodynamic solution has a major influence on the ability of the model to simulate stratified internal waves, indicating that high-resolution methods must be implemented in the numerical solution to properly simulate real situations.
Keywords Numerical Diffusion • Eulerian-Lagrangian method • Interpolation • Flux Limite
1	Introduction
When the ratio of vertical to horizontal motion scales is not small (e.g., flows over abruptly changing bottom topography, orbital movements in short-wave motions, or intensive vertical circulation), a nonhydrostatic approach may be necessary in order to accurately simulate three-dimensional free-surface flows in large aquatic ecosystems such as lakes, estuaries, reservoirs and coastal zones (Marshall et al., 1997; Casulli and Stelling, 1998; Chen, 2003). There is a trade-off between implementation and the computation cost when hydrostatic and non-hydrostatic approaches are compared. The non-hydrostatic approach, in general, requires more-complex interactive numeric methods (Stelling and Zijlema, 2003; Casulli and Lang, 2004), which increases the computation cost compared to the hydrostatic approach using the same computation grid. The non-hydrostatic approach also improves the physical representation of the phenomenon and requires fewer vertical layers to obtain physically satisfactory results than does the hydrostatic approach. Therefore, to obtain similar results, the hydrostatic approach requires more
Hydraulic Research Institute;
1	Federal Univerisity of Rio Grande do Sul, Porto Alegre, Rio Grande do Sul,Brazil
Tel.: +55 51-3308-6670
E-mail: hugo.cunha@ufrgs.br
2	Centro de Tecnologia;
Universidade Federal de Alagoas, Maceió, Brasil
3Laboratoire des Mócanismes de Transfert en Góologie;
3-RD UR 154, 1400 Toulouse, France
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
vertical layers, necessitating a higher computation cost than with the non-hydrostatic approach (Liu et al., 2017).
Whatever the approach (hydrostatic or non-hydrostatic), the numerical-diffusion issue remains critical, and many studies have attempted to reduce it by adopting diverse approaches. Higher-resolution techniques (e.g., quadratic, cubic and spline interpolators and flux limiters) have proven to be a promising alternative in order to minimize these numerical issues (Cheng et al., 1984; Ruan and McLaughlin, 1999; Waterson and Deconinck, 2007; Kong et al., 2013; Ye et al., 2018). Although previous studies showed that higher-resolution schemes might not maintain some important characteristics of a numerical solution (e.g., spurious oscillations of internal waves) (Wang and Lacroix, 1997), they may better represent the nonlinear behavior of a velocity field than low-resolution schemes (Upwind solute-transport solver, bilinear interpolation). Although linear schemes might be more stable, monotonic, and easily implemented, they still might give unsatisfactory results due to higher numerical diffusion. Generally, higher-resolution techniques are applied to reduce numerical diffusion separately in RANS-based (Reynolds averaged Navier-Stokes) or solute-transport models, without determining the relationship with the numerical diffusion caused by the solutions.
The Eulerian-Lagrangian Method (ELM) is one of the most popular and accurate techniques used to numerically solve the advection terms in RANS and solute-transport equations (Cheng et al., 1984; Ruan and McLaughlin, 1999; Cox and Runkel, 2008; Casulli and Cheng, 1992; Jankowski, 1999; Hodges et al., 2000; Wadzuk and Hodges, 2004; Walters, 2005; Fringer et al., 2005; Monteiro and Schettini, 2015). The purpose of ELM is to combine the simplicity of the fixed Eulerian computational grid with a stable and accurate Lagrangian approach. In summary, the ELM has two major steps (Staniforth and Cote, 1991): (i) a particle-tracking method, which consists of obtaining the location of the departure point of a fluid particle in the Lagrangian step by integrating a characteristic equation backward in time using a certain number of sub-time steps; and (ii) a repeated interpolation of the advected field in each sub-time step in order to estimate the velocity components at the departure point. As the result of the interpolation errors in the two steps, the ELM may introduce a substantial numerical diffusion when low-resolution interpolation schemes are used, or spurious oscillation when high-resolution interpolation schemes are used in the hydrodynamic and mass-transport solutions (Cheng et al., 1984; Oliveira and Baptista, 1998; Ruan and McLaughlin, 1999).
The interpolation technique used in the second step has a major impact on the total numerical diffusion produced in ELM, especially when low-resolution interpolation schemes are used, since both particle tracking and velocity retrieval are substantially affected by the interpolation process (Staniforth and Cote, 1991). Accordingly, Hodges et al. (2000) proposed a stable non-conciliatory quadratic Lagrange interpolation for a three-dimensional mesh, where 27 grid points are used to estimate the velocity values during the particle-tracking process. This technique has not yet been formally analyzed (Hodges et al., 2006, without any posterior record of formal analyses), although previous studies successfully modeled hydrodynamic and solute-transport simulations, strongly indicating that the solution satisfactorily represented internal gravity waves and may improve the ability of ELM to solve the free-surface motion (Hodges et al., 2000; Laval et al., 2003, 2005; Hodges et al., 2006; Valipour et al., 2015; Vilas et al., 2017; Soulignac et al., 2017).
The solute-transport solution can also be reached using numerical schemes other than ELM, such as high-order Total Variation Diminishing (TVD) schemes, Random Walk Particle Tracking (RWPT) and Smoothed Particle Hydrodynamics (SPH), which have been thoroughly discussed by Boso et al. (2013). One simple scheme to discretize the mass-conservation equation, with a low cost of implementation, is the first-order Upwind, to which the flux-limiter technique can be applied in order to reduce the well-known numerical diffusion of this discretization (Casulli and Zanolli, 2005; Zhang et al., 2018). The flux-limiter scheme proved to be one of the most effective approaches to constructing a nonlinear high-resolution scheme (Waterson and Deconinck, 2007). These schemes are simple functions that define a convection scheme based on a ratio of local gradients in the solution field, with a limited behavior in order to maintain the monotonicity, usually defined by a Total Variation Diminishing (TVD) condition (Sweby, 1984; Waterson and Deconinck, 2007). This method has been widely used to retrieve less diffusive and stable solutions, even in critical situations, such as in sharp concentration gradients in regions with a small Courant number (Wadzuk and Hodges, 2004; Fringer et al., 2005; Casulli and Zanolli, 2005; Kong et al., 2013; Zhang et al., 2015; Ye et al., 2018; Zhang et al., 2018; Nangia et al., 2019).
For solute-transport models, it is usually assumed that that the numerical solution is free of hydrodynamic numerical diffusion and that any error is leads to mass transport solution, and therefore the formal evaluation of the effect of hydrodynamic numerical diffusion on the solute-transport solution may not be properly addressed (Cheng et al., 1984; Ruan and McLaughlin, 1999; Cox and Runkel, 2008).
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
Therefore, coupling of hydrodynamic and solute-transport models may be useful in order to determine the relationship between numerical diffusion in the two solutions, which is still underexplored. Usually, studies using a coupled model propose improvements of the hydrodynamic or transport module to investigate numerical diffusion in one of the solutions separately, without accounting for the possibility that the use, or not, of high-resolution methods in one solution may affect the other (Wadzuk and Hodges, 2004; Fringer et al., 2005; Casulli and Zanolli, 2005; Kong et al., 2013; Ye et al., 2018; Zhang et al., 2018; Chandran et al., 2019). Thus, further effort is needed to understand how numerical diffusion, produced by low-resolution schemes in the hydrodynamic solution, may be transferred to solute-transport.
To explore this question, we tested a nonlinear quadratic interpolation in contrast to a linear one in ELM step-ii, combined with several flux-limiter schemes applied in the solute-transport module in order to reduce numerical diffusion, and evaluated the effect of the combined use of these methods on the solute-transport numerical diffusion. We used a coupled hydrodynamic solute-transport model with non-hydrostatic and flux-limiter Upwind approaches to evaluate the numerical diffusion in three numerical experiments, for different purposes: (a) the first two experiments evaluated the potential for reducing the numerical diffusion in the hydrodynamic solution, by applying a non-linear interpolator rather than a linear one, and the capability of representing the propagation of complex waves; (b) the third experiment evaluated the effect of using high-resolution schemes on the numerical diffusion of combined hydrodynamic and solute-transport models.
2	Mathematical considerations
2.1	Governing equations
The RANS equations are used to describe three-dimensional free-surface flows. These equations express the physical principle of volume, mass, and momentum conservation. The momentum equations for an incompressible fluid have the following form:
du	du	du	du	„
— + u — + v— + w---fv =
dt	dx	dy	dz
dpa	dp	d
dx	dx	dx
^0 dz
Po
dq
dx
+v h
d2u d2u\
dx2 + dy2 y
+
d dz
(1)
dv	dv	dv	dv
— + u — + v — + w — + f u = dt	dx	dy	dz
dpy_	M r P - Po dz
dy 9 dy 9 dy [jz	p0
dq
dy
+v h
d2 v d 2v\
dx2 + dy2j
d_ + dZ
(2)
dw	dw	dw	dw	dq	h (d2w	d2w\
It+ u ■ + v + w = ~dZ~z + v +	+ di
d. Lv
dz\ dz J
(3)
where u(x,y,z,t), v(x,y,z,t), and w(x,y,z,t) are the velocity components in the horizontal (x and y) and vertical (z) directions, respectively; where vh e vv are the horizontal and vertical turbulent eddy viscosity coefficients, respectively; t is the time; pa(x,y,z,t) is the atmospheric pressure; q is the free-surface elevation from a water-level reference. The second and third terms on the right-hand side of equations (1) and (2) represent the barotropic and the baroclinic contributions to the hydrostatic pressure; q(x,y,z,t) denotes the non-hydrostatic pressure component; f is the Coriolis parameter; and 9 is the gravitational acceleration.
When a simple hydrostatic approach is considered, equation (3) is neglected and q is assumed to be equal to zero in equations (1) and (2). In this case, it is assumed that the vertical acceleration does not have a significant effect on the velocity field in comparison with the horizontal acceleration, which is the assumption usually applied for simulation of shallow waters (e.g. Jin and Ji, 2005; Cavalcanti et al., 2016; Tang et al., 2017; Munar et al., 2018).
The volume conservation is expressed by the incompressibility condition and the continuity equation,
given by:	du	dv dw 0 dx ' dy ' dz
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
157
158
159
160
161
162
163
Integrating equation (4) over depth leads to the following equation:
f
du	dv	dw
dz =
h
-h
du .
^~dz +
dx
h
-h
d v ,
~z~dz + dy
h
-h
^dz = 0
dz
(5)
dx + dy + dz
where h is the bathymetry measured from the theorical undisturbed water surface (zero referential). Using the Leibniz integration rule, in each direction, in equation (5) aand using a kinematic condition at the free surface leads to the following free-surface equation:
dn d dt ' dx
h
-h
j	9
udz + — dy
h
-h
vdz = 0
(6)
Finally, the mass conservation of a conservative scalar variable may be expressed by the following equation:
dC d(uC)	d(vC)	d(wC)
dt + dx + dy + dz
=&amp;amp; (k h de)+jy *h dCd	%)
(7)
where C is the concentration of a conservative substance being transported (e.g., salinity); and Kh and Kv aare the horizontal and vertical turbulent eddy diffusivity coefficients, respectively.
For both the velocity field and scalar transport solutions, the boundary conditions are implemented under the assumption of “free-slip” boundaries. The Dirichlet and Neumann conditions were assigned to represent the normal and tangential velocities in the solid boundaries, respectively. For the scalar solution, a no-flux boundary condition is assumed in solid boundaries
The tangential stress boundary conditions for the momentum equations 1 at the free-surface are specified by the prescribed wind stresses, which can be approximated as:
du	dv
vvdz = Yt(ua - u),vvdz = Yt(va - v); at z = n
(8)
where ua and va are the horizontal wind velocity components, and yT is a non-negative wind stress coefficient. The bottom friction is specified by:
vdu	vdv	,
v — = YB u, v — = YB v; at z = -dz	dz
(9)
where y B is a non-negative bottom friction coefficient, which is typically represented by means of a Manning or Chezy coefficient.
2.2	Grid and Variable Locations
• 7
The computation grid can be described as a generic unstructured orthogonal grid, having Np elements, each having an arbitrary number of sides Si &gt; 3, i =1, 2, ..., Np (figure 1).
Let Ns be the total number of sides in the grid. The length of each side is Xj, j = 1, 2, ..., Np. The vertical faces of the i-th element are identified by an index j(itl), l = 1, 2, ..., Si, so that 1 &amp;lt;j(itl) &amp;lt;Ns. Similarly, the two polygons that share the j — th vertical face of the grid are identified by the indices i(j,i) and i(j,2), so that 1 &amp;lt;i(j,i) &amp;lt;Np and 1 &amp;lt;i(j,2) &amp;lt;Np. The non-zero distance between centers of two adjacent polygons that share the j-th side is denoted by Sj.
Along the vertical direction, a simple finite difference discretization, not necessarily uniform, is adopted. By denoting a given level surface as Azk+1 the vertical discretization step is defined by:
Azk = Azk+i - Azk-i k = l,2, ...,NS	(10)
The three-dimensional space discretization consists of elements whose horizontal faces are the polygons of a given orthogonal grid, represented by the layers at k + 1 (upper face) or k - 1 (bottom face), and whose height, for each layer, is Azk. The water-surface elevation (n), is located at the barycenter of the upper horizontal face for each i-th element. The velocity component normal to each horizontal face is assumed to be constant over the face of each computation cell, which is defined at the point of intersection between the face and the segment joining the centers of the two prisms that share the face. The non-hydrostatic pressure component q™k and the concentrations C™k are located at the center of the i-th computation cell, halfway between Azk+1 and Azk-1. Finally, the water depth hj is specified and assumed constant on each vertical face of an element.
164
165
166
167
168
169
170
171
172
173
174
175
176
177
178
179
180
181
182
183
184
185
186
187
188
2.3	Numerical Approach
2.3.1 RANS equations
We used a semi-implicit method (^-Method, Casulli, 1990) in a finite-difference finite-volume model, with a Eulerian-Lagrangian Method (Casulli and Cheng, 1992) to solve the convective and viscous terms of the RANS equations, and a fractional-step framework (Casulli and Lang, 2004) solve the pressure component by splitting the pressure into hydrostatic and non-hydrostatic parts. The first step of the hydrodynamic solution is to compute the provisional water velocity and surface elevation, neglecting the implicit contribution of the non-hydrostatic pressure. In the second fractional step, the provisional velocity (iz, v and w) and provisional surface elevation (rj) are corrected by non-hydrostatic pressure terms. A complete description of the numerical solution for non-hydrostatic flows was provided by Casulli and Lang (2004), and is here named CL04. Here, we describe in detail only the Eulerian-Lagrangian method in order to clarify where the high-resolution methods were applied.
One difficulty in the numerical treatment of RANS equations arises from the discretization of the convective and viscous terms of the convection-diffusion equation in three dimensions (Equations 1-3). The advection-diffusion equation without Coriolis and pressure terms can be described as:
dc	dc dc dc dc
dt -	ãi+ u dx	+ v dy	+ w a!	- “
B2c	d2c\	d 7 dc\
dx2 + dy2 + B~z V d~z
(11)
where c is a generic variable (e.g. velocity components u, v, w) (Casulli and Cheng, 1992). In order to simply solve and improve the stability and accuracy of an explicit finite-difference method, consider equation (11) in the Lagrangian form:
dc =	Í d2c B2c\ d 7 dc\
dt	dx2 + By2 + dz V dz
(12)
where the substantial derivative d indicates that the rate of change over time, which is calculated along
the stream line, is defined by:	dx	dy	dz — — u,	—	—	v,	—	— w	(13) dt	dt	dt
An explicit discretization of equation (13) can be given by:
cn+1  cn + 1
Cj,k + 1 Cj,k
(jn + 1_&lt;jn+1
Cj,k	Cj,k—1
vk+1
Vu	1
k 2
At
+ ^AhCjy
(14)

j)
Azj, k
where C* j k denotes a generic variable at the j-th side of a grid at vertical level and time step n.
In order to apply the Lagrangian discretization in a Eulerian grid, a backward stream line is required to estimate the departure velocity at time “n” ((Lagrangian approach) required to reach the final position “j,k” at time “n + 1” (Eulerian approach). (Eulerian approach). To estimate the particle departure
189
190
191
192
193
194
point, the ELM step-i interpolation is applied, which requires a particle-tracking method. A multi-step backward Euler (MSE) was applied, but other methods can be satisfactorily applied as well (e.g. fifthorder Runge-Kutta) (Oliveira and Baptista, 1998). However, the departure position is not a grid point, and an interpolation formula using known node points must be used to define Cj k (ELM step-ii).
A consistent semi-implicit finite difference discretization is used to calculate the provisional horizontal velocity component from momentum equations (1-2) and takes the following form (CL04):
U".IP = Fu],k - (1 - 0)	[5(C(jr) - 3i(j,l)) + (qi(j,r),k -
¿j *•
0a — (nn+1 - nn+1 _____________—
9 ¿j P9i(j,r)	ni(j,l)) + —gn
—n+1	—n+1
v	^j,k + 1	^j,k
Vjk+ 2	—Zn. + !
.	j,k+ 2
v
vj,k-
—n+1	—n + 1
^j,k	^j,k-1
2 —Zn
(15)
jk-2
qi(j,l) ,fc)]
j, k
195
196
197
198
199
200
201
202
k = mj ,mj+1,.. . ,Mj
where unk denotes the horizontal velocity component normal to the j-th side of the grid at vertical level k, and time step n; nfj r) is the free-surface level at the right neighbor j-th element from the j-th side and rff/j l) from left neighbor; qij r) k denotes the non-hydrostatic pressure component; and F is an explicit finite-difference operator, which accounts for the contributions from discretization of the air pressure, Coriolis, baroclinic pressure, advection, and horizontal friction terms.
Analogously to equation (15), a semi-implicit finite-difference discretization for the provisional vertical-velocity component (neglecting the non-hydrostatic pressure contribution) at the top of each computation cell is derived from equation (3):
w 1 = Fwik+2 - (1 - °)
—t	(qn	_ qn ) I	—t
—Zn	'^i’k+1	“i,k) ' —Zn
i,k+2	i,k+2
n+1	n+1	n+1
v	wi,k+3 - wkk+2	v wi,k+1
vi,k+1----—Z +1----------vi,k-------
n+1
- 'wi,k-2 —Znk
i,k
k = mi,mi+1,Mn - 1
(16)
203
204
205
where Fw aaccounts only for contributions from the discretization of the advection and horizontal-friction terms. The Eulerian-Lagrangian method can be applied to discretize the finite difference operator F in equations 15 and 16, given by:
—t Mi
F’uj,k = uj,k + vh —t—huj,k + f—tvj,k - S-$—	- Pi(j,1),^ —zj,e
j P0 t=k
206
(17)
207
208
209
210
211
212
213
214
215
216
217
218
219
220
FwZk+ 2 = Wj,k+ 2 + Vh—t—hWi,k+ 2	(18)
where uj k denotes the horizontal velocity component normal to the j-th side of the grid interpolated at time tn at the end of the Lagrangian trajectory; vj k denotes the horizontal velocity component orthogonal to uj k; w* k+1 denotes the vertical velocity component normal to the upper horizontal face of element “j” at layer “k + |~-k = | and = 1, for £ = k; —h is the discretization of the horizontal Laplacian. The Lagrangian trajectory is calculated by integrating the velocity backward in time from a face’s (j,k) barycenter at tn+1 to its location at time tn. The second step of the interpolation technique is discussed further below.
2.3.2 Solute-Transport Equation
We used a conservative finite-volume scheme with a semi-implicit approach based on CL04 with time-accurate local time stepping based on Cavalcanti et al. (2015), in order to discretize the solute-transport equation. The CL04 approach yields a conservative solution, also respecting the max-min property.
Assume that S+ represents the set of vertical faces belonging to the computation cell (i,k) through which water is leaving the respective computation cell; and S- represents the set of vertical faces through which water is entering the same computation cell and , p(i,j) is the neighbor of the computation cell
221
222
223
224
225
226
227
228
229
230
231
232
233
234
235
236
237
238
239
240
241
(i,k) that shares the vertical face (ij). For each computational cell, equation (7) for scalar transport is discretized as follows:
PiAzn+ 1Cn+1
1	i, k	i,k
Elnn+6^in	\ A \f-\n+0^tn
\Qj,k \Ci,k -	/ ^	\Qj,k \Cr(i,j'),k
j-	jeS7k
- At[ I Qn,ke+1 \Cnk - Qn,8-1 \Cnk-1] + At E	dn,+k3 * S * * [Cj - Cnk]
jeSikuS-k
- At [dn,-1 (cEi - Cn+- dn,-. c,1 - c^)]
- A he 2 \ Qnk-1 \(ch+1 - Cnk) - c-1 \Qnk-1 icn, - Cn-1)]
- A E	jIQ	(Cj - C,)
jeSikuS-k
- F&lt;Az~j, C-J, - At
(19)
where
dn- i — max | 0.Dnk, 1
i,k± 1	I ’ i,k± 2
-1 |qx± il)
(20)
j- — max	-
1 j l)
(21)
where Qn—	XjAzn, unke	and	Q'.'.	- 1 —	Piwn+— 1	are the advective-flux coefficients, and	Dn,	—
Aj.k	j j,k j,k	^i,k± 1	1 j,k± 1	’	j,k
Kh	Kv k± 1
XjAz'Xj and Dnk±i — Pi^zn—~ are the diffusive-flux coefficients. In equation (19) the first term 3 2	i, k±1
on the right side is the mass in layer k at time n; the second is the horizontal-advection term; the third is the vertical advection, followed by the horizontal and vertical-diffusion terms. The last two terms are the numerical-diffusion reduction terms , which depend on the high-resolution scheme to estimate h
The h represents the flux limiter itself, and is given by:

— $
j,k
nn
j,k	Vj,k
(22)
n
where $ is the partial flux limiter and 0 is a function that assures the independence between the max-min property and mesh size, and is given by:
f 1D
' — E’j
(23)
When the horizontal and vertical diffusion is set equal to zero, k — 0, hence k — $nk • The Upwind scheme may be easily obtained when $ (r) — 0.
3	High-resolution schemes to reduce numerical diffusion
For the hydrodynamic solution, two different interpolators at ELM step-ii were tested: a simple
bilinear interpolation (Casulli and Cheng, 1992) and a quadratic interpolator (Hodges et al., 2000), both
applied in a regular structure grid. Regarding the solute-transport solution, three different flux limiters were used: MUSCL, Superbee and Ultimate Quickest, which performed best for coupled hydrodynamic
and transport simulations in previous studies (Hodges et al., 2000; Fringer et al., 2005; Casulli and
Zanolli, 2005; Ye et al., 2018).
242
243
244
245
246
247
248
249
250
251
252
253
254
255
256
257
258
259
260
261
262
263
264
265
266
267
268
269
270
271
3.1	Flux-Limiter
In order to retrieve some accuracy from the solute-transport first order upwind scheme, an additional ”anti-diffusive” term is used (equation 22), the so-called flux limiter function. The high-resolution methods applied to the solute-transport solution are described as follows:
1.	UpWind
$(rf) = 0	(24)
2.	MUSCL (Van Leer, 1979)
&amp;amp;(rf) = max[fi™k; min(2rf; 0,5 + 0,5rf; 2)]	(25)
3.	Superbee (Roe, 1986)
&amp;amp;(rf) = max[^",fc ;min(1;2rf );min(2,rf)]	(26)
4.	Ultimate Quickest (Leonard, 1991)
1	1	2	2r
$(rf ) = max j min(j(1 + rf) + 6(1 - rf)(1 - 2|C|); 1 - |C|; ]C\J	(27)
where Cr here is the Courant number.
The consecutive gradients (rfactor) play an important role in the numerical diffusion of the masstransport equation. Several ways to estimate the rfactor have been proposed (Darwish and Moukalled, 2003; Casulli and Zanolli, 2005; Li and Huang, 2008; Kong et al., 2013; Zhang et al., 2015; Ye et al., 2018). The rfactor proposed by Ye et al. (2018) and Kong et al. (2013) gave the best results among all existing methods Ye et al. (2018). For the sake of simplicity, we adopted the rfactor proposed by Kong et al. (2013), which we found to be easier to implement, since the rfactor is calculated only based on the concentration of neighbor cells.
The rfactor is calculated only for horizontal and vertical water-leaving faces. For vertical faces (horizontal flux) the consecutive gradient is given by:
n
j,k
/~in _ /"in
Ci,k	Cr(i,jo),k
C n	_ C n
Cr(i,j),k Ci,k
(28)
where jo represents the opposite face from face j. For horizontal faces (vertical flux), the rfactor is given by:
rjn,k-
nn
Ci,k	Ci,k + 1
Cnk , - Cnk i,k-1 i,k
i,k-1
(29)
n
j,k+
nn
Ci,k	Ci,k-1
C n	_ C n
Ci,k + 1	Ci,k
i,k-1
(30)
r
1
2
r
1
2
3.2	Bilinear Interpolator
For a structure rectangular grid, the bilinear interpolator Casulli and Cheng (1992) uses 8 node points within a cell. The interpolated velocity component at tn can be found by:
ci-a,j-b,k-d = (1 - d (1 - a) [(1 - b) Un + b Un] + a [(1 - b) u4 + b un] + d (1 - a) (31) [(1 - b) un + bun] + a [(1 - b) u% + bun]
where a, b and d are the distances of the particle position at the end of a sub-time step (xp,yp,zp) normalized by the position of the nodes in each direction, where u1 was set as the initial position (xu1,yu1,zu1). For the following example (figure 2), the normalized distances are set as:
\y	yu1\ d  \zp	zu5\
|yu1 - yu4|	|zu1 - zu2|
xp	xu1 \ b
\xu1	xu2 \
We used two different procedures to select the 8 node points used for bilinear interpolation of Fu and Fw at the end of the Lagrangian trajectory: Regarding Fu (figure 2.a), the interpolation process follows the steps:
Fig. 2: Example of the velocity points used in the bilinear interpolation for the a) vertical faces (left), example for the particle stopped in up position, and b) horizontal faces (right), with the particle stopped in the fourth-quadrant position.
272
273
274
275
276
277
278
279
280
281
282
283
284
285
286
287
288
289
290
291
292
293
294
295
296
297
298
299
300
301
302
303
1.	(1) For each time step, the particle starts at the barycenter of the j-th face at layer k, where the multi-step backward Euler stream line is defined by linear interpolations to find the particle position at the end of a sub-time step (ELM step-i);
2.	(2) For each sub-time step, the particle position is analyzed in relation to the initial position (up right, up left, down right or down left);
3.	(3) Eight node points are selected in the cell, with four points in layer k (the same layer where the particle stops), and four points in layer k± 1, depending on the particle position (up or down). The used point are always 4 faces barycenter and 4 edge center, except for the top and bottom cells, which uses 2 faces barycenter, 4 edge center and 2 nodes;
4.	(4) The node indices are defined anticlockwise, where the first node is the initial position of the particle at time n+1;
5.	Equation (31) is used to calculate the velocity component in the particle position in the sub-time step;
6.	Steps (1-5) are repeated until the end of the Lagrangian trajectory.
For Fw (figure 2.b), a similar procedure is adopted:
1.	For each time step, the particle starts at the horizontal-face barycenter of the j-th element at layer (k + 1), where the multi-step backward Euler stream line is defined by linear interpolations to find the particle position at the end of a sub-time step (ELM step-i)
2.	For each sub-time step, the particle position is analyzed in relation to the initial position (up or down and in the direction of one of the four quadrants)
3.	Eight node points are selected in the cell, with four points in layer (k + |) (the same layer where the particle starts), and four points in layer k — 1, if the particle goes down, or k + |, if the particle goes up. The used point are always 2 horizontal faces barycenter, 4 edge center and 2 nodes;
4.	The node indices are defined anticlockwise, where the first node is the initial position of the particle at time n +1.
5.	Equation (31) is used to calculate the velocity component in the particle position in the sub-time step.
6.	Steps (1-5) are repeated until the end of the Lagrangian trajectory.
3.3	Quadratic Interpolator
The Quadratic Lagrangian interpolation was adapted from Hodges et al. (2000), who extended the 8-point Upwind bilinear stencil to a 27-grid point stencil using at least 8 computation cells. We proposed to use 27-node points inside a single computation cell, using the calculated velocities at the
304
305
306
307
308
309
310
311
312
313
314
315
316
317
318
319
320
321
322
323
324
Fig. 3: Example of model node point velocities for the quadratic interpolation. This illustration shows 27 points inside a computation cell, using information from nodes (in black), edge centers (in white) and face barycenters (in gray). The subscripts (l,m) denote the position of the vertical line (black lines) to be interpolated in the first step. n denotes the bottom, middle or top of a computation cell. The orange lines represent the second interpolation step, and the blue line represents the final interpolation step to estimate velocity of the particle at time tn.
face barycenters and interpolated velocities at the nodes, edge centers, face barycenters and element center (figure 3).
The quadratic interpolation is more generic and uses the same procedure for the horizontal and vertical faces. First, for each time step the particle starts at the face barycenter, where the backward stream line is defined in 10 sub-time steps by linear interpolation to find the departure position at time n (ELM step-i). Second, for each sub-time step the interpolation follows 3 major steps, illustrated in Figure 3, in order to determine the Lagrangian polynomial coefficients (e.g., Hodges et al., 2000). The Lagrangian polynomial coefficients are given by:
l = n
a=0 a=3
zp — z
z	zn±a
zn±3	zn±a
(33)
where each interpolation has 3 L coefficients, one for each node used in the interpolation line. zp is the particle position after the backtrack, 3 is the analyzed node position in the Upwind direction, and a is the other two points, both assuming values of 1, 2, or 3.
In summary, the interpolation process follows these steps:
1. (1) First, 9 z-direction interpolations are carried out (black lines in figure 3). Each vertical interpolation generates a velocity component in the horizontal plane that passes through the z-position of the particle, given by:
Ul+Y,m+^	Ll+y,m+'3U‘ l+l,m+^,n + Ll+y,m+^'U l+y,m+^,n+1 + Ll+y,m+^'U l+y,m+^,n+2
(34)
where each L is multiplied by the respective velocity node and 7 and 3 are the “l” and “m” displacement, respectively, to indicate which vertical line has been interpolated.
1. (2) 3 x-direction interpolations are carried out (orange line), using the estimated velocities found in step (1), resulting in 3 new velocity components (white diamonds in figure 3), given by:
U m+^	Ll,m+^Ul,m+^ + Ll + 1,m+^Ul + 1,m+^ + Ll+2,m+^Ul+2,m+^
(35)
1. One interpolation is made to compute the ^-direction displacement and find the final velocity for the particle at time tn
325
326
327
328
329
330
331
332
333
334
335
336
337
338
339
340
341
342
343
344
345
346
347
348
349
350
351
352
353
354
355
356
357
358
359
360
361
362
363
364
365
366
367
368
369
370
371
372
ui-a,j-b,k-d	Lj + Lj+1^j+l + Lj+2^j+2	(36)
1.	A new departure velocity is used to define the particle position in the next sub-time step.
2.	Steps (1) to (4) are repeated until the end of the Lagrangian trajectory.
4	Numerical Experiments
The proposed numerical approaches were used in three consolidated benchmarks usually use to verification and validation of numerical models Dingemans (1994); Jankowski (1999); Casulli and Lang (2004); Yuan and Wu (2004); Fringer et al. (2005); Liu et al. (2017); Yin et al. (2017). The first two experiments tested the numerical diffusion produced by the hydrodynamic solution, and the last experiment evaluated the numerical diffusion of the coupled hydrodynamic and solute-transport solution. Each numerical experiment had a different purpose, as follows:
1.	Standing waves in a three-dimensional closed basin. This test case verifies the capability of the model to simulate 3D linear waves, including phase and amplitude representation (Yuan and Wu, 2004; Monteiro and Schettini, 2015; Liu et al., 2017). The motion in the basin is caused only by the initial condition of the free surface. When the roughness, viscosity and diffusivity coefficients are set equal to zero, the motion of the free surface should not lose energy. However, a wave damping is caused by the numerical diffusion of the hydrodynamic solution. We evaluated the differences in the numerical diffusion between the bilinear and quadratic interpolations, applied in ELM step-ii, as well as the numerical diffusion considering the no-advection scheme. The numerical diffusion was evaluated in terms of the cumulative wave damping, comparing the waves after 30 seconds of simulation. Regarding the case of the no-advection scheme, u*, v* and w* (equations 17 and 18) are set directly equal to the horizontal and vertical face velocities. The performance between methods was evaluated with a few metrics (RMSE, BIAS, Volume Error, KGE, NSE). We also compared the mass conservation of the computation domain for each time step, the cumulative mass conservation over the course of the simulation, and the mean computation time of one time-step simulation, using an Intel® Xenon® CPU-E5-1620 3.7 GHz computer with 32 GB of RAM memory in a Fortran based numerical model.
2.	The wave propagation over a submerged bar was an experimental model idealized by Beji and Battjes (1993), and has been frequently used to validate numerical models (e.g., Beji and Battjes, 1994; Dingemans, 1994; Stelling and Zijlema, 2003; Zijlema and Stelling, 2005; Yuan and Wu, 2004; Cui et al., 2012; Yin et al., 2017). The experiment was used to evaluate the accuracy of representing an irregular wave pattern caused by physical changes at the bottom, by comparing the quadratic and bilinear interpolations used in ELM step-ii. The performance between methods was evaluated with a few metrics (RMSE, BIAS, Volume Error, KGE, NSE);
3.	The gravity-wave test consisted of a finite-amplitude deep-water standing wave in an inviscid fluid in a non-equilibrium situation, where the baroclinic pressure makes a major contribution to promote flow. The experiment evaluated the numerical diffusion in terms of density interface expansion, analyzing the difference between the combined uses of the interpolation techniques used in ELM step-ii and different flux-limiter schemes applied in a solute-transport solution. This test case also evaluated the individual effect of each interpolation technique used in the hydrodynamic solution on the solute-transport solution, using different flux limiters. We also compared the mean computation time of one time-step simulation.
4.1	3D standing waves in a closed basin
A closed cubic basin with 10 m of edge and the wave amplitude set to 0.1 m was used (figure 4). The spatial domain was discretized using a regular grid with 0.5 m resolution, resulting in 8,000 computation cells. The time step was 0.01 s and the total simulation time was 30 s. We evaluated the numerical diffusion produced by ELM, comparing the free-surface elevation at x = y = 0.25 m with the exact solution. We also compared the mass conservation between bilinear and quadratic interpolators, neglecting the convective terms.
The analytical solution of the free-surface water elevation is given by:
Fig. 4: The initial free-surface profile for a linear 3D standing wave oscillation in a closed basin. source: Yuan and Wu (2004)
Fig. 5: Comparisons of the free-surface elevation at x = y = 0.25 m. The solid black line is the analytical results, the dash-dot line is the quadratic interpolator results, the solid red line is the bilinear interpolator results, and the dashed black line is the results with no advection scheme
Table 1: Metrics between the analytical and simulated results each method for 30 seconds of simulation
Metrics	Quadratic	Bilinear	No Advection
RMSE (mm)	21.86	20.80	20.70
BIAS (mm)	0.18	0.52	0.56
Error (%)	27.22	25.94	25.79
KGE	0.87	0.66	0.64
NSE	0.90	0.91	0.91
373
374
375
where t is the time (the initial condition of the free surface may be obtained by setting t = 0), T is the wave period equal to 3.1 s, with the wave number kx = ky = n/L and the total wave number k = \/kX + ky = 0.44^. The analytic solution for each velocity component is described as follows:
Agkx cosh [kx(h + z)] w	cosh (kxh)
sin (kxx) cos (kyy) sin (wt)
376
377
Agky cosh [ky (h + z)] w	cosh (kyh)
Agkx sinh [kx(h + z)] w	cosh (kxh)
cos (kxx) sin (kyy) sin (wt)
cos (kXx) cos (kyy) sin (wt)
(38)
(39)
(40)
u
v
w
378
379
380
381
382
383
where w is giving by:
w = y/gK tanh (Kh)	(41)
The results showed that the numerical diffusion can be reduced when a higher-order interpolation is used (figure 5). The numerical diffusion of the quadratic interpolator (measured in terms of the amplitude error compared to the analytical solution) is ca. 10 times smaller than the bilinear interpolator after 30 s of simulation. The bilinear scheme did not show a substantial improvement over the simulation neglecting the convective terms (the numerical diffusion was only 10% lower). The Quadratic results show best
Fig. 6: Comparisons of the mass conservation of computational domain over the simulation (top) and the cumulative mass conservation (bottom) over the simulation time for the tested methods: No Advection (red dashed line), Bilinear (blue doted line) and Quadratic (black solid line)
384
385
386
387
388
389
390
391
392
393
394
395
396
397
398
399
400
401
402
403
404
405
406
407
408
409
performance between methods (Bias 0.18 mm and KGE 0.87, see table 1), indicating best agreement with the analytical solution, despite similar RMSE and NSE to the other methods. All analyzed metrics shows that bilinear and no advection had similar performance. The phase representation showed good agreement with the analytical solution, showing a cumulative phase error of only 0.3 s at the end of the simulation, which is similar to previous studies (Yuan and Wu, 2004; Monteiro and Schettini, 2015). As expected, the simulation neglecting the convective terms had a shorter computation time (ca. 1.65 s) than the bilinear (ca. 2.23 s) and quadratic interpolations (ca. 2.37 s). The computation cost using a quadratic interpolation was slightly higher (ca. 6%) than the bilinear interpolation.
The mass conservation analysis showed a more conservative behavior for the quadratic simulation (Figure 6). The simulation neglecting the convective terms showed a substantial decreasing pattern after 5 s of simulation, differently from when the bilinear was used, in which the pattern appeared after 20 s. The quadratic interpolation showed a more conservative pattern than the bilinear interpolation.
4.2	Wave propagation over a submerged bar
A scheme of the experiment of the wave propagation over a submerged bar with an uneven bottom is seen in (Figure 6) (Beji and Battjes, 1993). At the upward slope of the bar, the shoaling wave becomes non-linear due to the generation of a bound higher harmonic. At the downward slope, the depth increases rather fast and these harmonics become free, resulting in an irregular pattern of waves (Dingemans, 1994). The numerical reproduction of this pattern has proven to be very demanding with respect to the accuracy of the computed dispersion frequency (Stelling and Zijlema, 2003).
The computation domain has a total length of 30 m, with an initial undisturbed water level of 0. 4 m, and was discretized using a regular grid of 0.025 m resolution. The time step was 0.005 s and the total simulation time was 39 s. At the left boundary, a sinusoidal wave condition, with period T = 2 s and amplitude A = 0.01 m, was imposed to represent the wave generator of the original experiment. At the right outflow boundary, the experimental absorbed beach was computationally represented by a 5-m sponge layer with a combination of a sponge layer technique (Park et al., 1999) and a Sommerfeld-type radiation boundary condition, applied to minimize wave reflection, given by:
ei
if Xi &gt; Xio
if Xi &amp;lt;0
(42)
Fig. 7: Scheme of experimental bottom geometry and location of wave-level gauges. Source: Modified from Beji and Battjes (1993)
410
411
412
413
414
415
416
417
418
419
420
421
422
423
424
425
426
427
428
429
430
431
432
433
434
435
436
437
438
439
where ei is the sponge layer coefficient, xio is the initial point, and li the total length. This term must be added in the right side of equation (1) and (2).
The methods performance was compared by a few metrics (RMSE, BIAS, Volume Error, KGE, NSE), and also through graphic visualization (Figure 8) of the wave pattern among the 6 stations. We evaluated the capability of the model to correctly represent the measured free-surface water elevation at between 33 and 39 s of simulation, comparing the bilinear and quadratic interpolation solutions with the experimental results for the “low-amplitude waves” (LW), generated by the shoaling process, and the “higher-amplitude waves” (HW).
The results indicated that the shoaling process on the upward slope was well described by both interpolation techniques, although the bilinear interpolation poorly represented the LW at station “A”. At the beginning of the downward slope, at station “B”, the bilinear simulation showed higher free-surface elevation, poorly representing the LW minimums (B at 34.7 and 36.7 s), which is physically incoherent with the measurements and simulations by others (e.g., Stelling and Zijlema, 2003), due to an over-increased velocity in the de-shoaling process. The quadratic simulation more accurately represented the de-shoaling process, although it did not accurately represent the maximum height of HW (35 and 37 s). Moreover, the simulation without advection scheme was not able to represent the de-shoaling process and was numerically unstable due to a larger over-increase in velocity at the same point as the bilinear interpolation over-increased it.
The bilinear overestimation of the free-surface level was propagated to the other stations. For the other four stations, the bilinear case better represented the HW maximum amplitudes than the quadratic simulation, but poorly represented the LW phase and shape (see “D” and “F” LW over the oscillation pattern for the bilinear interpolation).
The quadratic interpolator had the best performance among methods table 2. The Quadratic method better represented the amplitude and the wave patter for all stations (NSE between 0.47 and 0.94, and RMSE between 2.17 and 4.29 mm). The results had high Volume Error (between 23% and 83%), overestimating the free-surface level for most cases (except for some method at stations b, c, d and f), and with low performance in KGE parameter for most cases. In summary, the quadratic solution was better in interacting with uneven bottoms to represent complex non-linear wave simulations. Similar results to the quadratic interpolation solution were reported by Dingemans (1994); Chen (2003); Walters (2005); Cui et al. (2012); Monteiro and Schettini (2015).
440
441
442
4.3 Gravity Wave
This benchmark setup is use to evaluate the numerical diffusion of numerical models under sharp density gradients (Fringer et al., 2005). The equation that represents the initial density condition is:
,	. Ap
p(x,z) = —— tanh
kz - kZ + 2
(43)
Bibl inear
Experimental
— -Bilinear
(b)x = 14.5 m
4
H—	n
0.02
0.01
I 0
G"
-0.01
33	34	35	36
Time (s)
o Experimental	Quadratic
(d)x= 17.3 m
Bilinear
(f) x = 21.0 m
o Experimental
36 Time ($)
° Experimental ■ Quadratic
Fig. 8: Comparisons between experimental (circles) (dashed line) and Quadratic interpolator (solid line),
		o		oo	
n	o		o		o
					
35	36
Time (s)
— Quadratic
and computed data with a Bilinear interpolator at 6 different level gauges.
Table 2: Metrics between simulated and experimental results for the six stations for bilinear and quadratic results
M	Station a: x = 13.5 m		Station d: Bilinear	x = 17.3 m Quadratic
	Bilinear	Quadratic		
RMSE (mm)	3.57	2.17	5.18	4.29
BIAS (mm)	2.01	0.18	0.87	-0.56
Error (%)	47.52	23.65	83.78	60.00
KGE	-0.90	0.82	0.23	0.46
NSE	0.83	0.94	0.56	0.70
	Station b: x	= 14.5 m	Station e:	x = 19.0 m
RMSE (mm)	4.79	4.25	4.97	3.81
BIAS (mm)	0.14	-0.64	2.49	0.76
Error (%)	64.77	50.22	52.79	45.31
KGE	0.39	0.35	-6.12	-1.18
NSE	0.33	0.47	0.60	0.76
	Station c: x	= 15.7 m	Station f:	x = 21.0 m
RMSE (mm)	4.66	3.51	4.04	3.67
BIAS (mm)	-0.19	-1.25	1.34	-0.28
Error (%)	56.71	39.63	57.48	43.84
KGE	0.65	-1.07	-4.92	-0.26
NSE	0.67	0.81	0.69	0.75
443	where a = 0,99, k = n is the wave number, ka represent the fluid interface inclination, kS is the non
444	dimensional interface thickness, and kZ is the interface initial condition, giving by (Thorpe, 1968):
kZ(x) = ka
(ka)2
6 1
cos(kx) —
(ka)2
8
cos(3kx)
(44)
445	The constant values follow those used by Fringer et al. (2005). ka = 0.1, kS = 0.05, the density
446	difference between the layers is = 0.03, with an analytical wave period of 9.43 s. In this test the
447
448
449
450
451
452
453
454
455
456
457
Fig. 9: Comparisons of densitys profiles between the exact no-diffusive solution, and the No Advection (left), Bilinear (middle) and Quadratic (right) interpolators for several flux-limiter schemes, after two wave periods.
bottom roughness and diffusion coefficients were both equal to zero. The spatial domain was alm x 1 m, discretized using a regular grid of 0.0125 m resolution, resulting in 6,400 computation cells. The time step was 0.0236 s and the total simulation time was two wave periods.
Because the vertical and horizontal diffusion were set equal to zero (i.e. pure advection transport), the initial and final shape of the gravity wave must be the same. We evaluated the numerical diffusion produced, neglecting the convective terms, and using both bilinear and quadratic interpolations in ELM step-ii combined with different flux-limiter schemes. The model outcomes (i.e. water density profiles) were compared with the exact solution. In order to evaluate the effects of different schemes and interpolation techniques on the numerical diffusion, we calculated the Terror norm of the density (Table 3), and compared the simulated vertical density profiles at x = 0.0 m and at x = 0.4 m with the exact solution.
The Lerror was calculated using the following expression:
L =
EN	NP PT - Pi,k\6Ai&lt;k
Nk1 \Pi,k\SAi,
(45)
458
459
460
461
462
463
464
465
466
467
where p is the density from the exact solution, and the p2T is the simulated density after two wave periods, and &amp;amp;Ai,k is the area of grid cell (i,k), which in our case is equal for all computation cells.
The comparison between the simulated density profiles and the exact solution is shown in Figure 9. Our findings indicated that the numerical diffusion produced by the hydrodynamic solution had a major influence on the total numerical diffusion.
The Upwind scheme showed a higher numerical diffusion than the high-resolution schemes, considering the two interpolation techniques in ELM step-ii (RMSE ca. 2.8 times bigger, table 4). For the high-resolution schemes, the numerical diffusion was reduced mainly when combined with the quadratic interpolation in ELM (RMSE ca. 3 times smaller). A similar numerical diffusion pattern was found when the convective terms were neglected or when a bilinear interpolation was used in ELM step-ii, with
Layer "k"	Layer "k"
Fig. 11: Comparisons between density profiles of the exact solution, and the No-Advection (top), Bilinear (middle) and Quadratic (bottom) interpolations for all flux-limiter schemes, after two wave periods, at x = 0.0 m (left) and x = 0.4 m (right).
Table 3: Relative errors (%) for the different advection schemes after two wave periods, for the bilinear and quadratic interpolators
Flux limiters	L NoAdvc	L Bilinear	L Quadratic	Fringer et. al 2005
UpWind	5.10	4.98	4.98	3.9
MUSCL	1.66	1.23	0.48	0.6
Ultimate-Quickest	1.40	0.94	0.46	0.4
SuperBee	1.36	0.88	0.30	0.4
Table 4: Root Means Square errors (kg/m3) for the different flux limiter schemes after two wave periods, for the No advection scenario, bilinear and quadratic interpolators.
Flux limiters	RMSENoAdvc	RMSE Bilinear	RM SEQuadratic
Upwind	2.08	1.97	1.97
MUSCL	1.16	0.72	0.38
Ultimate-Quickest	1.15	0.69	0.28
Superbee	1.16	0.70	0.24
468
469
470
471
472
473
474
a higher diffusive behavior in the middle of the spatial domain and an anti-diffusive pattern near the boundary domain for the higher-resolution schemes, as seen in Figure 11 and 9.
The Upwind scheme showed a higher relative error (Lerror norm ca. 5%) for all simulations. The results showed that the high-resolution methods substantially reduced the relative errors compared to the Upwind scheme, and the Superbee performed best among the higher-resolution schemes. The quadratic and Fringer et al. (2005) had similar results to the tested high-resolution methods, however the hydrodynamic discretization and its influence in the result was not discussed in Fringer et al. (2005)
475
476
477
478
479
480
481
482
483
484
485
486
487
488
489
490
491
492
493
494
495
496
497
498
499
500
501
502
503
504
505
506
507
508
509
510
511
512
513
514
515
516
517
518
519
520
521
522
523
524
525
526
527
528
529
work. The ¿error indicated that the bilinear interpolation substantially improved the representation of the density profile compared to the simulations neglecting the convective terms. Regarding the computation cost, the higher-resolution methods had similar computation times for each time step, differing only with the interpolation technique, with 1.25, 1.51 and 1.62 s for the No-advection, Bilinear and Quadratic interpolations, respectively. The Upwind scheme had a shorter computation time, with 1.01, 1.15 and 1.61 s for the no-advection, bilinear and quadratic interpolations, respectively.
5	Discussion
The numerical experiments in the hydrodynamic solution showed that the quadratic interpolation method, using 27 node points in a single computation cell, substantially reduced the numerical diffusion in the hydrodynamic solution, which had a positive effect on the solute-transport solution. This is the first study to verify and validate the quadratic interpolation method in ELM step-ii.
The results of the first experiment showed a good amplitude representation of the waves, with a satisfactory phase representation only 0.3 s slower than the analytical result. This was expected, since the phase representation is more related to the non-hydrostatic pressure and vertical momentum discretization (Yuan and Wu, 2004; Zijlema and Stelling, 2005). The second experiment successfully validated the proposed interpolation, which proved to be capable of representing complex wave problems. The bilinear interpolator applied at ELM step-ii had a numerical diffusion ca. 10 times higher than the quadratic interpolation. Moreover, the bilinear interpolation did not yield a substantial improvement in terms of numerical diffusion, compared with the simulations neglecting the convective terms. The quadratic interpolation also substantially improved the mass conservation over the course of the simulation, indicating that a high-resolution method can be applied to find mass-conservative solutions in free-surface simulations in complex wave problems, including shallow or deep waters. Higher numerical diffusion was also observed when the bilinear interpolator in ELM step-ii was used with different flux-limiter schemes in the mass-transport solution (Cheng et al., 1984), indicating that high-resolution schemes can be successfully used to attenuate the numerical diffusion for coupled hydrodynamic and transport solutions. The set of numerical experiments showed that the quadratic interpolation is a powerful and promising method to reduce numerical diffusion, with a slight increase in computation cost related to a bilinear interpolator (7.3% more), and also can be applied in 1D, 2D or 3D models. Other key factors related to the numerical solution are also responsible for the numerical diffusion, such as the fractional step error (Chen, 2003), caused by splitting the pressure solution into hydrostatic and non-hydrostatic modules, which was appropriately treated here following Casulli (1999); and the interpolation method used to define the stream line trajectory in ELM step-i (Staniforth and Cote, 1991).
In this study, we used different flux-limiter schemes to efficiently solve the mass-transport equation, which also proved to be an accurate alternative to reduce the numerical diffusion when coupled with a quadratic interpolation in ELM. The last numerical experiment showed that the Upwind scheme has serious numerical-diffusion problems (¿error norm ca. 5%), and can be considered inappropriate for modeling stratified basins. The SuperBee flux limiter showed the best results among the high-resolution methods used in this study (¿error norm ca. 0.3% with quadratic interpolation). Although further investigation is still needed to indicate the best flux limiter, the SuperBee has been used as a default in some models (e.g., Hodges et al., 2000; Casulli and Zanolli, 2005; Ye et al., 2018; Zhang et al., 2018), has proven to be capable of simulating stratified basins with or without sharp gradients, and has also been mass conservative. Despite the satisfactory results, the flux limiters used here are only non-linear second-order schemes (Fringer et al., 2005; Waterson and Deconinck, 2007). Numerical diffusion can be reduced even more by a different linear or non-linear higher-order discretization, but this usually requires a complex numerical solution, which is computationally expensive and also may be vulnerable to unphysical spatial oscillations (wiggles) under some circumstances (Leonard, 1991).The flux limiter is a simple approach that is easily implemented, especially when Kong's Cfactor is applied.
The results indicate that high-resolution schemes are suitable for reducing numerical diffusion, but combining their use in hydrodynamic and solute-transport solutions can improve the overall result even more. When the Upwind scheme was used, the differences between interpolation techniques were overcome by the higher Upwind numerical diffusion, although when flux-limiter methods were also used, the differences were clearer. The combined use of high-resolution methods shows that the interpolation technique in the hydrodynamic solution has a substantial effect on the mass-transport solution, and that, despite the improvement over Upwind, applying linear interpolators at the ELM step-ii still yields a relative error that is 2 to 3 times larger than with a non-linear interpolator, with a similar behavior to
530
531
532
533
534
535
536
537
538
539
540
541
542
543
544
545
546
547
548
549
550
551
552
553
554
555
556
557
558
559
560
561
562
563
564
565
566
567
568
569
570
571
572
573
574
575
576
577
578
the no-advection solution, which may generate unsatisfactory results for the transport solution in cases of sharp stratification.
A higher diffusive behavior in the middle of the spatial domain of gravity wave than in the nearby boundary domain was found for all simulations, as expected. Fringer et al. (2005) showed that in regions of the flowfield where the local Courant number is reduced (the middle), the interfacial diffusion is increased, which makes a zone that is sensitive to the velocity field. The results of the gravity-wave experiment were strongly influenced by the diffusion-over-time steps, since as the interface became more diffuse, the wave period and velocity field changed; that is, the use of a more diffusive method in a hydrodynamic solution may generate cumulative errors, leading to unsatisfactory results. The quadratic interpolation proved to better reduce the numerical diffusion in these critical areas, due to the less diffusive behavior in the hydrodynamic solution, and better predicted the sharp change of the velocity field in the middle region of the wave. Moreover, the results for the quadratic interpolation indicated that it performed better than the bilinear interpolation and similarly to the results reported by Fringer et al. (2005) in the transport solution. The bilinear interpolation, although it had a smaller relative error than the no-advection solution (1.5 times less), showed the same unsatisfactory diffusive behavior in the middle region.
The proposed combined use of the quadratic interpolation applied at ELM step-ii and the flux-limiter technique substantially reduced the numerical diffusion in solving mass-transport problems, showing that high-resolution methods must be implemented in the numerical solution to properly simulate more complex real situations. These methods can be easily implemented, as proposed here.
6	Conclusion
The combined use of high-resolution methods (quadratic interpolation and flux-limiter functions) showed to be an suitable alternative to reduced numerical diffusion, and with low cost of implementation in relation to higher order discretizations.
The analyses in a coupled numerical model allowed to understand how the numerical diffusion at one solution may affect the other. The numeric diffusion at hydrodynamic solution promoted by low-resolution methods (low-order interpolation at ELM) may have a substantial impact on solute transport solution, even if a high-resolution method were applied at solute transport solution (Relative error and RMSE ca. 3 times bigger).
When a low-order method are used in solute transport solution (Upwind scheme) the numerical diffusion differences between methods in hydrodynamic solution were overcome by the higher Upwind numerical diffusion. Thus, in order to accurately modeling stratified flows in real situations the combined use of high-resolution methods is mandatory.
Numerical models that use low-resolution methods usually neglected the diffusive part of the transport equation (eq. 7) (diffusivity coefficients equal to zero), assuming the numerical diffusion as the physical diffusion, which may difficult the Model’s calibration. The applied high-resolution methods allowed using the diffusivity coefficients as parameters to the model calibration. Therefore, we recommended the application of the implemented methods at real situations to evaluated the Model’s performance in the representation of the temperature dynamic of stratified flows in deep lakes or reservoirs.
7	Acknowledgments
We are grateful to the Coordenação de Aperfeiçoamento de Pessoal de Nivel Superior (CAPES: http://www.capes.gov.br) and to the Conselho Nacional de Desenvolvimento Cientifico e Tecnologico (CNPq: http://www.cnpq.br) of Brazil for the MSc. scholarships awarded to Augusto Hugo Farias da Cunha (grant number: 149819/2017-0) and Matheus Henrique Tavares (grant number: 1695302). We are also grateful to the project H2020 MSCA/RISE ODYSSEA (Grant Number 691053) e o INCT no 16-2014 ODISSEIA with fundings from CNPq/CAPES/FAP-DF. Last but not least we are grateful to the Global Lake Ecological Observatory Network (GLEON: www.gleon.org) for providing a venue and resources for lake science discussions. The English version of the manuscript was revised by Dr. Janet W. Reid (Trumansburg, NY, U.S.A.).
579
580
581
582
583
584
585
586
587
588
589
590
591
592
593
594
595
596
597
598
599
600
601
602
603
604
605
606
607
608
609
610
611
612
613
614
615
616
617
618
619
620
621
622
623
624
625
626
627
628
629
630
631
632
633
634
References
Beji S, Battjes J (1993) Experimental investigation of wave propagation over a bar. Coastal Engineering 19(1-2):151-162
Beji S, Battjes J (1994) Numerical simulation of nonlinear wave propagation over a bar. Coastal Engineering 23(1-2):1-16
Boso F, Bellin A, Dumbser M (2013) Numerical simulations of solute transport in highly heterogeneous formations: A comparison of alternative numerical schemes. Advances in water resources 52:178-189
Casulli V (1990) Semi-implicit finite difference methods for the two-dimensional shallow water equations. Journal of Computational Physics 86(1):56-74
Casulli V (1999) A semi-implicit finite difference method for non-hydrostatic, free-surface flows. International Journal for Numerical Methods in Fluids 30(4):425-440
Casulli V, Cheng RT (1992) Semi-implicit finite difference methods for three-dimensional shallow water flow. International Journal for numerical methods in fluids 15(6):629-648
Casulli V, Lang G (2004) Mathematical model untrim, validation document 1.0. the federal waterways engineering and research institute (baw), hamburg, germany
Casulli V, Stelling GS (1998) Numerical simulation of 3d quasi-hydrostatic, free-surface flows. Journal of Hydraulic Engineering 124(7):678-686
Casulli V, Zanolli P (2005) High resolution methods for multidimensional advection-diffusion problems in free-surface hydrodynamics. Ocean Modelling 10(1-2):137-151
Cavalcanti JR, Dumbser M, da Motta-Marques D, Junior CRF (2015) A conservative finite volume scheme with time-accurate local time stepping for scalar transport on unstructured grids. Advances in water resources 86:217-230
Cavalcanti JR, da Motta-Marques D, Fragoso Jr CR (2016) Process-based modeling of shallow lake metabolism: Spatio-temporal variability and relative importance of individual processes. Ecological modelling 323:28-40
Chandran K, Saha AK, Mohapatra PK (2019) Simulation of free surface flows with non-hydrostatic pressure distribution. Sadhana 44(1):20
Chen X (2003) A fully hydrodynamic model for three-dimensional, free-surface flows. International Journal for Numerical Methods in Fluids 42(9):929-952
Cheng RT, Casulli V, Milford SN (1984) Eulerian-lagrangian solution of the convection-dispersion equation in natural coordinates. Water Resources Research 20(7):944-952
Cox T, Runkel R (2008) Eulerian-lagrangian numerical scheme for simulating advection, dispersion, and transient storage in streams and a comparison of numerical methods. Journal of Environmental Engineering 134(12):996-1005
Cui H, Pietrzak J, Stelling G (2012) Improved efficiency of a non-hydrostatic, unstructured grid, finite volume model. Ocean Modelling 54:55-67
Darwish M, Moukalled F (2003) Tvd schemes for unstructured grids. International Journal of heat and mass transfer 46(4):599-611
Dingemans M (1994) Comparison of computations with boussinesq-like models and laboratory measurements. memo in framework of MAST project (G8-M), Delft Hydraulics memo H1684 12
Fringer O, Armfield S, Street R (2005) Reducing numerical diffusion in interfacial gravity wave simulations. International Journal for Numerical Methods in Fluids 49(3):301-329
Hodges BR, Imberger J, Saggio A, Winters KB (2000) Modeling basin-scale internal waves in a stratified lake. Limnology and oceanography 45(7):1603-1620
Hodges BR, Laval B, Wadzuk BM (2006) Numerical error assessment and a temporal horizon for internal waves in a hydrostatic model. Ocean modelling 13(1):44-64
Jankowski JA (1999) A non-hydrostatic model for free surface flows. PhD thesis, Inst. fur Stromungsmechanik und Elektronisches Rechnen im Bauwesen
Jin KR, Ji ZG (2005) Application and validation of three-dimensional model in a shallow lake. Journal of waterway, port, coastal, and ocean engineering 131(5):213-225
Kong J, Xin P, Shen CJ, Song ZY, Li L (2013) A high-resolution method for the depth-integrated solute transport equation based on an unstructured mesh. Environmental modelling &amp;amp; software 40:109-127
Laval B, Imberger J, Hodges BR, Stocker R (2003) Modeling circulation in lakes: Spatial and temporal variations. Limnology and Oceanography 48(3):983-994
Laval BE, Imberger J, Findikakis AN (2005) Dynamics of a large tropical lake: Lake maracaibo. Aquatic sciences 67(3):337-349
635
636
637
638
639
640
641
642
643
644
645
646
647
648
649
650
651
652
653
654
655
656
657
658
659
660
661
662
663
664
665
666
667
668
669
670
671
672
673
674
675
676
677
678
679
680
681
682
683
684
685
686
687
688
689
690
691
692
Leonard B (1991) The ultimate conservative difference scheme applied to unsteady one-dimensional advection. Computer methods in applied mechanics and engineering 88(1):17-74
Li Y, Huang P (2008) A coupled lattice boltzmann model for advection and anisotropic dispersion problem in shallow water. Advances in Water Resources 31(12):1719-1730
Liu X, Ma Dg, Zhang Qh (2017) A higher-efficient non-hydrostatic finite volume model for strong three-dimensional free surface flows and sediment transport. China Ocean Engineering 31(6):736-746 Marshall J, Hill C, Perelman L, Adcroft A (1997) Hydrostatic, quasi-hydrostatic, and nonhydrostatic ocean modeling. Journal of Geophysical Research: Oceans 102(C3):5733-5752
Monteiro LR, Schettini EBC (2015) Comparação entre a aproximaçao hidrostática e a nao-hidrostatica na simulacao numárica de escoamentos com superfácie livre. Revista Brasileira de Recursos Hádricos 20:1051-1062
Munar AM, Cavalcanti JR, Bravo JM, Fan FM, da Motta-Marques D, Fragoso Jr CR (2018) Coupling large-scale hydrological and hydrodynamic modeling: Toward a better comprehension of watershedshallow lake processes. Journal of hydrology 564:424-441
Nangia N, Griffith BE, Patankar NA, Bhalla APS (2019) A robust incompressible navier-stokes solver for high density ratio multiphase flows. arXiv preprint arXiv:180901008
Oliveira A, Baptista AM (1998) On the role of tracking on eulerian-lagrangian solutions of the transport equation. Advances in Water Resources 21:539-554
Park JC, Kim MH, Miyata H (1999) Fully non-linear free-surface simulations by a 3d viscous numerical wave tank. International Journal for Numerical Methods in Fluids 29(6):685-703
Roe PL (1986) Characteristic-based schemes for the euler equations. Annual review of fluid mechanics 18(1):337-365
Ruan F, McLaughlin D (1999) An investigation of eulerian-lagrangian methods for solving heterogeneous advection-dominated transport problems. Water Resources Research 35(8):2359-2373
Soulignac F, Vincon-Leite B, Lemaire BJ, Martins JRS, Bonhomme C, Dubois P, Mezemate Y, Tchigu-irinskaia I, Schertzer D, Tassin B (2017) Performance assessment of a 3d hydrodynamic model using high temporal resolution measurements in a shallow urban lake. Environmental Modeling &amp;amp; Assessment 22(4):309-322
Staniforth A, Cote J (1991) Semi-lagrangian integration schemes for atmospheric models—a review. Monthly weather review 119(9):2206-2223
Stelling G, Zijlema M (2003) An accurate and efficient finite-difference algorithm for non-hydrostatic free-surface flow with application to wave propagation. International Journal for Numerical Methods in Fluids 43(1):1-23
Sweby PK (1984) High resolution schemes using flux limiters for hyperbolic conservation laws. SIAM journal on numerical analysis 21(5):995-1011
Tang X, Chao J, Gong Y, Wang Y, Wilhelm SW, Gao G (2017) Spatiotemporal dynamics of bacterial community composition in large shallow eutrophic lake taihu: High overlap between free-living and particle-attached assemblages. Limnology and Oceanography 62(4):1366-1382
Thorpe S (1968) On standing internal gravity waves of finite amplitude. Journal of Fluid Mechanics 32(3):489-528
Valipour R, Bouffard D, Boegman L, Rao YR (2015) Near-inertial waves in lake erie. Limnology and Oceanography 60(5):1522-1535
Van Leer B (1979) Towards the ultimate conservative difference scheme. v. a second-order sequel to godunov’s method. Journal of computational Physics 32(1):101-136
Vilas MP, Marti CL, Adams MP, Oldham CE, Hipsey MR (2017) Invasive macrophytes control the spatial and temporal patterns of temperature and dissolved oxygen in a shallow lake: A proposed feedback mechanism of macrophyte loss. Frontiers in plant science 8:2097
Wadzuk BM, Hodges BR (2004) Hydrostatic and non-hydrostatic internal wave models. Tech. rep., Center for Research in Water Resources, University of Texas at Austin
Walters RA (2005) A semi-implicit finite element model for non-hydrostatic (dispersive) surface waves. International Journal for Numerical Methods in Fluids 49(7):721-737
Wang H, Lacroix M (1997) Interpolation techniques applied to the eulerian-lagrangian solution of the convection-dispersion equation in natural coordinates. Computers &amp;amp; Geosciences 23(6):677-688
Waterson NP, Deconinck H (2007) Design principles for bounded higher-order convection schemes-a unified approach. Journal of Computational Physics 224(1):182-207
Ye R, Zhang C, Kong J, Jin G, Zhao H, Song Z, Li L (2018) A non-negative and high-resolution finite volume method for the depth-integrated solute transport equation using an unstructured triangular mesh. Environmental Fluid Mechanics pp 1-33
693
694
695
696
697
698
699
700
701
702
Yin J, Sun Jw, Wang Xg, Yu Yh, Sun Zc (2017) A hybrid finite-volume and finite difference scheme for depth-integrated non-hydrostatic model. China Ocean Engineering 31(3):261-271
Yuan H, Wu CH (2004) An implicit three-dimensional fully non-hydrostatic model for free-surface flows. International Journal for Numerical Methods in Fluids 46(7):709-733
Zhang J, Liang D, Liu H (2018) A hybrid hydrostatic and non-hydrostatic numerical model for shallow flow simulations. Estuarine, Coastal and Shelf Science 205:21-29
Zhang Z, Song Zy, Kong J, Hu D (2015) A new r-ratio formulation for tvd schemes for vertex-centered fvm on an unstructured mesh. International Journal for Numerical Methods in Fluids 81(12):741-764
Zijlema M, Stelling GS (2005) Further experiences with computing non-hydrostatic free-surface flows involving water waves. International journal for numerical methods in fluids 48(2):169-197
Conclusão
Conclusão
O trabalho foi desenvolvido em grandes temas, passando pela implementação e tratamento adequado do termo de pressão não-hidrostática, identificação das relações da difusão numérica gerada na solução hidrodinâmica e de transporte e utilização de soluções numéricas mais completas de alta resolução para simulação de escoamentos estratificados em geometrias complexas.
O algorítimo utilizado para implementação da aproximação não hidrostática no modelo IPH-ECO se mostrou capaz de simular adequadamente a celeridade e a dispersão de frequência de ondas estacionárias em condição de águas profundas (H&gt;0.5m) utilizando uma resolução vertical mais flexível (10-layers ou mais) que um modelo não-hidrostático clássico, sem tratamento na condição de contorno (20-layers ou mais). Apesar da melhoria, o resultado ainda é limitado pela discretização utilizada para equação do momento vertical, enquadrando o método como de baixo custo de implementação e eficiência média.
A discretização utilizada tem uma dependência do perfil vertical de velocidades, que é menos preciso a medidas que a resolução vertical utilizada na simulação aumenta. Isto faz com que o modelo precise de uma resolução vertical apropriada para obter resultados satisfatórios. Quando comparado com a abordagem clássica de implementação da aproximação não-hidrostática, o método proposta tem um ganho substancial, gerando resultados semelhantes utilizados uma resolução vertical 2 vezes menor. Este resultado permite que modelos hidrodinâmicos semelhantes melhorem sua solução numérica com um baixo custo de implementação, aplicando um tratamento simples na condição de contorno da pressão não-hidrostática na superfície livre, consequentemente dmelhorando a performance em simulações hidrodinâmicas não-hidrostáticas.
Ainda quanto a melhoria do módulo hidrodinâmico, o interpolador bilinear aplicado ao passo-ii do ELM teve difusão numérica ca. 10 vezes maior que a interpolação quadrática. Além disso, a interpolação bilinear não apresentou melhoria substancial, em termos de difusão numérica, em comparação com a simulação sem esquema de advecção (negligenciando os termos convectivos). A interpolação quadrática diminuiu substancialmente a difusão numérica e melhorou a conservação de massa sobre a simulação, indicando que métodos de alta resolução podem ser utilizados para alcançar soluções conservativas em simulações de superfície livre.
A maior difusão numérica também foi observada quando o interpolador bilinear, aplicado ao passo-ii do ELM, foi utilizado em conjunto com diferentes esquemas de Limitadores de Fluxo na solução de transporte de massa (Cheng et al., 1984), indicando que esquemas de alta resolução podem ser usados com sucesso para atenuar o difusão para soluções de modelos acoplados hidrodinâmicos e de transporte. O conjunto de experimentos numéricos mostrou que
a interpolação quadrática é um método poderoso e promissor para reduzir a difusão numérica, com um ligeiro aumento do custo computacional em relação a um interpolador bilinear (7.3 % a mais) e também pode ser aplicado em modelos 1D, 2D ou 3D.
Quanto ao Tranporte de Soluto, a análise da difusão numérica gerada mostrou que o esquema UpWind tem sérios problemas de difusão numérica (Lerror ca. 5%) e pode ser considerado um modelo não adequado para simulação de escoamentos estratificados. O Limitador de Fluxo SuperBee teve os melhores resultados dentre os métodos de alta resolução testados (Lerror ca. 0,3% e RMSE ca. 0,24 kg/m3 utilizando interpolação quadrática). Apesar de maiores análises ainda serem necessárias para definir o melhor limitador de fluxo, o Superbee vem sido utilizado co sucesso por alguns modelos (e.g. Hodges et al., 2000; Casulli e Zanolli, 2005; Ye et al., 2018; Zhang et al., 2018), o que prova ser capaz de simular escoamentos estratificados.
Esquemas de alta resolução são adequados para reduzir a difusão numérica, mas o uso combinado deles em soluções Hidrodinâmica e de Transporte de Soluto pode melhorar ainda mais o resultado geral. Quando o esquema UpWind foi usado, as diferenças entre as técnicas de interpolação foram mascaradas pela elevada difusão numérica do esquema, entretanto, quando métodos de alta resolução foram utilizados na solução do transporte, as diferenças foram claras (eficiência ca. 3 vezes maior). O uso combinado de métodos de alta resolução mostra que a técnica de interpolação na solução hidrodinâmica tem um efeito substancial na solução de transporte de massa, e que, apesar da melhoria dos Limitadores de Fluxo em relação ao Upwind, a aplicação de interpolações lineares no passo-ii do ELM mostra um Erro relativo de 2 a 3 vezes maior que quando usado um interpolador não-linear, se aproximando do comportamento de uma solução sem termos advectivos.
A difusão numérica gerada por métodos de baixa resolução na solução hidrodinâmica pode ter grande impacto na solução do transporte, por tanto, para simular com maior precisão situações reais (dinâmica de escoamentos estratificados em reservatórios profundos) o uso combinado de métodos de alta resolução se mostrou necessário, ainda sendo de baixo custo de implementação, em relação à discretizações de alta ordem das equações governantes, e com elevada eficiência na redução da difusão numérica. Os resultados alcançados neste trabalho permitem que modelos mais difusivos, como o IPH-ECO (Fragoso Jr et al., 2009), passem a considerar a difusão física real ao invés da difusão numérica em suas modelagens, e portanto utilizar o coeficiente de difusão como um parâmetro de calibração do modelo.
Referências
Bergh, J. e Berntsen, J. (2010). The surface boundary condition in nonhydrostatic ocean models. Ocean dynamics, 60(2):301-315.
Bohacek, J., Kharicha, A., Ludwig, A., Wu, M., Karimi-Sibaki, E., Paar, A., Brandner, M., Elizondo, L., e Trickl, T. (2018). A (non-) hydrostatic free-surface numerical model for two-layer flows. Applied Mathematics and Computation, 319:301-317.
Boso, F., Bellin, A., e Dumbser, M. (2013). Numerical simulations of solute transport in highly heterogeneous formations: A comparison of alternative numerical schemes. Advances in water resources, 52:178-189.
Casulli, V. (1999). A semi-implicit finite difference method for non-hydrostatic, free-surface flows. International Journal for Numerical Methods in Fluids, 30(4):425-440.
Casulli, V. e Cattani, E. (1994). Stability, accuracy and efficiency of a semi-implicit method for three-dimensional shallow water flow. Computers &amp;amp; Mathematics with Applications, 27(4):99-112.
Casulli, V. e Cheng, R. T. (1992). Semi-implicit finite difference methods for three-dimensional shallow water flow. International Journal for numerical methods in fluids, 15(6):629-648.
Casulli, V. e Lang, G. (2004). Mathematical model untrim, validation document 1.0. the federal waterways engineering and research institute (baw), hamburg, germany.
Casulli, V. e Stelling, G. S. (1998). Numerical simulation of 3d quasi-hydrostatic, free-surface flows. Journal of Hydraulic Engineering, 124(7):678-686.
Casulli, V. e Zanolli, P. (2005). High resolution methods for multidimensional advection-diffusion problems in free-surface hydrodynamics. Ocean Modelling, 10(1-2):137-151.
Cavalcanti, J. R., da Motta-Marques, D., e Fragoso Jr, C. R. (2016). Process-based modeling of shallow lake metabolism: Spatio-temporal variability and relative importance of individual processes. Ecological modelling, 323:28-40.
Cavalcanti, J. R., Dumbser, M., da Motta-Marques, D., e Junior, C. R. F. (2015). A conservative finite volume scheme with time-accurate local time stepping for scalar transport on unstructured grids. Advances in water resources, 86:217-230.
Cavalcanti, J. R. d. A. (2017). Dinâmica espacial e temporal do metabolismo aquático em sistemas subtropicais. PhD thesis, Universidade Federal do Rio Grande do Sul - Instituto de Pesquisas Hidráulicas.
Chandran, K., Saha, A. K., e Mohapatra, P. K. (2019). Simulation of free surface flows with non-hydrostatic pressure distribution. Sãdhanã, 44(1):20.
Chapra, S. C., Canale, R. P., et al. (2010). Numerical methods for engineers. Boston: McGraw-Hill Higher Education,.
Chen, C., Beardsley, e et al (2011). An unstructured grid, finite-volume coastal ocean model fvcom user manual. SMAST/UMASSD, 11.
Chen, X. (2003). A fully hydrodynamic model for three-dimensional, free-surface flows. International Journal for Numerical Methods in Fluids, 42(9):929-952.
Cheng, R. T., Casulli, V., e Gartner, J. W. (1993). Tidal, residual, intertidal mudflat (trim) model and its applications to san francisco bay, california. Estuarine, Coastal and Shelf Science, 36(3):235-280.
Cheng, R. T., Casulli, V., e Milford, S. N. (1984). Eulerian-lagrangian solution of the convectiondispersion equation in natural coordinates. Water Resources Research, 20(7):944-952.
Collischonn, W. e Marques, D. (2003). Desenvolvimento de um modelo hidrodinâmico de transporte de sedimentos e nutrientes para lagos. Em Anais do IX Congresso Brasileiro de Limnologia.
Cox, T. e Runkel, R. (2008). Eulerian-lagrangian numerical scheme for simulating advection, dispersion, and transient storage in streams and a comparison of numerical methods. Journal of Environmental Engineering, 134(12):996-1005.
Cui, H., Pietrzak, J., e Stelling, G. (2012). Improved efficiency of a non-hydrostatic, unstructured grid, finite volume model. Ocean Modelling, 54:55-67.
da Paz, A. R., Villanueva, A. N., e Schettini, E. B. (2003). Wetting and drying algorithm to two-dimensional hydrodynamic modelling of wetlands. Em XXV CILAMCE (Iberian Latin American Congress on Computational Methods in Engineering).
Darwish, M. e Moukalled, F. (2003). Tvd schemes for unstructured grids. International Journal of heat and mass transfer, 46(4):599-611.
de Brito Jr, A. N., Fragoso Jr, C. R., e Larson, M. (2018). Tidal exchange in a choked coastal lagoon: A study of mundaú lagoon in northeastern brazil. Regional Studies in Marine Science, 17:133-142.
Escalante, C., de Luna, T. M., e Castro, M. (2018a). Non-hydrostatic pressure shallow flows: Gpu implementation using finite volume and finite difference scheme. Applied Mathematics and Computation, 338:631-659.
Escalante, C., Fernández-Nieto, E., de Luna, T. M., e Castro, M. (2018b). An efficient two-layer non-hydrostatic approach for dispersive water waves. Journal of Scientific Computing, pgs. 1-48.
Fragoso Jr, C. (2005). Simulações da dinâmica de fitoplâncton no sistema hidrológico do taim.
Fragoso Jr, C. R., Marques, D. M. M., Collischonn, W., Tucci, C. E., e van Nes, E. H. (2008). Modelling spatial heterogeneity of phytoplankton in lake mangueira, a large shallow subtropical lake in south brazil. Ecological modelling, 219(1-2):125-137.
Fragoso Jr, C. R., Marques, D. M. M., Ferreira, T. F., Janse, J. H., e van Nes, E. H. (2011). Potential effects of climate change and eutrophication on a large subtropical shallow lake. Environmental Modelling &amp;amp; Software, 26(11):1337-1348.
Fragoso Jr, C. R., van Nes, E. H., Janse, J. H., e da Motta Marques, D. (2009). Iph-trim3d-pclake: A three-dimensional complex dynamic model for subtropical aquatic ecosystems. Environmental Modelling &amp;amp; Software, 24(11):1347-1348.
Fringer, O., Armfield, S., e Street, R. (2005). Reducing numerical diffusion in interfacial gravity wave simulations. International Journal for Numerical Methods in Fluids, 49(3):301-329.
Fringer, O., Gerritsen, M., e Street, R. (2006). An unstructured-grid, finite-volume, nonhydrostatic, parallel coastal ocean simulator. Ocean Modelling, 14(3-4):139-173.
Gross, E. S., Casulli, V., Bonaventura, L., e Koseff, J. R. (1998). A semi-implicit method for vertical transport in multidimensional models. International Journal for Numerical Methods in Fluids, 28(1):157-186.
Hodges, B. R., Imberger, J., Saggio, A., e Winters, K. B. (2000). Modeling basin-scale internal waves in a stratified lake. Limnology and oceanography, 45(7):1603-1620.
Hodges, B. R., Laval, B., e Wadzuk, B. M. (2006). Numerical error assessment and a temporal horizon for internal waves in a hydrostatic model. Ocean modelling, 13(1):44-64.
Horne, A. J. e Goldman, C. R. (1994). Limnology. McGraw-Hill New York.
Jankowski, J. A. (1999). A non-hydrostatic model for free surface flows. PhD thesis, Inst. für Stromungsmechanik und Elektronisches Rechnen im Bauwesen.
Janse, J. H. (2005). Model studies on the eutrophication of shallow lakes and ditches. Wageningen Universiteit.
Kanarska, Y. e Maderich, V. (2003). A non-hydrostatic numerical model for calculating free-surface stratified flows. Ocean Dynamics, 53(3):176-185.
Kong, J., Xin, P., Shen, C.-J., Song, Z.-Y., e Li, L. (2013). A high-resolution method for the depth-integrated solute transport equation based on an unstructured mesh. Environmental modelling &amp;amp; software, 40:109-127.
Laval, B., Hodges, B. R., e Imberger, J. (2003a). Reducing numerical diffusion effects with pycnocline filter. Journal of Hydraulic Engineering, 129(3):215-224.
Laval, B., Imberger, J., Hodges, B. R., e Stocker, R. (2003b). Modeling circulation in lakes: Spatial and temporal variations. Limnology and Oceanography, 48(3):983-994.
Laval, B. E., Imberger, J., e Findikakis, A. N. (2005). Dynamics of a large tropical lake: Lake maracaibo. Aquatic sciences, 67(3):337-349.
Li, Y. e Huang, P. (2008). A coupled lattice boltzmann model for advection and anisotropic dispersion problem in shallow water. Advances in Water Resources, 31(12):1719-1730.
Liu, X., Ma, D.-g., e Zhang, Q.-h. (2017). A higher-efficient non-hydrostatic finite volume model for strong three-dimensional free surface flows and sediment transport. China Ocean Engineering, 31(6):736-746.
Lu, X., Dong, B., Mao, B., e Zhang, X. (2015). A two-dimensional depth-integrated nonhydrostatic numerical model for nearshore wave propagation. Ocean Modelling, 96:187-202.
Lv, B. (2014). A higher-efficient three-dimensional numerical model for small amplitude free surface flows. China Ocean Engineering, 28(5):617-628.
Marshall, J., Hill, C., Perelman, L., e Adcroft, A. (1997). Hydrostatic, quasi-hydrostatic, and nonhydrostatic ocean modeling. Journal of Geophysical Research: Oceans, 102(C3):5733-5752.
Monteiro, L. R. e Schettini, E. B. C. (2015). Comparação entre a aproximação hidrostática e a não-hidrostática na simulação numérica de escoamentos com superfície livre. Revista Brasileira de Recursos Hídricos, 20:1051-1062.
Munar, A. M., Cavalcanti, J. R., Bravo, J. M., Fan, F. M., da Motta-Marques, D., e Fragoso Jr, C. R. (2018). Coupling large-scale hydrological and hydrodynamic modeling: Toward a better comprehension of watershed-shallow lake processes. Journal of hydrology, 564:424-441.
Namin, M., Lin, B., e Falconer, R. (2001). An implicit numerical algorithm for solving nonhydrostatic free-surface flow problems. International Journal for Numerical Methods in Fluids, 35(3):341-356.
Nangia, N., Griffith, B. E., Patankar, N. A., e Bhalla, A. P. S. (2019). A robust incompressible navier-stokes solver for high density ratio multiphase flows. arXiv preprint arXiv:1809.01008.
Oliveira, A. e Baptista, A. M. (1998). On the role of tracking on eulerian-lagrangian solutions of the transport equation. Advances in Water Resources, 21:539-554.
Pereira, F., Fragoso Jr, C., Uvo, C., Collischonn, W., e Motta-Marques, D. (2013). Assessment of numerical schemes for solving the advection-diffusion equation on unstructured grids: case study of the guaíba river, brazil. Nonlinear Processes in Geophysics, 20(6):1113-1125.
Pereira, F. F. (2010). Modelo hidrodinâmico e de transporte bidimensional de grade não estruturada para lagos rasos. Master’s thesis, Universidade Federal do Rio Grande do Sul.
Roe, P. L. (1986). Characteristic-based schemes for the euler equations. Annual review of fluid mechanics, 18(1):337-365.
Rosman, P. C. C. et al. (2015). Referência técnica do sisbahia. Escola Politécnica e da Área de Engenharia.
Ruan, F. e McLaughlin, D. (1999). An investigation of eulerian-lagrangian methods for solving heterogeneous advection-dominated transport problems. Water Resources Research, 35(8):2359-2373.
Soulignac, F., Vinçon-Leite, B., Lemaire, B. J., Martins, J. R. S., Bonhomme, C., Dubois, P., Mezemate, Y., Tchiguirinskaia, I., Schertzer, D., e Tassin, B. (2017). Performance assessment of a 3d hydrodynamic model using high temporal resolution measurements in a shallow urban lake. Environmental Modeling &amp;amp; Assessment, 22(4):309-322.
Staniforth, A. e Côté, J. (1991). Semi-lagrangian integration schemes for atmospheric models—a review. Monthly weather review, 119(9):2206-2223.
Stelling, G. e Zijlema, M. (2003). An accurate and efficient finite-difference algorithm for nonhydrostatic free-surface flow with application to wave propagation. International Journal for Numerical Methods in Fluids, 43(1):1—23.
Sweby, P. K. (1984). High resolution schemes using flux limiters for hyperbolic conservation laws. SIAM journal on numerical analysis, 21(5):995-1011.
Tamamidis, P. e Assanis, D. N. (1993). Evaluation of various high-order-accuracy schemes with and without flux limiters. International Journal for Numerical Methods in Fluids, 16(10):931-948.
Valipour, R., Bouffard, D., Boegman, L., e Rao, Y. R. (2015). Near-inertial waves in lake erie. Limnology and Oceanography, 60(5):1522-1535.
Vilas, M. P., Marti, C. L., Adams, M. P., Oldham, C. E., e Hipsey, M. R. (2017). Invasive macrophytes control the spatial and temporal patterns of temperature and dissolved oxygen in a shallow lake: A proposed feedback mechanism of macrophyte loss. Frontiers in plant science, 8:2097.
Wadzuk, B. M. e Hodges, B. R. (2004). Hydrostatic and non-hydrostatic internal wave models. Technical report, Center for Research in Water Resources, University of Texas at Austin.
Walters, R. A. (2005). A semi-implicit finite element model for non-hydrostatic (dispersive) surface waves. International Journal for Numerical Methods in Fluids, 49(7):721-737.
Wang, H. e Lacroix, M. (1997). Interpolation techniques applied to the eulerian-lagrangian solution of the convection-dispersion equation in natural coordinates. Computers &amp;amp; Geosciences, 23(6):677-688.
Wang, K., Jin, S., e Liu, G. (2009). Numerical modelling of free-surface flows with bottom and surface-layer pressure treatment. Journal of Hydrodynamics, 21(3):352-359.
Waterson, N. P. e Deconinck, H. (2007). Design principles for bounded higher-order convection schemes-a unified approach. Journal of Computational Physics, 224(1):182-207.
Ye, R., Zhang, C., Kong, J., Jin, G., Zhao, H., Song, Z., e Li, L. (2018). A non-negative and high-resolution finite volume method for the depth-integrated solute transport equation using an unstructured triangular mesh. Environmental Fluid Mechanics, pgs. 1-33.
Yuan, H. e Wu, C. H. (2004). An implicit three-dimensional fully non-hydrostatic model for free-surface flows. International Journal for Numerical Methods in Fluids, 46(7):709-733.
Zhang, J., Liang, D., e Liu, H. (2018). A hybrid hydrostatic and non-hydrostatic numerical model for shallow flow simulations. Estuarine, Coastal and Shelf Science, 205:21-29.
Zhang, Y. e Baptista, A. M. (2008). Selfe: a semi-implicit eulerian-lagrangian finite-element model for cross-scale ocean circulation. Ocean modelling, 21(3-4):71-96.
Zhang, Z., Song, Z.-y., Kong, J., e Hu, D. (2015). A new r-ratio formulation for tvd schemes for vertex-centered fvm on an unstructured mesh. International Journal for Numerical Methods in Fluids, 81(12):741-764.
Zijlema, M. e Stelling, G. S. (2005). Further experiences with computing non-hydrostatic free-surface flows involving water waves. International journal for numerical methods in fluids, 48(2):169-197.</field>
	</doc>
</add>