<?xml version="1.0" encoding="utf-8"?>
<add>
	<doc>
		<field name="docid">BR-TU.25287</field>
		<field name="filename">9947_TeseFirmianoUSP2010.pdf</field>
		<field name="filetype">PDF</field>
		<field name="text">
UNIVERSIDADE DE SÃO PAULO 

ESCOLA DE ENGENHARIA DE SÃO CARLOS 

DEPARTAMENTO DE HIDRÁULICA E SANEAMENTO 

PROGRAMA DE PÓS GRADUAÇÃO EM ENGENHARIA HIDRÁULICA 

 

 

 

 

 

ALESSANDRO FIRMIANO DE JESUS 

 

 

 

 

Um Estimador de Erro a posteriori para a Equação do 

Transporte de Contaminantes em Regime de Pequena Advecção 

 

 

 

 

 

 

 

 

 

 

 

 

 

São Carlos 
2010 

 
 



  



ALESSANDRO FIRMIANO DE JESUS 

 

 

 

 

 

 

 

Um Estimador de Erro a posteriori para a Equação do  

Transporte de Contaminantes em Regime de Pequena Advecção 

 

 

 

 

 

 

 

Tese apresentada à Escola de Engenharia de São 
Carlos como parte dos requisitos para a 
obtenção do Título de Doutor em Engenharia 
Hidráulica e Saneamento 
 
Orientador: Prof. Assoc. Edson Cezar Wendland 

 

 
 
 
 

 
 
 
 
 

 
 
 

São Carlos 
2010 

 
 



 
 
 
 
 
 
 
 
 
 
 

 
 
 
 
  



 
 
 
 
 
 
Errata: O Prof. Dr. Jackson Roehrig pertence à instituição Cologne University of Applied Sciences - CUAS  



 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 



 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 

Às minhas filhas Tamiris, Letícia e Bianca, 
pelos créditos que fortalecem minha inspiração. 

 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 



  



AGRADECIMENTOS 
 
 

A Deus, por prover oportunidades que estimulam o conhecimento justo e 

correto das coisas. 

Aos meus pais, Marciano e Izilda, que cultivam na minha personalidade as 

respectivas características de humildade e perseverança. 

À minha esposa Patrícia, por compreender o meu conveniente estado de 

ausência e ainda alicerçar um lar harmonioso. 

Ao Prof. Dr-Ing Edson Wendland, por conduzir a orientação deste trabalho 

com tenacidade para arrumar os meus desalinhos, com coerência para conceber a minha 

autonomia e com encorajamento para superação dos meus desânimos. 

Ao Prof. Dr-Ing Jackson Roehrig, co-orientador no ITT FH-Köln, por 

desvendar os mistérios acerca de linguagem de programação e por apoiar o meu estágio na 

Alemanha durante o doutorado sanduíche. 

Às funcionárias Rose, Sá e Pavi, do Departamento de Hidráulica e 

Saneamento – EESC/USP, pela cordialidade e atenção no tratamento de questões relevantes e 

cotidianas do PPG-SHS. 

À Rosemeire Zambom, bibliotecária do ICMC/USP, pela amizade e pelos 

vários artigos científicos que me enviou para referenciar este trabalho. 

Aos companheiros do LHC, Luis Henrique, Francisco Marcuzzo, Anderson, 

Mariano Alencar, Ivan Marin, pelas diversas contribuições pessoais durante uma convivência 

agradável e peculiar. 

Aos Profs. Drs. do Depto. de Matemática da UFSCAR, os meus amigos 

Luís Antônio, Marcus Vinícios e Waldeck Schutzer por esclarecerem conceitos essenciais. 

Aos docentes da AFA, dos quais as constantes trocas de experiências foram 

favoráveis à pesquisa. Ao Prof. Dr. Laércio que partilhou dos problemas às descobertas. 

Aos demais familiares e amigos que opinavam, torciam, incentivavam, 

elogiavam e amparavam, somente pelo reconhecimento na importância que eu dava para a 

elaboração deste trabalho. 

À Capes pelo apoio financeiro do projeto Probral processo Capes/DAAD 

BEX1017/07-1 para realizar o estágio de doutorado na Alemanha. 

À Academia da Força Aérea – AFA/Pirassununga. 

 

A todos, os meus sinceros agradecimentos. 



 
  



 

 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 

Não há nada que conduza à verdade. Temos que 
navegar por mares sem roteiros para encontrá-la. 

Afirmo que a verdade é uma terra sem caminho. 
 

Jiddu Krishnamurti  
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 



  



RESUMO 
 
 
JESUS, A. F., (2010). Um Estimador de Erro a posteriori para a Equação do Transporte 
de Contaminantes em Regime de Pequena Advecção. 2010. 150 f. Tese (Doutorado) – 
Escola de Engenharia de São Carlos, Universidade de São Paulo, 2010. 
 
 
Vários modelos computacionais que implementam o transporte de soluto em meio poroso 
saturado surgem constantemente em publicações científicas devido à suma importância dada à 
compreensão e previsão do transporte de constituintes dissolvidos em água subterrânea. As 
soluções numéricas obtidas por esquemas computacionais não estão imunes aos erros de 
discretização. No entanto, a confiabilidade nos resultados obtidos das complexas operações 
provenientes da dinâmica de fluidos computacional pode ser aumentada através de 
estimadores de erro a posteriori que indicam a precisão da solução numérica de um modelo 
matemático que simula o fenômeno físico de interesse.  Neste trabalho é apresentado um 
estimador residual para a equação parabólica que descreve os fenômenos de advecção-
dispersão-reação (ADR) em meio poroso saturado, considerando o transporte em regime de 
pequena advecção. A solução numérica da equação ADR é obtida pelo método dos elementos 
finitos que emprega termos upwind para minimizar as inconvenientes oscilações espúrias. A 
implementação do código computacional para obter essa solução numérica e o seu 
correspondente erro a posteriori, é feita em linguagem JAVA na plataforma Eclipse seguindo o 
paradigma da Programação Orientada a Objetos (POO). A solução numérica da equação 
elíptica do fluxo subterrâneo e o seu estimador de erro com características de recuperação do 
gradiente, o estimador ZZ, também são implementados no código JAVA. Assim, a solução da 
equação do transporte é obtida em função da reusabilidade POO prevista na implementação da 
equação do fluxo. A comparação da solução numérica do modelo ADR 2D com a 
correspondente solução analítica disponível na literatura, demonstra que o estimador residual 
apresenta excelentes índices de eficiência. Os resultados numéricos obtidos mostraram que o 
estimador residual encontra-se limitado inferior e superiormente pelo erro real da solução em 
malha grosseira. O estimador ZZ mostrou-se inadequado para a análise do erro de 
aproximação das equações ADR. Os exemplos selecionados para verificação e aplicação do 
estimador residual abrangem, em diferentes escalas, modelos que descrevem reação de 
primeira ordem e modelos com fenômenos de sorção e retardamento na migração do 
contaminante em meio poroso saturado. Em conseqüência, o estimador residual proposto 
provou ser computável, eficiente e robusto no sentido de abranger uma grande variedade das 
aplicações dos fenômenos de transporte de contaminantes em meio poroso saturado e regime 
de pequena advecção. 
 
Palavras Chave: Águas Subterrâneas, Estimador Residual, Equação Parabólica, Transporte 
Advectivo, Meio Poroso, Código JAVA, Método dos Elementos Finitos, Indicador Temporal. 
 

 

 

 

 

 



 

 
  



ABSTRACT 
 
 
JESUS, A. F., (2010). A posteriori Error Estimate for the Contaminant Transport 
Equation in Small Advection Regime. 2010. 150 f. Doctoral Thesis. Escola de Engenharia 
de São Carlos, Universidade de São Paulo, 2010. 
 
 
Several computational models that implement the solute migration in saturated porous media 
constantly appear in scientific publications due to the great importance given to the 
understanding and forecast of the solute transport in groundwater. The numerical solutions 
obtained by computational schemes are not immune to errors related to the discretization 
process. However, the reliability of the results obtained by the complex operations of the 
computational fluids dynamics can be enhanced by a posteriori error estimates that indicate 
the accuracy of the numerical solution. In this work a residual error estimator is presented for 
the parabolic equation that describes the advection-dispersion-reaction phenomena (ADR) in 
saturated porous media, considering the transport in small advection regime. The numerical 
solution of the ADR equation is obtained by the finite element method using upwind terms to 
minimize the spurious oscillations. The computational code and the correspondent a 
posteriori error estimates are implemented in Java language following the Object Oriented 
Programming (OOP) paradigm in Eclipse platform. The numerical solution of the elliptic 
groundwater flow equation and the respective error estimates with gradient recovery 
characteristic, the ZZ-estimator, are also implemented in the JAVA code. The solution of the 
transport equation is obtained as a consequence of the OOP reusability intended in the 
implementation of the flow equation. The numerical solution of the ADR 2D simulation 
compared to the analytical solution available in the literature, demonstrate the excellent 
effectivity index presented by the residual error estimator. The obtained results indicate that 
the residual error estimator is lower and upper bounded by a solution in coarse mesh. The ZZ-
estimator showed to be inadequate for the error analysis of the ADR equations. The examples 
selected for validation and application of the residual estimator include, in distinct scales, 
models that describe reaction of first order and models with sorption and retardation 
phenomena in the pollutant migration in saturated porous media. Therefore, the proposed 
residual error estimator proved to be computable, efficient and robust in the sense of solving a 
great variety of applications of transport phenomena in saturated porous media at small 
advection regime.  
 
Keywords: Groundwater, Residual Error Estimator, Parabolic Equation, Advective Transport, 
Porous Media, JAVA Code, Finite Element Method, Temporal Error Indicator.  
 
 

 

 

 

 

 

 

 



 

  



LISTA DE FIGURAS 

 
FIGURA 3.1 – Determinação da velocidade real utilizando analogia de laboratório.................13 
 
FIGURA 3.2 – Distinção entre os mecanismos de transporte em função do no. de Peclet 
                      e a distinção entre os regimes de transporte em função da constante Cc............22 
 
FIGURA 4.1 – Geometria da discretização do domínio global ? utilizando elementos  
                      finitos quadriláteros.............................................................................................28 
 
FIGURA 4.2 – (a) Elemento físico nas coordenadas cartesianas (x,y) 
                      (b) Elemento de referência quadrilátero em coordenadas locais 
                      (c) Elemento de referência triangular degenerado..............................................30 
 
FIGURA 4.3 – Relação entre consistência, estabilidade e convergência Adaptado de 
                       [OTTO, 2007 pg. 69]...........................................................................................37 
 
FIGURA 4.4 – (a) valores de ( )e??  calculados para cada elemento do patch 
                      (b) gradiente suavizado pela média ? ...............................................................37 
 
FIGURA 4.5 – Valor da projeção independente da orientação do vetor normal.........................49 
 
FIGURA 4.6 – Discretização do domínio global visando a minimização da banda das  
                      matrizes globais...................................................................................................54 
 
FIGURA 4.7 – Atributos e métodos compartilhados entre o modelo computacional e a  
                      classe FE2DModel do pacote Fe2d...............................................................55 
 
FIGURA 4.8 – Linhas de comando da implementação JAVA da solução analítica 
                      de Theis contidas em package org.arena.water.gwfem2d.flow2d.tests;........58 
 
FIGURA 4.9 – Interface entre a classe pública FE2DModelTransientZZ e as demais  
                      definições para o cálculo da solução numérica estabelecida no inicio do  
                      código pelo método run()....................................................................................58 
 
FIGURA 4.10 – Rotina JAVA para determinar, em cada elemento da malha, o gradiente  
                        hidráulico descrito na equação (4.16)...............................................................59 
 
FIGURA 4.11 – Rotina JAVA para calcular o erro numérico ZZ da equação do fluxo em  
                        cada elemento da malha....................................................................................59 
 
FIGURA 4.12 – Implementação da função erro complementar e o correspondente gráfico  
                        gerado pelo MAPLE 12......................................................................................63 
 
FIGURA 4.13 – Implementação JAVA de uma solução analítica 2D para o transporte de  
                        contaminantes em água subterrânea..................................................................63 
 
FIGURA 4.14 – Distribuição da concentração de contaminantes obtidas pela solução  
                        analítica e pela solução numérica......................................................................65 



FIGURA 4.15 – Interface entre a classe pública FE2DModelTransientRESIDUAL e as 
                       demais definições para o cálculo da solução numérica estabelecida no inicio do 
                       código pelo método run(). Os dois métodos são mantidos para futuros testes  
                       de eficiência do estimador de erro residual da equação do transporte...............65 
 
FIGURA 4.16 – Classe que retorna o menor autovalor da matriz de dispersão..........................66 
 
FIGURA 4.17 – Obtenção da contribuição espacial para o erro residual da equação  
                        parabólica do transporte de contaminantes.......................................................67 
 
FIGURA 4.18 – Exemplo de malha inicial para a equação do fluxo subterrâneo com  
                        stepRef = 3........................................................................................................68 
 
FIGURA 4.19 – Exemplo de malha inicial para a equação do transporte com stepRef = 2 e  
                        delay = 30%......................................................................................................69 
 
FIGURA 4.20 – Performance do computador através dos anos Adaptado de [OTTO,  
                       2007 pg. 19].......................................................................................................70 
 
FIGURA 5.1 – Geometria do problema teste para o esquema S3 adaptado de [WENDLAND,  
                      2004]...................................................................................................................73 
 
FIGURA 5.2 – Comparação entre os esquemas de solução numérica da equação do transporte  
                      de contaminantes em regime de advecção dominante. Os gráficos (a), (b) e (c)  
                      foram adaptados de [WENDLAND e SCHMID, 2000] e o gráfico (d) foi obtido  
                      com a importação dos dados para o software Maple 12.....................................74 
 
FIGURA 5.3 – Malha inicial do domínio ? = 1000?X800? indicando os 150m da frente de  
                      contaminação, os nós 337 e 532, onde serão obtidas as curvas BTC, o  
                      elemento 416 e o patch 661 para análise de erro................................................76 
 
FIGURA 5.4 – Comparação entre as curvas de passagem de soluto da solução Java e a 
                      correspondente solução analítica 2D de WEXLER (1992) para o transporte  
                      do 90Sr em malha grosseira DH significa difusão horizontal e DT significa  
                      difusão transversal...............................................................................................77 
 
FIGURA 5.5 – Eficiência do estimador de erro residual em função do passo de tempo. 
                      O estimador residual é assintoticamente estável e a sua taxa de convergência é 
                      da ordem de uma função potência com confiança de 98,04%. A eficiência do 
                      estimador ZZ é quase nula para todos os passo de tempo..................................79 
 
FIGURA 5.6 – Evolução do erro residual estimado no patch do nó adjacente 337 e no patch  
                      do nó central 532 da malha grosseira..................................................................80 
 
FIGURA 5.7 – Evolução do indicador temporal e a correspondente taxa de convergência  
                      exponencial.........................................................................................................81 
 
FIGURA 5.8 – Comparação entre a solução analítica (a) e a solução numérica (b) do  
                      transporte do 90Sr em aquífero confinado no instante t = 800d..........................82 



FIGURA 5.9 – Ocorrência de erro máximo atual no nó 661 e captura desse erro, 
                      devido à simetria da solução, pelo estimador residual no elemento 416............82 
 
FIGURA 5.10 – Condição de ortogonalidade de Galerkin observada nos resíduos da solução 
                       numérica FEM.....................................................................................................83 
 
FIGURA 5.11 – Comparação entre a solução numérica ajustada e  a solução analítica de  
                        WEXLER  (1992) no nó 337 e no nó 532...........................................................83 
 
FIGURA 5.12 – Obtenção dos limites inferiores 1,7
?
 e superiores 4,0
?
 do  
                        estimador de erro residual em malha grosseira.................................................85 
 
FIGURA 5.13 – Comparação entre as curvas de passagem de soluto da solução JAVA e a  
                       correspondente solução analítica 2D de WEXLER (1992) para o transporte 
                       do 90Sr em malha com atraso de 30% DH significa difusão horizontal e DT 
                       significa difusão transversal...............................................................................86 
 
FIGURA 5.14 – Eficiência do estimador de erro residual em função do passo de tempo. 
                        O estimador residual é assintoticamente estável e a sua taxa de convergência 
                        é da ordem de uma função potência com confiança de 93,4%. A eficiência  
                        do estimador ZZ é quase nula para todos os passo de tempo...........................87 
 
FIGURA 5.15 – Análise do erro residual no patch do nó 536 e no patch do nó 344 da  
                        malha deformada...............................................................................................88 
 
FIGURA 5.16 – Evolução do indicador de erro temporal e a sua taxa de convergência 
                        exponencial com 95,08% de confiança na malha com deformada...................89 
 
FIGURA 5.17 – Comparação entre a solução analítica (a) e a solução numérica (b) do  
                        transporte do 90Sr em aquífero confinado no instante t = 700d em malha 
                        deformada..........................................................................................................89 
 
FIGURA 5.18 – Obtenção dos limites inferiores 1,0
?
 e superiores 2,0
?
 do 
                        estimador de erro residual em malha deformada..............................................91 
 
FIGURA 5.19 – Mapa de elementos marcados pelo estimador residual para o refinamento  
                        na malha original para t = 130d........................................................................93 
 
FIGURA 5.20 – Mapa dos elementos marcados pelo estimador residual para o refinamento  
                        na malha deformada, para t = 130d...................................................................93 
 
FIGURA 5.21 – Análise do erro residual no patch de elementos da malha com atraso de 30% 
                       e refinamento adaptativo com ? = 0,5...............................................................95 
 
FIGURA 5.22 – Comparação da solução numérica sem refinamento adaptativo (a) com a 
                        solução numérica com refinamento adaptativo (b) do transporte do 90Sr  
                        após 2000 dias de simulação.............................................................................95 
 
FIGURA 5.23 – Comparação do erro residual do patch 532 na malha original na malha 
                        deformada sem refinamento e com refinamento...............................................97 



FIGURA 5.24 – Comparação do erro residual global na malha original e na malha 
                        deformada sem refinamento e com refinamento...............................................97 
 
FIGURA 5.25 – Obtenção dos inferiores 0,55
?
 e superiores 0,90
?
do estimador  
                       de erro residual em malha deformada combinada com estratégia 
                       de refinamento....................................................................................................98 
 
FIGURA 5.26 – Frente de contaminante obtida com os parâmetros físicos adaptados  
                       de SOREK (1988), no instante t = 5.000s em regime de pequena advecção.....101 
 
FIGURA 5.27 – Relação linear entre o erro residual e o número de Peclet da malha inicial 
                        para a equação de advecção-dispersão............................................................102 
 
FIGURA 5.28 – Solução numérica JAVA da equação de advecção-dispersão em malhas com  
                       diferentes valores de Peclet indicando regime de advecção dominante no  
                       passo de tempo igual a 50.000s........................................................................103 
 
FIGURA 5.29 – Solução numérica da equação de advecção-dispersão-reação (ADR) com 
                        parâmetros físicos adaptados de PARKHURST (2004) no instante t = 400d.....105 
 
FIGURA 5.30 – Distribuição dos erros reais na aplicação do esquema de Crank-Nicolson.....106 
 
FIGURA 5.31 – Distribuição dos erros reais na aplicação do esquema de Galerkin................107 
 
FIGURA 5.32 – Distribuição dos erros reais na aplicação do esquema de Euler Implícito......107 
 
FIGURA 5.33 – Solução numérica da equação de advecção-dispersão-sorção com parâmetros  
                        físicos adaptados de KUMAR e DODAGOUDAR (2008) no instante t = 60d......108 
 
FIGURA 5.34 – Transporte de atrazina em coluna saturada de solo arenoso com parâmetros 
                        físicos adaptados de HUANG et al. (2008) e t = 20 min...................................110 
 
FIGURA 5.35 – Relação entre o erro residual global da solução numérica e o correspondente 
                       acréscimo de massa no sistema computacional. Os parâmetros físicos da  
                       simulação foram adaptados do transporte de atrazina em solo saturado de  
                       adaptados de HUANG et al. (2008)...................................................................111 
 
FIGURA A.1 – Relação entre o logaritmo natural na concentração de soluto (A.6) 
                       e o tempo..........................................................................................................126 
 
 
 
 
 
 
 
 
 
 



LISTA DE TABELAS 

TABELA 4.1 – Pontos de Gauss e os respectivos pesos sobre um triângulo Adaptado de 
                     [RATHOD et al., 2004]..........................................................................................56 
 
TABELA 4.2 – Parâmetros básicos da implementação do modelo de fluxo de água 
                      subterrânea..........................................................................................................57 
 
TABELA 4.3 – Parâmetros básicos da implementação do modelo de transporte de 
                      contaminantes......................................................................................................61 
 
TABELA 5.1 – Variáveis do transporte de 90Sr em aqüífero confinado, adaptadas de 
                     [WEXLER, 1992]...................................................................................................76 
 
TABELA 5.2 – Eficiência do estimador de erro residual na malha original e na malha 
                      deformada............................................................................................................86 
 
TABELA 5.3 – Convergência do estimador de erro temporal na malha original e na 
                       malha deformada................................................................................................89 
 
TABELA 5.4 – Comparação dos elementos indicados para refinamento pelo estimador 
                       residual na malha original e na malha deformada, para t = 130d......................92 
 
TABELA 5.5 – Análise do erro residual do estimador a posteriori em três tipos de malha  
                       que descreve o domínio do transporte de contaminante em regime de  
                       pequena advecção..............................................................................................96 
 
TABELA 5.6 – Desempenho do estimador de erro residual aplicado em malhas iniciais 
                      com quantidades distintas de elementos em regime de pequena advecção......101 
 
TABELA 5.7 – Desempenho do estimador de erro residual aplicado em malhas iniciais 
                      com distintos valores do parâmetro ? de discretização temporal e Cc = 6,32...106 
 
TABELA 5.8 – Proporcionalidade existente entre a concentração inicial na fronteira de 
                       Dirichlet e o erro residual espacial obtido pelo estimador...............................109 
 
TABELA 5.9 – Análise do erro da solução numérica do transporte de atrazina em coluna 
                      de solo arenoso saturado com parâmetros físicos adaptados de [HUANG et al., 
                      2008] e a respectiva quantidade de massa no sistema......................................112 
 
 
 
 
 
 
 
 
 



DEFINIÇÃO DOS SÍMBOLOS 
 
CARACTERES LATINOS 
 

Símbolo Dimensão Definição 

b [L] Espessura do aqüífero confinado. 

BTC[ ] --- Curvas de passagem de soluto. 

?c  --- Constante da desigualdade de Poincaré. 

T
c  --- Parâmetro de forma da partição de T. 

C [ ]2LM  Concentração do contaminante na posição (x,y) e instante t. 
C0 [ ]2LM  Concentração inicial do contaminante. 
Cc --- Constante característica do regime de transporte. 

CD [ ]2LM  Concentração do contaminante na fronteira ?D. 
?? [ ]2LM  Concentração obtida por solução numérica. 
Cx --- Número de Courant. 

D [ ]TL2  Tensor de dispersão hidrodinâmica. 
Dx [ ]TL2  Dispersão na direção longitudinal. 
Dy [ ]TL2  Dispersão na direção transversal. 

delay --- Porcentagem de atraso na malha regular. 

e [ ]2LM  Erro de aproximação da solução analítica. 
?? --- Índice de eficiência do estimador de erro. 

??
?

 --- Índice de eficiência restrito ao elemento K. 

erfc(x) --- Função erro complementar. 

f [ ]3LM  Termo de fonte ou sorvedouro. 
I

f  [ ]3LM  ?-interpolação da função f. 
g [ ]TL  Função escalar não negativa, 
I

g  [ ]TL  ?-interpolação da função g. 
? --- Aproximação do gradiente numérico. 

h [L] Carga hidráulica total. 

h?  [L] Solução aproximada da equação do fluxo. 

( )eh?  [L] Solução aproximada no elemento e. 

hS [L] Diâmetro de TET ??S .  

Dh  [L] Valor da carga hidráulica na fronteira D? . 



1
DH  --- Espaço de Sobolev de funções C tais que C = CD em D? .  
I --- Partição do intervalo de tempo [0,T]. 

2I  --- Matriz identidade de ordem 2. 

EJ  [L] Operador salto através do lado TE?E .  

( ) 1?TJ  --- Inversa da matriz jacobiana transposta. 
k 

[ ]
T
L  Condutividade hidráulica.  

K --- Elemento finito. 

Kd [ ]ML3  Coeficiente de partição entre soluto dissolvido e adsorvido à fase sólida.  
Kxx, Kyy e Kzz [ ]TL  Componentes principais do tensor da condutividade hidráulica. 

[K], [ ]TL  Tensor de condutividades hidráulica.  
L [L] Comprimento característico. 

n --- Vetor normal exterior a ?. 

nE --- Vetor normal exterior ao lado E. 

Na --- Funções interpolantes Lagrangeanas. 

Pe --- Número de Peclet. 

q ??

?
??

?
2

3

L
T

L

 Taxa de fluxo volumétrico por unidade de área. 

Q( ) --- Quantidade de interesse. 

Qi [ ]TL3  Taxa de bombeamento ou de injeção do poço i. 
R --- Fator de retardo do contaminante. 

R2 --- Coeficiente de determinação. 

RK --- Indicador de erro residual local. 

S --- Coeficiente de armazenamento 

Ss [ ]L1  Coeficiente de armazenamento específico. 
s(r,t) [L] Rebaixamento da superfície potenciométrica. 

stepRef --- Parâmetro de bipartição da malha retangular. 
90Sr --- Elemento químico estrôncio 90. 

T  --- Partição espacial do domínio ?. 

2
1T  [T] Tempo de meia vida do contaminante. 

Tf
 [T] Instante final da simulação computacional. 

Txx e Tyy [ ]TL2  Transmissividades nas direções x e y. 
   



u --- Solução analítica. 

uh --- Solução numérica. 
h
eu  --- Solução aproximada pelo método de elementos finitos. 

v [ ]TL  Campo de velocidades de classe C
1(?). 

??, ??  [ ]TL  Componentes da velocidade do fluxo subterrâneo. 
VD [ ]TL  Velocidade aparente no meio poroso. 
VR [ ]TL  Velocidade intersticial (ou real). 
W [ ]TL  Termos de fonte ou sorvedouro de água dentro do aqüífero, 
wi --- Pesos aplicados nos pontos de Gauss. 

kN ,?  --- Pesos aplicados nas raízes do polinômio de Legendre. 
w  --- Norma de energia do problema variacional. 

Xmin e Ymin [L] Valores mínimos em cada direção da malha retangular. 

Xmax e Ymax [L] Valores máximos em cada direção da malha retangular. 

Z --- Variável de integração na solução de WEXLER (1992). 

ZZ --- Estimador de erro do método de recuperação. 

 
CARACTERES GREGOS 
 

Símbolo Dimensão Definição 

?? [L] Dispersividade Longitudinal. 

S?  --- Constante de ponderação do estimador residual. 
??? [L] Dispersividade horizontal transversal 

??? [L] Dispersividade vertical transversal 

?D --- Fronteira de Dirichlet. 

?N --- Fronteira de Neumann. 

?  [ ]L1  Função delta de Dirac. 
? --- Menor autovalor da matriz de dispersão D. 

?  --- Erro exato no elemento K. 

T
E  --- Conjunto de lados dos elementos de T .  

•,nT
E  --- Conjunto de lados contidos em •. 

! --- Erro global da malha. 

ef?  --- Porosidade efetiva. 
   



!  --- Erro no nível do elemento K. 

!"#$ --- Limite inferior do erro. 

!%&amp;amp;' --- Limite superior do erro. 
n

nT
?  --- Indicador de erro espacial. 

n
t?  --- Indicador de erro temporal. 

I
?  --- Estimador residual computável. 

I
??  --- Estimador residual preliminar. 

ZZ?  --- Estimador de erro global obtido pela técnica SPR. 

? [ ]1,21?  --- Parâmetro de aproximação temporal. 
? [ ]T1  Constante de decaimento de 1ª ordem. 

( )?? ,  --- Sistema de coordenadas locais. 
?0 --- Projeção L

2 sobre espaço de elementos finitos na malha inicial. 

?b [ ]3LM  Densidade volumétrica do meio poroso. 
?  e h?  --- Gradiente da solução exata e gradiente da solução aproximada. 

( )e??  --- Gradiente numérico restrito ao elemento e. 

( --- Tolerância do erro numérico. 

n?  [T] Amplitude do n-ésimo intervalo de tempo. 
a
e?  --- Funções de aproximação sobre o elemento e. 

*
?  --- Norma dual do problema variacional. 

i?  --- Função de ponderação do resíduo. 

? --- Domínio computacional. 
h
e?  --- Subdomínio de ? restrito ao elemento e. 

?? --- Fronteira do domínio ?. 
 
 
 
 
 
 
 
 
 
 
 
 
 



 
 
  



SUMÁRIO 

1 INTRODUÇÃO ...................................................................................................................... 1 

1.1 Erros de Aproximação e Quantidade de Interesse ....................................................... 2 

1.2 Características Globais e Locais do Estimador de Erro ............................................... 3 

1.3 Classificação dos Estimadores de Erro ........................................................................ 4 

1.4 Outros Erros Numéricos .............................................................................................. 5 

1.5 Considerações do Capítulo 1 ....................................................................................... 7 

2 OBJETIVOS ......................................................................................................................... 9 

2.1 Objetivo Principal ........................................................................................................ 9 

2.1.1 Objetivos Intermediários ...................................................................................... 9 

 

3     O ESTADO DA ARTE............................................................................................................11 

3.1 Equações Governantes do Fluxo Subterrâneo ........................................................... 11 

3.1.1 Campo de Velocidades do Fluxo Subterrâneo ................................................... 13 

3.1.2 Solução Analítica de Theis ................................................................................. 15 

3.2 As Equações Governantes do Transporte de Contaminantes .................................... 16 

3.2.1 Condições Iniciais e Condições de Fronteira ..................................................... 18 

3.3 Aproximação da Equação do Transporte ................................................................... 19 

3.4 O Transporte em Regime de Pequena Advecção ....................................................... 22 

3.5 Erro a posteriori da Equação Parabólica ................................................................... 25 

3.6 Considerações do Capítulo 3 ..................................................................................... 28 

 

4     O MÉTODO DE ELEMENTOS FINITOS E A PROGRAMAÇÃO JAVA......................................31 

4.1 Conceitos Básicos do Método de Elementos Finitos ................................................. 31 

4.1.1 Consistência, Estabilidade e Convergência do Método...................................... 35 

4.2 Aproximação da Equação do Fluxo e o Estimador de Erro ....................................... 37 

4.2.1 Gradiente Numérico da Equação do Fluxo ........................................................ 40 



4.2.2 Estimador de Erro baseado na Recuperação do Gradiente ................................. 41 

4.3 Formulação Variacional da Equação do Transporte de Contaminantes .................... 44 

4.4 Elementos Finitos Espaço-Temporal para a Equação Parabólica .............................. 46 

4.5 Um Estimador de Erro Residual para Equação do Transporte .................................. 48 

4.5.1 Estimando o erro no Regime de Pequena Advecção .......................................... 50 

4.6 Implementação em Linguagem Java .......................................................................... 52 

4.6.1 Implementação da Equação do Fluxo de Água Subterrânea .............................. 56 

4.6.2 Implementação do Estimador para a Equação do Fluxo .................................... 58 

4.6.3 Implementação da Equação do Transporte de Contaminantes ........................... 60 

4.6.4 Implementação de uma solução analítica para o problema do transporte .......... 61 

4.6.5 Resultado Numérico versus Solução Analítica .................................................. 64 

4.6.6 Implementação do Estimador de Erro Residual ................................................. 65 

4.7 Geração de Malhas ..................................................................................................... 67 

4.8 Considerações do capítulo 4 ...................................................................................... 70 

 

5 RESULTADOS E DISCUSSÃO .............................................................................................. 73 

5.1 Verificação do Estimador Residual ........................................................................... 75 

5.1.1 Solução Numérica Ajustada no patch ................................................................ 83 

5.1.2 Limites Inferiores e Superiores do Estimador Residual ..................................... 84 

5.2 A influência da malha no erro residual da solução numérica .................................... 85 

5.3 Uma estratégia de refinamento adaptativo ................................................................. 91 

5.3.1 Comparação do erro residual para diferentes estratégias ................................... 96 

5.4 Aplicação do Estimador de Erro Residual em Regime de Pequena Advecção ......... 99 

5.4.1 Solução Numérica da Equação de Advecção-Dispersão .................................... 99 

5.4.2 Solução Numérica da Equação de Advecção-Dispersão-Reação ..................... 104 

5.4.3 Solução Numérica da Equação de Advecção-Dispersão-Sorção ..................... 108 

5.4.4 Transporte 1D de Atrazina em coluna de solo Saturado .................................. 110 



 

6 CONCLUSÃO ................................................................................................................... 115 

6.1 Sugestões para Trabalhos Futuros ........................................................................... 118 

 

ANEXO I - O Transporte de Contaminantes  em Água Subterrânea ............................... 121 

Os Principais Mecanismos de Transporte .......................................................................... 122 

O Transporte Advectivo ................................................................................................. 122 

O Transporte Difusivo .................................................................................................... 123 

O Transporte por Dispersão Mecânica ........................................................................... 124 

O Transporte por Dispersão Hidrodinâmica ................................................................... 125 

Reações Químicas de Primeira Ordem ........................................................................... 126 

Outros Processos Bio-Físico-Químicos do Transporte de Contaminantes ..................... 127 

 

ANEXO II - Symmetrical Streamline Stabilization-S3…………...........................................129 

 

ANEXO III - Solução da Equação de Fluxo Subterrâneo a partir  

                     de Estimador de Erro a posteriori...................................................................135 

 

7 REFERÊNCIAS BIBLIOGRÁFICAS .................................................................................... 145 

 

 

 

 

 

 

 

 



 

 

 

 

 

 

 

 

 

 



1 INTRODUÇÃO 

Resultados computacionais, mesmo quando obtidos de um apropriado modelo 

matemático que caracteriza um fenômeno físico de interesse, não estão inumes aos erros 

numéricos inseridos pelos processos de discretização. Equações diferenciais parciais ou 

equações integrais quando são manipuladas por dispositivos digitais perdem informações, 

uma vez que as aproximações numéricas diferem do modelo contínuo. Estes erros de 

aproximação, quando ultrapassam certa magnitude, invalidam a predição numérica do modelo 

matemático. 

Embora ocorram com freqüência, os erros de aproximação são difíceis de identificar e 

de avaliar com medidas intuitivas ou heurísticas. Nos últimos 20 anos, teorias matemáticas e 

procedimentos computacionais foram desenvolvidos para estimar o erro de aproximação em 

soluções numéricas dos problemas de valores iniciais e de fronteiras em diversas áreas da 

Engenharia. Neste cenário surgem técnicas e demonstrações matemáticas para fundamentar os 

chamados estimadores de erro a posteriori. 

As análises destes estimadores, baseadas em informações obtidas no pós-processamento 

das soluções numéricas, fornecem limites superiores e inferiores do erro de aproximação em 

uma norma apropriada. Assim, se o erro estimado pode ser controlado, é possível melhorar a 

qualidade da solução numérica ou pela modificação da malha que representa o domínio, ou 

pelo aumento da ordem da função de aproximação, ou otimização do passo de tempo ou por 

outro processo do algoritmo numérico capaz de reduzir o erro. Desta maneira, os estimadores 

de erro a posteriori são essenciais para conduzir os métodos computacionais adaptativos.  

Na presente tese, é apresentado um estimador de erro a posteriori, com características 

adequadas para análise específica da solução numérica da equação de advecção-dispersão-

reação (ADR) em regime de pequena advecção para o transporte de contaminantes. 

Uma vez que modelos computacionais que implementam o transporte de soluto em 

meio poroso saturado surgem constantemente na comunidade científica, devido à suma 

importância dada à compreensão e previsão do transporte de constituintes dissolvidos em 

água subterrânea, é fundamental assegurar a qualidade da solução numérica das equações 

ADR. 



2                                         Introdução 

 A finalidade das seções seguintes é caracterizar o erro numérico abordado neste 

trabalho, suas estimativas globais e locais, e apresentar os dois principais métodos da 

literatura que são base para implementação de um código computacional do estimador de erro 

a posteriori. 

1.1 ERROS DE APROXIMAÇÃO E QUANTIDADE DE INTERESSE 

Em uma situação computacional geral, o erro de aproximação é uma função da posição 

? e do tempo ?, e é definido por: 
? = ? ? ?? 

sendo ? a solução exata do modelo matemático do fenômeno de interesse e ?? a aproximação 
numérica de ? obtida por algum método numérico. 

Diversas aplicações da Engenharia, além de requerer uma magnitude desejável da 

parcela 	?	, representando a norma do erro da aproximação numérica, avaliam também o erro 
em uma quantidade de interesse 
 que depende da solução ?, isto é, avaliam a diferença: 

? = 
??
 ? 
??? 
. 
Essa estratégia, conhecida por estimativa goal-oriented, são direcionadas para o 

aprimoramento da aproximação das quantidades de interesse e têm recebido grande 

importância nestas últimas décadas [DEVLOO et al., 2009]. O seu objetivo principal é obter 

limites inferiores ????? ? e limites superiores ??????, tais que: 
???? ? 
??
 ? 
??? 
 ? ???? . 

Se 
??
 é um funcional linear, então 

??
 ? 
??? 
 = 
??
   ou   
??
 = 
??? 
 + 
??
. 

Uma vez que a solução ? é, em geral, desconhecida ou dispendiosa para ser computada, 
uma boa aproximação para 
??
 é responsável pela boa aproximação para 
??
. E ainda, os 
limites ????  e ???? são obtidos através da solução numérica ??. 



Departamento de Hidráulica e Saneamento – PPG SHS EESC USP                                     3 

Outra característica do estimador é o processo de verificação dos resultados produzidos 

por modelos matemáticos, assegurado por uma tolerância ? &gt; 0 do erro numérico, fornecida 
pelo analista. Ou seja, um modelo será considerado adequadamente resolvido quando  

|
??
 ? 
??? 
| ? ?. 
Desta forma, se o erro ? é estimado por limites computáveis ????  e ????, gerados pelo 

pós-processamento de ??, a aproximação da quantidade de interesse é dada por 
  
??
 ? 
??? 
 + ?, 

sendo ? = ? ???? + ? ???? ? ?. 

1.2 CARACTERÍSTICAS GLOBAIS E LOCAIS DO ESTIMADOR DE ERRO 

Segundo ODEN (2002), maior requisito de um estimador ? para aproximar ou limitar o 
erro real 	?	, é a existência de constantes positivas !? e !  tais que !?	?	 ? ? ? ! 	?	. Se o 
erro 	?	 é pequeno, então o estimador ? é um valor pequeno, pois !  é considerado um valor 
não muito grande e, inversamente, se a estimativa ? é um valor pequeno, então o erro real 	?	 
também será pequeno, pois !? é considerado como sendo um valor não muito pequeno. 

Define-se ainda uma quantidade "? = #	$	 como sendo o índice de eficiência para medir 
a qualidade do estimador ? [BABUSKA et al, 1994]. Quando "? ? 1, o estimador ? encontra-se 
próximo do erro real 	?	. Mesmo sendo rara a determinação da norma 	?	 para a maioria dos 
modelos matemáticos, existem problemas padrão1 onde o erro ? ou a solução ? são 
conhecidos ou são computados sob uma desejável precisão. Assim, a confiabilidade e a 

robustez de diversos estimadores podem ser numericamente asseguradas.  

As desigualdades !?	?	 ? ? ? ! 	?	 representam uma estimativa do erro no sentido 
global e indicam o intervalo que contém o erro total sobre um domínio computacional. Em 

geral, para uma malha contendo &amp;amp; elementos, indicadores de erro ?'  no nível de cada 
elemento (, são computados usando as restrições da solução aproximada ?? para cada 
elemento. 

                                                 

1 Do inglês benchmark problems – Modelos matemáticos para verificação ou calibração de esquemas numéricos. 



4                                         Introdução 

Assim, o estimador é dado por: 

? = ) * ?' 
+

',?
-

? 
 

Em cada elemento K, o respectivo índice de eficiência será dado por "? ' = #.	$	., sendo 	?	' a norma do erro restrito ao elemento ( e ?'  a contribuição do elemento ( para o erro 
global estimado ? [BABUSKA et al, 1994]. 

É importante ressaltar que os indicadores ?'  não representam o erro local no elemento 
(, pois o erro 	?	' é “poluído” por erros de outros elementos adjacentes a (. Neste sentido, 
o refinamento local da malha é útil na redução e controle, a um determinado limite, das fontes 

de poluições de erros do elemento. Ou seja, as quantidades ?'  são eficientemente usadas 
como base dos processos adaptativos de malha para controlar e reduzir o erro global 	?	. 

1.3 CLASSIFICAÇÃO DOS ESTIMADORES DE ERRO 

Os vários métodos para computar o indicador2 ?'  são basicamente divididos em duas 
classes [ALMEIDA et al., 2000]:  

(1) Métodos Residuais e  

(2) Métodos de Recuperação. 

Considere um determinado problema físico modelado por /? =  0, acrescido das 
condições iniciais e de contorno, sendo / um operador linear e 0 os valores de entrada. Na 
relação ? = ?? + ? seguida da definição do resíduo 1 = 0 ? /?? é visto que o erro ? satisfaz 
/? =  1. O resíduo 1 é uma medida que descreve o quanto a solução aproximada ?? resolve 
o problema original. O estimador de erro baseado neste método residual determina uma 

solução aproximada para /? = 1 [VERFÜRTH, 2008]. 
Os estimadores residuais são classificados ainda como estimadores explícitos ou 

implícitos. 

                                                 

2 Estimadores de erro, em geral, referem-se a quantidades usadas nos critérios de parada de uma estratégia 
adaptativa, e o indicador de erro é a contribuição do elemento na estimativa sobre uma quantidade de interesse. 



Departamento de Hidráulica e Saneamento – PPG SHS EESC USP                                     5 

Os estimadores explícitos envolvem uma computação direta do resíduo no interior e 

fronteira do elemento para encontra uma estimativa para o erro real 	?	 [BABUS?KA E 
RHEINBOLT, 1978].  Esse método explícito produz estimadores ?'  através de cálculos de 
funções ou substituições, sem envolver solução de um sistema linear de equações. 

O método implícito envolve a solução local de um problema de valor de contorno e 

necessita de maior esforço computacional, no entanto, ainda disponibilizam estimativas 

precisas para o erro real 	?	 [AINSWORTH e ODEN, 2000]. 
Para estimar o erro da solução numérica do transporte de contaminantes em regime de 

pequena advecção, utiliza-se o método explícito. Caso contrário, se o regime é de o grande 

advecção, faz-se necessário o uso do método implícito para a estimativa a posteriori da 

solução numérica do transporte de contaminantes, conforme descrito na subseção 4.5.1, na 

página 47 deste trabalho. 

Uma terceira classe de estimadores de erro é dada pelo método de recuperação do 

gradiente [ZIENKIEWICZ, 2004]. Nesta categoria, a solução aproximada ?? é pós-processada 
para obter uma solução melhorada ???  a qual é, presumidamente, mais precisa do que ??. A 
expressão ?? = ??? ? ?? é uma aproximação computável do erro ? ? ??. Em alguns casos, ???  
é obtido por extrapolação e o método de recuperação mais popular é o conhecido Método 

Superconvergente de Recuperação do Patch [ZIENKIEWICZ E ZHU, 1996b]. Nesta técnica, um 

ajuste polinomial de alta ordem é realizado sobre os valores nodais de ?? (ou de ???) sobre 
um conjunto de elementos adjacentes que compartilham um nó da malha (o chamado patch). 

Na seqüência, é empregada uma regressão, através do método dos mínimos quadrados, para 

determinar uma aproximação melhorada 4 da quantidade ??. Assim, a norma 5  da diferença 
4 ? ??? sobre o elemento ( é usada como indicador de erro local ?' , isto é,  

?' ? ?' = 67 |4??? 
 ? ??? | 8?.'  
Este indicador 99 possui atrativas propriedades que são: facilidade de implementação e 

independência dos operadores que caracterizam o problema que está sendo resolvido, 

podendo ser aplicado tanto para problemas lineares quanto não lineares. No entanto, 

AINSWORTH e ODEN (2000, pg. 82) apontaram deficiências neste indicador, quando o erro 

numérico arbitrariamente grande de um problema específico foi estimado, pela técnica 99, 
como sendo nulo. 



6                                         Introdução 

Segundo GRÄTSCH e BATHE (2005), outra característica importante de se observar na 

implementação do estimador de erro, para os problemas práticos da Engenharia, é que o seu 

custo computacional seja inferior ao custo de se obter a mesma aproximação numérica em 

uma segunda malha mais fina. 

Maiores detalhes para outros procedimentos de obtenção das estimativas do erro 

numérico das técnicas de aproximações aplicadas aos diversos problemas práticos podem ser 

encontrados em [VERFÜRTH, 1996], [ESTEP et al., 2000], [AINSWORTH E ODEN, 2000], 

[BABUS?KA E STROUBOULIS, 2001] ou [PRUDHOMME E ODEN, 2002]. 

1.4 OUTROS ERROS NUMÉRICOS 

Os esforços concentrados neste trabalho são para estimar os erros de aproximação 

provenientes do processo de discretização, através do método de elementos finitos, da 

dimensão espacial da malha e da respectiva dimensão temporal. 

Porém, outros erros numéricos são previstos em todo o procedimento computacional 

necessário para a resolução do modelo matemático. O surgimento destes erros pode ser 

resultado de diversas fontes, tais como: erros de modelagem, erros geométricos, erros de 

truncamento, erros de algoritmos, etc., conforme descritos em [BRENNER E SCOTT, 2002]. 

Os erros de modelagem podem ser introduzidos quando uma abstração matemática 

representa uma determinada característica do evento físico. Às vezes, é necessário estabelecer 

algumas simplificações para amenizar a complexidade dos modelos matemáticos mais 

sofisticados. E esta tentativa de tornar o modelo mais praticável, seguramente, resulta em 

erros de modelagem. 

Erros geométricos ocorrem quando a fronteira curva é aproximada por funções 

polinomiais por partes. Estas representações de funções contínuas por aproximações discretas 

são, para o analista, uma forma aceitável para a correspondente implementação digital, porém, 

“dobras” na fronteira de domínios côncavos perturbam o comportamento da solução em sua 

vizinhança. 

Os erros de truncamento ocorrem em aproximações obtidas pelas regras de integração 

(p. ex. os métodos de Gauss e os de Legendre) e os erros de algoritmo surgem dos esquemas 

numéricos diretos ou iterativos de resolução dos imensos sistemas de equações (p. ex. a 



Departamento de Hidráulica e Saneamento – PPG SHS EESC USP                                     7 

decomposição de Cholesky para equações lineares ou o método de Newton para equações não 

lineares.). 

Estes tipos de erros são considerados desprezíveis quando comparados aos erros de 

aproximação e podem ser controlados na verificação do modelo. 

De acordo com J. TINSLEY ODEN (2002), a verificação é o processo que assegura se um 

modelo físico ou se uma aplicação particular de um sistema da Engenharia é resolvida 

corretamente quando estes eventos estão representados por modelos matemáticos. Isto 

significa que, fundamentalmente, assegurar a acurácia da aproximação numérica é atingir a 

essência do processo de verificação. 

No seguinte trecho, ODEN (2002) relaciona conceitos do Processo de Verificação do 

modelo aos Estimadores de Erro a posteriori. 

 

...Implícito na idéia de verificação é que os modelos, de alguma maneira, são 
obtidos e cabe a nós determinar em que grau estas simulações resolvem o modelo 
em estudo. Isto é um estimador de erro a posteriori. 

1.5 CONSIDERAÇÕES DO CAPÍTULO 1 

Os estimadores de erro a posteriori desenvolvidos na década de 90 foram direcionados 

para controlar e avaliar o erro global na norma de energia. Recentemente, a teoria foi 

estendida para estimar o erro em uma quantidade de interesse. 

Basicamente, a presente tese contribui com a apresentação de um estimador de erro a 

posteriori que seja apropriado para as equações parabólicas do transporte de contaminantes 

em meio poroso saturado. 

Esse trabalho inicia-se com o desenvolvimento de técnicas computacionais da dinâmica 

dos fluidos para determinar o campo de velocidade através das equações do fluxo subterrâneo 

e que poderiam ser utilizados nas equações do transporte de contaminantes. Um estudo do 

erro de aproximação das respectivas soluções é apresentado, no entanto, como estes modelos 

matemáticos possuem equações de naturezas distintas, as análises do erro numérico seguiram 

por metodologias diferentes. 

A característica elíptica da equação do fluxo induz a utilização do método de 

recuperação do gradiente para estimativa do erro a posteriori da sua solução numérica. 



8                                         Introdução 

Porém, esse método baseado na parte difusiva do operador diferencial não se aplica na 

equação parabólica do transporte com advecção dominante. Logo, o método residual citado na 

seção 1.3 é mais apropriado para estimar o erro da solução numérica do transporte de 

contaminantes em águas subterrâneas. 

Para conduzir essas discussões, suas respectivas implementações, as contribuições 

relevantes e os resultados apresentados neste trabalho, a tese encontra-se organizada da 

seguinte forma: 

O capítulo 2 descreve, de forma sucinta, os objetivos da tese. 

O capítulo 3 apresenta o estado da arte, descrevendo algumas abordagens da equação do 

fluxo subterrâneo, a intrínseca relação com o transporte de contaminantes em meio poroso, os 

esquemas de discretização espacial e temporal discutidos na literatura, e o tratamento dos 

erros numéricos provenientes desses esquemas. 

O capítulo 4 descreve a metodologia empregada na implementação computacional do 

método de elementos finitos para obter a solução numérica da equação do fluxo e do 

transporte de contaminantes. Esse capítulo descreve ainda a adequação para estimar o erro 

numérico em cada tipo de equação, seja de caráter elíptico ou parabólico. O capítulo 4 finaliza 

com uma proposta de malha inicial que influenciará fortemente a análise do erro a posteriori 

da equação do transporte de contaminantes. 

O capítulo 5, o capítulo dos resultados e discussão, apresenta inicialmente, a verificação 

da solução numérica implementada no código JAVA e posteriormente, a verificação do 

estimador de erro a posteriori para a equação do transporte de contaminante. 

Após estes processos de verificação, o estimador de erro é aplicado em situações de 

transporte de contaminantes discutidos na literatura e que abrangem, além dos processos 

clássicos de advecção e dispersão, os processos de reação de primeira ordem e os de sorção 

com fator de retardo R &gt; 1. 

O capítulo 6 conclui o trabalho acerca da computabilidade e eficiência do estimador de 

erro a posteriori, apresentado no corpo da tese e aplicado na estimativa de erros provenientes 

da equação do transporte de contaminantes em meio poroso saturado. Na seção 6.1 são 

descritos os trabalhos futuros alinhados com os estudos desenvolvidos e relevantes para a 

continuidade na geração do conhecimento obtido. 

  



Departamento de Hidráulica e Saneamento – PPG SHS EESC USP                                     9 

2 OBJETIVOS 

Nesta página são descritos o objetivo principal e os objetivos intermediários deste 

trabalho científico orientado pela seguinte hipótese: “O estimador de erro a posteriori para a 

equação do transporte de contaminantes em meio poroso saturado pertence à classe dos 

métodos residuais”. 

2.1 OBJETIVO PRINCIPAL 

“Obter um estimador de erro a posteriori para a equação do transporte de contaminantes 

em meio poroso saturado que seja eficiente, robusto e computável”. 

Para que o Objetivo Principal da tese seja alcançado, são delineados os seguintes 

objetivos intermediários: 

2.1.1 Objetivos Intermediários 

• elaborar um código computacional que resolve a equação do transporte de 
contaminantes usando o Método dos Elementos Finitos; 

 

• verificar que o transporte de contaminantes em água subterrânea é realizado no regime 
de pequena advecção; 

 

• implementar no código computacional um estimador de erro com características 
residuais e um estimador de erro com características de recuperação; 

 

• apresentar uma verificação do estimador residual com a implementação de solução 
analítica da equação do transporte disponível na literatura; 

 

• comparar as técnicas residuais com as técnicas de recuperação empregadas na 
estimativa do erro entre a solução numérica e a solução analítica da equação do 
transporte de contaminantes em águas subterrâneas, e 

 

•  aplicar o estimador residual em diferentes processos do transporte de contaminantes. 
 



10                                         Introdução 

  



3   O ESTADO DA ARTE 

A equação do transporte de contaminante é vinculada ao modelo matemático que 

representa o fluxo de água subterrânea. A representação precisa de qualquer contaminante 

necessita, além de um modelo calibrado, da determinação precisa da velocidade e direção do 

fluxo de água subterrânea. O presente capítulo apresenta as equações governantes necessárias 

para obter os valores da velocidade real do fluxo de água subterrânea, com suas respectivas 

direções, seguidas das equações governantes necessárias para estabelecerem o modelo 

matemático do transporte de contaminantes no meio poroso saturado. 

3.1 EQUAÇÕES GOVERNANTES DO FLUXO SUBTERRÂNEO 

O modelo matemático para a distribuição de cargas que regem o fluxo de água 

subterrânea, obtido pela lei de Darcy e pelo princípio da conservação de massa em um volume 

elementar representativo (REV) de um aquífero é dado por [CLEARY, 2007]: 

( )
t

h
StzyxW

z

h
K

zy

h
K

yx

h
K

x
szzyyxx ?

?
=+?

?

?
?
?

?

?
?

?
?

+?
?

?
?
?

?

?
?

?
?

+?
?

?
?
?

?

?
?

?
?

,,,         (3.1) 

sendo h a carga hidráulica total [L], 

          Kxx, Kyy e Kzz os componentes principais do tensor da condutividade hidráulica [ ]TL , 
          Ss o coeficiente de armazenamento específico [ ]L1 , 
          W os termos de fonte ou sorvedouro de água dentro do aquífero [ ]

L
1 , 

Para o caso tridimensional, W poderia ser representado por: 

( ) ( ) ( )ii
N

i
ii zzyyxxQW ???= ?

=

???
1

     (3.2) 



12                                  O Estado da Arte 

sendo Qi [ ]TL3  a taxa de bombeamento ou de injeção do poço i em (xi,yi,zi) e 
         ?  é a função delta de Dirac com unidades [ ]

L
1 . 

Considerando desprezíveis as variações de carga ao longo da dimensão vertical 

(hipótese de Dupuit), e que a dimensão horizontal dos aquíferos em escalas regionais pode ser 

da ordem de dezenas de quilômetros, o fluxo pode ser modelado por uma equação 

bidimensional em x e y dada por [CLEARY, 2007]:  

( )
t

h
StyxW

y

h
T

yx

h
T

x
yyxx ?

?
=+?

?

?
?
?

?

?
?

?
?

+?
?

?
?
?

?

?
?

?
?

,,     (3.3) 

sendo Txx = b.Kxx, e Tyy = b.Kyy [ ]TL2  as transmissividades nas direções x e y  do aquífero 
confinado, 

            b, a espessura do aquífero [L] e  

            S = Ss.b, o coeficiente de armazenamento [adimensional]. 

W representa os termos de drenança dos fluxos verticais remanescentes em z = 0 

(camada confinante inferior) e em z = b (camada confinante superior) acrescidos da atividade 

de um poço i na posição (xi,yi). 

Para que as informações obtidas da equação do fluxo sejam aplicadas na equação do 

transporte de contaminantes, em aquíferos confinados, algumas hipóteses devem ser 

consideradas:  

• o contaminante em estudo não irá influenciar na velocidade do fluxo da água 

subterrânea, caracterizando o aquífero em estudo como um campo 

conservativo; 

• a temperatura média no meio poroso não sofrerá alterações significantes 

durante o tempo observado; 

• a matriz do solo saturado em estudo é rígida, ou seja, não sofre deformações ou 

relaxamento e 

• os poros estão todos conectados para a ocorrência do transporte de 

contaminante. 

A condição de fluxo horizontal será adotada para simplificar o estudo de fluxo 

subterrâneo, pois, para grandes extensões do aquífero, efeitos das áreas de recarga, de 

descarga e de poços parcialmente penetrantes podem ser desconsiderados [CLEARY, 2007]. 



Departamento de Hidráulica e Saneamento – PPG SHS EESC USP                                      13 

3.1.1 Campo de Velocidades do Fluxo Subterrâneo 

A previsão da distribuição de poluentes importa do modelo de água subterrânea a 

velocidade real determinada pela velocidade aparente, dada pela lei de Darcy, pela 

distribuição da condutividade hidráulica Kxx e Kyy, e pela distribuição da porosidade efetiva
3 

ef? . 

É oportuno, no entanto, citar um trecho do livro Águas Subterrâneas de ROBERT 

CLEARY (2007, pg. 38), no qual distingue o conceito de velocidade intersticial (ou real) VR e 

de velocidade aparente VD: 

[...] Embora a “velocidade” de Darcy VD = Q/A, onde Q é a taxa volumétrica de 
fluxo [L3/T] e A é a área total da secção transversal perpendicular à direção de fluxo 
[L2], possua unidade de velocidade [L/T], não é na verdade uma velocidade. Na 
realidade, é a taxa volumétrica do fluxo por unidade total de área. Como Darcy não 
estava diretamente interessado no fluxo da água subterrânea, ele usou a área total da 
secção transversal da sua coluna de areia. Obviamente, a área ocupada pelos grãos 
de areia não está disponível para o fluxo e sua “velocidade”, baseada na área total, 
deve ser modificada quando se deseja a velocidade verdadeira através do meio 
poroso. A velocidade real, também conhecida como velocidade de poro, é dada pela 
seguinte expressão: VR = VD/nef . 

A relação entre a velocidade real VR e a velocidade aparente VD é obtida se considerar 

um experimento realizado em uma coluna dividida em três partes iguais e de comprimento L, 

conforme ilustrado na figura 3.1. 

 

 

 

 

 

FIG 3.1 – Determinação da velocidade real utilizando analogia de laboratório 

A parte central desta coluna, o cilindro II, quando preenchida por material geológico, 

apresentará uma taxa volumétrica de fluxo Q em estado estacionário, no qual um fluido entra 

e sai da coluna sem que ocorram perdas ou ganhos. 

Nos cilindros I e III, as velocidades V1 e V3 são as velocidades aparentes. A velocidade 

V2 é a velocidade real no meio geológico II. 
                                                 

3 Quantidade de espaços no meio poroso que permitem a transmissão de fluidos. Exprime-se como a relação 
entre o volume total de interstícios conectados e o volume total do meio poroso, incluindo os espaços vazios. 

          L                   L       L 

Q        Q 

I         II      III 

        A1V1        A2V2  A3V3 



14                                  O Estado da Arte 

Da relação Q = A1V1 = A2V2 = A3V3 , segue que 

{

ef

D

IIcilindro

total

disp

D
R

V

V

V
V

LA

LA
V

A

A
V

VV
?

=====

  

1

2

1

1

2

1
2      (3.4) 

sendo A1 a área da secção transversal do cilindro I, A2 a área porosa e Vdisp o volume de poros 

disponíveis para o fluxo. Assim a velocidade real é sempre maior que a velocidade de Darcy. 

De acordo com INGEBRITSEN et al. (2006), a lei de Darcy é uma lei empírica que 

descreve adequadamente o fluxo subterrâneo para ser acoplado ao transporte de soluto por 

advecção e dispersão mecânica. Na forma diferencial, a lei de Darcy é expressa por: 

?? = ? = ?? ?
?	
?
?       (3.5) 

sendo q a taxa de fluxo volumétrico por unidade de área ??

?
??

?
2

3

L
T

L

, k a condutividade hidráulica 

[ ]
T
L

 e 
?	
?
 o gradiente hidráulico [adimensional]. O sinal negativo de (3.5) indica que o fluxo 

está na direção decrescente da carga hidráulica h. 

De posse de uma solução numérica ( )eh? em um elemento finito (e), e assumindo que as 

coordenadas cartesianas alinham-se com os eixos principais do tensor de condutividades 

hidráulicas [K], a velocidade real VR no elemento (e), indicado por 
( )e
Rv
r

, em analogia à 

expressão (3.5), é dada por: 

( ) ( )e

yy

xx

efy

xe
R hK

K

v

v
v ˆ

0

01
???
?

?
?
?
?

?
?=??

?

?
?
?
?

?
=

?
r

     (3.6) 

A estimativa do parâmetro b da espessura do aquífero confinado e as relações 

 Txx = b.Kxx, e Tyy = b.Kyy, resultam na seguinte expressão para o campo de velocidade real nos 

elementos finitos da malha: 

( ) [ ] ( )e
ef

e
R hT

b
v ˆ

.

1
??=

?
r

      (3.7) 

sendo [ ] ??
?

?
?
?
?

?
=

yy

xx

T

T
T

0

0
, o tensor de transmissividade da equação (3.3). 



Departamento de Hidráulica e Saneamento – PPG SHS EESC USP                                      15 

3.1.2 Solução Analítica de Theis 

No processo de verificação da solução numérica será empregada, para as futuras 

comparações, a solução analítica de Theis4 da equação do fluxo subterrâneo [SUTRA, 2003]. 

Esta solução analítica para a equação transiente do fluxo radial       
t

h

T

S

r

h

rr

h

?
?

=
?
?

+
?
? 1

2

2

 

considera as seguintes hipóteses [THEIS, 1935]: 

• o aquífero confinado é homogêneo e a sua extensão é infinita; 

• o aquífero é compressível e a água instantaneamente liberada da fonte quando a carga 

hidráulica é rebaixada; 

• a taxa de bombeamento é constante; 

• não existe recarga. 

A solução do fluxo horizontal da água subterrânea, resultante da equação e hipóteses 

acima determina o valor do rebaixamento da superfície potenciométrica s(r,t) [L] a uma 

distância r [L] do centro do poço de extração constante Q [ ]TL3  e num determinado instante t: 

)(
4

)()(),( uW
T

Q
thhtrs

?
=??=     (3.8) 

sendo ?
? ?

??
?

?
??
?

?
=

u

x

dx
x

e
uW )( para a variável 

Tt

Sr
u

4

2

= , 

S o coeficiente de armazenamento [adimensional] e 

T a transmissividade [ ]TL2 . 
Quando u &amp;lt;1, a função W(u) é aproximada pela expressão: 

543

2

00107857,000976004,005519968,0             

24991055,09999193,0ln57721566,0)(

uuu

uuuuW

+?+

?+??=
 

 Quando ?&lt;? u1 , a aproximação é dada por: 

                                                 

4 Charles Vernon Theis viveu de 27/03/1900 a 31/07/1987 e deixou importantes contribuições na área da 
Hidrogeologia. 



16                                  O Estado da Arte 

uue

bubububu

auauauau

uW
?
?

?
?
?

?

++++
++++

= 43
2

2
3

1
4

43
2

2
3

1
4

)(  com    

9584969228,3        2677737343,0

0996530827,21        6347608925,8

6329561486,25        059016973,18

5733223454,9        5733287401,8

44

33

22

11

==
==
==
==

ba

ba

ba

ba

 

As informações provenientes da distribuição de cargas hidráulicas de um aquífero 

podem ser utilizadas nos termos advectivo e difusivo da equação do transporte, fornecendo ao 

modelo matemático uma abrangência realista nos movimentos hídricos na zona de saturação. 

É neste sentido que o campo de velocidades do escoamento de água subterrânea representa a 

estreita relação entre a equação fundamental do fluxo e o transporte de contaminantes. 

3.2 AS EQUAÇÕES GOVERNANTES DO TRANSPORTE DE CONTAMINANTES 

O transporte de contaminantes, ou de soluto ou de outros constituintes químicos 

dissolvidos, que são importantes componentes de vários processos geológicos, ocorrem 

devido aos fenômenos descritos no ANEXO I: a advecção, a difusão molecular, a dispersão 

mecânica e outras características físico-químicas relevantes do fenômeno. 

Nesse anexo é visto que a advecção refere-se ao movimento de solutos transportados 

pelo movimento da água subterrânea. A difusão molecular é o fluxo difusivo do soluto no 

sentido contrário ao gradiente de concentração. Esse processo ocorre em função do 

movimento browniano dos íons na solução. Os íons de uma região de concentração alta 

tendem a se misturar com íons de uma região de baixa concentração, estabelecendo uma 

mesma distribuição no espaço. A dispersão mecânica tem o mesmo efeito da difusão, com a 

mistura resultando do movimento físico da água (diferenças de velocidade). Portanto, onde a 

concentração difere, o soluto é predominantemente transportado por difusão molecular 

quando a velocidade é relativamente baixa e por dispersão mecânica quando a velocidade é 

considerada alta [DYMINSKI, 2006]. 

Considerando a conservação de massa, com os fluxos advectivo e dispersivo associados 

às transformações químicas de primeira ordem e um termo de fonte ou sorvedouro f * [ ]
TL

M
3 , a 

equação do transporte de contaminantes em um sistema de fluxo não-uniforme em aquíferos 

gerais é descrita da seguinte forma [BEAR, 2001]: 



Departamento de Hidráulica e Saneamento – PPG SHS EESC USP                                      17 

             ( ) ( ) ( ) *** fCKCCCdivCKC dbdbt =++??+??+? ?????? vD                (3.9) 

sendo:    C a concentração de soluto (massa de soluto por unidade de volume do fluido) [ ]3LM . 
       ?  o conteúdo de umidade do solo [adimensional] 

     ?C o gradiente de concentração [ ]4LM , 
      D* = Dm + Dd o tensor da dispersão hidrodinâmica

5 [ ]TL2 , 
       v* vetor de velocidade aparente [ ]TL , 
      ?  o coeficiente de decaimento de 1ª ordem [ ]T1 , 
      ?b a densidade volumétrica6 do meio poroso [ ]3LM e 
      Kd o coeficiente de partição entre soluto dissolvido e adsorvido à fase sólida [ ]ML3 . 

Para aquífero confinado, o meio poroso é sempre saturado e, neste caso, o conteúdo de 

umidade ?  terá o mesmo valor da porosidade efetiva ef? [adimensional]. 

Definindo o fator de retardo por 
ef

db KR
?

?
+= 1 , a equação (3.9) é reescrita por  

( ) fCCCdivCt =+??+??? ?vD               (3.10) 

sendo 
R

*D
D = , 

Ref?

*v
v = , 

R

f
f

ef?

*

= . A equação (3.10) é a equação de advecção-dispersão-

reação (ADR) que descreve o transporte de solutos no aquífero ou meio poroso. 

Quando o fator de retardo é igual a 1, o campo de velocidades v da equação (3.10) 

representa a velocidade real do fluxo subterrâneo, esta velocidade também é conhecida por 

velocidade seepage. 

                                                 

5 Embora os respectivos parâmetros da dispersão mecânica e da difusão molecular, Dm e Dd , sejam provenientes 
de diferentes processos físicos, eles podem ser adicionados uma vez que possuem o mesmo efeito físico. 
6 O bulk density ?b também é conhecido por densidade do solo seco [ ]3LM . 



18                                  O Estado da Arte 

A razão entre o transporte advectivo e o transporte dispersivo é caracterizada pelo 

número de Peclet7 LPe
D

v
= , sendo L um comprimento característico definido sobre o 

domínio da equação (3.10) e   ?  é a norma euclidiana.  

O número de Peclet é um parâmetro adimensional e define o tipo predominante do 

transporte de soluto. Se o número de Peclet é maior que 1, o mecanismo de transporte 

predominante é o advectivo, caso contrário, se o número de Peclet é menor que 1, o transporte 

predominante é o dispersivo [BEAR, 2001]. 

3.2.1 Condições Iniciais e Condições de Fronteira 

Para modelar o problema físico é necessário definir um conjunto coerente de condições 

iniciais e condições de fronteiras inicialmente especificadas. 

As condições iniciais definem as concentrações do contaminante no aquífero em um 

determinado instante inicial. As condições de fronteira definem as restrições impostas sobre o 

contorno da malha do modelo que representa a interface existente entre o domínio 

discretizado e o ambiente do problema físico. 

Três tipos de condições de fronteira poderiam ser considerados para a equação do 

transporte de contaminantes: a condição de Dirichlet, a condição de Neumann e a condição de 

Robin (ou condição mista)8. 

A condição de Dirichlet ocorre quando o valor da concentração do contaminante é 

imposto sobre a fronteira (ou sobre parte dela, denominada fronteira de Dirichlet ?D) ou 

quando é imposto em um ponto específico do domínio, caso a contaminação seja pontual. Em 

termos matemáticos, esta condição é dada por: 

( ) DCtyxC =,,  sobre ?D      (tipo I) 

                                                 

7 Jean Claude Eugène Péclet (1793-1857) foi um físico francês. 
8 Johann Peter Gustav Lejeune Dirichlet (1805-1859) foi um matemático alemão creditado com a moderna 
definição “formal” de função. Carl Gottfried Neumann (1832-1925) foi um matemático alemão. 
Victor Gustave Robin (1855-1897) foi um matemático francês que contribuiu na área da termodinâmica. 



Departamento de Hidráulica e Saneamento – PPG SHS EESC USP                                      19 

A condição de Neumann ocorre quando existe uma imposição no gradiente da 

concentração normal sobre a fronteira, ou parte dela, denominada fronteira de Neumann ?N. 

Esta condição equivale dizer que o fluxo de massa dispersivo encontra-se fixo através desta 

parcela da borda (ou contorno), isto é: 

gC =?? Dn  sobre ?N      (tipo II) 

sendo n o vetor unitário exterior à fronteira ?N e g o fluxo do contaminante por unidade de 

comprimento de ?N. Se a fronteira é impermeável, então g ? 0. 

A condição de Robin ocorre quando o valor do fluxo total de massa é imposto sobre a 

fronteira. Neste caso, se Ce e ge são, respectivamente, a concentração e o fluxo de massa do 

contaminante, a expressão é: 

( ) ee gCCC +?=?+? nvDvn  sobre ?R      (tipo III) 

Em particular, se v = 0 sobre a fronteira, a condição acima será a condição de Neumann. 

Existem autores9 que ainda consideram um quarto tipo conhecido por condição de 

fronteiras abertas. Esta condição de fronteira considera que o contaminante sai por dispersão 

através de fronteiras permeáveis. O valor do fluxo de contaminante que sai é dado pela 

seguinte expressão: 

      ( )?
?

??? dCDn          (tipo IV) 

A vantagem na utilização deste tipo de condição de fronteira é que o domínio numérico 

pode ser inferior ao domínio que impõem a condições do tipo II [BONILLO et al., 1999]. 

3.3 APROXIMAÇÃO DA EQUAÇÃO DO TRANSPORTE 

 A metodologia para a estimativa do erro a posteriori da solução numérica é influenciada 

pelo método que é adotado para a discretização por elementos finitos. 

                                                 

9 BONILLO J. et al., 1999 A 2D Numerical Model for the Transport of Pollutants. 
    The Influence of Boundary Conditions 3rd International Symposium on Ecohydraulics. 
    CD Proceedings. Salt Lake City, Utah, USA. 



20                                  O Estado da Arte 

 A natureza parabólica da equação do transporte advectivo-dispersivo contribuiu, nos 

últimos anos, ao desenvolvimento de controle de erro a posteriori da aproximação destas 

equações transientes com caráter dissipativo. A literatura apresenta três principais métodos de 

aproximações no tempo que poderiam ser empregados na equação do transporte de 

contaminante (3.10). 

• Método das Linhas (MOL): Um sistema de equações diferenciais ordinárias 

(EDO), cuja ordem é a mesma que a do grau de liberdade do espaço de 

elemento finito, é obtido da discretização da malha espacial da equação 

parabólica. O esquema Crank-Nicolson [AKRIVIS et al., 2006] é adotado para 

resolver o sistema de EDO´s com coeficientes transientes. Esquemas MEF-FCT 

(Flux-Corrected Transport) para o fenômeno de fluxo dominado pelo 

transporte advectivo seguem baseados no MOL10. 

• Método de Rothe: Antes da discretização da variável espacial, é realizada uma 

partição no intervalo de tempo. Assim, em cada passo de tempo tem-se uma 

equação diferencial parcial  estacionária, a qual é aproximada por um esquema 

de elementos finitos11. Alguns autores implementaram o método de Rothe e 

desenvolveram um código adaptativo multilevel para a resolução de equações 

parabólicas lineares e não-lineares12. 

• Elementos finitos espaço-temporal: Nesta aproximação, o espaço e o tempo 

são discretizados simultaneamente. Segundo VERFÜRTH (2008) este tipo de 

aproximação da equação parabólica é superior em relação às duas anteriores e 

será detalhada na metodologia da presente tese (seção 4.4, pg. 46), pois este 

método de aproximação apóia o desenvolvimento do estimador de erro a 

posteriori da solução numérica do modelo ADR. 

A aplicabilidade de um modelo preciso para o transporte de contaminantes em água 

subterrânea incorpora, atualmente, a análise de resultados laboratoriais dos processos de 

degradação microbiótica [COUTO e MALTA, 2007]. Estes processos de biodegradação podem 

                                                 

10 KUZMIN D. 2008 Explicit and Implicit FEM-FCT Algorithms with Flux Linearization  Preprint  
    submetido ao Elsevier (disponível em http://www.mathematik.uni-dortmund.de/~kuzmin/linfct.pdf  
   acesso em 15/12/2008) 
11 AXELSSON O., FRANK L. S., Van der SLUIS A. 1980 Analytical and Numerical Approaches to  
    Asymptotic Problems in Analysis Mathematics Studies 47 North-Holland 
12 BECK R., ERDMANN B., ROITZSCH R. 1995. KASKADE 3.0 An Object-Oriented Adaptive Finite  
    Element Code, Technical Report TR 95-4, Konrad-Zuse- Zentrum, Berlin. 



Departamento de Hidráulica e Saneamento – PPG SHS EESC USP                                      21 

ser simulados descrevendo os fenômenos de transporte reativo com taxa de reação de 1ª 

ordem, ou reação do tipo Monod dentro de um poro simples [HE?E et al., 2009]. Neste 

modelo, a descrição matemática do destino e da concentração das espécies simples emprega 

as equações de advecção-dispersão na fase de fluido e reações cinéticas na interface fluido-

sólido do interior do poro. 

De acordo com HOSSAIN e MIAH (1999), o método dos elementos finitos (MEF) possui 

crescente popularidade entre os modelos de transporte de contaminante em água subterrânea. 

Estes modelos numéricos, baseado no princípio de minimização de Galerkin (GMEF) 

[BOCHEV, 2001], apresentaram resultados de precisão espacial de segunda ordem quando 

comparados aos dos métodos de diferenças finitas. No entanto, para simulação de transporte 

transiente GMEF é necessário a utilização de pequenos passos de tempo, e ainda, quando a 

advecção é o tipo de transporte predominante, a solução numérica apresenta oscilações 

espúrias, pois o operador advectivo é não-simétrico [DONEA E HUERTA, 2004], fato que 

contribui para a perda de estabilidade deste tradicional método de Galerkin [PAPASTAVROU e 

VERFÜRTH, 2000]. 

Para eliminar as oscilações numéricas, responsáveis por soluções não-físicas, são 

introduzidas as chamadas funções de bases com termos upwind13 e outras variações para 

adicionar uma estabilização linear à formulação de Galerkin tradicional [SANTOS E ALMEIDA, 

2007]. Os modelos referenciados por Petrov-Galerkin-MEF (PGMEF) oferecem resultados 

numéricos livre de oscilação, porém, com uma significativa dispersão artificial [GALEÃO et 

al., 2004] [KALASHNIKOVA et al., 2009]. 

Com o desenvolvimento de critérios refinados para o esquema de Crank-Nicolson, 

quando aplicado no GMEF (CNGMEF) para o transporte de advecção-dispersão, foi possível a 

obtenção de resultados de precisão temporal de alta ordem [HOSSEIN e MIAH, 1999]. Estes 

esquemas CNGMEF de discretização da equação do transporte disponibilizam simulações 

precisas e livres de oscilação mesmo em situação de advecção predominante do transporte de 

contaminante em água subterrânea, ou seja, estes esquemas são incondicionalmente estáveis. 

Segundo LOZINSKI et al. (2009), até o presente, são poucos os trabalhos que empregam o 

popular método de Crank-Nicolson nas equações parabólicas. Neste método de reconstrução, 

funções quadráticas e contínuas por partes no tempo podem ser obtidas explicitamente da 

solução numérica. 

                                                 

13 O upwind é uma correção para a descrição numérica incorreta do processo físico. 



22                                  O Estado da Arte 

Métodos livres de malha também foram desenvolvidos para modelos bidimensionais do 

transporte de contaminantes através do meio poroso saturado. Um método, conhecido por 

Método Radial de Interpolação de Ponto (RPIM) aproxima a solução em construções 

inteiramente em termos do conjunto de nós do domínio e nenhuma caracterização da inter-

relação entre estes nós é necessária [KUMAR E DODAGOUDAR, 2008]. O modelo RPIM 

apresentou uma adequada aplicabilidade para a equação de advecção-dispersão com 

fenômenos de sorção ou de degradação de 1ª ordem. Outros resultados numéricos foram 

utilizados na verificação dessa metodologia de aproximação e ainda foram gerados sem 

oscilações, demonstrando-se insensíveis às restrições do número de Peclet. O modelo RPIM 

para o transporte 2D de contaminantes considera o campo de velocidade em regime uniforme. 

3.4 O TRANSPORTE EM REGIME DE PEQUENA ADVECÇÃO 

Foi visto na seção 3.2 que o número de Peclet define o mecanismo de transporte com 

predominância dispersiva ou advectiva. Nesta seção, será definida uma constante 

característica ?
? ) para separar o mecanismo de transporte em regime de pequena advecção e 
regime de grande advecção. Se o número de Peclet for maior que 1, o mecanismo de 

transporte possui predominância advectiva, caso contrário, a predominância será dispersiva. 

Se o valor da constante característica for superior a 10, o regime de transporte será 

considerado de grande advecção, caso contrário, o regime é considerado de pequena 

advecção. A figura 3.2 apresenta as duas formas para distinguir, respectivamente, o 

mecanismo e o regime de transporte. Ela ainda mostra a possibilidade de ocorrência de 

exemplos de transporte de contaminantes de predominância advectiva e em regime de 

pequena advecção (Pe &gt; 1,0 e Cc &amp;lt;10). 

 

 

 

 

 

FIG 3.2 – Distinção entre os mecanismos de transporte em função do no. de Peclet 
e distinção entre os regimes de transporte em função da constante Cc 

pequena                                                pequena                                                           grande 
advecção                                              advecção                                                         advecção 

predominância                                 predominância                                               predominância 
   dispersiva                                           advectiva                                                         advectiva 

Cc = 10.0 Pe = 1.0 



Departamento de Hidráulica e Saneamento – PPG SHS EESC USP                                      23 

Para definir essa constante característica Cc, considere ? &gt; 0, o menor autovalor da 
matriz de dispersão D da equação 3.10 e ? ? 0 o coeficiente de decaimento de primeira 
ordem do contaminante em estudo, de acordo com VERFÜRTH (2008):  

• se ( ) 2
1

2

1

)(
0

},max{,sup 2 ???
????
&lt;?

L
Tt

tv  o regime é considerado de pequena advecção; 

• se ( ) 2
1

2

1

)(
0

},max{,sup 2 ???&gt;&gt;? ?
??

L
Tt

tv  o regime é considerado de grande advecção. 

Logo, considerando ? ? ? e fluxo de água subterrânea em regime permanente, ou seja, 
campo de velocidades v(x,y) constante, a pequena advecção é caracterizada quando 

|v| ? 
? ?
?
??????, ??

?
? ? 
? ?     (3.11) 

sendo 
? ?
|?|
 , uma constante característica de tamanho moderado. 

Na sequência, são analisados os regimes de advecção de quatro cenários do transporte 

de contaminantes em meio poroso saturado cujas escalas são: regional [SOREK, 1988], de 

campo [PARKHURST, 2004] e [KUMAR e DODAGOUDAR, 2008] e de laboratório [HUANG et al., 

2008]. Esses exemplos possuem a respectiva solução numérica cuja verificação e feita ou por 

soluções analíticas ou por métodos numéricos reconhecidos na literatura. 

Exemplo 1.) Em SOREK (1988) um método adaptativo 2D Euler-Lagrangiano foi utilizado 

para o transporte de massa com distribuição espacial da velocidade. A equação de advecção-

dispersão (EAD) para um constituinte efluente em um fluido incompressível considera: fator 

de retardo R &gt; 1, tensor de dispersão hidrodinâmica simétrico e semi-positivo e decaimento 

radioativo de 1ª ordem. 

Esse exemplo numérico para comparação com solução analítica e verificação do método 

proposto considerou os seguintes parâmetros físicos: !" = !# = 2 ?&amp;amp;/( para as dispersões 
nas direções dos eixos coordenados e )" = 0,25 ?/( e )# = 0 ?/( como sendo os 
componentes da velocidade do fluxo subterrâneo [VAROGLU e FINN, 1982 apud SOREK, 

1988]14. A malha adotada caracterizou o transporte em regime de advecção dominante, pois o 

número de Peclet na direção x, foi +" =
,-."

?-
= 25 e +# = 0 para a direção y. 

                                                 

14 Varoglu E., Finn W. D. L., “Utilization of the method of characteristics to solve accurately two dimensional 
transport problems by finite elements”.  Inter J. Num Methods in Fluid, 2, 173-184, 1982. 



24                                  O Estado da Arte 

Nesta situação, o menor autovalor do tensor D foi ? = !" = 2 e a constante 
/ ?
0,&amp;amp;1

&amp;amp; =
0,125 era de tamanho moderado. Ou seja, o regime adotado neste exemplo numérico foi o de 
pequena advecção. 

Exemplo 2.) No caso de fluxo unidimensional na direção x, PARKHURST (2004) apresenta 

uma simulação de transporte de espécies químicas nas três direções x, y e z, com reações de 

decaimento de 1ª ordem. 

Os parâmetros deste exemplo são: velocidade intersticial ) = 0,2 ?/34?, coeficiente de 
dispersividade longitudinal 5
 = 1,5 ?, dispersividade horizontal transversal 567 = 0,3 ?, 
dispersividade vertical transversal 569 = 0,1 ? e taxa constante de decaimento 
 ? = 0,05 3:;. Com estes valores, o tensor de dispersão é a matriz diagonal !&lt;"&amp;lt;=
34?=(0,30  0,06  0,02). 

Considerando que o menor autovalor da matriz !&lt;"&lt;, ? = 0,02 é, neste caso, menor que 
o coeficiente ? = 0,05, pode-se determinar que 


? ?
|)|

?
;
&amp;amp;?????, ??

;
&amp;amp;

=
0,2

(0,02)
;
&amp;amp;(0,05)

;
&amp;amp;

= 6,32 

é uma constante de tamanho moderado, ou seja, o exemplo encontra-se no regime de pequena 

advecção. 

Exemplo 3.) Um método numérico livre de malha, chamado de método radial de interpolação 

de ponto (RPIM), foi apresentado por KUMAR e DODAGOUDAR (2008) para a resolução 

bidimensional da equação de advecção-dispersão-sorção em meio poroso saturado. Em 

regime de advecção dominante (Px = 2,86) os autores consideraram um expressivo valor para 

o fator de retardo, R = 7,267. 

O exemplo numérico gerou a solução RPIM para ser comparada com a respectiva 

resolução por elementos finitos sobre uma malha inicial de 400 elementos quadriláteros e 

apresentou boa concordância. Dos parâmetros físicos deste exemplo, pode-se obter 
? ? 0,57 
para caracterizar o regime de transporte em pequena advecção. 



Departamento de Hidráulica e Saneamento – PPG SHS EESC USP                                      25 

Exemplo 4.)  Finalmente, para comparar uma EAD a sua correspondente equação de modelo 

fracionário (FADE15), HUANG et al. (2008) analisaram o processo do transporte de atrazina em 

uma coluna homogênea de solo arenoso saturado. 

Dentre os parâmetros físicos adotados para o ajuste da EAD encontra-se: @ = 1,825 
para o fator de retardo, ) = 1,9 C?/?4D para a velocidade no poro e ! = 1,304 C?&amp;amp;/?4D 
para a dispersão longitudinal. Assim 
? ?

;,F
0,G;H1 = 2,659, ou seja, o experimento foi 

realizado em regime de pequena advecção. 

Os exemplos acima são fortes indícios de que o transporte de contaminantes em água 

subterrânea é realizado no regime de pequena advecção. 

3.5 ERRO A POSTERIORI DA EQUAÇÃO PARABÓLICA 

De forma prática, os estimadores de erro a posteriori, obtidos dos diferentes métodos de 

discretização das equações diferenciais parciais, asseguram importantes questões de como 

uma solução discreta I	 pode ser precisamente determinada da solução fraca u de um dado 
problema da Engenharia. Esse estimador é construído após a solução numérica pelo método 

de elementos finitos, I	, ter sido computada e ainda utiliza os valores de entrada descritos no 
modelo matemático em questão. Outra característica fundamental reside na escolha da norma 

do erro J = I ? I	 para constituir os estimadores. 
Segundo BABUS?KA e STROUBOULIS (2001), o estudo do estimador de erro a posteriori 

inicia-se no desenvolvimento do erro na norma global de energia. No entanto, em problemas 

práticos da Engenharia não é suficiente somente a estimativa deste tipo de erro, pois, um 

pequeno valor na norma de energia do erro não implica necessariamente que o erro na 

quantidade de interesse seja também pequeno [BABUS?KA E STROUBOULIS, 2001, pg. 471]. 

A análise de erro a posteriori, que estima o erro discreto real sem o conhecimento da 

solução exata I, serve de base dos processos de refinamento ou desrefinamento das técnicas 
de malhas adaptativas. Estes processos necessitam de uma estratégia que facilmente limita o 

erro computável, para assegurar o controle global da solução. 

                                                 

15 O modelo FADE (fractional advection-dispersion equation) considera que as anomalias do movimento de 
contaminantes no meio poroso são representadas por processos não-Fickianos. 



26                                  O Estado da Arte 

Para os problemas elípticos, como a equação do fluxo subterrâneo em regime 

permanente, a teoria dos estimadores de erro a posteriori encontra-se particularmente bem 

desenvolvida [VERFÜRTH, 1996], [AINSWORTH e ODEN, 2000], e [CHIDYAGWAI e RIVIÈRE, 

2010]. Verifica-se na literatura que para equações diferenciais elípticas a norma comumente 

usada para quantificar o erro e é a norma de energia ou a norma L2 [KNABER E ANGERMANN, 

2003]. 

Para os problemas parabólicos, nos quais estão inseridas as equações do transporte de 

contaminantes, é encontrado um crescente interesse em estimar o erro da solução numérica 

das equações de advecção-dispersão com predominância advectiva e de abordagens distintas. 

O primeiro passo é a escolha da norma K?K que o erro numérico será estimado. No 
entanto, a questão para decidir qual é a norma apropriada do erro estimado para as equações 

de advecção-dispersão é uma discussão na comunidade científica [JOHN, 2000]. 

Além da prescrição da norma para estimar o erro, diferentes estratégias de discretização 

são apresentadas na literatura. Entre elas pode se destacar as seguintes abordagens da equação 

parabólica: 

Estimadores de erro anisotrópicos baseados na recuperação da derivada segunda da 

solução por elementos finitos foram desenvolvidos por [ALMEIDA et al., 2000] para conduzir 

uma eficiente geração de malhas para os domínios da equação de convecção-difusão e demais 

problemas que empregam as técnicas computacionais para a dinâmica de fluidos. 

Em [PAPASTAVROU e VERFÜRTH, 2000], encontra-se uma comparação entre três 

estimadores a posteriori aplicados no problema estacionário da equação linear de convecção-

difusão: um estimador ZZ, um estimador residual e um estimador de Neumann (estimador 

baseado na resolução local de um problema auxiliar discreto). Para assegurar a estabilidade da 

solução aproximada, o esquema de discretização aplica o conhecido SUPG (streamline upwind 

Petrov-Galerkin) no método de Galerkin tradicional introduzindo difusão artificial com o uso 

modificado nas funções de testes [HUGHES et al., 2009]. Nos problemas testes, da comparação 

realizada, conclui-se que o estimador ZZ não foi capaz de capturar os fenômenos de alta 

ordem, tais como, as regiões de singularidades. No entanto, tanto o estimador residual, quanto 

o estimador de Neumann, mostrou-se qualificados na localização destas regiões, fornecendo 

ainda informações quantitativas sobre o erro de aproximação.  

Uma vez que os métodos de elementos finitos adaptativos baseados em estimadores de 

erro a posteriori tornaram-se um tema central na Engenharia e na Computação Científica, os 

esforços seguem direcionados para o desenvolvimento de algoritmos adaptativos eficientes 

para os vários tipos de equações diferenciais parciais parabólicas lineares ou não-lineares. 



Departamento de Hidráulica e Saneamento – PPG SHS EESC USP                                      27 

Para um caso linear, CHEN e FENG (2004) desenvolveram um algoritmo adaptativo, com 

estratégias de refinamento e desrefinamento que é capaz de reduzir o erro indicado abaixo de 

um valor tolerável usando um número finito de passos na resolução iterativa. 

Estimadores a posteriori também são aplicados na avaliação do erro provenientes da 

discretização temporal da equação transiente de advecção-dispersão, tais como o já 

mencionado método de Crank-Nicolson. 

Utilizando a reconstrução de Crank-Nicolson de segunda ordem em contínuas 

aproximações lineares por partes da solução numérica, [AKRIVIS et al., 2006] obtiveram 

estimativas facilmente computadas e com apropriadas representações pontuais do erro 

observado na evolução temporal de uma equação parabólica. 

Um estimador a posteriori do esquema de discretização com elementos finitos misto de 

Raviart-Thomas de mais baixa ordem, para as equações de convecção-difusão-reação, é 

apresentado em [VOHRALÍK, 2007]. Esse estimador computável e de características residuais, 

quando aplicados nos problemas de convecção dominante, obteve explicitamente os valores 

constantes dos limites superiores globais do erro de aproximação na norma de energia, 

confirmados por experimentos numéricos. 

Utilizando na equação do calor, 
MN
MO ? ?I = Q, elementos finitos lineares para obter a 

discretização espacial e o método de Crank-Nicolson para a discretização temporal, [LOZINSKI 

et al., 2009] desenvolveu um estimador de erro a posteriori com uma representação razoável 

do erro real. As parcelas que constituem o estimador, conhecidas por indicadores de erro, 

conduziram um algoritmo adaptativo no tempo e no espaço. 

Em [HILHORST e VOHRALÍK, 2010] encontra-se um computável estimador de erro a 

posteriori baseado na discretização pelo Método de Volumes Finitos (FVM)16 [EYMARD et al., 

2003] das equações de convecção-difusão-reação. O algoritmo resultante para obter as 

estimativas apresenta boa eficiência para as contribuições do erro espacial e temporal. 

Verifica-se, desta maneira que os estimadores de erro a posteriori, para os problemas 

parabólicos, são obtidos de diferentes metodologias e aplicados na avaliação dos esquemas de 

discretização numérica conforme o propósito que é estabelecido pelo pesquisador. 

Neste trabalho serão adotados os esquemas ?A-estáveis [VERFÜRTH, 2008] que 

generalizam o método de Crank-Nicolson para obter a discretização temporal das equações de 

                                                 

16 Método de resolução de derivadas parciais baseado na resolução de balanços de massa, energia e quantidade 
de movimento a um determinado volume de meio contínuo. 
 



28                                  O Estado da Arte 

advecção-difusão-reação, com advecção dominante. Acompanhados pelos esquemas de 

discretização espacial que utilizam elementos finitos conformes17, é possível obter um 

eficiente estimador de erro a posteriori, com características residuais, para os esquemas de 

discretização espaço-temporal. 

VERFÜRTH (2006) demonstrou que o limite superior deste estimador residual é global no 

espaço e no tempo e que o limite inferior é global no espaço e local no tempo. O estimador 

desenvolvido é robusto no sentido que a razão entre o limite superior e inferior é 

uniformemente limitada no tempo e independe do tamanho da malha ou do passo de tempo 

adotado na discretização. Uma característica interessante deste estimador residual é que ele é 

uniformemente limitado em relação ao tamanho da advecção. 

3.6 CONSIDERAÇÕES DO CAPÍTULO 3 

Os modelos de transporte e dos processos de reação no meio poroso resultam na 

equação diferencial parcial dada por (3.10). Para os parâmetros físicos desta equação sobre 

um domínio poligonal limitado ?, o número de Péclet global definido por: 

+J ? K,KS?TUV(?)K?KS  ,    (3.11) 

é uma constante significativamente maior que uma unidade18. Isto caracteriza (3.10) como 

sendo uma equação de advecção dominante e como visto na literatura, para esta equação, os 

métodos convencionais de discretização (o Galerkin tradicional) apresentam limitações. 

A aproximação upwind é uma alternativa para remediar a diminuição na precisão 

numérica quando o tamanho h da malha não é “suficientemente pequeno”. Outra alternativa é 

contrabalancear a difusão numérica negativa introduzida pela aproximação obtida pelo 

método de Galerkin tradicional.  

                                                 

17 Uma aproximação FEM de uma equação elíptica de ordem 2m é conforme se: I- as funções de base são m 
vezes continuamente diferenciáveis em cada subregião e II- as funções de base são m-1 vezes continuamente 
diferenciáveis em todo domínio. 
18 Especificamente para o transporte de substâncias dissolvidas em água subterrânea, o valor representativo do 
número de Péclet global é em torno de 25 [KNABNER e ANGERMANN, 2003]. 



Departamento de Hidráulica e Saneamento – PPG SHS EESC USP                                      29 

De acordo com [DONEA e HUERTA, 2004] estas metodologias são equivalentes, ou seja, 

uma aproximação upwind induz a difusão numérica e vice versa. 

Entre outros métodos especiais para resolver equações de advecção dominante citam-se: 

• o método SUPG (streamline upwind Petrov-Galerkin) [BROOKS e HUGES, 1982], que 

basicamente adiciona apropriados resíduos ponderados na formulação variacional do 

problema estacionário para introduzir uma difusão extra na direção da velocidade (ou 

transporte advectivo). Quando métodos implícitos no tempo são acoplados com a 

discretização SUPG no espaço, o resultado são termos adicionais que oferecem 

consistência e acurácia na solução dos problemas de advecção dominante [BOCHEV et 

al., 2004];  

• o método de volume finito (MVF), que discretiza uma EDP integrando suas equações 

sob volumes de controle. O MVF é estável devido ao comportamento assintótico de 

suas funções de ponderação. Devido à sua generalidade, qualquer tipo de malha, 

estruturada19 ou não-estruturada, pode ser usada [EYMARD et al., 2003]; 

• o método de Galerkin Descontínuo (GD) pode ser considerado como uma 

generalização do MVF em que as funções de aproximação e funções testes são funções 

polinomiais sobre os elementos, sem restrições de continuidade sobre a fronteira entre 

os elementos [DEVLOO et al., 2005]. O método GD é consistente para a formulação dos 

problemas de advecção-dispersão; 

• o método de Lagrange-Galerkin (MLG), que elimina o termo advectivo por uma 

transformação apropriada das coordenadas, permitindo a aplicação dos métodos 

tradicionais de discretização em situação onde a advecção é dominante. Alguns 

problemas com a estabilidade revelaram a necessidade de uma melhor fundamentação 

teórica do método MLG [MORTON et al., 1988 apud KNABER E ANGERMANN, 2003]20 e  

• no método S3 (Symmetrical Streamline Stabilization) [WENDLAND e SCHIMD, 2000], a 

equação de advecção-dispersão é divida pela técnica de separação de operadores. Os 

termos advectivo e dispersivos são aproximados por técnicas FEM distintas e 

reagrupados a um único sistema de equações. O termo advectivo, que fica na parte 

implícita da equação, possui a sua matriz de coeficientes simétrica, propiciando a 

aplicação do solver conhecido por Gradiente Conjugado Pré-condicionado (PCG). 

                                                 

19 Malha estruturada apresenta uma estrutura, ou regularidade, na distribuição espacial dos pontos. 
 
20 Morton K. W., Priestley A., Süli E., Stability of the Lagrange-Galerkin method with non-exact 
integration. RAIRO Model. Math. Anal. Numer 22(4) 625-653, 1988 



30                                  O Estado da Arte 

Para resolver numericamente a equação parabólica (3.10), diferentes métodos são 

desenvolvidos e aperfeiçoados. A quantificação dos resultados obtidos, revelando a precisão 

ou a deficiência do método, é possível mediante a aplicabilidade efetiva dos estimadores de 

erro a posteriori. 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 



4 O MÉTODO DE ELEMENTOS FINITOS 
E A PROGRAMAÇÃO JAVA 

O Método de Elementos Finitos – FEM é conhecido por suas aplicações nas diversas 

áreas das Engenharia. O uso de uma formulação variacional do modelo matemático e de uma 

técnica de discretização do domínio ?  das equações são frequentemente usadas para as 

aproximações dos problemas de valores de contorno [DEVLOO et al., 2009]. A implementação 

do código numérico, baseada no FEM para a obtenção da solução aproximada da equação do 

fluxo e da equação do transporte, é realizada em linguagem JAVA em função da portabilidade 

e da reusabilidade facilitada pelo paradigma da programação orientada a objetos – POO. 

Neste capítulo é apresentado o método de obtenção das aproximações FEM das equações 

governantes do fluxo de água subterrânea da seção 3.1, das equações governantes do 

transporte de contaminantes da seção 3.2 e das respectivas implementações computacionais 

JAVA que fornecem a solução numérica. O código numérico disponibiliza resultados de 

soluções analíticas para casos especiais de cada equação e implementa, principalmente, as 

apropriadas técnicas que estabelecem estimativas do erro a posteriori. 

4.1 CONCEITOS BÁSICOS DO MÉTODO DE ELEMENTOS FINITOS 

No método FEM, um subdomínio de ?  será denotado por he? , onde o subscrito e denota 

o “elemento e” e o sobrescrito h representa o “tamanho característico” do elemento 

discretizado. 

O espaço de soluções que contêm ue é de dimensão infinita em todo ponto x sobre o 

subdomínio e possui uma variável ue(x) associada com o elemento. Na figura 4.1, esta 

variável de dimensão infinita ue(x) é aproximada por um espaço de dimensão finita )(xu
h
e , a 

qual depende do número finito dos valores nodais aeu?  (o subscrito a é número do nó do 

elemento e, e o símbolo “ ^ ” representa o valor de ue calculado no nó a – o valor nodal). 



32                                  Metodologia 

Uma base ae?  de funções de aproximação para uma variável ue é definida em cada 

subdomínio de acordo com a expressão: 

1,,0        ˆ ?=?? node
a
e

a
e

h
ee na Kuuu ?      (4.1) 

sendo nnode o número de nós do elemento 
h
e?  e  funções de aproximação. 

             elemento he?  

 

 

 

 

  fronteira ?? 

  Domínio global ?   Domínio global discretizado ?h 
     sobreposto no domínio ? 

 
FIG 4.1 – Geometria da discretização do domínio global ???? 

            utilizando elementos finitos quadriláteros. 

 A função aproximada heu  da equação 4.1 é definida por um conjunto de funções de 

interpolação ae?  sobre cada elemento e. O espaço gerado por estas funções é conhecido por 

espaço de elementos finitos. 

A terna definida pelo conjunto { }heaehe u,, ??  representa um elemento finito que consiste 
do domínio he? , da função interpolante 

a
e?  e do grau de liberdade 

h
eu  [CIARLET, 1978 apud 

WORKBOOK PG 268]21. 

Para discretização das equações do fluxo e do transporte de contaminantes, serão 

utilizadas as clássicas funções Lagrangianas sobre elementos de quatro nós, de acordo com a 

seguinte formulação: 

( ) ( )( )?????? aaaN ++= 11
4

1
,       (4.2) 

                                                 

21Ciarlet P. G., 1978 The finite element method for elliptic problems. North-Holland, Amsterdam. 



 Departamento de Hidráulica e Saneamento – PPG SHS EESC USP                                     33 

sendo 3 2, ,1 ,0=a  o número do nó do elemento e ( )?? ,  o sistema de coordenadas locais 
cujos vértices ( )aa ?? ,  são, respectivamente, {(-1,-1),(1,-1),(1,1),(-1,1)} [PRUDHOMME e 
ODEN, 2002] (ver figura 4.2b). 

Portanto, as formas explícitas para as funções interpolantes são: 

( ) ( )( )

( ) ( )( )

( ) ( )( )

( ) ( )( )?
?
?
?

?

?
?
?
?

?

?

+?=

++=

?+=

??=

????

????

????

????

11
4

1
,

11
4

1
,

11
4
1

,

11
4

1
,

3

2

1

0

N

N

N

N

       
(4.3) 

No processo de refinamento, elementos triangulares poderiam ser utilizados. Assim, as 

funções interpolantes para elementos triangulares podem ser obtidos pela degeneração das 

equações 4.3, definindo 1100    , NNNN
tritri ==  e )1(

2

1
322 ?+=+= NNN

tri , ou seja,  

( ) ( )( )

( ) ( )( )

( ) ( )?
?
?

?

?
?
?

?

?

+=

?+=

??=

???

????

????

1
2
1

,

11
4

1
,

11
4
1

,

2

1

0

tri

tri

tri

N

N

N

       
(4.4) 

A transformação de coordenadas usando a equação (4.3) para elementos quadriláteros 

são mostradas na figura 4.2a, e a transformação usando a equação (4.4) para elementos 

triangulares são mostradas na figura 4.2c. Um elemento de referência e?  pode ser definido 

na região normalizada de acordo com a regra de transformação de coordenadas ( )e?? xx  
que aplica e?  no elemento físico 

h
e? . Desta forma, o domínio normalizado nas coordenadas 

naturais ( )?? ,  é transformado no domínio físico nas coordenadas x = (x,y). 
As funções interpolantes para a transformação de coordenadas pode ser escolhida da 

mesma forma como foi definida a interpolação da função aproximada )(xuhe da equação (4.1), 

ou seja,  



34                                  Metodologia 

( ) aeaee xx ˆ???        (4.6) 

sendo 1,,0 ?= nodena K  e 
a
ex?  a coordenada fixa do valor nodal. 

 

 

 

            y 

                       x3            
h
e?  

                                              x2 

                    x0 

 

                                    x1 

 
(a) sistema de coordenadas 

cartesianas 
 
    FIG 4.2 – (a) Elemento físico nas coordenadas cartesianas (x,y) 
                   (b) Elemento de referência quadrilátero em coordenadas locais 
                   (c) Elemento de referência triangular degenerado 

 

 Um elemento finito com o mesmo conjunto de funções interpolantes para as funções 

de aproximação e para a transformação de coordenadas é conhecido por elemento 

isoparamétrico.  

 Uma vez que no método de elementos finitos as funções de interpolação são usadas 

para representar a aproximação de uma variável do modelo contínuo, é necessária a garantia 

de que esta aproximação FEM tradicional esteja convergindo para a solução exata quando o 

tamanho h da malha estiver diminuindo22. A convergência ocorre quando as funções de 

aproximação satisfazem as condições de completude e de continuidade. Estas condições de 

convergência são conhecidas por condições de admissibilidade das funções de aproximação e 

                                                 

22 Este tamanho h geralmente é definido como sendo o máximo dos diâmetros de cada elemento da malha.  

                                           ? 
                                                  2    e?  

 
                                                             ? 
 
x                                    0                1 
                     (c) triângulo linear degenerado 

                       ? 
                 3                2 
                                          e?  

                                        ? 
 
                 0                1 
  (b) sistema de coordenadas locais 



 Departamento de Hidráulica e Saneamento – PPG SHS EESC USP                                     35 

quando alguma das condições acima não é satisfeita, os elementos serão ditos não-

conforme23. 

4.1.1 Consistência, Estabilidade e Convergência do Método 

Três propriedades fundamentais que todo método numérico deve possuir para a 

aproximação de uma equação diferencial parcial - EDP são: consistência, estabilidade e 

convergência. 

Em linhas gerais, a consistência implica que a EDP pode ser recuperada por um sistema 

de equações algébricas. O conceito de estabilidade está relacionado ao crescimento ou 

diminuição dos erros introduzidos nos cálculos. E a convergência implica que a solução 

numérica aproxima a solução exata da EDP quando há um aumento no grau de liberdade24 do 

método numérico [FORTUNA, 2000]. 

Considerando o método de Galerkin25 no espaço com as funções de bases contínuas, 

como as representadas por (4.3) ou (4.4), e assumindo que a solução numérica C(t) é 

aproximada por funções lineares, em cada passo de tempo de acordo com (4.1), um esquema 

de médias ponderadas [HUGHES, 2000] para aproximar uma equação parabólica pode ser dado 

por: 

[ ] [ ] [ ]11 )1()1( ++ +??+???=?+ nnnn ttt FFCKMCKM ????   (4.7) 

sendo M e K matrizes globais obtidas, respectivamente, da montagem (ou assembling) das 

matrizes locais de massa e de rigidez. O vetor F refere-se à montagem dos vetores de carga da 

equação.  A constante ? é o parâmetro de discretização temporal. 

 As sensibilidades às pequenas perturbações, que implicam na ausência de estabilidade 

do método, podem ser expressas na seguinte definição [OTTO, 2007]: 

                                                 

23 O método de Galerkin Descontínuo, que admite aproximação não-conforme, é convergente. 
 
24 Graus de liberdade é um termo genérico utilizado em referência a quantidade mínima de números reais 
necessários para determinar completamente o estado físico de um dado sistema. 
 
25 Boris Grigoryevich Galerkin (1871-1945) foi um importante matemático e engenheiro russo. 



36                                  Metodologia 

Definição 4.1.1 Um esquema numérico é condicionalmente estável, se uma perturbação de 

tamanho ?  introduzida no instante tn permanece limitada para os tempos 

subseqüentes para Tt ?  e para todo passo de tempo 0tt ??? . 

 Sem perda de generalidade, pode-se assumir que uma perturbação ? é introduzida no 

instante t = 0. Considere C  solução da equação (4.7) satisfazendo ?+= 00 CC . Subtraindo o 

sistema perturbado [ ] [ ] [ ]11  )1()1( ++ +??+???=?+ nnnn ttt FFCKMCKM ????  da equação 
(4.7), a seguinte expressão é obtida: 

[ ] [ ] ?????? =???=?+ + 01             ,)1( nn tt KMKM    (4.8) 

sendo nnn CC ?=? . 

 Assim, para problemas lineares é suficiente aplicar a definição 4.1 na versão 

homogênea do esquema numérico, apresentando a perturbação ? em suas condições iniciais. 

Com estas restrições, define-se estabilidade de uma maneira mais explícita [OTTO, 2007]. 

Definição 4.1.2 Um esquema numérico linear é estável se existe uma constante c &gt; 0, que  

                           independe de t?  e tal que 
0?? cn ?  quando Tttn ?????   ,0  , . 

Ambas as definições permitem que a perturbação inicial cresça, mas somente por uma 

quantidade limitada. Se uma condição mais forte é imposta na definição acima, ou seja, se 

0?? ?n , as soluções de sistemas contínuos serão absolutamente estáveis no sentido que 

C(t) é limitada para todo 0?t . Neste caso, não são permitidos os crescimentos das 

perturbações ? n. 

O detalhamento da propriedade de estabilidade é motivado pelo seguinte teorema de 

Equivalência de Lax, o qual expressa uma relação entre as três propriedades fundamentais 

[OTTO, 2007]. 

Teorema de Equivalência de Lax. Para um problema bem posto26, sendo a 
formulação de dois níveis temporais consistente, a existência de estabilidade é uma 
condição necessária e suficiente para convergência de um sistema de equações 
lineares. 

                                                 

26 Um problema de valor inicial é dito bem posto quando depende continuamente das condições iniciais. 



 Departamento de Hidráulica e Saneamento 

Ou seja, se a formulação é consistente e estável, o esquema é convergente. Desta forma, 

a solução numérica Cn 

tyx ???   e    ,  tenderem para zero.

A figura 4.3 estabelece relações entre as três propriedades fundamentas do método 

numérico e sintetiza que a discretização é

• CONSISTENTE se a formulação numérica é suficientemente próxima da 

• ESTÁVEL se o problema discreto é bem posto.

• CONVERGENTE se C

FIG 4.3 – 

4.2 APROXIMAÇÃO DA E

Nesta seção, é usada uma formulação mist

aproximado por elementos finitos, enquanto o tempo é discretizado por diferenças finitas. 

Uma malha estruturada de elementos quadriláteros

corresponderá às dimensões horiz

A formulação contínua da equação 

Equação 

Diferencial 

Parcial

Solução Exata

Saneamento – PPG SHS EESC USP     

Ou seja, se a formulação é consistente e estável, o esquema é convergente. Desta forma, 

 convergirá para a solução exata C quando os incrementos 

ara zero. 

estabelece relações entre as três propriedades fundamentas do método 

a discretização é:  

se a formulação numérica é suficientemente próxima da 

se o problema discreto é bem posto. 

Cn é suficientemente próximo da solução exata

 
Relação entre consistência, estabilidade e convergência

Adaptado de [OTTO, 2007 pg. 69] 

EQUAÇÃO DO FLUXO E O ESTIMADOR DE ERRO

é usada uma formulação mista onde o domínio da equação do fluxo (3.3) é 

aproximado por elementos finitos, enquanto o tempo é discretizado por diferenças finitas. 

estruturada de elementos quadriláteros é gerada para representar o domínio 

às dimensões horizontais do aqüífero confinado. 

A formulação contínua da equação transiente do fluxo é dada por: 

Equação 

Diferencial 

Parcial

Sistemas de 

Equações 

Algébricas

Solução Exata
Solução 

aproximada

discretização 

consistência 
quando ?h e ?t 
tendem a zero 

convergência  
quando ?h e ?t 
tendem a zero 

 

                                37 

Ou seja, se a formulação é consistente e estável, o esquema é convergente. Desta forma, 

quando os incrementos 

estabelece relações entre as três propriedades fundamentas do método 

se a formulação numérica é suficientemente próxima da EDP. 

óximo da solução exata C. 

 

Relação entre consistência, estabilidade e convergência 

RRO 

a onde o domínio da equação do fluxo (3.3) é 

aproximado por elementos finitos, enquanto o tempo é discretizado por diferenças finitas. 

é gerada para representar o domínio que 

 

Sistemas de 

Solução 

aproximada

estabilidade 



38                                  Metodologia 

( )

?
?
?

?

?
?
?

?

?

?=?
?=??
?=

?
?
?

=+?
?

?
?
?

?

?
?

?
?

+?
?

?
?
?

?

?
?

?
?

   em            ),(                                              

],0( x   sobre                                                     

],0( x   sobre                                                             

],0( x    em        ,,

00 hth

TghD

Thh

T
t

h
StyxW

y

h
T

yx

h
T

x

N

DD

yyxx

n

 

sendo ? ? IR2 o domínio poligonal limitado e com fronteira Lipschitz27 ? consistindo de duas 

partes disjuntas, ?D a fronteira de Dirichlet e ?N a fronteira de Neumann, tais que 

?=??? ND .  O tempo final T é arbitrário, no entanto, precisa ser especificado. 

O Método de Resíduos Ponderados permite a obtenção da solução aproximada h? . A 

contribuição em cada elemento para o resíduo da solução numérica, no nó i, pode ser obtida 

da formulação integral da equação do fluxo: 

( ) ( ) ( )
( )( )

( ) 0 ,,
ˆˆˆ

=?
?
?

?

?

?
?

?

?
??

?

?
?
?

?

?
?

?
?

??
?

?
?
?

?

?
?

?
?

?
?

?
???

e
e

yy

e

xx

e

i dtyxW
y

h
T

yx

h
T

xt

h
S

e
  (4.9) 

sendo 
i?  a função de ponderação do resíduo e 

( )e?  um elemento da malha uniforme. 

Para cada elemento finito ( )e? , a carga hidráulica ( )eh?  será obtida através da 

interpolação nodal das cargas ( )ejh , utilizando as funções de bases ( )( )???? jjj ++=? 11
4

1
 em 

coordenadas locais ( )?? , , cujos vértices ( )jj ?? ,  são {(-1,-1),(1,-1),(1,1),(-1,1)} para
3 2, ,1 ,0=j . Desta forma, para cada elemento: 

( ) ( )?
=

?=
3

0

ˆ
j

e
jj

e hh .              (4.10) 

Substituindo a aproximação (4.10) na equação do resíduo (4.9) e aplicando a Identidade 

de Green28 nas derivadas de 2ª ordem, a formulação fraca de Galerkin para a aproximação da 

equação do fluxo é: 

                                                 

27 O termo é devido ao matemático alemão Rudolf Lipschitz (1832-1903). Um domínio Lipschitz, ou domínio 
com fronteira Lipschitz, é um domínio no espaço Euclidiano cuja fronteira é “suficientemente regular” no 
sentido que ela pode ser localmente representada como sendo um gráfico de uma função f : X?Y Lipschitz 
contínua (ie, existe K ? 0 tal que ( ) ( )2121 ,)(),( xxKdxfxfd xY ?  para todo x1 e x2 em X). Vários teoremas de 
imersão em espaço de Sobolev pedem que o domínio de estudo seja um domínio Lipschitz. Conseqüentemente, 
vários problemas envolvendo equações diferenciais parciais ou formulações variacionais estão definidos sobre 
domínios Lipschitz. 



 Departamento de Hidráulica e Saneamento – PPG SHS EESC USP                                     39 

{ }FKM =+
?
?
?

?
?
?

?
?

}ˆ{
ˆ

h
t

h
S      (4.11) 

sendo 
( )

( )e
ji de ???= ??M  a matriz de massa local ou de armazenamento, 

           ( )( ) ( )eji dTe ??????= ??   K  a matriz de rigidez local ou de mobilidade , 

            ?
?

?
?
?

?
=

yy

xx

T

T
T

0

0
 o tensor de transmissividade e  

           { } ( )( ) ( ) ???+?= ?? ?? dhTnWd ii
e

e
  

r
F  o vetor local de cargas nodais

29 ou de esforços. 

A aproximação temporal da equação (4.11) será obtida pelo esquema de Euler 

progressivo aproximando o termo 
?
?
?

?
?
?

dt

hd ˆ
 por 

?
?
?

?
?
?
?

?

?
??+

t

hh ttt ˆˆ
 e aplicando as interpolações: 

( ) ttt hhh ?++?= }ˆ{}ˆ{1}ˆ{ ??  e ( ) ttt FFF ?++?= }{}{1}{ ??    (4.12) 

A equação aproximada para cada passo de tempo t?  será dada pela expressão: 

( ) ( )( ) ( )tttttt FFthKtMShKtMS ?+?+ +??+???=?+ }{}){1(}ˆ{][1][}ˆ{][][ ????             (4.13) 

Os termos [M] e [K] representam as matrizes globais obtidas pela montagem 

(assembling) das matrizes locais nos elementos de uma malha inicial que discretiza o domínio 

? . 
A solução do problema discreto (4.13) pode aplicar o método de Crank-Nicolson 

atribuindo 
2
1

=?  e usando os valores 0}ˆ{ th  fornecidos pelas condições iniciais do problema 

em t = t0. 

Após a imposição das condições de contorno de Dirichlet Dhh =}ˆ{ , a qual especifica os 

valores das cargas hidráulicas na fronteira D? , e as condições de contorno de Neumann 

0ˆ =?h , para a representação de fluxo nulo nas fronteiras impermeáveis N?  do aqüífero 
                                                                                                                                                         

28 ( ) ?? ?? ??
?

=??+??? d
n

B
AdBABA 2  

29 n
r

 é o vetor unitário exterior a ??=???=? ND . 



40                                  Metodologia 

confinado, a solução da equação (4.13) fornece a solução numérica tth ?+0}ˆ{ . De maneira 

sucessiva, determinam-se as soluções )},(ˆ{ ji yxh  em cada nó ),( ji yx  da malha inicial, no  

n-ésimo passo de tempo tntt ?+= .0 . 

4.2.1 Gradiente Numérico da Equação do Fluxo 

O gradiente hidráulico h??  da solução numérica é aplicado na obtenção do campo de 
velocidades do fluxo de água subterrânea e na análise de erro a posteriori dos processos 

adaptativos que utilizam técnicas de Recuperação do Gradiente [ZIENKIEWICZ, 2004].  

As funções de interpolação lineares ( )( )???? jjj ++=? 11
4
1

, com os parâmetros das 

coordenadas locais ( )?? ,  e 30K=j , conforme definidas na seção 4.1, relacionam o gradiente 
hidráulico em cada elemento finito por: 

( ) ( ) ( ) ( ) ( )?? ,ˆ.,ˆ 1 eTe hJyxh ?=? ?     (4.14) 

sendo J a matriz jacobiana da mudança de coordenadas. 

Para uma malha inicial de (3.3) segue que ( ) ?
?

?
?
?

?
=

?

20

021TJ , e a substituição de (4.10) em 

(4.14) resulta na expressão ( ) ( ) ( )?
=

??=?
3

0
2.2

ˆ
j

e
jj

e hIh . 

Após simples operações matemáticas, obtém-se 

( )
( ) ( ) ( )( ) ( ) ( ) ( )( )

( ) ( ) ( )( ) ( ) ( ) ( )( )??
?
?

?

?

?
?
?
?

?

?

??+?+

??+?+
=?

eeee

eeee

e

hhhh

hhhh

h

0312

0132

ˆˆ1ˆˆ1

ˆˆ1ˆˆ1

2

1ˆ

??

??
   (4.15) 

Aplicando ( ) ( )0,0, =??  em coordenadas locais, o gradiente obtido no centro do 
elemento ( )e?  é especificado por 



 Departamento de Hidráulica e Saneamento – PPG SHS EESC USP                                     41 

( ) ( )
( ) ( ) ( ) ( )( )
( ) ( ) ( ) ( )( )??

?
?

?

?

?
?
?
?

?

?

+?+

+?+
=?

eeee

eeee

cc
e

hhhh

hhhh

yxh

1032

3021

ˆˆˆˆ

ˆˆˆˆ

2

1
,ˆ     (4.16) 

sendo xc e yc as coordenadas globais do ponto central do elemento finito. 

4.2.2 Estimador de Erro baseado na Recuperação do Gradiente 

A característica elíptica da equação fundamental (3.3) favorece a aplicação do estimador 

de erro a posteriori baseado em técnicas de recuperação do gradiente, conhecidas por técnica 

SPR (Superconvergent Patch Recovery) [ZIENKIEWICZ E ZHU, 1992b]. 

Quando o método de elementos finito (FEM) é usado para solucionar as equações 

diferenciais relacionadas a um funcional definido, para um problema discreto, erros são 

introduzidos pelo processo de discretização. O erro resultante da redução do modelo 

matemático contínuo para um modelo numérico discreto é dependente do número finito de 

graus de liberdade. 

O erro da aproximação obtida pelo método dos elementos finitos 
hu , em relação à 

solução exata u é dado por: 

  
huue ?=       (4.17) 

e o erro do fluxo (proporcional ao gradiente de u) é 

 
he ??? ?= .       (4.18) 

sendo ?  o gradiente da solução exata e h?  o gradiente da solução aproximada. 

Uma vez que as soluções exatas u e ?  são quase sempre desconhecidas, faz-se 

necessário desenvolver uma metodologia apropriada para estimar o erro da solução numérica 

FEM. 

O estimador de erro SPR, às vezes referenciado por estimador ZZ, provou ser efetivo e 

econômico tanto no cálculo do erro, quanto na condução do refinamento adaptativo da 

equação (3.3). 

 



42 

Segundo [ZHANG e 

computados da solução de elemento finito 

têm uma baixa precisão nos nós e 

interior dos elementos finitos, conhecidos como

derivadas e os fluxos são mais precisos nestes pontos do que em qualquer outro ponto no 

interior do elemento finito

convergem mais rapidamente

elemento. 

É possível recuperar um valor nodal de 

pontos superconvergentes em pequenos conjuntos de elementos em volta do nó, chamado 

patch [AKIN, 2000]. Este procedimento de recuperação para obter 

suavização dos valores nodais que de

obtidos de cada elemento adjacente ao nó

 

 

 

 

 

 

 

FIG 4.4 – (a) valores de 
      (b) gradiente su

Na prática, o gradiente suavizado 

polinomial ?  = Pa, sendo que 

conjunto de coeficientes desconhecido. Esta expansão é usada para cada componente do 

tensor ? . 
No caso do problema

elementos finitos quadráticos [

                                                

30 Convergência da ordem O(h1+p

                                 

 VICTORY JR., 1995], o campo das derivadas e 

da solução de elemento finito 
hu  não possuem continuidade entre os elementos e 

m uma baixa precisão nos nós e nos elementos da fronteira. No entanto, existem pontos no 

interior dos elementos finitos, conhecidos como pontos superconvergentes

derivadas e os fluxos são mais precisos nestes pontos do que em qualquer outro ponto no 

nito [ZIENKIEWICZ, 2004]. Os valores nos pontos superconvergentes 

convergem mais rapidamente30 para o valor exato do que o decréscimo do tamanho do 

É possível recuperar um valor nodal de ?  mais preciso que 
h? , por interpolação destes 

pontos superconvergentes em pequenos conjuntos de elementos em volta do nó, chamado 

]. Este procedimento de recuperação para obter ?

suavização dos valores nodais que determina uma média ponderada dos valores 

elemento adjacente ao nó, conforme ilustrado na figura 4.4

(a) valores de ( )e??  calculados para cada elemento do 
(b) gradiente suavizado pela média ?  

Na prática, o gradiente suavizado ?  é aproximadamente dado pela expansão 
, sendo que P contêm os termos polinomiais apropriados e 

ientes desconhecido. Esta expansão é usada para cada componente do 

No caso do problema elíptico bidimensional (3.3) é recomendada uma aproximação

elementos finitos quadráticos [ZIENKIEWICZ e ZHU, 1992a]: 

P = [1, x, y, x2, xy, y2]   

a = [a0, a1, a2, a3, a4, a5]
T  

         

p) sendo h o tamanho da malha e p a ordem do polinômio interpolador.

                                Metodologia 

campo das derivadas e os fluxos h?  

inuidade entre os elementos e 

No entanto, existem pontos no 

pontos superconvergentes, nos quais as 

derivadas e os fluxos são mais precisos nestes pontos do que em qualquer outro ponto no 

. Os valores nos pontos superconvergentes 

do que o decréscimo do tamanho do 

, por interpolação destes 

pontos superconvergentes em pequenos conjuntos de elementos em volta do nó, chamado 

?  utiliza a técnica de 

termina uma média ponderada dos valores 
( ) ( )ee h?ˆ ?=?  

nforme ilustrado na figura 4.4. 

calculados para cada elemento do patch 

é aproximadamente dado pela expansão 

contêm os termos polinomiais apropriados e a é um 

ientes desconhecido. Esta expansão é usada para cada componente do 

recomendada uma aproximação por 

  (4.19) 

  (4.20)  

a ordem do polinômio interpolador. 



 Departamento de Hidráulica e Saneamento – PPG SHS EESC USP                                     43 

Os coeficientes do vetor a são obtidos através do método dos mínimos quadrados. 

Ajusta-se a expansão polinomial de ?  para obter ( )e?? , que são provenientes da solução por 

elementos finitos aplicadas em seus centróides – ou sampling points. 

Na malhar quadrangular, o patch de elementos é definido como sendo a união dos 

elementos que compartilham um determinado nó. Estes patches de elementos são usados na 

performance local do ajuste do gradiente por mínimos quadrados. 

Para ilustrar a técnica de recuperação superconvergente – SPR, considere os sampling 

points (4 pontos superconvergentes) no patch com coordenadas globais (xi,yi). Assim, o 

problema é reduzido à minimização do seguinte funcional: 

 G = ( ) ( )?
=

?
m

i
iiii yxyx

1

2],,ˆ[ ?? = ( )?
=

?
m

i
ii yx

1

,ˆ[? P(xi,yi)a]2   (4.21) 

Este problema de minimização é resolvido com a condição ?G/?a = 0, o que fornece o 

seguinte sistema de equações lineares algébricas 

Aa = b               (4.22), 

sendo 

A = ?
=

m

i 1

[PT(xi,yi) P(xi,yi)]      e      b = ?
=

m

i 1

[PT(xi,yi) )](ˆ ii ,yx?  

A resolução do sistema (4.22) fornece a solução para os coeficientes de a e 

conseqüentemente a expressão de ?  do gradiente, suavizada pelo ajuste dos mínimos 
quadrados. 

Um estimador de erro a posteriori associado ao elemento ??K  para a equação do 
fluxo subterrâneo (3.3) pode ser definido por: 

( )
?
?

?= dxdyeK
22 ???     (4.23) 

 O erro global ZZ? estimado pela técnica SPR é dado por: 

2

1

2

?
?
?

?
?
?

= ?
??K

KZZ ??       (4.24) 

 Segundo VERFÜRTH (2008) o estimador ZZ fornece ainda os respectivos limites 

superiores e inferiores para o erro da solução numérica da correspondente equação elíptica. 



44                                  Metodologia 

4.3 FORMULAÇÃO VARIACIONAL DA EQUAÇÃO DO TRANSPORTE DE CONTAMINANTES 

 Nesta seção, na equação governante do transporte de contaminantes, dada pela equação 

parabólica linear e de segunda ordem (3.10), é imposto as condições iniciais e de condições de 

fronteira. O modelo matemático é então representado por: 

( )

?
?

?

?
?

?

?

?=
?=??
?=

?=+??+???

   em                                                   

],0( x   sobre                                           

],0( x   sobre                                                   

],0( x    em        

0CC

TgCD

TCC

TfCCCdivC

N

DD

t

n

vD ?

   (4.25) 

sendo ? ? IR2 o domínio poligonal limitado e com fronteira Lipschitz ? consistindo de duas 

partes disjuntas, ?D a fronteira de Dirichlet e ?N a fronteira de Neumann, tais que 

?=??? ND . O tempo final T é arbitrário, no entanto, precisa ser especificado. 

 Assuma que os parâmetros da equação (4.25) satisfazem às seguintes condições: 

a.) A difusão D é uma matriz continuamente diferenciável e simétrica, uniformemente 

definida positiva e uniformemente isotrópica, ou seja,  

0
),(

mininf
}0{\IR0 2

&gt;=
?

??
?&amp;lt;zz

ztxDz
T

T

z
x

Tt
?    e   

zz

ztxDz
T

T

z
x

Tt

),(
maxsup

}0{\IR0

1

2?
??
?&lt;

?= ??  

 são constantes de tamanho moderado. 

b.) O termo de reação ? é uma função escalar contínua e não-negativa. 

c.) Existe uma constante 0??  tal que: 

?? ?? v div
2

1

 
para quase todo ??x  e Tt ?&lt;0 . 

E ainda, existe uma constante 0?bc  de tamanho moderado
31 tal que ( ) .,sup

0
?? b

x
Tt

ctx ?
??
?&lt;

 

                                                 

31 Se 0=? , então o contaminante é considerado um traçador ideal, ou seja, 0=? . 



 Departamento de Hidráulica e Saneamento – PPG SHS EESC USP                                     45 

 Desta forma, para o modelo do transporte de contaminantes, o regime é: 

 difusão dominante se o ( ) ?c
x

Tt

ctx ?
??
?&lt;

,sup
0

v  e ?? bc?? ; 

 reação dominante se o ( ) ?c
x

Tt

ctx ?
??
?&lt;

,sup
0

v  e ?? &gt;&gt;  ou 

 advecção dominante se o ( ) ?&gt;&gt;
??
?&lt;

tx

x
Tt

,sup
0

v . 

Para fundamentar a discretização por elementos finitos da equação do transporte de 

contaminante que estabelecerá o estimador de erro a posteriori, é descrito a seguinte 

formulação variacional da equação parabólica (4.25): 

 

Encontrar 
1

*),0(: DHTC ?  tal que ?&lt;?? ?
T

L
txC

0

2

)(2
),( , 

? ? ?&lt;
?
?

?
?

?

?
?

?
?

?

???
?

=?
??
?

T

v
Hv

dtdxxwtxC

L

0

2

1
}0{\)(

,)(),(sup

)(2

1
2

 0)0,( CC =?  

e para quase todo ),0( Tt ? e para todo )(
1 ?? DHw , tem-se 

??????
??????

+=+??+???+?
N

gwfwCwCwwDCCwt ?v  (4.26) 

sendo }  sobre  :{)( 11 * DDD CvHvH ?=?=?  e }  sobre  0:{)(
11

DD vHvH ?=?=? . 

As hipóteses a.),  b.), c.) e condições de regularidades sobre f e g, implicam que o 

problema (4.26) admite uma solução única [VERFÜRTH, 2008]. 

A norma de energia associada a este problema variacional é  

{ } 212
)(

2

)(
  22 ?? +?= LL www ??     (4.27) 

sendo ?
?

=
?

dxvv
L

22

)(2
. 



46                                  Metodologia 

A correspondente norma dual é dada por 

?
???

???= w
w

DHw

?? 1sup
}0{\)(

* 1
                                     (4.28) 

A solução fraca é procurada no caso em que não é possível determinar a solução 

clássica do problema (4.25). Este é o caso de muitas aplicações cujos dados de entrada não 

apresentam a suavidade requerida ou apresentam descontinuidades do termo fonte f(x,t). 

Nestas circunstâncias, o problema fraco (4.26) precisa ser formulado. 

4.4 ELEMENTOS FINITOS ESPAÇO-TEMPORAL PARA A EQUAÇÃO PARABÓLICA 

 Como foi visto na seção (4.2) para a equação do fluxo subterrâneo, a discretização por 

elementos finitos é baseada na partição do domínio ? em subdomínios de formas simples que 

não se sobrepõem. A coleção destes subdomínios é chamada de partição T e os seus membros 

são os elementos K. 

 Nesta seção, para obter a aproximação da equação do transporte de contaminantes, 

algumas características e propriedades da partição T precisam ser consideradas. 

 Uma partição T  satisfaz às seguintes condições:  

i.) Da união de todos os elementos K de T  resulta o conjunto ? ? ?.  

ii.) Equivalência Afim – Para ? ? IR2, cada elemento K ? T é um triângulo ou 
um quadrilátero. 

iii.) Admissibilidade – Quaisquer dois elementos de T ou são disjuntos ou 

compartilham, no máximo, ou uma aresta completa ou um único vértice. 

iv.) Forma Regular – Para todo elemento K, a razão entre o seu diâmetro hK e o 

diâmetro ?K da circunferência inscrita em K, possui valor uniformemente 

limitado. A constante definida por 
K

K

K

h
c

?TT ?
= max  é o parâmetro de forma da 

partição T. 



 Departamento de Hidráulica e Saneamento – PPG SHS EESC USP                                     47 

 Esta condição de regularidade da partição T  implica que todos os elementos K e K’, e 

todos as arestas E e E’, nos quais compartilham no mínimo um vértice, possuem as razões 

K

K

h

h

?

, 
E

E

h

h

?

 e 
E

K

h

h
 limitadas acima e abaixo por constantes que dependem unicamente do 

parâmetro de forma Tc . 

 Para toda partição T em IR2 são associados aos seus elementos K os conjuntos: 

    NK conjunto dos vértices de K; 

    EK conjunto das arestas de K; 

    U
T

T
NN

?

=
K

K  conjunto dos vértices de todos os elementos de T; 

    U
T

T
EE

?

=
K

K  conjunto das arestas de todos os elementos de T; 

     NE  conjunto dos vértices de uma aresta E ? ET; 

    ?,TN  conjunto de vértices sobre a fronteira; 

    
D?,T

N  conjunto de vértices sobre a fronteira de Dirichlet; 

    
N?,T

N  conjunto de vértices sobre a fronteira de Neumann; 

    ?,TN   conjunto de vértices no interior de ?; 

    ?,TE   conjunto das arestas contidos na fronteira; 

    
D?,T

E  conjunto das arestas contidos na fronteira de Dirichlet; 

    
N?,T

E  conjunto das arestas contidos na fronteira de Neumann; 

    ?,TE   conjunto das arestas que possuem, no mínimo, um ponto final no 

interior de ?. 

 A discretização temporal inicia com uma partição I = [ ]{ }INntt nn ??? 1:,1  do intervalo 
[0,T] em subintervalos satisfazendo: Ttt N =&lt;&lt;= IK00 . Para todo n natural de INn ??1  

considere [ ]nnn ttI ,1?=  o n-ésimo subintervalo de comprimento 01 &gt;?= ?nnn tt? . A cada 
instante tn com INn ??0  é associado: 

• uma partição Tn de ? que é admissível, de equivalência afim e de forma regular; 

•  um espaço de elementos finitos Xn, que consiste das contínuas funções polinomiais por 

partes e 

•  a projeção ?n do espaço L2(?) sobre o espaço Xn. 



48                                  Metodologia 

 Se considerar o parâmetro [ ]1,21??  e as correspondentes abreviações ( )nn tDD ,?= , 
( )nn t,?= vv , ( )nn t,?= ?? , ( )nn tff ,?=  e ( )nn tgg ,?= , a aproximação totalmente discreto da 

equação (4.25) do transporte de contaminantes será dada por:  

 

 Encontrar 
IT

NnXC n
n

n
??? 0   , , tal que 00

0

0
CC ?=

T
 e para 

I
Nn ,,1 K=  

( ) ( )??
?

??

?

????+?+?
?? nnnnnn

wDCCwCC nnnnn

n
TTTTTT

11

11
)1(

1
??

?
 

            ( )?
?

?
?

?+??+
nnn

wCC nnn
TTT

1

1
)1( ??v ( )?

?

?
?

?++
nnn

wCC nnn
TTT

1

1
)1( ???  

           ( )?
?

??+=
n

wff nn
T

1)1( ?? ( )?
?

??++
N

n
wgg nn
T

1)1( ??  para todo nXw n ?T    

(4.29) 

 A discretização acima é conhecida na literatura por esquema ?A estável [VERFÜRTH, 

2008]. Segundo DONNEA e HUERTA (2004, pg 92), para valores de 
2

1
??  o método é 

incondicionalmente estável e ainda resulta no popular esquema de Crank-Nicolson se 
2
1

=? , 

no esquema de Galerkin se 
3
2

=?  e no esquema Euler implícito se ? = 1. 

 As hipóteses enunciadas na seção 4.3 implicam que o problema discreto (4.29) admite 

uma única solução ( )
I

T Nn

n

n
C

??0
. 

4.5 UM ESTIMADOR DE ERRO RESIDUAL PARA EQUAÇÃO DO TRANSPORTE 

 A partir desta seção, TET ??S  denotará um elemento ou uma aresta e hS o seu 

diâmetro. ( )?EJ  será o operador que determina o valor do salto da concentração do 

contaminante através da aresta TE?E  na direção do vetor ortonormal nE.  

 Se a aresta ??E , a orientação do vetor nE não está fixa e, no entanto, ( )?EJ  dependerá 
desta orientação. Para evitar este tipo de problema, para ? o valor da concentração sobre a 



 Departamento de Hidráulica e Saneamento – PPG SHS EESC USP                                     49 

aresta do elemento, será considerado o valor de ( )??EE nJ , pois este independe da orientação 
do vetor nE, conforme a figura 4.5. 

 

 

 

 

 

 

 

FIG 4.5 – Valor da projeção independente da orientação do vetor normal 

 

 Sobre cada intervalo [ ]nn tt ,1?  são definidas projeções fI e gI representadas pelas funções 
constantes por parte da seguinte maneira: 

( ) ( ) ( )( )1,)1(,, ???+?=? nnn tftftf ???I  e 
( ) ( ) ( )( )1,)1(,, ???+?=? nnn tgtgtg ???I , 

o elemento residual representado por 

( ) ( )
( ) ( )11

11

11

11

)1()1(      

))1((
1

??

??

??

??

?+??+???

?+?+??=

nnnnnn

nnnnn

n
K

nnnn

nnnn

CCCC

CCDdivCCfR

TTTT

TTTTI

?????

??
?

v

  (4.30) 

os resíduos laterais representados por  

( )

?
?
?

??
?

?

?

??+???

??+???

=

?

?
?

?
?

?

?

Dn

Nnnn

nnn

E

ECCDg

ECCD

R nnnE

nnn
EE

E

,

,
1

,
1

   se                                                          0

   se     ))1((

   se    ))1((

1

1

T

TTTI

TTT

E

E

E

??

??

n

nJ

  (4.31) 

e a função de ponderação representada por 
?
?
?

?
?
?

=
??

2

1

2

1

,min ??? SS h para todo elemento ou 

arestas TET ??S
32. 

                                                 

32 Se 0=?  será convencionado ?=
?

2

1

? . 

 

?
En

p proj=

??= Enp

1=En

?

En?



50                                  Metodologia 

 De acordo com VERFÜRTH (2008), a parcela 

 
2

1

2

)(
2

1

~

2

)(

2

~

22

??

?
?
?

??

?
?
?

+= ??
?

?

?
nn

n
E

ELEE
K

KLKK
n RR

T
ET

T
????    (4.32) 

pode ser tomada como um indicador de erro espacial. E ainda acrescenta que o erro real, 

provenientes das contribuições espaciais e das contribuições temporais da aproximação 

totalmente discreta da equação parabólica (4.25) é dado pela seguinte expressão: 

( ) ( ) 2
1

1

2

*

122

)(000 12
ˆ

?
?
?

?
?
?

??
?

??
? ???++?= ?

=

?
? ?

I

TTTI

N

n

nnnn
nL nnn

CCCC v????   (4.33) 

 O estimador de erro residual (4.33) é apenas preliminar, pois a presença da norma dual 

*
  ? , definida pela equação (4.28), torna impraticável a computação do erro da solução 

numérica. A obtenção de um estimador de erro mais prático será obtida através da 

substituição desta norma dual por uma quantidade equivalente e computável. 

 Para este fim, dois regimes de advecção serão considerados de acordo com a influência 

do termo advectivo: um regime de pequena advecção e um regime de grande advecção. 

4.5.1 Estimando o erro no Regime de Pequena Advecção 

 Segundo VERFÜRTH (2008), a equação de advecção-difusão-reação pode ser subdividida 

em dois regimes principais, em função dos parâmetros da equação (4.25), o regime de 

pequena advecção e o regime de grande advecção. 

 

• se ( ) 2
1

2

1

)(
0

},max{,sup 2 ???
????
&lt;?

L
Tt

tv , o regime é considerado de pequena advecção e 

• se ( ) 2
1

2

1

)(
0

},max{,sup 2 ???&gt;&gt;? ?
??

L
Tt

tv  o regime é considerado de grande advecção. 

 Baseado no campo de velocidades do fluxo de água subterrânea, os exemplos numéricos 

da seção 3.4 mostraram que o regime apropriado ao transporte de contaminantes em meio 

saturado é o regime de pequena advecção. 



 Departamento de Hidráulica e Saneamento – PPG SHS EESC USP                                     51 

 Uma vez que os problemas testes abordados neste trabalho possuem campo de 

velocidades uniforme v , a condição ?? ?? v div
2
1

 é satisfeita simplesmente se considerar 

?? = , recaindo, desta maneira, na definição dos regimes apresentado na página 23. 

 Para o regime de pequena advecção, a utilização de técnicas de estimativas inversas33 

faz com que a norma dual da equação (4.29), que é o termo crítico ( )
*

1

1

?
?

??? nnn
nn

CC
TT

v , seja 

limitada pela computável norma de energia 1
1

?
?

? nn
nn

CC
TT

definida por (4.27). 

 A obtenção dessa limitação considera a constante ?c  que aparece na desigualdade de 

Poincaré, ou seja, a constante tal que: 

( )????? ? 100         DHwwcw     (4.34). 

 Com a estimativa (4.34) e a norma de energia (4.27) válida ( )??? 1, DHwu  tem-se:  

 ( ) wcuwuwu
?
?
?

?
?
?

??&lt;??
??

?

?
2

1

2

1

2

1

00
,min.., ???vvv

 

                                              
{ } wuc .,min,1max 2

1

2

1

2

1

?
?
?

?
?
?

?
???

? ???v  

                                             { } { } wuc
cc

.,max.,1max

 

2

1
2

1

444 3444 21
?

??

?= ???v  

                                               { } wucc c .,1max ??                                                             (4.35) 
 

 Aplicando a estimativa (4.35) na definição (4.28) da norma dual, tem-se: 

( ) { } 1
*

1

11
,1max ??

?
??

????? nnc
nnn

nnnn
CCccCC
TTTT

v    (4.36) 

 E ainda, a norma de energia 1
1

?
?

? nn
nn

CC
TT

é um indicador de erro temporal [VERFÜRTH, 

2008] dado por: 

 1
1

?
?

?= nnnt nn CC TT?  ( ){ } 2
1

2

)(

1
2

)(

1    
2121 ?

?

?

?
??

?+??=
L

nn

L

nn

nnnn
CCCC
TTTT

??   (4.37) 

 Desta forma, obtém-se o seguinte estimador de erro residual para a equação parabólica 

(4.25) em regime de pequena advecção: 

                                                 

33 Se { } 212
)(

2

)(
  22 ?? +?= LL uuu ??  então wcuwu

?
?
?

?
?
?

??
??

?

?
2

1

2

1

2

1

00
,min ???      ( )??? 1, DHwu  



52                                  Metodologia 

( ) ( )[ ] 2
1

1

222

)(000 2

?
?
?

?
?
?

++?= ?
=

?

I

TI

N

n

n
t

n
nL n

CC ?????    (4.38) 

 Se o regime for o de grande advecção, estimativas inversas não limitam a norma dual. 

VERFÜRTH (2008) propõe que o erro da aproximação seja obtido também por contribuições de 

um estimador de erro para equações estacionárias de reação-difusão. Se comparado ao caso de 

pequena advecção, no regime de grande advecção é resolvido um problema elíptico discreto 

adicional, ou seja, o esforço computacional para obter o estimador de erro requer um passo de 

tempo adicional em cada nível temporal, pois é necessário determinar a solução de um 

problema auxiliar discreto estacionário da equação de reação-difusão [VERFÜRTH, 2006]. 

4.6 IMPLEMENTAÇÃO EM LINGUAGEM JAVA 

Nesta seção são descritos os procedimentos necessários para a obtenção do código 

computacional que implementa a solução FEM das equações governantes do capítulo 3 e os 

seus respectivos estimadores de erro. 

A aproximação da equação do fluxo emprega o método de Galerkin convencional e a 

aproximação da equação do transporte de contaminantes implementa o esquema S3 

(Symmetrical Streamline Stabilization) [WENDLAND E SCHMID, 2000] para a estabilização da 

solução numérica FEM, C(x,t), quando o regime do transporte de contaminantes for o de 

advecção dominante. Maiores detalhes sobre o esquema S3 são descritos no ANEXO II. 

Ambas as aproximações iniciam com a discretização do domínio ? em elementos he? . 

Estes elementos he?  serão freqüentemente descritos por simples áreas geométricas tais como 

triângulos ou quadriláteros. Os vértices destes simples objetos geométricos - os nós, possuem 

coordenadas nodais indicadas por x?  = p[i][j]. 

Um objeto p é instanciado pelo seu construtor 

Point2D[][] p = new Point2D[x.length][y.length]; 

sendo que a classe Point2D define a representação pontual da localização do nó na 

coordenada espacial (x,y). 



 Departamento de Hidráulica e Saneamento – PPG SHS EESC USP                                     53 

O nó é então criado por: 

public static Node2D createNode(Point2D p) { 
  return new Node2D(p); 
 } 

Se o elemento he?  é quadrilátero ele será criado por: 

simplices.add(new Point2D[] {p[i-1][j-1],p[i][j-1],p[i][j],p[i-1][j]}); 

Se for triangular então serão criados dois a dois por: 

simplices.add(new Point2D[] {p[i-1][j-1],p[i][j-1],p[i-1][j]}); 
simplices.add(new Point2D[] {p[i-1][j],p[i][j-1],p[i][j]}); 

A ordem da numeração global dos nós é no sentido anti-horário iniciando-se pelo nó 

inferior esquerdo (ordenação convencional utilizada no FEM). 

A discretização do domínio global ?h basicamente consiste da coleção de todos os nós e 

elementos. A geração da malha inicial e a correspondente numeração dos elementos são 

obtidas por: 

mesh = new Mesh(simplices, edges, constraintPoints); 
  mesh.enumerateElements(); 

A figura 4.6 ilustra a numeração de uma malha inicial que contém nove elementos 

quadriláteros e 16 nós. 

 

 

 

 

 

 

FIG 4.6 - Discretização do domínio global visando 
a minimização da banda das matrizes globais  

As condições de fronteira de Dirichlet, ou condições essenciais e as de Neumann, ou 

condições naturais, também fazem parte do código. Especificamente para o transporte de 

contaminantes, estas condições são impostas por: 

 
 



54                                  Metodologia 

concBC.put(node.id,solute); // poluição pontual 
concBC.put(node.id,CONCL); // poluição difusa 
flowBC.put(node.id,FLOW); // fluxo na fronteira 

sendo estes objetos criados por classes predefinidas no javadoc, ou seja,   

concBC = new HashMap&lt;Integer, Double&gt;(); 
    flowBC = new HashMap&lt;Integer, Double&gt;(); 

Esses objetos indicam se os valores armazenados correspondem às condições de 

contorno essenciais em ?D e ou às condições de contorno naturais em ?N . 

A vantagem desta metodologia POO está inserida no fato que qualquer atualização do 

código, relacionado à implementação não-estacionária, de heterogeneidades ou de uma 

possível criação de novos nós e elementos, podem ser obtidas por mudanças nas classes mais 

simples. 

Em [WORKBOOK, pg 273] cita-se a importância desta modelagem fundamentada em 

estruturas hierárquicas: 

[...] Em geral, o método de programação orientada a objetos não somente usa 
abstração para organizar dados e funções (...), ela também ajuda a classificar os 
módulos do software, os quais são objetos modelados do mundo real em uma 
estrutura hierárquica. Notemos que a classificação do pensamento em estrutura 
hierárquica é uma das mais poderosas ferramentas que o ser humano tem para a 
construção do conhecimento.  

A essência do código de elementos finitos é a formulação do elemento. A parte 

relevante da formulação variacional da equação do transporte foi discutida na seção 4.3 e a 

formulação integral da equação do fluxo encontra-se na seção 4.2. Cada equação diferencial 

parcial possui uma formulação do elemento diferente. No entanto, existe um impacto no 

código ocasionado pela mudança de um problema para outro. 

No paradigma da POO é reconhecido que uma sub-rotina elemento deva ser utilizada 

para adquirir um módulo de reposição.  E esta flexibilidade para a formulação do elemento 

pode ser obtida através do polimorfismo suportado na linguagem de implementação JAVA. 

A classe básica para grupo de nós, arestas e faces contidas no modelo é a classe pública 

FE2DAttributes. A classe FE2DFaces, do pacote Fe2d – conforme a figura 4.7, é um 

recipiente para as faces, para as montagens das matrizes globais de rigidez e de massa e é 

definida como uma extensão da classe FE2DAttributes. 

A classe FE2DFaces contém um vetor de figuras geométricas (Simplex2D) que 

correspondem aos elementos triangulares ou quadriláteros, e contém um vetor com as funções 

de forma do elemento. As funções de forma são instanciadas de acordo com a geometria do 

elemento. 



 Departamento de Hidráulica e Saneamento – PPG SHS EESC USP                                     55 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

FIG 4.7 - atributos e métodos compartilhados entre o modelo 
 computacional e a classe FE2DModel do pacote Fe2d 

A integração em cada face é determinada nos pontos de Gauss.  

Para elementos quadriláteros, quatro pontos são estabelecidos para a integração 

numérica. De acordo com [SUTRA, 2003 PG. 84], as coordenadas destes pontos são: 

?
?
?

?
?
?

??
?

?
??
?

?
???

?

?
??
?

?
??
?

?
??
?

?
???

?

?
??
?

?
??

3

1
,

3

1
,

3

1
,

3

1
,

3

1
,

3

1
,

3

1
,

3

1
, todas com peso 1. 

Para elementos triangulares, os pontos escolhidos no interior do elemento estão exibidos 

na tabela 4.1. 

A classe FE2DFaces é uma classe abstrata. 

 public abstract class FE2DFaces extends FE2DAttributes { 



56                                  Metodologia 

   Tabela 4.1 – Pontos de Gauss e os respectivos pesos sobre um triângulo 
                        Adaptado de [RATHOD et al., 2004]34 

Peso wi Coord xi Coord yi 
0,197168783 0,211324865 0,166666667 

0,197168783 0,211324865 0,622008467 

0,052831216 0,788675134 0,044658198 

0,052831216 0,788675134 0,166666667 

Os atributos e os métodos compartilhados em todas as instâncias do modelo 

computacional estão contidos na classe FE2DModel. Estas instâncias podem ser obtidas da 

combinação de: 

• caso estacionário ou caso transiente; 
• região de solo saturado ou região de solo não-saturado; 
• aqüífero livre ou aqüífero confinado e 
• implementação da equação de fluxo subterrâneo ou da equação do 

transporte de contaminantes.  

O preâmbulo da classe é: 

public class FE2DModel extends Observable { 
 protected FE2DEdges edgeAttributes; 
 protected FE2DFaces faceAttributes; 
 protected Matrix globalLoadVector; 
 protected Matrix globalMatrix; 
 protected FE2DNodes nodeAttributes; 

e a figura 4.7 detalha os atributos e métodos da classe FE2DModel. A classe ainda contém uma 

lista de simplices (triângulos ou quadriláteros), arestas e nós (com os respectivos atributos), a 

matriz global e o vetor carga da equação aproximada. 

4.6.1 Implementação da Equação do Fluxo de Água Subterrânea 

A resolução numérica do modelo matemático do fluxo horizontal de água subterrânea 

descrito na seção 4.2 e dado pela equação (4.11) pg. 39, é implementado na seguinte classe 

pública: public class FE2DModelTransient extends FE2Dmodel {. 

                                                 

34 Rathod H. T. et al, 2004 Gauss Legendre Quadrature over Triangle Journal Indian Inst. Sci., 84, 183-188. 



 Departamento de Hidráulica e Saneamento – PPG SHS EESC USP                                     57 

Os principais parâmetros da classe, a descrição e a correspondente indexação numa 

malha inicial são apresentados na tabela 4.2. 

Tabela 4.2 – Parâmetros básicos da implementação do modelo de fluxo de água subterrânea 

PARÂMETRO DESCRIÇÃO INDEXAÇÃO 

elements 
Vetor de elementos finitos 2D 
com ids de 0 a ne -1  

ne é o número de elementos 
não é permitido intervalo na numeração 
elements[i].id = i 
 

edges 
Vetor de elementos finitos 1D 
com ids de 0 a ng -1 

ng é o número de arestas 
não é permitido intervalo na numeração 
edges[i].id = i 

 

nodes Vetor de nós numerados de 0 a nn -1 

nn é o número de nós 
não é permitido intervalo na numeração 
nodes[i].id = i 

 
conductivity Vetor cujas entradas são matrizes 2x2 

de condutividade para os elementos 
 

elements[i].getConductivity () = 
conductivity[i] 

 
storage Vetor contendo os coeficientes de 

armazenamento para os elementos 
 

elements[i].getStorage() = 
storage[i] 
 

initialHeads Vetor contendo o potencial hidráulico 
inicial em cada nó da malha 

nodes[i].getInitialHead() = 
initialHead[i] 
 

concentratedLoads Vetor de cargas concentradas  
concentratedLoads. 
put(nodes.get(i).id, LOAD) 
// in the well coordinates 

 
basis 

 
Vetor de elevação da base do aqüífero 
em cada nó da malha 
 

basis.length == nodes.length 
nodes[i].getBasis() = basis[i] 
 

headBC Aplica a condição essencial se o nó 
pertence à fronteira de Dirichlet 
 

headBC.put(node.id,HEAD); 
// in Gama_D 
 

flowBC 
Aplica a condição natural se o nó 
pertence à fronteira de Neumann 

flowBC.put(node.id, FLOW); 
// in Gama_N 

package org.arena.water.gwfem2d.fe2d; 

Para comparação da solução numérica da implementação JAVA com a correspondente 

solução analítica, a figura 4.8 apresenta as linhas de comando da implementação da solução 

de Theis, considerando um aqüífero confinado, homogêneo, de características isotrópicas e 

dimensão infinita (subseção 3.1.2). 

A variável Theis é definida como sendo booleana para que a comparação entre as 

soluções seja realizada quando o propósito do cálculo é a verificação do código do fluxo 

subterrâneo. Neste caso, a variável é inicializada como verdadeira, ou seja, boolean Theis = 

true;. Caso contrário, se a implementação do código considera aqüíferos com outras 

características ou não necessita de uma verificação, a inicialização da variável é boolean 

Theis = false;. 

Em linhas gerais, a implementação da solução analítica de Theis é obtida por: 



58                                  Metodologia 

if (Theis) { 
System.out.println( 

"Node   Head [m]  Theis solution [m]  value of u    Error [m]   Distance [m]   coordinates"); 
 for (int i = 0; i &amp;lt;nc; ++i) { 
  for (int j = 0; j &amp;lt;nr; ++j) { 
   int idx = (i * nc) + j; 
   Node2D p = nodes[idx]; 
   double radius = Math.hypot(XWELL-p.x,YWELL-p.y); 
   if (radius == 0.0) radius = 0.314; // radius of well [m] 
   double u = radius*radius*SS/(4.0*TT*Step); 
   double Wu=0; 
   if (u&lt;=1){ 
     Wu = (-0.57721566-Math.log(u)+0.99999193*u 
          -0.24991055*Math.pow(u,2)+0.05519968*Math.pow(u,3) 
          -0.00976004*Math.pow(u,4)+0.00107857*Math.pow(u,5)); 
   } 
   if (u&gt;1){ 
     Wu = (Math.pow(u,4)+8.5733287401*Math.pow(u,3) 

     +18.059016973*Math.pow(u,2) +8.6347608925*u+0.267773743) 
     /(Math.pow(u,4)+9.5733223454*Math.pow(u,3) 

         +25.6329561486*Math.pow(u,2) 
     +21.0996530827*u+3.9584969228)/(u*Math.pow(Math.E,u)); 

   } 
   double drawDown = LOAD/(4.0*Math.PI*TT)*Wu; 
   double theisSolution = HINIT+drawDown; 
   double error = heads[idx]-theisSolution; 
   System.out.print(df1.format(idx) + "      " + df.format(heads[idx])); 
   System.out.print("        "+ df.format(theisSolution) +"        "+  
          df.format(u)+ "        "+ df.format(error)); 
   System.out.println("         "+ df.format(radius) +"      (" +  
          df1.format(p.x) + ";" + df1.format(p.y) + ")"); 
  } 
 } 
 Step = Step + timeStep; 
} 

FIG 4.8 – Linhas de comando da implementação JAVA  
da solução analítica de Theis contidas em  

package org.arena.water.gwfem2d.flow2d.tests; 

4.6.2 Implementação do Estimador para a Equação do Fluxo 

O estimador de erro a posteriori para a equação do fluxo de água subterrânea emprega 

as técnicas de recuperação do gradiente, descritas na subseção 4.2.2. 

Quando código é iniciado pelo método JAVA descrito na figura 4.9, estabelece-se uma 

interface com a classe pública FE2DModelTransientZZ responsável pela determinação do 

erro numérico de acordo com as técnicas clássicas apresentadas por ZIENKIEWICZ e ZHU 

(1992). 
public void run() { 
 ArrayList&lt;Simplex2D&gt; elements = mesh.getElements(); 
 FE2DModelTransientZZ flowModel = new FE2DModelTransientZZ( 
new FL2DFacesTransientConfined(elements.toArray(new Simplex2D[elements.size()]), 
transmissivity, storage), new FL2DEdges(null),new FL2DNodesConfined(nodes.toArray( 
new Node2D[nodes.size()]),initialHeads, basis),concentratedLoads, headBC, flowBC); 
 flowModel.addObserver(this); 
 flowModel.setCalculationTime(time, timeStep); 
 flowModel.solve(); 
} 

FIG 4.9 – Interface entre a classe pública FE2DModelTransientZZ  
e as demais definições para o cálculo da solução numérica  

estabelecida no inicio do código pelo método run() 



 Departamento de Hidráulica e Saneamento – PPG SHS EESC USP                                     59 

Desta forma, a cada passo de tempo, o potencial hidráulico do modelo de entrada é 

calculado e, se os elementos da malha são quadriláteros, o gradiente hidráulico é determinado 

pela rotina apresentada na figura 4.10, que implementa a equação (4.16). 

for (int i = 0; i&lt;n ; i++) { 
     int nodeID = sNodes[i].id; 
     double head = nodesHeads[nodeID]; 
  gradu_x += (0.5)*(Math.pow(-1.0, (2*i+1)%3))*head; 
  gradu_y += (-0.5)*(Math.pow(-1.0, (2*i+2)%5))*head; 
}  
det[elemID] = 2.0*ex*ey; 
gradu[elemID] = new Point2D.Double(gradu_x, gradu_y); 
 

FIG 4.10 – Rotina JAVA para determinar, em cada elemento da malha, 
 o gradiente hidráulico descrito na equação (4.16) 

Após a determinação do gradiente hidráulico nos elementos da malha, o erro da solução 

numérica é calculado, em cada passo de tempo, pela classe pública ZZ. A figura 4.11 

especifica a rotina JAVA destinada à determinação do erro numérico da equação do fluxo. 

for (Simplex2D s : simplices) {Node2D[] sNodes = s.getPoints(); 
 int n = sNodes.length; 
 Point2D.Double sxy = new Point2D.Double(); 
 for (int i = 0; i&lt;n ; i++) { 
  Point2D.Double p = aver_grad[sNodes[i].id]; 
  sxy.setLocation(sxy.x + p.x, sxy.y + p.y); 
 } 
 Point2D.Double ssxy = new Point2D.Double(); 
 for (int i = 0; i&lt;n ; i++) { 
  Point2D.Double p0 = aver_grad[sNodes[i].id]; 
  Point2D.Double p1 = aver_grad[sNodes[(i+1)%n].id]; 
  sxy.setLocation(sxy.x + (p0.x * p0.x), sxy.y + (p0.y * p0.y) ); 
  sxy.setLocation(sxy.x + (p0.x * p1.x), sxy.y + (p0.y * p1.y) ); 
 } 
 int elemID = s.id; 
 double area = 0.5*det[elemID]; 
 Point2D.Double p = gradu[elemID]; 
 Point2D.Double grad = new Point2D.Double (p.x / det[elemID], p.y / det[elemID]); 
 double error = area*( grad.x * grad.x + grad.y * grad.y + 
   (1./6.)*(ssxy.x+ssxy.y) - (2./3.)*(sxy.x*grad.x + sxy.y*grad.y)); 
  
       error = Math.sqrt(Math.abs(error)); 
        
       if( error &gt; etamax ){ 
     etamax = error; 
     IDmax = elemID; 
       } 
       if(error &amp;lt;etamin){ 
           etamin = error; 
    IDmin = elemID; 
       } 
 etasumm += error; 
 etaquad += (error * error); 
 eta[elemID] = error; 

} 
FIG 4.11 – Rotina JAVA para calcular o erro numérico ZZ  

da equação do fluxo em cada elemento da malha 

A verificação e aplicação do estimador de erro a posteriori para a equação do fluxo são 

apresentadas no ANEXO III [FIRMIANO e WENDLAND, 2009]. 



60                                  Metodologia 

4.6.3 Implementação da Equação do Transporte de Contaminantes 

A reusabilidade da POO para o transporte de contaminantes emerge naturalmente da 

abstração e modularidade da implementação FEM do fluxo das águas subterrâneas35.  

Uma vez que a herança POO disponibiliza partes comuns para a definição de uma classe 

básica mais geral na hierarquia de classes, os arquivos do pacote transport2D: 

TP2DModel.java e TP2DFacesTransient.java seguem, respectivamente, como extensões 

das classes FE2DModelTransient.java e FE2DFaces.java do pacote FE2D. Ou seja: 

public class TP2DModel extends FE2DModelTransient { 

e 

public class TP2DFacesTransient extends FE2DFaces { 

As classes do pacote Transport2D obtêm a solução numérica da equação parabólica 

(4.25) do transporte de contaminantes descrita na seção 4.3. 

A herança POO é utilizada na geração e orientação dos nós e elementos da malha do 

domínio discretizado; na montagem (assembling) das matrizes de massa, de rigidez e do vetor 

de cargas nodais para a equação do transporte, e ainda, na implementação do esquema S3 

(Symmetrical Streamline Stabilization) [WENDLAND E SCHMID, 2000] (ANEXO II) para a 

estabilização da solução numérica FEM, C(x,t), quando o regime do transporte de 

contaminantes for de advecção dominante [NATVIG et al.,  2007]. 

Os principais parâmetros das classes públicas: TP2DModel e TP2DFacesTransient, e 

suas correspondentes descrições são apresentados na tabela 4.3. Com as extensões descritas 

acima, os atributos dos parâmetros da tabela 4.2 (com exceção de conducivity e storage) 

são herdados da classe FE2DModelTransient. 

Inicialmente a implementação poderia considerar um aqüífero confinado cuja curva de 

rebaixamento encontra-se em regime permanente. No entanto, o fluxo de velocidades 

proveniente da implementação da subseção (3.1.1) seria útil para compor os dados de entrada 

para a resolução da equação do transporte de contaminantes. 

 

                                                 

35 Maiores detalhes sobre reusabilidade, abstração, modularidade e herança POO para o método dos elementos 
finitos são encontrados em [ZEILER, 1999], [AKIN e SINGH, 2002] ou [HEIMSUND, 2005]. 



 Departamento de Hidráulica e Saneamento – PPG SHS EESC USP                                     61 

Tabela 4.3 – Parâmetros básicos da implementação do modelo de transporte de contaminantes 

PARÂMETRO DESCRIÇÃO INDEXAÇÃO 
 

dispersivity Vetor cujas entradas são matrizes 2x2 
das dispersividades para os elementos 

 
dispersivity[i] = new Matrix(new 
double[][]{{Dx,Dxy},{Dxy,Dy}}); 
 

velocity 
 

Vetor 2D contendo a velocidade real 
do fluxo de água subterrânea em cada 
elemento finito da malha. 
 

velocity[i] = new Matrix(new 
double[][]{{Vx,Vy}}); 
 

 

porosity Vetor 1D de valores da porosidade 
efetiva do solo. 
 

porosity[i] = poro; 
//uniform value 

 
lambda Escalar que implementa o termo de 

decaimento de 1ª. ordem. 
 

public double getLambda() { 
return lambda; 

 
theta Escalar da aproximação temporal. 

 
this.setTheta(1.0/2.0); 
//Crank-Nicolson 

 
package org.arena.water.gwfem2d.transport2D 

4.6.4 Implementação de uma solução analítica para o problema do transporte 

A verificação da solução numérica da equação do transporte conta com as seguintes 

hipóteses sobre o aqüífero em estudo: 

• o aqüífero possui extensão infinita e a fonte não pontual de 

contaminação tem comprimento finito; 

• a densidade e a viscosidade do fluido são constantes; 

•  o contaminante está sujeito a transformação química de primeira ordem 

(se o contaminante é conservativo, então ? = 0); 

• o fluxo uniforme ocorre na direção x com velocidade constante v; 

• os coeficientes de dispersão longitudinal e transversal (Dx, Dy) são 

constantes. 

Essas restrições visam a comparação da solução JAVA da equação do transporte de 

contaminantes com uma solução analítica 2D disponível na literatura [WEXLER,1992]. 

As condições iniciais e de contorno para obter a solução analítica do transporte de 

contaminantes em aqüíferos, que obedecem às considerações acima, são dadas por: 

 

 



62                                  Metodologia 

C = C0,                       x = 0 e Y1 &amp;lt;y &amp;lt;Y2 

C = 0,                         x = 0 e y &amp;lt;Y1 ou y &gt; Y2 

±?==
?
?

= y
y

C
C          ,0   ,0  

?==
?
?

= x
x

C
C          ,0   ,0  

sendo Y1 a ordenada do limite inferior da fonte de contaminante em x = 0 e  

          Y2 a ordenada do limite superior da fonte de contaminante em x = 0. 

Assim, segundo WEXLER (1992) a solução analítica 2D é expressa por: 

( ) dZ
DZ

yY
erfc

DZ

yY
erfce

Z
e

D

xC
tyxC

t

yy

ZD

x
Z

D

v

D

vx

x

xxx

?
??

?
?
?

??

?
?
?

?
?
?

?

?
?
?

? ?
?

?
?
?

?

?
?
?

? ?
= ?

?
?

?

?
?
?

?
?

?
?
?

?
?
?
?

?
+??

?

?
?
?

? 4
1

4

2
4

2
    

0
2

2
2

144

3

20

22

1
,,

?

?
 (4.39) 

O termo referente à integral da solução acima é aproximado pela fórmula de translação 

Gauss-Legendre36, ou seja, por: 

?

??

=

?

?
?

?
?
?

? ?+
+?

?

?
?
?

?
?
?

? ?+
+

=

N

k
kNkN

b

a

x
abba

f
ab

dx
ab

x
abba

fdttf

1
,,

1

1

222
               

222
)(

?

   (4.40) 

sendo kNx ,  as n raízes do polinômio de Legendre e kN ,?  os respectivos pesos. 

Na implementação computacional adotou-se n = 8. 

A função especial, a função erro complementar )( xerfc , que aparece na solução 

analítica 2D, é dada por: 

?
?

?=?=
x

t dtexerfxerfc
22

)(1)(
?

     (4.41) 

sendo ( ) ( )?
?

=

+

+
?=

0

12

12!
1

2
)(

n

n
n

nn

x
xerf

?
 a função erro que goza das propriedades: 

                                                 

36 Mathews J. H., Fink K. K. Numerical Methods Using Matlab, Prentice Hall Inc, New Jersey, USA 2004, 



 Departamento de Hidráulica e Saneamento – PPG SHS EESC USP                                     63 

1)( =?erf  e )()( xerfxerf ?=?     (4.42) 

A figura 4.12 ilustra as linhas de comando que implementam a função erro 

complementar )( xerfc . 

private static double erfc(double x) { 
 double errorFunction = 0; 
 double fat = 1; 
 if (x &gt;= 0.0 &amp;amp; x&amp;lt;= 4.895){ 
  for(int i=0; i&lt;100; ++i){ 
   if (i&gt;0) fat = fat*i; 
   errorFunction += (2.0/(Math.pow(Math.PI,0.5)*(2*i+1))) 

 *Math.pow(-1,i)*Math.pow(x,2*i+1)/(fat); 
  } 
  return 1.0-errorFunction; 
 } 
 else if (x &amp;lt;0.0 &amp;amp; x &gt;= -4.895) return 2-erfc(-x); 
      else if (x &gt; 4.895)return 0.0; 

   else return 2.0; 
} 

FIG 4.12 – Implementação da função erro complementar  
                    e o correspondente gráfico gerado pelo MAPLE 12 

A figura 4.13 exibe as linhas de comando da implementação JAVA da solução analítica 

(4.41) nos referidos pontos de Legendre. 

if (AnalyticalSolution){ 
    double[] legendrePoint; // 8 pontos de Legendre para integração numérica 
    double[] legendreWeight; // 4 pesos de Legendre para integração numérica 
    legendrePoint = new double[] {-0.1834346424956498049394761,-0.5255324099163289858177390, 
      -0.7966664774136267395915539, -0.9602898564975362316835609, 0.1834346424956498049394761, 
       0.5255324099163289858177390, 0.7966664774136267395915539, 0.9602898564975362316835609}; 
    legendreWeight = new double[] {0.3626837833783619829651504, 0.3137066458778872873379622, 
       0.2223810344533744705443560, 0.1012285362903762591525314, 0.3626837833783619829651504,  
       0.3137066458778872873379622, 0.2223810344533744705443560, 0.1012285362903762591525314} 
    tt = tt + timeStep; 
    double limSup = Math.pow(tt,0.24)/2; // b/2 da aproximação da integral 
    double Y1 = YWELL-Ymed*YWELL/Math.pow(2, stepRef); 
    double Y2 = YWELL+Ymed*YWELL/Math.pow(2, stepRef); 
    DecimalFormat df1 = new DecimalFormat("##.#########"); 
    for (int i = 0; i &amp;lt;nc; ++i) { 
 for (int j = 0; j &amp;lt;nr; ++j) { 
  int idx = (i * nc) + j; 
  Node2D p = nodes[idx]; 
  double cx = p.x; 
  double cy = p.y; 
  double integral = 0; 
  for (int k = 0; k &amp;lt;legendrePoint.length; ++k){ 
   double Z = limSup*(legendrePoint[k]+1); // Variável de Integração 
   integral += legendreWeight[k]/Math.pow(Z, 3)*Math.exp(-(Vx*Vx/(4*Dx) 

            +lambda)*Math.pow(Z, 4)-cx*cx/(4*Dx*Math.pow(Z, 4))) 
            *(erfc((Y1-cy)/(2*Z*Z*Math.pow(Dy, 0.5))) 
            -erfc((Y2-cy)/(2*Z*Z*Math.pow(Dy, 0.5)))); 

  } 
  double conc2D = solute/Math.pow(Math.PI*Dx, 0.5)*cx 
     *Math.exp(Vx*cx/(2*Dx))*limSup*integral; 
  double  error = conc2D - concs[idx]; 
     concs[idx] = conc2D;  // Imprimir só a solução analítica 
  System.out.print(df.format(concs[idx]) + ";"); 
 } 
   } 
} 

FIG 4.13 – Implementação JAVA de uma solução analítica 2D 
para o transporte de contaminantes em água subterrânea 



64                                  Metodologia 

4.6.5 Resultado Numérico versus Solução Analítica 

Nesta subseção é apresentada uma solução numérica sobre uma malha inicial de 1024 

elementos quadriláteros dispostos sobre 1089 nós e com grau de liberdade37 igual a 1056. A 

finalidade encontra-se na comparação da solução numérica com a respectiva solução analítica. 

Os valores de entrada do modelo numérico da migração de contaminantes através de um 

aqüífero situado em Long Island, N.Y. estão disponíveis em PINDER [1973 apud WEXLER, 

1992]38. Estas variáveis são: 

Limite inferior da fonte de contaminante Y1 = 635 m 

Limite superior da fonte de contaminante Y2 = 865 m 

Velocidade da água subterrânea v = 1,42 m /dia 

Dispersividade longitudinal ?L = 70 m 

Dispersividade transversal ?T = 14 m 

Fonte de concentração inicial C0 = 40 mg/L 

 A distância entre as fronteiras laterais é suficiente para que a área de interesse 

considere o aqüífero como sendo de comprimento infinito. Para os valores acima, os termos 

da dispersão são dados por: 

Dispersão na direção x Dx = 100 m
 2/d 

Dispersão na direção y Dy =  20 m
 2/d 

 As concentrações determinadas pela solução analítica (4.41) estão distribuídas na 

figura 4.14 (a) ao considerar um domínio de extensões retangulares iguais a 3.000 m por 

1.500 m e 5 anos de simulação (t = 1.826 dias). 

A mesma simulação numérica foi implementada no código JAVA de modo que as 

concentrações obtidas são apresentadas na figura 4.14 (b). 

 

 
                                                 

37 Uma vez que condições iniciais e de contorno foram impostas em 33 nós da fronteira esquerda do domínio 
retangular, as bibliotecas disponíveis no JAMA resolveram o sistema de equações lineares de ordem 1056x1056 
utilizando o método direto de Decomposição LU. O Método de Cholesky também faz parte do JAMA. 
 
38 Pinder, G.F., 1973, A Galerkin-finite element simulation of groundwater contamination on Long Island,  
         New York Water  Resources Research, v. 9, no. 6, p. 1657-1669. 



 Departamento de Hidráulica e Saneamento – PPG SHS EESC USP                                     65 

        (a) solução analítica      (b) solução numérica 

 

 

 

FIG 4.14 – Distribuição da concentração de contaminantes  
obtidas pela solução analítica e pela solução numérica 

Evidentemente, a frente de contaminação da solução numérica (b) apresenta um atraso 

bastante considerável. A observação desta discrepância só foi possível com a disponibilização 

de uma solução analítica (a). No entanto, para a maioria dos problemas de transporte de 

contaminantes em água subterrânea, em função de heterogeneidades, anisotropias e domínios 

com formas irregulares, soluções analíticas não estão disponíveis na literatura. Este fato 

remete à grande importância do estudo dos estimadores de erros a posteriori para análise e 

verificação da qualidade da solução numérica de uma equação parabólica. 

4.6.6 Implementação do Estimador de Erro Residual 

Semelhante ao que foi apresentado para a equação do fluxo, o estimador residual para a 

equação do transporte de contaminantes é obtido pela interface com a classe pública 

FE2DModelTransientRESIDUAL , conforme a figura 4.15. 

public void run() { 
 ArrayList&lt;Simplex2D&gt; elements = mesh.getElements();   
 FE2DModelTransientRESIDUAL concModelRes = new FE2DModelTransientRESIDUAL( 
 new TP2DFacesTransient(elements.toArray(new Simplex2D[elements.size()]), 
     lambda, dispersivity, velocity), 
 new FL2DEdges(null), 
 new FL2DNodesConfined(nodes.toArray(new Node2D[nodes.size()]), initialConcs, 
    basis), concentratedLoads, concBC, flowBC); 
 concModelRes.addObserver(this); 
 concModelRes.setCalculationTime(time, timeStep); 
 concModelRes.solve(); 
} // fim run 

FIG 4.15 – Interface entre a classe pública FE2DModelTransientRESIDUAL  
e as demais definições para o cálculo da solução numérica  
estabelecida no inicio do código pelo método run(). Os dois  
métodos são mantidos para futuros testes de eficiência do 

estimador de erro residual da equação do transporte. 



66                                  Metodologia 

O estimador baseado na recuperação do gradiente será empregado na solução numérica 

da equação do transporte para futuras comparações com os resultados obtidos pelo estimador 

residual em regime de pequena advecção. No entanto, estratégias adaptativas serão realizadas 

com o estimador residual, que é adequado à característica parabólica da equação (4.25). 

Para verificação do tipo de regime de transporte, conforme descritos na subseção 4.5.1, 

o cálculo do menor autovalor da matriz de dispersão D2x2 é realizado na classe JAVA inicial 

que fornece os dados de entrada para o código (figura 4.16). 

A determinação dos autovalores da matriz D2x2 = ??
?

?
??
?

?

DyDxy

DxyDx
 é realizado com a 

implementação de um cálculo direto feito por: 

eigenValue1 = (Dx+Dy+Math.sqrt((Dx-Dy)*(Dx-Dy)+4*Dxy*Dxy))/2.0; 
eigenValue2 = (Dx+Dy-Math.sqrt((Dx-Dy)*(Dx-Dy)+4*Dxy*Dxy))/2.0; 

sendo Dx, Dy e Dxy as respectivas dispersões direcionais. 

private double menorAutovalor() { 
  double eigenValue1 = 0.0; 
  double eigenValue2 = 0.0; 
  double diameterhk = Math.hypot(DeltaX, DeltaYY); 
  double regime = 0.0; 
  double alphaK = 0.0; 
  eigenValue1 = (Dx+Dy+Math.sqrt((Dx-Dy)*(Dx-Dy)+4*Dxy*Dxy))/2.0; 
  eigenValue2 = (Dx+Dy-Math.sqrt((Dx-Dy)*(Dx-Dy)+4*Dxy*Dxy))/2.0; 
  if (eigenValue1 &gt; eigenValue2)eigenValue1 = eigenValue2; 
  alphaK = Math.min(diameterhk*Math.pow(eigenValue1,-0.5), 
                        Math.pow(reaction,-0.5)); 

regime = Math.pow(eigenValue1,0.5)* 
         Math.max(Math.pow(eigenValue1,0.5),Math.pow(reaction,0.5)); 

   
  return alphaK; 

} 

FIG 4.16 – Classe que retorna o menor autovalor da matriz de dispersão 

O estimador de erro determinado pelo elemento residual (4.30) inserido na equação 

(4.38) é implementado na classe privada elementResidual cujas principais linha de comando 

estão descritas na figura 4.17. Neste método também é feito o balanço de massa tanto no nível 

do nó, quanto no nível do elemento, utilizando as funções de base. Este balanço determina a 

quantidade de contaminante na malha atual e compara com a quantidade calculada no passo 

de tempo anterior. 

A cada iteração, os valores das concentrações concs[idx] determinadas são 

armazenadas no vetor concInit[idx], sendo o parâmetro inteiro idx o número da 

identificação do nó do elemento finito. Após a utilização no cálculo do estimador de erro dos 



 Departamento de Hidráulica e Saneamento – PPG SHS EESC USP                                     67 

valores das concentrações no instante anterior, é realizada a atualização do vetor que 

armazena as concentrações atuais, ou seja,  concInit[idx]:= concs[idx]. 

for (Simplex2D s : simplices) { 
int elemID = s.id; 

 Node2D[] sNodes = s.getPoints(); 
 int n = sNodes.length; 
 double gradu_x = 0.0; 
 double gradu_y = 0.0; 
 double divResidual = 0.0; 
 double[] concElement = new double[n]; 
 double RESIDUO; 
 double residuoGauss = 0.0; 
 double[] massNode = new double[n];//variáveis para determinar a conservação 
                      //de massa no nível do nó 
 for (int i = 0; i &amp;lt;n; i++) { 
  int nodeID = sNodes[i].id; 
  double conc = theta*concs[nodeID]+(1-theta)*concInit[nodeID]; 

concElement[i] = -1.0*reaction*(conc-(concs[nodeID]- 
                  concInit[nodeID])/timeStep); 

  gradu_x += (0.5) * (Math.pow(-1.0, (2 * i + 1) % 3)) * conc; 
  gradu_y += (-0.5) * (Math.pow(-1.0, (2 * i + 2) % 5)) * conc; 
  divResidual += 2*Dxy*Math.pow(-1.0, i) * conc; 
  massNode[i] = concs[nodeID]-concInit[nodeID]; //Qtde. de massa a cada time step 
 } 
 RESIDUO = 0.0; 
   
 for (int j = 0; j &amp;lt;n; j++) {//CÁLCULO NOS PONTOS DE GAUSS 
  double csi = Math.sqrt(3.0)/3.0; 
  double eta = Math.sqrt(3.0)/3.0; 
   csi = (Math.pow(-1.0, (2 * j + 1) % 3)) * csi; 
   eta = -1.0*(Math.pow(-1.0, (2 * j + 2) % 5)) * eta; 
  double phi0 = 0.25*(1-csi)*(1-eta); 
  double phi1 = 0.25*(1+csi)*(1-eta); 
  double phi2 = 0.25*(1+csi)*(1+eta); 
  double phi3 = 0.25*(1-csi)*(1+eta); 
  baseFunction =  new double[] {phi0, phi1, phi2, phi3}; 
    
  for (int k = 0; k &amp;lt;n; k++) { 
   RESIDUO += baseFunction[k]*concElement[k]; 
   massElem += baseFunction[k]*massNode[k]; //massa no nível do elemento 
  } 

residuoGauss += (RESIDUO+divResidual-(Vx*gradu_x+Vy*gradu_y))* 
                 (RESIDUO+divResidual-(Vx*gradu_x+Vy*gradu_y)); 
 } 
 gradu[elemID] = new Point2D.Double(gradu_x, gradu_y); 
 resQuad[elemID] = residuoGauss*alphaQuad; 
}// fim for simplex2D 

FIG 4.17 – Obtenção da contribuição espacial para o erro residual 
 da equação parabólica do transporte de contaminantes 

4.7 GERAÇÃO DE MALHAS 

A geração da malha inicial de elementos finitos contribui significativamente para a 

precisão e confiabilidade da solução numérica da equação diferencial parcial do modelo. 

Neste trabalho foram utilizadas duas técnicas distintas para a geração automática de malhas. 



68                                  Metodologia 

Para a equação do fluxo subterrâneo foi utilizada uma malha retangular, com o mesmo 

número de nós na direção x e na direção y.  

Os valores de entrada para esta malha são: 

• Xmin e Ymin – valores mínimos em cada direção; 

• Xmax e Ymax – valores máximos em cada direção; 

• stepRef – parâmetro de bipartição dos sub-intervalos de [Xmin , Xmax] e [Ymin , Ymax]. 

Após serem fornecidos, o código cria 2k+1 subintervalos com k = stepRef  bipartições e 

instancia as seguintes variáveis médias 
2

minmax XXX well
?

=  e 
2

minmax YYYwell
?

= . Esses valores 

são utilizados no cálculo do número de Peclet e o do número de Courant ao definir o tamanho 

da malha avaliado na direção x e y por 
k

wellXx
2

=?  e 
k

wellYy
2

=?
 
, conforme ilustrado na figura 

4.18. 

Xmin       Xwell        Xmax 

Ymin                

                

                

                

                

                

Ywell                

                

                

                

                

                

                

                

Ymax                

 
FIG 4.18 – Exemplo de malha inicial para a 

equação do fluxo subterrâneo com stepRef = 3 

Para o transporte de contaminantes, a estratégia de geração da malha inicial sofre uma 

pequena alteração na direção x em função de uma variável chamada delay. A mesma 

quantidade de nós da malha para a equação do fluxo é mantida para a equação do transporte, 

porém a sua distribuição terá outra metodologia. Nesta estratégia, os nós da malha podem ser 

movidos pelo usuário em função do valor atribuído para a variável delay. Uma vez que a 

pluma de contaminação avança da fronteira esquerda para a fronteira direita do domínio 

retangular, fez-se necessário o uso de uma malha inicial com elementos mais refinados nas 

proximidades da fonte de contaminação. A figura 4.19 ilustra a malha da estratégia 2. 



 Departamento de Hidráulica e Saneamento – PPG SHS EESC USP                                     69 

   Xwell    Xmax 

        

        

        

        

        

        

        

 
FIG 4.19 – Exemplo de malha inicial para a equação do transporte 

 com stepRef = 2 e delay = 30% 

O cálculo do número de Peclet e do número de Courant será baseado no tamanho da 

malha dado por i
x

xx
i

?=?
??

maxˆ  e determinado, neste caso, pela expressão: 

( ) 11
2

ˆ ++=? k
k

well delay
X

x     (4.43) 

Para o valor da variável delay = 0,0 %, a estratégia 2 fornecerá o refinamento uniforme 

apresentado inicialmente para o domínio da equação do fluxo. Para valores negativos do delay 

o modelo fornecerá um avanço nos elementos da malha de forma que a maior concentração 

dos elementos esteja na fronteira direita da malha quadrangular. 

Segundo [YANG e MAVRIPLIS, 2008] o objetivo de uma estratégia adaptativa é aumentar 

a eficiência do código numérico, ou seja, obter a máxima redução do erro por unidade de 

custo computacional. Outros tipos de estratégias adaptativas são apresentados: 

• O refinamento h – que envolve o aumento/diminuição do número de elementos 

com o refinamento/desrefinamento da malha. 

• O refinamento p – que envolve o aumento/diminuição do grau do polinômio 

interpolador das funções de base. 

• O refinamento r – que envolve o movimento dos nós da malha e ajustes no 

tamanho do elemento para obter uma melhor resolução. A vantagem desta 

estratégia, que não aumenta o grau de liberdade do método numérico, situa-se na 

sua facilidade de implementação. 

A combinação entre estas estratégias também é possível para obter, por exemplo, o 

refinamento hp ou refinamento hr. 

A estratégia que modifica a malha inicial, conforme ilustrada na figura 4.9, é um caso 

particular do refinamento r. E a malha que empregar este tipo de adaptação será referenciada 

neste trabalho por malha deformada. 

 



70                                  Metodologia 

4.8 CONSIDERAÇÕES DO CAPÍTULO 4 

O processo de discretização introduz outros tipos de erros provenientes de várias fontes, 

tais como: erros de arredondamento, erros de truncamento, erros da representação discreta 

devido aos recursos limitados do computador e erros obtidos com a acumulação sistemática 

da metodologia de certos métodos numéricos (interpolação, integração numérica, etc.). 

Uma maneira de apresentar uma solução com a devida redução nas respectivas fontes 

de erros poderia ser através da implementação sobre malhas mais finas, empregando mais 

elementos finitos e aumentando o número de funções de base, enquanto o passo de tempo 

diminui. Em outras palavras, deve-se implementar um esquema que exige uma capacidade 

cada vez maior em relação a memória e velocidade dos computadores que hospedam os 

complexos códigos numéricos. 

Uma vez que, através dos anos, os modelos numéricos e as diversas simulações foram 

significadamente beneficiados com um aumento contínuo na memória e na velocidade do 

computador, a otimização destes recursos tornou-se uma atividade viável. 

Considerando que a velocidade pode ser mensurada pelo número de operações por 

segundo com pontos flutuantes – MFLOPS (million floating point operations per second), a 

declividade na figura 4.20 para os computadores pessoais (PC´s) demonstra que o aumento na 

velocidade de processamento é da ordem de 10 MFLOPS a cada 4 anos. 

 

 

 

 

 

 

 

 

 

 

 

 

FIG 4.20 – Performance do computador através dos anos 
             Adaptado de [OTTO, 2007 pg. 19] 

 



 Departamento de Hidráulica e Saneamento – PPG SHS EESC USP                                     71 

Uma evolução similar ao gráfico acima é observada para o aumento de memória dos 

atuais computadores [OTTO, 2007]. 

Outros benefícios observados com a crescente capacidade de armazenamento de dados 

e da velocidade de processamento residem no emprego dos métodos indiretos na resolução 

dos imensos sistemas algébricos resultantes do código numérico. 

Esses métodos indiretos, tais como o algoritmo que implementa o gradiente conjugado 

pré-condicionado para operadores simétricos, ou os algoritmos Multigrid, que são baseados 

em uma sequência de malhas obtidas por refinamento sucessivo, necessitam de uma grande 

quantidade de memória computacional e de operações aritméticas proporcionais tanto ao grau 

de liberdade do problema numérico quanto ao tamanho da faixa da matriz de banda 

determinadas nas matrizes globais do sistema. 

De forma geral, as limitações devido às restrições dos recursos computacionais também 

são amenizadas com a crescente evolução tecnológica. Isto significa que, no processo de 

aproximação física ou numérica, as fontes de erros citadas no início desta seção podem ser 

negligenciadas em função dos testes realizados e da metodologia empregada. 

 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 



72                                  Metodologia 

  



5 RESULTADOS E DISCUSSÃO 

Para análise do estimador de erro residual são apresentados processos do transporte de 

contaminantes, em meio poroso saturado e homogêneo, cujo regime é predominantemente 

advectivo. A técnica empregada na solução JAVA para evitar o surgimento de concentrações 

negativas e oscilações espúrias é o esquema Symmetrical Streamline Stabilization (S3) 

[WENDLAND e SCHMID, 2000] (ANEXO II). 

Visando a verificação da solução numérica do código JAVA com a correspondente 

solução numérica obtida por WENDLAND e SCHMID (2000) com o esquema S3, é simulado um 

vazamento de contaminante conservativo de um depósito em uma região de seção retangular 

de 100m de comprimento e 40m de largura, conforme a figura 5.1. 

 
FIG 5.1 – Geometria do problema teste para o esquema S3 

adaptado de [WENDLAND, 2004] 

A fonte de contaminante está localizada na entrada de fluxo e os parâmetros físicos para 

o meio poroso são definidos de forma a estabelecer uma velocidade de fluxo de 1,0 m/s. As 

condições de contorno consistem de concentração normalizada ? ???? no lado esquerdo do 
domínio e condições homogêneas de Neumann nas demais fronteiras para especificar fluxo 

nulo de soluto através do contorno. A concentração inicial é ?? = 0 no interior do domínio ?. 
A discretização espacial da malha considera ?
 = ?? = 0,5?. A discretização temporal 

emprega ?? = 1,0? com instante final ?? = 50?, a formulação de integração consistente e o 
esquema de Euler implícito (? = 1,0). O número de Courant é ?? = 2,0. 

Os coeficientes de dispersão longitudinal e transversal são, respectivamente, 

?? = 0,02??/? e ?? = 0,002??/?, caracterizando o regime de advecção dominante, pois o 



74                                  Resultados 

número de Peclet é ??? = 25. Neste problema parabólico em que o transporte é dominado 
por advecção, dificuldades são esperadas devido à dispersão numérica, pois, critérios de 

estabilidades não foram respeitados. 

Em razão da simetria da solução da equação (4.25), a figura 5.2 apresenta a frente de 

contaminação na metade superior do domínio computacional que foi obtida considerando: 

a.)  solução analítica dada por LEIJ e DANE apud WENDLAND e SCHMID 200039; 

b.)  solução numérica que emprega o esquema S3; 

c.)  solução tradicional de Galerkin e 

d.)  solução numérica implementada no código JAVA. 

        (a) 

 

 

 

 

        (b) 

 

 

 

        (c) 

 

 

 

        (d) 

 

                                                        9.5         0.5           0.1              JAVA 

 

FIG 5.2 – Comparação entre os esquemas de solução numérica da equação do  
transporte de contaminantes em regime de advecção dominante. Os gráficos 

(a), (b) e (c) foram adaptados de [WENDLAND e SCHMID, 2000] e o gráfico 
(d) foi obtido com a importação dos dados para o software Maple 12 

                                                 

39Leij F. J. e Dane J. H. Analytical Solution of the One-Dimensional Advection Equation and Two- or 
Three- Dimensional Dispersion Equation, Water Resour. Res., 26(7), 1475-1482, 1990. 



    Departamento de Hidráulica e Saneamento – PPG SHS EESC USP                                 75 

Comparado com a solução analítica, verifica-se um maior espalhamento longitudinal 

nos três esquemas numéricos. Para o esquema de Galerkin é observado concentrações 

negativas fora da área da pluma e o maior espalhamento na frente de avanço do contaminante. 

Verifica-se ainda uma boa concordância entre a solução do código JAVA (d), a solução 

do esquema S3 (b) e a correspondente solução analítica (a) da equação do transporte (4.25), 

revelando que o código computacional encontra-se adequadamente implementado. 

5.1 VERIFICAÇÃO DO ESTIMADOR RESIDUAL 

Para a verificação do estimador de erro residual, da equação do transporte de 

contaminantes, é implementada uma fonte contendo o elemento 90Sr (Estrôncio-90)40 que 

migra facilmente de um armazenamento de resíduos radioativos para um aqüífero confinado.  

A solução numérica é comparada com a solução analítica de WEXLER (1992), dada pela 

equação (4.41) da subseção 4.6.6, e as variáveis do modelo de transporte são as apresentadas 

na tabela 5.1. 

Como visto na subseção 4.5.1, para um contaminante cujo coeficiente de decaimento de 

primeira ordem, ? ? 0, que não supera o valor de ? &gt; 0, o menor autovalor da matriz de 
dispersão D, a pequena advecção será caracterizada quando |v| ? ?" ? #$?%
&amp;amp;?, '(#$ ? ?" ?, 
sendo ?" ? |*|+  uma constante característica de tamanho moderado. 

De acordo com os valores que foram fornecidos, a matriz definida positiva da dispersão 

hidrodinâmica é ? = ?100 00 20? e determina-se que o menor autovalor é dado por ? = 20. 
Conforme os valores da velocidade uniforme, vx = 1,0 m/dia, segue que a constante 

característica é ?" = ,?? = 0,05, ou seja, a verificação do estimador que utiliza o transporte do 
contaminante 90Sr é realizado em regime de pequena advecção. 

 

 

                                                 

40 Entre os vários poluentes radioativos, um dos mais perigosos é o estrôncio-90 que, além de apresentar uma 
meia-vida relativamente alta, é um elemento metabolizado pelo organismo de forma semelhante ao cálcio. A 
radioatividade emitida pelo  90Sr pode alterar a atividade da medula óssea na produção de células sangüíneas, 
com o perigo de levar o indivíduo a uma forte anemia ou mesmo a adquirir leucemia. O 90Sr acumula no corpo.  



76 

Tabela 5.1 – Variáveis do transporte de 

VARIÁVEL 
 

Velocidade 
uniforme (m/dia) 

 

 
Velocidade real do fluxo de água 
subterrânea na direção horizontal

Dispersividade 
longitudinal (m) 
 

Estima a d
Dx =

Dispersividade 
transversal (m) 

 

Estima a dispersão transversal
Dy =

Porosidade 
efetiva 

 

Define a porosidade efetiva do 
aquífero

Frente de 
contaminante (m) 

 

Implementa a concentração na 
fronteira de Dirichlet de 150m.

Concentração de 
90Sr (mg/L) 

 

Conce
na fonte de 100 mg/L.

Decaimento de 1a 
ordem (1/dia) 

Escalar que implementa o termo de 
decaimento de 1ª  ordem do 
 

Coeficiente theta 
 
 

Escalar da discretização temporal.
 

Solução Analítica Variável booleana para comparar a 
solução numérica com a analítica. 

As dimensões do domínio retangular da figura 5.3

de largura. A malha inicial foi dividida de forma que os 1024 elementos retangulares 

sobrepõem os 1089 nós igualmente espa

FIG 5.3 – Malha inicial do domínio 
os nós 337 e 532, onde serão obtidas as curvas

325 m 

elemento 416     nó 337

150 m              nó 532
C0 = 100 mg/L 

 
                 patch 66
 
325 m 

                                 

ariáveis do transporte de 90Sr em aqüífero confinado, adaptadas de 

DESCRIÇÃO INPUT DOS DADOS

Velocidade real do fluxo de água 
subterrânea na direção horizontal 

 

double Vx = 1.0; 
double Vy = 0.0; 

Estima a dispersão longitudinal 
=?xVx em função da pluma.  

double longiDisp 
// de 0.1m a 100m

Estima a dispersão transversal 
=?yVx em função da pluma.. 

double transDisp 
 

ine a porosidade efetiva do 
aquífero 

double poro = 0.15; 

Implementa a concentração na 
fronteira de Dirichlet de 150m. 

int Ymed = 3; // 
da contaminação pontual.

Concentração constante estimada 
na fonte de 100 mg/L. 

double solute = 1

Escalar que implementa o termo de 
decaimento de 1ª  ordem do 90Sr. 

double reaction = 0.0000678; 
tempo de meia vida do 

 

Escalar da discretização temporal. double theta = 1.0/2.0; 
Crank-Nicolson-Galerkin

Variável booleana para comparar a 
solução numérica com a analítica.  

boolean AnalyticalSolution
// solução 2D de 

package org.arena.water.gwfem2d.transport2D

domínio retangular da figura 5.3 são 1000 m de comprimento por 800 

de largura. A malha inicial foi dividida de forma que os 1024 elementos retangulares 

sobrepõem os 1089 nós igualmente espaçados na direção x e na direção y

Malha inicial do domínio - ? .///012//0 indicando os 150m da frente de contaminação
serão obtidas as curvas BTC, o elemento 416 e o patch 661 para análise de erro

nó 337 

nó 532 

661 

1000 m 

vx = 1 m/dia 

                                Resultados 

, adaptadas de WEXLER (1992). 

DOS DADOS 

= 1.0; // velocidade em x 
= 0.0; // velocidade em y 

 = 100.0; 
100m - (Kumar, 2009) 

 = 20.0; 

= 0.15; // porosity  

// nós acima e abaixo 
da contaminação pontual. 

= 100.0; 

= 0.0000678; // 
tempo de meia vida do 90Sr = 28 anos. 

= 1.0/2.0; // método de 
Galerkin 

AnalyticalSolution = true;  
// solução 2D de Wexler 1992 

 
org.arena.water.gwfem2d.transport2D 

de comprimento por 800 m 

de largura. A malha inicial foi dividida de forma que os 1024 elementos retangulares 

direção y.  

 
da frente de contaminação, 

661 para análise de erro 



    Departamento de Hidráulica e Saneamento – PPG SHS EESC USP                                 77 

O tempo total de simulação é de 2000 dias (d) divididos em intervalos de tempo de 10 

dias. As informações iniciais do código referentes aos parâmetros da malha e do regime de 

transporte são: 

   delta X = 31.2500    delta Y = 25.0000   VALORES DE REFERÊNCIA       Retardo R = 01.0000 
 Peclet 2D = 00.4002    00.3125 (1D)          &amp;lt;= 50.0 
Courant 2D = 00.2499    00.3200 (1D)          &amp;lt;= 1.0 
     Pe.Cr = 00.1000    00.1000 (1D)          &amp;lt;= 5.0 
  Pe(1+Cr) = 00.5002    00.4125 (1D)          &amp;lt;&amp;lt;2.0 
 
QUANTIDADE DE NOS NO SISTEMA 1089 
Menor Autovalor de D = 20.0000 
Valor de Cc (regime) = 00.0500 
----------------------------------------- 
 

A análise de erro e os gráficos desta seção consideram a distribuição da concentração 

normalizada ? ???? do 90Sr.  
A solução numérica ?3 é comparada com a solução analítica ? de WEXLER (1992), dada 

pela equação 4.41 e implementada no código (figura 4.12). A norma euclidiana do erro real 

sobre todos os elementos da malha, 4?4 = 4? ? ?3 4, foi obtida para cada passo de tempo e 
posteriormente aplicada no índice de eficiência do estimador, conforme descrito na seção 1.2 

para avaliar a qualidade do estimador residual estipulado pela equação 4.32. 

Os nós escolhidos para a obtenção das curvas BTC[ ] de passagem de soluto41 são os nós 

337 e 532 devido à posição geográfica em que se encontram na figura 5.3. O nó central 532 

avaliará a evolução da passagem de soluto influenciado pela dispersão horizontal, e o nó 

adjacente 337 avaliará também a influência da dispersão transversal. A figura 5.4 ilustra o 

comportamento das curvas BTC[337] e BTC[532] obtidas pela solução analítica e comparadas, 

respectivamente, às curvas BTC[ ] obtidas da solução numérica do código JAVA. 

 
FIG 5.4 – Comparação entre as curvas de passagem de soluto da solução Java e a correspondente 

solução analítica 2D de Wexler (1992) para o transporte do 90Sr em malha grosseira 
DH significa difusão horizontal e DT significa difusão transversal 

                                                 

41 Do inglês Breakthrough Curves, estas curvas descrevem a evolução da concentração do soluto em migração 
no nó de observação. 

0

0,2

0,4

0,6

0,8

1

0 50 100 150 200

C
o

n
ce

n
tr

a
çã

o
n

o
rm

a
li

za
d

a

No. de passos de tempo de 10 dias [d]

Curvas de passagem de soluto - BTC[]
Solução Wesler DH

Solução Java DH

Solução Wesler DT

Solução Java DT



78                                  Resultados 

O erro entre estas curvas de passagem de soluto e o erro em toda malha inicial é 

estimado conforme a metodologia apresentada na subseção 4.5.1 pela equação 4.38. 

Para cada passo de tempo tn, o índice de eficiência sobre a malha grosseira é definido 

por:       
e

E
n

f
nT

?
=        (5.1). 

sendo n
nT

?  o erro residual espacial da equação (4.32) sobre a malha nT  e 4?4 a norma 
euclidiana do erro real. 

A figura 5.5 exibe uma curva de ajustamento que apresenta boa interpolação dos valores 

do índice de eficiência fE , equação (5.1), determinados em todos os passos de tempo da 

simulação numérica. 

Nos primeiros passos de tempo, as oscilações iniciais da solução numérica são 

responsáveis por apresentar valores do índice de eficiência acima do especificado para a 

maioria dos problemas da Engenharia, ou seja, segundo AINSWORTH e ODEN (2000), valores 

acima de 3,0. 

No entanto, verifica-se pela figura 5.5 que o índice de eficiência aproxima-se de 1,0 

conforme o tempo avança, ou seja, o estimador residual espacial n
nT

? , dado pela equação 4.32, 

encontra-se cada vez mais próximo do erro real 4?4, sendo assim, caracterizado como um 
estimador assintoticamente estável, pois, 

lim9?;
&lt;?4?4 = 1 

O limite acima assegura a qualidade do estimador de erro residual espacial utilizado nos 

resultados deste capítulo. 

O estimador ZZ, proveniente da técnica de recuperação do gradiente dado por 

ZIENKIEWICZ e ZHU (1992a) e validado para a equação elíptica do fluxo subterrâneo (3.3) 

[FIRMIANO e WENDLAND, 2009] (ANEXO III), também é analisado em todos os passos de 

tempo da simulação numérica e a sua eficiência avaliada. 

Verificou-se que o índice de eficiência do estimador ZZ é quase nulo para todos os 

passos de tempo. A figura 5.5 também ilustra o valor de fE  para o estimador ZZ em apenas 

três instantes de tempo (t = 100d, t  = 1000d e t = 2000d) mostrando que esse estimador não é 

adequado para o transporte de contaminantes, e ainda, o estimador ZZ subestima o erro real da 

solução numérica da equação parabólica (4.25) 



    Departamento de Hidráulica e Saneamento – PPG SHS EESC USP                                 79 

 
FIG 5.5 – Eficiência do estimador de erro residual em função do passo de tempo. 
O estimador residual é assintoticamente estável e a sua taxa de convergência é 
da ordem de uma função potência com confiança de 98,04%. A eficiência do 

estimador ZZ é quase nula para todos os passo de tempo. 

Valores adequados para o estimador residual espacial, 0,20,1 ?&amp;lt;n
nT

? , são observados a 

partir do 75º passo de tempo e a taxa de convergência no tempo do elemento residual de pode 

ser obtida pela curva de ajuste da figura 5.5, a função potência ? ? 1,0 + 82,117?@?,ABB com 
98,04% de confiança, sendo t o número de passos de tempo da simulação. 

O estimador de erro residual espacial também foi utilizado localmente para a avaliação 

do erro no patch dos nós 337 e 532. Verifica-se que esse erro estimado estabiliza-se, na 

concentração normalizada, em 0,18 para o nó adjacente 337 e em 2,3 para o nó central 532 

(ver figura 5.6). 

O objetivo desta análise é verificar a estabilidade do estimador residual aplicado no 

centróide de um elemento retangular da malha grossa. Assim, uma estratégia de refinamento 

0,0246 0,0061 0,0055

y = 1,0 + 82,117t-0,933

R² = 0,9804

0
1
2
3
4
5
6
7
8
9

10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45

0 20 40 60 80 100 120 140 160 180 200

Eficiência Residual

Eficiência ZZ

Potência (Eficiência Residual)

No. de passos de tempo de 10 dias [d] 

Eficiência do Estimador (malha original) 
Ín

d
ic

e
 d

e
 E

fi
ci

ê
n

ci
a

  



80                                  Resultados 

adaptativo [VERFÜRTH, 2008] poderia considerar a solução numérica no patch do nó indicado 

ao estimar os valores da concentração e compará-las às do passo de tempo do instante anterior 

ao refinamento. 

 
FIG 5.6 – Evolução do erro residual estimado no patch do nó adjacente 337 e 

no patch do nó central 532 da malha grosseira 

A contribuição do erro da discretização temporal da solução numérica em toda malha 

inicial também é verificada na comparação com a solução analítica de WEXLER (1992) para o 

transporte do 90Sr. 

O erro estimado pelo indicador temporal nt? , conforme descrito na equação 4.37, 

converge para zero com o avanço no tempo. A figura 5.7 ilustra a convergência no tempo do 

indicador temporal nos 100 últimos passos de tempo, ou seja, no intervalo compreendido 

entre o 1.000o dia de simulação e o 2.000o dia. 

A taxa de convergência do indicador de erro temporal nt?  é exponencial, conforme a 

sua curva de ajustamento ? ? 1735,9?@?,?EE9, apresentada com 99,99% de confiança. A 
variável t é representa o número de passos de tempo da simulação. 

Este indicador de erro temporal apresenta-se como uma ferramenta essencial para a 

obtenção de uma estratégia de refinamento adaptativo do intervalo de tempo da simulação, 

conforme apresentado em VERFÜRTH (2008, pg 77). 

As isoconcentrações da solução analítica e da solução numérica no instante ? = 800F 
são fornecidas para comparação na figura 5.8. Os valores normalizados são agrupados em 

intervalos de 0,2 em 0,2 das concentrações calculadas ? ????. 
 

0

0,5

1

1,5

2

2,5

3

3,5

4

4,5

0 20 40 60 80 100 120 140 160 180 200

E
rr

o
 r

e
si

d
u

a
l n

o
 p
a
tc
h

No. de passos de tempo de 10 dias [d]

Análise do resíduo estimado no patch da malha original

Patch 532

Patch 337



    Departamento de Hidráulica e Saneamento – PPG SHS EESC USP                                 81 

 
FIG 5.7 – Evolução do indicador temporal e a correspondente taxa de convergência exponencial  

Verifica-se na figura 5.8 que a frente de contaminação da solução numérica encontra-se 

atrasada em relação à frente da solução analítica. O objetivo do estimador residual espacial é 

controlar esse erro de discretização, fornecendo uma estimativa confiável do erro real, para 

que estratégias adaptativas sejam conduzidas para que a qualidade da solução numérica esteja 

assegurada.  

A análise de erro a posteriori apresentada pelo código JAVA no instante t = 800d é: 

 
Erro da malha atual: 05.6194 
Erro máximo de 00.3810 no nó: 661 

Erro residual espacial da malha: 11.2572 
Erro relativo da solução 0.0110 
Erro residual máximo = 2.9286 no elemento 416 
Erro residual mínimo = 0.0001 no elemento 975 
----------------------------------------- 
time: 800.0 
----------------------------------------- 

 Verifica-se que no instante indicado (t = 800d) o estimador residual espacial possui um 

índice de eficiência dado por 0033,2
6194,5

2572,11
===

e
E

n

f
nT

?
. Esse valor ainda é considerado 

aceitável para vários problemas da Engenharia [AINSWORTH E ODEN, 2000, pg. 18]. 
 

y = 1735,9e-0,044t

R² = 0,9999

0

5

10

15

20

25

100 110 120 130 140 150 160 170 180 190 200

Indicador de erro temporal na malha original

No. de passos de tempo de 10 dias [d] 

E
rr

o
 d

e
 d

is
cr

e
ti

za
çã

o
 t

e
m

p
o

ra
l 



82 

(a) solução analítica de 

FIG
a solução numérica (b) do transporte do 

Através da solução analítica, avaliou

Descrevendo 661 = 20x33 + 1, segue que a posição 

conforme a figura 5.3. De acordo com as disposições dos 1024 elementos da m

pela figura 5.16, o patch do nó 661 é simétrico ao 

661 = (16+4)x33 + 1 e 397 = (16

O estimador residual 

que é formado pelos nós: 429, 430, 463 e 462. Uma vez que os nós 429 e 430 fazem parte do 

patch 397 e que a solução 

residual foi capaz de identificar a região que apresenta o maior erro numérico da equação do 

transporte de contaminantes

A figura 5.9 ilustra a 

valor do erro máximo. 

13ª linha 
  patch 

  

fronteira 
de 

Dirichlet 

 elemento 416

 

17ª linha 

 

 

 

21ª linha  
   

  patch 

                  FIG 5.9 – Ocorrência de erro máximo atual no nó 661 e captura desse erro,
                       devido à simetria

                                 

solução analítica de Wexler (1992)   (b) solução numéric

IG 5.8 – Comparação entre a solução analítica (a) e 
a solução numérica (b) do transporte do 90Sr em 

aquífero confinado no instante t = 800d 

Através da solução analítica, avaliou-se que o erro real máximo ocorre no nó 661. 

61 = 20x33 + 1, segue que a posição desse nó situa-se na 21ª linha e 

De acordo com as disposições dos 1024 elementos da m

do nó 661 é simétrico ao patch do nó 397 = 12x33+1 (observe

x33 + 1 e 397 = (16-4)x33 + 1). 

O estimador residual espacial identificou que o erro máximo ocorre 

que é formado pelos nós: 429, 430, 463 e 462. Uma vez que os nós 429 e 430 fazem parte do 

397 e que a solução numérica é simétrica (figura 5.8), verifica

residual foi capaz de identificar a região que apresenta o maior erro numérico da equação do 

de contaminantes em malha grosseira. 

A figura 5.9 ilustra a região do domínio em que o estimador residual 

patch do nó 397 simétrico ao patch do nó 661 

 

elemento 416 - formado pelos nós 429, 430, 463,462 

linha - linha de simetria da solução numérica 

 

patch do nó 661- que apresenta o erro máximo atual 

Ocorrência de erro máximo atual no nó 661 e captura desse erro,
devido à simetria da solução, pelo estimador residual no elemento 41

0,8-1

0,6-0,8

0,4-0,6

0,2-0,4

0-0,2

                                Resultados 

solução numérica do código JAVA 

 

máximo ocorre no nó 661. 

se na 21ª linha e 2ª coluna, 

De acordo com as disposições dos 1024 elementos da malha fornecidos 

do nó 397 = 12x33+1 (observe que 

ocorre no elemento 416 

que é formado pelos nós: 429, 430, 463 e 462. Uma vez que os nós 429 e 430 fazem parte do 

, verifica-se que o estimador 

residual foi capaz de identificar a região que apresenta o maior erro numérico da equação do 

residual espacial capturou o 

Ocorrência de erro máximo atual no nó 661 e captura desse erro, 
, pelo estimador residual no elemento 416  

0,8-1

0,6-0,8

0,4-0,6

0,2-0,4

0-0,2



    Departamento de Hidráulica e Saneamento – PPG SHS EESC USP                                 83 

5.1.1 Solução Numérica Ajustada no patch 

Nesta subseção é realizada uma avaliação na distância entre as curvas de passagem de 

soluto – BTC[337] e BTC[532] da figura 5.4, obtidas localmente da solução analítica e da 

respectiva solução numérica do código JAVA. 

 A condição de ortogonalidade de Galerkin diz que o erro de discretização é 

perpendicular ao espaço das funções testes [HARBRECHT e SCHNEIDER, 2009] conforme 

indicado na figura 5.10. 

 

 

 

 

 

 

 

 

 

FIG 5.10 – Condição de ortogonalidade de Galerkin 
observada nos resíduos da solução numérica FEM 

Apesar de não analisar se o erro residual preserva ou não a ortogonalidade, pois o 

esquema de discretização adotado emprega termos upwind [WENDLAND, 2004], ao adotar os 

parâmetros empíricos da figura 5.10, como sendo G ? 0,0 e I = 1,3 verifica-se uma 
excelente concordância entre a curva BTC[532] da solução numérica ajustada com a sua 

correspondente curva BTC[532] da solução analítica, conforme apresentado na figura 5.11. 

 
FIG 5.11 – Comparação entre a solução numérica ajustada e 
 a solução analítica de Wexler (1992) no nó 337 e no nó 532 

0

0,2

0,4

0,6

0,8

1

0 50 100 150 200

C
o

n
ce

n
tr

a
çã

o
n

o
rm

a
li

za
d

a

No. de passos de tempo de 10 dias [d]

Curvas BTC[] ajustadas Solução Wexler DH
ajuste BTC[532]

solução Wexler DT

ajuste BTC[337]

 
                                               ? = G? + I?3 
                     ? 
 
 
 
                   G? 
                                         I?3 



84                                  Resultados 

Os parâmetros de ajuste para a curva BTC[337] da solução numérica são G ? 0,0 e 
I = 2,5 e a concordância com a correspondente BTC[337] da solução analítica é acentuada 
após o 100º passo de tempo, conforme visto na figura 5.11. Estes parâmetros empíricos 

podem variar de nó para nó e, até o momento, faz-se necessária uma fundamentação 

matemática para a sua obtenção. 

5.1.2 Limites Inferiores e Superiores do Estimador Residual 

Por simplicidade de notação, considere nesta subseção que o estimador residual espacial 

é denotado por n
nT

?? = . 

Segundo GRÄTSCH e BATHE (2005), o principal propósito do estimador de erro a 

posteriori é prover uma estimativa precisa e limitar o erro da solução numérica em uma 

norma específica. 

Um estimador de erro eficiente inclui uma predição muito próxima do erro real, mesmo 

quando a solução analítica é desconhecida para a maioria dos problemas da Engenharia. A 

confiabilidade do estimador surge com a existência de limites superiores e inferiores do erro 

estimado que são viabilizados pela implementação computacional, conforme discutido na 

seção 1.2. 

 Através da disponibilização dos valores dos erros residuais e dos erros reais da solução 

numérica do transporte do 90Sr, para a malha original e em todos os passos de tempo, 

determina-se as constantes ?, = 1,7 e ?? = 4,0, tais que: 
?,4?4 ? &amp;lt;? ??4?4      (5.2) 

 A figura 5.12 apresenta o erro residual fornecido pelo estimador espacial 4.32 limitado 

pela norma euclidiana do erro real. Verifica-se que o limite inferior 1,74?4 é válido para 
todos os passos de tempo da simulação numérica, enquanto que o limite superior aplica-se a 

partir do 40º passo de tempo. 

Para limitar superiormente os passos de tempo anteriores ao 40º, basta aumentar o valor 

da constante ??. 
 



    Departamento de Hidráulica e Saneamento – PPG SHS EESC USP                                 85 

 
FIG 5.12 – Visualização dos limites inferiores ., K4L4 e 

superiores M, /4L4 do estimador de erro residual em malha grosseira 
As desigualdades (5.2) mostram que o erro residual tende a zero na mesma taxa de 

convergência em que o erro real tende a zero, e que na simulação do transporte do 90Sr, o 

índice de eficiência é limitado por 0,47,1 ?? fE , a partir do 40º passo de tempo. 

5.2 A INFLUÊNCIA DA MALHA NO ERRO RESIDUAL DA SOLUÇÃO NUMÉRICA 

Nesta seção são apresentados os resultados obtidos com a reorganização dos nós da 

malha inicial em uma estratégia que concentra os nós disponíveis junto à frente de 

contaminação, conforme descrito na seção 4.7 e ilustrado na figura 4.19 (pg 69). Para obter 

essa malha deformada é adotado o seguinte valor da correspondente variável: 

double delay = 0.3; 

Isto significa que a malha inicial sofrerá uma deformação que concentrará vários dos 

1089 nós na região próxima margem esquerda da figura 5.3. Nesta nova configuração da 

malha, o nó central 536 recebe a posição geográfica do nó 531 e o nó adjacente 344 recebe a 

posição geográfica do nó 337, conforme atualizado no dado de entrada por: 

int nodeBTC1 = 536; 
int nodeBTC2 = 344; 

0

5

10

15

20

25

30

35

40

0 10 20 30 40 50 60 70 80 90 100 110 120 130 140 150 160 170 180 190 200

E
rr

o
  N

u
m

é
ri

co

No. de passos de tempo de 10 dias [d]

Limites Superiores e Inferiores do 

Estimador em malha grosseira

Erro Residual

Limite Inferior

Limite Superior



86                                  Resultados 

A comparação entre as curvas BTC[536] e BTC[344] da solução numérica com as 

respectivas curvas BTC[ ] da solução analítica é ilustrada na figura 5.13. 

 

 
FIG 5.13 – Comparação entre as curvas de passagem de soluto da solução JAVA e a correspondente 

solução analítica 2D de WEXLER (1992) para o transporte do 90Sr em malha deformada 
DH significa difusão horizontal e DT significa difusão transversal 

Se comparado com a figura 5.4, a melhora observada com a redistribuição dos nós da 

malha original, para a proximidade entre a solução numérica e a solução analítica nos nós 

indicados é muito pequena. No entanto, verifica-se, para o mesmo número de graus de 

liberdade, uma melhoria significativa no erro global da malha, no erro residual analisado no 

patch de elementos e no indicador de erro temporal quando a malha inicial se encontra com 

um atraso de 30% na redistribuição dos seus 1089 nós. 

Para o erro global da malha, índice de eficiência é reavaliado e o correspondente 

estimador residual mostra-se assintoticamente estável com melhora significativa na sua taxa 

de convergência, conforme indicado na figura 5.14. 

A tabela 5.2 confronta os valores da eficiência determinada na malha sem o atraso com 

os valores na malha deformada e mostra a boa resposta do estimador residual para o referido 

reposicionamento dos nós na obtenção da nova solução numérica. 

Tabela 5.2 – Eficiência do estimador de erro residual  
na malha original e na malha deformada 

Passo Delay = 0,0 Delay = 0,3 
t = 10  12,5093 4,1098 
t = 50    3,0622 1,5256 
t = 75   2,2856 1,2360 
t = 100   1,9687 1,1214 
t = 150    1,7703 1,0611 
t = 175   1,7478 1,0606 
t = 200   1,7439 1,0542 

 

0

0,2

0,4

0,6

0,8

1

0 50 100 150 200

C
o

n
ce

n
tr

a
çã

o
 

n
o

rm
a

li
za

d
a

No. de passos de tempo de 10 dias [d]

Curvas BTC[] em malhas com atraso de 30%
BTC Wesler DH

BTC JAVA DH

BTC Wesler DT

BTC JAVA DT



    Departamento de Hidráulica e Saneamento – PPG SHS EESC USP                                 87 

Verifica-se, na figura 5.14, que o índice de eficiência do estimador residual aproxima-se 

de 1,0 logo após o 50º passo de tempo na malha deformada. Ou seja, o estimador residual 

demonstrou-se mais eficiente nesse tipo de malha para o transporte de contaminantes, em 

relação à malha original da seção 5.1. 

 
FIG 5.14 – Eficiência do estimador de erro residual em função do passo de tempo. 

O estimador residual é assintoticamente estável e a sua taxa de convergência é 
da ordem de uma função potência com confiança de 93,4%. A eficiência do 

estimador ZZ é quase nula para todos os passo de tempo. 

A taxa de convergência do estimador residual 
I

?  pode ser estimada pela curva de 

ajustamento da figura 5.14, a função potência ? ? 1,0 + 69,265?@,,BO com 93,4% de 
confiança. Verificou-se novamente que o índice de eficiência do estimador ZZ é quase nulo 

para todos os passos de tempo. A figura 5.14 também ilustra esses baixos valores dos índices 

de eficiências fE  para o estimador ZZ em apenas três instantes de tempo (t = 100d, t  = 1000d 

e t = 2000d). 

O erro avaliado no patch do nó 536 (antigo nó 531 da malha original) e no patch do nó 

344 (antigo nó 337 da malha original) é ilustrado no gráfico da figura 5.15. 

0,035 0,013 0,012

y =1,0 + 69,265t-1,35

R² = 0,934

0

1

2

3

4

5

6

7

8

9

10

0 20 40 60 80 100 120 140 160 180 200

Ín
d

ic
e

 d
e

 E
fi

ci
ê

n
ci

a

No. de passos de tempo de 10 dias [d]

Eficiência do Estimador (malha 30%)

Eficiência Residual

Eficiência ZZ

Potência (Eficiência Residual)



88                                  Resultados 

 
FIG 5.15 – Análise do erro residual no patch do nó 536 e  

no patch do nó 344 da malha deformada 

O erro residual do patch mensurado nos diferentes passos de tempo é visivelmente 

inferior em relação ao erro residual obtido na malha original (figura 5.6). Para o nó 536, o 

erro no patch estabiliza-se por volta de 1,2, mostrando uma melhora de 49%, e para o nó 344, 

o erro no patch estabiliza-se por volta de 0,068, mostrando uma melhora de 62% se 

comparado com a análise do erro na malha original. 

Outro resultado favorável do estimador de erro residual na malha com atraso é a 

melhora observada na taxa de convergência do erro temporal. A figura 5.16 mostra esta 

convergência do erro temporal e a função de ajuste para os valores correspondentes aos 100 

últimos passos de tempo da simulação. 

 A tabela 5.3 confronta as taxas de convergência dos estimadores de erro temporal 

obtidas da solução numérica na malha original e na malha deformada. 

Tabela 5.3 – Convergência do estimador de erro temporal  
na malha original e na malha deformada 

Passos Delay = 0,0 Delay = 0,3 
t = 100  22,3934 10,7257 
t = 125    7,2769   3,4719 
t = 150    2,4143   1,0995 
t = 175   0,8162   0,3604 
t = 200   0,2810   0,1159 

 

0

0,5

1

1,5

2

2,5

0 20 40 60 80 100 120 140 160 180 200

E
rr

o
 r

e
si

d
u

a
l n

o
 p
a
tc
h

No. de passos de tempo de 10 dias [d]

Análise do resíduo estimado no patch da malha com atraso de 30%

Patch 536

Patch 344



    Departamento de Hidráulica e Saneamento 

 Verifica-se, na tabela 5.3, que o ajuste na distribuição espacial dos nó

original também é responsável pela melhora observada na velocidade de convergência do erro 

de discretização temporal para um valor nulo.

 

FIG 5.16 – Evolução do indicador de erro temporal e a sua taxa de convergência
exponencial com 95,08% de 

O mapa das isoconcentrações da solução analítica e da solução numérica também 

recalculado e os seus resultados

que estas soluções estão com um grau de proximi

figura 5.8. Os valores normalizados foram

concentrações calculadas. 

(a) solução analítica de 

FIG 5.17 – Comparação ent
      em aquífero confinado no instante 

 

0

1

2

3

4

5

6

7

8

9

10

100 110 120

E
rr

o
 t

e
m

p
o

ra
l

Departamento de Hidráulica e Saneamento – PPG SHS EESC USP       

se, na tabela 5.3, que o ajuste na distribuição espacial dos nó

original também é responsável pela melhora observada na velocidade de convergência do erro 

de discretização temporal para um valor nulo. 

Evolução do indicador de erro temporal e a sua taxa de convergência
exponencial com 95,08% de confiança na malha deformada

isoconcentrações da solução analítica e da solução numérica também 

e os seus resultados, para o instante t = 700 d, exibidos na figura 5.17

que estas soluções estão com um grau de proximidade superior ao que foi 

Os valores normalizados foram agrupados em intervalos de 0,2 em 0,2 das 

solução analítica de WEXLER (1992)   (b) solução numérica do código 

Comparação entre a solução analítica (a) e a solução numérica (b) 
aquífero confinado no instante t = 700d em malha deformada

y = 2892,9e

R² = 0,9508

120 130 140 150 160 170 180

100 últimos passo de tempo da simulação [d]

Indicador de erro temporal

Erro Temporal

Exponencial (Erro Temporal)

0,8-1

0,6-0,8

0,4-0,6

0,2-0,4

0-0,2

                           89 

se, na tabela 5.3, que o ajuste na distribuição espacial dos nós da malha 

original também é responsável pela melhora observada na velocidade de convergência do erro 

 
Evolução do indicador de erro temporal e a sua taxa de convergência 

deformada 

isoconcentrações da solução analítica e da solução numérica também foi 

exibidos na figura 5.17. Verifica-se 

que foi apresentado na 

agrupados em intervalos de 0,2 em 0,2 das 

solução numérica do código JAVA 

  
(b) do transporte do 90Sr 

deformada 

y = 2892,9e-0,053t

R² = 0,9508

180 190 200

Erro Temporal

Exponencial (Erro Temporal)

0,8-1

0,6-0,8

0,4-0,6

0,2-0,4

0-0,2



90                                  Resultados 

A análise de erro a posteriori apresentada pelo código no instante t = 700d é: 

Erro da malha atual: 04.8804 
Erro máximo de 00.6165 no nó: 661 

Erro residual espacial da malha: 6.1780 
Erro relativo da solução 0.0060 
Erro residual máximo = 0.9579 no elemento 455 
Erro residual mínimo = 0.0000 no elemento 21 
----------------------------------------- 
time: 700.0 
----------------------------------------- 

 Verifica-se que no instante indicado, o estimador de erro residual possui um índice de 

eficiência dado por P? = QR4S4 = 1,6259. Isto significa que o estimador residual espacial, na 
malha deformada e t = 700d, encontra-se mais próximo do erro real do que na malha original 

para t = 800d, cuja eficiência era P? (800) ? 2,0. 
Observa-se que índice de eficiência no passo de tempo t = 700d, da malha deformada, é 

superior ao índice de eficiência determinado em todos os passos de tempo da malha original 

pois, no último passo de tempo dessa malha original calcula-se P? (2000) = 1,7439. 
Os limites superiores e inferiores do erro residual estimado na malha deformada, 

conforme apresentado na figura 5.18 obedecem às desigualdades: 

4?4 ? &amp;lt;? 2,0. 4?4       (5.3) 
Desta forma, verifica-se que para limitar o erro residual, a partir do 40º passo de tempo, 

é necessário constantes ?, = 1,0 e ?? = 2,0, que determinam um intervalo de amplitude 1,0. 
Isto representa uma melhora de 57%, se comparado ao intervalo de amplitude 2,3 para limitar, 

a partir do 40º passo de tempo, o erro residual estimado na malha original. 

E ainda, as desigualdades (5.3) mostram que o erro residual tende a zero na mesma taxa 

de convergência em que o erro real tende a zero e que na simulação do transporte do 90Sr, o 

índice de eficiência do estimador residual na malha deformada é limitado por  

0,20,1 ?? fE , 

a partir do 40º passo de tempo. 

 As análises feitas nesta seção mostraram a boa funcionalidade do estimador residual 

espacial sobre este tipo de malha adaptada. 



    Departamento de Hidráulica e Saneamento – PPG SHS EESC USP                                 91 

 
FIG 5.18 – Obtenção dos limites inferiores ., /4L4 e superiores X, /4L4 do 

estimador de erro residual em malha deformada 

5.3 UMA ESTRATÉGIA DE REFINAMENTO ADAPTATIVO 

A aplicabilidade do estimador de erro a posteriori com características residuais para a 

equação parabólica 4.25 deve ser avaliada nas estratégias de refinamento adaptativo da malha 

de elementos finitos. O estimador residual espacial da equação 4.38, em regime de pequena 

advecção, conduzirá o refinamento adaptativo de acordo com a estratégia do máximo, descrita 

em VERFÜRTH (2008, pg. 81). Nesta estratégia, o elemento será refinado, se o seu resíduo 

superar em uma determinada porcentagem Y, o valor do erro máximo obtido nos elementos da 
malha. O valor de Y, geralmente indicada pelo usuário do código, será considerado neste 
trabalho como sendo Y = 0,5, uma escolha popular e bem estabelecida (VERFÜRTH, 2008). 

Sendo a malha original uma malha estruturada e com elementos quadriláteros, o 

elemento marcado para o refinamento será subdividido horizontalmente em dois elementos 

congruentes. Para evitar nós de enforcamento42, os elementos vizinhos da esquerda e da 

direita também serão refinados. Uma malha regular é uma malha sem estes nós de 

enforcamento [CARSTENSEN e HU, 2009]. A tabela 5.4 exemplifica uma captura do estimador 

de erro residual dos elementos que são indicados para o refinamento adaptativo pela estratégia 

do máximo. 
                                                 

42 Do inglês hanging nodes. Um nó será considerado de enforcamento se na malha existir pelo menos um 
elemento, tal que o nó pertence ao interior de uma aresta de K, mas não é vértice do elemento K. 

0

2

4

6

8

10

12

14

0 20 40 60 80 100 120 140 160 180 200

E
rr

o
 N

u
m

é
ri

co

No. de passos de tempo de 10 dias [d]

Limites Superiores e Inferiores do 
Estimador em malha deformada

Erro Residual

Limite inferior

Limite Superior



92                                  Resultados 

Nesta captura escolheu-se arbitrariamente o tempo t = 130d para a malha original e para 

a malha deformada. 

Tabela 5.4 – Comparação dos elementos indicados para refinamento pelo estimador 
 residual espacial na malha original e na malha deformada, para t = 130d 

malha original malha com delay 30% 

O resíduo do elemento 352 é 1,6380 O resíduo do elemento 419 é 1,1314 

O resíduo do elemento 416 é 3,1498 O resíduo do elemento 421 é 0,9114 

O resíduo do elemento 417 é 2,2881 O resíduo do elemento 423 é 1,2715 

O resíduo do elemento 418 é 1,7736 O resíduo do elemento 451 é 0,9006 

O resíduo do elemento 419 é 1,4428 O resíduo do elemento 453 é 0,8568 

O resíduo do elemento 448 é 1,8269 O resíduo do elemento 455 é 1,3728 

O resíduo do elemento 449 é 1,8384 O resíduo do elemento 459 é 0,9102 

O resíduo do elemento 450 é 1,7103 O resíduo do elemento 483 é 0,8411 

O resíduo do elemento 451 é 1,5454 O resíduo do elemento 487 é 1,3328 

O resíduo do elemento 452 é 1,3811 O resíduo do elemento 491 é 0,9373 

O resíduo do elemento 480 é 1,7025 O resíduo do elemento 515 é 0,8410 

O resíduo do elemento 481 é 1,6243 O resíduo do elemento 519 é 1,3324 

O resíduo do elemento 482 é 1,5487 O resíduo do elemento 523 é 0,9368 

O resíduo do elemento 483 é 1,4590 O resíduo do elemento 547 é 0,9002 

O resíduo do elemento 484 é 1,3564 O resíduo do elemento 549 é 0,8561 

O resíduo do elemento 512 é 1,7025 O resíduo do elemento 551 é 1,3717 

O resíduo do elemento 513 é 1,6243 O resíduo do elemento 555 é 0,9087 

O resíduo do elemento 514 é 1,5486 O resíduo do elemento 579 é 1,1307 

O resíduo do elemento 515 é 1,4590 O resíduo do elemento 581 é 0,9103 

O resíduo do elemento 516 é 1,3563 O resíduo do elemento 583 é 1,2698 

O resíduo do elemento 544 é 1,8269  

O resíduo do elemento 545 é 1,8384 Erro residual máximo = 1,3728 (455) 

O resíduo do elemento 546 é 1,7101  

O resíduo do elemento 547 é 1,5452  

O resíduo do elemento 548 é 1,3808  

O resíduo do elemento 576 é 3,1497  

O resíduo do elemento 577 é 2,2878  

O resíduo do elemento 578 é 1,7733  

O resíduo do elemento 579 é 1,4424  

O resíduo do elemento 640 é 1,6381  

 

Erro residual máximo = 3,1498 (416) double tau = 0.5; 

 

Verifica-se que a quantidade de elementos que foram marcados para o refinamento é 

inferior na malha com 30% de atraso em relação aos da malha original, e ainda os erros 

residuais foram distribuídos pelos elementos da malha. Assim, o estimador residual não só 

identifica o erro espacial global da solução numérica da equação do transporte 4.25, como 

também é capaz de mensurar a contribuição para o erro de cada um dos seus elementos. 



    Departamento de Hidráulica e Saneamento 

As figuras 5.19 e 5.20

refinamento nas duas malhas em estudo.

foram marcados em quase todos os passos de temp

FIG 5.19 –
 para 

 Verifica-se, pelo estimador residual

para o erro espacial global

constante quando a malha está sem o atraso. Verifica

identifica uma diminuição de 

FIG 5.20 –
 para o refinamento na malha 

Departamento de Hidráulica e Saneamento – PPG SHS EESC USP       

e 5.20 exibem a distribuição simétrica dos elementos indicados para o 

as duas malhas em estudo. Os mesmos elementos indicados nas figuras abaixo 

foram marcados em quase todos os passos de tempo da simulação numérica.

– Mapa de elementos marcados pelo estimador residual
para o refinamento na malha original para t = 130d 

se, pelo estimador residual espacial, que os elementos com maior contribuição 

 da solução estão posicionados próximos à fonte de contaminação 

uando a malha está sem o atraso. Verifica-se ainda que o estimador residual 

identifica uma diminuição de 56,4% do erro máximo. 

– Mapa dos elementos marcados pelo estimador residual
para o refinamento na malha deformada, para t = 130d

                           93 

dos elementos indicados para o 

Os mesmos elementos indicados nas figuras abaixo 

o da simulação numérica. 

 
pelo estimador residual 

, que os elementos com maior contribuição 

fonte de contaminação 

se ainda que o estimador residual 

 
r residual 

d 



94                                  Resultados 

Na sequência, são apresentados os resultados com as estratégias conjuntas da malha 

deformada acrescida do refinamento adaptativo com parâmetro Y ? 0,5. Com o refinamento 
dos elementos sugerido, os parâmetros da malha passam a ser: 

  delta X = 05.2522    delta Y = 12.5000   VALORES DE REFERÊNCIA       Retardo R = 01.0000 
 Peclet 2D = 00.1356    00.0525 (1D)          &amp;lt;= 50.0 
Courant 2D = 00.7375    01.9040 (1D)          &amp;lt;= 1.0 
     Pe.Cr = 00.1000    00.1000 (1D)          &amp;lt;= 5.0 
  Pe(1+Cr) = 00.2356    00.1525 (1D)          &amp;lt;&amp;lt;2.0 
 
QUANTIDADE DE NOS NO SISTEMA 1287 
----------------------------------------- 

 Os nós de observação para as curvas de passagem de soluto passam a ter a identificação 

635 para o nó central e 344 para o nó adjacente43. A quantidade de nós no sistema passa a ser 

de 1287. As variáveis de atualização do código numérico para as estratégias combinadas são: 

boolean REFINA = true; double delay = 0.3; int nodeBTC = 635; 

 A comparação entre as curvas BTC[635] e BTC[344] obtidas da solução analítica com às 

obtidas da solução numérica JAVA apresenta um comportamento semelhante ao apresentado 

na figura 5.13. Ou seja, na posição indicada, estimador de erro residual espacial revelou que o 

refinamento adaptativo adotado não apresenta efeitos relevantes quando a malha se encontra 

deformada (delay = 30%) na disposição dos seus nós. No entanto, nessa estratégia, observa-se 

uma melhora de 72% em relação à diminuição do erro residual no patch do nó 635 (antigo nó 

531), e uma melhora de 80% no patch do nó 344 (antigo nó 337), conforme mostra a figura 

5.21. 

 A diminuição do erro espacial do patch 635, indicada pelo estimador de erro residual é 

esperada, uma vez que a disposição do nó escolhido para traçar as curvas de passagem de 

soluto está situada entre os elementos indicados para o refinamento adaptativo. Assim, os 

elementos do patch são refinados e a resolução numérica torna-se mais precisa. Desta forma, 

o estimador de erro espacial, com características residuais, avaliou adequadamente a 

diminuição do erro da solução numérica no conjunto de elementos que compartilham o nó 

635. A diminuição considerável do erro residual no patch do nó 344 é devido à sua 

proximidade com os elementos indicados para o refinamento. Assim, a contribuição desses 

elementos, para o erro residual, conforme indicado pelo estimador, é inferior. 

                                                 

43 O refinamento adotado não influenciou no endereço do nó 344, pois o mesmo encontra-se acima dos 
elementos refinados 



    Departamento de Hidráulica e Saneamento 

FIG 5.21

De acordo com o estimador residual, 

O erro no patch do nó 344, na malha com refinamento, estabilizou

A figura 5.22 compara a solução numérica do código 

adaptativo e na malha com

para o passo de tempo t = 2000

menos achatada para a solução com refinamento e, de acor

posteriori da tabela 5.5, é a solução mais precisa.

(a) solução numérica sem refinamento 

FIG 5.22 – Comparação da
numérica com refinamento adaptativo (b)

 

0

0,2

0,4

0,6

0,8

1

1,2

1,4

0 20 40

E
rr

o
 r

e
si

d
u

a
l n

o
p
a
tc
h

Análise do resíduo estimado no 

Departamento de Hidráulica e Saneamento – PPG SHS EESC USP       

5.21 – Análise do erro residual no patch de elementos da malha
 deformada e refinamento adaptativo com Z ? /, [

De acordo com o estimador residual, o erro no patch do nó 635 estabilizou

do nó 344, na malha com refinamento, estabilizou-se em 0,036.

compara a solução numérica do código JAVA na malha sem refinamento 

na malha com refinamento adaptativo. As curvas das isoconcentrações

= 2000d, revelam que a pluma do contaminante 

para a solução com refinamento e, de acordo com a análise de erro 

, é a solução mais precisa. 

solução numérica sem refinamento    (b) solução numérica com refinamento

Comparação da solução numérica sem refinamento adaptativo
com refinamento adaptativo (b) do transporte do 90Sr após 2000 dias de simulação

60 80 100 120 140 160 180

No. de passos de tempo de 10 dias [d]

Análise do resíduo estimado no patch da malha 
com atraso de 30% e refinamento

0,8-1

0,6-0,8

0,4-0,6

0,2-0,4

0-0,2

                           95 

 
de elementos da malha 

[ 

do nó 635 estabilizou-se em 0,64. 

se em 0,036. 

a malha sem refinamento 

refinamento adaptativo. As curvas das isoconcentrações, traçadas 

do contaminante contendo 90Sr é 

do com a análise de erro a 

solução numérica com refinamento 

 
 (a) com a solução  

Sr após 2000 dias de simulação 

200

patch 635

patch 344

0,8-1

0,6-0,8

0,4-0,6

0,2-0,4

0-0,2



96                                  Resultados 

5.3.1 Comparação do erro residual para diferentes estratégias  

Os resultados do estimador de erro residual, para o transporte de contaminantes em 

regime de pequena advecção, são apresentados na tabela 5.5 para as diferentes estratégias 

descritas nas seções anteriores, referentes à malha inicial sem atraso, malha inicial deformada 

(delay = 30%) e sem refinamento, e malha inicial deformada e com refinamento adaptativo. 

Tabela 5.5 – Análise do erro residual do estimador a posteriori em três tipos de malha, que 
       descrevem o domínio do transporte de contaminante em regime de pequena advecção 

Malha original  
(delay = 0,0) 

Erro residual espacial da malha: 11.0642 
Erro residual temporal do passo: 0.2810 
Erro relativo da solução 0.0108 
Erro residual máximo = 2.8804 no elemento 416 
Erro residual mínimo = 0.0001 no elemento 1008 
----------------------------------------- 
time: 2000.0 

Malha deformada 
e sem refinamento 

Erro residual espacial da malha: 6.0849 
Erro residual temporal do passo: 0.1159 
Erro relativo da solução 0.0059 
Erro residual máximo = 0.8966 no elemento 455 
Erro residual mínimo = 0.0001 no elemento 86 
----------------------------------------- 
time: 2000.0 

Malha deformada 
e com refinamento 

Erro residual espacial da malha: 4.3797 
Erro residual temporal do passo: 0.1206 
Erro relativo da solução 0.0036 
Erro residual máximo = 0.5021 no elemento 419 
Erro residual mínimo = 0.0000 no elemento 86 
----------------------------------------- 
time: 2000.0 

 

A análise apresentada na tabela 5.5 também contribui para a verificação do estimador de 

erro com características residuais para o transporte de contaminantes. As estratégias adotadas 

resultam numa diminuição real do erro espacial estimado. Verifica-se, através do estimador de 

erro, uma melhora na precisão da solução numérica JAVA da ordem de 38% com o emprego 

de uma malha deformada em comparação do erro na malha original. E verifica-se, ainda, uma 

melhora de 60%, se a técnica da malha deformada for combinada com a estratégia de 

refinamento adaptativo considerando o parâmetro Y ? 0,5. 
O valor do erro residual determinado sobre o patch do nó central 532 é fortemente 

influenciado pelas estratégias apresentada neste capítulo. A figura 5.23 apresenta a evolução 

do erro residual observado no patch do nó 532, que foi calculado na malha original, na malha 

deformada e sem refinamento, e na malha deformada com refinamento. 

Verifica-se que o estimador residual responde adequadamente na determinação precisa 

do erro no patch de elementos, quando são empregadas estratégias de otimização da malha 

inicial. 



    Departamento de Hidráulica e Saneamento – PPG SHS EESC USP                                 97 

 
FIG 5.23 – Comparação do erro residual do patch 532 na malha original 

        e na malha deformada, sem refinamento e com refinamento 

 O erro residual estimado em cada passo de tempo nas três malhas apresentadas neste 

capítulo, também foi agrupado em um único gráfico. A figura 5.24 apresenta a diminuição 

desse erro residual em função das estratégias combinadas que otimizam a malha inicial. 

 
FIG 5.24 – Comparação do erro residual global na malha original 

na malha deformada sem refinamento e com refinamento 

 Verifica-se que, após as oscilações iniciais no erro residual, o comportamento 

assintótico é característico das três estratégias apresentadas neste capítulo. 

0

0,5

1

1,5

2

2,5

3

3,5

4

4,5

0 20 40 60 80 100 120 140 160 180 200

E
rr

o
 r

e
si

d
u

a
l

No. de passos de tempo de 10 dias [d]

Análise do erro residual do patch 532

Malha original

Deformada sem refino

Deformada com refino

0

5

10

15

20

25

30

35

40

0 20 40 60 80 100 120 140 160 180 200

E
rr

o
 R

e
si

d
u

a
l

No. de passos de tempo de 10 dias [d]

Análise do Erro Espacial Global

Malha original

Deformada sem refino

Deformada com refino



98                                  Resultados 

 Em relação aos limites superiores e inferiores já discutidos na subseção 5.1.2 

(desigualdade 5.2), para a malha original, e na seção 5.2 (desigualdade 5.3), para a malha 

deformada e sem o refinamento, a figura 5.25 apresenta o estimador residual limitado pelo 

erro real da malha deformada combinada com a estratégia de refinamento.  

 
FIG 5.25 – Obtenção dos limites inferiores /, [[4L4 e superiores /, \/4L4 do 

estimador de erro residual em malha deformada  
combinada com estratégia de refinamento 

 Verifica-se que o erro residual é limitado pela desigualdade: 

0,554?4 ? &amp;lt;? 0,904?4       (5.4) 
 Desta forma, para limitar o erro residual, a partir do 40º passo de tempo, é necessário 

um intervalo de amplitude 0,35, o que corresponde a uma melhora de 85% se comparado com 

a amplitude encontrada para limitar o erro residual na malha original. 

E ainda, as desigualdades (5.4) mostram que o erro residual tende a zero na mesma taxa 

de convergência em que o erro real tende a zero e que na simulação do transporte do 

contaminante 90Sr, o índice de eficiência do estimador residual espacial na malha deformada 

com refinamento passa a ser limitado por  

  
90,055,0 ?? fE , 

a partir do 40º passo de tempo. 

 

0

5

10

0 20 40 60 80 100 120 140 160 180 200

E
rr

o
 N

u
m

é
ri

co

No. de passos de tempo de 10 dias [d]

Limites Superiores e Inferiores do 
Estimador em malha deformada

e refinamento

Erro residual

Limite inferior

Limite superior



    Departamento de Hidráulica e Saneamento – PPG SHS EESC USP                                 99 

5.4 APLICAÇÃO DO ESTIMADOR DE ERRO RESIDUAL EM REGIME DE PEQUENA ADVECÇÃO 

Conforme apresentado na seção 3.4, o regime de pequena advecção é o regime 

apropriado ao campo de velocidade do fluxo de água subterrânea quando modelos 

matemáticos descrevem os fenômenos de transporte que ocorrem nos aqüíferos em estudo. 

Desta forma, nesta seção, o desempenho do estimador de erro residual será avaliado, 

considerando algumas técnicas computacionais de transporte de contaminantes provenientes 

da dinâmica dos fluidos em meio poroso saturado. 

Os exemplos numéricos para avaliação do erro espacial da solução por elementos 

finitos, através do estimador residual da equação 4.38 são adaptados da literatura e foram 

inicialmente apresentados na seção 3.4. Os cenários destes exemplos abrangem as diferentes 

escalas para o transporte de contaminantes no meio poroso. O primeiro exemplo considera a 

análise de erro num domínio em escala regional. Para os dois exemplos seguintes, que 

implementam, respectivamente, o transporte com reação de primeira ordem e o transporte 

com fenômenos de sorção, a análise de erro será realizada no domínio em escala de campo. 

No último exemplo, para o transporte unidimensional da atrazina em coluna de solo saturado, 

a análise será realizada em escala de laboratório. 

5.4.1 Solução Numérica da Equação de Advecção-Dispersão 

Nesta subseção é realizada a análise do estimador residual da solução numérica que será 

influenciada por diferentes discretizações do domínio retangular, ou seja, por diferentes 

valores para o número de Peclet da malha inicial. 

Em SOREK (1988) um método adaptativo 2D Euler-Lagrangiano foi utilizado para o 

transporte de massa com distribuição espacial da velocidade. A equação de advecção-

dispersão (EAD) para um constituinte efluente em um fluido incompressível considera: fator 

de retardo R &gt; 1, tensor de dispersão hidrodinâmica simétrico e semi-positivo e decaimento 

radioativo de 1ª ordem. Esse exemplo numérico para comparação com solução analítica e 

validação do método proposto considerou os seguintes parâmetros físicos: 



100                                  Resultados 

?? = ?] = 2 ?? ?? , para as dispersões nas direções dos eixos coordenados e _? = 0,25 ?/? 
e _] = 0 ?/? como sendo os componentes da velocidade do fluxo subterrâneo [VAROGLU e 
FINN, 1982 apud SOREK, 1988]44. 

A malha adotada com ?
 = ?? = 200? caracterizou o transporte em regime de 
advecção dominante, pois o número de Peclet na direção 
, foi ?? = `R??aR = 25 e ?] = 0 para 
a direção y. Nesta situação, o menor autovalor do tensor D foi ? = ?? = 2 e a constante 
?" ? ?,?O? = 0,125 era de tamanho moderado. Ou seja, o regime adotado neste exemplo 
numérico foi o de pequena advecção. 

A solução numérica obtida pelo código JAVA foi calculada sobre um domínio retangular 

de 3.200m x 3.200m cuja malha inicial contém 289 nós para constituir 256 elementos 

quadriláteros. O tempo final da simulação é de ?? = 50.000?, dividido em intervalos de 
tempo ?? = 5.000?. 

As condições iniciais adotadas são ?(
, ?, 0) = 0 no interior do domínio. As condições 
de fronteira são dadas pela expressão: 

?(
, ?, ?)
?? = b

1 ? c800 , 0 ? c ? 8000,       d%?e def?cáche
i 

sendo C0 a concentração inicial e r a distância entre os nós da fronteira ?D e o nó central do 

lado que contém a frente inicial de contaminação, situado na fronteira esquerda do domínio da 

figura 5.26. 

 A implementação JAVA desta condição de contorno possui as seguintes linhas de 

comando: 
 

for (int i = -Ymed; i&amp;lt;= Ymed; ++i){ 

double DeltaY = YWELL+(i-desloca)*YWELL/Math.pow(2.0, stepRef); 
 if (yy==DeltaY){ //Condição Inicial de Sorek, 1988 
     solute = 1.0-(Ymed/Math.pow(2.0, stepRef-3))*Math.abs(i)*DeltaYY/YFINAL; 
     concBC.put(node.id,solute); 
     concInit[node.id]=solute; 
  } 
  DeltaY+=DeltaYY; 
} 

 

 

 

 

                                                 

44 Varoglu E., Finn W. D. L., “Utilization of the method of characteristics to solve accurately two dimensional 
transport problems by finite elements”.  Inter J. Num Methods in Fluid, 2, 173-184, 1982. 



    Departamento de Hidráulica e Saneamento – PPG SHS EESC USP                                 101 

 
 
 
 
 
 
 
 

FIG 5.26 – Frente de contaminante obtida com os parâmetros físicos adaptados  
de SOREK (1988), no instante t = 10.000s em regime de pequena advecção 

A determinação da solução JAVA apenas na metade superior do domínio é uma das 

flexibilidades existentes no código implementado. Considerando essa simetria na solução 

numérica, a utilização do domínio computacional aumenta em 50%. A figura 5.26 ilustra a 

distribuição da concentração do contaminante, para o instante t = 10.000s, na metade superior 

do domínio computacional. As curvas de isoconcentrações são exibidas em intervalos de 0,2 

em 0,2 dos valores normalizados e o comando de atualização é boolean simetria = true; 

A análise de erro da solução numérica é realizada em domínios com os seguintes 

valores de bipartição:  

• int stepRef = 3  (256 elementos e 289 nós); 
• int stepRef = 4  (1024 elementos e 1089 nós); 
• int stepRef = 5  (4096 elementos e 4225 nós). 

Os resultados das simulações estão organizados na tabela 5.6. 

Tabela 5.6 – Desempenho do estimador de erro residual aplicado em malhas iniciais 
com quantidades distintas de elementos em regime de pequena advecção (Cc = 0,125) 

Malha inicial com  
256 elementos ??? = 25 e ?? = 6,25 

Erro residual espacial da malha: 9.7597 
Erro relativo da solução 0.0381 
Erro residual máximo = 1.9124 no elemento 0 
Erro residual mínimo = 0.0000 no elemento 251 
----------------------------------------- 
time: 50000.0 

Malha inicial com 
1024 elementos ??? = 12,5 e ?? = 12,5 

Erro residual espacial da malha: 4.9027 
Erro relativo da solução 0.0048 
Erro residual máximo = 0.5217 no elemento 0 
Erro residual mínimo = 0.0000 no elemento 997 
----------------------------------------- 
time: 50000.0 

Malha inicial com 
4096 elementos ??? = 6,25 e ?? = 25 

Erro residual espacial da malha: 2.4481 
Erro relativo da solução 0.0006 
Erro residual máximo = 0.1388 no elemento 0 
Erro residual mínimo = 0.0000 no elemento 4095 
----------------------------------------- 
time: 50000.0 

 

 Verifica-se que o erro indicado pelo estimador residual diminui consideravelmente com 

o tipo de malha inicial adotada. O gráfico exibido na figura 5.27 demonstra a correlação 

perfeita (R2 = 1) entre o valor do erro residual e o número de Peclet da malha correspondente 

quando o regime é de advecção dominante. 

                          3200 m 
800 m 
                   vx = 0,25 m/s 
 
800 m 



102                                  Resultados 

 
FIG 5.27 – Relação linear entre o erro residual e o número de 
Peclet da malha inicial para a equação de advecção-dispersão 

 A equação de regressão linear ? ? 2,5657
 ? 0,0502 é uma forte evidência de que o 
erro indicado pelo estimador residual&amp;lt;? tende a zero quando o tamanho da malha ?x tende a 
zero, pois, se ? = ??? ? 0 segue que ?
 ? 0, logo  

lim????&amp;lt;? ? 0       (5.2) 
 A correlação observada entre os valores dos erros relativos das malhas iniciais acima e o 

respectivo número de Peclet foi de 97,3%. Para os valores dos erros máximos, determinou-se 

uma correlação de 99,2% com os correspondentes números de Peclet. 

 A figura 5.28 ilustra a solução numérica JAVA nas malhas iniciais indicadas na tabela 

5.5 e no passo de tempo igual a 50.000s (tempo final da simulação). A malha inicial com 

1024 elementos (?
 = 100?) é o refinamento uniforme da malha inicial com 256 elementos 
(?
 = 200?). E ainda, a malha inicial com 4096 elementos (?
 = 50?) é o refinamento 
uniforme da malha inicial com 1024 elementos (?
 = 100?). 

Conforme os valores do erro máximo, especificados na tabela 5.5, o estimador de erro 

residual, para a equação do transporte de contaminantes, é adequado para conduzir uma 

estratégia de refinamento adaptativo, pois, foi capaz de identificar o elemento que apresenta o 

erro máximo – o elemento 0 – em todos os casos descritos na simulação numérica. Esse 

elemento identificado situa-se no canto inferior esquerdo dos mapas de isoconcentrações 

ilustrados na figura 5.26. 

9,7597

4,9027

2,4481
y = 2,5657x - 0,0502

R² = 1

0

5

10

15

20

25

30

0 1 2 3 4 5 6 7 8 9 10

N
o

. 
d

e
 P

e
cl

e
t

Erro estimado na malha inicial

Correlação do estimador residual
para o caso de advecção dominante



    Departamento de Hidráulica e Saneamento 

FIG 5.28 – Solução numérica 
em malhas com di

de advecção dominante no passo de tempo igual a 50.000

 

Visualmente, não existem diferenças importantes entre as curvas de isoconcentração, no 

entanto, o valor normalizado é mais preciso quando calculado no nó 

elementos, pois, verifica-se que o erro residual máximo possui o menor valor nessa última 

malha inicial. 

256 elementos

????x = 200

1024 elementos

????x = 100

4096 elementos

????x = 50

Departamento de Hidráulica e Saneamento – PPG SHS EESC USP       

Solução numérica JAVA da equação de advecção-dispersão
em malhas com diferentes valores de Peclet indicando regime 

de advecção dominante no passo de tempo igual a 50.000

Visualmente, não existem diferenças importantes entre as curvas de isoconcentração, no 

entanto, o valor normalizado é mais preciso quando calculado no nó 

se que o erro residual máximo possui o menor valor nessa última 

256 elementos

x = 200m

1024 elementos

x = 100m

4096 elementos

x = 50m

0,8-1

0,6-0,8

0,4-0,6

0,2-0,4

0-0,2

                           103 

 

 

 
dispersão 

ferentes valores de Peclet indicando regime  
de advecção dominante no passo de tempo igual a 50.000s 

Visualmente, não existem diferenças importantes entre as curvas de isoconcentração, no 

entanto, o valor normalizado é mais preciso quando calculado no nó da malha com 4096 

se que o erro residual máximo possui o menor valor nessa última 

0,8

0,6

0,4



104                                  Resultados 

5.4.2 Solução Numérica da Equação de Advecção-Dispersão-Reação 

Nesta subseção é realizada a análise do estimador de erro residual espacial da solução 

numérica que será influenciada pela mudança no parâmetro ? da aproximação da derivada 

temporal da equação 4.26. 

No caso de fluxo unidimensional na direção x, PARKHURST (2004) apresenta uma 

simulação de transporte de espécies químicas nas três direções x, y e z, com reações de 

decaimento de 1ª ordem. 

Os parâmetros deste exemplo são: velocidade intersticial _ ? 0,2 ?/Fh%, coeficiente de 
dispersividade longitudinal G? = 1,5 ?, dispersividade horizontal transversal G?j = 0,3 ?, 
dispersividade vertical transversal G?k = 0,1 ? e taxa constante de decaimento 
' = 0,05 F@,. Com estes valores, o tensor de dispersão é a matriz diagonal 
?BlB = Fh%m(0,30 0,06 0,02). Considerando que o menor autovalor da matriz ?BlB, 
? = 0,02 é, neste caso, menor que o coeficiente ' = 0,05, pode-se determinar que 

?" ? |v| ?,??%
&amp;amp;?, '(,? =
0,2

(0,02),?(0,05),? = 6,32 

é uma constante de tamanho moderado, ou seja, o exemplo encontra-se no regime de pequena 

advecção, cujo número de Peclet é Pex = 20,8 e o de Courant é Cx = 0,32. 

O domínio computacional de PARKHURST (2004) originalmente simulou uma região 3D 

de dimensões 100m de comprimento, 40m largura e 25m de altura, cuja adaptação espacial 

nas dispersividades do exemplo 2 da seção 3.4 (pg. 22) revelou que o menor autovalor de 

?BlB, ? = 0,02, era menor que a taxa de decaimento ' = 0,05 F@,. E ainda, o regime do 
transporte é de pequena advecção com ?" = 6,32 em uma malha inicial. 

As condições iniciais são as mesmas da subseção 5.3.1 e a condição de fronteira 

descreve a concentração normalizada em exatamente 20m centrados no lado esquerdo do 

domínio retangular. Na solução numérica, com o código desenvolvido JAVA, é considerado 

um domínio 2D com matriz de dispersão ? = o0,06 00 0,02p e porosidade constante é igual a 
0,1. A figura 5.29 ilustra os valores das concentrações normalizadas obtidas nos 289 nós do 

domínio 100m x 40m após a simulação de 400 dias. 

 



    Departamento de Hidráulica e Saneamento – PPG SHS EESC USP                                 105 

0 0,0001 0,0001 0,0001 0 0 0 0 0 0 0 0 0 0 0 0 0 

0 0,0002 0,0002 0,0001 0,0001 0 0 0 0 0 0 0 0 0 0 0 0 

0 0,0008 0,0006 0,0004 0,0002 0,0001 0,0001 0 0 0 0 0 0 0 0 0 0 

0 0,0029 0,0025 0,0016 0,0009 0,0005 0,0003 0,0001 0,0001 0 0 0 0 0 0 0 0 

1 0,4311 0,1855 0,0802 0,0344 0,0149 0,0064 0,0028 0,0012 0,0005 0,0002 0,0001 0 0 0 0 0 

1 0,4348 0,1887 0,0823 0,0356 0,0155 0,0067 0,0029 0,0013 0,0006 0,0002 0,0001 0 0 0 0 0 

1 0,4338 0,1879 0,0817 0,0353 0,0154 0,0067 0,0029 0,0013 0,0005 0,0002 0,0001 0 0 0 0 0 

1 0,4341 0,1881 0,0819 0,0354 0,0154 0,0067 0,0029 0,0013 0,0005 0,0002 0,0001 0 0 0 0 0 

1 0,4340 0,1880 0,0818 0,0353 0,0154 0,0067 0,0029 0,0013 0,0005 0,0002 0,0001 0 0 0 0 0 

1 0,4341 0,1881 0,0819 0,0354 0,0154 0,0067 0,0029 0,0013 0,0005 0,0002 0,0001 0 0 0 0 0 

1 0,4338 0,1879 0,0817 0,0353 0,0154 0,0067 0,0029 0,0013 0,0005 0,0002 0,0001 0 0 0 0 0 

1 0,4348 0,1887 0,0823 0,0356 0,0155 0,0067 0,0029 0,0013 0,0006 0,0002 0,0001 0 0 0 0 0 

1 0,4311 0,1855 0,0802 0,0344 0,0149 0,0064 0,0028 0,0012 0,0005 0,0002 0,0001 0 0 0 0 0 

0 0,0029 0,0025 0,0016 0,0009 0,0005 0,0003 0,0001 0,0001 0 0 0 0 0 0 0 0 

0 0,0008 0,0006 0,0004 0,0002 0,0001 0,0001 0 0 0 0 0 0 0 0 0 0 

0 0,0002 0,0002 0,0001 0,0001 0 0 0 0 0 0 0 0 0 0 0 0 

0 0,0001 0,0001 0,0001 0 0 0 0 0 0 0 0 0 0 0 0 0 

 
FIG 5.29 – Solução numérica da equação de advecção-dispersão-reação (ADR) 
com parâmetros físicos adaptados de PARKHURST (2004) no instante t = 400d  

 O estimador residual para a equação de advecção-dispersão-reação (ADR), com 

parâmetros físicos fornecidos por PARKHURST (2004), em regime de pequena advecção, 

apresentou as estimativas do erro para os seguintes esquemas de aproximação da derivada 

temporal da equação (4.25): 

• double theta = 1.0/2.0; //esquema de Crank-Nicolson 
• double theta = 2.0/3.0; //esquema de Galerkin 
• double theta = 1.0; //esquema de Euler ímplicito 

 O código JAVA aplica a solução analítica de WEXLER (1992) para obter o erro real da 

malha e o correspondente índice de eficiência no último passo de tempo, ou seja, em 

t = 400d.  

A tabela 5.7 organiza os resultados obtidos após a simulação para 400 dias. 

 Verifica-se que a solução numérica obtida pelo esquema de Crank-Nicolson, mesmo 

numa margem tolerável do índice de eficiência, superestima o erro residual na malha inicial. 

Quando o esquema empregado é o Euler implícito, a solução numérica subestima o erro real e 

o índice de eficiência encontra-se um pouco abaixo do esperado. 

A solução numérica do esquema de Galerkin, além de apresentar o menor erro residual 

espacial demonstrou uma excelente eficiência do estimador com índice igual a 1,0415. 

Assim, verifica-se que, o erro real da solução numérica é menor quando é obtida pelo 

esquema de Crank-Nicolson (ver figura 5.30). No entanto, para este problema teste em que o 

valor de ? = 0,05 d-1, supera o valor do menor autovalor da matriz de dispersão, ? ? 0,02, o 
esquema de Galerkin é o esquema de discretização temporal com índice de eficiência mais 

próximo de 1,0. Logo, para as equações de advecção-dispersão-reação, cujos parâmetros 

físicos foram os adaptados de PARKHURST (2004), o erro residual espacial foi melhor 

estimado quando o esquema de discretização temporal foi realizado com parâmetro q = ?B. 



106 

Tabela 5.7 – Desempenho do estimador de erro residual aplicado em malhas iniciais
com distintos valores do parâmetro 

Esquema de aproximação de
Crank-Nicolson,

q ? 1/2

Esquema de aproximação de
Galerkin45

q ? 2/3

Esquema de aproximação de
Euler implícito,

q ? 1 

 

 As figuras a seguir exibem os erros de discretização sobre a 

os três esquemas de discretização temporais aplicados nesta subseção para as eq

FIG 5.30 – Distribuição dos erros reais na aplicação do esquema de Crank

                                                

45 Para referenciar a nomenclatura do método em função

0

0,05

0,1

0,15

0,2

0,25

0,3

0,35

0,4

0,45

Erro real no esquema de Crank

                                 

Desempenho do estimador de erro residual aplicado em malhas iniciais
valores do parâmetro ????  de discretização temporal e 

Esquema de aproximação de 
Nicolson, 

2 

Erro real da malha: 00.8429 
Erro máximo de 00.0571 no nó: 53 
 
Erro residual espacial da malha: 1.7420
Erro residual temporal do passo: 0.0000
Erro relativo da solução 0.0068 
Erro residual máximo = 0.5650 no elemento 64
Erro residual mínimo = 0.0000 no elemento 255
-----------------------------------------
Efic[40] = 02.0668 
time: 400.0 

Esquema de aproximação de 
45, 
3 

Erro real da malha: 01.2268 
Erro máximo de 00.0561 no nó: 223
 
Erro residual espacial da malha: 1.2777
Erro residual temporal do passo: 0.0002
Erro relativo da solução 0.0050 
Erro residual máximo = 0.3915 no elemento 64
Erro residual mínimo = 0.0000 no elemento 255
-----------------------------------------
Efic[40] = 01.0415 
time: 400.0 

Esquema de aproximação de 
Euler implícito, 

 

Erro real da malha: 01.8751 
Erro máximo de 00.0544 no nó: 223
 
Erro residual espacial da malha: 1.
Erro residual temporal do passo: 0.00
Erro relativo da solução 0.0056 
Erro residual máximo = 0.3956 no elemento 
Erro residual mínimo = 0.0000 no elemento 1
-----------------------------------------
Efic[40] = 00.7597 
time: 400.0 

exibem os erros de discretização sobre a mesma 

de discretização temporais aplicados nesta subseção para as eq

Distribuição dos erros reais na aplicação do esquema de Crank

         

Para referenciar a nomenclatura do método em função do valor de q ver [DONEA e H

Erro real no esquema de Crank-Nicolson

                                Resultados 

Desempenho do estimador de erro residual aplicado em malhas iniciais 
de discretização temporal e Cc = 6,32 

 

Erro residual espacial da malha: 1.7420 
Erro residual temporal do passo: 0.0000 

0 no elemento 64 
Erro residual mínimo = 0.0000 no elemento 255 
----------------------------------------- 

Erro máximo de 00.0561 no nó: 223 

l espacial da malha: 1.2777 
Erro residual temporal do passo: 0.0002 

Erro residual máximo = 0.3915 no elemento 64 
Erro residual mínimo = 0.0000 no elemento 255 
----------------------------------------- 

no nó: 223 

Erro residual espacial da malha: 1.4245 
esidual temporal do passo: 0.0021 

no elemento 160 
no elemento 15 

----------------------------------------- 

mesma malha inicial para 

de discretização temporais aplicados nesta subseção para as equações ADR. 

 
Distribuição dos erros reais na aplicação do esquema de Crank-Nicolson 

HUERTA, 2004, pg. 92] 

0,4-0,45

0,35-0,4

0,3-0,35

0,25-0,3

0,2-0,25

0,15-0,2

0,1-0,15

0,05-0,1

0-0,05



    Departamento de Hidráulica e Saneamento 

 Os valores máximos observados nos picos da figura 5.30 referem

determinados sobre os nós simétricos 53 e 223. A ocorrência destes valores má

observada nesses nós quando se aplica os esquemas de discretização de Galerkin (conforme 

figura 5.31) e de Euler Implícito (conforme figura 5.32).

FIG 5.31 – Distribuição dos erros reais na aplicação do esquema de Galerkin

 Verifica-se que o método de Crank

malha menor que os erros reais dos outros dois esquemas. Verifica

de Galerkin, que possui melhor índice de eficiência entre os três esquemas, uma precisão mais 

apurada que no método de Euler Implícito.

FIG 5.32 – Distribuição dos erros reais na aplicação do esquema de 

0

0,05

0,1

0,15

0,2

0,25

0,3

0,35

0,4

0,45

Erro real no esquema de Galerkin

0

0,05

0,1

0,15

0,2

0,25

0,3

0,35

0,4

0,45

Erro real no esquema de Euler Implícito

Departamento de Hidráulica e Saneamento – PPG SHS EESC USP       

máximos observados nos picos da figura 5.30 referem

determinados sobre os nós simétricos 53 e 223. A ocorrência destes valores má

observada nesses nós quando se aplica os esquemas de discretização de Galerkin (conforme 

figura 5.31) e de Euler Implícito (conforme figura 5.32). 

Distribuição dos erros reais na aplicação do esquema de Galerkin

o método de Crank-Nicolson é mais preciso por apresentar 

malha menor que os erros reais dos outros dois esquemas. Verifica-se ainda que no esquema 

de Galerkin, que possui melhor índice de eficiência entre os três esquemas, uma precisão mais 

urada que no método de Euler Implícito. 

Distribuição dos erros reais na aplicação do esquema de Euler Implícito

Erro real no esquema de Galerkin

Erro real no esquema de Euler Implícito

                           107 

máximos observados nos picos da figura 5.30 referem-se aos erros reais 

determinados sobre os nós simétricos 53 e 223. A ocorrência destes valores máximos é ainda 

observada nesses nós quando se aplica os esquemas de discretização de Galerkin (conforme 

 
Distribuição dos erros reais na aplicação do esquema de Galerkin 

Nicolson é mais preciso por apresentar erro real da 

se ainda que no esquema 

de Galerkin, que possui melhor índice de eficiência entre os três esquemas, uma precisão mais 

 
Euler Implícito 

0,4-0,45

0,35-0,4

0,3-0,35

0,25-0,3

0,2-0,25

0,15-0,2

0,1-0,15

0,05-0,1

0-0,05

0,4-0,45

0,35-0,4

0,3-0,35

0,25-0,3

0,2-0,25

0,15-0,2

0,1-0,15

0,05-0,1

0-0,05



108 

5.4.3 Solução Numérica da Equação de Advecção

Nesta subseção é realizada 

examina a proporcionalidade existente 

Dirichlet e o valor do erro estimado

Um método numérico livre de malha, chamado de método de interpolação de ponto 

radial, foi apresentado por 

equação de advecção-dispersão

dominante (Px = 2,86) os autores consideraram um expressivo valor para o fator de retardo, 

R = 7,267. Dos parâmetros físicos 

regime de pequena advecção.

A solução numérica de 

retangular de dimensões 80

valores das dispersividades lon

1,75 ?. O tempo final da 

(d = dia). 

As condições iniciais

as condições de fronteira, a

situada na região central da fronteira esquerda do domínio da figura 

solução numérica JAVA do transporte de contaminantes com parâmetros físicos de

acima para t = 60d. 

FIG 5.33 –  Solução numérica da equação de advecção
parâmetros físicos adaptados de 

                                 

Numérica da Equação de Advecção-Dispersão-Sorção

Nesta subseção é realizada uma análise do estimador de erro residual espac

proporcionalidade existente entre os valores CD da concentração 

e o valor do erro estimado. 

Um método numérico livre de malha, chamado de método de interpolação de ponto 

radial, foi apresentado por KUMAR e DODAGOUDAR (2008) para a resolução bidimensional da 

dispersão-sorção em meio poroso saturado. Em regime

= 2,86) os autores consideraram um expressivo valor para o fator de retardo, 

Dos parâmetros físicos deste exemplo, pode-se obter ?" ? 0

regime de pequena advecção. 

A solução numérica de KUMAR e DODAGOUDAR (2008) foi implementada em domínio 

80m x 80m e velocidade do fluxo subterrâneo 

valores das dispersividades longitudinal e transversal são, respectivamente, 

 simulação foi Tf = 60d, dividido em passos de tempo 

As condições iniciais deste problema teste são iguais às dos exemplos anteriores. Para 

ões de fronteira, a frente inicial de contaminação de 20m, com 

situada na região central da fronteira esquerda do domínio da figura 5.33

do transporte de contaminantes com parâmetros físicos de

Solução numérica da equação de advecção-dispersão-sorção com 
parâmetros físicos adaptados de KUMAR e DODAGOUDAR (2008) no instante 

                                Resultados 

Sorção 

estimador de erro residual espacial que 

da concentração na fronteira de 

Um método numérico livre de malha, chamado de método de interpolação de ponto 

(2008) para a resolução bidimensional da 

sorção em meio poroso saturado. Em regime de advecção 

= 2,86) os autores consideraram um expressivo valor para o fator de retardo,  

0,57 para caracterizar o 

(2008) foi implementada em domínio 

e velocidade do fluxo subterrâneo vx = 0,864 m/dia. Os 

gitudinal e transversal são, respectivamente, G? ? G? ?

, dividido em passos de tempo ?t = 10d 

is às dos exemplos anteriores. Para 

, com CD = 1,0 g/m
3, está 

5.33. Essa figura exibe a 

do transporte de contaminantes com parâmetros físicos descritos 

 
sorção com  

(2008) no instante t = 60d  



    Departamento de Hidráulica e Saneamento – PPG SHS EESC USP                                 109 

O erro residual estimado da solução numérica da equação de advecção-dispersão-sorção 

com parâmetros físicos adaptados de KUMAR e DODAGOUDAR (2008) é apresentado na tabela 

5.8 no instante Tf = 60d para diferentes valores de CD. 

A análise realizada verificou uma proporcionalidade existente entre o resíduo estimado 

e o valor da concentração inicial na frente de contaminação. A proporção obtida verifica-se 

também para o erro relativo e para o erro residual máximo. 

 A proporcionalidade verificada no exemplo acima é uma característica intrínseca do 

estimador de erro residual e é observada em todos os passos de tempo da simulação. De forma 

geral, se &amp;lt;é a quantidade estimada do erro espacial (erro na malha inicial, erro relativo ou 
resíduo no nível elemento) para uma quantidade constante CD da concentração na frente de 

contaminante, então para uma concentração inicial igual a kCD a quantidade estimada passa a 

ser r&lt;, revelando a característica de proporcionalidade do estimador de erro residual espacial. 
Tabela 5.8 – Proporcionalidade existente entre a concentração inicial na 

fronteira de Dirichlet e o erro residual espacial obtido pelo estimador 

CD = 0.75 

Erro residual espacial da malha: 0.8849 
Erro relativo da solução 0.0009 
Erro residual máximo = 0.1284 no elemento 511 
Erro residual mínimo = 0.0000 no elemento 31 
----------------------------------------- 
time: 60.0 

CD = 1.0 

Erro residual espacial da malha: 1.1798 
Erro relativo da solução 0.0012 
Erro residual máximo = 0.1711 no elemento 511 
Erro residual mínimo = 0.0000 no elemento 31 
----------------------------------------- 
time: 60.0 

CD = 2.5 

Erro residual espacial da malha: 2.9495 
Erro relativo da solução 0.0029 
Erro residual máximo = 0.4279 no elemento 511 
Erro residual mínimo = 0.0000 no elemento 31 
----------------------------------------- 
time: 60.0 

 

O indicador elemento residual RK, que apresenta a proporcionalidade do estimador de 

erro, no qual é evidente na norma L2 do erro real, é dado pela equação: 

( ) ( )
( ) ( )11

11

11

11

)1()1(      

))1((
1

??

??

??

??

?+??+???

?+?+??=

nnnnnn

nnnnn

n
K

nnnn

nnnn

CCCC

CCDdivCCfR

TTTT

TTTTI

?????

??
?

v

 

descrita previamente na seção 4.5. 

Verifica-se que a proporção quando imposta em CD é repassada pelo código JAVA para 

n

n
C
T

 da equação acima e este, por sua vez, para o elemento residual RK. O resultado sobre 

proporcionalidade foi observado em todos os testes numéricos empregados pelo código JAVA. 

Este comportamento sugere que o código JAVA encontra-se adequadamente implementado ao 

satisfazer estas mínimas condições que mantêm a proporcionalidade do erro estimado. 



110                                  Resultados 

5.4.4 Transporte 1D de Atrazina em coluna de solo Saturado 

Nesta subseção é realizada uma análise da evolução do erro residual global da solução 

numérica influenciada pela quantidade de massa de contaminante que é acrescida no domínio 

poligonal da equação para cada passo de tempo da simulação. Este erro residual global é dado 

por: 

( ) ( )[ ] 2
1

1

222

)(000 2

?
?
?

?
?
?

++?= ?
=

?

I

TI

N

n

n
t

n
nL n

CC ?????  

com os estimadores residuais n
nT

?  e estimadores temporais nt?  descritos na subseção 4.5.1. 

Para os valores de entrada adaptados do modelo fracionário de HUANG et al. (2008) para 

o transporte de atrazina, foi realizado uma adequação no programa JAVA definindo a 

dispersividade transversal nula para caracterizar, desta forma, o problema do transporte de 

contaminante unidimensional. O domínio, em escala de laboratório, considera uma coluna de 

solo saturado de 20 cm de comprimento e 1 mm de largura. 

O valor indicado por HUANG et al. (2008) para a porosidade foi 20% e o correspondente 

fator de retardo foi s ? 1,825. Foram definidos _ = 1,9 d?/?hf para a velocidade no poro e 
? = 1,304 d??/?hf para a dispersão longitudinal. Assim, ?" ? ,,A?,t,EO = 2,659, ou seja, o 
experimento foi realizado em regime de pequena advecção. 

Empregando as mesmas condições iniciais dos problemas anteriores e concentração 

normalizada para a condição de fronteira no topo da coluna, a solução numérica que fornece a 

distribuição da concentração da atrazina no instante final da simulação, t = 20 min, é 

apresentada na figura 5.34. 

 
 

FIG 5.34 – Transporte de atrazina em coluna saturada de solo arenoso 
com parâmetros físicos adaptados de HUANG et al (2008) e t = 20 min. 



    Departamento de Hidráulica e Saneamento – PPG SHS EESC USP                                 111 

 A análise do erro residual global deste experimento 1D, realizado em regime de 

pequena advecção, verifica a correspondência existente entre os resultados do estimador em 

função da quantidade de massa acrescida nos nós do sistema. 

 Para isto, a malha inicial de 20cm de comprimento por 1mm de largura, com 63 nós, é 

implementada no código JAVA através dos comandos: 

 
// Malha quadrangular 
x = new double[] {0.0, 1.0, 2.0, 3.0, 4.0, 5.0, 6.0, 7.0, 8.0, 9.0, 10.0, 
   11.0, 12.0, 13.0, 14.0, 15.0, 16.0, 17.0, 18.0, 19.0, 20.0}; 
y = new double[] {9.95, 10.0, 10.05}; 

 

 A quantidade de massa acrescida no sistema computacional é determinada pela 

diferença entre a massa total de contaminante observada em um instante tn com a quantidade 

de massa total da malha no instante anterior tn-1. 

 É determinada uma correlação negativa igual a -0,9165 entre o aumento de 
I

?  e a 

quantidade de massa que foi acrescida na malha a cada passo de tempo. Isto significa que, de 

acordo com a evolução de 
I

? , o estimador residual dada pela tabela 5.9, o estimador residual 

global da solução numérica corresponde de forma adequada com a quantidade de massa 

acrescida no sistema computacional. A figura 5.35 exibe o gráfico com as disposições destas 

correspondências. 

 
FIG 5.35 – Relação entre o erro residual global da solução numérica e o correspondente 

acréscimo de massa no sistema computacional. Os parâmetros físicos da simulação foram 
adaptados do transporte de atrazina em solo saturado de adaptados de HUANG et al. (2008) 

 Os valores das abscissas estão em ordem decrescente para ficar de acordo com o 

comportamento da quantidade de massa acrescida a cada passo de tempo. 

2,8

3,0

3,2

3,4

3,6

3,8

4,0

4,2

0,00,51,01,52,02,53,03,5

E
rro

  R
e

sid
u

a
l G

lo
b

a
l

Acréscimo de massa no passo de tempo [g]

Evolução do Erro Global da Solução Numérica



112                                  Resultados 

 Os resultados dos 20 passos de tempo da simulação estão organizados na tabela 5.9 e 

apresenta, para cada passo de tempo, os valores decrescentes da quantidade de massa do 

contaminante introduzidas nos nós da malha inicial. 

Tabela 5.9 – Análise do erro da solução numérica do transporte de atrazina em coluna de solo 
arenoso saturado com parâmetros físicos adaptados de HUANG et al. (2008) e a respectiva 
quantidade de massa no sistema 

Passo de tempoPasso de tempoPasso de tempoPasso de tempo    EstiEstiEstiEstimador residualmador residualmador residualmador residual 
I

?          Massa no sistemaMassa no sistemaMassa no sistemaMassa no sistema    
time: 1,0 ERRO RESIDUAL GLOBAL DA SOLUÇÃO: 2,8162 

Erro residual espacial da malha: 2,8162 
Erro residual temporal do passo: 0,0000 

QUANTIDADE DE MASSA 
ACRESCIDA PELOS NÓS 
NO SISTEMA = 03,3254 

time: 2,0 ERRO RESIDUAL GLOBAL DA SOLUÇÃO: 3,6794 
Erro residual espacial da malha: 2,3679 
Erro residual temporal do passo: 0,0000 

QUANTIDADE DE MASSA 
ACRESCIDA PELOS NÓS 
NO SISTEMA = 02,8917 

time: 3,0 ERRO RESIDUAL GLOBAL DA SOLUÇÃO: 3,8815 
Erro residual espacial da malha: 1,2360 
Erro residual temporal do passo: 0,0000 

QUANTIDADE DE MASSA 
ACRESCIDA PELOS NÓS 
NO SISTEMA = 01,8760 

time: 4,0 ERRO RESIDUAL GLOBAL DA SOLUÇÃO: 3,9323 
Erro residual espacial da malha: 0,6305 
Erro residual temporal do passo: 0,0000 

QUANTIDADE DE MASSA 
ACRESCIDA PELOS NÓS 
NO SISTEMA = 01,3242 

time: 5,0 ERRO RESIDUAL GLOBAL DA SOLUÇÃO: 3,9640 
Erro residual espacial da malha: 0,5000 
Erro residual temporal do passo: 0,0000 

QUANTIDADE DE MASSA 
ACRESCIDA PELOS NÓS 
NO SISTEMA = 00,8913 

time: 6,0 ERRO RESIDUAL GLOBAL DA SOLUÇÃO: 3,9720 
Erro residual espacial da malha: 0,2523 
Erro residual temporal do passo: 0,0000 

QUANTIDADE DE MASSA 
ACRESCIDA PELOS NÓS 
NO SISTEMA = 00,6043 

time: 7,0 ERRO RESIDUAL GLOBAL DA SOLUÇÃO: 3,9843 
Erro residual espacial da malha: 0,3127 
Erro residual temporal do passo: 0,0000 

QUANTIDADE DE MASSA 
ACRESCIDA PELOS NÓS 
NO SISTEMA = 00,4359 

time: 8,0 ERRO RESIDUAL GLOBAL DA SOLUÇÃO: 3,9921 
Erro residual espacial da malha: 0,2496 
Erro residual temporal do passo: 0,0000 

QUANTIDADE DE MASSA 
ACRESCIDA PELOS NÓS 
NO SISTEMA = 00,2854 

time: 9,0 ERRO RESIDUAL GLOBAL DA SOLUÇÃO: 4,0053 
Erro residual espacial da malha: 0,3243 
Erro residual temporal do passo: 0,0000 

QUANTIDADE DE MASSA 
ACRESCIDA PELOS NÓS 
NO SISTEMA = 00,2200 

time: 10,0 ERRO RESIDUAL GLOBAL DA SOLUÇÃO: 4,0170 
Erro residual espacial da malha: 0,3061 
Erro residual temporal do passo: 0,0000 

QUANTIDADE DE MASSA 
ACRESCIDA PELOS NÓS 
NO SISTEMA = 00,1457 

time: 11,0 ERRO RESIDUAL GLOBAL DA SOLUÇÃO: 4,0323 
Erro residual espacial da malha: 0,3516 
Erro residual temporal do passo: 0,0000 

QUANTIDADE DE MASSA 
ACRESCIDA PELOS NÓS 
NO SISTEMA = 00,1165 

time: 12,0 ERRO RESIDUAL GLOBAL DA SOLUÇÃO: 4,0466 
Erro residual espacial da malha: 0,3394 
Erro residual temporal do passo: 0,0000 

QUANTIDADE DE MASSA 
ACRESCIDA PELOS NÓS 
NO SISTEMA = 00,0836 

time: 13,0 ERRO RESIDUAL GLOBAL DA SOLUÇÃO: 4,0632 
Erro residual espacial da malha: 0,3671 
Erro residual temporal do passo: 0,0000 

QUANTIDADE DE MASSA 
ACRESCIDA PELOS NÓS 
NO SISTEMA = 00,0656 

time: 14,0 ERRO RESIDUAL GLOBAL DA SOLUÇÃO: 4,0788 
Erro residual espacial da malha: 0,3561 
Erro residual temporal do passo: 0,0000 

QUANTIDADE DE MASSA 
ACRESCIDA PELOS NÓS 
NO SISTEMA = 00,0513 

time: 15,0 ERRO RESIDUAL GLOBAL DA SOLUÇÃO: 4,0959 
Erro residual espacial da malha: 0,3741 
Erro residual temporal do passo: 0,0000 

QUANTIDADE DE MASSA 
ACRESCIDA PELOS NÓS 
NO SISTEMA = 00,0397 

time: 16,0 ERRO RESIDUAL GLOBAL DA SOLUÇÃO: 4,1120 
Erro residual espacial da malha: 0,3643 
Erro residual temporal do passo: 0,0000 

QUANTIDADE DE MASSA 
ACRESCIDA PELOS NÓS 
NO SISTEMA = 00,0337 

time: 17,0 ERRO RESIDUAL GLOBAL DA SOLUÇÃO: 4,1293 
Erro residual espacial da malha: 0,3770 
Erro residual temporal do passo: 0,0000 

QUANTIDADE DE MASSA 
ACRESCIDA PELOS NÓS 
NO SISTEMA = 00,0282 

time: 18,0 ERRO RESIDUAL GLOBAL DA SOLUÇÃO: 4,1457 
Erro residual espacial da malha: 0,3683 
Erro residual temporal do passo: 0,0000 

QUANTIDADE DE MASSA 
ACRESCIDA PELOS NÓS 
NO SISTEMA = 00,0252 

time: 19,0 ERRO RESIDUAL GLOBAL DA SOLUÇÃO: 4,1629 
Erro residual espacial da malha: 0,3779 
Erro residual temporal do passo: 0,0000 

QUANTIDADE DE MASSA 
ACRESCIDA PELOS NÓS 
NO SISTEMA = 00,0225 

time: 20,0 ERRO RESIDUAL GLOBAL DA SOLUÇÃO: 4,1793 
Erro residual espacial da malha: 0,3704 
Erro residual temporal do passo: 0,0000 

QUANTIDADE DE MASSA 
ACRESCIDA PELOS NÓS 
NO SISTEMA = 00,0206 



    Departamento de Hidráulica e Saneamento – PPG SHS EESC USP                                 113 

 Verifica-se nesta tabela 5.9 que o erro temporal nt? , dado pela equação 4.37, é um valor 

insignificante para a presente simulação do transporte da atrazina em coluna de solo saturado. 

Ou seja, considerando a amplitude de cada intervalo de tempo 0,1=n?  e para 0?
n
t? , o erro 

residual global desta aplicação é simplificado para a expressão  

( ) 2
1

1

2

?
?
?

?
?
?

= ?
=

I

TI

N

n

n
n n

??? . 

 Esta aplicação mostra que, após simples ajustes, o estimador a posteriori implementado 

possui características abrangentes, no sentido de ser capaz de computar o erro numérico do 

modelo de transporte de contaminantes unidimensional. 

 

  



114                                  Resultados 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 



6 CONCLUSÃO 

Neste trabalho foi apresentado um estimador de erro a posteriori para a solução 

numérica da equação do transporte de contaminantes em meio poroso saturado, cujas 

características são de uma equação diferencial parcial parabólica.    

 O código desenvolvido em linguagem JAVA, compara a solução numérica da equação de 

advecção-dispersão-reação com a sua correspondente solução analítica dada por WEXLER 

(1992), em meio isotrópico e homogêneo, com campo de velocidades uniforme e regime 

predominantemente advectivo. Conclui-se que o estimador de erro pertencente à classe dos 

métodos residuais apresenta performance superior ao estimador de erro da classe dos métodos 

de recuperação, o estimador ZZ, quando o regime de transporte é o de pequena advecção. 

Para minimizar a ocorrência de oscilações espúrias da solução numérica da equação do 

transporte de contaminantes foi implementado o esquema S3 [WENDLAND e SCHMID, 2000] 

(Symmetrical Streamline Stabilization) no código JAVA que obtém a solução pelo método de 

elementos finitos. 

 De simplicidade computacional, o estimador residual espacial dado por 

2

1

~

2

)(

2
2

??

?
?
?

??

?
?
?

= ?
? n

n

K
KLKK

n R
T

T
??  

demonstrou-se assintoticamente estável para os problemas testes do transporte de 

contaminantes validados na literatura. O estimador ZZ, que emprega os métodos de 

recuperação, apresentou baixos índices de eficiência para os mesmos problemas. 

 Para avaliação do erro no patch de elementos finitos, o indicador elemento residual 

( ) ( )
( ) ( )11

11

11

11

)1()1(      

))1((
1

??

??

??

??

?+??+???

?+?+??=

nnnnnn

nnnnn

n
K

nnnn

nnnn

CCCC

CCDdivCCfR

TTTT

TTTTI

?????

??
?

v

 



116                                  Universidade de São Paulo – EESC 

é convergente, com o avanço do tempo, tanto para os nós à frente da fronteira de Dirichlet, 

quanto para os nós adjacentes à fronteira de Dirichlet. 

 Conclui-se que o estimador residual, através da análise no patch de elementos, é capaz 

de capturar a região da malha grosseira que apresenta o maior erro numérico conforme 

apresentado em comparação com uma solução analítica da equação do transporte. 

 O valor do indicador erro temporal, ou norma de energia do erro,  

1

1

?
?

?= nnnt nn CC TT?  ( ){ } 2
1

2

)(

1
2

)(

1    
2121 ?

?

?

?
??

?+??=
L

nn

L

nn

nnnn
CCCC
TTTT

??  

converge para zero com o avanço no passo de tempo. Este fato é um requisito mínimo para 

que o indicador temporal seja capaz de conduzir estratégias de refinamento adaptativo do 

intervalo de tempo da simulação numérica. 

 As curvas de passagem de soluto, ou curvas BTC[], provenientes da solução numérica e 

da solução analítica, para nós frontais e nós adjacentes à fronteira de Dirichlet, apresentam 

excelente concordância após a obtenção de parâmetros responsáveis pelos ajustes no erro 

fornecido pelo estimador residual espacial. 

O estimador de erro residual ? é limitado inferior e superiormente pela norma 

euclidiana do erro atual ???, ou seja, sobre a malha grosseira, é possível encontrar constantes 

?? e ??, tais que: 
????? ? ? ? ????? 

para todos os passos de tempo ? ? ?
 . Desta forma, o erro residual tende a zero na mesma taxa 
de convergência que o erro atual tende à zero.  

 Com a reorganização dos nós da malha inicial em uma estratégia que concentra os nós 

disponíveis junto à frente de contaminação, o estimador residual demonstrou as seguintes 

melhorias: 

• diminuição do erro global e do erro residual analisado no patch de elementos; 

• aumento na taxa de convergência do índice de eficiência para o valor 1;  

• aumento na taxa de convergência do estimador de erro temporal para o valor 0 e 

• diminuição da amplitude do intervalo (??, ??) formado pelas constantes positivas que 
limitam o erro residual na desigualdade ????? ? ? ? ?????. 

 



    Departamento de Hidráulica e Saneamento – PPG SHS EESC USP                         117 

 Na estratégia de refinamento adaptativo com parâmetro ? = 0,5, o estimador residual 
correspondeu com as seguintes contribuições: 

• menor quantidade na indicação de elementos para o refinamento de malhas com atraso; 

• diminuição do erro máximo e do erro espacial no patch de elementos; 

• diminuição do erro espacial global da malha com atraso e 

• diminuição da amplitude do intervalo (??, ??) para limitar o erro na malha com atraso. 
 

 Em regime de pequena advecção, o estimador residual apresentou-se de forma adequada 

na análise do erro da solução numérica do transporte de contaminantes em água subterrânea 

em escala regional, em escala de campo e em escala de laboratório. Nos problemas testes 

analisados da literatura, que apresentam diferentes fenômenos de transporte para modelar o 

transporte de contaminante em meio poroso saturado, o estimador residual corresponde 

satisfatoriamente aos testes realizados, conforme descrito abaixo: 

• O erro residual estimado da solução numérica da equação de advecção-dispersão 

(EAD), em escala regional, apresenta valor proporcional ao número de Peclet local, que é 

caracterizado pelo grau de refinamento uniforme da malha inicial. Isto significa que o 

estimador residual espacial tende a um valor nulo quando o tamanho da malha tende a 

zero. Ou seja, o erro residual espacial é assintoticamente correto no sentido de tender a 

zero na mesma taxa que o erro real tende a zero quando o tamanho da malha diminui. 

 

• Com a implementação do termo de reação de 1ª ordem, o estimador residual para a 

equação de advecção-dispersão-reação (ADR), em escala de campo e com os parâmetros 

físicos fornecidos por PARKHURST (2004), mostrou que as estimativas do erro são 

sensíveis aos esquemas de aproximação da derivada temporal tais como: Crank-Nicolson, 

Galerkin ou Euler Implícito. 

 

• Ainda em escala de campo, a análise do erro da solução numérica da equação de 

advecção-dispersão-sorção (ADR) em meio poroso saturado, com parâmetros físicos 

adaptados de KUMAR e DODAGOUDAR (2008), apresentou estimativas residuais 

proporcionais à concentração inicial na fronteira de Dirichlet. Esta característica, evidente 

na norma L2 do erro atual, pode ser estendida para qualquer problema teste que emprega 

o estimador residual em regime de pequena advecção. 



118                                  Universidade de São Paulo – EESC 

•  O estimador residual do código JAVA abrange a solução numérica dos problemas do 

transporte unidimensional de contaminantes em meio poroso saturado. A adequação do 

estimador no transporte de atrazina em coluna de solo saturado, com os parâmetros 

físicos de HUANG et al. (2008) em escala de laboratório, apresentou uma boa correlação 

entre a quantidade de massa de soluto acrescida no sistema computacional e o erro global 

da solução dado por ( ) ( )[ ] 2
1

1

222

)(000 2

?
?
?

?
?
?

++?= ?
=

?

I

TI

N

n

n
t

n
nL n

CC ????? . 

 Com a descrição acima, conclui-se que o estimador residual proposto é robusto no 

sentido de abranger uma grande variedade de aplicações dos fenômenos de transporte de 

contaminantes em meio poroso saturado e regime de pequena advecção. Para esses 

problemas, a confiabilidade no método empregado para a obtenção da solução numérica é 

garantida ao verificar-se que o estimador residual é assintoticamente exato, ou seja, ao 

verificar-se que o erro estimado aproxima-se do erro atual da solução em malha grosseira. 

 De forma geral, o estimador residual espacial proposto, além de indicar a precisão da 

solução numérica avaliada, mensurou a distribuição do erro local sobre o domínio 

computacional, para cada passo de tempo das simulações apresentadas. 

 Do ponto de vista da Engenharia, o estimador de erro a posteriori deste trabalho possui 

custo computacional menos expressivo do que aquele necessário para recalcular a solução 

numérica em uma malha totalmente refinada. Este fato pode ser observado se comparar a 

grande quantidade de classes da POO que compõem o código JAVA para obter a solução 

numérica da equação do transporte com o número reduzido de classes, do mesmo código, para 

obter a correspondente estimativa do erro residual. 

6.1 SUGESTÕES PARA TRABALHOS FUTUROS 

Esta seção descreve as sugestões para trabalhos futuros que poderiam complementar os 

assuntos abordados nesta tese ou, de forma mais específica, permitir a continuidade nas 

discussões dos tópicos alinhados com as metodologias para estimativa a posteriori do erro de 

aproximação da solução numérica da equação de advecção-dispersão-reação em meio poroso. 



    Departamento de Hidráulica e Saneamento – PPG SHS EESC USP                         119 

Com o desenvolvimento do código JAVA até o presente, torna-se viável o acoplamento 

entre a solução numérica da equação do fluxo subterrâneo e a solução numérica do transporte 

de contaminantes em águas subterrâneas. A primeira equação fornece o campo de velocidades 

de um domínio computacional, em função da descrição das condutividades hidráulicas, e é 

posteriormente aplicada na equação de advecção-dispersão-reação, fornecendo caráter realista 

aos fenômenos de transporte no aquífero que está sendo modelado. Ambas as soluções já 

possuem os seus respectivos estimadores de erros a posteriori implementadas no código JAVA 

favorecendo o emprego, de forma independente, das estratégias de refinamento adaptativo que 

poderiam ser empregadas. 

A otimização do código JAVA poderia resultar com a implementação de um solver mais 

eficiente do ponto de vista computacional, pois, métodos iterativos disponíveis na literatura 

permitem a resolução de imensos sistemas algébricos de equações. Entre esses métodos, cita-

se: o método do gradiente conjugado pré-condicionado, algoritmo do gradiente bi-conjugado 

estabilizado, algoritmos multigrid, etc. 

Uma comparação de desempenho entre o estimador residual com o estimador ZZ para as 

soluções numéricas do modelo de fluxo subterrâneo poderia unificar o emprego do estimador 

de erro. Uma vez que o estimador residual também se aplica na equação do transporte com 

difusão dominante, a avaliação de adequação e robustez do estimador residual para a equação 

do fluxo parece ser muito promissora. 

Em relação às funções de aproximação da solução por elementos finitos, seria 

interessante a verificação do estimador residual na análise em funções polinomiais de grau 2. 

Estas funções aumentam a precisão da solução numérica, e assim, é esperado que o estimador 

residual responda com valores menores para os erros de aproximação, indicando melhorias na 

solução numérica. 

É possível, ainda, desenvolver e implementar uma estratégia de refinamento adaptativo 

temporal. Esta estratégia seria conduzida pela norma de energia do código JAVA para 

discretizar o intervalo de tempo da simulação dos processos transientes da equação do 

transporte de contaminantes em meio poroso e regime de pequena advecção. Assim, o código 

asseguraria a qualidade da solução numérica minimizando o correspondente erro temporal. 

As técnicas desenvolvidas para obtenção da solução numérica da equação do fluxo e do 

transporte de contaminantes, seguidas dos seus respectivos estimadores de erro, e integradas 

com um código aberto de Sistema de Informações Geográficas (SIG), possibilitará uma 

adequação nas representações das características físicas e geométricas do aquífero confinado. 



120                                  Universidade de São Paulo – EESC 

O desenvolvimento do código em linguagem JAVA encontra-se propício para essa 

integração e a avaliação do proposto estimador residual poderia se estender para as condições 

heterogêneas e anisotrópicas do meio poroso saturado. 

Outra extensão proposta poderia ser para as condições do meio poroso não-saturado, 

empregando o estimador residual na solução numérica da equação de Richards. 

 

 

 

 

 

  



    Departamento de Hidráulica e Saneamento – PPG SHS EESC USP                         121 

ANEXO I - O TRANSPORTE DE CONTAMINANTES  
EM ÁGUA SUBTERRÂNEA  

O movimento de contaminantes dissolvidos em aqüíferos poderia seguir na direção dos 

poços de abastecimentos públicos. Na existência de uma fonte contínua de contaminação 

movendo pela água subterrânea, forma-se uma área contaminada, chamada de pluma de 

contaminação. Esta combinação do movimento da água subterrânea com a fonte contínua de 

contaminação poderia, no entanto, atingir grandes extensões do aqüífero, condenando-o em 

grandes áreas e em vastos volumes. 

Algumas substâncias perigosas são dissolvidas de modo muito lento na água. Sendo 

substâncias que extravasam mais rápido que o aqüífero pode dissolver, estes contaminantes 

permanecem em sua forma líquida. Se o líquido é menos denso que a água (ex. o óleo), o 

poluente flutua sobre o topo do lençol freático. Estes poluentes são chamados de LNAPLs 

(light non-aqueous phase liquids). Caso contrário, se o líquido é menos denso que a água, os 

poluentes são chamados de DNAPLs (dense non-aqueous phase liquids). Os DNAPLs tendem 

a concentrar no fundo do aqüífero. Estas concentrações que contaminam o aqüífero 

dissolvem-se muito vagarosamente e são transportadas, predominantemente, de acordo com o 

movimento da água subterrânea. Às vezes, pequenos glóbulos de DNAPLs aderem aos 

espaços entre as partículas sólidas, ocasionando a chamada contaminação residual da água 

subterrânea. 

Vários modelos que simulam o transporte de contaminantes dissolvidos em água 

subterrânea são descritos por equações de transporte de soluto por advecção-difusão. Esta 

equação diferencial parcial deriva do princípio da conservação de massa – a equação da 

continuidade, no qual afirma que, a taxa de variação da massa de soluto dentro de um volume 

de controle do meio poroso é igual a diferença entre o fluxo de soluto que entra e o fluxo que 

sai do volume, ajustados por perdas ou ganhos da massa de soluto devido a reações químicas 

ou degradação biológicas. O fluxo do soluto entrando no volume de controle é caracterizado 

por dois processos principais: a advecção e a dispersão hidrodinâmica46. Esse segundo 

processo físico é ainda representado pelo efeito combinado de outros dois processos: a difusão 

molecular e a dispersão mecânica. 

                                                 

46 Dispersão de uma solução que flui através de um meio poroso, devido à difusão molecular e à não 
homogeneidade de velocidades microscópicas. 



122                                  Universidade de São Paulo – EESC 

 Outros processos secundários contribuem para o espalhamento ou retardamento na 

propagação de substâncias perigosas no aqüífero que são a sorção47 e a degradação 

bioquímica. A sorção ocorre quando o contaminante adere às partículas do solo. Este tipo de 

contaminação é muito difícil de remover. A degradação bioquímica acontece quando 

microorganismos, tais como bactérias e fungos, degradam substâncias orgânicas ou 

inorgânicas que contaminam a água subterrânea. Neste processo natural, as substâncias 

perigosas freqüentemente tornam-se menos nocivas. 

OS PRINCIPAIS MECANISMOS DE TRANSPORTE 

 Nesta seção serão descritas, com pouco mais de detalhes, os principais processos físico-

químicos responsáveis pelo transporte de contaminantes em água subterrânea. O interesse 

neste detalhamento refere-se à obtenção do modelo matemático que descreve o transporte do 

contaminante em solo saturado. 

O Transporte Advectivo 

 Quando a água está se movendo no solo, o contaminante é conduzido por um processo 

físico conhecido por fluxo convectivo ou fluxo advectivo de massa. A melhor maneira de 

visualizar este transporte advectivo é através de um procedimento conhecido por fluxo tipo 

pistão, em que a frente de água avança deslocando o contaminante como um pistão [YANOSIK 

e MCCRACKEN, 1979]. 

 Em aqüíferos livres ou confinados, o transporte advectivo é a principal forma de 

transporte de contaminante.  O movimento das partículas de soluto, ao longo da direção 

média do fluxo, ocorre na mesma taxa de variação da velocidade intersticial48 média da água 

no meio poroso. 

 
                                                 

47 Termo genérico utilizado para indicar o processo pelo qual o soluto é repartido entre a fase líquida e a 
superfície das partículas sólidas. 
48 Velocidade do movimento das partículas de água no interior dos poros, bem como de um poro para outro. 



    Departamento de Hidráulica e Saneamento – PPG SHS EESC USP                         123 

 Em meio saturado, a densidade de fluxo da água no solo, ou velocidade aparente, é 

determinada pela lei de Darcy49, no caso estacionário por: 

h??= Kv*                    (A.1)  

sendo v* a velocidade aparente [ ]TL , 
   K o tensor de condutividade hidráulica do meio [ ]TL  e 
  ?h o gradiente hidráulico [adimensional]. 

 Assim, cada componente do transporte de soluto que ocorre por advecção será dada pelo 

produto entre a concentração do soluto C [ ]3LM  e a correspondente componente vx, vy ou vz [ ]TL  
da velocidade aparente da água subterrânea. Ou seja, para ( )zyx vvv ,,* =v  segue: 

 Ca
*vJ =        (A.2) 

O Transporte Difusivo 

 A difusão molecular refere-se ao fluxo difusivo do soluto na direção do gradiente de 

concentração. Este processo ocorre em função do movimento browniano dos íons na solução. 

Os íons de uma região de concentração alta tendem a se misturar com os íons de uma região 

de baixa concentração, estabelecendo uma mesma distribuição no espaço. Este fluxo difusivo 

é dado por uma relação empírica conhecida como a primeira lei de Fick, 

 Cdd ??= DJ ?                (A.3) 

sendo Dd o tensor diagonal da difusão molecular [ ]TL2 , 
  ? conteúdo de umidade do solo [adimensional], 

    ?C o gradiente de concentração [ ]4LM , e 
     C a concentração de soluto (massa de soluto por unidade de volume do fluido) [ ]3LM . 
                                                 

49 Henry Philibert Gaspard Darcy (1803-1858) foi um engenheiro francês que forneceu importantes 
contribuições à hidráulica. 



124                                  Universidade de São Paulo – EESC 

 O tensor de difusão contém as medidas de velocidades em que as moléculas ou íons 

estão difundindo através da substância porosa e trata-se de um coeficiente de transporte 

estacionário. Ele quantifica a dificuldade em que as moléculas ou íons possuem para se 

difundir enquanto movimentam-se através do meio poroso. O valor destes coeficientes tende a 

aumentar com o aumento da temperatura do solo ou do conteúdo de umidade e diminuem com 

o aumento da massa atômica do soluto.  

 A difusão no solo é relativamente um processo de transporte muito lento e opera sobre 

pequenas distâncias. Em situações em que o movimento de água é vagaroso, a difusão é o 

mecanismo de transporte dominante. 

 Transporte de contaminantes no solo por difusão é complicado pelo fato que os íons 

deveriam manter-se eletricamente neutro quando se difundirem. 

O Transporte por Dispersão Mecânica 

 A tendência da molécula de soluto tornar-se mais difusa com o tempo quando a água 

move-se no solo é conhecido por dispersão mecânica. A dispersão ocorre quando existe uma 

zona de transição entre duas soluções de diferentes composições químicas. A variação da 

pluma de contaminação é devida tanto à difusão quanto à dispersão mecânica. Portanto, em 

geral, não é possível separar os efeitos destes dois processos de transporte. 

 Especificamente, a dispersão mecânica, ou dispersão hidráulica, descreve a mistura e 

espalhamento do soluto ao longo da direção direta ou da direção transversal do fluxo em 

resposta à variação na velocidade intersticial do fluido. Para escalas microscópicas, estas 

flutuações da velocidade ocorrem em função da tortuosidade no caminho que o fluxo percorre 

dentro do poro, e para escalas macroscópicas, a dispersão mecânica é devido à variação local 

da condutividade hidráulica e à presença de heterogeneidades no interior do aqüífero50.  

 Testes de laboratórios em colunas de solos demonstram que o fluxo de soluto por 

dispersão mecânica também pode ser descrito pela primeira lei de Fick, 

 Cmm ??= DJ ?                (A.4) 

sendo que Dm é o tensor simétrico da dispersão mecânica [ ]TL2 . 
                                                 

50 BEAR J. 2001 Modeling Groundwater Flow and Contaminant Transport  Copyright © 2000 by Jacob  
         Bear, Haifa, Israel  disponível em  http://www.cmdlet.com/demos/mgfc-course/mgfctoc.html#toctoc 



    Departamento de Hidráulica e Saneamento – PPG SHS EESC USP                         125 

 A magnitude do tensor de dispersão depende da velocidade da água no poro e do 

coeficiente de difusão do soluto. Uma vez que os efeitos da difusão e da dispersão mecânica, 

sobre a distribuição da concentração, são semelhantes, estes processos provenientes de 

mecanismo de transporte distintos são freqüentemente combinados em um mecanismo 

chamado de dispersão hidrodinâmica. 

O Transporte por Dispersão Hidrodinâmica 

 A dispersão hidrodinâmica é o fluxo de soluto devido aos efeitos combinados da difusão 

molecular e da dispersão mecânica. A sua formulação é dada por 

 Cdmh ??=+=
*

?DJJJ            (A.5) 

sendo que D* = Dm + Dd é o tensor da dispersão hidrodinâmica
51 [ ]TL2 . 

 A difusão molecular independe da velocidade da água subterrânea e, em função do 

pequeno tamanho do tensor Dd, a contribuição do transporte de soluto por difusão é 

usualmente negligenciado quando comparado com a contribuição do transporte de soluto por 

advecção ou por dispersão mecânica para velocidades não muito pequenas do fluxo de água 

subterrânea. 

 A mistura ou dispersão que ocorre na direção do caminho do fluxo é chamada de 

dispersão longitudinal. A dispersão na direção normal do caminho do fluxo é chamada de 

dispersão transversal. Estas duas direções da dispersão mecânicas possuem seus coeficientes 

como resultados da velocidade linear do fluido na direção principal do fluxo e da propriedade 

do solo conhecida por dispersividade. Expressões matemáticas que descrevem os coeficientes 

de dispersão longitudinal e transversal estão largamente disponíveis na literatura onde é 

possível citar: [ISTOK,1989, pg. 472], [WEXLER,1992, pg. 4] e [SUTRA,2003, pg. 36]. 

 No solo, a distribuição de velocidade depende da geometria do solo, do conteúdo de 

umidade, da própria concentração de soluto e, portanto, relações empíricas entre o tensor D* e 

outros parâmetros macroscópicos observáveis têm sido estabelecidas. 

                                                 

51 Embora os parâmetros Dm e Dd sejam provenientes de diferentes processos físicos, eles podem ser adicionados 
uma vez que possuem o mesmo efeito físico. 



126                                  Universidade de São Paulo – EESC 

 A relação D* = Dm + Dd resulta de considerações estatísticas do transporte de soluto 

como conseqüência da distribuição randômica da velocidade de água no meio poroso. 

Reações Químicas de Primeira Ordem 

 Um processo químico, tal como o decaimento radioativo ou a decomposição 

bioquímica, geralmente envolve a conversão irreversível do soluto A no soluto B. A taxa de 

degradação (química ou biológica) é freqüentemente expressa por modelos de ordem zero ou 

de primeira ordem. No segundo modelo, a descrição da taxa de degradação é considerada 

proporcional à concentração do soluto, isto é, o processo químico é dado pela expressão  

[ ] [ ]A
dt

Ad
??=                  (A.6) 

sendo ? o coeficiente de decaimento ou de degradação [ ]T1 . Este coeficiente, que representa a 
declividade da reta na figura A.1, pode ser expresso em termos do tempo de meia vida52 do 

soluto, 
2
1T , da seguinte forma: 

2
1

2
1

693,02ln

TT
==? . 

 

 

 

 

 

 

 

 

 

 

 

                                                 

52 Tempo necessário para que a concentração inicial de espécies no soluto seja reduzida pela metade. 

ln C 
 
   ln C0 
 
                                declividade ? 
 
 
 
 
                                                        tempo 
 
FIG A.1 – Relação entre o logaritmo natural na 
            concentração de soluto (A.6) e o tempo 

 



    Departamento de Hidráulica e Saneamento – PPG SHS EESC USP                         127 

 Outras equações para o modelo cinético da taxa de degradação são encontradas na 

literatura, no entanto, o modelo (1.6), apesar da simplicidade, é aplicável à maioria dos 

contaminantes conhecidos para a água subterrânea [DYMINSKI, 2006]. 

 A taxa de produção de soluto devido as reações de sorção (ou dessorção) entre o soluto e 

o meio poroso dentro do volume de controle pode ser obtido se considerar a combinação 

[ ]CKCA db?? +=][  sendo ?b a densidade volumétrica53 do meio poroso e Kd [adimensional] é 
o coeficiente de partição entre a reação progressiva e a reação reversa [QUEIROZ, 2002]. 

Outros Processos Bio-Físico-Químicos do Transporte de Contaminantes 

 Outros processos poderiam envolver complexas interações bio-física-químicas para 

propiciar tanto o retardo quanto a aceleração do movimento de uma substância química 

através da água subterrânea. 

 De acordo com DYMINSKI (2006), os principais tipos de reações que causam a 

transferência de substância para a estrutura sólida retardando a frente de contaminação são: 

adsorção, absorção ou sorção hidrofóbica.54 

 Entre as principais reações causadoras de atenuação das substâncias no solo, por perdas 

ou transformação em outras substâncias citam-se: biodegradação, degradação abiótica, 

volatização e decaimento radioativo. 

 Enfim, as reações que aumentam a mobilidade dos contaminantes através do solo são: 

dissolução, formação de complexos ou quelação, co-solvência e ionização. 

 Outras características do contaminante que influenciam o transporte são: concentração, 

densidade, polaridade, solubilidade, pressão de vapor, pH, potencial iônico, demanda 

bioquímica de oxigênio (DBO) e demanda química de oxigênio (DQO), teor e finura de sólidos 

em suspensão e a toxidez. 

 O meio poroso influencia o transporte de contaminantes devido às características de: 

tipo de matéria orgânica, distribuição granulométrica, mineralogia, distribuição de vazios, 

capacidade de troca iônica e grau de saturação. 

                                                 

53 O bulk density ?b também é conhecido por densidade do solo seco [adimensional]. 
54 Adsorção refere-se à adesão de íons ou moléculas em uma camada extremamente fina da superfície sólida na 
qual está em contato. A absorção ocorre quando o contaminante se difunde no interior sólido da matriz porosa 
ocasionando um fenômeno volumétrico. 



128                                  Universidade de São Paulo – EESC 

 Alguns dos processos acima, apesar de sua importância nos fenômenos de transporte 

dos contaminantes, não foram considerados no modelo matemático em razão da ausência, até 

o presente, de uma literatura mais ampla para validar, verificar ou até mesmo estimar os 

parâmetros que descrevem as leis destas reações em meio poroso saturado. 

 

  



    Departamento de Hidráulica e Saneamento – PPG SHS EESC USP                         129 

ANEXO II – SYMMETRICAL STREAMLINE STABILIZATION-S3 

 O esquema Symmetrical Streamline Stabilization (S3) fornece um algoritmo robusto 

para resolver a equação de advecção-dispersão, assegurando uma solução estável mesmo para 

problemas dominados por advecção. Para evitar as indesejáveis oscilações espúrias 

ocasionadas pela instabilidade numérica dos processos desses transportes dominados por 

advecção, o desenvolvimento matemático do esquema de estabilização S3 se baseará no 

procedimento de separação de operadores descritos em [WENDLAND e SCHMID, 2000]. 

 Sem perdas de generalidades, o esquema de estabilização S3 inicialmente considerará a 

seguinte equação governante do transporte por advecção-dispersão: 

??
?? + ?? ?? ? ?(???) = ??(?? ? ?)    (A.7) 

sendo ?(?, ?) a concentração do contaminante na posição x e tempo t, ?? (?) o vetor 
velocidade, ?(?) o tensor de dispersão hidrodinâmica, ? a fonte pontual com concentração ?? 
e ? a função delta de Dirac55. 
 Quando a técnica de separação de operadores (operator splitting) é aplicada na equação 

(A.7), são produzidos os mesmos efeitos que a aproximação Euler-Lagrangiana: a separação 

da advecção e da dispersão. A aproximação numérica pelo método de elementos finitos (FEM) 

conduz a um único sistema de equações, com efeito inerente de upwind [WENDLAND, 2004]. 

 A equação diferencial (A.7) pode ser aproximada no tempo, considerando uma 

aproximação por diferença finita56 de primeira ordem com fator peso ? 

? !?"
?? + $(%? + %?)?&amp;amp; + (1 ? $)(%? + %?)?! = (    (A.8) 

sendo 

 ?&amp;amp; a concentração do contaminante no instante (? + ??); 
 ?! a concentração do contaminante no instante (?); 
                                                 

55 Segundo [WENDLAND, 2004, p. 114], reações químicas ou decomposições de 1ª ordem são facilmente 
incorporadas ao modelo matemático e numérico. 
56 O objetivo do método das diferenças finitas é transformar um problema composto por equações diferenciais 
em um problema formado por equações algébricas, utilizando a expansão da função em série de Taylor em torno 
de um ponto dado. 



130                                  Universidade de São Paulo – EESC 

 ?? o intervalo de tempo; 
 %? = ??(???) + ??; 
 %? = ?? ?  e 
 ( = ?? ??. 

 Segundo [WENDLAND e SCHMID, 2000], com a aproximação adotada, a equação (A.8) 

pode ser separada em uma parte dispersiva que depende somente do operador linear %? 

?*
?? + $%??+ =

?"
?? ? (1 ? $)%??! + (     (A.9) 

e uma parte advectiva, que depende somente do operador linear %? 

? 
?? + $%??&amp;amp; =

?*
?? ? (1 ? $)%??+         (A.10) 

 O componente dispersivo de concentração ?+  foi introduzido como uma incógnita 
provisória. As derivadas espaciais são discretizadas de acordo com a técnica proposta por 

KÖNIG (1994)57: a solução exata para cada etapa é aproximada pelo FEM usando o esquema 

tradicional de interpolação  

?(?, ,, -, ?) ? ? 01 (?, ,, -)?1 (?)213?       (A.11) 

sendo 01  uma função de interpolação linear. 
 Para a parte dispersiva dada pela equação (A.9), a solução é obtida usando a 

aproximação de Galerkin tradicional. O mínimo é obtido ponderando o resíduo com respeito à 

função-teste 0
  

4 0
? 6
? 78?8*

?? + $%? ? 01 ?1
+ 9 :? = 4 0
? ;

? 78?8"
?? ? (1 ? $)%? ? 01 ?1

! +&amp;lt;= :?     (A.12) 

que pode ser reescrita em notação matricial como 

; &gt;?? + $@= ?+ = ;
&gt;
?? ? (1 ? $)@= ?! + &amp;lt;    (A.13) 

                                                 

57 König, C. Operator Split for Three Dimensional Mass Transport Equation, Proceedings of 
Computational Methods in Water Resources X, 1, 309-316, Heidelberg, 1994. 



    Departamento de Hidráulica e Saneamento – PPG SHS EESC USP                         131 

sendo 

 &gt; = 4 0
 01? :?; 
 @ = 4 ??0
 ?01? :? + 4 ??0
 01? :?  e 
 &amp;lt;= 4 ????01? :?. 

 A parte advectiva, dada pela equação (A.10), pode ser aproximada pelo método dos 

mínimos quadrados. O resíduo da aproximação é minimizado, através de ponderação com 

função-teste 
7A
?? + $?? ?0
  

4 B7A?? + $?? ?0
 C? 6
? 78?8 

?? + $%? ? 01 ?1
&amp;amp;9 :? =  

4 B7A?? + $?? ?0
 C? ;
? 78?8"

?? + (1 ? $)%? ? 01 ?1
+ = :?    (A.14) 

 Em notação matricial, a operação (A.14) resulta em: 

; &gt;?? + $(D + DE ) + F?= ?&amp;amp; = ;
&gt;
?? ? (1 ? $)D + $DE ?

(?!G)
G F?= ?+  (A.15) 

sendo 

 D = 4 ?0
 ?01? :?  e 
 F? = $??? 4 ??E ?? ?0
 ?01? :?. 

 O procedimento tradicional da técnica de separação de operadores consiste em resolver 

a equação (A.13) e substituir, então, a concentração ?+  na equação (A.15), obtendo a solução 
desejada no novo instante. 

 O vetor 
&gt;
?? ?+  aparece em ambas as expressões (A.13) e (A.15), através do qual ambas 

podem ser acopladas em uma única equação. Após extrapolação para a eliminação da 

concentração provisória ?+ , a seguinte formulação acoplada da equação governante é obtida: 

; &gt;?? + $(@ + D) + $DE + F?= ?&amp;amp; = ;
&gt;
?? ? (1 ? $)(@ + D) + $DE ?

(?!G)
G F?= ?! + &amp;lt;  (A.16) 

 A análise da equação (A.16) apresenta as vantagens do método. Usando o método dos 

mínimos quadrados, a matriz de coeficientes resultante é sempre simétrica, mesmo quando o 



132                                  Universidade de São Paulo – EESC 

termo advectivo aparece no lado implícito da equação. A simetria resulta da presença do 

termo $DE ?&amp;amp; no lado esquerdo da equação. 
 Outra característica é o efeito de upwind no termo advectivo, responsável pela 

estabilização da solução numérica. O upwind resulta da combinação dos termos D e F?, como 
mostrados na figura A.2. 

 

 

 

 

FIG A.2 – Função peso para o termo advectivo (adaptado de [WENDLAND, 2004, p. 122])  
 

 Esse termo de upwind F? = $?????? pode ser interpretado em termos de critérios de 
estabilidade para o caso uni-dimensional. Considerando o número de Courant ?H = IJ???K , o 
caso uni-dimensional pode ser transformado em 

F? = $??H ?L??       (A.17) 

 Após a introdução do número de Peclet MN = IJ?K? , obtém-se: 

F? = $??H MN ?      (A.18) 

 O termo de upwind aparece como uma fração da dispersão natural de problema, através 

da qual a solução numérica é estabilizada, evitando a oscilação espúria. No procedimento S3, 

a difusão artificial introduzida pelo método numérico é controlada pela discretização temporal  

($, ?H ) e espacial (MN ). Devido ao produto vetorial ?E ?, a estabilização atua somente na 
direção de fluxo, evitando o surgimento de difusão transversal [WENDLAND, 2004] e essa 

transformação pode ser derivada para qualquer sistema de coordenadas. 

 A comparação do esquema desenvolvido pela equação (A.16) com um método de 

resíduos ponderados, que utiliza função-peso assimétrica para todos os termos, leva à 

observação de que algumas derivadas de ordem superior (por exemplo, termo de difusão) 

faltam na aproximação S3. No entanto, BROOKS e HUGHES (1982) mostraram que, se 

elementos retangulares com funções lineares de interpolação são usados, a parte assimétrica 

da função peso não afeta os termos de difusão. Conseqüentemente, as derivadas de ordem 

superior desaparecem naturalmente e não afetam a solução. O esquema S3 é, portanto, 

consistente com o problema físico. Geralmente, esse não é o caso para as funções quadráticas 



    Departamento de Hidráulica e Saneamento – PPG SHS EESC USP                         133 

ou cúbicas de interpolação para as quais os termos de ordem superior podem ser 

significativos. Assim mesmo, em situações dominadas pela advecção, pode-se também 

negligenciar essas contribuições. 

 Outra característica interessante é o comportamento do método para campos de fluxos 

sem divergente. Nesse caso, a simetrização conduz a uma aproximação explícita do termo 

advectivo e oscilações podem ser esperadas para números de Courant elevados. No entanto, 

essas oscilações não ocorrem devido à estabilização gerada pelo efeito de upwind. 

 Em relação esforço computacional, testes numéricos mostram que o esquema S3 

apresenta boa vantagem se comparado com o método tradicional. O método de Galerkin 

conduz a uma matriz assimétrica, para o qual poderia ser escolhido um método de solução 

direta. Assim, a matriz cheia tem de ser armazenada usando a técnica de armazenamento por 

bandas. Para o esquema S3, pode ser usado um esquema de solução baseado no solver 

conhecido por gradiente conjugado pré-condicionado (PCG), com armazenamento esparso. E 

de acordo com [WENDLAND e SCHMID, 2000] este solver apresenta grande economia de 

memória para modelos cujas larguras da matriz de banda são bem maiores que 15. 
 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 



134                                  Universidade de São Paulo – EESC 

 



    Departamento de Hidráulica e Saneamento – PPG SHS EESC USP                         135 

ANEXO III – ARTIGO TEMA 2009 

 

 

  



136                                  Universidade de São Paulo – EESC 

 

 

  



    Departamento de Hidráulica e Saneamento – PPG SHS EESC USP                         137 

 

 

  



138                                  Universidade de São Paulo – EESC 

 

 

  



    Departamento de Hidráulica e Saneamento – PPG SHS EESC USP                         139 

 

 

 

  



140                                  Universidade de São Paulo – EESC 

 

 

 

  



    Departamento de Hidráulica e Saneamento – PPG SHS EESC USP                         141 

 

 

 

  



142                                  Universidade de São Paulo – EESC 

 

 

 

  



    Departamento de Hidráulica e Saneamento – PPG SHS EESC USP                         143 

 

 

  



144                                  Universidade de São Paulo – EESC 

 

 

 

 

  



    Departamento de Hidráulica e Saneamento – PPG SHS EESC USP                         145 

7 REFERÊNCIAS BIBLIOGRÁFICAS 

Ainsworth M., Oden J.T. A Posteriori Error Estimation in Finite Element Analysis, 
Editora Wiley-IEEE, 2000. 
 
Akin J.E. Finite element analysis with Error Estimation Butterworth-Elsevier Ltd. 2005. 
 
Akin J.E., Singh M. Object-Oriented Fortran 90 P-adaptive Finite Element Method 
Advance. Eng. Software (33) 7-10, p. 461-468 Elsevier Science Ltd. 2002. 
 
Akrivis G., Makridakis C., Nochetto R. A Posteriori Error Estimates for the Crank-
Nicolson Method for Parabolic Equations. Mathematics of Computation, vol 75, 511-531, 
2006. 
 
Almeida, R. C., Feióo R. A., Galeão A. C., Padra C., Silva R. S., Adaptive Finite Element 
Computational Fluid Dynamics using an Anisotropic Error Estimator. Comput. Methods 
Appl. Mech. Engrg, n 182, 379-400. 2000. 
 
Babus?ka I., Rheinboldt, W. C. A posteriori Error Estimates for the Finite Element 
Methods. Int. J. Numer. Methods Engng. v. 12, 597-615. 1978. 
 
Babus?ka I., Strouboulis T., Upadhyay C.S., Gangaraj S.K., Copps K. Validation of a 
posteriori error estimators by numerical approach, Int. J. Numer. Methods Engrg. v. 37,  
p. 1073–1123, 1994. 
 
Babus?ka L., Strouboulis W. The Finite Element Method and its Reliability. Oxford 
University Press, 2001 
 
Bear J. Modeling Groundwater Flow and Contaminant Transport, Copyright © 2000 by 
Jacob Bear, Haifa, Israel (2001). Disponível em 
http://www.cmdlet.com/demos/mgfc-course/mgfctoc.html#toctoc, acesso em 15/07/2006. 
 
Bochev P. Finite Element Methods Based on Least Squares and Modified Variational 
Principles. University of Texas at Arlington, Texas, USA, p 163, 2002. Disponível em 
http://com2mac.postech.ac.kr/Lecture/Lec-5.pdf, acesso em 13/08/2009. 
 
Bochev P., Gunzburger M. D., Shadid J. N. Stability of the SUPG finite element method 
for transient advection-diffusion problems Computer methods in applied mechanics and 
engineering. v 193, pp 2301-2323. 2004 
 
Brenner, S. C., Scott, L. R. The matemathical theory of finite element methods. Springer-
Verlag, New York, Inc. 2002. 
 
Bonilla J. J., Puertas J., Fe J., Vellando P. A 2D numerical model for the transport of 
pollutants. The influence of Boundary Conditions. Proceedings of the 3rd International 
Symposium on Ecohydraulics, 12-16 July 1999, Salt Lake City, Utah. 1999. 
 



146                                  Universidade de São Paulo – EESC 

Brooks A. N., Hughes T. J. R., Streamline-upwind/Petrov-Galerkin formulations for 
convection dominated flows with particular emphasis on the incompressible Navier-
Stokes equations. Comput. Math. Appl. Mech Engrg., 32:199-259, 1982. 
 
Carstensen C.; Hu J. Hanging Nodes in the Unifying Theory of a posteriori Finite Element 
Error Control. J. Comput. Math. v. 27, pp 215-236, 2009. 
 
Chen Z., Feng J. An adaptive finite element algorithm with reliable error control for 
linear parabolic problems. Math. Comp., 73 (247): 1167-1193, 2004. 
 
Chidyagwai P., Rivière B. Numerical modelling of coupled surface and subsurface flow 
systems. Advances in Water Resources 33, 92–105, 2010. 
 
Devloo, P. R. B. et al. Pesquisas em Hidráulica de Poços Desenvolvidas no LABMEC-
FEC-Unicamp. Anais do III Encontro Nacional de Hidráulica de Poços, 07 a 10 de junho de 
2009, Campos do Jordão – SP, 2009. 
 
Devloo, P. R. B., Forti T., Gomes S. M. Métodos de Elementos Finitos Contínuos e 
Descontínuos Aplicado a Problemas de Convecção-Difusão. CILAMCE 2005 – 
ABMEC&amp;amp;AMC, Guarapari – ES, 19 a 21 de Outubro de 2005. 
 
Donea J., Huerta A. Finite Element Methods for Flow Problems John Wiley &amp;amp; Sons. 2004. 
 
Eckel B. Thinking in JAVA Prentice-Hall. 2000. disponível em 
http://www.mindview.net/Books/TIJ/. Acesso em 15/08/2007. 
 
Estep D., Larson M., Williams R. Estimating the error of numerical solutions of systems 
of reaction-diffusion equations. Americal Mathematical Society. N 696. 2000. 
 
Eymard R., Gallouët T., Herbin R., Finite Volume Methods which appeared in  
Handbook of Numerical Analysis vol 7 pp 713-1020, Ciarlet&amp;amp;Lions ed. Elsevier, 2003. 
 
Firmiano A., Wendland E. Solução da Equação do Fluxo Subterrâneo a partir de 
Estimador de Erro a posteriori. Tend. Mat. Apl. Comput – TEMA/SBMAC, v 10, n 01, 
11-20, 2009. 
 
Fortuna A. O. Técnicas Computacionais para Dinâmica dos Fluidos. Edusp, São Paulo, 
2000. 
 
Galeão A. C, Almeida R. C., Malta S. M. C., Loula A. F. D., Finite element analysis of 
convection dominated reaction-diffusion problems. Applied Numerical Mathematics, 
vol 48, issue 2, pg 205-222, 2004. 
 
Grätsch T., Bathe K. J., A posteriori error estimation techniques in practical finite 
element analysis. Computers and Structures 83, pg 235-265, 2005. 
 
Harbrecht H., Schneider R. On Error Estimation in Finite Element Methods without 
having Galerkin Orthogonality. SFB-611, University of Bonn, preprints/publications, 2009, 
disponível em http://sfb611.iam.uni-bonn.de/publications.php?lang=en acesso em 26/11/2009. 
 



    Departamento de Hidráulica e Saneamento – PPG SHS EESC USP                         147 

He?e F., Radu F. A., Thullner M., Attinger S. Upscaling of the advection-diffusion-reaction 
with Monod reaction. Advances in Water Resources, 32, 1336-1351, 2009. 
 
Heimsund B.O. High performance numerical libraries in Java  - Paper G in       
Mathematical and Numerical Methods for Reservoir Fluid Flow Simulation, Doctor 
Scientiarum thesis Department of Mathematics University of Bergen. Norway. 2005. 
disponível em http://www.uib.no/People/nmabh/art/hpj.pdf. Acesso em 17/03/2006. 
 
Hilhorst D., Vohralík M. A posteriori error estimates for combined finite volume-finite 
element discretizations of reactive transport equations on nonmatching grids. Preprint 
disponível em http://www.ann.jussieu.fr/publications/2010/R10007.php. 2010. 
Acesso em 08/02/2010. 
 
Hossain M. A., Miah A. S., Crank-Nicolson-Galerkin model for transport in 
groundwater: Refined criteria for accuracy, Applied Mathematics and Computation, 105 
pp 173-181, 1999. 
 
Huang Q, Huang G., Zang H., A finite element solution for the fractional advection-
dispersion equation, Advances in Water Resources, 1578-1589, 2008. 
 
Hughes T. J. R., The finite element method: linear static and dynamic finite element 
analysis. Prentice-Hall, Inc., New Jersey, 2000. 
 
Hughes T. J. R., Scovazzi G., Tezduyar T. E., Stabilized methods for compressible flows 
Journal of Scientific Computing. Springer Netherlands. 2009. disponível em 
www.springerlink.com/content/a5210x3405242767, acesso em 10/02/2010. 
 
Ingebritsen S. E., Sanford W. E., Neuzil  C. E., Groundwater in Geologic Processes, 
Second Edition Cambridge University Press, United Kingdom, 2006. 
 
Istok J. Groundwater Modeling by the Finite Element Method, American 
Geophysical Union, Water Resources Monograph 13, Wash., D.C., 1989. 
 
John V. A numerical study of a posteriori error estimators for convection-diffusion 
equations. Comput. Methods Appl. Mech. Engrg. v 190, 757-781. 2000. 
 
Kalashnikova I., Farhat C., Tezaur R. A discontinuous enrichment method for the finite 
element solution of high Péclet advection-diffusion problems. Finite Elements in Analysis 
and Design 45, 238-250, 2009. 
 
Knabner P., Angermann L., Numerical methods for elliptic and parabolic partial 
differential equations. Texts in Applied Mathematics, 44, p 415, Springer, 2003. 
 
Kumar B. P., Dodagoudar G. R., Two-dimensional modeling of contaminant transport 
trough saturated porous media using the radial point interpolation method (RPIM), 
Hydrogeology Journal, 16 pp 1497-1505, 2008. 
 
Lozinski A., Picasso M., Prachittham V. An Anisotropic Error Estimator for the  
Crank-Nicolson Method: Application to a Parabolic Problem. SIAM J. Sci. Comput. 31 (4) 
pp 2757-2783, 2009. 



148                                  Universidade de São Paulo – EESC 

Natvig et al. An efficient discontinuous Galerkin method for advective transport in 
porous media Advances in Water Resources 30, p. 2424-2438, Elsevier Science Ltd. 2007. 
 
Oden J. T., A Posteriori Error Estimation, Verification and Validation in Computational 
Solid Mechanics, Hans Maier, ASME/USACM Standards, 2002. 
 
Otto A. Methods of Numerical Simulation, Course Sillabus, University of Alaska, Fairbanks 
2007. Disponível em: http://what.gi.alaska.edu/ao/sim/#Notes . Acesso em 06/02/2008. 
 
Parkhurst D. L. et al. PHAST – A Program for Simulating Groundwater Flow, Solute 
Transport and Multicomponent Geochemical Reactions, USGS, Denver, Colorado, 2004. 
 
Patzak B. and Bittnar Z. Object Oriented Finite Element Modeling, Acta Polytechnica, 39, 
2/1999, p. 99-113. 1999. disponível em 
http://www.oofem.org/resources/doc/paper-actap/paper-actap.html. Acesso em 18/09/2007. 
 
Prudhomme S. e Oden, J. T. Computable Error Estimators and Adaptive Techniques for 
Fluid Flow Problems, in TICAM Report 02-07, The University of Texas at Austin, Austin, 
Texas, 2002 disponível em www.ices.utexas.edu/research/reports/2002/0207.ps.gz. Acesso 
em 21/07/2008. 
 
Queiroz P. I. B. Um método numérico para análise de adensamento e transporte de 
contaminantes no solo CTA/Instituto Tecnológico da Aeronáutica São José dos Campos-SP, 
Brasil. Tese de Doutorado. 2002. disponível em 
http://www.bd.bibl.ita.br/tde_busca/arquivo.php?codArquivo=200. Acesso em 12/11/2008. 
 
Santos I. P.e Almeida R. C., Um modelo subgrid para a equação de transporte com 
imposição fraca das condições de contorno de Dirichlet. Publicação nos Anais do XXX 
Congresso Nacional de Matemática Aplicada e Computacional (CNMAC). 2007. 
 
Sorek S., Two-Dimensional Adaptive Eulerian-Lagrangian Method for Mass Transport 
with Spatial Velocity Distribution, Transport in Porous Media, 3, 473-489, 1988. 
 
SUTRA A model for Saturated-Unsaturated Variable-Density Ground-Water Flow  
with Solute or Energy Transport Water-Resources Investigations Report 02-4231. 2003. 
Disponível em http://water.usgs.gov/nrp/gwsoftware/sutra/sutra.html. Acesso em 08/08/2007. 
 
Theis, C.V. The relation between the lowering of the piezometric surface and the  
rate of duration of discharge of a well using groundwater storage. Trans. Amer. 
Geophys. Union, Vol. 16, 519-524. 1935. 
 
Verfürth R. A Review of a Posteriori Error Estimation and Adaptive Mesh Refinement 
Techniques. Wiley and Teubner 8. 1996. 
 
Verfürth R. Robust a posteriori error estimates for non-stationary convection-diffusion 
equations. SIAM Journal on Numerical Analysis, 43 n 4, pp 1783-1802, 2005. 
 
Verfürth R. Adaptive Finite Element Methods Lecture Notes Winter Term 2007/08 Fakultät 
für Mathematik, Ruhr-Universität Bochum, Deutschland, 2008. 
 



    Departamento de Hidráulica e Saneamento – PPG SHS EESC USP                         149 

Vohralík M., A posteriori error estimates for lowest-order mixed finite element 
discretizations of convection-diffusion-reaction equations. SIAM J. Numer Anal., n 4, 
1570-1599. 2007. 
 
Wendland E., Contribuições à Simulações de Processos em Meios Porosos. Monografia de 
livre docência junto ao Departamento de Hidráulica e Saneamento apresentada na Escola de 
Engenharia de São Carlos, Universidade de São Paulo, 2004. 
 
Wendland E., Schmid G. A Symmetrical Streamline Stabilization Scheme for High  
Advective Transport, Intern Journal for Analytical and Numerical Methods in 
Geomechanics, 24(1), p. 29-45. 2000. 
 
Wexler E. J. Applications of Hydraulics Analytical Solutions for One-, Two- and Three-
Dimensional solute Transport in Groundwater Systems with Uniform Flow –  
Chapter B7 Techniques of Water-Resources Investigations of the USGS. Denver USA. 1992. 
 
Workbook of Applications in VectorSpace C++ Library  disponível em 
http://vector-space.com/services.htm#Online%20Workbook. Acesso em 20/01/2008. 
 
Yang Z.; Mavriplis D.J. Development of An Adaptive Space-Time Method for High-
Order Resolution of Discontinuities. Institute of Aeronautics and Astronautics, Inc.,  
46th AIAA Aerospace Sciences Meeting and Exhibit, 7-10 January 2008, Reno, Nevada. 
American., 2008. 
 
Yanosik J. L., McCracken T. A. A nine-point, finite difference reservoir simulator for 
realistic prediction of adverse mobility ratio displacements. SPE Journal. V. August 1979, 
pp 253-262. 1979, 
 
Zeiler M. Modeling our World The ESRI Guide to Geodatabase Design Environmental 
System Research Institute, Inc. California. 1999. 
 
Zhang Z., Victory Jr. Mathematical analysis of Zienkiewicz-Zhu's derivative patch 
recovery technique. Numerical Methods for Partial Differential Equations. v. 12 issue 4, p. 
507 – 524 Wiley Inter Science. 1995. 
 
Zienkiewicz O.C. and. Zhu J.Z. The Superconvergent patch recovery and a posteriori 
error estimators. Part 1. The recovery technique, Int. J. Numer. Methods Eng., 33, 1331-
1364. 1992a. 
 
Zienkiewicz O.C. and. Zhu J.Z. The Superconvergent patch recovery and a posteriori 
error estimators. Part 2. Error estimates and adaptivity. Int. J. Numer. Methods Eng., 33, 
1365-1382. 1992b. 
 
Zienkiewicz O.C. The background of error estimation and adaptivity in finite element 
computations Comput. Methods Appl. Mech. Engrg. 195 (2006) 207–213 Elsevier Science 
Ltd. 2004. 
 

 

 



150                                  Universidade de São Paulo – EESC 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

PBV 


</field>
	</doc>
</add>