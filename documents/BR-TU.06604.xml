<?xml version="1.0" encoding="utf-8"?>
<add>
	<doc>
		<field name="docid">BR-TU.06604</field>
		<field name="filename">11153_Pedro%20Figueira%20-Tese%20Especialista_200%20dpi.pdf</field>
		<field name="filetype">PDF</field>
		<field name="text">
ZI\E&lt;
W
MINISTÉRIO DA HABITAÇÃO E OBRAS PÚBLICAS
Laboratório Nacional de Engenharia Civil
NUMERICAL SIMULATION OF THE TIDAL FLOW
IN HOMOGENEOUS ESTUARIES
Lisboa, Junho de 1981
Pedro Manuel P. Leal Figueira
Tese apresentada no concurso para obtenção do grau de especialista
do Laboratório Nacional de Engenharia Civil
MINISTERIO DA HABITAQÁO E OBRAS PÚBLICAS LABORATORIO NACIONAL DE ENGENHARIA CIVIL DEPARTAMENTO DE HIDRAULICA NÚCLEO DE ESTUARIOS
NUMERICAL SIMULATION OF THE TIDAL FLOW
IN HOMOGENEOUS ESTUARIES
PROC. 64/13/5314
PEDRO MANUEL P. LEAL FIGUEIRA
JUNE 1981
Thesis presented as partial fulfilment of the requirements for the degree of Research Officer of LNEC.
AKNOWLEDGEMENTS
Although this work has individual characteristics, it could not have been done without the contribution of several people, The author wants to make the following aknowledgements:
-	To Mr. Ferry Borges, Director of LNEC and to Mr. Fernando Abecasis, Head of the Hydraulics Department who established the formal conditions for the development of the work.
-	To Mr. Reis de Carvalho, former Head of Estuary Division who made possible the exclusive dedication of the author to this work.
-	To Mr. Júlio Barceld, Head of Estuary Division who did his best
to. maintain acceptable conditions for the prosecution of the work.
-	To Mr. Luis de Sousa, Research Officer of Geotechnique Department.
who introduced the author on the application of the finite element techniques.
-	To Mr. Pires Elias, Research Officer and to Mr. Artur Portela, Research Assistant, both from the Estuary Division who discussed with the author several subjects of the work.
-	To Mr. Mendes de Carvalho, Research Officer of Harbour and Beach Division for his helpful comments on the manuscript contents and on the use of the English language.
-	To Mr. João Cunha, Research Officer of the Informatic Center whose help during the computer program development was always ready and efficient,
-	To the computer operation personnel by their always skilled and willing collaboration.
-	To Ana Maria who patiently typed the text of the work.
The author wants to express his appreciation and gratitude to the Technician of the Estuary Division, Mr. João Geadas Cabaço. During approximately one year he worked directly with the author and
LNEC - Proc. 64/13/5314
1
his contribuition in the preparation of data, in the development of computer programs for data and results processing and in the use of the computational system was enthusiastic and highly efficient, con firming his professional qualities. The author deeply regrets that his collaboration has been terminated.
Finally the author should like to thank Mr, Jean Cunge, from SOGREAH, President of the IAHR Section on the Use of Computers in Hydraulics and Water Resources, for his willingnes in accepting to sacrifice some of his time for discussing this work.
LNEC - Proc. 64/13/5314
II
ABSTRACT
This work is mainly directed to the use of numerical Simula tion of the flow in estuaries as a tool for engineering studies. Some general considerations are made about the definition and claiS sification of estuaries followed by a short description of the es tuarine hydrodynamics. The several solution techniques for hydro, dynamic problems of estuaries are described an&lt;i compared,
A mathematical model of the flow in homogeneous estuaries is formally derived and its equations are vertically integrated leading to the well known shallow water equations. The discretization of these equations is made using the finite element method in the space domain and the finite difference method in the time domain.
A computational system for solving the discretized mathemati, cal model is described and several remarks are made about its dev£ lopment and use.
Finally the results of some tests used in the verification of the computational system are presented.
LNEC - Proc. 64/13/5314
III
SUMÁRIO
Este trabalho é dirigido principalmente para o uso da simula ção numérica dos escoamentos em estuários como uma ferramenta para estudos de engenharia* Fazem-se algumas considerações gerais sobre a definição e classificação de estuários seguidas por urna descrição sumária da hidrodinâmica dos estuários. Descrevem-se e comparam-se as várias técnicas utilizadas na solução de problemas de hidrodinâmica de estuários.
Faz-se a dedução formal de um modelo matemático do escoamen to em estuários homogéneos e integram-se verticalmente as suas e-quaçÕes, obtendo-se as conhecidas equações do escoamento em águas pouco profundas ("shallow water equations”)* Estas equações são discretizadas utilizando os métodos dos elementos finitos e das diferenças finitas, respectivamente no espaço e no tempo.
Faz-se a descrição de um sistema de cálculo para determinar a solução do modelo matemático discretizado e tecem-se várias con sideraçÕes acerca do seu desenvolvimento e uso.
Finalmente apresentam-se os resultados de alguns testes ut¿ lizados para verificar o funcionamento do sistema de cálculo.
LNEC - Proc. 64/13/5314
IV
CONTENTS
CHAPTER 1
GENERAL REMARKS
Page
1.1	- INTRODUCTION ............................................. 1
1.2	- PURPOSE AND LIMITS OF THE WORK............................ 2
1.3	- OUTLINE OF THE WORK....................................... 3
1.4	- A PREVIEW ON THE APPLICATION OF THE WORK.................. 3
CHAPTER 2
ESTUARIES: GENERAL CONSIDERATIONS; HYDRODYNAMICS AND ITS STUDY
2.1	- GENERAL CONSIDERATIONS .................................   5
2.1.1	- Definition of estuary............................  5
2.1.2	- Classification of estuaries ..................... 6
2.1.2.1	- Geomorphological classification
of estuaries ..........................  7
2.1.2.2	- Salinity structure classification
of estuaries  ........................   8
2.2	- HYDRODYNAMICS OF ESTUARIES ............................... 9
2.2.1	- Introduction ................................      9
2.2.2	- Tidal flow ...................................... 10
2.2.3	- Non tidal flow.................................   11
2.3	- REMARKS ABOUT THE SOLUTION OF HYDRODYNAMIC PROBLEMS
OF ESTUARIES ...........................................  14
2.3.1	- The role of simulation in handling estuary
utilisation problems ............................ 14
LNEC - Proc. 64/13/5314
V
2.3.2	- Solution techniques for hydrodynamic
problem of estuaries ............................ 17
2.3.2.1	- Introduction ......................... 17
2.3.2.2	- Hydraulic models ..................... 18
2.3.2.3	- Analog electrical models ............. 18
2.3.2.4	- Mathematical simulation .............  19
2.3.2.5	- A comparison on the use of the diffe-
rent simulation techniques ........... 19
CHAPTER 3
MATHEMATICAL MODELLING OF ESTUARINE HYDRODYNAMICS
3.1	- INTRODUCTION ............................................ 22
3.2	- CLASSIFICATION OF MATHEMATICAL MODELS FOR ESTUARINE
HYDRODYNAMICS ........................................... 23
3.3	- THE CHOICE OF A MATHEMATICAL MODEL ...................... 24
3.4	- DEVELOPMENT OF A PLANE TWO DIMENSIONAL MATHEMATICAL
MODEL OF THE HYDRODYNAMICS OF A HOMOGENEOUS ESTUARY .	25
3.4.1	- General remarks ................. ...... o......	25
3.4.2	- The three dimensional equations of'theflow
in an homogeneous estuary........................ 25
3.4.3	- The two dimensional vertically integrated
equations  ...................................    29
3.4.3.1	- Continuity equation .................  31
3.4.3.2	- Momentum equations .................   32
3.4.3.3	- Initial and boundary conditions ...	38
3.4.4	- Derivation of the discretized model ............. 42
3.4.4.1	- Introduction .......................   42
3.4.4.2	- The choice of the numerical method.	43
3.4.4.3	- Linearization of the differential
equations ............................ 45
3.4.4.4	-	Discretization	in	space .............. 46
3.4.4.5	-	Discretization	in	time ............... 49
3.4.4.6	-	The discretized model ...............  50
LNEC - Proc. 64/13/5314
VI
CHAPTER 4
DEVELOPMENT OF THE COMPUTATIONAL SYSTEM
Page
4.1	- INTRODUCTION ..........................................   51
4.2	— CONCEPTION OF THE COMPUTATIONAL SYSTEM................... 52
4.3	- DESCRIPTION OF THE COMPUTATIONAL SYSTEM.................. 54
4.3.1	- Introduction..............................  .	54
4.3.2	- Data preparation and processing ................  55
4.3.3	- The main module of the computational system .	56
4.3.4	- Processing the results ......,................... 58
4.3.5	- Starting the simulation ........................  60
4.4	- GENERAL REMARKS ABOUT THE COMPUTATIONAL SYSTEM AND
ITS USE ................................................. 60
4.5	- REMARKS ON THE QUALITY OF THE RESULTS OF THE SYSTEM .	64
4.5.1	- Accuracy and credibility......................... 64
4.5.2	- Resolution of the discretization................ 65
4.5.3	- Consistency, stability and convergence ........  66
CHAPTER 5
VERIFICATION OF THE COMPUTATIONAL SYSTEM
5.1	— INTRODUCTION...........................................   67
5.2	- TESTS IN A RECTANGULAR CHANNEL .......................... 67
5.2.1	-	The finite element mesh......................    67
5.2.2	-	Uniform flow in a rectangular channel .......... 68
5.2.2.1	- General conditions of the tests ...	68
5.2.2.2	- Cold-start tests ....................  69
5.2.2.3	- Tests with known initial conditions	79
5.2.3	-	Non steady flow in a rectangular channel ....	84
5.2.3.1	- Introduction ......................... 84
5.2.3.2	- Description of the tests and resuls 85
5.3	- APPLICATION OF THE COMPUTATIONAL SYSTEM TO AN ACTUAL
ESTUARY - THE TAGUS - ................................... 95
5.3.1	- Introduction .................................    95
LNEC - Proc. 64/13/5314
VII
5.3.2	" The finite element mesh . ,	.............,.	96
5.3.3	- Boundary conditions ..........................   96
5.3.4	- Comparison data..................,.............. 96
5.3.5	- Remarks about the tests in the Tagus estuary.	97
5.3.6	- Calibration results ..........................   98
5.4	- CONCLUSIONS ..........................................   101
CHAPTER 6
CONCLUSIONS AND REMARKS ON FUTURE WORK
6.1	- CONCLUSIONS ............................................ 139
6.2	- REMARKS ON THE FUTURE WORK . *........................   140
APPENDIX
GENERAL EQUATIONS OF THE FLOW
1	- CONTINUITY EQUATION....................................... 143
1.1	- General case ...................................     143
1.2	- Continuity for liquids ............................. 144
1.3	- Continuity for turbulent liquid flow................ 145
2	- MOMENTUM EQUATIONS ....................................... 146
2.1	- General case ....................................... 146
2.2	- Momentum conservation for Newtonian Liquids......	148
2.3	« Turbulent flow of Newtonian Liquids ................ 149
BIBLIOGRAPHY ................................................. 151
LNEC - Proc. 64/13/5314	VIII
CHAPTER 1
GENERAL REMARKS
1.1	- INTRODUCTION
This work was prepared as part of the study project "Mathe matical Modelling in Dynamic Problems for Estuaries and Lagoons”. Its purpose is the development of a computational system for the simulation of the flow in a homogeneous estuary. The following (somewhat arbitrary) concepts are used throughout the work about what is a mathematical model and a computational system:
-	a mathematical model is a set of equations which, in this work, represents some conceptualization of estuarine hy drodynamics. That set may be composed of differential £ quations together with initial and boundary conditions
or of some discretized form of them. The mathematical-model of a given estuary is intended as the mathematical model above defined, plus the data which individualize the problem, that is, which define the geometry of the do main and the boundary types, and prescribe the values to some physical parameters.
-	computational system is the set of algorithms and compu ter programs used for the numerical simulation of the phenomena represented by the mathematical model, by the solution of its discretized form. The system includes the data and result processing programs.
Many ideas stated in this work represent the author’s result tant of what is written in the .abundant bibliography which exists about the subject of the work. In some cases it is difficult to
LNEC - Proc. 64/13/5318
1
make specific bibliographic references about those ideas. Thus the author has choosen to make a bibliographic list which contains the consulted works even if they are not referred, in the text.
In this introductory chapter and after these previous re marks, justification is made of the purpose and limits of the study, followed by a short description of its structure. A pre view of practical applications of the work ends the chapter.
1.2	- PURPOSE AND LIMITS OF THE WORK
The main purpose of this work is to_ provide^ LNEC with a com putatioj^l^system^which perm its thesimulationofestuary hydrody nami c s by„pther ways than physicalmode11ing. This is easily justified by the increasing importance of estuaries in what con cerns their utilisation and by the enormous development of such computational systems during the last twenty years which made them a privileged tool for the study of a great number of estuary problems.
For such a computational system it is always possible to in crease its capacity by the implementation of new facilities which permits to solve more complex or different mathematical models. That is the case of estuaries where from an initial system to sol ve, e.g., the linear shallow water equations in a simple domain, it is possible to go for a more complex system for simulating the
flow in tidal flats or the transport of a pollutant.
The limitations of the computational system here presented are related to the nature of this work and its capacity may eas^i ly be increased in the above sense. The defining criteria for the present configuration was that the system must be useful for the solution of some actual hydrodynamic.problems of estuaries and that it may be easily changed for solving more complete and complex models. Thus a two-dimensional depth averaged mathematical model was developed for homogeneous estuaries^ whichcan take into acbbunt^oitbm^friction, wind action, Coriolis force and atmospheric pressure gradients. The system permits the solution in irregular domains with fixed boundaries and so it does not si. mulate the flow in tidal flats.
LNEC - Proc. 64/13/5314
2
1.3	- OUTLINE OF THE WORK
The structure of this work is based on the concepts of ma thematical model and computational system presented at the begin ning of this chapter. Chapters 2 and 3 are concerned with the description of estuaries and their hydrodynamics from the physi. cal and mathematical standpoints, that is, a mathematical model of estuary hydrodynamics is derived, based on a physical conce^ tualisation. The development of the computational system and its verification are considered in chapters 4 and 5. In each chapter, complementary subjects are presented, which are interesting for the development of the main theme.
1.4	- A PREVIEW ON THE APPLICATION OF THE WORK
The usefulness of a computational system for estuaries has several different aspects. One is that it makes it possible to understand the mechanisms of some complex phenomena that occur in estuaries. That is the case of phenomena whose mathematical as pects are.known but for which observation in nature or in physL cal modelling is neither feasible nor economic. It is often possible to build a schematic model whose solution simulates, at least qualitatively, the phenomena. Is is also possible to stu dy the influence of each of the factors affecting the phenomena by separating their action. Such a system is mainly a simulation system.
On the other hand a computational system may be intended to simulate the actual flow in an estuary and to study the changes that will occur in that flow as a consequence of changes introdu ced in the actions over the estuary. This one will be a prediction system.
The importance of such a prediction system is evident in what concerns the choice of project^solutions for estuary works. These works are generally very expensive and not reversible, and so it is necessary to base the choice of the solution on the re_ suits of a prediction system (computational or physical).
Another important aspect of the utilisation of computational system is the simulation of the flow in large regions to learn the boundary conditions that will be used in the physiça1 mode1 ling of a sub-region. Thus the use of the computational system
LNEC - Prec. 64/13/5314
3
can save a lot of work and space necessary for the physical model^ ling of estuaries and, on the other hand, may render possible the use of big scale models in the limited areas available.
The computational system here presented intends to be a pre, diction system. Thus it will be mainly used as a tool for engineering studies which depend on the estuary hydrodynamics, by it self or together with physical models. Such usefulness is obviously limited by its capacity to reproduce only partially the com plex flows that occur in estuaries. That capacity will be increa sed by the future implementation of more complete models and of new facilities allowing for more complex flows simulation.
LNEC - Proc. 64/13/5314
4
CHAPTER 2
ESTUARIES: GENERAL CONSIDERATIONS; HYDRODYNAMICS AND ITS STUDY
2.1	- GENERAL CONSIDERATIONS
2.1.1	- Definition of Estuary
Estuaries are complicated natural systems where several phe nomena coexist and are related in a very complex way. The study of those phenomena belongs to different fields of science such as hydraulics, geomorphology, biology and chemistry, and therefore it is difficult to settle on a complete definition which agrees with the several standpoints from which they can be seen.
Definitions appearing in the literature reflect the particu lar aspects of estuarine global process which are studied by their
(1) respective authors51 . That is the case of the following define tion given by Pritchard (L967 ).
"An estuary is a semi-enclosed body of water which has a free connection with the open sea and within which sea water measura bly diluted with fresh water derived from land drainage.”
From the hydraulics standpoint, this definition considers important features of estuaries such as:
-	the influence on the flow patterns of lateral boundaries,
("semi-enclosed body of water”);
-	the continuous change of water and energy with the sea,
("free connection with the open sea”);
-	the influence of density gradients on flow patterns, (."sea water is measurably diluted with fresh water”).
(1)	For an analysis of the definitions given by several authors, see Caspers (1967),
LNEC - Proc. 64/13/5314
5
From Pritchard’s definition it follows that the upper limit of salt intrusion is considered as the limit of the estuary. The stretch of fresh river above this limit which is subject to tidal action is called by Pritchard the tidal section of the river.
Salinity aspects are not considered in the mathematical model developed in this work and so a definition of estuary where the limits of the study domain are settled by considerations of tidal influence on the hydrodynamics of the body of water seems more convenient. Thus the following definition of estuary will be adopted throughout this work:
"An estuary is a semi-enclosed body of water which has one or more free connections with the open sea, within which the flow is periodically influenced by ocean tide and where sea water e xists jointly with fresh water derived from land drainage”. x	This definition has a lack of precision deriving from the
variation of the upstream tidal propagation limit as a function of fresh water discharge and tidal amplitude. However this is not an important restriction, since in the study of an estuary the ma ximum upper limit, (corresponding to maximum tidal amplitude and mimimum fresh water discharge), must be considered.
2.1.2	- Classification of estuaries
As stated for the definition of estuary, the classification of estuaries may be established from different standpoints. From
the hydraulins-^tnnd.nuhxit--jth.e__t.wojain factorsthat .influence the f2,O3v_st.ruct.ure.-..in an .estuary are its geometry and the sal inity histribution within-it. The -geamairy....of the estuary^ls closely
x^laAed^n^geomoj^holngjdDAV&amp;amp;^ejB^s_^dJh^_?AllhXtyL-di.s.t.rihutlQn.
re.l a ted t o ge ome t r ytidal
wa ter d i s cha rge regi m e.
The classifications of estuaries presented in the following sections are based on the above mentioned aspects, that is, on the geomorphology of the estuary and on the salinity distribution with
(1)	For a more detailed presentation of the classifications, see PRITCHARD (1967) and DYER (1973).
LNEC - Proc. 64/13/5314
6
2,1.2.1	- Geomorphological classification of estuaries
From the geomorphological standpoint, there are four poss.i hie classes of estuaries:
a)	Drowned river valleys - These estuaries appear in zones where the coastal plain is relatively wide and are known also as coastal plain estuaries.
In these estuaries, the sea salt propagation limit can stay considerably seaward of the tidal propagation limit which position is approximately where the bottom rises a bove sea high tide level. These limits are strongly dependent on the tidal amplitude and freshwater discharge. Coastal plain estuaries deepen and widen towards their mouth and the depth-width ratio is usually small.
b)	Fjords - The fjords are U-shaped cross section estuaries that were originally glaciers1 beds. Typically they have a shallow sill formed by terminal glacial deposits at the mouth inside which there is a very deep basin. The exchange of water between the sea and the fjord depends on the relative depth of the sill and the inside basin. This exchange can be very small if the sillTs depth is very shallow and as a consequence the flow has a very marked layer structure with the deeper layers remaining stagnant for certain conditions of freshwater discharge.
c)	Bar-built estuaries - These estuaries rise from the for mation of sand spits and sand islands in a chain extending between headlands. This chain is broken by one or more inlets, and more than one river can input freshwater into the body of water which exists between the coastal line and the offshore chain. These estuaries are in general very shallow and the deposition of sediments within them gives rise to the formation of interconnected structure
of lagoons and channels. At the inlets flow velocities can be high as a consequence of their restricted cross-sectional area but they diminish rapidly inside the estuary.
d)	rest - In this class one can Include all bodies of water which fit the definition of estuary but are not In eluded in the classes above defined. It includes estuaries formed in coastal reentrances originated by tectonic processes.
LNEC - Proc. 64/13/5314
7
2.1.2.2	- Salinity structure classification of estuaries
Accordingly to its definition,.in an estuary sea salt water exists jointly with fresh water derived from land drainage. The degree and way of mixing of these two qualities of water can vary widely and this classification is a oonsequence of these Important factors in the estuarine flow,
a)	Highly stratified estuaries - In these estuaries the up per layers contain fresh water and the lower layers contain sea salt water forming a wedge. In the interface between salt and fresh water there is a little entrainment of salt water to the upper layers and thus some mi, xing, The degree of entrainment is small and depends on the velocity differences between the two layers. The po sition of the salt wedge depends on the tidal amplitude and fresh water discharge and changes along the tidal cy cle. The ratio of river flow to tidal flow is large in these estuaries and in general the cross section width is small compared to its depth.
b)	Partially mixed estuaries - This type of estuaries has the characteristics of a two layer system although there is a strong mixing between salt and fresh water, Sallnl ty decreases continuously from bottom to surface with a zone of high gradient at about mid depth. From the head of the eBtuary seaward there is a continuous Increasing of the salinity in both layers. In these estuaries the ratio of river flow to tidal flow is small.
c)	Vertically homogeneous estuaries - If the tidal flow is much larger than the river flow and the cross section of the estuary is small, the turbulence generated by the bottom roughness may be large enough to mix completely salt and fresh water. In this case there are no vertical salinity gradients. However there is an increasing
of the salinity from the head to the mouth of the estuary.
LNEC - Proc. 64/13/5314
8
2.2	- HYDRODXNAUICS OF ESTUARIES
2.2.1	- Introduction
The flow in an estuary is the resultant of several diffe, rent hydrodynamic ^phenomena'which have different origins, diffe, rent time and spatial scales* 'and different degrees of comple xityv That flow is thus a complex phenomenon and several theo. retical ways must be followed to study its components.
As an example, the water level variations due to wind ge. nerated waves in the estuary have a time scale of less than 15 seconds and a spatial scale of less than 200 meters. Unless some very restrictive assumptions are made, those level variations must be studied in a stochastic way. On the other hand the water level variations due to the tide in the near sea have a time scale of about 12,5 hours and a spatial scale which can attain the whole length of the estuary. If no other external factors affect the flow, those level variations can be predicted in a deterministic way with great accuracy, in spite of seme slm plifying assumtions.
Besides the considerations of time and spatial scaling of the component flows, their relative magnitude must also be taken into account. It depends on many factors and may determine very different flow patterns in estuaries with similar geometry.
These very general remarks about the flow in estuaries lead’ to the conclusion that for studying the hydrodynamics of’ an estu ary:
-	one must choose which flow components are to be studied;
-	one must choose the correct time and spatial scales and arrange mechanisms to simulate the influence of different scale phenomena on that flow;
-	one must know the relative magnitude of the several flow components.
In general, from the consideration of the two last items, important simplifications may result in the creation of a conceja tual model for the flow to be studied.
(1)	By time and spatial scales one means roughly the minimum time t interval and minimum space in which a phenomenon can be descrl bed with its characteristics.	i
One of the aims of this work is to simulate the time varia tion of the flow along the tidal cycle for the whole estuary . For that purpose it is convenient to consider that the total flow is the resultant of a tidal flow and a non tidal flow,
2.2.2	- Tidal flow
The tidal flow in an estuary has two different driving for ces:
a)	the sea level variation due to the tide in the near open sea* This variation induces a wave through the mouth of the estuary which propagates along it;
b)	the tide of the estuary itself, that is, the water level variations due to the attraction of the mass of water by the moon and the sun.
The mass of water inside the estuary is very small as comp a red to the mass of the sea and so id: the estuary tide as compared to the ocean tide. Thus the estuary tide may be neglected and the tidal flow in an estuary may be considered as solely induced by the level variations at its mouth.
The tidal flow has the characteristics of a wave whose pro pagatlon mode depends fundamentally on the geometry of the estua ry and on the energy dissipation if non tidal flow is discretized Theoretically that wave can vary from a standing wave to a pure progressive wave.
If energy dissipation is unimportant the superposition of the entering wave with the one reflected at the head of the estuary gives rise to a standing wave. If no nodal lines exist, all the points in the estuary have some phase and at each point there is a phase lag of a quarter of the tidal period between the current velocity and the surface elevation.
On the other hand, if all the energy of the entering wave is dissipated before a reflected wave is formed, then the tidal wave is a pure progressive wave. In this case the surface eleva tion and the current velocity have the same phase at each point and there is a continuous phase lag from the mouth to the head of the estuary.
In actual estuaries there is always some energy dissipation
LNEC - Proc, 64/13/5314
10
In general, the free surface level in the estuary’s near sea varies with time in an almost sinusoidal way, with a period of about 12,5 hours for a semi diurnal tide. Along the estuary the amplitude of the tidal wave changes increasingly or de, creasingly as a function of the energy dissipation and of the cross section area variation. It looses its symmetric sinusoidal shape because the propagation speed is greater for its crest than for its trough. Consequently the floodrs duration decreases from the mouth to the head the estuary and Inversely the ebb’s duration increases. In estuaries with special geometric and energy dissipation characteristics the assymetry of the tidal wave can become very marked if the tides have large amplitudes. The waves can even break with the consequent formation of a tidal bo re which can propagate for long distances.
2.2.3	- Non tidal flow
Several phenomena may contribute to the estuarine flow Introducing its non tidal components. The influence of these components on the resultant flow depends on their time and spatial scales and magnitudes relative to the tidal flow. The main driving forces of the non tidal flow are:
a)	Non tidal water level variations at the mouth of the es tuary. These variations can be originated in several ways: - by abnormal atmospheric conditions in the open sea. The formation of low atmospheric pressure zones In the open sea originates an elevation of the water relative to the normal tidal levels (storm surge). The importan ce of storm surges depends obviously on their magnitude and since they have time scales of the same order of the tide, there Is a great probability of their occurrence during the high tide period with the consequent overflew of the estuarine banks.
LNEC - Proc. 64/13/5314
11
-	by movements of the ocean bottom produced by seismio activities» These movements originate waves (tsunamis) who. se propagation affects the water levels in the estuaries near sea and so the wave which is induced through their mouths. The magnitude of tsunamis can be very important relative to the tidal amplitude and although their time scale Is smaller than the tidal scale, they can be a d£ tferminant component of estuaries circulation.
-	by the propagation of wind generated waves through the mouth of the estuary. These waves do have time and spatial scales much smaller than the tides and so they do not significantly affect the mean flow.
b)	The wind
The interaction between the water and the moving air at the free surface results in a vertical transfer of momen turn from the air partioules to the water particules, so introducing a new component in the estuary flow. The x-consequence is a water flow with the wind direction in the upper layers of the estuary. This water mass flow causes an elevation of the water level at the lee zones of the estuary thus modifying the slope of the free sur face. This slope is the driving force for the flow in the lower layers, which has a direction opposite to that of the upper layers. This last flow balances the upper layers flow and the water accumulation in the lee zone. One important aspect of the lower layers flow is that it may increase or decrease the tidal velocities near the bottom so increasing or decreasing the energy losses due to the bottom friction.
The magnitude and the time and spatial scales of the wind generated flow are closely related to the characte^ ristlcs of the wind field. The instantaneous structure of the wind field and its time variation are in general very complicated in an estuary area. However, considering that one wants to study the influence of its derived flow component on the tidal flow, only mean time and space variations taken over relatively large inter vals and areas are to be considered.
LNEC - Proc. 64/13/5314
12
c)	Atmospheric pressure gradients
The existence of atmospheric pressure gradients in the area of the estuary changes the free surface profiles a and its variation in time introduces a new component in the estuary’s flow. This component is in general not im portant in estuaries since the mass of water is very small compared to the sea where storm surges are firmed by a similar atmospheric phenomenon.
d)	Fresh water discharge from land drainage
The total volumes of water which pass through the mouth of an estuary during the ebb and the flood, for one tidal cycle are not the same. This may have two causes. One is the inequality of successive tides. The^ether is the freshwater discharge into the estuary which is res** ponsible for the fact that the mean flow discharge over the tidal cycle at any cross section is not zero and has a seaward resultant. This can be easily Justified by simple considerations of mass balance.
This component of the non tidal flow is called the res£ dual flow. Its magnitude depends on the relative volumes of sea water and fresh water entering into the estuary during the tidal cycle.
In general the variations of the fresh water discharge for which the global flow parameters are sensitive do have a time scale greater than the tidal scale.
e)	Density gradients
The existence of density gradients may be originated by the existence of sea water jointly with fresh water, by temperature gradients and by the existence of dissolved or suspended substances in the water.
Density gradients can affect significantly the structure of the flow because, in addition to local flow phenomena, they are a determinant factor of the slopes of the iso baric surfaces and so of the velocity distribution within the flow.
f)	Disposal of effluents
The disposal of effluents from industrial or power plants or from sewage has two distinct effects on the estuarine
LNEC - Proc. 64/13/5314
flow. One is related to the introduction of momentum in the flow at the disposal location. As the discharge vo lumes are in general much smaller than those of the estuary, that transfer of momentum is significant only in a small area where the flow pattern is affected. The o ther effect depends on the effluent nature. In general it has not the same density as the estuarine water and may spread over a large area changing to a greater or less degree the density structure of the water, and so the structure of the flow,
g)	Earth rotation
The movement of the water mass in the estuary is affected by the fact that the Earth is a rotating system. If no external action exist, the water particles tend to follow a straight pattern through their inertia. In the Earth’s relating frame, that pattern is a curve which corresponds to the deviation of the moving particules to their right hand side in the Northern hemisphere and in the opposite direction in the Southern hemisphere. The magnitude of this effect (Coriolis effect) is proportional to the ve. locity of the particle and to the latitude, so it is ze ro at the Equator and reaches its maximum at the Poles, The Coriolis effect may be important for large width es tuaries located at high latitudes affecting the flow pa rameters distribution along their cross sections.
For narrow estuaries or for estuaries located at low la titude zones this effect may be neglected.
2.3	- REMARKS ABOUT THE SOLUTION OF HYDHODINAMIC PROBLEMS OF ESTUARIES
2.3.1	- The role of simulation in handling estuary utilisation problems
Estuaries have always been used by man for multiple purposes. Their geographic situation in direct communication with the open sea, together with their natural shelter conditions, make eja tuaries priveledged places for harbour activities. In many cases they are also the terminal of navigable inland waterways. As a consequence estuaries became preferencial zones for industrial,
LNEC - Proc. 64/13/5314
14
commercial and urban development in parallel with harbour actiyi ties*
All those activities depend on the global regime ©f the es. tuary wich may be defined by several parameters such as flow velo cities, water levels, salinity, temperature, sediment transport, water quality parameters, etc. That regime is determined by the geometry of the estuary and by external factors such as tidal am plitude in the connecting sea, fresh water and sediment discharges into the estuary, atmopheric pressure, wind, industrial and urban sewage, termal discharges from cooling circuits, etc. Some of these factors may be changed by man, consequently changing di rectly or indirectly the defining parameters of the estuarine re gime.
From the hydrodynamics standpoint the parameters which de£i ne the estuarine regime are flow velocities and water levels which are to a greater or lesser extent related to the remaining para meters and to the above mentioned external factors,
Man's activities do need in many cases the alteration of the estuary geometry, which will affect its hydtodynamic regime. Such are the cases of, e.g., the construction of harbour facilities and the deepening of navigation channels. The consequent changes in the hydrodynamics of the estuary may merely be local or may be extended to a greater or smaller area of the estuary and they may affect other parameters and so other activities. Thus when planning some work in an estuary which will change its geometry, the engineer faces the problem of, in addition to the deflni tion of the fork's layout, determining how the hydrodynamics will be affected. Furthermore it is necessary to study the consequences for the other existing activities as far as any alteration of the hydrodynamics parameters will probably change ether parameters
Another factor that may produce important alterations in the global regime of the estuary without modifying its geometry is the change of fresh water and sediment discharges coming from upstream For example, the construction of a dam in a river may stop the flow of sediments, change the chemieal composition of the estuarine water, alter the residual flow, etc.. Obviously, this
LNEC - Proc. 64/13/5314
15
may strongly affect all the activities of the estuary
The implementation or alteration of other external factors such as sewage and cooling circuits discharges, may alter only lo eally the hydrodynamic field. However it may strongly affect o-ther parameters, such as temperature and chemical composition of water in a large zone of the estuary* The effect of these alterations on the global behaviour of the estuary must be evaluated in spite of inherent difficulties*
The estuary is a complex natural system. To achieve a pro fitable multipurpose current utilisation which does not compromi se its future and its related activities, man faces problems which are complex and difficult to solve globally. In spite of the big effort already developed, there is still a long way to run until the complete understanding of estuaries behaviour and so to the global solution of their problems. However, there are tools which may solve some of these problems by partially simulating that be ha viour. Such are the cases of hydraulic models and computational systems*
Any problem to be solved in an estuary needs the knowledge •f it hydrodynamics since this one is determinant of the global regime. Thus the simulation of hydrodynamics by physical mo delling or by numerical techniques yields the basic data for any study. Other aspects of estuary behaviour may be simulated by the same techniques, but that simulation needs the results of hy drodynamic simulation or must be performed simultaneously.
During recent years a big development of solution techniques for estuary problems has been achieved* Such development is strongly related with the continuous growing of the digital computation capacity, which makes possible a better utilisation of existing simulation techniques (numerical and physical), increases the number of problems which can be solved (by numerical Simula tion), and greatly enlarges the number of persons which can deva lop and use solution techniques for those problems.
A description of some aspects of the use of solution techni ques for estuarine hydrodynamic problems is made in 2*3.2*
LNEC - Proc. 64/13/5314
16
2.3.2	- Solution techniques for hydrodynamic problems of estuaries
2.3.2.1	- Introduction
The problems that one needs to solve in estuaries involve» as a general-^cule, the knowledge of their hydrodynamics regime qnd the prediction of the changes in that regime as a consequence of modifications introduced in.dhe^jceometry of the estuary and / or in the exte rnal^condi t io n s t hat 1nf1uence i t s flow pat tern.
A purely empirical approach to those problems, is to collect and analyse all the available data such as water levels and flow velocities and to predict by intuition what might happen to the flow in the future under given conditions. This approach is, of course, based on experience and, although this one is very im portant, in most cases it is insufficient as a consequence of the estuarine flow complexity. Thus for the solution of an estuary problem which has a minimum of risk, that empirical approach is not to be trusted and other techniques must be used.
Such techniques make use of some sort of simulation of the flow, which can be made by physical or mathematical methods. Phy sical simulation can be based on the hydraulics similitude laws (hydraulic models) or on some analogy between flow variables and other physical variables representative of a different type of phenomenon, in general electric (analog models)Q) The terminolo gy "physical model” is generally used for hydraulic models since these are more widely used than analog models.
The mathematical simulation is based on the solution of so me mathematical model of the flow, that is, some set of equations in which the dependent variables are the flow variables. The g£ neral partial differential equations of the flow are complicated and so is the domain where they must be solved. Thus some simply fications are made giving rise to different mathematical models of the flow. In general these models must be solved by numerical techniques with the use of digital computers (numerical models).
(1) An hydraulic model can be classified as an analog model where the two sets of variables are of the same kind.
LNEC - Proc. 64/13/5314
17
A short presentation of some aspects of the utilisation of the different types of simulation techniques is made in the folio wing sections.
2.3*2.2 - Hydraulic models
The large experience in the use of hydraulic models makes them a reliable tool for studying several hydraulic phenomena which occur in estuaries. In spite of the inherent difficulties related to similitude problems, scale effects and the impossibili ty to simulate some phenomena, hydraulic models do have the abil£ ty for simulating complex aspects of the flow which are difficult or impossible to simulate using other techniques. Such are the cases of the vertical distribution of velocities, of the bed ev£ lutlon, etc.. Hydraulic models also have the ability to slmulta neously simulate several phenomena which have different time and spatial scales.
However some factors exist which may discourage for the use of estuary hydraulic models. In fact, for building and operating such a model it is necessary to have:
-	a large covered area;
-	a big amount of expensive equipment;
-	a large period of time to build, calibrate and verify the model;
-	an experienced operating staff.
As a consequence, a hydraulic model study of an estuary is always expensive and time consuming, although the costs and the timing of estuary works may entirely justify that study.
2.3*2*3 - Analog electrical models
The simulation of the estuarine flow by means of analog e-lectrical models was never a widely used technique. This may be concluded from the very low number of publications existent about the subject. This number seems to be decreasing and perhaps the use of that technique will disappear.
LNEC - Proc. 64/13/5314
18
Several reasons may be pointed out for that. Those models were never an alternative for hydraulic models, except in the ca ses where the flow has one dimensional characteristic. Besides, an analog model may be considered as an analog computer and, for many purposes, the use of this type of computers became but of date by the rising and rapid growth of digital computers.
2.3.2.4	- Mathematical simulation
The mathematical simulation of the flow by the analytic so lutien of its equations is only possible if those equations are highly simplified and the domain’s geometry is very simple. Thus, for actual estuaries, those analytic models are of little interest.
The parallel development of digital computers and numerical analysis rendered possible the solution of complicated mathematl cal models of the flow, in domains with complicated geometry such that of estuaries. A great number of computational systems exist today for the numerical simulation of the flow in estuaries and this technique has already been used in many actual studies.
The numerical simulation has however some limitations arising mainly from:
-	the limitation of available computational capacity, which limits the complexity of the mathematical model to be used and the ac curacy of the results.
-	mathematical aspects, such as the choice of correct boundary conditions.
-	the simplifications made in the mathematical model, such as the use of fixed domains and the vertical integration of the equations .
2.3.2.5	- A comparison on the use of the different simulation
techniques
As it was said above, analytic mathematical models and ana log electric models are of little interest for actual estuaries studies. Thus this comparison is limited to hydraulic models and numerical techniques for the simulation of the estuarine flow. That comparison is based on the analysis of several factors which affect the time, the cost and the suitability of the results to the purpose of the study.
LNEC - Proc. 64/13/5314
19
In what concerns time, if all necessary data exist, the du ration of an hydraulic model study is several times that of a nu merical simulation one. This comes mainly from the comparative- ' ly long time necessary to build, calibrate and verify the hydrau lie model, which in general lasts for more than a year. After the model verification the difference of the durations for each experiment is not so important.
Concerning the cost of the study, this cost is quite diffe rent for the two techniques. In fact, a hydraulic model needs a large covered area and a lot of equipment which are attached to the study during all its duration. Besides, the building and main tenanee of the model are expensive and its operation needs an ex perienced staff of several people. The numerical simulation needs that a computer be available during some relatively short periods and for a complete study two experienced people are sufficient to prepare the data for running the computational system.
Thus the advantages of the numerical simulation over hy- • draulic models seem obvious in what concerns time and cost. How ever, the main factor which must be taken into account for the choice of the technique to be used is the fulfilment of the pur pose of the study. For that, the two techniques must be compared in what concerns their abilities and the reliability on their r£ suits, keeping in mind that these results are only the ones needed for that study. These aspects are related to the following consi derations:
-	the mathematical model used for the numerical simulation results from simplifications made in the general equations of the flow, while these equations "are" in the hydraulic model. Thus the mathematical model represents a simplified flow.
-	Scale effects may exist in the hydraulic model simulation while this is a non existent problem for the numerical simulation.
-	Hydraulic models have the ability to simulate the flow in singu lar zones of the estuary such as tidal flats and corners without great difficulty. With numerical techniques these flows can on ly be simulated by making some more or less "cooked" assumptions about them,
-	With numerical techniques it is possible to simulate some exter nal actions over the flow such as wind action, atmospheric press sure gradients and Coriolis effect without a great addition of
LNEC - Proc. 64/13/5314
20
- Hydraulic models may be used for studying the estuary's bed evo lution while at this stage this is unfeasible with mathematical models with a minimum of reliability.
From these considerations one may conclude that for some pro blems only one of those two techniques must be used, while in other cases one must choose among them. However in some cases the use of both may be justified. In fact one reason that makes hydraulic models so large is that, in addition to scale problems, it is necessary t© fix the boundaries of the model far enough from the stu dying area in such a way that correct known values may be imposed there or that errors in the boundary conditions may be attenuated. With the results of a numerical simulation good values for bounda ry conditions may be found near that studying area and so big sea le hydraulic models may be built on the same area, or the area nee ded for the study becomes smaller/ With the big scale models -the study of local effects which can not be done with small scales
and for which numerical simulation is not yet a satisfactory answer becomes possible, increasing economically the number of problems that can be solved in the field of actual estuary studies.
LNEC - Froc. 64/13/5314
21
CHAPTER 3
3.1	- INTRODUCTION
By definition (see ch.l), a mathematical model of the estua rine hydrodynamics is a set of differential equations together with suitable initial and boundary conditions, possibly in a disore, tized form. In order to avoid ambiguity, the discretized form of the differential equations will be called the discretized model. Thus mathematical model concerns the differential form of the equa tions.
The mathematical model may be derived from the general equa tions of the flow by making several assumptions about the flow cha racteristics, or may be established directly from those assumptions. The discretized model results from the application of some method of numerical analysis to the differential equations.
In this work the mathematical model is derived from the gene, ral equations of the flow. This methodology seems better because it permits an useful estimate (although subjective) of the influen ce of the simplifications made during the derivation on the results of the simulation.
Th® discretized model is fundamentally an algebraic system of equations derived from the differential equations. The so lution of that system may be obtained at a given set of points in the domain and it is an approximation to the solution of the mathe^ matical model.
Twou-d±s.t.inc_t.._ ,nrob 1 ems may _be. no sed.about the quail ty of the
simulation results. One is how well the mathematical model re pre, eents the actual flow in the estuary. The other is how close is the solution of the discretized model to the true solution of the differential equations of the mathematical model.
LNEC - Proc. 64/13/5314
22
The first problem depends fundamentally on the assumptions u sod to simplify the general equations of the flow, or in other words, on the suitability of a given model to the flow in a given estuary. The second one is a complicated mathematical problem, at least for some models and some numerical methods.
In this chapter, after a classification of mathematical models, the choice of a ;plane two dimensional model is justified. This model is derived from the general equations of the flow and its discretization is made using the finite element method.
3.2	- CLASSIFICATION OF MATHEMATICAL MODELS FOR ESTUARINE HYDRO-
DYNAMICS
There are several criteria which can be used to make a clas sification of mathemabical models. For example, that classification may be based on the type of flow (steady or unsteady), on the driving forces of the water movement (tide, wind, etc.), or on the degree of simplification of the model relative to the primitive ge. neral equations (linearized or not, with or without convective terms, etc.). Amore interesting classification in what concerns hydrodynamics estuarine models is baaed on the number of spatial dimensions used to describe the flow domain. From this standpoint, the following types of models may he considered:
(3D) - Three dimensional, models
The general equations of the flow more or less simplified are solved in a three dimensional space.
(2D-H)	- Two dimensional horizontal plane models
The general equations of the flow are vertically integrated between the bottom and the free surface, and are solved in a horizontal plane domain.
(2D-H-L) - Two dimensional horizontal plane models with, layers
They are an adaptation of 2D-H models for stratified estua ries* In each layer density is kept constant.
(2D-V) - Two dimensional vertical models
The general equations of the flow are width integrated and solved in a vertical plane domain normal to the direction of the integration,
(ID) - One, dimensional models
The general equations are integrated over the cross section and are solved along the axis of the estuary.
3.3	- THE CHOICE OF A MATHEMATICAL MODEL
For the choice of a mathematical model which will be used for simulating the hydrodynamics of an estuary one must analyse some factors which may affect that choice. They are:
a)	Existence of.computational facilities
When more dimensions are used in a model, more core is u sed, more data preparation is needed and more time is spent in the computations. Hardware or operational Jimi, tations may preclude the use of a given mathematical model.
b)	Available data
The use of simulation for an actual estuary study makes necessary the calibration and verification of the model. This implies that a lot of synoptic data must be available. That data grows strongly with the number of dimensions of the model, and its collection is a very costly operation.
c)	The scope of the simulation
The model must be suitable to describe the phenomena which one wants to study. Is is not possible to study the beha viour of a salt wedge or the Coriolis effect with a one dimensional model. On the other hand a ID model is suffi clent for studying water levels in many estuaries.
d)	Geometric characteristics of the estuary
Some estuaries have a geometry which is well suited for a ID model study since its flow does have one dimensional characteristics. On the other hand if the geometry of the estuary is irregular at least a 2D model must be used.
Items a) and b) discourage by themselves the use of three djL mensional models. In fact to run a 3D model one must have access to a large computer during a long period of time. Besides, it is very difficult that sufficient synoptic'data exists for the cal£ bration and-verification of the model.
The study of Portuguese-estuaries is the main scope for the utilization of the computational system developed in this work.
ID models are not suitable for the study of some of those estuaries such as the Tagus, the Sado, Aveiro and Faro* Thus the development of a computational system based on a one layer two dimensional plane model for the hydrodynamics of a homogeneous estuary was chosen. This is considered as a first step for the development of more complicated models, but, nevertheless, permits the study of some important engineering problems.
3.4	- DEVELOPMENT OF A PLANE TWO DIMENSIONAL MATHEMATICAL MODEL OF
THE HYDRODYNAMICS OF A HOMOGENEOUS ESTUARY
3.4.1	- General remarks
The three dimensional general equations of a homogeneous flow, derived in Appendix 1, are the starting point for the development of the two dimensional model. The transformation of those equations is mad® through three main steps. At first, they are adapted to the particular nature of the flow in estuaries. After that, they are vertically integrated over the depth of the flow. At last a discretized model is derived through the application of the finite e, lement method to the depth integrated equations.
The description of the finite element method or any other nu merical method is not in the scope of this work. However some general features of the method are presented as a basis for a comparison with the finite difference method, which is better known by hydraulic engineers, and for justifying the choice of the method.
3.4.2	- The three dimensional equations of the flow in an homoge-
neous estuary
In Appendix 1 the continuity and momentum three dimensional equations for the flow of a Newtonian liquid with constant density are derived. For estuaries the momentum equations must be adapted to the particular nature of the flow, while the continuity equation remains in the same form as a consequence of its simplicity.
In what follows the flow variables are expressed by their
of the variables is zero; the evolution of the variables mean value in time defines accurately the evolution of the flow»
The notation used in App.l for the mean value over At
(&lt;y&gt; = mean value of y over At ) is omitted since it is superfluous. Exception is made for the turbulent momentum transfer term p&lt;ufu/&gt; where u/ stands for the instantaneous fluctuation of u, around its mean value.
Xj (j - 1,	2,
on the Earth with x^
3)	are the coordinates in a direct system fixed directed vertically upward.
The summation convention is used throughtout this work.
3.4.2.1	- Continuity equation
The three dimensional continuity equation remains in its mo. re general form for the flow of a homogeneous liquid, derived in App.l, That is
G= 1,2,3)
(3.1)
where	is the mean value over A: of the x^ component of the v£
locity vector in a point of the flow. In the derivation of (3.1) it was assumed that variations., in density may be neglected, that is, the Bo us sinesq ap_p.roximation was used (s e e Ph iHips (1980).).
3.4,2.2	- Momentum equation
In App.l the three dimensional momentum equations are derived for the flow of a homogeneous liquid. The equation relative to the x^ component of momentum appears in the form
GJ =1,2,3)
(3.2)
where Uf and p are the mean values over At of the x^ components of the velocity vector and of the pressure at a point of the flow.
p is the fluid density (assumed constant), p is the dynamic vi£
cosity of the fluid and pX{ is the comPonent of the sum of the external mass forces per unit volume.
Some adaptations may be made in (3.2) as a consequence of the
estuarine flow nature.
Considering that gravity is the only vertical external mass force acting on the flow, it follows that X3 “ _g . Introducing this force in equation (3.2) for i=3, all the other acceleration terms may be neglected with regard to it. Consequently instead of (3.2) one may write
cp &gt;)=
0* V	V * f *	Cr . . J	' f
(i= 1,2.7= 1,2,3)
(3.3)
This means that the pressure distribution follows a hydrostatic law.
Vertical integration of the last equation of (3.3) between a point P in the flow with elevation x^ above the zero datum level and the free surface with elevation H gives
where p is the pressure at P and pa is the atmospheric pressure.
Derivation of (3.4) with regard to yields
cp
CXi
CPa
CXi
pdx3 = 0
(3.5)
(1 &gt; or, applying Leibnitz rulev
¿P = ?Pa
Pa;- cXi
+ 9
(3.6)
Dividing by pg and taking relative pressures ( pa - O)f the last equation becomes
1
P9
CP
rx,-
cH 1	_
C'X~p JA.cxf ‘3
(3.7)
The first term in this equation is the piezometric surface inclinationiin P and the second term is the free surface x^n clination in the vertical of P. Thus the sedond member of (3.^J represents the relative slope of those two surfaces, which is ob viously zero since we considered that p is constant*
However some interesting considerations may be made about that relative slope (Pritchard, 1971)* For estuaries with strong horizontal salinity gradients, the distance between the isobaric and the free surface decreases seaward. Typically in such estua« ries during the ebb period the flow velocity decreases with depth while in the flood period it increases with depth. Consequently for the whole tidal cycle there is a net non tidal circulation di^ rected up the estuarjr near the bottom and seaward in the upper la yers. The relative slope between the isobaric and the free surfa ce acts as the driving force of that circulation.
Important difficulties arise when attempting to introduce this mechanism in the modelling of estuarine circulationtbecause to compete the above mentioned relative slope, it is necessary to use the spatial distribution of temperature and salinity from which the density may be calculated. Usually these data are not availa ble and so that computation is impossible*
Resuming calculations from equation (3.6), the Integral term
(1)
'b
ca
CXi
a
C
CX;
is zero, si it may be written
cp dXf
cH_
(3,8)
Substituting In first equation of (3.3), yields
d	c	c	. .	cpn cH
(P»i) +	&lt;P &amp;lt;"i’"j &gt;) = _	+ PV~u' + PX‘
(3.9)
(i= 1,2.7= 1,2,3)
Supposing now that some empirical relationship'is established which ma^es the turbulent momentum transfer term a function of «, , Uj and a coefficient^ equation (3.9) and the continuity equation are a representative model of the circulation in an estua ry. However there are four unknowns , (uf, u2, u3, H) &gt; and only three equations and a direct solution is not possible. One way of aver coming this difficulty is the use of a two dimensional model which provides a satisfactory estimate of the free surface elevation H, Thus the introduction of H as a known value in equation (3.9), ma kes it theoretically possible to solve the three dimensional model. The main difficulty arises from the fact that it is necessary to have a credible relationship for the coefficients of turbulent mentum transfer in terms of known computable parameters, Pritchard (1971) points to possible further simplifications in the equations that may constitute the starting point for the development of such a model.
3.4.3	- The two dimensional vertically integrated equations
The three dimensional equations of continuity (3,1) and momentum (3.9) are the starting point for the deri^ vation of the two dimensional model. For that purpose, those equations are vertically integrated over the depth of the flow taking into account the following boundary conditions:
a)	At the free surface
= 0
_V,= H
(3.10)
that is, the particles that are on the free surface remain on it.
Developing (3.10) gives
cH
(3.11)

but
(3.12)
thus (3.11) becomes
cH cx~k
(k = 1,2)
(3.13)
b)	At the bottom
(3.14)
that is, the particles that are at
Developing (3.14) yields
the bottom remain there.
(3.15)
but
(3.16)
and, as the bottom is fixed
cz — = 0 Ct		(3.17)
thus (3.15) becomes		
f c- \		
b^-''3L=°	(A-=1,2)	(3.18)
3.4.3.1	- Continuity equation
Starting from three dimensional equation
1,2,3)
(3.19)
and integrating vertically over the total depth of the flow there results
(Zc = 1,2)	(3.20)
Applying the Leibnitz rule to the uk Integral yields
(3.21)
or
lwk -- u3(H)^ +	4^--u3(z)^ = 0
where
(3.22)
(3.23)
is the depth average velocity of the flow.
(3.24)
cr CAk
which is the continuity equation for the two dimensional vertical^ ly integrated model.
3.4.3.2	- Momentum equation
The derivation of the two dimensional momentum equations starts from the following three dimensional equation (see 3,4.2)
(p[/.)+ (pW n.)+ (P&lt;lt. l{+ &gt;) = _ ^pg 7-r + pV2ni- + pAf
C7 CXj	C.Xj	CX{	(3.25)
(1= 1,2,7” 1.2,3)
Considering that the density p is a constant, it may be wri,t ten
Clij G
Cl ~^CXj
(3.26)
where	is the kinematic viscosity of the liquid.
Vertical integration of (3.26) over depth, using Leibnitz ru le, gives for eaoh term of its left hand side
Ui dx3 ” u,(H)
cH ~cT
(3.27)
(3.28)
C//	C'
ukUidx3 — uk(H) u^H) 7— + uk(z) u£z) ^ + n3(W)	tfi(=) =
(	t Afc
(3.29)
yields
(3.31)
¿1) Consider now that the velocity^ ' at any point of the flow is given by (see figure)
+	(3.32)
where u is the depth average veloci^ ty over the vertical of that point and u' is the deviation of the actual velocity u from u .
Thus one may wrtte
	+ u’k u'i	(3.33)
and		
		(3.34)
B ut		
	iw=Mi	(3.35)
(1).
This velocity is a mean temporal point velocity over a period At such as defined in 3.4.2,
and
Then (3.34) becomes
I	+	(3.37)
Applying (3.37) to the first term of the second member in (3.31) gives
dx3
(3.38)
Taking into account (3.27) and (3.31) the first two terms of the momentum equation (3.26) may be written
c xk
cH
Ct
(3.39)
Developing the first and third terms yields
(3.40)
The second and
ged to
third terms of this equation may
be rearran
(3.41)
and as H = h^z it is
ct ct ct dt
(3.42)
Thus in (3.41)
the expression between brackets is zero by
continuity (3.24). The first two terms of (3.26) become
, Clii , _ Citi c /r „
11	---h 11 III. ------F~----- {¡I i/i-Wr)
Ct	cxk cxk
The integration of the third term of the momentum equation gives
(3.44)
45)
The last two terms may be neglected since vertical velocity fluctuations around its mean time value may be taken as zero. So (3.44) may be written
cz
(3.46)
For the terms of the second member of (3,26) vertical integration yields
rn
P CX;	P CX,
(3.47)
(3.48)
Taking Coriolis force as the only external horizontal mass
force acting on the flow, it is
xf = (-l)3-
where /=2Q sin&amp;lt;p is the Coriolis parameter with
Q - Earth angular rotation velocity
( Q =7.M2 xlO_5s-l)
&lt;p - latitude
Thus
(3.50)
J "
Considering the equations (3.43), (^.46) to the vertically Integrated momentum equation may be reordering and dividing all terms by h.
(3*48) and (3*50), written after
cu¡	„ cü¡	.	cH	1 c	' ' -^ +
+	/«3-í + é?	-hv p—(^ wkw*-i-/?&lt;ufc U,. &gt;)-
01	C	CAj /I (7A^
(3.51)
In this equation some terms appear without a known explicit dependence on the flow variables. Thus empirical expressions must be used to quantify those terms.
The term between brackets has one part related to turbulence and another related to velocity vertical distribution. Its impor tance is small when compared with other terms and so it can be n£ glected. However many authors use that term taking advantage of its favourable influence on the stability of the solutions, by acting as a filter for the short waves. In these eases that term is replaced by another with a structure similar to the so called ”Rey; nolds’stresses”, like, for example, the following one
2
Z
J = i
(3.52)
where sJk is a coefficient which is adjusted independently of phys£
cal considerations about the flow.
The last term of (3,51) is related to the viscosity and may be neglected because the flow is turbulent during almost all the tidal cycle.
The last two terms in the first member of (3,51) are related to the turbulent momentum exchanges at the surface and at the bottom, These exchanges are due to the effects of the bottom roughness and of the surface wind stress. They are substituted by empirical terms which simulate these effects since no explicit dependence on the flow variables exist.
Experience shows that a quadratic law is a good representa tion of the bottom roughness effect. Thus the related term in the momentum equation may be substituted by
(“1 + ^2)1/2	(3.53)
where g is gravity and C is the Ch^zy coefficient. Obviously 0-ther roughness coefficients like Manningrs n, can be used, changing slightly the above expression.
The wind effect on the flow is more complicated to handle because it induces changes in the vertical velocity distribution. Thus that effect is also influenced by bottom roughness, Dronkers (1964 )fand it should be considered in combination with surface stress in the expression that simulates wind action, It must also be taken into account that the free surface is deformable, so inducing variations in its "roughness” and consequently in the momen turn exchanges between air and flow. In general a quadratic relationship is used for writing the surface stress as a function of wind velocity. In the momentum equations the related term is writ ten in the form
¿¡fP'Wi2	(3.54)
where is the x^ component of wind velocity at a standard elevation above water level, pa is the air density and y is an adi-mensional coefficient that depends on the bottom roughness and wa ter surface shape.
The momentum equation can now be written in the following form which makes its solution possible:
(3,55)
where the relationship	H = h + z	was taken into account.
Developing the subscripts i, j, k and omitting the now unne. cessary bar rotation, the three equations of the mathematical model are:
Momentum equations
cu,
— + u,
Ct
CUi
-----F
ex.
«! =
(3,56-1)
CUt
CX j
cz
dxY
1 h
cu,
ct
cz
CX-,
(3.56-2)
Continuity equation
■7“ + v— +	(/1U7)"O
Ct C.X'j	cx2
(3.56-3)
These equations are usually known as the Shallow yater Equa-tions.
3.4.3.3	- Initial and boundary conditions
The shallow water eq.uations_f._ab.ove^derlv.edf_are -of- -the hyper
bo.l i c .type and s_o,^As^djqm,ain_i s^pen in^the^time_dtmenslon,„_,Xo
findasolution at a given inst an t. it is necessary to know.....the va
Lu e s_ of the dep e nden t.jya r i able sat a p r e c e d i ng instant. These are
the initial conditions of the problem and, from the mathematical standpoint, no special problems exist for its introduction in the calculations, except that they must be known,
The problem of setting boundary conditions is more complex, A set of boundary conditions must be chosen in such a way that the problem is well-posed and correct values must be assigned to the chosen boundary conditions. This is not an easy task as it can be seen in what follows.
In an estuary-like domain, there are two types of boundaries, (see
figure):
-	Solid boundariess
-	Open boundaries
Since-~onlv_f ixed domains are consi de red. so1i d bo undaries co rrespond to the banksand „ to t h e. s ho r e 1 ine
and so_they„are natural .AoundaxiiAS,
of the domain.
Open boundaries are arbitrarily located for closing the spa tlal domain so that the problem can be solved. Thus they are art¿ ficial boundaries which must not pertúrbate the natural flow pattern or, in other words, the solution must be independent of their location.
After chosing the location of the open boundaries, the problem consists in determining a set of boundary conditions and their numerical values such that:
a)	the problem Is well-posed, that is, a unique solution exists and depends continuously on initial and boundary conditions.
b)	boundary values in open boundaries agree with the natural flow.
Concerning the existence and uniqueness of the solution, on ly a few authors have made a formal approach to the problem.
In 1967, Daubert and Graffe, published a study on boundary conditions for the shallow water equations based on a geometric in terpretation of the theory of characteristics. That theory states
that the number of conditions to impose at a boundary point is the number of characteristic half-planes external to the space-time domain. The number of such half-planes depends on the Froude num ber and, in the case of a subcritical flow represented by the Sh. W.Eq., it is equal to one or two, depending on the flow direction at the boundary points. Tor a flow directed into the domain two conditions must be imposed. On the contrary, if the flow goes out ward, only one condition is necessary to obtain a unique solution. If non linear terms are dropped from the equations, only one condi tion is necessary along the boundary, independently of the flow di rection. However, the authors do not prove formally that with tho^ se conditions the problem is well-posed,
More recently, Oliger and Sundstrom (1975) studied the problem in a formal way and concluded that the Sh.W.Eq. problem is well-posed with the following boundary conditions:
Solid boundaries:
un = 0
Open inflow boundaries:
H = H	and d = 5
n n
or
- u„ and u. = u,
n n	t t
Open outflow boundaries:
H - H	or u^ = H
n n
where the overbar denotes prescribed values of normal velocity (uQ), tangential velocity (u^) and water level (H),
the problem of assigning correct values to the cho sen open boundary conditions, the following cases may be considered: • Opsn boundaries not influenced by tides
This is the case when the open boundary is located at a river section upstream of the tidal propagation limit. It is an inflow boundary and so water level or tangential velocity must be presort bed jointly with normal velocity. In general a section of the river is chosen such that a relationship between flow discharge and water levels exists. Water level can be considered constant along the boundary and normal velocity values can be derived from flow discharges.
- Open boundaries influenced by tides
At the line chosen as open boundary, the values of dependent variables depend on the flow pattern inside and outside the domain. Since these flows are unknown, there is no way to prescribe values to the variables directly, based on physical reasons. Thus the si. mulation of a given flow requires that field measurements of velocities and levels exist along the boundary. In general this is not; the case and even if they exist such values cannot be applied for prediction purposes, since the alterations in the inside domain flow pattern influence the boundary flow.
After these remarks, one may ask how it was possible to run estuary models during the last twenty years, Xn^the^llterature»^ ne can see that for the most part, o f ^models nnly ,the ^wate r levels are^prescribed .as,,open boundary conditions. ,Concerningthe well-p_o_sedness of the problem, this is a sufficient condition during outflow periodstbut, during inflow, it does,not guarantee a unique solution. However, as stated by Daubert and Graffe (1967) and by Praagman (1979) for the linear shallow water equations, (no con vective terms, no friction and linearized continuity equation), the prescription of water levels along open boundaries during the whole tidal cycle is a sufficient condition to get a unique solution. Thus...... if near the boundary ,non.linear lati.ve. to other terms. it can be expected that linear and nonlinear systems shall have similar	Hoil such a situation to be
realist in, ~ i t - i s. ^nene.sjsary_tolneatestheopenboundaryin.d eep w.a.. JLeji^ojie a,.^^	the domain., of ^i n te re s t ... _Qne.._argument
mre_in_favo,ur.ot.usingonly..o.nebo.undaryconditionduringinf low is that an ext ra boundary condition has only 1ocal influenee ( Praa gman (1979)). Thus_JXJ.he_b.oundaryis..notnearthe domainofin t e re s t. no influence of the "wro ng w bo undary co nd i t ion shal1 reach
The above solution which allows for running a model without great mathematical apprehension has, however, some practical disadvantages. In fact, the solution domain must be larger than the domain of interest and, consequently,more data must be prepared
and more running time is necessary» Also in most cases there are no ,water level data along the boundary but only at one end of it. If, at each time step, the same level value is prescribed at all points in the boundary, it will always be a cotidal line with the same tidal range along it. One may introduce some phase shift and tidal range variation along the boundary, but, since there are not any related data, their values must be found by calibration jointly with roughness parameters.
Since the beginning of the last decade, some researchers have worked in the problem of boundary conditions for the shallow water equations. Solutions have been developed which make the problem well-posed from a formal standpoint. However the impossibility of assigning the correct values to the boundary flow variables, leads to the necessity of investigating new types of boundary conditions.
One direction in those Investigations goes towards the sepa ration of the inside and outside influence of the domain on the boundary flow. This corresponds to considering that the tidal wave at the boundary is the sum of two waves, one propagating inward the domain and the other outwards. A condition must be imposed at the boundary, such that the outgoing wave is not reflected there. Thus it is only necessary to know the values of the undisturbed in going wave, which are closer to the hypothesis of equal range along the boundary.
3.4.4	- Derivation of the discretized model
3.4.4.1	- Introduction
The direct integration of the shallow water equations is on ly possible when they are In a very simplified form and for very simple geometries of the domain. However the integration is possi^ ble for the equations in the above derived form and for complicated domains, through the use of numerical methods. The use of these methods for actual estuary studies became possible with the advent of large capacity computers.
The discretized model which is derived in the following sec
LNEC - Proc. 64/13/5314
tion is the result of the application to the shallow water equations of the finite element method in the space domain and of the finite difference method in the time domain. By its nature the discretized model is an approximation to the primitive mathematical model, that is, its solution is an approximation to the true solu tion of the differential shallow water equations,
3.4,4.2	- The choice of the numerical method
Three numerical methods have been used for integrating the shallow water equations. They are the method of characteristics, the finite difference method (FDM) and the finite element method (FEM). The method of characteristics was already used before the digitals computer era for studying the propagation of tides in o^e dimension (see, e.g., Dronkers and Schonfeld, 1955), It has seme interesting features, such as its suggestive geometric interpre^ tation of the propagation phenomena. However its use decreased with the growth of computational capacity which made it possible to solve more complete models in a easier way.
Since the sixties the FDM has been widely used for solving the shallow water equations and more or less sophisticated computa tional systems based on finite difference models exist, everywhere. During the seventies the FEM which was born in the structural engi.' neering field was applied to hydraulic problems. During the last six years a lot of finite element models appeared and nowadays they coexist with FD models. It is not suprising that, during the latest years, the comparison of both methods has been a matter for analysis among those who work in the field of mathematical modelling in hydraulics.
For the computational system developed in this work, the FEM was chosen to derive a discretized model of the flow. It has some advantages and some disadvantages relative to FDM, which are analysed in what follows after a very short description of both m_e thods.
In the FDM the differential equations are discretized and
solved in a rectangular grid of points which covers the domain. The technique used for the discretization of the equations and for solving them may be more or less sophisticated. For the more simple models the grid size is uniform, butfdepending on the sophistication of the model,variable grids may be used.
In the FEM the domain is discretized in subdomains (finite elements). Within each element the variables of the problem are approximated by the interpolation of their values at a chosen set of points (nodes) in the element. The approximated values of the variables are substituted into the differential equations giving rise to an error (residual). When applying weighted residual methods, that residual is multiplied within the element by some weji ghting function and the integral of the weighted residual over the element is made zero. In this case the Galerkin weighted residual method is used, that is, the weighting functions are the same as those used for interpolation of the variables. The result is an algebraic system of equations whose unknowns are the values of the variables at the nodes of the element.
Performing the same operations for all the elements and sum ming for each node the respective equations obtained from each s-lement which contain that node, results in an algebraic system of equations whose unknowns are the problem variables at all nodes in the domain. Applying boundary conditions and solving the system the solution of the problem is obtained.
For a comparison of FDM and FEM one must keep in mind that the solutions obtained with each one are approximate solutions to the primitive differential equations, and that, theoretically, tho^ se solutions may be so close to the true solution as one wishes by reducing the grid size (FDM), or the elements size (FEM), Thus with both models the same degree of accuracy may be obtained, and so, when making a comparison of them, it must be based on the advantages and disadvantages of using one or the other to get solutions with the same degree of quality.
Obviously a quantitative comparison is only possible for two given computational systems. However there are some aspects for which a comparison may be made in a qualitative way and which are Important for the choice of the method to be used. They are:
a)	Domain discretiaation
The domain must be discretized in such a way that a good dea cription of its geometry, of the bottom and of the phenomena is a-chieved. For that purpose the degree of discretization may be ve ry different for different areas of the estuary. The FEM is natu rally suited for that purpose, while FDM, even using variable grid size, has limitations to fulfill it. Thus from this standpoint the FEM has advantages relative to the FDM,
b)	Computer utilization
When using the FEM large banded system of equations must be solved. This implies the use of large capacity computers and a large use of computer time. FDM models have more limited computa tional needs and so they may be run in smaller computers using less time than FEM models. Thus concerning this point FDM models are advantageous.
The choice of the FEM was based on the advantages pointed out in a). In fact estuaries are in general very irregular domains and the use of a discretization technique which permits a good adaj) tation to the geometry and makes local alterations easy seems be.t ter suited for the problem one wants to solve.
The problems of computer utilization were not disregarded. However, in addition to what is said in b) some factors may render smaller or less important the advantages of the FDM over the FEM. In fact, the cost of the computer use in an estuary study is a small percentage of the total cost, and so in most cases it is not a limitation on the study. Besides, the advances in software and hardware suited for the manipulation of large matrices may greatly reduce the problems of using the FEM for simulating the hydrodyna mics of estuaries,
3.4.4,3	- Linearization of the differential equations
In the shallow water equations some non linear terms appear. Their solution in that form is possible with the use of iterative procedures. However this technique is very costly because it uses a lot of computer time, A more usual solution is to linearize the equations. This can be done by replacing some of the variables in the non linear terms by their values computed at the preceding time step. Denoting the linearized variables with a zero super-
script, the shallow water equations become:
dh d
— + 7— Ct OXj
w©=°
(3.58)
3.4.4.4	- Discretization in space
The discretization in space is obtained by replacing the va riables with their approximate value over an element, after which the resulting residual error is weighted and the integral of the weighted residual over the element is made zero. Here the Galerkin weighted residual method is used and so the weighting functions are the shape functions of the element.
Over an element the variables are approximated by
Ui-Nk uik
h-Nkhk	(3.59)
zk
where Nk is the shape function of node k and subscript k in the variables uf, h and z means their values at node k.
Substituting (3.59) in the equations (3.57) and (3.58), wei^ ghting the resulting residual and integrating over an element, yields
1
P dX; CX;
Ns dAe~
(3.60)
Ns dAe

I	*	C Af	L Aj
1
over
equations R° is the term relative computed from the mean values over at the preceding time step. Ji° dpa ‘
The values of y, p, pa, % —
ex,-
to the bottom ef the element of the mean value ©f h°
over
In these feet which is its variables
the element.
the element.
Reordering equations (3.60) and (3.61),
is are kept constant
they may be written

A, L dt
cN
(3.62)
4r _
Making now
‘ p cx&amp;lt;ex, ‘ 3't+ sTiQ‘ P° •
dN
GXi
dA‘
(3.63)
Hks- NkNsdAe J
r cNk
^N‘dA‘
^N„N,dA‘-
A' °Xi
(3.64)
I2iks =
I3ikms~
n^+t^s
and subtituting in the preceding equations yields
C + n*s *°) uik" /1J -1 )3 ■ 7 «3 - itk + I2*s g hk =
= "Z0S 7	^ + 7°S y2 Pa Wi
P	“0
I l*s ~~ + (13¡kms h° + I3imks /i°) uik = 0
(3.66)
or in matrix
form
g zk+wsp r Pa w? "
9	+	Pa W2
~flhs
I3jkms u?m+IlksR0
(f 32fcms-F 732mfcs) /i°
(3.67)
Denoting the the right hand
and
that the following
comes
first and second square matrix by
side matrix by FJ where the overscript e means relationship is valid for an element, (3.67) be^
Aeks and B'kt
cc/r
(3.68)
or, in a more condensed form
cUe
Ae-^ + Be Ue = Fc
ci
where U' is the vector of unknowns, for an element.
3.4.4.5	- Discretization in time
For the time integration of differential equations in a timespace domain it is advantageous to use the finite difference method , as a consequence of the ^geometric” simplicity of the time domain.
The technique used for time integration is based on the appli. cation of a two level FD scheme, that is, a scheme where the values of the unknowns appear at two consecutive time levels. This yields a recurrence relationship in which the known values of the variables at a given instant t appear as initial conditions, and the values of the variables at a later instant t + At are the unknowns. These values are the new initial conditions for the next calculation, and so on.
Applying this to the matrix equation (3.69), gives the following recurrence relationship (see Zienckiewioz, 1977),
(3.70)
where 6 is a real number between 0 and 1.
1
In this model the value 0 = -g was choosen. This yields an implicit scheme of central differences in time known as Crank-Nicholson scheme or trapezoidal rule, and the preceding equation b£ comes
(3.71)

c I + At

or, condensing,
3,4,4.6	- The discretized model
For the whole domain the element matrices are assembled in a global matrix. This is achieved by changing the indexes of the element matrix coefficients, which are related to the local node numbering, to their corresponding values in the global node numbering, and by collocation of those coefficients in the global ma trix position relative to their new indexes. Each global matrix coefficient is the sum of all the element matrix coefficients wh£ se global indexes correspond to the former coefficient.
The final system of linear algebraic equations will then be
1
(3.73)
where n is the number of elements and the matrix indexes were chan ged to their global value.
The introduction of boundary conditions in this system and its solution yields the values of the dependent variables and so the solution of the problem.
CHAPTER 4
DEVELOPMENT OF THE COMPUTATIONAL SYSTEM
4.1	- INTRODUCTION
In this chapter a description is made of the computational system developed for the simulation of the estuarine hydrodynamics, which was named "HYDRA 7". According to the concept of computational system presented in chapter 1,"HYDRA 7" is the set of alg£ rlthms and computer programs developed to solve the equations of the mathematical model used to describe the estuary hydrodynamics, comprising processing programs for data and results. The algorithms and corresponding computer programs were purposely developed ft
for this system
The computer language first used was SIMULA, introduced in LNEC after the instalation of the present computer facilities^ It was chosen as a consequence of its similarity and advantages re lative to ALGOL which was traditionally used in LNEC wit: the pre, vious computer facilities.
However, SIMULA is not efficient in dealing with numerical arrays and the algorithms to solve the present problem are mainly composed of operations involving those arrays, which are repeated each time step. Typically one can have more than 250 grid points, each one has 3 associated variables (water depth and two velocity components). For the simulation of a semidiurnal tidal cycle with a time step of 30 miir it is necessary to solve 25 times a non sym metric system of more than 750 equations, with a band size of about 150. This is sufficient to justify the use of a fast solver lanr
(1)	. Exception is made for some subroutines which were adapted
from existing ones in another Department of LNEC.
(2)	. DEC - System 10
guage. In order to avoid a complete rewriting of the programs, the solution chosen was the replacement of all numeric manipulation SIMULA procedures by FORTRAN subroutines.. This has not special drawbacks for running the main SIMULA program, and the main goal was achieved. Another subject which is considered in this chapter concerns the quality of the simulation results. The credibility of the computational system depends on iFhat quality and thus an analysis of the several aspects' which may affect it seems important.
4.2	- CONCEPTION OF THE COMPUTATIONAL SYSTEM
In the conception of the computational system some aspects which affect its usefulness were taken into consideration. As a principle, a system must supply credible and usable results starting from a minimum of data, spending a minimum of man and eoapu* ter time. This goal must be achieved in a short time, compatible with the studying project needs. Also, as it was said before, its structure must allow for easy alterations such that efficiency can be improved and that different or more complicated models can be used for simulation.
In the following analysis of the factors affecting the usefulness of the computational system, some considerations are made which are quite obvious. Nevertheless, they are important and so they are here included,
a)	Structure of computer programs
The global design of the programs structure must be such that alterations made at a given point of one program do not have repercussions on the remaining parts of the system or, at least, that any repercussions are minimized and may be easily controled. This implies that the system be composed of independent or almost independent modules. In that way alterations of programs or the replacement of modules is easily made.
b)	Efficiency of computer programs
The number and type of operations which must be performed
during th® eoniputations of a tidal cycle justifies the need for a great care during the programs development. This is specially true in what concerns the modules used for the solution of the systems of equations which must be based on efficient algorithms.
0) Data preparation
The data which must be prepared for running the system may be classified in two main classes. One of them consists in what may be called fixed data which is mainly related to the geometry of the estuary and its discretization. It represents a great volume of numerical values corresponding to node coordinates and bottom depths, to the nodal connecting table and to the boundary definition. Almost all their preparation can be done automatical, ly. However, for estuaries, the choice of the location of the no. des must be carefully made in such a way that the bottom, the boun dairies and the phenomena can be well represented with a minimum of nodes and elements. Thus the mesh definition must be made by hand and so does the nodal connecting table. The subsequent processing of the fixed data may be done in an automatic or semi automatic way.
The remaining data may change from run to run and consists mainly in boundary conditions values, calibrating data and data u sed for comparison of the results. Its volume is much smaller than for the fixed data and its preparation has no special problems.
d)	Data correction and alteration
Th-"- correction and alteration of fixed data, (e.g. the boun dary geometry), must be a simple operation. Suitable programs must be available for that purpose* ’1
e)	Presentation of results
The primary solution of the simulation is a big array of num bers which is useless in that form. The system must supply -roce_s_ sed outputs which must have an easy and ready interpretation, f ) C e dlb i 111y o f the re s ul t s
This aspect is analysed in section 4.5.
(1). An interactive graphic program for making alterations on a ri. nite element mesh and on related data was recently developed in LNEC (Cunha, 1981).
LNEC - Proc. 64/13/5314
4.3	- DESCRIPTION OF THE COMPUTATIONAL SYSTEM
4.3.1	- Introduction
From the computational point of vue the results of the simu Tation are given by the solution of a linear algebraic system of equations, which in matrix form may be written
A (X@) . X = F (Xo)
where a(X0) is the coefficient matrix,F(Z0). Is the vector of the in dependent terms, X is the vector of the unknowns and represents the initial conditions. This system is a numerical analog of the differential equations plus initial and boundary conditions.
The coefficients of the matrices A and F are obtained through the discretization of the domain and boundary conditions and the a£ plication of finite element and finite difference algorithms to the differential equations, taking into account the initial values of the unknowns. Since a step by step calculation in time is used, those initial values are the solution of the previous time-step or are prescribed in some way for starting the run.
Very schematically, the computational system acts in three independent stages.
ANO PRO PF ££		SOLVE THE	' PROCESS
		p	PROBLEM	—	RESULTS
data				
At the first stage the data which will serve as input for the second stage is prepared and processed. The main module of the system simulates numerically the flow and outputs unprocessed results to a disk file. During the last stage these results are processed in several possible ways.
In the following sectrLons details of each stage are presented.
4*3*2 - Data preparation and processing
The following data must he prepared as input for the main module of the computational system:
a)	Domain, discretization data.
After the discretization of the domain and the numbering of nodes and elements, the nodal connection table is built and the no. de coordinates are stored in a file together with the respective bottom level extracted from survey charts*
b)	Boundary definition, data
The node numbers of each solid or open boundary are stored. Each node set is a ZONE which has assigned the type of boundary condition that will be prescribed.
The orientation of the exterior normal to boundary nodes is computed and stored*
c)	Integrals
The walues of the integrals used for computing the coefficients of the matrices, which are only dependent on the geometry of the elements are calculated by numeric integration and stored.
d)	Initial conditions.
If the initial conditions are known, they are stored in a disk file*
The values which will be prescribed at each open boundary are stored.
f)	Control data
The values prescribed to computation control parameters such as number of nodes, number of elements, time-step interval, number of zones, starting mode 5 etc. are stored in a file.
Obviously all the data must be cheeked. This is made mainly through the graphical display of the data (mesh layout, bottom topography, boundaries layout, boundaries conditions). Some small programs were developed for data correction.
4*3.3 - The, main module of the computational system
The structure of the program is composed of three sain blocks:
Block A makes the input of the data prepared as it was described in 40*3.2,
Block B prepares .so&gt;e&gt; parameters which will be used during the execution of taock 0. These parameters are related to the par titioning of the global matrix (partition bandwidth, initial and final. nodes and elements, etc,). Blocks A and B do not deserve a ny special explanation.
Block C is more complicated. Its structure is described schematically in the following general flowchart.
GENERAL STRUCTURE OF THE BLOCK C OF THE HAIN MODULE OF THE COMPUTATIONAL SYSTEM
C1	MAKES A &amp;amp; F COEFFICIENTS ZERO
C2	PRESCRIBE INITIAL CONDITIONS FOR THE FIRST TIME-STEP.
C3	COMPUTE ELEMENT MATRICES AND ASSEMBLE THEM TO FORM THE THE GLOBAL SYSTEM AX=F. INTRODUCE BOUNDARY CONDITIONS. SOLVE THE SYSTEM.
C4	PROCESSED RESULTS FOR LPT. DIRECT OUTPUT TO DSK FOR POSTPROCESSING.
C5	SOLUTION VALUES ARE ATRIBUTED TO INITIAL VALUES ARRAY.
II - CURRENT CYCLECCYCLIC
BOUNDARY CONDITIONS)
IT - CURRENT TIME-STEP
NT - NUMBER OF TIME-STEPS PER CYCLE
NCYCLES - NUMBER Or CYCLES
Xn the submodule Cl the initial conditions of the problem ar® prescribed if the current time-step 'is the first. A control parameters indicates if there are known initial conditions. If so they are read from a disk file. If not the cold start is used (see
4.3.5),
The submodule C3 may be considered as the nucleus of the pro. gram. The global matrix A is, in general, too large for beeing contained as a whole in the core memory of the computer and so an algorithm which solves the system AX - F using partitions of it is used. During each time step the following steps are performed for each partitions
a)	From the first until the last element which have nodes belonging to the partition, the matrix elements are computed and assembled into the global matrix A. The Chezy coefficients are calculated using Bazin formula.
b)	The boundary conditions affecting nodes of the current partition are introduced in the matrix.
c)	The current partition of the system AX = F is condensed using G-rauss ’ method .
d)	The condensed partition is kept in a disk file.
After steps a) to d) are performed,the backsubstitution be gins. It is made for each condensed partition which is read from disk starting from the last until the first. The solution is kept in a now unnecessary zone of matrix A.
In the submoduTe C4 the output of the solution is made in two different ways. A line printer file is built with some ca -racteristics of the simulation and with a processed solution for all nodes at chosen'time steps . Thn solution is also outputed to a binary direct access disk file which will be used by the pro cessing programs of the results.
4.3.4	- Processing the results
The final solution of the simulation is a large array of num
bers stored in disk file. That array contains, for all time -steps, the solution for each node (2 velocity components and water level), and must be processed in such a manner, that a correct in terpretation of the results becomes possible * This can be done through the several ways represented in the following scheme of the results processing module.
RANDOM ACCESS BINARY FILE
CREATES LINEPRINTER AND/OR DATA
FILES FOR GRAPHIC PROCESSING
SOLUTION FOR EACH NODE
OF A GIVEN SET.
SOLUTION FOR A GIVEN SET OF
NODES AT GIVEN INSTANTS.
BINARY FILES WITH THE SOLUTION
AT GIVEN INSTANTS OR AT
GIVEN NODES.
CREATES PLOT FILES FOR GRAPHIC
DISPLAY OF THE SOLUTION OR
TO CHECK INPUT DATA FOR
THE MAIN MODULE OF THE SYSTEM.
Um : V(T) ; HCT)
SURFACE LEVEL PROFILES.
BOTTOM PROFILES.
:	VELOCITY OR DISCHARGE FIELD.
j	HATER SURFACE LEVEL ISOLINES.
| FINITE ELEMENT MESH.
| BATHYMETRY
4.3.5	- Starting the simulation
For starting the simulation it is necessary to initiate th® array of initial conditions. As it was said before this may he do ne in two different ways corresponding to the existence or not of known initial values. If they ^xist they are read from a disk le and if they do not exist the cold start is used.
In case the cold start* is used the main program of the system must run a certain number of time steps to reach a state which in independent of the prescribed initial conditions. In the case of cyclic boundary conditions this happens when the solution for a given instant of a cycle is reasonably close to the solution for the correspondent instant in the preceding cycle. The number of time-steps that .the program must run before the solution is usa hie, depends on the mass of water inside th® estuary, on its geome try, on the time-step dimension and on the initial level chosen. The closer the initial conditions are to an admissible flow in the estuary, the smaller is the number of starting timo-steps.
The use of a solution chosen from a previous run as initial conditions may save a lot of computing time, since it represents a flow compatible with the geometry of the estuary.
4.4	- GENERAL REMARKS ABOUT THE COMPUTATIONAL SYSTEM AND ITS USE^
A computational system whose goal is the simulation or the prediction of the hydrodynamic behaviour of an estuary, is not an easy-to-run package of computer programs. The user must know the behaviour of th® system which depends on a lot of factors that in fluence the quality of the results. For that knowledge the diffjs rent stages of the development of the system must be considered.
The first stage consists of the derivation of a mathematical model which, under some hypothesis, pretends to describe the flow in an estuary. After that, the model is simplified (some terms are dropped, equations are vertically integrated, etc,).
(1), A schematic representation of the contents of this section is presented at its end.
At the second stage a method of numerical analysis is used to transform the differential equations of the mathematical model in a set of algebraic equations. This one is a new mathematical model which is an approximation of the former, and which solution must be found ir. a discretized domain, that is, in a schematiza-tion of the natural estv.ary.
The third stage corresponds to the elaboration of the compu ter programs. Th® main part of it is used to calculate the coeffi^ dents and independent terms of the equations, to introduce boun dary conditions and to solve the system of equations.
The learning of the behaviour of the system may be considered as the last stage before its use for actual estuary studies.
Basically, for understanding the behaviour of the system one needs:
a)	to know how well the mathematical model represents the flow;
b)	to know the behaviour of the solution of the discretized mo-
del relative to the solution of the continuous model as a tunc tion of the space-time discretization of the domain, of the boun dary conditions used and of other computational parameters.
What is said in a) represents the obvious necessity of knowing the physics of the phenomenon which is simulated.
To achieve the goal indicated inh)?two complernentar ways a re possible. One is related to the theoretical analysis of the solution error when the differential equations are solved through some numerical method; That analysis is complicated and is only possible with regular mesh geometries for the solution of simplified forms of the differential equations in zones not Influenced by boundaries.
The other:one follows an empirical methodology. It consists of making tests with simple geometry estuaries, (e.g,, a rectangular channel with horizontal bottom), for which it is possible to have analytical solutions of a simplified mathematical model. The com parison '-f th© analytical and numerical solutions may be made for different eases of space-time discretization and boundary conditions, providing useful information about the behaviour of the system, in spite of the fact that the sample solution is obtained from a sim
LNEC - Proc. 64/13/5314
■¡t I
plified model. After that some tests may be made with slightly complicated geometries to learn the behaviour of the solution for different particullar cases of the flow (curves, enlargements and narrowings, etc.). The simulation of a known flow in an actual es tuary is the last stage of the system working verification. This methodology was chosen in the present case.
The use of the system for actual estuary studies has three main stages. The first one is the calibration which is the'adjust ment of the physical parameters (calibrating data) in such a way that the solution fits a sample data set which corresponds to a known flow in the estuary and from where the boundary conditions for the simulation are extracted. The next stage IS the verifica tion, during which the simulation of another known natural flow is made with the physical parameters calibrated at the first stage. The comparison of the results and known values provides an estima te of the quality of the results th^t will be obtained during the next stage. The last stage is the prediction of the flow pattern under conditions for which there 'are not known natural data. Such is the case of geometry alterations, modifications in upland discharges, etc.
Actually, not all the studies have these three stages. For example, if one wants to know the flow field for a water quality study, the simulation of a known flow may be sufficient to provide the necessary data. In many eases there are not sufficient data for making a complete calibration and verification and thus it is not possible to have a reliable estimation basis for the quality of the prediction results. Anyway, if carefully used, the system may provide useful information for thor. who must make decisions about estuary projects.
4.5	- REMARKS ON THE QUALITY OF THE RESULTS OF THE SYSTEM
4.5.1	- Accuracy and credibility
The credibility of a computational system is an important problem which must be considered. In fact the users o." the system want to solve estuarine hydrodynamics problems by means of a tool which they trust.
This is mainly related to the quality of the simulation results and has soma aspects which deserve s^me analysis.
One of those aspects is concerned with the possibility of checking th® results against known data. -'In some cases this is pos. sible and a good calibration and verification of the model may be rade. In this case the quality of the results is upperlimited by the -~’'ality of checking data but one may have a basis for evaluating the reliability of th® results. In other cases there is no sufficient checking data or it has not the necessary quality, So# although the results may have "good appearance”, the only way of making an evaluation of the results quality is by "feeli&amp;amp;g". How ever changing some factors , (e,g. t^.e element size)* different re. suits with the same "good appearance” may appear for another run. Thus, admitting that th© computational system may give accurate re suits, it is essential to use it in such a vray that those results are reached. For that purpose, it is obviously necessary to know the behaviour of the computations?; system as a function of the factors which may affect the accuracy of the solution, A qualita tive analysis of those factors is made in the following sections.
Another aspect is related to what can be considered as an £ perational computational system for simulating tho flow in estuaries, The abimdant literature about numerical simulation of that phenomena makes possible for anyone who has some basic preparation and who has access to computer facilities, to build a computational system, with little mere work beyond	copying of published pro
grams. Very soon one can have results "rut in general one concludes that a lot of work must be done before those results may be considered of good quality. Even the use of already operating systems by someone who c^.id not fellow its development stages :1s a difficult task which costs in general a lot of time and work. One may con-
LNEC - Proc, 64/13/53X4
elude that there Is a significant difference between an operational system and its software9 That diffn.-one® consists in the knowledge of th® behaviour of th® system, which permits to reach accurate re suits and so that the system becomes a credrlbl® tool for solving estuarine problems.
4.5.2	- Resolution of the discretization
The resolution of the discretization is related to the desorip tion of the characteristics of the domain of th® boundary conditions and of the phenomena which are simulated. That description must be accurate enough in space and time and its accuracy is rela ted to the finite element mesh design and to the time step usee*
a)	Reso.lut.io.n_. in space
The mesh configuration must describe accurately the geometry of the estuary (bottom and hanks) and the flow. Thus the element size must be smaller where the geometry is more irregular and where the characteristics of th® flow are more variable. The discretiza tion with finite elements is a powerful tool for achieving that pur pose. However there are limitations to the refinement	mesh.
They arise from computer memory requirements, from running costs and from computer operation conditions.
h)	Resolution in time
In estuaries the time variation of th® tidal flow parameters is represented by a curve which i:\ the simplest ease is almost sinusoidal. Thus, for achieving a good description of that variation, the minimum number of points stays between 12 and 15. This corresponds to a time-step between 50 and GO minutes for a semi-diurnal tide. However there are estuaries where the curves describing’the variations of the phenomena, in spite ^f having the same period as the tide, are not sinusoidal. In these cases a smaller time-step is needed. Its duration depends on -;he irregularity of the mentio ned curves, but a minimum of 10 to 15 minut’W will in general be a satisfactory time interval to describe ther accurately. As it was said concerning the resolution in space there are limitations to the time-step duration since the running time and cost is pro por^fonal to the nnmhRr of time-steps per run. Limitations may also arise from computer operation conditions.
4.5,3	- Consistency* stability and convergence
The method .here used for solving the shallow water equations is 3°	.“IMM	jin space.an« finite.diffe-
rences in time. When the F.TM is applied to the equations, these become a^system of ordinary differential equations;(ODE) Jwith time derivatives which are to be solved by a FDM* The Crank-Nicholson method is used in this case and so the resultant finite difference equations are consistent with the ODE and .its solution is unconditionally stable and convergent. This means that the truncation error of the finite difference equation tends to zero with the time-step duration (consistency), that numerical perturbations in the solution are bounded (stability) and that the solution of the finite difference equation tends to the solution of the ODE when the time-step tends to zero, At this point,only the behaviour of the fin?.te difference scheme used for the discretization of the time domain was mentioned. The conclusion may be seen in the abundant liters, ture about the subjecte
The other problem concerns the convergence of the Galerkin method which wa? used fo.r joace discretization of the partial dif ferential equations■(PDE)It consists in knowing if the solution of the ODE tends for&gt;™theiX solution of the PDE when the size of the elements tends to zero* This problem was not analysed in this work, However one knows that for-the shalTcw water 'equations the solution using the Galerkin method is convergent and is the best approxima-tier in a minimum square sense1".
(1). MORTON, Ky(198O) - Introduction to the theme "Finite Element Method for Hyperbolic Equations” in the International Collo-o'/T.um on Finite Element Method in Non Linear Fluid Mechanics, organized by the Committee on the Use of Computers in Hydrau lies and Water Resources of the XAPTL Chatou, Frande, April 1980 (Unpublished)*
CHAPTER 5
VERIFICATION OF THE COMPUTATIONAL SYSTEM
5.1	- INTRODUCTION
Several tests were made to experiment the computational sys_ tem. In this chapter results for the following tests are presented:
-	Uniform flow in a rectangular channel.
-	Transient flow from rest to uniform in a rectangular channel (cold-start).
-	Non steady flow in a rectangular channel (standing wave),
-	Tidal propagation in the Tagus Estuary.
During the tests, some computational problems came to.light. These problems were related to the simultaneous use of triangular and rectangular elements and their origin was found only during the tests with the Tagus estuary (see section 5.3.5), After solving those problems there was net enough time for repeating all the tests for presentation in this work. Thus only a few of them were chosen.
5.2	- TESTS IN A RECTANGULAR CHANNEL
5.2.1	- The finite element mesh
For all the tests performed in a Rectangular channel the same finite element mesh was used. Only the dimension of the ele^ ments was different for steady and non steady flow tests. The mesh layout is shown in figure 5.1. It has 87 nodes and 22 elements (4 triangles and 18 rectangles). The sides of the elements
are aligned with x and y directions
E 8	13	,6	21	¿5	2?	32	37 *e 45	&lt;8 S3 56	41	6 5	49 Z277	92
4		12		28 19	23	2S		36		*4		52		48		68		76	
3	7	11	. ,s			27	JJ1	35	 39	43		£1	55	S9	43	67	./r‘		
2		18		15		26		34		42		58		ES		&amp;amp;&amp;amp;			^79
1	6	9	.4	17	22	2E	38	33	 38	41		49	54	£7	¿2	45	'/8	73	
87
96
85
95
83
Fig. 5.1
5,2.2	- Uniform flow in a rectangular channel
5.2.2.1	- General conditions of the tests
Several tests were made for the simulation of a uniform flow in a rectangular channel. The results were compared with those ob tained by Ch^zy formula. For the computation of the roughness coef ficient C the Bazin’s y parameter was used. The influence of the walls was not considered and so the hydraulic radius was taken e-qual to the depth.
The channel is 2 Km long and has a constant inclination of 0.00015. The finite element mesh is shown in figure 5.1. The si^ mulated flow has the following characteristics accordingly to Ch^zy law:
-	Depth H = 3 m
-	Chizy ooeff. C = 70.71 m1'2/s
-	Velocity V - 1,50 m/s (leftright)
The initial conditions used where of two types:
a)	Cold-start - Zero velocities at all nodes and horizontal water level were assumed.
At the ends of the channel water levels or normal velocities were prescribed as boundary conditions.
These tests were made as a simple first verification of the computational behaviour of the system and of the bottom resistance law used in the model. A verification for the lsehavdour of the mo del was also possible when using the cold-start conditions.
5.2.2.2	- Cold-start tests
All these tests were made with the following boundary conditions:
Left end - Constant depth equal to 3.00 meters
Right end - Depth varying linearly* from 3.30 to 3.00 meters during a certain number of time-steps. After that the depth is constant and equal to 3.00 meters.
The time-step (DT) and the number of time-steps used to reach the 3 meters depth (N) at the right end of the channel were the fol^ lowing for each test:
TEST	DT (sec)	N
CS1	50	15
CS2	200	4
CS3	200	2
CS4	400	2
For each test plots of velocities and level variations at 3 nodes are presented in figures 5.2 to 5.9. These nodes are at the two ends and at the middle of the channel. The results show that for all the conditions used to start the run, the simulated flow reaches the theoretical conditions given by Chizy formula. In e-very case the final state of the flow is found around the same si. mulated time (about 3200 sec ). This shows a certain independence
of the flow evolution from the time-step used,after the boundary conditions reach their steady characteristics. The fluctuations which can be seen in velocity and level curves depend obviously of the smothness of the boundary conditions. This is shown by com parison of the results of the tests CS2 and CS3 (figs. 5.4 to 5.7) where the same time-step was used, and also frop the comparison of tests CS3 and CS4 (figs. 5.6 to 5.9) with different time-step but with the samd number of time-steps to reach steady boundary conditions.
Lil
O
Proc. 64/13/5314
RECTANGULAR CHANNEL-UNIFORM ELOMCCOLD START)
DT-50 SEC 1-0.00015 NODES 3 43 85
LNEC - Proc* 64/13/5314
to
«-A
CJ Ld co
&gt;2 H
U
d
&gt;
DT=50 SEC 1=0.00615 NODES 3 43 85
DT=200 SEC 1=0.00615 NODES 3 43 85
«___v □CLEFT)
LNEC - Proc. 64/13/5314
LNEC - Procj 64/13/5314
-q
1 .SeitVSEC
DT=200 SEC
1-0.00015 NODES 3 43 85
LNEC - Proc. 64/13/5314
RECTANGULAR CHANNEL-UNIFORM FLOW(COLD START)
DT=200 SEC 1=0.00015 NODES 3 43 85
LNEC - Proc. 64/13/5314
DT-200 SEC
1.50 M/SEC
□(LEFT)
1=6.06015 NODES 3 43 85
&lt;J)
LNEC. Proc, 64/13/5314
LNEC - Proc. 64/13/5314

o -I

u LlI O) \ E
v-z &gt;-!—
DT—400 SEC 1-0.00015 NODES 3 43 95
FIG. 5.9
-4
00
5.2.2.3	- Tests with known initial conditions
Three tests were carried out starting from the same known i nitial conditions. All tests had a duration of 10 time-steps and the boundary conditions were kept constant. The time-step used was 400 sec. At each end of the channel only one boundary condition was prescribed (normal velocity or water level). The initial conditions correspond "to the theoretical values given by Chdzy’s formula, that is, for all nodes the depth was 3.00 m and the vejle city was 1.50 m/s.
The boundary conditions at the channel were the following ones:
TEST	B.C. LEFT
LL	LEVEL
W	NORMAL VEL.
LV	LEVEL
VL	NORMAL VEL.
left and right ends of the
B.C. RIGHT
LEVEL
NuHMAL VEL.
NORMAL VEL;
LEVEL
The results of the tests have shown almost constant values of the velocities and depths along the channel. The maximum deviation from the theoretical values were of the order of 10~4m
—4
for the depth and 10 m/s for the velocities. Since no significa tive plots can be made with the results, numerical values at nodes 3 (left ent), 43 (middle) and 85 (right end) are presented in Tables 5.2.1 to 5.2.4.
The results show a good behaviour of the computational sys«. tern for the very simple conditions of steady flow in a rectangular channel.
r
TABLE 5,2.1
nude:	3	RUN LL	DT- 400 8IE8		
INST	MEL XX	MEL YY	MEL. MOD	DEP TN	1, FOR) (DATUM)
1	1.50002	•■■■0.00000	1.50002	3.00000	3.30000
'•&gt;	1.50000	■•"0.00000	:i .50000	3.00000	3 %300 on
5	1,4 9998	-0.00000	:l&amp;lt;49998	3.00000	"&gt;. 31	■) O
4	1.50002	-■0.00000	1.50002	3.00000	3.30000
5	1.49995	-0.00000	1.49995	3.00000	3.300 0 0
•4	1.49998	"••0 . 00000	1.49998	3.00000	3.30000
7	1.50005	•■•■0.00000	1.50005	3.00000	3 . 3 0 0 0 0
8	1.49990	-‘•0.00000	1.49990	3.00000	3&amp;lt;3A0h0
9	1.49997	•••■0.00000	1 .4999?	3.00000	3.30000
:l o	1.50003	-■0.00000	1.50003	3.00000	3.30000
None	43	RUN I...L	DT-- 400 SEC
INST	MEL. XX	MEL YY	MEL MOD	DEPTH	I.FMFI (DATUM)
I	1.50000	0.00000	1.50000	3.00000	3.15000
o	1.49998	-0.00002	1.49998	3.00002	3.15009
	1.50001	-0.00001	1.50001	2.99997	3 • 14°97
■1	1.49992	0.00004	1.49992	3.00000	3.15^00
	1.50001	-0.00003	1.50001	3.00003	3.15003
6	1.49994,	-0.00002	1.49994	2.99996	3.14996
	1.49997	-0.00000	1.49997	33 00002	3:1500?
8	1.50002	-0.00001	1.50002	3.00000	3.15000
9	1.49992	-0.00001	1.49992	3.00001	3.15001
10	:l .50003	-0.00000	1.50003	2;80997	3.14997
NODE	85	RUN LL		DT- 400	SEC
INST	MEL XX	MEL YY	MEL MOD	DEPTH	LEMEL
					(DATUM)
1	1.49999	0.00000	1.49999	3.00000	3.00000
2	1.50000	0.00000	1.50000	3.00000	3.00000
3	1.49999	0.00000	1&amp;lt;49999	3.00000	3.00000
,4	1.49991	0.00000	1.49991	3.00000	3.00000
5	1.50003	0.00000	1.50003	3.00000	3.00000
z »../	1.49997	0.00000	1.49997	3.00000	■5 &amp;lt;0 8 0
7	1.49994	0.00000	1.49994	3.00000	3 ... (HbjOO
8	1.49999	0.00000	1.49999	3.00000	3.00000
9	1.50002	0.00000	1.50002	3.00000	3.00000
10	1.49993	0&lt;■00000	1.49993	3.00000	3.00000
TADLE 5.2,2
NODE	3	RUN VV	DT™ 400		SEC
INST	VEL XX	VEL YY	VEL MOD	DEPTH	LEVEL (DA7 UM&gt;
1	1.50000	■•••O * 00000	1.50000	2.99999	3.29999
	1.50000	’■■•0.00000	1.50000	2.99999	3.2i;'999
	1.50000	••■■0.00000	1.50000	2.99999	3.20998
4	1.50000	■•••0.00000	1.50000	2.99995	3.2900J
5	1.50000	- 0.00000	1.50000	2.99994	3.29996
ó	1.50000	-■ 0.00000	1.50000	2.99994	3 :■ 29994
7	1.50000	-•0.00000	1.50000	2.99995	3.29995
s	1.50000	•-0.00000	1.50000	2.99998	3.29988
C)	1.50000	■•••0.00000	1.50000	2.99993	3 - 99993
10	1.50000	••••0.00000	1.50000	2.99999	3.29990
NODE	43	RUN VV	DT™ 400		SEC
fNcr	VEL XX	VEL YY	VEL MOD	DEPTH	LEVEI, (DATUM)
1	1.50000	0.00000	1.50000	2.99999	3 1 4999
■;&gt;	1.49999	0.00003	1.49999	2.99993	3.1499?
3	1.50008	0.00000	1.50008	2.99996	3.1 499o
■7	1.50004	0.00002	1.50004	2.99995	3 14995
i;:-	1.49996	0.00000	1.49996	2.99994	3 ■ 1 4''!
6	1.50009	■••■0.00001	1.50O09	2 9 9994	3.1 4‘:;'0 1
”2	1.50002	O.OOOOl	1.50002	2.99991	3.1. 1 ■’ 91.
8	1.50003	0.00000	1.50003	299990	3.14990
9	1.49995	-•0.00002	1.49995	2.99990	3.14990
1 0	1.50012	0.00002	1.50012	2.99987	3.1.4987
NODE	85	PUN VV		DT:™ 400	SEC
1 NS r	VEL XX	VEL YY	VEL MOD	DEI"’Til	1, EV Fl
					(DATUM)
1	1.50000	0.00000	1.5O0OC)	2.99999	2 t99999
2	1.50000	0.00000	1.50000	2.99994	2 £. 99994
3	1.50000	0.00000	1.50000	2.99998	2.99998
4	1.5 0 0 0 0	0.00000	1.50000	2.99991	2.99991
5	1.50000	0.00000	1.50000	2.99998	2 f 9 9 9 9 3
9	1. .50000	0.00000	1.50000	2.99986	1:5 9986
7	1.50000	0.00000	1.50000	2.99994	2.99984
0	1.50000	0.00000	1.50000	2.99988	2.99988
9	1.50000	0.00000	1.50000	2.99987	2.99987
10	1.50000	0.00000	1.50000	2.99987	2t99987
LN3C - Proc. 64/13/5314
oo to
Hi o	X	■cc	X	o- en x				4X		2: en -i		i O í i “ l
~	*—i	Í-J.									•c	i
-i		-i	-&gt;	■&gt;	4.	-&gt;	■fr	■s.	*		pn	Ê
en	en	en	0»	en	en on		en	en	en			í
o	Qs	o	O	o	o	o	o	o	o			í S3
o	O	o	O	o	o	o	o	o	o		X	í en
o	O	o	o	o	o	o	o	o	o		X	i
o	■o	o	o	o	o	o	o	o	o			i i
o	o	o	o	o	o	o	o	o	■o		&lt;z :	i i i
-&gt;	*	■&gt;■	■»	■&gt;	*&gt;	«■	■&gt;■	•»			~ i	i
o	o	o	o	o	o	o	o	o	o		r~ i	i
o	o	o	o	o	o	o	o	o	o		i	i X
o	o	o	o	o	o	o	o	o	o		X	: X
o	O	o	o	o	o	o	o	o	o		X	í X
o	o	o	o	o	o	o	o	o	o		i 1 J	i ■	-. t	.-jh“
Hi	Hi	—■	H	h-	Hi	Hi	H-	j—i	Hi		&amp;lt;i	: ;’— ■ i
■&gt;	•&gt;	■í	■&gt;	-»	■&gt;		■»		■&gt;		rn i	i
en	en	en	en	en	en	en	en	en	en		r i	i
o	o	o	o	o	o	o	o	o	o			
o	o	o	o	-o	o	o	o	o	o		3í i	i
o	o	o	o	o	o	o	o	o	o		O í	!
o	C-	o	o	o	o	o	o	o	o		•z;	í
												: ;X
												
												
											i	: n
X	34	X	34	ÍX	e&gt;4	x	34	X	X		i	i
-:■		&lt;			&lt;*	*&gt;■	-&gt;	■:■	-&gt;		“Z: '	
X	o	'■&amp;amp;	z	X	o	■X	o	X	'X			. .e.
■'0	o	X	o	x	o	'X	o	'-O	X		~ !	i o
X	o	X	Q:	X	o	X	o	X	X		X i	o
■'0	o	'X	O	X	o	X	o	■X	X		X i	i
UJ.	CN	X	X	X	X	en	o	■Sí	X		i	; Í3
												: ~
											i !	■ n
X		X	34	X	04	x	34	X	X		i	¡ !
-»	&lt;-	■i-	-&gt;	&lt;■	-?	■;.	■&gt;	&lt;&gt;	*&gt;			
X	o	X	o	X	O	X	o	X	X		~ i	
X	C-	X	O		o	X	o	&lt;í	X	—í	■C i	
X	f2;:		£&gt;	&lt;•	o	■X	o	X	X		!	
x	o	-3	o	X	•Z&gt;	X	o	-3	•X	zr.		
:--		3	3-	X	X	en	■z	■-.j	•x	—■		
►	S-—■ :	o i í i í	*2’	■'X	3.		-_n 4i			X		-Z X -i		z C3 ‘O m
i				r-			1,		—u		&lt;	
		&lt;		O	■&gt;	&gt;	*&gt;	-&gt;	&lt;*			
i	X	X	en	-_n	en	■_n	en	en	en	en			
i	O	o	o	o	o	o	o	o	o	o			X
=	O	o	o	o	o	o	o	o	o	o		X	34
!	O	o	o	o	o	o	c=	o	o	o		X	
= Ê	?-3	rx	íX	X	“i	X	X	?x	s-i			
i	i i	O	O	i o	o	i o	o	o	o	o	o		&lt;	
i	❖		*	&lt;-	»&gt;	4’	*!►	•&gt;	*&gt;			
:	O	o	o	o	o	o	O	O	o	o		r~	
i	o	•o	o	o	o	o	o	o	o	o-			x-
i	O	o	o		o	o	o	o	o	o		X	
=	O	o	o	o	o	•O	o	o	o	o		“s	T1*
\	o	• 3	o	!X	o	o	o	o	o	o			
:												
Ê												&lt;
i	—		—				i-™		í—			■c	
í	*■	&lt;-	■*	:■		■&gt;	&gt;&gt;			-&gt;		X	
i	en	en	en	en	en	OH	en	en	en	:_n		—	
j	o	o	o	o	o	O	o	o	o	o			
i	o	o	o	o	o	■O	o	o	o	o		24	
o	O	o	o	o	o	o	o	o	o		C3	
i	*-=•	•V	iX	rx	X		X	X	S3			O	
i												í~í
												
í												H
												ií
			ÍX	re	ÍX	ÍX	í' 'j	,-J:	s3			
i		&gt;	&lt;-	-i-	&lt;				-			
=&amp;lt;=	-G	X	■X	X	X	X	•x	X	X			X
;&amp;lt;•	■X	X	X	■x	-¿i	■x	X	■x	X			O
;	s3	c	X	•X	X	X	■x	S3	-X	X		"i	o
i	X	X	•x	X	'X	X	'X	X	X	X		23	
i	-x	'X	X	•x	X	■x	■X	-3	■x	■x			33
i												X
												O
:	34		34		•34	34	34	X	34	;34			
\&amp;lt;-				■&gt;		'S	■&gt;		X		—	
		L—L		i-i				?-	;-“■	3&gt;		
X-				■ü.	-3		X	X	J2&gt;	—i		
&gt;r?		C:	-c	X		-3	3	¿i	'X	-Z		
	■3	••C	''-Z-		X	X	•v	X	3			
X	X	r.	J	X	X		■3		X	■■--		
-	22 i
o ■■■o :x sj ■&gt;- en x 34 x x í : —í	i	í
i Z i i O í i &amp;amp; i i " = i	í
=	i
*—í.	~			Hi	Hi	Hi	Hi	Hi	Hi	«f :	í
*	+	•&gt;	o	■&gt;	■»	1	•&gt;	•&gt;		m	í
en	en	en	en	en	en	en	en	en	en	~ ■	i
o	C:	o	o	o	o	o	o	o	c-		i
o	O	o	o	o	o	o	o	o	o	X	í 34
o	o	o	o	o	o	o	o	o	o	X ’	i
54	4s	4*	-3	4s	X-	-3	X	¡34	rX	i i	i í
i O	í O	i O	í O	i O	i o	i O	í o	i O	i O	= &amp;lt;:	í i í
■&gt;	•&gt;		*	*	«&gt;	■&gt;	■*	&lt;»	•&gt;	m i	i
o	O	o	o	O	o	O	o	o	o	“ í	i
o	o-	o	o	o	o	O	o	o	o		í X
o	o	o	o	o	o	o	C-	C:	o	X	= cz
o	o	o	o	o	o	o		-Os	o	-¿ :	: Z
o	o	o	o	o	o	■-Z	o	o	o	i	:
										i	i r~
										í	i&amp;lt;
Hi	i-i	i-i	Hi	Hi	Hi	~	Hi	Hi	Hi	í C í	: í
■&gt;	■&gt;	*	■v		.»	&lt;•	T		■&gt;	m í	
en	en	en	en	en	en	en	en	en	en	í~ í	
o	o	o	o	o	o	o	o	o	o	í	
í“5	o	o	o	o	■■z	o	c=	o	o	2í í	:
O	o	o	o	o	o	o	o	o	o	33 i	í
34	4s	-ü-	-b-	4s	X	X	x	34	X	ej i	í
										i	íe?
											
										í í	-i n
X	34	34	34	34	34	34	34	34	34	•	
	■&gt;		■:	■&gt;	3	■i		•&gt;	■&gt;	O í	
O	O	O	O	o	O	O	O	O	O	~ •	X
O	O	o	O	o	o	O	Õ	O	•■c?	~ i	o
o	o	o	o	o	o	o	o	o	o	~i í	o
o	o	o	■o	o	o	o	o	o	o	Z i	
o	X'	o	o	o	o	o	o	o	o	i	00
										i	rn
										! :	X
34	34	i.S	34	34	34	34	34	34		í	
&lt;-	--		.&gt;	&lt;-	■&gt;	-&gt;	■i	&gt;	&lt;■	ÍS ~ í	
	34		1:4	34	34	34	34	34	C:4	~ í	
o	X	o	■3		X;	O	9	O	O	■™Í C í	
;O‘	■Z	o	o	o	O	O	o	u		cz m í	
o	X:	C--	O	o	O		o				
Z’	Z-:	Z-	X	o	o		o	Z-r	o		
~
m
en
x
te
i
TADLE 5.2.4
NODE	3	RUN VI.	DT:	400 SEC	
T NOT	VEL XX	VEL. YY	VEL. MOD	DEPTE	L FUEL
					(DATUM)
1.	1 . 50000	-■0.00000	1&gt;50000	2.99922	3.2999'9
'7	1.50000	-0.00000	1.50000	3-00005	3.30005
3	1.50000	•0.00000	1.50000	3.00003	3&amp;lt;30003
4	1.50000	■•■■0.00000	1.50000	■	2.92998	3.29998
5	1.50000	—0.00000	1,50000	3.00004	3.30004
z	1.50000	-•0.00000	1.50000	2.99997	3 29'?q
■■;.’	1.50000	■■■■ 0.0 0 0 0 0	1.50000	3.00011	3 ■ 300'1 1
8	1.50000	■■••0.00000	1.50000	2.99993	3:29993
9	1.50000	-0. 00000	1.50000	3.00008	3.30008
1.0	1.50000	•■•■o.ooooo	1.50000	2.99999	3 &gt; 29999
NUDE	4 3	RUN VI...	DT™ 400 SEC		
T NS r	VEL XX	VEL YY	VEI... MOD	DEPTH	LF UFI ( DA 'Ll ir)
:l	1.50000	0.0 0 0 0 0	1.50000	2, 99999	3.1	99
3'	:l .50000	0, 00001	1.50000	3.00002	3&lt;1500"
3	1.49999	■•••0.00002	1 ,49999	3.00004	3.1 500 ■■■
4	1.50012	0.00004	1.50012	2.99998	3 14990
i:r j	1.42922	0.00002	1.49992	3.0 0 0 01	3 &gt; 1 500 J,
n	1.50007	0.00000	1 .50007	3.0000 :i	3:1 pon I
. 7	i *5ooo:i	0.00001	1.5000:1	3.OOOO1	3.1 509 -1
o	1.50003	0.00000	:l . 50003	3 &gt;00001	3:150V1
&lt;?	J.50000	0.00000	1.50000	3.00001	3.15001
1 0	I.49999	0.00001	1&amp;lt;4 9999	2.99999	3.14999
NODE	85	RUN VL	D79::	400 SEC		
INST	VEI... XX	VEL YY	VEL MUD	DEPTH	LEVEL (DATUM)
1	1.42999	0.00000	1.49999	3.00000	3. 00-^on
	1.49997	0.00000	1.49997	3.00000	3O‘”)OOO
3	1.50003	0.00000	1.50006	3.00000	3 ,0000 0
4	1.50005	0.00000	1.50005	3.00000	3.0000(1
5	1.49996	0.00000	1 .49996	3.00000	3.00000
6	1.49999	0.00000	1.49999	3^00000	3.0 00 0 &amp;lt;i
	1.5000S	0.00000	1.50008	3 '• 0 0 0 0 0	7 ... AiJi.rOi,"
8	1.49998	0 &amp;lt;0 0 0 0 0	1.49998	3 - 00000	3 v (’i(ioo&gt; j
9	1.50006	0.00000	1&amp;lt;-50006	3.00000	3	Hi•' 0 &amp;lt;■}&lt;■•&gt;
1 0	1.49999	0.00000	1.49999	3.00000	3 &gt;	';0)
5.2.3	- Non steady flow in a rectangular channel
5.2.3.1	- Introduction
In this section the simulation of the propagation of a stan ding wave 1b a rectangular channel with horizontal bottom and clo sed at one end is presented a3 a test of the computational system with non steady flow conditions. The finite element mesh used was the same used for uniform flow tests (see fig. 5.1). The channel is closed at its right end.
For the case of standing sinusoidal variation of the water level at the entrance of the channel a simple analytical solution can be found for a simplified mathematical model of the flow. This model is linear since neither convection nor bottom roughness effects are considered and in the divergence term of the continuity equation, the depth is replaced by its mean value.
For a forcing function z0 = asinwr at the entrance, the solution is, (Wang and Connor, 1975):
z — —a-—~ cos ( kl ( ~ — 1 )) sin wi cos kl \ \l J)
~ac - ii ix AA
U = ~-- SIH	1 | CQS Wt
h cos kl \	\ I J J
where the variables have the following meaning:
a - semi amplitude at the entrance
z - elevation above mean water level
h - mean water depth
I	- length of the channel
x - distance from the entrance of the channel c = ^gh	- celerity
w = 2k/T- , - frequency ( T - period)
k^2n/L - wave number ( L - wave length)
During;, the.numerical simulati.Qn^teats^..the^conye-Ctiye^amL
XQXgtaeisa«Aarms^Mex^xot«.xonsidexe.d, Thus the only term which m k e s cLi f fe..rent—the—anaXyt leal,... mo del and .the.mathematical model used
for, the numeri..Q.aJ^sdmlatlxm-i^-tha^jdixexg.eiice^ternL...,o^the.. continuity e qua t ion which.i s_jsox„linear.. in . the„lasfzxne. In_oxdex_-to
minimiz e the non 1 inear .e f £ec ts on the . solution and so _ to make the comparison of,the.....re.sul.ts...meaningful.p only small, amplitudes . were used,
5.2.3.2	- Description of the tests and results
The initial conditions and the boundary conditions at the £ pen end were calculated with the analytical model. The following boundary conditions were used:
-	zero normal velocity at the three walls,
-	zero velocity at the two corners in the closed end of the channel
-	water level or normal velocity at the open end.
The other characteristics of the tests were:
I	- 200 m
h =	4 m
a ~ O.XOm
T 200 sec
Dt=	25 sec (time-step)
The results of two tests are presented. The first one was run with water levels as boundary conditions at the open end. The results are plotted in figures 5,10 to 5.13 in 3 points of the channel (entrance, middle and closed end). They show a good agre£ ment betwenn the computed and analytical solution. In the veloci. ty curves small differences appear. The results of this first test may be compared with those presented by Wang and Connor (1975) for a test made under the same conditions except the finite element mesh which in that case was composed of linear triangles.
In the two following tables the two last digits of Wang and
Connor results are presented between brackets;
Comparison of levels
X	Analytical	t = 300s	t = 600s	t = 900s	t = 1200s
0	± °*x	- 0.1	0.1	- 0.1	0.1
100	" 0.1044	- 0.1046(47)	0.1043(42)	- 0.1046(45)	0.1043(46)
200	- 0.1059	- 0.1061(63)	0.1058(56)	- 0.1062(61)	0.1058(56)
Comparison of velocities
x Analytical t = 150s
t = 450s
t = 750s
t = 1050S
0	- 0.05440 - 0.05460(66) 0.05487(46) - 0.05465(31) 0.05473(17)
100 - 0,02759 - 0.02770(81) 0.02785(72) - 0.02785(51) 0.02801(49)
200 0 0 0 0 0
For the second test normal velocities were used as boundary condition at the entrance. The results of the simulation and of the analytical model are plotted in figures 5.14 to 5,17, As in the first test they show a good agreement between the wo models. In this cases small differences in level curves occur while the ve locity curves at the middle of the channel cannot be distinguished (fig. 5.17).
The conclusion from these tests is that for the simple condi tions in which they were performed, that is, without non linear terms in the momentum equations and for small amplitudes the results agree with those of the correspondent analytical linear model. These conclusions must not be lightly generalised since other conditions must be experienced in order to change the time-step and the number of elements per wave length. The results of such tests will not always be so good as those presented here and they may be useful for estimating the limitations of model in what con cerns the discretization parameters to be used for the simulation in actual circumstances.
co
CR CO
00
-5
ANALYTICAL
FIG. 5*10
TINE (SEC)
© o
'x ko
X,
on
■. -ij
LEVEL (Fl)
FIG.
5all
TIME CSEC)
00
00
IS a
I
■3
Q
4
05
\
CO \ CH w
RECTANGULAR CHANNEL
NODE 3 (ENTR. )
FIG. 5 « 1 2
TIME (SEC)
00&amp;lt;o
a
i
o
o
4
a&gt;
•aj
w
Ol
co
w
£2
&gt;~
U o
_J
LU
TINE (SEC)
CO o
I
f'd
m d
O
RECTANGULAR CHANNEL - NODE 3 (ENTR. )
X
'x, en
FIG. 5^14
TIFIE (SEC)
o
&lt;£&gt; CO
LEVEL CM)
ANALTTICAL
TINE (SEC)
¡S3
C
I
o o
'L"'X ' J
JU&amp;lt;0
J.r^i
iO co
LEVEL (N)
TINE (SEC)
t™1
O
I
O o
&lt;5&gt;
J
ox Co
o
ANALYTICAL
RECTANGULAR CHANNEL - NODE 43 (PUDDLE)
T-600 SEC DT-25 SEC L-200 Fl
5.3	- APPLICATION OF THE COMPUTATIONAL SYSTEM TO AN ACTUAL ESTUARY
- THE TAGUS -
5.3.1	- Introduction
For the verification of the system working with acutal condjL tions the Tagus estuary was chosen. It has a complicated geometry and thus it is a good test^ for the system. The sea limit of the simulation domain was located at a line which starts near Cascais and ends in Caparica beach following approximatively the bathymetric - 30 m. The upper limit was located at the cross section of the estuary in Vila Franca de XiraSBridge. At this section the es tuary has already almost one dimensional characteristic. In fig. 5.18’an hydrographic survey of the estuary is shown with the defi, niiion of the boundaries of the simulation domain. This one is ve_ ry simplified when compared with the actual geometry. This is jus, tified by the following reasons:
a)	The Tagus estuary has a large area or tidal flats, A large part of its whole area is dry during part oí the tidal cycle. The algorithms which make possible to simulate the flow in tidal flats are not yet implemented in the computational system. Thus the limits of the estuary in these areas were chosen in a somewhat arbitrary way.
b)	The estuary has some narrow channels between its margins and the islands which exist in it ("Mouchões”). There are also .some estuary branches in the Southern margin (Seixal, Montijo, Alco-chete). The discretization of these parts of the estuary must be made in such a way that, at least two elements exist between the two margins in order to avoid numerical troubles.
The complete representation of the estuary would lead to a lar ge number of nodes and elements and to a large bandwidth of the global matrix. With the present capacity and operating conditions of the available computer facilities it should be difficult to have results in time without a complete alteration of the programs which must be done after this work.
It is difficult to say how the simplifications made influen ce the tesults without a previous study. However it was expected that the results of the simulation should agree with available com parison data, at least in such a way that the suitability of the computational system for these kind of studies could be proved.
5.3.2	- The finite element mesh
For the space discretization of the simulation domain, a mesh with quadrilateral and triangular isoparametric elements was used (figs. 5.19 to 5.23), The density of elements and the location of the nodes were chosen as a function of the complexity of the bottom topography and of the boundary geometry. However some simplifications were accepted in order to avoid a large bandwidth of the glo^ bal matrix. The mesh has 203 elements, 695jnodes and the corresponding bandwidth is 177.	v
The geometric data used was extracted from hydrographic sux vey charts from the Hydrographie Institut with scales 1:50000 and 1:25000. The bathymetry used for the simulation is shown in fig. 5.24.
5.3.3	- Boundary conditions
For the computations, which results are here presented, the following boundary conditions were used:
-	zero normal velocities at solid boundaries,
-	levels at the open boundaries.
The tidal curves used at the open boundaries were obtained by harmonic synthesis at the Hydrographic Institut and correspond to a mean tide,
5.3.4	- Comparison data
For the calibration stage, the tidal curves at several points in the estuary obtained by harmonic synthesis were used.

5.3.5	- Remarks about the tests in the Tagus estuary
Some problems came to light during the application of the computational system to the Tagus estuary. The first one was sol ved but it seems useful to present it here.
Thr first results have showfa growing instabilities^, which ap peared in several areas of the estuary. The amplitude of those instabilities grew up until the water surface reached the bottom and then the computation was stopped. Some trials were made to a void those instabilities such as filtering of the solution for each time-step, element averaging of convective terms, regularization and simplification of the bottom topography and alteration on the mesh density. Results from a complete tidal cyele were obtained. However its quality was not acceptable. Besides, the improvement of that quality had not a logical relation to the alterations made.
The explanation was found in a somewhat hazardous way and it is the following one. The integrals used during the computations (see expressions 3.64 in section 3.4.4.4) are calculated using Gauss formula for numerical integration. Tables with the coordji nates and weights of the integration points exist in several publications from which the one of Zienkiewicz (1977) was used. When only one type of elements is used the values of those tables give good results. However when triangles and quadrilaterals are used simultaneously such as in this case, the weights given for the in tegration points in triangles must be divided by two, sfs ft* is in the table given by Connor and Brebbia (1976). After the necessary corrections the results appeared without problems of instabilities.
Another problem is related to the data used for comparison of the results. The available data came from the Hydrographic Inp titut (tidal curves obtained by harmonic synthesis) and from measurements in the physical model. The calibration of the physical model was made using tidal curves actually measured in nature.
The comparison of the two data sets shows some discrepancies in what concerns the shape of the curves in the upper part of the estuary, and the tidal lags along the estvary. High and low water
levels as well do not agree in the upper part of the estuary, Ob vieusly for a correct use of the computational system a previous study of the data is necessary for choosing correct boundary condi^ tions and comparison data.
The last problem arises from the simplifications of the es«i tuary topography. It is known that for obtaining good results with numerical simulation a correct representation of the estuary geometry must be used. As it was said before that geometry was simplified in order to avoid very large bandwidths of the global matrix* Besides, it was not possible to correct the bathymetry of the estuary between the middle of the channel and the upstream boundary, as it was expected to do for the last tests here presen ted. That bathymetry had been simplified before because of the problems pointed out in the beginning of this section.
The conclusion of these remarks is that it was not possible to make a complete calibration of the Tagus model, which is only possible after the correction of its topography and with the use of correct data as boundary conditions.
During the last tests two alterations were made in the mathe_ matical model related to its bottom roughness term. The first was the replacement of the Chezy C by the Manning-Stricker Ks. The se_ cond was the use of different^vaTues of Ks for ebb and flow conditions. This last alteration seems to be realistic for estuaries and gives more freedom during the adjustment operations*
5.3,6	- Calibration results
The calibration tests which results are presented here were made with the following boundary conditions:
Sea boundary - A cyclic water level condition with a period of
12.5	hours and an amplitude of 2^1^ meters. This tide corresponds to a mean tide in Cascais obtained by harmonic synthesis.
Upper boundary - The tidal cycle in Vila Franca de Xira which cor responds to the one used in Cascais was prescribed at the upper section of the simulation domain.Its amplitude is 2,74 meters.

The cold start was used for the first runs, after what the results of each run were used as initial conditions for the folio wing ones. When using the cold start with high water level conditions the results of the simulation have shown that after the first half-tide the results are repeated for the following cycles.
During the first tests a 50 minute time-step was used. The comparison with the results obtained with a time step of 25 minute have shown a good coincidence. However in the first case it was not possible to make a good geometric description of the tidal cur ves and so the time step of 25 min was used for all the following tests.
For the reasons pointed out in 5*3.5 a complete adjustment of the tidal curves was not achieved with the tests executed until now. The tidal curves for two calibration tests are presented at the following comparison points:
CASCAIS	(Node	1)	-	Fig. 5.25
PAÇO DE ARCOS	(Node	105)	-	Fig. 5.26
PEDROUÇOS	(Node	176)	-	Fig. 5.27
LISBON	(Node	250)	-	Fig, 5.28
CABO RUIVO	(Node	344)	-	Fig. 5.29
PONTA DA ERVA (approximately)	(Node	527)	-	Fig, 5,30
VILA FRANCA DE XIRA	(Node	693)	—	Fig. 5.31
In the same plots the computed x velocities are presented. Since Ponta de Erva is out of the simulation domain it is compa-
9 red with node 527 only for having an approximate measure of the phase lag. ^he comparison of the obtained results with the cur ves obtained by harmonic synthesis shows that:
a)	The main differences appear in the phase lags for the points lo_ cated upstream the middle of the Tagus channel.
b)	Those differences are larger for the low water than for the high water,
c)	The computed low water level is above the predicted one in the upper part of the estuary.
d)	The velocities at V.F.de Xira are always directed towards the interior of the simulation domain.
e)	Some instabilities appear in the lower part of the estuary (Pa po de Arcos and Pedroupos).
The points a), b), c) and d) suggest that the geometry and bathymetry in the upper part of the estuary must be improved to ha ve better results. However, in some previous tests made with dif ferent boundary conditions measured in the physical model (normal velocities at V.F.de Xira and levels at the open sea), a better ad justment was achieved for the tidal curve at Cabo Ruivo. This was the only point where a suitable comparison curve exists in the area not affected by the geometry simplifications. Thus one may conclu de that besides the improvement of the geometry and bathymetry of the model, the use of reliable data is fundamental for achieving the calibration of the model.
The point e) deserves also some aditional remarks. How it can be seen in figs 5.26 and 5.27 the instabilities are smaller for the run 7 than for the run 8. They appear for small values of Ks. The increasing of bottom roughness causes the rising of instabilities at each node and a node to node instability. This can be seen in a free surface profile along the Northern bank of the estuary (fig. 5.32). For the run 8 small values of Ks were used in the channel zone. For the run 7 these values were larger in that zone but were smaller in the upper part of the domain. The no de to node level fluctuations disappear in the lower part of the . estuary but appeared in its upper zone. Brebbia and Partridge (1976) in a model study for the North Sea noticed the existence of such node to node level fluctuations and suggest the use of filtering for avoiding that problem. However those authors have used very small Chezy coefficients(15 m^^2 §"1) to which correspond a Bazin’s y of about 26.	0^6
From these facts it seems reasonable to conclude that the u se of physically incorrect roughness in the numerical simulation may lead to numerical instabilities. The filtering of the solution may avoid those troubles. However it is more realistic to think that those instabilities correspond to incorrect conditions and so these ones must be altered, until a good solution is reached. This solution is very probably better than the filtered one.
Another aspect of the solution which is shown is the veloci.
LNEC - Proc. 64/13/5314
ty field along the tidal cycle. For the case of the Tagus it is difficult to show the velocity field for the whole domain in a fi gure because the range of the velocities is to large to be shown with only one velocity vector scale (fig, 5.33), In figures 5.34 to 5,54 the velocity field along the tidal cycle^^is shown for the area of the estuary downstream Lisbon. From the analysis of those figures it becomes apparent that the velocities in the chan nel are greater than it is expected. This may be explained by the errors which appear in the tidal phase for the nodes located upstream the middle of the channel.
The same remarks made before about the data used and about the simplifications made on the geometry and on the bathymetry may be used concerning', these results.
Some qualitative aspects of the results deserve some attention. One is that in spite of the geometry simplifications and of doubts about the data used it was possible to approximate the high water levels. The other is that the simulated circulation pattern in the channel and entrance of the estuary is realistic and agrees qualitatively with the flow observed in the physical model.
5.4,	CONCLUSIONS
The results of the tests with the computational system for simple flows show a good agreement with the expected results. The application to an actual" estuary was not a complete test since the simplifications made during that study and the data used made not possible a total calibration of the model. However from a qualitative analysis of the results one may conclude that it is possible to achieve that calibration after correction of the geometry and a careful choice of the data used as boundary conditions and for com parison of the results. During these tests the importance of the data quality and of a careful geometric representation of the estuary became apparent.
(1). The figures 5.33,to 5,54 concern the run 8,
LNEC - Proc, 64/13/5314	103
INI
TAGUS	SCALE = 1 : 200000
PROCESS 6*1/1 3/531*1
/&amp;lt;9 /fr, Í-
Fig, 5,19
J v	t i;i j T ?
S';;.-.	f^':
Ur S' ’/
/
PROCESS ¿&gt;4/13/5314
344
CM
in
ft
&amp;amp;
CD
co
□
&lt;
PROCESS 64/13ZS314
LNfíC - Proc. 64/13/5314
tf Cf Ld CJ o or Q_
&gt;— O'
&amp;lt;CD
CM iO
•H
&amp;amp;
t”
iz: w o
i
O
CASCAIS ~ NODE 1
4
LEV
DATA
7
V----V
O CD
TINE(SEC)
LNEC - Proc. 64/13/5314
o
DATA
P. DE
ARCOS - NODE 105
x 1500
Q
I
•Ti
Q O
PEDROUCOS - NODE 176
CO
CH
CO
h-J

TIME(SEC)
4.13
TAGUS ESTUARY - CALIBRATION
LISBON - NODE 250 ■
RUNS 7 &amp;amp; B
1—I—I—í—I—I—I—I—i—I—I—I	I í I
20	25	30
LNEC - Proc. 64/13/5314	■=*	113
TAGUS ESTUARY - CALIBRATION
CABO RUIVO - NODE 344
______DATA
v----v 7 LEV
H----Ej 8 LEV
1---1---1---1---1---1---1--J----1---1---1---1--1----1---1
2Ô	25	30
TIME(SEC J
LNEC - Proc. 64/13/5314	114
TAGUS ESTUARY - CALIBRATION
PTA DA ERVA (APPROX. ) - NODE 527
X 1E00
FIG. 5*30
TAGUS ESTUARY - CALIBRATION
V. FRANCA DE XIRA - NODE 693
V-----v 7 LEV Ef----B 9 LEV 4-----0 7 VX
*_____* 9 VX
“J--[—1----1---1--p 1-----[--1--1--1---1---1
20	'	25	30	.
' &amp;lt;! $
x 1500
TIME(SEC)
se*s '§idi
bJ&gt; 809 ¿S
-	ui
1 L
-&gt;	-	--■--  -'-'■	- MM	MNTffiWKNMl	MU	U	LXXJL4J
(n -earncd (noMUA in	ththMMm dd'U	d ® ®	\o®	-*	muaitd^
inrOM-^ a	—cn kjcho -oa	cd in &gt;a	ibKUMvUii	coin	u	ajaub
U (JAUWAA A A AIH UlTTn JI VI \o awanGNobawojm cd -jroinwN^CD-^UD'Xjm cd
f
S66 ’ I
VLZ'Z
CZQ'Z
&gt; M/ £
// Cj
g puv x sunj joj SQTfjojd eoejjns joiv/a
660 C
MCT
LNEC - Proc. 64/13/5314
Catcall
LNEC - Proc, 64/13/5314
LNEC - Proc. 64/13/5314
• so*5-
0^
Catcall
•¡m &gt;&gt;&lt;
‘U
11 i i‘” ’’
\ x \ » V • * ’

i;i;
^V:
' A\V.\...
• •uWVW'"
■ ■"'/////
i H H i ‘ *
03»o5
Caacalt
Catcall
VELOCITIES INSTANT 13 ( 1 9S00 SEC.
„ ?í°°’

vics/ex/’9
0OX¿L

LNEC - Proc. 64/13/5314	129
TAGUS
PROCESS 6'1/13/531'1
SCALE .. i rVJf
VELOCITIES INSTANT 1BC27000SEC.	)
LNEC - Proc, 64/13/5314
Fig. 5.46
LNEC - Proc. 64/13/5314
N
PROCESS 64/1 3/53'1 4
VELOCITIES INSTANT 22 ( 3JOO0SEC. )
Fig. 5.47


o
i
*TJ
3
o
th-X
CO X cn co |wl th-
t~* CO CO
Fig. 5.49
VÍ°°’
LNEC - Proc. 64/13/5314	135
Pig, 5.51
Q
I
Proc. 64/13/5314	136
Catcall
■
t
t
!
f
f
I
?
1
TAGUS
PROCESS 64/13/5314
VELOCITIES INSTANT
2Q ( 42000 SEC.



i’ig. 5.52
, o®3551
.oo*&amp;amp;
Catcall
VELOCITIES INSTANT 30C4G000SEC.
CHAPTER 6
CONCLUSIONS AND REMARKS ON FUTURE WORK
6,1	- CONCLUSIONS
The main goal of this work was the development of a computa tional system which might be used as a reliable tool for engineering studies of estuaries. That goal was achieved with the limits tions which are pointed out through the work. The main limitations of the computational system are:
a)	The water density is considered constant for all the mass ef wa ter inside the estuary.
b)	The flow equations are vertically integrated over the water depth and so the description of the flow is made at each point through the mean horizontal velocity ever the vertical of that point.
c)	The geometry of the wet domain is considered constant along the tidal cycle. Thus the flow in tidal flats cannot be simulated.
The suitability of the use of numerical simulation for hydro dynamic studies in estuaries was not specially emphasized through out the work since the experience in many countries prove &gt;t, Hew ever experience shows also that it is very important that this tool be very carefully used, that is, with the conscience of the limits tions of the mathematical models used and of the behaviour of the computational systems. From the point of view of the quality of the results this is more important than the choice of the numerical technique to use. In fact, both finite difference and finite ele ment method are no more than mathematical tools whic^ have been u sed successfully for solving differencial equations in several fields of science and engineering.
Another aspect of the use of numerical simulation, whieh:im' £ortanee became apparent in this work, is related to the data used. On one hand it is necessary that the geometry and bathymetry of the
LNEC - Proc. 64/13/5314
The interpretation of.the results is an important part of any simulation study. Since the simulation is a process which u ses approximate methods to solve simplified equations of the flow in a discretized domain, their results must not be seen as the final product of the study. Only a careful analysis and interpretation of those results makes them useful for actual applications.
These last remarks on the quality of data and on the interpretation of results lead directly to the necessity of knowing the flow characteristics of the estuary actually being studied and, more generally, the physics of the estuarine circulation,
6.2.	REMARKS ON THE FUTURE WORK
. Numerical simulation may be applied to the several scien tific areas which are related to estuarine phenomena. For that, hydrodynamic models supply the necessary flow parameters which are used as input data for simulation of ether phenomena. Thus the de^ velopment of reliable and suitable hydrodynamic^oomputational systems is an important basis for the study of ether estuarine phenomena.
The study which started with this wofck may continue in several ways that, at least partially, may be followed in parallel. They are related to the improvement of the present computational system and its extension to more complex flow simulation and to non flow problems. In any case, the following work must be made on the actual configuration of the computational system:
- Improvement of the efficiency of the system
The computer programs may become more efficient in what con cems running time and core memory used. For that it is necessary to rewrite the main program of the system, in such a way that the implementationPef a new algorithm to solve the system of equa tions becomes possible.
-	Implementation of new numerical facilities
This point is mainly related to the possibility of using o-ther types of finite elements and other time-integration schemes;
-	Study of the behaviour of the system
The study of the behaviour of the solution of the computatio nal system for different types of elements and time integration schemes, following theoretical and experimental ways is an important stage for the development ©f. -f^nre models. In particular, the study of the possible advantages of using explicit schemes for time integration must be investigated,
-	Simulation of the flow in tidal flats
In many estuaries (e.g, the Tagus and the Sado) the area of the tidal flats is an important part of the whole estuary area. The implementation of an algorithm which makes possible to consider the existence of such areas is important since a more complete and correct simulation of the flow becomes possible.
The extension of the capacity of the computational system for solving different problems must be defined through the knowled ge of the needs of LNEC in the field of estuaries in accordance with the availability bf investigation personnel. Two possible ways are here presented:
-	Simulation of non homogeneous flows
A possible extension of the mathematical model used in the present computational system Is related to the simulation of non homogeneous flows. Differences or water density may be considered in such models through the schematization of the flow in two or mo. re homogeneous layers. The equations of the flow are vertically integrated over the thickness of each layer and compatibility con ditions are used at the interface of each two layers. These type of models is useful for salinity and water quality studies.
-	Development of water quali'ty^models
For the simulation of water quality in estuaries the knowled ge of their hydrodynamics is necessary. These hydrodynamic data may serve as input for studies where the alterations of the water
composition do not affect the flow pattern significantly* The S£ lution of water quality mathematical models may be based on the sa me numerical techniques as those used in the present work, and so the extension of the present computational system to solve such problems is a continuation of the hydrodynamic studies»
0 Assistente de Investigação
Pedro Manuel P. Leal Figueira
APPENDIX
APPENDIX
GENERAL EQUATIONS OF THE FLOW
1	- CONTINUITY EQUATION
1*1 - General case
The continuity equation is derived from the principle of mass conservation applied to an arbitrary volume V fixed in a flow*	volume
V is limited by Lhe surface S with exterior normal unit vector n.
From that principle it follows that if there is no creation er destruction of matter Inside Vt the rate of change of the mass stored in V is equal to the net mass flow that enters V through Sf that is
~~ dV= - I pu.h dS	( 1 )
Jl dr Js
where u is the instantaneous velocity vector at a point of the flow and p is the density of the fluid.
The second member of ( 1 ) can be written (Ostrogadski-Gauss Theorem)
i*
Js
pu.n dS~
div (pu) dV
( 2 )
Substitution of ( 2 ) in ( 1 ) yields
( 3 )
( 4
Since the volume V is arbitrary the dentically zero, that is
Integrand ef ( 3 )
is i
dp
-/- + div (pu) = 0
Gt
The divergence term of ( 4 ) may be
written
div (pu)=^~ (pu^Ui ^+p^-
GX{	GXf dXi
2,	3) are the components summing convention
where (i = 1, locity vector, and the
Substituting ( 5 ) in ( 4 ) yields
of the instantaneous ve is used.
( 5
)
dp dui
-¿- + «^ + ^^ = 0 Gt	8Xi GX;
er
dp	OU: n
dt	dXi
the
( 6 )
The equations ( 4 ) and ( 6 ) are two usual general forms of continuity equation.
1.2
” Continuity for liquids
one important simplification in in that case
It is generally assumed that for liquids the density is cons^ tant. This assumption introduces the continuity equation, because
T=°
dt
( 7 )
and the continuity equation ( 6 )
becomes
^ = 0
dx{
( 8 )
Accepting that the density for an homogeneous fluid flew with the same temperature in every point is constant, is equivalent
to accepting its incompressibility. However for an estuary the fluid is not homogeneous and the temperature varies from point to point in the flow. The density is a function of pressure, salini^ ty and temperature. Thus
P=p(p(t),	0(t))
and
dp dp dp dp ds dp dO dt dp dt ds dt~^ d6 dt
( 9 )
Statement ( 7 ) is then equivalent to accepting that the liquid is incompressible and that its density variations with salinity and temparature can be neglected. For that it is necessary to invoke a Boussinesq type approximation, which states that time and spatial variations in density may be neglected except in terms in which they are multiplied by gravity (Phillips, 1977 ).
With this approximation, equation ( 8 ) is a good tepresenta tion of the principle of mass conservation for estuaries.
1.3	- Continuity for turbulent liquid flow
In a turbulent flow the component u^ of the instantaneous ve locity vector at a point may be considered as the sum of its mean value over a time interval At with a fluctuation around that mean
value, that is
w. = &amp;lt;u. &gt; 4- u*
( 10 )
where
&lt;Ui&gt;
At
rtf + At
i
u; dt
and At is such that&amp;lt;u*&gt; =0 and that&amp;lt;uf&gt; can describe accura tely the time evolution of the flow. Substituting ( 10 ) into
( 8 ), yields
Taking the mean ever Az for the terms of ( 11 ) one gets
( 12 )
but
and
d + d + n dx,- ‘ dx; *
Thus ( 12 ) becomes
(f- 1,2.3)
( 13 )
Equation ( 13 ) represents the principle of mass conservation for the turbulent flow of a liquid with the approximation assumed in 1.2.
2	- MOMENTUM EQUATIONS
2.1	- General case
The momentum equations are derived from the principle of mo mentum conservation applied to an arbitrary volume V fixed in a flew, limited by a surface S with exterior normal unit vector n. That principle states that the rate of change of momentum inside V is the sum of the net rate of flow of momentum that enters V through S with the sum of the external forces acting on V.
The momentum flows Into and out of the volume V by two mecha nisms: bv convection, associated with the mass that flows through S and by molecular transfer . associated with velocity gradients that cause momentum exchanges between adjacent particles of fluid.
To determine the flow of momentum
through S by convection, let P be a point of S where the flow veloei ty is u. The x^ component of momentum per unit volume is puj . The volume rate of flow that enters V per unit area at point P is -u.h .
nit
flow
Thus the rate of flow of the Xj component of momentum per u . For the whole surface S
area is -puju.n
that
rate of
is
pUjü.n dS
( 14 )
Applying the Ostrogadski-Gauss theorem to ( 14 ) it becomes
div (pUju) dV~ —
d- ípu¡uj dV
J r cxi
(i-1,2,3)
( 15 )
Now let be the rate of flow per ponent of momentum conveyed by molecular tion, at point P of S. Thus the part or
Xj com-transfer in the x^ direc that rate of flow that
unit area of the
enters V is —
For the whole surface it follows that
(i= 1,2,3)
( 16 )
(1). In general the molecular transfer mechanism is treated as a tangential stress between two adjacent layers and in the deri^ vation of the momentum equations it appears in the terms of external forces. This is admissible for laminar flows, but it is not consistent with the structure of the turbulent flows. However, as a consequence, of the complexity of these flows, the molecular transfer of momentum is assimilated to a tangen tial stress (Reynold’s turbulent stress).
The external forces aeting on V are pressure and mass forces.
The pressure at a point P of S is p
The sum of the pressu
re forces per unit area in P is -ph
Thus the x^ the whole surface
component of the is
component
sum of the pressure forces ever

( 17 )
If pXj is the xj unit volume V,,for the
component of the sum of the mass forces per whole volume V that component is
pX}dV	( 18 )
J V
Applying the principle of momentum conservation to its Xj component and considering the expressions ( 14 ) to ( 18 ), it foJL lows that
[J dv= T“+^-p X;)&lt;/F=0
or
^,(i(^)+i(/’u&gt;Ui)+4Ty+i“px&gt;)dF=o&amp;lt;i=1,2’3) (19}
Since the volume V was arbitrarily chosen, the integrand of ( 19 ) is identically zero, that is
¿(^+¿^&gt;+¿^+^-^^-=0 &amp;lt;20 )
Equation ( 20 ) represents the general form of the principle of conservation of momentum for a liquid.
2,2	- Momentum conservation for Newtonian Liquids
For fluids that follow Newton’s Law of viscosity, the rate
of flew per unit area of the x
component of the momentum conveyed
J
by molecular transfer in the x* direction is
where is a coefficient of momentum transfer (dynamic viscosity coefficient) and is the Kronecker delta*
If p is constant the last	21 ) lb" zero (continui
ty equation). Considering that p is also constant, it follows that
0Ty __	G
cxi	dx¡
a
d2Uj dx¡dx¡
( 22 )
But, by continuity
a
dx¡ \0UjJ axj \GXiJ
Thus
( 23 )
Substituting ( 23 ) into ( 20 ) yields
5	5	c)
si (pu¿+s¿; {pu^= -^+p ^u¡+p x¡
( 24 )
This equation represents the principle of momentum conserva tion for the flow of a Newtonian fluid assuming that mass conservation is well represented by the continuity equation in the form
2.3	- Turbulent flow of Newtonian Liquids
With the notation introduced in section 1.2 of this appendix the instantaneous velocity, pressure and density may be expressed

Uj=&lt;Uj&gt; + »/ p =&amp;lt;p&gt; + p + p = &amp;lt;p &gt; + p +
5	5
~dx-&amp;lt;P&gt; ~"dx-P*+p '^2&lt;uj&gt; + V2u/ + p Xj
G= 1,2,3)
( 26)
Taking the mean ©ver Ai for the terms of some algebra
( 26 ) yields
after
¡.(p&lt;Uj&gt;}+^.(P&lt;Ui&gt;&amp;lt;U.&gt;}+.L(P&lt;U+ u+
~&amp;lt;p&gt; +pV2&lt;Uj&gt; +p Xj J
( 27)
The term p&lt;u*u?&gt; whose derivative appears in ( 27 ) is
ass£ elated with the turbulent fluctuations of the velocity and may be considered as a Xj component of momentum rate of flow per unit a-rea in the x^ direction. Usually it appears with the name of Reynold stress and with the notation
Ty — p&amp;lt;u* uf &gt;
Difficulties tn the quantification of t;, arise from the natural complexity of turbulence. Usually that quantification is ma de by analogy with Newton’s law of viscosity by means of an expres. sion like
/I
v/'	X
where / is a coefficient of turbulent momentum molecular transfer
(eddy viscosity). This coefficient is not a physical characteristic ®f the fluid like the Newtonian viscosity coefficient. It is anisetropic since it depends on the local structure of the flow.
BIBLIOGRAPHY
s ií
ABBOT, M., 1977 - "Opening address of the 1 International Conference on Applied Numerical Modelling”• Southampton^ co Brebbia (ed.), Pentech Press, 1978.
ABBOT, M. et al., 1973 - System 21, "Jupiter" (a design system for two dimensional nearly-horizontal flow). "Journal of Hydraulic Research", 11 (1), 1973, p. 1 -28.
BIRD, R. et al., 1960 - Transport phenomena. New York, John Wiley &amp;amp; Sens, Inc.	(LNEC n® 62660).
BREBBIA, C.; PARTRIDGE, P., 1976 - Finite element simulation of water circulation in the North Sea, Applied Mathematical Modelling 1	(2) Sept. 1976, p, 101 - 107.
CASPERs, H., 1967 - Estuaries; Analysis of definitions and biological considerations. In "Estuaries", Washington, D.C., George Lauff (ed.), American Association for the Advancement of Science, Publ. n® 83.	(LNEC n® 59921).
CONNOR, J.; BREBBIA, C., 1976 — Finite, element techniques for fluid flow. London, Butterworth &amp;amp; Co, Ltd. (LNEC n® 75410.)»
CUNHA* J., 1981 - Sistema gráfico .interactivo ep.nfigurável para diferentes ,apiicagoes. Lisbotí, LNEC, Thesis.
CUNJE, JM 1975 - Application of mathematical modelling to two-dimensional tidal deltas and estuarine networks. (Case-study : River Seine estuary - coarse grid model). In «Unsteady Flow in Open Channels”, Vol, II, Fort Collins, Colo,, Mahmood and Yevjenich (eds.),
CUNJE, J., 1977 Difficulties of open channel hydraulic_.ma.thema-tical modelling as applied to real life, situations. «Froc. p&gt;r’*
1	" International Conference on Applied Numerical Modelling”, Southampton, C, Brebbia (ed.), Pentech Press, 1978.
CuNJE, J., 1979 - Remarques g4n£rales concernant les modules: ma-ft&gt;h.ematiqws des estuaires so urn is &amp;amp; Vaction de la mar4e.
"Is Simpdsio Naciaonal de Estuarios", LNEC, Lisbon»
DAUBERT, A.; GRAFFE, 0: , 1967 - Quelques aspects ..de.s.....^.coulements presque hpriz^ntaux deux dimensions em plan et non permanents, Application aux , estuaires. La Houille Blan ch® n9 8/1967, p. 847 - 860.
DBONKERS, J., 1964 - T i dal e omputa t io h in r i ve r s - and :, co as tai waters . Amsterdam, North - Holland Publ.Co, (LNEC n2 42814).
DRONKERS, J.; SCHOENFELD, J.t 1955 - Tidal computations. jn_shallow water. Proc. ASCE, Journ. Hyd. Div., Sep n9 714.
DYER, K., 1973 - Estuaries.: A physical,, .introductio.n. London, John Willey a Sons.	(LNEC n2 72418).

ENVIRONMENTAL PROTECTION AGENCY, WATER QUALITY OFFICE, 1971 - Estuarine modelling: An. assessment'»Tracer. Inc., Austin, Water Pollution Control Research Scries, Project 16070 DZV. (LNEC n9 65667).
GRAY, W., 1976 - An efficient finite element scheme for two-dimen-
sional surface water computation. «Proc. First International Conference on Finite Elements in Water Resources”, Princeton. Pentech Press. (LNEC n® 78476).
LNEC - Proc. 64/13/5314
I*
HARRIS, D.; BODINE, B., 1977 - Comparison of nwaerical and physical hydraulic models, Masonboro inlet. North Carolina. Dep. of the Army Corps of Engineers, GUI Report 6.
(LNEC n2 79640).
HERRLING, B., 1978 - Computation of shallow w^ter waves with hybrid finite e1ement s. Advances in Water Resources, !_ (6), Dec, 1978, p. 313 - 320.
HOLSTERS, H., 1978 - Ma thema t i cal mo delving o f.. 11dal flats: a f ew reMarkn • ”Proc. Int. Symposium on Mathematical Modelling ©f Estuarine Physics”, Hamburg, German Hydrographic Institute,- S&amp;amp;ndermann and Holz (eds.) Springer-Verlag, 1980.	(LNEC ns 85507).
HOLZ, K., 1978 - Finite elements, a flexible tool for modelling es-' tuarine proce s.sesy ”Proc. Int, Symposium on Mathematical Modelling of Estuarine Physics”, Hamburg, German Hydrographic institute, Sundermann and Holz (eds.). Springer-Verlag, 1980. (LNEC n® 85507),
HOLZ, K.; HENNLICH, H., 1976 - Numerical experience from the computation of tidal waves, byj^e finite element method. ”Proc. First International Conference on Finite Elements in Water Resources”, Princeton, Pentech Press.
(LNEC n® 78476).
KING, I.; NORTON, W., 1978 - Recent application of RMA*s. finite e-models., for two- dimensional hydrodynagiios and water RJA^lity* w Proc, Sec. International Conference on Finite Elements in Water Resources”, London, Pentech Press.
LYNCH, D., 1978 - Finite element solution of the shallow, water e-quation. Princeton University, USA, PhD Thesis.
LYNCH, D.; GRAY* N., 1978 - Finite element simulation of shallop
^'roc. Sec. International Conference on Finite Elements in Water Resources”, London, Pentech PresiF»
OLIGER, J.; SUNDSTROM, A., 1976 - Theoretical and praticai aspects of some initial boundary valu^ problems in f?_uid dynamics. Stanford Un., Computer Science Dept., STAN - CS - 76 - 578
OLIVEIRA, I,, 1973 - Embocaduras lagunares. Contribuição para o estudo Aas suas condigoes ■ de- equi 1 i brio.-. LNEG, Lisbon, Thesis (Instituto Superior Técnico).
PARTRIDGE, P.; BREBBIA, C., 1974 - Suitability of higher order fill i t e element „ mo del s for. shal lew	t e r pro b 1 ems. S o uthamp-
t^n, Rop. CE/9/74. " (LNEQ 74172),
PARTRIDGE, P.; FERRANTE, A:, 1977 - A...numerical model for circula-
tion studies in Brazil, "Proc, first International Conference on Applied Numerical Modelling", Southampton, 1978
C.	Brebbia (ed.), Pentech Press.
PHILLIPS, 0., 1977 - The dynamics of the upper ocean, Cambridge
’nó	—	-
University Press, 2~" ed.
PINDER, G.; GRAY, W.? 1977 - Finite element simulatipn in surface and subsurface hydrology. New York, Acadcnie Press, Inc. UNEC 85756).
PRAAGMAN,
N.* 1979 - Nume r i cal solution, of the....................shallow wat er e qua-
tion b_ by a finite e 1 _e me, n t...r?,c.thed, Technisohe Hegescholl
Delft, Holland. Thesis.
PRITCHARD, D,, 1967 - What is an estuary: Physical, viewpoint. In «Estuaries”, Washington, D.C., George Lauff (ed.), American Association for the Advancement of Science, Publ.
&amp;amp; n8 83.	(LNEC n9 59921).
PRITCHARD, D., 1971 - Two dimensional models. In «Estuarine modelling: Al assessment”. Environmental Protection Agency, Tracer, Inc., Austin, Water Pollution Control Research Series, Project 16070 DzlV. (LNEC n® 65667).
RAUDKXVI, At&gt;; CALLANDER, B,, 1975 - Advanced fluid mechanics. An introduction. London, Edward Arnold Ltd. (LNEC n9 75648).
WALTERS, R.; CiiENG,B., 1979 -A two dimensional hydrodynamic model of a tidal estuary. Advances in Water Resources, 2 (6) Dec. 1979, p. 177 - 184.
WEARE, T., 1973 * A. note on the economic disadvantages of the finite element method.for two-dimensional tidal hydraulics. Wallingford, Hydraulics Research Station, Rep n9 INT 123.
WANG, J.; CONNOR, J., 1975 - Mathematical modelling of near coastal circulation. Cambridge, Mass.. Ralph M, Parsons Laboratory -Rep. n8 200 (LNEC n9 78083).
ZIENKIEWICZ, 0., 1977 — .Thf init e..element me tho d., London, Me.Graw— Hill, 3rded.	(LNEC n8 81863).</field>
	</doc>
</add>