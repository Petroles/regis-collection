<?xml version="1.0" encoding="utf-8"?>
<add>
	<doc>
		<field name="docid">BR-TU.24697</field>
		<field name="filename">9143_Dissertacao_Flavio_Augusto_Martins_Strutzel.pdf</field>
		<field name="filetype">PDF</field>
		<field name="text">
 
 

UNIVERSIDADE DE SÃO PAULO 
ESCOLA POLITÉCNICA 

DEPARTAMENTO DE ENGENHARIA QUÍMICA 

FLAVIO AUGUSTO MARTINS STRUTZEL 

CONTROLE IHMPC DE UM PROCESSO INDUSTRIAL 
DE HIDROTRATAMENTO DE DIESEL 

São Paulo 
2014 

 
 



 
 

2 
 

UNIVERSIDADE DE SÃO PAULO 
ESCOLA POLITÉCNICA 

DEPARTAMENTO DE ENGENHARIA QUÍMICA 

FLAVIO AUGUSTO MARTINS STRUTZEL 

CONTROLE IHMPC DE UM PROCESSO INDUSTRIAL 
DE HIDROTRATAMENTO DE DIESEL 

 
 
 
 
 

Dissertação apresentada à Escola 
Politécnica da Universidade de São 
Paulo para obtenção do título de Mestre 
em Ciências, Programa de Engenharia 
Química. 

 

São Paulo 
2014 



 
 

3 
 

 
 

FLAVIO AUGUSTO MARTINS STRUTZEL 

CONTROLE IHMPC PARA UMA PLANTA 
DE HIDROTRATAMENTO DE DIESEL 

 

Dissertação apresentada à Escola 
Politécnica da Universidade de São 
Paulo para obtenção do título de Mestre 
em Ciências, Programa de Engenharia 
Química. 
 
 
Área de concentração:  
Engenharia Química 
 
Orientador:  
Prof. Dr. Darci Odloak 

São Paulo 
2014 



 
 

4 
 

Este exemplar foi revisado e corrigido em relação à versão original, sob 
responsabilidade única do autor e com a anuência de seu orientador. 
 
São Paulo,      de fevereiro de 2014. 
 
 
Assinatura do autor   ____________________________ 
 
 
Assinatura do orientador   _______________________ 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 

  

 
 
 

 FICHA CATALOGRÁFICA 

  

 
 
 
 
 
 
 
 
 

  

 
 
Strutzel, Flavio Augusto Martins 

Controle IHMPC de um processo industrial de hidrotratamen- 
to de diesel / F.A.M. Strutzel. – versão corr. -- São Paulo, 2014. 

106 p. 
 

Dissertação (Mestrado) - Escola Politécnica da Universidade  
de São Paulo. Departamento de Engenharia Química. 
 

1.Controle preditivo 2.Controle de processos 3.Tempo-real 
(Otimização) 4.Hidrorefino de petróleo I.Universidade de São 
Paulo. Escola Politécnica. Departamento de Engenharia Química 
II.t. 

 



 
 

5 
 

Agradecimentos 
 

 

Ao Prof. Darci Odloak, pela orientação e por todo o inestimável apoio 

dado durante a condução deste trabalho. 

 

À minha amada esposa Pamela, meus pais, irmãos e demais familiares, 

pelo carinho e incentivo dado ao longo desse período. 

 

À Petrobras, por incentivar e viabilizar a educação continuada dos seus 

profissionais. 

  

Aos nobres colegas da Refinaria Presidente Arthur Bernardes da 

Petrobras, a RPBC, por todo o apoio, sobretudo ao Engenheiro Oswaldo Luiz 

Carrapiço e ao meu Coordenador Antônio Maylinch Teruel. 

 

Ao Engenheiro Antônio Carlos Zanin da Petrobras, pelas preciosas 

contribuições. 

  

  



 
 

6 
 

 

“Oh, quão insuficiente é a palavra e quão ineficaz / ao meu conceito!” 

Paraíso, Dante Alighieri 

 

 

 

 

 

 

 

O Mistério das Cousas 

 

O mistério das cousas, onde está ele?  

Onde está ele que não aparece  

Pelo menos a mostrar-nos que é mistério?  

Que sabe o rio disso e que sabe a árvore?  

E eu, que não sou mais do que eles, que sei disso?  

Sempre que olho para as cousas e penso no que os  

homens pensam delas,  

Rio como um regato que soa fresco numa pedra.  

Porque o único sentido oculto das cousas  

É elas não terem sentido oculto nenhum,  

É mais estranho do que todas as estranhezas  

E do que os sonhos de todos os poetas  

E os pensamentos de todos os filósofos,  

Que as cousas sejam realmente o que parecem ser  

E não haja nada que compreender.  

Sim, eis o que os meus sentidos aprenderam sozinhos: 

As cousas não têm significação: têm existência.  

As cousas são o único sentido oculto das cousas.  

 

Alberto Caeiro, "O Guardador de Rebanhos - Poema XXXIX" 

Heterônimo  de Fernando Pessoa  

 

 



 
 

7 
 

ÍNDICE DE FIGURAS 

 
Figura 1.1 – Esquema simplificado de uma UHDT..................................................................26         

Figura 1.2 – Esquemático da UHDT da PETROBRAS – RPBC..............................................28 

Figura 4.1 – Esquema da estratégia de otimização em três camadas........................................55 

Figura 4.2 – Esquema da estratégia de otimização em duas camadas......................................57 

Figura 4.3 – Representação da pirâmide do controle de processos..........................................57 

Figura 4.4 – Interação entre os níveis da pirâmide do controle de processos...........................58 

Figura 4.5 – Ilustração do Conceito de Funnel.........................................................................63 

Figura 4.6 – Funnel sem Tempo Morto....................................................................................64 

Figura 4.7 – Funnel com Tempo Morto....................................................................................66 

Figura 5.1 – Estudo de Caso 1 – Variáveis Controladas (y1 – WABT [ºC]; y2 – Enxofre 

[ppm]; y3 – Total de Instáveis [m
3/d])......................................................................................81 

Figura 5.2 – Estudo de Caso 1 – Variáveis Controladas (y4 – Excesso de H2 [kNm
3/d]; 

y5 – Pressão de H2 para C-02  [kgf/cm
2])..................................................................................81 

Figura 5.3 – Estudo de Caso 1 – Variáveis Manipuladas (u1 – Carga [m
3/d]; u2 – Vazão de 

Instáveis [m3/d]; u3 – T. Saída do Forno [ºC])..........................................................................82 

Figura 5.4 – Estudo de Caso 1 – Variáveis Manipuladas (u4 – T. Entrada R1L2 [ºC]; u5 – T. 

Entrada R2L1 [ºC]; u6 – T. Entrada R2L2 [ºC]).......................................................................82 

Figura 5.5 – Estudo de Caso 1 – Evolução do Valor Total da Função Objetivo......................83 

Figura 5.6 – Estudo de Caso 2 – Variáveis Controladas (y1 – WABT [ºC]; y2 – Enxofre 

[ppm]; y3 – Total de Instáveis [m
3/d])......................................................................................85 

Figura 5.7 – Estudo de Caso 2 – Variáveis Controladas (y4 – Excesso de H2 [kNm
3/d]; 

y5 – Pressão de H2 para C-02  [kgf/cm
2])..................................................................................85 

Figura 5.8 – Estudo de Caso 2 – Variáveis Manipuladas (u1 – Carga [m
3/d]; u2 – Vazão de 

Instáveis [m3/d]; u3 – T. Saída do Forno [ºC])..........................................................................86 

Figura 5.9 – Estudo de Caso 2 – Variáveis Manipuladas (u4 – T. Entrada R1L2 [ºC]; u5 – T. 

Entrada R2L1 [ºC]; u6 – T. Entrada R2L2 [ºC]).......................................................................86 

Figura 5.10 – Estudo de Caso 2 – Evolução do Valor Total da Função Objetivo....................87 

Figura 5.11 – Estudo de Caso 3 – Variáveis Controladas (y1 – WABT [ºC]; y2 – Enxofre 

[ppm]; y3 – Total de Instáveis [m
3/d])......................................................................................88 

Figura 5.12 – Estudo de Caso 3 – Variáveis Controladas (y4 – Excesso de H2 [kNm
3/d]; 

y5 – Pressão de H2 para C-02  [kgf/cm
2])..................................................................................89 



 
 

8 
 

Figura 5.13 – Estudo de Caso 3 – Variáveis Manipuladas (u1 – Carga [m
3/d]; u2 – Vazão de 

Instáveis [m3/d]; u3 – T. Saída do Forno [ºC])..........................................................................89 

Figura 5.14 – Estudo de Caso 3 – Variáveis Manipuladas (u4 – T. Entrada R1L2 [ºC]; u5 – T. 

Entrada R2L1 [ºC]; u6 – T. Entrada R2L2 [ºC]).......................................................................90 

Figura 5.15 – Estudo de Caso 3 – Evolução do Valor Total da Função Objetivo....................90 

Figura 5.16 – Estudo de Caso 4 – Variáveis Controladas (y1 – WABT [ºC]; y2 – Enxofre 

[ppm]; y3 – Total de Instáveis [m
3/d])......................................................................................92 

Figura 5.17 – Estudo de Caso 4 – Variáveis Controladas (y4 – Excesso de H2 [kNm
3/d]; 

y5 – Pressão de H2 para C-02  [kgf/cm
2]).................................................................................92 

Figura 5.18 – Estudo de Caso 4 – Variáveis Manipuladas (u1 – Carga [m
3/d]; u2 – Vazão de 

Instáveis [m3/d]; u3 – T. Saída do Forno [ºC])..........................................................................93 

Figura 5.19 – Estudo de Caso 4 – Variáveis Manipuladas (u4 – T. Entrada R1L2 [ºC]; u5 – T. 

Entrada R2L1 [ºC]; u6 – T. Entrada R2L2 [ºC]).......................................................................93 

Figura 5.20 – Estudo de Caso 4 – Evolução do Valor Total da Função Objetivo....................94 

Figura 5.21 – Estudo de Caso 5 – Variáveis Controladas (y1 – WABT [ºC]; y2 – Enxofre 

[ppm]; y3 – Total de Instáveis [m
3/d])......................................................................................95 

Figura 5.22 – Estudo de Caso 5 – Variáveis Controladas (y4 – Excesso de H2 [kNm
3/d]; 

y5 – Pressão de H2 para C-02  [kgf/cm
2])..................................................................................96 

Figura 5.23 – Estudo de Caso 5 – Variáveis Manipuladas (u1 – Carga [m
3/d]; u2 – Vazão de 

Instáveis [m3/d]; u3 – T. Saída do Forno [ºC])..........................................................................97 

Figura 5.24 – Estudo de Caso 5 – Variáveis Manipuladas (u4 – T. Entrada R1L2 [ºC]; u5 – T. 

Entrada R2L1 [ºC]; u6 – T. Entrada R2L2 [ºC]).......................................................................97 

Figura 5.25 – Estudo de Caso 5 – Evolução do Valor Total da Função Objetivo....................98 

Figura 5.26 – Estudo de Caso 6 – Variáveis Controladas (y1 – WABT [ºC]; y2 – Enxofre 

[ppm]; y3 – Total de Instáveis [m
3/d])......................................................................................99 

Figura 5.27 – Estudo de Caso 6 – Variáveis Controladas (y4 – Excesso de H2 [kNm
3/d]; 

y5 – Pressão de H2 para C-02  [kgf/cm
2])................................................................................100 

Figura 5.28 – Estudo de Caso 6 – Variáveis Manipuladas (u1 – Carga [m
3/d]; u2 – Vazão de 

Instáveis [m3/d]; u3 – T. Saída do Forno [ºC])........................................................................100 

Figura 5.29 – Estudo de Caso 6 – Variáveis Manipuladas (u4 – T. Entrada R1L2 [ºC]; u5 – T. 

Entrada R2L1 [ºC]; u6 – T. Entrada R2L2 [ºC]).....................................................................101 

Figura 5.30 – Estudo de Caso 6 – Evolução do Valor Total da Função Objetivo..................101 

 



 
 

9 
 

ÍNDICE DE TABELAS 
 
 
Tabela 5.1 – Modelos de Processo em Função de Transferência Contínua..............................76 

Tabela 5.2 – Estudo de Caso 4 – Modelos de Processo em Função de Transferência 

Contínua....................................................................................................................................91 



 
 

10 
 

Resumo 
 
Neste trabalho é abordado o problema de controle e de otimização de unidades industriais de 
hidrotratamento de diesel (UHDT) por controladores MPC (Model Predictive Control). É 
apresentado um breve histórico dos controladores MPC convencionais e de horizonte infinito 
(IHMPC), bem como uma breve descrição do processo de Hidrotratamento de Diesel e das 
particularidades da aplicação do controle de processos a este tipo de planta industrial. 
 
Em seguida foi gerado, passo a passo, um algoritmo de controle que sumarizou e agregou 
características de vários controladores MPC disponíveis na literatura aberta, em especial os 
que foram desenvolvidos ao longo dos últimos anos pelo laboratório de simulação e controle 
da USP (LSCP), a fim de se obter um algoritmo adequado para a solução do problema de 
controle abordado. Em ambiente computacional de simulação, o algoritmo resultante 
possibilitou controlar e otimizar simultaneamente processos contínuos, sendo capaz de 
estabilizar a planta industrial de forma robusta e, ao mesmo tempo, aumentar a lucratividade 
de sua operação. 
 
Para tanto, foi desenvolvida uma “função objetivo” econômica que aumentou a conversão da 
carga bruta em produtos hidrotratados e minimizou o consumo de insumos, sendo que essa 
correlação foi agregada ao algoritmo de controle. As simulações permitiram que as estratégias 
de controle previamente discutidas pudessem ser testadas e seus resultados apresentados e 
debatidos. 
 
 
 
 
 
Palavras-chave: Controle Preditivo Baseado em Modelos (MPC), Unidades de 
Hidrotratamento de Diesel, Hidrorefino de Petróleo. 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 



 
 

11 
 

Abstract 
 
This work addresses the control and optimization problem of industrial diesel hydrotreating 
units (UHDT) by MPC controllers (Model Predictive Control). It is presented a brief 
historical of conventional MPC controllers and infinite horizon controllers (IHMPC), as well 
as a brief description of the Diesel Hydrotreating process and the particulars of the application 
of process control for this type of industrial plant. 
 
It was then generated, step by step, one algorithm that summarized and aggregated control 
characteristics of various MPC controllers available in the open literature, in particular those 
that have been developed over the past few years by USP’s laboratory of simulation and 
control of (LSCP), in order to obtain an algorithm suitable for solving the addressed control 
problem. In a computational simulation environment, the resulting algorithm allowed to 
simultaneously control and optimize continuous processes, being able to robustly stabilize the 
industrial plant and at the same time increase the profitability of its operation. 
 
For this purpose, an "objective function" was developed which increased the economic 
conversion of crude feed to hydrotreated product and minimized the consumption of raw 
materials, and this correlation was added to the control algorithm. The simulations allowed 
that the previously discussed control strategies could be tested and the results presented and 
discussed. 
 
 
 
Keywords: Model Predicted Control (MPC), Diesel Hydrotreating Units, Petroleum 
Hydrorefining. 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 



 
 

12 
 

 
 

Lista de Símbolos 

 

Símbolos Latinos 

 

A  matriz característica do modelo incremental em malha aberta 

*A  matriz A  modificada que limita predições das saídas no infinito 

A%  matriz característica do modelo posicional em malha aberta, em função de A, C, p e m 

~

AB  matriz auxiliar em função de A , B  e m  

B  matriz de distribuição das entradas do modelo incremental em malha aberta 

B%  matriz de distribuição das entradas do modelo posicional em malha aberta 

C  matriz das saídas do sistema, com base no modelo incremental 

fC  matriz auxiliar da função objetivo dos problemas de programação quadrática 

C%  matriz das saídas do modelo posicional 

C  matriz auxiliar em função de A , C  e np  

C
==

 matriz auxiliar em função de A , B , C , m  e np  

c  gradiente da função objetivo dos problemas de programação quadrática 

0D  matriz dos ganhos de regime permanente 

0
mD  matriz 

0D  estendida ao longo do horizonte de controle 

dD  matriz dos resíduos de regime permanente 

D%  matriz auxiliar em função de 0D , m  e t?   

d  coeficientes obtidos pela expansão em frações parciais de ( )zG ji,  

e  erro entre uma dada saída y qualquer e seu valor de referência spy  

F  matriz incremental do regime transiente do sistema 

uF  matriz auxiliar em função de 
dD , F  e N  

xF  matriz auxiliar em função de F  

G  matriz auxiliar em função de 0D , F  e N  

G  matriz auxiliar em função de 0D , ? , F  e N  

( )zG  matriz das funções de transferência entre as saídas e as entradas 



 
 

13 
 

( )zG ji,  função de transferência entre uma saída i  e uma entrada j  
H  matriz Hessiana da função objetivo dos problemas de programação quadrática 

I  matriz identidade 

nyI  matriz identidade de dimensão nyxny 

nuI  matriz identidade de dimensão nuxnu 

muI  matriz auxiliar u
sp ao longo de m 

I  matriz auxiliar de ysp ao longo de p 

I  matriz auxiliar das variáveis de folga sk?  ao longo do horizonte de controle 
sp

I  matriz auxiliar de ysp ao longo de p e estendido para os estados 

J  matriz auxiliar em função de nu  e na  

k  instante qualquer de tempo discreto 

FK  ganho do observador de estados (Filtro de Kalman) 

L  matriz auxiliar em função de ? e F  

M  matriz auxiliar para spy ?  

L  matriz L  estendida ao longo do horizonte de controle   

m  horizonte de controle das variáveis manipuladas 

N  matriz auxiliar usada na resposta do sistema ao degrau 

N
~

 matriz auxiliar quando da consideração de referências para as entradas 

,i jna  número de pólos da função de transferência entre a saída iy  e a entrada ju  

nd  número de estados  

np  horizonte de predição finito das variáveis controladas 

nu  número de entradas (variáveis manipuladas) 

ny  número de saídas (variáveis controladas) 

P  matriz auxiliar do Filtro de Kalman em função de A , C , V  e W  

Potim  peso da função objetivo econômica 

Q  matriz de Lyapunov 

Q  matriz de ponderação das variáveis controladas 

Q%  matriz Q  estendida ao longo de um horizonte definido m ou np  

Qu  matriz de ponderação das entradas manipuladas 

R  matriz de supressão das variáveis manipuladas 



 
 

14 
 

R%  matriz R  estendida ao longo do horizonte de controle 

r  pólo de uma função de transferência 

 S respostas ao degrau do sistema 

kS  matriz dos coeficientes da resposta ao degrau referente ao instante de tempo k  

1S  matriz de ponderação das variáveis de folga 
s
k?  

Su  matriz de ponderação das variáveis de folga das entradas 

t  tempo 

T  matriz auxiliar das variáveis de folga ik?  ao longo do horizonte de controle 

T período de amostragem do controlador preditivo 

u  vetor das variáveis manipuladas 

umax vetor de valores máximos para as variáveis manipuladas 

umin vetor de valores mínimos para as variáveis manipuladas 

U  espaço da região viável de solução das variáveis manipuladas 

usp  referências ou “targets” para as entradas manipuladas 

V  matriz de sintonia do filtro de Kalman 

kV  função custo do algoritmo de controle num dado instante de tempo k  

x  vetor de estados do modelo, [ ]Tds xxx =  
[ ]

/ 1k k
x

?
vetor de estados no instante k  com informações da planta do instante anterior 

[ ]
/k k

x   vetor atualizado dos estados com informações da planta do instante atual 

sx  vetor de estados integradores gerado pela forma incremental do modelo 

dx  vetor de estados estáveis do modelo 

y  vetor das variáveis controladas 

max,iy  limite máximo para a saída i 

min,iy  limite mínimo para a saída i 

spy  vetor de referência (setpoints) das variáveis controladas 

1
spy  vetor estendido de setpoints das variáveis controladas 

p
ky  vetor de saídas da planta medidas no instante k  

spy ?  vetor de referências para as saídas controladas ao longo de p 

W  matriz de sintonia do filtro de Kalman 



 
 

15 
 

Símbolos Gregos 

 

?  operador diferença 

?u  vetor de variações nas variáveis manipuladas 

?u,max  vetor de variações máximas nas variáveis manipuladas 

?u,min  vetor de variações mínimas nas variáveis manipuladas 

?  matriz da parcela dinâmica associada aos estados transientes  

?  matriz auxiliar para a atualização dos estados 

?  autovalores de uma matriz quadrada 

?  constante de tempo de um sistema de primeira ordem (domínio de Laplace) 

?  matriz dos tempos mortos do sistema 

,i j?  tempo morto entre uma saída i  e uma entrada j  

s
k?  variáveis de folga num dado instante de tempo k , relacionadas aos pólos   

            integradores criados pela forma incremental do modelo 

 

Siglas 

 

DCS  Digital Control System 

DMC  Dynamic Matrix Control 

IHMPC Infinite Horizon Model Predictive Control 

MIMO  Multi-Input Multi-Output 

MPC  Model Predictive Control 

OPOM  Output Prediction Oriented Model 

QDMC Quadratic Dynamic Matrix Control 

QP  Quadratic Programming 

RMPCT  Robust MPC Technology 

ROSSMPC Reducer Order State Space MPC 

SISO  Single-Input Single-Output 

 

Sobrescritos 

T operação de transposição de uma matriz. 

SP  “setpoint” 



 
 

16 
 

SUMÁRIO 

 
1 – Introdução e Objetivos.....................................................................................................18 

1.1 – Introdução aos Controladores MPC............................................................................18 

1.2 – O Desenvolvimento dos Controladores MPC de Estabilidade garantida.................21 

1.3 – Novas aplicações dos controladores MPC...................................................................24 

1.4 – Introdução ao Processo de Hidrotratamento..............................................................25 

1.4.1 – A Unidade de Hidrotratamento de Diesel da RPBC................................................26 

1.4.2 – Seção de Reação e Reciclo de H2...............................................................................29 

1.5 – Introdução ao Problema de Controle de Unidades de Hidrotratamento de 

Diesel........................................................................................................................................30 

2 – Modelos de Processo para Controladores MPC.............................................................32 

2.1 – Apresentação de um Modelo em Variáveis de Estado para Sistemas 

Integradores.............................................................................................................................32 

2.1.1 – Sistema “MIMO” de Funções de Transferência......................................................32 

2.1.2 – Modelo de Resposta ao degrau..................................................................................32 

2.2 – Modelo em Variáveis de Estado para Sistemas sem Tempo Morto..........................35 

2.3 – Modelo em Variáveis de Estado para Sistemas com Tempo Morto..........................37 

3 – Controlador IHMPC.........................................................................................................39 

3.1 – Controlador IHMPC com variáveis de folga...............................................................44 

3.2 – IHMPC Estendido para Sistemas com Tempo Morto................................................46 

3.3 – Observador de Estados..................................................................................................53 

4 – Otimização Integrada ao Controlador Preditivo...........................................................55 

4.1 - MPC convencional em duas Camadas - Camada de Otimização de Estado 

Estacionário.............................................................................................................................58 

4.2 – IHMPC Estendido com Controle por Zonas e Targets para as 

Entradas...................................................................................................................................61 



 
 

17 
 

4.3 – IHMPC Estendido com Funnel.....................................................................................63 

4.4 - Integração da Otimização Online ao Controle Preditivo ...........................................67 

4.5 – IHMPC - Estendido com “Funil” e Otimizador Online com Targets.......................69 

5 – Estudo de Caso – Simulação de uma UHDT..................................................................75 

5.1 - Otimização Online para a UHDT .................................................................................77 

5.2 – Simulações e Resultados................................................................................................78 

5.2.1 – Estudo de Caso 1 ........................................................................................................80 

5.2.2 – Estudo de Caso 2 ........................................................................................................84 

5.2.3 – Estudo de Caso 3 ........................................................................................................88 

5.2.4 – Estudo de Caso 4.........................................................................................................91 

5.2.5 – Estudo de Caso 5.........................................................................................................95 

5.2.6 – Estudo de Caso 6 ........................................................................................................98 

6 – Conclusões........................................................................................................................102 

7 – Referências Bibliográficas..............................................................................................104 

 

  



 
 

18 
 

1 – Introdução e Objetivos 

O objetivo deste trabalho é apresentar os problemas de controle e de otimização de unidades 

industriais de hidrotratamento de diesel (UHDT) e propor uma solução para os mesmos 

através do uso de controladores MPC (Model Predictive Control). A solução proposta 

abordará, simultaneamente, ambos os problemas de controle e otimização num único 

algoritmo, cumprindo a funções de promover a estabilidade da planta e melhorar sua 

rentabilidade. 

 

Neste primeiro capitulo será apresentado um breve histórico dos controladores MPC 

convencionais e de horizonte infinito (IHMPC), bem como uma breve descrição do processo 

de Hidrotratamento de Diesel e das particularidades da aplicação do controle de processos a 

este tipo de planta industrial. No segundo capitulo são discutidos diversos modelos de 

processos em variáveis de estado que serão utilizados ao longo do presente trabalho. Em 

seguida, no terceiro capítulo, é feita uma revisão sobre os fundamentos dos controladores 

IHMPC, bem como sobre observadores de estado e o filtro de Kalman. 

 

No quarto capítulo, é realizada uma breve revisão dos conceitos de otimização de processo e 

das formas disponíveis de implementá-los. Ainda no quarto capítulo são apresentados o 

controle MPC por zonas e o controle “Funnel”. E em seguida foi gerado, passo a passo, um 

algoritmo de controle MPC que agregou todas as características apresentadas até então.  

 

No quinto capítulo, são apresentados seis diferentes estudos de caso baseados num modelo de 

processo real de uma unidade UHDT. Por meio de simulações em ambiente computacional, o 

algoritmo foi testado e seus efeitos avaliados. 

 

 

1.1 – Introdução aos Controladores MPC 

 

Marlin (2000) apresenta os controladores preditivos baseados em modelo, ou MPC (Model 

Predictive Control), como sendo algoritmos de controle desenvolvidos para estabilizar plantas 

de processos multivariáveis, permitindo que estas operem mais próximas das suas restrições, 

sejam estas restrições na qualidade dos produtos ou restrições derivadas dos limites de 

operação dos equipamentos.  



 
 

19 
 

Pode-se citar como exemplo de restrição referente à qualidade do produto o “ponto de 

congelamento” do querosene de aviação, que deve ser uma temperatura baixa o bastante para 

que o combustível não congele durante um voo. Como restrição que surge a partir de limites 

de operação dos equipamentos se pode citar a temperatura máxima da tubulação de um forno 

industrial, ou “skin point”. O valor máximo dessa variável é dado pelo limite metalúrgico do 

aço utilizado na construção do tubo. 

 

Uma discussão sobre as vantagens e desvantagens dos controladores MPC pode ser 

encontrada em Campos, Teixeira, Liporace e Gomes (2009), e de forma resumida pode-se 

listar suas principais características como sendo as seguintes: 

 

- Multivariáveis: ao contrário dos clássicos controladores PID, que são capazes de manipular 

apenas uma variável e controlar outra variável, os MPC podem manipular diversas variáveis, 

buscando manter todo um conjunto de controladas nos seus “setpoints”, ou ainda dentro de 

faixas toleráveis, na medida em que esse objetivo seja numericamente possível. 

 

- Preditivos: os MPC possuem modelos dinâmicos do processo que descrevem o 

comportamento esperado de todas as variáveis controladas em relação a variações ou 

distúrbios em todas as variáveis manipuladas, ao longo de um dado período de tempo. 

Também levam em conta os distúrbios medidos antes que estes afetem as demais variáveis de 

processo. 

 

 

- Otimizam a operação da planta: uma vez que uma ou mais variáveis controladas estejam 

dentro de seus limites toleráveis, ou seja, o “controle por zonas” esteja sendo implementado 

com sucesso, um controlador MPC comum não irá tomar ações de controle relacionadas a 

estas variáveis, e estas irão oscilar livremente enquanto estiverem dentro de sua zona 

permitida. Ou seja, o controlador permanecerá ocioso e irá atuar apenas quando as variáveis 

controladas infringirem os limites de zona. Nessas condições, haverá graus de liberdade 

disponíveis para a utilização por algoritmos de otimização econômica integrados aos 

controladores MPC.  

 



 
 

20 
 

Em geral, a otimização se dá ao se aproximar as controladas dos seus limites, na medida do 

possível sem, contudo, ultrapassá-los. O mesmo vale para as manipuladas. Muitas vezes há 

ganho econômico em se minimizar ou maximizar uma variável manipulada. Por exemplo, se a 

carga de uma planta de processo for uma manipulada, em geral têm-se um ganho em mantê-la 

no maior patamar possível. Da mesma forma, se a concentração de uma dada substância numa 

corrente de processo é uma variável controlada e possui um valor mínimo que deve ser 

respeitado, e esta restrição limita a vazão total desta corrente, um algoritmo de otimização irá 

reduzir a variável controlada ao menor valor possível. Em geral o MPC deverá ser 

configurado de modo a minimizar o consumo de energia da planta e maximizar a produção 

das correntes mais rentáveis. 

 

- Exigem uma hierarquização das variáveis controladas: muitas vezes não é 

numericamente possível manter todas as variáveis dentro dos limites o tempo todo, portanto 

atribuímos pesos e se prioriza as variáveis críticas. 

    

- Utilizam Algoritmos de Otimização: a cada instante de amostragem, ou passo, um 

problema de otimização é solucionado, gerando vetores de novos valores que serão atribuídos 

às manipuladas no instante presente e nos próximos. 

 

 

A implantação de um MPC é complexa: O projeto de implantação deve se adequar à 

estrutura de hardware computacional onde os algoritmos serão executados e sua interligação 

com os sistemas de automação e controle da planta de processo. 

 

Deve ser definido claramente qual é o problema de controle a ser resolvido, para a partir daí 

se selecionar as variáveis manipuladas, controladas e distúrbios, e suas respectivas faixas 

operacionais, pesos e como otimizá-las. Definidas as variáveis, levanta-se o modelo do 

processo através de testes em degrau ou pulso nas variáveis manipuladas e nos distúrbios. 

 

A partir daí é escolhida uma “função objetivo” que será minimizada a cada passo pelo 

algoritmo de otimização. Os pesos de variáveis são ajustados de forma a se obter movimentos 

suaves nas manipuladas. Interliga-se o MPC aos sistemas de controle e são realizados novos 

testes e ajustes finais. 



 
 

21 
 

Camacho e Bordons (2007) enumeram as principais vantagens dos controladores MPC como 

sendo: 

• Simplicidade conceitual; 

• Aplicabilidade para um grande número de processos, inclusive com longos tempos 

mortos, sistemas de fase não mínima e processos instáveis; 

• Facilidade em lidar com o caso multivariável e compensação intrínseca de tempos 

mortos; 

• Introduzem controle antecipatório de forma a compensar distúrbios medidos; 

• Totalmente baseados em metodologias abertas que permitem extensões futuras. 

 

Camacho e Bordons (2007) também discutem as possíveis desvantagens dos controladores 

MPC, destacando a maior exigência de tempo computacional para calcular as ações de 

controle como uma restrição considerável à formulação de algoritmos, bem como a 

necessidade de um modelo de processo apropriado para o sistema. Camacho e Bordons 

argumentam que os benefícios obtidos pela implementação do controlador MPC são 

reduzidos pelo grau de incerteza ou imperfeição do modelo de processo, ou seja, a diferença 

entre os parâmetros de um modelo ideal que descreveriam perfeitamente o comportamento da 

planta e os parâmetros do modelo real. 

 

 

1.2 – O Desenvolvimento dos Controladores MPC de Estabilidade garantida  

 

O primeiro controlador do tipo MPC foi proposto por Cutler e Ramaker (1979), e foi chamado 

de Dynamic Matrix Control, ou DMC. O método era baseado em “horizontes de predição” 

finitos e em modelos de coeficientes de resposta ao degrau e ao impulso. 

 

Vetores com esses coeficientes para cada par de variável controlada e manipulada eram 

agrupados em matrizes, que adquiriam grandes dimensões, pois era necessária a inclusão de 

coeficientes até a estabilização total do sistema. Para modelos desse tipo, a solução dos 

problemas de controle de sistemas com grande número de variáveis exigia um esforço 

computacional relevante - mesmo para os dias de hoje.  O resultado desse trabalho foi uma 

aplicação bastante eficaz para sistemas estáveis, mas com limitações como, por exemplo, para 

o uso em sistemas instáveis ou integradores.  



 
 

22 
 

Garcia e Morshedi (1986) aperfeiçoaram o DMC desenvolvendo o controlador QDMC, 

baseado em programação quadrática que requer menor esforço computacional. A partir dos 

anos 90 os modelos com realização em “espaço de estados” passaram a ser predominantes na 

produção científica relacionada ao tema de controle preditivo multivariável, e os modelos 

baseados em coeficientes de resposta não receberam mais atenção. 

 

Um artigo seminal que apresentou o desenvolvimento de controladores MPC de estabilidade 

garantida foi apresentado por Rawlings e Muske (1993), demonstrando que se o “horizonte de 

predição” das variáveis controladas tender ao infinito, a estabilidade do sistema estará 

garantida independentemente dos parâmetros de sintonia utilizados. Esse algoritmo de 

controle foi denominado “Infinite Horizon Model Predictive Control”, ou IHMPC, e consistia 

em se obter o equivalente a um MPC de horizonte de predição finito pela introdução de um 

peso terminal que é obtido pela solução de uma equação de Lyapunov. 

 

Odloak (1996) e Gouvêa e Odloak (1997) apresentaram uma formulação alternativa para os 

modelos de processo de resposta ao degrau e que se mostrou mais compacta que as 

encontradas tradicionalmente. Ao invés de se usar, como antes, extensos vetores de dados, 

esta formatação fez uso dos parâmetros das funções de transferência para gerar modelos em 

variáveis de estado de ordem reduzida, que requerem menor tempo computacional. Esse 

formato foi chamado de Reduced Order State Space MPC, ou ainda ROSSMPC.  

 

Combinando essas diferentes abordagens no intuito de se criar um controlador garantidamente 

estável, Rodrigues e Odloak (2003) desenvolveram uma formulação alternativa para o MPC 

de horizonte infinito, baseada no ROSSMPC. Sua principal vantagem em relação ao 

controlador de Rawlings e Muske (1993) foi a extensão para sistemas não quadrados, ou seja, 

sistemas de diferente número de manipuladas e controladas para o caso de "output tracking" 

pois o IHMPC de Rawlings e Muske (1993) resolvia apenas o problema regulador. 

 

A partir do trabalho de Rodrigues e Odloak (2003), Carrapiço (2004) expandiu o IHMPC de 

estabilidade nominal para processos com variáveis de características integradoras e com 

tempo morto, utilizando um filtro de Kalman para a estimativa dos estados do modelo a partir 

das saídas da planta. 

 



 
 

23 
 

Novos trabalhos baseados em controladores MPC de estabilidade garantida, ou controladores 

nominalmente estáveis,  seguem aparecendo desde então na literatura (Carrapiço &amp;amp; Odloak, 

2005; González &amp;amp; Odloak, 2009), chegando a ser implementados com sucesso na prática 

(Carrapiço, Santos, Zanin, Odloak, 2009; Schnelle, Lamon, Badgwell, 2007). 

 

Para lidar com modelos que apresentam incerteza, ou seja, quando o modelo do processo a ser 

controlado não é conhecido com boa precisão, outras abordagens de controladores MPC de 

estabilidade garantida têm sido propostas, tendo-se obtido êxito ao lidar com certas classes de 

incerteza (Badgwell, 1997; Kothare, Barakrishnan &amp;amp; Morari , 1996; Lee &amp;amp; Yu, 1997;  Mayne, 

Rawlings, Rao &amp;amp; Scokaert, 2000; Odloak, 2004; Ralhan &amp;amp; Badgwell, 2000; Rodrigues &amp;amp; 

Odloak, 2003). Pelo menos uma dessas propostas pôde ser aplicada na pratica sem maiores 

dificuldades (Porfirio, Neto &amp;amp; Odloak, 2003). 

 

Paralelamente, prosseguiu o desenvolvimento de controladores comerciais por empresas tais 

como a empresa de automação Honeywell, que possui um controlador proprietário chamado 

Robust Model Predictive Control Technology, ou RMPCT, que surgiu a partir da mescla do 

antigo RMPC, também da Honeywell, com o PCT, que era da Profimatic, empresa adquirida 

pela Honeywell em 1995, no processo que deu origem a Honeywell Hi-Spec Solutions. O 

RMPCT, ou Profit® Controller, o nome com o qual vem sendo comercializado possui uma 

característica inovadora que é o controle por funis (“funnel”). Quando uma determinada 

variável está fora de seu limite, ao invés de computar o erro total em relação ao valor desejado 

e usar esse valor na função objetivo, esse controlador cria uma rampa entre o valor desejado e 

o valor onde a variável se encontra e calcula o erro em relação a essa rampa. A vantagem seria 

liberar alguns graus de liberdade que poderiam ser utilizados para otimização, além de obter 

ações de controles mais suaves. 

 

Pacheco (2009) agregou o controle por funis ao IHMPC com modelo variáveis em estado, 

com características integradoras e com tempo morto. 

 

 

 

 

 



 
 

24 
 

1.3 – Novas aplicações dos controladores MPC 

 

O Controle Preditivo Baseado em Modelos, ou MPC, tem sido desenvolvido continuamente 

por mais de 30 anos e dessa forma já não pode mais ser considerado uma novidade na área de 

controle de processos.  

 

Ainda assim, inovações continuam surgindo ao se aplicar esta ferramenta a diferentes 

processos industriais contínuos, após se esgotarem os alvos mais evidentes para seu uso. Por 

exemplo, controladores MPC foram recentemente utilizados em unidades de refino de 

petróleo nas quais antes não se enxergava a possibilidade de ganhos no seu uso. Após nova 

análise, esses processos passaram a ser vistos como detentores de grande potencial de ganhos 

em lucratividade, estabilidade e segurança a partir da concepção e implantação de novas 

estratégias de controle. 

 

Um destes casos é o das Unidades de Hidrotratamento de Diesel, ou UHDT, que nos últimos 

anos vêm se multiplicando no parque de refino brasileiro devido às novas normas ambientais 

e requisitos de qualidade para combustíveis, com o novo protocolo legal (PROCONVE - 

programa controle poluição ar veículos automotores) atualmente em fase final de implantação 

no País. No Brasil, o primeiro controlador MPC de uma UHDT que contemplou uma 

estratégia de controle completa para a “Seção de Reação” da unidade foi implementado na 

UHDT da RPBC, em Cubatão, São Paulo, uma refinaria de petróleo pertencente à Petrobras.  

 

Essa aplicação utiliza uma ferramenta de controle comercial e proprietária, o “Profit 

Controler” da Honeywell, cujas características são conhecidas de forma qualitativa, mas cujo 

equacionamento e algoritmos são proprietários e não abertos e, portanto, desconhecidos. 

Dessa forma, a despeito desta ser inegavelmente uma ferramenta bastante completa e bem 

sucedida, os usuários do “Profit Controler” não possuem entendimento integral do seu 

funcionamento e normalmente são incapazes de alterar as características de seu algoritmo, o 

que restringe as possibilidades de inovação ao se trabalhar com este controlador comercial. Os 

demais produtos disponíveis no mercado possuem limitações semelhantes.  

 

 

 



 
 

25 
 

1.4 – Introdução ao Processo de Hidrotratamento 

 

Meyers (2003) descreve o hidrotratamento como sendo um processo de refino de petróleo no 

qual o enxofre é removido de uma corrente de processo pela passagem dessa corrente por um 

leito de catalisador em presença de hidrogênio. Nesse processo, em geral, não se verifica uma 

redução significativa do tamanho das cadeias moleculares.  

 

O Hidrotratamento também é utilizado na redução do teor de compostos nitrogenados, para 

saturar as olefinas e para reduzir o teor de aromáticos. O enxofre é o mais fácil de remover, 

seguido pela remoção dos nitrogenados e pela saturação de cadeias aromáticos. A saturação 

de olefinas e a remoção de enxofre e nitrogênio se dão ao mesmo tempo. A pressão parcial de 

hidrogênio é o fator fundamental neste processo, e seus valores requeridos variam conforme 

as características da corrente a ser tratada, ou seja, depende da complexidade de suas cadeias 

moleculares. Segundo Meyers (2003), para um petróleo relativamente leve (grau API superior 

a 30), a pressão parcial de hidrogênio oscila, por exemplo, numa faixa de 5 kgf/cm2 a 7 

kgf/cm2 para a nafta obtida por destilação atmosférica, chegando até 25 kgf/cm2 a 50 kgf/cm2 

para um gasóleo de vácuo.  

 

Correntes advindas de processos de craqueamento exigem mais hidrogênio que correntes 

“virgens” com mesmo intervalo de temperaturas de ebulição. As temperaturas empregadas 

estão geralmente no intervalo de 330 ºC a 400 ºC.  

 

O consumo de hidrogênio varia de 0 - 1,5 m3 H2/bbl para nafta destilada, até 10 m
3 H2/bbl 

para o gasóleo pesado. Mais uma vez, correntes craqueadas requerem maiores quantidades de 

hidrogênio. Quando se deseja também reduzir nitrogenados, pode ser necessário algo entre   

15 - 35 m3 H2/bbl.  

 

A corrente de alimentação é combinada com o reciclo e a reposição de hidrogênio e aquecida 

em um forno e depois segue para um reator catalítico de leito fixo. O efluente do reator passa 

então para um vaso de alta pressão, onde é separado em uma fase líquida e uma corrente de 

reciclo de hidrogênio. Um fluxograma simplificado do processo de hidrogenodessulfurização 

é mostrado abaixo (ver Meyers (2003)): 

 



 
 

26 
 

 

 

Figura 1.1 – Esquema simplificado de uma UHDT 

 

 

 A corrente líquida de alta pressão segue para um vaso separador de baixa pressão onde ocorre 

um “flash”, produzindo uma corrente gasosa e uma nova corrente líquida, que alimenta uma 

torre de fracionamento. 

 

 O gás é enviado para uma planta de tratamento para a recuperação de enxofre e 

hidrocarbonetos e o líquido é fracionado em produto com hidrotratado e substâncias de menor 

ponto de ebulição produzidas na reação. 

 

 

1.4.1 – A Unidade de Hidrotratamento de Diesel da RPBC 

 

Este trabalho se baseou numa unidade de processo real, a Unidade de Hidrotratamento de 

Diesel da Refinaria RPBC da Petrobras, em Cubatão (U-22313), que processa 6.000 m3/d de 

uma mistura de diesel pesado, óleo leve de FCC (LCO) e gasóleo leve de Coque (LGO). A 

Figura 1.2 mostra um fluxograma de processo simplificado para a unidade. 

 



 
 

27 
 

O diesel pesado e o LCO são misturados e aquecidos no permutador P-01A/B antes de 

entrarem em uma torre retificadora de O2, T-01, a fim de minimizar o oxigênio dissolvido, 

que é prejudicial ao catalisador.  

 

A corrente de LGO é adicionada junto à saída do fundo da retificadora.  A alimentação 

combinada, misturada com reciclo de gás e com a reposição de hidrogênio, é aquecida pelo 

efluente do segundo reator nos permutadores P-03 e P-04, passa pelo forno F-01 e, em 

seguida, entra no primeiro dos dois reatores, R-01 e R-02. 

 

Ambos os reatores possuem 2 leitos catalíticos. A temperatura de entrada do primeiro leito é 

controlada na saída do forno F-01, enquanto que as temperaturas nas saídas dos leitos são 

controladas com "quenches" de gás de reciclo. O efluente do reator R-02 é resfriado pela 

alimentação da retificadora de H2S , T-02, no permutador P-05 e pela corrente de entrada do 

forno F-01 nos permutadores P-03 e P-04 e pelo efluente do vaso separador de baixa pressão, 

V-04, no permutador P-06A/B antes de entrar no V-02, o vaso separador de baixa pressão. 

Gás rico em H2 vai para o compressor de reciclo, C-01, cuja pressão de sucção é controlada 

pela velocidade do compressor alternativo de reposição de H2, C-02. 

 

A fração líquida do separador de alta pressão V-02 é “flasheada” no separador de baixa 

pressão V-04, onde são geradas 3 correntes: corrente de gás contendo H2S, água ácida e uma 

corrente de hidrocarbonetos líquidos. Esta última é conduzida para a retificadora de H2S,      

T-02, onde vapor superaquecido é introduzido no fundo da torre para remover o H2S, H2 e 

hidrocarbonetos leves. A nafta instável, ou “wild naphtha”, é retirada do vaso de refluxo da 

torre T-02. O líquido do fundo flui para o sistema de secagem à vácuo a fim de remover a 

água. Pelo fundo da torre de vácuo, T-03, o óleo diesel hidrotratado vai para o sistema de 

tancagem da refinaria. 



 
 

28 
 

 

 

Figura 1.2 – Esquemático da UHDT da PETROBRAS - RPBC 



 
 

29 
 

1.4.2 – Seção de Reação e Reciclo de H2 

 

Neste trabalho será dado foco à seção de reação e reciclo de H2 da Unidade de HDT de 

Diesel.  

 

A carga da torre retificadora de O2 T-01 é constituída por Diesel vindo das unidades de 

destilação atmosférica e LCO. À corrente de fundo dessa torre é adicionado Gasóleo de 

Coque filtrado, e a corrente resultante é misturada com o fluxo de hidrogênio proveniente do 

compressor de gás de reciclo C-01 e com a reposição de gás vinda do compressor C-02 A/B. 

A corrente resultante é então aquecida nos permutadores P-03 A/C e P-04, trocando calor com 

os efluentes dos reatores de hidrogenação, sendo então aquecida no forno F-01. O efluente do 

forno, que é então uma corrente bifásica, alimenta os dois reatores de hidrotratamento, R-01 e 

R-02.  

 

A temperatura da entrada no reator é controlada manipulando-se a vazão de gás combustível 

queimado no forno. De modo a aumentar o tempo de campanha da unidade, diminuindo a 

inativação do catalisador, e para permitir um melhor controle da temperatura máxima no 

interior dos leitos catalíticos, o hidrogênio é injetado como "quench" entre os leitos 

catalíticos.  

 

Os efluentes dos reatores possuem elevada temperatura, e para ter seu calor aproveitado são 

divididos em duas correntes, uma delas aquecendo a carga da unidade pelo permutador P-04, 

e a outra aquecendo a alimentação da torre retificadora T-02, pelo permutador P-05. Depois 

de passar pelos trocadores, ambos os fluxos são misturados novamente, desta vez para pré-

aquecer a alimentação do reator, pelo permutador P-03. Finalmente, o efluente do reator, 

aquece a carga ainda fria da Torre Retificadora, no pré-aquecedor P-06. 

 

Finalmente, o efluente é resfriado com água de resfriamento no P-07, de onde segue ao vaso 

separador de alta pressão, V-02. 

 

O objetivo da UHDT é hidrotratar componentes de óleo cru na faixa de destilação do diesel, 

de maneira a adicioná-los ao pool de diesel da refinaria. O hidrotratamento irá melhorar as 

seguintes especificações: 



 
 

30 
 

• Teor de Enxofre; 

• Teor de Nitrogênio; 

• Índice de Cetano; 

• Estabilidade química para armazenamento. 

 

Um subproduto da UHDT é nafta instável ou “wild naphtha”, contaminada com H2S, que não 

pode ser incorporada em nenhum pool de produtos e, portanto, é encaminhada para tratamento 

em outras unidades da refinaria. O produto hidrotratado deve atender às seguintes 

especificações: 

 

• Remoção superior a 90% da massa de enxofre; 

• Estabilidade, conforme teste DuPont – F31; 

• Índice de Cetano (ASTM D976) – 48 (min). 

 

Nas seguintes situações pode ser necessário limitar a carga da UHDT: 

 

• Baixa pressão parcial de H2 ou baixa relação H2/Hidrocarboneto; 

• Porcentagem de abertura da válvula de reciclo do C-02 aproximando de 0%; 

• Pressão de sucção do compressor de make-up se aproximando do mínimo; 

• Taxa de reposição de H2 próxima do mínimo. 

 

O principal objetivo é maximizar a proporção de LCO na carga. Entretanto, a refinaria produz 

mais gasóleo de coque e LCO que a capacidade de processamento da UHDT. A torre 

retificadora de O2 é também utilizada como um vaso pulmão de carga. Gasóleo de coque é 

injetado na torre e usado como "quench" para controlar a temperatura de entrada na bomba. 

 

1.5 – Introdução ao Problema de Controle de Unidades de Hidrotratamento de Diesel 

Os objetivos de controle da unidade UHDT foram definidos visando à obtenção de máxima 

rentabilidade, observando os requisitos de qualidade do produto. Para tanto, a carga ou 

corrente de alimentação da unidade de processo deve ser composta preferencialmente por 

subcorrentes de menor valor comercial, de forma que o valor agregado pelo hidrotratamento 

seja maximizado. Também se deve minimizar o consumo de hidrogênio pelo processo, pois 



 
 

31 
 

este é um insumo caro de se produzir, sendo gerado com grande gasto energético a partir de 

gás natural. 

 

A massa de catalisador dos reatores de processo sofre aceleração no processo de desativação 

quando exposto a temperaturas demasiadamente altas ou variações bruscas de temperatura, 

reduzindo sua vida útil, sendo necessário, portanto, priorizar o controle da temperatura dos 

leitos catalíticos. Esse é talvez o maior beneficio advindo do controle MPC para unidades de 

hidrotratamento de diesel: a melhoria do controle da temperatura dos leitos catalíticos permite 

que a unidade de processo tenha “tempo de campanha” (período em que a ela opera entre 

paradas de manutenção) maior e reduz o consumo de catalisador ao reduzir sua taxa de 

desativação. Por fim, o produto final, o óleo diesel hidrotratado, deve se encontrar dentro de 

todas as especificações aplicáveis. Em especial, o teor de enxofre não deve ser superior à 

concentração máxima. 

 

Portanto, os objetivos de controle são listados a seguir: 

 

• Maximizar o volume total de hidrocarbonetos processados pela unidade; 

 

• Maximizar a proporção de correntes instáveis na carga (LCO + Gasóleo de Coque); 

 

• Coordenar a produção de hidrogênio de acordo com os requisitos da UHDT; 

 

• Minimizar a queima de H2 na tocha; 

 

• Manter a concentração de enxofre no diesel dentro das especificações, através de uma 

acurada inferência de cálculo desta propriedade; 

 

• Manter o perfil de temperaturas dos leitos catalíticos dos reatores dentro dos limites 

especificados pela operação da unidade. 

 

  



 
 

32 
 

2 – Modelos de Processo para Controladores MPC 

 

Neste capítulo será apresentada uma revisão do equacionamento dos controladores MPC de 

horizonte infinito ou “IHMPC”, e será formulado um novo controlador que agrega as 

características apresentadas para ser usado na solução do problema de controle de unidades 

UHDT. 

 

2.1 – Apresentação de um Modelo em Variáveis de Estado para Sistemas Integradores 

 

A proposta deste capítulo é apresentar o modelo dinâmico do processo que será empregado no 

desenvolvimento de um controlador IHMPC e que apresente características adequadas para 

promover os estudos propostos na seção introdutória deste trabalho. 

 

Esse modelo, que está em variáveis de estado na forma incremental e é denominado OPOM 

(Output Prediction Oriented Model) , foi desenvolvido por Odloak (1996). 

 

 

2.1.1 – Sistema “MIMO” de Funções de Transferência 

 

A formulação mais usual para modelos de processo são as funções de transferência. Para um 

dado sistema multivariável, com nu entradas e ny saídas, pode-se considerar que haverá uma 

função de transferência relacionando cada saída yi a cada entrada uj: 

 

 

            (2.1) 

 

 

2.1.2 – Modelo de Resposta ao degrau 

 

A partir da expansão em frações parciais da resposta ao degrau da função de transferência Gi,j 

pode-se chegar à uma formulação que descreve a resposta da saída yi a um degrau na entrada 

uj, no instante k. Se pudermos admitir que o sistema não possui pólos repetidos ou 



 
 

33 
 

integradores, a resposta do sistema apresentado em (2.1) ao degrau pode ser escrita na 

seguinte forma:         

( ) [ ] kl
na

l

d
ljijiji rddkS ?

=

+=
1

,,
0
,,      (2.2) 

 

Onde: 

 

 nalrl ,,2,1, K=   Polos do sistema; 

 

d
na

d
i ddd ,,,

0
K  Parâmetros obtidos através de expansão por frações 

parciais da função s
Gij

1?
 

 

A partir do instante k, uma predição da trajetória da saída yi pode ser obtida ao se somar os 

efeitos de todas as entradas da seguinte forma: 

 

( ) ( ) ( )??
= =

+=
nu

j

k
lji

na

l

d
lji

s
i rkxkxky

1
,,

1
,, , para i = 1, ... , ny 

 

De forma conveniente, define-se o vetor de estados como sendo composto por dois 

componentes: o vetor de estados integradores gerados pela forma incremental do modelo, xs, e 

o vetor de estados estáveis, xd. Sendo que, para este sistema os estados xs e xd são definidos 

como: 

 

( ) ( ) ( )?
=

?+=+
nu

j
jji

s
i

s
i kudkxkx

1

0
,1 , para i = 1, ... , ny 

 

( ) ( ) ( ), , , , , , , , , ,1d d di j l i j l i j l i j l i j l jx k r x k d r u k+ = + ? , para i = 1,..., ny; j = 1,..., nu; l = 1,..., na 
 

 

 



 
 

34 
 

?
?
?

?

?

?
?
?

?

?

?
0

,
0

1,

0
,1

0
1,1

0

nunyny

nu

dd

dd

D

K

MOM

K

nuxnyD ??0,

Para se obter predições para as trajetórias de todas as saídas, é conveniente apresentar o 

modelo “MIMO” na forma matricial, definindo-se os seguintes vetores para os estados: 

 

[ ]Tsnysss xxxx K21=  
 

 

 

 

Além das seguintes matrizes, que agregam os parâmetros obtidos através de expansão por 

frações parciais das funções de transferência, e os pólos: 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

Onde: . .nd ny nu na=  sendo que na é a ordem máxima das funções de transferência. 

 

( )d nanunyd nunyd nanydnyd nanudnud nadd dddddddddiagD ,,1,,,1,1,1,,,11,,1,1,11,1,1 KKKKKKK=
d nd x ndD ? ?

[ ]Td nanunyd nunyd nanydnyd nanudnud nadd xxxxxxxxx ,,1,,,1,1,1,,,11,,1,1,11,1,1 KKKKKKK=

nd x ndF ? ?

( )nanunynunynanynynanununa rrrrrrrrdiagF ,,1,,,1,1,1,1,,1,,1,1,11,1,1 KKKKKKK=



 
 

35 
 

 

 

Portanto, a representação em forma matricial dos estados xs e xd será: 

 

       ( ) ( ) ( )kuDkxkx ss ?+=+ 01      (2.3) 
 

    ( ) ( ) ( )kuNFDkxFkx ddd ?+=+ 1     (2.4) 
 

 

 

2.2 – Modelo em Variáveis de Estado para Sistemas sem Tempo Morto 

 

 

Camacho e Bordons (2008) argumentam que os modelos em variáveis de estado são 

provavelmente os mais amplamente empregados na comunidade acadêmica devido à sua 

simplicidade inerente, mesmo para o caso multivariável, e que a descrição por estados permite 

que se expressem facilmente critérios de estabilidade e robustez. 

 

As equações (2.3) e (2.4) correspondem a um modelo de variáveis de estado incremental, pois 

trabalha com a diferença entre os valores das variáveis manipuladas em instantes 

consecutivos. Ao contrário da chamada forma posicional, neste tipo de representação as 

variáveis envolvidas não são medidas como desvios em relação a um determinado estado 

estacionário, que por sua vez não necessita, portanto, ser determinado. O modelo pode ser 

colocado na forma: 

?
?
?
?
?

?

?

?
?
?
?
?

?

?

?

nyJ

J

J

N
M

2

1

nuxndN ??,

?
?
?
?
?
?
?
?
?

?

?

?
?
?
?
?
?
?
?
?

?

?

?

1000

1000

0001

0001

K

MOMMM

K

O

K

MOMMM

K

iJ

nyiJ nuxnanui ,...,2,1,
. =??



 
 

36 
 

 

( ) ( ) ( )kuBkxAkx ?+=+ 1         (2.5) 
 

( ) ( )kxCky =           (2.6) 
 

Nos estados definidos em (2.3) e (2.4), tem-se o vetor dos estados integradores gerados pela 

forma incremental do modelo, xs, e o vetor dos estados estáveis, xd. As equações (2.5) e (2.6) 

podem ser estritas como segue: 

 

( )
( )

( )
( )

( )ku
NFD

D

kx

kx

F

I

kx

kx
dd

s
ny

d

s

?
?
?
?

?

?
?
?

?
+

?
?
?

?

?
?
?

?
?
?

?
?
?

?
=

?
?
?

?

?
?
?

?

+
+ 0

0

0

1

1
 

 

 

 

Onde: 

( )

( )
( )

( )?
?
?
?

?

?

?
?
?
?

?

?

?

?
?

=?

kT

kT

kT

kT

nyL

MOMM

L

L

00

00

00

2

1

ndxny???,  

( ) [ ] ndirrrri kTnanuikTnuikTnaikTi eeeekT ???=? ,,,1,,,1,1,1, KKK , i = 1, 2, ..., ny 

Da mesma forma, pode-se reescrever o modelo de resposta ao degrau como segue: 

 

 

 

 

Onde T é o período de amostragem. Este modelo apresentado, denominado OPOM por 

Odloak (1996), consegue gerar o equivalente a um modelo de resposta ao degrau a partir dos 

parâmetros das funções de transferência. 

 

( ) ( ) NDkTDTS dk ?+= 0

( ) [ ] ( )
( )?
?
?

?

?
?
?

?
?=

kx

kx
Iky

d

s

ny



 
 

37 
 

2.3 – Modelo em Variáveis de Estado para Sistemas com Tempo Morto 

 

Gouvêa e Odloak (1997) estenderam o modelo OPOM para sistemas com tempo morto, 

criando o ROSSMPC (Reduced Order State Space MPC). Para sistemas com tempo morto, o 

controlador deve possuir um horizonte de predição grande o suficiente para abranger todos os 

atrasos ou tempos mortos das diversas entradas do processo: 

 

 

 

 

Onde: 

 

            o tempo morto entre a saída i e a entrada j; 

m  o número de ações de controle planejadas a partir do instante 

atual, k, para os instantes seguintes, conhecido como horizonte 

das ações de controle;  

 

A matriz abaixo contém os tempos mortos de todas as entradas do sistema: 

 

 

 

 

 

O seguinte estado é definido pelo ROSSMPC para sistemas com tempo morto: 

 

[ ] Tdsnpkkk xxyyyx +++= K21 , 1,nex ?? , ( )nanunpnyne .1. ++=  
 

As matrizes (2.5) e (2.6) foram reescritas para este caso na seguinte forma:  

 

( ){ }Tmnp ji /maxint ,?+?

ji,?

?
?
?

?

?

?
?
?

?

?

=

nunyny

nu

,1,

,11,1

??

??
?

L

MOM

L



 
 

38 
 

 
nenynunenene CBA ,,, ;; ??????  

 

Para k&gt;np, os coeficientes do modelo de resposta ao degrau podem ser obtidos pela seguinte 

equação ao longo do horizonte de predição: 

 

 

 

 

 

 

Onde, 

 

 

 

 

 

 

 

 

Este modelo será empregado ao longo deste trabalho por possuir as características desejadas 

para o estudo do problema de controle de unidades UHDT como, por exemplo, a forma 

compacta, utilização de parâmetros de funções de transferência e por incluir modelos de 

variáveis com tempo morto. 

( )[ ]

?
?
?
?
?
?
?
?
?
?

?

?

?
?
?
?
?
?
?
?
?
?

?

?

+?

=

F

I

TnpI

I

I

I

A

ny

ny

ny

ny

ny

00000

00000

10000

00000

00000

00000

L

L

L

L

MMMOMMM

L

L

?
?
?
?
?
?
?
?
?
?

?

?

?
?
?
?
?
?
?
?
?
?

?

?

=

+

FND

D

S

S

S

S

B

d

np

np

0

1

3

2

M

[ ]00 LnyIC =

( ) nunyd

knunyknykny

knukk

knukk

k NDkTD

SSS

SSS

SSS

S ,0

,,,2,,1,

,,2,2,2,1,2

,,1,2,1,1,1

???+=

?
?
?
?
?

?

?

?
?
?
?
?

?

?

=

L

MOMM

L

L

( )

( )
( )

( )

ndny

ny kT

kT

kT

kT ,
2

1

,

00

00

00

???

?
?
?
?
?

?

?

?
?
?
?
?

?

?

=?

?

?
?

L

MOMM

L

L

( ) [ ] nanuikTnanuikTnuikTnaikTii nuinuiii rrrrkT .,,1,,,1,1,1, ,,,1,1, ??= ???? ?? ???? KKK



 
 

39 
 

3 – Controlador IHMPC 

 

A lei de controle em um controlador MPC de horizonte infinito é dada pela solução de um 

problema de otimização que consiste na minimização da diferença, ou “erro”, entre as 

predições para as saídas do sistema ao longo de um horizonte infinito e as trajetórias futuras 

desejadas para cada saída, através da escolha de um conjunto adequado de valores para as 

variáveis manipuladas. 

Considere a seguinte função Objetivo: 

 

 

             (3.1) 

 

 

Onde: 

 

é o erro entre a predição das saídas e seus valores de   

referência, sendo que ( ) nykjke ??+ ; 
                                                      

é uma matriz definida positiva que serve de peso para 

ponderar o erro das variáveis controladas; 

                                                         

é uma matriz semi-definida positiva que serve de peso para 

ponderar o movimento das variáveis controladas; 

 

                                                        é um vetor de valores de referência das saídas (Set-Points). 

 

É útil separar o primeiro termo da função objetivo (3.1) em dois, um referente ao erro gerado 

nos instantes correspondentes ao horizonte de controle, e outro que computa o erro até o 

infinito. A função objetivo passa a ser: 

 

 

 

 

( ) ( ) ( ) ( )kjkuRkjkukjkeQkjkeJ
m

j

T

j

T

k +?+?+++= ??
?

=

?

=

1

01

( ) ( ) spykjkykjke ?+=+

nyxnyQ ??

nuxnuR ??

spy



 
 

40 
 

 

 

 

            (3.2) 

 

 

O segundo termo do lado direito de (3.2) pode ser desenvolvido como se segue: 

 

 

             (3.3) 

 

 

 

O termo                              não depende do índice j e, portanto, deve ser feito igual a zero para 

manter o valor da função objetivo limitado. Portanto, a solução do problema de controle deve 

se submeter à seguinte restrição: 

 

            (3.4) 

 

Incorporando essa restrição (3.4), o termo da somatória infinita da função objetivo pode ser 

simplificada como segue: 

 

 

            (3.5) 

 

 

 

O lado direito da equação (3.5) pode ser reduzido para um único termo: 

 

 

            (3.6) 

 

 

( ) ( )

( )( ) ( )( ) ( ) ( )kjkuRkjkuykjkxCQykjkxC

kjkeQkjkeJ

m

j

T

mj

spTsp

m

j

T

k

+?+?+?+?++

++=

??

?
?

=

?

+=

=

1

01

1

( )( ) ( )( )

( ) ( )( ) ( ) ( )( )?

?
?

=

?

+=

+???++???+

=?+?+

1

1

j

djspsTdjsps

mj

spTsp

kmkxFykmkxQkmkxFykmkx

ykjkxCQykjkxC

( ) sps ykmkx ?+

( ) 0=?+ sps ykmkx

( )( ) ( )( )

( ) ( ) ( )?

?
?

=

?

+=

+??+=

?+?+

1

1

j

djTTjTd

mj

spTsp

kmkxFQFkmkx

ykjkxCQykjkxC

( ) ( ) ( ) ( ) ( )kmkxQkmkxkmkxFQFkmkx dTd
j

djTTjTd ++=+??+?
?

=1



 
 

41 
 

Onde Q é a solução da seguinte equação de Lyapunov: 

 

 

      ,  

 

A função objetivo (3.2) se torna: 

 

 

 

 

 

 

É possível obter uma expressão mais simples para o objetivo de controle. Pode se demonstrar 

que: 

 

 

 

Aplicando as expressões acima para os passos de tempo dentro do horizonte de controle, 

obtém-se: 

 

 

Onde: 

 

( ) ( ) ( )kjkxkjkxkjky ds +?++=+

( ) ( ) ( ) ( )

( ) ( ) ( ) ( )
( )kmkuFND

kkuFNDFkkuFNDFkxFkjkx

kjkuDkkuDkxkjkx

d

djdjdjd

ss

1...

1

1...

21

00

?+?+

++?+?+=+

?+?++?+=+

??

FQFFQFQ TTT ??=?

( ) ( )

( ) ( ) ( ) ( )kjkuRkjkukmkxQkmkx

kjkeQkjkeJ

m

j

TdTd

m

j

T

k

+?+?++++

++=

?

?
?

=

=

1

0

1

( ) kmss uDkxIx ?+= 0

ndxndQ ??



 
 

42 
 

 

 

 

Analogamente, aplicando as mesmas expressões para os estados estáveis dentro do horizonte 

de controle, tem-se: 

 

 

 

A função objetivo (3.6) pode então ser escrita como: 

 

 

 

 
Onde: 

 

( )

( )?
?
?

?

?

?
?
?

?

?

+

+
=

kmkx

kkx

x
s

s

s
M

1

?
?
?

?

?

?
?
?

?

?

=

ny

ny

I

I

I M

?
?
?

?

?

?
?
?

?

?

?
00

0

0

0

DD

D

Dm

K

OM

( )

( )?
?
?

?

?

?
?
?

?

?

?+?

?
??

kmku

kku

uk
1

M

( )
( )

( )

( )

?
?
?
?
?

?

?

?
?
?
?
?

?

?

?
?
?
?
?

?

?

?
?
?
?
?

?

?

+

?
?
?
?
?

?

?

?
?
?
?
?

?

?

=

?
?
?
?
?

?

?

?
?
?
?
?

?

?

+

+

+

??
ND

ND

ND

IFF

IF

I

kx

F

F

F

kmkx

kkx

kkx

d

d

d

mm

d

md

d

d

L

MOMM

L

L

L

MOMM

ML

L

MM

00

00

0000

2

1

21

22

( ) kudxd uFkxFx ?+=

cucuHuJ k
T

fk
T

kk +?+??= 2

ku?



 
 

43 
 

 

 

A restrição (3.4) pode ser escrita como: 

 

             

Onde: 

 

 

 

O controlador MPC de horizonte infinito, que é estável para sistemas com modelo perfeito 

contendo polos estáveis, pode ser formulado como sendo a solução do seguinte problema de 

otimização: 

 

 

 

Sujeito a: 

 

            (3.7) 

           

 

            (3.8) 

 

 

 

 

( ) ( ) 1210110 RFQFFDQFDH uTuumTum ++?+?+=

( ) ( ) ( )( ) ( )( )kxFQFkxFkeIQFDc dxTudxsTumf 21110 +?+?+=

( ) ( ) ( ) ( )( ) ( ) ( )( ) ( )( ) ( )( )kxFQkxFkxFkeIQkxFkeIkQekec dxTdxdxsTdxssTs 2111 +?+?++=

[ ]
48476 m

QQdiagQ ...1 = [ ]
44 844 76 m

QdiagQ 0...02 = [ ]
48476 m

RRdiagR ...1 =

[ ]
48476 m

diag ??=? ...1 ( ) ( )
spss ykxke ?=

( ) 0~ 0 =?+ ks uDke

[ ]
44 844 76 m

DDD 000 ...
~

=

ccuHuJJ Tfk
T
kkk

uk
++??=

?
2,min



 
 

44 
 

 

Este controlador, quando implementado na prática torna-se frequentemente inviável, pois 

ocorre conflito entre as restrições de igualdade dadas pelas equações (3.7) e (3.8). Isso 

acontece por exemplo, quando o controlador é submetido a grandes variações nos set-points 

ou, quando o sistema sofre perturbações de amplitudes significativas. 

 

 

 

3.1 – Controlador IHMPC com variáveis de folga 

 

Para aumentar a faixa de viabilidade do controlador, Rodrigues e Odloak (2003) apresentaram 

uma abordagem que insere uma variável de folga na função objetivo, a qual relaxa a solução 

da restrição de igualdade dada pela Eq. (3.7). Essa solução, que é válida para sistemas 

estáveis, será desenvolvida a seguir. Partindo da equação (3.1), inserimos a variável de folga 

da seguinte maneira: 

 

 

 

 

 

 

            (3.9) 

Onde: 

 

 

 

Utilizando-se o mesmo procedimento empregado para gerar a equação (3.2), obtém-se: 

 

 

 

 

                     (3.10) 

 

( )( ) ( )( )

( ) ( ) kTk
m

j

T

j
k

T

kk

SkjkuRkjku

kjkeQkjkeJ

??

??

++?+?+

?+?+=

?

?
?

=

?

=

1

0

1

nyxnyny
k S ???? ,?

( )( ) ( )( )

( )( ) ( )( )

( ) ( ) kTk
m

j

T

mj

sp
k

Tsp
k

m

j
k

T

kk

SkjkuRkjku

ykjkxCQykjkxC

kjkeQkjkeJ

??

??

??

++?+?+

??+??++

?+?+=

?

?

?

?

=

?

+=

=

1

0

1

1



 
 

45 
 

( )( ) ( )( )

( ) ( )( ) ( ) ( )( )?

?
?

=

?

+=

+?+??++?+??+=

??+??+

1

1

j

djsp
k

sTdjsp
k

s

mj

sp
k

Tsp
k

kmkxFykmkxQkmkxFykmkx

ykjkxCQykjkxC

??

??

 

Analogamente ao caso sem variáveis de folga, o segundo termo da parte direita da equação 

(3.10) pode ser desenvolvido como segue: 

 

 

                     (3.11) 

 

 

 

A restrição ao objetivo de controle (3.7) deve ser modificada com a adição da variável de 

folga, que garante que o problema de controle sempre tenha uma solução viável: 

 

 

                     (3.12) 

                       

Ou ainda: 

 

                     (3.13) 

                        

 

Utilizando-se Q , que é a solução da equação de Lyapunov (3.6) a função objetivo se torna: 

  

 

                     (3.14)  

 

 

 

Como exposto por Carrapiço (2004), a função objetivo (3.14) resolve os problemas de 

inviabilidade apontados anteriormente, e pode ser escrita como uma expressão quadrática, 

facilitando a resolução numérica do problema.   

 

 

 

( ) 0=??+ spks ykmkx ?

( ) 0~ 0 =???+ spkks yuDkx ?

( )( ) ( )( ) ( ) ( )

( ) ( ) kTk
m

j

T

dTd
m

j
k

T

kk

SkjkuRkjku

kmkxQkmkxkjkeQkjkeJ

??

??

++?+?+

+++?+?+=

?

?
?

=

=

1

0

1



 
 

46 
 

( )
( )

( )
( )

( )

( )
( )

( )?
?
?
?
?

?

?

?
?
?
?
?

?

?

?+?

+?

?

?
?
?
?
?
?
?
?
?
?

?

?

?
?
?
?
?
?
?
?
?
?

?

?

+

?
?
?
?
?
?

?

?

?
?
?
?
?
?

?

?

=

?
?
?
?
?
?
?

?

?

?
?
?
?
?
?
?

?

?

+

?+

+

+

???

?

??

?

kmku

kku

kku

BCABCABCA

CABBCABCA

CBBCABCA

CBCAB

CB

kx

CA

CA

CA

CA

knpky

knpky

kky

kky

mnpnpnp

mm

mm

np

np

1

1

0

00

1

2

1

21

1

21

1

2

M

L

MOMM

L

L

MOMM

L

L

MM

3.2 – IHMPC Estendido para Sistemas com Tempo Morto 

 

Nesta seção será definida uma nova lei de controle que possibilitará controlar sistemas que 

apresentem uma ou mais saídas com tempo morto. Retornando-se agora à equação (3.1), que 

define uma função objetivo que pondera os erros das predições das saídas e os movimentos 

nas variáveis manipuladas: 

 

( ) ( ) ( ) ( )kjkuRkjkukjkeQkjkeJ
Tm

j

T

j
k +?+?+++= ??

?

=

?

=

1

00

            (3.1) 

Desdobrando-se a primeira parcela da equação (3.1) em dois termos que correspondem, 

respectivamente, ao erro computado entre o instante atual e o horizonte de predição e ao erro 

computado entre o horizonte de predição e o infinito, obtém-se: 

 

( ) ( )

( ) ( ) ( ) ( )kjkuRkjkukjnpkeQkjnpke

kjkeQkjkeJ

Tm

j

T

j

Tnp

j
k

+?+?++++++

++=

??

?

?

=

?

=

=

1

01

0
             (3.15) 

 

Os dois primeiros termos da equação (3.16) serão agora desenvolvidos e agrupados 

convenientemente na forma matricial. Denominando-os respectivamente de ( )1
kJ  e 

( )2
kJ  têm-

se, dessa forma: 

 

                      (3.16) 

Pode-se desenvolver ( )1
kJ  calculando a predição de saída de forma recursiva a partir do 

instante atual presente até o horizonte de predição finito np, como segue: 

 

 

 

 

 

 

 

 

( ) ( ) ( ) ( )kjkuRkjkuJJJ
m

j

T

kkk +?+?++= ?
?

=

1

0

21



 
 

47 
 

A qual pode ser representada em forma compacta matricial: 

 

 

                      (3.17) 

 

 

Substituindo-se a Eq.(3.17) na expressão de ( )1
kJ  obtém-se: 

 

 

                      (3.18) 

 

 

 

 

 

 

 

Pode-se agora desenvolver ( )2
kJ . O vetor que multiplica Q pode ser definido como o erro entre 

o valor desejado para as saídas de processo e o valor obtido num dado instante após o 

horizonte de predição: 

 

 

                      (3.19) 

 

 

 

Isso é exatamente a definição de erro discutida anteriormente. Substituindo a expressão para o 

erro, obtém-se: 

 

                      (3.20) 

 

 

( ) ( )
numnynpnanunynynpnynynp

K

CCCCOnde

uCkxCky
.,...2.,. ,:

,

??

?+=
++

[ ]( )

[ ] nynpTspspspsp

nynpnynp

TTT

yyyy

QQQdiagQOnde

.
1

.,.~:

??=

??=

L

L

( ) ( )( ) ( )( )?
?

=

?++?++=
1

2

j

spTsp
k ykjnpkxCQykjnpkxCJ

( ) ( ) ( )?
?

=

++++=
1

2

j

T
k jnpkeQjnpkeJ

( ) ( )[ ] ( )[ ]spKTspKk yuCkxCQyuCkxCJ 111 ~ ??+??+=



 
 

48 
 

Agora a equação 3.20 será posta na forma matricial. Fazendo uso das equações 2.5 e 2.6 

podemos escrever recursivamente as predições das saídas do processo 
( )y k np+

em função 

do vetor de estados no instante k+m+1 e nos instantes seguintes. 

 

Para tal observe que para a saída de processo, tem-se: 

 

  ( ) ( ) ( )( ) ( )mkxTnpmkxmknpky ds ++?++=+++ 11  
( ) ( ) ( )( ) ( )

( ) ( )( ) ( )mkxFTnpmkx
mkxTnpmkxmknpky

ds

ds

++?++=

=+++?+++=+++

1

1112
 

( ) ( ) ( )( ) ( )mkxFTnpmkxjmknpky djs ++?++=+++ 1
M

 

 

Como na formulação anterior, para garantir que a função objetivo seja limitada deve-se forçar 

a anulação do estado ( )kmkxs + . Isso pode ser feito pela anulação dos termos 
correspondentes aos polos integradores na matriz A. Daí define-se a matriz modificada A*. 

 

 

 

 

 

Assim, no instante j as previsões das saídas são obtidas por: 

 

( ) ( )( ) ( )mkxFTnpjmknpky Tdj ++?=+++ 1  
 

 



 
 

49 
 

Os estados após o horizonte de predição (k + np) serão: 

 

                      (3.21) 

Com o estado (3.21) substituído dentro da predição das saídas por: 

 

 

                      (3.22) 

 

Substituindo (3.23) na expressão para ( )2
kJ : 

 

 

 

                      (3.23) 

 

 

 

 

 

Daí resulta a seguinte a expressão para o erro: 

 

 

                      (3.24) 

 

A equação (3.25) pode por sua vez ser substituída em (3.24): 

 

 

                      (3.25) 

 

 

 

Daí define-se a variável: 

 

                      (3.26) 

( ) ( ) ( )mkxAjnpkx mjnp +=++ ?+*

( ) ( ) ( ) ( )mkxACjnpkxCjnpky mjnp +=++=++ ?+*

( ) ( )[ ] ( )[ ]

( )[ ] ( )[ ]

( ) ( )

[ ] nanunynynynpTTTspspspspsp
j

TT

j

spTsp

j

spTsp
k

TTTT

yyyyyonde

kjmkeCQCkjmke

CykjnpkxCQCykjnpkxC

ykjnpkyQykjnpkyJ

...2.
2

1

1
22

1

2

00: ++

?

=

?

=

?

=

??=

++++=

?++?++=

?++?++=

?

?

?

L

( ) ( ) ( )kmkeAkjnpke mjnp +=++ ?+*

( ) ( ) ( ){ } ( ) ( ){ }
( ) ( ) ( ) ( )kmkeAACQCAAkmke

kjmkeACQCkjmkeAJ

Tmnp

j

jT
TjTmnpT

j

jmnpT
Tjmnp

k

+??
?

?
?
?
?

?
+=

++++=

?
?

=

?

?

=

+?+?

?

?

*

1

***

1

**2

?
?

=

=
1

**

j

jT
Tj

ACQCAQ



 
 

50 
 

Que pode ter seu valor determinado pela solução de uma equação de equação de Lyapunov:  

 

 

                      (3.27) 

 

 

Substituindo (3.26) em (3.25) obtém-se uma nova expressão para o termo correspondente à 

somatória infinita: 

 

                      (3.28) 

 

 

Portanto, a restrição (3.4): 

 

( ) 0=?+ sps ykmkx       (3.4)
   

   

Poderá ser reescrita de modo mais fácil de se aplicar, da forma como segue: 

 

 

 

                      (3.29) 

 

 

O que é equivalente a: 

 

 

                      (3.30) 

 

 

 

 

 

**** ACQCAQAQA T
TT

?=?

( ) ( ) ( ) ( ) ( )kmkeAQAkmkeJ TmnpTmnpTk ++=
?? **2

( ) ( ) ( )
( )

( )

( )?
?
?
?
?

?

?

?
?
?
?
?

?

?

?+?

+?

?

+=+

kmku

kku

kku

DDDkkxkmkx ss

1

1
000

M
L

( ) 0~ =?+? ksps uDykkx



 
 

51 
 

Reescrevendo o estado x no instante k+m: 

 

 

 

 

 

 

O que equivale à: 

 

 

Portanto, a função objetivo é equivalente a: 

 

           (3.31) 

 

 

 

Ao se incluir as variáveis de folga na função objetivo definida em (3.2) e seguindo-se um 

procedimento análogo ao apresentado acima, chega-se à seguinte função objetivo: 

 

 

 

 

 

 

 

 

 

 

( )[ ] ( )[ ]
( ){ } ( ){ } skTskKTkKmTKm

s
k

sp
K

T
s
k

sp
Kk

SuRuuBAkkeAQuBAkkeA

IyuCkkxCQIyuCkkxCJ

??

??

1
*

11

~~~

~

+??+?+?++

???+???+=

( ) ( ) [ ]
( )

( )

( )?
?
?
?
?

?

?

?
?
?
?
?

?

?

?+?

+?

?

+=+ ??

kmku

kku

kku

BBABAkkxAkmkx mmm

1

1
21

M
L

( )[ ] ( )[ ]
( )[ ] ( )[ ] kTkkmTkm

sp
k

T
sp

kk

uRuuBAkkeAQuBAkkeA

yuCkkxCQyuCkkxCJ

??+?+?++

??+??+=
~~~

~

*

11



 
 

52 
 

Onde: 

 

 

 

 

 

Dessa forma o problema de controle do IHMPC para processos com tempo morto fica 

definido como: 

 

 

 

Sujeito a: 

 

 

 

 

Onde: 

 

 

 

 

 

 

 

 

 

 

 

 

( )xnynynp

ny

ny

ny

I

I

I

I

I ., ??

?
?
?
?
?

?

?

?
?
?
?
?

?

?

=
M

[ ]
??

?
?
?

??

?
?
?

+?
?

?
?
?

??
+?
?

?
?
?

??
?

?
2

,
2min c

u
C

u
Hu

s
k

kT
fs

k

kTs
k

T
k

u skk ??
?

?

( )

( ) 0,

0
~

??+?

=??+?

jkjku

uDykkx skk
sps

U

?



 
 

53 
 

3.3 – Observador de Estados 

 
Quando o modelo é representado sob a forma de variáveis de estado, deve-se em geral usar 

um observador de estado para atualizar os estados como uma função dos erros entre as saídas 

preditas e as saídas reais, que são medidas. Seu propósito é utilizar medições de grandezas 

realizadas ao longo do tempo (contaminadas com ruído e outras incertezas) e gerar resultados 

que tendam a se aproximar dos valores reais das grandezas medidas.  O observador de estados 

considerado neste trabalho pode ser representado pelas seguintes equações: 

 

( ) ( ) ( )
( ) ( ) ( ){ }

( ) ( )[ ] ( ) ( )[ ] ( ) pkFFF

p
kF

yKkkuBCKIkkxACKIkkx

kkxCyKkkxkkx

kkuBkkxAkkx

+????+???=

??+?=

???+??=?

1111

11

11111

 

 

Onde: 

yk
p – é o vetor de saídas da planta, aferidas no instante k; 

KF - matriz de ganho do observador. 

 

Usualmente, os controladores MPC corrigem as saídas adicionando o erro atual para todas as 

previsões futuras. Na nossa representação esta estratégia corresponde a um filtro dado por: 

 

 

 

 

 

Para garantir a estabilidade do controlador em malha fechada, o ganho do observador, KF, 

deverá ser tal que todos os autovalores da matriz [(I - KF C) A] estejam dentro do círculo 

unitário, o que corresponde à obtenção de polos estáveis do sistema em malha fechada. 

 

O estimador de estado que será utilizado neste trabalho é o filtro de Kalman. O Filtro de 

Kalman, que pode ser utilizado para estimar uma variável a partir do conhecimento de outras 

variáveis, baseia-se num modelo estatístico (estocástico) do processo. Foi originalmente 

desenvolvido para sistemas lineares com ruídos gaussianos e, neste caso, apresenta uma 

?
?
?
?
?

?

?

?
?
?
?
?

?

?

=

0
ny

ny

F
I

I

K
M



 
 

54 
 

solução fechada, ou em outras palavras, demonstra-se que é o estimador de mínima variância 

para esse tipo de sistema, conforme apresentado em Ricker (1990). Entretanto, para aplicar o 

Filtro de Kalman para sistemas não lineares é necessário fazer adaptações e extensões do 

algoritmo original. Uma discussão e dedução formal do Filtro de Kalman pode ser encontrada 

na literatura, como por exemplo, em Jazwinski (1997).  

 

O filtro de Kalman produz estimativas dos valores reais de grandezas medidas predizendo um 

valor, estimando a incerteza do valor predito e calculando uma média ponderada entre o valor 

predito e o valor medido. O peso maior é dado ao valor de menor incerteza. As estimativas 

geradas pelo método tendem a estarem mais próximas dos valores reais que as medidas 

originais, pois a média ponderada apresenta uma melhor estimativa de incerteza que ambos os 

valores utilizados no seu cálculo. 

 

Pode-se demonstrar (Astrom e Wittenmark, 1990) que para um tempo de observação 

suficientemente grande, o ganho do filtro de Kalman é definido pelas seguintes equações: 

 

( )

[ ] WCPACPCVAPCAPAP

CPCVAPCK

TTTT

TT
F

++?=

+=

?

?

1

1

                (3.29) 

 

Onde: 

 

V e W são as matrizes de covariância dos ruídos na saída e estado respectivamente podem ser 

usadas como parâmetros de sintonia do filtro de Kalman. 

 

  



 
 

55 
 

4 – Otimização Integrada ao Controlador Preditivo 

 

Neste capítulo são apresentadas diversas metodologias para integrar a otimização com o 

controle de processos. Kwong (1992) argumenta que isto pode ser realizado utilizando-se a 

estratégia de multicamadas, também conhecida como estrutura hierárquica.  

 

Uma estrutura hierárquica comum para integrar a otimização em tempo real (Real Time 

Optimization, RTO) com controle MPC é através de uma estrutura de três camadas (Ying &amp;amp; 

Joseph, 1999), onde na camada superior se encontra uma aplicação de RTO, que se baseia 

num modelo rigoroso não-linear de estado estacionário do processo. A camada RTO resolve 

um problema de otimização que define as condições de operação ótimas para processos 

contínuos sujeitos a restrições provenientes de equipamentos e especificações dos produtos. 

Ou seja, a camada de otimização, que é baseada num modelo econômico, busca as melhores 

condições de operação para o processo. A camada de controle MPC calcula e implementa as 

ações visando a estabilidade e otimização processo, dentro de certos limites. A camada do 

processo representa a planta em si, incluindo as operações unitárias, a instrumentação do 

processo e o controle regulatório. 

 

 

Figura 4.1 - Esquema da estratégia de otimização em três camadas. 

 

Como representado na figura 4.1, as entradas e saídas ideais do sistema, calculadas pelo RTO 

são, em seguida, passadas para uma camada intermédia em que, com base na estimativa dos 

distúrbios d(k), setpoints viáveis para as entradas e saídas são recalculados através da solução 



 
 

56 
 

de um problema de programação quadrática (QP) baseado em modelos estáticos lineares do 

processo. O problema de programação quadrática refere-se à minimização ou maximização de 

uma função objetivo quadrática que é linearmente restrita (Coelho &amp;amp; Mariani, 2006). O 

controlador MPC resolve o problema de controle implementado dinamicamente os setpoints 

viáveis de otimização. 

 

Outra possibilidade mais simples, apresentada por Kwong (1992) é a estrutura da estratégia de 

otimização em duas camadas. Nesta estrutura, representada de forma simplificada como 

mostrado na figura 4.2, a camada de otimização em tempo real ou RTO envia diretamente os 

targets ótimos ao controlador MPC. Essa estrutura apresenta algumas dificuldades. Devem-se 

tomar cuidados para que o problema de controle resultante seja sempre viável. Além disso, a 

frequência com que o RTO consegue convergir e enviar resultados ao controlador é baixa. 

Entres duas iterações bem sucedidas, pode decorrer um intervalo de várias horas, no qual o 

processo pode sofrer distúrbios e os resultados perderem relevância. Por exemplo, a carga 

processada pelo reator de uma planta petroquímica pode se alterar, modificando as condições 

de operação do processo. Por estas razões, justifica-se a estratégia em 3 camadas representada 

na figura 4.1. 

 

No item 4.1 será apresentada a camada de cálculo de target e sua interação com o controlador 

MPC. Neste trabalho, será desenvolvido um controlador capaz de implementar targets (sejam 

eles gerados por uma camada QP ou diretamente por um RTO). Alternativamente, este 

controlador MPC também contemplará uma outra estratégia de otimização denominada 

otimização online, que consiste em acrescentar um terno de otimização econômica à função 

objetivo. Descrita no item 4.4, esta estratégia ameniza as dificuldades decorrentes do elevado 

tempo que o RTO exige para fornecer novos resultados. O objetivo da estrutura de controle 

adotada é possibilitar a resolução um único problema de programação quadrática que 

contemple simultaneamente o problema de controle e o problema de otimização. 

 



 
 

57 
 

 

 

Figura 4.2 - Esquema da estratégia de otimização em duas camadas. 

 

Quando se aplica uma estratégia de controle em múltiplas camadas, na prática, deve-se 

considerar de uma maneira mais ampla o controle de processos, que se dá em dois ambientes 

computacionais distintos, o SDCD ou Sistema Digital de Controle Distribuído, também 

chamado de DCS (Distributed Control System), no qual está ligada toda a instrumentação de 

processo, e um outro computador que roda as aplicações de controle MPC e otimização, que é 

denominado como “computador de processo”. Dependendo das dimensões do processo, pode 

ser necessário utilizar mais de uma computador para minimizar o tempo computacional. 

 

Pode-se considerar que estes sistemas interdependentes formam uma pirâmide, pois o bom 

funcionamento das aplicações de controle MPC dependem integralmente de uma correta 

concepção e implementação das malhas de controle regulatório que rodam no SDCD e do 

bom funcionamento da instrumentação de campo. O bom funcionamento da camada de 

otimização depende da definição de objetivos de controle consistentes. A figura 4.3 apresenta 

uma representação esquemática da pirâmide das sistemas de automação e controle de 

processos. 

 

 

Figura 4.3 – Representação da pirâmide do controle de processos 



 
 

58 
 

No presente trabalho interessa explorar as melhores maneiras de unir as camadas de 

otimização e controle, fazendo considerações adequadas para o controle de UHDT. Nas 

próximas seções serão exploradas alternativas para este fim. 

 

 

4.1 - MPC convencional em duas Camadas - Camada de Otimização Simplificada do 

Estado Estacionário 

 

Esta estrutura clássica de controle, envolve um simulador com um modelo rigoroso que é 

usado na otimização em estado estacionário, que é realizada em tempo real em um intervalo 

de tempo maior do que o período utilizado na camada de controle (Kwong,1992). Esta 

camada de otimização estacionária envia periodicamente valores de referência, ou “targets”, 

ao controlador MPC. Retomando a analogia da uma pirâmide dos sistemas de automação e 

controle, pode-se visualizar este processo na figura 4.3. 

 

 

Figura 4.4 – Interação entre os níveis da pirâmide do controle de processos 

 

 

Nesta estrutura, definida na figura 4.4, existe uma forte interação entre as camadas, mas suas 

ações são realizadas em procedimentos distintos. Agora será discutido o funcionamento da 

camada de otimização no estado estacionário. Utilizando-se a mesma formulação da seção 2, 

a partir das equações 2.5 e 2.6, a predição do vetor de saídas no estado estacionário pode ser 

descrita da seguinte forma: 



 
 

59 
 

 

( ) ( ) [ ]
( )

( )

( )?
?
?
?

?

?

?
?
?
?

?

?

?+?

+?
?

+=+ ???

1

121

mku

ku

ku

BCABCABCAkxCANky mNNNN
M

L   (4.1) 

 

Onde N é suficientemente grande para aproximar o estado estacionário. Portanto, quando 

??N  a equação (4.1) pode ser escrita da seguinte forma: 

 

   ( ) ( ) ( )?
?

=

?? +?+=?+
1

0

m

i

ikuBCAkxCAky      (4.2) 

 

Porém, ( ) ( )?+=?+ kumku 1  que corresponde ao estado da saída e, portanto, a equação 
(4.2) torna-se: 

   ( ) ( ) ( ) ( )( )1???++=?+ ?? kukuBCAkxCAky     (4.3) 
 

Supondo-se que haja uma função objetivo econômico do tipo: 

 

( ) ( ) ?? ?CkuCkyC TuTy +?++?+=      (4.4) 
 

Sujeita às seguintes restrições: 

 

( ) ?? +??+?? maxmin ykyy  
( ) maxmin ukuu ??+?  

 

Onde Cy e Cu são vetores de preços (se positivos) ou custos (se negativos) das entradas e 

saídas, ? é uma variável de folga que assegura a viabilidade do problema e C? é sua matriz de 

ganhos. Assim, a camada superior do controlador resolve o seguinte problema: 

 

( ) ( )
( ) ( ){ }?? ?CkuCkyC TuTy

kyku
+?++?+=

?+?+ ,
max     (4.5) 

 



 
 

60 
 

( )( ) ( )( )[ ] ( )( ) ( )( )[ ]
( ) ( )[ ]?

?
?

=

=

+?+?+

??+??++?+?+=

1

1

1

//

/1/1//

m

j

T

sp
u

Tsp
np

j

spTsp
k

kjkuRkjku

ukmkuRukmkuykjkyQykjkyJ

Ao resolver este problema definido pela equação (4.5), são obtidos "setpoints" ótimos para a 

camada dinâmica, ou seja, os targets: 

 

 

Um controlador MPC convencional poderia ser modificado para que se tenha os targets 

implementados através da seguinte função objetivo: 

 

 

 

       (4.6) 

 

Onde Ru é uma matriz de pesos de dimensões adequadas. 

 

Portanto, a camada inferior ou dinâmica do controlador resolve o seguinte problema: 

( ) ( ) kmkuku
J

1,,
min

?+?? K
 

Sujeito às seguintes restrições: 

 

 

 

Como se pode observar, o erro entre a entrada e seu "target" só é ponderado no último 

instante do horizonte de controle, pois isto é conveniente para separar o controle das saídas da 

otimização das entradas. Desta forma, o controlador dará prioridade para controlar as saídas 

nos valores desejados e mover as entradas para os seus "alvos" apenas quando há número 

suficiente de graus de liberdade. A otimização, ou obtenção dos targets, deve incluir todas as 

restrições do processo. Esta é a estratégia de otimização em tempo real utilizada pelos pacotes 

comerciais disponíveis atualmente para implementações industriais, inclusive o Profit Suite. 

( ) ( )?+=?+= kuCukyy Tuspsp ,



 
 

61 
 

 

Conforme exposto por Porfírio (2011), uma desvantagem da estrutura representada na figura 

4.1 é que podem ocorrer instabilidades caso ocorra um distúrbio no processo ao mesmo tempo 

em que os “targets” estão sendo alterados (Gouvêa &amp;amp; Odloak, 1998). Deve-se considerar que 

plantas que sofrem muitos distúrbios, especialmente distúrbios não medidos pela 

instrumentação de processo, tal como as unidades de UHDT, os “targets” de otimização 

poderão não mais representar o melhor ponto operacional ou serem inviáveis. Uma adaptação 

deste esquema ao IHMPC é apresentada na seção 4.4.  

 

4.2 – IHMPC Estendido com Controle por Zonas e Targets para as Entradas 

 

Gonzalez e Odloak (2009) estenderam o controlador MPC de horizonte infinito para o caso 

em que as saídas são controladas por faixas e as entradas possuem targets, ou alvos, que são 

valores de referência, em geral providos por um algoritmo de otimização econômica e 

definem o ponto ótimo de operação. Neste seção, apresenta-se a proposta de Gonzalez e 

Odloak (2009) e, em seguida, a extensão realizada por Pacheco (2009) para o caso de controle 

por funnel das saídas mantendo os targets para as entradas. A função objetivo do controlador 

IHMPC incluindo o controle por zona e metas (targets) para as entradas pode ser definida 

como se segue: 

 

 

 

                      (4.7) 

 

Onde: 

Erro entre as saídas e seus valores de referência 

Erro entre as entradas e seus valores de referência 

Targets para as entradas 

Matriz peso positiva que pondera os “targets” das 

entradas 

Variável de folga para a implementação do target 

Matriz peso positivo que pondera as slacks dos 

“targets” das entradas 

( ) ( )
( ) ( )

u

nuu
k

u

sp

nu
u

sp
u

sp

S

Q

u

eukjkukjke

ykjkykjke

??

???+=+

?+=+

?

,

( )[ ] ( )[ ] ( )[ ] ( )[ ]

( ) ( ) uku
Tu

k
s
k

Ts
k

j

T

j

u
kuu

Tu
ku

j

s
k

Ts
kk

SSkjkuRkjku

kjkeQkjkekjkeQkjkeV

????

????

+++?+?+

?+?++?+?+=

?

??
?

=

?

=

?

=

1
0

00



 
 

62 
 

( )[ ] ( )[ ]
( ){ } ( ){ }

( ){ } ( ){ }
u
ku

Tu
k

s
k

Ts
k

k
T
k

spsp
k

mTspsp
k

m

u
kmu

sp
mukmuu

Tu
kmu

sp
mukmu

s
k

sp
k

T
s
k

sp
kk

SS

uRuyIuBAkkxCAQyIuBAkkxCA

IuIuNkkuIQIuIuNkkuI

IyuCkkxCQIyuCkkxCV

????

??

??

++

??+??+??++

???+???++

???+???+=

1

*

11

~~~

~~~

~

m

I

I

I

nu

nu

mu

?
?

?
?

?

?
?
?

?

?

?
?
?

?

?

= M ( )( ) nynanunynyp
ny

ny

sp
p

I

I

I ...1

0

1 ++??

?
?
?
?
?

?

?

?
?
?
?
?

?

?

+
?
?

?
?

?

=
M

?
?
?
?
?
?
?

?

?

?
?
?
?
?
?
?

?

?

=

44 844 76

L

OMM

L

L

m

nununu

nunu

nu

III

II

I

N
0

0

00

~

Para que a função objetivo definida em (4.7) seja limitada, deve-se impor a restrição (3.13), 

que garante que o primeiro somatório infinito seja limitado, e a seguinte restrição: 

 

( ) 01 =???+ ukspukmku ?      (4.8) 
 

A restrição (4.8) garante que o segundo somatório infinito também seja limitado. Em seguida 

definimos as seguintes matrizes que permitem representar a função objetivo de forma 

compacta: 

 

             (4.9) 

 

 

 

 

Incluindo estas matrizes e expandindo a função objetivo (4.7) da mesma forma que foi feito 

na seção 2.2, obtém-se: 

 

 

                      (4.10) 

 

 

 

É possível então substituir a expressão para no terceiro termo da equação (4.10), 

obtendo o IHMPC com targets para as entradas e faixas para o controle de saídas, definido 

pela seguinte função objetivo: 

 

 

                      (4.11) 

 

 

 

 

( )[ ] ( )[ ]
( ){ } ( ){ }
( ){ } ( ){ } ukuTukskTskkTkkmTkm

u
kmu

sp
mukmuu

Tu
kmu

sp
mukmu

s
k

sp
k

T
s
k

sp
kk

SSuRuuBAkkeAQuBAkkeA

IuIuNkkuIQIuIuNkkuI

IyuCkkxCQIyuCkkxCV

????

??

??

++??+?+?++

???+???++

???+???+=

1
*

11

~~~

~~~

~

( )kke



 
 

63 
 

O problema de controle do IHMPC estendido com controle por zonas e targets para as 

entradas fica definido como: 

[ ]
?
?

?
?

?

?
?

?
?

?

+
?
?
?

?

?

?
?
?

?

??

+
?
?
?

?

?

?
?
?

?

??

?
?

33,3
,,

2min c

u

C

u

Hu
u
k

s
k

k

T
f

u
k

s
k

k
Tu

k

Ts
k

T
k

u uk
s
kk

?
?

?
???

??
 

Sujeito a: 

 

A matriz hessiana H3 e as matrizes Cf,3 e c3 podem ser obtidas de maneira semelhante ao 

procedimento utilizado no item 4.5. 

 

4.3 – IHMPC Estendido com Funnel 

 

Maciejowski (2000) argumenta que embora seja comum representar os objetivos de controle 

como trajetórias de referência que as saídas do processos devem seguir, na maioria das 

aplicações os valores exatos dessas saídas não são relevantes, o importante é mantê-las dentro 

de certos limites específicos ou zonas. Dessa forma, uma variável ter peso nulo no problema 

de controle enquanto se encontrar dentro desses limites. Maciejowski (2000) apresenta uma 

variação dessa representação clássica dos objetivos de controle que são os Funnel, ou funis, 

que são idênticos à abordagem por zonas, exceto que se tornam mais estreitos ao longo do 

horizonte de predição. 

 

Figura 4.5 – Ilustração do Conceito de Funnel  



 
 

64 
 

As áreas hachuradas na figura 4.5 mostram a penalização da trajetória, que ocorre apenas 

quando esta deixa a região do Funnel. 

 

Portanto, o "funil" (Funnel) é um conceito cujo objetivo é suavizar as ações do controlador, a 

fim de tornar o controle menos agressivo, ao mesmo tempo abrindo espaço para que os 

objetivos de otimização sejam cumpridos. Controlar saídas através de funis e zonas, em vez 

de trajetórias específicas, é uma forma de liberar graus de liberdade adicionais ao processo de 

otimização. 

 

 

Figura 4.6 – Funnel sem Tempo Morto 

 

 

Conforme representado na Fig. 4.6, é possível combinar os conceitos de controle por zona, 

onde ao invés de Set-Point têm-se limites máximos e mínimos, com o controle por funil, 

através da definição das seguintes restrições para as variáveis controladas: 

 

 

 

( ) ( ) ( ) ( )( ) m,1,2,j   ,max,max, K=???+?&gt; iiispiii yky
m

j
kyjkyyky

( ) ( ) ( ) ( )( ) m,1,2,j   ,min,min, K=?+?+?&amp;lt;kyy
m

j
kyjkyyky iii

sp
iii



 
 

65 
 

( )[ ] ( )[ ]
( ){ } ( ){ }

( ){ } ( ){ }
u
ku

Tu
k

s
k

Ts
k

k
T
k

spsp
k

m
Tspsp

k
m

u
kmu

sp
mukmuu

Tu
kmu

sp
mukmu

s
k

sp

k

T
s
k

sp

kk

SS

uRuMyIuBAkkxCAQMyIuBAkkxCA

IuIuNkkuIQIuIuNkkuI

IyuCkkxCQIyuCkkxCJ

????

??

??

++

??+??+??++

???+???++

???+???+=

??

??

1

* ~~~

~~~

~

Daí, a função custo (4.11) para o IHMPC desenvolvido pode ser reescrita da seguinte forma: 

 

 

 

                (4.12) 

 

 

 

 

Onde: 

 

 

 

 

Também é conveniente definir uma matriz M como segue: 

 

 

 

 

Daí resulta que: 

( ) spsp yMknpky ?=+ /  
 

Observa-se que os “set-points” fixos para as controladas se tornam de fato um vetor de “set-

points” ao longo do horizonte de predição np. Finalmente, a função custo torna-se: 

 

 

 

                (4.13) 

 

 

Para cada intervalo de amostragem em que o problema seja resolvido, o funil define novos 

limites para as saídas. O controlador é livre para encontrar o melhor caminho para as saídas, 

desde que se mantenham dentro dos limites determinados pelo funil. 

?
?

?

?

?
?

?

?
=

44 344 21
L

np

nyIM 00

( )[ ] ( )[ ]
( ){ } ( ){ }

( ) ( ){ } ( ) ( ){ }
u
ku

Tu
k

s
k

Ts
kk

T
k

spsp
k

mTspsp
k

m

u
kmu

sp
mukmuu

Tu
kmu

sp
mukmu

s
k

sp

k

T
s
k

sp

kk

SSuRu

kpkyIuBAkkxCAQkpkyIuBAkkxCA

IuIuNkkuIQIuIuNkkuI

IyuCkkxCQIyuCkkxCJ

????

??

??

++??+

+??++??++

???+???++

???+???+= ??

1

*

~

~~

~~~

~

( )

( )
npny

sp

sp

sp

knpky

kky

y .

/

/1

??
?
?
?

?

?

?
?
?

?

?

+

+
=? M



 
 

66 
 

Se há qualquer erro para a saída do sistema no instante k, o funil determina limites para esta 

saída a partir deste momento até ao final do horizonte de controle, k + m. O funil estabelece 

tais limites estabelecendo uma linha que conecta o valor atual de saída para o alvo ou limite 

excedido pela saída (em relação ao qual o erro é calculado), k + m. 

 

 

 

Figura 4.7 – Funnel com Tempo Morto 

 

 

Para sistemas com tempo morto, o comportamento do funil é mostrado na Fig. 4.7. Neste 

caso, o funil limita a saída a partir do final do tempo morto até o instante k + p. Esta forma de 

implementação assegura que o efeito do funil não será anulado pelo tempo morto do sistema. 

As restrições de funil para os sistemas com tempo morto se tornam: 

 

( ) ( )
T

jkykjky ii
sp
i

?
,,2,1, K=&lt;+  

( ) ( ) ( ) ( )( ) p
TT

jyky
m

j
kykjkyyky iii

sp
ii

sp
i ,,2,1,max,max, K?

?

?
?
?

? +?
?

?
?
?

? +=???+?&gt;
??

 

 

( ) ( )
T

jkykjky ii
sp
i

?
,,2,1, K=&gt;+  

( ) ( ) ( ) ( )( ) p
TT

jkyy
m

j
kykjkyyky iii

sp
ii

sp
i ,,2,1,min,min, K?

?

?
?
?

? +?
?

?
?
?

? +=?+?+?&lt;
??

 



 
 

67 
 

4.4 - Integração da Otimização Online ao Controle Preditivo  

 

Nesta seção é discutida uma alternativa para se integrar o controle de processos através de 

controle preditivo multivariável e a otimização econômica em tempo real.  

 

Conforme apresentado por Porfírio (2011), uma possível solução pode ser uma estratégia de 

controle integrada, numa única camada, na qual os problemas de controle e otimização 

econômica são resolvidos simultaneamente, na mesma função objetivo. 

 

Supondo que o objeto da otimização econômica possa ser dado por uma função convexa das 

entradas e saídas do processo, um controlador MPC com otimização econômica poderá ser 

obtido através da inclusão do gradiente reduzido do objetivo econômico na função objetivo do 

controlador preditivo. 

 

Considerando-se que o controle dinâmico das variáveis é realizado por bandas, a função 

objetivo torna-se: 

 

( )( ) ( )( )[ ] ( ) ( )[ ] otimotim
m

j

T
np

j

spTsp
k fPkjkuRkjkuykjkyQykjkyJ ++?+?+?+?+= ??

?

==

1

11

////  

 

 

Assumindo que a predição para as variáveis controladas no estado estacionário 

correspondentes a um determinado conjunto de valores para as entradas, u, é representado por 

y
)

, então a função objetivo econômico associada a este estado estacionário pode ser 

representada por uma função genérica: 

 

 ( )uyfF ,
)=                           (4.14) 

 

Alterando o vetor de controle para o valor uu ?+ , a aproximação de primeira ordem do 

gradiente da função objetivo (4.14) será: 

 

         u
du

Fd

du

dF

du

dF

uuu
uu ?+==

?+
?+ 2

2

?                     (4.15) 



 
 

68 
 

Se não há restrições sobre a otimização da operação, estar-se-á procurando um ponto extremo 

onde 0=?+ uu? . Se o modelo rigoroso no estado estacionário for conhecido, a equação 
diferencial (4.15) pode ser representada da seguinte forma: 

 

u

F

u

y

y

F

du

dF

?
?

+
?
?

?
?

=
)

)                (4.16) 

 

2

22

2

22

2

2

2

2

u

F

yu

F

u

y

u

y

y

F

u

y

uy

F

y

F

u

y

du

Fd
TT

?
?

+
??

?
?
?

?
?
?

?

?
?

+
?
?

?
?

+
?
?

?
?
?

?

?
?
?

?

??
?

+
?
?

?
?

?
?
?

?

?
?

= )
))

)

)

))

)

                    (4.17) 

 

 

Definindo-se 
u

y

?
?)

como o ganho do processo no estado estacionário e o denominando Kp, e 

substituindo-se as equações (4.16) e (4.17) na equação (4.15), obtêm-se: 

 

u
u

F

yu

F
K

u

y

y

F
K

uy

F
K

y

F
K

u

F

u

y

y

F T
ppp

T
puu ??

?

?
?
?

?

?
?

+
??

?
+??
?

?
??
?

?

?
?

?
?

+
??

?
+

?
?

+?
?

?
?
?

?

?
?

+
?
?

?
?

=?+ 2
22

2

22

2

2

)

)

)))

)

)?     (4.18) 

 

 

Ou ainda: 

 

uGduu ?+=?+?  
 

Onde: 

 

?
?

?
?
?

?

?
?

+
??

?
+??
?

?
??
?

?

?
?

?
?

+
??

?
+

?
?

=

?
?

?
?
?

?

?
?

+
?
?

?
?

=

2

22

2

22

2

2

u

F

yu

F
K

u

y

y

F
K

uy

F
K

y

F
KG

u

F

u

y

y

F
d

T
ppp

T
p )

)

)))

)

)

 

 

 



 
 

69 
 

Dado o horizonte de controle m, a variação na função econômica seria calculada pela equação 

(4.19): 

 

[ ]

( )
( )

( )?
?
?
?
?

?

?

?
?
?
?
?

?

?

?+?

+?

?

+=?+

kmku

kku

kku

GGGduu

1

1

M
L?                     (4.19) 

 

O vetor gradiente representado na equação (4.19) acima pode ser interpretado como um vetor 

de erros em relação a um "setpoint", cujo ponto ótimo corresponde a zero. Assim, zerar este 

vetor deve ser um dos objetivos do controlador. Esse conjunto de equações de erro pode ser 

incluído na função objetivo do algoritmo MPC. Assim, a função objetivo torna-se: 

 

 

( )( ) ( )( )[ ] ( ) ( )[ ] uuotimuuT
m

j

T
np

j

spTsp
k PkjkuRkjkuykjkyQykjkyJ ?+?+

?

==

++?+?+?+?+= ?? ??
1

11

 

Ou ainda: 

 

( )( ) ( )( )[ ] ( ) ( )[ ]
[ ] [ ]uGdPuGd

kjkuRkjkuykjkyQykjkyJ

otim
T

m

j

T
np

j

spTsp
k

?+?++

++?+?+?+?+= ??
?

==

1

11  

 

 

4.5 – IHMPC - Estendido com “Funil” e Otimizador Online com Targets  

 

Embora não se deseje trabalhar simultaneamente com otimização online e com targets para as 

variáveis manipuladas, uma vez que ambos servem ao mesmo propósito de otimizar a planta 

de processo e não faz sentido fornecer dois objetivos para que isso ocorra, será gerado um 

algoritmo contendo ambas as características. Pode-se, de qualquer forma, desativar facilmente 

a otimização online ou os targets ao tornar nulas suas respectivas matrizes de peso na função 

objetivo.   

 



 
 

70 
 

Somando-se numa única função objetivo todas as características apresentadas nas seções 

anteriores, obtém-se: 

 

( )[ ] ( )[ ]
( ){ } ( ){ }

( ){ } ( ){ }
[ ] [ ]kotimTkuku

Tu
k

s
k

Ts
kK

T
k

spsp
k

m
Tspsp

k
m

u
kmu

sp
mukmuu

Tu
kmu

sp
mukmu

s
k

sp

k

T
s
k

sp

kk

uGdPuGdSSuRu

yMIuBAkkxCAQyMIuBAkkxCA

IuIuNkkuIQIuIuNkkuI

IyuCkkxCQIyuCkkxCJ

?+?++++??+

??+??++

???+???++

???+???+=

??

??

????

??

??

1

*

~

~~

~~~

~

     (4.20) 

 

 

Como antes, esta função objetivo (4.20) estará sujeita às seguintes restrições: 

 

 

 

Estará sujeita também às restrições que definem o Funil: 

( ) ( )
T

jkykjky ii
sp
i

?
,,2,1, K=&lt;+  

( ) ( ) ( ) ( )( ) p
TT

jyky
m

j
kykjkyyky iii

sp
ii

sp
i ,,2,1,max,max, K?

?

?
?
?

? +?
?

?
?
?

? +=???+?&gt;
??

 

 

( ) ( )
T

jkykjky ii
sp
i

?
,,2,1, K=&gt;+  

( ) ( ) ( ) ( )( ) p
TT

jkyy
m

j
kykjkyyky iii

sp
ii

sp
i ,,2,1,min,min, K?

?

?
?
?

? +?
?

?
?
?

? +=?+?+?&lt;
??

 

 



 
 

71 
 

Agora a função objetivo (4.20) será posta em forma quadrática, possibilitando a utilização de 

algoritmos numéricos para problemas de programação quadrática na obtenção da solução do 

problema. Desenvolvendo o primeiro termo: 

 

 

 

 

 

 

 

 

 

Analogamente, desenvolvendo o segundo termo têm-se: 

 

 

 

 

 

 

 

 

Desenvolvendo o terceiro termo: 

 

 

 

 

 

 

E, por fim, desenvolvendo os demais termos: 

 

 

 

 

( )[ ] ( )[ ]
( ) ( ) ( ) ( )

( ) ( )
( )

( ) skT
Ts

k

spTTs
kk

TTs
k

TTs
k

spTsp

k

TspTsps
k

T
T

k

spTT
kk

T
T

k

T
T

k
s
k

TT

spTT

k
TTTT

s
k

sp

k

T
s
k

sp

k

IQIyQIuCQIkkxCQI

yQyuCQykkxCQyIQCu

yQCuuCQCukkxCQCuIQCkkx

yQCkkxuCQCkkxkkxCQCkkx

IyuCkkxCQIyuCkkxC

?????

?

?

??

~~~~

~~~~

~~~~

~~~

~

++???

+?????

????+?+?

??+

=???+???+

?

????

?

?

??

( ){ } ( ){ }
( ) ( ) ( ) ( ) ( )

( )
( )
( ) ukmuuTmu

Tu
k

sp
muu

T
mu

Tu
kku

T
mu

Tu
kmuu

T
mu

Tu
k

u
kmuu

T
mu

Tspsp
muu

T
mu

Tsp
ku

T
mu

Tsp
muu

T
mu

Tsp

u
kmuu

TT
k

sp
muu

TT
kku

TT
kmuu

TT
k

u
kmuu

T
mu

Tsp
muu

T
mu

T

ku
T

mu

T

muu
T

mu

T

u
kmu

sp
mukmuu

Tu
kmu

sp
mukmu

IQIuIQIuNQIkkuIQI

IQIuuIQIuuNQIukkuIQIu

IQNuuIQNuuNQNukkuIQNu

IQIkkuuIQIkkuuNQIkkukkuIQIkku

IuIuNkkuIQIuIuNkkuI

?????

?

?

?

??

~~~~~

~~~~~

~~~~~~~~~

~~~~~

~~~

++???

++???

??????+?+

???+

=???+???+

( ){ } ( ){ }
( ) ( ) ( ) ( )

( )
( ) spspTspTTk

TspTTmTspTT

spspTTT
kk

TTT
k

mTTT
k

spspTmTT
k

TmTTmTmTT

spsp
k

m
Tspsp

k
m

yMIQIMyuBAQIMykkxCAQIMy

yMIQABuuBAQABukkxCAQABu

yMIQACkkxuBAQACkkxkkxCAQACkkx

yMIuBAkkxCAQyMIuBAkkxCA

????

?

?

??

+???

????+?+

??+

=??+??+

***

***

***

*

~

~~~~
/

~

~~

[ ] [ ]

kotim
TT

kotim
TT

k

kotim
T

otim
Tu

ku

Tu
k

s
k

Ts
kk

T
k

kotim
T

k
u
ku

Tu
k

s
k

Ts
kk

T
k

uGPGudPGu

uGPddPdSSuRu

uGdPuGdSSuRu

??+?+

?++++??

=?+?++++??

????

????

1

1

~

~



 
 

72 
 

Agora é possível agrupar adequadamente todos os termos da função objetivo na seguinte 

forma quadrática: 

 

 

 

 

 

 

  

Onde: 

 

Onde: 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

4

4,4

3,4

2,4

1,4

44342414

34332313

24232212

14131211

2 c
y

u

C

C

C

C

y

u

HHHH

HHHH

HHHH

HHHH

yuJ

u
k

s
k

sp

k

f

f

f

f

u
k

s
k

sp

k

TTT

TT

T
Tu

k

Ts
k

TspT
kk +

?
?
?
?
?

?

?

?
?
?
?
?

?

? ?

?
?
?
?
?

?

?

?
?
?
?
?

?

?

+

?
?
?
?
?

?

?

?
?
?
?
?

?

? ?

?
?
?
?
?

?

?

?
?
?
?
?

?

?

??
?

??
? ?=

??
?

?
?

?
?

??

muu
T

T

spTT
T

otim
TTT

u
T

T

IQNH

IQCH

MIQABQCH

GPGRBAQABNQNCQCH

~~

~

~~

~~~~~~~

14

13

*
12

*
11

=

?=

??=

++++=

( ) ( ) ( )
( ) ( )
( )
( )

( ) ( ) ( ) ( ) ( )
( ) ( ) ( ) dPdkkxACQACkkxuIQIukkuIQIu

uIQIkkukkuIQIkkukkxCQCkkxc

IQIuIQIkkuC

IQCkkxC

MIQACkkxQCkkxC

GPdNQIuNQIkkuBAQACkkxCQCkkxC

IQH

MIQIMQH

otim
TmTmTTsp

muu
T

mu

Tsp
muu

T
mu

Tsp

sp
muu

T
mu

T

muu
T

mu

TTT

muu
T

mu

Tsp
muu

T
mu

T

f

TT

f

spTmTTTT

f

otim
T

u
T

mu

Tsp
u

T
mu

TTmTTTT

f

spTspT

+++?

?+=

+?=

?=

??=

+?++=

=

+=

*

4

4,4

3,4

*
2,4

*
1,4

23

*
22

~~

~~~

~~

~
/

~

~~~~~
/

~

~

~



 
 

73 
 

O parâmetro c4 é a constante da função objetivo dos problemas de programação quadrática. A 

matriz Hessiana da função objetivo, H4, é definida por: 

 

 

 

 

 

 

E a matriz auxiliar da função objetivo, Cf4, é dada por: 

 

 

 

 

 

 

Dessa forma o problema de controle do IHMPC estendido com “Funil”, Otimizador Online e 

targets na forma quadrática fica definido como: 

 

 

 

 

 

 

 

Esse controlador possui todas as características necessárias para realizar o controle e 

otimização de processos de unidades de UHDT. Ele é capaz de lidar com os grandes tempos 

mortos existentes nesse processo, atuando mais lentamente e liberando graus de liberdade 

para a execução da otimização devido ao controle por Funil, e pode otimizar a planta tanto 

através de “targets” fornecidos por uma camada de otimização baseada na simulação estática 

de um modelo rigoroso, ou então por otimização online acoplada à camada de controle. É 

necessário optar por uma entre as duas últimas opções, ou seja, utilizar num dado momento 

apenas um tipo de otimização.  

 

?
?

?

?
?

?

?

?
?

?

?
?

?

?

?
?
?
?
?

?

?

?
?
?
?
?

?

? ?

+

?
?
?
?
?

?

?

?
?
?
?
?

?

? ?

??
?

??
? ?

??
?

? ?

u
k

s
k

sp

k

f

u
k

s
k

sp

k

Tu
k

Ts
k

TspT
K

yu

y

u

C
y

u

Hyu
u
k

s
k

sp
k

?
?

?
?

??
??

4,4 2min

?
?
?
?
?

?

?

?
?
?
?
?

?

?

=

44342414

34332313

24232212

14131211

4

HHHH

HHHH

HHHH

HHHH

H

TTT

TT

T

?
?
?
?
?

?

?

?
?
?
?
?

?

?

=

4,4

3,4

2,4

1,4

4

f

f

f

f

f

C

C

C

C

C



 
 

74 
 

Ou seja, no caso da unidade de processo contar com um software otimizador em tempo real 

(RTO) cujos resultados formam um conjunto de “targets” para as variáveis manipuladas e 

controladas, e este estiver obtendo convergência adequada e resultados coerentes, não haverá 

necessidade de acionar a otimização online acoplada à camada de controle, pois esta é menos 

precisa. 

 

Entretanto, quando o simulador estático não for capaz de convergir com a rapidez necessária, 

o que de fato é uma ocorrência bastante frequente, levando-se em conta que o tempo entre 

duas tentativas subsequentes de convergência de um RTO pode ser bastante longo, 

usualmente 2 a 5 horas, a otimização online acoplada à camada de controle poderá ser 

utilizada para conduzir o processo ao ótimo econômico na indisponibilidade de resultados 

vindos da camada de RTO. Uma discussão aprofundada da otimização em tempo real e 

estratégias de otimização pode ser encontrada em Rotava e Zanin (2005) e Zanin, Gouvêa e 

Odloak (2000). 

 

  

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 



 
 

75 
 

5 – Estudo de Caso – Simulação de uma UHDT 

 

Para testar a eficácia do controlador desenvolvido na seção 4 na solução do problema 

proposto (controle e otimização econômica de unidades de processo UHDT), foram realizadas 

simulações computacionais para se obter a resposta do processo em malha fechada, para 

modelos sem incerteza e também para modelos com incerteza. Ou seja, num primeiro 

momento, o próprio modelo do controlador foi utilizado para gerar a resposta do sistema, o 

que equivale a supor que o modelo é perfeito, e posteriormente um modelo diferente foi 

utilizado, isto é, um modelo imperfeito. 

 

Para realizar este teste, de acordo com as premissas descritas na seção introdutória do presente 

trabalho (seção 1), foram selecionadas as seguintes variáveis de processo de uma UHDT, que 

são as mais significativas para a estratégia de controle empregada no presente trabalho: 

 

Variáveis controladas: 

  

 y(1) – WABT (“Weighted Average Bed Temperature”) total da reação (ºC); 

 y(2) – Enxofre no diesel (ppm); 

 y(3) – vazão total de instáveis (LCO + gasóleo de coque) (m3/d); 

 y(4) – excesso de H2 na reação (kNm
3/d) (vazão corrigida para 100 kPa e 0 ºC); 

 y(5) – pressão de H2 da PSA para o Compressor C-02 (kgf/cm
2); 

 

 

Variáveis manipuladas: 

  

 u(1) – volume de carga da unidade (m3/d); 

 u(2) – vazão de LCO (“Light Cycle Oil”) (m3/d); 

 u(3) – temperatura de Saída do Forno (ºC); 

 u(4) – temperatura de Entrada R1L2 (ºC); 

 u(5) – temperatura de Entrada R2L1 (ºC); 

 u(6) – temperatura de Entrada R2L2 (ºC); 

 

 



 
 

76 
 

O filtro de Kalman foi adotado para as correções dos estados com a leitura da planta, 

conforme a Equação (2.6). O filtro foi sintonizado para garantir que todos os autovalores da 

matriz [ ]ACKI F?  sejam pertencentes ao círculo unitário [-1,1], resultando em pólos 
estáveis do sistema em malha fechada. 

 

As variáveis estão correlacionadas entre si pelos modelos de função de transferência contínua 

que estão representados na Tabela 5.1. Estes modelos representam a dinâmica real de uma 

planta de processo quando o conjunto de variáveis não está muito distante do estado 

estacionário. O objetivo destes testes iniciais foi o de observar se o controlador é 

numericamente consistente e operacional, quando submetido a testes com situações que 

correspondem com precisão às situações que se encontram na prática em plantas de 

hidrotratamento de diesel.   

 

Tabela 5.1 – Modelos do Processo em Função de Transferência Contínua (tempo em minutos) 

  y(1) y(2) y(3) y(4) y(5) 

u(1)   
 

13

074,0

+s
 

  
 

se
s

20

115

04,0 ?
+

?
  

se
s

20
4

115

10 ?
?

+
?

 

u(2)   13

1,0

+s
   

13

1

+s
 

se
s

20

115

6,0 ?
+

?
  

se
s

s 15
2 17,27192

00348,01009,0 ?
++

??
  

u(3) 
 

se
ss

s 14
2 19,22131

444,063,11 ?
++

+
 

16

25,1

+
?

s
  

  

se
s

10

116
2,0 ?

+
?

   
se

s
10

116

0024,0 ?
+

?
 

u(4) 
se

ss

s 3
2 125150

328,0545,9 ?
++

+
  

16

25,1

+
?

s
  

  

se
s

10

116

2,0 ?
+

?
  

se
s

10

116

0024,0 ?
+

?
  

u(5) 
 

se
ss

s 3
2 138361

415,056,15 ?
++

+
  

16

25,1

+
?

s
 

  

se
s

10

116

2,0 ?
+

?
  

se
s

10

116

0024,0 ?
+

?
  

u(6) 
 

se
ss

s 3
2 135303

415,049,13 ?
++

+
  

16

25,1

+
?

s
 

  
 

se
s

10

116

2,0 ?
+

?
 

se
s

10

116

0024,0 ?
+

?
  

 

 

 

 

 

 

 



 
 

77 
 

5.1 - Otimização Online para a UHDT  

 

Conforme discutido anteriormente. Os maiores ganhos da otimização de uma planta de 

Hidrotratamento de Diesel são obtidos ao se aumentar a vazão de carga total da unidade, 

aumentar a proporção de correntes instáveis na carga, e ao mesmo tempo manter a 

concentração de enxofre no diesel dentro das especificações e o perfil de temperaturas dos 

leitos catalíticos dos reatores dentro dos limites requeridos pelo catalisador. Ou seja: 

 

• Maximizar a carga total da unidade até o limite operacional   ( ){ }21max,1min uu ??  
 

• Maximizar a proporção de correntes instáveis na carga (LCO) até o limite operacional   

( ){ }22max,2min uu ?? ; 
 

Usando a nomenclatura do item anterior, pode-se definir a seguinte função objetivo 

econômica: 

 

( ) ( )22max,221max,1 uuuuF ?+?= ??                          (5.1) 
 

Onde ?? , são constantes. Expandindo a equação (5.1): 
2

22max,2
2

max,2
2

11max,1
2

max,1 22 uuuuuuuuF ?????? +?++?=                                      (5.2) 

 

 

Como F depende apenas do conjunto de variáveis manipuladas, u, pode-se simplificar as 

equações (4.16) e (4.17) como segue: 

 

?
?

?
?
?

?

?
?

=?
?

?
?
?

?

?
?

=
2

2

u

F
G

u

F
d  

 

Para o modelo da UHDT, é obtido: 

 



 
 

78 
 

?
?
?
?
?
?

?

?

?
?
?
?
?
?

?

?

?
?

?
?

?
?

?
?

?
?

?
?

?
?

?
?

?
?

?
?

?
?

?
?

=?
?

?
?
?

?

?
?

=

?
?

?
?
?

?

?
?

?
?

?
?

?
?

?
?

?
?

=?
?

?
?
?

?

?
?

=

2
6

2

56

2

46

2

36

2

26

2

6

2

61

2

51

2

41

2

31

2

21

2

2
1

2

2

2

654321

1

,

u

F

uu

F

uu

F

uu

F

uu

F

uu

F

uu

F

uu

F

uu

F

uu

F

uu

F

u

F

u

F
G

u

F

u

F

u

F

u

F

u

F

u

F

u

F
d

MMMMMM  

Dada a definição da função objetivo econômico, os termos não nulos são: 

 

2max,2
2

1max,1
1

22

22

uu
u

F

uu
u

F

??

??

+?=
?
?

+?=
?
?

 

?

?

2

2

2
2

2

2
1

2

=
?
?

=
?
?

u

F

u

F

 

 

Considerando-se os pesos da otimização da carga total e da vazão de instáveis iguais à 1, ou 

seja, 1== ?? , obtém-se: 

 

 

 

Estes parâmetros definem a função de Otimização Online para o presente estudo de caso.  

 

5.2 – Simulações e Resultados 

 

O seguinte conjunto de parâmetros de sintonia será utilizado em todos os estudos de caso, a 

menos que se faça menção em contrário: 

 

Limites máximos e mínimos para as Variáveis Controladas: 

 

y1,min = 357;  y1,max = 377; 

y2,min = 29,4;  y2,max = 49,4; 

y3,min = 1976;  y3,max = 1996; 

y4,min = 18,4;  y4,max = 38,4; 

y5,min = 9,5;  y5,max = 29,5; 

[ ]
[ ]( )0,0,0,0,2,2

0,0,0,0,22,22 2max,21max,1
diagG

uuuud

=
+?+?=



 
 

79 
 

Limites máximos e mínimos para as Variáveis Manipuladas: 

 

u1,min = 5000;  u1,max = 6000; 

u2,min = 800;  u2,max = 1000; 

u3,min = 363;  u3,max = 403; 

u4,min = 363;  u4,max = 403; 

u5,min = 369;  u5,max = 409; 

u6,min = 371;  u6,max = 411; 

 

Variação máxima de cada variável manipulada: dumax = [0,01*[ umax - umin]]; 

 

Período de amostragem (minutos): T = 1; 

 

Horizonte de controle: m = 1; 

 

Horizonte de predição para inclusão dos tempos mortos: np = 22; 

 

Vetor de supressão das variações das manipuladas: R = [1200 300 3600 3600 3600 3600]; 

 

Vetor de peso das controladas: Q = [0,50   2,00   0,50   1,00   1,00]; 

 

Vetor de peso dos Targets: uQ
~

 = [0 0 0 0 0 0]; 

 

Matriz de pesos das variáveis de folga s
k? : S1=1000,0; 

 

Matriz de pesos das variáveis de folga u
k? : Su=0,0; 

 

Estado estacionário das variáveis controladas em unidades de engenharia: 

 yo_ss = [367  39,4  1986  28,4  19,5]; 

 

Estado estacionário das variáveis manipuladas em unidades de engenharia: 

 uo_ss = [5500   900   383   383   389   391]; 

 



 
 

80 
 

Peso da função de Otimização Online na resolução do problema de controle: 

 

Potim = diag([0,0    0,0    0,0    0,0    0,0   0,0)]; 

 

O vetor de pesos da função objetivo de otimização online Potim foi zerado no caso base 

porque neste não inclui otimização online.  

  

5.2.1 – Estudo de Caso 1 – Mudanças nas Faixas Operacionais de WABT e Teor de 

Enxofre, modelo sem incerteza 

 

Nesta simulação ocorrem duas mudanças sequenciais nas faixas operacionais das variáveis 

WABT (y1) e teor de enxofre no produto (y2). Os limites máximos e mínimos das variáveis 

foram mudados da seguinte forma nos instantes k = 2 e k=150: 

 

Para k =2: 

 

y1,min = 369,5;  y1,max = 377,0; 

y2,min = 29,4;  y2,max = 35,4; 

 

 

 

Para k =150: 

y1,min = 357,0;  y1,max = 366,0; 

y2,min = 41,4;  y2,max = 45,4; 

 

 

Os resultados dessas alterações se encontram nas figuras 5.1, 5.2, 5.3, 5.4 e 5.5: 

 

 



 
 

81 
 

 

Figura 5.1 – Estudo de Caso 1 – Variáveis Controladas (y1 – WABT [ºC]; y2 – Enxofre 

[ppm]; y3 – Total de Instáveis [m
3/d]) 

 

 

Figura 5.2 – Estudo de Caso 1 – Variáveis Controladas (y4 – Excesso de H2 [kNm
3/d]; 

y5 – Pressão de H2 para C-02  [kgf/cm
2]) 



 
 

82 
 

 

Figura 5.3 – Estudo de Caso 1 – Variáveis Manipuladas (u1 – Carga [m
3/d]; u2 – Vazão de 

Instáveis [m3/d]; u3 – T. Saída do Forno [ºC]) 

 

 

Figura 5.4 – Estudo de Caso 1 – Variáveis Manipuladas (u4 – T. Entrada R1L2 [ºC]; u5 – T. 

Entrada R2L1 [ºC]; u6 – T. Entrada R2L2 [ºC]) 



 
 

83 
 

 

Figura 5.5 – Estudo de Caso 1 – Evolução do Valor Total da Função Objetivo 

 

 

No instante k=2, conforme se pode observar na figura 5.1, a faixa operacional do teor de 

enxofre teve seus limites máximo e mínimo reduzidos. O controlador atuou elevando as 

temperaturas de entrada nos leitos de reação (u3, u4, u5, u6), como se vê nas figuras 5.3 e 5.4. 

Percebe-se que a elevação dessas temperaturas foi além da necessária para atingir a redução 

no teor de enxofre, pois também tiveram o objetivo de atingir o valor mínimo de WABT. 

 

 

No instante k=150, ocorreu o movimento no sentido contrário, com elevação dos limites da 

faixa operacional do teor de enxofre no diesel tratado e redução nos de WABT. Para atingir 

esse novo objetivo de controle, o controlador elevou a vazão de instáveis e reduziu as 

temperaturas dos leitos. Após as ações de controle o sistema por fim se estabilizou com todas 

as variáveis dentro de seus limites estabelecidos. 

 

 

 



 
 

84 
 

5.2.2 – Estudo de Caso 2 – Mudanças Seguidas nas Faixas Operacionais de WABT e 

Teor de Enxofre, modelo sem incerteza, com otimização online 

 

Nesta simulação, de forma semelhante ao estudo de caso 1, item 5.2.1, ocorrem duas 

mudanças sequenciais nas faixas operacionais das variáveis WABT (y1) e teor de enxofre no 

produto (y2). Os limites máximos e mínimos das variáveis foram mudados em relação ao caso 

base no instante k=1:  

y1,min = 357;  y1,max = 377; 

y2,min = 29.4;  y2,max = 49.4; 

y3,min = 1970;  y3,max = 2000; 

y4,min = 18.4;  y4,max = 38.4; 

y5,min = 9.5;  y5,max = 29.5; 

 

As mudanças nos batentes das faixas operacionais, que podem ser observadas na figura 5.6, 

ocorreram nos instantes k = 2 e k = 150, da seguinte forma: 

 

Para k =2: 

y1,min = 369,0;  y1,max = 377,0; 

y2,min = 29.4;  y2,max = 35.4; 

 

 

Para k =150: 

y1,min = 357,0;  y1,max = 367; 

y2,min = 41.4;  y2,max = 45.4; 

 

Além disso, nesta simulação também foi empregada otimização online acoplada à camada de 

controle, conforme descrita no item 5.1. Os resultados dessas alterações se encontram nas 

figuras 5.6, 5.7, 5.8, 5.9 e 5.10, onde se pode observar os resultados das ações de otimização 

sobre o sistema: 



 
 

85 
 

 

Figura 5.6 – Estudo de Caso 2 – Variáveis Controladas (y1 – WABT [ºC]; y2 – Enxofre 

[ppm]; y3 – Total de Instáveis [m
3/d]) 

 

 

Figura 5.7 – Estudo de Caso 2 – Variáveis Controladas (y4 – Excesso de H2 [kNm
3/d]; 

 y5 – Pressão de H2 para C-02  [kgf/cm
2]) 



 
 

86 
 

 

Figura 5.8 – Estudo de Caso 2 – Variáveis Manipuladas (u1 – Carga [m
3/d]; u2 – Vazão de 

Instáveis [m3/d]; u3 – T. Saída do Forno [ºC]) 

 

 

Figura 5.9 – Estudo de Caso 2 – Variáveis Manipuladas (u4 – T. Entrada R1L2 [ºC]; u5 – T. 

Entrada R2L1 [ºC]; u6 – T. Entrada R2L2 [ºC]) 



 
 

87 
 

 

Figura 5.10 – Estudo de Caso 2 – Evolução do Valor Total da Função Objetivo 

 

Novamente, a faixa operacional de WABT tem seus limites aumentados e a faixa operacional 

do teor de enxofre tem seus limites reduzidos no instante k=2, gerando como ação de controle 

elevações nas temperaturas de entrada nos leitos de reação, conforme as figuras 5.6, 5.7, 5.8 e 

5.9. Da mesma forma que no estudo de caso 1, essas elevações de temperatura foram feitas na 

medida para atingir o novo valor mínimo de WABT (y1) e ao mesmo tempo o valor mínimo 

do teor de enxofre (y2), que tem maior peso. Paralelamente a isso, a otimização online atuou 

aumentando a carga total da unidade e a vazão de instáveis (u1 u2). Contudo, essa ação foi 

limitada pelo limite máximo do total de Instáveis (y3). 

 

No instante k=150, com a redução na faixa operacional de WABT e o aumento na faixa do 

teor de enxofre, o controlador reduziu as temperaturas dos leitos e manteve a vazão de 

instáveis (u2) constante, pois esta continuou limitada pelo total de Instáveis (y3), e prosseguiu 

aumentando a carga total da planta, (u1). 

 

O sistema por fim se estabilizou com todas as variáveis dentro de seus limites estabelecidos e, 

devido à otimização online, houve um aumento relevante nas cargas total e de instáveis 

processadas. 



 
 

88 
 

5.2.3 – Estudo de Caso 3 – Mudanças Seguidas nas Faixas Operacionais de WABT e 

Teor de Enxofre, modelo sem incerteza, com otimização online e controle “Funnel” 

 

Nesta simulação foram utilizados exatamente os mesmos parâmetros do item 5.2.2, porém 

desta vez o algoritmo contemplou a estratégia do Funnel, conforme descrita no item 4.3. A 

mudança no algoritmo faz com que, ao invés de perseguir uma trajetória de referência fixa e 

igual ao limite máximo ou mínimo para as controladas, o controlador procura fazer com que 

as controladas transitem para sua zona operacional seguindo uma trajetória linear. Nesse caso, 

usando o mesmo peso para as variáveis “slack” do problema de controle, obtém-se 

naturalmente movimentos mais lentos das variáveis manipuladas e controladas, conforme é de 

fato o objetivo do controle MPC com “Funnel”. Sob todos os demais aspectos, a atuação do 

controlador foi idêntica e os resultados, bastante semelhantes, como pode-se observar nas 

figuras 5.11, 5.12, 5.13, 5.14 e 5.15 a seguir: 

  

 

Figura 5.11 – Estudo de Caso 2 – Variáveis Controladas (y1 – WABT [ºC]; y2 – Enxofre 

[ppm]; y3 – Total de Instáveis [m
3/d]) 



 
 

89 
 

 

Figura 5.12 – Estudo de Caso 2 – Variáveis Controladas (y4 – Excesso de H2 [kNm
3/d]; 

 y5 – Pressão de H2 para C-02  [kgf/cm
2]) 

 

 

Figura 5.13 – Estudo de Caso 2 – Variáveis Manipuladas (u1 – Carga [m
3/d]; u2 – Vazão de 

Instáveis [m3/d]; u3 – T. Saída do Forno [ºC]) 



 
 

90 
 

 

Figura 5.14 – Estudo de Caso 2 – Variáveis Manipuladas (u4 – T. Entrada R1L2 [ºC]; u5 – T. 

Entrada R2L1 [ºC]; u6 – T. Entrada R2L2 [ºC]) 

 

 

 

Figura 5.15 – Estudo de Caso 2 – Evolução do Valor Total da Função Objetivo 



 
 

91 
 

5.2.4 – Estudo de Caso 4 – Mudanças Seguidas nas Faixas Operacionais de WABT e 

Teor de Enxofre, modelo com incerteza, com otimização online e controle “Funnel” 

 

Este estudo de caso adota exatamente as mesmas alterações de faixas operacionais e 

parâmetros que os estudos de caso 2 e 3 e, assim como no estudo de caso 3, utilizou-se o 

controlador com “Funnel”. Entretanto, modelos distintos foram utilizados para simular a 

resposta da planta de processo e para calcular as ações de controle. Ou seja, foram gerados 

modelos com incertezas para a variável y2, teor de enxofre, em relação às temperaturas de 

entrada nos leitos reacionais u3, u4, u5 e u6. Estes novos modelos possuem ganhos estáticos 

15% maiores que os do modelo original. 

 

Tabela 5.2 – Estudo de Caso 4 – Modelos de Processo em Função de Transferência Contínua 

 y2 (planta) y2 (modelo) 

u3 
16

1.4375-

+s
 

16

25,1

+
?

s
 

u4 
16

1.4375-

+s
 

16

25,1

+
?

s
 

u5 
16

1.4375-

+s
 

16

25,1

+
?

s
 

u6 
16

1.4375-

+s
 

16

25,1

+
?

s
 

 

 

 

Os resultados obtidos pela simulação com modelo com incertezas se encontram nas figuras 

5.16, 5.17, 5.18, 5.19 e 5.20 a seguir: 

 



 
 

92 
 

 

Figura 5.16 – Estudo de Caso 3 – Variáveis Controladas (y1 – WABT [ºC]; y2 – Enxofre 

[ppm]; y3 – Total de Instáveis [m
3/d]) 

 

 

 

Figura 5.17 – Estudo de Caso 3 – Variáveis Controladas (y4 – Excesso de H2 [kNm
3/d]; 

y5 – Pressão de H2 para C-02  [kgf/cm
2]]) 



 
 

93 
 

 

Figura 5.18 – Estudo de Caso 3 – Variáveis Manipuladas (u1 – Carga [m
3/d]; u2 – Vazão de 

Instáveis [m3/d]; u3 – T. Saída do Forno [ºC]) 

 

 

Figura 5.19 – Estudo de Caso 3 – Variáveis Manipuladas (u4 – T. Entrada R1L2 [ºC]; u5 – T. 

Entrada R2L1 [ºC]; u6 – T. Entrada R2L2 [ºC]) 



 
 

94 
 

 

Figura 5.20 – Estudo de Caso 3 – Evolução do Valor Total da Função Objetivo 

 

Comparando-se estes resultados do caso 3 com os do caso 2, percebe-se na figura 5.16 que 

surgiu uma lenta oscilação nas variáveis controladas y1 (WABT) e y2 (Enxofre), mas que esta 

se deu quase totalmente dentro da suas respectivas zonas operacionais, o portanto não 

penalizou a função objetivo de forma significativa. Essa oscilação ocorreu devido à oscilação 

nas variáveis manipuladas u3, u4, u5 e u6, conforme se observa nas figuras 5.18 e 5.19, e por 

sua vez essa oscilação foi causada pelo erro de 15% no modelo dessas variáveis. A oscilação 

também não é penalizada de forma significativa, pois os valores da matriz de supressão das 

variáveis manipuladas são pequenos em relação aos demais parâmetros da função objetivo.  

 

Desta forma, mesmo havendo certa degradação nas respostas do controlador esta não impediu 

a obtenção de uma resposta satisfatória do algoritmo de controle utilizando um modelo de 

processo com incertezas, tendo sido capaz de atingir de forma adequada os objetivos de 

controle definidos. De fato, as figuras 5.15 (modelo perfeito) e 5.20 (modelo com incerteza), 

que mostram a evolução do valor da função objetivo ao longo do tempo de simulação em cada 

caso não apresentam diferenças marcantes entre si. Mesmo assim, fica claro que o controlador 

proposto é sensível à incerteza e, portanto, não muito robusto. 

 

 



 
 

95 
 

5.2.5 – Estudo de Caso 5 – Implementação de targets para as variáveis manipuladas 

 

Nesta simulação, os seguintes valores foram estabelecidos como targets para as seis 

manipuladas: 

 

Usp,i =  [ 5600   920    386,5   386,0   391,5   393,0]; 

 

Sendo que estes valores tomam o estado estacionário como referência. Os limites máximo e 

mínimo das controladas foram estabelecidos de forma a obter uma zona de controle 

suficientemente ampla para evitar que sua manutenção entrasse em conflito com a 

implementação dos targets das variáveis manipuladas. 

 

 Dessa forma, definiu-se:   

 

y1,min = 360;  y1,max = 374; 

y2,min = 29.4;  y2,max = 49.4; 

y3,min = 1956;  y3,max = 2016; 

y4,min = 3.4;  y4,max = 53.4; 

y5,min = 17.5;  y5,max = 21.5; 

 

Todas as controladas estão ativas, mas por estarem longe dos batentes o controlador pode 

implementar os targets sendo limitado apenas pelo limite de máximo movimento e o peso 

fator de supressão de movimento no algoritmo de otimização. Além disso, os parâmetros 

referentes ao peso dos targets foram modificados em relação ao caso base: 

 

Su=diag([24 120 300 300 300 300]); 

 

uQ
~

 = diag([1 1 1 1 1 1] [1 1 1 1 1 1] [1 1 1 1 1 1]); 

 

Os resultados são apresentados a seguir nas figuras 5.21, 5.22, 5.23, 5.24 e 5.25: 

 



 
 

96 
 

 

Figura 5.21 – Estudo de Caso 5 – Variáveis Controladas (y1 – WABT [ºC]; y2 – Enxofre 

[ppm]; y3 – Total de Instáveis [m
3/d]) 

 

 

 

Figura 5.22 – Estudo de Caso 5 – Variáveis Controladas (y4 – Excesso de H2 [10
-3 m3/d, 

CNPT]; y5 – Pressão de H2 para C-02  [kgf/cm
2]]) 

 

 



 
 

97 
 

 

Figura 5.23 – Estudo de Caso 5 – Variáveis Manipuladas (u1 – Carga [m
3/d]; u2 – Vazão de 

Instáveis [m3/d]; u3 – T. Saída do Forno [ºC]) 

 

 

Figura 5.24 – Estudo de Caso 5 – Variáveis Manipuladas (u4 – T. Entrada R1L2 [ºC]; u5 – T. 

Entrada R2L1 [ºC]; u6 – T. Entrada R2L2 [ºC]) 



 
 

98 
 

 

Figura 5.25 – Estudo de Caso 5 – Evolução do Valor Total da Função Objetivo 

 

Observa-se nas figuras 5.23 e 5.24 que todas as variáveis manipuladas de fato caminharam ao 

simultaneamente para os targets estipulados e, sem restrições, a função objetivo pode ser 

quase zerada. De fato, com um maior tempo de simulação, a função objetivo de fato atingiria 

o valor zero quando a vazão de carga total, u1, atingisse o seu target. 

 

 

5.2.6 – Estudo de Caso 6 – Implementação de targets para as variáveis manipuladas, 

com restrições nas variáveis controladas 

 

Nesta simulação, os targets das manipuladas utilizados no estudo de caso 5, item 5.2.5, foram 

mantidos, bem como os demais parâmetros: 

 

Usp,i =  [ 5600   920    386,5   386,0   391,5   393,0]; 

 

Sendo que, novamente, estes valores tomam o estado estacionário como referência. 

Entretanto, um novo e mais restrito limite mínimo foi definido para y2, de forma que os 

targets não podem ser atingidos sem que y2 venha a violar seu limite mínimo, sendo que os 

demais limites permaneceram constantes. Definiu-se: 



 
 

99 
 

 

y1,min = 360;  y1,max = 374; 

y2,min = 38.4;  y2,max = 49.4; 

y3,min = 1956;  y3,max = 2016; 

y4,min = 3.4;  y4,max = 53.4; 

y5,min = 17.5;  y5,max = 21.5; 

 

Os resultados da simulação com otimização pela por implementação de targets se encontram 

nas figuras 5.26, 5.27, 5.28, 5.29 e 5.30 abaixo: 

 

 

 

Figura 5.26 – Estudo de Caso 6 – Variáveis Controladas (y1 – WABT [ºC]; y2 – Enxofre 

[ppm]; y3 – Total de Instáveis [m
3/d]) 



 
 

100 
 

 

Figura 5.27 – Estudo de Caso 6 – Variáveis Controladas (y4 – Excesso de H2 [10
-3 m3/d, 

CNPT];  y5 – Pressão de H2 para C-02  [kgf/cm
2]]) 

 

 

 

Figura 5.28 – Estudo de Caso 6 – Variáveis Manipuladas (u1 – Carga [m
3/d]; u2 – Vazão de 

Instáveis [m3/d]; u3 – T. Saída do Forno [ºC]) 



 
 

101 
 

 

Figura 5.29 – Estudo de Caso 6 – Variáveis Manipuladas (u4 – T. Entrada R1L2 [ºC]; u5 – T. 

Entrada R2L1 [ºC]; u6 – T. Entrada R2L2 [ºC]) 
 

 

Figura 5.30 – Estudo de Caso 6 – Evolução do Valor Total da Função Objetivo 

 



 
 

102 
 

Observa-se nas figuras 5.28 e 5.29 que as variáveis manipuladas referentes às temperaturas de 

entrada dos leitos (u3, u4, u5, u6) se aproximaram dos targets, mas esta aproximação foi 

limitada pelo limite inferior de y2, teor de enxofre, que atuou como restrição, impedindo que a 

função objetivo pudesse ser zerada, como se pode observar na figura 5.26. Ou seja, para evitar 

que o teor de enxofre mínimo no produto fosse violado o controlador teve que moderar os 

aumentos nas temperaturas dos leitos reacionais e, consequentemente, nas taxas de reação. 

 

  



 
 

103 
 

6 – Conclusões 

 

No presente trabalho, foi estudada a implementação de um controle avançado MPC para uma 

unidade de refino de hidrotratamento óleo diesel. As estratégias encontradas na indústria 

mundial de refino de petróleo para controle de UHDT foram discutidas e em seguida foram 

replicadas através da utilização um algoritmo de controle experimental. O controlador MPC 

considerado aqui possui algumas características interessantes como o horizonte infinito de 

predição e o controle por zonas e funis das saídas do processo. O horizonte infinito de 

previsão resulta em estabilidade nominal do sistema em malha fechada e o controle por zonas 

e funis das saídas libera alguns graus de liberdade para a otimização em tempo real do 

processo.  

 

A otimização pode ser obtida através de duas abordagens distintas: na primeira abordagem os 

“targets” ou valores de referência para as variáveis, calculados por um otimizador externo, são 

incluídos na função objetivo de controle através de um termo adicional que penaliza a 

distância entre as entradas do processo e os “targets” previstos; na segunda abordagem a 

otimização do processo é incluída diretamente no controlador, sem a presença de um 

otimizador externo. Nesse caso a otimização é feita através da inclusão de um termo na 

função objetivo que penaliza o gradiente de uma função objetivo econômica diretamente no 

controlador, de forma que quando o processo se afasta do ponto operacional ótimo econômico 

esse movimento é penalizado, o que resulta em ações de controle em sentido contrario. Na 

versão estendida do controle MPC considerada aqui o controle por zonas das saídas é 

expandido com a inclusão de trajetórias em funil para as saídas cuja predição se encontra fora 

das respectivas zonas de controle.  

 

As simulações apresentadas aqui demonstraram que a estrutura de controle avançado proposta 

para UHDT em conjunto com o algoritmo de controle MPC apresentado têm bom 

desempenho para cenários operacionais usuais. O controlador é capaz de estabilizar o sistema 

suavemente e direcionar a unidade de processo as condições mais rentáveis. Ficou 

demonstrado que esse controlador, se bem sintonizado, atua de forma muito consistente e 

suave no processo e possui as características desejadas de estabilidade e eficácia e poderia, em 

tese, ser implementado numa planta real. 



 
 

104 
 

7 – Referências Bibliográficas 

 

ASTROM, K. J., WITTENMARK B., Computer Controlled Systems: Theory and Design, 

Prentice-Hall, 2ªedição, (1990). 

BADGWELLl, T. A. (1997). Robust model predictive control of stable linear systems. 

International Journal of Control, 68, 797–818. 

CAMACHO, E. F., &amp;amp; BORDONS, C. A., Model Predictive Control, Springer, 2ª edição, 

(2008). 

CAMPOS, M., TEIXEIRA, H., LIPORACE, F., GOMES, M., Challenges and problems with 

advanced control and optimization technologies, Advanced Control of Chemical Processes, 

Volume # 7 | Part# 1, Koç University Campus, Turkey, (2009). 

CARRAPIÇO ¸ O. L., SANTOS, M. M., ZANIN, A. C., &amp;amp; ODLOAK, D. (2009). Application 

of the IHMPC to an industrial process system with integrating output. In Symposium on 

advanced control of chemical processes (ADCHEM 2009) Istambul, Turkey. 

CARRAPIÇO, O. L. (2004). Controle Preditivo de Horizonte Infinito para Processos 

Integradores com Tempo Morto. Dissertação de Mestrado. EPUSP, São Paulo. 

CARRAPIÇO¸ O. L., &amp;amp; ODLOAK, D. (2005). A stable model predictive control for 

integrating process. Computers and Chemical Engineering, 29, 1089–1099. 

COELHO, L.S., MARIANI, V.C., Evolução diferencial híbrida com programação quadrática 

aplicada ao problema de despacho econômico de energia elétrica. Sba Controle &amp;amp; 

Automação vol.17 nº4 Campinas (2006). 

CUTLER, C. R. &amp;amp; RAMAKER, B. L. (1979). Dynamic matrix control – a computer control 

algorithm. AIChE 86th National Meeting, Houston, TX. 

GARCIA, C. E. &amp;amp; MORSHEDI, A. M. (1986). Quadratic programing solution of dynamics 

matrix control (QDMC). Chem. Engng Commun., v.46, p.73-87. 

GONZALEZ, A &amp;amp; ODLOAK, D. (2009). A stable MPC with zone control. Journal of Process 

Control, 19, p.110-122. 



 
 

105 
 

GOUVÊA, M. T. &amp;amp; ODLOAK, D. (1997). ROSSMPC: A new way of representing and 

analysing the predictive controllers. Trans IchemE, v.75, n.4, p.707-717. 

GOUVÊA, M. T. &amp;amp; ODLOAK, D. One-layer real time optimization of LPG production in the 

FCC unit: procedure, advantages and disadvantages. Computers Chem. Engng., 22, Suppl., p. 

191 (1998). 

JAZWINSKI, A. H. Stochastic Processes and Filtering Theory. 1st ed. V. 1. Academic Press, 

USA, (1997). 

KALID, R. A. (1999). Modelagem, Simulação, Controle e Otimização de Conversores de 

Acetileno. Dissertação de Doutorado. EPUSP, São Paulo. 

KOTHARE, M. V., BARAKRISHNAN, V., &amp;amp; MORARI, M. (1996). Robust constrained 

model predictive control using linear matrix inequalities. Automática, 32, 1361–1379. 

KWONG, W. H. Otimização de Plantas Industriais Complexas, Tese de Doutoramento, 

Universidade de São Paulo/EPUSP, São Paulo (1992). 

LEE, J. H., &amp;amp; YU, Z. (1997). Worst case formulation of model predictive control for systems 

with bounded parameters. Automatica, 33(5), 763–781. 

MACIEJOWSKI, J., Predictive Control with Constraints, Prentice Hall, 1ª edição, (2000). 
 
MARLIN, T., Process Control: Designing Processes and Control Systems for Dynamic 

Performance, McGraw-Hill Science/Engineering/Math, 2ª edição, (2000). 

MAYNE, D. Q., RAWLINGS, J. B., RAO, C. V., &amp;amp; SCOKAERT, P. O. (2000). Constrained 

model predictive control: stability and optimality. Automatica, 36, 789–814. 

MEYERS, R., Handbook of Petroleum Refining Processes, McGraw-Hill Professional, 3ª 

edição (2003). 

ODLOAK, D. (1996). A new state-space approach to model predictive control, Brazilian 

Journal of Chem. Engng, v.13, n.3, p.152-167. 

ODLOAK, D. (2004). Extended robust model predictive control. AIChE Journal, 50(8), 

1824–1836. 



 
 

106 
 

PACHECO, D. A. (2009). Controle do sistema de produção de alumínio com RMPCT de 

horizonte infinito. Dissertação de Mestrado. EPUSP, São Paulo. 

PORFÍRIO, C. R. (2011). Implantação de Otimizador Online acoplado ao Controle Preditivo 

(MPC) de uma Coluna de Tolueno. Dissertação de Mestrado. EPUSP, São Paulo. 

PORFIRIO, C. R., NETO, E. A., &amp;amp; ODLOAK, D. (2003). Multi-model predictive control of 

an industrial C3/C4 splitter. Control Engineering Practice, 11(7), 765–779. 

RALHAN, S., &amp;amp; BADGWELL, T. A. (2000). Robust control of stable linear systems with 

continuous uncertainty. Computer and Chemical Engineering, 24, 2533–2544. 

RAWLINGS, J.B &amp;amp; K.R MUSKE (1993). The stability of constrained multivariable receding 

horizon control. IEEE Trans. Autom. Cont., 38, p.1512-1516. 

RICKER, N, L. Model Predictive Control with State Estimation. Industrial Engineering 

Chemical Reser., v. 29, p. 374-382 (1990). 

RODRIGUES, M. A. &amp;amp; ODLOAK D. (2003). An infinite horizon model predictive control 

for stable and integrating processes. Computers Chem. Engng, v.27, p. 1113-1128. 

ROSSITER, J.A., Model-Based Predictive Control: A Practical Approach, CRC Press, 1ª 

edição (2003). 

ROTAVA, O., &amp;amp; ZANIN, A. C, Multivariate Control and real time optimization. 

Hydrocarbon Processing, Agosto, p 63, 2005. 

SCHNELLE, P. D., LAMON, J., &amp;amp; BADGWELL, T. A. (2007). Application of state space 

MPC to a commercial scale dilution/pasteurization/drying process. In Proceedings of the 

annual ISA analysis division symposium 4, October , pp. 2828–2855. 

SOUZA, G. F. (2007). Integração da Otimização em Tempo Real com Controle Preditivo. 

Dissertação de Mestrado. EPUSP, São Paulo. 

YING, C. M., &amp;amp; JOSEPH, B. (1999). Performance and stability analysis of LP-MPC and QP-

MPC cascade control systems. AIChE Journal, 45(7), 1521–1534. 

ZANIN, A.C., GOUVÊA, M.T., ODLOAK, D. Comparing different real-time optimization 

strategies for the FCC catalytic converters. In: ADCHEM 2000 International Symposium on 

Advanced Control of Chemical Processes, Pisa, June, 14-16, 2000, Proceedings, 2000a. 


</field>
	</doc>
</add>