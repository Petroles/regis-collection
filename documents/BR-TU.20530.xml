<?xml version="1.0" encoding="utf-8"?>
<add>
	<doc>
		<field name="docid">BR-TU.20530</field>
		<field name="filename">4101_103706.pdf</field>
		<field name="filetype">PDF</field>
		<field name="text">
UNIVERSIDADE FEDERAL DE SANTA CATARINA 

CURSO DE PÓS-GRADUAÇÃO EM ENGENHARIA MECÂNICA

SOLUÇÃO NUMÉRICA USANDO MÉTODOS ADAFIATIVOS-IMPLÍCITOS E MALHA 

DE VORONOI DE PROBLEMAS DE RESERVATÓRIOS DE PETRÓLEO

TESE SUBMETIDA À UNIVERSIDADE FEDERAL DE SANTA CATARINA PARA A 
OBTENÇÃO DO GRAU DE DOUTOR EM ENGENHARIA

FRANCISCO MARCONDES

FLORIANÓPOLIS, ABRIL DE 1996



SOLUÇÃO NUMÉRICA USANDO MÉTODOS ADAPTATWOS-IMPLÍCITOS E MALHA 

DE VORONOI DE PROBLEMAS DE RESERVATÓRIOS DE PETRÓLEO

FRANCISCO MARCONDES

ESTA TESE FOI JULGADA PARA OBTENÇÃO DO TITULO DE 

DOUTOR EM ENGENHARIA

ESPECIALIDADE ENGENHARIA MECANICA E APROVADA EM SUA FORMA FINAL 

PELO PROGRAMA DE PÓS-GRADUAÇÃO EM E N G E N H A R ^ MECÂNICA

Antônio Fábio Carvalho da ^filva, D. Eng. Mec. - Coordenador do Curso 

BANCA EXAMINADORA:

Prof. Álvaro L. G. de Azeredo Coutinho, D. Sc. - Relator



iii

A minha esposa Reneuda e à minha filh a  

Rebeca, minhas musas inspiradoras, pelo carinho e 

paciência nestes tempos difícieis; aos meus pais, M oisés 

(in memorian) e Naíde, pela preciosa e indispensável 

formação.



AGRADECIMENTOS iv

Ao Prof. Clovis Raimundo Maliska, pela valiosa orientação, escolha de tema e pela 

amizade adquirida ao longo dos anos.

Ao Prof. Mario Cesar Zambaldi, do Dep. de matemática da UFSC, pela valiosa 

cooperação na solução de sistemas lineares e pela amizade.

Ao Clovis Raimundo Maliska Jr. por ter iniciado o gerador de malhas de Voronoi que 

permitiu a realização do presente trabalho.

Ao Amigo Axel Dilhamn pela amizade e cooperação nos momentos dificieis.

Ao doutorando João Flávio de Vasconcellos pela prestigiosa revisão do texto deste 

trabalho.

Ao Marcos Livramento pela ajuda com os diversos sofwares disponíveis no SINMEC.

Ao demais membros do SINMEC pela convivência agradável e harmoniosa.

Aos professores do Departamento de Engenharia Mecânica da UFPB, Campus II, 

principalmente os colegas da área térmica, por terem viabilizado o meu afastamento para 

conclusão deste trabalho.

A CAPES pelo auxílio financeiro.



SUMÁRIO V

Resumo ........................................................................................................................................ viii

A b s tr a c t ..........................................................................................................................................  ix

Lista de F ig u ra s ................................................................................................................................  x

Lista de Tabelas .................  ..................................................................................................  xiii

S im b o lo g ia .....................................................................................................................................  xv

1. In trodução.....................................................................................................................................  1

1.1 Preliminares ............................................................................................................... 1

1.2 Malhas Utilizadas .....................................................................................................  4

1.3 Técnicas de Solução das E q u a çõ es..........................................................................  9

1.4 Solução dos Sistemas Lineares ............................................................................  11

1.5 Esboço da Tese .......................................................................................................  13

2. F o rm u laçã o ................................................................................................................................  17

2.1 In tro d u ção ........................................................................................... ...................... 17

2.2 Modelo Composicional ........................................................................................  17

2.3 Modelo Black-Oil ..................................................................................................  19

2.4 Modelo Black-Oil do Presente T ra b a lh o .............................................................  20

3. Métodologias Explícita, Implícita e A d a p ta tiv a ..................................................................  23

3.1 In tro d u ção .................................................................................................................  23

3.2 Definição do Diagrama de Voronoi ..................................................................... 23

3 .3 Integração das Equações G overnantes..................................................................  25

3.4 Fator de Correção C ilín d ric a .................................................................................  29

3.5 Metodologia Totalmente Implícita .....................................................................  33

3.6 Metodologia IM P E S ................................................................................................  37

3.6.1 Procedimento Iterativo Utilizando o Esquema I M P E S .................... 39

3.7 Metodologia Implícita Adaptativa .......................................................................  40

3.7.1 Critério de Mudança de um Volume de IMPES para TI e Vice-



Sumário vi

V e r s a ................................................................................................... 44

3.8 - Escolha do Passo de T e m p o ................................................................  52

4. Métodos de Solução dos Sistemas L in e a re s..........................................................................  54

4.1 In tro d u ç ã o .................................................................................................................  54

4.2 P recondicionam ento................................................................................................  54

4.3 Ordenação das Incógnitas ............................................................. ........................  57

4.4 Métodos de S o lu ç ã o ................................................................................................  62

4.4.1 Método G M R E S .................................................................................... 63

4.4.2 Método B i-C G S T A B ............................................................................  65

4.4.3 Método O R TH O M IN ............................................................................  66

5 - Validação do Modelo N u m érico ...........................................................................................  68

5.1 In tro d u ção .................................................................................................................  68

5.2 Comparação com os Resultados de Palagi (1992) ............................................  68

5.3 Comparação com o SIRP-3D ...............................................................................  82

5.4 Análise de C a s o ........................................................................................................ 100

6 - Resultados: Comparação Entre as Metodologias TI, IMPES E A I M .......... ............... 107

6.1 In tro d u ção .................................................................................................................  107

6.2 Efeito do Critério de Parada das Iterações Newtonianas ................................  108

6.3 Análise das Metodologias IMPES, AIM e TI .................................................... 112

7 - Resultados: Comparação Entre Métodos de Solução de Sistemas Lineares .................  123

7.1 In tro d u ção .................................................................................................................  123

7.2 Efeito da Ordenação MDF .................................................................................... 123

7.3 Comparação Entre os Métodos de Solução dos Sistemas L in e a r e s .................  131

8. Conclusões .............................................................................................................................. 136

Referências Bibliográficas 140



Sumário

Apêndice A



RESUMO Vlll

O objetivo do presente trabalho é o desenvolvimento de um modelo numérico usando 

malhas de Voronoi para a solução de problemas de reservatório de petróleo. Empregou-se o 

modelo black-oil, bifásico (óleo-água) e as equações foram discretizadas utilizando-se o Método 

dos Volumes Finitos.

Implementou-se três metodologias de solução, a saber: IMPES - Implicit Pressure 

Explicií Saturation, TI - Totalmente Implícita e AIM - Adaptive Implicit Method. Apesar do uso 

destas metodologias por vários autores, os critérios empregados para troca de IMPES para TI e 

vice-versa e parada das iterações newtonianas não são claramente apresentados e discutidos na 

literatura. Portanto, uma das contribuições do presente trabalho é uma discussão destes tópicos 

usando malhas com conectividade variada.

Malhas híbridas de Voronoi são fortemente usadas neste trabalho devido a sua 

flexibilidade em representar o escoamento em volta dos poços. Um extensivo estudo é realizado 

onde os métodos para solução dos sistemas são analisados considerando os esquemas de 

ordenações das incógnitas e aceleradores de convergência. Com relação aos esquemas de 

ordenação ambos esquemas, ordenação natural, similar à ordenação natural em malhas cartesianas, 

bem como esquemas baseados na estrutura do Jacobiano são considerados. O último método 

ordena as incógnitas baseado nos valores numéricos dos elementos do Jacobiano e é conhecido 

na literatura como MDF - Minimum Discarded Fill. Com relação aos aceleradores de 

convergência empregou-se três métodos largamente conhecidos na literatura: ORTHOMIN, 

GMRES e Bi-CGSTAB. Estes métodos foram comparados entre si em diversas situações práticas.

O modelo numérico desenvolvido foi validado usando resultados numéricos 

disponíveis na literatura e também aplicando o mesmo a situações práticas, onde as malhas 

híbridas de Voronoi são mais indicadas.



ABSTRACT IX

The main goal of the present work is the development of a numerical model using 

Voronoi grids for the solution of fluid flow in petroleum reservoirs. The scheme uses the two- 

phase (oil-water) black-oil model with the equations discretized using finite-volume method.

Three metodologies were implemented, namely, the IMPES - Implicit Pressure 

Explicit Saturation, TI - Totaly Implicit e AIM - Adaptive Implicit Method. Despite the use of 

these metodologies for several authors, the criteria employed for switching from IMPES to TI 

and vice-versa, and for stopping the Newton iterations are not cleary presented and discussed in 

the available literature. Therefore, one of the contributions o f this work is to address these topics 

using grids with variable connectivity.

Voronoi grids are strongly used in this work due their flexibility in representing the 

flow around wells. An extensive study is realized where the methods for solving the linear 

systems of equations are analyzed considering ordering schemes and convergence accelerators. 

With respect to the ordering schemes both, natural ordering, like the ones used in cartesian, as 

well as schemes basead on the structure of the Jacobian are considered. The latter one uses the 

numerical value o f the Jacobian, and it is know in the literature as MDF - Minimum Discarded 

Fill. With respect to the convergence accelerator three well know methods, ORTHOMIN, 

GMRES e Bi-CGSTAB were used. They are fully compared among them.

The numerical model developed is evaluated using available numerical results and 

also applied to practical situations where hybrid Voronoi grids are suitable.



LISTA DE FIGURAS X

Fig. 1 - Amostra do re se rv a tó rio ..................................................................................................  2

Fig. 2 - Malha diagonal e paralela para a configuração de cinco poços ................................  5

Fig. 3 - Diagrama de Voronoi com seis pontos g erad o res......................................................  25

Fig. 4 - Volume de controle de Voronoi para o ponto i ......................................................... 26

Fig. 5 - Bloco de Voronoi contendo um p o ç o ................................................. ........................  29

Fig. 6- Diagrama de Voronoi com 2297 pontos geradores .................................................... 30

Fig. 7 - Módulo cilíndrico .......................................................................................................... 31

Fig. 8 - Conexão ij em uma seção de um módulo c ilín d ric o .................................................  31

Fig. 9 - Bloco mais interno de um módulo cilíndrico..................................  ......................  33

Fig. 10 - Seqüência de passos para obtenção da equação da pressão para o IMPES . . . .  38

Fig. 11 - Exemplo bidimensional utilizando AIM para um escoamento bifásico ............... 41

Fig. 12 -Matriz Jacobiana para o exemplo da Fig. 11 ...........................................................  41

Fig. 13 - Matriz Jacobiana para o exemplo da Fig. 11 para o método AIM ......................  43

Fig. 14 - Discretização da equação de Bucklev-Leverett......................................................... 50

Fig. 15 - Fatoração incompleta de nível 1 - I L U ( l ) ................................................................  57

Fig. 16 - Esquema de ordenação do g e r a d o r ............................................................................  58

Fig. 17 - Malha de Voronoi - esquema de ordenação h o r iz o n ta l.......................................... 59

Fig. 18 - Estrutura da matriz Jacobiana - ordenação h o riz o n ta l............................................  59

Fig. 19 - Representação da eliminação do nó 1 para uma ILU(O) .......................................  60

Fig. 20 - Seqüência necessária para originar a equação reduzida de pressão para a

metodologia T I ...............................................................................................................  62

Fig. 21 - Malha hexagonal-híbrida com 445 volumes ...........................................................  70

Fig. 22 - Escoamento tipo pistão - M = 1 0  ............................................................................  71

Fig. 23 - Escoamento tipo pistão - M = 5 0 ............................................................................... 72

Fig. 24 - Fig. 6.23 do trabalho de Palagi ( 1 9 9 2 ) .....................................................................  74

Fig. 25 - Fig. 6.29 do trabalho de Palagi ( 1 9 9 2 ) .....................................................................  75

Fig. 26 - Escoamento tipo pistão - poço paralelo - M = 1 0 ......................................................  77

Fig. 27 - Escoamento tipo pistão - poço diagonal - M=10 ....................................................  77

Fig. 28 - Escoamento tipo pistão - poço paralelo - M = 5 0 ......................................................  78



Lista de Figuras xi

Fig. 29 - Escoamento tipo pistão - poço diagonal - M=50 .................................................... 78

Fig. 30 - Efeito do fator de correção cilíndrica - escoamento tipo pistão - M=10 ............  79

Fig. 31 - Efeito do fator de correção cilíndrica - escoamento tipo pistão - M=50 ............  79

Fig. 32 - Escoamento típico de reservatório - M=10 .............................................................. 80

Fig. 33 - Escoamento típico de reservatório - M=50 .............................................................. 81

Fig. 34 - Malha generalizada còm 756 volumes (21x36) ......................................................  82

Fig. 35 - Malha hexagonal com 410 v o lu m e s ..........................................................................  83

Fig. 36 - Recuperação - comparação com o SIRP-3D - caso 2 ............................................  85

Fig. 37 - Corte de água - comparação com o SIRP-3D - caso 2 ..........................................  86

Fig. 38 - Pressão - comparação com o SIRP-3D - caso 2 ......................................................  87

Fig. 39 - Algumas das malhas utilizadas para a configuração de oito p o ç o s ......................  88

Fig. 40 - Erro de localização dos poços para a malha g e n e ra liz a d a .....................................  90

Fig. 41 - Erro de localização dos poços para a malha h ex ag o n al..........................................  90

Fig. 42 - Recuperação do poço 1 - comparação com o SIRP-3D - caso 3 ......................... 91

Fig. 43 - Corte de água do poço 1 - comparação com o SIRP-3D - caso 3 ......................  92

Fig. 44 - Pressão do poço 1 - comparação com o SIRP-3D - caso 3 ................................... 93

Fig. 45 - Recuperação do poço 4 - comparação com o SIRP-3D - caso 3 ......................... 94

Fig. 46 - Corte de água do poço 4 - comparação com o SIRP-3D - caso 3 ......................  95

Fig. 47 - Pressão do poço 4 - comparação com o SIRP-3D - caso 3 ..................................  96

Fig. 48 - Recuperação do poço 5 - comparação com o SIRP-3D - caso 3 ......................... 97

Fig. 49 - Corte de água do poço 5 - comparação com o SIRP-3D - caso 3 ......................  98

Fig. 50 - Pressão do poço 5 - comparação com o SIRP-3D - caso 3 ................................... 99

Fig. 51 - Recuperação com pressão capilar - caso 1 .............................................................  103

Fig. 52 - Saturação e pressão com pressão capilar - caso 1 .................................................  104

Fig. 53 - Recuperação com pressão capilar - caso 2 .............................................................. 105

Fig. 54 - Saturação e pressão com pressão capilar - caso 2 .................................................  106

Fig. 55 - Campos de implicitude para quatro valores de VPI - \  -  1,0, \  = 0,8 e ASW= OJOU7

Fig. 56 - Comparação de metodologias - V O R ........................................................................ 118

Fig. 57 - Comparação de metodologias - corte de água ......................................................... 118

Fig. 58 - Corte de água - IMPES - Atmax = 50 dias ................................................................  119

Fig. 59 - Malha hexagonal híbrida com 1026 v o lu m e s ...........................................................  128



Lista de Figuras xii

Fig. 60 - Malha hexagonal com 559 volumes 129



LISTA DE TABELAS xüi

Tab. 1 - Restrição para a equação do p o ç o ...............................................................................  34

Tab. 2 - Número aproximado de operações dos métodos para i ite ra ç õ e s ...........................  67

Tab. 3 - Dados físicos e geométricos do reservatório - caso 1 ............................................  69

Tab. 4 - Dados físicos e geométricos do reservatório - caso 2 ............................................  83

Tab. 5 - Permeabilidades r e la tiv a s .............................................................................................. 84

Tab. 6 - Dados físicos e geométricos do reservatório - caso 3 ............................................  89

Tab. 7 - Pressão capilar ...............................................................................................................  102

Tab. 8 - Fator de formação volumétrico e compressibilidade ............................................... 105

Tab. 9 - Caso típico de reservatório - M=10 - Malha hexagonal híbrida com 445

volumes VPI = 1,82 - ? - flr||/||ro||&lt;10-2; O  - flr||/|Ir0 B&lt;103 .......................................  109

Tab. 10 - Caso típico de reservatório - Malha hexagonal híbrida com 445 volumes -

M=50 VPI = 1,82 - ? - ||r||/ ||r0||&amp;lt;10"2; O- ||r||/ ||r0f&amp;lt;10'3 ............................................... 110

Tab. 11 - Configuração de oito poços - Malha hexagonal com 672 volumes - VPI =

1 , 8 2 |r |/J r oll&lt;10'2;O-|lr|l/Bro|j&lt;10-3 ........................................................................ 111

Tab. 12 - Comparação de metodologias - malha hexagonal-híbrida com 445 volumes -

M=10 - VPI=1,82 - menor tempo de CPU = 236,6 seg............................................. 116

Tab. 13 - Comparação de metodologias - Malha hexagonal-híbrida com 445 volumes -

M=50 VPI =1,82 - menor tempo de CPU = 234,04 seg............................................  120

Tab. 14 - Comparação de metologias - malha hexagonal com 410 volumes - VPI=1,82

menor tempo de CPU = 171,29 seg..............................................................................  121

Tab. 15 - Comparação de metodologias - configuração de oito poços - malha hexagonal-

híbrida com 672 volumes - menor tempo de CPU = 255,03 seg.............................  122

Tab. 16 - Resultados para o problema STR O N G Y utilizando G M R E S ................................  125

Tab. 17 - Resultados para o problema ST R O N G X  utilizando G M R E S ................................  125

Tab. 18 - Resultados para a conf. de cincos poços - 1,0 VPI - M=10 ................................  126

Tab. 19 - Resultados para a conf. de oito poços - 0,50 VPI .................................................  127

Tab. 20 - Resultados para a malha hexagonal com 559 volumes - 0,5 V P I ......................... 129

Tab. 21 - Número de elementos necessários para solução via GMRES com base igual 

a 50, tamanho médio da base e número de elementos para fatoração completa



da matriz Jacobiana .....................................................................................................  130

Tab. 22 - Número médio de elementos armazenados e número de elementos requerido

para a malha hexagonal com 559 volumes com ordenação v e r t ic a l ......................  131

Tab. 23 - Número de iterações e tempo de CPU normalizado - para 1,0 VPI - caso 1 -

M = 1 0 ................................................................................................................................  132

Tab. 24 - Número de iterações e tempo de CPU normalizado - para 0,5 VPI - caso 2 . . . 133

Tab. 25 - Número de iterações e tempo de CPU normalizado - para 0,5 VPI - caso 3 . . . 134

Tab. 26 - Variáveis dependentes para o modelo com posicional............................................  149

Lista de Tabelas xiv



SIMBOLOGIA XV

a = coeficiente de ortogonalidade - algoritmo ORTHOMIN

A = área, m2

b = largura da interface entre dois volumes, m

B = matriz, Nota de rodapé 1 - Pag. 11

Bp = fator de formação volumétrico da fase p

c = vetor, Nota de rodapé 1 - Pag. 11

Cj = constante - algoritmo de controle do passo de tempo

c2 = constante - algoritmo de controle do passo de tempo

Cj = coeficiente da rotação de Givens - algoritmo GMRES

c0 = compressibilidade do componente óleo, Pa'1

cw = compressibilidade do componente água, Pa'1

C = matriz de transformação local, Eq. (60)

CFL = número de Courant-Friedrichs-Lewy

d = distância entre pontos geradores, m

discard(i) = discard do nó i

d((x,y) - p) = distância do ponto (x,y) ao ponto p, m

D = profundidade medida em relação a um plano horizontal (Eq. 98), m

Det = determinante, Eq. (72)

Dj = bloco diagonal

DPLEM = parâmetro de controle do passo de tempo baseado na pressão

DPMAX"*1 = variação máxima na pressão no instante de tempo n+1

DSLIM = parâmetro de controle do passo de tempo baseado na saturação

DSMAX"*-1 = variação máxima na saturação no instante de tempo n+1

e = vetor canônico de m+1 componentes - algoritmo GMRES

EB Cp = erro de balanço percentual de volume do componente p, Eq. (92)

fc = fator de correção cilíndrico

fw = fluxo fracionário da água com pressão capilar, Eq. (90)

fw* = fluxo fracionário da água sem pressão capilar, Eq. (94)



Simbologia xvi

g = aceleração da gravidade, m/dia2

h = profundidade da face ij, m

I = matriz identidade

J  = matriz Jacobiana

/(J,j) = nível, Eq. (80)

L = matriz triangular inferior

Lj = Bloco triangular inferior

k = permeabilidade absoluta no plano horizontal, m2

= base de Krylov

K  = Tensor permebealidade absoluta

Kj = condutividade térmica adimensional na direção x, Eq. (97)

Ky = condutividade térmica adimensional na direção y, Eq. (97)

K.P = permeabilidade relativa da fase p

m = massa, Kg; tamanho da base de Krylov - algoritmo GMRES

nip = massa da fase p nas condições P e T  do reservatório, Kg

iüjp = massa liberada do componente i da fase p nas condições P e T do reservatório, 

Kg

M  = razão de viscosidades óleo/água

= matriz de precondicionamento

n  = vetor normal a superfície

N = número de volumes

Np = número de fases

Nq = número de componentes

Nv = número de vizinhos do volume de controle

p = vetor - algoritmo Bi-CGSTAB

P = vetor - algoritmo Bi-CGSTAB

P0 = pressão do óleo, Pa

Pw = pressão da água, Pa



Simbologia X V ll

Pc = pressão capilar, Pa

P'c = derivada da pressão capilar em relação a saturação da água, Pa

Pp = pressão da fase p, Pa

Pp&gt;i = pressão da fase p no ponto i, Pa

Pwf = pressão de poço, Pa

q = termo fonte, Eq. (98); vetor - algoritmo ORTHOMIN

qll = vazão de líquido produzida no poço 1 (óleo + água), m3/dia

qwl = vazão de água injetada no poço 1, m3/dia

qp = vazão volumétrica da fase p nas condições de reservatório por unidade de 

volume do reservatório, m3/(dia m3)

*pp = vazão de fase p produzida em todos os poços, m3/dia

q wi = vazão de água injetada em todos os poços, m3/dia

qp = vazão volumétrica da fase p nas condições padrão por unidade de volume do

reservatório, m3/(dia m3)

qPii  — vazão volumétrica da fase p do volume i nas condições padrão, m3/dia

r  = vetor resíduo, Eq. (79)

f  = vetor - algoritmo Bi-CGSTAB

r0 = raio equivalente do poço, Eq. (25), m

rc = raio do bloco C, Eq. (31), m

II r  D = norma segunda do vetor resíduo, r

D ro0 = norma segunda do vetor resíduo inicial, r0

re = raio externo, m

rw = raio do poço, m

R = função resíduo

R*pi = função resíduo da fase p no volume i excluído o termo de acumulação, Eqs.

(61)-(62).



Simbologia xviii

= solubilidade do componente i na fase p, Eq. (6)

= vetor - algoritmo Bi-CGSTAB

= vetor - algoritmo Bi-CGSTAB

= coeficiente da rotação de Givens - algoritmo GMRES

= saturação residual do óleo

= saturação inicial da água

= saturação da fase p

= tempo, dia; vetor - algoritmo Bi-CGSTAB

= matriz de transformação, Eq. (56); temperatura

= fator de transmissibilidade

= j-ésima coluna de Ü - algoritmo GMRES

= elementos de Ü - algoritmo GMRES

= matriz de Hessenberg - algoritmo GMRES

= matriz triangular superior

= bloco triangular superior

= tolerância

= vetor - algoritmo GMRES

= Volume, m3

= volume da célula i, m3

= Volume da fase nas condições P e T  do reservatório, m3

= Volume inicial da fase p no início da simulação, m3

= Volume do componente i na fase p nas condições padrão, m3

= Volume final da fase p em cada instante de tempo, m3

= Volume do componente p na fase p nas condições padrão, m3

= velocidade da fase p, m/dia

= velocidade da total (óleo + água), m/dia

= volume de óleo recuperado, Eq. (95)

= volume poroso injetado, Eq. (96)



Simbologia xix

w = vetor - algoritmo GMRES

W I = índice de poço, Eq. (23)

x  = vetor solução, Eq. (86)

x = coordenada cartesiana

x’ = coordenada cartesiana local

X = vetor de incógnitas

X ip = fração mássica do componente i na fase p

z = vetor - algoritmo GMRES; vetor Eq. (88)

Zj = fração mássica global do componente i, Eq. (123);

= matriz (nxm) - algoritmo GMRES

y = coordenada cartesiana

y’ = coordenada cartesiana local

ym = vetor solução do problema de quadrados mínimos - algoritmo GMRES

(. , . )  = produto escalar

DD = norma segunda

Gregos

a  = razão de raios, Eq. (27); coeficiente - algoritmo Bi-CGSTAB

ctj = autovalor i

P = ângulo; coeficiente - algoritmo GMRES

Pt = ângulo total de abertura de fluxo

y = constante, Eq. (73); constante-algoritmo GMRES

ÁPP(i = gradiente de pressão no volume i entre a pressão da fase p e a pressão de poço, 

Eq. (24)

AP‘omax = critério de parada na pressão para o ciclo de Newton

APv+10,niax = variação máxima na pressão no instante v+1

AS*W)1111IX = critério de parada na saturação para o ciclo de Newton

ASvflw,m»  = variação máxima na saturação da água no instante v+1

AX = incremento nas variáveis saturação ou pressão

AXj - dimensão do volume i



Simbologia XX

At = incremento de tempo, dias

At1* 1 = incremento de tempo do instante n+1, dias

A&lt;p = incremento de tempo baseado na pressão, dias

Ats = incremento de tempo baseado na saturação, dias

ASW = variação na saturação para troca de implicitude

e = medida do erro

0y =? ângulo, Eq. (25)

Àq = limite superior para troca forw ard

Xj = limite inferior para troca backward

= mobilidade da fase p

Xj,y = mobilidade da fase p avaliada na face ij do volume de controle i

jip = viscosidade da fase p, Pa.dia

p = raio espectral; coeficiente - algoritmo Bi-CGSTAB

Pi = densidade do componente i nas condições padrão, Kg/m3

pm = densidade da média da mistura, Eq. (115), Kg/m3

pp = densidade da fase p, Kg/m3

&lt;|&gt; = porosidade

Q  = coeficiente, Eq. (73)

0  = coeficiente - algoritmo Bi-CGSTAB; coeficiente - algoritmo ORTHOMIN 

v  = vetor - algoritmo Bi-CGSTAB; vetor - algoritmo ORTHOMIN; velocidade

Subscritos

c = correção cilíndrica

1 = componente ou volume do bloco 

h = horizontal

ij = conexão entre os volume i e j

g = gás

j = vizinho do volume i

o = óleo

p = fase p



Simbologia xxi

ip = componente i na fase p

w = água ou poço

Superscritos

m = última iteração newtoniana do instante de tempo n

n = instante de tempo

T  = vetor transposto ou matriz transposta

0 = grau de implicidade

v = nível de iteração

* = vizinho mais distante do ponto i, Eq. (25); parâmetro especificado pelo usuário;

restrição imposta, Tab. 1.



INTRODUÇÃO 1

1.1 Preliminares

Na indústria de petróleo existem diversas questões que devem ser respondidas antes 

de se decidir a viabilidade de uma determinada bacia petrolífera. Dentro destas questões, podem- 

se citar duas principais: vida útil do reservatório e a capacidade de produção por unidade de 

tempo. Devido ao fato do petróleo encontrar-se geralmente localizado no subsolo, a centenas de 

metros abaixo da superfície, das dificuldades de escala e da complexidade do problema real, é 

bastante improvável que estas questões possam ser respondidas somente através de experimentos 

em laboratório.

Devido à dificuldades experimentais e aos altos custos associados à perfuração e 

instalação de plataformas de produção de petróleo, é necessário prever as características 

importantes do reservatório no que concerne ao escoamento de fluidos no meio poroso. A questão 

primordial é como conseguir este intento. Uma saída para este problema é a construção de 

modelos matemáticos que possam representar adequadamente o escoamento dos fluidos presentes 

no reservatório. A escolha do modelo, para um determinado reservatório, dependerá, obviamente 

dos tipos de fluidos presentes no reservatório.

Antes de se referir a um determinado modelo, far-se-á uma descrição sucinta de 

alguns,tipos de fluidos que podem ser encontrados em uma determinada bacia petrolífera e dos 

diversos métodos de recuperação.

O processo produtivo pode ser dividido em três fases distintas: o escoamento no 

interior do meio poroso, o escoamento dos fluidos dos poços até a superfície, e o escoamento no 

interior de dutos na superfície do solo até o local de armazenamento, Mezzomo (1992). Enquanto 

que o escoamento nas duas etapas finais do processo são regidos por leis físicas bem conhecidas, 

a primeira etapa do processo é bastante complexa e muito desenvolvimento tecnológico ainda será 

necessário para que se possa obter melhores efíciências no processo produtivo.



Introdução 2

Um erro geralmente cometido por pessoas que não conhecem o processo de 

recuperação de petróleo, é o de imaginar que o óleo ou gás é encontrado em grandes piscinas 

subterrâneas, e que o mesmo deve ser bombeado de forma semelhante a um líquido armazenado 

em um tanque. Evidentemente isto não ocorre. Em geral o óleo ou gás encontra-se confinado em 

pequenos poros da rocha e irá escoar através destes sob a influência de grandes gradientes de 

pressão. A Fig. 1 esboça uma possível amostra do reservatório. Uma grande porcentagem destes 

poros são conectados entre si e os fluidos podem escoar através destes canais na rocha. Contudo, 

os canais são muito pequenos e altamente irregulares e tortuosos, criando um escoamento 

transiente e altamente irregular a nível microscópico, Ewing (1983).

No início da vida útil do reservatório as pressões existentes são elevadas e geralmente 

suficientes para iniciar o escoamento dos fluidos através dos poros da rocha e retirá-los nos poços 

de produção, sem esforço de bombeamento. A energia existente (pressão) no reservatório pode 

ser oriunda do contato com aqüíferos naturais, gás em solução no óleo, e capas de gás. Este tipo 

de procedimento é denominado recuperação primária. A medida que as pressões vão decrescendo, 

diminui também a produção e, geralmente, mais de 70% do petróleo inicialmente presente 

permanece no reservatório quando não existe mais o escoamento natural. Fica claro, portanto, a 

importância de melhorar a eficiência dos métodos de recuperação.

rocha

óleo, água ou gás

Fig. 1 - Amostra do reservatório

Com o intuito de recuperar o nível de pressão existente no reservatório pode-se injetar 

água ou gás em alguns poços, forçando o petróleo a migrar para outros poços de produção. A



Introdução 3

este processo dá-se o nome de recuperação secundária. A eficiência deste processo dependerá 

da mobilidade do fluido residente. Se o fluido residente tem uma mobilidade baixa quando 

comparada com aquela do fluido injetado e se as vazões de injeção são elevadas, a interface entre 

o óleo residente e a água injetada toma-se instável e frentes com formatos de "dedos" ou 

"chifres" tendem a aparecer, as quais crescem em direção aos poços de produção. Quando esta 

frente atinge um determinado poço extrator, a produção de óleo é sensivelmente reduzida e a 

produção de água largamente aumentada. Com isto grande parte de petróleo (mais de 50%, 

dependendo da mobilidade do mesmo) fica ainda retido sem que possa ser retirado com este tipo 

de recuperação.

Para aumentar a eficiência do processo de recuperação secundária existem os métodos 

de recuperação terciária que englobam os métodos térmicos (combustão in situ, injeção contínua 

de vapor, etc); os métodos químicos (injeção de polímeros, álcalis, tensoativos); os métodos 

mísciveis (injeção de gás natural, gás carbônico, nitrogênio, etc) e outros como a introdução de 

bactérias, espumas, etc.

Além de existirem vários tipos de óleos, requerendo modelos diferentes, há ainda 

vários parâmetros do reservatório suscetíveis a grandes incertezas. Por exemplo, porosidade, 

permeabilidade absoluta, contornos geométricos do reservatório, etc. Para a medição de 

parâmetros como a porosidade são tomadas amostras ao longo do reservatório, sendo difícil 

avaliar quão representativos são estes dados. Entretanto, estas incertezas não impedem que cada 

vez mais se busquem modelos matemáticos mais representativos do problema físico em questão. 

Logicamente, quanto melhor caracterizado o reservatório, melhores resultados serão obtidos na 

previsão.

O tipo de hidrocarboneto presente no reservatório irá determinar o modelo (conjunto 

de equações) que possibilitará a sua caracterização. Por exemplo, se estão presentes no 

reservatório hidrocarbonetos com alta volatilidade, modelos composicionais ou modelos de 

múltiplos componentes em múltiplas fases são requeridos. Por outro lado, se os hidrocarbonetos 

presentes no reservatório possuem baixa volatilidade, o modelo black-oil ou modelo de dois 

componentes hidrocarbonetos (óleo e gás) pode ser utilizado. Além disso, se a viscosidade do



Introdução 4

óleo presente no reservatório for elevada, tomando o processo de recuperação inviável somente 

com a imposição de elevados gradientes de pressão, é necessário alguma técnica que permita a 

redução da viscosidade do óleo. Uma possibilidade já  citada, é a injeção de vapor d'água em 

alguns poços do reservatório. Evidentemente que existem vários métodos e não é o objetivo deste 

trabalho falar de cada um individualmente.

Qualquer que seja o modelo utilizado, as leis básicas que governam o escoamento dos 

fluidos presentes no reservatório são: a conservação da massa e de energia e relações adicionais, 

como a equação de Darcy e equações de estado. Para o fechamento do problema são necessários 

ainda uma completa descrição do reservatório (geometria, propriedades físicas, etc), e um 

conjunto de condições iniciais e de contorno. Em geral, as equações diferenciais que descrevem 

o escoamento de fluidos em reservatórios não podem ser resolvidas analiticamente. Uma forma 

de contornar este problema é resolvê-las numericamente, substituindo as equações diferenciais 

por equações aproximadas. No esquema numérico o reservatório é tratado como se fosse 

constituído de volumes discretos e as taxas de mudança em cada equação são calculadas em 

intervalos de tempo discretos. Obviamente, o processo físico é independente desta divisão 

(volumes, intervalos de tempo), contudo, a resposta do simulador vai depender da forma como 

foi efetuada a discretização do reservatório e como cada equação foi formulada e discretizada. 

As equações discretizadas geram, por sua vez, um sistema de equações algébricas não-lineares, 

as quais devem ainda serem linearizadas antes da obtenção da solução final do problema. O 

sistema linear final dependerá da forma como cada equação foi linearizada. Existem na literatura 

diversas posssibilidades de linearizações, as quais receberão maior enfoque posteriormente neste 

trabalho.

A seguir realizar-se-á uma revisão dos diversos tipos de malhas utilizadas em 

simulação de reservatórios, dos métodos de linearização das equações aproximadas e resolução 

dos sistemas lineares.

1.2 Malhas Utilizadas

Malhas cartesianas têm sido amplamente utilizadas em simulação de reservatórios,



Introdução 5

Brand et al. (1991), Yanosik e McCracken (1978), Bertiger e Padmanabhan (1983), Rubin e Blunt 

(1991) e Pinto (1991). Todos os aplicativos comerciais atualmente utilizados pelas grandes 

companhias de petróleo empregam coordenadas cartesianas. A Fig. 2 apresenta dois tipos de 

malhas cartesianas que podem ser utilizadas para uma configuração teórica empregada em 

simulação de reservatórios, uma configuração de cinco poços. Esta configuração é constituída de

4 poços produtores e um injetor, com este esquema repetindo-se ao longo do reservatório.

malha diagonal

P - Ptodução 
I - Injeção

Fig. 2 - Malha diagonal e paralela para a configuração de cinco poços

Malhas cartesianas apresentam como vantagens principais a facilidade na realização 

de balanços de componentes e na solução dos respectivos sistemas lineares, que apesar de 

esparsos, apresentam leis de formação bem definidas. Entretanto, existem algumas dificuldades 

relacionadas com a sua utilização. Os resultados obtidos com malhas cartesianas (paralelas e 

diagonais), para a configuração de cinco poços, utilizando esquemas de primeira ordem nas 

permeabilidades relativas, são altamente dependente da orientação da malha. Para muitos 

esquemas, principalmente os de primeira ordem (UDS - Uupstream Differencing Schemes), 

existem diferenças consideráveis nas soluções numéricas obtidas para as malhas paralelas e



Introdução 6

diagonais. Para um escoamento denominado piston-type estas diferenças não desaparecem quando 

malhas mais refinadas são utilizadas, Este fenômeno é denominado efeito de orientação de malha, 

Brand et cã. (1991). Yanosik e McCracken (1978), Bertier e Padmanabham (1983) e Santos

(1990) reduziram este efeito utilizando esquemas de 9 pontos. Rubin e Blunt (1991) e Pinto

(1991) conseguiram reduzir tal efeito utilizando esquemas TVD (Totcã Variation Diminishing 

schemes). Outra dificuldade no uso de malhas cartesianas é a difícil representação de 

reservatórios com frontreiras arbitrárias.

O uso de malhas coincidentes com a fronteira contorna a dificuldade da representação 

de reservatórios com fronteiras complexas e permite, também maior flexibilidade na representação 

de falhas geológicas ao longo do reservatório, (Hirasaki e O'Dell, 1970; Fleming, 1987; Sharpe 

e Anderson, 1991; Sharpe, 1993; Maliska et cã., 1994; Cunha et cã., 1994; Mota, 1994; M ota e 

Maliska, 1994; Maliska, 1995). Os quatro primeiros trabalhos citados utilizam coordenadas 

curvilíneas ortogonais, que é um caso especial dos esquemas de cinco pontos. Existem dois 

problemas relacionadas com a utilização de coordenadas curvilíneas ortogonais. O primeiro, e 

talvez o mais restritivo, é a sua difícil geração. O segundo está relacionado ao uso deste tipo de 

coordenadas juntamente com os esquemas de primeira ordem, que devem apresentar as mesmas 

dificuldades das malhas cartesianas, no que tange ao problema de orientação de malha. 

Obviamente, existem casos especiais em que a geometria do reservatório permite que as linhas 

coordenadas assemelhem-se às linhas de fluxo do escoamento. Neste caso, deve-se esperar uma 

melhora sensível dos resultados.

Uma forma de eliminar a restrição da ortogonalidade das linhas coordenadas é 

trabalhar com coordenadas curvilíneas não-ortogonais, (Maliska et cã., 1994; Cunha et. cã., 1994; 

Mota, 1994; Mota e Maliska, 1994; Maliska, 1995). Neste caso, o esquema numérico para o caso 

2D passa a ser de 9 pontos, mas este fato deve-se unicamente aos termos cruzados do tensor 

métrico e não a uma melhor aproximação dos fluxos de massa nas fronteiras do volume de 

controle. Maliska et cã. (1994), Mota (1994), e Mota e Maliska (1994) obtiveram resultados sem 

efeito de orientação de malha em uma configuração de cinco poços, para um caso proposto por 

Palagi (1992). Nestes trabalhos foram empregadas curvas de permeabilidade relativa mais realistas 

do ponto de vista de recuperação de petróleo.



Introdução 7

Conforme Palagi (1992), von Rosenberg (1982) propôs a combinação de malhas 

cartesianas de diferentes tamanhos, von Rosenberg (1982) modelou um escoamento com razão 

de mobilidades unitária em um quarto da configuração de cinco poços, e observou que o 

refinamento próximo aos poços melhora a solução sem um considerável aumento no número de 

volumes. Heinemann et ai. (1983) usaram a técnica de refinamento local da malha cartesiana 

dinamicamente, isto é, a malha refinada é somente aplicada para um certo período de tempo. Os 

resultados obtidos com a grade localmente refinada foram bastante similares aos obtidos com 

grades refinadas uniformemente. Quandalle e Besset (1983) apresentaram resultados obtidos com 

malhas localmente refinadas e concluíram que este procedimento melhora a qualidade da solução, 

com tempos totais de execução ligeiramente maiores que aqueles obtidos usando malhas 

grosseiras. Nacul (1991) mostrou que o refinamento de áreas em volta dos poços nem sempre 

melhora os resultados para o problema de injeção de gás em um quarto da configuração de cinco 

poços. Pedrosa e Aziz (1986) propuseram o uso da malha híbrida, que é uma combinação de 

grades cilíndricas e cartesianas. A geometria cilíndrica é usada em volta de poços verticais e a 

grade cartesiana no restante do reservatório. Mais recentemente, Deimbacher e Heinemann 

(1993), Chien e Northrup (1993) propuseram o uso de refinamento local dinâmico, com a malha 

dentro das janelas (ou subdomínios) podendo ter geometrias diferentes da malha cartesiana global 

(restante do domínio).

Pruess e Bodvarsson (1983) propuseram o uso de grades hexagonais (que gera um 

esquema de 7 pontos, utilizando o esquema UDS em 2D) com o intuito de reduzir o efeito de 

orientação de malha. Foi observado para o problema de injeção de vapor, que este tipo de grade 

originava soluções com pouco efeito de orientação de malha. Heinemann e Brand (1988) 

utilizaram uma malha de hexágonos distorcida, a qual também origina esquemas de 7 pontos. Foi 

resolvido o problema de injeção de vapor e verificou-se que os resultados estavam de acordo com 

aqueles obtidos com malhas cartesianas utilizando esquemas de 9 pontos. Malhas hexagonais é 

um caso especial das malhas de Voronoi que serão empregadas no presente trabalho.

Palagi (1992) propôs a utilização de malhas de Voronoi na solução de problemas de 

reservatório. A malha gerada utilizando o princípio de Voronoi dá origem a volumes de controle 

cujas faces são sempre ortogonais às retas que unem o ponto gerador do volume de controle em



Introdução 8

questão aos pontos dos volumes vizinhos. Isso, por sua vez, facilita a realização de balanços de 

massa, energia, etc. Obviamente que todos os tipos de malhas localmente ortogonais podem ser 

vistas como casos particulares de malhas de Voronoi (cartesianas, cilíndricas, coordenadas 

generalizadas ortogonais, etc). Como as diversas grades utilizadas em simulação de reservatório 

são casos especiais de malhas de Voronoi, Palagi (1992) propôs a combinação de módulos 

(cartesianos, cilíndricos, hexagonais ou irregulares) para a discretização do domínio. Colocando 

módulos cilíndricos em volta de poços verticais e no restante do domínio módulos cartesianos 

ou hexagonais, Palagi (1992) obteve resultados com pouco efeito de orientação de malha para 

uma série de problemas onde tal influência é bastante pronunciada (escoamento tipo pistão, cone 

de água, etc). Em todos estes casos, a malha de Voronoi foi competitiva com todos os métodos 

existentes na literatura. A malha de Voronoi não precisa de nenhum tratamento especial na 

transição de regiões com malha refinada para regiões com malhas grosseiras (por exemplo, na 

transição de uma malha cilíndrica em volta de um poço vertical para uma região com malha 

cartesiana grosseira). A combinação de diferentes malhas de Voronoi generaliza a proposição de 

Pedrosa e Aziz (1986).

Os métodos de discretização vistos anteriormente empregam as técnicas de diferenças 

finitas ou volumes finitos. Outra possibilidade e que tem grande facilidade na representação de 

geometrias complexas é o método dos elementos finitos. Este método tem sido empregado na 

simulação de reservatórios de petróleo por diversos autores (Sprivak et al., 1977; Shaw, 1993; 

Coutinho et al., 1993 a-b e Coutinho et al., 1994). Deve-se salientar que o dual das malhas de 

Voronoi é a triangulação de Delaunay, que coincide com o elemento triangular bastante 

empregado pelos pesquisadores de elementos finitos na representação de geometrias 2D.

Obviamente que o esquema numérico dos volumes finitos utilizando-se malhas de 

Voronoi pode ser visto como um caso especial da técnica dos volumes de controle utilizando 

elementos finitos - Contml Volume Finite Element Method. Esta técnica foi inicialmente proposta 

por Baliga e Patankar (1983), Raw e Schneider (1986) na solução de problemas de mecânica dos 

fluidos e transferência de calor e posteriormente aplicada na solução de problemas de reservatório 

por Forsyth (1989), Fung et al. (1991).



Introdução 9

1.3 Técnicas de Solução das Equações

As equações de conservação de massa dos componentes óleo, água ou gás podem ser 

consideradas hirperbólicas para a saturação (ou quase hiperbólicas, quando a pressão capilar é 

considerada e os fluidos são compressíveis) e a equação da pressão elíptica, ou quase elíptica 

(quando os efeitos de compressibilidade das fases ou rocha são considerados), conforme 

Peaceman (1977). Este fato, sugere que na avaliação do fluxo de massa, num determinado 

instante de tempo, os termos que dependem da saturação podem ser avaliados com a saturação 

do instante de tempo anterior, e os termos que dependem da pressão sejam avaliados no mesmo 

instante de tempo em que o fluxo está sendo calculado, originando o esquema IMPES (Implicit 

Pressure Explicit Saturatiori). Este fato, desacopla a equação da pressão das equações de 

saturação, uma vez que o campo de pressão depende apenas do campo de saturação do instante 

anterior. Tal esquema requer pequeno esforço computacional por intervalo de tempo, uma vez 

que a pressão é a única incógnita do sistema de equações e a saturação é calculada explicitamente 

com o novo campo de pressão.

Para o IMPES os erros de discretização de primeira ordem dos termos temporais e 

espaciais das equações de conservação tem sinais contrários e são funções do CFL. Desta forma, 

a dispersão numérica associada a estes erros tende a desaparecer ou diminuir quando o intervalo 

de tempo (At) é escolhido de forma que o número de Courant-Friedrichs-Lewy, o CFL, é próximo 

de 1 (um). Devido à natureza não-linear das equações envolvidas, o cálculo exato do CFL deverá 

requerer um algebrismo acentuado. N a prática, trabalha-se com o CFL aproximado, (Russell, 

1989; Young e Russell, 1993) e, desta forma, mesmo com o esquema IMPES, os erros de 

truncamentos ainda estarão presentes nas equações, mesmo em menor escala. Outra vantagem do 

IMPES é que o procedimento de avanço das incógnitas explícitas é facilmente vetorizável. A 

principal desvantagem do IMPES é que se deve empregar o CFL menor que a unidade a fim de 

se evitar oscilações espúrias na solução.

Uma metodologia que trabalha com o de CFL maior que um, sem que ocorra 

oscilações na solução, é a solução totalmente implícita (TI), ou solução simultânea. Na solução 

simultânea, a equação da pressão não é desacoplada das equações das saturações e ambas são



Introdução 10

calculadas simultaneamente. Todavia, o esforço computacional por passo de tempo aumenta 

quando comparado com o IMPES, uma vez que todas as incógnitas fazem parte do sistema de 

equações (por exemplo, cada elemento da matriz Jacobiana passa a ser uma submatriz 3x3, no 

caso do modelo black-oil, com três fases água, óleo e gás). Conforme observado por alguns 

autores, (Thomas e Thumau, 1983; Forsyth Jr. e Sammon, 1986; Fung et. cã, 1989; Forsyth, 1989; 

Russel, 1989; Young e Russél, 1993), o método IMPES consegue trabalhar com razoáveis 

intervalos de tempo (At) exceto em algumas regiões localizadas do reservatório, como por 

exemplo, nas proximidades de poços. Partindo desta observação, Thomas e Thumau (1983) 

propuseram o uso de esquemas implícitos adaptativos (AIM - Adaptive Implicit Method), cujo 

conceito foi posteriormente melhorado por Forsyth Jr. e Sammon (1986). A idéia do método 

implícito adaptativo é avançar todas as incógnitas implicitamente nas regiões onde o CFL é maior 

que um ou onde ocorram grandes variações nas saturações ou na pressão de saturação, e no 

restante do reservatório somente a pressão é tratada implicitamente. Se o número de volumes 

onde todas as incógnitas são avançadas implicitamente não for muito grande, menor que 50% 

segundo Young e Russel (1993), consegue-se uma boa redução no tempo final de execução da 

simulação. Um dos grandes problemas da implementação do AIM é o critério lógico para trocar 

uma variável de IMPES para TI ou vice-versa.

Thomas e Thumau (1983), Forsyth Jr. e Sammon (1986), utilizaram como critério de 

troca as variações máximas nas saturações e pressão de saturação. Se uma célula IMPES tiver 

uma variação em saturação ou pressão de saturação maior que um valor predeterminado, está 

célula é calculada como sendo TI na próxima iteração de Newton ou no próximo intervalo de 

tempo. Forsyth Jr. e Sammon (1986) argumentam que este critério não permite que uma célula 

volte a ser IMPES após ter sido trocada para TI, porque uma célula TI pode ter grandes fluxos 

de massa e as variações nas saturações serem pequenas. Caso esta célula seja trocada para IMPES 

é possível que ocorram instabilidades. Evidentemente, se fosse calculado o CFL da célula, seu 

valor deveria ser elevado. Entretanto, como o critério utilizado é baseado somente nas variações 

das incógnitas explicitas, este critério não pode detectar o surgimento desta instabilidade.

Russel (1989) propõe um critério baseado no CFL para determinar se uma célula deva 

passar de I I  para IMPES e vice-versa. Russel (1989) fornece várias justificativas para trabalhar



Introdução 11

com o critério baseado no CFL e várias formas de calculá-lo aproximadamente. Entretanto, não 

apresenta nenhum resultado para escoamento bi ou trifásico. Young e Russel (1993) propuseram 

uma nova expressão para o cálculo do CFL e sugerem que este seja aplicado juntamente com o 

cálculo de máxima variação nas saturações ou pressão de saturação. Ou seja, se o CFL ou a 

máxima variação for violada, a célula deve passar de EMPES para TI. Caso o número de CFL 

seja menor que um, a célula TI passará para IMPES. Entretanto, com a expressão de cálculo do 

CFL proposta por Young e Russel (1993) foram obtidas soluções com o método IMPES com 

CFL maiores que um, sem que ocorressem oscilações na solução.

Fung et cd. (1989) propuseram um critério baseado na análise local das equações 

aproximadas. Em cada célula são calculados os autovalores e é exigido o módulo do menor 

autovalor não seja superior a unidade, para que a célula possa ser tratada pelo método IMPES. 

Caso contrário, a célula deve ser tratada pelo método TI. Russel (1989) argumentou que a forma 

como é calculado os autovalores pelo método de Fung et al. (1989) é equivalente ao cálculo do 

CFL. Maiores detalhes sobre o cálculo dos autovalores serão fornecidos no Cap. 3 do presente 

trabalho.

1.4 Solução dos Sistemas lineares

Na solução dos sistemas lineares obtidos por algum dos métodos citados 

anteriormente, existem duas linhas principais a ser adotadas: métodos diretos e métodos iterativos. 

De acordo com o que foi exposto nas seções precedentes, os problemas oriundos de simulação 

de reservatórios são não-lineares e desta forma a solução do sistema linear representa uma 

solução intermediária, cujo custo computacional para obtê-la não deve ser excessivo.

Métodos diretos apresentam como principais obstáculos à sua utilização o alto valor 

requerido de memória e o número excessivo de operações para o cálculo dos fatores L U  da 

decomposição. A memória e número de operações envolvidas dependem do tamanho das malhas 

empregadas, do número de equações e da ordenação da incógnitas. Baseado nas informações 

anteriores e lembrando que a resolução do sistema linear é um passo intermediário do processo 

de solução, pode-se justificar porque se tem preterido, na maior parte dos trabalhos, os métodos



Introdução 12

diretos, na resolução de problemas de reservatórios.

Na maioria dos casos a resolução dos sistemas lineares é obtida via métodos 

iterativos. Estes métodos têm como características principais: o baixo custo por iteração e a pouca 

memória requerida. Dentre os métodos iterativos mais conhecidos pode-se citar os métodos 

estacionários1 (Jacobi, Gauss-Seidel, SOR (Successive OverRelaxatiori), SSOR (Symmetric 

Successive OverRelaxatiori)) e os métodos não-estacionários (GC-Conjugate Gradient, GMRES- 

Generalized M inimal Residual, Bi-CGSTAB-BiConjugate Gradient Stabilized, CGS- Conjugate 

Gradient Square, ORTHOMIN, etc).

Os métodos estacionários, apesar de facilmente vetorizáveis e paralelizáveis, não são 

bastantes empregados em simulação de reservatórios. Estes métodos, além de possuírem taxa de 

convergência lenta, requerem que a matriz Jacobiana seja diagonalmente dominante. Devido aos 

grandes intervalos de tempo em que, geralmente, realiza-se a simulação, a dominância diagonal 

do Jacobiano é reduzida, diminuindo também as propriedades de convergência destes métodos, 

Marcondes et al. (1995c). Métodos não-estacionários têm sido largamente aplicados em simulação 

de reservatórios (Vinsome, 1976; Behie e Vinsome, 1982; Behie e Forsyth, 1983; Coutinho et 

al., 1993a-b). A taxa de convergência destes métodos dependem principalmente de dois fatores: 

a qualidade do precondiconador empregado e ordenação das incógnitas. Existem diversas formas 

de precondicionamento. Alguns pesquisadores que trabalham com elementos finitos 

precondicionam as matrizes locais em vez de precondicionar a matriz Jacobiana globalmente - 

(EBE - Element by Element), (Shakib, et al., 1989; Coutinho et al., 1993a-b; Coutinho et al., 

1994). A maioria dos trabalhos que empregam diferenças finitas ou volumes finitos 

precondiconam a matriz Jacobiana globalmente. Nesta linha, a fatoração ILU (Incomplete L U  

Factorization) tem sido a mais utilizada.

1Conforme Barrett et. al (1993), métodos iterativos que podem ser escritos como

x  (jc&gt; = + c  ; onde B  e c não dependem do contador de iteração, são classificados
como métodos estacionários. Por outro lado, se existem parâmetros que variam a cada iteração 
os métodos são denominados de não-estacionários.



Introdução 13

Com relação a ordenação das incógnitas, diversas formas de ordenações geométricas 

(ordenações baseadas somente no grafo da matriz) têm sido empregadas. Por exemplo, red-black 

(Price e Coats, 1974), Cuthill-McKee - CM (Cuthill e McKee, 1969; Liu e Sherman, 1975), 

reverse Cuthill-McKee - RCM  (George, 1971; Liu e Sherman, 1975), minimum degree e 

minimum deficiency (Tinney e Walker, 1967), etc. Conforme comentado por D'Azevedo et al. 

(1992a) estes métodos não são capazes de detectar a anisotropia nos elementos da matriz. A 

anisotropia pode ser originada pelo emprego de malhas estruturadas com regiões de refino 

localizado, através de materiais ou meios heterogêneos ou ambos. D'Azevedo et al. (1992a) 

propuseram um método de ordenação das incógnitas baseado não somente na estrutura da matriz, 

mas também nos seus valores numéricos. Este esquema é denominado MDF (Minimum Discarded 

Fill) e está associado a uma fatoração incompleta da matriz. Maiores detalhes deste esquema de 

ordenação serão apresentados no Cap. 4 do presente trabalho.

1.5 Esboço da Tese

Malhas não-estruturadas, que eram basicamente utilizadas apenas em elementos 

finitos, têm recebido bastante atenção dos pesquisadores que empregam métodos baseados nos 

volumes finitos, ou seja, em métodos que realizam balanços para cada volume, (Baliga e 

Patankar, 1983; Raw e Schneider, 1986; Forsyth, 1989; Fung et al., 1991; Palagi, 1992). Este 

fato, por sua vez, origina sistemas que respeitam a conservação de cada propriedade física 

localmente. Malhas não-estruturadas têm uma grande vantagem sobre malhas estruturadas, pois 

na maioria dos casos os problemas que se deseja resolver ocorrem em geometrias complexas. 

Empregando-se malhas estruturadas nem sempre é possível resolver um determinado tipo de 

problema com a utilização de único domínio de cálculo, mesmo trabalhando-se com coordenadas 

generalizadas, Vasconcellos (1993) e Vasconcellos e Maliska (1994). Em malhas não-estruturadas 

este problema não existe e é também muito mais fácil a realização de refinamento local da malha. 

Conforme comentado anteriormente, as malhas de Voronoi híbridas, propostas por Palagi (1992), 

apresentam grandes vantagens sobre a maioria das malhas utilizadas na simulação de 

reservatórios. Neste trabalho fazendo-se uso deste tipo de malha, é desenvolvido um código 

computacional 2D não-estruturado, para a simulação do escoamento bifásico óleo-água. Para a 

geração dos diagramas de Voronoi foi utilizado o gerador de malhas de Voronoi desenvolvido



Introdução 14

por Maliska Jr. (1993).

Um dos objetivos do presente trabalho é desenvolver um código computacional 

utilizando malhas não estruturadas de Voronoi que englobe as metodologias IMPES, ATM e 

Totalmente Implícita (TI). Conforme citado anteriormente, existe uma série de trabalhos que 

versam a respeito da metodologia AIM. Na maioria destes trabalhos são realizadas comparações 

entre as metodologias AIM, IMPES e TI. Um fato que deve ser frisado, é o não aparecimento 

dos critérios utilizados para convergência de uma iteração newtoniana. Um outro detalhe, talvez 

mais importante, com relação a metodologia AIM é a pouca discussão a respeito da eficiência 

dos diversos critérios para trocar-se uma célula de IMPES para TI e em alguns casos de TI para 

IMPES. Por exemplo, no trabalho de Young e Russel (1993) é sugerido que critérios baseados 

no CFL devem ser utilizados. Entretanto, soluções com CFL maiores que 1 (um) foram obtidas 

sem oscilações através do método IMPES. Este fato pode ser atribuído ao cálculo não rigoroso 

do CFL.

Outro ponto que será enfocado neste trabalho é a solução dos sistemas lineares 

oriundos da utilização de malhas não-estruturadas. Para malhas estruturadas existe uma série de 

trabalhos que utilizam métodos derivados dos gradientes conjugados com ELU (Incomplete L U  

Factorizatiori), (Behie e Vinsome, 1982; Behie e Forsyth, 1984; Eisenstat et cd., 1988). Com 

relação ao precondicionamento, existem duas linhas básicas: uma utiliza como ILU somente uma 

partição do Jacobiano, Eisenstat et al. (1988) e outra utiliza toda a estrutura do Jacobiano, (Behie 

e Vinsome, 1982; Behie e Forsyth, 1984). Partições do Jacobiano podem não fornecer bons 

resultados em malhas não-estruturadas, Marcondes et cd. (1995c). Para malhas não-estruturadas, 

a conectividade da matriz Jacobiana pode ser variada e uma decomposição como proposta por 

Behie e Forsyth (1984) é mais complicada. Forsyth e Sammon (1985) sugerem que a 

decomposição ELU para matrizes com conectividade variada pode ser realizada de forma 

semelhante àquela utilizada por Behie e Forsyth (1984), desde que seja realizada primeiramente 

uma fatoração simbólica da matriz. A fatorização simbólica determina a posição do enchimento 

(fill-in) nos fatores LU.

Outro ponto que deve ser frisado é o esquema de armazenamento da matriz Jacobiana.



Introdução 15

Para precondicionadores de ponto (point-wise) pode-se resolver com facilidade os sistemas 

oriundos das metodologias IMPES e TI. Para a metodologia AIM vetores adicionais são 

necessários para armazenamento e processo de fatoração aproximada. No presente trabalho as 

operações são realizadas do ponto de vista de bloco. Por exemplo, primeiramente é realizada uma 

fatoração simbólica independente da metodologia empregada e o processo de fatoração é 

realizado com o auxilio de um vetor auxiliar para determinar-se o tamanho de cada bloco. No 

presente caso, para a metodologia AIM, cada bloco pode ser l x l ,  2x1, 1x2 ou 2x2.

O restante deste trabalho será dividido da seguinte forma. O Cap. 2 apresentará as 

equações do modelo black-oil utilizado neste trabalho. As equações serão obtidas a partir de um 

modelo composicional.

No Cap. 3 serão integradas as equações no espaço e no tempo. Serão apresentadas 

as metodologias TI, IMPES e AIM e o ciclo iterativo de cada metodologia. Também serão 

discutidos os critérios de troca de implicitude.

O Cap. 4 apresentará os ciclos dos três métodos iterativos (GMRES, Bi-CGSTAB e 

ORTHOMIN) que serão utilizados para a resolução dos sistemas lineares oriundos das 

metodologias utilizadas. Apresentar-se-á também, a forma de precondicionamento empregado, 

bem como, os esquemas de ordenações das incógnitas utilizados.

O Cap. 5 apresentará os resultados com o intuito de validar o código computacional 

desenvolvido neste trabalho. Os resultados apresentados foram obtidos com a metodologia TI e 

foram empregados para validação alguns dos resultados obtidos por Palagi (1992) e Cunha 

(1996). Foi também realizado uma análise de caso onde se verificou o efeito da pressão capilar 

nas curvas de recuperação de óleo.

O Cap. 6 apresentará as comparações das metodologias TI, IMPES e AIM. Os 

resultados serão apresentados em termos de tempo de CPU, número de iterações de Newton, 

número de iterações no tempo e percentagem de implicitude. Como critério de chaveamento de 

implicitude foram utilizados o critério de estabilidade de Fung et al. (1989) e o critério de



Introdução 16

variação na saturação.

O Cap. 7 apresentará uma comparação entre três métodos de solução de sistemas 

lineares empregados no presente trabalho: ORTHOMIN, GMRES e Bi-CGSTAB. As 

comparações serão realizadas em termos de tempo de CPU e número de iterações no solver. 

Apresentar-se-á também o efeito da ordenação MDF no método GMRES.

Por fim o Cap. 8 é reservado para um resumo das conclusões obtidas e sugestões 

para futuros trabalhos.



FORMULAÇÃO 17

2.1 Introdução

Neste capítulo apresenta-se a equação de conservação de um componente qualquer 

que poderá estar presente em uma ou mais fases existentes no reservatório. Em seguida são 

apresentadas as hipóteses simplificativas necessárias para tom ar o modelo composicional ou 

modelo de múltiplos componentes em múltiplas fases, no modelo de dois componentes ou modelo 

black-oil.

2.2 Modelo Composicional

Suponha que existam Np fases presentes no reservatório (geralmente óleo, gás e água) 

e que existam Nq espécies químicas ou componentes, onde cada um deles pode estar presente em 

qualquer uma das Np fases. Representar-se-á por Xip a fração mássica do componente i presente 

na fase p. Uma vez que existe a possibilidade de transferência de componentes entre as fases, não 

se pode dizer que a massa da fase é conservada; o que se conserva é a massa de cada 

componente individualmente. Conforme Peaceman, (1977) e Allen et a i, (1988), a equação 

representando o balanço de cada componente pode ser escrita como,

dt\
IP VP  P

N,
= - P . * X i pPpt p

Np + S PPX ÍP% Np
( 1)

onde a porosidade&amp;lt;|&gt; representa a fração de volume que é disponível para o escoamento dos 

fluidos presentes no reservatório e é, em geral, função das pressões encontradas no meio poroso. 

pp é a densidade da fase p, e para fluidos compressíveis pp = pp (Xip,Pp), onde Pp é a  pressão da 

fase p. Sp é a saturação da fase p e representa a fração do espaço poroso que é ocupado pela fase

p. Vp é a velocidade da fase p e qp é a vazão volumétrica de produção/injeção da fase p por

unidade de volume do reservatório, que é admitido positivo para para injeção e negativo para 

produção. O termo no lado esquerdo da Eq. (1) é a taxa de acumulação do componente i na fase



Formulação 18

p e o primeiro termo da direita representa a taxa de fluxo do componente i por convecção. Na 

Eq. (1) foi admitido que não existe nenhuma reação química e que o transporte do componente

i é somente por convecção, não sendo considerado o transporte do mesmo por difusão molecular 

e dispersão hidrodinâmica. Uma vez que na maioria dos casos práticos envolvendo recuperação 

primária e secundária ocorre somente escoamento imiscível, os termos convectivos das equações 

de conservação da massá de cada componente são largamente dominantes. As unidades de cada 

termo na Eq. (1) são,

A velocidade da fase p considerando o reservatório 2D e horizontal é dada pela lei

de Darcy,

onde, Pp é a pressão da fase p e  ^  a mobilidade da fase p, definida por

onde, K,p é a permeabilidade relativa da fase p, que é função da saturação da fase p, fip a

massa do componente i
( unidade de tempo) ( unidade de volume do reservatório)

(3)

viscosidade da fase p, geralmente uma função da pressão da fase p, e K  o tensor 

permeabilidade absoluta do meio, dado por

K
k 0 
0 k

(4)

k  na Eq. (4) representa a permeabilidade no plano horizontal. Está implícito na Eq. (4) que o 

meio poroso considerado neste trabalho será localmente isotrópico na direção horizontal, isto é, 

os valores de k  nas direções x e y ao longo do plano serão iguais.



Formulação 19

Maiores detalhes do modelo composicional serão apresentados no apêndice A.

2.3 Modelo Black-Oil

O modelo composicional da seção anterior permite que sistemas com óleos de alta 

volatilidade sejam modelados. Entretanto, o custo computacional gasto para tratar o sistema de 

equações oriundos deste modelo é bastante alto. Contudo, para óleos com baixa volatilidade, o 

modelo black-oil ou modelo de dois componentes pode ser usado para descrever o equilíbrio das 

fases. E admitido que não existe transferência de massa entre a fase água e as fases óleo e gás. 

No sistema hidrocarboneto somente dois componentes são considerados: óleo e gás. O 

componente óleo (também chamado óleo nas condições de armazenagem ou condições padrão 

{standard)) é o líquido residual na pressão atmosférica após uma vaporização diferencial, e o 

fluido restante é o componente gás.

O fator de formação de volume da fase p e a solubilidade do componente i na fase 

p são definidos como,

*  2 *^ p ~ v  
pp

KjpIPl 
V I B

P '  P

m iplPi

ü í  ±  
0 _ B.

- - B p =Xip 
m p Pj

-5 .
Pi (6)

onde,

Bp = fator de formação de volume da fase p nas condições de pressão e temperatura do 

reservatório ( P e T ) ;  

nip = massa da fase p nas condições P e T do reservatório;

Vp = volume da fase p nas condições P e T do reservatório;



Formulação 20

pp = densidade da fase p nas condições P e T do reservatório;

Pi = densidade do componente i nas condições de estocagem;

“ «p = massa liberada do componente i da fase p nas condições de estocagem, oriunda de 

condições P e T  do reservatório;

RjP = solubilidade do componente i na fase p nas condições P e T do reservatório;

V ip = volume liberado do componente i da fase p nas condições de estocagem, oriundo de 

condições P e T  do reservatório;

Vpp = volume liberado do componente p da fase p nas condições de estocagem, oriundo de

condições de P e T do reservatório.

Da Eq. (6) obtém-se,

V ,  = V Í r
P

(7)

Substituindo-se as Eqs. (2) e (7) na Eq. (1), obtém-se a equação de conservação do 

componente i para o modelo black-oil,

(8 )

2.4 - Modelo Black-Oil do Presente Trabalho

No presente trabalho implementou-se um modelo black-oil simplificado, o qual 

consiste do escoamento de duas fases imiscíveis, óleo (o) e água (w). Neste caso,

K o  - R ow - 0
(9)



Formulação 21

= 1
( 1 0 )

As equações de conservação para os componentes óleo e água podem ser escritas

como,

d_
d t

— ^ p n 
B 0 °

4o
( 11)

As Eqs. (11) e (12) representam a conservação volumétrica dos componentes óleo e 

água nas condições de estocagem. Observando-se as Eqs. (11) e (12) vê-se que existem quatro 

incógnitas (S0, Sw, P0 e Pw) e apenas duas equações. As outras duas equações para o fechamento 

do problema vêm da restrição de volume e de dados experimentais via pressão capilar.

W So =

P C( S W) = P 0 - P W

(13)

(14)

Por facilidade de representação escrever-se-á as Eqs. (11) e (12) na seguinte forma 

geral, com o índice p podendo representar a fase óleo (o) ou fase água (w),



Formulação 22

d_
dt %p ) (15)

A mobilidade da fase p foi modificada para levar em consideração o fator 

volumétrico, e q representa à vazão volumética nas condições de estocagem por unidade de

volume do reservatório. Desta forma, tem-se



METODOLOGIAS EXPLÍCITA, IMPLÍCITA E ADAPTATIVA 23

3.1 Introdução

Neste capítulo integra-se a equação do modelo black-oil no espaço e no tempo para 

um componente p qualquer. Dependendo das aproximações efetuadas durante o processo surgem 

naturalmente as metodologias TI, IMPES e AIM. Apresenta-se também o critério para a troca de 

implicitude baseado nos autovalores.

3.2 Definição do Diagrama de Voronoi

O diagrama de Voronoi para um conjunto de pontos foi definido primeiramente por 

Dirichlet (1850) e Voronoi (1908). Conforme Palagi (1992) este tipo de malha tem sido aplicada 

em áreas como, física (Winterfeld et a i, 1981), caracterização de rochas (Pathak, et al. 1980), 

cristalografia (Mackay, 1981), etc. Recentemente tem sido aplicado a problemas de mecânica dos 

fluidos (Taniguchi et al., 1991) e a problemas de reservatório de petróleo (Heinemann e Brand, 

1988; Palagi, 1992; Marcondes et al. 1994; Maliska e Maliska Jr., 1994).

Um volume de Voronoi é definido como a região do espaço que é mais próxima do 

seu grid-point ou ponto gerador do que qualquer outro ponto e o diagrama ou malha de Voronoi 

é composta de tais volumes. A definição de um volume de Voronoi para o espaço R2, conforme 

pode ser encontrada nos trabalhos de Sugihara e Iri (1992) e Maliska Jr. (1993), é:

Dado um conjunto de n pontos p e uma região do espaço R2, o volume de Voronoi 

para o ponto gerador i é o conjunto dos pontos (x,y) e  R2 que obedecem a:

(x,y) / d ((x,y) - p() &amp;lt;d ((x,y) - ty) V j / 1 &amp;lt;j &amp;lt;n e j * i 

onde d ((x,y) - p) é a distância do ponto (x,y) ao ponto p.

A Fig. 3 apresenta o diagrama de Voronoi para o ponto gerador i. Da Fig. 3 pode-se



Metodologias Explícita, Implícita e Adaptativa 24

observar as seguintes propriedades do diagrama:

a) A reta que une o ponto i ao seu vizinho j é sempre ortogonal a aresta comum a estes dois 

pontos. Por exemplo, i~ j=1 x  b~C.

b) A face comum ao ponto i e seu vizinho j, ou o seu prolongamento, passa no ponto médio da 

reta unindo estes dois pontos. Por exemplo, a reta b - c  passa no ponto médio da reta i - j =1 e

o prolongamento da reta c~d passa no ponto médio da reta i - j = 5. O último caso acontece 

geralmente nas interfaces de alguns volumes onde ocorre a combinação de diferentes tipos de 

malhas (hexagonal-híbrida, cartesiana-híbrida, cartesiana com refino local, etc.). No trabalho de 

Palagi (1992) malhas de múltiplas geometrias foram empregadas para resolver diversos 

problemas, onde as soluções numéricas foram validadas com soluções analíticas e soluções 

numéricas obtidas com malhas refinadas. Conforme Palagi (1992) não existe nenhuma indicação 

de que a existência de interfaces que não interceptem a linha que une dois pontos geradores seja 

a única causa de inexatidão nas soluções obtidas.

c) O círculo que passa por três pontos geradores é um vértice do volume de Voronoi. Por 

exemplo, o ponto c é o centro do círculo que passa pelos pontos j= l, j=2 e i.

d) Qualquer ponto dentro do polígono abcde está mais próximo do ponto i do que de qualquer 

um dos seus vizinhos j.



Metodologias Explícita, Implícita e Adaptativa 25

Fig. 3 - Diagrama de Voronoi com seis pontos geradores

3.3 Integração das Equações Governantes

A Fig. 4 apresenta um volume de controle de Voronoi. O ponto i é o ponto gerador 

e os pontos j's seus vizinhos. Para cada ponto j é possível alinhar um sistema cartesiano local x - 

y ' de tal forma que o eixo x' (linha que une o ponto i ao ponto j) seja perpendicular à face do 

volume de controle e o eixo y* paralelo a esta face.



Metodologias Explícita, Implícita e Adaptativa 26

Fig. 4 - Volume de controle de Voronoi para o ponto i

A Eq. (15), onde Sp é a saturação do óleo ou da água, é integrada no volume de 

controle e no tempo,

IIt v d v d t  = / J V - Í V ^ , )  d V d t * j j q p d V d t ( 18)P ) t V t V
Aplicando-se o teorema da divergência ou teorema de Gauss para o primeiro termo 

do lado direito da Eq. (18), obtém-se



Metodologias Explícita, Implícita e Adaptativa 27

t V

dVdt= f f X p$ P p.dÃ dt + f f q p dVdt
t A  t V

(19)

onde dA é o vetor área elementar.

Para a integração da Eq. (19) foi admitido que o fluxo convectivo é constante através 

de cada face ij do volume de controle i. Uma vez que o sistema cartesiano local x'-y' é 

perpendicular a cada face do volume de controle, o cálculo do primeiro termo no lado direito da 

Eq. (19) é bastante facilitado. Para cada face ij, o gradiente normal a esta face depende 

unicamente dos valores de Pp nestes pontos. Vale a pena salientar que, se o meio poroso não 

fosse localmente isotrópico, (ver Eq. (4)), o fluxo convectivo dependeria de outros vizinhos j, 

Palagi (1992). Fazendo-se as integrações da Eq. (19) e representando t + At por n + 1, tem-se

&amp;lt;D ^ r _ í &amp;lt;i &gt; r V "
Aí Bp j Aí B

T  T..xn+e( p n-1 - P ^ 1) + ã"*6 
tj p&gt;u\ p j  p ,i } HP*

j=ip )
(20)

O índice 0 na Eq. (20) pode assumir os valores 0 ou 1, dependendo, da técnica de 

solução (IMPES ou TI), q é a vazão volumétrica da fase p nas condições padrão e Nv o número

de vizinhos do volume i. O termo Ty na Eq. (20) é conhecido como fator de transmissibilidade 

e é o produto de fatores geométricos e da permeabilidade horizontal,

T _ ( bhk 
i j ~ {  d

(21)

'ij

onde, d é a distância do ponto i ao ponto j, b e h são a largura e profundidade da face ij, 

respectivamente, e k é a permeabilidade na face ij. Na interface de dois meios diferentes será 

calculado via média harmônica.

Voltando à Eq. (20), o último termo desta equação é calculado como,



Metodologias Explícita, Implícita e Adaptativa 28

—n+0
Qp,i = ( WI)i

K \n+0n&gt;
u B nt~p p /

A P (22)

com

W th

W r J r J
(23)

(24)

Nas Eqs. (22) a (24), Pt representa o ângulo total de abertura de fluxo (Pt = 271 para 

um poço interno). Pwr a pressão do poço localizado no bloco i, (Wl), é o índice de poço e r0 o 

raio equivalente do bloco do poço. O raio equivalente do poço é o raio para o qual a distribuição 

de pressão do poço em regime permanente iguala-se a pressão numérica do bloco contendo o 

poço, Peaceman (1978, 1983, 1987). Para o cálculo de r0 adotar-se-á o "modelo 2" proposto por 

Palagi (1992). Segundo este modelo, r0 é dado por,

ro = d-j exp (25)

onde, * refere-se ao vizinho j mais distante do volume i, conforme Fig. 5.



Metodologias Explícita, Implícita e Adaptativa 29

3.4 - Fator de Correção Cilíndrica

A malha de Voronoi, que foi utilizada neste trabalho, é composta de vários módulos, 

conforme exemplo apresentado na Fig. 6. Uma vez que os volumes formados pelos módulos 

cilíndricos não são exatamente os volumes que deveriam ser originados se uma discretização no 

plano r-0 fosse realizada, Palagi (1992) propôs uma correção no fator de transmissibilidade para 

que os módulos cilíndricos em volta dos poços verticais possam representar exatamente o 

escoamento radial nesta região.



Metodologias Explícita, Implícita e Adaptativa 30

Fig. 6- Diagrama de Voronoi com 2297 pontos geradores

A Fig. 7 apresenta uma malha "quase-cilíndrica" em tomo de um poço vertical e a 

Fig. 8 apresenta uma seção da malha apresentada na Fig. 7. Com a inclusão da correção cilíndrica 

o fator de transmissibilidade é dado por

TU '
' f ebhk' (26)

onde,

J C IJ
2 ( P l  + P2) (a - 1 )

(tanpj +tanp2) ( a  + 1) lna
(27)

'V



Metodologias Explícita, Implícita e Adaptativa 31

Fig. 8 - Conexão ij em uma seção de um módulo cilíndrico

Para as regiões cilíndricas em volta de poços verticais fc é calculado pela Eq. (27), 

fora desta região fc= l. Necessita-se ainda de uma maneira de calcular fc para o bloco mais 

interno (bloco C na Fig. 7) e seus vizinhos. Embora este ponto esteja localizado na origem de 

um sistema de coordenadas cilíndricas, na realidade ele representa condições médias do 

correspondente volume. O bloco C pode ser visualizado como sendo o volume mais interno, cujas



Metodologias Explícita, Implícita e Adaptativa 32

fronteiras estão limitadas pelo raio do poço (rw) e pelo raio externo (re), Palagi, (1992). Na Fig. 

9 estão representados rw, rc e re, onde re é dado por

=
' A 2 A

P,
(29)

onde A é a área do volume C. Palagi (1992) propôs que a posição do ponto gerador do bloco C 

(rc) fosse expresso como função do raio re e rw usando uma expressão desenvolvida por Pedrosa 

e Aziz (1986).

r = — exp 
a . 2 1 a* -  1

(30)

onde

a .  = (31)
W

O raio rc é usado somente na Eq. (28) para calcular a  para todas as conexões do bloco

C

O efeito da correção cilíndrica será analisado para o escoamento tipo pistão no Cap.

5 . Serão apresentados resultados para este tipo de escoamento empregando malhas híbridas, com 

fc = 1 e fc obtido via Eq. (27) na região radial. Discute-se também alguns dos resultados obtidos 

por Palagi (1992) empregando a correção cilíndrica.



Metodologias Explícita, Implícita e Adaptativa 33

vizinhos 

•  »

Fig. 9 - Bloco mais intemo de um módulo cilíndrico

3.5 Metodologia Totalmente Implícita

Fazendo-se 0 = 1 na Eq. (20), tem-se

i r V n+1
Aí Bp)

\n AL

Aí Bp)

( v- yi+l
__ n&gt;_

li Bn\ “p p )ij

l p « + l _ p n + l \  +  - n + l  (32)
\ PJ PS ) HPJ v

As incógnitas que devem ser calculadas implicitamente para cada volume são a 

pressão do óleo (P0) e a saturação da água (Sw). Apesar dos termos de poços serem tratados 

implicitamente pode-se mostrar facilmente que a pressão do poço não faz parte do sistema de 

equações. O que ocorre com o tratamento implícito dos termos de poços é o acréscimo de uma 

parcela no bloco diagonal do Jacobiano nos blocos contendo os poços. Este fato ocorre devido 

ao não surgimento dos termos de gravidade nos termos de fluxo e o fato de se ter desconsiderado 

os efeitos da pressão capilar no cálculo das vazões produzidas. Para o cálculo de

rp
li BV p  p/y

adotar-se-á o seguinte procedimento: será calculado pelo esquema UDS ou



Metodologias Explícita, Implícita e Adaptativa 34

upstream weighting scheme (esquema de um ponto a montante) como é conhecido na literatura 

de simulação de reservatórios e (ju-pB^ será calculado pela média aritmética dos correspondentes 

valores nos pontos ij.

O sistema de equações é resolvido iterativamente usando o método de Newton. A 

forma residual da equação de conservação do componente p para o volume i é

r „í = Y , t ü p,i ij
j =1

/ ir \n+l
__ rp_

Li B
\ * P P )

l pn+l _p n: l \ - n + l  
\ PJ PS 1 HPJ A t  Bp)

\ n

A t  B
; p = o ,w  (33)

p )

A Tab. 1 apresenta algumas restrições possíveis para os poços de injeção e produção. 

O sobrescrito * refere-se ao valor da restrição imposta.

Tab. 1 - Restrição para a equação do poço

Poço Restrição

Produtor

P r &gt; P* , ?wf — wf,min

\ l * \  +

Injetor

P &amp;lt;P*A wf — wf,max

Qwjc ^ QwJcjnsx.

Expandindo o resíduo em série de Taylor, tem-se



Metodologias Explícita, Implícita e Adaptativa 35

vx
_P£
d X  j

(34)

onde v é o nível iterativo e X representa as incógnitas (P0, Sw). Assumindo-se que o resíduo na 

iteração v + 1 é zero, tem-se .

ou,

onde

E
vx

' ^ ? xv __P£
l c&gt;X J

A X -1 = -J&amp;amp; ; p  = o,w (35)

[ j y  a x v+1 = - / r (36)

riv (37)

AXV+1 =&amp;lt;[ A P0&gt;1, A 5W)1,.... , AP0 A ^ .... , A P0&gt;N, ASW&gt;NV }riv+i (38)



Metodologias Explícita, Implícita e Adaptativa 36

M  =

3*&lt;m
^1

3*»,. 3*.,.
K &gt; 3s»,.j

f dR* 3* J

k * as*.

X *
®»n

3V 3V
«V. a S w,l.

3* „ ,. 3* o ,l

3*»,1

l 3 **«/ 3S»^.

[ 3*&lt;v aRJ
3 ÍW 3S»V

S K j 3* .v
[ 3 Í W

X » 3V
dP.OJ ds„j

3V

1 3V

(39)

onde, N é o número de volumes, e a matriz Jacobiana. As incógnitas (P0, Sw) são calculadas 

após cada iteração newtoniana, como

Xv+1 = X v + AXv+l (40)

e a solução é aceita quando todas as tolerâncias são satisfeitas, de acordo com

APv+1 £ AP*o jm x  ojm x
A - C *  * A S ^

(41)



Metodologias Explícita, Implícita e Adaptativa 37

3.6 Metodologia IMPES

No método IMPES a avaliação, em um determinado instante de tempo, dos termos 

de fluxo que carregam a informação da mobilidade do fluido e dos termos de produção ou 

injeção, é feita baseando-se nas saturações e pressões do instante anterior. Fazendo-se 0 = 0 na 

Eq. (20) e escrevendo-se a mesina, na forma residual para o componente p, tem-se

tf,

Rf ,  - £  T,j
i - 1

K rp
lí„ B n

P Hj

/ p n: l _ p n: l \ - n  
\ PJ P,i ) Aí B

Pt
Aí B

; p = 0 ,w  (42)
p )

onde,

K Ï  = - C  -  K / s j  &amp;lt;« )

procedimento similar é aplicado para a pressão da água no ponto i.

Obervando-se a Eq. (42) nota-se que o único termo que depende da saturação no 

instante futuro, n+1, é o termo de acumulação. Desta forma, quando da linearização de Newton, 

em cada linha de blocos do Jacobiano, o único bloco cheio é aquele da diagonal, ver Fig. 10a. 

Para obter a equação implícita da pressão cada linha de blocos do Jacobiano é multiplicada pelo 

inverso da diagonal, resultando na linha de bloco da Fig. 10b. Após esta operação a equação da 

pressão é desacoplada da equação da saturação originando a linha de blocos da Fig. 10c. Este 

processo é repetido para todas as células. A equação da pressão é obtida tomando-se a primeira 

linha de cada linha de blocos da Fig. 10c, originando o sistema dado pela Eq. (44).

[JT a x v+1 = - / r v&amp;lt;44)

onde, R*v é o vetor resíduo multiplicado pela inversa da matriz do bloco diagonal de cada



Metodologias Explícita, Implícita e Adaptativa 38

volume de controle. O vetor R*v é dado pela Eq. (45). Resolvido o sistema dado pela Eq. (44), 

P0 é obtido via Eq. (47) e Sw através da Eq. (48). Na Eq. (48), JÇj representam os coeficientes da 

segunda linha de i após a multiplicação pela matriz inversa da diagonal, conforme Fig. 10c.

* * ’ = ( i &amp;lt;i ... &gt;&lt;/&gt;... &amp;lt;í*]riv (45)

A*»*1 -  {[APm,.... A P ja ,..... A P „ ,f ) v W

K "  = p l  * AX" ‘&amp;lt;47*

(48)

(a)
X ‘“'W-

X 0
wi

X X X 0

,X 0, X X X 0,

(b)

p s". p Sw P Sw
X

0 ... l 1
01 X

X ol l o ll X 0

(c) t 1 t 1
m

X

?  - Equação da pressão

Fig. 10 - Seqüência de passos para obtenção da equação da pressão para o IMPES



Metodologias Explícita, Implícita e Adaptativa 39

3.6.1 Procedimento Iterativo Utilizando o Esquema IMPES

1. Estima-se as condições iniciais Sw, P„ (instante de tempo n);

2. faz-se, S ~ l = Swv e P0?  = P„v;

3. monta-se a matriz Jacobiana e função resíduo;

4. multiplica-se cada linha de blocos da matriz Jacobiana pela inversa do bloco diagonal;

5. calcula-se P0 no instante de tempo v + 1;

6. calcula-se Sw explicitamente via Eq. (48);

7. volta-se ao item 2 e itera-se até obter a convergência;

8. faz-se P "  =P"*1 e S "  =S”+1 e volta-se ao item 2 para avançar a solução para um novo 

instante de tempo.

Observe-se que o item 6 poderia ser realizado após a convergência da pressão, isto 

é, quando as variações de pressão fossem pequenas. Teoricamente, este seria o "verdadeiro" 

IMPES. A metodologia IMPES foi implementada desta forma neste trabalho, para que o ciclo 

iterativo do IMPES fosse idêntico ao ciclo iterativo do AIM, que será discutido na próxima seção. 

Entretanto, o "verdadeiro" IMPES também foi implementado e os resultados obtidos com o 

mesmo foram idênticos aos obtidos com o ciclo apresentado nesta seção. Com relação à 

implementação da metodologia IMPES, deve-se frisar que esta forma é mais estável 

numericamente que a forma implementada nos trabalhos de Mota (1993), Maliska e Mota (1994), 

Maliska et al. (1994) e Cunha et al. (1994). Este fato ocorre devido ao acréscimo da contribuição 

do termo de acumulação no termo diagonal de cada linha de blocos. No método IMPES 

implementado por Mota (1993), Mota e Maliska (1994), Maliska et al. (1994) e Cunha et al. 

(1994) as equações de conservação do óleo e água são manipuladas juntamente com a restrição 

de volume no sentido de obter a equação da pressão. Este fato origina um sistema linear para a 

pressão que é semi-defínido, se os fluidos presentes são incompressíveis. Ou seja, se AX é 

solução da Eq. (44) então AX + C, sendo C uma constante qualquer, também deve satisfazer a 

mesma.



Metodologias Explicita, Implícita e Adaptativa 40

3.7 Metodologia Implícita Adaptativa

A metodologia IMPES requer menor esforço computacional por intervalo de tempo 

que a metodologia TI. Entretanto, exige pequenos intervalos de tempo por motivo de 

instabilidades. Este efeito geralmente é localizado em algumas áreas do reservatório onde as 

velocidades são elevadas, ou os gradientes de saturação são elevados, ou em regiões onde ocorre 

um refino local da malha. Por outro lado, a metodologia TI permite trabalhar com maiores 

intervalos de tempo, uma vez que não sofre as limitações de instabilidade numérica do IMPES. 

O objetivo do AIM é tratar estas regiões onde o IMPES tem problemas de instabilidades 

utilizando o TI e o restante do reservatório utilizando o IMPES. Num dado intervalo de tempo 

a pressão irá ser calculada implicitamente em todo o reservatório e a saturação irá ser calculada 

implicitamente somente em algumas regiões do reservatório e explicitamente no restante. Esta 

divisão de regiões implícitas e explícitas pode variar a cada iteração de Newton e a cada intervalo 

de tempo.

Avaliando-se os termos de produção/injeção implicitamente e considerando que as 

mobilidades das fases podem ser implícitas ou explícitas pode-se escrever a Eq. (20) na forma 

residual como,

Nv /

?H V

K \n+0rp
Ll Bp /y

,p n : l _ p n: l \ - n : l _
V pj p&gt;i ) HP,i

( W S!
\ n +1 4&gt;vs, \n

A t  B
Pt I

A t  B
; p = o ,w  (49)

p / í

Aplicando-se o mesmo processo que foi realizado para a obtenção da matriz Jacobiana 

do IMPES, a Eq. (49), tem-se

[ J ] VA X V+1 = - R * v (5°)

com R*v e AXV + 1 idênticos às Eqs. (45) e (46), respectivamente.

Para uma melhor visualização da metodologia AIM considere-se a malha apresentada 

na Fig. 11. A matriz Jacobiana para o exemplo apresentado nesta figura, sem considerar a



Metodologias Explícita, Implícita e Adaptativa 41

presença poços, é apresentada na Fig. 12. Cada x na matriz da Fig. 12 pode representar

dR0 dR0 dRw dRw 
 ,  ,  o u  . 
dP dS dP dSO W O W

IMPES

TI

Fig. 11 - Exemplo bidimensional utilizando AIM para um escoamento bifásico

Po Sw Bí $w Jb Sw Po Sw Po Sw Ib Sw Po Sw Po Sw íb Sw

[J] =

i / R0\Rw
2 Í p°R?w
3 ÍR0 
\Rw

^  Rw
ÍR o  

* \Rw 

- {  

7 { 

8{  

9{

X X X X
X X X X
X x x x X X X
X x x x X X X

x x X X
x x X X

X X X X X X
X X X X X X

x X X X X X X
x X X X X X X

x X X X X X X
x X X X X X X

X X X X X
X X X X X

X X X X X X
X X X X X X

X X X X X
X X X X X

Fig. 12 -Matriz Jacobiana para o exemplo da Fig. 11



Metodologias Explícita, Implícita e Adaptativa 42

No caso de uma célula IMPES, as derivadas em relação a saturação aparecem somente 

no bloco diagonal. Suponha, por exemplo, que o volume i é IMPES e é vizinho do volume k,

que é TI. As equações para a célula i contém derivadas com relação a S^*1 somente na

submatriz diagonal do Jacobiano. Estas equações contém derivadas nas submatrizes fora da

diagonal principal com relação a S^ , visto que a célula k é TI. Para as equações da célula k

não existe nenhuma derivada com relação a S^ 1, uma vez que a célula i é IMPES. Existem, por

sua vez, derivadas em relação a oriundas dos termos de fluxo e dos termos de acumulação.

Conforme sugerido por Forsyth e Sammon (1986), cada linha da matriz Jacobiana é multiplicada 

pela inversa da submatriz diagonal. Para volumes IMPES esta operação elimina a saturação da 

célula do sistema de equações. Se a célula i é IMPES após a multiplicação pela inversa da

submatriz diagonal as únicas entradas não-nulas nas colunas correspondendo para S aparecem

na submatriz diagonal da célula i. Isto significa que a equação contendo dependência de

S ^ p o d e  ser retirada da matriz Jacobiana, uma vez que nenhuma outra equação tem dependência

sobre as derivadas de . Após a resolução do sistema para as outras variáveis, pode ser

calculada por retrosubstituição. Aplicando este esquema para a matriz Jacobiana da Fig. 12 resulta 

na matriz Jacobiana apresentada na Fig. 13.



Metodologias Explícita, Implícita e Adaptativa 43

1 2  3 4 5 6  7 8 9  
p p p s p  p s p  p p s p

3 / Ro\Rw

[J] = €

f

[Ro

ÍRo
R?w

rRo

fRo

H " :

1 X X

X 1 X X X X

X
X

1 0 
0 I

X
X

X 1 X X X

X
X

X
X

1 0 
0 1

X
X

X X 
X X

X X X X 1 X

X 1 X x

X X 
X X

X
X

1 0 
0 1

X
X

X X X X 1

Fig. 13 - Matriz Jacobiana para o exemplo da Fig. 11 para o método AIM

onde,

A X = {[ A Poi, A P ^ , A Pt í, A S^, A P ^  4ítf A S*. A P ^ A P ^ A P ^ , A 8 ^ , A (52)

Os esquemas IMPES, TI ou combinação de ambos (AIM) são de primeira ordem no 

tempo, ou seja, são compatíveis entre si e com o esquema de discretização espacial (UDS) 

empregado na avaliação das permeabilidades relativas nas faces de cada volume de controle.



Metodologias Explícita, Implícita e Adaptativa 44

3.7.1 Critério de Mudança de um Volume de IMPES para H  e Vice-Versa

Quando se utiliza a metodologia AIM, uma questão chave é o critério para a escolha 

se um determinado volume é IMPES ou TI. Forsyth e Sammon (1986) propuseram que o volume 

contendo o poço e seus vizinhos fossem tratados implicitamente (TI) e o restante do reservatório 

via IMPES. O critério para tròcar uma célula de IMPES para TI é baseado na mudança na 

pressão de saturação ou saturação do instante anterior. Cada vez que ocorrer uma mudança na 

saturação ou pressão de saturação maior que o valor previamente estabelecido, o volume passa 

de IMPES para TI. Evidentemente, este processo só permite que células passem de IMPES para 

TI e no final da execução quase todas as células serão TI.

O critério que será adotado neste trabalho é o critério de estabilidade local da matriz 

Jacobiana proposta por Fung et al. (1989). A seguir delinear-se-á este procedimento.

Se Rj1*1 e X * 1 denotam o resíduo das equações de conservação e variáveis primárias 

( P ^ 1 e S / " ) ,  respectivamente, a iteração de Newton pode ser escrita na notação indiciai, como

j^n+l,v+l _  j£ii+l,v dRl
n+l,v

ex;B+l.V
* r ‘,v ;&amp;lt;=1 ..J V . e j = L . . M

(53)

onde Nq é o número de espécies químicas ou componentes. Na Eq. (53), X i ’ é a (v+l)-ésim a 

iteração de X, no tempo (n+1), e Rj“+1,v é a v-ésima iteração da equação j. X "4-1, V+1 convergirá 

quando a norma infinita de X for pequena, ou seja, |X in+1,v4'1 - Xin+1,v||to &amp;lt;E. Escrevendo dRjn+1,v, 

como

dRn+l,v+l
/ aj?;+1*v+lN

dx njn
dXn,m

dR,n+l,v+l

dX Í»+1,V+1
dXn+l,v+l (54)

onde o índice m refere-se á última iteração do instante de tempo n.



Metodologias Explícita, Implícita e Adaptativa 45

Se os erros no instante n e n+1 são s" e e,1*1, respectivamente, pode-se escrever a 

Eq. (54) como,

'd R j +l'v+?

dX,
n+l,v+l

n+1 / ô/?/+1,V+lN
njn

(55)

onde os sinais de s não foram considerados, porque se está interessado nas normas de s. 

Fazendo-se,

T  =
's r ; “'’*1' 'a*;+1’v+1&gt;

1
1

d x nst
(56)

pode-se escrever a Eq. (55), como

e"+1 =Tzl (57)

onde T  é a matriz transformação. Segundo Fung et al. (1989), a condição de estabilidade do 

intervalo de tempo (At) é,

a qual garante que os erros introduzidos em um intervalo de tempo não serão amplificados nos 

intervalos seguintes. Esta condição é satisfeita se T é normal2, requerendo que,

2Uma matriz normal (J) comuta com sua transposta (J1), isto é, JJ1 = «fJ.



Metodologias Explícita, Implícita e Adaptativa 46

p(7) = max||a;(7)|| á 1; 1&amp;lt;i&lt;Nq (59)

onde p é o raio espectral e otj os autovalores de T. A análise anterior proposta por Fung et al. 

(1989) determina se o sistema como um todo é estável. Entretanto, o objetivo é determinar quais 

células são instáveis com o At escolhido. Fung et al. (1989) sugerem que a Eq. (57) seja escrita 

para cada célula e seja calculado o máximo autovalor de C, onde C é dado por,

f d R j+1’v+1&gt;
-i

'dR?+1'v+1'
dxfn+1’v+1 d xnjn\ 1 /

Fung et al. (1989) argumentaram que se deve excluir de Rj os termos de acumulação 

no instante n para que este critério funcione adequadamente. A seguir apresenta-se uma expressão 

para o cálculo de máximo autovalor de cada célula. Representar-se-á por Rj" a função resíduo 

excluída do termo de acumulação no instante n.

Avaliando-se os termos de fluxo no instante n e desprezando-se o termo de 

acumulação no instante n, pode-se escrever a equação residual para as fases óleo e água como,

(61)

(62)

Usando a Eq. (57) do ponto de vista local, tem-se



Metodologias Explícita, Implícita e Adaptativa 47

K i &amp;lt;• &amp;lt;• &amp;lt;•

&amp;lt;, +1 a « : ; 1
O  n+1
&lt;^Pi dP0nj &amp;lt;« •

&amp;lt;/ &amp;lt;« •
C s ; : 1 d K j &amp;lt;/

d P £ l c 1.
*

.

8  ,?

e s ; ,

(63)

Para o cálculo das derivadas admitiu-se que o escoamento é incompressível. Isto de 

certa forma facilita o cálculo dos autovalores. Numa etapa posterior desprezou-se esta hipótese 

e o comportamento do método foi idêntico. Portanto, para todos os resultados que serão expostos 

no Cap. 6 empregando-se a análise de estabilidade, foram obtidos considerando-se que os fluidos 

presentes no reservatório são incompressíveis. Levando-se em consideração a hipótese do 

escoamento incompressível, tem-se

d P
n+i
oj

(64)

&amp;lt;/

dP./l+lo,i

Ny

- H Ti\ j =1

(  i r  \ n  
rw (65)

a * «

&amp;lt;?

K , = o (66)

*V,
/l+l

A tB.
(67)



Metodologias Explícita, Implícita e Adaptativa 48

C 1

*vt
A ífl,n+1

(68)

as,n*lwj

Xn( d K ^

ds:
(P -p  .)v o j o y

rt+1 (69)

&amp;lt;/

&amp;lt;/

\rt
f a O

) [ &amp;lt;]
(p % 1 - p ÔJl +pcn(.swJ  - p c ( s wj)) (70)

Com algum algebrismo pode-se mostrar que a matriz de transformação local C pode 

dada por

C =
Det

a&lt;,. a/?;, d K j
es: : 1 d p i dsi? õp";n+1

0,1 H-,1 0,1

ôr;4 a &amp;lt;; a &amp;lt;,-

[ d P ^ d P Z j  dPn0; l dP n0j

d K j  a i C

w,i ^ w ,i w j w j )

a/?;, a&lt;,. a&lt;,- &amp;lt;,
a p n+lo j dS^4 dP n0; l dSnw4f

Det
^11 ^12 

^21 ^22
(71)

ie,

Det
a*;,. a &amp;lt;, ô/?;, a &amp;lt;(.
a p /|+l aon+l ann+l a p n+l 

Wyt VP0j )

(72)

Os autovalores da Eq. (71) satisfazem a equação quadrática,



Metodologias Explícita, Implícita e Adaptativa 49

a 2- Q c c + Y  =  0  ( 7 3 )

onde,

0  = ( C ^ C ^ D e t  e y = (Cn C22 -  C2ICI2) /D « 2 (74)

Substituindo-se a Eq. (66) na Eq. (74), e o resultado na Eq. (73), tem-se os dois 

autovalores,

a 1 = 0 e a 2 = C22JDet (75)

Desta forma, para estabilidade é necessário que Bc? l] &amp;lt;1. No caso de se relaxar a 

hipótese de incompressibilidade dos fluidos presentes no reservatório, deverão existir dois 

autovalores reais.

Apresenta-se agora a relação do cálculo da estabilidade com o CFL, conforme 

apresentado por Russel (1989). Considere-se o escoamento bifásico (óleo-água), unidimensional, 

incompressível e sem a inclusão do efeito da pressão capilar e gravitacional. A equação 

governante que descreve a frente de saturação da água é conhecida como equação de Buckley- 

Leverett (Allen et a i, 1988) e é dada por,

d sw + = 0 (76)
dt&amp;lt;J&gt; ctc

onde Vt é a velocidade total (óleo + água) e f*  é o fluxo fracionário da água sem a pressão

capilar e é a razão entre a mobilidade da água e a mobilidade do óleo e da água, sendo portanto, 

uma função da saturação da água. Maiores detalhes serão fornecidos no Cap. 5.



Metodologias Explícita, Implícita e Adaptativa 50

Assumindo-se que f*  e Sw são funções diferenciáveis pode-se escrever a Eq. (76)

como,

dS dS 
— -  + v— -  = 0 

d t dx
(77)

onde

v  =
?

(78)

é uma velocidade positiva e constante.

Para resolver a Eq. (77) suponha ainda a seguinte condição inicial e de contorno,

S w(x,0 )  = 0  0&amp;lt;*&amp;lt;1; (? 9 ) 
S w(Q,t) = 1 í&gt;0;

AX,
= 0 
A

i-1 i i+1 i

i - 1/2 i+1/2

Fig. 14 - Discretização da equação de Bucklev-Leverett

Discretizando a Eq. (77) no espaço (Fig. 14) e no tempo e empregando-se um 

esquema explícito tem-se,



Metodologias Explícita, Implícita e Adaptativa 51

( C  -
A í

(80)

Assumindo o esquema UDS para avaliação das saturações nas faces e com v positivo

tem-se,

(81)

onde Cj é o CFL do volume i e é dado por

VAX. 

Cf ~ A í
(82)

Reescrevendo a Eq. (81) na forma de resíduo tem-se,

= c  -  í x - c) a  -  c x ,í-i i (83)

com Snw0 = 1 quando i=l.

Pode-se mostrar que o esquema explícito dado pela Eq. (83) é estável para c, &amp;lt;1, 

(Peaceman, 1977; Russel, 1989). As derivadas da Eq. (60) são dadas por,

dRjn+l,v+l

a c n+l,v+l
™Wti

=/,
dR

n+l,v+l

as,n+ljnw,i

1-c*

1 - C ,

(84)

Desta forma,



Metodologias Explícita, Implícita e Adaptativa 52

-1
rdflIB+1’V+1&gt; d R " " ’" "

3 Cn+l,v+l 
\ "V a C * C 1-”

(85)

Uma vez que a matriz C é uma matriz triangular inferior os autovalores são os 

elementos da diagonal. Neste caso o critério de estabilidade é satisfeito para 0 &amp;lt;c, &amp;lt;2. 

Entretanto, esta não é a condição aplicada uma vez que no trabalho de Fung et al. (1989) é 

sugerido que os termos no instante n sejam suprimidos do cálculo da estabilidade. Fazendo-se 

isto, remove-se os l's  da diagonal de C e os autovalores são dados por cs e o critério exige que 

Cj &amp;lt;1. Observe-se que este também é o critério empregado via análise do CFL.

3.8 - Escolha do Passo de Tempo

Conforme Aziz e Settari (1979) a escolha do passo de tempo (At) deve assegurar 

estabilidade da solução e erros de truncamento aceitáveis e conforme estes autores estes 

requerimentos podem ser relacionados ao menos qualitivamente para as taxas de troca nas 

saturações e pressões no reservatório. Mudanças bruscas nas saturações e pressões indicam que 

menores passos de tempo devem ser empregados.

O algoritmo para controle do passo de tempo conforme apresentado por Aziz e Settari 

(1979) é dado por:

a) Calcular

DPMAX" = max,{ l A P ^ J }

DSMAX" = maXjJ |AS"w,mJ }

b) Calcular At1*1 como

A t^1 = min{Ats, At„}

onde

Ats = A f DSLIM / DSMAX" ; Atj, = A f DPLEM / DPMAX“



Metodologias Explícita, Implícita e Adaptativa 53

DSLIM e DPLIM são parâmetros de iteração a serem definidos pelo usuário. O algoritmo irá 

manter as variações de pressão e saturações próximas para DPLIM e DSLIM. Por causa das não- 

lineraridades envolvidas os valores de DPLIM e DSLIM podem ser consideravelmente excedidos. 

Isto pode ser prevenido adicionando o seguinte passo:

c) após a solução no instante de tempo (n+1) ser completada, calcule DSMAX1*1 e DPMAX1* 1. 

A solução é aceita se,

DSMAX1*1 &amp;lt;c, DSLIM e DPMAX1*1 &amp;lt;c2 DPLIM 

onde c, e c2 são constantes e maiores que 1. No presente trabalho = c2 = 1,1. Caso contrário, 

calcule At* como,

At* = min{Áts, Atp}

onde

Ats = A f 1 DSLIM / DSM AX^1 ; At„ = Af*1 DPLIM / DPMAX"*1



MÉTODOS DE SOLUÇÃO DE SISTEMAS LINEARES 54

4.1 Introdução

Neste capítulo serão discutidos alguns aspectos relevantes da solução dos sistemas 

lineares. A saber, o precondicionamento e a ordenações das incógnitas. Também serão 

apresentados os algoritmos dos três métodos não-estacionários (GMRES, Bi-CGSTAB e 

ORTHOMIN) que foram empregados na solução dos sistemas lineares deste trabalho.

4.2 Precondicionamento

De acordo ao que foi exposto no Cap. 3, o processo final da solução dos problemas 

descritos é a solução dos sistemas lineares. Para maior clareza, considere o sistema linear,

Jx = R (86)

onde J  é a matriz Jacobiana, x  é o vetor solução e R é a função resíduo. Observe-se que AX, na 

Eq. (36) e similares foi substituído por x  na Eq. (86), por simplicidade. Os métodos iterativos 

não-estacionários, em geral, utilizados para solução deste tipo de sistema apresentam taxa de 

convergência lenta. Com o objetivo de melhorar a taxa de convergência destes métodos, resolve- 

se o sistema equivalente,

M[ lJ x  = M;l R (87)

onde, M, é denominada matriz de precondicionamento e deve ser ao mesmo tempo, uma boa 

aproximação do Jacobiano e sua fatoração fácil de ser obtida. Observe-se que M, deve oscilar 

entre a matriz identidade e a matriz Jacobiana J. Se a matriz de precondicionamento for uma boa 

aproximação de J  o raio espectral de (M ^ J) é menor que o de J, e isso acelera a taxa de 

convergência do método iterativo.



Métodos de Solução de Sistemas Lineares 55

O novo sistema, dado pela Eq. (87), é considerado precondicionado a esquerda. 

Existem outras duas formas possíveis de se aplicar o precondicionador: à direita ou à esquerda 

e direita. Nos resultados que serão apresentados no Cap. 7 foi utilizado o precondicionamento 

à direita. Foram realizados alguns testes com o sistema dado pela Eq. (87), mas estes foram 

sempre inferiores à aqueles obtidos com o precondicionamento à direita. Para o 

precondicionamento à direita pode-se escrever a Eq. (86), como

j m ; 1z = r  e x  = W

Nesté caso, o resíduo correspondente do sistema precondicionado é idêntico ao 

resíduo original,

rk = R -  J M ; lzk = R  -  J x k (89)

Existem diversas possibilidades de se obter Por exemplo, se a matriz J  apresenta 

uma estrutura regular, uma partição de J  pode ser uma boa escolha para M r  Entretanto, se J 

resulta de uma discretização utilizando malhas não-estruturadas a estrutura de J, além de ser 

esparsa, pode não ter uma estrutura regular e a escolha de M, como sendo uma partição de J  

pode não ser adequada, Marcondes et al. (1995c). Precondicionadores baseados na estrutura 

global da matriz Jacobiana contém mais informações e, geralmente, fornecem resultados 

satisfatórios para malha estruturadas e não-estruturadas. Se o precondiconador é baseado na 

estrutura de J, a matriz Mt pode ter o mesmo padrão de esparsidade de J  ou pode ter elementos 

adicionais que não pertençam a estrutura de J. Caso seja permitido a criação de elementos que 

não pertençam a estrutura original de J  é necessário que primeiramente uma fatoração simbólica 

seja realizada, Simon (1988).

Na fatoração simbólica não é realizado nenhum cálculo, apenas é localizada a posição 

dos novos elementos, do ponto.de vista de nível. Para cada posição (JÇj) na matriz está associado 

um nível /(J? ,). Inicialmente,



Métodos de Solução de Sistemas Lineares 56

KJ,) =
0 se J y * 0 

&lt;» se Jjj=Q
(90)

no m-ésimo passo da eliminação gaussiana, define-se

f t y  = m i n K J J  * W J  * 1] (91)

Por definição todos os elementos nas matrizes L e U têm nível 0 (zero). Caso não seja 

permitido que elementos adicionais sejam criados, obtêm-se uma fatoração de ordem zero, 

denominada por ILU(O). Se uma fatoração de nível 1 (um) é realizada, somente os elementos com 

nível menor ou igual a um são aceitos com os elementos de nível mais alto rejeitados, isto é, não 

são incluídos nos fatores L e U . A Fig. 15 apresenta os elementos criados nos fatores L  e U para 

uma ILU (l). Quanto maior o nível da ILU, menor o custo por iteração do método iterativo. Por 

outro lado, a memória e o trabalho na realização da fatoração aumentam, o que pode 

comprometer o desempenho do método iterativo. Usualmente níveis 0, 1 e 2 são os mais 

recomendados pois não comprometem o custo da iteração individual do algoritmo.

Este tipo de fatoração incompleta é denominado point-wise, (Meijerink e van der 

Vorst, 1981; Forsyth e Sammon, 1985; Simon, 1988; Marcondes et al., 1995c), e é diferente dos 

precondicionadores de blocos (Axelsson, 1985; Concus et al., 1985; Eisenstat et al., 1988; Aarden 

e Karlsson, 1989). No segundo caso, particiona-se a matriz Jacobiana por blocos da forma 

J  = Dj + L, + U1? onde D, é o bloco diagonal, L, é o bloco triangular inferior e U, o bloco 

triangular superior. Cada posição no bloco pode ser um elemento ou uma submatriz de dimensão 

igual ao número de equações acopladas por células. Os precondicionadores point-wise têm sido 

preteridos por alguns autores porque têm mais relações recursivas do que os de blocos, sendo 

portanto, menos paralelizáveis e vetorizáveis. Entretanto, a maioria dos trabalhos que utilizam 

este tipo de precondicionadores empregam malhas estruturadas. Não é claro, entretanto, a 

eficiência deste tipos de métodos na solução de sistemas lineares oriundos de malhas não- 

estruturadas, devido a conectividade variada. Além do mais, os computadores que serão utilizados 

para a implementação do código computacional são seriais, de forma que não é objetivo, neste



Métodos de Solução de Sistemas Lineares 57

instante, a paralelização e vetorização do código em desenvolvimento. Pelos motivos 

anteriormente expostos resolveu-se adotar no presente trabalho o precondicionador tipo point- 

wise.

X  X  

X X X  

X X X  

X  X

X  X

X  X

x  Lx
X  [X

X

x l X

X

X

X  X

X  X

X

X  X
X X X

X X X

^  - Posição original 

X  - Elementos criados
- Elementos descartados

Fig. 15 - Fatoração incompleta de nível 1 - IL U (l)

4.3 Ordenação das Incógnitas

No presente trabalho foram empregados dois tipos de ordenações: uma geométrica 

(natural, vertical e horizontal) e outra baseada na fatoração incompleta da matriz Jacobiana (MDF 

- M ini muni Discarded Fill).

A ordenação natural é a ordenação oriunda do gerador da malha. Para malhas 

híbridas, a malha básica é hexagonal ou cartesiana, com os volumes podendo ser distorcidos ou 

irregulares. Após a construção desta, escolhe-se o local onde se deseja a malha polar, por 

exemplo, em torno de um poço vertical. Os pontos pertecentes à malha básica contidos na região 

polar são eliminados e os pontos remanescentes renumerados. Os novos pontos colocados dentro



Métodos de Solução de Sistemas Lineares 58

da janela polar são numerados a partir do último nó da malha básica. Por simplicidade apresenta- 

se na Fig. 16, para uma malha cartesiana, um exemplo onde foram retirados 16 pontos na região 

central da malha em um janela retangular. Os novos pontos a serem incluídos nesta janela serão 

numerados a partir do ponto 85. Note que isto torna a matriz originalmente estruturada (Fig. 16a) 

numa matriz com uma estrutura bastante complexa. Observe-se também que o termo natural não 

tem nenhuma conexão com a ordenação natural utilizados em malhas cartesianas.

91 92 93 94 95 96 97 98 99 100

81 82 83 84 85 86 87 88 89 90

71 72 73 74 75 76 77 78 79 80

61 62 63 64 65 66 67 68 69 70

51 52 53 54 55 56 57 58 59 60

41 42 43 44 45 46 47 48 49 50

31 32 33 34 35 36 37 38 39 40

21 22 23 24 25 26 27 28 29 30

11 12 13 14 15 16 17 18 19 20

1 2 3 4 5 6 7 8 9 10

75 76 77 78 79 80 81 82 83 84

65 66 67 68 69 70 71 72 73 74

55 56 57 58 59 60 61 62 63 64

49 50 51 52 53 54

43 44 45 46 47 48

37 38 39 40 41 42

31 32 33 34 35 36

21 22 23 24 25 26 27 28 29 30

11 12 13 14 15 16 17 18 19 20

1 2 3 4 5 6 7 8 9 10

(a) (b)

Fig. 16 - Esquema de ordenação do gerador

A ordenação vertical ou horizontal, proposta por Palagi (1992), é realizada de forma 

semelhante à ordenação natural empregada em malhas cartesianas. Para o caso da ordenação 

horizontal, considere-se a malha da Fig. 17. Localiza-se o ponto gerador com menor valor de y, 

e passa-se uma linha horizontal com altura igual a y mínimo. Todos os pontos geradores que 

estiverem sobre esta linha serão renumerados. A seguir localiza-se, entre os pontos não 

renumerados, o próximo ponto com menor valor de y e repete-se o processo para os pontos 

remanescentes. A Fig. 18 apresenta a estrutura da matriz Jacobiana para a ordenação horizontal 

aplicada à malha da Fig 17. A ordenação vertical é realizada de forma semelhante, a única



Métodos de Solução de Sistemas Lineares 

diferença é que as linhas traçadas são verticais com cota igual a x mínimo.

Fig. 17 - Malha de Voronoi - esquema de ordenação horizontal

X X X X

X X X X

X X X X

X X X X X X

X X X X X X

X X X

X X X X

X X X X X

X X X X

X  X X  X

X X  X X  X

X X  X  X  X  X  X

X X  X X  X

X X  X

X  X  X  X

Fig. 18 - Estrutura da matriz Jacobiana - ordenação horizontal



Métodos de Solução de Sistemas Lineares 60

Conforme D'Azevedo et al. (1991) a combinação de malhas não-estruturadas com 

meios heterogêneos tornam os precondicionadores baseados em fatorações incompletas (ILU) 

muito sensíveis a ordenação das incógnitas. Na maioria dos casos não existe uma forma adequada 

de ordenação. No trabalho de D'Azevedo et al. (1992a) é mostrado que a solução de um sistema 

linear oriundo de problema de condução de calor com ordenação natural x-y, é fortemente afetada 

pelos valores das condutividades térmicas nessas direções. Baseado neste fato, os mesmos autores 

propuseram um método de ordenação das incógnitas baseado não somente na estrutura da matriz, 

mas também nos seus valores numéricos. Este esquema, denominado MDF (Minimum Discarded 

Fill), também está associado a uma fatoração incompleta. A idéia do método é ordenar as 

incógnitas que minimizem localmente o enchimento a ser descartado durante a fatoração 

incompleta. Este método tem sido utilizado nos trabalhos de D'Azevedo et al. (1991, 1992a) para 

problemas não-simétricos e simétricos, respectivamente, utilizando malhas estruturadas e não- 

estruturadas.

A ordenação das incógnitas através do MDF é realizada durante a fatoração 

incompleta da matriz Jacobiana, ordenando os nós que tiverem menores discard (D'Azevedo et 

al., 1991). Para um dado nível da fatoração incompleta, o discard para o nó i é calculado com 

os elementos que não fazem parte dos fatores L e U. A Fig. 19 apresenta os elementos que 

participarão do cálculo do discard para o nó 1 (pivô) quando uma 1LU(0) for realizada.

X
X

X l .

1
X

X

X

A  - Nó eliminado ( pivô)

X - Elementos originais da matriz

X) - Elementos eliminados 
? - Elementos descartados

Fig. 19 - Representação da eliminação do nó 1 para uma ILU(O)



Métodos de Solução de Sistemas Lineares 61

O valor do discard para o nó / é dado por,

discard(i) = (^2 (elementos descartados)2)112 (92)

O algoritmo MDF para uma ILU(l) é denotado por MDF(l).

Algoritmo MDF.

Inicialização:

J =  J„
para cada *  0

w  = 0

para cada nó i 

calcule discard(i) 

para k=l,...,n

. escolha o nó com o mínimo discard 

. elimine o nó j

. para todos os nós k vizinhos de j 

atualize o discaid(k)

No processo de eliminação e cálculo do discard é possível obter-se vários nós com 

o mesmo discard, principalmente nos estágios iniciais da ordenação. Nesses casos são necessários 

estratégias de desempate (lie-breaking). Utilizar-se-á neste trabalho como primeiro critério o nó 

com mínima deficiência (menor enchimento, caso este nó seja eliminado) e se, mesmo assim, 

ainda existam nós empatados procura-se o nó com o menor valor na ordenação original.

Quando o esquema totalmente implícito é empregado, existem duas incógnitas por nó 

(P0,S„), originando uma matriz Jacobiana blocada, com cada bloco sendo 2x2. D'Azevedo et al.

(1991) não aplicam o MDF para a matriz Jacobiana completa, e sim para uma matriz reduzida 

com forte influência da pressão, considerando que a pressão domina a convergência do solver.



Métodos de Solução de Sistemas Lineares 62

Uma típica linha da matriz Jacobiana é apresentada na Fig. 20a. A matriz reduzida é originada 

multiplicando cada linha de blocos da matriz Jacobiana (Fig. 20a) pela inversa do bloco diagonal, 

resultando a linha blocada apresentada na Fig. 20b. Considerando as entradas 8 pequenas, do 

ponto de vista de ordenação, a pressão resulta independente da saturação. Este processo é repetido 

para todas as linhas de blocos e o MDF é aplicado para a matriz reduzida de pressão, obtida no 

final deste processo. Observe-se que este procedimento é idêntico para as metodologias IMPES 

e AIM. A única diferença é que as entradas e  são zero para as células IMPES.

(a)
X

wi
X X

“~w_
x x x 1

,X X x x, x X,

( b )

1 V?_
X 8

*
' 1 0 '

' r
X 8

XX

10  1 , ,X X

(c)
t a  £' tD 0 1 Kl 8

,X X,
0 X X

?  - Equação da pressão

Fig. 20 - Seqüência necessária para originar a equação reduzida de pressão para a
metodologia TI

4.4 Métodos de Solução

Apresenta-se agora os algoritmos dos três métodos não-estacionários que foram 

empregados no presente trabalho. Todos os algoritmos são precondicionados à direita. Nos 

algoritmos descritos, jc0 é a aproximação inicial, r0 o resíduo calculado com este ponto. Em todos 

os casos jc0 foi calculado por,



Métodos de Solução de Sistemas Lineares 63

= (93)

4.4.1 Método GMRES

No método GMRES (sem precondicionamento) de Saad e Schultz (1986), a cada 

passo minimiza-se a norma do vetor |R  - J(x0+z)H, onde z é um membro do subespaço de 

Krylov K,,, = span {r0, Jr0, ..., Na prática a dimensão m do subespaço de Krylov é

determinada no sentido de reduzir o custo do algoritmo e restrição de memória. No processo de 

minimização, busca-se uma base ortonormal de K,,, e posteriormente resolve-se um problema de 

quadrados mínimos. Os resultados deste trabalho correspondem à utilização do método de Gram- 

Schmidt modificado sucedido por rotações no plano.

Algoritmo GMRES.

passo 1 - inicialização

r0 = R  - Jx„ ; Vj = r0 /  II r jl e et = II r j  

passo 2 - iteração do GMRES 

para j= l,...,m  

Zj = M-'vj 

W=J Zj

passo 3 - ortogonalização de Gram-Schmidt Modificado 

para

«ij = (w,Vi)

w  W  -  u y  V,

Vj+i =  w / u ^ j j

Hi =



Métodos de Solução de Sistemas Lineares 64

passo 4 - algoritmo QR (rotações de Givens) 

para i= l,...,j-l

C, S;
1 «- 1 1

V i J - s .  C- 1 1.

v

y = i-iú2 + »u«2]2
cj = ujj 1 y

sj = «ufi &gt; y
rotação aplicada a U

i,jj&amp;lt;- y
u 0

rotação aplicada a e

ejH * sj ej

ei ~CJ eJ
se | e^j | / | e, I  &amp;lt;TOL saia do loop j 

passo 5 - resolve y

&gt;1
? +—

«1,1 •" uj j
-1 *1

;

&amp;amp; 0 .- “/V. h

passo 6 - resolve x

* = *o + z „ , y ni 

se convergiu pare 

senão

passo 7- recomeço 

r „ = R -  lx m

x0 = xm e Vj = r j  II r0 II vá para o passo 2

No algoritmo apresentado e é o vetor canônico de m  + 1 componentes, TOL é a 

tolerância, Z^



Métodos de Solução de Sistemas Lineares 65

4.4.2 Método Bi-CGSTAB

O Bi-CGSTAB, de van der Vorst (1992), foi desenvolvido no sentido de corrigir 

"freqüentes irregularidades" no processo de convergência do método CGS (Conjugate Gradient 

Squared, Sonneveld, 1989), por um tipo de minimização local do vetor resíduo. O CGS pode ser 

visto como um método no qual o operador contração do BiCG {BiConjugate Gradient, Voevodin, 

1983) é aplicado duas vezes. O Bi-CGSTAB pode ser interpretado como o produto do BiCG e 

repetidamente aplicado o GMRES(l). Ao menos localmente, o vetor resíduo é minimizado, o qual 

conduz a uma convergência suave, Barrett et al. (1994).

Algoritmo Bi-CGSTAB.

r„ = R  - Jx„

r = r0 , p„ = a„ = 0)o = 1

vo = P o = 0

para i=l,2,...

Pi =  ( ?  A  , )  

Pi-i =  (Pi /Pi-i y ( a i i /  Mi l) 

P i =  ri-i +  Pi-i ( Pi-i - a&gt;i-t Vi-i)

P = M 1Pi

Vi = J p

«, ~ P i /  &gt;v , )

= 'i-i - «,-/

S = M 1 s

t = J s

(Oi =  (t,s)/(t,t)

Xi = Xi-1 + a iP +

r, =  .v -  (Oi t

se II ijll /II r0ll &amp;lt;TOL pare



Métodos de Solução de Sistemas Lineares 6 6

senão

x i-, = X i; a ,.| =  a , ; (oUÍ =  =  #

4.4.3 Método ORTHOMIN

O ORTHOMIN minimiza a norma do resíduo no subespaço de Kyrlov e conforme 

Ewing (1989) pode ser interpretado como a versão com recomeços do método CGR (Generalized 

Conjugate Residual, Eisenstat et al., 1983), o qual é uma classe especial dos métodos conhecidos 

como Petrov-Galerkin-Krylov.

Algoritmo ORTHOMIN.

r0 = R -  ,bc0 

passo 1: 

para k = l, ... ,m 

vk = M-'rk_t

ai,k= - ( ? h v M V f V q )  ; i= i,k -i

Jt-1
4k = vk -  E  ai ^ i  

i—1

&lt;t&gt;k = (rk-,rfql)/(J(lkJ q J  

x k = x k_, + (Okqk 

ru = rk.i '  0 ijq k 

se II rjll /II r0ll &amp;lt;TOL pare 

senão

passo 2 - recomeço

r. = R -  Jxm
x o = x nn vá ao passo 1

Conforme citado em Behie e Vinsome (1982), o coeficiente a \ é escolhido de modo 

que a soma dos quadrados do resíduo seja minimizado e os coeficientes aik são os coeficientes



Métodos de Solução de Sistemas Lineares 67

de ortogonalidade, de modo que os vetores aqk sejam ortogonais.

A Tab. 2 apresenta o número aproximado de operações para cada um dos métodos. 

Verificando-se os dados da Tab. 2 pode-se concluir que, se o número de iterações do GMRES 

e ORTHOMIN coincidem, o custo do ORTHOMIN deverá ser maior, uma vez que, o mesmo 

realiza 1 produto interno e (i+1) operações do tipo (x + a y ) a mais que o GMRES.

Tab. 2 - Número aproximado de operações dos métodos para i iterações

MÉTODO (*&gt;y) y  + a x y  = Jx V: I
I *

GMRES i + 1 i + 1 1 1

ORTHOMIN i + 2 2i + 2 1 1

Bi-CGSTAB 4 6 2 2

Todos os métodos anteriormente descritos foram empregados no presente trabalho. 

Nos resultados apresentados nos Caps. 5 e 6 foi empregado apenas o método GMRES. O Cap.

7 é dedicado a uma comparação da eficiência dos três métodos. No Cap. 7 foi também verificado 

o efeito de diversas ordenações geométricas no desempenho destes métodos de solução. Com 

relação ao MDF é mostrado o efeito desta ordenação somente para o GMRES.



VALIDAÇÃO DO MODELO NUMÉRICO 68

5.1 - Introdução

O objetivo deste capítulo é validar alguns dos resultados obtidos no presente trabalho 

com os dados existentes na literatura. As comparações foram realizadas utilizando a metodologia 

totalmente implícita (TI). Para efeito de comparação foram analisados alguns dos resultados 

obtidos por Palagi (1992) e os resultados obtidos com o SIRP-3D (Simulador de Reservatórios 

de Petróleo Tridimensional) (Maliska, et. al, 1995, Cunha, 1996). O SIRP-3D emprega 

coordenadas curvilíneas não-ortogonais e o modelo utilizado é o black-oil com as frações 

mássicas e pressão como variáveis dependentes. Por último, foram realizados alguns testes para 

verificar o efeito da pressão capilar na recuperação de óleo.

5.2 - Comparação com os Resultados de Palagi (1992)

Comparou-se inicialmente os resultados obtidos para um escoamento tipo pistão para 

razões de viscosidade (M) iguais a 10 e 50. Este tipo de escoamento, apesar de não ser um 

escoamento típico de reservatório, é largamente empregado para efeito de validação de resultados 

porque a sua solução é bastante dependente da orientação da malha utilizada. As curvas de 

permeabilidade relativa e razão de viscosidades são dadas pela Eq. (94). A Tab. 3 apresenta os 

dados físicos e geométricos do reservatório e a Fig. 21 mostra a malha hexagonal. Esta malha 

se assemelha a malha hexagonal-híbrida com 445 volumes empregada por Palagi (1992). No 

trabalho de Palagi (1992) a região cilíndrica foi localizada na região onde as linhas de igual 

potencial eram aproximadamente circulares para um deslocamento com razão de mobilidades 

iguais a 1 (um). Para a geração da malha da Fig. 21, o tamanho da região cilíndrica foi tomado 

como uma medida aproximada da Fig. 8.1-b do trabalho de Palagi (1992). Devido à simetria da 

malha hexagonal, a malha da Fig. 21 apresenta os poços diagonal e paralelo. Observe-se que as 

linhas que unem os pontos geradores dos volumes da malha hexagonal são paralelos em relação 

ao escoamento do poço injetor-produtor na horizontal, enquanto que são inclinados em relação 

ao escoamento do poço injetor-produtor na vertical, dai a denominação poço paralelo e poço 

diagonal. Para os resultados que serão apresentados nesta seção foram utilizados como critério



Validação do Modelo Numérico 69

de parada de uma iteração newtoniana 6,893x102 Pa para AP*0&gt;niai e 10'4 para AS’wniaï. A vazão 

de produção corresponde a uma vazão constante de líquido prescrita (óleo + água).

*? „ = s l n m i - s i )  * s l &gt;
-  1&amp;lt;94&gt; 

M = v -J v -,

Tab. 3 - Dados físicos e geométricos do reservatório - caso 1

Dados do reservatório Condição inicial Propriedades físicas

k = 12,5 x 10 15 m2 Swi = 0,0 B0= Bw = l a  0 Pa

h = 6,09 m Ps = 6,893xl05 Pa y h o

A = 1,6 x 105 m 2 Sor= 0 ,0 = IO 3 P a s

&lt;|&gt; = 0,08 = Í/M  x l O3 Pa.s

rw= 0,0914 m c„ = cw= 1,45x10 9 P a 1

\\qu \\ = \\qwI\\= 1,10x10-* m*/s



Validação do Modelo Numérico 70

p  diagonal

As Figs. (22) e (23) apresentam as curvas de volume de óleo recuperado (VOR) 

versus volume poroso injetado (VPI), para M igual a 10 e 50, respectivamente. As Eqs. (95) e 

(96) apresentam a definição destes dois números adimensionais, onde Swi é a saturação de água 

inicial e Sor é a saturação de óleo residual (saturação na qual nenhum óleo pode mais ser

recuperado), V é o volume do reservatório,&amp;lt;|&gt; é a porosidade, e qwi é o volume de total de

água injetada no reservatório por unidade de tempo. O denominador nestas equações é o volume 

total de óleo possível de ser recuperado.

VOR = ( ' q 0d m V ( l - S wi-S or)
J O

(95)

(96)



V
O

R
Validação do Modelo Numérico 71

VPI

Fig. 22 - Escoamento tipo pistão - M = 10



Validação do Modelo Numérico 72

V P I

Fig. 23 - Escoamento tipo pistão - M = 50

Nas Figs. (22) e (23) observa-se uma diferença nas curvas de recuperação obtidas no 

presente trabalho e aquelas obtidas por Palagi (1992), principalmente para M=50. Pode-se 

verificar entretanto, que a máxima diferença para M^IO, quando compara-se a recuperação do 

poço paralelo (Palagi, 1992) com o poço diagonal (presente trabalho), ficou em torno de 4% e 

a diferença máxima para M=50, para o poço paralelo, não ultrapassou a 8%. Destaca-se que os 

pontos lidos da curva de Palagi (1992) para M=50 podem ser mais imprecisos devido ao tamanho 

reduzido da figura apresentada em seu trabalho quando comparada com os resultados para M=10



Validação do Modelo Numérico 73

e ao elevado número de curvas presentes na mesma.

Com relação aos resultados do escoamento tipo pistão, outro ponto deve ser enfocado. 

O mesmo refere-se ao fator de correção cilíndrica. Palagi (1992) analisou o efeito da correção 

cilíndrica para dois problemas monofásicos. O primeiro teste foi para um reservatório quadrado, 

com um poço no centro do reservatório, produzindo uma vazão constante, (Exemplo 6.6 do 

trabalho de Palagi (1992)). Neste caso, foram empregados três tipos de malhas: (1) malha 

cartesiana (9x9); (2) malha cartesiana (33x33) e (3) malha cartesiana (9x9) com dois módulos 

cilíndricos (4x8 e 2x8), sendo o primeiro número na direção radial e o segundo na direção axial 

(9). A Fig. 24 mostra o reservatório e a malha cartesiana-híbrida empregada no trabaho de Palagi 

(1992) para este caso. A malha híbrida foi simulada com e sem o fator de correção cilíndrica, ou 

seja, fc calculado via Eq. (27) e fc= l. Os resultados obtidos pelo mesmo, para a pressão do poço, 

foram comparados com a solução analítica. Os resultados concordaram razoavelmente bem com 

a solução analítica, sendo que a maior diferença ocorreu para a solução com malha cartesiana- 

híbrida sem fator de correção cilíndrica. Sobre estes resultados, Palagi (1992) comenta que não 

existe nenhuma razão para usar malhas com geometria complexa para este caso.



y-
di

re
ct

ío
n 

(1
00

0 
ft

)

Validação do Modelo Numérico

•v*
(xd=0.75,yd=0.75)

well (xd=0,yd=0)
•  *

(xd=0.25,yd=0)

x-direction (1000 f t )

(a) Qosed reservoir.

(b) 9x9 Cartesian grid plus 2 ’cylindrical’ (4x8 and 2x8).

Fig. 24 - Fig. 6.23 do trabalho de Palagi (1992)



Validação do Modelo Numérico 75

O segundo caso foi para um problema analisado anteriormente, por Pedrosa e Aziz 

(1986), (Exemplo 6.8 do trabalho de Palagi (1992)). O problema consiste de dois poços colocados 

na linha de centro de um reservatório retangular e dispostos eqüidistantes um do outro e das 

fronteiras, com um dos poços produzindo a vazão constante e o outro injetando a mesma vazão. 

Devido à simetria esta configuração é equivalente a um poço no centro de um reservatório 

quadrado com três fronteiras impermeáveis e outra a pressão constante. Neste caso, foi 

empregado aproximadamente as mesmas malhas utilizadas por Pedrosa e Aziz (1986), a saber: 

(1) malha cartesiana (6x3) com geometria cilíndrica (8x4) em volta de cada poço; (2) malha 

cartesiana (18x9) com geometria cilíndrica (8x12) em volta de cada poço. A Fig. 25 apresenta 

as duas malhas cartesiana-híbrida empregadas no trabalho de Palagi (1992).

(a) Coarse Cartesian grid (6x3) plus 2 hybrid (8x4).

x-direcüon (4000 f t )

(b) Fine Cartesian grid (18x9) plus 2 hybrid (8x12).

Fig. 25 - Fig. 6.29 do trabalho de Palagi (1992)



Validação do Modelo Numérico 76

A Fig. (6.30) do trabalho de Palagi (1992) apresenta a solução analítica, os resultados 

de Pedrosa e Aziz (1986) e os seus próprios resultados, para as malhas grosseiras e refinadas com 

e sem o uso do fator cilíndrico. As soluções de Palagi (1992), com o uso do fator cilíndrico, 

concordam razoavelmente bem com a solução analítica. Entretanto, os resultados com malha 

grosseira diferem daqueles obtidos por Pedrosa e Aziz (1986). Observe-se que a malha de Palagi

(1992), com o uso do fator cilíndrico é equivalente à malha empregada por Pedrosa e Aziz (1986) 

que é cilíndrica em volta do poço. Os resultados obtidos por Palagi (1992) sem o uso do fator 

de correção cilíndrica apresentam uma maior diferença em relação a solução analítica. Quando 

se compara os resultados obtidos por Palagi (1992) com e sem o uso do fator cilíndrico observa- 

se uma diferença aproximada de 8,5%, para os resultados com a malha grosseira e de 1,3%, para 

a malha refinada.

Inicialmente, no presente trabalho, todas as simulações foram realizadas empregando- 

se o fator cilíndrico fornecido pela Eq. (27). Entretanto, como foram observadas algumas 

diferenças nos resultados quando comparados como o trabalho de Palagi (1992), para o 

escoamento tipo-pistão, foram realizadas algumas simulações empregando-se fc = 1 na região 

cilíndrica. Os resultados destas simulações encontram-se nas Figs. (26) a (29). Nas curvas 

apresentadas "sem correção cilíndrica" significa que em volta dos poços (na região radial) f£ jj = 

1,0. Como as curvas apresentadas nas Figs. (26) a (29) são curvas integrais (Eq.(95)) plotou-se, 

também, as curvas de pressão nos poços para M  = 10 e M = 50. As Figs. (30) e (31) apresentam 

os resultados para os poços paralelo e diagonal. Observe-se que de acordo como foi apresentado 

nas Figs. (22) e (23), para as curvas de recuperação, as pressões em ambos os poços (diagonal 

e paralelo) são diferentes, com esta diferença aumentando com a razão de mobilidade (M). 

Novamente o efeito do fator cilíndrico praticamente não foi observado. Não existe a princípio 

nenhum argumento físico que justifique a influência de fc nas curvas de recuperação. O efeito de 

orientação de malha está relacionado a forma com que a malha é direcionada em relação ao 

escoamento e não se a malha é "radial ou quase-radial". E evidente que quanto menor for a 

conectividade de um determinado volume (por exemplo, um poço) menor será a possibilidade de 

alinhar a malha com a direção do escoamento, e é este ponto que deve ser enfatizado quando da 

utilização de malha híbridas em volta de poços verticais.



V
O

R

Validação do Modelo Numérico 77

VPI

Fig. 26 - Escoamento tipo pistão - poço paralelo - M=10

Fig. 27 - Escoamento tipo pistão - poço diagonal - M=10



Validação do Modelo Numérico 78

VPI

Fig. 28 - Escoamento pistão - poço paralelo - M=50

VPI

Fig. 29 - Escoamento tipo pistão - poço diagonal - M ^ O



Validação do Modelo Numérico 79

VPI

Fig. 30 - Efeito do fator de correção cilíndrica - escoamento tipo pistão - M=10

0-1Jli
oa.
•o
o

&lt;u
Cu

2,0e+3 —

-0,0e+0 —

-2,0e+3

-4,0e+3 -

-6,0e+3

-8,0e+3

Poço paralelo com corr. cilíndrica 

Poço diagonal com corr. cilíndrica 

Poço paralelo sem corr. cilíndrica 

Poço diagonal sem corr. cilíndrica

0,00 0,40 0,80 1,20 1,60 2,00
VPI

Fig. 31 - Efeito do fator de correção cilíndrica - escoamento tipo pistão - M=50



Validação do Modelo Numérico 80

Para finalizar as comparações com o trabalho de Palagi (1992) apresenta-se agora 

resultados para um caso onde as curvas de permeabilidade relativa são mais próxima das curvas 

tipicamente empregadas na recuperação de petróleo. As curvas de permeabilidades são dadas pela 

Eq. (97) e os demais dados são aqueles já  listados na Tab. 3.

Krw = Sw (97)
Kro = d  -  S wf

VPI

Fig. 32 - Escoamento típico de reservatório - M=10



Validação do Modelo Numérico 81

VPI

Fig. 33 - Escoamento típico de reservatório - M=50

As Figs. (32) e (33) apresentam os resultados para razões de viscosidade iguais a 10 

e 50, respectivamente. Pode-se observar que os resultados apresentam boa concordância com 

aqueles obtidos por Palagi (1992). Com relação aos resultados de Palagi (1992), mostrados na 

Figs. (32) e (33), não se especifica se os mesmos são para um poço paralelo ou diagonal, porque 

na Fig. 8.9 daquele trabalho se as curvas de recuperação para os dois poços coincidem. Também 

não foi especificado na Fig. 8.9 daquele trabalho, se as curvas de recuperação foram obtidas com 

ou sem fator de correção cilíndrica. Os resultados apresentados nas Figs. (32) e (33) foram 

obtidos sem o uso do fator cilíndrico. Apesar de não estar reportado, foram realizados testes para 

fc calculado pela Eq. (27) e os resultados foram idênticos à aqueles já  apresentados nas Figs. (32) 

e (33). Como não foi observado nenhuma diferença nos resultados anteriores quando da utilização 

da correção cilíndrica, no restante deste trabalho todas as simulações serão realizadas com fc= l.



Validação do Modelo Numérico 82

5.3 - Comparação com o SIRP - 3D

A primeira geometria testada foi uma configuração de cinco poços, na qual as linhas 

coordenadas da malha generalizada assemelham-se as linhas de fluxo do escoamento. A Fig. (34) 

mostra uma das malhas empregadas. O zoom na Fig. (34) é apenas ilustrativo e é utilizado 

somente para indicar a forma da malha nos poços. Observe que a massa produzida ou injetada 

é distribuída ao longo da região radial como condição de contorno de vazão prescrita. Para 

validação dos resultados foram empregados duas malhas: uma hexagonal com 410 volumes e uma 

hexagonal-híbrida com 445 volumes, similar àquela apresentada na Fig. (21). A Fig. (35) mostra 

a malha hexagonal. Os dados físicos e geométricos estão listados na Tab. 4. As curvas de 

permeabilidade relativa encontram-se na Tab. 5 e foram extraídas da Tab. 9.3 do trabalho de 

Palagi (1992). As viscosidades do óleo e da água são dados pela Eq. (98).

Fig. 34 - Malha generalizada com 756 volumes (21x36)



Validação do Modelo Numérico 83

P - Produtor
I - Injetor

Fig. 35 - Malha hexagonal com 410 volumes

Tab. 4 - Dados físicos e geométricos do reservatório - caso 2

Dados do reservatório Condição inicial Propriedades físicas

k = 3,0 x 10 13 m2 

h = 15 m

A = 2,14048 x 106 m2 

&lt;J&gt; = 0,30 

rw= 0,122 m

Swi = 0,22

Pi = 2,068427xl07 Pa 

Sor = 0,20

B0=BW= 1 a 2,068427xl07 Pa 

Pc = 0

c0 = cw= 7,25x10 9 P a 1 

llí/jll = l í w;l =2,76*/0"3H!3/‘S



Validação do Modelo Numérico 

Tab. 5 - Permeabilidades relativas

84

Sw K , Knv

0,22 1,0000 0,00

0,30 0,4000 0,07

0,40 0,1250 0,15

0,50 0,0649 0,24

0,60 0,0048 0,33

0,80 0,0000 0,65

0,90 0,0000 0,83

1,00 0,0000 1,00

[iw = 10 3(1 + 1,45x10 12(Po ~ 1,37x1o1)) [Pajs] (98)
[i0 = I,l63xl0~2(l + l,45x 10 12(P0 - 1,31x1o1)) [Pa-s]

A Fig. (36) apresenta a curva de recuperação de óleo e a Fig. (37) a curva de corte 

de água. O corte de água é definido como a razão do volume de água produzido e o volume total 

de líquido produzido (óleo + água). Observa-se uma boa concordância dos resultados para as três 

malhas empregadas. A Fig. (38) mostra a pressão no bloco produtor. Neste caso existiu uma 

diferença entre os resultados da malha generalizada e as malhas empregadas no presente trabalho. 

Apesar de não estar representado na Fig. (38) foram utilizados duas outras malhas hexagonais 

(uma com 559 e outra com 915 volumes) e a pressão do bloco obtida com estas malhas tendiam 

a pressão do bloco produtor com a malha hexagonal-híbrida, sendo o resultado com a malha 

hexagonal com 915 bastante próxima da malha hexagonal-híbrida. Aparentemente, a malha 

hexagonal produz resultados satisfatórios quando comparado com a malha generalizada, mesmo 

para este caso onde as linhas coordenadas da malha apresentam uma semelhança considerável 

com as linhas de fluxo do escoamento. É, portanto, mais um indicativo de que o aumento da



V
O

R

Validação do Modelo Numérico 

conectividade do volume de controle beneficia a qualidade da solução.

85

V PI

Fig. 36 - Recuperação - comparação com o SIRP-3D - caso 2



Co
rt

e 
de 

ág
ua

Validação do Modelo Numérico 8 6

1,00

0,80 —

0,60

0,40

0,20

0,00

Presente trabalho - m alh a h íb rid a (445) - poço paralelo 

P resente trabalho - m alh a hexagonal (410)

- A —  M alha generalizada (21x28)

M alha g eneralizada (21x36)

Fig. 37 - Corte de água - comparação com o SIRP-3D - caso 2



Validação do Modelo Numérico 87

O
"3
T3
O

OO
o

3
£

onC/5&lt;D
Ph

2,4e+4

2,0e+4

1,2e+4

8,0e+3

4,0e+3

0,0e+0

Presente trabalho - m alha h íbrida (445) - poço paralelo 

Presente trabalho - m alha hexagonal (410)

M alha generalizada (21x28)

M alha generalizada (21x36)

0,00 0,40 0,80 1,20 1,60 2,00
VPI

Fig. 38 - Pressão - comparação com o SIRP-3D - caso 2

O último teste utilizando-se o SIRP-3D como comparação, é para uma configuração 

mais próxima daquelas encontradas em recuperação de petróleo. A configuração é composta de

8 (oito) poços, sendo que 6 (seis) são poços produtores e 2 (dois) injetores. A Fig. (39) apresenta 

algumas das malhas utilizadas para os testes. A Tab. (6) apresenta os dados físicos e geométricos, 

a Eq. (99) contém os dados de permeabilidade relativa e as curvas de viscosidade empregadas 

foram aquelas da Eq. (98).



Validação do Modelo Numérico

Malha hexagonal (559) Malha hexagonal-híbrida(672)

Fig. 39 - Algumas das malhas utilizadas para a configuração de oito poços



Validação do Modelo Numérico 89

Tab. 6 - Dados físicos e geométricos do reservatório - caso 3

Dados do reservatório Condição inicial Propriedades físicas

k  = 3,0 x 10 13 m2 Swi = 0,20 B0=BW = 1 a 2,068427xl07 Pa
h = 15 m Ps = 2,068427x10’ Pa Pc = 0
A = 1,82 x 106 m2 Sor = 0,20 c„ = cw— 7,25x10 9 P a 1
4) = 0,30 qu =qB = -9,2x l0 '4m3/s
rw= 0,122 m ql2 =-1,1x10 3m3/s 

ql4 =-5,52x10-*m3ls 
ql5 =ql6 = -1,36x10* m 3Js 

qwl=2,94xl0~3m3/s 
qw2 = 2,024^7 0~3m 3/s

= (S„ - 0,2)(-250S* + 325S. - 55V27 (99)
= 1 -

Para a configuração de 8 poços utilizando malhas generalizadas (SIRP-3D) e 

hexagonais (presente trabalho) o poço produtor ou injetor foi localizado no volume mais próximo 

de sua posição correta. Ou seja, para cada posição de poço foi procurado o volume para o qual 

a distância do seu ponto gerador estava mais próximo da posição do poço, e neste volume foi 

localizado o poço. Observe que com o refinamento da malha ocorre também uma mudança de 

orientação da mesma e isto dificulta a convergência da localização dos poços quando malhas mais 

refinadas são empregadas. As Figs. (40) e (41) apresentam a variação da localização dos poços 

para a malha generalizada e hexagonal, respectivamente quando as mesmas são refinadas. Para 

melhor visualização as distâncias da posição correta estão ampliadas por um fator de 8. Estas 

duas figuras facilitarão o entendimento das curvas de recuperação, corte de água e pressão 

apresentadas nas Figs. (42) a (50) para três dos poços produtores. Com relação a localização dos 

poços para a malha hexagonal-híbrida, o bloco central de cada região cilíndrica foi localizado na



Validação do Modelo Numérico 

posição de cada poço, de forma que o ponto (nó) do volume e posição do poço coincidem.

Fig. 40 - Erro de localização dos poços para a malha generalizada

Fig. 41 - Erro de localização dos poços para a malha hexagonal



Validação do Modelo Numérico 91

Poço 1

- A —  P resen te trab alh o  - m a lh a  h exagonal (559)

P resen te trab alh o  - m alh a h ex .-h íb rid a gros. (672) 

P resen te trab alh o  - m alh a h ex .-h íb rid a fin a (1026) 

M alh a g en eralizad a gros. (560)

^  ?- - M alh a g en eralizad a fin a 1160)

Fig. 42 - Recuperação do poço 1 - comparação com o SIRP-3D - caso 3



C
or

te
 

de 
ág

ua

Validação do Modelo Numérico 92

1,00

0,80

0,60

0,40

0,20

0,00

0,00

Poço 1

Presente trabalho - m alha hexagonal (559) 

Presente trabalho - m alha hex.-híbrida gros. (672) 

Presente trabalho - m alha hex.-híbrida fina (1026) 

M alha generalizada gros. (560)

M alh a generalizada fina (1160)

0,40 0,80 1,20 
VPI

1,60 2,00

Fig. 43 - Corte de água do poço 1 - comparação com o SIRP-3D - caso 3



Pr
es

sã
o 

(k
Pa

)

Validação do Modelo Numérico 93

2,1e+4

2,0e+4

1,9e+4 —

1,8e+4

1,7e+4

Poço 1

Presente trabalho - malha hexag. (559)

Presente trabalho - malha hexag.-híbrida gros. (672) 

Presente trabalho - malha hexag.-híbrida fina (1026) 

Malha generalizada gros. (560)

Malha generalizada fina (1160)

0,00 0,40 0,80 1,20
VPI

1,60 2,00

Fig. 44 - Pressão do poço 1 - comparação com o SIRP-3D - caso 3



V
O

R

Validação do Modelo Numérico 94

0,10

0,08

0,06 —

0,04

0,02

0,00

0,00

Poço 4

Presente trabalho - malha hexag. (559)

Presente trabalho - malha hexag.-híbrida gros. (672) 

Presente trabalho - malha hexag.-híbrida fina (1026) 

Malha generalizada gros. (560)

Malha generalizada fina (1160)

0,40 0,80 1,20 
VPI

1,60 2,00

Fig. 45 - Recuperação do poço 4 - comparação com o SIRP-3D - caso 3



Co
rte

 
de 

ág
ua

Validação do Modelo Numérico 95

1,00

0,80

0,60

0,40

0,20

0,00 —íH— 

0,00 0,40

P o ço  4

Presente trabalho - malha hexag. (559)

Presente trabalho - malha hexag.-híbrida gros. (672) 

Presente trabalho - malha hexag.-híbrida fina (1026) 

Malha generalizada gros. (560)

Malha generalizada fina (1160)

0,80 1,20 
V P I

1,60 2,00

Fig. 46 - Corte de água do poço 4 - comparação com o SIRP-3D - caso 3



Pr
es

sã
o 

(k
P

a)

2,10e+4

2,05e+4

2,00e+4

1,95e+4

1,90e+4

1,85e+4

Validação do Modelo Numérico 96

Poço 4

Presente trabalho - malha hexag. (559)

Presente trabalho - malha hexag.-híbrida gros. (672) 

Presente trabalho - malha hexag.-híbrida fina (1026) 

Malha generalizada gros. (560)

Malha generalizada fina (1160)

0,00 0,40 0,80 1,20
V PI

1,60 2,00

Fig. 47 - Pressão do poço 4 - comparação com o SIRP-3D - caso 3



VO
R

Validação do Modelo Numérico 97

0,05

0,04

0,03

0,02

0,01

0,00 0,40

Poço 5

Presente trabalho - malha hexag. (559)

Presente trabalho - malha hexag.-híbrida gros. (672) 

Presente trabalho - malha hexag.-híbrida fina (1026) 

Malha generalizada gros. (560)

Malha generalizada fina (1160)

0,80 1,20 
VPI

1,60 2,00

Fig. 48 - Recuperação do poço 5 - comparação com o SIRP-3D - caso 3



C
or

te
 

de 
ág

ua

Validação do Modelo Numérico 98

1,00

0,80

0,60 —

0,40

0,20

0,00

0,00

Poço 5

P resente trabalho - m alha hexagonal (559) 

Presente trabalho - m alha hex.-híbrida gros. (672) 

Presente trabalho - m alha hex.-híbrida fin a (1026) 

M alha generalizada gros. (560)

M alha generalizada fina (1026)

0,40 0,80 1,20 
VPI

1,60 2,00

Fig. 49 - Corte de água do poço 5 - comparação com o SIRP-3D - caso 3



Validação do Modelo Numérico 99

ctí

O«}
C/í

2
(X

2,10e+4

2,05e+4

2,00e+4

1,95e+4 —

1,90e+4

1,85e+4

1,80e+4

Poço 5

- A —  Presente trabalho - m alha hexag. (559)

Presente trabalho - m alha hexag.-híbrida gros. (672) 

Presente trabalho - m alha hexag.-híbrida fina (1026) 

M alha generalizada gros. (560)

^ —  M alha generalizada fina (1160)

0,00 0,40 0,80 1,20 
VPI

1,60 2,00

Fig. 50 - Pressão do poço 5 - comparação com o SIRP-3D - caso 3

Nas Figs. (42) a (50) observa-se que a malha hexagonal-híbrida (672) forneceu 

resultados bastantes próximos a malha hexagonal-híbrida fina (1026), para as curvas de 

recuperação, corte de água e pressão de poço, indicando uma razoável independência da malha 

hexagonal híbrida. Com relação ao comportamento das malhas generalizada e hexagonal o que 

se pode afirmar é que da forma como foram localizados os poços e distribuídas as vazões, estar- 

se-á resolvendo problemas distintos e evidentemente não se pode esperar nenhuma concordância 

dos resultados. Com estes tipos de malhas o que parece mais correto é dividir a vazão de cada



Validação do Modelo Numérico 1 0 0

poço nos volumes que tiverem alguma face em comum. Nesse caso deveria-se esperar uma 

concordância dos resultados ou mesmo uma convergência dos mesmos quando da utilização de 

malhas mais refinadas.

5.4 - Análise de Caso

O objetivo desta seção é estudar o efeito da pressão capilar nas curvas de recuperação. 

Devido a pouca disponibilidade de resultados que verifiquem o seu efeito em escoamentos em 

reservatórios 2D, os resultados desta seção não são comparados com dados da literatura.

A principal característica matemática quando da inclusão da pressão capilar nas 

equações de conservação é tomar as equações hiperbólicas em equações parabólicas. As equações 

hiperbólicas, prevêem a formação de soluções descontínuas (choques), e conforme Dake (1978), 

é nas regiões de choque que o gradiente de pressão capilar é máximo. Fisicamente, a pressão 

capilar reduz ou atenua o choque. Antes de se analisar alguns dos resultados obtidos é instrutivo 

analisar a forma do fluxo fracionário da água. Conforme pode ser encontrado em Lake (1989), 

para um escoamento unidimensional e incompressível sem efeito da força gravitacional, o fluxo 

fracionário da água pode ser dado por,

K  + *

k x w(d p ja x ) 

o d  + V W
( 100)

onde Vt é a velocidade total das duas fases. O gradiente da pressão capilar na Eq. (100) pode ser 

escrito como,

(dPr)( dSj\ (dsw)C _ C| W
= K w

etc ,d S Wj I c k J
c

1 àx J
( 101)

O sinal do gradiente de pressão capilar é sempre positivo para o deslocamento do óleo 

pela água, independentemente da molhabilidade da rocha, porque a derivada da pressão capilar



Validação do Modelo Numérico 1 0 1

em relação à saturação é negativa e este também é o sinal do gradiente de saturação. Desta 

forma, a pressão capilar tende a aumentar o fluxo fracionário da água.

Reescrevendo a Eq. (15) para os componentes óleo (o) e água (w) e considerando o 

escoamento incompressível, B0 = Bw = 1, pode-se escrever a equação do componente água como,

onde,

Vt = V0 + Vw = constante (103)

/ ;  = -  (io4)
K  + K

Combinando-se as Eqs. (101) e (103) pode-se escrever a Eq. (102) como,

* 1 F  + o &amp;lt;105&gt;

O termo -  Xo f^P 'c &gt; 0 , pode ser interpretado como uma difusão. Desta forma, a

pressão capilar tom a as equações de conservação originalmente hiperbólicas em equações 

parabólicas.

Apresenta-se a seguir alguns resultados para dois casos analisados. No primeiro caso 

as densidades dos fluidos (óleo e água) são iguais. A malha empregada foi a malha hexagonal- 

híbrida similar à aquela apresentada na Fig. 21. Os dados físicos e geométricos e as curvas de 

permeabilidades relativas são aqueles já  listados na Tabs. 4 e 5, respectivamente. A única exceção 

são as vazões injetadas e produzidas. Para este caso a vazão injetada foi l,84 0 1 x l0 '3 m3/s e a 

vazão produzida (óleo + água) em cada poço foi igual a 9,2005x10'4 m3/s. Os dados de pressão



capilar foram extraídos da Tab. 9.3 do trabalho de Palagi (1992) e estão mostrados na Tab. 7.

Validação do Modelo Numérico 102

Tab. 7 - Pressão capilar

Saturação 0,22 0,30 0,40 0,50 0,60 0,80 0,90 1,00

Pc,base (kPa) 48,258 27,576 20,682 17,235 13,788 6,894 3,447 0,000

A Fig. (51) apresenta as curvas de recuperação e a Fig. (52) mostra o 

comportamento da pressão e saturação ao longo da linha injetor-produtor para três curvas de 

pressão capilar. Pode-se verificar nestas figuras que para valores baixos de pressão capilar não 

existe quase nenhuma influência da mesma no comportamento das curvas. Para valores maiores 

(50*Pc,base) ocorreu uma maior variação nas curvas de recuperação. Apesar de não reportado 

nas Figs. (51) e (52) foi simulado com os mesmos dados já  apresentados o caso para Pc igual a 

zero. Os resultados foram idênticos à aqueles para Pc=Pc,base.



V
O

R
Validação do Modelo Numérico 103

VPI

Fig. 51 - Recuperação com pressão capilar - caso 1



Validação do Modelo Numérico 104

£o»
tf

«3
PU

4 3C/5C/3O)WCL,

D istância do poço injetor ao poço produtor (m)

Fig. 52 - Saturação e pressão com pressão capilar - caso 1

O segundo teste realizado foi para o caso da densidade da água diferente da densidade 

do óleo. A Tab. 8 apresenta as compressibilidades e fatores de formação volumétricos. O restante 

dos dados foram iguais aos do caso anterior. As Figs. (53) e (54) apresentam as curvas de 

recuperação, saturação e pressão ao longo da linha injetor-produtor.



V
O

R
Validação do Modelo Numérico 

Tab. 8 - Fator de formação volumétrico e compressibilidade

105

Bw = 1,1018 a 20,682 kPa cw= 1,45054x1010 P a 1

B0 = 1,1018 a 20,682 kPa c„= 7,25269xl0 9 P a 1

VPI

Fig. 53 - Recuperação com pressão capilar - caso 2



Validação do Modelo Numérico 106

oicdo
cdu
3
cd

cd
Cu
&amp;amp;
O
?cdC/3C/3&lt;D

D istância do poço injetor ao poço produtor

Fig. 54 - Saturação e pressão com pressão capilar - caso 2

Das Figs. (53) e (54) observa-se que o comportamento das curvas de recuperação e 

pressão foram bastante similares as curvas já  apresentadas nas Figs. (51) e (52). Apesar do efeito 

da pressão capilar ter sido pequena, observa-se que em termos de recuperação o seu 

comportamento está de acordo com o esperado via Eq. (100), ou seja, a pressão capilar tende a 

aumentar a fluxo fracionário de água e conseqüentemente diminuir o volume de óleo recuperado.



RESULTADOS: COMPARAÇÃO ENTRE AS METODOLOGIAS TI, IMPES 
E AIM

107

6.1 - Introdução

O objetivo deste capítulo é comparar a eficiência de três metodologias de linearização 

das equações do modelo black-oil. TI, IMPES e AIM. As comparações foram realizadas em 

termos do tempo de CPU, número de iterações no tempo e número de iterações de Newton 

necessárias para a obtenção da convergência. No caso da metodologia AIM, atenção também é 

dada ao efeito dos diferentes critérios de troca de implicitude no seu desempenho.

Existem diversos trabalhos na literatura que empregam as metodologias deste capítulo. 

Entretanto, os critérios de parada das iterações newtonianas, em sua maioria, não são descritos, 

o que dificulta a comparação da eficiência das mesmas. Além do mais, este é provavelmente um 

dos poucos trabalhos empregando malhas com conectividade variada que utiliza as três 

metodologias. Buscou-se então analisar alguns dos parâmetros que influenciam na convergência 

destes métodos.

Antes de apresentar o desempenho das metodologias, investigou-se inicialmente o 

efeito do critério de convergência das iterações newtonianas no erro de balanço de volume dos 

componentes óleo e água, no número de iterações de Newton e no número de iterações no solver.

Outro ponto que deve ser enfatizado é que o sistema linearizado não é consistente, 

devido a diferença dos valores numéricos das grandezas que estão sendo calculadas (P„ e Sw). 

Devido a este fato, não se pode afirmar rigorosamente que normas de vetores, produtos escalares, 

etc. sejam bem definidos. A rigor o sistema deveria ser homogeneizado. Entretanto, no presente 

trabalho isto não foi realizado. Uma forma de homogeneização bastante empregado por 

pesquisadores de elementos finitos é: D j I/2 J D  j m z = D j V2 R.



Resultados: Comparação Entre as Metodologias TI, IMPES e AIM 108

6.2 - Efeito do Critério de Parada das Iterações Newtonianas

O primeiro caso analisado é para o escoamento cujas curvas de permeabilidade 

relativa são funções quadráticas da saturação. Este problema já  foi estudado no Cap. 5 do 

presente trabalho. Os dados físicos e geométricos encontram-se na Tab. 3 e as curvas de 

permeabilidade relativa e razão de viscosidade são fornecidas pela Eq. (94). O cálculo do erro 

de volume global de cada componente (EBCp) foi obtido via Eq. (106). O numerador da Eq. 

(106), a cada instante da simulação, representa o erro no volume da fase p medido desde o 

instante inicial da simulação e o denominador o volume de água injetada.

e b c p  - W ,  ? E í * A (  -  E  v * '  (106)

onde, V, é o volume inicial da fase p, Vf&gt;p o volume final da fase p avaliada em um determinado 

instante de tempo e qwi o volume total de água injetada em cada intervalo de tempo At e qpp a 

vazão total de água ou óleo produzida por unidade de tempo.

As Tabs. (9) e (10) mostram os resultados obtidos para as razões de viscosidade 

iguais a 10 e 50, respectivamente. Nas tabelas apresentadas NIN é o número total de iterações 

de Newton, NIS o número total de iterações no solver e NIT o número de intervalos de tempo. 

O solver empregado foi o GMRES precondicionado à direita com uma ILU (l). Nas tabelas |r|| 

é a norma do resíduo após um determinado número de iterações no solver e |r0 fl é a norma do 

resíduo inicial calculado com o vetor inicial x 0, Eq. (93). Nos testes realizados neste capítulo foi 

empregado o algoritmo de passo de tempo variável conforme descrito na seção 3.8 do presente 

trabalho. O valor máximo do passo de tempo empregado foi de 50 dias e foi utilizado os 

seguintes valores para os parâmetros de ajuste do passo de tempo: 0,05 para DSLIM e 689,5 kPa 

para DPLEM.



Resultados: Comparação Entre as Metodologias TI, IMPES e AIM 109

Tab. 9 - Caso típico de reservatório - M=10 - Malha hexagonal-híbrida com 445 volumes

VPI = 1,82 - ?  - |r |/|r o|&lt;10"2; O  - Ir||/|r0 fl&lt;10 3

Tolerância

NIN NIS NIT

EBCp (%)

A P ^ J k P a ) AS* w?maz óleo água

°0,6895 0,0001 848 12.024 358 l,1 3 x l0 '6 3,3 9x10"6

°6,895 0,0001 823 11.717 358 1,87x10 6 3,84xl0'6

°34,475 0,0001 820 11.710 358 l,8 8 x l0 '6 3,84xl0'6

D68,950 0,0001 819 11.709 358 1,88x10'6 3,84x10 6

d6,895 0,0005 795 11.260 358 6,46x10'6 7,49x10'6

d34,475 0,0005 790 ,11.243 358 6,47x10 6 7,49x10'6

d68,950 0,0005 789 !l 1.242 358 6,47x10'6 7,49x10'6

d34,475 0,0010 754 10.635 358 3,98xl0'5 5,30x10'5

d68,950 0,0010 752 10.629 358 3,99x10'5 5,3 0x10’5

d68,950 0,0050 504 6.006 358 7,89x10'4 1,88x10'3

°68,950 0,0010 752 14.713 358 2,62x10 6 1,76x10'5

°68,950 0,0050 504 9.843 358 2,92x10'4 2,15x10 4



Resultados: Comparação Entre as Metodologias TI, IMPES e AIM 110

Tab. 10 - Caso típico de reservatório - Malha hexagonal-híbrida com 445 volumes - M=50

VPI -  1,82 - ?  - 8r|/|ro|&lt;10-2;O -|r|/|rJ &amp;lt;1 0 -3

Tolerância

NIN NIS NIT

EBCp (%)

AP'o,mJkPa) AS*w,max óleo água

°0,6895 0,0001 804 11.571 343 1,09x10'6 7,83xl0"6

°6,895 0,0001 763 11.022 343 5,03x10 6 7,87x10'6

d34,475 0,0001 760 11.015 343 5,12xl0'6 7,87x10'6

d68,950 0,0001 759 11.014 343 5,1 lxlO ’6 7,87x10'6

d6,895 0,0005 700 9.916 343 8,06x10'6 1,3 5x10‘4

d34,475 0,0005 696 9.905 343 8,06x10'6 1,3 5x10'4

D68,950 0,0005 695 9.904 343 8,06x10'6 1,3 5x10'6

d34,475 0,0010 567 7.315 343 1,46x10'4 1,07x10'3

d68,950 0,0010 565 7.310 343 1,46x10'4 1,07x10 3

d68,950 0,0050 436 4.903 343 1,3 9x10'3 4,1 lxlO '3

°68,950 0,0010 565 11.810 343 5,14xl0'5 5,10xl0'5

°68,950 0,0050 436 8.500 343 5,25xl0'4 2,2 l x l  O'4

Das Tabs. (9) e (10), observa-se que AP*0)mai tem pouca influência no número de 

iterações de Newton e no erro de balanço de componentes, para valores de ÁP’o mai maiores ou 

iguais a 6,895 kPa. Este fato pode ser explicado considerando a natureza quase linear de Bp e fip 

com a pressão para os fluidos estudados. A convergência do ciclo iterativo é, portanto, dominada 

pela variação na saturação (AS*wmM). Observe-se que ocorre um decréscimo no número de 

iterações de Newton para M=50 quando comparado com M=10. Fisicamente o escoamento para 

M=50 é mais instável e propicia a formação de "dedos" ou "chifes", sendo portanto mais



Resultados: Comparação Entre as Metodologias TI, IMPES e AIM 111

dependente da orientação da malha empregada. Entretanto, isto não garante que sua a solução seja 

mais difícil de ser obtida quando comparado com aquela de M=10. Apesar dos dados de 

recuperação não estarem presentes nas tabelas, não existiu nenhuma variação nas curvas de 

volume de óleo recuperado (VOR). Note-se, também, que restringindo-se o critério de 

convergência no solver consegue-se uma redução nos erros de balanço para um mesmo conjunto 

de parâmetros de convergência de Newton. Um dos motivos para ocorrência deste fato é que as 

variações podem ser pequenas mas o valor do resíduo ainda pode ser grande.

Tab. 11 - Configuração de oito poços - Malha hexagonal com 672 volumes - VPI = 1,82

? - ||r||/ ||r0 J&lt;10'2; O- |r|/ Jr01&lt;10'3

Tolerância

NIN NIS NIT

EBCp (%)

AP*0&gt;max(kPa) AS*w&gt;mai óleo água

d0,6895 0,0001 986 9.418 454 5,64x10'7 1,59x10'6

d6,895 0,0001 982 9.414 454 5,64x10'7 l,5 9 x l0 '6

d34,475 0,0001 981 9.413 454 5,64x10’7 l,59xl0"6

°6,8950 0,0005 835 7.656 454 1,08x10 5 1,3 l x l  O’4

n34,475 0,0005 831 7.651 454 1,09x10'5 1,3 lx l O'4

d68,950 0,0005 830 7.651 454 1,09x10'5 1,3 lx l O 4

°34,475 0,0010 648 5.534 454 1,70x10'4 9,41x1o4

n68,950 0,0010 647 5.553 454 1,70x10 4 9,41xl0-4

d68,950 0,0050 523 4.301 454 3,84xl0‘4 9,9 l x l  0‘4

°68,950 0,0010 647 8.538 454 7,62x10'5 3,45x10'5

°68,950 0,0050 523 6.981 454 2,90x10'4 2,29x10'4



Resultados: Comparação Entre as Metodologias TI, IMPES e AIM 112

A Tab. 11 apresenta os resultados para a configuração de oito poços com uma malha 

hexagonal-híbrida de 672 volumes (Fig. 39-d). Os dados físicos e geométricos estão listados na 

Tab. 6, as curvas de permeabilidade relativa são dadas pela Eq. (98) e as de viscosidade pela Eq. 

(99). Novamente, pode-se observar que a convergência das iterações de Newton e o erro de 

balanço são dominados basicamente pela saturação. De novo, reduzindo-se o critério de 

convergência no solver foram obtidas soluções com pequenos erros de balanço para grandes 

variações nas saturações (0,001 e 0,005). Sugerindo que, para problemas bifásicos (óleo-água) 

não é necessário verificar as variações na pressão. Isto por sua vez, toma o código computacional 

mais versátil uma vez que o número de testes por iteração newtoniana diminui.

6.3 - Análise das Metodologias IMPES, AIM e TT

Todos os casos analisados nesta seção foram obtidos com os seguintes critérios: 

ÀP*o,max igual a 68,95 kPa e AS*w&gt;max igual a 5x10'3. O critério de parada no solver foi 

||r |/|r o|l&lt;10'3. Foram realizados alguns testes com AS‘w&gt;mai igual a 10'3 e o mesmo A P*,,^ e as 

razões de tempo do AIM em relação a metodologia TT foram semelhantes. Para as metodologias 

AIM e TI, uma nova iteração newtoniana foi requerida quando em algum volume as variações 

na saturação e pressão ultrapassaram valores predeterminados, independentemente da saturação 

ser explícita ou implícita. Para o IMPES isto aumentou consideravelmente o número de iterações 

de Newton por intervalo de tempo. Desta forma, optou-se por realizar apenas uma iteração de 

Newton por passo de tempo, isto é, somente uma iteração do ciclo apresentado na seção 3.4.1 

foi realizada.

Para a metodologia AIM, se for utilizado valores apertados de AP*0(inai e AS‘Wimai para 

a convergência do ciclo de Newton (por exemplo, 0,685 kPa para a pressão e 10'4 para a 

saturação), a convergência do método adaptativo ficará sensivelmente prejudicada quando 

comparada com a metodologia TI, devido ao número excessivo de iterações newtonianas do AIM. 

Conforme Coutinho (1995) o método adaptativo pode ser considerado como um método de 

Newton Inexato, onde uma parcela do Jacobiano foi desprezada e desta forma, o número de 

iterações das metodologias AIM e TI não necessariamente coincidem.



Antes de apresentar as comparações das metodologias, explicar-se-á como foi aplicado 

o critério de estabilidade proposto por Fung et al. (1989). No trabalho destes autores foi aplicado 

a metodologia AIM para problemas trifásicos (óleo, gás e água). Desta forma, o critério de 

estabilidade requer o cálculo de três autovalores em cada volume, afim de decidir se as saturações 

devem ser calculadas explicitamente ou implicitamente. Para evitar o cálculo dos autovalores em 

todos os volumes, Fung et al. (1989) propuseram que só fossem calculados os autovalores na 

fronteira entre regiões implícitas e explícitas, a qual denominaram de frente implícita. Onde 

existisse uma troca nas células testadas nesta região, todos os vizinhos explícitos deveriam ser 

testados se a troca é de explicito para implícito (forward switch - troca à frente) ou nos vizinhos 

implícitos se a troca é de implícito para explícito (backward switch - troca para trás), repetindo-se 

este procedimento até que nenhum volume devesse ser trocado. Este foi o primeiro procedimento 

implementado neste trabalho. Entretanto, não se conseguiu captar a frente de implicitude 

conforme comentado por Fung et al. (1989) e representado para um problema 2D analisado por 

estes autores. Resolveu-se então calcular os autovalores para todos os volumes. Observe-se que 

com a hipótese de incompressibilidade dos fluidos é necessário calcular somente um autovalor 

por volume. Note-se que esta hipótese é plenamente aceitável, considerando os fluidos estudados 

no presente trabalho. Mesmo calculando-se os autovalores para todas as células observou-se 

somente uma pequena parcela de célula implícitas. Desprezando-se a hipótese de 

incompressibilidade os resultados foram idênticos. Para os resultados que serão expostos no 

restante desta seção foram testados o critério de estabilidade juntamente com critério de mudança 

na saturação.

Outro ponto que deve ser enfocado nos resultados apresentados a seguir é que foram 

construídos programas distintos para as metodologias AIM, IMPES e TI. Desta forma o (overhead 

- cálculo adicional) associado à montagem do Jacobiano e do solver para as metodologias IMPES 

e TI foi evitado.

Nas tabelas que serão apresentadas ^ é o  limite para troca à frente, o limite para 

troca para trás e ASW é a variação na saturação da água empregada para troca de implicitude. 

Utilizando o critério na saturação, sempre que uma célula foi trocada todos os seu vizinhos foram 

checados. Para troca para trás foram realizados alguns testes para descobrir a freqüência com que

Resultados: Comparação Entre as Metodologias TI, IMPES e AIM 113



Resultados: Comparação Entre as Metodologias TI, IMPES e AIM 114

a mesma deveria ser realizada. A troca a cada 20 iterações no tempo forneceu bons resultados. 

Foram testados as seguintes freqüências: 10, 20, 30 e 50. Todos os testes foram realizados numa 

estação de trabalho SUN SPARC Station 10 com 2 CPU's P61 com 128 Mbytes de RAM. Os 

tempos de CPU apresentados foram normalizados dividindo-se o tempo de computação pelo 

tempo de computação mínimo entre os métodos. Os mesmos referem-se a montagem do 

Jacobiano, lado direito (função resíduo) e tempo no solver.

O primeiro caso analisado foi para a configuração de cinco poços. As curvas de 

permeabilidade relativa são dadas pela Eq. (94). Os dados físicos e geométricos estão listados na 

Tab. 3. As Tabs. 12 e 13 mostram os resultados para duas razões de viscosidades, 10 e 50, 

respectivamente.

Da Tab. 12 observa-se que o critério baseado na análise de estabilidade requereu 

somente uma pequena parcela dos volumes a serem implícitos. Praticamente não existiu muito 

efeito nos limites dos autovalores testados para as trocas à frente e para trás. Para este caso um 

valor de ASW=0,01 aliado ao critério de estabilidade forneceu o melhor resultado. Observa-se que, 

utilizando somente o critério de troca baseado na variação da saturação, uma grande parcela dos 

volumes é implícita no final da simulação, principalmente para pequenos valores de ASW. Nota-se 

também que existiu um caso onde o AIM requereu mais tempo de CPU que a metodologia TI. 

Observe-se que neste caso existiu uma diferença acentuada no número de iterações de Newton, 

significando então, que o critério utilizado para chaveamento da metodologia AIM não detectou 

adequadamente as regiões de surgimento de instabilidades. Pode-se observar também que os erros 

de balanço do IMPES são superiores aos do AIM e TI. Este fato pode ser explicado considerando 

que apenas uma iteração do ciclo apresentado na seção 3.6.1 foi realizado e de se ter empregado 

o mesmo critério de convergência no solver para as três metodologias. Por exemplo, se em algum 

instante da simulação o sistema linear da pressão não foi adequadamente solucionado os erros 

de balanço deverão ser grandes e como o ciclo não é repetido, os erros não podem ser reduzidos. 

A tendência é que estes erros se propaguem durante o restante da simulação.

A Fig. 55 apresenta as frentes de implicitude para quatro valores de VPI. Esta figura 

foi obtida para ^= 1 ,0 , ^ = 0 ,8  e ASW= 0,01. Verifica-se que para valores elevados de VPI



Resultados: Comparação Entre as Metodologias TI, IMPES e AIM 115

somente um pequeno número de volumes foram mantidos implícitos. Observe que ocorreu uma 

queda substancial no número de células implícitas de 0,2 para 0,6 VPI. Este fato ocorre devido 

a 0,6 VPI a frente de água já  ter atingido os poços produtores. Após a chegada da frente no poço 

produtor o número de células implícitas vai diminuindo proporcionalmente à queda da saturação 

no poço. Para este caso a chegada da frente ocorre aproximadamente a 0,3 VPI, ver Fig. 57. A 

Fig. 56 mostra as curvas de VOR e a Fig. 57 o corte de água para as metodologias AIM, TI e 

IMPES para o poço paralelo. O corte de água é definido como a razão do volume de água 

produzido e o volume total de líquido produzido (óleo + água). Observa-se uma boa concordância 

dos resultados. A Fig. 58 apresenta o corte de água para a metodologia IMPES obtida com um 

Mo« de 50 dias. Observa-se acentuadas oscilações no corte de água. Um fato que deve ser 

frisado é que não foram observados oscilações nas curvas de VOR para o IMPES para valores 

de A t ^  maiores que 2 (dois) dias. As curvas de VOR estavam de acordo com aquelas obtidas 

com o métodos AIM e TI. Entretanto, foram observados oscilações nas curvas de corte de água. 

Deve ser enfatizado que a curva de VOR não deve ser o único parâmetro de verificação uma vez 

que a mesma é uma curva integral, Eq. (95), e desta forma, as oscilações são suavizadas, 

mascarando as oscilações nas saturações.



Resultados: Comparação Entre as Metodologias TI, IMPES e AIM 116

Tab. 12 - Comparação de metodologias - malha hexagonal-híbrida com 445 volumes - M=10

VPI=:1,82 - menor tempo de CPU = 236,6 seg.

Método Critério TCPU NIT NIN PI (%)

EBCp (%)

óleo água

AIM autovalor ( ^ = 1 ,0,7^=0,8) 1,04 381 541 4,93 3,81xl0'4 l,9 1 x l0 '4

AIM autovalor (X,=l,0 ^ = 0 ,9 ) 1,04 381 541 4,60 3,86xl0‘4 2,10x10 4

AIM autovalor (A1=0,8;A^=0,6) 1,04 380 529 6,79 3,46x10'4 1,3 9x10 4

AIM

autovalor + variação 

(^ 1==1 &gt;0;à2=0,8; ASW=0,01) 1,00 359 509 12,96 3,12xl0'4 1,37x10'4

AIM

autovalor + variação 

(V = l,0 ;^ = 0 ,8 ; ASW =0,02) 1,01 360 515 10,22 4,10x10'4 2,30x10'4

AIM autovalor + variação 

(^ = 1 ,0 ^ = 0 ,8 ; ASW =0,05) 1,06 372 550 6,35 3,76x10'4 2,34x10'4

AIM variação (ASW=0,01) 1,20 359 514 64,45 3,1 lxlO '4 l,1 8 x l0 '4

AIM variação (ASW =0,02) 1,18 359 517 56,59 4,2 lx l O4 1,98x10'4

AIM variação (ASW=0,05) 1,35 374 630 31,08 4,17x10'3 1,78x10'3

TI - 1,26 358 504 100 2,62x10'6 1,76x10'5

IMPES A&lt;maI= 2 dias 11,00 7564 7564 0 1,22x10'2 1,23x10'2



Resultados: Comparação Entre as Metodologias TI, IMPES e AIM 117

(b) - 0,4 VPI _ o 6 y p j

Fig. 55 - Campos de implicitude para quatro valores de VPI - ^  = 1,0, \  = 0,8 e ASW = 0,01



Resultados. Comparação Entre as Metodologias TI, IMPES e AIM 118

VPI

Fig. 56 - Comparação de metodologias - VOR

Fig. 57 - Comparação de metodologias - corte de água



Resultados: Comparação Entre as Metodologias TI, IMPES e AIM 119

VPI

Fig. 58 - Corte de água - IMPES - Atmax = 50 dias

Da Tab. 13 observa-se que o critério de estabilidade não conseguiu captar 

adequadamente o surgimento de instabilidades, tomando os resultados do AIM inferiores aos da 

metodologia TI. Nota-se que este escoamento é mais instável que aquele analisado na Tab. 12, 

devido a maior razão de viscosidade. Observe-se que as percentagens de implicitude foram 

superiores à aquelas da Tab. 12 e, mesmo assim, não foram obtidos bons resultados somente com 

o critério de instabilidade. Verifica-se que o critério não foi capaz de detectar adequadamente o 

surgimento das instabilidades a fim de assegurar robustez na solução de Newton e desta forma, 

um número excessivo de iterações de Newton foram realizadas. Observe-se também, que mesmo 

trabalhando-se com os critérios de instabilidade e variação na saturação, não foi detectado o 

surgimento de instabilidades para ASW = 0,02 durante algum período da simulação, o que resultou 

num número excessivo de iterações de Newton quando comparado com o mesmo caso com 

ASW = 0,01.



Resultados: Comparação Entre as Metodologias TI, IMPES e AIM 120

Tab. 13 - Comparação de metodologias - Malha hexagonal-híbrida com 445 volumes - M=50

VPI =1,82 - menor tempo de CPU = 234,04 seg.

Método Critério TCPU NIT NIN PI (%)

EBCp (%)

óleo água

AIM autovalor (ÀI=1,0;A7=0,8) 1,30 362 592 7,74 6,75x10'4 2,09x10'3

AIM autovalor (À -^ O ^ ^ O .ó ) 1,40 361 617 11,21 6,96xl0'4

Ò"P00

AIM

autovalor + variação 

(^i= l,0;^=0,8;À Sw=0,01) 1,00 346 442 13,64 7,2 lx l O'4 l,8 1 x l0 ‘3

AIM

autovalor + variação 

(X1=1,0;à2=0,8;ASw=0,02) 1,24 348 563 13,40 7,65x10'4 1,74x10‘3

AIM

autovalor + variação 

( ^ S ^ O ^ A S ^ O l ) 1,00 346 441 15,58 6,96x10'4 l,8 1 x l0 '3

AIM variação (ASW=0,01) 1,18 344 445 67,06 7,64x10'4 1,93x10 3

AIM variação (ÁSW=0,02) 1,64 347 639 59,92 7,5 lx l O'4 l,9 8 x l0 ‘3

TI - 1,28 343 436 100 5,25xl0'4 2,21xl0'4

IMPES Atmax = 1 dia 26,5 15088 15088 0 6,19x10'3 6,22x10'3

A Tab. 14 apresenta os resultados obtidos para uma malha hexagonal com 410 

volumes. Os dados estão listados nas Tabs. 4 e 5. As curvas de viscosidade são dadas pela Eq. 

(98) e a malha empregada é a mesma já  apresentada na Fig. 35. Para este caso nota-se que foi 

requerida uma pequena quantidade de implicitude, mesmos para os casos onde somente o critério 

de variação na saturação foi utilizado. Com exceção do método IMPES, o número de intervalos 

de tempo para todas as simulações coincidiram. Neste caso, o método que forneceu melhores 

resultados em termos de tempo de CPU foi o AIM com o critério de troca baseado na variação 

de saturação (ASW=0,02).



Resultados: Comparação Entre as Metodologias TI, IMPES e AIM 121

Tab. 14 - Comparação de metologias - malha hexagonal com 410 volumes - VPI=1,82

menor tempo de CPU = 171,29 seg.

Método Critério TCPU NIT N1N PI (%)

EBCp (%)

óleo água

AIM autovalor ( ^ = 1 ,0 ^ = 0 ,8 ) 1,05 882 953 1,26 3,45x10"4 6,8 l x l  O'4

AIM autovalor ( ^ = 0 ,8 ^ = 0 ,6 ) 1,06 882 957 1,87 3,22x10'4 6,48x10’4

AIM

autovalor + variação 

(XI=1,0;A2=0,8;ASW=0,01) 1,03 882 936 1,46 3,24x10'4 6,50x10 4

AIM autovalor + variação 

(À1=1,0;X2=0,8;ASW=0,02) 1,05 882 953 1,26 3,45xl0'4 6,81xl0'4

AIM

autovalor + variação 

(À1=0,8;A^=0,6;ASW=0,01) 1,04 882 940 2,06 3,01x10'4 6,18x10 4

AIM variação (ASW=0,01) 1,14 882 941 13,23 4,02x10'4 5,27x10’4

AIM variação (ASW=0,02) 1,00 882 949 3,26 3,67x10’4 5,41xl0‘4

TI - 1,38 882 9,34 100 3,60x10'4 2,55xl0'4

IMPES Atmax ^  4 dias 7,25 10.676 10.676 0 8,63x10 3 8,61xl0'3

A Tab. 15 apresenta os resultados para a configuração de oito poços com uma malha 

hexagonal-híbrida (Fig. 39-d). Os dados físicos e geométricos estão enumerados na Tab. 6. As 

curvas de viscosidade são dadas pela Eq. (99) e as de permeabilidade relativa pela Eq. (98). Da 

Tab. 15 pode-se observar que diminuindo os valores de À, e ^  conseguiu-se captar 

razoavelmente a região onde era necessário tratamento implícito. Novamente, o critério de 

estabilidade aliado ao critério de variação na saturação (ASW=0,01) forneceu bons resultados. Para 

todos os testes realizados com uma pequena margem de implicitude, conseguiu-se bons resultados 

com a metodologia AIM. A questão principal é o critério de chaveamento das implicitudes.



Resultados: Comparação Entre as Metodologias TI, IMPES e AIM 1 2 2

Tab. 15 - Comparação de metodologias - configuração de oito poços - malha hexagonal-híbrida 

com 672 volumes - menor tempo de CPU = 255,03 seg.

Método Critério TCPU NIT NIN PI(%)

EBC (%)

óleo água

AIM autovalor (^ ,= 1 ,0 ^ = 0 ,8 ) 1,09 456 556 3,75 4,57x10 4 3,78x10'4

AIM autovalor (A ^O ^X ^O .ó) 1,01 454 536 5,22 2,13x10'4 1,34x10 4

AIM

autovalor + variação 

(^'1= l,0;Ao=0,8;ASw=0,01) 1,01 454 521 6,40 3,75xl0"4 2,76x10'4

AIM

autovalor + variação

(^ 1= 1,0;X2=0,8;Aw=0j02) 1,03 454 537 5,99 2,61xl0'4 l,8 1 x l0 '4

AIM

autovalor + variação 

( ^ O j S ^ O ^ À S ^ O . O l ) 1,00 454 521 7,49 2,45x10'4 1,40x10'4

AIM variação (ASW=0,01) 1,13 454 533 35,05 2,56x10'4 1,66x10'4

AIM variação (ASW=0,02) 1,16 454 571 26,00 2,61xl0'4 2,29x10'4

TI - 1,33 454 523 100 2,90x10 4 2,29x10'4

IMPES Atmax=4 dias 5,85 5232 5232 0 1,75x10 2 1,75x10'2

Nos testes realizados, conseguiu-se uma razoável redução de tempo de execução 

aliando-se ao critério de estabilidade o critério de variação na saturação. No trabalho de Fung et 

al. (1989) não foi necessário a utilização do critério estabilidade juntamente com o critério de 

variação na saturação. O critério de estabilidade mostrou-se robusto para detectar as regiões onde 

a maior implicitude era necessária. Uma possível causa para a não ocorrência deste fato no 

presente trabalho, foi ter-se trabalhado apenas com escoamento bifásico (óleo-água), no qual as 

instabilidades físicas são bem menores.



RESULTADOS: COMPARAÇÃO ENTRE MÉTODOS DE SOLUÇÃO DE 
SISTEMAS LINEARES

123

7.1 - Introdução

No presente capítulo apresenta-se uma comparação entre três métodos empregados 

para solução de sistemas lineares não-simétricos: ORTHOMIN, GMRES e Bi-CGSTAB. As 

comparações foram realizadas em termos de tempo de CPU e número de iterações no solver. Nas 

comparações verifica-se também o efeito das ordenações geométricas e nível da fatoração ILU 

empregada. Todos os métodos foram precondicionados à direita conforme descrito no Cap. 4.

Antes de se mostrar a análise dos métodos de resolução, é analisado o efeito da 

ordenação MDF no método GMRES. Na aplicação da ordenação MDF foram utilizados dois 

problemas testes: O problema bifásico (óleo-água) e um problema de condução anisotrópica.

7.2 Efeito da Ordenação MDF

Para todos os resultados que serão mostrados neste Capítulo o critério de parada no 

solver foi a razão lrkI/|rol&amp;lt;10'3, e como critério de parada de uma iteração newtoniana, o valor 

de 6,893x102 Pa para AP*omáx e 10'4 para AS*wmáx. Foram utilizados os seguintes valores para 

ajuste do passo de tempo: 0,02 para DSLIM e 13,79 kPa para DPUM . O menor intervalo de 

tempo empregado foi 10'5 dias e o máximo 10 dias. Estes critérios garantiram simulações com 

aproximadamente os mesmos intervalos de tempo.

Um dos problemas analisados no trabalho de D’Azevedo et cã. (1992a) foi o problema 

de condução anisotrópica, governado por

definido na região x s [0,1] e y s [0,2]. No trabalho de D'Azevedo et cã. (1992a) foi empregado



Resultados: Comparação Entre os Métodos de Solução de Sistemas Lineares 124

para resolver este problema diferenças finitas com volume centrado. A condição de contorno foi 

de fluxo nulo nas fronteiras com uma malha cartesiana uniforme, com espaçamento d=l/30 (30 

volumes em x e 60 em y). O termo fonte q foi dado por

- l / h 2 em [ x, y )  =  { d/ 2,  d/ 2)  
q { x , y )  =  i / h 2 em { x, y )  = (1 - d / 2 , 2 - d / 2 )  

0 no r e s t a n t e  do dom ínio
(108)

No trabalho de D'Azevedo et al. (1992a) a denominação STR O N G Y corresponde a 

1, Ky = 1000 e STR O N G X  a Kj= 1000, Ky= 1. Em todas as tabelas apresentadas, TS 

corresponde ao tempo no solver, NIS o número de iterações no solver e EL o número de 

elementos na matriz triangular inferior. A ordenação MDF é recomendada para problemas 

transientes, uma vez que o custo da ordenação pode ser amortecido pela redução no custo da 

obtenção de cada sistema linear. Desta forma, nos tempos das Tabs. 16 e 17, não está embutido 

o tempo de ordenação. Nas demais tabelas o custo da ordenação está incluído no valor de TS. 

Todos os tempos apresentados foram normalizados dividindo-se o menor tempo da tabela pelo 

seu respectivo valor.

A Tab. 16 apresenta os resultados obtidos para o problema STRO N G Y. Observa-se 

que a ordenação original tem efeito significativo no MDF, que apresenta uma melhora somente 

no caso da ordenação vertical. O melhor caso ocorreu com ordenação horizontal e a aplicação 

do MDF a esta ordenação não apresentou efeito positivo. Por outro lado, na Tab. 17 acontece 

uma acentuada melhoria no desempenho do GMRES com MDF em ambas as ordenações, com 

mais efeito na horizontal. Conforme comentado em Behie e Forsyth (1984), se »  Ky, um 

método baseado em ILU (para qualquer nível &gt; 0) converge mais rápido se uma ordenação 

vertical for utilizada. Note-se que isto ocorre na Tab. 16, para a ordenação horizontal e Tab. 17 

para a ordenação vertical. D'Azevedo etal. (1992a) apresentaram resultados para estes dois casos, 

utilizando o gradiente conjugado (GC) somente com ordenação vertical, o que não permite avaliar 

adequadamente as observações feitas. Apesar de não reportado no presente trabalho, utilizando

o GC foram obtidos os mesmos resultados obtidos por D'Azevedo et al. (1992a). A diferença é



que o GMRES é mais sensível a ordenação porque o custo computacional do mesmo aumenta 

com o número de iterações. Observe-se que o enchimento da matriz para IL U (l) nas Tabs. 16 

e 17 é muito maior para o MDF. Com o aumento do nível da ILU estas diferenças são 

sensivelmente reduzidas, como pode ser verificado nestas tabelas para os níveis de ILU 2 e 3.

Resultados: Comparação Entre os Métodos de Solução de Sistemas Lineares 125

Tab. 16 - Resultados para o problema STRO N G Y utilizando GMRES

Ordenação

ILU

0 1 2 3

EL TS NIS EL TS NIS EL TS NIS EL TS NIS

Vertical 3510 14,55 59 5221 2,51 19 6903 2,68 19 10238 1,34 10

MDF-verti cal 3510 14,53 59 6859 1,80 14 7021 1,62 13 10024 1,16 9

Horizontal 3510 5,21 32 5221 1,47 13 6873 1,60 13 10118 1,01 8

MDF-Horizontal 3510 5,25 32 6856 1,43 12 7126 1,31 11 10131 1,00 8

Tab. 17 - Resultados para o problema STRO N G X utilizando GMRES

Ordenação

ILU

0 1 2 3

EL TS NIS EL TS NIS EL TS NIS EL TS NIS

Vertical 3510 4,46 32 5221 4,68 32 6903 4,67 31 10238 4,81 30

MDF-vertical 3510 4,46 32 6851 1,26 12 7015 1,13 11 10120 1,00 9

Horizontal 3510 12,36 59 5221 12,06 57 6873 11,62 55 10118 11,62 53

MDF-Horizontal 3510 12,48 59 6845 1,53 14 7122 1,55 14 10050 1,00 9

Os casos analisados a seguir referem-se ao escoamento bifásico água-óleo em meios 

porosos. A primeira geometria testada é um quarto da configuração de cinco poços. Os dados



físicos e geométricos deste caso estão listados na Tab. 3 e a malha utilizada é apresentada na Fig.

21. As curvas de permeabilidades relativa e razão de viscosidades são dadas pela Eq. (94). Os 

resultados correspondentes a este caso estão listados na Tab. 18 para M=10. O tamanho máximo 

da base foi 10. Nas tabelas a serem expostas no restante deste capítulo NIN é o número de 

iterações de Newton.

Resultados: Comparação Entre os Métodos de Solução de Sistemas Lineares 126

Tab. 18 - Resultados para a conf. de cinco poços - 1,0 VPI - M = 10

Ordenação

ILU

0 1 2

EL TS NIN NIS EL TS NIN NIS EL TS NIN NIS

Natural 1074 2,77 1989 135.223 1572 1,12 1989 40.581 2258 1,30 1989 36.050

Vertical 1074 2,67 1989 131.445 1499 1,63 1989 67.275 2099 1,19 1989 34.625

Horizontal 1074 2,95 1989 132.695 1522 1,91 1989 69.221 2123 1,17 1989 34.671

MDF-Natural 1074 2,75 1989 119.681 1895 1,08 1989 34.940 2414 1,05 1989 24.014

MDF-Vertical 1074 2,52 1989 120.770 1931 1,17 1989 37.649 2413 1,02 1989 23.271

MDF-Horizontal 1074 2,41 1989 119.482 1901 1,21 1989 40.392 2420 1,00 1989 22.570

Na Tab. 18 observa-se que o MDF apresentou sensibilidade a todas as ordenações 

utilizadas, sendo o MDF-Horizontal com ILU(2) a ordenação mais robusta. Observe-se que para 

IL U (l) a ordenação natural foi a ordenação mais eficiente. Para os diversos níveis de ILU e 

ordenações empregadas, a aplicação da ordenação MDF sempre resultou num menor número de 

iterações no solver. Entretanto, isto não garante sempre menor tempo de CPU uma vez que o 

MDF, da forma como proposto inicialmente por D'Azevedo et al. (1992a), não verifica a 

importância dos elementos criados na fatoração incompleta.

A Fig. 59 apresenta a malha hexagonal-híbrida com 1026 volumes empregada para 

a configuração de 8 (oito) poços. Os dados físicos e geométricos estão listados na Tab. 6, as 

curvas de permeabilidade relativa são dadas pela Eq. (99) e as viscosidades são dadas na Eq. 

(98), todas no SI. Neste caso, não foi obtida convergência do GMRES, com base 10, mesmo



Resultados: Comparação Entre os Métodos de Solução de Sistemas Lineares 127

permitindo-se vários recomeços. O tamanho máximo da base foi 50. Os resultados estão 

mostrados na Tab. 19 para 0,5 VPL Deve-se ressaltar que este tamanho de base para níveis de 

ILU igual ou superior a 1 não foi atingido. Todos os testes iniciais para dimensionamento do 

tamanho da base foi realizado com ILU(O) e como pode ser visto das tabelas apresentadas é um 

precondicionamento deficiente.

Tab. 19 - Resultados para a conf. de oito poços - 0,50 VPI

Ordenação

ILU

0 1 2

EL TS NIN N1S EL TS NIN NIS EL TS NIN NIS

Natural 2456 2,30 1898 70.299 4179 1,43 1886 46.978 6373 1,33 1815 33.881

Vertical 2456 1,76 1891 64.124 3579 1,14 1891 42.325 4901 1,00 1855 31.044

Horizontal 2456 1,80 1891 64.785 3577 1,16 1889 42.554 4907 1,10 1866 31.520

MDF-Natural 2456 1,77 1888 64.169 4485 1,18 1828 37.843 5602 1,12 1855 30.633

MDF-Vertical 2456 1,76 1890 64.169 4481 1,23 1835 38.189 5595 1,18 1852 30.609



Resultados: Comparação Entre os Métodos de Solução de Sistemas Lineares 128

Fig. 59 - Malha hexagonal híbrida com 1026 volumes

Observa-se na Tab. 19, que o MDF foi a ordenação mais robusta em termos do 

número de iterações no solver para níveis de ILU 1 e 2. Entretanto, menores tempos de CPU 

foram obtidos com as ordenações vertical e horizontal. Nota-se que estas ordenações tentam 

minimizar a largura de banda do Jacobiano. Apesar da malha empregada ser bastante não- 

estruturada e possuir uma heterogeneidade acentuada, o MDF não foi capaz de fornecer a melhor 

ordenação. Pode-se verificar também que o tamanho médio da base para todas as ordenações 

com ILU maior ou igual 1 foi inferior a 25.

A Fig. 60 apresenta uma malha quase estruturada para o mesmo reservatório do caso 

anterior. A diferença é que esta malha tem conectividade aproximadamente constante e o 

Jacobiano resultante é bastante homogêneo. A única diferença com relação aos dados anteriores 

é que esta configuração é composta de dois poços produtores e um injetor. A vazão de cada 

produtor foi 1.84 10'3 m3/s e a do injetor 3.68 10'3 m3/s. Como a convergência do método 

iterativo como base igual a 10 e com ILU(O) estava demasiadamente lenta foi empregado, 

novamente, tamanho de base máximo igual a 50.

A Tab. 20 apresenta os resultados obtidos. Novamente, observa-se que a ordenação



Resultados: Comparação Entre os Métodos de Solução de Sistemas Lineares 129

MDF foi a mais robusta em termos de iterações para níveis de ILU 1 e 2. Entretanto, a ordenação 

vertical foi mais robusta, em termos de tempo de CPU.

Fig. 60 - Malha hexagonal com 559 volumes

Tab. 20 - Resultados para a malha hexagonal com 559 volumes - 0,5 VPI

Ordenação

ILU

0 1 2

EL TS NIN NIS EL TS NIN NIS EL TS NIN NIS

Natural 1568 1,68 2334 61.401 2329 1,55 2295 44.879 3588 1,63 2283 34.147

Vertical 1568 1,31 2353 48.218 2053 1,06 2293 36.348 2942 1,00 2274 25.449

Horizontal 1568 1,30 2345 50.749 2044 1,21 2326 39.743 2955 1,09 2279 28.365

MDF-Natural 1568 1,40 2336 49.602 2711 1,23 2283 34.101 3546 1,19 2268 23.551

MDF-Vertical 1568 1,30 2347 49.428 2746 1,18 2304 33.095 3456 1,14 2274 23.451

MDF-Horizontal 1568 1,45 2336 49.519 2817 1,32 2297 33.055 3496 1,18 2265 23.538



Apresenta-se na Tab. 21 o número médio de elementos a serem armazenados para 

solução via GMRES assumindo tamanho de base igual a 50, tamanho médio da base empregada 

(TMB) e o número de elementos requeridos para uma fatoração completa da matriz Jacobiána. 

TMB foi calculado dividindo-se o número de iterações do solver pelo número de iterações de 

Newton. Os dados da Tab. 21 referem-se aos resultados obtidos para malha hexagonal com 559 

volumes mostrada na Fig. 60.

Resultados: Comparação Entre os Métodos de Solução de Sistemas Lineares 130

Tab. 21 - Número de elementos necessários para solução via GMRES com base igual a 50, 

tamanho médio da base e número de elementos para fatoração completa da matriz Jacobiana

Método (ILU)

Ordenação

Natural (TMB) Vertical (TMB) Horizontal (TMB)

GMRES (0) 70.680 (26,30) 70.680 (20,49) 70.680 (26,30)

GMRES (1) 76.768 (19,56) 74.560 (15,85) 74.488 (17,09)

GMRES (2) 86.840 (14,95) 81.672 (11,19) 81.776 (12,45)

DIRETO 124.628 76.652 77.436

Da Tab. 21 pode-se observar que apesar do aumento do número de elementos para 

níveis de ILU igual ou superior a 1 ocorreu também uma diminuição acentuada no tamanho 

médio da base necessária para convergência. Determinar o tamanho ótimo da base é uma tarefa 

que depende de certa forma da experiência do usuário ou de uma série de testes. Determinar o 

tamanho da base a partir de testes realizados com uma ILU(O), como foi realizado no presente 

trabalho, demonstrou não ser o método mais adequado. A Tab. 22 apresenta o número médio de 

elementos a serem armazenados e o número de elementos requerido para a ordenação vertical. 

NUEM é o número médio de elementos e NUER o número de elementos requerido.



Resultados: Comparação Entre os Métodos de Solução de Sistemas Lineares 131

Tab. 22 - Número médio de elementos armazenados e número de elementos requerido para a 

malha hexagonal com 559 volumes com ordenação vertical

Método (ILU) NUEM NUER

GMRES (0) 37.687 42.730

GMRES (1) 36.380 37.666

GMRES (2) 38.282 40.306

De acordo com os dados expostos anteriormente a memória requerida é função do 

número de elementos necessários para armazenar a matriz aproximada (M) e tamanho da base 

empregada. O que ocorre na realidade é um balanceamento destes dois fatores. Observa-se da 

Tab. 22 que o GMRES(O) requereu mais memória que o GMRES(l). Isto ocorre devido ao 

decréscimo do tamanho da base com o aumento do nível da ILU.

Apesar de não estar reportado nesta seção, foram realizados testes do MDF aplicado 

ao Bi-CGSTAB e ORTHOMIN e na média o comportamento foi o mesmo ao apresentado 

anteriormente para o GMRES.

7.3 - Comparação Entre os Métodos de Solução dos Sistemas lineares

A primeira geometria testada corresponde a um quarto da configuração de cinco 

poços. Os dados físicos e geométricos estão listados na Tab. 3 e a malha utilizada é apresentada 

na Fig. 21. As curvas de permeabilidade relativa e razão de viscosidades são dadas pela Eq. (94). 

Os resultados correspondentes a este caso, para M=10 e 1,0 VPI, estão listados na Tab. 23. O 

tamanho máximo da base para o GMRES e ORTHOMIN foi 10.



Resultados: Comparação Entre os Métodos de Solução de Sistemas Lineares 132

Tab. 23 - Número de iterações e tempo de CPU normalizado - para 1,0 VPI - caso 1 - M=10

ORDENAÇÃO

MÉTODO (ILU) NATURAL VERTICAL HORIZONTAL

GMRES(O) 135.223 (2,56) 131.145 (2,50) 132.695 (2,76)

GMRES(l) 40.581 (1,05) 67.275 (1,53) 69.221 (1,69)

GMRES(2) 36.050 (1,22) 34.265 (1,11) 34.671 (1,09)

ORTHOMIN(O) 135.223 (2,75) 131.145 (2,69) 132.695 (2,89)

ORTHOMIN(l) 40.581 (1,08) 67.275 (1,63) 69.221 (1,80)

ORTHOMIN(2) 36.050 (1,26) 34.265 (1,16) 34.671 (1,14)

Bi-CGSTAB(O) 36.190 (1,17) 39.135 (1,23) 40.193 (1,40)

Bi-CGSTAB(l) 22.800 (1,00) 26.058 (1,04) 26.918 (1,15)

Bi-CGSTAB(2) 17.734 (1,05) 18.389 (1,02) 18.577 (1,00)

Da Tab. 23, verifica-se que ORTHOMIN e GMRES com ILU(O) apresentaram 

comportamento bastante inferior ao Bi-CGSTAB. Por outro lado, o Bi-CGSTAB, apresentou uma 

sensibilidade muito pequena ao precondicionamento, quando comparado aos outros dois métodos. 

Observa-se também, para este caso, que a ordenação natural foi a que apresentou melhores 

resultados para os três métodos. Antes de tentar elucidar este ponto, far-se-á uma breve 

descrição de como é obtida a ordenação natural, através do gerador usado neste trabalho. A malha 

básica é hexagonal. Após a construção desta, escolhe-se o local onde deseja-se a malha polar (por 

exemplo, em tomo do poço). Os pontos pertencentes a malha hexagonal, contidos dentro da 

região polar, são eliminados e os pontos remanescentes no restante do domínio renumerados. Os 

novos pontos colocados dentro da janela circular são numerados a partir do último nó hexagonal. 

Isto faz com que as incógnitas relacionadas aos poços fiquem bastante próximas. Neste problema 

só existe uma frente de propagação de onda e, como as incógnitas relacionadas aos poços estão 

bastantes próximas, a informação da frente de onda é rapidamente transmitida para o restante do



Resultados: Comparação Entre os Métodos de Solução de Sistemas Lineares 133 

domínio, melhorando a convergência do solver.

A Tab. 24 mostra os resultados obtidos para a configuração de oito poços com uma 

malha hexagonal-híbrida com 1026 volumes. Os dados deste problema foram idênticos aos 

apresentados na seção anterior. Neste caso, não foi obtida convergência do GMRES e 

ORTHOMIN, com base 10, mesmo permitindo-se vários recomeços. O tamanho máximo da base 

foi 50.

Tab. 24 - Número de iterações e tempo de CPU normalizado - para 0,5 VPI - caso 2

ORDENAÇÃO

MÉTODO (ILU) NATURAL VERTICAL HORIZONTAL

GMRES(O) 70.299 (2,03) 64.124 (1,76) 64.785 (1,80)

GM RES(l) 46.979 (1,42) 42.325 (1,14) 42.554 (1,16)

GMRES(2) 33.831 (1,32) 31.044 (1,00) 31.520 (1,09)

ORTHOMIN(O) 70.286 (2,34) 64.058 (2,01) -

ORTHOMIN(l) 46.846 (1,61) 42.243 (1,31) -

ORTHOMIN(2) 33.954 (1,46) 30.924 (1,05) -

Bi-CGSTAB(O) 54.839 (1,50) 54.669 (1,62) -

Bi-CGSTAB(l) 36.536 (1,36) 33.162 (1,15) -

Bi-CGSTAB(2) 27.035 (1,44) 25.326 (1,11) -

Da Tab. 24 verifica-se, novamente, uma maior sensibilidade do GMRES e 

ORTHOMIN a qualidade do precondicionador. O Bi-CGSTAB também apresentou uma sensível 

diferença a qualidade do mesmo. Neste problema existem diversas frentes de propagação de onda 

e a ordenação natural não forneceu bons resultados. A melhor convergência foi obtida com uma 

ordenação vertical para a maioria dos casos testados. Este fato pode ser explicado, considerando



que o número de nós na direção y é muito menor que na direção x e, desta forma, a largura de 

banda originada com a ordenação vertical é muito menor. Observa-se que o número de iterações 

para o GMRES com as ordenações vertical e horizontal são bastantes próximas. Novamente, o 

tempo de CPU do ORTHOMIN foi maior que o tempo do GMRES, apesar de existir uma 

pequena diferença no número de iterações dos métodos, a favor do ORTHOMIN.

A Tab. 25 apresenta o resultados para a malha hexagonal com 559 volumes 

apresentada na seção anterior. Foram utilizados os mesmos dados já  apresentados para esta 

configuração.

Resultados: Comparação Entre os Métodos de Solução de Sistemas Lineares 134

Tab. 25 - Número de iterações e tempo de CPU normalizado - para 0,5 VPI - caso 3

ORDENAÇÃO

MÉTODO (ILU) NATURAL VERTICAL HORIZONTAL

GMRES(O) 61.401 (1,68) 48.218 (1,31) 50.749 (1,30)

GMRES(l) 44.879 (1,55) 36.348 (1,06) 39.743 (1,21)

GMRES(2) 34.147 (1,63) 25.449 (1,00) 28.365 (1,09)

ORTHOMIN(O) 61.312 (2,02) 48.220 (1,46) 50.693 (1,52)

ORTHOMIN(l) 44.886 (1,66) 36.324 (1,14) 39.658 (1,38)

ORTHOMIN(2) 34.147 (1,64) 25.440 (1,05) 28.357 (1,18)

Bi-CGSTAB(O) 49.212 (1,62) 35.941 (1,67) 39.499 (1,41)

Bi-CGSTAB(l) 34.467 (1,66) 26.370 (1,16) 28.481 (1,22)

Bi-CGSTAB(2) 25.188 (1,79) 18.325 (1,17) 20.178 (1,22)

Da Tab. 25 observa-se que Bi-CGSTAB com ILU(O) apresentou os piores resultados 

para as ordenações vertical e horizontal. Melhores resultados para todos os métodos foram



obtidos com a ordenação vertical. Observe que o melhor resultado em termos de tempo de CPU 

foi obtido para o GMRES com ILU(2) e ordenação vertical. O mesmo não ocorre para o Bi- 

CGSTAB. O maior custo computacional dos métodos está na solução do sistema precondicionado 

e no produto matriz-vetor. O enchimento da matriz de precondicionamento para uma ILU(2) é 

maior que o enchimento da matriz com ILU(l). Desta forma, o custo de resolver o sistema 

aproximado fica mais comprometido com o aumento do nível da ILU. Como no Bi-CGSTAB 

são necessárias duas operações deste tipo (ver. Tab. 1), não ocorre uma diminuição do tempo de 

CPU, com o aumento do nível da ILU de 1 para 2, embora ocorra uma diminuição do número 

de iterações.

Resultados: Comparação Entre os Métodos de Solução de Sistemas Lineares 135



CONCLUSÕES 136

No presente trabalho implementou-se um código computacional 2D não-estruturado 

empregando malhas de Voronoi, para a solução das equações oriundas do escoamento bifásico 

(óleo-água) em meios porosos. Foi empregado o modelo black-oil com as equações de 

conservação volumétricas escritas nas condições de superfície. O trabalho enquadra-se em uma 

linha bastante recente de pesquisa que é o uso de diagramas de Voronoi para a discretização do 

domínio de cálculo. O conhecimento do comportamento das técnicas neste tipo de discretização 

auxilia o desenvolvimento de simuladores, indispensáveis em engenharia de reservatório.

1. Comparar a eficiência da metodologias de linearização do modelo black-oil. IMPES, 

AIM e TI.

Apesar de existir um grande número de trabalhos que empregam a metodologia AIM 

não é claro o comportamento deste método em relação ao IMPES e TI, ou seja, grande parte 

destes trabalhos comparam o método AIM com o IMPES, TI ou com ambos, mas geralmente os 

critérios utilizados para controle das iterações de newtonianas não são apresentados. Além do 

mais este é um dos poucos trabalhos que empregam o AIM com malha híbridas de Voronoi com 

conectividade variada. Estes fatos justificam o estudo destes métodos no presente trabalho.

Para todos os testes realizados a metodologia IMPES requereu maior tempo de CPU. 

A limitação do IMPES está relacionada a fatores como: curva de fluxo fracionário, vazões 

empregadas, tipo de malhas, etc. Por exemplo, para a malha hexagonal-híbrida empregada para 

a configuração de cinco poços o IMPES requereu 11 vezes mais tempo de CPU que o AIM com 

critério de estabilidade aliado a variação na saturação para M=10. Para M=50 esta relação 

aumentou para 26,2. Observe-se que a única diferença nestes dois casos foi a razão de 

viscosidade e por conseguinte a curva de fluxo fracionário.

Na maioria dos casos analisados o critério de estabilidade proposto por Fung et al. 

(1989) não foi bastante rigoroso, entretanto aliando-se ao mesmo a variação na saturação forneceu 

resultados satisfatórios. Deve-se salientar que o critério para chaveamento de IMPES para TI e



Conclusões 137

vice-versa não necessariamente deve ser exato. O que se objetiva são critérios confiáveis que 

possam realizar a troca sem causar oscilações. Devido a natureza não-linear das equações 

envolvidas um CFL ou critério de estabilidade exato não é uma tarefa fácil de ser realizada.

Verificou-se que mesmo desconsiderando-se uma parcela do Jacobiano para a 

metodologia AIM os erros de balanço tinham a mesma ordem de grandeza que aqueles obtidos 

para a metodologia TI. Para o IMPES mesmo trabalhando-se com intervalos de tempo bastante 

inferiores aos do AIM e TI os erros de balanço foram ligeiramente superiores. Este fato pode ser 

creditato à realização de apenas uma iteração do ciclo de Newton.

2. Estudar o efeito de dois tipos de ordenações das incógnitas para o GMRES: Uma 

geométrica, similar a ordenação natural aplicada a malhas cartesianas e outra baseada 

em uma fatoração incompleta (ILU), denominada MDF (Minimum Discarded FilJ).

A ordenação MDF foi aplicada nos trabalhos de D'Azevedo et al. (1991, 1992a e 

1992b) a problemas condutivos, de mecânica dos fluidos e de reservatório de petróleo 

empregando malhas cartesianas e malhas não-estruturadas oriundas do emprego de discretização 

triangular. Empregando o método dos volumes finitos este tipo de discretização origina volumes 

distorcidos de hexágonos (2D) e tetraedros (3D). Novamente, este é um tópico em aberto na 

literatura, sendo o seu estudo plenamente justificável.

3. Estudar o comportamento dos sistemas lineares oriundos da aplicação deste tipo de 

malhas. Para tal, foram empregados três aceleradores de convergência comumente 

empregados na literatura: ORTHOMIN, GMRES e Bi-CGSTAB.

Novamente, o emprego das malhas de Voronoi híbridas justifica o estudo do 

comportamento dos diversos métodos de solução dos sistemas lineares.

Os resultados apresentados mostraram que a ordenação MDF é robusta para níveis 

de ILU igual ou superior a 1, reduzindo o número de iterações no solver. Entretanto, a mesma 

é grandemente afetada pela ordenação original. Em alguns casos esta dependência foi diminuída



Conclusões 138

com o aumento do nível da fatoração incompleta. Talvez uma maior robustez do esquema seja 

obtida aliando-se ao MDF uma estratégia de análise dos elementos criados nos fatores LU como 

foi realizado por D'Azevedo et cã. (1992b). Deve-se também testar outros tipos de ordenações 

básicas como por exemplo, Reverse-Cuthil-McKee, R e d  Black, etc.

Em relação a resolução dos sistemas lineares, os resultados apresentados em termos 

de tempo de CPU e número de iterações no solver mostraram que o GMRES é ligeiramente 

superior ao ORTHOMIN, apesar do número de iterações em ambos os métodos serem 

semelhantes. Isto ocorre, em virtude do número de operações no ORTHOMIN ser maior. Poder- 

se-ia tentar realizar o produto M q“*1 em vez de realizá-lo por acumulação, como foi realizado 

neste trabalho. Entretanto como foi sugerido por Behie e Vinsome (1982) este procedimento só 

deve ser realizado se o número de ortogonalizações for maior que o número de bandas da matriz 

original. Entretanto como foi observado no presente trabalho, o número de ortogonalizações é 

dependente de cada problema a ser resolvido.

Para a configuração de oito poços com malha hexagonal-híbrida e para a configuração 

de dois poços com malha hexagonal o GMRES apresentou melhores resultados em termos de 

tempo de CPU, entretanto para a configuração de cinco poços o Bi-CGSTAB foi o método mais 

robusto. Em todos os casos testados o Bi-CGSTAB foi o método que apresentou o menor número 

de iterações para uma dada ordenação e nível de ILU empregado. Uma vantagem do Bi-CGSTAB 

é a não dependência de parâmetros de iteração a ser definidos pelo usuário, enquanto o GMRES 

e ORTHOMIN requerem alguma experiência do usuário ou uma série de testes na tentativa de 

obter a dimensão da base e número de recomeços ótimos.

Lista-se a seguir alguns dos pontos não abordados no presente trabalho e que 

considera-se que devam ser atacados em futuros trabalhos nesta área:

1. Testar outros esquema de fatoração aproximada, como por exemplo, os esquemas de 

fatoração em bloco (Eisenstat et al., 1988; Axelsson, 1988; Aarden e Karlsson, 1989). 

Estes esquemas são considerados superiores ao empregado no presente trabalho quando 

trabalha-se com máquinas vetoriais e paralelas.



Conclusões 139

Resolver o problema trifásico e verificar se o critério de estabilidade funciona 

adequadamente com o acréscimo da fase gás, como foi observado no trabalho de Fung 

et al. (1992).

Implementar esquemas de interpolação de ordem mais alta na avaliação das mobilidades. 

Uma opção que parece mais atrativa devido as características geométricas da malha de 

Voronoi é o esquema CDS (Central Difference Scheme) com inclusão de termos de 

dissipação artificial para evitar possíveis oscilações nos campos de saturação e pressão. 

Este tipo de esquema tem sido largamente empregado na área de mecânica dos fluidos 

computacional (Jamenson e Mavriplis, 1986; Cabuk et cã., 1992).



REFERÊNCIAS BIBLIOGRÁFICAS 140

1. AARDEN, J. M. C. e KARLSSON, K. E.: "Preconditioned CG-Type Methods for Solving 

the Coupled Systems of Semicondutor Equations", BIT, 1989, pp. 916-937.

2. ALLEN III, M. B., BEfflE, G. A. e TRANGENSTEIN, J. A.: "Multiphase Flow in Porous 

Media", ed. by C. A. Brebbia and Orszag, Germany, 1988.

3. AXELSSON, O.: "Incomplete Block Matrix Factorization Preconditioning Methods, The 

Ultimate Answer?", J. Comput. Appl. Math., 13, 1985, pp. 3-18.

4. AZIZ, K.: "Notes f o r  Petroleum Reservoir Simulation", Stanford University, 1993.

5. AZIZ, K. e SETTARI, A.: "Petroleum Reservoir Simulation", Applied Science Publishers, 

1979.

6. BALIGA, B. R. and PATANKAR, S. V.: "A Control-Volume Finite Element Method for 

Two-Dimensional Fluid Flow and Heat Transfer", Numer. Heat Transfer, 6, 1983, pp. 245- 

261.

7. BARRET, R., BERRY, M„ CHAN, T„ DEMMEL, J., DONATO, J., DONGARRA, J., 

EIJKHOUT, V., POZO, R., ROMINE, C. e van der VORST, H.: "Templates f o r  the Solution 

o f Linear Systems: Building Blocks f o r  Iterative Methods", SIAM, Philadelphia, 1994.

8. BEHIE, A. e FORSYTH Jr., P. A.: "Incomplete Factorization Methods for Fully Implicit 

Simulation of Enhanced Oil Recovery", S IA M  J. Sci. Stat. Comput., 5, 1984, pp.543-561.

9. BEHIE, A. and VINSOME, P. K. W.: "Block Iterative Methods for Fully Implicit Reservoir 

Simulation", Soc. Pet. Eng. J., 22, 1982, pp. 659-668.

10. BERTIGER, W. J. and PADMANABHAN, L.: "Finite Difference Solutions to Grid 

Orientation Problems Using IMPES, artigo SPE 12250, SPE-AIM E Symposium o f  Reservoir 

Simulation, São Francisco, 1983.

11. BRAND, C. W. e HEINEMANN, J. E and AZIZ, K.: "The Grid Orientation Effect in 

Reservoir Simulation", artigo SPE 21228, Eleventh SPE Symposium on Reservoir Simulation, 

Anaheim, 1991.

12. CABUK, H., SUNG, C. -H., MODI, V.: "Explicit Runge-Kutta Method for Three- 

Dimensional Internal Incompressible Flows", A IA A  Journal, 30, August, pp. 2024-2031.

13. CHIEN, M. C. H. and NORTHRUP, E. J.: "Vetorization and Parallel Processing o f Local



Referências Bibliográficas 141

Grid Refinement and Adptive Implicit Schemes in a General Purpose Reservoir Simulation, 

artigo SPE 25258, Twelfth Symposium on Reservoir Simulation, New Orleans, 1993.

14. CONCUS, P., GOLUB, G. H. e MEURANT, G.: "Block Preconditioning for the Conjugate 

Gradient Method", S IA M  J. Sei. Stat. Comput., 6, 1985, pp. 220-252.

15. COUTINHO, A. L. G. A.: "Comunicação pessocd", 1995.

16. COUTINHO, A. L. G. A., ALVES, J. L. D., LANDAU, L. e EBECKEN, N. F. F.: "Solution 

of Two-Phase Immiscible Flow in Oil Reservoirs Employing Element-By-Element Iterative 

Strategies on the CRAY Y-MP", XIV CILAMCE, São Paulo, SP, 1993a, pp. 723-732.

17.  : "A Dynamic Mesh Partition Algorithm for the Finite Element Solution o f Two-

Phase Immiscible Flow in Oil Reservoir", Finite Elements in Fluids, 1993b, pp. 856-865.

18. COUTINHO, A. L. G. A., ALVES, J. L. D., GARCIA, E. L. e LOULA, A. F. D.: "Solution 

o f Miscible and Immiscible Flows Employing Element-By-Element Iterative Strategies", 

artigo SPE 27050, III A merican/Caribbean Petroleum Engineering Conference, Buenos Aires, 

Argentina, 1994.

19. CUNHA, A. R. C.: "Uma metodologia para Simulação Numérica Tridimensional de 

Reservatórios de Petróleo Utilizando o Modelo Black-Oil e Formulação nas Frações 

Mássicas", Dissert, de Mestrado, Dept0 Enga Mecânica, UFSC, em andamento.

20. CUNHA, A. R., MALISKA, C. R., SILVA, A. F. C. e LIVRAMENTO, M. A.: "Two- 

Dimensional Two-Phase Petroleum Reservoir Simulation Using Boundary-Fitted Grids", V 

ENCIT, São Paulo, SP, Dezembro, 1994, pp. 359-362; RBCM , XVI, 1994, pp. 423-429.

21. CUTHILL, E. e McKEE, J.: "Reducing the Bandwith o f Sparse Symmetric Matrices", Proc. 

24th Nat. Conf. o f  A CM, ACM publ. P-69, Association of Computing Machinery, New York, 

1969, pp. 157-172.

22. DAKE, L. P.: "Fundamentals o f  Reservoir Engineering", Elsivier Scientific Publishing 

Company, Amsterdam, 1978.

23. D'AZEVEDO, E„ FORSYTH, P. A., e WEI-PAI, T.: "An Automatic Ordering Method for 

Imcomplete Factorization Iterative Solvers", artigo SPE 21226, Eleventh Symposium on 

Reservoir Simulation, California, 1991, pp. 259-266.

24.  : "Ordering Methods for Preconditioned Conjugate Gradient Methods Applied

to Unstructured Grid Problems", SIA M  J. Matrix Anal. A p p l, 13, 1992a, pp. 994-961.

25.  : "Towards a Cost-Effective ILU Preconditioner wit High Level Fill", BIT, 32,



Referências Bibliográficas 142

1992b, pp. 442-463.

26. DEIMBACHER, F. X. and HEINEMANN, Z. E.: "Time-Dependent Incorporation of Locally 

Irregular Grids in Large Reservoir Simulation Models", artigo SPE 25260, Twelfth 

Symposium on Reservoir Simulation, New Orleans, 1993.

27. DIRICHLET, G. L. : "Z Reire Angew Math", vol. 40, 1850, p. 216.

28. EISENSTAT, S. C., ELMAN, H. C. e SCHULTZ, M. H.: "Block-Preconditioned Conjugate- 

Gradient-Like Methods for Numerical Reservoir Simulation", SPE Res. Eng., 1988, pp. 307- 

312.

29. EWING, R.: "Problems Arising in the M odeling o f  Processes f o r  Hydrocarbon Recovery" in 

The Mathematics of Reservoir Simulation, ed. por R. E. Ewing, Philadelphia: SIAM, 1983, 

pp. 3-34.

30. EWING, R. E.: "Preconditioned Conjugate Gradient Methods for Large-Scale Fluid Flow 

Applications", BIT, 29, 1989, pp. 850-866.

31. FLEMING, G. C.: "Modeling the Performance of Fractured Wells in Pattern Floods Using 

Orthogonal, Curvilinear Grids", artigo SPE 16973, SPE Annual Technical Conference and 

Exhibition, Dallas, 1987.

32. FORSYTH, P. A: "A Control Volume Finite Element Method for Local Mesh Refinement", 

artigo SPE 18415, Tenth Symposium on Reservoir Simulation, Houston, 1989, pp. 85-96.

33.  : "Adaptive Implicit Criteria for Two-Phase Flow with Gravity and Capillary

Pressure", S IA M  J. Sei. Stat. CompuX., 10, 1989, pp. 227-252.

34. FORSYTH, P. A. e SAMMON, P. H.: "Local Mesh Refinement and Modelling of Faults and 

Pinchouts", artigo SPE 13524, Reservoir Symposium, Dallas, Texas, 1985.

35.  : "Pratical Considerations for Adptive Implicit Methods in Reservoir Simulation",

Journal o f  Comput. Physics, 62, 1986, pp. 265-281.

36. FUNG, L. S. K., BUCHAMAN, W. L. and RAVI SHARMA: "Hybrid-CFFE Method for 

Flexible Grid Reservoir Simulation", artigo SPE 25266, Twelfth Symposium on Reservoir 

Simulation, New Orleans, 1993.

37. FUNG, L. S. K., COLLINS, D. A., NGHIEM, L. X.: "An Adaptive-Implicit Switching 

Criterion Based on Numerical Stability Analysis", SPE Reservoir enginnering, 1989, pp.45- 

51.

38. FUNG, L. S. K., HIEBERT, A. D. and NGHIEM, L.: "Reservoir Simulation with a Control-



Referências Bibliográficas 143

Volume Finite-Element Method", artigo SPE 21224, Eleventh SPE Symposium on Reservoir 

Simulation, Anaheim, 1991.

39. GEORGE, J. A.: "Computer Implementation of the Finite Element Method", Tech. Rep. 

STAN-CS. 71-208, Computer Sei. Dept., Stanford Univ., Stanford, California, 1971.

40. HEINEMANN, Z. E. e BRAND, C. W.: "Gridding Construction for Reservoir Simulation, 

First International Forum on Reservoir Simulation, Alpbach, Austria, 1988.

41. HEINEMANN, Z. E., GERKEN, G. and HANTELMANN, G.: "Using Grid Refinement in 

a Multiple-Aplication Reservoir Simulator, artigo SPE 12225, Seventh Symposium on 

Reservoir Simulation, San Francisco, 1983.

42. HIRASAKI, G. J. and O'DELL, P. M.: "Representation of Reservoir Geometry for Numerical 

Simulation", Soc. Pet. Eng. J., Dec. 1970, pp. 393-394.

43. JAMESON, A. e MAVRIPLIS, D.: "Finite Volume Solution of the Two-Dimensional Euler 

Equations on a Regular Triangular Mesh", A1AA Journal, 24, April, 1986, pp. 611-618.

44. LAKE, L. P.: "Enhanced Oil Recovery", Prentice Hall, Englewood Cliffs, 1989.

45. LIU, J.W.-H. e SHERMAN, A. H.: "Comparative Analysis of the Cuthill-McKee and the 

Reverse Cuthill-McKee Ordering Algorithms for Sparse Matrices", S IA M  J. Numer. Anal.,

13, 1975, pp. 198-213.

46. MACKAY, A. L. : "Stereological Characteristic of Antomic Arrangements in Crystals", 

Journal o f  M icroscopy, 1972, 95, pp. 217 - 27.

47. MALISKA Jr., C. R.: "Um Robusto Gerador de Diagramas de Voronoi para Discretização 

de Domínios Irregulares", X I V  CILAMCE, São Paulo, SP, Dezembro, 1993, pp. 753-762.

48. MALISKA, C. R. e MALISKA Jr., C. R.: "A Finite Volume Method Using Voronoi Grids 

for the Solution o f Miscible Displacement in Porous Media", V ENCIT, São Paulo, SP, 1994, 

pp. 355-358; RBCM , XVI, 1994, pp. 415-422.

49. MALISKA, C. R.: "Transferência de Calor e Mecânica dos Fluidos Computacional", LTC, 

Rio de Janeiro, RJ, 1995.

50. MALISKA, C. R., CUNHA, A. R., LIVRAMENTO M. A. e SILVA, A. F. C.: 

"Tridimensional Petroleum Reservoir Simulation Using Generalized Curvilinear Grids", V 

ENCIT, São Paulo, SP, Dezembro, 1994, pp. 363 - 366.

51. MALISKA, C. R., SILVA, A. F. C., CUNHA, A. R., e OMOTO, M.: "Desenvolvimento de 

Modelos Computacionais em Coordenadas Generalizadas para Simulação de Reservatórios



Referências Bibliográficas 144

de Petróleo - Modelo Black-Oil 3D Usando as frações Massicas", Relatório para o CENPES, 

Projeto 03.73.01 - Programa 102, outubro, 1995.

52. MARCONDES, F., ZAMBALDI, M. C. e MALISKA, C. R.: "Simulação Numérica de 

Reservatórios de Petróleo Utilizando Malhas de Voronoi", V ENCIT, São Paulo, SP, 

Dezembro, 1994, pp. 335-338.

53.  : "Aplicação da Ordenação MDF ao Método GMRES", X I I I  COBEM, Belo

Horizonte, MG, 1995a.

54.  : "Comparação de Métodos Iterativos não Estacionários em Malhas não

Estruturadas de Voronoi na Solução de Problemas de Petróleo", X I I I  COBEM, Belo 

Horizonte, MG, 1995b.

55.  : "Comparação de Métodos Estacionários e GMRES em Simulação de

Reservatórios de Petróleo Utilizando Malhas Não-Estruturadas de Voronoi", RBCM , XVII, 

1995c, pp. 360-372.

56. MEIJRINK, J. A. e van der VORST, H. A.: "Guidelines for the Usage of Incomplete 

Decompositions in Solving Sets of Linear Equations as the Occour in Praticai Problems", J. 

Comput. Physics, 44, 1981, pp. 134-155.

57. MEZZOMO, R. F.: "O Escoamento em Meios Porosos na Indústria do Petróleo", B. Técnico 

PETROBRÁS, Rio de Janeiro, 35, 1992, pp. 21-32.

58. MOTA, M. A. A.: "Simulação Numérica de Resevatórios de Petróleo Utilizando Coordenadas 

Generalizadas e Esquema de Interpolação TVD", Dissertação de mestrado, UFSC, 

Florianópolis, SC, 1994.

59. MOTA, M. A. A. e MALISKA, C. R.: "Simulação Numérica de Resevatórios de Petróleo 

Utilizando Coordenadas Generalizadas e Interpolação TVD", V ENCIT, São Paulo, SP, 

Dezembro, 1994, pp. 325 - 328.

60. NACUL, E. C.: "Use of Domain Decomposition and Local Grid Refinement in Reservoir 

Simulation", PhD dissertation, Stanford University, Stanford, 1991.

61. PALAGI, C.: "Generation and Application o f Voronoi Grid to Model Flow in Heterogeneous 

Reservoirs", PhD dissertation, Stanford University, Stanford, 1992.

62. PATHAK, P.; Winterfeld, P. H., Davis, H. T. e Scriven L. E.: "Rock Structure and 

Transport there in: Unifying with Voronoi Models and Percolation Concepts", paper SPE 

8846, First Joint SPE/DOE Symposium on Enhanced Oil Recovery, Tulsa, April, 1980.



Referências Bibliográficas 145

63. PEACEMAN, D. W.: "Fundamentais o f  Numerical Reservoir Simulation", Elsevier Scientific 

Publishing Company, Amsterdam, 1977.

64.  : "Interpretation o f Well-Block Pressures in Numerical Reservoir Simulation",

Soc. Pet. Eng. J., 1978, pp. 183-194.

65. '______: "Interpretation of Well-Block Pressures in Numerical Reservoir Simulation with

Nonsquare Grid Blocks and Anisotropic Permeability", Soc. Pet. Eng. J. 1983.

66.  "Interpretation of Well-Block Pressures in Numerical Reservoir Simulation-Part

3: Some Additional Well Geometries", artigo SPE 16976, SPEAnnual Technical Conference 

and Exhibition, Dallas, 1987.

67. PEDROSA, O. A. and AZIZ, K.: "Use of a Hybrid Grid in Reservoir Simulation", SPERE, 

1986, pp. 611-621.

68. PINTO, A. C. C.: "Esquemas de A lta  Resolução Para Controle de Dispersão Numérica em 

Simulação de Reservatórios”, Dissertação de Mestrado, UNICAMP, Campinas, SP, 1991.

69. PRAIS, F. e CAMP AGNOLO, E. A.: "Modelagem do Escoamento Multifásico em Simulação 

de Reservatório", XI COBEM, 1991, São Paulo, SP, pp. 545-548.

70. PRICE, H. S. e COATS, K. H.: "Direct Methods in Reservoir Simulation", Trans. SPE o f 

ATME, 257, 1974, pp. 295-308.

71. PRUESS, K. and BODVARSSON, G. S.: "A Seven-Point Finite Difference Method for 

Improved Grid Orientation Performance in Pattern Steamfloods", artigo SPE 12252, Seventh 

Symposium on Reservoir Simulation, San Francisco, 1983.

72. QUANDALLE, P. and BESSET, P.: "The Use o f Flexible Gridding for Improved Reservoir 

Modeling", artigo SPE 12239, Seventh Symposium on Reservoir Simulation, San Francisco, 

1983.

73. RAW, M. J. and SCHNEIDER, G. E.: "A Skewed Positive Influence Coefficient Upwinding 

Procedure for Control-Volume-Based Finite Element Convection-Diffusion Computation", 

Numer. Heat Transfer, 9, 1986, pp. 1-26.

74. RUBIN, B. and BLUNT, M. J.: "High-Order Implicit Flux Limiting Schemes for Black-Oil 

Simulating", artigo SPE 21222, Eleventh SPE Symposium on Reservoir Simulation, Anahein, 

1991, pp. 219-229.

75. RUSSELL, T. F.: "Stability Analysis and Switching Criteria for Adaptive Implicit Methods 

Based on the CFL Condition", artigo SPE 18416, Tenth Symposium on Reservoir



Referências Bibliográficas 146

Simulation, Houston, 1989.

76. SAAD, Y. e SCHULTZ, M. H.: "GMRES: A General Minimal residual Algorithm for 

Solving Nonsymmetric Linear Systems", S IA M  J. Sei. Stat. Comput., 7, 1986, pp. 856-869.

77. SANTOS, R. L. A.: "Estudo de Injeção de Traçadores em M eios Porosos A través do Método 

de Diferenças Finitas com Discretização Exponencicd", Dissertação de Mestrado, UNICAMP, 

Campinas, SP, 1990.

78. SHARPE, H. N.: "Validation o f an Adptative, Orthogonal, Curvilinear Gridding Procedure 

for Reservoir Simulation", artigo SPE 25262, Twelfth SPE Symposium on Reservoir 

Simulation, New Orleans, 1993.

79. SHARPE, H. N. e ANDERSON, D. A.: "Orthogonal Curvilinear Grid Generation with 

Present Internal Boundaries for Reservoir Simulation", artigo SPE 21235, Eleventh SPE 

Symposium on Reservoir Simulation, Anaheim, 1991.

80. SHAKIB, F., HUGES, J. R. e JOHAN, Z.: "A Multi-Element Group Preconditioned GMRES 

Algorithm for Nonsymmetric Systems Arising in Finite Element Analysis", Computer 

M ethods in A pplied Mechanics and Engineering, 75, 1989, pp. 415-456.

81. SHAW, D. C.: "The Treatment o f wells, Faults and Other Singularities in a Black-Oil Finite- 

Element Reservoir Simulator", Twelfth Symposium on Reservoir Simulator, New Orleans, 

1993.

82. SIMON, H. D.: "Incomplete LU Preconditioners for Conjugate-Gradient-Type Iterative 

Methods", SPE J. Res. Engrg., 3, 1988, pp. 302-306.

83. SONNEVELD, P.: "CGS, A Fast Lanczos-Type Solver for Nonsymmetric Linear Systems", 

S IA M  J. Sei. Stat. Comp., 10, 1989, pp. 36-52.

84. SPIVAK, A., PRICE, H. S. e SETTARI, A.: "Solution o f the Equations for Multidimensional, 

Two-Phase, Immiscible Flow by Variational Methods", paper SPE 5723, SPE-AIM  Fourth 

Symposium on Numerical Simulation o f Reservoir Performance, Los Angeles, 1976.

^ 8 5 .  SUGIHARA, K., IRI, M.: "Construction of the Voronoi Diagram for one Million Generators 

in Single-Precision Arithmetic". Proc. o f the IEEE, vol. 80, pp 1471 - 1484.

86. STEVENSON, M. D„ KAGAN, M. e PINCZEWSKI, W. V.: "Computational Methods in 

Petroleum Reservoir Simulation", Comuters &amp;amp; Fluids, 19, 1991, pp. 1-19.

87. TANIGUCHI, N., Arakawa, C., e Kobayoshi, T. : "Construction of a Flow - Simulating 

Method with Finite Volume Based on a Voronoi Diagram", ISM E  International Journal, 31,



Referências Bibliográficas 147

1 9 9 1 ,  pp. 19 - 23.

88. TINNEY, W. F. e WALKER, J. W.: "Direct Solutions of Sparse Network Equations by 

Optmally Ordered Triangular Factorization", Proc. IEEE, 55, 1967, pp. 1801-1809.

89. THOMAS, G. W. e THURNAU, D. H: "Reservoir Simulating Using an Adaptive Implicit 

Method", Soc. Pet. Eng. J., 1983, pp. 759-768.

90. VASCONCELLOS, J. F. V.: "Solução Numérica de Escoamentos Turbulentos em Dutos com 

Bifurcação Usando M ultidomínios", Dissertação de Mestrado, UFSC, Florianópolis, SC, 

1993.

91. VASCONCELLOS, J. F. V. e MALISKA, C. R.: "Numerical Study of the Turbulent Flow 

in a Bifurcating Channel using a Multidomain Procedure", V ENCIT, São Paulo, SP, 1994, 

pp. 109-112.

92. VINSOME, P. K. W.: "ORTHOMIN, An Iterative Method for Solving Sparse Sets of 

Simultaneous Linear Equations", artigo SPE 5729, Fourth SPE Symposium on Numerical 

Simulation o f  Reservoir Performance, Los Angeles, 1976.

93. VOEVODIN, V.: "The Problem o f Non-Self-Adjoint Generalization o f the Conjugate 

Gradient Method is Closed", U.S.S.R. Comput. Meths. and Math. Phys., 23, 1983, pp. 143- 

144.

94. von ROSENBERG, D. U.: "Local Grid Refinement for Finite Difference Methods", artigo 

SPE 10974, SPE Annual Technical Conference and Exhibition, New Orleans, 1982.

95. WINTERFELD, P. H., Scriven, L. E. e Davis, H. T.: "Percolation and Conductivity of 

Randon Two-Dimensional Composites", J. Phys. C: Solid State Phys., 1981, 14, pp. 2361 -

76.

96. WONG, T. W., FIROOZABADI, A. e AZIZ, K.: "The Relationship o f the Volume Balance 

Method of Compositional Simulation to the Newton-Raphson Method", Artigo SPE 18424, 

Tenth SPE Symposium on Reservoir Simulation, Feb., 1989, Houston, Texas.

97. YOUNG, L. C. and RUSSEL, T. F.: "Implementation o f an Adaptive Implicit Method", 

artigo SPE 25245, Twelfth Symposium on Reservoir Simulation, New Orleans, 1993.

98. YANOSIK, J. L., and McCRACKEN, T. A.: "A Nine-Point Finite-Difference Reservoir 

Simulator for Realistic Prediction of Unfavorable Mobility Ratio Displacements", paper SPE 

apresentado no fourth Symposium on Numerical Simulation o f  Reservoir Performance, Los 

Angeles, 1976; Soc. Pet. Eng. J., 18, 1978, pp. 253-262.



APÊNDICE A 148

Com o objetivo de um maior entendimento a respeito do modelo composicional 

apresenta-se a formulação descrita em Peaceman (1977). Conforme anteriormente descrito no 

Cap. 2, suponha que exista N p fases (gás (g), óleo(o) e água (w)) e Nq componentes químicos, 

onde cada componente N, pode estar presente em qualquer uma das fases. O fluxo de massa do 

componente i por unidade de área e por unidade de tempo pode ser escrito como,

X. p V + X. p V + X. p v  ( 109)íg^g g 10^0 O SW^w w

a massa do componente i por unidade de volume do reservatório é dada por,

&lt;b(X. p S  + X. p S + X. p S ) (110)I g r g u g  IO r  0  0  t w ^ w ^ w '  x ’

e os termos de injeção ou produção podem ser escritos como,

X- p a + X. p a + X. p a (111)ig “ g^g u&gt;“ o “ o nv '

Combinando as relações apresentadas anteriormente e empregando a lei de Darcy para 

cálculo das velocidades das fases, pode-se escrever a equação de conservação para o componente

i como,

|«H E  V A »  = v / - p , s V D ) ]  * Y. A, (112)
01 Np Np Pp Np

onde D é a profundidade medida de algum plano horizontal, sendo o sentido positivo para baixo, 

e g a aceleração da gravidade.



Apêndice A 149

Tab. 26 - Variáveis dependentes para o modelo composicional

Variáveis Número

x ig Nq

Xi0 Nq

Xiw Nq

Pg, Po e p w 3

Sg, S0 e Sw 3

ÍV e 3

Pg* Po e pw 3

3

Total 3Nq + 15

Existem Nq equações dadas pela Eq. (112) uma para cada componente i. Entretanto 

existem (3Nq + 15) incógnitas, como pode ser observado na Tab. 26. As equações para 

fechamento do problema são obtidas através de dados experimentais, restrições de volume, 

restrição de massa, etc. Apresenta-se a seguir as relações adicionais.

. Restrição volumétrica

S + S + S = 1g o w 1 Equação (113)



Apêndice A 150

Restrição mássica

n p  n p  n p

E * «  - E * « .  = E * &amp;lt;»
1=1 /=1 i=l

3 Equações (114)

Densidade

Viscosidades

Pp = PA Pp’Xip) 3 Equações (115)

3 Equações (116)

Permeabilidade relativas

= V W 3 Equações (117)

Pressão capilar

1 Equação (118)

P = P -  P (SJS ,Sw) 1 Equação (119)

. Relações de equilíbrio (K ^ ) - Para cada par de fases existe uma constante de distribuição para 

cada componente. Esta constante é função da pressão, temperatura (T) e composição das fases.

— Nq Equações ( 120)
W



Apêndice A 151

— Nq Equações ( 121)

Xio =* Nq Equações ( 122)

Das equações de equilíbrio observa-se que existem apenas 2Nq relações adicionais

uma vez que Nq relações podem ser obtidas das outras equações. Somando-se as Eqs. (113)-(121) 

nota-se que se têm 2Nq + 15 equações. Somando-se as mesmas as Nq equações fornecidas pela 

Eq. (112) tem-se o equacionamento do problema.

saturações e pressão. A confecção de um código computacional empregando as equações descritas 

anteriormente é de difícil programação. A principal dificuldade ocorre quando uma das fases 

desaparece, por exemplo, todo o gás encontram-se diluído na fase óleo. Neste caso as equações 

de restrição e as variáveis primárias têm que ser alteradas. Uma forma de se evitar este 

incoveniente é utilizar como variáveis primárias, a pressão e a fração mássica global (Zj), Wong 

et cã. (1989), Prais e Campagnolo (1991). A fração mássica global é definida por,

Na modelagem apresentada anteriormente as incógnitas são: frações mássicas,

massa do componente i (123)
massa do total da mistura m

onde

(124)

A densidade média da mistura pode ser calculada por,

massa total da mistura 
volume total mistura

(125)



Apêndice A 152

Empregando-se as Eqs. (123)-(125) pode-se escrever a equação de conservação da 

massa do componente i como,

1 (4 &gt; P ^ ,) = E V.[X í ^ ( V Í &gt;  - p gVZ))] + £  p X  q (126)
01 Np V-p Np

Utilizando a equação de conservação, Eq. (126), as frações mássicas são obtidas 

através de rotinas flash (Wong, et al., 1989, Prais e Campagnolo, 1991) e as saturações por sua 

vez são obtidas a partir das frações mássicas. Este tipo de formulação vem sendo utilizado para 

resolver escoamentos trifásicos empregando o modelo black-oil (Maliska et oi., 1995; Cunha, 

1996).


</field>
	</doc>
</add>